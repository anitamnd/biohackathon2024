<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10564618</article-id>
    <article-id pub-id-type="pmid">37740957</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad592</article-id>
    <article-id pub-id-type="publisher-id">btad592</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Systems Biology</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MuDCoD: multi-subject community detection in personalized dynamic gene networks from single-cell RNA sequencing</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4396-817X</contrib-id>
        <name>
          <surname>Şapcı</surname>
          <given-names>Ali Osman Berk</given-names>
        </name>
        <aff><institution>Bioinformatics and Systems Biology Graduate Program, University of California San Diego</institution>, La Jolla, CA 92093, <country country="US">United States</country></aff>
        <aff><institution>Faculty of Engineering and Natural Sciences, Sabancı University</institution>, Istanbul 34956, <country country="TR">Turkey</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lu</surname>
          <given-names>Shan</given-names>
        </name>
        <aff><institution>Department of Statistics, University of Wisconsin-Madison</institution>, Madison, WI 53706, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yan</surname>
          <given-names>Shuchen</given-names>
        </name>
        <aff><institution>Department of Statistics, University of Wisconsin-Madison</institution>, Madison, WI 53706, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0708-6914</contrib-id>
        <name>
          <surname>Ay</surname>
          <given-names>Ferhat</given-names>
        </name>
        <aff><institution>Department of Pediatrics, University of California San Diego</institution>, La Jolla, CA 92093, <country country="US">United States</country></aff>
        <aff><institution>Centers for Autoimmunity, Inflammation and Cancer Immunotherapy, La Jolla Institute for Immunology</institution>, La Jolla, CA 92037, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7058-5372</contrib-id>
        <name>
          <surname>Tastan</surname>
          <given-names>Oznur</given-names>
        </name>
        <aff><institution>Faculty of Engineering and Natural Sciences, Sabancı University</institution>, Istanbul 34956, <country country="TR">Turkey</country></aff>
        <xref rid="btad592-cor1" ref-type="corresp"/>
        <!--otastan@sabanciuniv.edu-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Keleş</surname>
          <given-names>Sündüz</given-names>
        </name>
        <aff><institution>Department of Statistics, University of Wisconsin-Madison</institution>, Madison, WI 53706, <country country="US">United States</country></aff>
        <aff><institution>Department of Biostatistics and Medical Informatics, University of Wisconsin-Madison</institution>, Madison, WI 53706, <country country="US">United States</country></aff>
        <xref rid="btad592-cor1" ref-type="corresp"/>
        <!--keles@stat.wisc.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kendziorski</surname>
          <given-names>Christina</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad592-cor1">Corresponding authors. Department of Statistics, University of Wisconsin-Madison, Madison, WI 53706, United States. E-mail: <email>keles@stat.wisc.edu</email> (S.K.); Faculty of Engineering and Natural Sciences, Sabancı University, Istanbul 34956, Turkey. E-mail: <email>otastan@sabanciuniv.edu</email> (O.T.) </corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>10</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-09-23">
      <day>23</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>10</issue>
    <elocation-id>btad592</elocation-id>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>24</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>17</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>10</day>
        <month>10</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad592.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>With the wide availability of single-cell RNA-seq (scRNA-seq) technology, population-scale scRNA-seq datasets across multiple individuals and time points are emerging. While the initial investigations of these datasets tend to focus on standard analysis of clustering and differential expression, leveraging the power of scRNA-seq data at the personalized dynamic gene co-expression network level has the potential to unlock subject and/or time-specific network-level variation, which is critical for understanding phenotypic differences. Community detection from co-expression networks of multiple time points or conditions has been well-studied; however, none of the existing settings included networks from multiple subjects and multiple time points simultaneously. To address this, we develop <bold>Mu</bold>lti-subject <bold>D</bold>ynamic <bold>Co</bold>mmunity <bold>D</bold>etection (MuDCoD) for multi-subject community detection in personalized dynamic gene networks from scRNA-seq. MuDCoD builds on the spectral clustering framework and promotes information sharing among the networks of the subjects as well as networks at different time points. It clusters genes in the personalized dynamic gene networks and reveals gene communities that are variable or shared not only across time but also among subjects.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Evaluation and benchmarking of MuDCoD against existing approaches reveal that MuDCoD effectively leverages apparent shared signals among networks of the subjects at individual time points, and performs robustly when there is no or little information sharing among the networks. Applications to population-scale scRNA-seq datasets of human-induced pluripotent stem cells during dopaminergic neuron differentiation and CD4<inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> T cell activation indicate that MuDCoD enables robust inference for identifying time-varying personalized gene modules. Our results illustrate how personalized dynamic community detection can aid in the exploration of subject-specific biological processes that vary across time.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>MuDCoD is publicly available at <ext-link xlink:href="https://github.com/bo1929/MuDCoD" ext-link-type="uri">https://github.com/bo1929/MuDCoD</ext-link> as a Python package. Implementation includes simulation and real-data experiments together with extensive documentation.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>HG003747</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Chan Zuckerberg Initiative</institution>
            <institution-id institution-id-type="DOI">10.13039/100014989</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The advent of single-cell RNA sequencing (scRNA-seq) has provided unparalleled insights into the transcriptional programs of different cell types and cellular stages at the individual cell level (<xref rid="btad592-B31" ref-type="bibr">Zeisel <italic toggle="yes">et al.</italic> 2015</xref>, <xref rid="btad592-B4" ref-type="bibr">Chen <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btad592-B27" ref-type="bibr">Travaglini <italic toggle="yes">et al.</italic> 2020</xref>). Population-scale scRNA-seq datasets across multiple individuals and time points are becoming increasingly available (<xref rid="btad592-B19" ref-type="bibr">Mathys <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad592-B9" ref-type="bibr">HipSci Consortium <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad592-B10" ref-type="bibr">2021</xref>, <xref rid="btad592-B23" ref-type="bibr">Soskic <italic toggle="yes">et al.</italic> 2022</xref>). These datasets make it possible to construct personalized, i.e. subject-specific, dynamic gene networks that vary across individuals and across time. Community structures emerge in these dynamic networks when there is strong local clustering of genes that are synchronized to function together. Unraveling the differentiation dynamics or deciphering pathways affected in various diseases requires discovering which genes cooperate in specific cellular processes. Thus, a key inference from the analysis of gene networks is detecting time/condition-varying gene modules that might correspond to genes cooperating in various biological processes. While these modules change over time due to the dynamic nature of the relations among the genes in the processes, they may also vary among different subjects. Variation and similarity among subjects at the network-level, when combined with subject-level phenotype information, can reveal critical information such as differential dynamics of the gene modules driving specific phenotypes. Thus, identifying gene modules by taking into account multiple subjects at once is of paramount importance.</p>
    <p>Gene module detection methods for scRNA-seq data have mostly focused on the construction of static gene networks that capture a snapshot of time or a developmental epoch (<xref rid="btad592-B7" ref-type="bibr">Dai <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad592-B14" ref-type="bibr">Jackson <italic toggle="yes">et al.</italic> 2020</xref>). Many methods exist for detecting modules/communities in networks with or without specialization in multiple subjects or time points, both within and outside of genomics research (summarized in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). These approaches leverage and combine stochastic block models (SBMs) (<xref rid="btad592-B20" ref-type="bibr">Matias and Miele 2017</xref>) with Kalman filters (<xref rid="btad592-B29" ref-type="bibr">Xu and Hero 2014</xref>) or hidden Markov models (<xref rid="btad592-B26" ref-type="bibr">Ting <italic toggle="yes">et al.</italic> 2021</xref>), impose smoothing in spectral clustering (<xref rid="btad592-B5" ref-type="bibr">Chi <italic toggle="yes">et al.</italic> 2007</xref>, <xref rid="btad592-B16" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2018</xref>), and utilize Steiner tree formulation (<xref rid="btad592-B21" ref-type="bibr">Norman and Cicek 2019</xref>). Modularity maximization (<xref rid="btad592-B1" ref-type="bibr">Bassett <italic toggle="yes">et al.</italic> 2013</xref>, <xref rid="btad592-B3" ref-type="bibr">Betzel <italic toggle="yes">et al.</italic> 2019</xref>), nonnegative matrix factorization (<xref rid="btad592-B18" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> 2019</xref>), and network change point detection (NCPD) (<xref rid="btad592-B6" ref-type="bibr">Cribben and Yu 2017</xref>) were also explored in community detection from brain and behavioral networks.</p>
    <p>Recently, <xref rid="btad592-B16" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> (2018)</xref> developed a global spectral clustering framework named PisCES for inferring communities in dynamic networks. PisCES detects gene modules at each time point by imposing module smoothness across time in a spectral clustering formulation. They show that such information sharing across the time domain improves community detection in dynamic networks (<xref rid="btad592-B16" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2018</xref>). However, PisCES does not accommodate joint analysis of networks from multiple subjects, potentially overlooking information that could boost the signal for discovering communities. Here, we generalize the PisCES to detect communities in personalized dynamic gene networks and identify gene modules that vary or persist not only across time but also among subjects. Our method, named <bold>Mu</bold>lti-subject <bold>D</bold>ynamic <bold>Co</bold>mmunity <bold>D</bold>etection (MuDCoD), infers gene communities per subject and per time point by extending the temporal smoothness assumption to the subject dimension.</p>
    <p>We evaluated MuDCoD with simulation experiments in a wide variety of scenarios. To this end, we extended the dynamic degree corrected block model (Dynamic DCBM) (<xref rid="btad592-B20" ref-type="bibr">Matias and Miele 2017</xref>), which provides a setting for time-varying networks to multi-subject scenarios. This multi-subject dynamic DCBM setting accommodates the characteristics of scRNA-seq-based personalized gene networks not only across time but also in the subject dimension. While there are several community detection methods within and outside of genomics, as we summarized above, they are limited in their applicability to handle dynamic multi-subject networks. After taking these approaches and the accessibility of their software into consideration, we compared MuDCoD with the recently developed multi-layer multi-subject modularity maximization technique (referred to as Betzel-2019 hereafter) (<xref rid="btad592-B3" ref-type="bibr">Betzel <italic toggle="yes">et al.</italic> 2019</xref>), PisCES, and static spectral clustering. We observed that MuDCoD markedly outperforms other methods when subjects share information at the network level and performs robustly otherwise. In addition to the simulation experiments, we also applied MuDCoD to scRNA-seq studies of long-term human induced pluripotent stem cells (iPSC) (<xref rid="btad592-B10" ref-type="bibr">HipSci Consortium <italic toggle="yes">et al.</italic> 2021</xref>) and activation of naive and memory human CD4<inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> T cells isolated from peripheral blood (<xref rid="btad592-B23" ref-type="bibr">Soskic <italic toggle="yes">et al.</italic> 2022</xref>). Our results highlight that MuDCoD is able to leverage information sharing across subjects and infer gene modules that contribute to network variation across subjects and time points. Downstream gene set enrichment analysis of inferred modules highlights persistent biological processes across subjects, as well as biological processes that are specific to subsets of subjects and/or time points. A detailed analysis of <xref rid="btad592-B10" ref-type="bibr">HipSci Consortium <italic toggle="yes">et al.</italic> (2021)</xref> dataset by leveraging the differentiation efficiency of subjects reveals that the gene modules of high differentiation efficiency subjects tend to exhibit higher variation across the differentiation time points compared to subjects with low differentiation efficiency. For <xref rid="btad592-B23" ref-type="bibr">Soskic <italic toggle="yes">et al.</italic> (2022)</xref> dataset, we observe that module structures inferred by MuDCoD and the dynamics of enriched biological process annotations for such modules are consistent with mechanisms governing CD4<inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> T cell activation.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Problem formulation</title>
      <p>We define a multi-subject dynamic gene co-expression network for discrete time steps <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> and for subjects <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula> as a time series of undirected and unweighted graphs <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> for each subject <italic toggle="yes">s</italic>. Given a multi-subject dynamic gene co-expression network, the key task is to infer the <italic toggle="yes">community structure</italic> for each time point and subject. The community structure of a gene co-expression network of size <italic toggle="yes">G</italic> is defined as a partition of genes into <italic toggle="yes">K</italic> disjoint cohesive modules/subsets, where <italic toggle="yes">K</italic> is a hyperparameter determining the number of communities. Each community is essentially a group of gene nodes, densely connected inside and loosely connected outside the community. The problem structure is shown in <xref rid="btad592-F1" ref-type="fig">Fig. 1</xref>. In what follows, we use “community” and “module” interchangeably.</p>
      <fig position="float" id="btad592-F1">
        <label>Figure 1.</label>
        <caption>
          <p>A schematic for multi-subject dynamic gene networks. A gene network is observed for each subject at each time step among a common set of nodes. The sets of edges vary among both the subjects and the time steps. These networks are estimated from scRNA-seq data and are expected to harbor communities that are conserved at varying levels among the subject and time dimensions. Different colors mark distinct communities, where the nodes (genes) within the same communities are depicted with the same color. MuDCoD assumes that communities change smoothly across both the subject and the time dimensions.</p>
        </caption>
        <graphic xlink:href="btad592f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>2.2 Promoting signal sharing simultaneously in subject and time dimensions</title>
      <p>Let <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> denote a time series of symmetric <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:math></inline-formula> adjacency matrices of networks <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> varying across discrete time steps <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>, for subjects <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula>. Let <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> denote the degree-normalized Laplacian of <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> as defined by:</p>
      <disp-formula id="E1">
        <label>(1)</label>
        <mml:math id="M1" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mi>L</mml:mi>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msup>
                <mml:mrow>
                  <mml:mi>D</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>/</mml:mo>
                  <mml:mn>2</mml:mn>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
            <mml:mi>A</mml:mi>
            <mml:mrow>
              <mml:msup>
                <mml:mrow>
                  <mml:mi>D</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>/</mml:mo>
                  <mml:mn>2</mml:mn>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
            <mml:mo> </mml:mo>
            <mml:mtext>where</mml:mtext>
            <mml:mo> </mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>D</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mo stretchy="true">{</mml:mo>
              <mml:mrow>
                <mml:mtable>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mi>deg</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>v</mml:mi>
                            </mml:mrow>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mtext>if</mml:mtext>
                        <mml:mo> </mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mi>j</mml:mi>
                        <mml:mo>,</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mn>0</mml:mn>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mtext>otherwise</mml:mtext>
                        <mml:mo>,</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mi>deg</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> denotes the degree of node <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
      <p>Let <italic toggle="yes">K</italic> be fixed, and <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> denote a matrix with columns corresponding to the <italic toggle="yes">K</italic> leading eigenvectors of <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. A baseline strategy for inferring communities from these adjacency matrices is finding communities separately at each time step and for each individual. To detect communities that change longitudinally, PisCES (<xref rid="btad592-B16" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2018</xref>) applies smoothing to the eigenvectors of <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> across time. We develop MuDCoD as a novel and empirically motivated (<xref rid="sup1" ref-type="supplementary-material">Supplementary Section S5</xref>) extension of this framework. MuDCoD applies eigenvector smoothing across both the subject and the time dimensions to promote signal sharing across the subjects in addition to the time dimension. Let <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> be the projection matrix onto the column space of <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and define mean projection matrix</p>
      <disp-formula id="E2">
        <label>(2)</label>
        <mml:math id="M2" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>μ</mml:mo>
                </mml:mrow>
                <mml:mi>s</mml:mi>
              </mml:msub>
            </mml:mrow>
            <mml:mrow>
              <mml:mo>(</mml:mo>
              <mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mover accent="true">
                            <mml:mi>U</mml:mi>
                            <mml:mo>¯</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>:</mml:mo>
                      <mml:mo>,</mml:mo>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
              </mml:mrow>
              <mml:mo>)</mml:mo>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mrow>
                  <mml:mi>S</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mrow>
              <mml:munder>
                <mml:mo>∑</mml:mo>
                <mml:mrow>
                  <mml:mtable>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                          <mml:mo>≤</mml:mo>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mi>s</mml:mi>
                              </mml:mrow>
                              <mml:mo>′</mml:mo>
                            </mml:msup>
                          </mml:mrow>
                          <mml:mo>≤</mml:mo>
                          <mml:mi>S</mml:mi>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mi>s</mml:mi>
                              </mml:mrow>
                              <mml:mo>′</mml:mo>
                            </mml:msup>
                          </mml:mrow>
                          <mml:mo>≠</mml:mo>
                          <mml:mi>s</mml:mi>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mrow>
              </mml:munder>
            </mml:mrow>
            <mml:mrow>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mover accent="true">
                          <mml:mi>U</mml:mi>
                          <mml:mo>¯</mml:mo>
                        </mml:mover>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>s</mml:mi>
                        </mml:mrow>
                        <mml:mo>′</mml:mo>
                      </mml:msup>
                    </mml:mrow>
                    <mml:mo>,</mml:mo>
                    <mml:mi>t</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>U</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the smoothed version of <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. We estimate <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>U</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> by:</p>
      <disp-formula id="E3">
        <label>(3)</label>
        <mml:math id="M3" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mtable>
              <mml:mtr columnalign="left">
                <mml:mtd columnalign="left">
                  <mml:mrow>
                    <mml:mrow>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mi>min</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtable>
                            <mml:mtr>
                              <mml:mtd>
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mrow>
                                        <mml:mrow>
                                          <mml:mrow>
                                            <mml:mover accent="true">
                                              <mml:mi>U</mml:mi>
                                              <mml:mo>¯</mml:mo>
                                            </mml:mover>
                                          </mml:mrow>
                                        </mml:mrow>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mi>s</mml:mi>
                                        <mml:mo>,</mml:mo>
                                        <mml:mi>t</mml:mi>
                                      </mml:mrow>
                                    </mml:msub>
                                  </mml:mrow>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                            <mml:mtr>
                              <mml:mtd>
                                <mml:mrow>
                                  <mml:mi>s</mml:mi>
                                  <mml:mo>=</mml:mo>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>,</mml:mo>
                                  <mml:mo>…</mml:mo>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>S</mml:mi>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                            <mml:mtr>
                              <mml:mtd>
                                <mml:mrow>
                                  <mml:mi>t</mml:mi>
                                  <mml:mo>=</mml:mo>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>,</mml:mo>
                                  <mml:mo>…</mml:mo>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>T</mml:mi>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                          </mml:mtable>
                        </mml:mrow>
                      </mml:munder>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:munderover>
                            <mml:mo>∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>s</mml:mi>
                              <mml:mo>=</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mi>S</mml:mi>
                          </mml:munderover>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:munderover>
                            <mml:mo>∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>t</mml:mi>
                              <mml:mo>=</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mi>T</mml:mi>
                          </mml:munderover>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:mo>‖</mml:mo>
                                    <mml:mrow>
                                      <mml:mrow>
                                        <mml:msub>
                                          <mml:mrow>
                                            <mml:mi>U</mml:mi>
                                          </mml:mrow>
                                          <mml:mrow>
                                            <mml:mi>s</mml:mi>
                                            <mml:mo>,</mml:mo>
                                            <mml:mi>t</mml:mi>
                                          </mml:mrow>
                                        </mml:msub>
                                      </mml:mrow>
                                      <mml:mo>−</mml:mo>
                                      <mml:mrow>
                                        <mml:msub>
                                          <mml:mrow>
                                            <mml:mrow>
                                              <mml:mrow>
                                                <mml:mover accent="true">
                                                  <mml:mi>U</mml:mi>
                                                  <mml:mo>¯</mml:mo>
                                                </mml:mover>
                                              </mml:mrow>
                                            </mml:mrow>
                                          </mml:mrow>
                                          <mml:mrow>
                                            <mml:mi>s</mml:mi>
                                            <mml:mo>,</mml:mo>
                                            <mml:mi>t</mml:mi>
                                          </mml:mrow>
                                        </mml:msub>
                                      </mml:mrow>
                                    </mml:mrow>
                                    <mml:mo>‖</mml:mo>
                                  </mml:mrow>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mi>F</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr columnalign="left">
                <mml:mtd columnalign="left">
                  <mml:mrow>
                    <mml:mo>+</mml:mo>
                    <mml:mrow>
                      <mml:munderover>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>t</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>T</mml:mi>
                      </mml:munderover>
                    </mml:mrow>
                    <mml:mo>β</mml:mo>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mo>‖</mml:mo>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mrow>
                                        <mml:mrow>
                                          <mml:mover accent="true">
                                            <mml:mi>U</mml:mi>
                                            <mml:mo>¯</mml:mo>
                                          </mml:mover>
                                        </mml:mrow>
                                      </mml:mrow>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>s</mml:mi>
                                      <mml:mo>,</mml:mo>
                                      <mml:mi>t</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mo>−</mml:mo>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mo>μ</mml:mo>
                                    </mml:mrow>
                                    <mml:mi>s</mml:mi>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:mrow>
                                    <mml:mrow>
                                      <mml:msub>
                                        <mml:mrow>
                                          <mml:mrow>
                                            <mml:mrow>
                                              <mml:mover accent="true">
                                                <mml:mi>U</mml:mi>
                                                <mml:mo>¯</mml:mo>
                                              </mml:mover>
                                            </mml:mrow>
                                          </mml:mrow>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mo>:</mml:mo>
                                          <mml:mo>,</mml:mo>
                                          <mml:mi>t</mml:mi>
                                        </mml:mrow>
                                      </mml:msub>
                                    </mml:mrow>
                                  </mml:mrow>
                                  <mml:mo>)</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mo>‖</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mi>F</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msubsup>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr columnalign="left">
                <mml:mtd columnalign="left">
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:munderover>
                            <mml:mo>∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>t</mml:mi>
                              <mml:mo>=</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:munderover>
                        </mml:mrow>
                        <mml:mo>α</mml:mo>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mo>‖</mml:mo>
                                  <mml:mrow>
                                    <mml:mrow>
                                      <mml:msub>
                                        <mml:mrow>
                                          <mml:mrow>
                                            <mml:mrow>
                                              <mml:mover accent="true">
                                                <mml:mi>U</mml:mi>
                                                <mml:mo>¯</mml:mo>
                                              </mml:mover>
                                            </mml:mrow>
                                          </mml:mrow>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mi>s</mml:mi>
                                          <mml:mo>,</mml:mo>
                                          <mml:mi>t</mml:mi>
                                        </mml:mrow>
                                      </mml:msub>
                                    </mml:mrow>
                                    <mml:mo>−</mml:mo>
                                    <mml:mrow>
                                      <mml:msub>
                                        <mml:mrow>
                                          <mml:mrow>
                                            <mml:mrow>
                                              <mml:mover accent="true">
                                                <mml:mi>U</mml:mi>
                                                <mml:mo>¯</mml:mo>
                                              </mml:mover>
                                            </mml:mrow>
                                          </mml:mrow>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mi>s</mml:mi>
                                          <mml:mo>,</mml:mo>
                                          <mml:mi>t</mml:mi>
                                          <mml:mo>+</mml:mo>
                                          <mml:mn>1</mml:mn>
                                        </mml:mrow>
                                      </mml:msub>
                                    </mml:mrow>
                                  </mml:mrow>
                                  <mml:mo>‖</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mi>F</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msubsup>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>subject to <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>U</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mrow><mml:msup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow><mml:mo> </mml:mo><mml:mo>:</mml:mo><mml:mo> </mml:mo><mml:mi>V</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mi>I</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mo>∀</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mo>∀</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>.</p>
      <p>Here, the penalty term with parameter <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula> enforces smoothness over the adjacent time points, whereas the term with parameter <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula> constrains subject-specific variation from the mean time-dependent projection matrix <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>U</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Our formulation is based on the assumption that community structure of gene co-expression networks are expected to be similar across the subjects at a fixed time point (i.e. small <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>U</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>U</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>) unless there is an explicit grouping variable (e.g. in a case and control setting). This assumption is empirically supported for the datasets we are considering in this article (<xref rid="sup1" ref-type="supplementary-material">Supplementary Section S5</xref>). The solution of <xref rid="E3" ref-type="disp-formula">Equation 3</xref> yields a series of smoothed mean projection matrices for each subject. Similar to PisCES, we propose to solve this nonconvex optimization problem with the following iterative method:</p>
      <disp-formula id="E4">
        <label>(4)</label>
        <mml:math id="M4" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mtable>
              <mml:mtr columnalign="left">
                <mml:mtd columnalign="left">
                  <mml:mrow>
                    <mml:mtable>
                      <mml:mtr columnalign="left">
                        <mml:mtd columnalign="left">
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msubsup>
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:mrow>
                                      <mml:mover accent="true">
                                        <mml:mi>U</mml:mi>
                                        <mml:mo>¯</mml:mo>
                                      </mml:mover>
                                    </mml:mrow>
                                  </mml:mrow>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>s</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>ℓ</mml:mi>
                                  <mml:mo>+</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msubsup>
                            </mml:mrow>
                            <mml:mo>=</mml:mo>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mo>Π</mml:mo>
                                </mml:mrow>
                                <mml:mi>K</mml:mi>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>U</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>s</mml:mi>
                                      <mml:mo>,</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mo>+</mml:mo>
                                <mml:mo>α</mml:mo>
                                <mml:mrow>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mrow>
                                        <mml:mrow>
                                          <mml:mover accent="true">
                                            <mml:mi>U</mml:mi>
                                            <mml:mo>¯</mml:mo>
                                          </mml:mover>
                                        </mml:mrow>
                                      </mml:mrow>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>s</mml:mi>
                                      <mml:mo>,</mml:mo>
                                      <mml:mn>2</mml:mn>
                                    </mml:mrow>
                                    <mml:mi>ℓ</mml:mi>
                                  </mml:msubsup>
                                </mml:mrow>
                                <mml:mo>+</mml:mo>
                                <mml:mo>β</mml:mo>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mo>μ</mml:mo>
                                    </mml:mrow>
                                    <mml:mi>s</mml:mi>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:mrow>
                                    <mml:mrow>
                                      <mml:msubsup>
                                        <mml:mrow>
                                          <mml:mrow>
                                            <mml:mrow>
                                              <mml:mover accent="true">
                                                <mml:mi>U</mml:mi>
                                                <mml:mo>¯</mml:mo>
                                              </mml:mover>
                                            </mml:mrow>
                                          </mml:mrow>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mo>:</mml:mo>
                                          <mml:mo>,</mml:mo>
                                          <mml:mn>1</mml:mn>
                                        </mml:mrow>
                                        <mml:mi>ℓ</mml:mi>
                                      </mml:msubsup>
                                    </mml:mrow>
                                  </mml:mrow>
                                  <mml:mo>)</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr columnalign="left">
                        <mml:mtd columnalign="left">
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msubsup>
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:mrow>
                                      <mml:mover accent="true">
                                        <mml:mi>U</mml:mi>
                                        <mml:mo>¯</mml:mo>
                                      </mml:mover>
                                    </mml:mrow>
                                  </mml:mrow>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>s</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>T</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>ℓ</mml:mi>
                                  <mml:mo>+</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msubsup>
                            </mml:mrow>
                            <mml:mo>=</mml:mo>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mo>Π</mml:mo>
                                </mml:mrow>
                                <mml:mi>K</mml:mi>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                <mml:mo>α</mml:mo>
                                <mml:mrow>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mrow>
                                        <mml:mrow>
                                          <mml:mover accent="true">
                                            <mml:mi>U</mml:mi>
                                            <mml:mo>¯</mml:mo>
                                          </mml:mover>
                                        </mml:mrow>
                                      </mml:mrow>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>s</mml:mi>
                                      <mml:mo>,</mml:mo>
                                      <mml:mi>T</mml:mi>
                                      <mml:mo>−</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                    <mml:mi>ℓ</mml:mi>
                                  </mml:msubsup>
                                </mml:mrow>
                                <mml:mo>+</mml:mo>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>U</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>s</mml:mi>
                                      <mml:mo>,</mml:mo>
                                      <mml:mi>T</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mo>+</mml:mo>
                                <mml:mo>β</mml:mo>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mo>μ</mml:mo>
                                    </mml:mrow>
                                    <mml:mi>s</mml:mi>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:mrow>
                                    <mml:mrow>
                                      <mml:msubsup>
                                        <mml:mrow>
                                          <mml:mrow>
                                            <mml:mrow>
                                              <mml:mover accent="true">
                                                <mml:mi>U</mml:mi>
                                                <mml:mo>¯</mml:mo>
                                              </mml:mover>
                                            </mml:mrow>
                                          </mml:mrow>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mo>:</mml:mo>
                                          <mml:mo>,</mml:mo>
                                          <mml:mi>T</mml:mi>
                                        </mml:mrow>
                                        <mml:mi>ℓ</mml:mi>
                                      </mml:msubsup>
                                    </mml:mrow>
                                  </mml:mrow>
                                  <mml:mo>)</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr columnalign="left">
                        <mml:mtd columnalign="left">
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msubsup>
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:mrow>
                                      <mml:mover accent="true">
                                        <mml:mi>U</mml:mi>
                                        <mml:mo>¯</mml:mo>
                                      </mml:mover>
                                    </mml:mrow>
                                  </mml:mrow>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>s</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>t</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>ℓ</mml:mi>
                                  <mml:mo>+</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msubsup>
                            </mml:mrow>
                            <mml:mo>=</mml:mo>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mo>Π</mml:mo>
                                </mml:mrow>
                                <mml:mi>K</mml:mi>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                <mml:mo>α</mml:mo>
                                <mml:mrow>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mrow>
                                        <mml:mrow>
                                          <mml:mover accent="true">
                                            <mml:mi>U</mml:mi>
                                            <mml:mo>¯</mml:mo>
                                          </mml:mover>
                                        </mml:mrow>
                                      </mml:mrow>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>s</mml:mi>
                                      <mml:mo>,</mml:mo>
                                      <mml:mi>t</mml:mi>
                                      <mml:mo>−</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                    <mml:mi>ℓ</mml:mi>
                                  </mml:msubsup>
                                </mml:mrow>
                                <mml:mo>+</mml:mo>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>U</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>s</mml:mi>
                                      <mml:mo>,</mml:mo>
                                      <mml:mi>t</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mo>+</mml:mo>
                                <mml:mo>α</mml:mo>
                                <mml:mrow>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mrow>
                                        <mml:mrow>
                                          <mml:mover accent="true">
                                            <mml:mi>U</mml:mi>
                                            <mml:mo>¯</mml:mo>
                                          </mml:mover>
                                        </mml:mrow>
                                      </mml:mrow>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>s</mml:mi>
                                      <mml:mo>,</mml:mo>
                                      <mml:mi>t</mml:mi>
                                      <mml:mo>+</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                    <mml:mi>ℓ</mml:mi>
                                  </mml:msubsup>
                                </mml:mrow>
                                <mml:mo>+</mml:mo>
                                <mml:mo>β</mml:mo>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mo>μ</mml:mo>
                                    </mml:mrow>
                                    <mml:mi>s</mml:mi>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:mrow>
                                    <mml:mrow>
                                      <mml:msubsup>
                                        <mml:mrow>
                                          <mml:mrow>
                                            <mml:mrow>
                                              <mml:mover accent="true">
                                                <mml:mi>U</mml:mi>
                                                <mml:mo>¯</mml:mo>
                                              </mml:mover>
                                            </mml:mrow>
                                          </mml:mrow>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mo>:</mml:mo>
                                          <mml:mo>,</mml:mo>
                                          <mml:mi>t</mml:mi>
                                        </mml:mrow>
                                        <mml:mi>ℓ</mml:mi>
                                      </mml:msubsup>
                                    </mml:mrow>
                                  </mml:mrow>
                                  <mml:mo>)</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mo>,</mml:mo>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula> for all iterations <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mi>ℓ</mml:mi></mml:math></inline-formula> and the iterative algorithm is initialized by <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>U</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> for <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula>. The mapping <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>Π</mml:mo></mml:mrow><mml:mi>K</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> extracts the <italic toggle="yes">K</italic> leading eigenvectors, and is given by <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>Π</mml:mo></mml:mrow><mml:mi>K</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, for a matrix <italic toggle="yes">M</italic>, where <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> are the <italic toggle="yes">K</italic> leading eigenvectors of <italic toggle="yes">M</italic>. This formulation allows the model order <italic toggle="yes">K</italic> to be unknown and possibly varying over time by replacing <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>Π</mml:mo></mml:mrow><mml:mi>K</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:mo>Π</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="script">K</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. We provide a proof of convergence for this iterative algorithm and a range of hyperparameter values (<inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula> and <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula>) for guaranteed convergence in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S2.1</xref>. We utilize the eigengap statistics to select <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">K</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula>  <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula> are chosen with a re-sampling-based cross-validation strategy by <xref rid="btad592-B15" ref-type="bibr">Li <italic toggle="yes">et al.</italic> (2020)</xref>, as we discuss in the next section. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref> illustrates the experimental convergence status for different <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula> and <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula> values.</p>
    </sec>
    <sec>
      <title>2.3 Hyperparameter selection</title>
      <p><bold>Selecting the number of communities:</bold> We allow the number of communities, <italic toggle="yes">K</italic>, to be unknown and possibly varying over time by exploiting the eigengap statistics. <xref rid="btad592-B22" ref-type="bibr">Shen and Cheng (2010)</xref> demonstrated that the degree-normalized Laplacian matrix and the correlation matrix significantly outperform the adjacency matrix, the standard Laplacian matrix, and the modularity matrix at identifying the community structure of networks. Therefore, we use eigenvalues of degree-normalized Laplacian matrix to estimate <italic toggle="yes">K</italic> as described in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S1.2</xref>.</p>
      <p><bold>Cross-validation to tune</bold>  <inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula>  <bold>and</bold>  <inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula><bold>:</bold> We adopt the re-sampling based network cross-validation strategy of <xref rid="btad592-B15" ref-type="bibr">Li <italic toggle="yes">et al.</italic> (2020)</xref> to tune the hyperparameters <inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula> and <inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula>. This network cross-validation strategy makes sure to keep the node pairs in 1-fold when splitting the data into training and validation folds to avoid deleting edges and changing the network structure. Then, we apply grid search to find the best combination of hyperparameters <inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula> and <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula>, where we define the best with respect to a higher DCBM likelihood function. In our experiments, we observed best performing <inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula> and <inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula> values to range between 0.25 and 0.75. Further details on this strategy are available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S1.1</xref>.</p>
    </sec>
    <sec>
      <title>2.4 Prioritizing communities with CRank</title>
      <p>Many community detection methods, including MuDCoD, fully partition network nodes into nonoverlapping groups. However, in real-world datasets, only a few communities can typically be interpreted and linked to relevant underlying factors. Therefore, it is important to prioritize communities for downstream experimentation and further investigation.</p>
      <p>CRank (<xref rid="btad592-B32" ref-type="bibr">Zitnik <italic toggle="yes">et al.</italic> 2018</xref>) prioritizes network communities by considering the structural features of each community and combining these features into an overall community score. Using metrics such as density, likelihood, allegiance, and boundary, CRank effectively ranks communities inferred by an external method.</p>
      <p>We consider CRank as an optional but useful component of any analysis pipeline that includes MuDCoD. This is especially important for datasets with large numbers of subjects/time points, where aligning or matching subject/time-specific modules becomes infeasible. In our applications of MuDCoD, we benefitted from CRank by conducting a gene set enrichment analysis of only the prioritized communities for each subject.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Experimental setup</title>
    <sec>
      <title>3.1 Simulations</title>
      <p>To evaluate MuDCoD, we extended the dynamic degree corrected block model (Dynamic-DCBM) (<xref rid="btad592-B28" ref-type="bibr">Xu and Hero 2013</xref>) simulation set up to multi-subject setting [multi-subject dynamic degree corrected block model (MuS-Dynamic-DCBM)]. This extension captures the overall characteristics of scRNA-seq-based personalized gene networks both in time and subject dimensions. In our computational experiments, we simulated modules from this model and assessed the performances of different methods in recovering the true modules.</p>
      <p>The entries of the adjacency matrix <inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> under MuS-Dynamic-DCBM are generated by the following Bernoulli distribution:</p>
      <disp-formula id="E5">
        <label>(5)</label>
        <mml:math id="M5" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mtable>
              <mml:mtr columnalign="left">
                <mml:mtd columnalign="left">
                  <mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mo>[</mml:mo>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>A</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>s</mml:mi>
                                      <mml:mo>,</mml:mo>
                                      <mml:mi>t</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mo>]</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo>∼</mml:mo>
                    <mml:mtext>Bernoulli</mml:mtext>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mo>Ψ</mml:mo>
                            </mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mi>s</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>t</mml:mi>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                          </mml:msubsup>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mo>Ψ</mml:mo>
                            </mml:mrow>
                            <mml:mi>j</mml:mi>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mi>s</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>t</mml:mi>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                          </mml:msubsup>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>B</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mi>z</mml:mi>
                                  </mml:mrow>
                                  <mml:mi>j</mml:mi>
                                  <mml:mrow>
                                    <mml:mo stretchy="false">(</mml:mo>
                                    <mml:mi>s</mml:mi>
                                    <mml:mo>,</mml:mo>
                                    <mml:mi>t</mml:mi>
                                    <mml:mo stretchy="false">)</mml:mo>
                                  </mml:mrow>
                                </mml:msubsup>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mi>z</mml:mi>
                                  </mml:mrow>
                                  <mml:mi>j</mml:mi>
                                  <mml:mrow>
                                    <mml:mo stretchy="false">(</mml:mo>
                                    <mml:mi>s</mml:mi>
                                    <mml:mo>,</mml:mo>
                                    <mml:mi>t</mml:mi>
                                    <mml:mo stretchy="false">)</mml:mo>
                                  </mml:mrow>
                                </mml:msubsup>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mi>s</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>t</mml:mi>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                          </mml:msubsup>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mo>,</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr columnalign="left">
                <mml:mtd columnalign="left">
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>j</mml:mi>
                    <mml:mo>∈</mml:mo>
                    <mml:mrow>
                      <mml:mo>[</mml:mo>
                      <mml:mi>G</mml:mi>
                      <mml:mo>]</mml:mo>
                    </mml:mrow>
                    <mml:mo>,</mml:mo>
                    <mml:mo> </mml:mo>
                    <mml:mi>j</mml:mi>
                    <mml:mo>&gt;</mml:mo>
                    <mml:mi>i</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mo> </mml:mo>
                    <mml:mi>t</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mo>…</mml:mo>
                    <mml:mo>,</mml:mo>
                    <mml:mi>T</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mo> </mml:mo>
                    <mml:mi>s</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mo>…</mml:mo>
                    <mml:mo>,</mml:mo>
                    <mml:mi>S</mml:mi>
                    <mml:mo>,</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>with <inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Here <inline-formula id="IE58"><mml:math id="IM58" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi>K</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mi>G</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> are vectors of community labels. More specifically, <italic toggle="yes">i</italic>-th entry <inline-formula id="IE59"><mml:math id="IM59" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> of <inline-formula id="IE60"><mml:math id="IM60" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> denotes the module assignment of gene <italic toggle="yes">i</italic> for subject <italic toggle="yes">s</italic> at time point <italic toggle="yes">t</italic>. <inline-formula id="IE61"><mml:math id="IM61" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>Ψ</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>G</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> are degree parameters and <inline-formula id="IE62"><mml:math id="IM62" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> is a connectivity matrix at time <italic toggle="yes">t</italic> for subject <italic toggle="yes">s</italic>. As we describe below with specific cases, variations in the generation process of <inline-formula id="IE63"><mml:math id="IM63" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> as a function of <italic toggle="yes">s</italic> and <italic toggle="yes">t</italic> provide a systematic way of modulating shared information, i.e. similarities, across the subject and time dimensions.</p>
      <p>The degree parameters and the connectivity matrix (<inline-formula id="IE64"><mml:math id="IM64" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>Ψ</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE65"><mml:math id="IM65" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>) for subject <italic toggle="yes">s</italic> at time <italic toggle="yes">t</italic> are randomized as follows:</p>
      <disp-formula id="E6">
        <label>(6)</label>
        <mml:math id="M6" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>B</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>l</mml:mi>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mo stretchy="true">{</mml:mo>
              <mml:mrow>
                <mml:mtable>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mtext>Uniform</mml:mtext>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>p</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>in</mml:mtext>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mn>0</mml:mn>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                          </mml:msubsup>
                        </mml:mrow>
                        <mml:mo>,</mml:mo>
                        <mml:mo> </mml:mo>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>p</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>in</mml:mtext>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mn>1</mml:mn>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                          </mml:msubsup>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mtext>if</mml:mtext>
                        <mml:mo> </mml:mo>
                        <mml:mi>l</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mi>k</mml:mi>
                        <mml:mo>,</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mtext>Uniform</mml:mtext>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>p</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>out</mml:mtext>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mn>0</mml:mn>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                          </mml:msubsup>
                        </mml:mrow>
                        <mml:mo>,</mml:mo>
                        <mml:mo> </mml:mo>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>p</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>out</mml:mtext>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mn>1</mml:mn>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                          </mml:msubsup>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mtext>if</mml:mtext>
                        <mml:mo> </mml:mo>
                        <mml:mi>l</mml:mi>
                        <mml:mo>≠</mml:mo>
                        <mml:mi>k</mml:mi>
                        <mml:mo>,</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <disp-formula id="E7">
        <label>(7)</label>
        <mml:math id="M7" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msup>
                <mml:mrow>
                  <mml:mo>Ψ</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>s</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>t</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>γ</mml:mo>
                </mml:mrow>
                <mml:mn>0</mml:mn>
              </mml:msub>
            </mml:mrow>
            <mml:mo>+</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>γ</mml:mo>
                </mml:mrow>
                <mml:mn>1</mml:mn>
              </mml:msub>
            </mml:mrow>
            <mml:mrow>
              <mml:msup>
                <mml:mrow>
                  <mml:mo>π</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>s</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>t</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
            <mml:mo>/</mml:mo>
            <mml:mi>G</mml:mi>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula id="IE66"><mml:math id="IM66" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>in</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>in</mml:mtext></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>in</mml:mtext></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE67"><mml:math id="IM67" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>out</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>out</mml:mtext></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>out</mml:mtext></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are in-cluster and between-cluster density parameters (<inline-formula id="IE68"><mml:math id="IM68" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>in</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>≥</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>out</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>), respectively, <inline-formula id="IE69"><mml:math id="IM69" display="inline" overflow="scroll"><mml:mo>π</mml:mo></mml:math></inline-formula> is a random permutation of <inline-formula id="IE70"><mml:math id="IM70" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE71"><mml:math id="IM71" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE72"><mml:math id="IM72" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> are determined based on the value of <italic toggle="yes">G</italic> and the desired degree distribution. We set <inline-formula id="IE73"><mml:math id="IM73" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE74"><mml:math id="IM74" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> in our experiments. For the original network (<inline-formula id="IE75"><mml:math id="IM75" display="inline" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE76"><mml:math id="IM76" display="inline" overflow="scroll"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>), community memberships of nodes are initialized from the following multinomial distribution: <inline-formula id="IE77"><mml:math id="IM77" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>∼</mml:mo><mml:mtext>Multinomial</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mfrac></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mfrac></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
      <p>Our extension MuS-Dynamic-DCBM spans two distinct multi-subject settings: Signal-Sharing-over-Subjects (SSoS) and Signal-Sharing-over-Time (SSoT) (<xref rid="btad592-F2" ref-type="fig">Fig. 2</xref>). Both of these vary the degree of similarity between subject-specific networks while maintaining their time-dependent components and developing corresponding generation processes for community memberships across the time and subject dimensions. Signal-Sharing-over-Subjects (SSoS) enables modulation of signal sharing across subjects. For both settings, each subject’s network at time <italic toggle="yes">t</italic> is generated based on the corresponding module labels.</p>
      <fig position="float" id="btad592-F2">
        <label>Figure 2.</label>
        <caption>
          <p>Multi-subject dynamic degree corrected block models (MuS-Dynamic-DCBM) for the two proposed settings. (a) <italic toggle="yes">SSoS setting:</italic> subjects evolve from a common ancestor at each time step <italic toggle="yes">t</italic>; and only the ancestor’s evolution over time is parameterized. (b) <italic toggle="yes">SSoT setting:</italic> subjects evolve from a common ancestor at <inline-formula id="IE78"><mml:math id="IM78" display="inline" overflow="scroll"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>; and then they evolve independently over time.</p>
        </caption>
        <graphic xlink:href="btad592f2" position="float"/>
      </fig>
      <sec>
        <title>3.1.1 Signal-Sharing-over-Subjects (SSoS)</title>
        <p>In SSoS, gene modules of an “ancestor” progress over time with controllable similarity along the adjacent time points, and each subject’s set of gene modules at time <italic toggle="yes">t</italic> is a realization from this progressing ancestor (<xref rid="btad592-F2" ref-type="fig">Fig. 2</xref>). Let <inline-formula id="IE79"><mml:math id="IM79" display="inline" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> index the subject for the ancestor network, and <inline-formula id="IE80"><mml:math id="IM80" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> denote its community labels for <inline-formula id="IE81"><mml:math id="IM81" display="inline" overflow="scroll"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>. In SSoS, <inline-formula id="IE82"><mml:math id="IM82" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> progresses over time according to</p>
        <disp-formula id="E8">
          <label>(8)</label>
          <mml:math id="M8" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mtable>
                <mml:mtr columnalign="left">
                  <mml:mtd columnalign="left">
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mi>z</mml:mi>
                          </mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo>,</mml:mo>
                            <mml:mi>t</mml:mi>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="false">{</mml:mo>
                        <mml:mrow>
                          <mml:mtable>
                            <mml:mtr columnalign="left">
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:msubsup>
                                      <mml:mrow>
                                        <mml:mi>z</mml:mi>
                                      </mml:mrow>
                                      <mml:mi>i</mml:mi>
                                      <mml:mrow>
                                        <mml:mo stretchy="false">(</mml:mo>
                                        <mml:mn>1</mml:mn>
                                        <mml:mo>,</mml:mo>
                                        <mml:mi>t</mml:mi>
                                        <mml:mo>−</mml:mo>
                                        <mml:mn>1</mml:mn>
                                        <mml:mo stretchy="false">)</mml:mo>
                                      </mml:mrow>
                                    </mml:msubsup>
                                  </mml:mrow>
                                </mml:mrow>
                              </mml:mtd>
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mtext>with</mml:mtext>
                                  <mml:mo> </mml:mo>
                                  <mml:mtext>probability</mml:mtext>
                                  <mml:mo> </mml:mo>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>−</mml:mo>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mrow>
                                        <mml:mi>r</mml:mi>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mtext>time</mml:mtext>
                                      </mml:mrow>
                                    </mml:msub>
                                  </mml:mrow>
                                  <mml:mo>,</mml:mo>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                            <mml:mtr columnalign="left">
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mtext>Multinomial</mml:mtext>
                                  <mml:mo stretchy="true">(</mml:mo>
                                  <mml:mrow>
                                    <mml:mfrac>
                                      <mml:mn>1</mml:mn>
                                      <mml:mi>K</mml:mi>
                                    </mml:mfrac>
                                  </mml:mrow>
                                  <mml:mo>,</mml:mo>
                                  <mml:mo>…</mml:mo>
                                  <mml:mo>,</mml:mo>
                                  <mml:mrow>
                                    <mml:mfrac>
                                      <mml:mn>1</mml:mn>
                                      <mml:mi>K</mml:mi>
                                    </mml:mfrac>
                                  </mml:mrow>
                                  <mml:mo stretchy="true">)</mml:mo>
                                </mml:mrow>
                              </mml:mtd>
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mtext>otherwise</mml:mtext>
                                  <mml:mo>,</mml:mo>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                          </mml:mtable>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr columnalign="left">
                  <mml:mtd columnalign="left">
                    <mml:mrow>
                      <mml:mtext>for</mml:mtext>
                      <mml:mo> </mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>∈</mml:mo>
                      <mml:mrow>
                        <mml:mo>[</mml:mo>
                        <mml:mi>G</mml:mi>
                        <mml:mo>]</mml:mo>
                      </mml:mrow>
                      <mml:mo>,</mml:mo>
                      <mml:mo> </mml:mo>
                      <mml:mi>t</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mo>…</mml:mo>
                      <mml:mo>,</mml:mo>
                      <mml:mi>T</mml:mi>
                      <mml:mo>,</mml:mo>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>where <inline-formula id="IE83"><mml:math id="IM83" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>time</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> denotes the probability that a node <italic toggle="yes">i</italic> changes its previous community label, <inline-formula id="IE84"><mml:math id="IM84" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>. Then, community labels of other subjects for each time point <italic toggle="yes">t</italic> are generated as follows:</p>
        <disp-formula id="E9">
          <label>(9)</label>
          <mml:math id="M9" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mtable>
                <mml:mtr columnalign="left">
                  <mml:mtd columnalign="left">
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mi>z</mml:mi>
                          </mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>s</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>t</mml:mi>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="false">{</mml:mo>
                        <mml:mrow>
                          <mml:mtable>
                            <mml:mtr columnalign="left">
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:msubsup>
                                      <mml:mrow>
                                        <mml:mi>z</mml:mi>
                                      </mml:mrow>
                                      <mml:mi>i</mml:mi>
                                      <mml:mrow>
                                        <mml:mo stretchy="false">(</mml:mo>
                                        <mml:mn>1</mml:mn>
                                        <mml:mo>,</mml:mo>
                                        <mml:mi>t</mml:mi>
                                        <mml:mo stretchy="false">)</mml:mo>
                                      </mml:mrow>
                                    </mml:msubsup>
                                  </mml:mrow>
                                </mml:mrow>
                              </mml:mtd>
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mtext>with</mml:mtext>
                                  <mml:mo> </mml:mo>
                                  <mml:mtext>probability</mml:mtext>
                                  <mml:mo> </mml:mo>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>−</mml:mo>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mrow>
                                        <mml:mi>r</mml:mi>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mtext>subject</mml:mtext>
                                      </mml:mrow>
                                    </mml:msub>
                                  </mml:mrow>
                                  <mml:mo>,</mml:mo>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                            <mml:mtr columnalign="left">
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mtext>Multinomial</mml:mtext>
                                  <mml:mo stretchy="true">(</mml:mo>
                                  <mml:mrow>
                                    <mml:mfrac>
                                      <mml:mn>1</mml:mn>
                                      <mml:mi>K</mml:mi>
                                    </mml:mfrac>
                                  </mml:mrow>
                                  <mml:mo>,</mml:mo>
                                  <mml:mo>…</mml:mo>
                                  <mml:mo>,</mml:mo>
                                  <mml:mrow>
                                    <mml:mfrac>
                                      <mml:mn>1</mml:mn>
                                      <mml:mi>K</mml:mi>
                                    </mml:mfrac>
                                  </mml:mrow>
                                  <mml:mo stretchy="true">)</mml:mo>
                                </mml:mrow>
                              </mml:mtd>
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mtext>otherwise</mml:mtext>
                                  <mml:mo>,</mml:mo>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                          </mml:mtable>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr columnalign="left">
                  <mml:mtd columnalign="left">
                    <mml:mrow>
                      <mml:mtext>for</mml:mtext>
                      <mml:mo> </mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>∈</mml:mo>
                      <mml:mrow>
                        <mml:mo>[</mml:mo>
                        <mml:mi>G</mml:mi>
                        <mml:mo>]</mml:mo>
                      </mml:mrow>
                      <mml:mo>,</mml:mo>
                      <mml:mo> </mml:mo>
                      <mml:mi>t</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mo>…</mml:mo>
                      <mml:mo>,</mml:mo>
                      <mml:mi>T</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mo> </mml:mo>
                      <mml:mi>s</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mo>…</mml:mo>
                      <mml:mo>,</mml:mo>
                      <mml:mi>S</mml:mi>
                      <mml:mo>,</mml:mo>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>where <inline-formula id="IE85"><mml:math id="IM85" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the probability that the node <italic toggle="yes">i</italic> changes community label while progressing from <inline-formula id="IE86"><mml:math id="IM86" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
      </sec>
      <sec>
        <title>3.1.2 Signal-Sharing-over-Time (SSoT)</title>
        <p>In contrast to SSoS, in SSoT, each subject’s gene modules start out from a common ancestor network at time <inline-formula id="IE87"><mml:math id="IM87" display="inline" overflow="scroll"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and progress over time independent of other subjects. In this setting, gene modules of a subject share similarities between time points (<xref rid="btad592-F2" ref-type="fig">Fig. 2</xref>). Let <inline-formula id="IE88"><mml:math id="IM88" display="inline" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> index the subject for the ancestor network, and <inline-formula id="IE89"><mml:math id="IM89" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> denote its community labels at <inline-formula id="IE90"><mml:math id="IM90" display="inline" overflow="scroll"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. The community labels of other subjects progress from the ancestor network only at time <inline-formula id="IE91"><mml:math id="IM91" display="inline" overflow="scroll"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> according to:</p>
        <disp-formula id="E10">
          <label>(10)</label>
          <mml:math id="M10" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mtable>
                <mml:mtr columnalign="left">
                  <mml:mtd columnalign="left">
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mi>z</mml:mi>
                          </mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>s</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="false">{</mml:mo>
                        <mml:mrow>
                          <mml:mtable>
                            <mml:mtr columnalign="left">
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:msubsup>
                                      <mml:mrow>
                                        <mml:mi>z</mml:mi>
                                      </mml:mrow>
                                      <mml:mi>i</mml:mi>
                                      <mml:mrow>
                                        <mml:mo stretchy="false">(</mml:mo>
                                        <mml:mn>1</mml:mn>
                                        <mml:mo>,</mml:mo>
                                        <mml:mn>1</mml:mn>
                                        <mml:mo stretchy="false">)</mml:mo>
                                      </mml:mrow>
                                    </mml:msubsup>
                                  </mml:mrow>
                                </mml:mrow>
                              </mml:mtd>
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mtext>with</mml:mtext>
                                  <mml:mo> </mml:mo>
                                  <mml:mtext>probability</mml:mtext>
                                  <mml:mo> </mml:mo>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>−</mml:mo>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mrow>
                                        <mml:mi>r</mml:mi>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mtext>subject</mml:mtext>
                                      </mml:mrow>
                                    </mml:msub>
                                  </mml:mrow>
                                  <mml:mo>,</mml:mo>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                            <mml:mtr columnalign="left">
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mtext>Multinomial</mml:mtext>
                                  <mml:mo stretchy="true">(</mml:mo>
                                  <mml:mrow>
                                    <mml:mfrac>
                                      <mml:mn>1</mml:mn>
                                      <mml:mi>K</mml:mi>
                                    </mml:mfrac>
                                  </mml:mrow>
                                  <mml:mo>,</mml:mo>
                                  <mml:mo>…</mml:mo>
                                  <mml:mo>,</mml:mo>
                                  <mml:mrow>
                                    <mml:mfrac>
                                      <mml:mn>1</mml:mn>
                                      <mml:mi>K</mml:mi>
                                    </mml:mfrac>
                                  </mml:mrow>
                                  <mml:mo stretchy="true">)</mml:mo>
                                </mml:mrow>
                              </mml:mtd>
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mtext>otherwise</mml:mtext>
                                  <mml:mo>,</mml:mo>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                          </mml:mtable>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr columnalign="left">
                  <mml:mtd columnalign="left">
                    <mml:mrow>
                      <mml:mtext>for</mml:mtext>
                      <mml:mo> </mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>∈</mml:mo>
                      <mml:mrow>
                        <mml:mo>[</mml:mo>
                        <mml:mi>G</mml:mi>
                        <mml:mo>]</mml:mo>
                      </mml:mrow>
                      <mml:mo>,</mml:mo>
                      <mml:mo> </mml:mo>
                      <mml:mi>s</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mo>…</mml:mo>
                      <mml:mo>,</mml:mo>
                      <mml:mi>S</mml:mi>
                      <mml:mo>.</mml:mo>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>Then, each subject progresses independently over time by:</p>
        <disp-formula id="E11">
          <label>(11)</label>
          <mml:math id="M11" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mtable>
                <mml:mtr columnalign="left">
                  <mml:mtd columnalign="left">
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mi>z</mml:mi>
                          </mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>s</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>t</mml:mi>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="false">{</mml:mo>
                        <mml:mrow>
                          <mml:mtable>
                            <mml:mtr columnalign="left">
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:msubsup>
                                      <mml:mrow>
                                        <mml:mi>z</mml:mi>
                                      </mml:mrow>
                                      <mml:mi>i</mml:mi>
                                      <mml:mrow>
                                        <mml:mo stretchy="false">(</mml:mo>
                                        <mml:mi>s</mml:mi>
                                        <mml:mo>,</mml:mo>
                                        <mml:mi>t</mml:mi>
                                        <mml:mo>−</mml:mo>
                                        <mml:mn>1</mml:mn>
                                        <mml:mo stretchy="false">)</mml:mo>
                                      </mml:mrow>
                                    </mml:msubsup>
                                  </mml:mrow>
                                </mml:mrow>
                              </mml:mtd>
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mtext>with</mml:mtext>
                                  <mml:mo> </mml:mo>
                                  <mml:mtext>probability</mml:mtext>
                                  <mml:mo> </mml:mo>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>−</mml:mo>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mrow>
                                        <mml:mi>r</mml:mi>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mtext>time</mml:mtext>
                                      </mml:mrow>
                                    </mml:msub>
                                  </mml:mrow>
                                  <mml:mo>,</mml:mo>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                            <mml:mtr columnalign="left">
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mtext>Multinomial</mml:mtext>
                                  <mml:mo stretchy="true">(</mml:mo>
                                  <mml:mrow>
                                    <mml:mfrac>
                                      <mml:mn>1</mml:mn>
                                      <mml:mi>K</mml:mi>
                                    </mml:mfrac>
                                  </mml:mrow>
                                  <mml:mo>,</mml:mo>
                                  <mml:mo>…</mml:mo>
                                  <mml:mo>,</mml:mo>
                                  <mml:mrow>
                                    <mml:mfrac>
                                      <mml:mn>1</mml:mn>
                                      <mml:mi>K</mml:mi>
                                    </mml:mfrac>
                                  </mml:mrow>
                                  <mml:mo stretchy="true">)</mml:mo>
                                </mml:mrow>
                              </mml:mtd>
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mtext>otherwise</mml:mtext>
                                  <mml:mo>,</mml:mo>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                          </mml:mtable>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr columnalign="left">
                  <mml:mtd columnalign="left">
                    <mml:mrow>
                      <mml:mtext>for</mml:mtext>
                      <mml:mo> </mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>∈</mml:mo>
                      <mml:mrow>
                        <mml:mo>[</mml:mo>
                        <mml:mi>G</mml:mi>
                        <mml:mo>]</mml:mo>
                      </mml:mrow>
                      <mml:mo>,</mml:mo>
                      <mml:mo> </mml:mo>
                      <mml:mi>t</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mo>…</mml:mo>
                      <mml:mo>,</mml:mo>
                      <mml:mi>T</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mo> </mml:mo>
                      <mml:mi>s</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mo>…</mml:mo>
                      <mml:mo>,</mml:mo>
                      <mml:mi>S</mml:mi>
                      <mml:mo>.</mml:mo>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </sec>
    </sec>
    <sec>
      <title>3.2 Experiments on real biological datasets</title>
      <p>We applied MuDCoD to two population-scale scRNA-seq datasets. In this section, we provide details on the data preprocessing steps of these applications. We remark that different data preprocessing steps were applied for the two datasets to accommodate differences in their overall levels of sparsity and the sequencing depths of the cells.</p>
      <sec>
        <title>3.2.1 scRNA-seq of iPS cells during dopaminergic neuron differentiation</title>
        <p>The Jerber-2021 dataset (<xref rid="btad592-B10" ref-type="bibr">HipSci Consortium <italic toggle="yes">et al.</italic> 2021</xref>) harbors scRNA-seq data of 215 iPSC lines differentiating toward a mid-brain neural fate from the Human Induced Pluripotent Stem Cell Initiative (HipSci). Cells were collected for scRNA-seq profiling on days 11, 30, and 52 (day-11, day-30, and day-52). We considered the scRNA-seq count matrices from the three time points together for preprocessing. We retained genes expressed in at least <inline-formula id="IE92"><mml:math id="IM92" display="inline" overflow="scroll"><mml:mrow><mml:mn>0.5</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> of the cells and selected top 3000 highly variable genes using the function <monospace>pp.filter_genes_dispersion</monospace> from Python package <monospace>Scanpy</monospace>. We normalized the count matrix for each donor using the <monospace>R</monospace> package <monospace>SCTransform</monospace> (<xref rid="btad592-B8" ref-type="bibr">Hafemeister and Satija 2019</xref>) and adjusted for covariates “<monospace>pool_id</monospace>”, “<monospace>time_point</monospace>”, and “<monospace>treatment</monospace>” for batch correction. Leveraging the cell type annotations from the original publication (<xref rid="btad592-B10" ref-type="bibr">HipSci Consortium <italic toggle="yes">et al.</italic> 2021</xref>), we excluded day-11 from the analysis as it predominantly harbored progenitor cells which matured into young and mature neurons in the following time points. We focused on day-30 and day-52 both of which had dopaminergic neurons (DA), serotonin transporter (Sert), and ependymal-like 1 (Epen1) cell types. Furthermore, donors that (i) do not express the 3000 highly variable genes, i.e. have zero expression count across all cells, for one or more “time point-cell type” combinations; (ii) have fewer than 500 cells for any specific “time point-cell type” combination were filtered out for a robust estimation of gene co-expression networks. This resulted in 16, 22, and 8 donors, respectively, for DA, Sert, and Epen1 cell types. Finally, we constructed cell-type specific gene–gene Pearson correlation matrices for each donor at each time point.</p>
      </sec>
      <sec>
        <title>3.2.2 scRNA-seq of CD4<inline-formula id="IE93"><mml:math id="IM93" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> T cells during activation</title>
        <p>The Soskic-2022 dataset (<xref rid="btad592-B23" ref-type="bibr">Soskic <italic toggle="yes">et al.</italic> 2022</xref>) contains scRNA-seq profiling of 600k CD4<inline-formula id="IE94"><mml:math id="IM94" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> T cells in a time course of activation after stimulation with anti-CD3/anti-CD28 beads. Cells were collected for scRNA-seq profiling before (0-h) and at 16-h, 40-h, and 5-days after stimulation. We considered the scRNA-seq count matrices from the four time points together for preprocessing and retained genes expressed in at least <inline-formula id="IE95"><mml:math id="IM95" display="inline" overflow="scroll"><mml:mrow><mml:mn>2</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> of the cells for initial gene filtering. All the ribosomal and mitochondrial genes were further removed. Datasets from specific time points and donor combinations with more than 200 cells were retained for the construction of networks. Due to the large sequencing depth differences between the cells profiled at different time points in this dataset, we applied <monospace>Dozer (</monospace><xref rid="btad592-B17" ref-type="bibr">Lu and Keleş 2023</xref><monospace>)</monospace>, which utilizes a Poisson measurement error model, to robustly estimate personalized gene co-expression networks. Furthermore, to improve the reliability and reproducibility of gene co-expression networks, we filtered out noisy and sparse genes using the “noise-ratio” metric from <monospace>Dozer</monospace> and retained 408 genes. Finally, this preprocessing yielded 79 healthy donors with co-expression networks of CD4<inline-formula id="IE96"><mml:math id="IM96" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> Naive cells for 408 genes across the four time points.</p>
        <p>For both datasets, the resulting co-expression matrices were then converted into unweighted adjacency matrices by keeping the top <inline-formula id="IE97"><mml:math id="IM97" display="inline" overflow="scroll"><mml:mrow><mml:mn>5</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> of the edges [as commonly practiced in gene co-expression network construction from scRNA-seq (<xref rid="btad592-B13" ref-type="bibr">Iacono <italic toggle="yes">et al.</italic> 2019</xref>)] based on absolute values of their correlations. While this approach is commonly practiced and appears reasonable for these datasets (<xref rid="sup1" ref-type="supplementary-material">Supplementary Section S8</xref>), alternatives that formally test for the edges in the co-expression networks could also be used (<xref rid="btad592-B25" ref-type="bibr">Su <italic toggle="yes">et al.</italic> 2022</xref>).</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>4 Results</title>
    <sec>
      <title>4.1 Performance comparison with simulation experiments</title>
      <p>We compared MuDCoD, PisCES, baseline static spectral clustering (“static”), and Betzel-2019 on simulated networks to assess their performance in community detection over the subject and time dimensions. We utilized the same selection procedure for the number of communities, <italic toggle="yes">K</italic>, when running PisCES, MuDCoD and “static” (<xref rid="sup1" ref-type="supplementary-material">Supplementary Section S1.2</xref>). We used the network cross-validation approach to determine the tuning hyperparameters <inline-formula id="IE98"><mml:math id="IM98" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula> and <inline-formula id="IE99"><mml:math id="IM99" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula> for MuDCoD, and <inline-formula id="IE100"><mml:math id="IM100" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula> for PisCES. Our choice of PisCES and “static” to compare MuDCoD with is motivated by PisCES’s overall established advantages over the two additional methods that <xref rid="btad592-B16" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> (2018)</xref> had considered. Since Betzel-2019 has a different hyperparameter structure, we followed its default procedure, and provided the implementation details in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S3</xref>. To measure the similarity between the inferred and the ground truth gene communities of each method, we used the adjusted Rand index (ARI) (<xref rid="btad592-B11" ref-type="bibr">Hubert and Arabie 1985</xref>) as also used in <xref rid="btad592-B16" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> (2018)</xref>.</p>
      <p>We conducted simulations under the SoSS and SSoT settings of MuS-Dynamic-DCBM with 16 subjects and for <inline-formula id="IE101"><mml:math id="IM101" display="inline" overflow="scroll"><mml:mrow><mml:mi>T</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>8</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. The rest of the parameters were set as follows: network sizes <inline-formula id="IE102"><mml:math id="IM102" display="inline" overflow="scroll"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mn>500</mml:mn></mml:mrow></mml:math></inline-formula>, number of communities <inline-formula id="IE103"><mml:math id="IM103" display="inline" overflow="scroll"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>, in-cluster and out-cluster density parameters <inline-formula id="IE104"><mml:math id="IM104" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>in</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0.2</mml:mn><mml:mo>,</mml:mo><mml:mn>0.4</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE105"><mml:math id="IM105" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>out</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:mn>0.1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. We further considered varying <inline-formula id="IE106"><mml:math id="IM106" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>time</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE107"><mml:math id="IM107" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> levels. Here, <inline-formula id="IE108"><mml:math id="IM108" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>time</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the probability of a node changing its module label over two adjacent time points, and, similarly, <inline-formula id="IE109"><mml:math id="IM109" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the probability of a node changing its module label across two subjects. For example, setting <inline-formula id="IE110"><mml:math id="IM110" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> corresponds to the case where modules are similar across subjects, while <inline-formula id="IE111"><mml:math id="IM111" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> corresponds to the setting where the modules of the subjects vary considerably and do not share any signal. Similarly, <inline-formula id="IE112"><mml:math id="IM112" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>time</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE113"><mml:math id="IM113" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>time</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> yield constant and rapidly changing module labels across time, respectively. We conducted 100 simulation replicates and compared the methods based on the average ARI values over these replicates.</p>
      <p><xref rid="btad592-F3" ref-type="fig">Figure 3a</xref> and b summarizes the results of these two general settings. For both settings, as <inline-formula id="IE114"><mml:math id="IM114" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and/or <inline-formula id="IE115"><mml:math id="IM115" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>time</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> increases, ARIs of MuDCoD, PisCES, and Betzel-2019 tend to decrease and, eventually, MuDCoD and PisCES perform similarly to the baseline “static”. This immediate observation is expected because, as the community structures among the subjects and/or along the adjacent time points become more dissimilar, promoting information sharing across either dimension is no longer advantageous. Compared to other methods, performance of Betzel-2019 appears to be most sensitive against increasing <inline-formula id="IE116"><mml:math id="IM116" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE117"><mml:math id="IM117" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>time</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. For <inline-formula id="IE118"><mml:math id="IM118" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>≥</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math></inline-formula> and/or <inline-formula id="IE119"><mml:math id="IM119" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>time</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>≥</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math></inline-formula>, Betzel-2019 achieves ARI values that are even less than (up to 0.2 less) those of the baseline static spectral clustering, and results in ARI values &lt;0.2 when <inline-formula id="IE120"><mml:math id="IM120" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> and/or <inline-formula id="IE121"><mml:math id="IM121" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>time</mml:mtext><mml:mo>=</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula>.</p>
      <fig position="float" id="btad592-F3">
        <label>Figure 3.</label>
        <caption>
          <p>Evaluation of the identified communities under two different MuS-Dynamic-DCBM settings: (a) SSoS and (b) SSoT. The simulation parameters were set as follows: the network size is <inline-formula id="IE122"><mml:math id="IM122" display="inline" overflow="scroll"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mn>500</mml:mn></mml:mrow></mml:math></inline-formula>, the number of class labels <inline-formula id="IE123"><mml:math id="IM123" display="inline" overflow="scroll"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>, the in-cluster and out-cluster density parameters <inline-formula id="IE124"><mml:math id="IM124" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>in</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0.2</mml:mn><mml:mo>,</mml:mo><mml:mn>0.4</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE125"><mml:math id="IM125" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>out</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:mn>0.1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, number of subjects <inline-formula id="IE126"><mml:math id="IM126" display="inline" overflow="scroll"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math></inline-formula>, and the number of time points <inline-formula id="IE127"><mml:math id="IM127" display="inline" overflow="scroll"><mml:mrow><mml:mi>T</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>8</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. <italic toggle="yes">x</italic>-axis is the number of time points <italic toggle="yes">T</italic>, and <italic toggle="yes">y</italic>-axis is the mean ARI of the inferred modules for all subjects and time steps across 100 simulation replicates.</p>
        </caption>
        <graphic xlink:href="btad592f3" position="float"/>
      </fig>
      <p>For the SSoT setting, <xref rid="btad592-F3" ref-type="fig">Fig. 3b</xref> reveals that even for the case with the most module heterogeneity along the subject and time dimensions <inline-formula id="IE128"><mml:math id="IM128" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE129"><mml:math id="IM129" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>time</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, PisCES and MuDCoD perform slightly better than both “static” and Betzel-2019. MuDCoD consistently performs better when there are varying levels of information sharing among the subjects <inline-formula id="IE130"><mml:math id="IM130" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0.2</mml:mn><mml:mo>,</mml:mo><mml:mn>0.5</mml:mn><mml:mo>}</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and the modules are completely conserved across the time dimension <inline-formula id="IE131"><mml:math id="IM131" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>time</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, yielding more than <inline-formula id="IE132"><mml:math id="IM132" display="inline" overflow="scroll"><mml:mrow><mml:mn>20</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> increase in the ARI with <inline-formula id="IE133"><mml:math id="IM133" display="inline" overflow="scroll"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math></inline-formula>, compared to second best PisCES.</p>
      <p>For the SSoS setting, <xref rid="btad592-F3" ref-type="fig">Fig. 3a</xref> highlights MuDCoD as significantly outperforming other methods for relatively small <inline-formula id="IE134"><mml:math id="IM134" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> values, and performing robustly against increasing <inline-formula id="IE135"><mml:math id="IM135" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>time</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> values. For the <inline-formula id="IE136"><mml:math id="IM136" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula>, MuDCoD performs no worse than other methods, if not negligibly better. When <inline-formula id="IE137"><mml:math id="IM137" display="inline" overflow="scroll"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math></inline-formula>, the average increase in ARI is about <inline-formula id="IE138"><mml:math id="IM138" display="inline" overflow="scroll"><mml:mrow><mml:mn>20</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE139"><mml:math id="IM139" display="inline" overflow="scroll"><mml:mrow><mml:mn>8</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> for <inline-formula id="IE140"><mml:math id="IM140" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE141"><mml:math id="IM141" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math></inline-formula>, respectively. The mean ARI increase is markedly high for some settings. For example, when <inline-formula id="IE142"><mml:math id="IM142" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE143"><mml:math id="IM143" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>time</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math></inline-formula>, increase in the mean ARI reaches to almost <inline-formula id="IE144"><mml:math id="IM144" display="inline" overflow="scroll"><mml:mrow><mml:mn>30</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> with <inline-formula id="IE145"><mml:math id="IM145" display="inline" overflow="scroll"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math></inline-formula>. Even with an extreme value of <inline-formula id="IE146"><mml:math id="IM146" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula>, which corresponds to high levels of heterogeneity between the subject modules, MuDCoD performs again at least as well as the other methods. PisCES and MuDCoD exhibit increasing performances as <italic toggle="yes">T</italic> increases, supporting the merits of information sharing across the time dimension. In contrast to PisCES and MuDCoD, Betzel-2019 appears to only benefit from increasing the time horizon when <inline-formula id="IE147"><mml:math id="IM147" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE148"><mml:math id="IM148" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> are both set to zero.</p>
    </sec>
    <sec>
      <title>4.2 Application of MuDCoD to discover multi-subject dynamic gene communities</title>
      <sec>
        <title>4.2.1 Analysis of <xref rid="btad592-B10" ref-type="bibr">HipSci Consortium <italic toggle="yes">et al.</italic> (2021)</xref> dataset</title>
        <p>We next applied MuDCoD along with PisCES and static spectral clustering to discover personalized gene communities from the scRNA-seq data of human-induced pluripotent stem cells (<xref rid="btad592-B10" ref-type="bibr">HipSci Consortium <italic toggle="yes">et al.</italic> 2021</xref>). We specifically focused on cell types DA (16 donors, 1955 retained genes), Sert (22 donors and 2234 retained genes) and Epen1 (8 donors and 2475 retained genes) on days 30 and 52. Inferred communities varied in their sizes and densities (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>). Overall, the typical runtimes of MuDCoD and PisCES were comparable, ranging between 30 min and 1.5 h for about 2000 genes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Section S7</xref>).</p>
        <p>MuDCoD promotes the smoothness of spectral representations over donors within a time point; therefore, we would expect the gene modules across donors within a time point to be more similar to each other compared to PisCES and static spectral clustering, which treat each donor separately. We assessed to what extent this was realized in this application by calculating the normalized mutual information (NMI) scores (<xref rid="btad592-B24" ref-type="bibr">Strehl and Ghosh 2003</xref>) among the discovered gene modules of the donors at each time point. <xref rid="btad592-F4" ref-type="fig">Figure 4a</xref> and b displays the histograms of NMI scores between every pair of donors on day-30 and day-52. First, we observe that MuDCoD and PisCES infer gene modules that are more similar to each other across subjects, compared to static spectral clustering. Between MuDCoD and PisCES, MuDCoD tends to yield higher, but not statistically significant, NMI scores between donors on day-30 (<xref rid="btad592-F4" ref-type="fig">Fig. 4a</xref>) and it leads to significantly higher scores at day-52 (<xref rid="btad592-F4" ref-type="fig">Fig. 4b</xref>, Wilcoxon rank-sum test <italic toggle="yes">P</italic>-value of 0.0003), highlighting the impact of information sharing across the donors. Furthermore, this does not incur at the cost of additional smoothing over the time domain, as MuDCoD identified communities of donors display a level of heterogeneity comparable to those of PisCES across the time points (<xref rid="btad592-F4" ref-type="fig">Fig. 4c</xref>).</p>
        <fig position="float" id="btad592-F4">
          <label>Figure 4.</label>
          <caption>
            <p>NMI scores between inferred gene modules of donor and time point pairs aggregated across all cell types. (a) and (b) quantify NMI scores between modules of every pair of donors on day-30 and day-52, respectively. (c) displays NMI scores between inferred gene modules of each donor on day-30 and on day-52. The <italic toggle="yes">y</italic>-axis denotes the percentage of donor pairs.</p>
          </caption>
          <graphic xlink:href="btad592f4" position="float"/>
        </fig>
        <p>Following these general observations, we investigated the biological implications of MuDCoD results. To elucidate the biological processes that the modules might be involved in, we conducted gene set enrichment analysis of the discovered modules of each donor at each time point with <monospace>clusterProfiler</monospace> (<xref rid="btad592-B30" ref-type="bibr">Yu <italic toggle="yes">et al.</italic> 2012</xref>), with an emphasis on the Gene Ontology (GO) biological processes. We only focused on the communities with sizes larger than 20. Our analysis limited the background gene sets in <monospace>clusterProfiler</monospace> to only those genes that were used in the construction of the adjacency matrices and used the Benjamini-Hochberg procedure (<xref rid="btad592-B2" ref-type="bibr">Benjamini and Hochberg 1995</xref>) for false discovery rate (FDR) control at 0.05. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S3</xref> highlights that some general biological processes, e.g. general cell-cycle and cell division-related processes, are enriched across the communities of all donors. In addition, we also observe processes specific to subsets of donors, highlighting the personalized nature of the communities.</p>
        <p>Next, to further explore the utility of our results, we leveraged the grouping of the donors based on the differentiation efficiency of their cells during dopaminergic neuron differentiation, as defined in <xref rid="btad592-B10" ref-type="bibr">HipSci Consortium <italic toggle="yes">et al.</italic> (2021)</xref>. We specifically assessed whether donors with low and high differentiation efficiency exhibited varying levels of similarity among their modules inferred at different time points. <xref rid="btad592-F5" ref-type="fig">Figure 5a</xref> displays the NMI scores between the inferred modules of day-30 and day-52 for each donor, and suggests that donors with lower differentiation efficiency tend to have higher levels of similarity among their gene communities inferred at the two-time points (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S8a and S9a</xref> for qualitatively similar results of PisCES and static spectral clustering). We then focused on cell type Epen1, which is not used in the definition of differentiation efficiency by <xref rid="btad592-B10" ref-type="bibr">HipSci Consortium <italic toggle="yes">et al.</italic> (2021)</xref>, and asked whether differences in the donor-specific communities are associated with the differentiation efficiency. This resulted in markedly higher module similarity within each group (i.e. high versus low differentiation efficiency) and lower across groups (<xref rid="btad592-F5" ref-type="fig">Fig. 5b</xref>). We observed similar trends with PisCES and static spectral clustering (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S8b and S9b</xref>). Furthermore, consistent with the differentiation dynamics (<xref rid="btad592-B10" ref-type="bibr">HipSci Consortium <italic toggle="yes">et al.</italic> 2021</xref>), we also observed relatively higher heterogeneity within the high group compared to the low group. Collectively, these observations support that personalized modules inferred by MuDCoD recapitulate the underlying differentiation efficiencies of donor iPS cells.</p>
        <fig position="float" id="btad592-F5">
          <label>Figure 5.</label>
          <caption>
            <p>(a) NMI scores of each donor between the MuDCoD inferred modules on day-30 and on day-52 against the differentiation efficiency. For each cell type (DA, Sert, Epen1), each donor’s modules from day-30 and day-52 were compared with NMI and plotted against donor’s differentiation efficiency. (b) Comparison of the mean NMI scores within and between the low and high differentiation efficiency groups of Epen1 cells. Donor labels for differentiation efficiency were obtained from <xref rid="btad592-B10" ref-type="bibr">HipSci Consortium <italic toggle="yes">et al.</italic> (2021)</xref>. NMI scores between pairs of donors are calculated based on their MuDCoD inferred modules. Differentiation efficiency groups were generated based on the percentiles of differentiation efficiency values across the donors, i.e. 50-th percentile (inclusive) corresponds to the low differentiation efficiency group.</p>
          </caption>
          <graphic xlink:href="btad592f5" position="float"/>
        </fig>
      </sec>
      <sec>
        <title>4.2.2 Analysis of <xref rid="btad592-B23" ref-type="bibr">Soskic <italic toggle="yes">et al.</italic> (2022)</xref> dataset</title>
        <p>We applied MuDCoD along with PisCES and static spectral clustering to discover dynamic gene modules from the scRNA-seq data of CD4<inline-formula id="IE149"><mml:math id="IM149" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> T cell activation (<xref rid="btad592-B23" ref-type="bibr">Soskic <italic toggle="yes">et al.</italic> 2022</xref>). This dataset includes both memory and naive CD4<inline-formula id="IE150"><mml:math id="IM150" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> T cells isolated from peripheral blood. We focused on Naive CD4<inline-formula id="IE151"><mml:math id="IM151" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> T cells, which have not yet encountered an antigen. The entire dataset captures transcriptional states of unstimulated cells (0-h) and three time points (16-h, 40-h, and 5-days after the stimulation) of cell activation in 79 healthy donors, and 408 retained genes, as described in Section 3.2.2. <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref> reports characteristics of inferred communitites at different time points. Similar to Jerber-2021, the typical runtimes of MuDCoD and PisCES in this dataset were comparable, usually ranging between 20 min and 1 h (<xref rid="sup1" ref-type="supplementary-material">Supplementary Section S7</xref>).</p>
        <p>Similar to the analysis of <xref rid="btad592-B10" ref-type="bibr">HipSci Consortium <italic toggle="yes">et al.</italic> (2021)</xref> dataset, we first evaluated to what extent MuDCoD promoted smoothness of spectral representations among donors within a time point compared to PisCES by leveraging the NMI scores. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4</xref> displays the histograms of NMI scores between all possible pairs of donors at time points 0-h, 16-h, 40-h, and 5-days for modules inferred by MuDCoD, PisCES and static spectral clustering. Consistent with our expectation, MuDCoD tends to yield higher NMI scores (one-sided Wilcoxon rank-sum test <italic toggle="yes">P</italic>-values of 0.0003, 0.01, and 0.00019, respectively, for the time points 0-h, 16-h, and 5-days). The higher similarities among the gene modules across donors highlight the impact of information sharing across the donors at fixed time points.</p>
        <p>Next, we assessed how the similarities between donors change as donor cells respond to stimulation over time. Specifically, we computed the mean NMI scores between each donor and the rest of the donors at all four time points separately. <xref rid="btad592-F6" ref-type="fig">Figure 6a</xref> displays mean NMI scores that range between 0.05 and 0.2 across the time points. This comparison reveals that the inferred community structures of donors tend to be more similar at 16-h after stimulation, as evidenced by the significant <italic toggle="yes">P</italic>-values (≤0.05) of the one-sided Wilcoxon rank sum tests comparing mean NMI scores at 16-h with those at other time points. We note that 16-h corresponds to the first measurement of gene expression right after stimulation of the T cells and before the first cell division. Hence, the increased similarity across donors may correspond to the concerted activity of T cell activation related genes and pathways. Analysis of PisCES and static spectral clustering output led to qualitatively similar results (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S10A and S11A</xref>).</p>
        <fig position="float" id="btad592-F6">
          <label>Figure 6.</label>
          <caption>
            <p>(a) Normalized mutual information scores between pairs of donors based on their gene modules inferred by MuDCoD at each time point. Each data point stands for a donor, and the <italic toggle="yes">y</italic>-axis denotes the mean of NMI scores between that donor and other donors at the corresponding time point. All the statistically significant comparisons with time point 16-h from the one-sided Wilcoxon rank-sum test are marked (with <italic toggle="yes">P</italic>-value≤0.05), *** and **** stand for <italic toggle="yes">P</italic>-value≤0.001 and <italic toggle="yes">P</italic>-value≤0.0001, respectively. (b) Set of top fifteen frequent significantly enriched biological processes (with the adjusted <italic toggle="yes">P</italic>-values <inline-formula id="IE153"><mml:math id="IM153" display="inline" overflow="scroll"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>) of most prioritized communities contributed by each donor at different time points. Overall, <inline-formula id="IE154"><mml:math id="IM154" display="inline" overflow="scroll"><mml:mrow><mml:mn>79</mml:mn><mml:mo>×</mml:mo><mml:mn>4</mml:mn><mml:mo>=</mml:mo><mml:mn>316</mml:mn></mml:mrow></mml:math></inline-formula> gene sets were contributed by 79 donors at 4 time points, and correspondingly, 316 separate enrichment analyses were performed. Displayed are significant biological processes, their corresponding number of appearances in the most prioritized communities of donors, and the minimum <italic toggle="yes">P</italic>-values of enrichment among those communities.</p>
          </caption>
          <graphic xlink:href="btad592f6" position="float"/>
        </fig>
        <p>Following these general observations, we investigated the biological implications of MuDCoD results. MuDCoD fully partitions genes into modules. However, not all gene modules are necessarily interesting or biologically relevant. Furthermore, due to dropouts in scRNA-seq data, it is likely that only a small number of the inferred communities are biologically relevant (i.e. prioritized communities) and should be subject to further interpretation. We utilized CRank (<xref rid="btad592-B32" ref-type="bibr">Zitnik <italic toggle="yes">et al.</italic> 2018</xref>) to rank the resulting communities. Specifically, we ranked inferred communities of each donor’s network and identified the one with the highest rank, i.e. the most prioritized community. In the case of ties in CRank scores, we prioritized the larger community. This prioritization resulted in <inline-formula id="IE155"><mml:math id="IM155" display="inline" overflow="scroll"><mml:mrow><mml:mn>79</mml:mn><mml:mo>×</mml:mo><mml:mn>4</mml:mn><mml:mo>=</mml:mo><mml:mn>316</mml:mn></mml:mrow></mml:math></inline-formula> gene sets when aggregated across donors and time points. Next, we conducted gene set enrichment analysis with GO biological processes for each of the prioritized modules using <monospace>clusterProfiler</monospace> (<xref rid="btad592-B30" ref-type="bibr">Yu <italic toggle="yes">et al.</italic> 2012</xref>). In order to summarize and elucidate the underlying biological processes at each time point, we calculated the frequencies of significant GO terms [FDR control at level 0.05 with the Benjamini-Hochberg procedure (<xref rid="btad592-B2" ref-type="bibr">Benjamini and Hochberg 1995</xref>) at each time point]. <xref rid="btad592-F6" ref-type="fig">Figure 6b</xref> displays the top 15 most frequently enriched GO terms at each time point, along with their frequencies (i.e. number of appearances across donors) and minimum adjusted <italic toggle="yes">P</italic>-values across the donors (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S10B and S11B</xref> for PisCES and statistc spectral clustering, respectively). Time point specific enriched biological processes appear consistent with the mechanisms governing CD4<inline-formula id="IE156"><mml:math id="IM156" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> T cell activation (<xref rid="btad592-B12" ref-type="bibr">Hwang <italic toggle="yes">et al.</italic> 2020</xref>). For example, positive regulation of T cell activation is among the top 15 most frequent terms only at 16-h and 40-h after stimulation, and we start to observe positive regulation of cytokine production more frequently at 40-h after stimulation. While these results require further analysis to reveal more detailed biological insights, MuDCoD successfully highlights how multi-subject module detection promoting module smoothness over the subject and time dimensions can yield gene modules that associate with specific biological conditions and phenotypes.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>5 Conclusion</title>
    <p>As advances in single-cell profiling technologies allow charting transcriptomes of individuals at unprecedented resolutions across developmental and cellular stages, analysis of personalized dynamic gene networks is poised to emerge as a critical tool for elucidating network-level variations among subjects to explain phenotypic variation. In this work, we developed a global spectral clustering framework that promotes information sharing among subjects and adjacent time points. MuDCoD utilizes co-expression networks to infer co-expression modules and can be effectively combined with any co-expression network construction method. For population-scale scRNA-seq data, we recommend using Dozer (<xref rid="btad592-B17" ref-type="bibr">Lu and Keleş 2023</xref>), which uses a Poisson measurement error model to handle sparsity and correct gene pair correlation biases. In addition, thresholding the subject-specific co-expression networks to obtain adjacency matrices should also be tailored by taking into account the gene–gene correlation distribution characteristics of the datasets. Recent developments in testing of gene–gene correlations, like CS-CORE (<xref rid="btad592-B25" ref-type="bibr">Su <italic toggle="yes">et al.</italic> 2022</xref>), offer potential insights into binarizing co-expression networks.</p>
    <p>Our simulation experiments highlighted the superior performance of MuDCoD over existing alternatives. Applications to two population-scale scRNA-seq datasets revealed that MuDCoD infers biologically meaningful and relevant communities in multi-subject dynamic scRNA-seq datasets. While our current framework encourages information sharing among all subjects, it can be extended to accommodate groupings among subjects where the communities are persistent only within the group members. Such an extension could be useful, especially when an apparent grouping such as healthy versus diseased subjects exists in the dataset. Finally, we expect this multi-subject setting to be useful in other domains to infer network community structures with the availability of multiple samples.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad592_Supplementary_Data</label>
      <media xlink:href="btad592_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by National Institutes of Health (NIH) grant HG003747 and a Chan Zuckerberg Initiative (CZI) Single Cell Data Insights grant to S.K.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data Availability</title>
    <p>MuDCoD is implemented in Python, the source code and the sripts used to conduct experiments are available at <ext-link xlink:href="https://github.com/bo1929/MuDCoD" ext-link-type="uri">https://github.com/bo1929/MuDCoD</ext-link>. The datasets were derived from <xref rid="btad592-B10" ref-type="bibr">Jerber <italic toggle="yes">et al.</italic> 2021</xref> and<xref rid="btad592-B23" ref-type="bibr"> Soskic <italic toggle="yes">et al.</italic> 2022</xref>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad592-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bassett</surname><given-names>DS</given-names></string-name>, <string-name><surname>Porter</surname><given-names>MA</given-names></string-name>, <string-name><surname>Wymbs</surname><given-names>NF</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Robust detection of dynamic community structure in networks</article-title>. <source>Chaos</source>  <year>2013</year>;<volume>23</volume>:<fpage>013142</fpage>.<pub-id pub-id-type="pmid">23556979</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Benjamini</surname><given-names>Y</given-names></string-name>, <string-name><surname>Hochberg</surname><given-names>Y.</given-names></string-name></person-group>  <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>. <source>J R Stat Soc Ser B (Methodological)</source>  <year>1995</year>;<volume>57</volume>:<fpage>289</fpage>–<lpage>300</lpage>.</mixed-citation>
    </ref>
    <ref id="btad592-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Betzel</surname><given-names>RF</given-names></string-name>, <string-name><surname>Bertolero</surname><given-names>MA</given-names></string-name>, <string-name><surname>Gordon</surname><given-names>EM</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>The community structure of functional brain networks exhibits scale-specific patterns of inter- and intra-subject variability</article-title>. <source>Neuroimage</source>  <year>2019</year>;<volume>202</volume>:<fpage>115990</fpage>.<pub-id pub-id-type="pmid">31291606</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>Y-JJ</given-names></string-name>, <string-name><surname>Friedman</surname><given-names>BA</given-names></string-name>, <string-name><surname>Ha</surname><given-names>C</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Single-cell RNA sequencing identifies distinct mouse medial ganglionic eminence cell types</article-title>. <source>Sci Rep</source>  <year>2017</year>;<volume>7</volume>:<fpage>45656</fpage>.<pub-id pub-id-type="pmid">28361918</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chi</surname><given-names>Y</given-names></string-name>, <string-name><surname>Song</surname><given-names>X</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>D</given-names></string-name></person-group> <italic toggle="yes">et al.</italic> Evolutionary spectral clustering by incorporating temporal smoothness. In: <italic toggle="yes">Proceedings of the 13th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</italic>. New York, Association for Computing Machinery, <volume>2007</volume>, <fpage>153</fpage>–<lpage>62</lpage>.</mixed-citation>
    </ref>
    <ref id="btad592-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cribben</surname><given-names>I</given-names></string-name>, <string-name><surname>Yu</surname><given-names>Y.</given-names></string-name></person-group>  <article-title>Estimating whole-brain dynamics by using spectral clustering</article-title>. <source>J R Stat Soc Ser C (Appl Stat)</source>  <year>2017</year>;<volume>66</volume>:<fpage>607</fpage>–<lpage>27</lpage>.</mixed-citation>
    </ref>
    <ref id="btad592-B9">
      <mixed-citation publication-type="journal">Cuomo ASE, Seaton DD, McCarthy DJ <italic toggle="yes">et al</italic>. <article-title>Single-cell RNA-sequencing of differentiating iPS cells reveals dynamic genetic effects on gene expression</article-title>. <source>Nat Commun</source>  <year>2020</year>;<volume>11</volume>:<fpage>810</fpage>.<pub-id pub-id-type="pmid">32041960</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dai</surname><given-names>H</given-names></string-name>, <string-name><surname>Li</surname><given-names>L</given-names></string-name>, <string-name><surname>Zeng</surname><given-names>T</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Cell-specific network constructed by single-cell RNA sequencing data</article-title>. <source>Nucleic Acids Res</source>  <year>2019</year>;<volume>47</volume>:<fpage>e62</fpage>.<pub-id pub-id-type="pmid">30864667</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hafemeister</surname><given-names>C</given-names></string-name>, <string-name><surname>Satija</surname><given-names>R.</given-names></string-name></person-group>  <article-title>Normalization and variance stabilization of single-cell RNA-seq data using regularized negative binomial regression</article-title>. <source>Genome Biol</source>  <year>2019</year>;<volume>20</volume>:<fpage>296</fpage>.<pub-id pub-id-type="pmid">31870423</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hubert</surname><given-names>L</given-names></string-name>, <string-name><surname>Arabie</surname><given-names>P.</given-names></string-name></person-group>  <article-title>Comparing partitions</article-title>. <source>J Classif</source>  <year>1985</year>;<volume>2</volume>:<fpage>193</fpage>–<lpage>218</lpage>.</mixed-citation>
    </ref>
    <ref id="btad592-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hwang</surname><given-names>J-R</given-names></string-name>, <string-name><surname>Byeon</surname><given-names>Y</given-names></string-name>, <string-name><surname>Kim</surname><given-names>D</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Recent insights of T cell receptor-mediated signaling pathways for T cell activation and development</article-title>. <source>Exp Mol Med</source>  <year>2020</year>;<volume>52</volume>:<fpage>750</fpage>–<lpage>61</lpage>.<pub-id pub-id-type="pmid">32439954</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Iacono</surname><given-names>G</given-names></string-name>, <string-name><surname>Massoni-Badosa</surname><given-names>R</given-names></string-name>, <string-name><surname>Heyn</surname><given-names>H</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Single-cell transcriptomics unveils gene regulatory network plasticity</article-title>. <source>Genome Biol</source>  <year>2019</year>;<volume>20</volume>:<fpage>110</fpage>–<lpage>20</lpage>.<pub-id pub-id-type="pmid">31159854</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jackson</surname><given-names>CA</given-names></string-name>, <string-name><surname>Castro</surname><given-names>DM</given-names></string-name>, <string-name><surname>Saldi</surname><given-names>G-A</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Gene regulatory network reconstruction using single-cell RNA sequencing of barcoded genotypes in diverse environments</article-title>. <source>Elife</source>  <year>2020</year>;<volume>9</volume>:<fpage>e51254</fpage>.<pub-id pub-id-type="pmid">31985403</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jerber</surname><given-names>J</given-names></string-name>, <string-name><surname>Seaton</surname><given-names>DD</given-names></string-name>, <string-name><surname>Cuomo</surname><given-names>ASE</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Population-scale single-cell RNA-seq profiling across dopaminergic neuron differentiation</article-title>. <source>Nat Genet</source>  <year>2021</year>;<volume>53</volume>:<fpage>304</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">33664506</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>T</given-names></string-name>, <string-name><surname>Levina</surname><given-names>E</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>J</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Network cross-validation by edge sampling</article-title>. <source>Biometrika</source>  <year>2020</year>;<volume>107</volume>:<fpage>257</fpage>–<lpage>76</lpage>.</mixed-citation>
    </ref>
    <ref id="btad592-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>F</given-names></string-name>, <string-name><surname>Choi</surname><given-names>D</given-names></string-name>, <string-name><surname>Xie</surname><given-names>L</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Global spectral clustering in dynamic networks</article-title>. <source>Proc Natl Acad Sci USA</source>  <year>2018</year>;<volume>115</volume>:<fpage>927</fpage>–<lpage>32</lpage>.<pub-id pub-id-type="pmid">29339482</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lu</surname><given-names>S</given-names></string-name>, <string-name><surname>Keleş</surname><given-names>S.</given-names></string-name></person-group>  <article-title>Debiased personalized gene coexpression networks for population-scale scRNA-seq data</article-title>. <source>Genome Res</source>  <year>2023</year>;<volume>33</volume>:<fpage>932</fpage>–<lpage>47</lpage>.<pub-id pub-id-type="pmid">37295843</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>X</given-names></string-name>, <string-name><surname>Li</surname><given-names>D</given-names></string-name>, <string-name><surname>Tan</surname><given-names>S</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Detecting evolving communities in dynamic networks using graph regularized evolutionary nonnegative matrix factorization</article-title>. <source>Phys A Stat Mech Its Appl</source>  <year>2019</year>;<volume>530</volume>:<fpage>121279</fpage>.</mixed-citation>
    </ref>
    <ref id="btad592-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mathys</surname><given-names>H</given-names></string-name>, <string-name><surname>Davila-Velderrain</surname><given-names>J</given-names></string-name>, <string-name><surname>Peng</surname><given-names>Z</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Single-cell transcriptomic analysis of Alzheimer’s disease</article-title>. <source>Nature</source>  <year>2019</year>;<volume>570</volume>:<fpage>332</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">31042697</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Matias</surname><given-names>C</given-names></string-name>, <string-name><surname>Miele</surname><given-names>V.</given-names></string-name></person-group>  <article-title>Statistical clustering of temporal networks through a dynamic stochastic block model</article-title>. <source>J R Stat Soc Ser B</source>  <year>2017</year>;<volume>79</volume>:<fpage>1119</fpage>–<lpage>41</lpage>.</mixed-citation>
    </ref>
    <ref id="btad592-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Norman</surname><given-names>U</given-names></string-name>, <string-name><surname>Cicek</surname><given-names>AE.</given-names></string-name></person-group>  <article-title>ST-Steiner: a spatio-temporal gene discovery algorithm</article-title>. <source>Bioinformatics</source>  <year>2019</year>;<volume>35</volume>:<fpage>3433</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">30759247</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shen</surname><given-names>H-W</given-names></string-name>, <string-name><surname>Cheng</surname><given-names>X-Q.</given-names></string-name></person-group>  <article-title>Spectral methods for the detection of network community structure: a comparative analysis</article-title>. <source>J Stat Mech</source>  <year>2010</year>;<volume>2010</volume>:<fpage>P10020</fpage>.</mixed-citation>
    </ref>
    <ref id="btad592-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Soskic</surname><given-names>B</given-names></string-name>, <string-name><surname>Cano-Gamez</surname><given-names>E</given-names></string-name>, <string-name><surname>Smyth</surname><given-names>DJ</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Immune disease risk variants regulate gene expression dynamics during CD4+ T cell activation</article-title>. <source>Nat Genet</source>  <year>2022</year>;<volume>54</volume>:<fpage>817</fpage>–<lpage>26</lpage>.<pub-id pub-id-type="pmid">35618845</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Strehl</surname><given-names>A</given-names></string-name>, <string-name><surname>Ghosh</surname><given-names>J.</given-names></string-name></person-group>  <article-title>Cluster ensembles—a knowledge reuse framework for combining multiple partitions</article-title>. <source>J Mach Learn Res</source>  <year>2003</year>;<volume>3</volume>:<fpage>583</fpage>–<lpage>617</lpage>.</mixed-citation>
    </ref>
    <ref id="btad592-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Su</surname><given-names>C</given-names></string-name>, <string-name><surname>Xu</surname><given-names>Z</given-names></string-name>, <string-name><surname>Shan</surname><given-names>X</given-names></string-name></person-group>  <etal>et al</etal> Cell-type-specific co-expression inference from single cell RNA-sequencing data. <italic toggle="yes">Nat Commun</italic> 2023;<volume>14</volume>:4846.</mixed-citation>
    </ref>
    <ref id="btad592-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ting</surname><given-names>C-M</given-names></string-name>, <string-name><surname>Samdin</surname><given-names>SB</given-names></string-name>, <string-name><surname>Tang</surname><given-names>M</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Detecting dynamic community structure in functional brain networks across individuals: a multilayer approach</article-title>. <source>IEEE Trans Med Imaging</source>  <year>2021</year>;<volume>40</volume>:<fpage>468</fpage>–<lpage>80</lpage>.<pub-id pub-id-type="pmid">33044929</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Travaglini</surname><given-names>KJ</given-names></string-name>, <string-name><surname>Nabhan</surname><given-names>AN</given-names></string-name>, <string-name><surname>Penland</surname><given-names>L</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>A molecular cell atlas of the human lung from single-cell RNA sequencing</article-title>. <source>Nature</source>  <year>2020</year>;<volume>587</volume>:<fpage>619</fpage>–<lpage>25</lpage>.<pub-id pub-id-type="pmid">33208946</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B28">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Xu</surname><given-names>KS</given-names></string-name>, <string-name><surname>Hero</surname><given-names>AO.</given-names></string-name></person-group>  <part-title>Dynamic stochastic blockmodels: statistical models for time-evolving networks</part-title>. In: <person-group person-group-type="editor"><string-name><surname>Greenberg</surname><given-names>AM</given-names></string-name>, <string-name><surname>Kennedy</surname><given-names>WG</given-names></string-name>, <string-name><surname>Bos</surname><given-names>ND</given-names></string-name></person-group> (eds.), <source>Social Computing, Behavioral-Cultural Modeling and Prediction, Lecture Notes in Computer Science</source>. <publisher-loc>Berlin, Heidelberg</publisher-loc>: <publisher-name>Springer</publisher-name>, <year>2013</year>, <fpage>201</fpage>–<lpage>10</lpage>.</mixed-citation>
    </ref>
    <ref id="btad592-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xu</surname><given-names>KS</given-names></string-name>, <string-name><surname>Hero</surname><given-names>AO.</given-names></string-name></person-group>  <article-title>Dynamic stochastic blockmodels for time-evolving social networks</article-title>. <source>IEEE J Sel Top Signal Process</source>  <year>2014</year>;<volume>8</volume>:<fpage>552</fpage>–<lpage>62</lpage>.</mixed-citation>
    </ref>
    <ref id="btad592-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yu</surname><given-names>G</given-names></string-name>, <string-name><surname>Wang</surname><given-names>L-G</given-names></string-name>, <string-name><surname>Han</surname><given-names>Y</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>clusterProfiler: an R package for comparing biological themes among gene clusters</article-title>. <source>OMICS</source>  <year>2012</year>;<volume>16</volume>:<fpage>284</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">22455463</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zeisel</surname><given-names>A</given-names></string-name>, <string-name><surname>Muñoz-Manchado</surname><given-names>AB</given-names></string-name>, <string-name><surname>Codeluppi</surname><given-names>S</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq</article-title>. <source>Science</source>  <year>2015</year>;<volume>347</volume>:<fpage>1138</fpage>–<lpage>42</lpage>.<pub-id pub-id-type="pmid">25700174</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zitnik</surname><given-names>M</given-names></string-name>, <string-name><surname>Sosič</surname><given-names>R</given-names></string-name>, <string-name><surname>Leskovec</surname><given-names>J</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Prioritizing network communities</article-title>. <source>Nat Commun</source>  <year>2018</year>;<volume>9</volume>:<fpage>2544</fpage>.<pub-id pub-id-type="pmid">29959323</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10564618</article-id>
    <article-id pub-id-type="pmid">37740957</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad592</article-id>
    <article-id pub-id-type="publisher-id">btad592</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Systems Biology</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MuDCoD: multi-subject community detection in personalized dynamic gene networks from single-cell RNA sequencing</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4396-817X</contrib-id>
        <name>
          <surname>Şapcı</surname>
          <given-names>Ali Osman Berk</given-names>
        </name>
        <aff><institution>Bioinformatics and Systems Biology Graduate Program, University of California San Diego</institution>, La Jolla, CA 92093, <country country="US">United States</country></aff>
        <aff><institution>Faculty of Engineering and Natural Sciences, Sabancı University</institution>, Istanbul 34956, <country country="TR">Turkey</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lu</surname>
          <given-names>Shan</given-names>
        </name>
        <aff><institution>Department of Statistics, University of Wisconsin-Madison</institution>, Madison, WI 53706, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yan</surname>
          <given-names>Shuchen</given-names>
        </name>
        <aff><institution>Department of Statistics, University of Wisconsin-Madison</institution>, Madison, WI 53706, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0708-6914</contrib-id>
        <name>
          <surname>Ay</surname>
          <given-names>Ferhat</given-names>
        </name>
        <aff><institution>Department of Pediatrics, University of California San Diego</institution>, La Jolla, CA 92093, <country country="US">United States</country></aff>
        <aff><institution>Centers for Autoimmunity, Inflammation and Cancer Immunotherapy, La Jolla Institute for Immunology</institution>, La Jolla, CA 92037, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7058-5372</contrib-id>
        <name>
          <surname>Tastan</surname>
          <given-names>Oznur</given-names>
        </name>
        <aff><institution>Faculty of Engineering and Natural Sciences, Sabancı University</institution>, Istanbul 34956, <country country="TR">Turkey</country></aff>
        <xref rid="btad592-cor1" ref-type="corresp"/>
        <!--otastan@sabanciuniv.edu-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Keleş</surname>
          <given-names>Sündüz</given-names>
        </name>
        <aff><institution>Department of Statistics, University of Wisconsin-Madison</institution>, Madison, WI 53706, <country country="US">United States</country></aff>
        <aff><institution>Department of Biostatistics and Medical Informatics, University of Wisconsin-Madison</institution>, Madison, WI 53706, <country country="US">United States</country></aff>
        <xref rid="btad592-cor1" ref-type="corresp"/>
        <!--keles@stat.wisc.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kendziorski</surname>
          <given-names>Christina</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad592-cor1">Corresponding authors. Department of Statistics, University of Wisconsin-Madison, Madison, WI 53706, United States. E-mail: <email>keles@stat.wisc.edu</email> (S.K.); Faculty of Engineering and Natural Sciences, Sabancı University, Istanbul 34956, Turkey. E-mail: <email>otastan@sabanciuniv.edu</email> (O.T.) </corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>10</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-09-23">
      <day>23</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>10</issue>
    <elocation-id>btad592</elocation-id>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>24</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>17</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>10</day>
        <month>10</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad592.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>With the wide availability of single-cell RNA-seq (scRNA-seq) technology, population-scale scRNA-seq datasets across multiple individuals and time points are emerging. While the initial investigations of these datasets tend to focus on standard analysis of clustering and differential expression, leveraging the power of scRNA-seq data at the personalized dynamic gene co-expression network level has the potential to unlock subject and/or time-specific network-level variation, which is critical for understanding phenotypic differences. Community detection from co-expression networks of multiple time points or conditions has been well-studied; however, none of the existing settings included networks from multiple subjects and multiple time points simultaneously. To address this, we develop <bold>Mu</bold>lti-subject <bold>D</bold>ynamic <bold>Co</bold>mmunity <bold>D</bold>etection (MuDCoD) for multi-subject community detection in personalized dynamic gene networks from scRNA-seq. MuDCoD builds on the spectral clustering framework and promotes information sharing among the networks of the subjects as well as networks at different time points. It clusters genes in the personalized dynamic gene networks and reveals gene communities that are variable or shared not only across time but also among subjects.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Evaluation and benchmarking of MuDCoD against existing approaches reveal that MuDCoD effectively leverages apparent shared signals among networks of the subjects at individual time points, and performs robustly when there is no or little information sharing among the networks. Applications to population-scale scRNA-seq datasets of human-induced pluripotent stem cells during dopaminergic neuron differentiation and CD4<inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> T cell activation indicate that MuDCoD enables robust inference for identifying time-varying personalized gene modules. Our results illustrate how personalized dynamic community detection can aid in the exploration of subject-specific biological processes that vary across time.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>MuDCoD is publicly available at <ext-link xlink:href="https://github.com/bo1929/MuDCoD" ext-link-type="uri">https://github.com/bo1929/MuDCoD</ext-link> as a Python package. Implementation includes simulation and real-data experiments together with extensive documentation.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>HG003747</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Chan Zuckerberg Initiative</institution>
            <institution-id institution-id-type="DOI">10.13039/100014989</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The advent of single-cell RNA sequencing (scRNA-seq) has provided unparalleled insights into the transcriptional programs of different cell types and cellular stages at the individual cell level (<xref rid="btad592-B31" ref-type="bibr">Zeisel <italic toggle="yes">et al.</italic> 2015</xref>, <xref rid="btad592-B4" ref-type="bibr">Chen <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btad592-B27" ref-type="bibr">Travaglini <italic toggle="yes">et al.</italic> 2020</xref>). Population-scale scRNA-seq datasets across multiple individuals and time points are becoming increasingly available (<xref rid="btad592-B19" ref-type="bibr">Mathys <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad592-B9" ref-type="bibr">HipSci Consortium <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad592-B10" ref-type="bibr">2021</xref>, <xref rid="btad592-B23" ref-type="bibr">Soskic <italic toggle="yes">et al.</italic> 2022</xref>). These datasets make it possible to construct personalized, i.e. subject-specific, dynamic gene networks that vary across individuals and across time. Community structures emerge in these dynamic networks when there is strong local clustering of genes that are synchronized to function together. Unraveling the differentiation dynamics or deciphering pathways affected in various diseases requires discovering which genes cooperate in specific cellular processes. Thus, a key inference from the analysis of gene networks is detecting time/condition-varying gene modules that might correspond to genes cooperating in various biological processes. While these modules change over time due to the dynamic nature of the relations among the genes in the processes, they may also vary among different subjects. Variation and similarity among subjects at the network-level, when combined with subject-level phenotype information, can reveal critical information such as differential dynamics of the gene modules driving specific phenotypes. Thus, identifying gene modules by taking into account multiple subjects at once is of paramount importance.</p>
    <p>Gene module detection methods for scRNA-seq data have mostly focused on the construction of static gene networks that capture a snapshot of time or a developmental epoch (<xref rid="btad592-B7" ref-type="bibr">Dai <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad592-B14" ref-type="bibr">Jackson <italic toggle="yes">et al.</italic> 2020</xref>). Many methods exist for detecting modules/communities in networks with or without specialization in multiple subjects or time points, both within and outside of genomics research (summarized in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). These approaches leverage and combine stochastic block models (SBMs) (<xref rid="btad592-B20" ref-type="bibr">Matias and Miele 2017</xref>) with Kalman filters (<xref rid="btad592-B29" ref-type="bibr">Xu and Hero 2014</xref>) or hidden Markov models (<xref rid="btad592-B26" ref-type="bibr">Ting <italic toggle="yes">et al.</italic> 2021</xref>), impose smoothing in spectral clustering (<xref rid="btad592-B5" ref-type="bibr">Chi <italic toggle="yes">et al.</italic> 2007</xref>, <xref rid="btad592-B16" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2018</xref>), and utilize Steiner tree formulation (<xref rid="btad592-B21" ref-type="bibr">Norman and Cicek 2019</xref>). Modularity maximization (<xref rid="btad592-B1" ref-type="bibr">Bassett <italic toggle="yes">et al.</italic> 2013</xref>, <xref rid="btad592-B3" ref-type="bibr">Betzel <italic toggle="yes">et al.</italic> 2019</xref>), nonnegative matrix factorization (<xref rid="btad592-B18" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> 2019</xref>), and network change point detection (NCPD) (<xref rid="btad592-B6" ref-type="bibr">Cribben and Yu 2017</xref>) were also explored in community detection from brain and behavioral networks.</p>
    <p>Recently, <xref rid="btad592-B16" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> (2018)</xref> developed a global spectral clustering framework named PisCES for inferring communities in dynamic networks. PisCES detects gene modules at each time point by imposing module smoothness across time in a spectral clustering formulation. They show that such information sharing across the time domain improves community detection in dynamic networks (<xref rid="btad592-B16" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2018</xref>). However, PisCES does not accommodate joint analysis of networks from multiple subjects, potentially overlooking information that could boost the signal for discovering communities. Here, we generalize the PisCES to detect communities in personalized dynamic gene networks and identify gene modules that vary or persist not only across time but also among subjects. Our method, named <bold>Mu</bold>lti-subject <bold>D</bold>ynamic <bold>Co</bold>mmunity <bold>D</bold>etection (MuDCoD), infers gene communities per subject and per time point by extending the temporal smoothness assumption to the subject dimension.</p>
    <p>We evaluated MuDCoD with simulation experiments in a wide variety of scenarios. To this end, we extended the dynamic degree corrected block model (Dynamic DCBM) (<xref rid="btad592-B20" ref-type="bibr">Matias and Miele 2017</xref>), which provides a setting for time-varying networks to multi-subject scenarios. This multi-subject dynamic DCBM setting accommodates the characteristics of scRNA-seq-based personalized gene networks not only across time but also in the subject dimension. While there are several community detection methods within and outside of genomics, as we summarized above, they are limited in their applicability to handle dynamic multi-subject networks. After taking these approaches and the accessibility of their software into consideration, we compared MuDCoD with the recently developed multi-layer multi-subject modularity maximization technique (referred to as Betzel-2019 hereafter) (<xref rid="btad592-B3" ref-type="bibr">Betzel <italic toggle="yes">et al.</italic> 2019</xref>), PisCES, and static spectral clustering. We observed that MuDCoD markedly outperforms other methods when subjects share information at the network level and performs robustly otherwise. In addition to the simulation experiments, we also applied MuDCoD to scRNA-seq studies of long-term human induced pluripotent stem cells (iPSC) (<xref rid="btad592-B10" ref-type="bibr">HipSci Consortium <italic toggle="yes">et al.</italic> 2021</xref>) and activation of naive and memory human CD4<inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> T cells isolated from peripheral blood (<xref rid="btad592-B23" ref-type="bibr">Soskic <italic toggle="yes">et al.</italic> 2022</xref>). Our results highlight that MuDCoD is able to leverage information sharing across subjects and infer gene modules that contribute to network variation across subjects and time points. Downstream gene set enrichment analysis of inferred modules highlights persistent biological processes across subjects, as well as biological processes that are specific to subsets of subjects and/or time points. A detailed analysis of <xref rid="btad592-B10" ref-type="bibr">HipSci Consortium <italic toggle="yes">et al.</italic> (2021)</xref> dataset by leveraging the differentiation efficiency of subjects reveals that the gene modules of high differentiation efficiency subjects tend to exhibit higher variation across the differentiation time points compared to subjects with low differentiation efficiency. For <xref rid="btad592-B23" ref-type="bibr">Soskic <italic toggle="yes">et al.</italic> (2022)</xref> dataset, we observe that module structures inferred by MuDCoD and the dynamics of enriched biological process annotations for such modules are consistent with mechanisms governing CD4<inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> T cell activation.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Problem formulation</title>
      <p>We define a multi-subject dynamic gene co-expression network for discrete time steps <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> and for subjects <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula> as a time series of undirected and unweighted graphs <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> for each subject <italic toggle="yes">s</italic>. Given a multi-subject dynamic gene co-expression network, the key task is to infer the <italic toggle="yes">community structure</italic> for each time point and subject. The community structure of a gene co-expression network of size <italic toggle="yes">G</italic> is defined as a partition of genes into <italic toggle="yes">K</italic> disjoint cohesive modules/subsets, where <italic toggle="yes">K</italic> is a hyperparameter determining the number of communities. Each community is essentially a group of gene nodes, densely connected inside and loosely connected outside the community. The problem structure is shown in <xref rid="btad592-F1" ref-type="fig">Fig. 1</xref>. In what follows, we use “community” and “module” interchangeably.</p>
      <fig position="float" id="btad592-F1">
        <label>Figure 1.</label>
        <caption>
          <p>A schematic for multi-subject dynamic gene networks. A gene network is observed for each subject at each time step among a common set of nodes. The sets of edges vary among both the subjects and the time steps. These networks are estimated from scRNA-seq data and are expected to harbor communities that are conserved at varying levels among the subject and time dimensions. Different colors mark distinct communities, where the nodes (genes) within the same communities are depicted with the same color. MuDCoD assumes that communities change smoothly across both the subject and the time dimensions.</p>
        </caption>
        <graphic xlink:href="btad592f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>2.2 Promoting signal sharing simultaneously in subject and time dimensions</title>
      <p>Let <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> denote a time series of symmetric <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:math></inline-formula> adjacency matrices of networks <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> varying across discrete time steps <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>, for subjects <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula>. Let <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> denote the degree-normalized Laplacian of <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> as defined by:</p>
      <disp-formula id="E1">
        <label>(1)</label>
        <mml:math id="M1" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mi>L</mml:mi>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msup>
                <mml:mrow>
                  <mml:mi>D</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>/</mml:mo>
                  <mml:mn>2</mml:mn>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
            <mml:mi>A</mml:mi>
            <mml:mrow>
              <mml:msup>
                <mml:mrow>
                  <mml:mi>D</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>/</mml:mo>
                  <mml:mn>2</mml:mn>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
            <mml:mo> </mml:mo>
            <mml:mtext>where</mml:mtext>
            <mml:mo> </mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>D</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mo stretchy="true">{</mml:mo>
              <mml:mrow>
                <mml:mtable>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mi>deg</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>v</mml:mi>
                            </mml:mrow>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mtext>if</mml:mtext>
                        <mml:mo> </mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mi>j</mml:mi>
                        <mml:mo>,</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mn>0</mml:mn>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mtext>otherwise</mml:mtext>
                        <mml:mo>,</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mi>deg</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> denotes the degree of node <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
      <p>Let <italic toggle="yes">K</italic> be fixed, and <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> denote a matrix with columns corresponding to the <italic toggle="yes">K</italic> leading eigenvectors of <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. A baseline strategy for inferring communities from these adjacency matrices is finding communities separately at each time step and for each individual. To detect communities that change longitudinally, PisCES (<xref rid="btad592-B16" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2018</xref>) applies smoothing to the eigenvectors of <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> across time. We develop MuDCoD as a novel and empirically motivated (<xref rid="sup1" ref-type="supplementary-material">Supplementary Section S5</xref>) extension of this framework. MuDCoD applies eigenvector smoothing across both the subject and the time dimensions to promote signal sharing across the subjects in addition to the time dimension. Let <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> be the projection matrix onto the column space of <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and define mean projection matrix</p>
      <disp-formula id="E2">
        <label>(2)</label>
        <mml:math id="M2" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>μ</mml:mo>
                </mml:mrow>
                <mml:mi>s</mml:mi>
              </mml:msub>
            </mml:mrow>
            <mml:mrow>
              <mml:mo>(</mml:mo>
              <mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mover accent="true">
                            <mml:mi>U</mml:mi>
                            <mml:mo>¯</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>:</mml:mo>
                      <mml:mo>,</mml:mo>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
              </mml:mrow>
              <mml:mo>)</mml:mo>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mrow>
                  <mml:mi>S</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mrow>
              <mml:munder>
                <mml:mo>∑</mml:mo>
                <mml:mrow>
                  <mml:mtable>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                          <mml:mo>≤</mml:mo>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mi>s</mml:mi>
                              </mml:mrow>
                              <mml:mo>′</mml:mo>
                            </mml:msup>
                          </mml:mrow>
                          <mml:mo>≤</mml:mo>
                          <mml:mi>S</mml:mi>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mi>s</mml:mi>
                              </mml:mrow>
                              <mml:mo>′</mml:mo>
                            </mml:msup>
                          </mml:mrow>
                          <mml:mo>≠</mml:mo>
                          <mml:mi>s</mml:mi>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mrow>
              </mml:munder>
            </mml:mrow>
            <mml:mrow>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mover accent="true">
                          <mml:mi>U</mml:mi>
                          <mml:mo>¯</mml:mo>
                        </mml:mover>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>s</mml:mi>
                        </mml:mrow>
                        <mml:mo>′</mml:mo>
                      </mml:msup>
                    </mml:mrow>
                    <mml:mo>,</mml:mo>
                    <mml:mi>t</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>U</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the smoothed version of <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. We estimate <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>U</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> by:</p>
      <disp-formula id="E3">
        <label>(3)</label>
        <mml:math id="M3" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mtable>
              <mml:mtr columnalign="left">
                <mml:mtd columnalign="left">
                  <mml:mrow>
                    <mml:mrow>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mi>min</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtable>
                            <mml:mtr>
                              <mml:mtd>
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mrow>
                                        <mml:mrow>
                                          <mml:mrow>
                                            <mml:mover accent="true">
                                              <mml:mi>U</mml:mi>
                                              <mml:mo>¯</mml:mo>
                                            </mml:mover>
                                          </mml:mrow>
                                        </mml:mrow>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mi>s</mml:mi>
                                        <mml:mo>,</mml:mo>
                                        <mml:mi>t</mml:mi>
                                      </mml:mrow>
                                    </mml:msub>
                                  </mml:mrow>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                            <mml:mtr>
                              <mml:mtd>
                                <mml:mrow>
                                  <mml:mi>s</mml:mi>
                                  <mml:mo>=</mml:mo>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>,</mml:mo>
                                  <mml:mo>…</mml:mo>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>S</mml:mi>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                            <mml:mtr>
                              <mml:mtd>
                                <mml:mrow>
                                  <mml:mi>t</mml:mi>
                                  <mml:mo>=</mml:mo>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>,</mml:mo>
                                  <mml:mo>…</mml:mo>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>T</mml:mi>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                          </mml:mtable>
                        </mml:mrow>
                      </mml:munder>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:munderover>
                            <mml:mo>∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>s</mml:mi>
                              <mml:mo>=</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mi>S</mml:mi>
                          </mml:munderover>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:munderover>
                            <mml:mo>∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>t</mml:mi>
                              <mml:mo>=</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mi>T</mml:mi>
                          </mml:munderover>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:mo>‖</mml:mo>
                                    <mml:mrow>
                                      <mml:mrow>
                                        <mml:msub>
                                          <mml:mrow>
                                            <mml:mi>U</mml:mi>
                                          </mml:mrow>
                                          <mml:mrow>
                                            <mml:mi>s</mml:mi>
                                            <mml:mo>,</mml:mo>
                                            <mml:mi>t</mml:mi>
                                          </mml:mrow>
                                        </mml:msub>
                                      </mml:mrow>
                                      <mml:mo>−</mml:mo>
                                      <mml:mrow>
                                        <mml:msub>
                                          <mml:mrow>
                                            <mml:mrow>
                                              <mml:mrow>
                                                <mml:mover accent="true">
                                                  <mml:mi>U</mml:mi>
                                                  <mml:mo>¯</mml:mo>
                                                </mml:mover>
                                              </mml:mrow>
                                            </mml:mrow>
                                          </mml:mrow>
                                          <mml:mrow>
                                            <mml:mi>s</mml:mi>
                                            <mml:mo>,</mml:mo>
                                            <mml:mi>t</mml:mi>
                                          </mml:mrow>
                                        </mml:msub>
                                      </mml:mrow>
                                    </mml:mrow>
                                    <mml:mo>‖</mml:mo>
                                  </mml:mrow>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mi>F</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr columnalign="left">
                <mml:mtd columnalign="left">
                  <mml:mrow>
                    <mml:mo>+</mml:mo>
                    <mml:mrow>
                      <mml:munderover>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>t</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>T</mml:mi>
                      </mml:munderover>
                    </mml:mrow>
                    <mml:mo>β</mml:mo>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mo>‖</mml:mo>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mrow>
                                        <mml:mrow>
                                          <mml:mover accent="true">
                                            <mml:mi>U</mml:mi>
                                            <mml:mo>¯</mml:mo>
                                          </mml:mover>
                                        </mml:mrow>
                                      </mml:mrow>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>s</mml:mi>
                                      <mml:mo>,</mml:mo>
                                      <mml:mi>t</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mo>−</mml:mo>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mo>μ</mml:mo>
                                    </mml:mrow>
                                    <mml:mi>s</mml:mi>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:mrow>
                                    <mml:mrow>
                                      <mml:msub>
                                        <mml:mrow>
                                          <mml:mrow>
                                            <mml:mrow>
                                              <mml:mover accent="true">
                                                <mml:mi>U</mml:mi>
                                                <mml:mo>¯</mml:mo>
                                              </mml:mover>
                                            </mml:mrow>
                                          </mml:mrow>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mo>:</mml:mo>
                                          <mml:mo>,</mml:mo>
                                          <mml:mi>t</mml:mi>
                                        </mml:mrow>
                                      </mml:msub>
                                    </mml:mrow>
                                  </mml:mrow>
                                  <mml:mo>)</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mo>‖</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mi>F</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msubsup>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr columnalign="left">
                <mml:mtd columnalign="left">
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:munderover>
                            <mml:mo>∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>t</mml:mi>
                              <mml:mo>=</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:munderover>
                        </mml:mrow>
                        <mml:mo>α</mml:mo>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mo>‖</mml:mo>
                                  <mml:mrow>
                                    <mml:mrow>
                                      <mml:msub>
                                        <mml:mrow>
                                          <mml:mrow>
                                            <mml:mrow>
                                              <mml:mover accent="true">
                                                <mml:mi>U</mml:mi>
                                                <mml:mo>¯</mml:mo>
                                              </mml:mover>
                                            </mml:mrow>
                                          </mml:mrow>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mi>s</mml:mi>
                                          <mml:mo>,</mml:mo>
                                          <mml:mi>t</mml:mi>
                                        </mml:mrow>
                                      </mml:msub>
                                    </mml:mrow>
                                    <mml:mo>−</mml:mo>
                                    <mml:mrow>
                                      <mml:msub>
                                        <mml:mrow>
                                          <mml:mrow>
                                            <mml:mrow>
                                              <mml:mover accent="true">
                                                <mml:mi>U</mml:mi>
                                                <mml:mo>¯</mml:mo>
                                              </mml:mover>
                                            </mml:mrow>
                                          </mml:mrow>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mi>s</mml:mi>
                                          <mml:mo>,</mml:mo>
                                          <mml:mi>t</mml:mi>
                                          <mml:mo>+</mml:mo>
                                          <mml:mn>1</mml:mn>
                                        </mml:mrow>
                                      </mml:msub>
                                    </mml:mrow>
                                  </mml:mrow>
                                  <mml:mo>‖</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mi>F</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msubsup>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>subject to <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>U</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mrow><mml:msup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow><mml:mo> </mml:mo><mml:mo>:</mml:mo><mml:mo> </mml:mo><mml:mi>V</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mi>I</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mo>∀</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mo>∀</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>.</p>
      <p>Here, the penalty term with parameter <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula> enforces smoothness over the adjacent time points, whereas the term with parameter <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula> constrains subject-specific variation from the mean time-dependent projection matrix <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>U</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Our formulation is based on the assumption that community structure of gene co-expression networks are expected to be similar across the subjects at a fixed time point (i.e. small <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>U</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>U</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>) unless there is an explicit grouping variable (e.g. in a case and control setting). This assumption is empirically supported for the datasets we are considering in this article (<xref rid="sup1" ref-type="supplementary-material">Supplementary Section S5</xref>). The solution of <xref rid="E3" ref-type="disp-formula">Equation 3</xref> yields a series of smoothed mean projection matrices for each subject. Similar to PisCES, we propose to solve this nonconvex optimization problem with the following iterative method:</p>
      <disp-formula id="E4">
        <label>(4)</label>
        <mml:math id="M4" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mtable>
              <mml:mtr columnalign="left">
                <mml:mtd columnalign="left">
                  <mml:mrow>
                    <mml:mtable>
                      <mml:mtr columnalign="left">
                        <mml:mtd columnalign="left">
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msubsup>
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:mrow>
                                      <mml:mover accent="true">
                                        <mml:mi>U</mml:mi>
                                        <mml:mo>¯</mml:mo>
                                      </mml:mover>
                                    </mml:mrow>
                                  </mml:mrow>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>s</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>ℓ</mml:mi>
                                  <mml:mo>+</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msubsup>
                            </mml:mrow>
                            <mml:mo>=</mml:mo>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mo>Π</mml:mo>
                                </mml:mrow>
                                <mml:mi>K</mml:mi>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>U</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>s</mml:mi>
                                      <mml:mo>,</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mo>+</mml:mo>
                                <mml:mo>α</mml:mo>
                                <mml:mrow>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mrow>
                                        <mml:mrow>
                                          <mml:mover accent="true">
                                            <mml:mi>U</mml:mi>
                                            <mml:mo>¯</mml:mo>
                                          </mml:mover>
                                        </mml:mrow>
                                      </mml:mrow>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>s</mml:mi>
                                      <mml:mo>,</mml:mo>
                                      <mml:mn>2</mml:mn>
                                    </mml:mrow>
                                    <mml:mi>ℓ</mml:mi>
                                  </mml:msubsup>
                                </mml:mrow>
                                <mml:mo>+</mml:mo>
                                <mml:mo>β</mml:mo>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mo>μ</mml:mo>
                                    </mml:mrow>
                                    <mml:mi>s</mml:mi>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:mrow>
                                    <mml:mrow>
                                      <mml:msubsup>
                                        <mml:mrow>
                                          <mml:mrow>
                                            <mml:mrow>
                                              <mml:mover accent="true">
                                                <mml:mi>U</mml:mi>
                                                <mml:mo>¯</mml:mo>
                                              </mml:mover>
                                            </mml:mrow>
                                          </mml:mrow>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mo>:</mml:mo>
                                          <mml:mo>,</mml:mo>
                                          <mml:mn>1</mml:mn>
                                        </mml:mrow>
                                        <mml:mi>ℓ</mml:mi>
                                      </mml:msubsup>
                                    </mml:mrow>
                                  </mml:mrow>
                                  <mml:mo>)</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr columnalign="left">
                        <mml:mtd columnalign="left">
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msubsup>
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:mrow>
                                      <mml:mover accent="true">
                                        <mml:mi>U</mml:mi>
                                        <mml:mo>¯</mml:mo>
                                      </mml:mover>
                                    </mml:mrow>
                                  </mml:mrow>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>s</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>T</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>ℓ</mml:mi>
                                  <mml:mo>+</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msubsup>
                            </mml:mrow>
                            <mml:mo>=</mml:mo>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mo>Π</mml:mo>
                                </mml:mrow>
                                <mml:mi>K</mml:mi>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                <mml:mo>α</mml:mo>
                                <mml:mrow>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mrow>
                                        <mml:mrow>
                                          <mml:mover accent="true">
                                            <mml:mi>U</mml:mi>
                                            <mml:mo>¯</mml:mo>
                                          </mml:mover>
                                        </mml:mrow>
                                      </mml:mrow>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>s</mml:mi>
                                      <mml:mo>,</mml:mo>
                                      <mml:mi>T</mml:mi>
                                      <mml:mo>−</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                    <mml:mi>ℓ</mml:mi>
                                  </mml:msubsup>
                                </mml:mrow>
                                <mml:mo>+</mml:mo>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>U</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>s</mml:mi>
                                      <mml:mo>,</mml:mo>
                                      <mml:mi>T</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mo>+</mml:mo>
                                <mml:mo>β</mml:mo>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mo>μ</mml:mo>
                                    </mml:mrow>
                                    <mml:mi>s</mml:mi>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:mrow>
                                    <mml:mrow>
                                      <mml:msubsup>
                                        <mml:mrow>
                                          <mml:mrow>
                                            <mml:mrow>
                                              <mml:mover accent="true">
                                                <mml:mi>U</mml:mi>
                                                <mml:mo>¯</mml:mo>
                                              </mml:mover>
                                            </mml:mrow>
                                          </mml:mrow>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mo>:</mml:mo>
                                          <mml:mo>,</mml:mo>
                                          <mml:mi>T</mml:mi>
                                        </mml:mrow>
                                        <mml:mi>ℓ</mml:mi>
                                      </mml:msubsup>
                                    </mml:mrow>
                                  </mml:mrow>
                                  <mml:mo>)</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr columnalign="left">
                        <mml:mtd columnalign="left">
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msubsup>
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:mrow>
                                      <mml:mover accent="true">
                                        <mml:mi>U</mml:mi>
                                        <mml:mo>¯</mml:mo>
                                      </mml:mover>
                                    </mml:mrow>
                                  </mml:mrow>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>s</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>t</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>ℓ</mml:mi>
                                  <mml:mo>+</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msubsup>
                            </mml:mrow>
                            <mml:mo>=</mml:mo>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mo>Π</mml:mo>
                                </mml:mrow>
                                <mml:mi>K</mml:mi>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                <mml:mo>α</mml:mo>
                                <mml:mrow>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mrow>
                                        <mml:mrow>
                                          <mml:mover accent="true">
                                            <mml:mi>U</mml:mi>
                                            <mml:mo>¯</mml:mo>
                                          </mml:mover>
                                        </mml:mrow>
                                      </mml:mrow>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>s</mml:mi>
                                      <mml:mo>,</mml:mo>
                                      <mml:mi>t</mml:mi>
                                      <mml:mo>−</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                    <mml:mi>ℓ</mml:mi>
                                  </mml:msubsup>
                                </mml:mrow>
                                <mml:mo>+</mml:mo>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>U</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>s</mml:mi>
                                      <mml:mo>,</mml:mo>
                                      <mml:mi>t</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mo>+</mml:mo>
                                <mml:mo>α</mml:mo>
                                <mml:mrow>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mrow>
                                        <mml:mrow>
                                          <mml:mover accent="true">
                                            <mml:mi>U</mml:mi>
                                            <mml:mo>¯</mml:mo>
                                          </mml:mover>
                                        </mml:mrow>
                                      </mml:mrow>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>s</mml:mi>
                                      <mml:mo>,</mml:mo>
                                      <mml:mi>t</mml:mi>
                                      <mml:mo>+</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                    <mml:mi>ℓ</mml:mi>
                                  </mml:msubsup>
                                </mml:mrow>
                                <mml:mo>+</mml:mo>
                                <mml:mo>β</mml:mo>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mo>μ</mml:mo>
                                    </mml:mrow>
                                    <mml:mi>s</mml:mi>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:mrow>
                                    <mml:mrow>
                                      <mml:msubsup>
                                        <mml:mrow>
                                          <mml:mrow>
                                            <mml:mrow>
                                              <mml:mover accent="true">
                                                <mml:mi>U</mml:mi>
                                                <mml:mo>¯</mml:mo>
                                              </mml:mover>
                                            </mml:mrow>
                                          </mml:mrow>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mo>:</mml:mo>
                                          <mml:mo>,</mml:mo>
                                          <mml:mi>t</mml:mi>
                                        </mml:mrow>
                                        <mml:mi>ℓ</mml:mi>
                                      </mml:msubsup>
                                    </mml:mrow>
                                  </mml:mrow>
                                  <mml:mo>)</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mo>,</mml:mo>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula> for all iterations <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mi>ℓ</mml:mi></mml:math></inline-formula> and the iterative algorithm is initialized by <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>U</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> for <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula>. The mapping <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>Π</mml:mo></mml:mrow><mml:mi>K</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> extracts the <italic toggle="yes">K</italic> leading eigenvectors, and is given by <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>Π</mml:mo></mml:mrow><mml:mi>K</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, for a matrix <italic toggle="yes">M</italic>, where <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> are the <italic toggle="yes">K</italic> leading eigenvectors of <italic toggle="yes">M</italic>. This formulation allows the model order <italic toggle="yes">K</italic> to be unknown and possibly varying over time by replacing <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>Π</mml:mo></mml:mrow><mml:mi>K</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:mo>Π</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="script">K</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. We provide a proof of convergence for this iterative algorithm and a range of hyperparameter values (<inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula> and <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula>) for guaranteed convergence in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S2.1</xref>. We utilize the eigengap statistics to select <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">K</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula>  <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula> are chosen with a re-sampling-based cross-validation strategy by <xref rid="btad592-B15" ref-type="bibr">Li <italic toggle="yes">et al.</italic> (2020)</xref>, as we discuss in the next section. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref> illustrates the experimental convergence status for different <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula> and <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula> values.</p>
    </sec>
    <sec>
      <title>2.3 Hyperparameter selection</title>
      <p><bold>Selecting the number of communities:</bold> We allow the number of communities, <italic toggle="yes">K</italic>, to be unknown and possibly varying over time by exploiting the eigengap statistics. <xref rid="btad592-B22" ref-type="bibr">Shen and Cheng (2010)</xref> demonstrated that the degree-normalized Laplacian matrix and the correlation matrix significantly outperform the adjacency matrix, the standard Laplacian matrix, and the modularity matrix at identifying the community structure of networks. Therefore, we use eigenvalues of degree-normalized Laplacian matrix to estimate <italic toggle="yes">K</italic> as described in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S1.2</xref>.</p>
      <p><bold>Cross-validation to tune</bold>  <inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula>  <bold>and</bold>  <inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula><bold>:</bold> We adopt the re-sampling based network cross-validation strategy of <xref rid="btad592-B15" ref-type="bibr">Li <italic toggle="yes">et al.</italic> (2020)</xref> to tune the hyperparameters <inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula> and <inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula>. This network cross-validation strategy makes sure to keep the node pairs in 1-fold when splitting the data into training and validation folds to avoid deleting edges and changing the network structure. Then, we apply grid search to find the best combination of hyperparameters <inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula> and <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula>, where we define the best with respect to a higher DCBM likelihood function. In our experiments, we observed best performing <inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula> and <inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula> values to range between 0.25 and 0.75. Further details on this strategy are available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S1.1</xref>.</p>
    </sec>
    <sec>
      <title>2.4 Prioritizing communities with CRank</title>
      <p>Many community detection methods, including MuDCoD, fully partition network nodes into nonoverlapping groups. However, in real-world datasets, only a few communities can typically be interpreted and linked to relevant underlying factors. Therefore, it is important to prioritize communities for downstream experimentation and further investigation.</p>
      <p>CRank (<xref rid="btad592-B32" ref-type="bibr">Zitnik <italic toggle="yes">et al.</italic> 2018</xref>) prioritizes network communities by considering the structural features of each community and combining these features into an overall community score. Using metrics such as density, likelihood, allegiance, and boundary, CRank effectively ranks communities inferred by an external method.</p>
      <p>We consider CRank as an optional but useful component of any analysis pipeline that includes MuDCoD. This is especially important for datasets with large numbers of subjects/time points, where aligning or matching subject/time-specific modules becomes infeasible. In our applications of MuDCoD, we benefitted from CRank by conducting a gene set enrichment analysis of only the prioritized communities for each subject.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Experimental setup</title>
    <sec>
      <title>3.1 Simulations</title>
      <p>To evaluate MuDCoD, we extended the dynamic degree corrected block model (Dynamic-DCBM) (<xref rid="btad592-B28" ref-type="bibr">Xu and Hero 2013</xref>) simulation set up to multi-subject setting [multi-subject dynamic degree corrected block model (MuS-Dynamic-DCBM)]. This extension captures the overall characteristics of scRNA-seq-based personalized gene networks both in time and subject dimensions. In our computational experiments, we simulated modules from this model and assessed the performances of different methods in recovering the true modules.</p>
      <p>The entries of the adjacency matrix <inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> under MuS-Dynamic-DCBM are generated by the following Bernoulli distribution:</p>
      <disp-formula id="E5">
        <label>(5)</label>
        <mml:math id="M5" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mtable>
              <mml:mtr columnalign="left">
                <mml:mtd columnalign="left">
                  <mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mo>[</mml:mo>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>A</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>s</mml:mi>
                                      <mml:mo>,</mml:mo>
                                      <mml:mi>t</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mo>]</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo>∼</mml:mo>
                    <mml:mtext>Bernoulli</mml:mtext>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mo>Ψ</mml:mo>
                            </mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mi>s</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>t</mml:mi>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                          </mml:msubsup>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mo>Ψ</mml:mo>
                            </mml:mrow>
                            <mml:mi>j</mml:mi>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mi>s</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>t</mml:mi>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                          </mml:msubsup>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>B</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mi>z</mml:mi>
                                  </mml:mrow>
                                  <mml:mi>j</mml:mi>
                                  <mml:mrow>
                                    <mml:mo stretchy="false">(</mml:mo>
                                    <mml:mi>s</mml:mi>
                                    <mml:mo>,</mml:mo>
                                    <mml:mi>t</mml:mi>
                                    <mml:mo stretchy="false">)</mml:mo>
                                  </mml:mrow>
                                </mml:msubsup>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mi>z</mml:mi>
                                  </mml:mrow>
                                  <mml:mi>j</mml:mi>
                                  <mml:mrow>
                                    <mml:mo stretchy="false">(</mml:mo>
                                    <mml:mi>s</mml:mi>
                                    <mml:mo>,</mml:mo>
                                    <mml:mi>t</mml:mi>
                                    <mml:mo stretchy="false">)</mml:mo>
                                  </mml:mrow>
                                </mml:msubsup>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mi>s</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>t</mml:mi>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                          </mml:msubsup>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mo>,</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr columnalign="left">
                <mml:mtd columnalign="left">
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>j</mml:mi>
                    <mml:mo>∈</mml:mo>
                    <mml:mrow>
                      <mml:mo>[</mml:mo>
                      <mml:mi>G</mml:mi>
                      <mml:mo>]</mml:mo>
                    </mml:mrow>
                    <mml:mo>,</mml:mo>
                    <mml:mo> </mml:mo>
                    <mml:mi>j</mml:mi>
                    <mml:mo>&gt;</mml:mo>
                    <mml:mi>i</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mo> </mml:mo>
                    <mml:mi>t</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mo>…</mml:mo>
                    <mml:mo>,</mml:mo>
                    <mml:mi>T</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mo> </mml:mo>
                    <mml:mi>s</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mo>…</mml:mo>
                    <mml:mo>,</mml:mo>
                    <mml:mi>S</mml:mi>
                    <mml:mo>,</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>with <inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Here <inline-formula id="IE58"><mml:math id="IM58" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi>K</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mi>G</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> are vectors of community labels. More specifically, <italic toggle="yes">i</italic>-th entry <inline-formula id="IE59"><mml:math id="IM59" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> of <inline-formula id="IE60"><mml:math id="IM60" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> denotes the module assignment of gene <italic toggle="yes">i</italic> for subject <italic toggle="yes">s</italic> at time point <italic toggle="yes">t</italic>. <inline-formula id="IE61"><mml:math id="IM61" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>Ψ</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>G</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> are degree parameters and <inline-formula id="IE62"><mml:math id="IM62" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> is a connectivity matrix at time <italic toggle="yes">t</italic> for subject <italic toggle="yes">s</italic>. As we describe below with specific cases, variations in the generation process of <inline-formula id="IE63"><mml:math id="IM63" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> as a function of <italic toggle="yes">s</italic> and <italic toggle="yes">t</italic> provide a systematic way of modulating shared information, i.e. similarities, across the subject and time dimensions.</p>
      <p>The degree parameters and the connectivity matrix (<inline-formula id="IE64"><mml:math id="IM64" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>Ψ</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE65"><mml:math id="IM65" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>) for subject <italic toggle="yes">s</italic> at time <italic toggle="yes">t</italic> are randomized as follows:</p>
      <disp-formula id="E6">
        <label>(6)</label>
        <mml:math id="M6" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>B</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>l</mml:mi>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mo stretchy="true">{</mml:mo>
              <mml:mrow>
                <mml:mtable>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mtext>Uniform</mml:mtext>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>p</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>in</mml:mtext>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mn>0</mml:mn>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                          </mml:msubsup>
                        </mml:mrow>
                        <mml:mo>,</mml:mo>
                        <mml:mo> </mml:mo>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>p</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>in</mml:mtext>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mn>1</mml:mn>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                          </mml:msubsup>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mtext>if</mml:mtext>
                        <mml:mo> </mml:mo>
                        <mml:mi>l</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mi>k</mml:mi>
                        <mml:mo>,</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mtext>Uniform</mml:mtext>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>p</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>out</mml:mtext>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mn>0</mml:mn>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                          </mml:msubsup>
                        </mml:mrow>
                        <mml:mo>,</mml:mo>
                        <mml:mo> </mml:mo>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>p</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>out</mml:mtext>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mn>1</mml:mn>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                          </mml:msubsup>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mtext>if</mml:mtext>
                        <mml:mo> </mml:mo>
                        <mml:mi>l</mml:mi>
                        <mml:mo>≠</mml:mo>
                        <mml:mi>k</mml:mi>
                        <mml:mo>,</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <disp-formula id="E7">
        <label>(7)</label>
        <mml:math id="M7" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msup>
                <mml:mrow>
                  <mml:mo>Ψ</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>s</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>t</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>γ</mml:mo>
                </mml:mrow>
                <mml:mn>0</mml:mn>
              </mml:msub>
            </mml:mrow>
            <mml:mo>+</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>γ</mml:mo>
                </mml:mrow>
                <mml:mn>1</mml:mn>
              </mml:msub>
            </mml:mrow>
            <mml:mrow>
              <mml:msup>
                <mml:mrow>
                  <mml:mo>π</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>s</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>t</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
            <mml:mo>/</mml:mo>
            <mml:mi>G</mml:mi>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula id="IE66"><mml:math id="IM66" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>in</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>in</mml:mtext></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>in</mml:mtext></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE67"><mml:math id="IM67" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>out</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>out</mml:mtext></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>out</mml:mtext></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are in-cluster and between-cluster density parameters (<inline-formula id="IE68"><mml:math id="IM68" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>in</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>≥</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>out</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>), respectively, <inline-formula id="IE69"><mml:math id="IM69" display="inline" overflow="scroll"><mml:mo>π</mml:mo></mml:math></inline-formula> is a random permutation of <inline-formula id="IE70"><mml:math id="IM70" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE71"><mml:math id="IM71" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE72"><mml:math id="IM72" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> are determined based on the value of <italic toggle="yes">G</italic> and the desired degree distribution. We set <inline-formula id="IE73"><mml:math id="IM73" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE74"><mml:math id="IM74" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> in our experiments. For the original network (<inline-formula id="IE75"><mml:math id="IM75" display="inline" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE76"><mml:math id="IM76" display="inline" overflow="scroll"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>), community memberships of nodes are initialized from the following multinomial distribution: <inline-formula id="IE77"><mml:math id="IM77" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>∼</mml:mo><mml:mtext>Multinomial</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mfrac></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mfrac></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
      <p>Our extension MuS-Dynamic-DCBM spans two distinct multi-subject settings: Signal-Sharing-over-Subjects (SSoS) and Signal-Sharing-over-Time (SSoT) (<xref rid="btad592-F2" ref-type="fig">Fig. 2</xref>). Both of these vary the degree of similarity between subject-specific networks while maintaining their time-dependent components and developing corresponding generation processes for community memberships across the time and subject dimensions. Signal-Sharing-over-Subjects (SSoS) enables modulation of signal sharing across subjects. For both settings, each subject’s network at time <italic toggle="yes">t</italic> is generated based on the corresponding module labels.</p>
      <fig position="float" id="btad592-F2">
        <label>Figure 2.</label>
        <caption>
          <p>Multi-subject dynamic degree corrected block models (MuS-Dynamic-DCBM) for the two proposed settings. (a) <italic toggle="yes">SSoS setting:</italic> subjects evolve from a common ancestor at each time step <italic toggle="yes">t</italic>; and only the ancestor’s evolution over time is parameterized. (b) <italic toggle="yes">SSoT setting:</italic> subjects evolve from a common ancestor at <inline-formula id="IE78"><mml:math id="IM78" display="inline" overflow="scroll"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>; and then they evolve independently over time.</p>
        </caption>
        <graphic xlink:href="btad592f2" position="float"/>
      </fig>
      <sec>
        <title>3.1.1 Signal-Sharing-over-Subjects (SSoS)</title>
        <p>In SSoS, gene modules of an “ancestor” progress over time with controllable similarity along the adjacent time points, and each subject’s set of gene modules at time <italic toggle="yes">t</italic> is a realization from this progressing ancestor (<xref rid="btad592-F2" ref-type="fig">Fig. 2</xref>). Let <inline-formula id="IE79"><mml:math id="IM79" display="inline" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> index the subject for the ancestor network, and <inline-formula id="IE80"><mml:math id="IM80" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> denote its community labels for <inline-formula id="IE81"><mml:math id="IM81" display="inline" overflow="scroll"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>. In SSoS, <inline-formula id="IE82"><mml:math id="IM82" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> progresses over time according to</p>
        <disp-formula id="E8">
          <label>(8)</label>
          <mml:math id="M8" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mtable>
                <mml:mtr columnalign="left">
                  <mml:mtd columnalign="left">
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mi>z</mml:mi>
                          </mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo>,</mml:mo>
                            <mml:mi>t</mml:mi>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="false">{</mml:mo>
                        <mml:mrow>
                          <mml:mtable>
                            <mml:mtr columnalign="left">
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:msubsup>
                                      <mml:mrow>
                                        <mml:mi>z</mml:mi>
                                      </mml:mrow>
                                      <mml:mi>i</mml:mi>
                                      <mml:mrow>
                                        <mml:mo stretchy="false">(</mml:mo>
                                        <mml:mn>1</mml:mn>
                                        <mml:mo>,</mml:mo>
                                        <mml:mi>t</mml:mi>
                                        <mml:mo>−</mml:mo>
                                        <mml:mn>1</mml:mn>
                                        <mml:mo stretchy="false">)</mml:mo>
                                      </mml:mrow>
                                    </mml:msubsup>
                                  </mml:mrow>
                                </mml:mrow>
                              </mml:mtd>
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mtext>with</mml:mtext>
                                  <mml:mo> </mml:mo>
                                  <mml:mtext>probability</mml:mtext>
                                  <mml:mo> </mml:mo>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>−</mml:mo>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mrow>
                                        <mml:mi>r</mml:mi>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mtext>time</mml:mtext>
                                      </mml:mrow>
                                    </mml:msub>
                                  </mml:mrow>
                                  <mml:mo>,</mml:mo>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                            <mml:mtr columnalign="left">
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mtext>Multinomial</mml:mtext>
                                  <mml:mo stretchy="true">(</mml:mo>
                                  <mml:mrow>
                                    <mml:mfrac>
                                      <mml:mn>1</mml:mn>
                                      <mml:mi>K</mml:mi>
                                    </mml:mfrac>
                                  </mml:mrow>
                                  <mml:mo>,</mml:mo>
                                  <mml:mo>…</mml:mo>
                                  <mml:mo>,</mml:mo>
                                  <mml:mrow>
                                    <mml:mfrac>
                                      <mml:mn>1</mml:mn>
                                      <mml:mi>K</mml:mi>
                                    </mml:mfrac>
                                  </mml:mrow>
                                  <mml:mo stretchy="true">)</mml:mo>
                                </mml:mrow>
                              </mml:mtd>
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mtext>otherwise</mml:mtext>
                                  <mml:mo>,</mml:mo>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                          </mml:mtable>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr columnalign="left">
                  <mml:mtd columnalign="left">
                    <mml:mrow>
                      <mml:mtext>for</mml:mtext>
                      <mml:mo> </mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>∈</mml:mo>
                      <mml:mrow>
                        <mml:mo>[</mml:mo>
                        <mml:mi>G</mml:mi>
                        <mml:mo>]</mml:mo>
                      </mml:mrow>
                      <mml:mo>,</mml:mo>
                      <mml:mo> </mml:mo>
                      <mml:mi>t</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mo>…</mml:mo>
                      <mml:mo>,</mml:mo>
                      <mml:mi>T</mml:mi>
                      <mml:mo>,</mml:mo>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>where <inline-formula id="IE83"><mml:math id="IM83" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>time</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> denotes the probability that a node <italic toggle="yes">i</italic> changes its previous community label, <inline-formula id="IE84"><mml:math id="IM84" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>. Then, community labels of other subjects for each time point <italic toggle="yes">t</italic> are generated as follows:</p>
        <disp-formula id="E9">
          <label>(9)</label>
          <mml:math id="M9" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mtable>
                <mml:mtr columnalign="left">
                  <mml:mtd columnalign="left">
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mi>z</mml:mi>
                          </mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>s</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>t</mml:mi>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="false">{</mml:mo>
                        <mml:mrow>
                          <mml:mtable>
                            <mml:mtr columnalign="left">
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:msubsup>
                                      <mml:mrow>
                                        <mml:mi>z</mml:mi>
                                      </mml:mrow>
                                      <mml:mi>i</mml:mi>
                                      <mml:mrow>
                                        <mml:mo stretchy="false">(</mml:mo>
                                        <mml:mn>1</mml:mn>
                                        <mml:mo>,</mml:mo>
                                        <mml:mi>t</mml:mi>
                                        <mml:mo stretchy="false">)</mml:mo>
                                      </mml:mrow>
                                    </mml:msubsup>
                                  </mml:mrow>
                                </mml:mrow>
                              </mml:mtd>
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mtext>with</mml:mtext>
                                  <mml:mo> </mml:mo>
                                  <mml:mtext>probability</mml:mtext>
                                  <mml:mo> </mml:mo>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>−</mml:mo>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mrow>
                                        <mml:mi>r</mml:mi>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mtext>subject</mml:mtext>
                                      </mml:mrow>
                                    </mml:msub>
                                  </mml:mrow>
                                  <mml:mo>,</mml:mo>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                            <mml:mtr columnalign="left">
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mtext>Multinomial</mml:mtext>
                                  <mml:mo stretchy="true">(</mml:mo>
                                  <mml:mrow>
                                    <mml:mfrac>
                                      <mml:mn>1</mml:mn>
                                      <mml:mi>K</mml:mi>
                                    </mml:mfrac>
                                  </mml:mrow>
                                  <mml:mo>,</mml:mo>
                                  <mml:mo>…</mml:mo>
                                  <mml:mo>,</mml:mo>
                                  <mml:mrow>
                                    <mml:mfrac>
                                      <mml:mn>1</mml:mn>
                                      <mml:mi>K</mml:mi>
                                    </mml:mfrac>
                                  </mml:mrow>
                                  <mml:mo stretchy="true">)</mml:mo>
                                </mml:mrow>
                              </mml:mtd>
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mtext>otherwise</mml:mtext>
                                  <mml:mo>,</mml:mo>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                          </mml:mtable>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr columnalign="left">
                  <mml:mtd columnalign="left">
                    <mml:mrow>
                      <mml:mtext>for</mml:mtext>
                      <mml:mo> </mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>∈</mml:mo>
                      <mml:mrow>
                        <mml:mo>[</mml:mo>
                        <mml:mi>G</mml:mi>
                        <mml:mo>]</mml:mo>
                      </mml:mrow>
                      <mml:mo>,</mml:mo>
                      <mml:mo> </mml:mo>
                      <mml:mi>t</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mo>…</mml:mo>
                      <mml:mo>,</mml:mo>
                      <mml:mi>T</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mo> </mml:mo>
                      <mml:mi>s</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mo>…</mml:mo>
                      <mml:mo>,</mml:mo>
                      <mml:mi>S</mml:mi>
                      <mml:mo>,</mml:mo>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>where <inline-formula id="IE85"><mml:math id="IM85" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the probability that the node <italic toggle="yes">i</italic> changes community label while progressing from <inline-formula id="IE86"><mml:math id="IM86" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
      </sec>
      <sec>
        <title>3.1.2 Signal-Sharing-over-Time (SSoT)</title>
        <p>In contrast to SSoS, in SSoT, each subject’s gene modules start out from a common ancestor network at time <inline-formula id="IE87"><mml:math id="IM87" display="inline" overflow="scroll"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and progress over time independent of other subjects. In this setting, gene modules of a subject share similarities between time points (<xref rid="btad592-F2" ref-type="fig">Fig. 2</xref>). Let <inline-formula id="IE88"><mml:math id="IM88" display="inline" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> index the subject for the ancestor network, and <inline-formula id="IE89"><mml:math id="IM89" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> denote its community labels at <inline-formula id="IE90"><mml:math id="IM90" display="inline" overflow="scroll"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. The community labels of other subjects progress from the ancestor network only at time <inline-formula id="IE91"><mml:math id="IM91" display="inline" overflow="scroll"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> according to:</p>
        <disp-formula id="E10">
          <label>(10)</label>
          <mml:math id="M10" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mtable>
                <mml:mtr columnalign="left">
                  <mml:mtd columnalign="left">
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mi>z</mml:mi>
                          </mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>s</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="false">{</mml:mo>
                        <mml:mrow>
                          <mml:mtable>
                            <mml:mtr columnalign="left">
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:msubsup>
                                      <mml:mrow>
                                        <mml:mi>z</mml:mi>
                                      </mml:mrow>
                                      <mml:mi>i</mml:mi>
                                      <mml:mrow>
                                        <mml:mo stretchy="false">(</mml:mo>
                                        <mml:mn>1</mml:mn>
                                        <mml:mo>,</mml:mo>
                                        <mml:mn>1</mml:mn>
                                        <mml:mo stretchy="false">)</mml:mo>
                                      </mml:mrow>
                                    </mml:msubsup>
                                  </mml:mrow>
                                </mml:mrow>
                              </mml:mtd>
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mtext>with</mml:mtext>
                                  <mml:mo> </mml:mo>
                                  <mml:mtext>probability</mml:mtext>
                                  <mml:mo> </mml:mo>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>−</mml:mo>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mrow>
                                        <mml:mi>r</mml:mi>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mtext>subject</mml:mtext>
                                      </mml:mrow>
                                    </mml:msub>
                                  </mml:mrow>
                                  <mml:mo>,</mml:mo>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                            <mml:mtr columnalign="left">
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mtext>Multinomial</mml:mtext>
                                  <mml:mo stretchy="true">(</mml:mo>
                                  <mml:mrow>
                                    <mml:mfrac>
                                      <mml:mn>1</mml:mn>
                                      <mml:mi>K</mml:mi>
                                    </mml:mfrac>
                                  </mml:mrow>
                                  <mml:mo>,</mml:mo>
                                  <mml:mo>…</mml:mo>
                                  <mml:mo>,</mml:mo>
                                  <mml:mrow>
                                    <mml:mfrac>
                                      <mml:mn>1</mml:mn>
                                      <mml:mi>K</mml:mi>
                                    </mml:mfrac>
                                  </mml:mrow>
                                  <mml:mo stretchy="true">)</mml:mo>
                                </mml:mrow>
                              </mml:mtd>
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mtext>otherwise</mml:mtext>
                                  <mml:mo>,</mml:mo>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                          </mml:mtable>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr columnalign="left">
                  <mml:mtd columnalign="left">
                    <mml:mrow>
                      <mml:mtext>for</mml:mtext>
                      <mml:mo> </mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>∈</mml:mo>
                      <mml:mrow>
                        <mml:mo>[</mml:mo>
                        <mml:mi>G</mml:mi>
                        <mml:mo>]</mml:mo>
                      </mml:mrow>
                      <mml:mo>,</mml:mo>
                      <mml:mo> </mml:mo>
                      <mml:mi>s</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mo>…</mml:mo>
                      <mml:mo>,</mml:mo>
                      <mml:mi>S</mml:mi>
                      <mml:mo>.</mml:mo>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>Then, each subject progresses independently over time by:</p>
        <disp-formula id="E11">
          <label>(11)</label>
          <mml:math id="M11" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mtable>
                <mml:mtr columnalign="left">
                  <mml:mtd columnalign="left">
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mi>z</mml:mi>
                          </mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>s</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>t</mml:mi>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="false">{</mml:mo>
                        <mml:mrow>
                          <mml:mtable>
                            <mml:mtr columnalign="left">
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:msubsup>
                                      <mml:mrow>
                                        <mml:mi>z</mml:mi>
                                      </mml:mrow>
                                      <mml:mi>i</mml:mi>
                                      <mml:mrow>
                                        <mml:mo stretchy="false">(</mml:mo>
                                        <mml:mi>s</mml:mi>
                                        <mml:mo>,</mml:mo>
                                        <mml:mi>t</mml:mi>
                                        <mml:mo>−</mml:mo>
                                        <mml:mn>1</mml:mn>
                                        <mml:mo stretchy="false">)</mml:mo>
                                      </mml:mrow>
                                    </mml:msubsup>
                                  </mml:mrow>
                                </mml:mrow>
                              </mml:mtd>
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mtext>with</mml:mtext>
                                  <mml:mo> </mml:mo>
                                  <mml:mtext>probability</mml:mtext>
                                  <mml:mo> </mml:mo>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>−</mml:mo>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mrow>
                                        <mml:mi>r</mml:mi>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mtext>time</mml:mtext>
                                      </mml:mrow>
                                    </mml:msub>
                                  </mml:mrow>
                                  <mml:mo>,</mml:mo>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                            <mml:mtr columnalign="left">
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mtext>Multinomial</mml:mtext>
                                  <mml:mo stretchy="true">(</mml:mo>
                                  <mml:mrow>
                                    <mml:mfrac>
                                      <mml:mn>1</mml:mn>
                                      <mml:mi>K</mml:mi>
                                    </mml:mfrac>
                                  </mml:mrow>
                                  <mml:mo>,</mml:mo>
                                  <mml:mo>…</mml:mo>
                                  <mml:mo>,</mml:mo>
                                  <mml:mrow>
                                    <mml:mfrac>
                                      <mml:mn>1</mml:mn>
                                      <mml:mi>K</mml:mi>
                                    </mml:mfrac>
                                  </mml:mrow>
                                  <mml:mo stretchy="true">)</mml:mo>
                                </mml:mrow>
                              </mml:mtd>
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mtext>otherwise</mml:mtext>
                                  <mml:mo>,</mml:mo>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                          </mml:mtable>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr columnalign="left">
                  <mml:mtd columnalign="left">
                    <mml:mrow>
                      <mml:mtext>for</mml:mtext>
                      <mml:mo> </mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>∈</mml:mo>
                      <mml:mrow>
                        <mml:mo>[</mml:mo>
                        <mml:mi>G</mml:mi>
                        <mml:mo>]</mml:mo>
                      </mml:mrow>
                      <mml:mo>,</mml:mo>
                      <mml:mo> </mml:mo>
                      <mml:mi>t</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mo>…</mml:mo>
                      <mml:mo>,</mml:mo>
                      <mml:mi>T</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mo> </mml:mo>
                      <mml:mi>s</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mo>…</mml:mo>
                      <mml:mo>,</mml:mo>
                      <mml:mi>S</mml:mi>
                      <mml:mo>.</mml:mo>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </sec>
    </sec>
    <sec>
      <title>3.2 Experiments on real biological datasets</title>
      <p>We applied MuDCoD to two population-scale scRNA-seq datasets. In this section, we provide details on the data preprocessing steps of these applications. We remark that different data preprocessing steps were applied for the two datasets to accommodate differences in their overall levels of sparsity and the sequencing depths of the cells.</p>
      <sec>
        <title>3.2.1 scRNA-seq of iPS cells during dopaminergic neuron differentiation</title>
        <p>The Jerber-2021 dataset (<xref rid="btad592-B10" ref-type="bibr">HipSci Consortium <italic toggle="yes">et al.</italic> 2021</xref>) harbors scRNA-seq data of 215 iPSC lines differentiating toward a mid-brain neural fate from the Human Induced Pluripotent Stem Cell Initiative (HipSci). Cells were collected for scRNA-seq profiling on days 11, 30, and 52 (day-11, day-30, and day-52). We considered the scRNA-seq count matrices from the three time points together for preprocessing. We retained genes expressed in at least <inline-formula id="IE92"><mml:math id="IM92" display="inline" overflow="scroll"><mml:mrow><mml:mn>0.5</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> of the cells and selected top 3000 highly variable genes using the function <monospace>pp.filter_genes_dispersion</monospace> from Python package <monospace>Scanpy</monospace>. We normalized the count matrix for each donor using the <monospace>R</monospace> package <monospace>SCTransform</monospace> (<xref rid="btad592-B8" ref-type="bibr">Hafemeister and Satija 2019</xref>) and adjusted for covariates “<monospace>pool_id</monospace>”, “<monospace>time_point</monospace>”, and “<monospace>treatment</monospace>” for batch correction. Leveraging the cell type annotations from the original publication (<xref rid="btad592-B10" ref-type="bibr">HipSci Consortium <italic toggle="yes">et al.</italic> 2021</xref>), we excluded day-11 from the analysis as it predominantly harbored progenitor cells which matured into young and mature neurons in the following time points. We focused on day-30 and day-52 both of which had dopaminergic neurons (DA), serotonin transporter (Sert), and ependymal-like 1 (Epen1) cell types. Furthermore, donors that (i) do not express the 3000 highly variable genes, i.e. have zero expression count across all cells, for one or more “time point-cell type” combinations; (ii) have fewer than 500 cells for any specific “time point-cell type” combination were filtered out for a robust estimation of gene co-expression networks. This resulted in 16, 22, and 8 donors, respectively, for DA, Sert, and Epen1 cell types. Finally, we constructed cell-type specific gene–gene Pearson correlation matrices for each donor at each time point.</p>
      </sec>
      <sec>
        <title>3.2.2 scRNA-seq of CD4<inline-formula id="IE93"><mml:math id="IM93" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> T cells during activation</title>
        <p>The Soskic-2022 dataset (<xref rid="btad592-B23" ref-type="bibr">Soskic <italic toggle="yes">et al.</italic> 2022</xref>) contains scRNA-seq profiling of 600k CD4<inline-formula id="IE94"><mml:math id="IM94" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> T cells in a time course of activation after stimulation with anti-CD3/anti-CD28 beads. Cells were collected for scRNA-seq profiling before (0-h) and at 16-h, 40-h, and 5-days after stimulation. We considered the scRNA-seq count matrices from the four time points together for preprocessing and retained genes expressed in at least <inline-formula id="IE95"><mml:math id="IM95" display="inline" overflow="scroll"><mml:mrow><mml:mn>2</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> of the cells for initial gene filtering. All the ribosomal and mitochondrial genes were further removed. Datasets from specific time points and donor combinations with more than 200 cells were retained for the construction of networks. Due to the large sequencing depth differences between the cells profiled at different time points in this dataset, we applied <monospace>Dozer (</monospace><xref rid="btad592-B17" ref-type="bibr">Lu and Keleş 2023</xref><monospace>)</monospace>, which utilizes a Poisson measurement error model, to robustly estimate personalized gene co-expression networks. Furthermore, to improve the reliability and reproducibility of gene co-expression networks, we filtered out noisy and sparse genes using the “noise-ratio” metric from <monospace>Dozer</monospace> and retained 408 genes. Finally, this preprocessing yielded 79 healthy donors with co-expression networks of CD4<inline-formula id="IE96"><mml:math id="IM96" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> Naive cells for 408 genes across the four time points.</p>
        <p>For both datasets, the resulting co-expression matrices were then converted into unweighted adjacency matrices by keeping the top <inline-formula id="IE97"><mml:math id="IM97" display="inline" overflow="scroll"><mml:mrow><mml:mn>5</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> of the edges [as commonly practiced in gene co-expression network construction from scRNA-seq (<xref rid="btad592-B13" ref-type="bibr">Iacono <italic toggle="yes">et al.</italic> 2019</xref>)] based on absolute values of their correlations. While this approach is commonly practiced and appears reasonable for these datasets (<xref rid="sup1" ref-type="supplementary-material">Supplementary Section S8</xref>), alternatives that formally test for the edges in the co-expression networks could also be used (<xref rid="btad592-B25" ref-type="bibr">Su <italic toggle="yes">et al.</italic> 2022</xref>).</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>4 Results</title>
    <sec>
      <title>4.1 Performance comparison with simulation experiments</title>
      <p>We compared MuDCoD, PisCES, baseline static spectral clustering (“static”), and Betzel-2019 on simulated networks to assess their performance in community detection over the subject and time dimensions. We utilized the same selection procedure for the number of communities, <italic toggle="yes">K</italic>, when running PisCES, MuDCoD and “static” (<xref rid="sup1" ref-type="supplementary-material">Supplementary Section S1.2</xref>). We used the network cross-validation approach to determine the tuning hyperparameters <inline-formula id="IE98"><mml:math id="IM98" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula> and <inline-formula id="IE99"><mml:math id="IM99" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula> for MuDCoD, and <inline-formula id="IE100"><mml:math id="IM100" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula> for PisCES. Our choice of PisCES and “static” to compare MuDCoD with is motivated by PisCES’s overall established advantages over the two additional methods that <xref rid="btad592-B16" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> (2018)</xref> had considered. Since Betzel-2019 has a different hyperparameter structure, we followed its default procedure, and provided the implementation details in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S3</xref>. To measure the similarity between the inferred and the ground truth gene communities of each method, we used the adjusted Rand index (ARI) (<xref rid="btad592-B11" ref-type="bibr">Hubert and Arabie 1985</xref>) as also used in <xref rid="btad592-B16" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> (2018)</xref>.</p>
      <p>We conducted simulations under the SoSS and SSoT settings of MuS-Dynamic-DCBM with 16 subjects and for <inline-formula id="IE101"><mml:math id="IM101" display="inline" overflow="scroll"><mml:mrow><mml:mi>T</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>8</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. The rest of the parameters were set as follows: network sizes <inline-formula id="IE102"><mml:math id="IM102" display="inline" overflow="scroll"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mn>500</mml:mn></mml:mrow></mml:math></inline-formula>, number of communities <inline-formula id="IE103"><mml:math id="IM103" display="inline" overflow="scroll"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>, in-cluster and out-cluster density parameters <inline-formula id="IE104"><mml:math id="IM104" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>in</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0.2</mml:mn><mml:mo>,</mml:mo><mml:mn>0.4</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE105"><mml:math id="IM105" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>out</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:mn>0.1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. We further considered varying <inline-formula id="IE106"><mml:math id="IM106" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>time</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE107"><mml:math id="IM107" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> levels. Here, <inline-formula id="IE108"><mml:math id="IM108" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>time</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the probability of a node changing its module label over two adjacent time points, and, similarly, <inline-formula id="IE109"><mml:math id="IM109" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the probability of a node changing its module label across two subjects. For example, setting <inline-formula id="IE110"><mml:math id="IM110" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> corresponds to the case where modules are similar across subjects, while <inline-formula id="IE111"><mml:math id="IM111" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> corresponds to the setting where the modules of the subjects vary considerably and do not share any signal. Similarly, <inline-formula id="IE112"><mml:math id="IM112" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>time</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE113"><mml:math id="IM113" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>time</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> yield constant and rapidly changing module labels across time, respectively. We conducted 100 simulation replicates and compared the methods based on the average ARI values over these replicates.</p>
      <p><xref rid="btad592-F3" ref-type="fig">Figure 3a</xref> and b summarizes the results of these two general settings. For both settings, as <inline-formula id="IE114"><mml:math id="IM114" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and/or <inline-formula id="IE115"><mml:math id="IM115" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>time</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> increases, ARIs of MuDCoD, PisCES, and Betzel-2019 tend to decrease and, eventually, MuDCoD and PisCES perform similarly to the baseline “static”. This immediate observation is expected because, as the community structures among the subjects and/or along the adjacent time points become more dissimilar, promoting information sharing across either dimension is no longer advantageous. Compared to other methods, performance of Betzel-2019 appears to be most sensitive against increasing <inline-formula id="IE116"><mml:math id="IM116" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE117"><mml:math id="IM117" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>time</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. For <inline-formula id="IE118"><mml:math id="IM118" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>≥</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math></inline-formula> and/or <inline-formula id="IE119"><mml:math id="IM119" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>time</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>≥</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math></inline-formula>, Betzel-2019 achieves ARI values that are even less than (up to 0.2 less) those of the baseline static spectral clustering, and results in ARI values &lt;0.2 when <inline-formula id="IE120"><mml:math id="IM120" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> and/or <inline-formula id="IE121"><mml:math id="IM121" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>time</mml:mtext><mml:mo>=</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula>.</p>
      <fig position="float" id="btad592-F3">
        <label>Figure 3.</label>
        <caption>
          <p>Evaluation of the identified communities under two different MuS-Dynamic-DCBM settings: (a) SSoS and (b) SSoT. The simulation parameters were set as follows: the network size is <inline-formula id="IE122"><mml:math id="IM122" display="inline" overflow="scroll"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mn>500</mml:mn></mml:mrow></mml:math></inline-formula>, the number of class labels <inline-formula id="IE123"><mml:math id="IM123" display="inline" overflow="scroll"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>, the in-cluster and out-cluster density parameters <inline-formula id="IE124"><mml:math id="IM124" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>in</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0.2</mml:mn><mml:mo>,</mml:mo><mml:mn>0.4</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE125"><mml:math id="IM125" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>out</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:mn>0.1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, number of subjects <inline-formula id="IE126"><mml:math id="IM126" display="inline" overflow="scroll"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math></inline-formula>, and the number of time points <inline-formula id="IE127"><mml:math id="IM127" display="inline" overflow="scroll"><mml:mrow><mml:mi>T</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>8</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. <italic toggle="yes">x</italic>-axis is the number of time points <italic toggle="yes">T</italic>, and <italic toggle="yes">y</italic>-axis is the mean ARI of the inferred modules for all subjects and time steps across 100 simulation replicates.</p>
        </caption>
        <graphic xlink:href="btad592f3" position="float"/>
      </fig>
      <p>For the SSoT setting, <xref rid="btad592-F3" ref-type="fig">Fig. 3b</xref> reveals that even for the case with the most module heterogeneity along the subject and time dimensions <inline-formula id="IE128"><mml:math id="IM128" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE129"><mml:math id="IM129" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>time</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, PisCES and MuDCoD perform slightly better than both “static” and Betzel-2019. MuDCoD consistently performs better when there are varying levels of information sharing among the subjects <inline-formula id="IE130"><mml:math id="IM130" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0.2</mml:mn><mml:mo>,</mml:mo><mml:mn>0.5</mml:mn><mml:mo>}</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and the modules are completely conserved across the time dimension <inline-formula id="IE131"><mml:math id="IM131" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>time</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, yielding more than <inline-formula id="IE132"><mml:math id="IM132" display="inline" overflow="scroll"><mml:mrow><mml:mn>20</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> increase in the ARI with <inline-formula id="IE133"><mml:math id="IM133" display="inline" overflow="scroll"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math></inline-formula>, compared to second best PisCES.</p>
      <p>For the SSoS setting, <xref rid="btad592-F3" ref-type="fig">Fig. 3a</xref> highlights MuDCoD as significantly outperforming other methods for relatively small <inline-formula id="IE134"><mml:math id="IM134" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> values, and performing robustly against increasing <inline-formula id="IE135"><mml:math id="IM135" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>time</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> values. For the <inline-formula id="IE136"><mml:math id="IM136" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula>, MuDCoD performs no worse than other methods, if not negligibly better. When <inline-formula id="IE137"><mml:math id="IM137" display="inline" overflow="scroll"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math></inline-formula>, the average increase in ARI is about <inline-formula id="IE138"><mml:math id="IM138" display="inline" overflow="scroll"><mml:mrow><mml:mn>20</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE139"><mml:math id="IM139" display="inline" overflow="scroll"><mml:mrow><mml:mn>8</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> for <inline-formula id="IE140"><mml:math id="IM140" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE141"><mml:math id="IM141" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math></inline-formula>, respectively. The mean ARI increase is markedly high for some settings. For example, when <inline-formula id="IE142"><mml:math id="IM142" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE143"><mml:math id="IM143" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>time</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math></inline-formula>, increase in the mean ARI reaches to almost <inline-formula id="IE144"><mml:math id="IM144" display="inline" overflow="scroll"><mml:mrow><mml:mn>30</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> with <inline-formula id="IE145"><mml:math id="IM145" display="inline" overflow="scroll"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math></inline-formula>. Even with an extreme value of <inline-formula id="IE146"><mml:math id="IM146" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula>, which corresponds to high levels of heterogeneity between the subject modules, MuDCoD performs again at least as well as the other methods. PisCES and MuDCoD exhibit increasing performances as <italic toggle="yes">T</italic> increases, supporting the merits of information sharing across the time dimension. In contrast to PisCES and MuDCoD, Betzel-2019 appears to only benefit from increasing the time horizon when <inline-formula id="IE147"><mml:math id="IM147" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE148"><mml:math id="IM148" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>subject</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> are both set to zero.</p>
    </sec>
    <sec>
      <title>4.2 Application of MuDCoD to discover multi-subject dynamic gene communities</title>
      <sec>
        <title>4.2.1 Analysis of <xref rid="btad592-B10" ref-type="bibr">HipSci Consortium <italic toggle="yes">et al.</italic> (2021)</xref> dataset</title>
        <p>We next applied MuDCoD along with PisCES and static spectral clustering to discover personalized gene communities from the scRNA-seq data of human-induced pluripotent stem cells (<xref rid="btad592-B10" ref-type="bibr">HipSci Consortium <italic toggle="yes">et al.</italic> 2021</xref>). We specifically focused on cell types DA (16 donors, 1955 retained genes), Sert (22 donors and 2234 retained genes) and Epen1 (8 donors and 2475 retained genes) on days 30 and 52. Inferred communities varied in their sizes and densities (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>). Overall, the typical runtimes of MuDCoD and PisCES were comparable, ranging between 30 min and 1.5 h for about 2000 genes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Section S7</xref>).</p>
        <p>MuDCoD promotes the smoothness of spectral representations over donors within a time point; therefore, we would expect the gene modules across donors within a time point to be more similar to each other compared to PisCES and static spectral clustering, which treat each donor separately. We assessed to what extent this was realized in this application by calculating the normalized mutual information (NMI) scores (<xref rid="btad592-B24" ref-type="bibr">Strehl and Ghosh 2003</xref>) among the discovered gene modules of the donors at each time point. <xref rid="btad592-F4" ref-type="fig">Figure 4a</xref> and b displays the histograms of NMI scores between every pair of donors on day-30 and day-52. First, we observe that MuDCoD and PisCES infer gene modules that are more similar to each other across subjects, compared to static spectral clustering. Between MuDCoD and PisCES, MuDCoD tends to yield higher, but not statistically significant, NMI scores between donors on day-30 (<xref rid="btad592-F4" ref-type="fig">Fig. 4a</xref>) and it leads to significantly higher scores at day-52 (<xref rid="btad592-F4" ref-type="fig">Fig. 4b</xref>, Wilcoxon rank-sum test <italic toggle="yes">P</italic>-value of 0.0003), highlighting the impact of information sharing across the donors. Furthermore, this does not incur at the cost of additional smoothing over the time domain, as MuDCoD identified communities of donors display a level of heterogeneity comparable to those of PisCES across the time points (<xref rid="btad592-F4" ref-type="fig">Fig. 4c</xref>).</p>
        <fig position="float" id="btad592-F4">
          <label>Figure 4.</label>
          <caption>
            <p>NMI scores between inferred gene modules of donor and time point pairs aggregated across all cell types. (a) and (b) quantify NMI scores between modules of every pair of donors on day-30 and day-52, respectively. (c) displays NMI scores between inferred gene modules of each donor on day-30 and on day-52. The <italic toggle="yes">y</italic>-axis denotes the percentage of donor pairs.</p>
          </caption>
          <graphic xlink:href="btad592f4" position="float"/>
        </fig>
        <p>Following these general observations, we investigated the biological implications of MuDCoD results. To elucidate the biological processes that the modules might be involved in, we conducted gene set enrichment analysis of the discovered modules of each donor at each time point with <monospace>clusterProfiler</monospace> (<xref rid="btad592-B30" ref-type="bibr">Yu <italic toggle="yes">et al.</italic> 2012</xref>), with an emphasis on the Gene Ontology (GO) biological processes. We only focused on the communities with sizes larger than 20. Our analysis limited the background gene sets in <monospace>clusterProfiler</monospace> to only those genes that were used in the construction of the adjacency matrices and used the Benjamini-Hochberg procedure (<xref rid="btad592-B2" ref-type="bibr">Benjamini and Hochberg 1995</xref>) for false discovery rate (FDR) control at 0.05. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S3</xref> highlights that some general biological processes, e.g. general cell-cycle and cell division-related processes, are enriched across the communities of all donors. In addition, we also observe processes specific to subsets of donors, highlighting the personalized nature of the communities.</p>
        <p>Next, to further explore the utility of our results, we leveraged the grouping of the donors based on the differentiation efficiency of their cells during dopaminergic neuron differentiation, as defined in <xref rid="btad592-B10" ref-type="bibr">HipSci Consortium <italic toggle="yes">et al.</italic> (2021)</xref>. We specifically assessed whether donors with low and high differentiation efficiency exhibited varying levels of similarity among their modules inferred at different time points. <xref rid="btad592-F5" ref-type="fig">Figure 5a</xref> displays the NMI scores between the inferred modules of day-30 and day-52 for each donor, and suggests that donors with lower differentiation efficiency tend to have higher levels of similarity among their gene communities inferred at the two-time points (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S8a and S9a</xref> for qualitatively similar results of PisCES and static spectral clustering). We then focused on cell type Epen1, which is not used in the definition of differentiation efficiency by <xref rid="btad592-B10" ref-type="bibr">HipSci Consortium <italic toggle="yes">et al.</italic> (2021)</xref>, and asked whether differences in the donor-specific communities are associated with the differentiation efficiency. This resulted in markedly higher module similarity within each group (i.e. high versus low differentiation efficiency) and lower across groups (<xref rid="btad592-F5" ref-type="fig">Fig. 5b</xref>). We observed similar trends with PisCES and static spectral clustering (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S8b and S9b</xref>). Furthermore, consistent with the differentiation dynamics (<xref rid="btad592-B10" ref-type="bibr">HipSci Consortium <italic toggle="yes">et al.</italic> 2021</xref>), we also observed relatively higher heterogeneity within the high group compared to the low group. Collectively, these observations support that personalized modules inferred by MuDCoD recapitulate the underlying differentiation efficiencies of donor iPS cells.</p>
        <fig position="float" id="btad592-F5">
          <label>Figure 5.</label>
          <caption>
            <p>(a) NMI scores of each donor between the MuDCoD inferred modules on day-30 and on day-52 against the differentiation efficiency. For each cell type (DA, Sert, Epen1), each donor’s modules from day-30 and day-52 were compared with NMI and plotted against donor’s differentiation efficiency. (b) Comparison of the mean NMI scores within and between the low and high differentiation efficiency groups of Epen1 cells. Donor labels for differentiation efficiency were obtained from <xref rid="btad592-B10" ref-type="bibr">HipSci Consortium <italic toggle="yes">et al.</italic> (2021)</xref>. NMI scores between pairs of donors are calculated based on their MuDCoD inferred modules. Differentiation efficiency groups were generated based on the percentiles of differentiation efficiency values across the donors, i.e. 50-th percentile (inclusive) corresponds to the low differentiation efficiency group.</p>
          </caption>
          <graphic xlink:href="btad592f5" position="float"/>
        </fig>
      </sec>
      <sec>
        <title>4.2.2 Analysis of <xref rid="btad592-B23" ref-type="bibr">Soskic <italic toggle="yes">et al.</italic> (2022)</xref> dataset</title>
        <p>We applied MuDCoD along with PisCES and static spectral clustering to discover dynamic gene modules from the scRNA-seq data of CD4<inline-formula id="IE149"><mml:math id="IM149" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> T cell activation (<xref rid="btad592-B23" ref-type="bibr">Soskic <italic toggle="yes">et al.</italic> 2022</xref>). This dataset includes both memory and naive CD4<inline-formula id="IE150"><mml:math id="IM150" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> T cells isolated from peripheral blood. We focused on Naive CD4<inline-formula id="IE151"><mml:math id="IM151" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> T cells, which have not yet encountered an antigen. The entire dataset captures transcriptional states of unstimulated cells (0-h) and three time points (16-h, 40-h, and 5-days after the stimulation) of cell activation in 79 healthy donors, and 408 retained genes, as described in Section 3.2.2. <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref> reports characteristics of inferred communitites at different time points. Similar to Jerber-2021, the typical runtimes of MuDCoD and PisCES in this dataset were comparable, usually ranging between 20 min and 1 h (<xref rid="sup1" ref-type="supplementary-material">Supplementary Section S7</xref>).</p>
        <p>Similar to the analysis of <xref rid="btad592-B10" ref-type="bibr">HipSci Consortium <italic toggle="yes">et al.</italic> (2021)</xref> dataset, we first evaluated to what extent MuDCoD promoted smoothness of spectral representations among donors within a time point compared to PisCES by leveraging the NMI scores. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4</xref> displays the histograms of NMI scores between all possible pairs of donors at time points 0-h, 16-h, 40-h, and 5-days for modules inferred by MuDCoD, PisCES and static spectral clustering. Consistent with our expectation, MuDCoD tends to yield higher NMI scores (one-sided Wilcoxon rank-sum test <italic toggle="yes">P</italic>-values of 0.0003, 0.01, and 0.00019, respectively, for the time points 0-h, 16-h, and 5-days). The higher similarities among the gene modules across donors highlight the impact of information sharing across the donors at fixed time points.</p>
        <p>Next, we assessed how the similarities between donors change as donor cells respond to stimulation over time. Specifically, we computed the mean NMI scores between each donor and the rest of the donors at all four time points separately. <xref rid="btad592-F6" ref-type="fig">Figure 6a</xref> displays mean NMI scores that range between 0.05 and 0.2 across the time points. This comparison reveals that the inferred community structures of donors tend to be more similar at 16-h after stimulation, as evidenced by the significant <italic toggle="yes">P</italic>-values (≤0.05) of the one-sided Wilcoxon rank sum tests comparing mean NMI scores at 16-h with those at other time points. We note that 16-h corresponds to the first measurement of gene expression right after stimulation of the T cells and before the first cell division. Hence, the increased similarity across donors may correspond to the concerted activity of T cell activation related genes and pathways. Analysis of PisCES and static spectral clustering output led to qualitatively similar results (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S10A and S11A</xref>).</p>
        <fig position="float" id="btad592-F6">
          <label>Figure 6.</label>
          <caption>
            <p>(a) Normalized mutual information scores between pairs of donors based on their gene modules inferred by MuDCoD at each time point. Each data point stands for a donor, and the <italic toggle="yes">y</italic>-axis denotes the mean of NMI scores between that donor and other donors at the corresponding time point. All the statistically significant comparisons with time point 16-h from the one-sided Wilcoxon rank-sum test are marked (with <italic toggle="yes">P</italic>-value≤0.05), *** and **** stand for <italic toggle="yes">P</italic>-value≤0.001 and <italic toggle="yes">P</italic>-value≤0.0001, respectively. (b) Set of top fifteen frequent significantly enriched biological processes (with the adjusted <italic toggle="yes">P</italic>-values <inline-formula id="IE153"><mml:math id="IM153" display="inline" overflow="scroll"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>) of most prioritized communities contributed by each donor at different time points. Overall, <inline-formula id="IE154"><mml:math id="IM154" display="inline" overflow="scroll"><mml:mrow><mml:mn>79</mml:mn><mml:mo>×</mml:mo><mml:mn>4</mml:mn><mml:mo>=</mml:mo><mml:mn>316</mml:mn></mml:mrow></mml:math></inline-formula> gene sets were contributed by 79 donors at 4 time points, and correspondingly, 316 separate enrichment analyses were performed. Displayed are significant biological processes, their corresponding number of appearances in the most prioritized communities of donors, and the minimum <italic toggle="yes">P</italic>-values of enrichment among those communities.</p>
          </caption>
          <graphic xlink:href="btad592f6" position="float"/>
        </fig>
        <p>Following these general observations, we investigated the biological implications of MuDCoD results. MuDCoD fully partitions genes into modules. However, not all gene modules are necessarily interesting or biologically relevant. Furthermore, due to dropouts in scRNA-seq data, it is likely that only a small number of the inferred communities are biologically relevant (i.e. prioritized communities) and should be subject to further interpretation. We utilized CRank (<xref rid="btad592-B32" ref-type="bibr">Zitnik <italic toggle="yes">et al.</italic> 2018</xref>) to rank the resulting communities. Specifically, we ranked inferred communities of each donor’s network and identified the one with the highest rank, i.e. the most prioritized community. In the case of ties in CRank scores, we prioritized the larger community. This prioritization resulted in <inline-formula id="IE155"><mml:math id="IM155" display="inline" overflow="scroll"><mml:mrow><mml:mn>79</mml:mn><mml:mo>×</mml:mo><mml:mn>4</mml:mn><mml:mo>=</mml:mo><mml:mn>316</mml:mn></mml:mrow></mml:math></inline-formula> gene sets when aggregated across donors and time points. Next, we conducted gene set enrichment analysis with GO biological processes for each of the prioritized modules using <monospace>clusterProfiler</monospace> (<xref rid="btad592-B30" ref-type="bibr">Yu <italic toggle="yes">et al.</italic> 2012</xref>). In order to summarize and elucidate the underlying biological processes at each time point, we calculated the frequencies of significant GO terms [FDR control at level 0.05 with the Benjamini-Hochberg procedure (<xref rid="btad592-B2" ref-type="bibr">Benjamini and Hochberg 1995</xref>) at each time point]. <xref rid="btad592-F6" ref-type="fig">Figure 6b</xref> displays the top 15 most frequently enriched GO terms at each time point, along with their frequencies (i.e. number of appearances across donors) and minimum adjusted <italic toggle="yes">P</italic>-values across the donors (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S10B and S11B</xref> for PisCES and statistc spectral clustering, respectively). Time point specific enriched biological processes appear consistent with the mechanisms governing CD4<inline-formula id="IE156"><mml:math id="IM156" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> T cell activation (<xref rid="btad592-B12" ref-type="bibr">Hwang <italic toggle="yes">et al.</italic> 2020</xref>). For example, positive regulation of T cell activation is among the top 15 most frequent terms only at 16-h and 40-h after stimulation, and we start to observe positive regulation of cytokine production more frequently at 40-h after stimulation. While these results require further analysis to reveal more detailed biological insights, MuDCoD successfully highlights how multi-subject module detection promoting module smoothness over the subject and time dimensions can yield gene modules that associate with specific biological conditions and phenotypes.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>5 Conclusion</title>
    <p>As advances in single-cell profiling technologies allow charting transcriptomes of individuals at unprecedented resolutions across developmental and cellular stages, analysis of personalized dynamic gene networks is poised to emerge as a critical tool for elucidating network-level variations among subjects to explain phenotypic variation. In this work, we developed a global spectral clustering framework that promotes information sharing among subjects and adjacent time points. MuDCoD utilizes co-expression networks to infer co-expression modules and can be effectively combined with any co-expression network construction method. For population-scale scRNA-seq data, we recommend using Dozer (<xref rid="btad592-B17" ref-type="bibr">Lu and Keleş 2023</xref>), which uses a Poisson measurement error model to handle sparsity and correct gene pair correlation biases. In addition, thresholding the subject-specific co-expression networks to obtain adjacency matrices should also be tailored by taking into account the gene–gene correlation distribution characteristics of the datasets. Recent developments in testing of gene–gene correlations, like CS-CORE (<xref rid="btad592-B25" ref-type="bibr">Su <italic toggle="yes">et al.</italic> 2022</xref>), offer potential insights into binarizing co-expression networks.</p>
    <p>Our simulation experiments highlighted the superior performance of MuDCoD over existing alternatives. Applications to two population-scale scRNA-seq datasets revealed that MuDCoD infers biologically meaningful and relevant communities in multi-subject dynamic scRNA-seq datasets. While our current framework encourages information sharing among all subjects, it can be extended to accommodate groupings among subjects where the communities are persistent only within the group members. Such an extension could be useful, especially when an apparent grouping such as healthy versus diseased subjects exists in the dataset. Finally, we expect this multi-subject setting to be useful in other domains to infer network community structures with the availability of multiple samples.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad592_Supplementary_Data</label>
      <media xlink:href="btad592_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by National Institutes of Health (NIH) grant HG003747 and a Chan Zuckerberg Initiative (CZI) Single Cell Data Insights grant to S.K.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data Availability</title>
    <p>MuDCoD is implemented in Python, the source code and the sripts used to conduct experiments are available at <ext-link xlink:href="https://github.com/bo1929/MuDCoD" ext-link-type="uri">https://github.com/bo1929/MuDCoD</ext-link>. The datasets were derived from <xref rid="btad592-B10" ref-type="bibr">Jerber <italic toggle="yes">et al.</italic> 2021</xref> and<xref rid="btad592-B23" ref-type="bibr"> Soskic <italic toggle="yes">et al.</italic> 2022</xref>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad592-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bassett</surname><given-names>DS</given-names></string-name>, <string-name><surname>Porter</surname><given-names>MA</given-names></string-name>, <string-name><surname>Wymbs</surname><given-names>NF</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Robust detection of dynamic community structure in networks</article-title>. <source>Chaos</source>  <year>2013</year>;<volume>23</volume>:<fpage>013142</fpage>.<pub-id pub-id-type="pmid">23556979</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Benjamini</surname><given-names>Y</given-names></string-name>, <string-name><surname>Hochberg</surname><given-names>Y.</given-names></string-name></person-group>  <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>. <source>J R Stat Soc Ser B (Methodological)</source>  <year>1995</year>;<volume>57</volume>:<fpage>289</fpage>–<lpage>300</lpage>.</mixed-citation>
    </ref>
    <ref id="btad592-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Betzel</surname><given-names>RF</given-names></string-name>, <string-name><surname>Bertolero</surname><given-names>MA</given-names></string-name>, <string-name><surname>Gordon</surname><given-names>EM</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>The community structure of functional brain networks exhibits scale-specific patterns of inter- and intra-subject variability</article-title>. <source>Neuroimage</source>  <year>2019</year>;<volume>202</volume>:<fpage>115990</fpage>.<pub-id pub-id-type="pmid">31291606</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>Y-JJ</given-names></string-name>, <string-name><surname>Friedman</surname><given-names>BA</given-names></string-name>, <string-name><surname>Ha</surname><given-names>C</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Single-cell RNA sequencing identifies distinct mouse medial ganglionic eminence cell types</article-title>. <source>Sci Rep</source>  <year>2017</year>;<volume>7</volume>:<fpage>45656</fpage>.<pub-id pub-id-type="pmid">28361918</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chi</surname><given-names>Y</given-names></string-name>, <string-name><surname>Song</surname><given-names>X</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>D</given-names></string-name></person-group> <italic toggle="yes">et al.</italic> Evolutionary spectral clustering by incorporating temporal smoothness. In: <italic toggle="yes">Proceedings of the 13th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</italic>. New York, Association for Computing Machinery, <volume>2007</volume>, <fpage>153</fpage>–<lpage>62</lpage>.</mixed-citation>
    </ref>
    <ref id="btad592-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cribben</surname><given-names>I</given-names></string-name>, <string-name><surname>Yu</surname><given-names>Y.</given-names></string-name></person-group>  <article-title>Estimating whole-brain dynamics by using spectral clustering</article-title>. <source>J R Stat Soc Ser C (Appl Stat)</source>  <year>2017</year>;<volume>66</volume>:<fpage>607</fpage>–<lpage>27</lpage>.</mixed-citation>
    </ref>
    <ref id="btad592-B9">
      <mixed-citation publication-type="journal">Cuomo ASE, Seaton DD, McCarthy DJ <italic toggle="yes">et al</italic>. <article-title>Single-cell RNA-sequencing of differentiating iPS cells reveals dynamic genetic effects on gene expression</article-title>. <source>Nat Commun</source>  <year>2020</year>;<volume>11</volume>:<fpage>810</fpage>.<pub-id pub-id-type="pmid">32041960</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dai</surname><given-names>H</given-names></string-name>, <string-name><surname>Li</surname><given-names>L</given-names></string-name>, <string-name><surname>Zeng</surname><given-names>T</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Cell-specific network constructed by single-cell RNA sequencing data</article-title>. <source>Nucleic Acids Res</source>  <year>2019</year>;<volume>47</volume>:<fpage>e62</fpage>.<pub-id pub-id-type="pmid">30864667</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hafemeister</surname><given-names>C</given-names></string-name>, <string-name><surname>Satija</surname><given-names>R.</given-names></string-name></person-group>  <article-title>Normalization and variance stabilization of single-cell RNA-seq data using regularized negative binomial regression</article-title>. <source>Genome Biol</source>  <year>2019</year>;<volume>20</volume>:<fpage>296</fpage>.<pub-id pub-id-type="pmid">31870423</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hubert</surname><given-names>L</given-names></string-name>, <string-name><surname>Arabie</surname><given-names>P.</given-names></string-name></person-group>  <article-title>Comparing partitions</article-title>. <source>J Classif</source>  <year>1985</year>;<volume>2</volume>:<fpage>193</fpage>–<lpage>218</lpage>.</mixed-citation>
    </ref>
    <ref id="btad592-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hwang</surname><given-names>J-R</given-names></string-name>, <string-name><surname>Byeon</surname><given-names>Y</given-names></string-name>, <string-name><surname>Kim</surname><given-names>D</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Recent insights of T cell receptor-mediated signaling pathways for T cell activation and development</article-title>. <source>Exp Mol Med</source>  <year>2020</year>;<volume>52</volume>:<fpage>750</fpage>–<lpage>61</lpage>.<pub-id pub-id-type="pmid">32439954</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Iacono</surname><given-names>G</given-names></string-name>, <string-name><surname>Massoni-Badosa</surname><given-names>R</given-names></string-name>, <string-name><surname>Heyn</surname><given-names>H</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Single-cell transcriptomics unveils gene regulatory network plasticity</article-title>. <source>Genome Biol</source>  <year>2019</year>;<volume>20</volume>:<fpage>110</fpage>–<lpage>20</lpage>.<pub-id pub-id-type="pmid">31159854</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jackson</surname><given-names>CA</given-names></string-name>, <string-name><surname>Castro</surname><given-names>DM</given-names></string-name>, <string-name><surname>Saldi</surname><given-names>G-A</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Gene regulatory network reconstruction using single-cell RNA sequencing of barcoded genotypes in diverse environments</article-title>. <source>Elife</source>  <year>2020</year>;<volume>9</volume>:<fpage>e51254</fpage>.<pub-id pub-id-type="pmid">31985403</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jerber</surname><given-names>J</given-names></string-name>, <string-name><surname>Seaton</surname><given-names>DD</given-names></string-name>, <string-name><surname>Cuomo</surname><given-names>ASE</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Population-scale single-cell RNA-seq profiling across dopaminergic neuron differentiation</article-title>. <source>Nat Genet</source>  <year>2021</year>;<volume>53</volume>:<fpage>304</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">33664506</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>T</given-names></string-name>, <string-name><surname>Levina</surname><given-names>E</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>J</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Network cross-validation by edge sampling</article-title>. <source>Biometrika</source>  <year>2020</year>;<volume>107</volume>:<fpage>257</fpage>–<lpage>76</lpage>.</mixed-citation>
    </ref>
    <ref id="btad592-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>F</given-names></string-name>, <string-name><surname>Choi</surname><given-names>D</given-names></string-name>, <string-name><surname>Xie</surname><given-names>L</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Global spectral clustering in dynamic networks</article-title>. <source>Proc Natl Acad Sci USA</source>  <year>2018</year>;<volume>115</volume>:<fpage>927</fpage>–<lpage>32</lpage>.<pub-id pub-id-type="pmid">29339482</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lu</surname><given-names>S</given-names></string-name>, <string-name><surname>Keleş</surname><given-names>S.</given-names></string-name></person-group>  <article-title>Debiased personalized gene coexpression networks for population-scale scRNA-seq data</article-title>. <source>Genome Res</source>  <year>2023</year>;<volume>33</volume>:<fpage>932</fpage>–<lpage>47</lpage>.<pub-id pub-id-type="pmid">37295843</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>X</given-names></string-name>, <string-name><surname>Li</surname><given-names>D</given-names></string-name>, <string-name><surname>Tan</surname><given-names>S</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Detecting evolving communities in dynamic networks using graph regularized evolutionary nonnegative matrix factorization</article-title>. <source>Phys A Stat Mech Its Appl</source>  <year>2019</year>;<volume>530</volume>:<fpage>121279</fpage>.</mixed-citation>
    </ref>
    <ref id="btad592-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mathys</surname><given-names>H</given-names></string-name>, <string-name><surname>Davila-Velderrain</surname><given-names>J</given-names></string-name>, <string-name><surname>Peng</surname><given-names>Z</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Single-cell transcriptomic analysis of Alzheimer’s disease</article-title>. <source>Nature</source>  <year>2019</year>;<volume>570</volume>:<fpage>332</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">31042697</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Matias</surname><given-names>C</given-names></string-name>, <string-name><surname>Miele</surname><given-names>V.</given-names></string-name></person-group>  <article-title>Statistical clustering of temporal networks through a dynamic stochastic block model</article-title>. <source>J R Stat Soc Ser B</source>  <year>2017</year>;<volume>79</volume>:<fpage>1119</fpage>–<lpage>41</lpage>.</mixed-citation>
    </ref>
    <ref id="btad592-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Norman</surname><given-names>U</given-names></string-name>, <string-name><surname>Cicek</surname><given-names>AE.</given-names></string-name></person-group>  <article-title>ST-Steiner: a spatio-temporal gene discovery algorithm</article-title>. <source>Bioinformatics</source>  <year>2019</year>;<volume>35</volume>:<fpage>3433</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">30759247</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shen</surname><given-names>H-W</given-names></string-name>, <string-name><surname>Cheng</surname><given-names>X-Q.</given-names></string-name></person-group>  <article-title>Spectral methods for the detection of network community structure: a comparative analysis</article-title>. <source>J Stat Mech</source>  <year>2010</year>;<volume>2010</volume>:<fpage>P10020</fpage>.</mixed-citation>
    </ref>
    <ref id="btad592-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Soskic</surname><given-names>B</given-names></string-name>, <string-name><surname>Cano-Gamez</surname><given-names>E</given-names></string-name>, <string-name><surname>Smyth</surname><given-names>DJ</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Immune disease risk variants regulate gene expression dynamics during CD4+ T cell activation</article-title>. <source>Nat Genet</source>  <year>2022</year>;<volume>54</volume>:<fpage>817</fpage>–<lpage>26</lpage>.<pub-id pub-id-type="pmid">35618845</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Strehl</surname><given-names>A</given-names></string-name>, <string-name><surname>Ghosh</surname><given-names>J.</given-names></string-name></person-group>  <article-title>Cluster ensembles—a knowledge reuse framework for combining multiple partitions</article-title>. <source>J Mach Learn Res</source>  <year>2003</year>;<volume>3</volume>:<fpage>583</fpage>–<lpage>617</lpage>.</mixed-citation>
    </ref>
    <ref id="btad592-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Su</surname><given-names>C</given-names></string-name>, <string-name><surname>Xu</surname><given-names>Z</given-names></string-name>, <string-name><surname>Shan</surname><given-names>X</given-names></string-name></person-group>  <etal>et al</etal> Cell-type-specific co-expression inference from single cell RNA-sequencing data. <italic toggle="yes">Nat Commun</italic> 2023;<volume>14</volume>:4846.</mixed-citation>
    </ref>
    <ref id="btad592-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ting</surname><given-names>C-M</given-names></string-name>, <string-name><surname>Samdin</surname><given-names>SB</given-names></string-name>, <string-name><surname>Tang</surname><given-names>M</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Detecting dynamic community structure in functional brain networks across individuals: a multilayer approach</article-title>. <source>IEEE Trans Med Imaging</source>  <year>2021</year>;<volume>40</volume>:<fpage>468</fpage>–<lpage>80</lpage>.<pub-id pub-id-type="pmid">33044929</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Travaglini</surname><given-names>KJ</given-names></string-name>, <string-name><surname>Nabhan</surname><given-names>AN</given-names></string-name>, <string-name><surname>Penland</surname><given-names>L</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>A molecular cell atlas of the human lung from single-cell RNA sequencing</article-title>. <source>Nature</source>  <year>2020</year>;<volume>587</volume>:<fpage>619</fpage>–<lpage>25</lpage>.<pub-id pub-id-type="pmid">33208946</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B28">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Xu</surname><given-names>KS</given-names></string-name>, <string-name><surname>Hero</surname><given-names>AO.</given-names></string-name></person-group>  <part-title>Dynamic stochastic blockmodels: statistical models for time-evolving networks</part-title>. In: <person-group person-group-type="editor"><string-name><surname>Greenberg</surname><given-names>AM</given-names></string-name>, <string-name><surname>Kennedy</surname><given-names>WG</given-names></string-name>, <string-name><surname>Bos</surname><given-names>ND</given-names></string-name></person-group> (eds.), <source>Social Computing, Behavioral-Cultural Modeling and Prediction, Lecture Notes in Computer Science</source>. <publisher-loc>Berlin, Heidelberg</publisher-loc>: <publisher-name>Springer</publisher-name>, <year>2013</year>, <fpage>201</fpage>–<lpage>10</lpage>.</mixed-citation>
    </ref>
    <ref id="btad592-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xu</surname><given-names>KS</given-names></string-name>, <string-name><surname>Hero</surname><given-names>AO.</given-names></string-name></person-group>  <article-title>Dynamic stochastic blockmodels for time-evolving social networks</article-title>. <source>IEEE J Sel Top Signal Process</source>  <year>2014</year>;<volume>8</volume>:<fpage>552</fpage>–<lpage>62</lpage>.</mixed-citation>
    </ref>
    <ref id="btad592-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yu</surname><given-names>G</given-names></string-name>, <string-name><surname>Wang</surname><given-names>L-G</given-names></string-name>, <string-name><surname>Han</surname><given-names>Y</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>clusterProfiler: an R package for comparing biological themes among gene clusters</article-title>. <source>OMICS</source>  <year>2012</year>;<volume>16</volume>:<fpage>284</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">22455463</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zeisel</surname><given-names>A</given-names></string-name>, <string-name><surname>Muñoz-Manchado</surname><given-names>AB</given-names></string-name>, <string-name><surname>Codeluppi</surname><given-names>S</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq</article-title>. <source>Science</source>  <year>2015</year>;<volume>347</volume>:<fpage>1138</fpage>–<lpage>42</lpage>.<pub-id pub-id-type="pmid">25700174</pub-id></mixed-citation>
    </ref>
    <ref id="btad592-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zitnik</surname><given-names>M</given-names></string-name>, <string-name><surname>Sosič</surname><given-names>R</given-names></string-name>, <string-name><surname>Leskovec</surname><given-names>J</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Prioritizing network communities</article-title>. <source>Nat Commun</source>  <year>2018</year>;<volume>9</volume>:<fpage>2544</fpage>.<pub-id pub-id-type="pmid">29959323</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
