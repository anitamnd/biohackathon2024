<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Microb Genom</journal-id>
    <journal-id journal-id-type="iso-abbrev">Microb Genom</journal-id>
    <journal-id journal-id-type="hwp">mgen</journal-id>
    <journal-id journal-id-type="publisher-id">mgen</journal-id>
    <journal-title-group>
      <journal-title>Microbial Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2057-5858</issn>
    <publisher>
      <publisher-name>Microbiology Society</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9837567</article-id>
    <article-id pub-id-type="publisher-id">000904</article-id>
    <article-id pub-id-type="doi">10.1099/mgen.0.000904</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Articles</subject>
        <subj-group subj-group-type="heading">
          <subject>Genomic Methodologies</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PneumoKITy: A fast, flexible, specific, and sensitive tool for <italic toggle="yes">Streptococcus pneumoniae</italic> serotype screening and mixed serotype detection from genome sequence data</article-title>
      <alt-title alt-title-type="recto-page-foot">
        <ext-link xlink:href="http://mgen.microbiologyresearch.org" ext-link-type="uri">http://mgen.microbiologyresearch.org</ext-link>
      </alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-2699-9057</contrib-id>
        <name>
          <surname>Sheppard</surname>
          <given-names>Carmen L.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff5" ref-type="aff">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7694-9605</contrib-id>
        <name>
          <surname>Manna</surname>
          <given-names>Sam</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3832-3484</contrib-id>
        <name>
          <surname>Groves</surname>
          <given-names>Natalie</given-names>
        </name>
        <xref rid="aff3" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9215-0553</contrib-id>
        <name>
          <surname>Litt</surname>
          <given-names>David J.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3106-992X</contrib-id>
        <name>
          <surname>Amin-Chowdhury</surname>
          <given-names>Zahin</given-names>
        </name>
        <xref rid="aff4" ref-type="aff">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6226-1172</contrib-id>
        <name>
          <surname>Bertran</surname>
          <given-names>Marta</given-names>
        </name>
        <xref rid="aff4" ref-type="aff">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0856-2476</contrib-id>
        <name>
          <surname>Ladhani</surname>
          <given-names>Shamez</given-names>
        </name>
        <xref rid="aff4" ref-type="aff">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3164-8849</contrib-id>
        <name>
          <surname>Satzke</surname>
          <given-names>Catherine</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4862-6507</contrib-id>
        <name>
          <surname>Fry</surname>
          <given-names>Norman K.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff4" ref-type="aff">
          <sup>4</sup>
        </xref>
        <xref rid="cor1" ref-type="corresp">*</xref>
      </contrib>
      <aff id="aff1"><label><sup>1</sup>​</label><institution content-type="department">Vaccine Preventable Bacteria Section, Respiratory and Vaccine Preventable Bacteria Reference Unit</institution>, <institution>UK Health Security Agency</institution>, <addr-line content-type="city">London NW9 5EQ</addr-line>, <country>UK</country></aff>
      <aff id="aff2"><label><sup>2</sup>​</label><institution content-type="department">Translational Microbiology Group</institution>, <institution>Murdoch Children’s Research Institute, The University of Melbourne Department of Paediatrics at the Royal Children’s Hospital</institution>, <addr-line content-type="city">Parkville, Victoria</addr-line>, <country>Australia</country></aff>
      <aff id="aff3"><label><sup>3</sup>​</label><institution content-type="department">Respiratory and Vaccine Preventable Bacteria Reference Unit</institution>, <institution>UK Health Security Agency</institution>, <addr-line content-type="city">London NW9 5EQ</addr-line>, <country>UK</country></aff>
      <aff id="aff4"><label><sup>4</sup>​</label><institution>Immunisation and Vaccine Preventable Diseases, UK Health Security Agency</institution>, <addr-line content-type="city">London NW9 5EQ</addr-line>, <country>UK</country></aff>
      <aff id="aff5"><label><sup>†</sup>​</label>Present address: Genpax Ltd, 9 Pembridge Road, Notting Hill, London, W11 3JY, UK</aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><bold>*Correspondence:</bold> Norman K. Fry, <email xlink:href="mailto:norman.fry@ukhsa.gov.uk">norman.fry@ukhsa.gov.uk</email>
</corresp>
      <fn fn-type="accession-no">
        <p>European Nucleotide Archive PRJEB14267, PRJEB34491. National Center for Biotechnology Information (NCBI) Sequence Read Archive PRJNA561126. GenBank Accessions - JF911487–JF911531. Figshare repository <ext-link xlink:href="https://figshare.com/" ext-link-type="uri">https://figshare.com/</ext-link> has been used for all Supplementary Tables and Figures: <ext-link xlink:href="https://doi.org/10.6084/m9.figshare.21067339.v1" ext-link-type="uri">https://doi.org/10.6084/m9.figshare.21067339.v1</ext-link>.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <!--PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>.-->
    <volume>8</volume>
    <issue>12</issue>
    <elocation-id>mgen000904</elocation-id>
    <history>
      <date date-type="received">
        <day>08</day>
        <month>6</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>03</day>
        <month>10</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2022 Crown copyright</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This information is licensed under the Open Government Licence 3.0. This is an open-access article distributed under the terms of the Creative Commons Attribution License. This article was made open access via a Publish and Read agreement between the Microbiology Society and the corresponding author’s institution.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="mgen-8-904.pdf"/>
    <abstract>
      <p>Determination of serotypes of <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.5677" ext-link-type="uri">Streptococcus pneumoniae</ext-link></named-content></italic> is essential for monitoring current vaccine programmes. Since October 2017, pneumococcal serotypes in England have been derived from whole genome sequencing (WGS) data using our bioinformatic tool PneumoCaT. That tool was designed for serotype determination from pure cultures in a reference laboratory. To help determine multiple serotypes in pneumococcal carriage samples, we developed a new software tool named PneumoKITy (Pneumococcal K-mer Integrated Typing) that uses the powerful Mash k-mer screening method for pneumococcal serotyping. Mash k-mer screening is more sequence specific and much faster than the mapping method used in PneumoCaT and can determine 54 (58.1  %) of the 93 serotypes in the SSI Diagnostica phenotypical serotyping scheme to type level with the remainder called to serogroup or subgroup level (e.g., 11A/D). PneumoKITy can be run on both FastQ and assembly input, requiring up to 11× less memory and running up to 29× faster than the current version of PneumoCaT (1.2.1) on FastQ files. PneumoKITy can be used as a rapid, flexible serotype screening method which adds sensitive detection of mixed serotypes, e.g., for nasopharyngeal carriage studies where the presence of multiple serotypes is common. PneumoKITy’s ability to function from assembly file, for pure culture serotype detection, increases its speed. This speed potentially enables the software to be run using low infrastructure overhead via web-based platforms. PneumoKITy could be used as a fast initial screening method with other tools used for those serotypes that could not be fully determined to type level if necessary. PneumoKITy was found to be highly accurate and sensitive when run on a panel of FastQ files derived from mixed cultures with all serotypes in 47/51 (92.2  %) of samples being accurately detected. PneumoKITy was also able to accurately estimate the relative abundance of serotypes in the same sample. Estimates being within a mean relative abundance of 1.5 % of the expected abundance in mixtures with known concentrations. PneumoKITy was able to detect minor serotypes with expected abundance of 1 % in the known mixture serotypes. PneumoKITy is a rapid, flexible tool with wide-ranging applications outside of the pure-culture, reference laboratory serotyping remit of PneumoCaT.</p>
    </abstract>
    <kwd-group>
      <kwd>bioinformatics</kwd>
      <kwd>carriage</kwd>
      <kwd>colonisation</kwd>
      <kwd>detection</kwd>
      <kwd>epidemiology</kwd>
      <kwd>Pneumococcus</kwd>
      <kwd>serotyping</kwd>
      <kwd>software</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>OpenAccessEmbargo</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="s2">
    <title>Data Summary</title>
    <p>PneumoCaT development and validation genomic datasets can be obtained on the European Nucleotide Archive (ENA) at project PRJEB14267. Genomic data from Public Health England (PHE), now UK Health Security Agency (UKHSA), pure culture carriage isolates used for validation of the method are available at ENA under project PRJEB34491.</p>
    <p>Genomic data from known mixture (simulated mixed carriage) can be obtained from National Centre for Biotechnology Information (NCBI) Sequence Read Archive under project PRJNA561126.</p>
    <p>The data used in this manuscript are listed in Table 1 and Fig. S1 and Tables S1–S6 <ext-link xlink:href="https://doi.org/10.6084/m9.figshare.21067339" ext-link-type="uri">https://doi.org/10.6084/m9.figshare.21067339.v1</ext-link> [<xref rid="R1" ref-type="bibr">1</xref>].</p>
    <p>PneumoKITy is available on Github at <ext-link xlink:href="https://github.com/CarmenSheppard/PneumoKITy" ext-link-type="uri">https://github.com/CarmenSheppard/PneumoKITy.</ext-link>
</p>
    <boxed-text position="float">
      <caption>
        <title>Impact Statement</title>
      </caption>
      <p>We describe a new bioinformatic tool, PneumoKITy, for determination of <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.5677" ext-link-type="uri">Streptococcus pneumoniae</ext-link></named-content></italic> serotype or serogroup from genomic data. PneumoKITy offers sensitive screening of multiple serotypes in complex samples and is computationally fast and efficient. Sensitive multiple serotype detection is important for detection of low abundance serotypes of pneumococcus circulating in the population, and their potential impact on future vaccination policies. PneumoKITy offers flexible run options and can be optimised for either serotype screening from expected pure or expected mixed culture input. In pure run mode PneumoKITy, uniquely, can be used on both FastQ and genome assembly input data or, if run in mix mode, can screen FastQ data for detection of multiple serotypes. The run time for one genome assembly in pure culture detection mode is milliseconds, and in all run modes PneumoKITy offers reduced run-time and computational load compared to existing methods. While PneumoKITy lacks the fine serotyping determination for some serogroups offered by other methods, it has application in the efficient screening of large datasets by reducing computational load in conjunction with other methods to subtype samples that cannot be distinguished fully using PneumoKITy alone and offers sensitivity for detection and quantification of mixed serotypes in complex samples.</p>
    </boxed-text>
  </sec>
  <sec sec-type="intro" id="s3">
    <title>Introduction</title>
    <p><italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.5677" ext-link-type="uri">Streptococcus pneumoniae</ext-link></named-content></italic> (the pneumococcus) is an important bacterial pathogen that can also be carried asymptomatically in the nasopharynx. A systematic analysis of the global burden of disease in 2016 found that <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.5677" ext-link-type="uri">S. pneumoniae</ext-link></named-content></italic> was the leading cause of disease, causing 197 million episodes of lower respiratory infection globally and 1 189 937 deaths, more than all the other aetiologies combined [<xref rid="R2" ref-type="bibr">2</xref>]. Effective vaccines have been introduced and licenced for use since 2000. However, vaccine-induced immune responses are specific to the capsular polysaccharide (CPS) that surrounds the bacterial cell and are limited in serotype valency, with existing vaccines only targeting up to 23 serotypes while over 100 distinct serotypes of pneumococcus have been described [<xref rid="R3" ref-type="bibr">3</xref>].</p>
    <p>In 2006, the publication of the full CPS operon sequences of 90 serotype reference strains [<xref rid="R4" ref-type="bibr">4</xref>], enabled the development of sequence-based methods for serotyping. PneumoCaT (<underline>Pneumo</underline>coccal <underline>Ca</underline>psular <underline>T</underline>yping) published in 2016 [<xref rid="R5" ref-type="bibr">5</xref>] was the first fully automated pneumococcal serotyping method available that offered comprehensive serotyping for a reference laboratory, enabling 94.7 % of the serotypes that could be defined using the gold standard serotyping sera (SSI Diagnostica) to be distinguished using whole genome sequencing. In October 2017 this method was implemented into the routine <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.5677" ext-link-type="uri">S. pneumoniae</ext-link></named-content></italic> reference service at Public Health England (PHE), now UK Health Security Agency (UKHSA).</p>
    <p>There has been increasing interest in recent years in methods for accurate detection of multiple serotypes carried in the nasopharynx. Studies have demonstrated that multiple serotype carriage is common [<xref rid="R6" ref-type="bibr">6–8</xref>] and methods to sensitively detect serotypes occurring at lower abundance in carriage have been devised and compared [<xref rid="R9" ref-type="bibr">9</xref>] as use of these methods would increase the knowledge of circulating serotypes and their potential impact when considering vaccination policy and vaccine development.</p>
    <p>Although PneumoCaT is an accurate method for serotype discrimination from whole genome sequencing (WGS) data, it is not particularly fast to run, taking up to several minutes per serotype determination on a standard computing infrastructure and does not have the necessary sensitivity for detection of multiple serotypes required for studies of more complex samples (e.g., nasopharyngeal swabs) rather than pure cultures (e.g., from CSF or blood samples).</p>
    <p>Other serotyping methods have been developed using variations of the PneumoCaT Capsular Type Variant database (CTVdb) such as seroBA [<xref rid="R10" ref-type="bibr">10</xref>], which offers faster serotyping from FastQ, and SeroCall [<xref rid="R11" ref-type="bibr">11</xref>], which provides mixed serotype detection from FastQ data. Although SeroBA offers higher speed serotyping, it does not offer any advantage in mixed serotype detection over PneumoCaT, and indeed may be more limited in detection of mixed types due to the partially assembly-based methods used. Although SeroCall offers highly accurate mixed serotype detection, the use of mapping for serotype screening increases the run time over the kmer-screening method used by SeroBA.</p>
    <p>We have developed PneumoKITy (<underline>Pneumo</underline>coccal <underline>K</underline>-mer <underline>I</underline>ntegrated <underline>Ty</underline>ping), a lightweight tool using a fast k-mer-based method for pneumococcal serotype/serogroup screening. This method offers speed, input datatype flexibility and increased sensitivity to mixed serotypes over the original PneumoCaT tool. PneumoKITy can be run with either FastQ or assembly input data for expected pure culture detection which gives more limited ability to detect mixed serotypes, or for expected mixed serotype detection with enhanced sensitivity (FastQ data only). PneumoKITy offers a sensitive, accurate, flexible, and fast alternative which can be useful for initial screening of large datasets with lower computational overhead, from either assemblies or FastQ data or for detection of serotype mixtures from FastQ files.</p>
  </sec>
  <sec sec-type="methods" id="s4">
    <title>Methods</title>
    <sec id="s4-1">
      <title>Definitions</title>
      <p>For the purposes of this manuscript – the following definitions are used throughout.</p>
      <p><bold>Serotype</bold> – the serologically determined type of the organism (phenotype), e.g., 6B.</p>
      <p><bold>Serogroup</bold> – a group of serotypes that are related serologically using phenotypical typing sera, e.g., serotype 6A, 6B, 6C and 6D form serogroup 6.</p>
      <p><bold>Genogroup</bold> – a group of strains that have capsular operon sequences that are related to each other, e.g., serotypes 12A, 12B, 12C, 12F, 44, and 46 are considered within the same genogroup due to their capsular operon sequence similarity.</p>
      <p><bold>Genetic subtype</bold> – a detectable genetic difference between strains that are considered the same phenotypical serotype, e.g., genetic type 23B1 which is a previously described subtype of serotype 23B [<xref rid="R12" ref-type="bibr">12</xref>].</p>
    </sec>
    <sec id="s4-2">
      <title>Reference sequences and information</title>
      <p>As a source of reference sequence information and for benchmark comparisons, PneumoCaT version 1.2.1 was downloaded from the Github repository (<ext-link xlink:href="https://github.com/phe-bioinformatics/PneumoCaT" ext-link-type="uri">https://github.com/phe-bioinformatics/PneumoCaT</ext-link>). The reference file from the PneumoCaT 1.2.1 CTVdb for the stage 1 operon mapping ‘reference.fasta’ was used as the basis for much of this work. This reference file contains 95 CPS operon sequences including those from [<xref rid="R4" ref-type="bibr">4</xref>] and some extra references and capsular variants as detailed in [<xref rid="R5" ref-type="bibr">5</xref>]. Gene sequence reference files for serogroups that had stage 2 gene presence/absence or allele variants from the CTVdb were also used. The yaml files (‘mutationdb.yml’) from the PneumoCaT CTVdb folders for each genogroup, containing serotype-specific gene variants for all serotypes determined in stage 2 by gene presence/absence or allele determinations, were used to assemble the information for the new CTVdb SQL database used in PneumoKITy.</p>
    </sec>
    <sec id="s4-3">
      <title>Bacterial sequences and standard bioinformatic processing</title>
      <p>The sequences used for analysis are noted in <xref rid="T1" ref-type="table">Table 1</xref>. All isolates except the mixed serotype sequences had been analysed as part of the standard PHE/UKHSA genomic pipeline as discussed in Kapatai <italic toggle="yes">et al</italic>. [<xref rid="R5" ref-type="bibr">5</xref>], which includes quality trimming of the Illumina reads, species identity check, multi-locus sequence typing (MLST) and PneumoCaT 1.0 serotyping.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1.</label>
        <caption>
          <p>Isolates or sequences used for analysis</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" valign="top" rowspan="1" colspan="1">
                <p>Isolate/sequence</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>no. of isolates/genomes</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>Study reference or supplier</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>Comments</p>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Reference isolates</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>92</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>SSI Diagnostica</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Bacterial type strains of 92 different serotypes used for creating serotyping sera. Genomic data for these isolates are included in the PneumoCaT development set [<xref rid="R5" ref-type="bibr">5</xref>] ENA PRJEB14267 (See Table S1)</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>PneumoCaT validation panel genomes</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>2054</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>[<xref rid="R5" ref-type="bibr">5</xref>]</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Validation panel. Genome data from PneumoCaT original validation ENA PRJEB14267 (seeTable S2 for list) [<xref rid="R5" ref-type="bibr">5</xref>]</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Nasopharyngeal carriage isolates</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>876</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>[<xref rid="R23" ref-type="bibr">23</xref>]</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Isolates from large studies of pneumococcal nasopharyngeal carriage [<xref rid="R23" ref-type="bibr">23</xref>], ENA PRJEB34491 See Table S3.</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Serogroup 6 and 19 Subtypes capsular operon sequences</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>44</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>[<xref rid="R16" ref-type="bibr">16</xref>]</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Subtype sequences from a paper on the diversity of serogroup 6 and 19 CPS operons [<xref rid="R16" ref-type="bibr">16</xref>] GenBank, accession numbers JF911487–JF911531</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Mixed serotype samples</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>60</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>[<xref rid="R11" ref-type="bibr">11</xref>]</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Illumina reads from pneumococcal co-cultures or serotypes mixed in known concentrations [<xref rid="R11" ref-type="bibr">11</xref>]. Bioproject accession number PRJNA561126</p>
              </td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tbl1fn1">
            <p>See <ext-link xlink:href="https://doi.org/10.6084/m9.figshare.21067339.v1" ext-link-type="uri">https://doi.org/10.6084/m9.figshare.21067339.v1</ext-link> for Supplementary tables.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="s4-4">
      <title>Initial bioinformatic and data analysis methods</title>
      <p>Marbl Mash version 2.3 [<xref rid="R13" ref-type="bibr">13</xref>] was used to assess the k-mer distance between reference capsular operon sequences. Mash Dist was used to create a non-tabular distance matrix comparing the reference sketch files. Using default settings, k-mer length 21 and max 1000 non-redundant k-mers. Serotypes that were too closely related using Mash Dist would fall into genogroups that would need further serotype determination using specific gene variants (stage 2). The resulting distance data were used to determine whether the Mash method could be viable, and to inform the potential new genogroup configurations.</p>
      <p>As initial proof of principle, Mash Screen [<xref rid="R14" ref-type="bibr">14</xref>] was used to screen FastQ files obtained from 91 type strain isolates (SSI Diagnostica) against the CPS reference sequences, sketched using Mash Sketch with default parameters, which were k-mer length 21 (-k) and max non-redundant k-mer numbers 1000 (-s) (subsequently referred to as ‘k-mer number’). The data were filtered to remove non-match values, arbitrarily assigned as any with shared k-mer hash values less than 40 % of the total hashes, to reduce the large number of data points for analysis. The percentage hits were then calculated (shared hashes/total hashes × 100) and this metric is used throughout this manuscript.</p>
      <p>Analysis of the Mash Screen input parameters was assessed using Mash Sketch to produce various versions of the sketched reference sequence fasta file, with k-mer length parameters (-k) 15, 21, 31 and in later experiments k-mer numbers (-s) 1000 and 25 000 as input values for the references.</p>
      <p>Sequence identity, median multiplicity and p-values reported by Mash were assessed for usefulness in the context of screening CPS operon sequences.</p>
      <p>After initial assessment of the Mash Screen parameters, the conformation of the new genogroups of serotypes that were appropriate to the new method and that would be included in the new CTVdb were established.</p>
    </sec>
    <sec id="s4-5">
      <title>Development of PneumoKITy software and CTVdb</title>
      <p>PneumoKITy software was written in Python version 3.9 [<xref rid="R15" ref-type="bibr">15</xref>], Python packages Pandas 1.0.3 and Numpy 1.21.5 were used for data analysis within the software and SQLalchemy 1.3.10 was used for interactions with the CTVdb for interpretation of the Mash Screen results.</p>
      <p>The software has two different run modes depending on whether the input sample data is from an expected pure culture isolate (referred to as ‘pure’ run mode) or expected mixed culture (referred to as ‘mix’ run mode). This changes the parameters and outputs to suit each type of run.</p>
      <p>Mash Screen was used for all screening analyses and is run as a sub-process in the Python [<xref rid="R15" ref-type="bibr">15</xref>] software. The fasta file of the CPS operon references was sketched using Mash Sketch on the command line, with option -i to allow sketching of multiple references from the multi-fasta into one ‘references.msh’ sketch file. This reference_msh file of sketched sequences became the overall reference sequence set for the new programme. Input FastQ or assembly data are screened by Mash in the same way, the only difference being for assembly data, detection of mixed serotypes is very insensitive due to mixtures of sequences being lost in the assembly process.</p>
      <p>A new SQLite3 CTVdb was designed to hold information regarding the phenotypical serotype, genetic types, stage 1 Mash serotype hits, variants, genogroups and genes. Information from the PneumoCaT 1.2.1 CTVdb and documentation was assembled in Microsoft Excel and modified according to the newly assigned genogroups (see Results) and the structure of the tables in the database. Phenotype was separated from genotype to enable both a genetic type and a predicted phenotypical type to be reported based on interpretation data stored in the CTVdb to allow a potential future update where this facility for reporting genetic type separately from predicted phenotype might be used more widely. The subtype operon references for serogroups 6 and 19 (<xref rid="T1" ref-type="table">Table 1</xref>) [<xref rid="R16" ref-type="bibr">16</xref>] were included in the new CTVdb to improve sensitivity for detection of these variable genogroups in stage 1 and enable a genetic subtyping method to be added to future versions of software. The final database consisted of seven linked tables containing unique information.</p>
      <p>A RED-AMBER-GREEN (RAG) traffic light style system for assessing result quality was implemented based on metrics such as stage 1 hit percentage and stage 2 gene detections hits, with differences based on whether pure or mix run type was used, for example, mixed samples are automatically flagged AMBER when run in pure culture mode but not when run in mix mode.</p>
      <p>For each sample run (whether assembly or FastQ input and in both run modes), the CTVdb is used to interpret the hits received in the stage 1 Mash Screen. If no hits are found with the initial percentage hit cut-off (default 90 %) the software reduces the cut-off by 10 % and re-scores the sample until a minimum of 70 % before reporting as a non-typeable or variant organism (e.g., genetic serotype variant) with AMBER RAG status. If no reference operons give a hit above 70 % then the software flags the result as RED. If there is &lt;20 % hit the software alerts the user that the isolate may be acapsular (does not produce a capsule), non-pneumococcal species or the sequence quality may be poor.</p>
      <p>At stage 2, analysis for serotypes where the second stage variant types included in the original PneumoCaT 1.2.1 CTVdb that were gene allele and presence, or absence, was added as these types of variants could be analysed using Mash Screen against a reference gene sequence sketch with no need to invoke differing methods. In some cases, only one serotype or sub-genogroups were separated from the overall group due to the specificity of the gene detections used. This method used Mash Screen with the required reference gene sketches (Sketched using Mash sketch and kmer number 1000, kmer length 31) and used the CTVdb to interpret the variants returned. Serotypes 38, 15F, 12F, 15A, 19A and variant 19AF (determined as phenotype 19F) could be fully distinguished from their genogroups, and other serotypes such as 6A/B and 6C/D separated using this method in stage 2 of the PneumoKITy software.</p>
      <p>If pure run mode is selected indicating expected pure cultures, but mixed serotypes are determined, the genogroups and estimated abundance of the mixed serotypes are reported but sub-typing is not attempted. However, if mix run mode is selected and mixed serotypes are determined in stage 1, subtyping will be attempted for those subtypes that can be determined using PneumoKITy.</p>
      <p>A diagram outlining the flow of the software run for the input options and run modes is shown in Fig. S1 (<xref rid="supp1" ref-type="supplementary-material">Fig. S1</xref>).</p>
      <p>For assessment of PneumoKITy when run on genome assembly files, Unicycler version 0.4.7 [<xref rid="R17" ref-type="bibr">17</xref>] was used to create high quality sequence assemblies from the processed FastQ read files for both the validation and carriage datasets.</p>
      <p>R version 4.0.2 [<xref rid="R18" ref-type="bibr">18</xref>] was used to analyse data using ggplot2 [<xref rid="R19" ref-type="bibr">19</xref>] to create plots.</p>
    </sec>
    <sec id="s4-6">
      <title>Updating the initial reference sequences to suit k-mer screening</title>
      <p>After initial testing for specificity and sensitivity the CTVdb was updated by inclusion of three additional references in the stage 1 capsular operon screen to make them more suitable for the greater specificity of k-mer screening by representation of more diverse genotypes of the capsular operon sequences.</p>
      <p>DNA sequences for the capsular operon were extracted from 33F and 24F isolates chosen from the UKHSA nasopharyngeal carriage study set (ERR3530303 and ERR3530868 respectively). Due to the failure of the 18F SSI reference strain to match the 18F reference for this serotype with a hit value above 90%, the DNA sequence was extracted from an assembly created from this reference isolate strain.</p>
      <p>To retrieve the CPS DNA sequences, firstly the FastQ were assembled using Unicycler as described previously. The sequences were then annotated using Prokka [<xref rid="R20" ref-type="bibr">20</xref>] with provision of a reference GenBank file containing the Pneumococcal D39 genome (CP000410.2) and GenBank files for all the 91 serotype reference sequences [<xref rid="R4" ref-type="bibr">4</xref>] to ensure correct annotation of the capsular operon genes. The DNA sequence from the beginning of the first coding sequence of the first gene of the capsular operon to the end of the last coding sequence were extracted using BioPython (SeqIO) [<xref rid="R21" ref-type="bibr">21</xref>]. To check the sequences, they were aligned with the appropriate serotype 18F, 33F and 24F references from the original PneumoCaT reference.fasta file using Mega X [<xref rid="R22" ref-type="bibr">22</xref>].</p>
      <p>The sequences were appended to the new references.fasta file created for PneumoKITy, and then this was sketched using Mash Sketch (with input options - i for multi-fasta sketching, -k 31 and default 1000 k-mer number).</p>
      <p>The references.msh and references.fasta then replaced the existing files in the CTVdb folder within the PneumoKITy software.</p>
      <p>The Microsoft Excel template, contained within the Database_tools folder of the PneumoKITy repository, for importing the CTVdb data was updated to include the new references and the existing CTVdb was deleted and recreated using the PneumoKITy sqlalchemydeclarative.py script. Then the new data were imported from the Excel template using the PneumoKITy import_from_excel.py script (at present no update script exists, but due to the small size of the PneumoKITy database, recreating the CTVdb is fast).</p>
      <p>The resulting new CPS reference sequences are available labelled 33F2, 24F2 and 18F in the references.fasta in PneumoKITy CTVdb folder on GitHub.</p>
      <p>The panels of reference isolates, carriage isolates and the PneumoCaT validation panel and mixed serotype sequences, were then run as the final dataset to validate the ‘PneumoKITy V1.0’ version of the software.</p>
    </sec>
    <sec id="s4-7">
      <title>Validation of PneumoKITy software</title>
      <p>PneumoKITy was tested against the original PneumoCaT Validation panel, and panel of reference genomes from the SSI Diagnostica type strains, and from the nasopharyngeal carriage study panel (<xref rid="T1" ref-type="table">Table 1</xref>) running both FastQ and assembly inputs. The software was run in the pure run mode and other settings at defaults and asked to collate the results into one file (the optional flag -c was added).</p>
      <p>In each validation analysis, the serotypes obtained from PneumoKITy V1.0 were compared with the original PneumoCaT serotype and the phenotypical serotype (obtained by slide agglutination) if available. A matching serotype (or genogroup for those that could not be called to type level) was scored 'one', a mismatching serotype/group with PneumoCaT was scored 'zero'. Isolates that were RAG flagged ‘RED’ by PneumoKITy but matched with a phenotypically acapsular isolate and where PneumoCaT had resulted ‘Failed’ were scored 'one' as they represent isolates highly likely to not have full (or recognised) capsular operons or variants. Sequences for which PneumoCaT had failed to give a result and for which PneumoKITy scored as ‘Less than 70 % hit’ were accepted as a match if there was either no phenotypical data existing for the samples, or if these samples showed non-typeable or other difficulty with serotyping (e.g., auto-agglutination). In some cases, PneumoKITy was able to determine a serotype where PneumoCaT failed to produce a result, in these cases the PneumoKITy result was scored 'zero' or 'one' according to whether it matched the phenotypical laboratory-derived serotype if available and 'zero' if not available.</p>
    </sec>
    <sec id="s4-8">
      <title>Testing the multiple serotype detection ability of PneumoKITy</title>
      <p>The ability of PneumoKITy to detect multiple serotypes in mixed samples was determined using a dataset of mixed serotype sequences prepared by Knight <italic toggle="yes">et al</italic>. [<xref rid="R11" ref-type="bibr">11</xref>]. These sequences (BioProject accession no. PRJNA561126) consisted of DNA from serotypes mixed with known ratios, and samples grown as co-cultures containing anywhere from two to ten serotypes grown for either 2, 4 or 8 h. For these samples, PneumoKITy was run from the FastQ, using the default parameters in mix run mode.</p>
    </sec>
    <sec id="s4-9">
      <title>PneumoKITy V1.0 performance testing</title>
      <p>PneumoKITy V1.0 was benchmarked for speed and memory requirements against SeroCall (installed using conda 4.10.3) and PneumoCaT V1.2.1 in pure run mode on FastQ read files from a serotype 1 (determined in stage 1 only) and serotype 15A (determined in stage 2 using presence/absence variant analysis). PneumoKITy was also run using assemblies of the same files again using pure run mode (representing a technical replicate). Benchmarking was performed in triplicate on an Intel Core i7-7700HQ (2.80GHz x4) laptop running Ubuntu 18.04.6 LTS and with 32 GB RAM. The wallclock run time and memory requirements were assessed by invoking the time command (/usr/bin/time -v). The programmes were run requesting a single thread or four threads for the sub-processes, an output folder was specified in all software, but no additional result collate file was requested from PneumoKITy as none of the other software packages offer a result collation option for collating data from multiple runs. To avoid PneumoCaT V1.2.1 gaining an unfair advantage on run two and three of the 15A sample by reuse of existing output files, the outputs were deleted between runs.</p>
      <p>The PneumoKITy code is available on GitHub at <ext-link xlink:href="https://github.com/CarmenSheppard/PneumoKITy" ext-link-type="uri">https://github.com/CarmenSheppard/PneumoKITy</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="s5">
    <title>Results</title>
    <sec id="s5-1">
      <title>Proof of principle Mash Distance and Mash Screen analysis</title>
      <p>Serotypes that would form genogroups at various Mash Distance cut-offs are shown in <xref rid="T2" ref-type="table">Table 2</xref> and compared to the genogroups reported by Kapatai <italic toggle="yes">et al</italic>. [<xref rid="R5" ref-type="bibr">5</xref>] for PneumoCaT 1.0. All serotypes not contained in the table were distinguishable below these cut-off values (<italic toggle="yes">N</italic>=30).</p>
      <table-wrap position="float" id="T2">
        <label>Table 2.</label>
        <caption>
          <p>Genogroups assigned by Kapatai <italic toggle="yes">et al</italic>. [<xref rid="R5" ref-type="bibr">5</xref>] and with Mash Distance analysis at various cut-offs. Equivalent groupings to those defined by Kapatai <italic toggle="yes">et al</italic>. are indicated in green shading, more specific in purple and less specific in pink. Empty coloured cells indicate that at this cut-off level the serotypes separate completely and do not form a genogroup</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" valign="top" rowspan="1" colspan="1">
                <p>Kapatai <italic toggle="yes">et al.</italic>
</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>Mash distance 0.2</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>Mash distance 0.3</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>Mash distance 0.4</p>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>6A, 6B, 6C, 6D, (6E)*</bold>
                </p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>6A, 6B, 6C, 6D</p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>6A, 6B, 6C, 6D</p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>6A, 6B, 6C, 6D</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>7A, 7F</bold>
                </p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>7A, 7F</p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>7A, 7F</p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>7A, 7F</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>7B, 7C, 40</bold>
                </p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>7B, 7C, 40</p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>7B, 7C, 40</p>
              </td>
              <td align="center" valign="top" style="background:#EEADA6" rowspan="1" colspan="1">
                <p>7B, 7C, 40, 24F, 24B, 24A, 48</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p><bold>9A, 9L, 9V, 9</bold> <bold>N</bold></p>
              </td>
              <td align="center" valign="top" style="background:#CCC0D9" rowspan="1" colspan="1">
                <p>9A, 9V</p>
              </td>
              <td align="center" valign="top" style="background:#CCC0D9" rowspan="1" colspan="1">
                <p>9A, 9V</p>
              </td>
              <td align="center" valign="top" style="background:#CCC0D9" rowspan="1" colspan="1">
                <p>9A, 9V</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1"/>
              <td align="center" valign="top" style="background:#CCC0D9" rowspan="1" colspan="1">
                <p>9L, 9 N</p>
              </td>
              <td align="center" valign="top" style="background:#CCC0D9" rowspan="1" colspan="1">
                <p>9L, 9 N</p>
              </td>
              <td align="center" valign="top" style="background:#CCC0D9" rowspan="1" colspan="1">
                <p>9L, 9 N</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>10A, 10B</bold>
                </p>
              </td>
              <td align="center" valign="top" style="background:#CCC0D9" rowspan="1" colspan="1"/>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>10A, 10B</p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>10A, 10B</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>10C, 10F</bold>
                </p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>10C, 10F</p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>10C, 10F</p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>10C, 10F</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>11A, 11B, 11C, 11D, 11F</bold>
                </p>
              </td>
              <td align="center" valign="top" style="background:#CCC0D9" rowspan="1" colspan="1">
                <p>11A, 11D</p>
              </td>
              <td align="center" valign="top" style="background:#CCC0D9" rowspan="1" colspan="1">
                <p>11A, 11D</p>
              </td>
              <td align="center" valign="top" style="background:#CCC0D9" rowspan="1" colspan="1">
                <p>11A, 11D</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1"/>
              <td align="center" valign="top" style="background:#CCC0D9" rowspan="1" colspan="1">
                <p>11B,11C</p>
              </td>
              <td align="center" valign="top" style="background:#CCC0D9" rowspan="1" colspan="1">
                <p>11B,11C</p>
              </td>
              <td align="center" valign="top" style="background:#CCC0D9" rowspan="1" colspan="1">
                <p>11B,11C</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>12A, 12B, 12F, 44, 46</bold>
                </p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>12A, 12B, 12F, 44, 46</p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>12A, 12B, 12F, 44, 46</p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>12A, 12B, 12F, 44, 46</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>15A, 15B, 15C, 15F</bold>
                </p>
              </td>
              <td align="center" valign="top" style="background:#CCC0D9" rowspan="1" colspan="1">
                <p>15A, 15F</p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>15A, 15B, 15C, 15F</p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>15A, 15B, 15C, 15F</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1"/>
              <td align="center" valign="top" style="background:#CCC0D9" rowspan="1" colspan="1">
                <p>15B, 15C</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>18A, 18B, 18C, 18F</bold>
                </p>
              </td>
              <td align="center" valign="top" style="background:#CCC0D9" rowspan="1" colspan="1">
                <p>18B, 18C</p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>18A, 18B, 18C, 18F</p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>18A, 18B, 18C, 18F</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>19B, 19C</bold>
                </p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>19B, 19C</p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>19B, 19C</p>
              </td>
              <td align="center" valign="top" style="background:#EEADA6" rowspan="1" colspan="1">
                <p>19B, 19C, 19F</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>22A, 22F</bold>
                </p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>22A, 22F</p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>22A, 22F</p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>22A, 22F</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>23A, 23B, 23F</bold>
                </p>
              </td>
              <td align="center" valign="top" style="background:#CCC0D9" rowspan="1" colspan="1">
                <p>23A, 23F</p>
              </td>
              <td align="center" valign="top" style="background:#CCC0D9" rowspan="1" colspan="1">
                <p>23A, 23F</p>
              </td>
              <td align="center" valign="top" style="background:#EEADA6" rowspan="1" colspan="1">
                <p>23A, 23B, 23F,28A,28F,23B,16F,23B1</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>24A, 24B, 24F</bold>
                </p>
              </td>
              <td align="center" valign="top" style="background:#CCC0D9" rowspan="1" colspan="1">
                <p>24B, 24F</p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>24A, 24B, 24F</p>
              </td>
              <td align="center" valign="top" style="background:#EEADA6" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>25A, 25F, 38</bold>
                </p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>25A, 25F, 38</p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>25A, 25F, 38</p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>25A, 25F, 38</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>28A, 28F</bold>
                </p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>28A, 28F</p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>28A, 28F</p>
              </td>
              <td align="center" valign="top" style="background:#EEADA6" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>32A, 32F</bold>
                </p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>32A, 32F</p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>32A, 32F</p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>32A, 32F</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>33A, 33F, (37)†</bold>
                </p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>33A, 33F</p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>33A, 33F</p>
              </td>
              <td align="center" valign="top" style="background:#EEADA6" rowspan="1" colspan="1">
                <p>33A, 33F, 35C</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>33B, 33D</bold>
                </p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>33B, 33D</p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>33B, 33D</p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>33B, 33D</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>35A, 35C, 42</bold>
                </p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>35A, 35C, 42</p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>35A, 35C, 42</p>
              </td>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1">
                <p>35A, 35C, 42</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1"/>
              <td align="center" valign="top" style="background:#D6E3BC" rowspan="1" colspan="1"/>
              <td align="center" valign="top" style="background:#EEADA6" rowspan="1" colspan="1">
                <p>35F 47F</p>
              </td>
              <td align="center" valign="top" style="background:#EEADA6" rowspan="1" colspan="1">
                <p>35F 47F</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>41A, 41F</bold>
                </p>
              </td>
              <td align="center" valign="top" style="background:#CCC0D9" rowspan="1" colspan="1">
                <p>41A, 41F</p>
              </td>
              <td align="center" valign="top" style="background:#EEADA6" rowspan="1" colspan="1">
                <p>41A, 41F, 31</p>
              </td>
              <td align="center" valign="top" style="background:#EEADA6" rowspan="1" colspan="1">
                <p>41A, 41F, 31</p>
              </td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tbl2fn1">
            <p>*Serotype 6E is a genetic variant only and not a distinguishable phenotypical serotype.</p>
          </fn>
          <fn id="tbl2fn2">
            <p>†37 is included in this group in Kapatai <italic toggle="yes">et al</italic>. [<xref rid="R5" ref-type="bibr">5</xref>] due to shared operon-like sequences in the genome however the sequence included in the reference file is very distinct and therefore does not cluster with the other serotypes in the Mash Distance analysis.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>The reference isolate FastQ files were screened against the reference CPS operons (without additional subtypes) using Mash Screen with default settings (k-mer length 21, k-mer number 1000) and the results were assessed using the genogroups assigned with a Mash Dist. cut-off of 0.3.</p>
      <p><xref rid="F1" ref-type="fig">Fig. 1</xref> shows the accuracy of all the Mash Screen hits filtered for &gt;40 % (percent hit k-mers/total k-mers). A suggested arbitrary 90 % cut-off line shown was chosen as the starting point for the specificity analysis as it allows for some diversity from the reference sequence.</p>
      <fig position="float" fig-type="figure" id="F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Accuracy of percentage hit (hit kmers/total kmers × 100) for SSI reference strain fastQ against SSI reference operon sequences using Mash Screen with 21 k-mer length and 1000 k-mer number parameters (equivalent to stage 1 analysis with fastQ input). Solid line shows potential 90 % hit cut-off.</p>
        </caption>
        <graphic xlink:href="mgen-8-904-g001" position="float"/>
      </fig>
      <p>Top hits for the 6C, 18F, 19A and 24F isolates did not reach the arbitrary 90 % cut-off. Two isolate sequences gave false-positive signals for a serotype that was not the expected serotype or group suggested by the Mash Distance cut-off of 0.03, when a 90 % hit threshold was applied. These two false positive hits were 28F which hit with 28A and 28A which hit with 28F suggesting establishment of a genogroup despite the Mash Distance analysis suggesting they might be separated. The 90 % cut-off was selected as the default due to the high specificity.</p>
    </sec>
    <sec id="s5-2">
      <title>Development of PneumoKITy analysis parameters</title>
      <p>An iterative approach to determining the best input analysis parameters for the MASH screen subprocess and subsequent filtering of the Mash Screen result was employed, using the sequences from the reference strains and the full panels of validation and carriage data. The software was developed in stages until the following parameters were adopted.</p>
      <p>Analysis of k-mer length input value of 31 with initial test k-mer number of 25 000 significantly increased the proportion of hits to the correct serotype or genogroup (as suggested by the previous Mash Distance analysis) above the &gt;90 % suggested percent hit cut-off compared to using the lower setting of 11 (<italic toggle="yes">P</italic>≤ 2.2 x 10<sup>−16</sup>) (<xref rid="F2" ref-type="fig">Fig. 2</xref>). There was not much difference between 21 and 31, but the higher setting was chosen for improved accuracy.</p>
      <fig position="float" fig-type="figure" id="F2">
        <label>Fig. 2.</label>
        <caption>
          <p>SSI reference strain FastQ screened against SSI reference operon sequences using Mash Screen varying k-mer lengths used for sketch creation. (<bold>a</bold>) Proportion of correct hits ≥90 % hit with differing k-mer lengths. (<bold>b</bold>) Box plot of sequence identity at differing k-mer lengths (a) and (b).</p>
        </caption>
        <graphic xlink:href="mgen-8-904-g002" position="float"/>
      </fig>
      <p>A comparison of the use of 1000 non-redundant k-mers (k-mer number) vs 25 000 k-mer number with a k-mer length of 31 showed that the proportions of the SSI reference isolates scored correctly was the same (<xref rid="F3" ref-type="fig">Fig. 3</xref>).</p>
      <fig position="float" fig-type="figure" id="F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Effect of k-mer number on Mash Screen accuracy and run time for SSI reference isolate FastQ against reference sequences using 90 % hit threshold. (<bold>a</bold>) proportion of correct hits to serotype or group, (<bold>b</bold>) box plot of identity metric (a) and (b).</p>
        </caption>
        <graphic xlink:href="mgen-8-904-g003" position="float"/>
      </fig>
      <p>Runtime analysis for a serotype 3 FastQ pair run using k-mer number 1000 or 25 000, showed that use of the 1000 k-mer number instead of 25 000, reduced the run time and memory usage from 254.3 s and 957.7 mb to only 29.8 s and 85.6 mb. From these data, max 1000 k-mer number parameter was chosen as this made no difference to the accuracy of the serotype call, but reduced runtime by 65.2 % and memory requirement by 73.4 %.</p>
      <p>A combination of 31 k-mer length and 1000 k-mer number parameters were used as final settings for the Mash Sketch or Mash Screen sub-process.</p>
      <p>For filtering the output data obtained from Mash Screen <italic toggle="yes">P</italic>-value and median-multiplicity parameters were considered.</p>
      <p><italic toggle="yes">P</italic>-values were all reported as 0 (zero) in the data when filtered for &gt;40 % top hit, representing &lt;2.2×10<sup>−308</sup> and therefore added no further value for scoring the data, thus these were disregarded as metrics for use in filtering the Mash outcomes.</p>
      <p>Median multiplicity was useful for filtering FastQ data and made a difference based on whether pure culture or mixed serotypes were expected in the data. For pure run mode a higher median-multiplicity default cut-off of 10 was employed to avoid oversensitivity to low level contamination. For expected mixed culture inputs (mix run mode) the median-multiplicity default was set to 4.</p>
      <p>For assembly input data the median-multiplicity value is not applicable as the data do not generally have multiple k-mer copies, so the median multiplicity cut-off is automatically set to one.</p>
    </sec>
    <sec id="s5-3">
      <title>Determination of genogroups for the CTVdb</title>
      <p>The new genogroups from which serotypes can be determined by stage 2 in the PneumoKITy software using either presence or absence or gene allele determinations only are shown in <xref rid="T3" ref-type="table">Table 3</xref>.</p>
      <table-wrap position="float" id="T3">
        <label>Table 3.</label>
        <caption>
          <p>Genogroups assigned for PneumoKITy CTVdb</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" valign="top" rowspan="1" colspan="1">
                <p>Ctv.db genogroup / folder name</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>Predicted phenotypes determinable in genogroup</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>Comment</p>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p> 6A_6B_6C_6D</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6A/6B, 6C/6D, serogroup _6(6E)</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p> Genogroup less specific than suggested by distance evaluations to capture large amount of variation observed in serogroup 6 CPS operon and presence of 6E variant.</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p> 12F_12A_12B_44_46</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>12F, 12A/12B/44/46</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p> Serotype 12F can be separated from the others</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p> 15F_15A</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>15F, 15A</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p> 19A_19AF</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>19A, 19F</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p> Include second stage detection of 19A-like 19F variants (variant <italic toggle="yes">wzy*</italic>) and separate from 19A phenotype</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p> 25F_25A_38</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>25F/25A, 38</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p> Serotype 38 can be separated from the others</p>
              </td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tbl3fn1">
            <p>∗<italic toggle="yes">wzy</italic>, gene coding for polysaccharide polymerase.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="s5-4">
      <title>Updating the CTVdb with new references and reconfiguring stage 2 determinations</title>
      <p>To increase sensitivity to some of the serotypes, DNA sequences spanning the capsular operons of the serotype 18F, 24F and 33F isolates were extracted from the GenBank files created by Prokka annotation of the DNA assemblies from the two representative isolates.</p>
      <p>For serotype 24F, the DNA sequence from the first nucleotide of the first codon of the regulatory gene <italic toggle="yes">wzg</italic> to the last nucleotide of the last codon of <italic toggle="yes">rmlD</italic> (which codes for a dTDP-4-dehydrorhamnosereductase, a component of the TDP-Rha synthesis pathway) produced a DNA sequence of length 20 793 bp. When aligned to the original PneumoCaT reference for 24F, the new sequence was nine nucleotides longer, representing three extra codons (coding for V, L, I) at the beginning of <italic toggle="yes">wzg</italic>, but otherwise was similar to the original reference strain with only 234/20793 (1.1 %) variable sites.</p>
      <p>For serotype 33F the DNA sequence from the first nucleotide of the first codon of <italic toggle="yes">wzg</italic> to the last nucleotide of the last codon of <italic toggle="yes">wcyO</italic> (which encodes an acetyltransferase) produced a DNA sequence of length 15 931 bp. No <italic toggle="yes">wcjE</italic> gene (which also encodes an acetyltransferase) was found in the annotation, which is present in the reference sequence, instead <italic toggle="yes">wcyO</italic> appears the end of the CPS operon, the <italic toggle="yes">wcyO</italic> ORF appears to be intact and was annotated as a putative acetyltransferase. When aligned to the original PneumoCaT reference for 33F, the new sequence had 251 additional nucleotides at the beginning of the sequence and 931 additional nucleotides at the end. Within the aligned sequence there were 351 variable sites. Due to existing descriptions of a 33F1 variant possessing an inactive <italic toggle="yes">wcyO</italic> we designated this sequence as 33F2 in line with this work [<xref rid="R12" ref-type="bibr">12</xref>].</p>
      <p>For serotype 18F the DNA sequence from the first nucleotide of the first codon of <italic toggle="yes">wzg</italic> to the last nucleotide of the last codon of <italic toggle="yes">rmlD</italic> produced a DNA sequence of length 20 077 bp. When aligned to the original PneumoCaT reference for 18F, the new sequence had 269 additional nucleotides at the beginning of the sequence and was 932 nucleotides shorter at the end due to non-inclusion of a short hypothetical sequence at the end of the operon. Within the aligned sequence there were 795 variable sites.</p>
      <p>The CTVdb was updated to add the new 24F2 and 33F2 sequences to be interpreted correctly in the database. As the 18F reference was so different to the existing reference and was created from an isolate of the SSI Diagnostica type strain, the new 18F sequence directly replaced the original 18F sequence in the reference.fasta.</p>
      <p>After the CTVdb update PneumoKITy was then potentially able to determine 54 (58 %) of the 93 serotypes currently distinguishable by the commercially available SSI Diagnostica serotyping sera.</p>
    </sec>
    <sec id="s5-5">
      <title>Results from SSI reference panel FastQ and assemblies</title>
      <p>PneumoKITy V1.0 was used to test the 91 reference FastQ pairs obtained from the reference isolates (see Table S4, in pure run mode.</p>
      <p>Compared to the expected serotype or genogroup for the 91 reference strains, there was only one unexpected result, a serotype 7C strain reported as mixed with 7B/40. There is a possibility this was contaminated, as the 7C and 7B strains were next to each other in the original sequencing plate. The mixture was estimated at 38.1 % 7B_40 and 61.9 % 7C by use of the median-multiplicity metric in PneumoKITy, a result which was scored as ‘incorrect’ for the purposes of this analysis. Four further samples resulted with the correct serotype or genogroup hit but were flagged AMBER by PneumoKITy, two of these represented low hits at stage 1 screen, these were a serotype 19A and 6C which hit at 88.3% and 87.2% but were otherwise correctly typed as 19A and 6C/6D respectively. The next two samples were 25A and 25F and the AMBER flag was due to a low median multiplicity for the isolates meaning that the multiplicity for the k-mers in the <italic toggle="yes">wcyV</italic> in stage 2 gene presence or absence analysis was below the cut-off of 10, which meant that gene-absence was not scored and the group 25A_25F_38 was returned instead of separating 25F/25A from serotype 38. The overall hit accuracy was 88/91 (97.8 %) to correct result or 90/91 (98.9 %) to genogroup level using the FastQ input.</p>
      <p>Compared with FastQ input, the results from running PneumoKITy in pure run mode when the assembly files were used as the input gave only one unexpected result, the 25A isolate resulted as ‘Poor sequence quality’, with a RED RAG score. The top hits were 25A at only 20.6 % and 25F at only 21 %. In addition, three other samples gave AMBER RAG status, to warn of potential problems with the data due to lower than 90 % initial hits. These, however, resulted in the correct call to serotype or genogroup. The assembly statistics for these samples compared to a sample giving a GREEN RAG status are shown in <xref rid="T4" ref-type="table">Table 4</xref>.</p>
      <table-wrap position="float" id="T4">
        <label>Table 4.</label>
        <caption>
          <p>PneumoKITy metrics and assembly statistics for reference isolate assemblies exhibiting RED or AMBER PneumoKITy result flags, plus an example of a GREEN flagged result. Pure culture run mode</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" valign="top" rowspan="1" colspan="1">
                <p>Sample</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>Expected serotype</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>Top hit %</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>RAG status</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>No. of contigs</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>L50</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>N50</p>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1437928</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>10F</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>GREEN</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>57</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>9</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>78 340</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1437950</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>19A</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>88.3</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>AMBER</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>68</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>12</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>59 981</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1438004</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6C</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>87</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>AMBER</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>71</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>12</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>65 406</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1438011</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>9L</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>72.3</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>AMBER</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>119</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>22</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>24 978</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1437965</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>25A</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>21</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>79</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>13</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>53 365</p>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>In general, the PneumoKITy maximum top hit percentage decreased with increasing number of contigs in the assembly (indicating decreasing assembly quality). The RED score for the 25A assembly appeared to be due to the capsular operon genes being broken up between different contigs in the assembly.</p>
      <p>The 7C isolate assembly resulted without error as 7C, not mixed as when the FastQ were run. This was due to the hit to the 7B and 7C references being below the 90 % hit cut-off for the assembly input. For the assembly files the accuracy was also 90/91 (98.9 %).</p>
      <p>No samples caused errors in the PneumoKITy software run. Data and results from this analysis are available in Table S4.</p>
    </sec>
    <sec id="s5-6">
      <title>Results from final validation with PneumoCaT1 validation set</title>
      <p>To validate the PneumoKITy V1.0, the tool was run in pure culture mode on FastQ genome pairs and assemblies created from the original PneumoCaT validation set data. In total 2053 FastQ pairs and assemblies of these FastQ pairs were tested, the data are shown in Table S2. A summary of these results is seen in <xref rid="T5" ref-type="table">Table 5</xref>.</p>
      <table-wrap position="float" id="T5">
        <label>Table 5.</label>
        <caption>
          <p>Summary results from testing of PneumoCaT1 validation panel samples using PneumoKITy with a) FastQ input and b) assembly input, compared to original results. Pure culture run mode</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" valign="top" colspan="4" rowspan="1">
                <p>a) FastQ input</p>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>RAG status</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Mismatch</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Match</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Grand total</bold>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>AMBER</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>36</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>42</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>GREEN</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>2</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1976</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1978</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>RED</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>9</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>24</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>33</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Grand total</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>17</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>2036</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>2053</bold>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" colspan="4" rowspan="1">
                <p>
                  <bold>b) Assembly input</bold>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>RAG status</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Mismatch</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Match</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Total</bold>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>AMBER</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>4</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>40</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>44</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>GREEN</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>3</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1966</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1969</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>RED</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>16</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>24</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>40</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Grand total</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>23</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>2030</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>2053</bold>
                </p>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>Several discrepancies between the original published PneumoCaT serotype designation of 12B and PneumoKITy designation of 12F were seen, however this was due to inaccurate original serotyping leading to mis-development of the original PneumoCaT CTVdb and erroneous calling of 12F as 12B, this was fixed in a later release of PneumoCaT (see <ext-link xlink:href="https://github.com/phe-bioinformatics/PneumoCaT/releases/tag/v1.1" ext-link-type="uri">https://github.com/phe-bioinformatics/PneumoCaT/releases/tag/v1.1</ext-link>) due to this the PneumoKITy calls of 12F for these samples were scored as correct.</p>
      <p>For FastQ and assembly input data respectively, 2036 (99.0 %) and 2032 (98.98 %) of the samples gave the expected results compared to the original PneumoCaT 1.0 calls (serotype, genogroup or acapsular call) with either a ‘GREEN’ or ‘AMBER’ RAG status flag or a ‘RED’ status flag where the sample was originally designated as acapsular or if the original PneumoCaT result was ‘Failed’.</p>
      <p>Mismatched data are summarised in <xref rid="T6" ref-type="table">Table 6</xref>.</p>
      <table-wrap position="float" id="T6">
        <label>Table 6.</label>
        <caption>
          <p>Mismatched results from testing of PneumoCaT1 validation panel samples using PneumoKITy compared to original results. NTR=Non-typeable rough</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" valign="top" rowspan="1" colspan="1">
                <p>Sample ID</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>Lab serotype</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>PneumoCaT serotype</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>PneumoKITy FastQ result</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>FastQ RAG status</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>PneumoKITy assembly result</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>Assembly RAG status</p>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1440723</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>37</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>37</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Below 70 % hit – Poor Sequence quality, variant or non-typeable organism.</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Below 70 % hit – Poor Sequence quality, variant or non-typeable organism.</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1440855</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>37</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>37</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Below 70 % hit – Poor Sequence quality, variant or non-typeable organism.</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Below 70 % hit – Poor Sequence quality, variant or non-typeable organism.</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1440332</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>06A</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>06A</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Serotype within 6A_6B_6C_6D unexpected variant pattern</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Serotype within 6A_6B_6C_6D unexpected variant pattern</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1440637</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>06A</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>06A</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Serotype within 6A_6B_6C_6D unexpected variant pattern</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Serotype within 6A_6B_6C_6D unexpected variant pattern</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1440020</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>06C</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>06C</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Serotype within 6A_6B_6C_6D unexpected variant pattern</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Serotype within 6A_6B_6C_6D unexpected variant pattern</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1438860</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>06D</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>06D</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Serotype within 6A_6B_6C_6D unexpected variant pattern</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Serotype within 6A_6B_6C_6D unexpected variant pattern</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1439179</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>18C</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>18A</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Mixed serotypes – {'18A', '18C/18B'}</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>AMBER</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Below 70 % hit – Poor Sequence quality, variant or non-typeable organism.</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1439638</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>33B</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>33B</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>33D</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>GREEN</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>33D</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>GREEN</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1440439</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>35F</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>35F</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>34</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>GREEN</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>34</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>GREEN</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1438800</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>NTR</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Failed</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>25F_25A_38</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>25F_25A_38</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1438809</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>38</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>38</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>25F_25A_38</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>25F_25A_38</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1440458</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>38</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>38</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>25F_25A_38</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>25F_25A_38</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1440125</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>23F</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Failed</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>23B</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>AMBER</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>23B</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>AMBER</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1440391</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>23F</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Failed</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>23B</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>AMBER</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>23B</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>AMBER</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1440598</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>NTR</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Failed</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>14</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>AMBER</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>14</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>AMBER</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1439282</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>8</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>8</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Below 20 % hit – possible acapsular organism, check species identity and sequence quality.</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1440445</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>31</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>31</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Below 70 % hit – Poor Sequence quality, variant or non-typeable organism.</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1439965</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>06C</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>06C</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Below 70 % hit – Poor Sequence quality, variant or non-typeable organism.</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1439040</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>11A</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>11A</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Below 70 % hit – Poor Sequence quality, variant or non-typeable organism.</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1438836</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>12F</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>12F</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>12F_12A_12B_44_46: wciI not found in isolate, possible variant</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>AMBER</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1439960</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>15A</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>15A</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Below 70 % hit – Poor Sequence quality, variant or non-typeable organism.</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1440661</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>15B</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>15B</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Below 70 % hit – Poor Sequence quality, variant or non-typeable organism.</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1440611</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>15C</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Mixed: ['15A', '15B/C']</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>15B/15C</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>GREEN</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1440740</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>10F</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Failed</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>25F_25A_38</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>AMBER</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1439227</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>15B/C</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>15B</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Mixed serotypes– {'15B/15C', '15F_15A'}</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>AMBER</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>Seven isolates (0.34 %) gave the correct results to genogroup level in the FastQ analysis, with problems detected at stage 2 analysis, <italic toggle="yes">wciN</italic> allele detection at stage 2 for four serogroup 6 isolates failed due to hit percentages just below the 90 % cut-off. In addition, low hit percentage for <italic toggle="yes">wcyD</italic> for distinction of serotype 38 from 25F/25A. Similar problems with stage 2 analysis were also seen in the assembly data with four serogroup 6 isolates also giving similar hits just under the 90 % cut-off for the <italic toggle="yes">wciN</italic> analysis at stage 2 and three serotype 38 isolates also giving a low percentage hit to <italic toggle="yes">wcyD</italic>. Two serotype 37 isolates gave a low hit to the initial <italic toggle="yes">tts</italic> reference below the 70 % cut-off in both the FastQ and assembly data.</p>
      <p>Six further isolates gave discrepant results (in both FastQ and assembly results) with either differing serotypes compared to PneumoCaT or where PneumoCaT had failed, a differing serotype compared to the original laboratory type. These were a serotype 33D when PneumoCaT resulted as 33B, the 33D hit was 90 % and 33B was 89 % and as no genogroup was assigned to this type, the top hit result was returned as the second hit was just below the 90 % threshold, which would have resulted in a mixed serotype call. This could be due to a variant serotype as in the reference dataset, 33D was very much lower at 10 % hit when compared to the 33B sample. The second serotype discrepancy was a serotype 34 when PneumoCaT originally resulted as 35F. In the FastQ data serotype 34 hit at 93 % and 35F at only 28.89 % and in the assembly data 34 was 92.7 % and the 35F serotype did not register in the top five hits (lowest hit in top five was 27.7 %). This may have been due to a sample/data mix up, repeating the file in PneumoCaT 1.2 resulted as a failure but with a serotype 34 top hit at 84.6 %, with 35F only giving 30.85 % coverage. A further two isolates resulted as 23B when PneumoCaT failed and original serotyping was 23F, both isolates had top hits below the initial 90 % in both sets of data indicating either poor sequence quality or variant sequences. In the FastQ data, the 23B hit was 82.7% and 84.5 % for both samples with the 23F hit at 65.8% and 64.0% respectively. In the assembly data the 23B hit was 84.5% and 79.9 % with 23F at 63.6% and 62% respectively. This could indicate mixed reads between a 23F and 23B but due to both being within the same genogroup PneumoKITy cannot distinguish them as a mixture. The final two serotype discrepancies were two isolates that were serotype 14 and group 25F/25A/38 respectively when PneumoCaT failed and original phenotypic serotyping was non-typeable.</p>
      <p>One serotype 8 isolate failed with a &lt;20 % hit in the assembly data (top hit was to serotype 36 with only 14.9 %). However, this isolate resulted correctly as serotype 8 with 98 % hit in the FastQ data. The N50 and L50 statistics for the assembly were poor at 3227 and 192 respectively.</p>
      <p>For the discrepancies where the FastQ data gave a match, but the assemblies had results falling below the 70 % hit threshold, the assembly statistics were as shown in <xref rid="T7" ref-type="table">Table 7</xref>. Full PneumoKITy hit and stage 2 statistics are contained in Table S2.</p>
      <table-wrap position="float" id="T7">
        <label>Table 7.</label>
        <caption>
          <p>Hit and assembly statistics for isolates which gave a match result in PneumoKITy using FastQ input but failed with &lt;70 % hit using assembly input</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" valign="top" rowspan="1" colspan="1">
                <p>Sample id</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>Lab serotype</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>PneumoCaT</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>PneumoKITy assembly result</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>Top hit %</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>L50</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>N50</p>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1440445</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>31</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>31</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Below 70 % hit – Poor Sequence quality, variant or non-typeable organism.</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>31 44.4 %</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>14</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>47 781</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1439965</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>06C</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>06C</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Below 70 % hit – Poor Sequence quality, variant or non-typeable organism.</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6D 56.9%</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>15</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>40 725</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1439040</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>11A</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>11A</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Below 70 % hit – Poor Sequence quality, variant or non-typeable organism.</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>11F 65.3%</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>25</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>22 892</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1439960</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>15A</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>15A</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Below 70 % hit – Poor Sequence quality, variant or non-typeable organism.</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>15A 45.5%</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>16</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>44 976</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>ERR1440661</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>15B</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>15B</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Below 70 % hit – Poor Sequence quality, variant or non-typeable organism.</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>15B 59.7%</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>16</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>48 254</p>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>One sample resulted as ‘Mixed serotypes- {'18A', '18C/18B'}” in PneumoKITy FastQ data and as a below 70 % hit in the assembly data. This isolate gave an 18A result in PneumoCaT, but the laboratory serotype result was 18C. Potentially this isolate could be either mixed or a serotype variant with sequence characteristics of both serotypes.</p>
      <p>One isolate was scored as mismatch in the assembly data due to the original sample being mixed (15A and 15B/C) in PneumoCaT. However, it was resulted as 15B/C which correctly matched with the original laboratory serotype 15C.</p>
      <p>Sample ERR1440740 gave completely discrepant results with differing top hits between the FastQ and assembly data. The original PneumoCaT result was ‘Failed’ for this sample and the lab serotype was reported as 10F. The assembly data reported a &lt;20 % hit result with a top hit of 10C at only 11.1 %, while the FastQ data returned a 99.3 % hit with serotype 38. However, the maximum median-multiplicity metric was only 15, which indicated poor depth of read data in this sample resulting in poor multiplicity of k-mers in the analysis. For comparison, the average maximum median-multiplicity metric for the top hits in the full set of FastQ data from the validation panel was 114.45.</p>
      <p>The final discrepancy was mixed serotypes detected with PneumoKITy for a sample which had original PneumoCaT result 15B/C. PneumoKITy reported the estimated mixture of the isolates to be 15B/15C 53.47 % and 15F_15A 46.53 %, the top hits were 15C 95.7 %, 15B 95.6 %, 15A 91.4 %, and 15F 69.5 %,</p>
    </sec>
    <sec id="s5-7">
      <title>Results from final validation with nasopharyngeal culture genome set</title>
      <p>For final validation of PneumoKITy V1.0, the tool was run in pure culture mode on FastQ genome pairs and assemblies created from isolates obtained from a study of pneumococcal nasopharyngeal carriage [<xref rid="R23" ref-type="bibr">23</xref>]. In total 876 FastQ pairs and assemblies of these FastQ pairs were tested (Table S3) In this carriage study these samples were isolated as single colony picks and therefore considered as ‘pure culture’ isolates rather than potentially mixed (e.g., plate sweep samples). The summary results are shown in <xref rid="T8" ref-type="table">Table 8</xref>.</p>
      <table-wrap position="float" id="T8">
        <label>Table 8.</label>
        <caption>
          <p>Summary results from testing of nasopharyngeal carriage panel isolates using PneumoKITy with a) FastQ input and b) assembly input, compared to original PneumoCaT results</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" valign="top" colspan="4" rowspan="1">
                <p>a) FastQ input</p>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>RAG status</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Mismatch</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Match</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Grand total</bold>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>AMBER</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>3</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>3</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>GREEN</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>824</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>825</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>RED</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>7</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>38</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>45</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Grand total</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>11</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>865</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>876</bold>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" colspan="4" rowspan="1">
                <p>
                  <bold>b) Assembly input</bold>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>RAG status</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Mismatch</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Match</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Total</bold>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>AMBER</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>11</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>12</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>GREEN</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>816</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>816</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>RED</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>10</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>38</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>48</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Grand total</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>11</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>865</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>876</bold>
                </p>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>For FastQ and assembly input data respectively, 865 (98.7 %) of the samples gave the expected results compared to the original PneumoCaT 1.0 calls (serotype, genogroup or acapsular call) with either a ‘GREEN’ or ‘AMBER’ RAG status flag or a ‘RED’ status flag where the PneumoCaT result was ‘Failed’ which had been originally designated as NT (non-typable).</p>
      <p>Mismatched data are summarised in <xref rid="T9" ref-type="table">Table 9</xref>. One sample that had given a non-typeable result by PneumoCaT, gave a serotype 23B result and had an MLST sequence type and GPSC (439 and 7 respectively), indicative of serogroup 23 in the original study.</p>
      <table-wrap position="float" id="T9">
        <label>Table 9.</label>
        <caption>
          <p>Mismatched result data for the nasopharyngeal carriage isolate set</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" valign="top" rowspan="1" colspan="1">
                <p>Sample ID</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>PneumoCaT serotype</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>PneumoKITy FastQ result</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>FastQ RAG status</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>PneumoKITy assembly result</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>Assembly RAG status</p>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>ERR3530897</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>nt</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>23B</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>GREEN</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>23B</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>AMBER</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>ERR3530844</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6A</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6A_6B_6C_6D</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>AMBER</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6A_6B_6C_6D</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>ERR3530272</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6C</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6A_6B_6C_6D</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6A_6B_6C_6D</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>ERR3530449</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6A</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6A_6B_6C_6D</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6A_6B_6C_6D</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>ERR3530750</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6A</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6A_6B_6C_6D</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6A_6B_6C_6D</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>ERR3530848</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6A</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6A_6B_6C_6D</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6A_6B_6C_6D</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>ERR3530980</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6A</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6A_6B_6C_6D</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6A_6B_6C_6D</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>ERR3531026</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6A</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6A_6B_6C_6D</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6A_6B_6C_6D</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>ERR3531108</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6A</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6A_6B_6C_6D</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6A_6B_6C_6D</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>ERR3530382</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>15A</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Mixed serotypes- {'23B', '15F_15A'}</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>AMBER</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>ERR3530324</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6B</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6A_6B_6C_6D</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>AMBER</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>ERR3530801</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6C</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6A_6B_6C_6D</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>ERR3530903</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>23A</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Below 70 % hit – Poor Sequence quality, variant or non-typeable organism.</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>Most discrepancies in this set were serogroup 6 isolates which resulted as the serogroup rather than a more specific 6 A/C or 6C/D result due to failure of the second stage <italic toggle="yes">wciN</italic> determination to hit at &gt;90 % or in one case due to the median multiplicity of the k-mers screening against <italic toggle="yes">wciN</italic> being below the cut-off of 10.</p>
      <p>For one sample PneumoKITy detected a serotype mixture of 15A/15F with 23B which had not been detected in the original PneumoCaT run, the original PneumoCaT result was 15A. The final discrepancy was the failure of a 23A serotype to reach the initial 70 % screen lower cut-off in the assembly data, though the sample resulted correctly in the FastQ data.</p>
    </sec>
    <sec id="s5-8">
      <title>Detection of multiple serotypes in mixed samples</title>
      <p>To evaluate the capacity of PneumoKITy to detect multiple serotypes in mixed samples, the tool was run on 52 publicly available mixed serotype sequence samples prepared by Knight <italic toggle="yes">et al</italic>, [<xref rid="R11" ref-type="bibr">11</xref>] consisting of different combinations of serotypes 1, 3, 4, 6B, 7F, 9V, 14, 18C, 19F and 23F (Table S5) and compared with SeroCall. One sample (SRR9998155) had no serotypes detected by either method, but the FastQ files only had 3250 reads, suggesting there was not sufficient sequence coverage to detect the serotypes in the sample. This sample was excluded from further analysis.</p>
      <p>A comparison of multiple serotype detection of PneumoKITy and SeroCall on these samples is summarized in <xref rid="T10" ref-type="table">Table 10</xref>. PneumoKITy correctly detected all expected serotypes in the sample in 47/51 (92.2 %) to either type (1, 3, 4, 14, 19F, 23F) or group (6A/6B/6C/6D, 7F/7A, 9A/9V, 18B/18C) level compared with 42/51 (82.4 %) by SeroCall.</p>
      <table-wrap position="float" id="T10">
        <label>Table 10.</label>
        <caption>
          <p>Summary results of multiple serotype detection of mixed cultures of PneumoKITy compared with SeroCall. A match was defined as all expected serotypes and no unexpected serotypes were detected in the sample</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" valign="top" rowspan="1" colspan="1">
                <p>Method</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>Mismatch</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>Match</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>Grand total</p>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>PneumoKITy</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>4</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>47</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>51</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SeroCall</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>9</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>42</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>51</p>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p><xref rid="T11" ref-type="table">Table 11</xref> lists the samples where the serotypes determined by either PneumoKITy or SeroCall did not match what was expected. SRR9998215 was a mixture of serotypes 18C and 19F, however both PneumoKITy and SeroCall detected a third serotype (23F). Given the relative abundance of 23F was ~9 %, this result likely represents contamination of the culture with a 23F strain.</p>
      <table-wrap position="float" id="T11">
        <label>Table 11.</label>
        <caption>
          <p>Discrepant serotype results by PneumoKITy and/or SeroCall of mixed culture samples. Relative abundance is noted in parentheses where relevant. Note: as PneumoKITy will type 18B or 18C and 9V or 9A to group level, calls of 18B and 9A made by SeroCall were considered ‘correct’ for fair comparison to PneumoKITy</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" valign="top" rowspan="1" colspan="1">
                <p>Sample ID</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>Expected mix</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>SeroCall result</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>PneumoKITy result</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>RAG status</p>
              </th>
              <th align="center" valign="top" rowspan="1" colspan="1">
                <p>Mismatch description</p>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SRR9998215</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>18C, 19F</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>18C, 19F, 23F (8.96 %)</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>18C/18B, 19F, 23F (10.2 %)</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>GREEN</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>23F detected by both methods</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SRR9998218</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1, 3, 4, 6B, 7F, 9V, 14, 18C, 19F, 23F</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1, 3 (2.7 %), 4, 7F, 9V, 14, 18B, 19F, 23F</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1, 4, 6A/6B (19.69 %), 7F/7A, 9A/9V, 14, 18C/18B, 19F, 23F</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>GREEN</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Serotype 3 not detected by PneumoKITy</p>
                <p>6B not detected by SeroCall</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SRR9998177</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>3, 6B, 7F, 9V, 14</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>3 (1.5 %), 6B, 7F, 9V, 14</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>6A/6B, 7F/7A, 9A/9V, 14</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>GREEN</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Serotype 3 not detected by PneumoKITy</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SRR9998166</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1, 3, 4, 6B, 7F, 9V, 14, 18C, 19F, 23F</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1, 3 (0.5 %), 4, 6B, 7F, 9V, 14, 18B, 19F, 23F</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1, 4, 6A_6B_6C_6D, 7F/7A, 9A/9V, 14, 18C/18B, 19F, 23F</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>GREEN</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Serotype 3 not detected by PneumoKITy</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SRR9998157</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>3, 6B, 7F, 9V, 14</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>3, 4 (1 %), 6B, 7F, 9A, 14</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>3, 6A_6B_6C_6D, 7F/7A, 9A/9V, 14</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>GREEN</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Serotype 4 detected by SeroCall</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SRR9998185</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1, 19F</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1, 4 (0.4 %), 19F</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1, 19F</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>GREEN</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Serotype 4 detected by SeroCall</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SRR9998188</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>3, 6B, 7F, 9V, 14</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>3, 4 (0.6 %), 6B, 7F, 9V, 14</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>3, 6A/6B, 7F/7A, 9A/9V, 14</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>GREEN</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Serotype 4 detected by SeroCall</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SRR9998190</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>3, 6B, 7F, 9V, 14</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>3, 4 (0.7 %), 6B, 7F, 9V, 14</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>3, 6A/6B, 7F/7A, 9A/9V, 14</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>GREEN</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Serotype 4 detected by SeroCall</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SRR9998199</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>19F, 23F</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1 (0.3 %), 4 (0.3 %), 19F, 23F (10.2 %)</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>19F, 23F (8.96 %)</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>GREEN</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Serotypes 1 and 4 detected by SeroCall</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SRR9998219</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>3, 6B, 7F, 9V, 14</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>3, 4 (0.7 %), 6B, 7F, 9V, 14</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>3, 6A/6B, 7F/7A, 9A/9V, 14,</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>GREEN</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Serotype 4 detected by SeroCall</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SRR9998222</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>18C, 19F</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>4 (0.4 %), 18B, 18C, 19F, 23F (0.3 %)</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>18C/18B, 19F</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>GREEN</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Serotypes 4, and 23F detected by SeroCall</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SRR9998155 - EXCLUDED</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>3, 6B, 7F, 9V, 14</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>No result</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>No result</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>RED</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Low sequence coverage</p>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>Compared with SeroCall, PneumoKITy failed to detect serotype 3 in three samples. For these samples the serotype 3 hit percentage was below 90 % threshold (82.6%, 73.2% and 69.7 %) and the relative abundance of serotype 3 in these samples as determined by SeroCall were less than 3 %.</p>
      <p>For the remaining seven discrepant samples, SeroCall detected a serotype that was not expected to be present in the sample. All these serotype calls had a relative abundance of less than 1%, suggesting these may represent contamination of these samples during the DNA extraction procedure.</p>
      <p>To assess the ability of PneumoKITy to determine the relative abundance of serotypes in a sample, samples mixed in known proportions prepared by Knight <italic toggle="yes">et al</italic>. [<xref rid="R11" ref-type="bibr">11</xref>] were compared with the relative abundance calculated by PneumoKITy and SeroCall (<xref rid="T12" ref-type="table">Table 12</xref>). Both methods performed well in estimating the relative abundance of each of the serotypes within each sample. PneumoKITy was more accurate at estimating the relative abundance with an average estimate of 1.5 % deviation from the expected abundance compared with 2.2 % for SeroCall.</p>
      <table-wrap position="float" id="T12">
        <label>Table 12.</label>
        <caption>
          <p>Comparison of relative abundance of each serotype detected by PneumoKITy or SeroCall in samples mixed in known ratios</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" valign="top" rowspan="1" colspan="1"/>
              <th align="center" valign="top" rowspan="1" colspan="1"/>
              <th align="center" valign="top" colspan="5" rowspan="1">
                <p>Relative abundance of serotype (%)</p>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Sample ID</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1"/>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>1</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>4</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>18C</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>19F</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>23F</bold>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="3" colspan="1">
                <p>SRR9998169</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Known mixture</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>50.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>50.00</p>
              </td>
            </tr>
            <tr>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>PneumoKITy</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>49.81</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>50.19</p>
              </td>
            </tr>
            <tr>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>SeroCall</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>49.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>51.00</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="3" colspan="1">
                <p>SRR9998160</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Known mixture</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>33.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>67.00</p>
              </td>
            </tr>
            <tr>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>PneumoKITy</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>32.82</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>67.18</p>
              </td>
            </tr>
            <tr>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>SeroCall</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>31.10</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>68.90</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="3" colspan="1">
                <p>SRR9998161</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Known mixture</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>20.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>80.00</p>
              </td>
            </tr>
            <tr>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>PneumoKITy</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>20.90</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>79.10</p>
              </td>
            </tr>
            <tr>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>SeroCall</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>17.40</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>82.60</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="3" colspan="1">
                <p>SRR9998159</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Known mixture</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>11.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>89.00</p>
              </td>
            </tr>
            <tr>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>PneumoKITy</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>11.60</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>88.40</p>
              </td>
            </tr>
            <tr>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>SeroCall</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>10.30</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>89.70</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="3" colspan="1">
                <p>SRR9998156</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Known mixture</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>9.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>91.00</p>
              </td>
            </tr>
            <tr>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>PneumoKITy</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>9.57</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>90.43</p>
              </td>
            </tr>
            <tr>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>SeroCall</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>8.70</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>91.30</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="3" colspan="1">
                <p>SRR9998197</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Known mixture</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>99.00</p>
              </td>
            </tr>
            <tr>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>PneumoKITy</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.30</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>98.70</p>
              </td>
            </tr>
            <tr>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>SeroCall</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.90</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>99.10</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="3" colspan="1">
                <p>SRR9998191</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Known mixture</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>17.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>17.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>66.00</p>
              </td>
            </tr>
            <tr>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>PneumoKITy</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>10.53</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>18.42</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>71.05</p>
              </td>
            </tr>
            <tr>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>SeroCall</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>9.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>–</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>16.50</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>74.60</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="3" colspan="1">
                <p>SRR9998154</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>Known mixture</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>40.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>20.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>10.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>10.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>20.00</p>
              </td>
            </tr>
            <tr>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>PneumoKITy</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>45.28</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>19.44</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>4.44</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>10.83</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>20.00</p>
              </td>
            </tr>
            <tr>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>SeroCall</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>44.80</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>19.90</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>3.70</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>9.20</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>22.40</p>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec id="s5-9">
      <title>Benchmarking</title>
      <p>PneumoKITy V1.0, PneumoCaT V1.2.1 and SeroCall were run on serotype 1 (ERR1437924) and serotype 15A (ERR1437939) SSI reference FastQ files in pure culture mode. The full data on mean run time and memory requirement from three runs are recorded in Table S6. PneumoKITy was 18× faster and used over 10× less memory than PneumoCaT and 25× faster and used 1.9× less memory than SeroCall on a serotype 1 isolate (stage 1 only) using a single thread. On a 15A genome using a single thread, PneumoKITy was 4.4× faster and used 9× less memory than PneumoCaT and 5.9× faster and used 1.9 × less memory than SeroCall. The memory requirement for PneumoKITy was consistent between the two serotype runs remaining at around 88 Mb. Increasing the number of threads to four reduced the run time for PneumoKITy from 7.96 s to 5.89 s for the serotype 1 compared to PneumoCaT and SeroCall both resulted in just under 1 min when four threads were used for the analysis compared to 2.28 min and 3.25 min respectively for a single thread.</p>
      <p>PneumoKITy was then run with the genome assembly files for serotype 1 and 15A in pure culture mode. SeroCall and PneumoCaT 1.2.1 cannot run from assemblies so were not compared. Determinations from assemblies in pure culture mode for both serotype 1 (stage 1 only) and serotype 15A (stage 2) were completed in less than 1 smeg and using fewer than 90 megabytes of memory using PneumoKITy.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s6">
    <title>Discussion</title>
    <p>Sensitive detection of multiple pneumococcal serotypes in nasopharyngeal carriage samples would give valuable additional information to inform vaccine implementation and surveillance of <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.5677" ext-link-type="uri">S. pneumoniae</ext-link></named-content></italic> disease. We have developed PneumoKITy a lightweight, fast and accurate option for determining multiple serotypes present in genomic read data (FastQ).</p>
    <p>Mash Screen, as used in PneumoKITy, was found to be a highly effective method of determination of serotype from WGS data. The method was specific enough to determine genogroups that were similar to those defined for the Bowtie two mapping approach used for PneumoCaT [<xref rid="R5" ref-type="bibr">5</xref>]. In some cases, Mash Screen [<xref rid="R13" ref-type="bibr">13</xref>] was found to be more specific than the original mapping method, meaning that serotypes that fall in a genogroup in PneumoCaT can be determined fully with a stage 1 screen alone (e.g. serotypes in serogroup 10), in total PneumoKITy can determine 54 (58.1 %) of the 93 serotypes in the SSI Diagnostica phenotypical serotyping scheme to type level with the remainder called to serogroup or sub-serogroup level (e.g. 11A/D)</p>
    <p>Mash Screen was successfully implemented as stage 2 analysis method for genogroups where the difference can be determined using gene presence/absence or alleles of genes. Serotypes 19A, 19AF (19A-like CPS operon background with variant <italic toggle="yes">wzy</italic> and phenotype 19F [<xref rid="R24" ref-type="bibr">24</xref>]), 15A and 15F can be fully determined in this way and some genogroups can be sub-divided into serotypes and sub-serogroups, e.g. serotype 12F can be subdivided from sub-serogroup 12A/12B/44/46; serogroup 6 can be sub-divided into 6A/6B and 6C/6D with subtype 6E also being detected and reported as 6E_serogroup6 to reflect that the phenotype of the genetic type 6E isolate within serogroup 6 is not possible to derive using PneumoKITy.</p>
    <p>PneumoKITy reports the expected phenotype of the organism as if it had been determined using the commercially available typing sera (SSI Diagnostica, Copenhagen). However, by examination of the top-hits and other information included in the PneumoKITy output – the genetic type of the organism can be suggested, for example genetic subtype 23B1 discovered in the initial development of PneumoCaT [<xref rid="R12" ref-type="bibr">12</xref>] will result as expected phenotype 23B. However, the top hit in the stage 1 analysis will be to the 23B1 reference rather than the 23B reference, in this way the similarity of the isolate CPS operon to previously published subtypes of serogroup 19 and 6 [<xref rid="R16" ref-type="bibr">16</xref>] can be determined by examination of the top hits.</p>
    <p>PneumoKITy incorporates a newly designed SQL CTVdb which is central to the software and used for all serotype result interpretations. PneumoKITy provides useful outputs that are more comprehensive and user friendly than the outputs provided by PneumoCaT and employs a helpful RAG status flag to alert the user to the quality of the results. The software outputs a human-readable text report containing the results, RAG status and quality system data (file locations, software versions etc.), csv files suitable for computational manipulation, if necessary, plus full analysed Mash Screen result output csv for the capsular operon screen (and any subsequent gene screens). Outputs are also tailored depending on whether pure run mode is selected, or mix run mode is selected. If pure mode is selected, mixed serotypes can still be detected with lower sensitivity, but any serotypes in the mixture that require subtyping at stage 2 are not subtyped, though an estimation of the abundance of the genogroups determined is still given. In mix mode subtyping of all the serotypes detected in the mix is attempted if applicable.</p>
    <p>Analysis of the reference isolates and the carriage study data showed PneumoKITy to be highly accurate. Its sensitivity to mixtures when used in mix mode is useful for detection of multiple serotypes where mixtures might be expected, for example if testing sweep cultures from carriage samples or as a means of quality control of DNA extraction procedures.</p>
    <p>Some areas for serotype specificity improvement were noted in the data, for example in the pure culture nasopharyngeal carriage set, several serogroup 6 samples resulted as 6A/6B/6C/6D rather than the expected sub-groups 6A/6B or 6C/6D. This was due to the second stage detection of <italic toggle="yes">wciN</italic> giving hits just below the hit cut-off of 90 %. Although in this set 111 samples did correctly type as the more specific 6A/6B or 6C/6D sub-serogroup, indicating the problem was not widespread, this did suggest that the stage 2 gene-based analysis was either set with too-strict a cut-off or would be better served by inclusion of more than one gene version for each detected gene in the analysis, the latter being the preferable solution.</p>
    <p>The reference sequences used in the original PneumoCaT CTVdb are from very historical strains and therefore may not reflect the sequences of the currently circulating strains. Due to the extra specificity of the Mash Screen k-mer-based method, this results in lower hit percentage due to removal of non-exact match k-mers than would happen in the mapping-based method used by PneumoCaT, and this is particularly emphasised in the gene-based analysis where the percentage hit is much more affected by loss of individual k-mers, due to one nucleotide difference, than in longer sequences. Additional references were added to the PneumoKITy CTVdb stage 1 capsular operon reference to reflect expected diversity of sequences, with inclusion of capsular operon references for defined subtypes of serogroups 6 and 19 from Elberse <italic toggle="yes">et al.</italic> [<xref rid="R16" ref-type="bibr">16</xref>] and new capsular operon references were created and added to the stage 1 references during the development of PneumoKITy for serotypes 18F, 33F and 24F.</p>
    <p>For 33F it was found that the isolates that gave an issue and caused an additional reference sequence to be necessary, had a missing gene <italic toggle="yes">wcjE</italic>, which had been replaced with <italic toggle="yes">wcyO</italic> in the capsular operon sequence. Variants similar to these had been noted in previous work [<xref rid="R25" ref-type="bibr">25</xref>]. It is highly likely that additional variants and representative capsular operon references will need to be added to the CTVdb, for other serogroups in stage 1 which demonstrated higher percentage of samples hitting with AMBER RAG status due to the initial hit being below 90 %.</p>
    <p>No additional references were added to the gene sequence references used in stage 2 of the PneumoKITy analysis, and thus AMBER flagged sample results could be upgraded to GREEN by inclusion of additional representatives of the genes or alleles used in stage 2 presence/absence or allele-based analyses.</p>
    <p>Analysis of the mixed serotype samples showed that detection of low abundance serotypes in mixtures was possible. PneumoKITy correctly detected 92.2 % of the serotypes in the panel of mixed serotype samples tested and was able to detect a minor serotype with 1 % expected abundance in some samples. The calculated abundance reported by PneumoKITy on samples of known mixtures was highly accurate and estimated the abundance to within 1.5 % of the expected abundance in the mix which was a closer match than found by SeroCall (2.2 %). However, PneumoKITy did present a limitation for detecting serotype 3 in some of the mixtures, with serotype 3 being undetected in three samples. Of all the mixed samples containing serotype 3, these three had the lowest abundance of serotype 3 as determined by SeroCall. The hit percentage for serotype 3 in these samples ranged from 70–83 % (Table S5) suggesting that the abundance of the serotype 3 was too low for the detection using the &gt;90 % hit cut off in the presence of other serotypes with hit percentage above this level. At present PneumoKITy ignores these due to the presence of initial hits above the 90 % default cut-off setting, but if it was the only serotype present the cut-off drop to 70 % could have then detected them. The hit percentage cut off can be manually reduced using the -p flag which would improve the sensitivity for detection of the low abundance samples in this case. Further work could be undertaken to improve the sensitivity for detection in mixtures, perhaps by flagging serotypes that are not in genogroups but that hit with a percentage level between 70 % and the input cut-off or by inclusion of additional references if the current reference is not representative of the serotype so that the initial hit percentage is higher and it is less likely to dip below 90 % when in low abundance.</p>
    <p>Some serotypes missed by PneumoKITy in the incubated mixture samples but called by SeroCall were missed due to very low median-multiplicity of the specific k-mers in the mixture in the majority of cases. This could represent very low numbers of original reads in the data for this serotype, which coupled with the sequence specific nature of the k-mer analysis could reduce k-mers included leading to failure to detect. A sensible initial median multiplicity cut-off value of 4 was set for the PneumoKITy mixture analysis which means that each k-mer included in the analysis must be represented four times in the dataset. If this cut-off is reduced further some low abundance serotypes may be called. However, this greatly increases the chances of calling hits with sequence errors or very low-level contaminants. Distinguishing contaminants from genuine serotypes present in the data is difficult, but the information included in the additional files produced by PneumoKITy can be used along with laboratory experience of the extraction and sequencing techniques to judge whether a low-level serotype resulting in the k-mer analysis with below four median-multiplicity could be judged as a true positive. PneumoKITy can run with less stringent median-multiplicity requirement (-n) if it was felt the cut-off was too strict. As PneumoKITy retains all data used for the analysis in additional csv files, results from samples which did not hit the cut-offs can be examined post-run.</p>
    <p>An additional feature of PneumoKITy is its ability to run on genome assembly (Fasta) data when run in pure detection mode. This ability was tested by parallel running of the reference and nasopharyngeal carriage data in pure culture detection mode. The use of assembly data gave almost identical results to that of the FastQ input data. However, the quality of the assembly input greatly affected the outcomes; in some cases, the input assembly data was poor with poor L50 and N50 scores and no result was obtained. In other cases, though the L50 and N50 scores of the assemblies were good, no result was obtained. Annotation of these assembly files revealed that the capsular operon in these cases was split over multiple contigs which had affected the assembly input but not the result from the FastQ input.</p>
    <p>As with all analytical processes it is best if quality assessment of input data is performed, and results judged accordingly. As PneumoKITy data resulting with the &lt;20 % hit can be assumed to represent an acapsular organism, the quality of the input data must be considered if scoring these results this way. In its current validated form described in this manuscript, PneumoKITy has no ability to determine if a non-capsular pneumococcus might exist in a mixture with a capsular pneumococcus. However, a developmental version of PneumoKITy which has sequences representing non-capsular organisms has been added to a development branch on the PneumoKITy GitHub repository (<ext-link xlink:href="https://github.com/CarmenSheppard/PneumoKITy/tree/non_cap" ext-link-type="uri">https://github.com/CarmenSheppard/PneumoKITy/tree/non_cap</ext-link>). This version has not yet been fully validated; users may wish to validate this version for their own purposes. In addition, PneumoKITy does provide an option for users to provide a custom CTVdb database and reference files, so users can run the software against their own reference sequences.</p>
    <p>Benchmarking showed PneumoKITy to be extremely fast and with lower memory requirements than PneumoCaT 1.2.1. The determinations were even quicker, resulting in &lt;1 s, when run on assembly files. The software cannot determine final serotype for serotypes that require SNP or functional gene analysis, so the addition of these methods would increase runtime as they would require additional bioinformatic methods for determination rather than k-mer screening. However, PneumoKITy can determine more serotypes in stage 1 than PneumoCaT 1.2.1, and therefore many of the samples that are run in the software will result to a final serotype quickly using the k-mer screen analysis alone. PneumoKITy also demonstrates high accuracy for determination of multiple serotypes in complex samples which should facilitate studies of the serotypes present in nasopharyngeal carriage.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Data</title>
    <supplementary-material position="float" id="supp1" content-type="local-data">
      <caption>
        <title>Supplementary material 1</title>
      </caption>
      <media xlink:href="mgen-8-904-s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material position="float" id="supp2" content-type="local-data">
      <caption>
        <title>Supplementary material 2</title>
      </caption>
      <media xlink:href="mgen-8-904-s002.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material position="float" id="supp3" content-type="local-data">
      <caption>
        <title>Supplementary material 3</title>
      </caption>
      <media xlink:href="mgen-8-904-s003.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material position="float" id="supp4" content-type="local-data">
      <caption>
        <title>Supplementary material 4</title>
      </caption>
      <media xlink:href="mgen-8-904-s004.xls">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material position="float" id="supp5" content-type="local-data">
      <caption>
        <title>Supplementary material 5</title>
      </caption>
      <media xlink:href="mgen-8-904-s005.xls">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material position="float" id="supp6" content-type="local-data">
      <caption>
        <title>Supplementary material 6</title>
      </caption>
      <media xlink:href="mgen-8-904-s006.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material position="float" id="supp7" content-type="local-data">
      <caption>
        <title>Supplementary material 7</title>
      </caption>
      <media xlink:href="mgen-8-904-s007.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Funding information</title>
    <p>This work received no specific grant from any funding agency</p>
  </ack>
  <ack id="ack2">
    <title>Acknowledgements</title>
    <p>The authors would like to acknowledge the assistance of the following people: Anthony Underwood, formerly of the Centre for Pathogen Genomic Surveillance for external testing and feedback on an initial version of the PneumoKITy software. Jim Knight and Dan Weinberger for correspondence regarding SeroCall software and genomic data. The laboratory and surveillance team at PHE/UKHSA for coordinating the surveillance for sending of isolates, serotyping isolates and genomic DNA extraction and sequencing that went into the original PneumoCaT validation panel and the nasopharyngeal carriage panel.</p>
  </ack>
  <ack id="ack3">
    <title>Author contribution</title>
    <p>C.S. – Conceptualization, Data curation, Formal analysis, Investigation, Methodology, Project administration, Software, Validation, Visualisation, Writing – original draft, Writing – review and editing. S.M. – Data curation, Formal analysis, Investigation, Validation, Writing – original draft, Writing – review and editing. N.G. – Conceptualization, Supervision, Writing – review and editing. D.J.L. – Supervision, Project administration, Resources, Writing – review and editing. Z.A-C. – Data curation, Writing – review and editing. M.B. – Writing – review and editing. S.L. – Data curation, Resources, Writing – review and editing. C.S. – Data curation, Supervision, Resources, Writing – review and editing. N.K.F. - Supervision, Project administration, Resources, Writing – review and editing.</p>
  </ack>
  <ack id="ack4">
    <title>Conflicts of interest</title>
    <p content-type="COI-statement">Carmen Sheppard – recently joined a commercial company specialising in development of genome analysis platforms; however, this work was done prior to this change in affiliation. Public Health England (PHE), now the UK Health Security Agency (UKHSA) Immunisation and Vaccine Preventable Diseases Division provides vaccine manufacturers with post-marketing surveillance reports, which Marketing Authorisation Holders are required to submit to the UK Licensing authority in compliance with their Risk Management Strategy. A cost recovery charge is made for these reports. Sam Manna – None. Natalie Groves – Public Health England (PHE), now the UK Health Security Agency (UKHSA) Immunisation and Vaccine Preventable Diseases Division provides vaccine manufacturers with post-marketing surveillance reports, which Marketing Authorisation Holders are required to submit to the UK Licensing authority in compliance with their Risk Management Strategy. A cost recovery charge is made for these reports. David J. Litt – Public Health England (PHE), now the UK Health Security Agency (UKHSA) Immunisation and Vaccine Preventable Diseases Division provides vaccine manufacturers with post-marketing surveillance reports, which Marketing Authorisation Holders are required to submit to the UK Licensing authority in compliance with their Risk Management Strategy. A cost recovery charge is made for these reports. Zahin Amin-Chowdhury – Public Health England (PHE), now the UK Health Security Agency (UKHSA) Immunisation and Vaccine Preventable Diseases Division provides vaccine manufacturers with post-marketing surveillance reports, which Marketing Authorisation Holders are required to submit to the UK Licensing authority in compliance with their Risk Management Strategy. A cost recovery charge is made for these reports. Marta Bertran – Public Health England (PHE), now the UK Health Security Agency (UKHSA) Immunisation and Vaccine Preventable Diseases Division provides vaccine manufacturers with post-marketing surveillance reports, which Marketing Authorisation Holders are required to submit to the UK Licensing authority in compliance with their Risk Management Strategy. A cost recovery charge is made for these reports. Shamez Ladhani – Public Health England (PHE), now the UK Health Security Agency (UKHSA) Immunisation and Vaccine Preventable Diseases Division provides vaccine manufacturers with post-marketing surveillance reports, which Marketing Authorisation Holders are required to submit to the UK Licensing authority in compliance with their Risk Management Strategy. A cost recovery charge is made for these reports. Catherine Satzke – Lead investigator on a Merck Investigator Studies ProgramProgramme grant funded by MSD on pneumococcal serotype epidemiology. Investigator on a clinical research collaboration on PCV vaccination in Mongolia. Norman K. Fry – Public Health England (PHE), now the UK Health Security Agency (UKHSA) Immunisation and Vaccine Preventable Diseases Division provides vaccine manufacturers with post-marketing surveillance reports, which Marketing Authorisation Holders are required to submit to the UK Licensing authority in compliance with their Risk Management Strategy. A cost recovery charge is made for these reports. Dr NK Fry and his team conduct contract research for pharmaceutical industries on behalf of UKHSA (formerly PHE). No personal remuneration is received.</p>
  </ack>
  <ack id="ack5">
    <title>Ethical statement</title>
    <p>None necessary - publicly available data only used for analyses.</p>
  </ack>
  <ack id="ack6">
    <title>Consent to publish</title>
    <p>None necessary.</p>
  </ack>
  <fn-group>
    <fn id="FN1">
      <p>Abbreviations: CPS, capsular polysaccharide; CSF, cerebrospinal fluid; GPSC, Global Pneumococcal Sequence Cluster; MLST, multi-locus sequence typing; PHE, Public Health England; PneumoKITy, Pneumococcal K-mer Integrated Typing; UKHSA, UK Health Security Agency; WGS, whole genome sequencing.</p>
    </fn>
    <fn id="FN3">
      <p>All supporting data, code and protocols have been provided within the article or through supplementary data files. One supplementary figure and six supplementary tables are available with the online version of this article.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="R1">
      <label>1</label>
      <element-citation publication-type="data">
        <person-group person-group-type="author">
          <name>
            <surname>Sheppard</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Manna</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Groves</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Litt</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Amin-Chowdhury</surname>
            <given-names>Z</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <data-title>PneumoKITy: A fast, flexible, specific, and sensitive tool for <italic toggle="yes">Streptococcus pneumoniae</italic> serotype screening and mixed serotype detection from genome sequence data</data-title>
        <source>FigShare</source>
        <year>2022</year>
        <pub-id pub-id-type="doi">10.6084/m9.figshare.21067339.v1</pub-id>
      </element-citation>
    </ref>
    <ref id="R2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Troeger</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Blacker</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Khalil</surname>
            <given-names>IA</given-names>
          </name>
          <name>
            <surname>Rao</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>J</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>Estimates of the global, regional, and national morbidity, mortality, and aetiologies of lower respiratory infections in 195 countries, 1990-2016: a systematic analysis for the Global Burden of Disease study 2016</article-title>
        <source>Lancet Infect Dis</source>
        <year>2018</year>
        <volume>18</volume>
        <fpage>1191</fpage>
        <lpage>1210</lpage>
        <pub-id pub-id-type="doi">10.1016/S1473-3099(18)30310-4</pub-id>
        <pub-id pub-id-type="pmid">30243584</pub-id>
      </element-citation>
    </ref>
    <ref id="R3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ganaie</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Saad</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>McGee</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>van Tonder</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Bentley</surname>
            <given-names>SD</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>A new pneumococcal capsule type, 10D, is the 100th serotype and has a large <italic toggle="yes">cps</italic> fragment from an oral <italic toggle="yes">Streptococcus</italic>
</article-title>
        <source>mBio</source>
        <year>2020</year>
        <volume>11</volume>
        <elocation-id>e00937-20</elocation-id>
        <pub-id pub-id-type="doi">10.1128/mBio.00937-20</pub-id>
        <pub-id pub-id-type="pmid">32430472</pub-id>
      </element-citation>
    </ref>
    <ref id="R4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bentley</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Aanensen</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Mavroidi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Saunders</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rabbinowitsch</surname>
            <given-names>E</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>Genetic analysis of the capsular biosynthetic locus from all 90 pneumococcal serotypes</article-title>
        <source>PLoS Genet</source>
        <year>2006</year>
        <volume>2</volume>
        <elocation-id>e31</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.0020031</pub-id>
        <pub-id pub-id-type="pmid">16532061</pub-id>
      </element-citation>
    </ref>
    <ref id="R5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kapatai</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sheppard</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Al-Shahib</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Litt</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Underwood</surname>
            <given-names>AP</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>Whole genome sequencing of <italic toggle="yes">Streptococcus pneumoniae</italic>: development, evaluation and verification of targets for serogroup and serotype prediction using an automated pipeline</article-title>
        <source>PeerJ</source>
        <year>2016</year>
        <volume>4</volume>
        <elocation-id>e2477</elocation-id>
        <pub-id pub-id-type="doi">10.7717/peerj.2477</pub-id>
        <pub-id pub-id-type="pmid">27672516</pub-id>
      </element-citation>
    </ref>
    <ref id="R6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaguza</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Senghore</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bojang</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lo</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Ebruke</surname>
            <given-names>C</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>Carriage dynamics of pneumococcal serotypes in naturally colonized infants in a rural African setting during the first year of life</article-title>
        <source>Front Pediatr</source>
        <year>2020</year>
        <volume>8</volume>
        <fpage>587730</fpage>
        <pub-id pub-id-type="doi">10.3389/fped.2020.587730</pub-id>
        <pub-id pub-id-type="pmid">33489998</pub-id>
      </element-citation>
    </ref>
    <ref id="R7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sá-Leão</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Tomasz</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Santos Sanches</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>de Lencastre</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Pilot study of the genetic diversity of the pneumococcal nasopharyngeal flora among children attending day care centers</article-title>
        <source>J Clin Microbiol</source>
        <year>2002</year>
        <volume>40</volume>
        <fpage>3577</fpage>
        <lpage>3585</lpage>
        <pub-id pub-id-type="doi">10.1128/JCM.40.10.3577-3585.2002</pub-id>
        <pub-id pub-id-type="pmid">12354849</pub-id>
      </element-citation>
    </ref>
    <ref id="R8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kamng’ona</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Hinds</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bar-Zeev</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Gould</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Chaguza</surname>
            <given-names>C</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>High multiple carriage and emergence of <italic toggle="yes">Streptococcus pneumoniae</italic> vaccine serotype variants in Malawian children</article-title>
        <source>BMC Infect Dis</source>
        <year>2015</year>
        <volume>15</volume>
        <elocation-id>234</elocation-id>
        <pub-id pub-id-type="doi">10.1186/s12879-015-0980-2</pub-id>
        <pub-id pub-id-type="pmid">26088623</pub-id>
      </element-citation>
    </ref>
    <ref id="R9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kaltoft</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Skov Sørensen</surname>
            <given-names>UB</given-names>
          </name>
          <name>
            <surname>Slotved</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Konradsen</surname>
            <given-names>HB</given-names>
          </name>
        </person-group>
        <article-title>An easy method for detection of nasopharyngeal carriage of multiple <italic toggle="yes">Streptococcus pneumoniae</italic> serotypes</article-title>
        <source>J Microbiol Methods</source>
        <year>2008</year>
        <volume>75</volume>
        <fpage>540</fpage>
        <lpage>544</lpage>
        <pub-id pub-id-type="doi">10.1016/j.mimet.2008.08.010</pub-id>
        <pub-id pub-id-type="pmid">18801391</pub-id>
      </element-citation>
    </ref>
    <ref id="R10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Epping</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>van Tonder</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Gladstone</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Bentley</surname>
            <given-names>SD</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>SeroBA: rapid high-throughput serotyping of <italic toggle="yes">Streptococcus pneumoniae</italic> from whole genome sequence data</article-title>
        <source>Microb Genom</source>
        <year>2018</year>
        <volume>4</volume>
        <elocation-id>e000186</elocation-id>
        <pub-id pub-id-type="doi">10.1099/mgen.0.000186</pub-id>
        <pub-id pub-id-type="pmid">29870330</pub-id>
      </element-citation>
    </ref>
    <ref id="R11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Knight</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Dunne</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Mulholland</surname>
            <given-names>EK</given-names>
          </name>
          <name>
            <surname>Saha</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Satzke</surname>
            <given-names>C</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>Determining the serotype composition of mixed samples of pneumococcus using whole-genome sequencing</article-title>
        <source>Microb Genom</source>
        <year>2021</year>
        <volume>7</volume>
        <pub-id pub-id-type="doi">10.1099/mgen.0.000494</pub-id>
      </element-citation>
    </ref>
    <ref id="R12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kapatai</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sheppard</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Troxler</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Litt</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Furrer</surname>
            <given-names>J</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>Pneumococcal 23B molecular subtype identified using whole genome sequencing</article-title>
        <source>Genome Biol Evol</source>
        <year>2017</year>
        <volume>9</volume>
        <fpage>2122</fpage>
        <lpage>2135</lpage>
        <pub-id pub-id-type="doi">10.1093/gbe/evx092</pub-id>
        <pub-id pub-id-type="pmid">28910966</pub-id>
      </element-citation>
    </ref>
    <ref id="R13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ondov</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Treangen</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Melsted</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mallonee</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Bergman</surname>
            <given-names>NH</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>Mash: fast genome and metagenome distance estimation using MinHash</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <elocation-id>132</elocation-id>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0997-x</pub-id>
        <pub-id pub-id-type="pmid">27323842</pub-id>
      </element-citation>
    </ref>
    <ref id="R14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ondov</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Starrett</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Sappington</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kostic</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>Mash screen: high-throughput sequence containment estimation for genome discovery</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <elocation-id>232</elocation-id>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1841-x</pub-id>
        <pub-id pub-id-type="pmid">31690338</pub-id>
      </element-citation>
    </ref>
    <ref id="R15">
      <label>15</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>van Rossum</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Drake</surname>
            <given-names>FL</given-names>
          </name>
        </person-group>
        <source>Python 3 Reference Manual</source>
        <publisher-loc>Scotts Valley, CA</publisher-loc>
        <publisher-name>CreateSpace</publisher-name>
        <year>2009</year>
      </element-citation>
    </ref>
    <ref id="R16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Elberse</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Witteveen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>van der Heide</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>van de Pol</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Schot</surname>
            <given-names>C</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>Sequence diversity within the capsular genes of <italic toggle="yes">Streptococcus pneumoniae</italic> serogroup 6 and 19</article-title>
        <source>PLoS One</source>
        <year>2011</year>
        <volume>6</volume>
        <elocation-id>e25018</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0025018</pub-id>
        <pub-id pub-id-type="pmid">21949837</pub-id>
      </element-citation>
    </ref>
    <ref id="R17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wick</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Judd</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Gorrie</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Holt</surname>
            <given-names>KE</given-names>
          </name>
        </person-group>
        <article-title>Unicycler: resolving bacterial genome assemblies from short and long sequencing reads</article-title>
        <source>PLoS Comput Biol</source>
        <year>2017</year>
        <volume>13</volume>
        <elocation-id>e1005595</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1005595</pub-id>
        <pub-id pub-id-type="pmid">28594827</pub-id>
      </element-citation>
    </ref>
    <ref id="R18">
      <label>18</label>
      <element-citation publication-type="book">
        <person-group>
          <collab>R Core team</collab>
        </person-group>
        <article-title>R: The R Project for Statistical Computing. R Foundation for Statistical Computing</article-title>
        <publisher-loc>Vienna, Austria</publisher-loc>
        <year>2017</year>
        <ext-link xlink:href="https://www.r-project.org/" ext-link-type="uri">https://www.r-project.org/</ext-link>
      </element-citation>
    </ref>
    <ref id="R19">
      <label>19</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Wickham</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>ggplot2: Elegant Graphics for Data Analysis</article-title>
        <publisher-name>Springer-Verlag New York</publisher-name>
        <year>2016</year>
        <ext-link xlink:href="https://ggplot2.tidyverse.org" ext-link-type="uri">https://ggplot2.tidyverse.org</ext-link>
      </element-citation>
    </ref>
    <ref id="R20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Seemann</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Prokka: rapid prokaryotic genome annotation</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>2068</fpage>
        <lpage>2069</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu153</pub-id>
        <pub-id pub-id-type="pmid">24642063</pub-id>
      </element-citation>
    </ref>
    <ref id="R21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cock</surname>
            <given-names>PJA</given-names>
          </name>
          <name>
            <surname>Antao</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Chapman</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Cox</surname>
            <given-names>CJ</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>Biopython: freely available Python tools for computational molecular biology and bioinformatics</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1422</fpage>
        <lpage>1423</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp163</pub-id>
        <pub-id pub-id-type="pmid">19304878</pub-id>
      </element-citation>
    </ref>
    <ref id="R22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kumar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Stecher</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Knyaz</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Tamura</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>MEGA X: Molecular Evolutionary Genetics Analysis across computing platforms</article-title>
        <source>Mol Biol Evol</source>
        <year>2018</year>
        <volume>35</volume>
        <fpage>1547</fpage>
        <lpage>1549</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msy096</pub-id>
        <pub-id pub-id-type="pmid">29722887</pub-id>
      </element-citation>
    </ref>
    <ref id="R23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sheppard</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Groves</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Litt</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Fry</surname>
            <given-names>NK</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>The genomics of <italic toggle="yes">Streptococcus pneumoniae</italic> carriage isolates from UK children and their household contacts, Pre-PCV7 to Post-PCV13</article-title>
        <source>Genes</source>
        <year>2019</year>
        <volume>10</volume>
        <elocation-id>E687</elocation-id>
        <pub-id pub-id-type="doi">10.3390/genes10090687</pub-id>
      </element-citation>
    </ref>
    <ref id="R24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dunne</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Tikkanen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Balloch</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gould</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Yoannes</surname>
            <given-names>M</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>Characterization of 19A-like 19F pneumococcal isolates from Papua new Guinea and Fiji</article-title>
        <source>New Microbes New Infect</source>
        <year>2015</year>
        <volume>7</volume>
        <fpage>86</fpage>
        <lpage>88</lpage>
        <pub-id pub-id-type="doi">10.1016/j.nmni.2015.06.008</pub-id>
        <pub-id pub-id-type="pmid">26339490</pub-id>
      </element-citation>
    </ref>
    <ref id="R25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Manna</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dunne</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Ortika</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Pell</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Kama</surname>
            <given-names>M</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>Discovery of a <italic toggle="yes">Streptococcus pneumoniae</italic> serotype 33F capsular polysaccharide locus that lacks wcjE and contains a wcyO pseudogene</article-title>
        <source>PLoS One</source>
        <year>2018</year>
        <volume>13</volume>
        <elocation-id>e0206622</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0206622</pub-id>
        <pub-id pub-id-type="pmid">30395578</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
