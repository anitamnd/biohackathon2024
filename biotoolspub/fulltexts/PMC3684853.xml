<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Mol Biol Evol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Mol. Biol. Evol</journal-id>
    <journal-id journal-id-type="publisher-id">molbev</journal-id>
    <journal-id journal-id-type="hwp">molbiolevol</journal-id>
    <journal-title-group>
      <journal-title>Molecular Biology and Evolution</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0737-4038</issn>
    <issn pub-type="epub">1537-1719</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3684853</article-id>
    <article-id pub-id-type="doi">10.1093/molbev/mst063</article-id>
    <article-id pub-id-type="publisher-id">mst063</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methods</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Testing for Associations between Loci and Environmental Gradients Using Latent Factor Mixed Models</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Frichot</surname>
          <given-names>Eric</given-names>
        </name>
        <xref ref-type="aff" rid="mst063-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schoville</surname>
          <given-names>Sean D.</given-names>
        </name>
        <xref ref-type="aff" rid="mst063-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bouchard</surname>
          <given-names>Guillaume</given-names>
        </name>
        <xref ref-type="aff" rid="mst063-AFF2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>François</surname>
          <given-names>Olivier</given-names>
        </name>
        <xref ref-type="corresp" rid="mst063-COR1">*</xref>
        <xref ref-type="aff" rid="mst063-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="mst063-AFF1"><sup>1</sup>TIMC-IMAG UMR 5525, Université Joseph Fourier Grenoble, Centre National de la Recherche Scientifique, Grenoble, France</aff>
    <aff id="mst063-AFF2"><sup>2</sup>Xerox Research Center Europe, Meylan, France</aff>
    <author-notes>
      <corresp id="mst063-COR1"><bold>*Corresponding author:</bold> E-mail: <email>olivier.francois@imag.fr</email>.</corresp>
      <fn>
        <p><bold>Associate editor:</bold> Asger Hobolth</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>7</month>
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>3</month>
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>3</month>
      <year>2013</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>30</volume>
    <issue>7</issue>
    <fpage>1687</fpage>
    <lpage>1699</lpage>
    <permissions>
      <copyright-statement>© The Author 2013. Published by Oxford University Press on behalf of the Society for Molecular Biology and Evolution.</copyright-statement>
      <copyright-year>2013</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">http://creativecommons.org/licenses/by-nc/3.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Adaptation to local environments often occurs through natural selection acting on a large number of loci, each having a weak phenotypic effect. One way to detect these loci is to identify genetic polymorphisms that exhibit high correlation with environmental variables used as proxies for ecological pressures. Here, we propose new algorithms based on population genetics, ecological modeling, and statistical learning techniques to screen genomes for signatures of local adaptation. Implemented in the computer program “latent factor mixed model” (LFMM), these algorithms employ an approach in which population structure is introduced using unobserved variables. These fast and computationally efficient algorithms detect correlations between environmental and genetic variation while simultaneously inferring background levels of population structure. Comparing these new algorithms with related methods provides evidence that LFMM can efficiently estimate random effects due to population history and isolation-by-distance patterns when computing gene-environment correlations, and decrease the number of false-positive associations in genome scans. We then apply these models to plant and human genetic data, identifying several genes with functions related to development that exhibit strong correlations with climatic gradients.</p>
    </abstract>
    <kwd-group>
      <kwd>local adaptation</kwd>
      <kwd>environmental correlations</kwd>
      <kwd>genome scans</kwd>
      <kwd>latent factor models</kwd>
      <kwd>population structure</kwd>
    </kwd-group>
    <counts>
      <page-count count="13"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>Introduction</title>
    <p>Local adaptation through natural selection plays a central role in shaping the variation of natural populations (<xref ref-type="bibr" rid="mst063-B11">Darwin 1859</xref>; <xref ref-type="bibr" rid="mst063-B59">Williams 1966</xref>) and is of fundamental importance in evolution, conservation, and global-change biology (<xref ref-type="bibr" rid="mst063-B30">Joost et al. 2007</xref>; <xref ref-type="bibr" rid="mst063-B36">Manel et al. 2010</xref>; <xref ref-type="bibr" rid="mst063-B3">Barrett and Hoekstra 2011</xref>; <xref ref-type="bibr" rid="mst063-B28">Jay et al. 2012</xref>; <xref ref-type="bibr" rid="mst063-B52">Schoville et al. 2012</xref>). The intensity of natural selection commonly varies in space and can result in gene-environment interactions that have measurable effects on fitness (<xref ref-type="bibr" rid="mst063-B55">Storz and Wheat 2010</xref>). This can lead to local adaptation if populations maintain locally advantageous traits despite gene flow with neighboring populations.</p>
    <p>In principle, identifying chromosomal regions involved in adaptive divergence can be achieved by scanning genome-wide patterns of DNA polymorphism (<xref ref-type="bibr" rid="mst063-B39">Nielsen 2005</xref>; <xref ref-type="bibr" rid="mst063-B54">Storz 2005</xref>). Usually, the aim of screening procedures is to detect locus-specific signatures of positive selection. In populations inhabiting spatially distinct environments, loci that underlie adaptive divergence can be detected by comparing relative levels of differentiation among large samples of unlinked markers (<xref ref-type="bibr" rid="mst063-B5">Beaumont and Nichols 1996</xref>; <xref ref-type="bibr" rid="mst063-B4">Beaumont and Balding 2004</xref>) and by using empirical tests to compare levels of differentiation with the genomic background (<xref ref-type="bibr" rid="mst063-B31">Kelley et al. 2006</xref>; <xref ref-type="bibr" rid="mst063-B1">Akey 2009</xref>; <xref ref-type="bibr" rid="mst063-B40">Novembre and Di Rienzo 2009</xref>).</p>
    <p>An alternative way to investigate signatures of local adaptation, especially when beneficial alleles have weak phenotypic effects, is by identifying polymorphisms that exhibit high correlation with environmental variables (<xref ref-type="bibr" rid="mst063-B30">Joost et al. 2007</xref>; <xref ref-type="bibr" rid="mst063-B22">Hancock et al. 2008</xref>; <xref ref-type="bibr" rid="mst063-B10">Coop et al. 2010</xref>; <xref ref-type="bibr" rid="mst063-B43">Poncet et al. 2010</xref>; <xref ref-type="bibr" rid="mst063-B46">Pritchard et al. 2010</xref>). In natural populations, quantitative traits that exhibit continuous geographic variation are often associated with specific ecological variables reflecting selective pressures acting on individual phenotypes (<xref ref-type="bibr" rid="mst063-B16">Endler 1977</xref>). This type of variation is then reflected in geographic clines or in sympatric populations that exploit different ecological niches (<xref ref-type="bibr" rid="mst063-B20">Haldane 1948</xref>; <xref ref-type="bibr" rid="mst063-B7">Berry and Kreitman 1993</xref>; <xref ref-type="bibr" rid="mst063-B48">Prugnolle et al. 2005</xref>; <xref ref-type="bibr" rid="mst063-B60">Young et al. 2005</xref>). Evidence for local adaptation to continuous environments can be detected if there is highly significant association with the environmental variables at some loci compared with the background genomic variation.</p>
    <p>A major difficulty is that the geographical basis of both environmental and genetic variation can confound interpretation of the tests (<xref ref-type="bibr" rid="mst063-B14">Eckert et al. 2010</xref>), as local adaptation can be hindered by gene flow (<xref ref-type="bibr" rid="mst063-B34">Lenormand 2002</xref>), and can be difficult to distinguish from the effects of genetic drift and demographic history (<xref ref-type="bibr" rid="mst063-B40">Novembre and Di Rienzo 2009</xref>). The main problem is that without corrections for the effect of population structure or isolation-by-distance (IBD), the underlying null distribution may be insufficient to account for the demographic history of the study organism. As a result, tests for associations between loci and environmental variables using classical regression models will be prone to high rates of false positives (FP) (<xref ref-type="bibr" rid="mst063-B37">Meirmans 2012</xref>). Recent studies have used the background patterns of allele frequencies to build a null model that accounts for the effects of drift and demographic history (<xref ref-type="bibr" rid="mst063-B22">Hancock et al. 2008</xref>; <xref ref-type="bibr" rid="mst063-B10">Coop et al. 2010</xref>; <xref ref-type="bibr" rid="mst063-B19">Fumagalli et al. 2011</xref>; <xref ref-type="bibr" rid="mst063-B21">Hancock et al. 2011</xref>). To correct for population stratification, <xref ref-type="bibr" rid="mst063-B22">Hancock et al. (2008)</xref> used an empirical approach that estimates the covariance of allele frequencies among populations. These authors assessed the evidence for local adaptation of each allele by testing whether environmental variables explained more variance than a null model with this particular covariance structure.</p>
    <p>A drawback of empirical tests is the need to identify selectively neutral loci from the genomic background before testing for associations with environmental factors. The need to identify such a list a priori implies that tests based on empirical estimates of relatedness can lack power to reject neutrality, which is an important limitation for data sets where all loci are potentially under selection. For example, single nucleotide polymorphism (SNP) data sets derived from expressed sequences are often used to study local adaptation in nonmodel organisms (<xref ref-type="bibr" rid="mst063-B14">Eckert et al. 2010</xref>). Choosing a subset of markers not only reduces the size of such a data set but could also arbitrarily bias downstream statistical tests if only certain subsets of data (e.g., synonymous sites) are chosen as the neutral markers. After all, putatively neutral sites can be linked to loci under selection over large physical distances (<xref ref-type="bibr" rid="mst063-B56">Thibert-Plante and Hendry 2010</xref>). In this study, we address this problem by introducing statistical models called latent factor mixed models (LFMM).</p>
    <p>Using these models, we test correlations between environmental and genetic variation while estimating the effects of hidden factors that represent background residual levels of population structure. To perform parameter estimation, we extend probabilistic principal component analysis (PCA) and recent statistical learning approaches (<xref ref-type="bibr" rid="mst063-B57">Tipping and Bishop 1999</xref>; <xref ref-type="bibr" rid="mst063-B51">Salakhutdinov and Mnih 2008</xref>; <xref ref-type="bibr" rid="mst063-B17">Engelhardt and Stephens 2010</xref>; <xref ref-type="bibr" rid="mst063-B18">Frichot et al. 2012</xref>). Based on low rank approximation of the residual covariance matrix, we implement algorithms to deal with hundreds of thousands of polymorphisms with rapid computing times. We show that our algorithms control for random effects due to population history and spatial autocorrelation when estimating gene-environment association, and we provide examples of how our approach can be used to detect local adaptation in plants and humans.</p>
  </sec>
  <sec>
    <title>New Approaches</title>
    <p>Consider the data matrix, <inline-formula><inline-graphic xlink:href="mst063i1.jpg"/></inline-formula>, where each entry records the allele frequency for individual <italic>i</italic> at the genomic locus <inline-formula><inline-graphic xlink:href="mst063i2.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="mst063i3.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="mst063i4.jpg"/></inline-formula>, and <italic>n</italic> and <italic>L</italic> represent the total sample size and number of loci, respectively. For simplicity, we assume our loci are bi-allelic, for example, SNPs. In this case, for each marker, there is an ancestral and a derived allele, and <inline-formula><inline-graphic xlink:href="mst063i5.jpg"/></inline-formula> is the number of derived alleles for locus <inline-formula><inline-graphic xlink:href="mst063i6.jpg"/></inline-formula> and individual <italic>i</italic>. For diploid data, <inline-formula><inline-graphic xlink:href="mst063i7.jpg"/></inline-formula> is thus equal to 0, 1, or 2, and corresponds to the genotype at locus <inline-formula><inline-graphic xlink:href="mst063i8.jpg"/></inline-formula>. In addition to the genotypic data, we have a vector of <italic>d</italic> geographic and environmental variables, <inline-formula><inline-graphic xlink:href="mst063i9.jpg"/></inline-formula>, for each individual. The vector of covariates could include latitude and longitude, habitat and other ecological information, climatic variables, and so forth, which serve as proxies for unknown environmental pressures (<xref ref-type="bibr" rid="mst063-B22">Hancock et al. 2008</xref>; <xref ref-type="bibr" rid="mst063-B14">Eckert et al. 2010</xref>).</p>
    <sec>
      <title>Model</title>
      <p>To evaluate associations between allele frequencies and environmental variables while correcting for background levels of population structure, we regard the matrix <italic>G</italic> as being a response variable in a regression mixed model
<disp-formula id="mst063-M1"><label>(1)</label><graphic xlink:href="mst063m1"/></disp-formula>
where <inline-formula><inline-graphic xlink:href="mst063i10.jpg"/></inline-formula> is a locus specific effect, <inline-formula><inline-graphic xlink:href="mst063i11.jpg"/></inline-formula> is a <italic>d</italic>-dimensional vector of regression coefficients, <italic>U<sub>i</sub></italic> and <inline-formula><inline-graphic xlink:href="mst063i12.jpg"/></inline-formula> are scalar vectors with <italic>K</italic> dimensions that model latent factors and their scores (<inline-formula><inline-graphic xlink:href="mst063i13.jpg"/></inline-formula>). The residuals <inline-formula><inline-graphic xlink:href="mst063i14.jpg"/></inline-formula> are statistically independent Gaussian variables of mean zero and variance <inline-formula><inline-graphic xlink:href="mst063i15.jpg"/></inline-formula>.</p>
      <p>We refer to the earlier-mentioned statistical model as a LFMM (see Materials and Methods). Similar models, termed factor regression models, have been considered earlier in biostatistics in the inference of molecular pathways from gene expression data (<xref ref-type="bibr" rid="mst063-B58">West 2003</xref>; <xref ref-type="bibr" rid="mst063-B8">Carvalho et al. 2008</xref>).</p>
      <p>In LFMMs, environmental variables are introduced as fixed effects while population structure is modeled using latent factors. In the model, the matrix term <inline-formula><inline-graphic xlink:href="mst063i16.jpg"/></inline-formula> models the part of genetic variation that cannot be explained by the environmental pressures. Note that the use of factorization methods is closely related to estimating population structure by singular value decomposition, a well-established technique for identifying scores and loadings in PCA (<xref ref-type="bibr" rid="mst063-B29">Jolliffe 1986</xref>). Recently, matrix factorization methods have been generalized to include probabilistic PCA (<xref ref-type="bibr" rid="mst063-B57">Tipping and Bishop 1999</xref>) and probabilistic matrix factorization algorithms (<xref ref-type="bibr" rid="mst063-B51">Salakhutdinov and Mnih 2008</xref>), which have proven useful in analyzing population genetic data (<xref ref-type="bibr" rid="mst063-B17">Engelhardt and Stephens 2010</xref>). To clarify the connection between LFMM and PCA, assume that no environmental variable is available. In this case, we set <inline-formula><inline-graphic xlink:href="mst063i17.jpg"/></inline-formula> for all locus <inline-formula><inline-graphic xlink:href="mst063i18.jpg"/></inline-formula>. In matrix factorization algorithms, a data matrix <italic>G</italic> with <italic>n</italic> rows and <italic>L</italic> columns can be decomposed into a product of two matrices <italic>U</italic> and <italic>V</italic>, where <italic>U</italic> has <italic>n</italic> rows and <italic>K</italic> columns, and <italic>V</italic> is a <italic>K</italic> × <italic>L</italic> matrix. Following <xref ref-type="bibr" rid="mst063-B41">Patterson et al. (2006)</xref>, we assume that the genotypic data are centered. We consider the matrix <inline-formula><inline-graphic xlink:href="mst063i19.jpg"/></inline-formula>, where we have subtracted the mean value of each column, <inline-formula><inline-graphic xlink:href="mst063i20.jpg"/></inline-formula>. For each individual <italic>i</italic> and locus <inline-formula><inline-graphic xlink:href="mst063i21.jpg"/></inline-formula>, the decomposition is as follows:
<disp-formula id="mst063-M2"><label>(2)</label><graphic xlink:href="mst063m2"/></disp-formula>
</p>
      <p>To estimate the factor vectors <italic>U<sub>i</sub></italic> and <inline-formula><inline-graphic xlink:href="mst063i22.jpg"/></inline-formula>, the squared error is minimized on the set of observed data
<disp-formula id="mst063-M3"><label>(3)</label><graphic xlink:href="mst063m3"/></disp-formula>
</p>
      <p>With <inline-formula><inline-graphic xlink:href="mst063i23.jpg"/></inline-formula>, this approach is similar to computing PCA loadings and scores (<xref ref-type="bibr" rid="mst063-B29">Jolliffe 1986</xref>). The number of components <italic>K</italic> can, however, be chosen much lower than the number of loci or individuals. In simulations, we based our choice of <italic>K</italic> on Tracy–Widom theory (<xref ref-type="bibr" rid="mst063-B41">Patterson et al. 2006</xref>). In real applications, this choice of <italic>K</italic> may be replaced by estimates of population genetic structure obtained with clustering algorithms like <monospace>STRUCTURE</monospace> (<xref ref-type="bibr" rid="mst063-B47">Pritchard et al. 2000</xref>) or <monospace>TESS</monospace> (<xref ref-type="bibr" rid="mst063-B9">Chen et al. 2007</xref>). When values of <italic>K</italic> are low our algorithm is essentially a low-rank approximation of the covariance structure (<xref ref-type="bibr" rid="mst063-B13">Eckart and Young 1936</xref>), which leads to computationally fast estimation algorithms. To estimate the LFMM parameters, we implemented a Gibbs sampler algorithm (Materials and Methods and <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/lookup/suppl/doi:10.1093/molbev/mst063/-/DC1">supplementary file S1</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/lookup/suppl/doi:10.1093/molbev/mst063/-/DC1">Supplementary Material</ext-link> online). We computed <inline-formula><inline-graphic xlink:href="mst063i24.jpg"/></inline-formula>-scores for all environmental effects, and we tested the significance of these effects using the standard Gaussian distribution and Bonferroni correction for multiple testing.</p>
      <p>Incorporating population genetic structure using estimates of principal components or ancestry coefficients is common in genome-wide association studies (<xref ref-type="bibr" rid="mst063-B44">Price et al. 2006</xref>; <xref ref-type="bibr" rid="mst063-B61">Yu et al. 2006</xref>; <xref ref-type="bibr" rid="mst063-B62">Zhou and Stephens 2012</xref>), and in tests based on empirical approaches (<xref ref-type="bibr" rid="mst063-B10">Coop et al. 2010</xref>; <xref ref-type="bibr" rid="mst063-B43">Poncet et al. 2010</xref>). In this paragraph, we explain the distinction between LFMM and tests based on empirical covariance matrices. Suppose that we start by computing PCA scores from the matrix <italic>Y</italic> for all individuals, and denote by <inline-formula><inline-graphic xlink:href="mst063i25.jpg"/></inline-formula> the PCA scores for individual <italic>i</italic>. The product matrix <inline-formula><inline-graphic xlink:href="mst063i26.jpg"/></inline-formula> is thus equal to the empirical covariance matrix
<disp-formula id="mst063-M4"><label>(4)</label><graphic xlink:href="mst063m4"/></disp-formula>
</p>
      <p>Now using the scores as covariates in a Bayesian regression model, we obtain
<disp-formula id="mst063-M5"><label>(5)</label><graphic xlink:href="mst063m5"/></disp-formula>
</p>
      <p>By a change of variables, this is equivalent to fitting the model
<disp-formula id="mst063-M6"><label>(6)</label><graphic xlink:href="mst063m6"/></disp-formula>
where the distribution of <inline-formula><inline-graphic xlink:href="mst063i27.jpg"/></inline-formula> is a multivariate Gaussian distribution of the covariance matrix equal to <inline-formula><inline-graphic xlink:href="mst063i28.jpg"/></inline-formula>. Here, Id is the <italic>n</italic>-dimensional identity matrix, and <inline-formula><inline-graphic xlink:href="mst063i29.jpg"/></inline-formula> is the variance of factor coordinates. Setting <inline-formula><inline-graphic xlink:href="mst063i30.jpg"/></inline-formula> and considering small values of the scaling parameter <inline-formula><inline-graphic xlink:href="mst063i31.jpg"/></inline-formula>, the model defined in <xref ref-type="disp-formula" rid="mst063-M6">equation (6)</xref> is nearly equivalent to the model implemented in empirical approaches. In a Bayesian Gaussian regression framework, incorporating PCA scores as covariates in an association model is equivalent to modeling residuals as Gaussian vectors with covariance depending on the empirical covariance matrix of the genotypic data. Thus, a major difference between methods is that the factor matrix <italic>U</italic> and the regression coefficients <italic>β</italic> are estimated by a two-stage procedure in empirical approaches, whereas it requires a single step in LFMMs.</p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <p>We designed experiments based on simulated data to answer the following questions: 1) Are tests based on LFMMs conservative or liberal? 2) How does the LFMM algorithm perform compared with existing methods such as logistic or standard regression models (<xref ref-type="bibr" rid="mst063-B30">Joost et al. 2007</xref>), principal component regression model (PCRM), partial Mantel tests (PMTs) <xref ref-type="bibr" rid="mst063-B19">(Fumagalli et al. 2011)</xref>, standard linear mixed models (<xref ref-type="bibr" rid="mst063-B62">Zhou and Stephens 2012</xref>), and Bayesian mixed models (<xref ref-type="bibr" rid="mst063-B10">Coop et al. 2010</xref>)?</p>
    <sec>
      <title>Distribution of <italic>P</italic> Values under the Null Hypothesis</title>
      <p>To evaluate the calibration of <italic>P</italic> values, we used <xref ref-type="disp-formula" rid="mst063-M1">equation (1)</xref> with <inline-formula><inline-graphic xlink:href="mst063i32.jpg"/></inline-formula> to simulate data under a null hypothesis of no association with any environmental variable (Materials and Methods). <xref ref-type="fig" rid="mst063-F1">Figure 1</xref> reports the empirical cumulative distribution function (ECDF) of <italic>P</italic> values for <italic>K</italic> = 5 and <italic>K</italic> = 20. Plots for other values of <italic>K</italic> are shown in <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/lookup/suppl/doi:10.1093/molbev/mst063/-/DC1">supplementary figure S1</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/lookup/suppl/doi:10.1093/molbev/mst063/-/DC1">Supplementary Material</ext-link> online. <italic>P</italic> values are well calibrated when their ECDF is close to the uniform distribution, represented by the bisector line. Below the line, the test is conservative. For values of <italic>K</italic> less than 5, the ECDF was close to a uniform distribution, and <italic>P</italic> values were correctly calibrated. For <italic>K</italic> = 20, the tests were slightly conservative. Thus, for moderate and for large values of the number of latent factors, the tests produced small numbers of FP associations.
<fig id="mst063-F1" position="float"><label>F<sc>ig</sc>. 1.</label><caption><p>Simulations from the null model. ECDF of <italic>P</italic> values for LFMM tests for simulations from a latent factor model using (<italic>A</italic>) <italic>K</italic> = 5 and (<italic>B</italic>) <italic>K</italic> = 20 latent factors.</p></caption><graphic xlink:href="mst063f1p"/></fig></p>
      <p>Next, we used <xref ref-type="disp-formula" rid="mst063-M1">equation (1)</xref> to simulate data exhibiting various levels of population structure and association with a randomly generated environmental variable, and we compared the distributions of statistical errors for the following three estimation approaches: 1) LFMM, 2) a standard linear regression model, and 3) a PC regression model (Materials and Methods).</p>
      <p><xref ref-type="fig" rid="mst063-F2">Figure 2</xref> reports the quantiles of absolute errors for LFMM, the standard linear regression, and PC regression models. For LFMM, absolute errors ranged between 0 and 0.6 for <inline-formula><inline-graphic xlink:href="mst063i33.jpg"/></inline-formula>, and between 0 and 1.0 for <inline-formula><inline-graphic xlink:href="mst063i34.jpg"/></inline-formula>. Mean squared errors indicated that the bias and variance of estimates were small (<xref ref-type="table" rid="mst063-T1">table 1</xref>). Compared with LFMMs, the relative errors of the linear and PC regression estimates increased with the rank of the hidden factor matrix. The absolute errors of these algorithms ranged between 0 and 1.4 for <italic>K</italic> = 2, between 0 and 3.2 for <inline-formula><inline-graphic xlink:href="mst063i35.jpg"/></inline-formula>, and between 0 and 9.2 for <italic>K</italic> = 100. When linear or PC regression models were fitted to the data, the quantiles of errors shifted to values ≈1.74-fold higher for <italic>K</italic> = 2, ≈3.8- to 4.1-fold higher for <inline-formula><inline-graphic xlink:href="mst063i36.jpg"/></inline-formula>, and ≈5.5- to 7.7-fold higher for <italic>K</italic> = 100. Mean squared errors provided additional evidence of relatively poor performances of the linear regression and PC regression estimates when the levels of underlying structure increased (<xref ref-type="table" rid="mst063-T1">table 1</xref>).
<fig id="mst063-F2" position="float"><label>F<sc>ig</sc>. 2.</label><caption><p>Generative model simulations. Quantiles of absolute errors for the standard linear regression, PC regression, and LFM models using simulations from latent factor models using (<italic>A</italic>) <italic>K</italic> = 2, (<italic>B</italic>) <italic>K</italic> = 20, and (<italic>C</italic>) <italic>K</italic> = 100 latent factors.</p></caption><graphic xlink:href="mst063f2p"/></fig>
<table-wrap id="mst063-T1" position="float"><label>Table 1.</label><caption><p>Mean Squared Errors for Estimates of Environmental Effects.</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"><italic>K</italic></th><th rowspan="1" colspan="1">LM</th><th rowspan="1" colspan="1">PCRM</th><th rowspan="1" colspan="1">LFMM</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">0.20</td><td rowspan="1" colspan="1">0.21</td><td rowspan="1" colspan="1">0.15</td></tr><tr><td rowspan="1" colspan="1">20</td><td rowspan="1" colspan="1">1.27</td><td rowspan="1" colspan="1">1.42</td><td rowspan="1" colspan="1">0.08</td></tr><tr><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">6.13</td><td rowspan="1" colspan="1">12.41</td><td rowspan="1" colspan="1">0.20</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec>
      <title>Spatial Coalescent Simulations</title>
      <p>In another series of experiments, we compared the LFMM estimation algorithm against two methods that do not correct for population stratification, and against methods that use the empirical covariance matrix to correct for population stratification. The first set of methods include a linear model (LM) and generalized linear model (GLM) (<xref ref-type="bibr" rid="mst063-B30">Joost et al. 2007</xref>), and the second set of methods included three empirical methods: a PCRM, PMTs (<xref ref-type="bibr" rid="mst063-B53">Smouse et al. 1986</xref>; <xref ref-type="bibr" rid="mst063-B33">Legendre and Legendre 2012</xref>), and the mixed models implemented in <monospace>BAYENV</monospace> and <monospace>GEMMA</monospace> (<xref ref-type="bibr" rid="mst063-B10">Coop et al. 2010</xref>; <xref ref-type="bibr" rid="mst063-B62">Zhou and Stephens 2012</xref>). In PMTs, the relationship between population genetic distances at each SNP and a matrix of environmental variable distance was evaluated using a correction for correlations in genome-wide allele frequencies. With <monospace>GEMMA</monospace>, we implemented a standard linear mixed model in which a single environmental variable is explained by SNP genotype, and where relatedness is introduced by a random effect (see Materials and Methods for a description of all methods).</p>
      <p>To examine the outcome of tests when genetic variation is neutral at all loci, we computed the distributions of <italic>P</italic> values under LM, GLM, PMT, PCRM, <monospace>GEMMA</monospace>, and LFMM with different values for the number of latent factors (<italic>K</italic> ranging from 1 to 20). The distributions of <italic>P</italic> values for tests based on LM and GLM showed a strong departure from the uniform distribution (<xref ref-type="fig" rid="mst063-F3">fig. 3</xref><italic>A</italic> and <italic>B</italic>). In those cases, the tests were too liberal and produced a large number of FP results. For GLM, using population allele frequencies instead of individual genotypes reduced the number of FP associations but the tests based on these models remained liberal. The ECDF for PMTs showed an excess of low and high <italic>P</italic> values, but the curve was closer to a uniform distribution than with LM tests (<xref ref-type="fig" rid="mst063-F3">fig. 3</xref><italic>C</italic>). Using <inline-formula><inline-graphic xlink:href="mst063i41.jpg"/></inline-formula> PCs in PCRM, <italic>P</italic> values for those tests and for <monospace>GEMMA</monospace> were well calibrated (<xref ref-type="fig" rid="mst063-F3">fig. 3</xref><italic>D</italic>–<italic>F</italic>). Choosing <italic>K</italic> based on Tracy–Widom theory (<inline-formula><inline-graphic xlink:href="mst063i42.jpg"/></inline-formula>) and on Bayesian clustering algorithms (<inline-formula><inline-graphic xlink:href="mst063i43.jpg"/></inline-formula>) led to slightly conservative tests for LFMMs (<xref ref-type="fig" rid="mst063-F3">fig. 3</xref><italic>E</italic>). ECDFs for all values of <italic>K</italic> are shown in <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/lookup/suppl/doi:10.1093/molbev/mst063/-/DC1">supplementary figures S2</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/lookup/suppl/doi:10.1093/molbev/mst063/-/DC1">S3</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/lookup/suppl/doi:10.1093/molbev/mst063/-/DC1">Supplementary Material</ext-link> online, respectively.
<fig id="mst063-F3" position="float"><label>F<sc>ig</sc>. 3.</label><caption><p>Spatial neutral coalescent simulations. ECDF of <italic>P</italic> values for (<italic>A</italic>) the linear regression model (LM), (<italic>B</italic>) the GLM, (<italic>C</italic>) PMTs using Nei’s genetic distance and the empirical correlation matrix for correction, (<italic>D</italic>) the PC regression model using <inline-formula><inline-graphic xlink:href="mst063i37.jpg"/></inline-formula> principal components (PCRM), (<italic>E</italic>) the LFM model using <inline-formula><inline-graphic xlink:href="mst063i38.jpg"/></inline-formula> latent factors (LFMM) where the value <inline-formula><inline-graphic xlink:href="mst063i39.jpg"/></inline-formula> corresponds to the estimate of the number of clusters obtained from Bayesian clustering algorithms, and the value <inline-formula><inline-graphic xlink:href="mst063i40.jpg"/></inline-formula> is a Tracy–Widom estimate, and (<italic>F</italic>) the standard linear mixed model implemented in <monospace>GEMMA</monospace>.</p></caption><graphic xlink:href="mst063f3p"/></fig></p>
      <p>Next, we evaluated the ability of LFMMs to detect loci exhibiting correlations with particular environmental gradients and compared tests based on LFMMs with methods based on linear models. An environmental variable, <italic>x</italic>, was defined for each population as the geographic identifier of the population in the linear stepping-stone model. Following <xref ref-type="bibr" rid="mst063-B20">Haldane (1948)</xref>, we chose a sigmoid function to represent the shape of a selected allele frequency cline through geographic space. Under strong selection (<inline-formula><inline-graphic xlink:href="mst063i44.jpg"/></inline-formula>), we expect that tests produce low rates of FP associations while still preserving reasonable power.</p>
      <p>For all simulated data sets, we evaluated the rates of false negative (FN) and of FP tests based on LM, GLM, PMT, PCRM, <monospace>GEMMA</monospace>, and LFMM for two values of the type I error (<xref ref-type="table" rid="mst063-T2">table 2</xref>). In the case of strong selection, we found that standard linear models exhibited high rates of FP. In contrast, tests that include corrections for population structure—based on PMTs, PCRM, and standard linear mixed models—exhibited low rates of FP. But PMT, PCRM, and <monospace>GEMMA</monospace> exhibited large rates of FN, and these tests had low power to reject neutrality. These results provide evidence that the standard methods may fail to identify selected loci from the genomic background even though association with the environment is strong. In this context, tests based on LFMM produced low rates of FP and had reasonable power to reject neutrality (<xref ref-type="table" rid="mst063-T2">table 2</xref>).
<table-wrap id="mst063-T2" position="float"><label>Table 2.</label><caption><p>Rates of FN and FP Association for Tests Based on LM, PCRM, Standard Linear Mixed Models (<monospace>GEMMA</monospace>), PMT Correlations, and LFMM.</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">FN (FP)</th><th rowspan="1" colspan="1">LM</th><th rowspan="1" colspan="1">GLM</th><th rowspan="1" colspan="1">PCRM</th><th rowspan="1" colspan="1"><monospace>GEMMA</monospace></th><th rowspan="1" colspan="1">PMT</th><th rowspan="1" colspan="1">LFMM</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Type I error</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">    <inline-formula><inline-graphic xlink:href="mst063i45.jpg"/></inline-formula></td><td rowspan="1" colspan="1">0% (33%)</td><td rowspan="1" colspan="1">0% (24%)</td><td rowspan="1" colspan="1">100% (3%)</td><td rowspan="1" colspan="1">100% (2%)</td><td rowspan="1" colspan="1">99% (6.8%)</td><td rowspan="1" colspan="1">4% (5%)</td></tr><tr><td rowspan="1" colspan="1">    <inline-formula><inline-graphic xlink:href="mst063i46.jpg"/></inline-formula></td><td rowspan="1" colspan="1">0% (27%)</td><td rowspan="1" colspan="1">0% (19%)</td><td rowspan="1" colspan="1">100% (0%)</td><td rowspan="1" colspan="1">100% (0%)</td><td rowspan="1" colspan="1">100% (3.4%)</td><td rowspan="1" colspan="1">14% (3%)</td></tr></tbody></table></table-wrap></p>
      <p>To perform comparisons with the program <monospace>BAYENV</monospace> (<xref ref-type="bibr" rid="mst063-B10">Coop et al. 2010</xref>), we wanted to evaluate whether the program was able to detect weak selection. Thus, we set the intensity of selection through space to a low level (<inline-formula><inline-graphic xlink:href="mst063i47.jpg"/></inline-formula>, Materials and Methods). As <monospace>BAYENV</monospace> returns Bayes factors instead of <italic>P</italic> values, we considered ranked lists recording the <italic>M</italic> loci corresponding to the strongest associations (<italic>M</italic> between 1 and <inline-formula><inline-graphic xlink:href="mst063i48.jpg"/></inline-formula>). <xref ref-type="fig" rid="mst063-F4">Figure 4</xref> reports the number of true positives (TP) as a function of the number of FP. Considering the rates of TP and FP, the mean area under the receiver-operating characteristic curve (AUC) for tests based on LFMMs with <italic>K</italic> = 5–7 factors were approximately 0.95–0.96, whereas the AUC for <monospace>BAYENV</monospace> was equal to 0.88. In the linear stepping stone model simulations, the tests based on LFMM performed better than <monospace>BAYENV</monospace> for all values of <italic>K</italic> (<xref ref-type="fig" rid="mst063-F4">fig. 4</xref>).
<fig id="mst063-F4" position="float"><label>F<sc>ig</sc>. 4.</label><caption><p>Spatial coalescent simulations with loci under selection. Number of true positive associations for BAYENV and for LFMM for <inline-formula><inline-graphic xlink:href="mst063i49.jpg"/></inline-formula> (<monospace>STRUCTURE</monospace> and Tracy–Widom values) and for <italic>K</italic> = <inline-formula><inline-graphic xlink:href="mst063i50.jpg"/></inline-formula> for spatial coalescent simulations including 1,050 loci with 50 SNPs under selection.</p></caption><graphic xlink:href="mst063f4p"/></fig></p>
    </sec>
    <sec>
      <title>Loblolly Pine</title>
      <p>To illustrate the application of LFMMs, we analyzed genomic data of Loblolly pines (<italic>Pinus taeda</italic>, Pinaceae, <xref ref-type="bibr" rid="mst063-B14">Eckert et al. 2010</xref>). The Loblolly pine is distributed throughout the Southeastern United States, ranging from the arid Great Plains to the humid Eastern Temperate Forest ecoregion. These data consisted of 1,730 SNPs selected in expressed sequence tags (ESTs) for 682 individuals (<xref ref-type="bibr" rid="mst063-B14">Eckert et al. 2010</xref>).</p>
      <p>We applied LFMM to the Loblolly pine data, testing 5 environmental variables representing the 5 first components of a PCA for 60 climatic variables (data from <xref ref-type="bibr" rid="mst063-B14">Eckert et al. 2010</xref>). A total of 392, 113, and 30 SNPs obtained <inline-formula><inline-graphic xlink:href="mst063i51.jpg"/></inline-formula>-scores greater than 3, 4, or 5 for at least one environmental variable, respectively. On the basis this result, we considered that a SNP effect was significant when its <inline-formula><inline-graphic xlink:href="mst063i52.jpg"/></inline-formula>-score was greater than 4 (two-sided test). The cutoff <inline-formula><inline-graphic xlink:href="mst063i53.jpg"/></inline-formula> corresponds to <italic>P</italic> values <inline-formula><inline-graphic xlink:href="mst063i54.jpg"/></inline-formula> obtained after applying a Bonferroni correction for a type I error <inline-formula><inline-graphic xlink:href="mst063i55.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="mst063i56.jpg"/></inline-formula> loci. Among the 50 loci with the highest <inline-formula><inline-graphic xlink:href="mst063i57.jpg"/></inline-formula>-scores, 17 were shared with those detected by <xref ref-type="bibr" rid="mst063-B14">Eckert et al. (2010)</xref> using <monospace>BAYENV</monospace>. Seven of the 10 SNPs with Bayes factors greater than 10<sup>3</sup> were confirmed by the LFMM analysis. For the first and second environmental variables, the two SNPs which obtained the highest Bayes factors using <monospace>BAYENV</monospace> were recovered by the LFMM analysis. <xref ref-type="table" rid="mst063-T3">Table 3</xref> provides a list of SNPs associated with climatic gradients and their functional annotation. The LFMM analysis discovered new significant and interesting associations with climatic gradients not identified in the analysis of <xref ref-type="bibr" rid="mst063-B14">Eckert et al. (2010)</xref>, such as the chloroplast lumen 19 kDA protein involved in photosynthesis (<inline-formula><inline-graphic xlink:href="mst063i58.jpg"/></inline-formula>), a pentatricopeptide repeat protein involved in oxidative stress and salt stress (<inline-formula><inline-graphic xlink:href="mst063i59.jpg"/></inline-formula>), and the heat shock transcription factor hsf5 (<inline-formula><inline-graphic xlink:href="mst063i60.jpg"/></inline-formula>) involved in regulation of transcription and response to temperature stress (<xref ref-type="table" rid="mst063-T3">table 3</xref> and <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/lookup/suppl/doi:10.1093/molbev/mst063/-/DC1">supplementary table S1</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/lookup/suppl/doi:10.1093/molbev/mst063/-/DC1">Supplementary Material</ext-link> online).
<table-wrap id="mst063-T3" position="float"><label>Table 3.</label><caption><p>Loblolly Pines.</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Annotation</th><th rowspan="1" colspan="1">Gene Ontology</th><th rowspan="1" colspan="1">−Log<sub>10</sub>(<italic>P</italic> Value)</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Thylakoid lumenal 19 kDa chloroplast</td><td rowspan="1" colspan="1">Oxygen-evolving complex; Photosystem II</td><td rowspan="1" colspan="1">9.87</td></tr><tr><td rowspan="1" colspan="1">Pentatricopeptide repeat protein</td><td rowspan="1" colspan="1">Oxidative stress; salt stress</td><td rowspan="1" colspan="1">8.44</td></tr><tr><td rowspan="1" colspan="1">Conserved hypothetical protein</td><td rowspan="1" colspan="1">Ubiquitin-specific protease</td><td rowspan="1" colspan="1">8.28</td></tr><tr><td rowspan="1" colspan="1">Chalcone synthase</td><td rowspan="1" colspan="1">Flavonoid biosynthesis; wound response; oxidative stress</td><td rowspan="1" colspan="1">7.80</td></tr><tr><td rowspan="1" colspan="1">Heat shock</td><td rowspan="1" colspan="1">Temperature stress</td><td rowspan="1" colspan="1">7.67</td></tr><tr><td rowspan="1" colspan="1">Dirigent protein pdir18</td><td rowspan="1" colspan="1">Disease response</td><td rowspan="1" colspan="1">6.56</td></tr><tr><td rowspan="1" colspan="1">Heat shock transcription factor hsf5</td><td rowspan="1" colspan="1">Regulation of transcription; response to stress</td><td rowspan="1" colspan="1">6.15</td></tr><tr><td rowspan="1" colspan="1">Zinc finger</td><td rowspan="1" colspan="1">Transcription; DNA binding; zinc ion binding</td><td rowspan="1" colspan="1">5.84</td></tr><tr><td rowspan="1" colspan="1">Probable <italic>n</italic>-acetyltransferase hookless 1</td><td rowspan="1" colspan="1">Auxin signaling; photomorphogenesis; ethylene response</td><td rowspan="1" colspan="1">5.78</td></tr><tr><td rowspan="1" colspan="1">Calcium-binding pollen allergen</td><td rowspan="1" colspan="1">Polcalcin; calcium ion binding</td><td rowspan="1" colspan="1">4.61</td></tr><tr><td rowspan="1" colspan="1">Geranylgeranyl diphosphate synthase</td><td rowspan="1" colspan="1">Cholesterol biosynthesis; isoprenoid biosynthesis</td><td rowspan="1" colspan="1">4.59</td></tr><tr><td rowspan="1" colspan="1">Hypothetical protein OsI_04393</td><td rowspan="1" colspan="1">Trehalose-6-phosphate phosphatase</td><td rowspan="1" colspan="1">4.59</td></tr><tr><td colspan="3" rowspan="1"/></tr><tr><td rowspan="1" colspan="1">Potassium proton antiporter</td><td rowspan="1" colspan="1">Potassium ion transport; solute:hydrogen antiporter</td><td rowspan="1" colspan="1">5.54</td></tr><tr><td rowspan="1" colspan="1">DNA mismatch repair</td><td rowspan="1" colspan="1">DNA repair; regulation of DNA recombination</td><td rowspan="1" colspan="1">5.44</td></tr></tbody></table><table-wrap-foot><fn id="mst063-TF1"><p>N<sc>ote</sc>.—Annotation and gene ontology for some interesting SNPs with <italic>z</italic>-scores with absolute value greater than 4 for the first two components of 60 climatic variables.</p></fn></table-wrap-foot></table-wrap></p>
    </sec>
    <sec>
      <title>Human Data Analysis</title>
      <p>We applied LFMM to a worldwide sample of genomic DNA from 1,043 individuals in 52 populations, referred to as the Human Genome Diversity Project – Centre d’Etude du Polymorphisme Humain (HGDP–CEPH) Human Genome Diversity Cell Line Panel (hagsc.org/hgdp/). We extracted climatic data for each of the 52 population samples using the WorldClim data set at 30 arcsecond (<inline-formula><inline-graphic xlink:href="mst063i61.jpg"/></inline-formula>) resolution (<xref ref-type="bibr" rid="mst063-B24">Hijmans et al. 2005</xref>) (<ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/lookup/suppl/doi:10.1093/molbev/mst063/-/DC1">supplementary table S2</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/lookup/suppl/doi:10.1093/molbev/mst063/-/DC1">Supplementary Material</ext-link> online).</p>
      <p>A total of 2,624 (0.4%) SNPs obtained <inline-formula><inline-graphic xlink:href="mst063i62.jpg"/></inline-formula>-scores greater than 5 (<ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/lookup/suppl/doi:10.1093/molbev/mst063/-/DC1">supplementary fig. S3</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/lookup/suppl/doi:10.1093/molbev/mst063/-/DC1">Supplementary Material</ext-link> online). The cutoff <inline-formula><inline-graphic xlink:href="mst063i63.jpg"/></inline-formula> (<inline-formula><inline-graphic xlink:href="mst063i64.jpg"/></inline-formula>) corresponds to the standard Bonferroni correction for a nominal value of type I error <inline-formula><inline-graphic xlink:href="mst063i65.jpg"/></inline-formula> and <italic>L</italic> of order 10<sup>5</sup>. Among loci with <inline-formula><inline-graphic xlink:href="mst063i66.jpg"/></inline-formula>-scores greater than 5, 28 genome-wide association study (GWAS) SNPs with known disease or trait association were found (<xref ref-type="bibr" rid="mst063-B25">Hindorff et al. 2009</xref>). These include several SNPs discovered by <xref ref-type="bibr" rid="mst063-B21">Hancock et al. (2011)</xref>. For example, the SNPs rs12913832 and rs28777 have <inline-formula><inline-graphic xlink:href="mst063i67.jpg"/></inline-formula>-scores greater than 6 and are associated with genes <italic>OCA2</italic> and <italic>SLC45A2</italic> (<xref ref-type="table" rid="mst063-T4">table 4</xref>). Among the SNPs significantly correlated with climatic gradients, several notable examples include genes associated with celiac disease (ICOSLG), height (<italic>LHX3-QSOX2</italic> and <italic>IGF1</italic>), and vitamin D synthesis or activation (<italic>NADSYN1</italic>-encoding nicotinamide adenine dinucleotide synthetase and <italic>DHCR7</italic> the gene encoding 7-dehydrocholesterol reductase, an enzyme catalyzing the production in skin of cholesterol from 7-dehydrocholesterol) (<xref ref-type="table" rid="mst063-T4">table 4</xref>).
<table-wrap id="mst063-T4" position="float"><label>Table 4.</label><caption><p>Human Data.</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Landscape-Trait Category</th><th rowspan="1" colspan="1">Ref. SNP ID</th><th rowspan="1" colspan="1">Nearby Gene</th><th rowspan="1" colspan="1">Disease or Trait Association</th><th rowspan="1" colspan="1">−Log<sub>10</sub> (<italic>P</italic> Value)</th></tr></thead><tbody align="left"><tr><td rowspan="5" colspan="1">Pigmentation and tanning</td><td align="left" rowspan="1" colspan="1">rs32579</td><td align="left" rowspan="1" colspan="1"><italic>PPARGC1</italic></td><td align="left" rowspan="1" colspan="1">Tanning</td><td rowspan="1" colspan="1">9.42</td></tr><tr><td align="left" rowspan="1" colspan="1">rs12913832</td><td align="left" rowspan="1" colspan="1"><italic>OCA2/HERC2</italic></td><td align="left" rowspan="1" colspan="1">Eye color, eye color traits, hair color, black vs. blond hair color, black vs. red hair color</td><td rowspan="1" colspan="1">9.15</td></tr><tr><td align="left" rowspan="1" colspan="1">rs11234027</td><td align="left" rowspan="1" colspan="1"><italic>DHCR7</italic></td><td align="left" rowspan="1" colspan="1">Vitamin D levels</td><td rowspan="1" colspan="1">7.78</td></tr><tr><td align="left" rowspan="1" colspan="1">rs3129882</td><td align="left" rowspan="1" colspan="1"><italic>HLA-DRA</italic></td><td align="left" rowspan="1" colspan="1">Parkinson’s disease</td><td rowspan="1" colspan="1">6.97</td></tr><tr><td align="left" rowspan="1" colspan="1">rs28777</td><td align="left" rowspan="1" colspan="1"><italic>SLC45A2</italic></td><td align="left" rowspan="1" colspan="1">Black vs. blond hair color, black vs. red hair color</td><td rowspan="1" colspan="1">6.90</td></tr><tr><td rowspan="10" colspan="1">Immune and autoimmune</td><td align="left" rowspan="1" colspan="1">rs1250550</td><td align="left" rowspan="1" colspan="1"><italic>ZMIZ1</italic></td><td align="left" rowspan="1" colspan="1">Crohn’s disease and inflammatory bowel disease (early onset)</td><td rowspan="1" colspan="1">8.77</td></tr><tr><td align="left" rowspan="1" colspan="1">rs2735839</td><td align="left" rowspan="1" colspan="1"><italic>KLK3</italic></td><td align="left" rowspan="1" colspan="1">Prostate cancer</td><td rowspan="1" colspan="1">8.16</td></tr><tr><td align="left" rowspan="1" colspan="1">rs9264942</td><td align="left" rowspan="1" colspan="1"><italic>RPL3P2</italic></td><td align="left" rowspan="1" colspan="1">HIV-1 control</td><td rowspan="1" colspan="1">8.02</td></tr><tr><td align="left" rowspan="1" colspan="1">rs2179367</td><td align="left" rowspan="1" colspan="1">Intergenic between <italic>SUMO4</italic> and <italic>ZC3H12D</italic></td><td align="left" rowspan="1" colspan="1">Dupuytren’s disease</td><td rowspan="1" colspan="1">7.57</td></tr><tr><td align="left" rowspan="1" colspan="1">rs1551398</td><td align="left" rowspan="1" colspan="1">Intergenic between <italic>TRIB1</italic> and <italic>LOC100130231</italic></td><td align="left" rowspan="1" colspan="1">Crohn’s disease</td><td rowspan="1" colspan="1">7.45</td></tr><tr><td align="left" rowspan="1" colspan="1">rs2289700</td><td align="left" rowspan="1" colspan="1"><italic>CTSH</italic></td><td align="left" rowspan="1" colspan="1">Bipolar disorder</td><td rowspan="1" colspan="1">6.98</td></tr><tr><td align="left" rowspan="1" colspan="1">rs4819388</td><td align="left" rowspan="1" colspan="1"><italic>ICOSLG</italic></td><td align="left" rowspan="1" colspan="1">Celiac disease</td><td rowspan="1" colspan="1">6.67</td></tr><tr><td align="left" rowspan="1" colspan="1">rs703842</td><td align="left" rowspan="1" colspan="1"><italic>CYP27B1/METTL1</italic></td><td align="left" rowspan="1" colspan="1">Multiple sclerosis</td><td rowspan="1" colspan="1">6.59</td></tr><tr><td align="left" rowspan="1" colspan="1">rs12593813</td><td align="left" rowspan="1" colspan="1"><italic>MAP2K5</italic></td><td align="left" rowspan="1" colspan="1">Restless legs syndrome</td><td rowspan="1" colspan="1">6.40</td></tr><tr><td align="left" rowspan="1" colspan="1">rs4664308</td><td align="left" rowspan="1" colspan="1"><italic>PLA2R1</italic></td><td align="left" rowspan="1" colspan="1">Nephropathy (idiopathic membranous)</td><td rowspan="1" colspan="1">6.28</td></tr><tr><td rowspan="3" colspan="1">Metabolism</td><td align="left" rowspan="1" colspan="1">rs10908907</td><td align="left" rowspan="1" colspan="1">Intergenic <italic>MUC7</italic></td><td align="left" rowspan="1" colspan="1">Alcoholism (heaviness of drinking)</td><td rowspan="1" colspan="1">8.91</td></tr><tr><td align="left" rowspan="1" colspan="1">rs1566039</td><td align="left" rowspan="1" colspan="1">Intergenic between <italic>PAPD7</italic> and <italic>MIR4278</italic></td><td align="left" rowspan="1" colspan="1">Sphingolipid levels</td><td rowspan="1" colspan="1">6.89</td></tr><tr><td align="left" rowspan="1" colspan="1">rs7665090</td><td align="left" rowspan="1" colspan="1"><italic>MANBA</italic></td><td align="left" rowspan="1" colspan="1">Primary biliary cirrhosis</td><td rowspan="1" colspan="1">6.48</td></tr><tr><td rowspan="4" colspan="1">Cardiovascular</td><td align="left" rowspan="1" colspan="1">rs869244</td><td align="left" rowspan="1" colspan="1"><italic>ADRA2A</italic></td><td align="left" rowspan="1" colspan="1">Platelet aggregation</td><td rowspan="1" colspan="1">7.20</td></tr><tr><td align="left" rowspan="1" colspan="1">rs12034383</td><td align="left" rowspan="1" colspan="1"><italic>CR1</italic></td><td align="left" rowspan="1" colspan="1">Erythrocyte sedimentation rate</td><td rowspan="1" colspan="1">7.15</td></tr><tr><td align="left" rowspan="1" colspan="1">rs3129882</td><td align="left" rowspan="1" colspan="1"><italic>HLA-DRA</italic></td><td align="left" rowspan="1" colspan="1">Systemic sclerosis</td><td rowspan="1" colspan="1">6.97</td></tr><tr><td align="left" rowspan="1" colspan="1">rs11897119</td><td align="left" rowspan="1" colspan="1"><italic>MEIS1</italic></td><td align="left" rowspan="1" colspan="1">PR interval</td><td rowspan="1" colspan="1">6.71</td></tr><tr><td rowspan="1" colspan="1">Height</td><td align="left" rowspan="1" colspan="1">rs7678436</td><td align="left" rowspan="1" colspan="1"><italic>NCAPG-LCORL</italic></td><td align="left" rowspan="1" colspan="1">Height</td><td rowspan="1" colspan="1">9.43</td></tr><tr><td rowspan="1" colspan="1">Other</td><td align="left" rowspan="1" colspan="1">rs12479254</td><td align="left" rowspan="1" colspan="1"><italic>BOK</italic></td><td align="left" rowspan="1" colspan="1">Brain structure</td><td rowspan="1" colspan="1">9.43</td></tr></tbody></table><table-wrap-foot><fn id="mst063-TF2"><p>N<sc>ote</sc>.—HGDP SNPs with the highest |<italic>z</italic>|-scores among those associated with phenotypic traits in GWAS.</p></fn></table-wrap-foot></table-wrap></p>
      <p>We performed a Gene Ontology enrichment analysis on human genes with <inline-formula><inline-graphic xlink:href="mst063i68.jpg"/></inline-formula>-scores greater than 5 (2,624 SNPs). Using a threshold of 0.001 for the false discovery rate (FDR) <italic>q</italic> values, we found significant enrichment of gene ontology terms associated with six biological processes linked to cell adhesion and locomotion, neural and organismal development (<ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/lookup/suppl/doi:10.1093/molbev/mst063/-/DC1">supplementary tables S3–S4</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/lookup/suppl/doi:10.1093/molbev/mst063/-/DC1">Supplementary Material</ext-link> online). The FDR <italic>q</italic> values for the regulation of developmental processes (76 genes) and the regulation of multicellular organismal processes (88 genes) were equal to <inline-formula><inline-graphic xlink:href="mst063i69.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="mst063i70.jpg"/></inline-formula>. For examples of interesting genes with a high level of association with climatic variables, we focus of the 65 SNPs with <inline-formula><inline-graphic xlink:href="mst063i71.jpg"/></inline-formula>-scores greater than 7. Among the 65 SNPs, <italic>EPHB4</italic> (<inline-formula><inline-graphic xlink:href="mst063i72.jpg"/></inline-formula>) is involved in heart morphogenesis and angiogenesis, <italic>NRG1</italic> (<inline-formula><inline-graphic xlink:href="mst063i73.jpg"/></inline-formula>) is involved with nervous system development and cell proliferation, <italic>RBM19</italic> (<inline-formula><inline-graphic xlink:href="mst063i74.jpg"/></inline-formula>) is involved with positive regulation of embryonic development, <italic>EYA2</italic> (<inline-formula><inline-graphic xlink:href="mst063i75.jpg"/></inline-formula>) is involved with eye development and DNA repair, and <italic>POLA1</italic> (<inline-formula><inline-graphic xlink:href="mst063i76.jpg"/></inline-formula>) is involved with the mitotic cell cycle and cell proliferation (<xref ref-type="bibr" rid="mst063-B50">Saccone et al. 2011</xref>; <xref ref-type="bibr" rid="mst063-B26">Hornbeck et al. 2012</xref>; <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/lookup/suppl/doi:10.1093/molbev/mst063/-/DC1">supplementary table S3</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/lookup/suppl/doi:10.1093/molbev/mst063/-/DC1">Supplementary Material</ext-link> online). <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/lookup/suppl/doi:10.1093/molbev/mst063/-/DC1">Supplementary table S5</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/lookup/suppl/doi:10.1093/molbev/mst063/-/DC1">Supplementary Material</ext-link> online, describes a list of 508 SNPs with <inline-formula><inline-graphic xlink:href="mst063i77.jpg"/></inline-formula>-scores greater than 6.</p>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <sec sec-type="discussion">
      <title>Interpretation of LFMM Results and Other Methods</title>
      <p>On the basis of a matrix factorization approach, LFMMs provide a unified framework for estimating effects of environmental and demographic factors on genetic variation. Without environmental variables, LFMMs are similar to performing a sparse version of a probabilistic PCA of allele frequencies (<xref ref-type="bibr" rid="mst063-B57">Tipping and Bishop 1999</xref>; <xref ref-type="bibr" rid="mst063-B17">Engelhardt and Stephens 2010</xref>). When environmental variables are included, hidden factors capture the part of genetic variation that cannot be explained by the set of measured environmental variables. This fraction of genetic variation could result from the demographic history of the species, unknown environmental pressures or from IBD patterns.</p>
      <p>Although a plethora of statistical tests have been proposed for detecting genes evolving under positive selection and local adaptation (<xref ref-type="bibr" rid="mst063-B54">Storz 2005</xref>; <xref ref-type="bibr" rid="mst063-B40">Novembre and Di Rienzo 2009</xref>), the development of tests based on correlations with habitat or landscape variables is still recent (<xref ref-type="bibr" rid="mst063-B30">Joost et al. 2007</xref>; <xref ref-type="bibr" rid="mst063-B22">Hancock et al. 2008</xref>). Compared with methods based on summary statistics, tests based on environmental association have increased power to detect selection from standing genetic variation and soft sweeps in a species genome (<xref ref-type="bibr" rid="mst063-B46">Pritchard et al. 2010</xref>; <xref ref-type="bibr" rid="mst063-B52">Schoville et al. 2012</xref>). However, simple implementation of these tests, for example, linear or logistic regression models, can be misleading in the presence of IBD patterns (<xref ref-type="bibr" rid="mst063-B37">Meirmans 2012</xref>). Our simulation results provide clear evidence that tests based on LFMMs significantly reduce the rates of FP associations in the presence of IBD.</p>
      <p>Rates of FP and FN were also investigated for three regression methods that include corrections for population genetic structure: PMTs, PCRM, and standard linear mixed models. In the case of phylogenetic comparative analyses that infer environmental correlations for correlated DNA sequences, PMTs were reported to be erroneous (<xref ref-type="bibr" rid="mst063-B23">Harmon and Glor 2010</xref>). In addition, <xref ref-type="bibr" rid="mst063-B33">Legendre and Legendre (2012)</xref> warn against using partial Mantel correlations. The high error rate may stem from autocorrelation of matrix elements due to underlying phylogenetic structure. We found that PMTs produced an excess of high and low <italic>P</italic> values under IBD assumptions. Although PMTs were not correctly calibrated, these tests can provide a useful statistic for ranking loci, and they can detect interesting associations after choosing a tail cutoff (<xref ref-type="bibr" rid="mst063-B19">Fumagalli et al. 2011</xref>). <italic>P</italic> values based on PCRM and standard linear mixed models were correctly calibrated. But we found that the three regression methods had low power to detect true associations under IBD assumptions. Although these approaches might be useful to detect alleles with strong associations to environmental gradients, they can miss several interesting associations. FN rates were high for PMT, PCRM, and GEMMA because the simulated environmental variable was strongly correlated with population structure. We suspect all regression methods—including LFMM—have higher power when environmental gradients are uncorrelated to the main axis of neutral genetic variation.</p>
      <p>Both the mixed model approach of the computer program <monospace>BAYENV</monospace> and the LFMM approach include a covariance structure in a regression model, but there are important differences between the two approaches. A first improvement is that LFMMs estimate latent factors and regression coefficients simultaneously, whereas <monospace>BAYENV</monospace> first estimates a covariance matrix, and then uses it when estimating (random) environmental effects. To apply <monospace>BAYENV</monospace>, the authors suggest utilizing selectively neutral SNPs to estimate the covariance matrix. Inclusion of adaptive markers in the “neutral set” is sometimes unavoidable, and in this case, methods based on the empirical covariance matrix may overlook interesting associations. For Loblolly pines expressed sequence data, the distinction between the two approaches may explain the differences we observed between the list of loci obtained from LFMM and the list obtained from <monospace>BAYENV</monospace> (<xref ref-type="bibr" rid="mst063-B14">Eckert et al. 2010</xref>). For the pine data, it was difficult to select neutral SNPs from the background a priori. Another distinction between LFMM and <monospace>BAYENV</monospace> approaches is our use of low rank approximations of the covariance matrix. LFMMs actually estimate correlations between environmental predictors and allele frequencies while <italic>K</italic> hidden factors explain residual genetic variation, where <italic>K</italic> is much smaller than the sample size. Though program speed is generally difficult to evaluate for Markov chain Monte Carlo methods, we observed that LFMM was computationally faster than <monospace>BAYENV</monospace> when analyzing large data sets.</p>
    </sec>
    <sec>
      <title>Number of Latent Factors</title>
      <p>A potential weakness of tests based on LFMM is that we need to choose <italic>K</italic>. In the LFMM modeling approach, the choice of low values for <italic>K</italic> is important for optimizing the computational performances of the estimation algorithm. This choice is reminiscent of selecting the number of components in PCA or in Bayesian clustering programs, and it has also an impact on test outcomes. For values of <italic>K</italic> taken too large, the tests are conservative, and the power to reject neutrality declines. Estimates of <italic>K</italic> that minimize the trade-off between the bias and variance for our statistical estimates could be obtained by using cross-validation procedures. Cross-validation procedures are computationally intensive, so instead we use Tracy–Widom theory to select <italic>K</italic> (<xref ref-type="bibr" rid="mst063-B41">Patterson et al. 2006</xref>). We evaluated this choice during our simulation analysis and found that <italic>P</italic> values were well calibrated. Although the choice of Tracy–Widom estimates is suboptimal, the performances of LFMMs were superior to those of <monospace>BAYENV</monospace> in simulations of IBD patterns. In the analysis of human data, we restricted <italic>K</italic> to be less than 50 (approximately the number of population samples). We suggest that, when there is a reasonable estimate of the number of genetic clusters for a species, this should be used in LFMM tests directly. For example, estimates of <italic>K</italic> based on independent genetic data sets could be obtained from Bayesian clustering programs like <monospace>STRUCTURE</monospace> (<xref ref-type="bibr" rid="mst063-B47">Pritchard et al. 2000</xref>). Although finer grain population structure could also be evaluated (<xref ref-type="bibr" rid="mst063-B32">Lawson et al. 2012</xref>), our choice was again motivated by a trade-off between accuracy and run-time. A future development of our LFMM approach will be to develop fast numerical optimization procedures based on variational approximations of the likelihood, which will allow us to implement cross-validation algorithms and increase the power of tests.</p>
    </sec>
    <sec>
      <title>Plant and Human Data</title>
      <p>For <italic>P. </italic><italic>taeda</italic>, the LFMM results confirmed that several ESTs previously discovered with <monospace>BAYENV</monospace> had functions linked to climate (<xref ref-type="bibr" rid="mst063-B14">Eckert et al. 2010</xref>). In addition, the LFMM analysis discovered new interesting candidate SNPs. Those variants include functions associated with wound repair and immunity; photosynthetic activity and carotenoid biosynthesis; cellular respiration and carbohydrate metabolism; and heat, salt, and oxidative stress responses (<xref ref-type="table" rid="mst063-T3">table 3</xref>). Applying LFMMs to the HGDP data, we found that a total of 0.4% of all polymorphisms (2,624 SNPs) exhibited significant associations with temperature gradients (<inline-formula><inline-graphic xlink:href="mst063i78.jpg"/></inline-formula>). For example, we identified SNPs associated with the gene OCA2 that may be functionally linked to blue or brown eye color and the gene <italic>SLC45A2</italic> that may be associated with skin pigmentation (<xref ref-type="bibr" rid="mst063-B21">Hancock et al. 2011</xref>). This list also contained SNPs identified from GWAS studies of height and vitamin D synthesis and diseases such as gluten intolerance and Crohn’s disease. Another interesting result is that the list of genic SNPs with <inline-formula><inline-graphic xlink:href="mst063i79.jpg"/></inline-formula>-scores greater than 5 (<inline-formula><inline-graphic xlink:href="mst063i80.jpg"/></inline-formula>) was enriched for gene ontology terms associated with six biological processes linked to cell adhesion and locomotion, neural and organismal development. Among the highest scores, the genes EPHB4, BOK, and NRG1—with functions related to heart and brain development—were associated with climatic gradients. Although cautious interpretations of the results may be required (<xref ref-type="bibr" rid="mst063-B42">Pavlidis et al. 2012</xref>), our data analysis confirmed that many allele frequencies correlate with climatic gradients or with some evolutionary pressures associated with these gradients.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusion</title>
    <p>With ever increasing amounts of genetic data generated by high-throughput sequencing technologies, population genetic methods have shifted from empirical approaches to models that incorporate hidden factors. Estimates of ancestry and other population parameters are commonly obtained from mixture models (<xref ref-type="bibr" rid="mst063-B47">Pritchard et al. 2000</xref>; <xref ref-type="bibr" rid="mst063-B12">Durand et al. 2009</xref>; <xref ref-type="bibr" rid="mst063-B2">Alexander and Lange 2011</xref>), principal component analyses (<xref ref-type="bibr" rid="mst063-B41">Patterson et al. 2006</xref>), hidden Markov models (<xref ref-type="bibr" rid="mst063-B45">Price et al. 2009</xref>), and factor analysis (<xref ref-type="bibr" rid="mst063-B17">Engelhardt and Stephens 2010</xref>). Our study contributes to the factor analysis methods for population and landscape genomic analysis by implementing new tests of gene-environment association. These new tests use comparisons between closely related populations that have adapted to different environments, and they may help to detect modes of selection that differ from the classic selective sweep paradigm.</p>
  </sec>
  <sec sec-type="materials|methods">
    <title>Materials and Methods</title>
    <sec>
      <title>LFMM Implementation Details</title>
      <p>Consider the data matrix, <inline-formula><inline-graphic xlink:href="mst063i81.jpg"/></inline-formula>, where each entry records the allele frequency in individual <italic>i</italic> at the genomic locus <inline-formula><inline-graphic xlink:href="mst063i82.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="mst063i83.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="mst063i84.jpg"/></inline-formula>, and <italic>n</italic> and <italic>L</italic> represent the total sample size and number of loci, respectively. LFMMs were defined by the following equation:
<disp-formula><graphic xlink:href="mst063um1"/></disp-formula>
where <inline-formula><inline-graphic xlink:href="mst063i85.jpg"/></inline-formula> is a locus-specific effect, <inline-formula><inline-graphic xlink:href="mst063i86.jpg"/></inline-formula> is a <italic>d</italic>-dimensional vector of regression coefficients, <italic>U<sub>i</sub></italic> and <inline-formula><inline-graphic xlink:href="mst063i87.jpg"/></inline-formula> are scalar vectors with <italic>K</italic> dimensions (<inline-formula><inline-graphic xlink:href="mst063i88.jpg"/></inline-formula>). The residuals <inline-formula><inline-graphic xlink:href="mst063i89.jpg"/></inline-formula> are statistically independent Gaussian variables of mean zero and variance <inline-formula><inline-graphic xlink:href="mst063i90.jpg"/></inline-formula>.</p>
      <p>We use Bayesian analysis to estimate the regression coefficients and their standard deviations. We assume Gaussian prior distributions on <inline-formula><inline-graphic xlink:href="mst063i91.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="mst063i92.jpg"/></inline-formula> with means equal to zero and variances <inline-formula><inline-graphic xlink:href="mst063i93.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="mst063i94.jpg"/></inline-formula> (<inline-formula><inline-graphic xlink:href="mst063i95.jpg"/></inline-formula>). Prior distributions on <italic>U<sub>i</sub></italic> and <inline-formula><inline-graphic xlink:href="mst063i96.jpg"/></inline-formula> are Gaussian distributions with means equal to zero and constant variance for each component (the components are independent random variables). The variance of <inline-formula><inline-graphic xlink:href="mst063i97.jpg"/></inline-formula> is set to <inline-formula><inline-graphic xlink:href="mst063i98.jpg"/></inline-formula>. The prior distributions on <inline-formula><inline-graphic xlink:href="mst063i99.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="mst063i100.jpg"/></inline-formula> are noninformative distributions. The variance of each factor, <inline-formula><inline-graphic xlink:href="mst063i101.jpg"/></inline-formula>, follows an inverse-Gamma distribution <inline-formula><inline-graphic xlink:href="mst063i102.jpg"/></inline-formula> where <inline-formula><inline-graphic xlink:href="mst063i103.jpg"/></inline-formula>. This parameterization encourages sparsity in factor estimates and provides a more accurate description of underlying population structure (<xref ref-type="bibr" rid="mst063-B17">Engelhardt and Stephens 2010</xref>).</p>
      <p>To simultaneously estimate scores (<italic>U</italic>) and loadings (<italic>V</italic>), environmmental effects (<italic>β</italic>), and biases (<italic>μ</italic>), we implemented a Gibbs sampler algorithm for LFMMs (<ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/lookup/suppl/doi:10.1093/molbev/mst063/-/DC1">supplementary file S1</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/lookup/suppl/doi:10.1093/molbev/mst063/-/DC1">Supplementary Material</ext-link> online). The Gibbs sampler was based on computing products of matrices of low dimension—typical values of <italic>K</italic> were less than 50—and its speed scales with the current size of SNP data sets, around <inline-formula><inline-graphic xlink:href="mst063i104.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="mst063i105.jpg"/></inline-formula>. We implemented a stochastic algorithm to compute standard deviations for the environmental effects (<ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/lookup/suppl/doi:10.1093/molbev/mst063/-/DC1">supplementary file S1</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/lookup/suppl/doi:10.1093/molbev/mst063/-/DC1">Supplementary Material</ext-link> online). The <inline-formula><inline-graphic xlink:href="mst063i106.jpg"/></inline-formula>-scores were computed as the ratios between the centered values of the regression coefficients <inline-formula><inline-graphic xlink:href="mst063i107.jpg"/></inline-formula> and their standard deviations, and they were converted into <italic>P</italic> values according to the standard Gaussian distribution. The cutoff for <inline-formula><inline-graphic xlink:href="mst063i108.jpg"/></inline-formula>-scores was obtained after applying a Bonferroni correction, corresponding to a type I error of 0.01. From a preliminary set of experiments using data simulated from the model defined in <xref ref-type="disp-formula" rid="mst063-M1">equation (1)</xref>, we found that the estimates of fixed effects stabilized quickly, after 1,000 to 10,000 sweeps for <inline-formula><inline-graphic xlink:href="mst063i109.jpg"/></inline-formula> individuals and <inline-formula><inline-graphic xlink:href="mst063i110.jpg"/></inline-formula> loci. A 10-fold increase in the number of sweeps, however, was necessary to recover the true values of the latent factors. Additionally, we developed numerical optimization methods to compute maximum a posteriori (MAP) estimates for the LFMM. One of these methods, the alternate least square method uses deterministic steps that are similar to our stochastic Gibbs sampler (<xref ref-type="bibr" rid="mst063-B6">Koren et al. 2009</xref>). When checking for convergence of the Markov chain Monte Carlo (MCMC) algorithm, we also found that least square estimates of regression coefficients were close to the point estimates computed by the Gibbs sampler method. The computational complexity of a single sweep of the LFMM Gibbs sampler algorithm is of order <inline-formula><inline-graphic xlink:href="mst063i111.jpg"/></inline-formula>. For about 1,000 loci and 1,000 individuals, the LFMM MCMC algorithm was run for approximately 1 minute of a 2.4 GHz Intel Xeon 64 bit processor. For larger data sets with 650 K loci and 1,000 individuals, we used a multithreated version of the algorithm, for which a single run lasted approximately 24 h on a multiprocessor computer system (using 10 threads).</p>
    </sec>
    <sec>
      <title>Alternative Regression Approaches</title>
      <p>The standard linear regression model (LM) was defined as
<disp-formula id="mst063-M7"><label>(7)</label><graphic xlink:href="mst063m7"/></disp-formula>
and the GLMs used the binomial family and the canonical link. The PCRM was defined as
<disp-formula id="mst063-M8"><label>(8)</label><graphic xlink:href="mst063m8"/></disp-formula>
where <inline-formula><inline-graphic xlink:href="mst063i112.jpg"/></inline-formula> are the first <italic>K</italic> PCs computed from the matrix <italic>G</italic>. For each SNP, we applied PMTs to assess the relationship between the matrix of allele frequency distances and the matrix for environmental variable distance (<xref ref-type="bibr" rid="mst063-B53">Smouse et al. 1986</xref>; <xref ref-type="bibr" rid="mst063-B33">Legendre and Legendre 2012</xref>). PMTs are nonparametric permutation-based tests for quantifying association between two distance matrices, while controlling for the effect of a third matrix. The allele frequency distance matrices were computed using Nei’s distance (<xref ref-type="bibr" rid="mst063-B38">Nei 1972</xref>), and the environmental distance matrix used the Euclidean distance. The third matrix was the Pearson’s correlation matrix computed over all loci. <italic>P</italic> values were computed from the R package <monospace>vegan</monospace> using 10,000 permutations (<xref ref-type="bibr" rid="mst063-B49">R Development Core Team 2012</xref>). We used the computer program <monospace>GEMMA</monospace> to implement a standard linear mixed model for genome-wide association studies (<xref ref-type="bibr" rid="mst063-B62">Zhou and Stephens 2012</xref>). The model had the following form
<disp-formula><graphic xlink:href="mst063um2"/></disp-formula>
where <italic>u</italic> is a multivariate random effect having a Gaussian distribution of covariance matrix <inline-formula><inline-graphic xlink:href="mst063i113.jpg"/></inline-formula>, and each <inline-formula><inline-graphic xlink:href="mst063i114.jpg"/></inline-formula> is a residual error vector having a Gaussian distribution of covariance matrix <inline-formula><inline-graphic xlink:href="mst063i115.jpg"/></inline-formula>. The parameter τ is the variance of the residual errors, and λ is the ratio between the variance components. The matrix Λ is an <inline-formula><inline-graphic xlink:href="mst063i116.jpg"/></inline-formula> relatedness matrix, and <inline-formula><inline-graphic xlink:href="mst063i117.jpg"/></inline-formula> is the identity matrix. Finally, we used the generalized linear mixed model implemented in the computer program <monospace>BAYENV</monospace> with the default settings of the software (<xref ref-type="bibr" rid="mst063-B10">Coop et al. 2010</xref>).</p>
    </sec>
    <sec>
      <title>LFMM Generative Model Simulations</title>
      <p>We used <xref ref-type="disp-formula" rid="mst063-M1">equation (1)</xref> with <inline-formula><inline-graphic xlink:href="mst063i118.jpg"/></inline-formula> to generate data under a null hypothesis of no association with any environmental variables. In these experiments, we set the number of individuals to <inline-formula><inline-graphic xlink:href="mst063i119.jpg"/></inline-formula>, and the number of loci to <inline-formula><inline-graphic xlink:href="mst063i120.jpg"/></inline-formula>. We used six values, <inline-formula><inline-graphic xlink:href="mst063i121.jpg"/></inline-formula>, and 20, for the rank of the factor matrix, <italic>V</italic>. For each series of experiments, we generated 10 replicates of this generative model, and we studied the distributions of <italic>P</italic> values for tests using LFMMs. In these tests, we set the rank of the factor matrix equal to the values we used to generate simulations.</p>
      <p>Next we used <xref ref-type="disp-formula" rid="mst063-M1">equation (1)</xref> to generate data showing various levels of population structure and association with an environmental variable. The environmental variable was uniformly generated in the range <inline-formula><inline-graphic xlink:href="mst063i122.jpg"/></inline-formula>. Here, we used three values for the rank of the factor matrix, <italic>K</italic> = 2, 20, and 100, representing low, moderate, and high levels of underlying population genetic structure. For each series of experiments, we generated 20 replicates of the generative model.</p>
      <p>To compute point estimates of environmental effects and their <inline-formula><inline-graphic xlink:href="mst063i123.jpg"/></inline-formula>-scores, Gibbs sampler algorithms were run for 1,000 sweeps after a burn-in period of 100 sweeps. For these particular run length parameters, we checked that similar estimates were obtained for distinct initializations of the algorithm. For each locus, we recorded both the true, <inline-formula><inline-graphic xlink:href="mst063i124.jpg"/></inline-formula>, and estimated environmental effects, <inline-formula><inline-graphic xlink:href="mst063i125.jpg"/></inline-formula>, and evaluated the absolute error
<disp-formula><graphic xlink:href="mst063um3"/></disp-formula>
</p>
    </sec>
    <sec>
      <title>Spatial Coalescent Simulations</title>
      <p>To enable comparisons with other models, we simulated genotypic data from spatial coalescent models with the computer program <monospace>ms</monospace> (<xref ref-type="bibr" rid="mst063-B27">Hudson 2002</xref>). Ten data sets were generated according to a linear stepping-stone model with 40 demes, setting the effective migration rate between pairs of adjacent demes to the value <inline-formula><inline-graphic xlink:href="mst063i126.jpg"/></inline-formula>. Sampling five individuals in each deme, each data set included a total of <italic>n</italic> = 200 haploid individuals genotyped at <inline-formula><inline-graphic xlink:href="mst063i127.jpg"/></inline-formula> unlinked SNP loci. We ran the LFMM during 100 sweeps for burn-in, and we used the next 900 sweeps to compute point estimates, variances, and <inline-formula><inline-graphic xlink:href="mst063i128.jpg"/></inline-formula>-scores. An environmental variable<italic>, x,</italic> was defined for each population as the geographic identifier of the population in the linear stepping-stone model.</p>
      <p>We created an environmental gradient for the artificial variable <italic>x</italic> using a logistic function, <italic>s</italic>(<italic>x</italic>), of <italic>x</italic> as follows
<disp-formula id="mst063-M9"><label>(9)</label><graphic xlink:href="mst063m9"/></disp-formula>
</p>
      <p>For each of the 10 previously generated neutral stepping-stone simulations, we simulated binary alleles at 50 unlinked loci for each deme <italic>x</italic> with frequency <italic>s</italic>(<italic>x</italic>), and with the slope of the gradient <inline-formula><inline-graphic xlink:href="mst063i129.jpg"/></inline-formula>. We then obtained 10 data sets with <inline-formula><inline-graphic xlink:href="mst063i130.jpg"/></inline-formula> unlinked loci including 50 loci correlated with the environmental gradient, <italic>s</italic>(<italic>x</italic>). Using Tracy–Widom tests implemented in SmartPCA, we found that the number of principal components with <italic>P</italic> values smaller than 0.01 was around <inline-formula><inline-graphic xlink:href="mst063i131.jpg"/></inline-formula>. Using the Bayesian clustering programs <monospace>STRUCTURE</monospace> and <monospace>TESS</monospace>, we found that <inline-formula><inline-graphic xlink:href="mst063i132.jpg"/></inline-formula> components could better describe our simulated data. A value <inline-formula><inline-graphic xlink:href="mst063i133.jpg"/></inline-formula> corresponds to a strong intensity of selection through geographic space, whereas <inline-formula><inline-graphic xlink:href="mst063i134.jpg"/></inline-formula> corresponds to a weak intensity of selection. We used the value <inline-formula><inline-graphic xlink:href="mst063i135.jpg"/></inline-formula> when comparing tests based on linear and PC regression models. When comparing LFMMs with <monospace>BAYENV</monospace>, we used the value <inline-formula><inline-graphic xlink:href="mst063i136.jpg"/></inline-formula> to better fit the objectives of both models. As <monospace>BAYENV</monospace> returns Bayes factors instead of <italic>P</italic> values, we considered ranked lists recording the <italic>M</italic> loci corresponding to the strongest associations (<italic>M</italic> between 1 and <inline-formula><inline-graphic xlink:href="mst063i137.jpg"/></inline-formula>). For each <italic>M</italic>, we computed the number of TPs and the number of FPs. Locus ranking was performed on the basis of <inline-formula><inline-graphic xlink:href="mst063i138.jpg"/></inline-formula>-scores in LFMM and on the basis of Bayes factors in <monospace>BAYENV</monospace>. The LFMM tests used values of <italic>K</italic> equal to <inline-formula><inline-graphic xlink:href="mst063i139.jpg"/></inline-formula> and 20, and we used of the <monospace>BAYENV</monospace> algorithm to compute Bayes factors. Experiments were assessed by counting the number of FP and FN associations, and by measuring the AUC averaged over 10 replicates.</p>
    </sec>
    <sec>
      <title>Real Data</title>
      <sec>
        <title>Loblolly Pine</title>
        <p>The Loblolly pine data consisted of 1,730 SNPs selected in ESTs for 682 individuals (<xref ref-type="bibr" rid="mst063-B14">Eckert et al. 2010</xref>). We considered 5 environmental variables representing the 5 first components of a PCA for 60 climatic variables (<xref ref-type="bibr" rid="mst063-B14">Eckert et al. 2010</xref>). The first component (PC1) was mainly described by latitude, longitude, temperature, and winter aridity. PC2 was described by longitude, spring-fall aridity, and precipitation (<xref ref-type="bibr" rid="mst063-B14">Eckert et al. 2010</xref>). For each of the 5 environmental variables, we applied the LFMM algorithm using 100 sweeps for burn-in and 400 additional sweeps to compute <inline-formula><inline-graphic xlink:href="mst063i140.jpg"/></inline-formula>-scores for all loci. On the basis of a prior analysis of the genotypic data with the program <monospace>SmartPCA</monospace> and Tracy–Widom tests, we used <italic>K</italic> = 10 latent factors.</p>
      </sec>
      <sec>
        <title>Human Data</title>
        <p>Genotypes from the HGDP–CEPH data set were generated on Illumina 650 K arrays (<xref ref-type="bibr" rid="mst063-B35">Li et al. 2008</xref>), and the data were filtered to remove low quality SNPs included in the original files. We extracted climatic data for each of the 52 population samples using the WorldClim data set at 30 arcsecond (<inline-formula><inline-graphic xlink:href="mst063i141.jpg"/></inline-formula>) resolution (<xref ref-type="bibr" rid="mst063-B24">Hijmans et al. 2005</xref>). These data included 11 bioclimatic variables interpolated from global weather station data collected during a 50-year period (averaged of the years 1950–2000). The environmental variables were mainly related to temperature data. These variables included annual mean temperature, mean diurnal range, maximum temperature of warmest month, minimum temperature of coldest month, and so forth (<ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/lookup/suppl/doi:10.1093/molbev/mst063/-/DC1">supplementary table S2</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/lookup/suppl/doi:10.1093/molbev/mst063/-/DC1">Supplementary Material</ext-link> online). We summarized them by using the first axis of a PCA (all 11 climatic variables were given similar loadings). For this environmental proxy, we applied the LFMM algorithm and computed <inline-formula><inline-graphic xlink:href="mst063i142.jpg"/></inline-formula>-scores for each locus, using 100 sweeps for burn-in and 900 additional sweeps to compute estimates. We used <italic>K</italic> = 50 which was of the same order as the number of population samples and the value returned by the Tracy–Widom tests. We investigated whether the gene ontology terms of environmentally associated SNPs were enriched in specific categories of biological processes. The list of target genes with <inline-formula><inline-graphic xlink:href="mst063i143.jpg"/></inline-formula>-scores greater than 5 was compared with the background list of 14,042 genes represented in the HGDP–CEPH data set using a hypergeometric distribution. This test was implemented using the <monospace>GORILLA</monospace> software tool (<xref ref-type="bibr" rid="mst063-B15">Eden et al. 2009</xref>), with significance determined by at an FDR corrected <italic>q</italic> value threshold of 0.01.</p>
      </sec>
      <sec>
        <title>Software Availability</title>
        <p>Source codes and computer programs for fitting LFMMs are available from the author websites (<ext-link ext-link-type="uri" xlink:href="http://membres-timc.imag.fr/Eric.Frichot/">http://membres-timc.imag.fr/Eric.Frichot/</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://membres-timc.imag.fr/Olivier.Francois/lfmm.html">http://membres-timc.imag.fr/Olivier.Francois/lfmm.html</ext-link>).</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <p><ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/lookup/suppl/doi:10.1093/molbev/mst063/-/DC1">Supplementary file S1</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/lookup/suppl/doi:10.1093/molbev/mst063/-/DC1">tables S1–S5</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/lookup/suppl/doi:10.1093/molbev/mst063/-/DC1">figures S1–S3</ext-link> are available at <italic>Molecular Biology and Evolution</italic> online (<ext-link ext-link-type="uri" xlink:href="http://www.mbe.oxfordjournals.org/">http://www.mbe.oxfordjournals.org/</ext-link>).</p>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_30_7_1687__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_mst063_supplementary_figures.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_mst063_supplementary_tables.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_mst063_supplementary_file.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="vnd.ms-excel" xlink:href="supp_mst063_supplementary_table_S5.xls"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>This work was supported by <funding-source>la Région Rhône-Alpes</funding-source> grant to E.F. and O.F.; <funding-source>National Science Foundation</funding-source> grant <award-id>OISE-0965038</award-id> to S.D.S.; and <funding-source>Grenoble INP</funding-source> grant to O.F. The authors are grateful to Florian Alberto, Pierre De Villemereuil, and Oscar Gaggiotti for useful comments of the LFMM software and to Daniel Wegmann and Matteo Fumagalli for their careful reading and helpful suggestions on a previous version of the manuscript.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="mst063-B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Akey</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Constructing genomic maps of positive selection in humans: where do we go from here?</article-title>
        <source>Genome Res.</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>711</fpage>
        <lpage>722</lpage>
        <pub-id pub-id-type="pmid">19411596</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alexander</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Lange</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Enhancements to the ADMIXTURE algorithm for individual ancestry estimation</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>246</fpage>
        <pub-id pub-id-type="pmid">21682921</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barrett</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Hoekstra</surname>
            <given-names>HE</given-names>
          </name>
        </person-group>
        <article-title>Molecular spandrels: tests of adaptation at the genetic level</article-title>
        <source>Nat Rev Genet.</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>767</fpage>
        <lpage>780</lpage>
        <pub-id pub-id-type="pmid">22005986</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beaumont</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Balding</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Identifying adaptive genetic divergence among populations from genome scans</article-title>
        <source>Mol Ecol.</source>
        <year>2004</year>
        <volume>13</volume>
        <fpage>969</fpage>
        <lpage>980</lpage>
        <pub-id pub-id-type="pmid">15012769</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beaumont</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Nichols</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Evaluating loci for use in the genetic analysis of population structure</article-title>
        <source>Proc R Soc B Biol Sci.</source>
        <year>1996</year>
        <volume>263</volume>
        <fpage>1619</fpage>
        <lpage>1626</lpage>
      </element-citation>
    </ref>
    <ref id="mst063-B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berry</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kreitman</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Molecular analysis of an allozyme cline: alcohol dehydrogenase in <italic>Drosophila melanogaster</italic> on the East Coast of North America</article-title>
        <source>Genetics</source>
        <year>1993</year>
        <volume>134</volume>
        <fpage>869</fpage>
        <lpage>893</lpage>
        <pub-id pub-id-type="pmid">8102342</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carvalho</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lucas</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Nevins</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>West</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>High-dimensional sparse factor modeling: applications in gene expression genomics</article-title>
        <source>J Am Stat Assoc.</source>
        <year>2008</year>
        <volume>103</volume>
        <fpage>1438</fpage>
        <lpage>1456</lpage>
        <pub-id pub-id-type="pmid">21218139</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Forbes</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>François</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Bayesian clustering algorithms ascertaining spatial population structure: a new computer program and a comparison study</article-title>
        <source>Mol Ecol Notes.</source>
        <year>2007</year>
        <volume>7</volume>
        <fpage>747</fpage>
        <lpage>756</lpage>
      </element-citation>
    </ref>
    <ref id="mst063-B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coop</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Witonsky</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Di Rienzo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pritchard</surname>
            <given-names>JK</given-names>
          </name>
        </person-group>
        <article-title>Using environmental correlations to identify loci underlying local adaptation</article-title>
        <source>Genetics</source>
        <year>2010</year>
        <volume>185</volume>
        <fpage>1411</fpage>
        <lpage>1423</lpage>
        <pub-id pub-id-type="pmid">20516501</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B11">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Darwin</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <source>On the origin of species by means of natural selection, or the preservation of favoured races in the struggle for life</source>
        <year>1859</year>
        <publisher-loc>London</publisher-loc>
        <publisher-name>John Murray</publisher-name>
      </element-citation>
    </ref>
    <ref id="mst063-B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durand</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Jay</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Gaggiotti</surname>
            <given-names>OE</given-names>
          </name>
          <name>
            <surname>François</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Spatial inference of admixture proportions and secondary contact zones</article-title>
        <source>Mol Biol Evol.</source>
        <year>2009</year>
        <volume>26</volume>
        <fpage>1963</fpage>
        <lpage>1973</lpage>
        <pub-id pub-id-type="pmid">19461114</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eckart</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>The approximation of one matrix by another of lower rank</article-title>
        <source>Psychometrika</source>
        <year>1936</year>
        <volume>1</volume>
        <fpage>211</fpage>
        <lpage>218</lpage>
      </element-citation>
    </ref>
    <ref id="mst063-B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eckert</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Bower</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Gonzàlez-Martìnez</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Wegrzyn</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Coop</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Neale</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Back to nature: ecological genomics of loblolly pine (<italic>Pinus taeda</italic>, Pinaceae)</article-title>
        <source>Mol Ecol.</source>
        <year>2010</year>
        <volume>19</volume>
        <fpage>3789</fpage>
        <lpage>3805</lpage>
        <pub-id pub-id-type="pmid">20723060</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eden</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Navon</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Steinfeld</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Lipson</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Yakhini</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>GOrilla: a tool for discovery and visualization of enriched GO terms in ranked gene lists</article-title>
        <source>BMC Bioinformatics</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>48</fpage>
        <pub-id pub-id-type="pmid">19192299</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B16">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Endler</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <source>Geographic variation, speciation, and clines</source>
        <year>1977</year>
        <publisher-loc>Princeton (NJ)</publisher-loc>
        <publisher-name>Princeton University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="mst063-B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Engelhardt</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Analysis of population structure: a unifying framework and novel methods based on sparse factor analysis</article-title>
        <source>PLoS Genet.</source>
        <year>2010</year>
        <volume>6</volume>
        <fpage>e1001117</fpage>
        <pub-id pub-id-type="pmid">20862358</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frichot</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Schoville</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Bouchard</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>François</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Correcting principal component maps for effects of spatial autocorrelation in population genetic data</article-title>
        <source>Front Genet.</source>
        <year>2012</year>
        <volume>3</volume>
        <fpage>254</fpage>
        <pub-id pub-id-type="pmid">23181073</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fumagalli</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sironi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pozzoli</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Ferrer-Admettla</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pattini</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Signatures of environmental genetic adaptation pinpoint pathogens as the main selective pressure through human evolution</article-title>
        <source>PLoS Genet.</source>
        <year>2011</year>
        <volume>7</volume>
        <fpage>e1002355</fpage>
        <pub-id pub-id-type="pmid">22072984</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haldane</surname>
            <given-names>JBS</given-names>
          </name>
        </person-group>
        <article-title>The theory of a cline</article-title>
        <source>J Genet.</source>
        <year>1948</year>
        <volume>48</volume>
        <fpage>277</fpage>
        <lpage>284</lpage>
        <pub-id pub-id-type="pmid">18905075</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hancock</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Witonsky</surname>
            <given-names>DB</given-names>
          </name>
          <name>
            <surname>Alkorta-Aranburu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Beall</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Gebremedhin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sukernik</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Utermann</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Pritchard</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Coop</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Di Rienzo</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Adaptations to climate-mediated selective pressures in humans</article-title>
        <source>PLoS Genet.</source>
        <year>2011</year>
        <volume>7</volume>
        <fpage>e1001375</fpage>
        <pub-id pub-id-type="pmid">21533023</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hancock</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Witonsky</surname>
            <given-names>DB</given-names>
          </name>
          <name>
            <surname>Gordon</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Eshel</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Pritchard</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Coop</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Di Rienzo</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Adaptations to climate in candidate genes for common metabolic disorders</article-title>
        <source>PLoS Genet.</source>
        <year>2008</year>
        <volume>4</volume>
        <fpage>e32</fpage>
        <pub-id pub-id-type="pmid">18282109</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harmon</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Glor</surname>
            <given-names>RE</given-names>
          </name>
        </person-group>
        <article-title>Poor statistical performance of the Mantel test in phylogenetic comparative analyses</article-title>
        <source>Evolution</source>
        <year>2010</year>
        <volume>64</volume>
        <fpage>2173</fpage>
        <lpage>2178</lpage>
        <pub-id pub-id-type="pmid">20163450</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hijmans</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Cameron</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Parra</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Jarvis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Very high resolution interpolated climate surfaces for global land areas</article-title>
        <source>Int J Climatol.</source>
        <year>2005</year>
        <volume>25</volume>
        <fpage>1965</fpage>
        <lpage>1978</lpage>
      </element-citation>
    </ref>
    <ref id="mst063-B25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hindorff</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Sethupathy</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Junkins</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Ramos</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Mehta</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Collins</surname>
            <given-names>FS</given-names>
          </name>
          <name>
            <surname>Manolio</surname>
            <given-names>TA</given-names>
          </name>
        </person-group>
        <article-title>Potential etiologic and functional implications of genome-wide association loci for human diseases and traits</article-title>
        <source>Proc Natl Acad Sci U S A.</source>
        <year>2009</year>
        <volume>106</volume>
        <fpage>9362</fpage>
        <lpage>9367</lpage>
        <pub-id pub-id-type="pmid">19474294</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hornbeck</surname>
            <given-names>PV</given-names>
          </name>
          <name>
            <surname>Kornhauser</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Tkachev</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Skrzypek</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Murray</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Latham</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Sullivan</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>PhosphoSitePlus: a comprehensive resource for investigating the structure and function of experimentally determined post-translational modifications in man and mouse</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2012</year>
        <volume>40</volume>
        <issue>Database issue</issue>
        <fpage>D261</fpage>
        <lpage>D270</lpage>
        <pub-id pub-id-type="pmid">22135298</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B27">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hudson</surname>
            <given-names>RR</given-names>
          </name>
        </person-group>
        <article-title>Generating samples under a Wright-Fisher neutral model of genetic variation</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <fpage>337</fpage>
        <lpage>338</lpage>
        <pub-id pub-id-type="pmid">11847089</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B28">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jay</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Manel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Alvarez</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>EY</given-names>
          </name>
          <name>
            <surname>Thuiller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Holderegger</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Taberlet</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>François</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Forecasting changes in population genetic structure of alpine plants in response to global warming</article-title>
        <source>Mol Ecol.</source>
        <year>2012</year>
        <volume>21</volume>
        <fpage>2354</fpage>
        <lpage>2368</lpage>
        <pub-id pub-id-type="pmid">22512785</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B29">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Jolliffe</surname>
            <given-names>IT</given-names>
          </name>
        </person-group>
        <source>Principal component analysis</source>
        <year>1986</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer Verlag</publisher-name>
      </element-citation>
    </ref>
    <ref id="mst063-B30">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Joost</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bonin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bruford</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Després</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Conord</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Erhardt</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Taberlet</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>A spatial analysis method (SAM) to detect candidate loci for selection: towards a landscape genomics approach to adaptation</article-title>
        <source>Mol Ecol.</source>
        <year>2007</year>
        <volume>16</volume>
        <fpage>3955</fpage>
        <lpage>3969</lpage>
        <pub-id pub-id-type="pmid">17850556</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B31">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kelley</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Madeoy</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Calhoun</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Swanson</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Akey</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Genomic signatures of positive selection in humans and the limits of outlier approaches</article-title>
        <source>Genome Res.</source>
        <year>2006</year>
        <volume>16</volume>
        <fpage>980</fpage>
        <lpage>989</lpage>
        <pub-id pub-id-type="pmid">16825663</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koren</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Bell</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Volinsky</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Matrix factorization techniques for recommender systems</article-title>
        <source>Computer</source>
        <year>2009</year>
        <volume>8</volume>
        <fpage>30</fpage>
        <lpage>37</lpage>
      </element-citation>
    </ref>
    <ref id="mst063-B32">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lawson</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Hellenthal</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Falush</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Inference of population structure using dense haplotype data</article-title>
        <source>PLoS Genet.</source>
        <year>2012</year>
        <volume>8</volume>
        <fpage>e1002453</fpage>
        <pub-id pub-id-type="pmid">22291602</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B33">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Legendre</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Legendre</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <source>Numerical ecology</source>
        <year>2012</year>
        <edition>3rd English ed</edition>
        <publisher-loc>Amsterdam (Netherlands)</publisher-loc>
        <publisher-name>Elsevier</publisher-name>
      </element-citation>
    </ref>
    <ref id="mst063-B34">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lenormand</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Gene flow and the limits to natural selection</article-title>
        <source>Trends Ecol Evol.</source>
        <year>2002</year>
        <volume>17</volume>
        <fpage>183</fpage>
        <lpage>189</lpage>
      </element-citation>
    </ref>
    <ref id="mst063-B35">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>JZ</given-names>
          </name>
          <name>
            <surname>Absher</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
          <collab>(11 co-authors)</collab>
        </person-group>
        <article-title>Worldwide human relationships inferred from genome-wide patterns of variation</article-title>
        <source>Science</source>
        <year>2008</year>
        <volume>319</volume>
        <fpage>1100</fpage>
        <lpage>1104</lpage>
        <pub-id pub-id-type="pmid">18292342</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B36">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Manel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Joost</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Epperson</surname>
            <given-names>BK</given-names>
          </name>
          <name>
            <surname>Holderegger</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Storfer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rosenberg</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Scribner</surname>
            <given-names>KT</given-names>
          </name>
          <name>
            <surname>Bonin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fortin</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Perspectives on the use of landscape genetics to detect genetic adaptive variation in the field</article-title>
        <source>Mol Ecol.</source>
        <year>2010</year>
        <volume>19</volume>
        <fpage>3760</fpage>
        <lpage>3772</lpage>
        <pub-id pub-id-type="pmid">20723056</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B37">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meirmans</surname>
            <given-names>PG</given-names>
          </name>
        </person-group>
        <article-title>The trouble with isolation by distance</article-title>
        <source>Mol Ecol.</source>
        <year>2012</year>
        <volume>21</volume>
        <fpage>2839</fpage>
        <lpage>2846</lpage>
        <pub-id pub-id-type="pmid">22574758</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B38">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nei</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Genetic distance between populations</article-title>
        <source>Am Nat.</source>
        <year>1972</year>
        <volume>106</volume>
        <fpage>283</fpage>
        <lpage>292</lpage>
      </element-citation>
    </ref>
    <ref id="mst063-B39">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nielsen</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Molecular signatures of natural selection</article-title>
        <source>Annu Rev Genet.</source>
        <year>2005</year>
        <volume>39</volume>
        <fpage>197</fpage>
        <lpage>218</lpage>
        <pub-id pub-id-type="pmid">16285858</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B40">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Novembre</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Di Rienzo</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Spatial patterns of variation due to natural selection in humans</article-title>
        <source>Nat Rev Genet.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>745</fpage>
        <lpage>755</lpage>
        <pub-id pub-id-type="pmid">19823195</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B41">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patterson</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Price</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Reich</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Population structure and eigenanalysis</article-title>
        <source>PLoS Genet.</source>
        <year>2006</year>
        <volume>2</volume>
        <fpage>e190</fpage>
        <pub-id pub-id-type="pmid">17194218</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B42">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pavlidis</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Jensen</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Stephan</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A critical assessment of storytelling: gene ontology categories and the importance of validating genomic scans</article-title>
        <source>Mol Biol Evol.</source>
        <year>2012</year>
        <volume>29</volume>
        <fpage>3237</fpage>
        <lpage>3248</lpage>
        <pub-id pub-id-type="pmid">22617950</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B43">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Poncet</surname>
            <given-names>BN</given-names>
          </name>
          <name>
            <surname>Herrman</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gugerli</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Taberlet</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Holderegger</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gielly</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Rioux</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Thuiller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Aubert</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Manel</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Tracking genes of ecological relevance using a genome scan in two independent regional population samples of <italic>Arabis alpina</italic></article-title>
        <source>Mol Ecol.</source>
        <year>2010</year>
        <volume>19</volume>
        <fpage>2896</fpage>
        <lpage>2907</lpage>
        <pub-id pub-id-type="pmid">20609082</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B44">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Patterson</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Plenge</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Weinblatt Michael</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Shadick</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Reich</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Principal components analysis corrects for stratification in genome-wide association studies</article-title>
        <source>Nat Genet.</source>
        <year>2006</year>
        <volume>38</volume>
        <fpage>904</fpage>
        <lpage>909</lpage>
        <pub-id pub-id-type="pmid">16862161</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B45">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Tandon</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Patterson</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Barnes</surname>
            <given-names>KC</given-names>
          </name>
          <name>
            <surname>Rafaels</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ruczinski</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Beaty</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Mathias</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Reich</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Sensitive detection of chromosomal segments of distinct ancestry in admixed populations</article-title>
        <source>PLoS Genet.</source>
        <year>2009</year>
        <volume>5</volume>
        <fpage>e1000519</fpage>
        <pub-id pub-id-type="pmid">19543370</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B46">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pritchard</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Pickrell</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Coop</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>The genetics of human adaptation: hard sweeps, soft sweeps, and polygenic adaptation</article-title>
        <source>Curr Biol.</source>
        <year>2010</year>
        <volume>20</volume>
        <fpage>R208</fpage>
        <lpage>R215</lpage>
        <pub-id pub-id-type="pmid">20178769</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B47">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pritchard</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Donnelly</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Inference of population structure using multilocus genotype data</article-title>
        <source>Genetics</source>
        <year>2000</year>
        <volume>155</volume>
        <fpage>945</fpage>
        <lpage>959</lpage>
        <pub-id pub-id-type="pmid">10835412</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B48">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prugnolle</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Manica</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Charpentier</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gugan</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Guernier</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Balloux</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Pathogen-driven selection and worldwide HLA class I diversity</article-title>
        <source>Curr Biol.</source>
        <year>2005</year>
        <volume>15</volume>
        <fpage>1022</fpage>
        <lpage>1027</lpage>
        <pub-id pub-id-type="pmid">15936272</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B49">
      <element-citation publication-type="book">
        <collab>R Development Core Team</collab>
        <source>R: a language and environment for statistical computing</source>
        <year>2012</year>
        <publisher-loc>Vienna (Austria)</publisher-loc>
        <publisher-name>R Foundation for Statistical Computing</publisher-name>
      </element-citation>
    </ref>
    <ref id="mst063-B50">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saccone</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Quan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mehta</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Bolze</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Deelman</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Tischfield</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Rice</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>New tools and methods for direct programmatic access to the dbSNP relational database</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>D901</fpage>
        <lpage>D907</lpage>
        <pub-id pub-id-type="pmid">21037260</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B51">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Salakhutdinov</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Mnih</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Bayesian probabilistic matrix factorization using Markov chain Monte Carlo</article-title>
        <source>ICML</source>
        <year>2008</year>
        <volume>25</volume>
        <fpage>880</fpage>
        <lpage>887</lpage>
      </element-citation>
    </ref>
    <ref id="mst063-B52">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schoville</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Bonin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>François</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Lobreaux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Melodelima</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Manel</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Adaptive genetic variation on the landscape: methods and cases</article-title>
        <source>Annu Rev Ecol Syst.</source>
        <year>2012</year>
        <volume>43</volume>
        <fpage>23</fpage>
        <lpage>43</lpage>
      </element-citation>
    </ref>
    <ref id="mst063-B53">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smouse</surname>
            <given-names>PE</given-names>
          </name>
          <name>
            <surname>Long</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Sokal</surname>
            <given-names>RR</given-names>
          </name>
        </person-group>
        <article-title>Multiple regression and correlation extensions of the Mantel test of matrix correspondence</article-title>
        <source>Syst Biol.</source>
        <year>1986</year>
        <volume>35</volume>
        <fpage>627</fpage>
        <lpage>632</lpage>
      </element-citation>
    </ref>
    <ref id="mst063-B54">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Storz</surname>
            <given-names>JF</given-names>
          </name>
        </person-group>
        <article-title>Using genome scans of DNA polymorphism to infer adaptive population divergence</article-title>
        <source>Mol Ecol.</source>
        <year>2005</year>
        <volume>14</volume>
        <fpage>671</fpage>
        <lpage>688</lpage>
        <pub-id pub-id-type="pmid">15723660</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B55">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Storz</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Wheat</surname>
            <given-names>CW</given-names>
          </name>
        </person-group>
        <article-title>Integrating evolutionary and functional approaches to infer adaptation at specific loci</article-title>
        <source>Evolution</source>
        <year>2010</year>
        <volume>64</volume>
        <fpage>2489</fpage>
        <lpage>2509</lpage>
        <pub-id pub-id-type="pmid">20500215</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B56">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thibert-Plante</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Hendry</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>When can ecological speciation be detected with neutral loci?</article-title>
        <source>Mol Ecol.</source>
        <year>2010</year>
        <volume>19</volume>
        <fpage>2301</fpage>
        <lpage>2314</lpage>
        <pub-id pub-id-type="pmid">20465581</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B57">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tipping</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Bishop</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <article-title>Probabilistic principal component analysis</article-title>
        <source>J Roy Stat Soc B.</source>
        <year>1999</year>
        <volume>61</volume>
        <fpage>611</fpage>
        <lpage>622</lpage>
      </element-citation>
    </ref>
    <ref id="mst063-B58">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>West</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Bayesian factor regression models in the “large p, small n” paradigm</article-title>
        <source>Bayesian Stat.</source>
        <year>2003</year>
        <volume>7</volume>
        <fpage>723</fpage>
        <lpage>732</lpage>
      </element-citation>
    </ref>
    <ref id="mst063-B59">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Williams</surname>
            <given-names>GC</given-names>
          </name>
        </person-group>
        <source>Adaptation and natural selection</source>
        <year>1966</year>
        <volume>Vol. 1996</volume>
        <publisher-loc>Princeton (NJ)</publisher-loc>
        <publisher-name>Princeton University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="mst063-B60">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Young</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>YC</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Chretien</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Klag</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Levine</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Ruff</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>NY</given-names>
          </name>
          <name>
            <surname>Chakravarti</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Differential susceptibility to hypertension is due to selection during the out-of-Africa expansion</article-title>
        <source>PLoS Genet.</source>
        <year>2005</year>
        <volume>1</volume>
        <fpage>e82</fpage>
        <pub-id pub-id-type="pmid">16429165</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B61">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pressoir</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Briggs</surname>
            <given-names>WH</given-names>
          </name>
          <name>
            <surname>Vroh Bi</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Yamasaki</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Doebley</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>McMullen</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Gaut</surname>
            <given-names>BS</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Holland</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Kresovich</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Buckler</surname>
            <given-names>ES</given-names>
          </name>
        </person-group>
        <article-title>A unified mixed-model method for association mapping that accounts for multiple levels of relatedness</article-title>
        <source>Nat Genet.</source>
        <year>2006</year>
        <volume>38</volume>
        <fpage>203</fpage>
        <lpage>208</lpage>
        <pub-id pub-id-type="pmid">16380716</pub-id>
      </element-citation>
    </ref>
    <ref id="mst063-B62">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide efficient mixed-model analysis for association studies</article-title>
        <source>Nat Genet.</source>
        <year>2012</year>
        <volume>44</volume>
        <fpage>821</fpage>
        <lpage>824</lpage>
        <pub-id pub-id-type="pmid">22706312</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
