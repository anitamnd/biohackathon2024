<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Proc Natl Acad Sci U S A</journal-id>
    <journal-id journal-id-type="iso-abbrev">Proc Natl Acad Sci U S A</journal-id>
    <journal-id journal-id-type="hwp">pnas</journal-id>
    <journal-id journal-id-type="pmc">pnas</journal-id>
    <journal-id journal-id-type="publisher-id">PNAS</journal-id>
    <journal-title-group>
      <journal-title>Proceedings of the National Academy of Sciences of the United States of America</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0027-8424</issn>
    <issn pub-type="epub">1091-6490</issn>
    <publisher>
      <publisher-name>National Academy of Sciences</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7812788</article-id>
    <article-id pub-id-type="pmid">33402531</article-id>
    <article-id pub-id-type="publisher-id">202013756</article-id>
    <article-id pub-id-type="doi">10.1073/pnas.2013756118</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Biological Sciences</subject>
        <subj-group>
          <subject>Biophysics and Computational Biology</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Sparseness and Smoothness Regularized Imaging for improving the resolution of Cryo-EM single-particle reconstruction</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Luo</surname>
          <given-names>Zhenwei</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>a</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3256-9088</contrib-id>
        <name>
          <surname>Campos-Acevedo</surname>
          <given-names>Adam A.</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>b</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lv</surname>
          <given-names>Longfei</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>c</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Qinghua</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>b</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Jianpeng</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>a</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>b</sup>
        </xref>
        <xref ref-type="aff" rid="aff3">
          <sup>c</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>1</sup>
        </xref>
      </contrib>
      <aff id="aff1"><sup>a</sup>Department of Bioengineering, <institution>Rice University</institution>, Houston, <addr-line>TX</addr-line> 77030;</aff>
      <aff id="aff2"><sup>b</sup>Verna and Marrs Mclean Department of Biochemistry and Molecular Biology, <institution>Baylor College of Medicine</institution>, Houston, <addr-line>TX</addr-line> 77030;</aff>
      <aff id="aff3"><sup>c</sup>Multiscale Research Institute of Complex Systems, <institution>Fudan University</institution>, Shanghai, 201203, <country>China</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><sup>1</sup>To whom correspondence may be addressed. Email: <email>jpma@bcm.tmc.edu</email>.</corresp>
      <fn fn-type="edited-by">
        <p>Edited by Alan R. Fersht, University of Cambridge, Cambridge, United Kingdom, and approved November 23, 2020 (received for review July 8, 2020)</p>
      </fn>
      <fn fn-type="con">
        <p>Author contributions: Z.L., Q.W., and J.M. designed research; Z.L., A.A.C.-A., and L.L. performed research; Z.L., Q.W., and J.M. analyzed data; and Z.L., Q.W., and J.M. wrote the paper.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>12</day>
      <month>1</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>05</day>
      <month>1</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>1</month>
      <year>2021</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>118</volume>
    <issue>2</issue>
    <elocation-id>e2013756118</elocation-id>
    <permissions>
      <copyright-statement>Copyright © 2021 the Author(s). Published by PNAS.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="vor">https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref>
        <license-p>This open access article is distributed under <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">Creative Commons Attribution-NonCommercial-NoDerivatives License 4.0 (CC BY-NC-ND)</ext-link>.</license-p>
      </license>
    </permissions>
    <self-uri xlink:title="pdf" xlink:href="pnas.202013756.pdf"/>
    <abstract abstract-type="executive-summary">
      <title>Significance</title>
      <p>Three-dimensional refinement is a critical component of cryo-EM single-particle reconstruction. In this paper, we report the development of a computational method, OPUS-SSRI, and its application to seven real cryo-EM datasets. Our data clearly demonstrated that OPUS-SSRI can improve the final resolutions and structural details in cryo-EM single-particle analysis.</p>
    </abstract>
    <abstract>
      <p>In this paper, we present a refinement method for cryo-electron microscopy (cryo-EM) single-particle reconstruction, termed as OPUS-SSRI (Sparseness and Smoothness Regularized Imaging). In OPUS-SSRI, spatially varying sparseness and smoothness priors are incorporated to improve the regularity of electron density map, and a type of real space penalty function is designed. Moreover, we define the back-projection step as a local kernel regression and propose a first-order method to solve the resulting optimization problem. On the seven cryo-EM datasets that we tested, the average improvement in resolution by OPUS-SSRI over that from RELION 3.0, the commonly used image-processing software for single-particle cryo-EM, was 0.64 Å, with the largest improvement being 1.25 Å. We expect OPUS-SSRI to be an invaluable tool to the broad field of cryo-EM single-particle analysis. The implementation of OPUS-SSRI can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/alncat/cryoem" xlink:show="new">https://github.com/alncat/cryoem</ext-link>.</p>
    </abstract>
    <kwd-group>
      <kwd>Cryo-EM</kwd>
      <kwd>3D reconstruction</kwd>
      <kwd>ill-posed inverse problem</kwd>
      <kwd>smoothness</kwd>
      <kwd>sparseness</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="gs1">
        <funding-source id="sp1">HHS | National Institutes of Health (NIH)<named-content content-type="funder-id">100000002</named-content></funding-source>
        <award-id rid="sp1">R01-GM127628</award-id>
        <principal-award-recipient>Qinghua Wang</principal-award-recipient>
        <principal-award-recipient>Jianpeng Ma</principal-award-recipient>
      </award-group>
      <award-group id="gs2">
        <funding-source id="sp2">HHS | National Institutes of Health (NIH)<named-content content-type="funder-id">100000002</named-content></funding-source>
        <award-id rid="sp2">R01-GM116280</award-id>
        <principal-award-recipient>Qinghua Wang</principal-award-recipient>
        <principal-award-recipient>Jianpeng Ma</principal-award-recipient>
      </award-group>
      <award-group id="gs3">
        <funding-source id="sp3">Welch Foundation<named-content content-type="funder-id">100000928</named-content></funding-source>
        <award-id rid="sp3">Q-1512</award-id>
        <principal-award-recipient>Qinghua Wang</principal-award-recipient>
        <principal-award-recipient>Jianpeng Ma</principal-award-recipient>
      </award-group>
      <award-group id="gs4">
        <funding-source id="sp4">Welch Foundation<named-content content-type="funder-id">100000928</named-content></funding-source>
        <award-id rid="sp4">Q-1826</award-id>
        <principal-award-recipient>Qinghua Wang</principal-award-recipient>
        <principal-award-recipient>Jianpeng Ma</principal-award-recipient>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <p content-type="flushleft">Cryo-electron microscopy (Cryo-EM) single-particle analysis is a powerful method for determining macromolecular structures. The major advantages of cryo-EM over the traditional X-ray crystallography are that it does not require crystallization and is not plagued by the phase problem. However, there remain many new challenges in this promising technique. The central problem of cryo-EM single-particle analysis is the incompleteness of experimental observations. More specifically, the information of the relative orientations and translations of all particles is missing. Furthermore, in a dataset with multiple conformations (or substates), the membership of a specific class needs to be defined. Moreover, the signal-to-noise ratio (SNR) of a cryo-EM dataset is often very low since the electron exposure of the sample needs to be strictly limited to reduce radiation damage (<xref rid="r1" ref-type="bibr">1</xref>). Other problems often present in cryo-EM datasets include the nonuniform angular sampling, which frequently results in inadequate sampling or even no sampling in certain orientations (<xref rid="r2" ref-type="bibr">2</xref>). Therefore, the problem of cryo-EM three-dimensional (3D) reconstruction is an extremely ill-posed problem. To alleviate the ill-posedness of this problem, prior assumptions must be incorporated into the reconstruction process to ensure the uniqueness of solution and the objectivity of the final maps.</p>
  <p>Two outstanding features of 3D density maps are sparseness and smoothness. Specifically, since the atoms in macromolecules only occupy part of the 3D maps, the macromolecular maps are often sparse in space. On the other hand, because the atoms in macromolecules are connected through chemical bonds, the electron densities of macromolecules vary smoothly across the space (<xref rid="r3" ref-type="bibr">3</xref>). Though sparseness is a popular prior in solving inverse problems, it is a relatively novel notion to cryo-EM 3D reconstruction. In contrast, the importance of smoothness prior is widely recognized in cryo-EM 3D refinement. An early attempt to enforce the smoothness of the density map was to apply the Wiener filter (<xref rid="r4" ref-type="bibr">4</xref>). Later approaches improved upon the Wiener filter by using Bayesian statistics (<xref rid="r3" ref-type="bibr">3</xref>). Scheres et al. assumed that the Fourier components of the density map are distributed according to Gaussian distributions (<xref rid="r3" ref-type="bibr">3</xref>) a priori and derived a maximum a posteriori estimation for reconstruction. This approach, as implemented in REgularised LIkelihood OptimisatioN (RELION) (<xref rid="r5" ref-type="bibr">5</xref>), is referred to as the traditional approach in the context of this paper. Except for incorporating priors into the reconstruction process, another line of efforts aims to enhance cryo-EM 3D refinement by optimizing the defocus parameter and class membership for each particle, as exemplified by THUNDER (<xref rid="r6" ref-type="bibr">6</xref>). THUNDER has been shown to improve cryo-EM refinement by providing more accurate contrast transfer function and membership for each particle.</p>
  <p>In this paper, we continued the direction used in RELION and proposed an approach to regularize the 3D maps. Our approach, named OPUS-SSRI (Sparseness and Smoothness Regularized Imaging), focuses on imposing sparseness and smoothness priors (i.e., <inline-formula><mml:math id="i1"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> regularization) (<xref rid="r7" ref-type="bibr">7</xref>) and total variation (TV) (<xref rid="r8" ref-type="bibr">8</xref>). To encourage sparseness and smoothness of the density map while suppressing bias, we proposed a nonconcave, nonsmooth, real-space restraint by combining <inline-formula><mml:math id="i2"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> regularization and TV norm. Since such target function is difficult to optimize, we designed a reweighted scheme to approximately optimize it with a sequence of weighted <inline-formula><mml:math id="i3"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and TV problem. The major differences between the traditional approach in RELION and our approach in OPUS-SSRI are outlined in detail in the <xref ref-type="sec" rid="s3"><italic>Materials and Methods</italic></xref> section. In essence, the traditional approach in RELION can be viewed as applying a translation-invariant isotropic kernel to smooth the 3D map, whereas OPUS-SSRI applies a spatially varying anisotropic kernel. Another challenge of 3D map reconstruction in real space is the prohibitive computation cost as a result of its ultrahigh dimensionality. For example, a common 512 × 512 × 512 3D volume contains hundreds of millions of variables. We addressed this challenge by leveraging a Compute Unified Device Architecture (CUDA)-accelerated implementation. In addition, we cast the back-projection as a local kernel regression problem, thus paving a way to promote the smoothness of the 3D map (<xref rid="bib34" ref-type="bibr">9</xref>). By applying it to seven real cryo-EM datasets, we demonstrated that our OPUS-SSRI supports a significant improvement over RELION 3.0 or THUNDER, especially for systems with significant flexibility.</p>
  <sec sec-type="results" id="s1">
    <title>Results</title>
    <p content-type="flushleft">We tested OPUS-SSRI by performing 3D refinement on a total of seven real datasets and comparing the refinement results with those obtained using RELION 3.0 or THUNDER. The detailed experimental process and optimal parameters are reported in the <ext-link ext-link-type="uri" xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2013756118/-/DCSupplemental" xlink:show="new"><italic>SI Appendix</italic></ext-link>.</p>
    <p>According to the gold-standard Fourier shell correlation (FSC) at 0.143, the final density maps reconstructed by OPUS-SSRI clearly have higher SNRs compared to those generated by RELION 3.0 in most resolution shells for β-galactosidase (<xref rid="r10" ref-type="bibr">10</xref>, <xref rid="r11" ref-type="bibr">11</xref>) (<xref ref-type="fig" rid="fig01">Fig. 1<italic>A</italic></xref>), 80S ribosome (<xref rid="r12" ref-type="bibr">12</xref>) (<xref ref-type="fig" rid="fig01">Fig. 1<italic>B</italic></xref>), influenza hemagglutinin (HA) (<xref rid="r13" ref-type="bibr">13</xref>) (<xref ref-type="fig" rid="fig01">Fig. 1<italic>C</italic></xref>), transient receptor potential melastatin (TRPM4) (<xref rid="r14" ref-type="bibr">14</xref>) (<xref ref-type="fig" rid="fig01">Fig. 1<italic>D</italic></xref>), protein-conducting ERAD channel Hrd1/Hrd3 complex (<xref rid="r15" ref-type="bibr">15</xref>) (<xref ref-type="fig" rid="fig02">Fig. 2<italic>A</italic></xref>), transient receptor potential vanilloid 5 (TRPV5) (<xref rid="r16" ref-type="bibr">16</xref>) (<xref ref-type="fig" rid="fig03">Fig. 3<italic>A</italic></xref>), and calcium-activated chloride channel (TMEM16A) in nanodisc (<xref rid="r17" ref-type="bibr">17</xref>) (<xref ref-type="fig" rid="fig04">Fig. 4<italic>A</italic></xref>). The final maps refined by OPUS-SSRI have resolutions that are 0.15 to 1.25 Å better than those refined by RELION 3.0, with averaged resolution improvement of 0.64 Å for all seven systems (<xref rid="t01" ref-type="table">Table 1</xref>). The improvement of the density maps reconstructed by OPUS-SSRI is also confirmed by the model versus map FSCs. The postprocessed maps of OPUS-SSRI have much higher correlations with respect to the corresponding rigid-body fitted atomic models in most resolution shells than RELION 3.0 (<ext-link ext-link-type="uri" xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2013756118/-/DCSupplemental" xlink:show="new"><italic>SI Appendix</italic>, Fig. S1</ext-link>). Overall, for the seven systems, the improvements in resolution for the postprocessed maps of OPUS-SSRI are in the range of 0.14 to 0.73 Å, with an average of 0.30 Å, over those refined by RELION 3.0 (<ext-link ext-link-type="uri" xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2013756118/-/DCSupplemental" xlink:show="new"><italic>SI Appendix</italic>, Table S1</ext-link>).</p>
    <fig fig-type="featured" id="fig01" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>Gold-standard unmasked and masked FSC curves for the final 3D reconstructions refined by OPUS-SSRI (in red color) or RELION 3.0 (in blue color) for (<italic>A</italic>) β-galactosidase, (<italic>B</italic>) 80S ribosome, (<italic>C</italic>) influenza hemagglutinin, and (<italic>D</italic>) TRPM4. In all panels, the dashed black line represents FSC = 0.143.</p>
      </caption>
      <graphic id="gra1" xlink:href="pnas.2013756118fig01"/>
    </fig>
    <fig fig-type="figure" id="fig02" orientation="portrait" position="float">
      <label>Fig. 2.</label>
      <caption>
        <p>Refinement of Hrd1/Hrd3 complex. (<italic>A</italic>) Gold-standard unmasked and masked FSC curves calculated from two independent reconstructions by OPUS-SSRI or RELION 3.0. The dashed black line represents FSC = 0.143. (<italic>B</italic>) Final reconstructed cryo-EM map using RELION 3.0. (<italic>C</italic>) Final reconstructed cryo-EM map using OPUS-SSRI. The red rectangle defines a region of the EM map to be enlarged in <italic>D</italic> for RELION 3.0 and <italic>E</italic> for OPUS-SSRI for residues 142 to 175, respectively. The EM density is represented in mesh (blue), and the atomic model is shown in a ribbons diagram with side chains in stick presentation. Both density maps are contoured at the same level.</p>
      </caption>
      <graphic id="gra2" xlink:href="pnas.2013756118fig02"/>
    </fig>
    <fig fig-type="figure" id="fig03" orientation="portrait" position="float">
      <label>Fig. 3.</label>
      <caption>
        <p>Refinement of TRPV5. (<italic>A</italic>) Gold-standard unmasked and masked FSC curves calculated from two independent reconstructions by OPUS-SSRI or RELION 3.0. The dashed black line represents FSC = 0.143. (<italic>B</italic>) Final reconstructed cryo-EM map using RELION 3.0. (<italic>C</italic>) Final reconstructed cryo-EM map using OPUS-SSRI. The red rectangles in <italic>B</italic> and <italic>C</italic> define a region of the EM map to be enlarged in <italic>D</italic> for RELION 3.0 and <italic>E</italic> for OPUS-SSRI for residues 374 to 409, respectively. The dash red circles highlight a region in the model before (<italic>D</italic>) and after (<italic>E</italic>) the manual adjustments in COOT and structural refinement using PHENIX. The EM density is represented in mesh (blue), and the structural model is represented by a ribbons diagram with side chains in stick presentation. Both density maps are contoured at the same level.</p>
      </caption>
      <graphic id="gra3" xlink:href="pnas.2013756118fig03"/>
    </fig>
    <fig fig-type="figure" id="fig04" orientation="portrait" position="float">
      <label>Fig. 4.</label>
      <caption>
        <p>Refinement of TMEM16A in nanodisc. (<italic>A</italic>) Gold-standard unmasked and masked FSC curves calculated from two independent reconstructions by OPUS-SSRI or RELION 3.0. The dashed black line represents FSC = 0.143. (<italic>B</italic>) Final reconstructed cryo-EM map using RELION 3.0. (<italic>C</italic>) Final reconstructed cryo-EM map using OPUS-SSRI. The dashed red rectangles in <italic>B</italic> and <italic>C</italic> define a region of EM map to be enlarged in <italic>D</italic> for RELION 3.0 and <italic>E</italic> for OPUS-SSRI for residues 408 to 440, respectively. The solid red rectangles in <italic>B</italic> and <italic>C</italic> define a region of the EM map to be enlarged in <italic>F</italic> for RELION 3.0 and <italic>G</italic> for OPUS-SSRI for residues 848 to 884, respectively. The EM density is represented in mesh (blue), and the structural model is represented by a ribbons diagram with side chains in stick presentation. Both density maps are contoured at the same level.</p>
      </caption>
      <graphic id="gra4" xlink:href="pnas.2013756118fig04"/>
    </fig>
    <table-wrap id="t01" orientation="portrait" position="float">
      <label>Table 1.</label>
      <caption>
        <p>Comparison of the final reconstructions refined by RELION 3.0, THUNDER, or OPUS-SSRI</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <td rowspan="3" colspan="1">Proteins</td>
            <td align="center" colspan="6" rowspan="1">Gold-standard FSC = 0.143</td>
          </tr>
          <tr>
            <td align="center" rowspan="1" colspan="1">RELION</td>
            <td align="center" colspan="2" rowspan="1">THUNDER</td>
            <td align="center" colspan="3" rowspan="1">OPUS-SSRI</td>
          </tr>
          <tr>
            <td align="center" rowspan="1" colspan="1">Resolution (Å)</td>
            <td align="center" rowspan="1" colspan="1">Resolution (Å)</td>
            <td align="center" rowspan="1" colspan="1">ΔÅ over RELION<xref ref-type="table-fn" rid="tfn1">*</xref></td>
            <td align="center" rowspan="1" colspan="1">Resolution (Å)</td>
            <td align="center" rowspan="1" colspan="1">ΔÅ over RELION<xref ref-type="table-fn" rid="tfn1">*</xref></td>
            <td align="center" rowspan="1" colspan="1">ΔÅ over THUNDER<xref ref-type="table-fn" rid="tfn2"><sup>†</sup></xref></td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">β<italic>-</italic>galactosidase (EMPIAR-10017)</td>
            <td align="char" char="." rowspan="1" colspan="1">4.16</td>
            <td align="center" rowspan="1" colspan="1">4.25</td>
            <td align="center" rowspan="1" colspan="1">−0.09</td>
            <td align="char" char="." rowspan="1" colspan="1">3.93</td>
            <td align="char" char="." rowspan="1" colspan="1">0.23</td>
            <td align="center" rowspan="1" colspan="1">0.33</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">80S ribosome (EMPIAR-10002)</td>
            <td align="char" char="." rowspan="1" colspan="1">4.08</td>
            <td align="center" rowspan="1" colspan="1">3.80</td>
            <td align="center" rowspan="1" colspan="1">0.28</td>
            <td align="char" char="." rowspan="1" colspan="1">3.93</td>
            <td align="char" char="." rowspan="1" colspan="1">0.15</td>
            <td align="center" rowspan="1" colspan="1">−0.13</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Hemagglutinin (EMPIAR-10097)</td>
            <td align="char" char="." rowspan="1" colspan="1">4.19</td>
            <td align="center" rowspan="1" colspan="1">4.11</td>
            <td align="center" rowspan="1" colspan="1">0.08</td>
            <td align="char" char="." rowspan="1" colspan="1">3.77</td>
            <td align="char" char="." rowspan="1" colspan="1">0.42</td>
            <td align="center" rowspan="1" colspan="1">0.34</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">TRPM4 (EMPIAR-10126)</td>
            <td align="char" char="." rowspan="1" colspan="1">3.48</td>
            <td align="center" rowspan="1" colspan="1">/</td>
            <td align="center" rowspan="1" colspan="1">/</td>
            <td align="char" char="." rowspan="1" colspan="1">2.74</td>
            <td align="char" char="." rowspan="1" colspan="1">0.74</td>
            <td align="center" rowspan="1" colspan="1">/</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Hrd1/Hrd3 (EMPIAR-10099)</td>
            <td align="char" char="." rowspan="1" colspan="1">4.80</td>
            <td align="center" rowspan="1" colspan="1">4.75</td>
            <td align="center" rowspan="1" colspan="1">0.05</td>
            <td align="char" char="." rowspan="1" colspan="1">3.55</td>
            <td align="char" char="." rowspan="1" colspan="1">1.25</td>
            <td align="center" rowspan="1" colspan="1">1.20</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">TRPV5 (EMPIAR-10254)</td>
            <td align="char" char="." rowspan="1" colspan="1">3.12</td>
            <td align="center" rowspan="1" colspan="1">3.09</td>
            <td align="center" rowspan="1" colspan="1">0.03</td>
            <td align="char" char="." rowspan="1" colspan="1">2.47</td>
            <td align="char" char="." rowspan="1" colspan="1">0.65</td>
            <td align="center" rowspan="1" colspan="1">0.62</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">TMEM16A (EMPIAR-10123)</td>
            <td align="char" char="." rowspan="1" colspan="1">3.90</td>
            <td align="center" rowspan="1" colspan="1">/</td>
            <td align="center" rowspan="1" colspan="1">/</td>
            <td align="char" char="." rowspan="1" colspan="1">2.84</td>
            <td align="char" char="." rowspan="1" colspan="1">1.06</td>
            <td align="center" rowspan="1" colspan="1">/</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Average improvement</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td align="center" rowspan="1" colspan="1">0.07</td>
            <td rowspan="1" colspan="1"/>
            <td align="char" char="." rowspan="1" colspan="1">0.64</td>
            <td align="center" rowspan="1" colspan="1">0.47</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn>
          <p>/ indicates that the comparison was unavailable in two cases in which THUNDER failed to execute due to computer incompatibility.</p>
        </fn>
        <fn id="tfn1">
          <label>*</label>
          <p>The value in negative indicates the resultant resolution is worse than that from RELION, while the value in positive indicates the resultant resolution is better than that from RELION.</p>
        </fn>
        <fn id="tfn2">
          <label>
            <sup>†</sup>
          </label>
          <p>The value in negative indicates the resultant resolution is worse than that from THUNDER, while the value in positive indicates the resultant resolution is better than that from THUNDER.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>THUNDER was also run on five of these seven systems (it failed to execute on two datasets due to incompatibility with our computing facility). According to the gold-standard FSC at 0.143, the improvements in resolution by THUNDER over RELION 3.0 are in the range of −0.09 to 0.28 Å with an average of 0.07 Å (<xref rid="t01" ref-type="table">Table 1</xref>). If judged by the model versus map FSCs at 0.143, the improvements in resolution of THUNDER over RELION 3.0 are in the range of −0.18 to 0.17 Å with an average of 0.07 Å on the five systems (<ext-link ext-link-type="uri" xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2013756118/-/DCSupplemental" xlink:show="new"><italic>SI Appendix</italic>, Table S1</ext-link>). Of these five systems, OPUS-SSRI constantly outperforms THUNDER on four systems and only slightly underperforms THUNDER on one system (80S ribosome) as gauged by the gold-standard FSC = 0.143 and model versus map FSC = 0.143. Overall, OPUS-SSRI produces an average improvement of 0.47 Å in resolution over THUNDER for all five systems if judged by the gold-standard FSC = 0.143, with the largest improvement being 1.20 Å (<xref rid="t01" ref-type="table">Table 1</xref> and <ext-link ext-link-type="uri" xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2013756118/-/DCSupplemental" xlink:show="new"><italic>SI Appendix</italic>, Fig. S2</ext-link>), and of 0.20 Å in resolution if judged by the model versus map FSC = 0.143, with the largest improvement being 0.63 Å (<ext-link ext-link-type="uri" xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2013756118/-/DCSupplemental" xlink:show="new"><italic>SI Appendix</italic>, Table S1 and Fig. S3</ext-link>).</p>
    <p><xref ref-type="fig" rid="fig02">Fig. 2</xref> shows some of the structural improvements for Hrd1/Hrd3 complex in more detail. Clearly, compared to the density map reconstructed by RELION 3.0 (<xref ref-type="fig" rid="fig02">Fig. 2<italic>B</italic></xref>), the density map from OPUS-SSRI is much sharper and cleaner (<xref ref-type="fig" rid="fig02">Fig. 2<italic>C</italic></xref>). In fact, out of the seven systems studied, OPUS-SSRI refinement on Hrd1/Hrd3 complex results in the largest improvements in resolution (<xref rid="t01" ref-type="table">Table 1</xref> and <ext-link ext-link-type="uri" xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2013756118/-/DCSupplemental" xlink:show="new"><italic>SI Appendix</italic>, Table S1</ext-link>). For instance, in the density map from RELION 3.0, there is a gap in the main-chain density between residues 147 and 148 (<xref ref-type="fig" rid="fig02">Fig. 2<italic>D</italic></xref>). However, in the density map from OPUS-SSRI, the density in this region becomes continuous and strong (<xref ref-type="fig" rid="fig02">Fig. 2<italic>E</italic></xref>).</p>
    <p>Similarly, for TRPV5, comparing to the final map obtained by RELION 3.0 (<xref ref-type="fig" rid="fig03">Fig. 3<italic>B</italic></xref>), the density map from OPUS-SSRI becomes much sharper with improved SNRs (<xref ref-type="fig" rid="fig03">Fig. 3<italic>C</italic></xref>). Most impressively, the density map from OPUS-SSRI even allows retracing of the structural model in the region of residues 374 to 380 that was out of the density map in the original structure (highlighted in dashed red circle in <xref ref-type="fig" rid="fig03">Fig. 3<italic>D</italic></xref>). After the manual adjustment in the crystallographic object-oriented toolkit COOT (<xref rid="r18" ref-type="bibr">18</xref>) and structural refinement using Python-based Hierarchical ENvironment for Integrated Xtallography (PHENIX) (<xref rid="r19" ref-type="bibr">19</xref>), the match between the model and map is substantially improved (highlighted by dashed red circle in <xref ref-type="fig" rid="fig03">Fig. 3<italic>E</italic></xref>).</p>
    <p>In addition, for TMEM16A, in contrast to the density map from RELION 3.0 (<xref ref-type="fig" rid="fig04">Fig. 4<italic>B</italic></xref>), the density map obtained by OPUS-SSRI (<xref ref-type="fig" rid="fig04">Fig. 4<italic>C</italic></xref>) shows sharper and smoother densities with less noise throughout. The improvement from OPUS-SSRI is highlighted for two helices in the regions of residues 408 to 440 (<xref ref-type="fig" rid="fig04">Fig. 4 <italic>D</italic> and <italic>E</italic></xref>) and 848 to 884 (<xref ref-type="fig" rid="fig04">Fig. 4 <italic>F</italic> and <italic>G</italic></xref>). Most impressively, in the density map refined by OPUS-SSRI, the densities for side chains of residues F412, M416, W419, and F423 (<xref ref-type="fig" rid="fig04">Fig. 4<italic>E</italic></xref>) and F863, I865, F867, and N869 (<xref ref-type="fig" rid="fig04">Fig. 4<italic>G</italic></xref>) become very well separated, in marked contrast to the blobs of densities from RELION 3.0 in <xref ref-type="fig" rid="fig04">Fig. 4 <italic>D</italic> and <italic>F</italic></xref>, respectively.</p>
  </sec>
  <sec sec-type="discussion" id="s2">
    <title>Discussion</title>
    <p content-type="flushleft">In this paper, we proposed OPUS-SSRI, a 3D refinement method for cryo-EM single-particle analysis. The improvement of our method in gold-standard FSC of the final reconstructions is the most noticeable, which can be largely attributed to the superior denoising effect of the sparseness and smoothness priors that we introduced. By setting relatively small components in the 3D map to zero and filtering components to be more consistent with their neighbors, the sparseness and smoothness restraints can suppress the noisy densities that do not belong to the molecules in the map, thus producing cleaner reconstructions. The cleaner map in turn leads to more accurate pose estimation for each particle. These improvements brought about by our method result in an overall much-improved final reconstruction. Furthermore, the relatively large improvements for structures with heterogenous flexibility such as Hrd1/Hrd3 and TMEM16A confirm the theoretical difference between the traditional smoothness prior in RELION and our smoothness prior in OPUS-SSRI. For structures with heterogeneous flexibilities in different regions, the traditional approach in RELION enforces translation-invariant isotropic smoothness to the 3D maps, thus smearing the rigid regions and creating large biases in the reconstructions. In contrast, OPUS-SSRI can adapt to different flexibilities in different regions in the maps, thus greatly reducing biases and improving the final reconstructions. Another approach we explored to promote smoothness is by casting the back-projection as a local kernel regression problem. This formulation enables us to embed the 3D maps in a reproducing kernel Hilbert space (RKHS) with specific smoothness.</p>
    <p>Although our method introduces five more parameters, their optimal values can be easily determined. First of all, we can set <inline-formula><mml:math id="i4"><mml:mi mathvariant="italic">ϵ</mml:mi></mml:math></inline-formula> to the level of density values corresponding to molecular content in the 3D volume. This level can be easily obtained from the intermediate volumes generated by the refinement using RELION 3.0. The optimal values of <inline-formula><mml:math id="i5"><mml:mi>α</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="i6"><mml:mi>β</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="i7"><mml:mi>γ</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="i8"><mml:mrow><mml:mi mathvariant="italic">ϵ</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>can be found by grid search as detailed in <ext-link ext-link-type="uri" xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2013756118/-/DCSupplemental" xlink:show="new"><italic>SI Appendix</italic>, <italic>Experiment process</italic></ext-link> and exemplified in <ext-link ext-link-type="uri" xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2013756118/-/DCSupplemental" xlink:show="new"><italic>SI Appendix</italic>, Fig. S4</ext-link>. The parameters were searched in the order <inline-formula><mml:math id="i9"><mml:mrow><mml:mi>α</mml:mi><mml:mo>→</mml:mo><mml:mi>β</mml:mi><mml:mo>→</mml:mo><mml:mi>γ</mml:mi><mml:mo>→</mml:mo><mml:mi mathvariant="italic">ϵ</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:math></inline-formula>. The complexity of the grid search depends linearly on the number of parameters. The ranges of parameters where optimal settings were found in our tests are summarized as follows: <inline-formula><mml:math id="i10"><mml:mi>α</mml:mi></mml:math></inline-formula> are in the range of <inline-formula><mml:math id="i11"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0.4</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>0.8</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msup><mml:mi>A</mml:mi><mml:mi>H</mml:mi></mml:msup><mml:mi>D</mml:mi><mml:mi>y</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow><mml:mi mathvariant="italic">ϵ</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="i12"><mml:mi>β</mml:mi></mml:math></inline-formula> are in the range of <inline-formula><mml:math id="i13"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msup><mml:mi>A</mml:mi><mml:mi>H</mml:mi></mml:msup><mml:mi>D</mml:mi><mml:mi>y</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow><mml:mi mathvariant="italic">ϵ</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="i14"><mml:mi>γ</mml:mi></mml:math></inline-formula> are in the range of <inline-formula><mml:math id="i15"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0.05</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>0.2</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="i16"><mml:mrow><mml:mi mathvariant="italic">ϵ</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> are in the range of <inline-formula><mml:math id="i17"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mi mathvariant="italic">ϵ</mml:mi></mml:mrow></mml:math></inline-formula>. These ranges can serve as useful guidance for future applications of OPUS-SSRI to other systems. In practice, a reasonable set of parameters can be obtained with just a few trials.</p>
    <p>It is worth noting that OPUS-SSRI focuses on improving accuracies of pose parameters for each particle in the maximization step, which is complementary to the approach explored by THUNDER that targets other latent variables, such as defocus parameters and class membership. Hence, these two approaches can be readily combined. In fact, accurate determination of pose parameters are the prerequisites for a better per-particle defocus parameter refinement. This is exemplified by the limited improvement of THUNDER on the highly noisy dataset Hrd1/Hrd3, in which the pose of each particle was of large errors (<ext-link ext-link-type="uri" xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2013756118/-/DCSupplemental" xlink:show="new"><italic>SI Appendix</italic>, Figs. S2 and S3</ext-link>), yielding inaccurate reference two-dimensional (2D) projections and adversely affecting the per-particle contrast transfer function (CTF) refinement. Therefore, our OPUS-SSRI might enhance the per-particle CTF refinement on some noisy datasets by improving the pose determination of these datasets.</p>
    <p>Finally, our tests of OPUS-SSRI on seven real datasets support that OPUS-SSRI can greatly improve the resolution of the final density map, thus allowing more accurate building of atomic models. We expect OPUS-SSRI to be an invaluable tool to the general field of cryo-EM single-particle analysis.</p>
  </sec>
  <sec sec-type="materials|methods" id="s3">
    <title>Materials and Methods</title>
    <p content-type="flushleft">We clarify some notations here. For a vector <inline-formula><mml:math id="i18"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="normal">ℝ</mml:mi><mml:mi>N</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, we use <inline-formula><mml:math id="i19"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mi>x</mml:mi><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> to represent the <inline-formula><mml:math id="i20"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> norm of the vector <inline-formula><mml:math id="i21"><mml:mi>x</mml:mi></mml:math></inline-formula>, which is defined as <inline-formula><mml:math id="i22"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mi>x</mml:mi><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mi>p</mml:mi></mml:msup></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. <inline-formula><mml:math id="i23"><mml:mi mathvariant="normal">ℤ</mml:mi></mml:math></inline-formula> represents the set of integers, while <inline-formula><mml:math id="i24"><mml:mi mathvariant="normal">ℝ</mml:mi></mml:math></inline-formula> stands for the set of reals. We use <inline-formula><mml:math id="i25"><mml:mi>x</mml:mi></mml:math></inline-formula> to represent the 3D map, <inline-formula><mml:math id="i26"><mml:mi>V</mml:mi></mml:math></inline-formula> to represent the Fourier transform (FT) of <inline-formula><mml:math id="i27"><mml:mi>x</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="i28"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> to represent the FT of the <inline-formula><mml:math id="i29"><mml:mi>i</mml:mi></mml:math></inline-formula>th image. For simplicity, we often use vector representation for multidimensional data (i.e., a point with multidimensional index <inline-formula><mml:math id="i30"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is mapped to the <inline-formula><mml:math id="i31"><mml:mi>h</mml:mi></mml:math></inline-formula>th component <inline-formula><mml:math id="i32"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> of <inline-formula><mml:math id="i33"><mml:mi>x</mml:mi></mml:math></inline-formula>).</p>
    <sec id="s4">
      <title>Introduction to Cryo-EM Refinement.</title>
      <p>Formally, the FT of 3D map <inline-formula><mml:math id="i34"><mml:mi>V</mml:mi></mml:math></inline-formula> to be reconstructed in cryo-EM refinement can be defined as the maximizer of the penalized log marginal likelihood function (<xref rid="r3" ref-type="bibr">3</xref>) <inline-formula><mml:math id="i35"><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>J</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="i36"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the marginal probability (see <ext-link ext-link-type="uri" xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2013756118/-/DCSupplemental" xlink:show="new"><italic>SI Appendix</italic>, <italic>Log marginal likelihood</italic></ext-link> for derivation) of <inline-formula><mml:math id="i37"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> given map <inline-formula><mml:math id="i38"><mml:mi>V</mml:mi></mml:math></inline-formula> by marginalizing over all hidden variables, such as orientation and translation (pose), and <inline-formula><mml:math id="i39"><mml:mrow><mml:mi>J</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the penalty for <inline-formula><mml:math id="i40"><mml:mi>x</mml:mi></mml:math></inline-formula>, which serves to reduce overfitting and guarantee the feasibility of solution.</p>
      <p>As 3D molecular maps are both sparse and smooth, in order to incorporate these priors into refinement, a mathematical formulation for them must be developed. Conventionally, the smoothness of a function is associated with the norm of its gradient, and sparseness is referred to as the number of zeros in the values of function (<xref rid="r20" ref-type="bibr">20</xref>). In the following subsections, we will formulate different smoothness priors and reveal their differences. The key equations illustrating the effects of the traditional smoothness restraint and our smoothness restraint are <xref ref-type="disp-formula" rid="eq2">Eqs. <bold>2</bold></xref> and <xref ref-type="disp-formula" rid="eq5"><bold>5</bold></xref>, respectively.</p>
    </sec>
    <sec id="s5">
      <title>Traditional Smoothness Prior.</title>
      <p>The traditional method (<xref rid="r5" ref-type="bibr">5</xref>) enforces smoothness by applying a quadratic restraint on the magnitudes of FTs based on the assumption that they are distributed according to Gaussian. Since the traditional method is an instance of Wiener filtering (<xref rid="r21" ref-type="bibr">21</xref>), the restraint strength depends on the SNR. The 3D map reconstructed by the traditional method can be defined as the maximizer of<disp-formula id="eq1"><mml:math id="me1"><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>SNR</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle><mml:mo>,</mml:mo></mml:mrow></mml:math><label>[1]</label></disp-formula></p>
      <p content-type="flushleft">where <inline-formula><mml:math id="i41"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula> is the modulus of the spatial frequency vector of the Fourier coefficient <inline-formula><mml:math id="i42"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="i43"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is the average of weights <inline-formula><mml:math id="i44"><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="eq8">Eq. <bold>8</bold></xref>, and <inline-formula><mml:math id="i45"><mml:mrow><mml:mtext>SNR</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the SNR estimated by gold-standard FSC (<xref rid="r22" ref-type="bibr">22</xref>).</p>
      <p>To understand the effect of the smoothness restraint of the traditional method, we consider the role of the restraint in the gradient ascent iteration, which is of the form<disp-formula id="eq2"><mml:math id="me2"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mo>'</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mfrac><mml:mo>∂</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math><label>[2]</label></disp-formula></p>
      <p content-type="flushleft">where <inline-formula><mml:math id="i46"><mml:mrow><mml:mi>λ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>SNR</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> is the damping weight for <inline-formula><mml:math id="i47"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="i48"><mml:mrow><mml:mi>η</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> is the learning rate. The gradient of the traditional prior <inline-formula><mml:math id="i49"><mml:mrow><mml:mi>λ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> can be viewed as a smoothed map in real space. By convolution theorem, let the inverse FT of <inline-formula><mml:math id="i50"><mml:mrow><mml:mi>λ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> be <inline-formula><mml:math id="i51"><mml:mrow><mml:mi>K</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mi>u</mml:mi><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, which is a radial function. The gradient of traditional prior <inline-formula><mml:math id="i52"><mml:mrow><mml:mi>x</mml:mi><mml:mo>′</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is a convolution in real space, namely, <inline-formula><mml:math id="i53"><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:munder><mml:mo>∫</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="normal">ℝ</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:munder><mml:mrow><mml:mi>K</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>−</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula>, which represents a map smoothed by the translation-invariant isotropic kernel <inline-formula><mml:math id="i54"><mml:mrow><mml:mi>K</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>−</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. At each step, the old solution is modified by a linear combination of the gradient of log marginal likelihood function and the radial-kernel–smoothed old solution. We thus postulate that the traditional method in RELION biases the solution toward the 3D map with homogeneous smoothness across space.</p>
    </sec>
    <sec id="s6">
      <title>Sparseness and Smoothness Priors in OPUS-SSRI.</title>
      <p>Sparseness resembles the idea of masking in the calculation of masked FSC, where the voxels which are below a certain threshold are setting to 0. The similar effects can be achieved by restraining the sum of the absolute values of densities, namely, the <inline-formula><mml:math id="i55"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> norm of the density map (<xref rid="r7" ref-type="bibr">7</xref>) during reconstruction. Hence, we can encode the sparseness using the <inline-formula><mml:math id="i56"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> norm (<xref rid="r7" ref-type="bibr">7</xref>) and the smoothness of 3D map using the TV norm (<xref rid="r8" ref-type="bibr">8</xref>). Though these two priors can effectively guarantee both sparseness and smoothness of the map, they also introduce biases to the final solution (<xref rid="r23" ref-type="bibr">23</xref>). In particular, <inline-formula><mml:math id="i57"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> regularization tends to underestimate true nonzero elements (<xref rid="r23" ref-type="bibr">23</xref>) since the corresponding soft-threshold operator shrinks the volume by a global threshold. Fan et al. discovered that nonconcave penalty can prevent true nonzero elements from being overly shrunk while preserving sparseness (<xref rid="r23" ref-type="bibr">23</xref>). Therefore, we employ a nonconcave penalty log norm (<xref rid="r24" ref-type="bibr">24</xref>) to reduce biases in the solution. The penalized log likelihood function in OPUS-SSRI has the form<disp-formula id="eq3"><mml:math id="me3"><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁡</mml:mo><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="italic">ϵ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo>⁡</mml:mo><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mo>∇</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="italic">ϵ</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>,</mml:mo></mml:mrow></mml:math><label>[3]</label></disp-formula></p>
      <p content-type="flushleft">where <inline-formula><mml:math id="i58"><mml:mi>α</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="i59"><mml:mi>β</mml:mi></mml:math></inline-formula> are positive, and <inline-formula><mml:math id="i60"><mml:mi mathvariant="italic">ϵ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="i61"><mml:mrow><mml:mi mathvariant="italic">ϵ</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> are positive parameters to guard against the singularity of logarithm function at zero.</p>
    </sec>
    <sec id="s7">
      <title>Optimization Methods in OPUS-SSRI.</title>
      <p>This subsection presents the algorithm to optimize the penalized log likelihood in <xref ref-type="disp-formula" rid="eq3">Eq. <bold>3</bold></xref>. First, the log marginal likelihood function can be optimized by the expectation–maximization method (<xref rid="r25" ref-type="bibr">25</xref>) (see <ext-link ext-link-type="uri" xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2013756118/-/DCSupplemental" xlink:show="new"><italic>SI Appendix</italic>, <italic>Expectation maximization</italic></ext-link> for derivation). The reconstruction process alternates between the expectation step in which the distribution of pose parameters for each particle is determined and the maximization step in which the 3D map is reconstructed. Secondly, to address the nonconcavity of log norm, we approximate the logarithm function by concave function and iteratively improve the approximation (<xref rid="r24" ref-type="bibr">24</xref>) at each maximization step (see <ext-link ext-link-type="uri" xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2013756118/-/DCSupplemental" xlink:show="new"><italic>SI Appendix</italic>, <italic>Weighted approximation</italic></ext-link> for derivation). Lastly, to average 3D maps reconstructed in consecutive maximization steps, we consider leveraging implicit gradient ascent (<xref rid="r26" ref-type="bibr">26</xref>), which is a widely used technique to improve the stability of optimization method. The implicit gradient ascent restrains the Euclidean distance between the new solution and the 3D map of previous maximization step <inline-formula><mml:math id="i62"><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. These choices yield a target function in <xref ref-type="disp-formula" rid="eq4">Eq. <bold>4</bold></xref> by optimizing which can improve <xref ref-type="disp-formula" rid="eq3">Eq. <bold>3</bold></xref> (<xref rid="r24" ref-type="bibr">24</xref>). Formally, at the <inline-formula><mml:math id="i63"><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>th iteration of the <inline-formula><mml:math id="i64"><mml:mi>k</mml:mi></mml:math></inline-formula>th maximization step, let the solution obtained in the previous iteration be <inline-formula><mml:math id="i65"><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>. We approximate <xref ref-type="disp-formula" rid="eq3">Eq. <bold>3</bold></xref> with the expected log likelihood (the first term in <xref ref-type="disp-formula" rid="eq4">Eq. <bold>4</bold></xref>) and the weighted <inline-formula><mml:math id="i66"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and TV norms and define the solution at iteration <inline-formula><mml:math id="i67"><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> as the maximizer of the following equation:<disp-formula id="eq4"><mml:math id="me4"><mml:mrow><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:munder><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>ϕ</mml:mi></mml:munder><mml:mrow><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mtext>CTF</mml:mtext></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:msup><mml:mi>P</mml:mi><mml:mi>ϕ</mml:mi></mml:msup><mml:mi>V</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mfrac><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="italic">ϵ</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mo>∇</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mo>∇</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="italic">ϵ</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mi>γ</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mstyle><mml:mo>,</mml:mo></mml:mrow></mml:math><label>[4]</label></disp-formula></p>
      <p content-type="flushleft">where <inline-formula><mml:math id="i68"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the conditional probability of the pose parameters given the observation <inline-formula><mml:math id="i69"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and the map <inline-formula><mml:math id="i70"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> from the previous maximization step, and <inline-formula><mml:math id="i71"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> is the weight of the implicit gradient ascent penalty. The effect of log norm becomes evident after converting it to the weighted norm in <xref ref-type="disp-formula" rid="eq4">Eq. <bold>4</bold></xref>. Reweighting each voxel yields a spatially varying threshold (<xref ref-type="disp-formula" rid="eq6">Eq. <bold>6</bold></xref>), which can reduce the bias of prior. Next, we will demonstrate that the gradient of TV norm enforces heterogenous smoothness to the 3D map, and the <inline-formula><mml:math id="i72"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> norm achieves sparseness by the soft-thresholding rule while presenting the optimization algorithm.</p>
      <p>Though TV norm is nondifferentiable at zero, we can approximate its gradient by Nesterov smoothing (<xref rid="r27" ref-type="bibr">27</xref>). The approximate gradient of TV norm at a voxel <inline-formula><mml:math id="i73"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (see <ext-link ext-link-type="uri" xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2013756118/-/DCSupplemental" xlink:show="new"><italic>SI Appendix</italic>, <italic>Nesterov smoothed TV norm</italic></ext-link> for derivation) is of the form<disp-formula id="eq5"><mml:math id="me5"><mml:mrow><mml:mo>∇</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:munderover><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>±</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mo>'</mml:mo></mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>±</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>,</mml:mo></mml:mrow></mml:math><label>[5]</label></disp-formula></p>
      <p content-type="flushleft">where <inline-formula><mml:math id="i74"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is a 1 × 3 vector with 1 on the <inline-formula><mml:math id="i75"><mml:mi>a</mml:mi></mml:math></inline-formula>th entry and zeros elsewhere, <inline-formula><mml:math id="i76"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:msubsup><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mo>∇</mml:mo><mml:mi>x</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mi>μ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:munderover><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mo>∇</mml:mo><mml:mi>x</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mi>μ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="i77"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mo>'</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mo>∇</mml:mo><mml:mi>x</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mi>μ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="i78"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mo>'</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mo>∇</mml:mo><mml:mi>x</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mi>μ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="i79"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mo>∇</mml:mo><mml:mi>x</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mi>μ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mo>∇</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="italic">ϵ</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mo>∇</mml:mo><mml:mi>x</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="i80"><mml:mi>μ</mml:mi></mml:math></inline-formula> is the Nesterov smoothing parameter. The gradient of the smoothed TV norm at the voxel <inline-formula><mml:math id="i81"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> depends on the gradients at this voxel and its neighboring voxels <inline-formula><mml:math id="i82"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>±</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Specifically, the voxel on the direction with smaller gradient has a larger contribution to the gradient of TV norm. We can write the continuous form of <xref ref-type="disp-formula" rid="eq5">Eq. <bold>5</bold></xref> as <inline-formula><mml:math id="i83"><mml:mrow><mml:mi>x</mml:mi><mml:mo>′</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:munder><mml:mo>∫</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="normal">ℝ</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:munder><mml:mrow><mml:mi>K</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula>, where the kernel <inline-formula><mml:math id="i84"><mml:mrow><mml:mi>K</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> depends on the voxel <inline-formula><mml:math id="i85"><mml:mi>u</mml:mi></mml:math></inline-formula> and its neighboring voxel <inline-formula><mml:math id="i86"><mml:mi>v</mml:mi></mml:math></inline-formula> simultaneously. Therefore, the weighted TV norm smooths the map by a spatially varying anisotropic kernel <inline-formula><mml:math id="i87"><mml:mrow><mml:mi>K</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, which adapts to heterogenous smoothness in the 3D map.</p>
      <p>The differentiable function with <inline-formula><mml:math id="i88"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> penalty can be optimized by a joint application of gradient ascent and soft-thresholding operator (<xref rid="r28" ref-type="bibr">28</xref>). Denote the implicit gradient-restrained expected log likelihood <inline-formula><mml:math id="i89"><mml:mrow><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mtext>CTF</mml:mtext></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mi>P</mml:mi><mml:mi>ϕ</mml:mi></mml:msup><mml:mi>V</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mfrac><mml:mi>γ</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula> as <inline-formula><mml:math id="i90"><mml:mrow><mml:mi>h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>and the weight <inline-formula><mml:math id="i91"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="italic">ϵ</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> as <inline-formula><mml:math id="i92"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, and let the learning rate be <inline-formula><mml:math id="i93"><mml:mi>η</mml:mi></mml:math></inline-formula> for the <inline-formula><mml:math id="i94"><mml:mi>j</mml:mi></mml:math></inline-formula>th component of <inline-formula><mml:math id="i95"><mml:mi>x</mml:mi></mml:math></inline-formula> at <inline-formula><mml:math id="i96"><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> iteration. <xref ref-type="disp-formula" rid="eq4">Eq. <bold>4</bold></xref> can be optimized by the following equation:<disp-formula id="eq6"><mml:math id="me6"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>'</mml:mo><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>η</mml:mi><mml:mi>α</mml:mi><mml:msub><mml:mi>w</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>'</mml:mo><mml:mo>−</mml:mo><mml:mi>η</mml:mi><mml:mi>α</mml:mi><mml:msub><mml:mi>w</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>'</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>'</mml:mo><mml:mo>|</mml:mo><mml:mo>≥</mml:mo><mml:mi>η</mml:mi><mml:mi>α</mml:mi><mml:msub><mml:mi>w</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math><label>[6]</label></disp-formula></p>
      <p content-type="flushleft">where <inline-formula><mml:math id="i97"><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mo>'</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>∇</mml:mo><mml:mi>h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mo>∇</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the 3D map updated by gradient ascent, and <inline-formula><mml:math id="i98"><mml:mrow><mml:mtext>sign</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> extracts the sign of a voxel value. <xref ref-type="disp-formula" rid="eq6">Eq. <bold>6</bold></xref> is referred to as the soft-thresholding operator. The sparseness of the volume is preserved by the soft-thresholding operator since it sets the voxels with relatively small values to zeros. Moreover, the threshold <inline-formula><mml:math id="i99"><mml:mrow><mml:mi>η</mml:mi><mml:mi>α</mml:mi><mml:msub><mml:mi>w</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is inversely proportional to the strength of the voxel. Therefore, the voxels with small values are more likely to be shrunk to 0 s. Since the values of electron densities for molecules are often higher than the background noises, this soft-thresholding operator can suppress noises while leaving the electron densities of molecules intact. We hence demonstrate how our <inline-formula><mml:math id="i100"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> restraint yields an unbiased cleaner 3D map.</p>
      <p>In summary, <xref ref-type="disp-formula" rid="eq6">Eq. <bold>6</bold></xref> is applied iteratively in the maximization step. The gradient of the TV norm enforces spatially varying smoothness in gradient ascent, while the soft-thresholding operator induced by the weighted <inline-formula><mml:math id="i101"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> norm guarantees the sparseness of the 3D map. In all of our experiments, convergences were achieved in a maximization step after 100 iterations.</p>
    </sec>
    <sec id="s8">
      <title>Back-Projection as Local Kernel Regression.</title>
      <p>To reconstruct the 3D map, cryo-EM researchers introduced a back-projection operator, which puts the 2D FT of the image into the 3D map. As the inverse of slice operator <inline-formula><mml:math id="i102"><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mi>ϕ</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> (<ext-link ext-link-type="uri" xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2013756118/-/DCSupplemental" xlink:show="new"><italic>SI Appendix</italic>, Eq. <bold>S2</bold></ext-link>), back-projection puts the data with 2D index <inline-formula><mml:math id="i103"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to the 3D index <inline-formula><mml:math id="i104"><mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> according to <inline-formula><mml:math id="i105"><mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>R</mml:mi><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="i106"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is the inverse of the rotation matrix parameterized by orientation parameter <inline-formula><mml:math id="i107"><mml:mi>ϕ</mml:mi></mml:math></inline-formula>. Back-projection prompts us to create a 3D volume to store the data on nonintegral indices <inline-formula><mml:math id="i108"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="normal">ℝ</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> if the orientation <inline-formula><mml:math id="i109"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> is randomly sampled, while the indices of the 3D map operated in computer memory are integral, namely, <inline-formula><mml:math id="i110"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="normal">ℤ</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>. Therefore, the limitation of computer memory prevents us from storing the voxel of the back-projected 2D slice <inline-formula><mml:math id="i111"><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>ϕ</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> in the 3D map <inline-formula><mml:math id="i112"><mml:mi>V</mml:mi></mml:math></inline-formula>. Nonparametric regression can be leveraged to eliminate this discrepancy by storing weighted back-projected data on integral grids (<xref rid="r29" ref-type="bibr">29</xref>). Using local kernel regression (see <ext-link ext-link-type="uri" xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2013756118/-/DCSupplemental" xlink:show="new"><italic>SI Appendix</italic>, <italic>Local kernel regression</italic></ext-link> for derivation), the expected log likelihood can be written as<disp-formula id="eq7"><mml:math id="me7"><mml:mrow><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>ϕ</mml:mi></mml:munder><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi><mml:mtext>|</mml:mtext><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>K</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mtext>CTF</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>V</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle><mml:mo>,</mml:mo></mml:mrow></mml:math><label>[7]</label></disp-formula></p>
      <p content-type="flushleft">where <inline-formula><mml:math id="i113"><mml:mi>K</mml:mi></mml:math></inline-formula> is the kernel, <inline-formula><mml:math id="i114"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is a voxel back-projected with parameter <inline-formula><mml:math id="i115"><mml:mi>ϕ</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="i116"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="normal">ℤ</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> is the voxel storing the kernel-weighted back-projected data. Hence, in contrast to the first term in <xref ref-type="disp-formula" rid="eq4">Eq. <bold>4</bold></xref>, this new formulation decouples the slice operator from <inline-formula><mml:math id="i117"><mml:mi>V</mml:mi></mml:math></inline-formula> and has variables <inline-formula><mml:math id="i118"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> on integral grids.</p>
      <p>OPUS-SSRI used Gaussian kernel, which is of the form <inline-formula><mml:math id="i119"><mml:mrow><mml:mi>K</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. We set the bandwidth <inline-formula><mml:math id="i120"><mml:mi>σ</mml:mi></mml:math></inline-formula> of the Gaussian kernel to be <inline-formula><mml:math id="i121"><mml:mrow><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mrow></mml:math></inline-formula> in our implementation of OPUS-SSRI. For practical consideration, a Fourier coefficient <inline-formula><mml:math id="i122"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> cannot be scattered to every voxel. Since the Gaussian kernel is quickly diminishing, we let <inline-formula><mml:math id="i123"><mml:mrow><mml:mrow><mml:mo>〚</mml:mo><mml:mo>⋅</mml:mo><mml:mo>〛</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> be the round operator, and we consider storing <inline-formula><mml:math id="i124"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> with the index <inline-formula><mml:math id="i125"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> on the neighboring voxels <inline-formula><mml:math id="i126"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mrow><mml:mo>〚</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>〛</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mrow><mml:mo>〚</mml:mo><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>〛</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="i127"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>±</mml:mo><mml:mn>1</mml:mn><mml:mo> </mml:mo><mml:mtext>or</mml:mtext><mml:mo> </mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. In the original implementation of RELION (<xref rid="r5" ref-type="bibr">5</xref>), they chose a kernel with trilinear interpolation–like weight. Using the formalism introduced before, their kernel functions are of the form <inline-formula><mml:math id="i128"><mml:mrow><mml:mi>K</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>w</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>w</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>w</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="i129"><mml:mrow><mml:mi>w</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>x</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>x</mml:mi><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="i130"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mo>⌊</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>⌋</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>⌈</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>⌉</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="i131"><mml:mrow><mml:mrow><mml:mo>⌊</mml:mo><mml:mo>⋅</mml:mo><mml:mo>⌋</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="i132"><mml:mrow><mml:mrow><mml:mo>⌈</mml:mo><mml:mo>⋅</mml:mo><mml:mo>⌉</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are the floor and ceiling operator, respectively. Hence, a Fourier coefficient is scattered to eight neighboring voxels in the original implementation of RELION (<xref rid="r5" ref-type="bibr">5</xref>).</p>
      <p><xref ref-type="disp-formula" rid="eq7">Eq. 7</xref> has a closed form solution,<disp-formula id="eq8"><mml:math id="me8"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:msubsup><mml:mrow><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mi>ϕ</mml:mi></mml:msub><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi><mml:mtext>|</mml:mtext><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>K</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mtext>CTF</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math><label>[8]</label></disp-formula></p>
      <p content-type="flushleft">with <inline-formula><mml:math id="i133"><mml:mi>N</mml:mi><mml:mfenced><mml:mi>n</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mstyle displaystyle="false"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover></mml:mstyle><mml:mstyle displaystyle="false"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:munderover></mml:mstyle><mml:mstyle displaystyle="false"><mml:munder><mml:mo>∑</mml:mo><mml:mi>ϕ</mml:mi></mml:munder></mml:mstyle><mml:mi>P</mml:mi><mml:mfenced><mml:mrow><mml:mi>ϕ</mml:mi><mml:mtext>|</mml:mtext><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi>K</mml:mi><mml:mfenced><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mfenced><mml:mi>ϕ</mml:mi></mml:mfenced><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfenced><mml:msubsup><mml:mtext>CTF</mml:mtext><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>. Ignoring regularization terms, local kernel regression estimates the value of a voxel <inline-formula><mml:math id="i134"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> by an integral between the kernel <inline-formula><mml:math id="i135"><mml:mi>K</mml:mi></mml:math></inline-formula> and neighboring experimental data <inline-formula><mml:math id="i136"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>′</mml:mo><mml:mi>k</mml:mi><mml:mo>′</mml:mo><mml:mi>l</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi><mml:mtext>|</mml:mtext><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mtext>CTF</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="i137"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>Π</mml:mtext><mml:mstyle displaystyle="true"><mml:mrow><mml:munder><mml:mo>∫</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>′</mml:mo><mml:mi>k</mml:mi><mml:mo>′</mml:mo><mml:mi>l</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:mi>K</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>n</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>′</mml:mo><mml:mi>k</mml:mi><mml:mo>′</mml:mo><mml:mi>l</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:mi>h</mml:mi><mml:mo>′</mml:mo><mml:mi>d</mml:mi><mml:mi>k</mml:mi><mml:mo>′</mml:mo><mml:mi>d</mml:mi><mml:mi>l</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="i138"><mml:mtext>Π</mml:mtext></mml:math></inline-formula> is the normalizing factor. This convolution projects <inline-formula><mml:math id="i139"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mo>'</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> into the RKHS associated with the given kernel according to the representer theorem (<xref rid="bib34" ref-type="bibr">9</xref>), thus enforcing <inline-formula><mml:math id="i140"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> to exhibit the smoothness of the RKHS induced by that kernel.</p>
    </sec>
    <sec id="s9">
      <title>OPUS-SSRI Implementation.</title>
      <p>The implementation of OPUS-SSRI is based on RELION. The 3D refinement program in RELION consists of two modules, expectation and maximization. We implemented our method as a new routine in its maximization module. Therefore, when performing refinement, the expectation steps of RELION (<xref rid="r5" ref-type="bibr">5</xref>) and OPUS-SSRI use exactly the same settings. The gradient calculation and soft-thresholding operators are implemented with CUDA, thus allowing fast maximization.</p>
    </sec>
    <sec id="s10">
      <title>Gold-Standard FSC.</title>
      <p>The gold-standard FSC is the FSC between two independently refined half maps <italic>F</italic> and <italic>G</italic> (<xref rid="r22" ref-type="bibr">22</xref>). The gold-standard FSC of Fourier coefficients at shell <inline-formula><mml:math id="i141"><mml:mi>k</mml:mi></mml:math></inline-formula> relates to the SNR through <inline-formula><mml:math id="i142"><mml:mrow><mml:mtext>FSC</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>SNR</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mtext>SNR</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, as noises inside two maps are independent (<xref rid="r30" ref-type="bibr">30</xref>). The frequency where the gold-standard FSC passes through 0.143 is denoted as the estimated resolution of the reconstruction. A high-resolution noise substitution method is often used to correct effects of masking in the masked FSC (<xref rid="r30" ref-type="bibr">30</xref>).</p>
    </sec>
    <sec id="s11">
      <title>Model versus Map FSC.</title>
      <p>If there exists a high-resolution atomic structural model, we can validate the cryo-EM map by comparing it to this atomic model. The first step in calculating the model versus map FSC is fitting the atomic model into the cryo-EM density map. The model map is constructed from the fitted atomic model by sampling on the same grid as the experimental map. The model versus map FSC (<xref rid="r31" ref-type="bibr">31</xref>) is the correlation between the FT of the model map and the FT of cryo-EM map. The point where the model versus map FSC approaches 0.143 can be regarded as the resolution of the experimental map.</p>
    </sec>
    <sec id="s12">
      <title>Refinement Protocol.</title>
      <p>The single-particle datasets used in this paper were obtained from either the deposited particle stack or the coordinate files. In all experiments, we built the initial maps ab initio in RELION 3.0 and refined those initial maps using the three methods to be compared. The initial map building began with one round of 2D classification in RELION 3.0. The particles belonging to the major classes were then selected to build the initial map ab initio using the 3D classification procedure in RELION 3.0. The same low-pass–filtered initial maps were subsequently supplied into the three methods, RELION 3.0, THUNDER, and OPUS-SSRI, for refinement. For the datasets with specific symmetry, the symmetry was enforced throughout the refinement process. For RELION 3.0 and OPUS-SSRI, we also used the same convergence criteria [i.e., no resolution improvement and pose changes for the last two iterations (<xref rid="r5" ref-type="bibr">5</xref>)]. In THUNDER, the particle grading and CTF search options were set as “True” for better results. Finally, the gold-standard FSC calculations and density map postprocessing of the refinement results of all methods were carried out in RELION 3.0. In the postprocessing step, the mask was created from the final reconstruction using all particles in the 3D refinement procedure. Using <italic>relion_postprocess</italic> (<xref rid="r30" ref-type="bibr">30</xref>), we obtained gold-standard FSCs and the postprocessed map from independent maps by correcting the modulation transfer function of the detector and sharpening with automatically estimated <italic>B</italic>-factors. We then compared the postprocessed map with respect to the corresponding published atomic model(s) by calculating model versus map FSC using <italic>Phenix.Mtriage</italic> (<xref rid="r32" ref-type="bibr">32</xref>). Before comparison, the atomic model was fitted into the postprocessed density maps reconstructed by different methods using the rigid-body fit in <italic>Chimera</italic> (<xref rid="r33" ref-type="bibr">33</xref>).</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data">
      <label>Supplementary File</label>
      <media xlink:href="pnas.2013756118.sapp.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>J.M. acknowledges support from the NIH (R01-GM127628 and R01-GM116280) and the Welch Foundation (Q-1512). Q.W. acknowledges support from the NIH (R01-GM127628 and R01-GM116280) and the Welch Foundation (Q-1826). A.A.C.-A. was partially supported by a training fellowship from the Computational Cancer Biology Training Program of the Gulf Coast Consortia (Cancer Prevention and Research Institute of Texas [CPRIT] Grant No. RP170593).</p>
  </ack>
  <fn-group>
    <fn fn-type="COI-statement">
      <p>The authors declare no competing interest.</p>
    </fn>
    <fn fn-type="other">
      <p>This article is a PNAS Direct Submission.</p>
    </fn>
    <fn fn-type="supplementary-material">
      <p>This article contains supporting information online at <ext-link ext-link-type="uri" xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2013756118/-/DCSupplemental" xlink:show="new">https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2013756118/-/DCSupplemental</ext-link>.</p>
    </fn>
  </fn-group>
  <sec id="s13" sec-type="data-availability">
    <title>Data Availability.</title>
    <p>The implementation of OPUS-SSRI can be found at GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/alncat/cryoem" xlink:show="new">https://github.com/alncat/cryoem</ext-link>). All other study data are included in the article and supporting information.</p>
  </sec>
  <ref-list>
    <ref id="r1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Glaeser</surname><given-names>R. M.</given-names></name></person-group>, <article-title>Limitations to significant information in biological electron microscopy as a result of radiation damage</article-title>. <source>J. Ultrastruct. Res.</source><volume>36</volume>, <fpage>466</fpage>–<lpage>482</lpage> (<year>1971</year>).<pub-id pub-id-type="pmid">5107051</pub-id></mixed-citation>
    </ref>
    <ref id="r2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Glaeser</surname><given-names>R. M.</given-names></name></person-group>, <article-title>How good can cryo-EM become?</article-title><source>Nat. Methods</source><volume>13</volume>, <fpage>28</fpage>–<lpage>32</lpage> (<year>2016</year>).<pub-id pub-id-type="pmid">26716559</pub-id></mixed-citation>
    </ref>
    <ref id="r3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Scheres</surname><given-names>S. H.</given-names></name></person-group>, <article-title>A Bayesian view on cryo-EM structure determination</article-title>. <source>J. Mol. Biol.</source><volume>415</volume>, <fpage>406</fpage>–<lpage>418</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22100448</pub-id></mixed-citation>
    </ref>
    <ref id="r4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sindelar</surname><given-names>C. V.</given-names></name>, <name name-style="western"><surname>Grigorieff</surname><given-names>N.</given-names></name></person-group>, <article-title>An adaptation of the Wiener filter suitable for analyzing images of isolated single particles</article-title>. <source>J. Struct. Biol.</source><volume>176</volume>, <fpage>60</fpage>–<lpage>74</lpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21757012</pub-id></mixed-citation>
    </ref>
    <ref id="r5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Scheres</surname><given-names>S. H.</given-names></name></person-group>, <article-title>RELION: Implementation of a bayesian approach to cryo-EM structure determination</article-title>. <source>J. Struct. Biol.</source><volume>180</volume>, <fpage>519</fpage>–<lpage>530</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">23000701</pub-id></mixed-citation>
    </ref>
    <ref id="r6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hu</surname><given-names>M.</given-names></name><etal/></person-group>, <article-title>A particle-filter framework for robust cryo-EM 3D reconstruction</article-title>. <source>Nat. Methods</source><volume>15</volume>, <fpage>1083</fpage>–<lpage>1089</lpage> (<year>2018</year>).<pub-id pub-id-type="pmid">30504871</pub-id></mixed-citation>
    </ref>
    <ref id="r7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tibshirani</surname><given-names>R.</given-names></name></person-group>, <article-title>Regression shrinkage and selection via the lasso</article-title>. <source>J. R. Stat. Soc. B</source><volume>58</volume>, <fpage>267</fpage>–<lpage>288</lpage> (<year>1996</year>).</mixed-citation>
    </ref>
    <ref id="r8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rudin</surname><given-names>L. I.</given-names></name>, <name name-style="western"><surname>Osher</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Fatemi</surname><given-names>E.</given-names></name></person-group>, <article-title>Nonlinear total variation based noise removal algorithms</article-title>. <source>Phys. Nonlinear Phenom.</source><volume>60</volume>, <fpage>259</fpage>–<lpage>268</lpage> (<year>1992</year>).</mixed-citation>
    </ref>
    <ref id="bib34">
      <label>9</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Schölkopf</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Herbrich</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Smola</surname><given-names>A. J.</given-names></name></person-group>, “<chapter-title>A generalized representer theorem</chapter-title>” in <source>International Conference on Computational Learning Theory</source>, <person-group person-group-type="editor"><name name-style="western"><surname>Helmbold</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Williamson</surname><given-names>B.</given-names></name></person-group>, Eds. (<publisher-name>Springer</publisher-name>, <year>2001</year>), pp. <fpage>416</fpage>–<lpage>426</lpage>.</mixed-citation>
    </ref>
    <ref id="r10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Scheres</surname><given-names>S. H.</given-names></name></person-group>, <article-title>Semi-automated selection of cryo-EM particles in RELION-1.3</article-title>. <source>J. Struct. Biol.</source><volume>189</volume>, <fpage>114</fpage>–<lpage>122</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">25486611</pub-id></mixed-citation>
    </ref>
    <ref id="r11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Vinothkumar</surname><given-names>K. R.</given-names></name>, <name name-style="western"><surname>McMullan</surname><given-names>G.</given-names></name>, <name name-style="western"><surname>Henderson</surname><given-names>R.</given-names></name></person-group>, <article-title>Molecular mechanism of antibody-mediated activation of β-galactosidase</article-title>. <source>Structure</source><volume>22</volume>, <fpage>621</fpage>–<lpage>627</lpage> (<year>2014</year>).<pub-id pub-id-type="pmid">24613486</pub-id></mixed-citation>
    </ref>
    <ref id="r12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bai</surname><given-names>X.</given-names></name>, <name name-style="western"><surname>Fernandez</surname><given-names>I. S.</given-names></name>, <name name-style="western"><surname>McMullan</surname><given-names>G.</given-names></name>, <name name-style="western"><surname>Scheres</surname><given-names>S. H.</given-names></name></person-group>, <article-title>Ribosome structures to near-atomic resolution from thirty thousand cryo-EM particles</article-title>. <source>elife</source><volume>2</volume>, <fpage>e00461</fpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23427024</pub-id></mixed-citation>
    </ref>
    <ref id="r13">
      <label>13</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tan</surname><given-names>Y. Z.</given-names></name><etal/></person-group>, <article-title>Addressing preferred specimen orientation in single-particle cryo-EM through tilting</article-title>. <source>Nat. Methods</source><volume>14</volume>, <fpage>793</fpage>–<lpage>796</lpage> (<year>2017</year>).<pub-id pub-id-type="pmid">28671674</pub-id></mixed-citation>
    </ref>
    <ref id="r14">
      <label>14</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Autzen</surname><given-names>H. E.</given-names></name><etal/></person-group>, <article-title>Structure of the human TRPM4 ion channel in a lipid nanodisc</article-title>. <source>Science</source><volume>359</volume>, <fpage>228</fpage>–<lpage>232</lpage> (<year>2018</year>).<pub-id pub-id-type="pmid">29217581</pub-id></mixed-citation>
    </ref>
    <ref id="r15">
      <label>15</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schoebel</surname><given-names>S.</given-names></name><etal/></person-group>, <article-title>Cryo-EM structure of the protein-conducting ERAD channel Hrd1 in complex with Hrd3</article-title>. <source>Nature</source><volume>548</volume>, <fpage>352</fpage>–<lpage>355</lpage> (<year>2017</year>).<pub-id pub-id-type="pmid">28682307</pub-id></mixed-citation>
    </ref>
    <ref id="r16">
      <label>16</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dang</surname><given-names>S.</given-names></name><etal/></person-group>, <article-title>Structural insight into TRPV5 channel function and modulation</article-title>. <source>Proc. Natl. Acad. Sci. U.S.A.</source><volume>116</volume>, <fpage>8869</fpage>–<lpage>8878</lpage> (<year>2019</year>).<pub-id pub-id-type="pmid">30975749</pub-id></mixed-citation>
    </ref>
    <ref id="r17">
      <label>17</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dang</surname><given-names>S.</given-names></name><etal/></person-group>, <article-title>Cryo-EM structures of the TMEM16A calcium-activated chloride channel</article-title>. <source>Nature</source><volume>552</volume>, <fpage>426</fpage>–<lpage>429</lpage> (<year>2017</year>).<pub-id pub-id-type="pmid">29236684</pub-id></mixed-citation>
    </ref>
    <ref id="r18">
      <label>18</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Emsley</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Cowtan</surname><given-names>K.</given-names></name></person-group>, <article-title>Coot: Model-building tools for molecular graphics</article-title>. <source>Acta Crystallogr. D Biol. Crystallogr.</source><volume>60</volume>, <fpage>2126</fpage>–<lpage>2132</lpage> (<year>2004</year>).<pub-id pub-id-type="pmid">15572765</pub-id></mixed-citation>
    </ref>
    <ref id="r19">
      <label>19</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Adams</surname><given-names>P. D.</given-names></name><etal/></person-group>, <article-title>PHENIX: A comprehensive python-based system for macromolecular structure solution</article-title>. <source>Acta Crystallogr. D Biol. Crystallogr.</source><volume>66</volume>, <fpage>213</fpage>–<lpage>221</lpage> (<year>2010</year>).<pub-id pub-id-type="pmid">20124702</pub-id></mixed-citation>
    </ref>
    <ref id="r20">
      <label>20</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Hastie</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Tibshirani</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Wainwright</surname><given-names>M.</given-names></name></person-group>, <source>Statistical Learning with Sparsity: The Lasso and Generalizations</source> (<publisher-name>CRC press</publisher-name>, <year>2015</year>).</mixed-citation>
    </ref>
    <ref id="r21">
      <label>21</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Candes</surname><given-names>E. J.</given-names></name></person-group>, <article-title>Modern statistical estimation via oracle inequalities</article-title>. <source>Acta Numer.</source><volume>15</volume>, <fpage>257</fpage>–<lpage>325</lpage> (<year>2006</year>).</mixed-citation>
    </ref>
    <ref id="r22">
      <label>22</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Scheres</surname><given-names>S. H.</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>S.</given-names></name></person-group>, <article-title>Prevention of overfitting in cryo-EM structure determination</article-title>. <source>Nat. Methods</source><volume>9</volume>, <fpage>853</fpage>–<lpage>854</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22842542</pub-id></mixed-citation>
    </ref>
    <ref id="r23">
      <label>23</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fan</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>R.</given-names></name></person-group>, <article-title>Variable selection via nonconcave penalized likelihood and its oracle properties</article-title>. <source>J. Am. Stat. Assoc.</source><volume>96</volume>, <fpage>1348</fpage>–<lpage>1360</lpage> (<year>2001</year>).</mixed-citation>
    </ref>
    <ref id="r24">
      <label>24</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Candes</surname><given-names>E. J.</given-names></name>, <name name-style="western"><surname>Wakin</surname><given-names>M. B.</given-names></name>, <name name-style="western"><surname>Boyd</surname><given-names>S. P.</given-names></name></person-group>, <article-title>Enhancing sparsity by reweighted <italic>ℓ</italic> 1 minimization</article-title>. <source>J. Fourier Anal. Appl.</source><volume>14</volume>, <fpage>877</fpage>–<lpage>905</lpage> (<year>2008</year>).</mixed-citation>
    </ref>
    <ref id="r25">
      <label>25</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dempster</surname><given-names>A. P.</given-names></name>, <name name-style="western"><surname>Laird</surname><given-names>N. M.</given-names></name>, <name name-style="western"><surname>Rubin</surname><given-names>D. B.</given-names></name></person-group>, <article-title>Maximum likelihood from incomplete data via the EM algorithm</article-title>. <source>J. R. Stat. Soc. B</source><volume>39</volume>, <fpage>1</fpage>–<lpage>22</lpage> (<year>1977</year>).</mixed-citation>
    </ref>
    <ref id="r26">
      <label>26</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Toulis</surname><given-names>P.</given-names></name></person-group>, “<article-title>Implicit methods for iterative estimation with large data sets</article-title>,” Doctoral dissertation, Graduate School of Arts &amp; Sciences, Harvard University, Cambridge, MA (<year>2016</year>).</mixed-citation>
    </ref>
    <ref id="r27">
      <label>27</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nesterov</surname><given-names>Y.</given-names></name></person-group>, <article-title>Smooth minimization of non-smooth functions</article-title>. <source>Math. Program.</source><volume>103</volume>, <fpage>127</fpage>–<lpage>152</lpage> (<year>2005</year>).</mixed-citation>
    </ref>
    <ref id="r28">
      <label>28</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Parikh</surname><given-names>N.</given-names></name>, <name name-style="western"><surname>Boyd</surname><given-names>S.</given-names></name></person-group>, <article-title>Proximal algorithms</article-title>. <source>Found. Trends Optim.</source><volume>1</volume>, <fpage>127</fpage>–<lpage>239</lpage> (<year>2014</year>).</mixed-citation>
    </ref>
    <ref id="r29">
      <label>29</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Takeda</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Farsiu</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Milanfar</surname><given-names>P.</given-names></name></person-group>, <article-title>Kernel regression for image processing and reconstruction</article-title>. <source>IEEE Trans. Image Process.</source><volume>16</volume>, <fpage>349</fpage>–<lpage>366</lpage> (<year>2007</year>).<pub-id pub-id-type="pmid">17269630</pub-id></mixed-citation>
    </ref>
    <ref id="r30">
      <label>30</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chen</surname><given-names>S.</given-names></name><etal/></person-group>, <article-title>High-resolution noise substitution to measure overfitting and validate resolution in 3D structure determination by single particle electron cryomicroscopy</article-title>. <source>Ultramicroscopy</source><volume>135</volume>, <fpage>24</fpage>–<lpage>35</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23872039</pub-id></mixed-citation>
    </ref>
    <ref id="r31">
      <label>31</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bränd’en</surname><given-names>C.-I.</given-names></name>, <name name-style="western"><surname>Alwyn Jones</surname><given-names>T.</given-names></name></person-group>, <article-title>Between objectivity and subjectivity</article-title>. <source>Nature</source><volume>343</volume>, <fpage>687</fpage>–<lpage>689</lpage> (<year>1990</year>).</mixed-citation>
    </ref>
    <ref id="r32">
      <label>32</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Afonine</surname><given-names>P. V.</given-names></name><etal/></person-group>, <article-title>New tools for the analysis and validation of cryo-EM maps and atomic models</article-title>. <source>Acta Crystallogr. D Struct. Biol.</source><volume>74</volume>, <fpage>814</fpage>–<lpage>840</lpage> (<year>2018</year>).<pub-id pub-id-type="pmid">30198894</pub-id></mixed-citation>
    </ref>
    <ref id="r33">
      <label>33</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pettersen</surname><given-names>E. F.</given-names></name><etal/></person-group>, <article-title>UCSF Chimera–A visualization system for exploratory research and analysis</article-title>. <source>J. Comput. Chem.</source><volume>25</volume>, <fpage>1605</fpage>–<lpage>1612</lpage> (<year>2004</year>).<pub-id pub-id-type="pmid">15264254</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
