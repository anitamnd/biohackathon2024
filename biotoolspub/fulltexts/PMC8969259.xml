<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8969259</article-id>
    <article-id pub-id-type="publisher-id">4643</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-022-04643-9</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Clustering biological sequences with dynamic sequence similarity threshold</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Chiu</surname>
          <given-names>Jimmy Ka Ho</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Ong</surname>
          <given-names>Rick Twee-Hee</given-names>
        </name>
        <address>
          <email>ephoth@nus.edu.sg</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.4280.e</institution-id><institution-id institution-id-type="ISNI">0000 0001 2180 6431</institution-id><institution>Saw Swee Hock School of Public Health, </institution><institution>National University of Singapore and National University Health System, </institution></institution-wrap>Singapore, 117549 Singapore </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>30</day>
      <month>3</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>3</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>108</elocation-id>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>3</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>2</day>
        <month>3</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Biological sequence clustering is a complicated data clustering problem owing to the high computation costs incurred for pairwise sequence distance calculations through sequence alignments, as well as difficulties in determining parameters for deriving robust clusters. While current approaches are successful in reducing the number of sequence alignments performed, the generated clusters are based on a single sequence identity threshold applied to every cluster. Poor choices of this identity threshold would thus lead to low quality clusters. There is however little support provided to users in selecting thresholds that are well matched with the input sequences.
</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We present a novel sequence clustering approach called ALFATClust that exploits rapid pairwise alignment-free sequence distance calculations and community detection in graph for clusters generation. Instead of a single threshold applied to every generated cluster, ALFATClust is capable of dynamically determining the cut-off threshold for each individual cluster by considering both cluster separation and intra-cluster sequence similarity. Benchmarking analysis shows that ALFATClust generally outperforms existing approaches by simultaneously maintaining cluster robustness and substantial cluster separation for the benchmark datasets. The software also provides an evaluation report for verifying the quality of the non-singleton clusters obtained.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">ALFATClust is able to generate sequence clusters having high intra-cluster sequence similarity and substantial separation between clusters without having users to decide precise similarity cut-off thresholds.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-022-04643-9.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Sequence clustering</kwd>
      <kwd>Graph clustering</kwd>
      <kwd>Homologous sequences</kwd>
      <kwd>Metagenomics</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Saw Swee Hock School of Public Health, National University of Singapore</institution>
        </funding-source>
        <award-id>SSHSPH ID-PRG/PILOTGRANT/2018/04</award-id>
        <principal-award-recipient>
          <name>
            <surname>Chiu</surname>
            <given-names>Jimmy Ka Ho</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par4">Sequence clustering refers to the process of grouping together similar biological sequences such that only homologous sequences are expected to appear in each sequence cluster. It is particularly useful for identifying various sets of potentially homologous candidates from unknown sequences for further analysis or annotation, as well as aggregating sequencing reads for reference genes abundance estimation in metagenomic samples. Sequence clustering could be considered within the problem domain of general data clustering and are usually resolved using unsupervised learning techniques. Early approaches exploit agglomerative hierarchical clustering [<xref ref-type="bibr" rid="CR1">1</xref>] to cluster sequences with either single linkage (e.g. BlastClust [<xref ref-type="bibr" rid="CR2">2</xref>] and GeneRAGE [<xref ref-type="bibr" rid="CR3">3</xref>]) or average linkage (methods proposed by Loewenstein et al. [<xref ref-type="bibr" rid="CR4">4</xref>] and Uchiyama [<xref ref-type="bibr" rid="CR5">5</xref>]) metrics. Partitional clustering, especially K-means clustering [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>], was another popular method used to derive sequence clusters (customized K-means approaches by Ashlock et al. [<xref ref-type="bibr" rid="CR8">8</xref>] and Kelarev et al. [<xref ref-type="bibr" rid="CR9">9</xref>]). All these approaches require a pairwise sequence distance matrix to be computed. High computation costs are therefore incurred due to the O(<italic>N</italic><sup>2</sup>) pairwise sequence alignments (such as BLAST alignments [<xref ref-type="bibr" rid="CR10">10</xref>]) required for <italic>N</italic> sequences. The size of the distance matrix (<italic>N </italic>× <italic>N</italic>) also creates a scalability problem in terms of space complexity. Moreover, clustering results are often sensitive to user-specified clustering parameters. For example, the K-means algorithm would require the number of final clusters <italic>K</italic> to be specified upfront. In order to determine the optimal parameter values for any given set of sequences, the clustering process would need to be performed iteratively, each with a different set of parameter values. After each iteration, an internal validation index [<xref ref-type="bibr" rid="CR11">11</xref>] such as the silhouette coefficient [<xref ref-type="bibr" rid="CR12">12</xref>] is calculated from the pairwise sequence distance matrix for the generated output clusters. The set of parameter values having the best index score is deemed to generate the optimal clusters. However, the number of sequences in each cluster is expected to vary substantially [<xref ref-type="bibr" rid="CR13">13</xref>], with some clusters having hundreds of sequences while some having only a few or even just a single sequence, therefore making it difficult to efficiently estimate the clustering parameters by assuming similar size or density for all clusters.</p>
    <p id="Par5">Many recent sequence clustering approaches [<xref ref-type="bibr" rid="CR14">14</xref>–<xref ref-type="bibr" rid="CR18">18</xref>] therefore aim at minimizing both the number of pairwise alignments performed and the space complexity (i.e. the sequence distance matrix is no longer required), as well as defining the cluster cut-off through a biologically comprehensible parameter known as the sequence identity threshold <italic>T</italic>. The value of <italic>T</italic> ranges from 0 (complete mismatch) to 1 (identical sequences) and is usually selected based on users’ domain knowledge or a widely accepted value within the domain. It thus reflects that the higher value of the threshold, the more similar would be the sequences in each derived cluster. Such approaches are primarily greedy algorithms that assign a target sequence to an existing cluster when the pairwise sequence identity of this target sequence with the representative center sequence of this cluster is at least <italic>T</italic>, or otherwise creates a new cluster of size = 1 with this target sequence as its representative center sequence. Techniques such as short word filtering [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>] can be applied to avoid the computational expensive procedure of aligning a target sequence with the representative center sequence if their pairwise sequence identity is likely below <italic>T</italic>. The greedy algorithms are also very space efficient because they only consider the sequence identities between the target sequence and all existing representative center sequences. The clustering results can however be affected by the choices of the representative center sequences for the clusters, which are determined by the order of the sequences assessed. MeShClust [<xref ref-type="bibr" rid="CR21">21</xref>] therefore addresses this limitation by reselecting the representative center sequence from all sequences in the cluster after a new sequence has been added using the mean-shift algorithm [<xref ref-type="bibr" rid="CR22">22</xref>]. The representative center sequences for all clusters are also reselected again by mean-shift once all sequences have been clustered, and two clusters are merged when the pairwise sequence identity between their representative center sequences is equal to or greater than <italic>T</italic>.</p>
    <p id="Par6">In contrast, MMseqs2 [<xref ref-type="bibr" rid="CR23">23</xref>] models each sequence as a unique graph vertex, and two vertices are connected by an edge when the pairwise alignment of their underlying sequences satisfies particular criteria including significance, sequence coverage, and <italic>T</italic>. Sequence clusters are then obtained through a graph clustering approach. In addition, the sequence clustering tool Linclust [<xref ref-type="bibr" rid="CR24">24</xref>] can be run as a pre-processing step to divide the sequences into intermediate clusters for individual graph clustering in each intermediate cluster for scalability. For computational efficiencies, MMseqs2 replaces the exact alignment process between sequences with rapid approximations. The speedup techniques utilized by the different algorithms are summarized in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1. Although the sequence identity threshold <italic>T</italic> is comprehensible to most users, a poorly chosen value could generate clusters substantially different from the true biological clusters [<xref ref-type="bibr" rid="CR21">21</xref>]. The most common scenario is that the value of <italic>T</italic> is set too high and hence some homologous sequences are assigned to different clusters, but these clusters are hardly identifiable given the large number of sequences or insufficient annotation. Parameter optimization with internal validation index is also not feasible for these approaches due to the absence of the complete distance matrix.</p>
    <p id="Par7">We therefore develop a novel sequence clustering method that dynamically adjusts the cut-off thresholds for individual clusters. It first estimates a complete pairwise sequence distance matrix using an alignment-free approach to avoid performing the traditional slower sequence alignments. This distance matrix is then used to derive all the edge weights for a graph, in which each sequence is represented by a vertex, and the edge weight for an edge denotes the pairwise similarity between the pair of sequences associated with. Sequence clustering is now performed via an iterative graph clustering in which each vertex is regarded as a singleton graph cluster (a singleton graph cluster consists of only one vertex) initially. Each iteration begins with identifying potential clusters to be merged. A cluster separation cut-off threshold then determines which of them can be merged into a single cluster without introducing possible outliers. When a cluster is prohibited from expansion, it is deemed well separated from its neighbours. In contrast to the sequence identity threshold <italic>T</italic>, the cluster separation cut-off threshold is a dynamic threshold because it is partially determined by the clusters considered. We thus name this sequence clustering approach as Alignment-Free Adaptive Threshold Clustering, or ALFATClust in short. ALFATClust is implemented as a publicly available tool, which also provides an user option to evaluate the non-singleton clusters in terms of sequence identity through sequence alignment.</p>
    <p id="Par8">The remaining sections of this manuscript are organized as follows: The “<xref rid="Sec2" ref-type="sec">Methods</xref>” section first introduces the sequence distance calculation approach and its estimation parameters to be used in ALFATClust, and then gives an overview of the ALFATClust algorithm. Its core steps such as the binning process to derive the graph clusters and the graph contraction are illustrated afterwards. Details of the scalability enhancement and the optional sequence cluster evaluation report are also provided. In the “<xref rid="Sec11" ref-type="sec">Results</xref>” section, we assess both clustering and time performances of ALFATClust with other sequence clustering tools using the benchmark datasets. We then elaborate on the advantages and limitations of ALFATClust in the “<xref rid="Sec16" ref-type="sec">Discussion</xref>” section.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Pairwise sequence distance using alignment-free approach</title>
      <p id="Par9">Mash [<xref ref-type="bibr" rid="CR25">25</xref>] and Dashing [<xref ref-type="bibr" rid="CR26">26</xref>] are two rapid alignment-free sequence distance approaches that require k-mer size and sketch size to be specified as input parameters. We therefore performed experiments to assess the distance calculation method to be implemented in ALFATClust and also determine the relevant input parameters. The experimental details can be found in Additional file <xref rid="MOESM1" ref-type="media">1</xref> provided. Results (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S1–S5) indicate that Mash is better due to the higher correlation between Mash distance and the sequence distance obtained by alignment approach. In addition, from Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S1 and S3, the optimal Mash k-mer size for gene sequences is 17, or lower (e.g. 13) when some sequences are very short. For complete protein sequences, the optimal k-mer size is 9 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5). The optimal sketch size is 2000 for both gene and protein sequences. Since Mash distance <italic>d</italic> ranges from 0 to 1, the corresponding sequence similarity can be easily calculated as 1 − <italic>d</italic>.</p>
    </sec>
    <sec id="Sec4">
      <title>Overview of ALFATClust algorithm</title>
      <p id="Par10">The ALFATClust algorithm consists of four components:<list list-type="order"><list-item><p id="Par11">Mash [<xref ref-type="bibr" rid="CR25">25</xref>] distance calculation for constructing a graph to model pairwise distances between the input sequences;</p></list-item><list-item><p id="Par12">Leiden algorithm [<xref ref-type="bibr" rid="CR27">27</xref>] to partition the graph into communities [<xref ref-type="bibr" rid="CR28">28</xref>] of raw graph clusters;</p></list-item><list-item><p id="Par13">A binning process to bin the vertices in each raw graph cluster into validated graph clusters;</p></list-item><list-item><p id="Par14">A graph contraction step to replace every validated graph cluster by a single vertex.</p></list-item></list></p>
      <p id="Par15">Suppose a Mash distance matrix <italic>D</italic> is computed for a sequence set <italic>S</italic> such that <italic>d</italic><sub><italic>ij</italic></sub> of <italic>D</italic> represents the pairwise Mash distance between sequences <italic>s</italic><sub><italic>i</italic></sub> and <italic>s</italic><sub><italic>j</italic></sub> in <italic>S</italic>. Since Mash distance is a symmetric distance measure, <italic>d</italic><sub><italic>ij</italic></sub> = <italic>d</italic><sub><italic>ji</italic></sub> and both <italic>D</italic> and <italic>W</italic> = 1 − <italic>D</italic> are therefore symmetric matrices. An undirected weighted graph <italic>G</italic> = (<italic>V</italic>, <italic>E</italic>, <italic>W</italic>) is initialized with each vertex <italic>v</italic><sub><italic>i</italic></sub> ∈ <italic>V</italic> representing a sequence <italic>s</italic><sub><italic>i</italic></sub> ∈ <italic>S</italic>. Every vertex pair (<italic>v</italic><sub><italic>i</italic></sub>, <italic>v</italic><sub><italic>j</italic></sub>) (<italic>i</italic> &lt; <italic>j</italic>) is connected with an edge <italic>e</italic><sub><italic>ij</italic></sub> ∈ <italic>E</italic> = {(<italic>v</italic><sub><italic>i</italic></sub>, <italic>v</italic><sub><italic>j</italic></sub>) | <italic>v</italic><sub><italic>i</italic></sub>, <italic>v</italic><sub><italic>j</italic></sub> ∈ <italic>V</italic>, <italic>i</italic> &lt; <italic>j</italic>}, and the edge weight of <italic>e</italic><sub><italic>ij</italic></sub> is equal to <italic>w</italic><sub><italic>ij</italic></sub> of <italic>W</italic>. <italic>w</italic><sub><italic>ii</italic></sub> = 1 despite the absence of self-loop <italic>e</italic><sub><italic>ii</italic></sub> in <italic>G</italic>. <italic>w</italic><sub><italic>ij</italic></sub> therefore denotes the sequence similarity between sequences <italic>s</italic><sub><italic>i</italic></sub> and <italic>s</italic><sub><italic>j</italic></sub>. Leiden algorithm then partitions the graph into raw graph clusters (communities) that maximize the score calculated using a pre-defined quality function. Given a value of <italic>γ</italic> between 0 and 1, the quality function of the Constant Potts Model (CPM) [<xref ref-type="bibr" rid="CR29">29</xref>] guarantees that for any vertex <italic>v</italic> in a non-singleton raw graph cluster <italic>R</italic>, the average edge weight of edges connecting between <italic>v</italic> and other vertices in <italic>R</italic> exceeds <italic>γ</italic>. This means the average sequence similarity between the sequences within every non-singleton raw cluster is higher than <italic>γ</italic>. The core parameters of the ALFATClust algorithm thus include a value range [<italic>γ</italic><sub><italic>low</italic></sub>, <italic>γ</italic><sub><italic>high</italic></sub>] (<italic>γ</italic><sub><italic>low</italic></sub> &lt; <italic>γ</italic><sub><italic>high</italic></sub>) for <italic>γ</italic> and a step size <italic>Δ</italic>, which are used to determine the values of <italic>γ</italic> used in the algorithm:<list list-type="order"><list-item><p id="Par16">Create graph <italic>G</italic> using Mash distance matrix <italic>D</italic>; assign <italic>γ</italic><sub><italic>high</italic></sub> to <italic>γ</italic></p></list-item><list-item><p id="Par17"> While <italic>γ</italic> &gt; <italic>γ</italic><sub><italic>low </italic></sub>− <italic>Δ</italic> do:</p></list-item><list-item><p id="Par18"> Run Leiden algorithm on <italic>G</italic> using CPM with <italic>γ</italic> to obtain set of raw clusters <italic>C</italic><sub><italic>raw</italic></sub></p></list-item><list-item><p id="Par19"> Initialize <italic>L</italic> with an empty list</p></list-item><list-item><p id="Par20"> Assign <italic>C</italic><sub><italic>raw</italic></sub> to <italic>L</italic> if <italic>γ</italic> = <italic>γ</italic><sub><italic>high</italic></sub>; otherwise bin each raw cluster in <italic>C</italic><sub><italic>raw</italic></sub> and add the bins to <italic>L</italic></p></list-item><list-item><p id="Par21"> Contract <italic>G</italic> by replacing every graph cluster in <italic>L</italic> by a single vertex and update edges</p></list-item><list-item><p id="Par22"> Decrement <italic>γ</italic> by <italic>Δ</italic></p></list-item><list-item><p id="Par23">Return the sequence clusters represented by <italic>L</italic> derived in the final iteration</p></list-item></list></p>
      <p id="Par24">The above-mentioned steps would derive graph (sequence) clusters iteratively from <italic>γ</italic> = <italic>γ</italic><sub><italic>high</italic></sub> to a value determined by <italic>γ</italic><sub><italic>low</italic></sub>. In the <italic>i</italic>-th iteration, it first performs Leiden algorithm using CPM with <italic>γ</italic> = <italic>γ</italic><sub><italic>high </italic></sub>− (<italic>i </italic>− 1)<italic>Δ</italic>, and the raw clusters <italic>C</italic><sub><italic>raw</italic></sub> become the graph clusters <italic>L</italic> directly in the first iteration. From the second iteration onwards, the vertices in each individual raw cluster are binned (refer to the binning section below) and vertices in the same bin become a validated graph cluster in <italic>L</italic>. After deriving <italic>L</italic> for the current iteration, graph <italic>G</italic> is contracted in a way similar to Uchiyama’s approach [<xref ref-type="bibr" rid="CR5">5</xref>] that all vertices belonging to a cluster in <italic>L</italic> are replaced by a single vertex. The next iteration, if any, begins with the contracted graph <italic>G</italic>. The graph clusters <italic>L</italic> derived in the final iteration thus become the output sequence clusters. Details of the Leiden algorithm with CPM, binning, and graph contraction are further elaborated below. A detailed description of the ALFATClust algorithm can be found in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
    </sec>
    <sec id="Sec5">
      <title>Leiden algorithm with Constant Potts Model to identify vertices for binning</title>
      <p id="Par25">Community detection [<xref ref-type="bibr" rid="CR28">28</xref>] refers to the process of partitioning a graph such that vertices in each partition are closely related with each other. While each of these partitions is originally known as a community, we term it as a raw graph cluster or raw cluster in this article. In ALFATClust, community detection is performed using the Leiden algorithm [<xref ref-type="bibr" rid="CR27">27</xref>] which is an improvement of the Louvain algorithm [<xref ref-type="bibr" rid="CR30">30</xref>] in both cluster quality and execution time. Briefly, Leiden algorithm starts with each vertex as an individual cluster, and then updates the clusters iteratively to maximize the overall quality score <italic>q</italic>. The calculation of <italic>q</italic> requires a quality function to quantify how closely related the vertices are within each of the raw clusters. For a graph <italic>G</italic> without self-loop, Eq. (<xref rid="Equ1" ref-type="">1</xref>) is the general form of the quality function as defined in CPM [<xref ref-type="bibr" rid="CR29">29</xref>]:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q = \mathop \sum \limits_{ i &lt; j} \left( {\alpha_{ij} w_{ij} - \gamma } \right)\delta \left( {\sigma_{i} ,\sigma_{j} } \right)$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>γ</mml:mi></mml:mrow></mml:mfenced><mml:mi>δ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2022_4643_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>
where <italic>α</italic><sub><italic>ij</italic></sub> belongs to the adjacency matrix <italic>A</italic>. <italic>α</italic><sub><italic>ij</italic></sub> = 1 for any <italic>i</italic> and <italic>j</italic> because <italic>G</italic> is complete (i.e. an edge exists between any two distinct vertices regardless of edge weight). <italic>σ</italic><sub><italic>i</italic></sub> refers to the raw cluster for <italic>v</italic><sub><italic>i</italic></sub>, and δ(<italic>σ</italic><sub><italic>i</italic></sub>, <italic>σ</italic><sub><italic>j</italic></sub>) = 1 if <italic>σ</italic><sub><italic>i</italic></sub> = <italic>σ</italic><sub><italic>j</italic></sub>, i.e., both <italic>v</italic><sub><italic>i</italic></sub> and <italic>v</italic><sub><italic>j</italic></sub> belong to the same raw cluster, and zero otherwise. CPM therefore only considers edge weights for edges within a cluster but not those across clusters. The value of <italic>γ</italic>, which is called the resolution parameter, is within the range of the edge weight for <italic>G</italic>, i.e. from 0 to 1. When a vertex exists as a singleton raw cluster it contributes zero score to <italic>q</italic> according to Eq. (<xref rid="Equ1" ref-type="">1</xref>). It follows that the baseline case for CPM is every raw cluster being a singleton cluster and therefore <italic>q</italic> = 0 regardless of the value of <italic>γ</italic>. Given a value of <italic>γ</italic>, for any vertex <italic>v</italic> in a non-singleton raw cluster <italic>R</italic>, the average edge weight of the intra-cluster edges in <italic>R</italic> involving <italic>v</italic> must be greater than <italic>γ</italic> in order to contribute a positive score to <italic>q</italic>. <italic>γ</italic> therefore becomes a lower bound of the average intra-cluster edge weight for all raw clusters. Graph clusters maximizing the value of <italic>q</italic> are regarded as the raw clusters for a particular value of <italic>γ</italic>.</p>
      <p id="Par26">A problem for community detection is the size bias where large communities dominate over small communities [<xref ref-type="bibr" rid="CR31">31</xref>]. Similar size bias are also observed in CPM where the lower the value of <italic>γ</italic>, the more it favours larger raw cluster size over higher edge weight. For example, suppose graph <italic>G</italic> consists of vertices <italic>v</italic><sub><italic>1</italic></sub>, <italic>v</italic><sub><italic>2</italic></sub>, <italic>v</italic><sub><italic>3</italic></sub>, <italic>v</italic><sub><italic>4</italic></sub>, <italic>v</italic><sub><italic>5</italic></sub>, … with edge weights <italic>w</italic><sub><italic>ij</italic></sub> in <italic>W</italic>. For <italic>γ</italic> = 0.875, <italic>v</italic><sub>1</sub> may form a raw cluster <italic>R</italic> = {<italic>v</italic><sub>1</sub>, <italic>v</italic><sub>2</sub>} when <italic>w</italic><sub>12</sub> = 0.89, thus giving <italic>q</italic> = 0.89 − 0.875 = 0.15. Meanwhile, <italic>v</italic><sub><italic>1</italic></sub> cannot form a larger raw cluster <italic>R’</italic> = {<italic>v</italic><sub>1</sub>, <italic>v</italic><sub>3</sub>, <italic>v</italic><sub>4</sub>, <italic>v</italic><sub>5</sub>} when {<italic>w</italic><sub>13</sub>, <italic>w</italic><sub>14</sub>, <italic>w</italic><sub>15</sub>, <italic>w</italic><sub>34</sub>, <italic>w</italic><sub>35</sub>, <italic>w</italic><sub>45</sub>} = {0.84, 0.86, 0.87, 0.85, 0.87, 0.86}, because <italic>q</italic> for <italic>R’</italic> is equal to (0.84 + 0.86 + 0.87 + 0.85 + 0.87 + 0.86) − 6 × 0.875 = − 0.1. This situation is however reversed for <italic>γ</italic> = 0.85, because <italic>q</italic> becomes 0.05 for <italic>R’</italic> and is now larger than that for <italic>R</italic> (<italic>q</italic> = 0.89 − 0.85 = 0.04). Size bias occurs at <italic>γ</italic> = 0.85 in this example since the highest edge weight <italic>w</italic><sub>12</sub> is omitted from <italic>R’</italic> for <italic>v</italic><sub><italic>1</italic></sub>. This suggests, in the presence of size bias, community detection may allocate less similar sequences to the same raw cluster and highly similar sequences to distinct raw clusters. Another problem is that parameter <italic>γ</italic> is still a uniform cluster cut-off threshold analogous to sequence identity threshold <italic>T</italic>. Nevertheless, community detection is still an effective means to identify potential vertices for individual graph clusters provided these shortcomings are addressed. Indeed, ALFATClust minimizes the impact of size bias by deriving the graph clusters iteratively and replacing them with individual vertices through graph contraction. Also, the subsequent binning process facilitates an adaptive cut-off threshold for individual clusters.</p>
    </sec>
    <sec id="Sec6">
      <title>Binning process</title>
      <p id="Par27">The binning cut-off criteria requires calculating the arithmetic mean of the intra-cluster edge weight for every validated graph cluster obtained in the previous iteration. Since a vertex <italic>v</italic><sub><italic>i</italic></sub> in the contracted graph <italic>G</italic> represents a validated graph cluster, the average intra-cluster edge weight is regarded as the vertex weight of <italic>v</italic><sub><italic>i</italic></sub> and is denoted as <italic>w</italic><sub><italic>ii</italic></sub> of <italic>W</italic>. All diagonal elements <italic>w</italic><sub><italic>ii</italic></sub> of <italic>W</italic> therefore represent the vertex weights for <italic>G</italic> and other elements <italic>w</italic><sub><italic>ij</italic></sub> (<italic>i</italic> ≠ <italic>j</italic>) denote the edge weights. This does not affect the calculation of Eq. (<xref rid="Equ1" ref-type="">1</xref>) for the community detection process because <italic>G</italic> has no self-loop <italic>e</italic><sub><italic>ii</italic></sub> and thus <italic>w</italic><sub><italic>ii</italic></sub> is not associated with any edge. Initially each vertex <italic>v</italic><sub><italic>i</italic></sub> in <italic>G</italic> is simply a singleton graph cluster, and <italic>w</italic><sub><italic>ii</italic></sub> = 1 for any singleton cluster represented by <italic>v</italic><sub><italic>i</italic></sub>. For the first iteration (<italic>γ</italic> = <italic>γ</italic><sub><italic>high</italic></sub>), all raw clusters become graph clusters directly without binning. This is because <italic>γ</italic><sub><italic>high</italic></sub> is supposed to be close to the highest possible edge weight (i.e. 1) so that the raw clusters identified are robust against size bias, and the intra-cluster edge weights are sufficiently large for raw clusters to qualify as graph clusters. The binning process, which is performed individually for each non-singleton raw cluster, begins by sorting its intra-cluster edges in a descending order of edge weight. The two vertices <italic>v</italic><sub><italic>i</italic></sub> and <italic>v</italic><sub><italic>j</italic></sub> associated with edge <italic>e</italic><sub><italic>ij</italic></sub> are added to a vertex list <italic>J</italic> following the sorted edge order, however only the vertex not present in <italic>J</italic> can be added. When both <italic>v</italic><sub><italic>i</italic></sub> and <italic>v</italic><sub><italic>j</italic></sub> do not appear in <italic>J</italic>, the one representing the larger underlying graph cluster is added first. The first bin is created using the first vertex in <italic>J</italic>. Starting from the second vertex, the selected vertex <italic>v</italic><sub><italic>t</italic></sub> is eligible to be assigned to an existing bin <italic>B</italic> satisfying Eq. (<xref rid="Equ1" ref-type="">2</xref>):<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{bin} \left( {B,W} \right) - I\left( {B,W,v_{t} } \right) &lt; I\left( {B,W,v_{t} } \right) - \gamma_{low}$$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="italic">bin</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>W</mml:mi></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>W</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>&lt;</mml:mo><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>W</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">low</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><graphic xlink:href="12859_2022_4643_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where<disp-formula id="Equa"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} &amp; I_{bin} \left( {B,W} \right) = \left\{ {\begin{array}{ll} {w_{ii} } \hfill &amp;\quad {if \left| B \right| = 1\; and\; v_{i} \in B} \hfill \\ {\frac{{\mathop \sum \nolimits_{{v_{i} \in B}} \left( {\rho \left( {v_{i} } \right)\left( {\rho \left( {v_{i} } \right) - 1} \right)/2} \right)w_{ii} + \mathop \sum \nolimits_{{v_{i} ,v_{j} \in B,i &lt; j}} \rho \left( {v_{i} } \right)\rho \left( {v_{j} } \right)w_{ij} }}{{\mathop \sum \nolimits_{{v_{i} \in B}} \rho \left( {v_{i} } \right)\left( {\rho \left( {v_{i} } \right) - 1} \right)/2 + \mathop \sum \nolimits_{{v_{i} ,v_{j} \in B,i &lt; j}} \rho \left( {v_{i} } \right)\rho \left( {v_{j} } \right)}}} \hfill &amp;\quad {otherwise} \hfill \\ \end{array} } \right. \\ &amp; I\left( {B,W,v_{t} } \right) = \frac{{\mathop \sum \nolimits_{{v_{i} \in B}} \rho \left( {v_{i} } \right)w_{it} }}{{\mathop \sum \nolimits_{{v_{i} \in B}} \rho \left( {v_{i} } \right)}} \\ \end{aligned}$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="italic">bin</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>W</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ii</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mrow><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mfenced close="|" open="|"><mml:mi>B</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.277778em"/><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.277778em"/><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>ρ</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:mi>ρ</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ii</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>ρ</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mi>ρ</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfenced><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mi>ρ</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:mi>ρ</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>ρ</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mi>ρ</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mrow><mml:mi mathvariant="italic">otherwise</mml:mi></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>W</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mi>ρ</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">it</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mi>ρ</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2022_4643_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par28"><italic>ρ</italic>(<italic>v</italic><sub><italic>i</italic></sub>) returns the underlying graph cluster size of <italic>v</italic><sub><italic>i</italic></sub> as the total number of primitive vertices (i.e. vertices in initial <italic>G</italic>) belonging to that cluster. In Fig. <xref rid="Fig1" ref-type="fig">1</xref>A, <italic>I</italic><sub><italic>bin</italic></sub>(<italic>B</italic>, <italic>W</italic>) denotes the current cluster compactness of <italic>B</italic> in terms of its average intra-bin edge weight. <italic>I</italic>(<italic>B</italic>, <italic>W</italic>, <italic>v</italic><sub><italic>t</italic></sub>) refers to the average edge weight between <italic>v</italic><sub><italic>t</italic></sub> and vertices in <italic>B</italic>. By assuming the homologous sequences have significantly higher edge weights (lower Mash distances) with each other than with other non-homologous sequences, <italic>v</italic><sub><italic>t</italic></sub> should not be assigned to <italic>B</italic> when <italic>I</italic>(<italic>B</italic>, <italic>W</italic>, <italic>v</italic><sub><italic>t</italic></sub>) is much smaller than <italic>I</italic><sub><italic>bin</italic></sub>(<italic>B</italic>, <italic>W</italic>), or it might introduce outliers into <italic>B</italic> otherwise. <italic>I</italic><sub><italic>bin</italic></sub>(<italic>B</italic>, <italic>W</italic>) − <italic>I</italic>(<italic>B</italic>, <italic>W</italic>, <italic>v</italic><sub><italic>t</italic></sub>) in Eq. (<xref rid="Equ1" ref-type="">2</xref>) is therefore an estimate for the cluster separation between <italic>B</italic> and <italic>v</italic><sub><italic>t</italic></sub>, and <italic>I</italic>(<italic>B</italic>, <italic>W</italic>, <italic>v</italic><sub><italic>t</italic></sub>) − <italic>γ</italic><sub><italic>low</italic></sub> is the cut-off threshold determined by both <italic>B</italic> and <italic>v</italic><sub><italic>t</italic></sub> as well as the pre-defined <italic>γ</italic><sub><italic>low</italic></sub>. Figure <xref rid="Fig1" ref-type="fig">1</xref>A illustrates both cluster separation and adaptive cut-off threshold in the graph. <italic>v</italic><sub><italic>t</italic></sub> is assigned to the bin giving the highest positive score calculated with a scoring function <italic>Q</italic>(<italic>B</italic>, <italic>W</italic>, <italic>v</italic><sub><italic>t</italic></sub>):<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q\left( {B,W,v_{t} } \right) = 2I\left( {B,W,v_{t} } \right) - I_{bin} \left( {B,W} \right) - \gamma_{low}$$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mrow><mml:mi>Q</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>W</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>W</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="italic">bin</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>W</mml:mi></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">low</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><graphic xlink:href="12859_2022_4643_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula><fig id="Fig1"><label>Fig. 1</label><caption><p>Illustration of the binning process and graph contraction in ALFATClust. <bold>A</bold> Suppose the black dots are the primitive graph vertices. The binning process determines whether a vertex <italic>v</italic><sub><italic>t</italic></sub> (red circle) representing a graph cluster of two primitive vertices can be assigned to the bin <italic>B</italic> (purple dashed ellipse) consisting of two vertices (blue circles) containing clusters of sizes 2 and 3. <italic>I</italic><sub><italic>bin</italic></sub>(<italic>B</italic>, <italic>W</italic>) is the average edge weight for all edges inter-connecting primitive vertices inside <italic>B</italic> (blue and purple lines) and <italic>I</italic>(<italic>B</italic>, <italic>W</italic>, <italic>v</italic><sub><italic>t</italic></sub>) refers to the average edge weight for all edges (orange lines) connecting <italic>v</italic><sub><italic>t</italic></sub> and <italic>B</italic>. The cluster separation <italic>g</italic> = <italic>I</italic><sub><italic>bin</italic></sub>(<italic>B</italic>, <italic>W</italic>) − <italic>I</italic>(<italic>B</italic>, <italic>W</italic>, <italic>v</italic><sub><italic>t</italic></sub>) and the cluster cut-off threshold <italic>r</italic> = <italic>I</italic>(<italic>B</italic>, <italic>W</italic>, <italic>v</italic><sub><italic>t</italic></sub>) − <italic>γ</italic><sub><italic>low</italic></sub>. According to Eq. (<xref rid="Equ1" ref-type="">2</xref>), <italic>v</italic><sub><italic>t</italic></sub> can be assigned to <italic>B</italic> when <italic>g</italic> is less than <italic>r</italic>. <bold>B</bold> The graph contraction shrinks two clusters (primitive vertices connected by either blue or red edges) into two vertices (blue and red dots respectively). The intra-cluster (blue and red) and inter-cluster (black) edge weights are averaged to become vertex (blue and red) weights and collapsed edge (black) weights respectively. The value in the parentheses denotes the number of underlying actual edges. These two vertices can be further collapsed into a single vertex (black)</p></caption><graphic xlink:href="12859_2022_4643_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par29">The inequality in Eq. (<xref rid="Equ1" ref-type="">2</xref>) is satisfied when <italic>Q</italic>(<italic>B</italic>, <italic>W</italic>, <italic>v</italic><sub><italic>t</italic></sub>) &gt; 0. <italic>v</italic><sub><italic>t</italic></sub> is assigned to a new bin when none of the scores for the existing bins are positive. As a result, every bin derived from a raw cluster becomes a validated graph cluster for the current iteration.</p>
    </sec>
    <sec id="Sec7">
      <title>Graph contraction</title>
      <p id="Par30">After binning all raw clusters, <italic>G</italic> is contracted such that each graph cluster <italic>C</italic><sub><italic>i</italic></sub> in <italic>G</italic> is now replaced by a new vertex <italic>v’</italic><sub><italic>i</italic></sub>, and its vertex weight <italic>w’</italic><sub><italic>ii</italic></sub> is equal to the average intra-cluster edge weight of <italic>C</italic><sub><italic>i</italic></sub>. Edges connecting between clusters <italic>C</italic><sub><italic>i</italic></sub> and <italic>C</italic><sub><italic>j</italic></sub> are replaced by a single edge connecting <italic>v’</italic><sub><italic>i</italic></sub> and <italic>v’</italic><sub><italic>j</italic></sub> in the contracted graph, with its edge weight averaged from the replaced edges. Figure <xref rid="Fig1" ref-type="fig">1</xref>B illustrates an example of the graph contraction process. However, graph clusters obtained from the same raw cluster are prohibited from appearing together in any raw cluster in subsequent iterations. This is achieved by assigning a large negative edge weight (–|<italic>V’</italic>|<sup>2</sup> where <italic>V’</italic> is the vertices of the contracted <italic>G</italic>) to the edges interconnecting them. The next iteration, if any, begins with the contracted graph. The graph contraction therefore preserves the validated graph clusters in subsequent iterations against size bias, provided that <italic>Δ</italic> is sufficiently small.</p>
    </sec>
    <sec id="Sec8">
      <title>Selection of the core parameters in ALFATClust</title>
      <p id="Par31">The value of <italic>γ</italic><sub><italic>high</italic></sub> is supposed to approach the maximum possible edge weight value (i.e. 1) so that the raw clusters detected in the first iteration are robust against size bias. Most of the actual cut-offs for individual clusters are expected to appear above <italic>γ</italic><sub><italic>low</italic></sub>, which still needs to be set as high as possible to avoid capturing subsequent trivial (but larger) drops. For example, a decrease of edge weight from 0.85 to 0.72 is more significant than the next even larger drop from 0.74 to 0.59. The smaller the value of <italic>Δ</italic> the lesser is the size bias for CPM in an iteration. The minimum value for <italic>γ</italic><sub><italic>high</italic></sub> is at least 0.95. The value for <italic>Δ</italic> should not exceed 0.025. Both <italic>γ</italic><sub><italic>high</italic></sub> and <italic>Δ</italic> are usually relatively invariant and the value of <italic>γ</italic><sub><italic>low</italic></sub> can set between 0.7 and 0.8.</p>
    </sec>
    <sec id="Sec9">
      <title>Scalability improvement</title>
      <p id="Par32">Although ALFATClust computes a full Mash distance matrix for its graph clustering, the matrix can be significantly reduced using a divide-and-conquer approach. A pre-clustering step is performed at the beginning to divide the sequences into multiple sequence partitions. This is achieved by running the highly scalable MMSeqs2 with sequence identity threshold <italic>T</italic> equal to <italic>γ</italic><sub><italic>low</italic></sub>, and each of its output sequence clusters becomes an individual sequence partition. ALFATClust can then run with each partition separately without compromising the overall clustering accuracy. This is because the pairwise sequence similarity between any two sequences in different partitions is below <italic>γ</italic><sub><italic>low</italic></sub>, hence filtering their corresponding vertex pair brings little impact to both CPM scoring community detection and the binning process. ALFATClust runs in pre-clustering mode when either the number of sequences exceeds a pre-defined limit (20,000 sequences by default) or the pre-clustering option is activated by the user.</p>
    </sec>
    <sec id="Sec10">
      <title>Cluster evaluation</title>
      <p id="Par33">ALFATClust provides an optional evaluation of cluster quality in terms of sequence identity. For each non-singleton cluster, the sequence giving the largest sum of intra-cluster edge weight and satisfying the sequence length criteria (i.e. between lower quartile − 1.5 × interquartile range and upper quartile + 1.5 × interquartile range) is selected as the representative center sequence. If no such sequence exists or the cluster consists of only two sequences, then the longest sequence will be selected instead. Pairwise sequence identity (number of matched bases divided by alignment length excluding terminal gaps, refer to Additional file <xref rid="MOESM1" ref-type="media">1</xref> for implementation details) is calculated between the center sequence and every other sequence in the same cluster. The evaluation report includes both mean sequence identity and minimum sequence identity for every non-singleton cluster.</p>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Results</title>
    <sec id="Sec12">
      <title>Benchmark datasets and setup</title>
      <p id="Par34">Antimicrobial resistance (AMR) gene and protein sequence datasets [<xref ref-type="bibr" rid="CR32">32</xref>–<xref ref-type="bibr" rid="CR34">34</xref>] are suitable for evaluating clustering effectiveness due to the presence of many distinct classes of homologous resistance gene sequences, and a wide range of sequence similarities among these sequences. AMR gene sequences are retrieved from various public AMR databases including CARD (version 3.0.7) [<xref ref-type="bibr" rid="CR32">32</xref>], ResFinder (downloaded on 3th Feb, 2020) [<xref ref-type="bibr" rid="CR33">33</xref>], and ARG-ANNOT (version 4) [<xref ref-type="bibr" rid="CR34">34</xref>]. All AMR sequences collected are validated, integrated, annotated into an AMR gene sequence dataset using ARGDIT [<xref ref-type="bibr" rid="CR35">35</xref>], which further translates this dataset into an AMR protein sequence dataset. Non-AMR plasmid nucleotide sequences are extracted with their original annotation from PLSDB [<xref ref-type="bibr" rid="CR36">36</xref>] (version 2019_10_07) to create a plasmid nucleotides dataset. Due to its highly variable sequence lengths, it can be used to investigate whether the clustering performance is affected when the sequence length differs substantially. Finally, scalability in terms of the number of sequences and sequence length is examined using viral nucleotide and amino acid sequence datasets (each consisting of ~ 470,000 sequences) retrieved from viruSITE (release 2021.1) [<xref ref-type="bibr" rid="CR37">37</xref>]. Sequences consisting of ambiguous nucleotide or amino acid, or having their sequence length shorter than the smallest Mash k-mer size benchmarked (13 for gene and 9 for protein) are discarded. In particular, viral nucleotide sequences are split into two separate datasets according to the 10,000 nucleotides criteria. The viral sequence datasets are only used for scalability assessments. Table <xref rid="Tab1" ref-type="table">1</xref> summarizes the properties of all benchmark datasets used, with further details provided in the “<xref rid="Sec11" ref-type="sec">Results</xref>” section.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Details of the benchmark datasets used for evaluation</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Dataset</th><th align="left" rowspan="2">No. of sequences</th><th align="left" colspan="3">Sequence length</th></tr><tr><th align="left">Mean (standard deviation)</th><th align="left">Min</th><th align="left">Max</th></tr></thead><tbody><tr><td align="left">AMR genes</td><td align="left">4027</td><td align="left">939.93 (± 381.98)</td><td align="left">162</td><td align="left">4359</td></tr><tr><td align="left">AMR proteins</td><td align="left">3891</td><td align="left">312.53 (± 127.90)</td><td align="left">53</td><td align="left">1452</td></tr><tr><td align="left">Plasmid nucleotides</td><td align="left">5005</td><td align="left">1010.38 (± 1 008.45)</td><td align="left">77</td><td align="left">9511</td></tr><tr><td align="left">Viral nucleotides</td><td align="left">478,652</td><td align="left">717.09 (± 837.21)</td><td align="left">13</td><td align="left">9993</td></tr><tr><td align="left">Long viral nucleotides</td><td align="left">676</td><td align="left">14,803.87 (± 12 048.56)</td><td align="left">10,002</td><td align="left">262,388</td></tr><tr><td align="left">Viral amino acids</td><td align="left">469,835</td><td align="left">242.64 (± 313.29)</td><td align="left">9</td><td align="left">13,556</td></tr></tbody></table></table-wrap></p>
      <p id="Par35">The performance of ALFATClust is compared with CD-HIT (version 4.8.1), UCLUST (version 11.0.667), VSEARCH (version 2.14.1), DNACLUST (version 3.7), MeShClust (also MeShClust<sup>2</sup> [<xref ref-type="bibr" rid="CR38">38</xref>] for the viral nucleotide dataset), and MMseqs2 (version 12.113e3). The identity thresholds used for these tools range from 0.7 to 0.9 with a step size of 0.05. Any cluster optimization option(s) in the tools are also turned on whenever available except for the viral sequence datasets. The suggested value of <italic>γ</italic><sub><italic>low</italic></sub> is in the range of 0.7 to 0.8 for most instances; in this benchmark <italic>γ</italic><sub><italic>low</italic></sub> is set to three different values: 0.7, 0.75, and 0.8. Default values are applied for other parameters: <italic>γ</italic><sub><italic>high</italic></sub> = 0.95, and <italic>Δ</italic> = 0.025. Also, the default Mash k-mer size (17 for nucleotide sequences and 9 for protein sequences) and sketch size (2000) are used except for both plasmid and viral nucleotide datasets where the k-mer size is set to 13. Execution commands and options for all the tools are provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>. Silhouette scores [<xref ref-type="bibr" rid="CR12">12</xref>] for the sequence clusters are computed using scikit-learn [<xref ref-type="bibr" rid="CR39">39</xref>], while the results are plotted using Matplotlib [<xref ref-type="bibr" rid="CR40">40</xref>]. All the benchmarks are performed on a workstation with a quad-core Intel Xeon W-2102 CPU and 64 GB RAM. Cluster evaluation reports of ALFATClust for the AMR and plasmid sequence datasets are available in Additional files <xref rid="MOESM2" ref-type="media">2</xref>, <xref rid="MOESM3" ref-type="media">3</xref>, <xref rid="MOESM4" ref-type="media">4</xref>, <xref rid="MOESM5" ref-type="media">5</xref>, <xref rid="MOESM6" ref-type="media">6</xref>, <xref rid="MOESM7" ref-type="media">7</xref>, <xref rid="MOESM9" ref-type="media">9</xref>, <xref rid="MOESM10" ref-type="media">10</xref>, <xref rid="MOESM11" ref-type="media">11</xref>. In addition, although the Leiden algorithm involves random vertex and community selection, identical set of clusters is obtained from 50 individual runs for each of the AMR and plasmid datasets using any of the three values of <italic>γ</italic><sub><italic>low</italic></sub> specified above.</p>
    </sec>
    <sec id="Sec13">
      <title>Sensitivity of clustering parameter <bold><italic>γ</italic></bold><sub><bold><italic>low</italic></bold></sub> and cluster robustness</title>
      <p id="Par36">Figure <xref rid="Fig2" ref-type="fig">2</xref> shows the rate of decrease in number of clusters generated is slower with decreasing <italic>γ</italic><sub><italic>low</italic></sub> in ALFATClust than decreasing <italic>T</italic> in other clustering approaches, especially for the AMR sequence datasets. One possible explanation is the clustering results being less sensitive to <italic>γ</italic><sub><italic>low</italic></sub>, at least for its suggested value range (0.7–0.8), than <italic>T</italic> in other clustering tools. A further verification is therefore performed by comparing the clusters derived with these values of <italic>γ</italic><sub><italic>low</italic></sub> and <italic>T</italic> (0.9, 0.85, and 0.8) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S6–S12). ALFATClust exhibits the highest proportion of identical clusters shared across different <italic>γ</italic><sub><italic>low</italic></sub>. For example, in the AMR gene dataset, the number of identical clusters common across the three values of <italic>γ</italic><sub><italic>low</italic></sub> is 995 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6), which constitute 83.4% of all distinct clusters seen. This proportion is remarkably higher than all other tools such as UCLUST (68.5%, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S8) and MMseqs2 (65.9%, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S9). This better cluster pattern convergence indicates a lower impact of selecting a non-optimal <italic>γ</italic><sub><italic>low</italic></sub> from the suggested range. Another observation is the uneven distribution of the cluster sizes. When running ALFATClust with <italic>γ</italic><sub><italic>low</italic></sub> = 0.75, the average number of sequences per cluster and the standard deviation for the AMR gene, AMR protein, and plasmid nucleotides datasets are 3.72 ± 13.77, 3.74 ± 13.98, and 7.27 ± 15.66 respectively. Their cluster sizes are therefore highly varied. Moreover, while there are a few clusters consisting of over 100 sequences in each of these datasets, singleton clusters occupy ~ 70% of all derived clusters for the AMR sequence datasets and ~ 39% for the plasmid dataset. These datasets are thus real examples illustrating the difficulty in searching for suitable clustering parameter value (such as <italic>K</italic> in K-means clustering) evaluated with internal validation index.<fig id="Fig2"><label>Fig. 2</label><caption><p>Number of sequence clusters derived by the clustering tools. <italic>γ</italic><sub><italic>low</italic></sub> for ALFATClust varies from 0.8 down to 0.7 and <italic>T</italic> for others varies from 0.9 down to 0.7, both with a step size of 0.05. The values of <italic>γ</italic><sub><italic>low</italic></sub> or <italic>T</italic> are distinguished by different colours. Only ALFATClust, CD-HIT, UCLUST, and MMseqs2 can cluster protein sequences. The lowest value of <italic>T</italic> allowed for nucleotide sequences by CD-HIT is 0.8. DNACLUST cannot cluster some plasmid nucleotide sequences that are too short</p></caption><graphic xlink:href="12859_2022_4643_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par37">The distribution of the minimum sequence identities presented in the ALFATClust cluster evaluation reports (available in Additional files <xref rid="MOESM2" ref-type="media">2</xref>, <xref rid="MOESM3" ref-type="media">3</xref>, <xref rid="MOESM4" ref-type="media">4</xref>, <xref rid="MOESM5" ref-type="media">5</xref>, <xref rid="MOESM6" ref-type="media">6</xref>, <xref rid="MOESM7" ref-type="media">7</xref>, <xref rid="MOESM9" ref-type="media">9</xref>, <xref rid="MOESM10" ref-type="media">10</xref>, <xref rid="MOESM11" ref-type="media">11</xref>) is shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. For <italic>γ</italic><sub><italic>low</italic></sub> ≥ 0.75, at least 74% of the non-singleton clusters have minimum sequence identity ≥ 0.9 in all three benchmark datasets; and only a few clusters have minimum sequence identity below 0.8. The particularly low sequence identities (&lt; 0.7) for the plasmid nucleotides dataset are partially due to multiple large non-terminal gaps present in the pairwise sequence alignment, such as the one between the cluster center sequence “CP016074.1_rep7a_15_repC(pS0385p1)” and sequence “NC_017335.1_rep7a_18_rep(pS0385p2)” in the same cluster. Another reason is the significantly underestimated Mash distance due to partially overlapping sequence segments. Plasmid nucleotide sequence pair “LT906556.1_IncFII(pCoo)_1_pCoo” and “KX276657.1_IncFIC(FII)_1” is an example demonstrating such partial overlap, with the Mash distance equal to 0.069 (hence the corresponding sequence similarity is 1 − 0.069 = 0.931), while the true sequence identity calculated using alignment is only 0.555. The alignments giving large non-terminal gaps or partial overlap for the above examples are illustrated in Additional file <xref rid="MOESM1" ref-type="media">1</xref>. By examining the cluster evaluation reports generated, it is found that for the AMR gene dataset with <italic>γ</italic><sub><italic>low</italic></sub> = 0.7, the sequence pair having the lowest minimum sequence identity belongs to the same AMR gene family (AMR genes LRA-3 and LRA-9, both under subclass B3 LRA beta-lactamase according to CARD). For the AMR protein dataset with <italic>γ</italic><sub><italic>low</italic></sub> = 0.7, the sequence pair having the lowest identity score belongs to dihydrofolate reductase (conferring resistance to trimethoprim), although the sequence identity for this pair is quite low (0.675).<fig id="Fig3"><label>Fig. 3</label><caption><p>Distribution of non-singleton sequence clusters based on minimum sequence identity. The minimum sequence identity for a sequence cluster is the lowest sequence identity observed between its representative center sequence and another sequence in the same cluster. The value next to the slice indicates the number of clusters belonging to a particular sequence identity category</p></caption><graphic xlink:href="12859_2022_4643_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec14">
      <title>Overall sequence cluster quality benchmark</title>
      <p id="Par38">The overall sequence cluster quality of ALFATClust is compared with other approaches using both external and internal validation indices. Normalized mutual information (NMI) [<xref ref-type="bibr" rid="CR41">41</xref>] and purity [<xref ref-type="bibr" rid="CR42">42</xref>] are external validation indices used for this comparison with the AMR sequence datasets. The AMR sequences are manually classified into gene classes created using the gene names (and their synonyms provided by CARD [<xref ref-type="bibr" rid="CR32">32</xref>]) identified from the AMR gene sequence annotations. Sets of AMR sequence clusters obtained by various approaches at different thresholds are evaluated individually against a set of 827 AMR gene classes consisting of 3 720 AMR sequences (accounting for ~ 92% of all AMR gene sequences, refer to Additional file <xref rid="MOESM8" ref-type="media">8</xref> for the AMR gene classes). For a set of sequence clusters <italic>L</italic> consisting of <italic>N</italic> sequences together, NMI measures the correlation between <italic>L</italic> and the pre-defined gene classes Ω using Eq. (<xref rid="Equ3" ref-type="">4</xref>) below:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$NMI\left( {L,{\Omega }} \right) = \frac{{2 \times I\left( {L;{\Omega }} \right)}}{{H\left( L \right) + H\left( {\Omega } \right)}}$$\end{document}</tex-math><mml:math id="M10" display="block"><mml:mrow><mml:mi>N</mml:mi><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>L</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mfenced close=")" open="("><mml:mi>L</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:mi>H</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="normal">Ω</mml:mi></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2022_4643_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where<disp-formula id="Equb"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left( {L;{\Omega }} \right) = \mathop \sum \limits_{C \in L} \mathop \sum \limits_{{\omega \in {\Omega }}} \frac{{\left| {C \cap \omega } \right|}}{N}\log \left( {\frac{{N\left| {C \cap \omega } \right|}}{\left| C \right|\left| \omega \right|}} \right)$$\end{document}</tex-math><mml:math id="M12" display="block"><mml:mrow><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>L</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>∈</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>ω</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mfenced close="|" open="|"><mml:mrow><mml:mi>C</mml:mi><mml:mo>∩</mml:mo><mml:mi>ω</mml:mi></mml:mrow></mml:mfenced><mml:mi>N</mml:mi></mml:mfrac><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi>N</mml:mi><mml:mfenced close="|" open="|"><mml:mrow><mml:mi>C</mml:mi><mml:mo>∩</mml:mo><mml:mi>ω</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfenced close="|" open="|"><mml:mi>C</mml:mi></mml:mfenced><mml:mfenced close="|" open="|"><mml:mi>ω</mml:mi></mml:mfenced></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2022_4643_Article_Equb.gif" position="anchor"/></alternatives></disp-formula>and<disp-formula id="Equc"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H\left( {\Theta } \right) = - \mathop \sum \limits_{{\theta \in {\Theta }}} \frac{\left| \theta \right|}{N}\log \left( {\frac{\left| \theta \right|}{N}} \right)$$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mrow><mml:mi>H</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="normal">Θ</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mfenced close="|" open="|"><mml:mi>θ</mml:mi></mml:mfenced><mml:mi>N</mml:mi></mml:mfrac><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mfenced close="|" open="|"><mml:mi>θ</mml:mi></mml:mfenced><mml:mi>N</mml:mi></mml:mfrac></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2022_4643_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par39">The higher the values for NMI (maximum NMI is 1) the better correlation is between the sequence clusters and the gene classes. Figure <xref rid="Fig4" ref-type="fig">4</xref> illustrates how NMI varies with <italic>γ</italic><sub><italic>low</italic></sub> for ALFATClust as well as <italic>T</italic> for other approaches. The NMI values obtained by ALFATClust are not less than any other tool (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S2 and S3) in the AMR gene dataset, and its NMI at <italic>γ</italic><sub><italic>low</italic></sub> = 0.7 is the overall highest (0.933) in the AMR protein dataset. Moreover, the NMI value variation for <italic>γ</italic><sub><italic>low</italic></sub> between 0.7 and 0.8 is relatively small compared to others in both datasets. This is mainly due to the lower sensitivity of the clustering outcomes with <italic>γ</italic><sub><italic>low</italic></sub> than <italic>T</italic>. Purity is another external index to assess the homogeneity of gene class in the sequence clusters. Higher purity (maximum purity is 1) means the clusters are generally more dominated by sequences in the same gene class. Equation (<xref rid="Equ4" ref-type="">5</xref>) below calculates purity:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Purity = \frac{1}{N}\mathop \sum \limits_{C \in L} \mathop {\max }\limits_{{\omega \in {\Omega }}} \left| {C \cap \omega } \right|$$\end{document}</tex-math><mml:math id="M16" display="block"><mml:mrow><mml:mi>P</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>∈</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo movablelimits="false">max</mml:mo><mml:mrow><mml:mi>ω</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:munder><mml:mfenced close="|" open="|"><mml:mrow><mml:mi>C</mml:mi><mml:mo>∩</mml:mo><mml:mi>ω</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2022_4643_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula><fig id="Fig4"><label>Fig. 4</label><caption><p>Comparison of NMI between ALFATClust and other clustering tools. <italic>γ</italic><sub><italic>low</italic></sub> for ALFATClust varies from 0.8 down to 0.7 (solid to dotted lines) and <italic>T</italic> for other clustering tools (x-axis) varies from 0.9 down to 0.7, both with a step size of 0.05. Only ALFATClust, CD-HIT, UCLUST, and MMseqs2 can cluster protein sequences. The lowest value of <italic>T</italic> allowed for nucleotide sequences by CD-HIT is 0.8</p></caption><graphic xlink:href="12859_2022_4643_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par40">Figure <xref rid="Fig5" ref-type="fig">5</xref> shows a strictly decreasing trend of purity with decreasing <italic>γ</italic><sub><italic>low</italic></sub> and <italic>T</italic> for all the clustering approaches benchmarked. Nevertheless, the rate of decrease for ALFATClust is slower than others, and its purity is often close to or even higher than other tools at <italic>T</italic> = 0.85 (exact values for ALFATClust and other methods are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S4 and S5 respectively). The implication is that the cluster expansion in ALFATClust is less aggressive than the greedy algorithms towards lower thresholds. This is the benefit of determining an individual cut-off for each cluster by considering the separation with its neighbour clusters, rather than relying on a single rigid threshold to allocate sequences.<fig id="Fig5"><label>Fig. 5</label><caption><p>Comparison of purity between ALFATClust and other clustering tools. <italic>γ</italic><sub><italic>low</italic></sub> for ALFATClust varies from 0.8 down to 0.7 (solid to dotted lines) and <italic>T</italic> for other clustering tools (x-axis) varies from 0.9 down to 0.7, both with a step size of 0.05. Only ALFATClust, CD-HIT, UCLUST, and MMseqs2 can cluster protein sequences. The lowest value of <italic>T</italic> allowed for nucleotide sequences by CD-HIT is 0.8</p></caption><graphic xlink:href="12859_2022_4643_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par41">Internal validation indices such as silhouette coefficient <italic>c</italic> [<xref ref-type="bibr" rid="CR12">12</xref>] evaluates the overall cluster separation using the true sequence distance matrix (rather than the Mash distance matrix). <italic>c</italic> is defined as:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c = \frac{1}{\left| S \right|}\mathop \sum \limits_{s \in S} \frac{{d_{neighbor} \left( s \right) - d_{intra} \left( s \right)}}{{{\text{max}}\left( {d_{neighbor} \left( s \right),d_{intra} \left( s \right)} \right)}}$$\end{document}</tex-math><mml:math id="M18" display="block"><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mfenced close="|" open="|"><mml:mi>S</mml:mi></mml:mfenced></mml:mfrac><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi mathvariant="italic">neighbor</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>s</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi mathvariant="italic">intra</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>s</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi mathvariant="italic">neighbor</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>s</mml:mi></mml:mfenced><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi mathvariant="italic">intra</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>s</mml:mi></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2022_4643_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>where <italic>d</italic><sub><italic>neighbor</italic></sub>(<italic>s</italic>) measures the separation of sequence <italic>s</italic>, i.e. mean distance between <italic>s</italic> and a sequence in its nearest (called “neighboring”) cluster, and <italic>d</italic><sub><italic>intra</italic></sub>(<italic>s</italic>) measures the cohesion of <italic>s</italic>, i.e. mean distance between <italic>s</italic> and other sequences in the same cluster. <italic>c</italic> ranges from − 1 to 1, and a higher value of <italic>c</italic> indicates a better overall cluster separation. Internal validation indices can be used for cluster quality evaluation when the pre-determined sequence classes are unknown (e.g. the plasmid nucleotides dataset). To compute the true sequence distance matrix for the plasmid nucleotides dataset, exact pairwise sequence identity (same calculation formula as the one used for cluster evaluation in ALFATClust) is calculated for every pair of sequences, and the pairwise distance is given by 1 − sequence identity. Figure <xref rid="Fig6" ref-type="fig">6</xref> shows that while the maximum silhouette coefficient values are attained at distinct values of <italic>T</italic> for different tools, none of them is better than those for ALFATClust at all three values of <italic>γ</italic><sub><italic>low</italic></sub>. By comparing the silhouette coefficients between Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S6 and S7, it can be seen that the lowest silhouette coefficient achieved (0.716) by ALFATClust is equal to the highest score obtained with other approaches for the plasmid dataset.<fig id="Fig6"><label>Fig. 6</label><caption><p>Comparison of silhouette coefficient between ALFATClust and other clustering tools for the plasmid nucleotides dataset. <italic>γ</italic><sub><italic>low</italic></sub> for ALFATClust varies from 0.8 down to 0.7 (solid to dotted lines) and <italic>T</italic> for other clustering tools (x-axis) varies from 0.9 down to 0.7, both with a step size of 0.05. The lowest value of <italic>T</italic> allowed for nucleotide sequences by CD-HIT is 0.8. DNACLUST cannot cluster some plasmid nucleotide sequences that are too short, and the silhouette coefficients for MeShClust are below zero for the plasmid nucleotides dataset with all values of <italic>T</italic></p></caption><graphic xlink:href="12859_2022_4643_Fig6_HTML" id="MO6"/></fig></p>
    </sec>
    <sec id="Sec15">
      <title>Scalability performance</title>
      <p id="Par42">The scalability benchmark is performed with respect to the number of sequences using the viral nucleotide and amino acid sequence datasets, and sequence length using the long viral nucleotide dataset. ALFATClust clusters these datasets with <italic>γ</italic><sub><italic>low</italic></sub> = 0.75 (without the optional cluster evaluation), while others perform clustering with <italic>T</italic> = 0.85. The processing times shown in Table <xref rid="Tab2" ref-type="table">2</xref> vary substantially among different clustering approaches, ranging from a minute or less to several hours. Both MMSeqs2 and MeShClust runs faster than ALFATClust for the viral nucleotide dataset, but the number of clusters derived by MeShClust is unusually low. UCLUST requires less than a minute to cluster ~ 470,000 viral amino acid sequences, but it cannot process long viral nucleotide sequences due to its software limitation. MMseqs2 as well as the alignment-free ALFATClust and MeShClust<sup>2</sup> run much faster than other alignment-based tools for long viral nucleotide sequences. In summary, ALFATClust is scalable for a large number of sequences due to the efficient pre-clustering based on MMseqs2, and sequence length through alignment-free sequence distance calculation.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Scalability benchmark through the viral nucleotide and amino acid sequence datasets</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="3"/><th align="left" colspan="6">Datasets</th></tr><tr><th align="left" colspan="2">Viral nucleotides (≤ 10,000 nts)</th><th align="left" colspan="2">Long viral nucleotides (&gt; 10,000 nts)</th><th align="left" colspan="2">Viral amino acids<sup>@</sup></th></tr><tr><th align="left">No. of clusters</th><th align="left">Time (hh:mm:ss)</th><th align="left">No. of clusters</th><th align="left">Time (hh:mm:ss)</th><th align="left">No. of clusters</th><th align="left">Time (hh:mm:ss)</th></tr></thead><tbody><tr><td align="left">ALFATClust<sup>$</sup></td><td align="left">237,276</td><td align="left">00:35:41</td><td align="left">499</td><td align="left">00:00:39</td><td align="left">234,451</td><td align="left">00:27:23</td></tr><tr><td align="left">CD-HIT</td><td align="left" colspan="2">N.A.<sup>#</sup></td><td align="left">506</td><td align="left">00:16:10</td><td align="left">109,515</td><td align="left">04:29:06</td></tr><tr><td align="left">UCLUST</td><td align="left">245,658</td><td align="left">07:47:25</td><td align="left" colspan="2">N.A.*</td><td align="left">243,982</td><td align="left">00:00:56</td></tr><tr><td align="left">MMseqs2</td><td align="left">221,997</td><td align="left">00:02:18</td><td align="left">428</td><td align="left">00:00:15</td><td align="left">235,921</td><td align="left">00:06:43</td></tr><tr><td align="left">VSEARCH</td><td align="left">239,728</td><td align="left">05:23:11</td><td align="left">507</td><td align="left">01:48:36</td><td align="left"/><td align="left"/></tr><tr><td align="left">MeShClust</td><td align="left">8713</td><td align="left">00:14:53</td><td align="left">462</td><td align="left">01:14:52</td><td align="left"/><td align="left"/></tr><tr><td align="left">MeShClust<sup>2</sup></td><td align="left">194,267</td><td align="left">03:43:00</td><td align="left">571</td><td align="left">00:00:10</td><td align="left"/><td align="left"/></tr><tr><td align="left">DNACLUST</td><td align="left" colspan="2">N.A.<sup>^</sup></td><td align="left" colspan="2">N.A.<sup>^</sup></td><td align="left"/><td align="left"/></tr></tbody></table><table-wrap-foot><p><sup>$</sup>ALFATClust runs at <italic>γ</italic><sub><italic>low</italic></sub> = 0.75, and all other tools run at <italic>T</italic> = 0.85</p><p><sup>#</sup>Terminated after running for 8 h</p><p>*Memory limit exceeded for the community (32-bit) version of UCLUST</p><p>^Segmentation fault occurs</p><p><sup>@</sup>Only ALFATClust, CD-HIT, UCLUST, and MMseqs2 can process protein sequences</p></table-wrap-foot></table-wrap></p>
    </sec>
  </sec>
  <sec id="Sec16">
    <title>Discussion</title>
    <p id="Par43">ALFATClust is conceptually similar to hierarchical agglomerative clustering since its algorithm begins with each sequence (vertex) as a singleton graph cluster, and the graph clusters are gradually merged through iterations with decreasing resolution parameter <italic>γ</italic>. The graph contraction at the end of each iteration preserves the integrity of the current graph clusters against the size bias of CPM in subsequent iterations. Moreover, for each raw cluster, vertex sorting prioritizes its vertex pairs in descending order of edge weight (i.e. ascending order of sequence distance) for subsequent binning. Both intra-cluster and inter-cluster edge weight calculations are based on unweighted average linkage as shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>B. Using the CPM formulated in Eq. (<xref rid="Equ1" ref-type="">1</xref>), community detection (Leiden algorithm) acts as a selection process at a particular value of <italic>γ</italic> to identify potential vertices for individual graph clusters. Equation (<xref rid="Equ2" ref-type="">3</xref>) is the scoring function proposed to bin these vertices within each raw cluster to one or more graph clusters. For any existing bin <italic>B</italic>, it considers both the average intra-bin edge weight <italic>I</italic><sub><italic>bin</italic></sub>(<italic>B</italic>, <italic>W</italic>), which is equal to the mean sequence similarity inferring sequence homology, and the proximity between <italic>B</italic> and vertex <italic>v</italic><sub><italic>t</italic></sub>, i.e. <italic>I</italic>(<italic>B</italic>, <italic>W</italic>, <italic>v</italic><sub><italic>t</italic></sub>), with respect to <italic>γ</italic><sub><italic>low</italic></sub>. Note that this scoring function only depends on the constant <italic>γ</italic><sub><italic>low</italic></sub> but not the variable <italic>γ</italic> in its calculation, hence the binning process is consistent throughout iterations. Although it references a single value of <italic>γ</italic><sub><italic>low</italic></sub>, every bin has its own actual cut-off above <italic>γ</italic><sub><italic>low</italic></sub>. In other words, <italic>γ</italic><sub><italic>low</italic></sub> is a soft cut-off as opposed to a global hard cut-off like sequence identity threshold <italic>T</italic> or number of clusters <italic>K</italic> [<xref ref-type="bibr" rid="CR13">13</xref>] to define all output clusters. Individual adaptive cluster cut-offs offer greater flexibility to fit different clusters such that the cut-off value can be lowered for only certain clusters when necessary, i.e. to expand a cluster by including those slightly less similar sequences, if any. The benchmark analysis suggests that the clustering outcomes are less sensitive to different values of <italic>γ</italic><sub><italic>low</italic></sub> (at least for those within the suggested value range) compared to <italic>T</italic>, therefore reducing the impact of selecting a non-optimal soft cut-off. It is also easier to simultaneously maintain relatively high cluster quality and cluster separation for a wider range of <italic>γ</italic><sub><italic>low</italic></sub>. This is much harder for other algorithms to balance between these two criteria through a uniform cluster cut-off threshold, of which the optimal value is often unknown and difficult to determine. Moreover, ALFATClust is scalable towards sequence length due to the use of alignment-free sequence distance calculation such as Mash.</p>
    <p id="Par44">From the sequence similarity point of view, both the iterative cluster computation from <italic>γ</italic><sub><italic>high</italic></sub> down to <italic>γ</italic><sub><italic>low</italic></sub> (provided <italic>Δ</italic> is sufficiently small) accompanied by graph contraction, and the vertex sorting prior to the binning process generally prioritize more similar sequence pairs for clustering. This is particularly important because the linear correlation between the average nucleotide identity (ANI) and the Mash distance <italic>d</italic> decreases with increasing <italic>d</italic> [<xref ref-type="bibr" rid="CR25">25</xref>], and thus this prioritization allows the sequence pairs to be processed from the most reliable (and small) sequence distances. In addition, since <italic>γ</italic><sub><italic>low</italic></sub> determines the value of <italic>γ</italic> for the final iteration, most of the pairwise sequence similarity values below <italic>γ</italic><sub><italic>low</italic></sub> are actually filtered, and so the clustering outcomes are not affected even they deviate substantially from the true sequence identities. Mash distance inaccuracies are mitigated by averaging the edge weights when collapsing the relevant vertices. The proposed ALFATClust algorithm allows pre-clustering to enhance scalability towards number of sequences without disrupting the overall clustering outcomes, because the sequences from distinct partitions are supposed to be dissimilar with each other. Cluster evaluation is also available for users to inspect the quality of the non-singleton sequence clusters, and determine whether the specified value of <italic>γ</italic><sub><italic>low</italic></sub> is appropriate for the given dataset. In particular, the recommended value for <italic>γ</italic><sub><italic>low</italic></sub> is 0.7 or above, because the linear correlation between ANI and <italic>d</italic> might become distorted when its value is too low. It is sufficient to set <italic>γ</italic><sub><italic>high</italic></sub> to 0.95 for most cases, and the step size <italic>Δ</italic> is not larger than 0.025.</p>
    <p id="Par45">Although both ALFATClust and CARNAC-LR [<xref ref-type="bibr" rid="CR43">43</xref>] are clustering tools based on community detection, they do have fundamental differences. Firstly, CARNAC-LR relies on read alignment (mapping) to determine whether two long reads overlap significantly based on a similarity threshold set in the alignment tool, and an unweighted edge between two vertices (reads) denotes such overlap; ALFATClust creates a complete graph using the alignment-free Mash distances, which are converted to edge weights representing (average) pairwise sequence similarities. Hence, it does not impose any similarity threshold for graph construction. Secondly, CARNAC-LR partitions the graph into <italic>K</italic> cliques or dense subgraphs by minimizing the number of edges between them, and the value of <italic>K</italic> is determined internally; ALFATClust performs sequence clustering based on a user-specified soft cut-off <italic>γ</italic><sub><italic>low</italic></sub> as explained above. Finally, CARNAC-LR resolves intersecting clusters by identifying spurious read overlaps and cutting the edges accordingly; ALFATClust gradually expands the clusters from the largest (and also the most reliable) edge weights first to minimize the impact of sequence distance approximation errors.</p>
    <p id="Par46">ALFATClust inherits the limitations of Mash distance, particularly distance underestimation for partially overlapping sequences such as the plasmid sequence cases discussed in the “<xref rid="Sec11" ref-type="sec">Results</xref>” section. Therefore, when the input sequences consist of genome sequence fragments rather than complete gene sequences, users are advised to identify clusters with particularly low sequence identities through the evaluation report to detect potential partial overlaps. Moreover, compared to genome-scale sequences, gene sequences are more sensitive to the specified k-mer size for accurate distance calculation, and this value is shown to be varying between different datasets. It should also be noted that ALFATClust is intended to be used to partition multiple groups of homologous sequences, it is therefore not suitable for tasks such as OTU (operational taxonomic unit) clustering, in which the sequence identity threshold required is strictly 97%.</p>
  </sec>
  <sec id="Sec17">
    <title>Conclusions</title>
    <p id="Par47">Our benchmark demonstrates numerous advantages of ALFATClust over typical threshold-based sequence clustering approaches, including better clustering results for a non-optimal soft cut-off threshold, generally large cluster separation, and scalability with respect to number of sequences and sequence length. It also facilitates cluster quality inspection by providing cluster evaluation. It is suitable for clustering multiple groups of homologous sequences in which the sequence similarity cut-off threshold is often unknown and hard to determine.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec18">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2022_4643_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold>. Supplementary method and benchmark details, figures, and tables.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2022_4643_MOESM2_ESM.csv">
            <caption>
              <p><bold>Additional file 2</bold>. ALFATClust cluster evaluation report for the AMR gene sequence dataset (<italic>γ</italic><sub>low</sub> = 0.7).</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2022_4643_MOESM3_ESM.csv">
            <caption>
              <p><bold>Additional file 3</bold>. ALFATClust cluster evaluation report for the AMR gene sequence dataset (<italic>γ</italic><sub>low</sub> = 0.75).</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="12859_2022_4643_MOESM4_ESM.csv">
            <caption>
              <p><bold>Additional file 4</bold>. ALFATClust cluster evaluation report for the AMR gene sequence dataset (<italic>γ</italic><sub>low</sub> = 0.8). </p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="12859_2022_4643_MOESM5_ESM.csv">
            <caption>
              <p><bold>Additional file 5</bold>. ALFATClust cluster evaluation report for the AMR protein sequence dataset (<italic>γ</italic><sub>low</sub> = 0.7).</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="12859_2022_4643_MOESM6_ESM.csv">
            <caption>
              <p><bold>Additional file 6</bold>. ALFATClust cluster evaluation report for the AMR protein sequence dataset (<italic>γ</italic><sub>low</sub> = 0.75).</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="12859_2022_4643_MOESM7_ESM.csv">
            <caption>
              <p><bold>Additional file 7</bold>. ALFATClust cluster evaluation report for the AMR protein sequence dataset (<italic>γ</italic><sub>low</sub> = 0.8).</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM8">
          <media xlink:href="12859_2022_4643_MOESM8_ESM.csv">
            <caption>
              <p><bold>Additional file 8</bold>. Gene classification for the AMR gene sequence dataset. Used as the background truth for the NMI and purity evaluation.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM9">
          <media xlink:href="12859_2022_4643_MOESM9_ESM.csv">
            <caption>
              <p><bold>Additional file 9</bold>. ALFATClust cluster evaluation report for the plasmid nucleotide sequence dataset (<italic>γ</italic><sub>low</sub> = 0.7).</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM10">
          <media xlink:href="12859_2022_4643_MOESM10_ESM.csv">
            <caption>
              <p><bold>Additional file 10</bold>. ALFATClust cluster evaluation report for the plasmid nucleotide sequence dataset (<italic>γ</italic><sub>low</sub> = 0.75).</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM11">
          <media xlink:href="12859_2022_4643_MOESM11_ESM.csv">
            <caption>
              <p><bold>Additional file 11</bold>. ALFATClust cluster evaluation report for the plasmid nucleotide sequence dataset (<italic>γ</italic><sub>low</sub> = 0.8).</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors' contributions</title>
    <p>JKHC and RTHO conceived the method and wrote the manuscript. JKHC implemented the software and performed the experiments. Both authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This research is supported by the Saw Swee Hock School of Public Health, National University of Singapore under its Infectious Disease Programme Research (SSHSPH ID-PRG/PILOTGRANT/2018/04).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>ALFATClust is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/phglab/ALFATClust">https://github.com/phglab/ALFATClust</ext-link>. AMR sequence and plasmid datasets are also available in this package.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par48">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par49">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par50">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Murtagh</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Contreras</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Algorithms for hierarchical clustering: an overview</article-title>
        <source>WIREs Data Min Knowl Discov</source>
        <year>2012</year>
        <volume>2</volume>
        <issue>1</issue>
        <fpage>86</fpage>
        <lpage>97</lpage>
        <pub-id pub-id-type="doi">10.1002/widm.53</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">National Center for Biotechnology Information (NCBI): Documentation of the BLASTCLUST-algorithm. <ext-link ext-link-type="uri" xlink:href="ftp://ftp.ncbi.nih.gov/blast/documents/blastclust.html">ftp://ftp.ncbi.nih.gov/blast/documents/blastclust.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Enright</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Ouzounis</surname>
            <given-names>CA</given-names>
          </name>
        </person-group>
        <article-title>GeneRAGE: a robust algorithm for sequence clustering and domain detection</article-title>
        <source>Bioinformatics</source>
        <year>2000</year>
        <volume>16</volume>
        <issue>5</issue>
        <fpage>451</fpage>
        <lpage>457</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/16.5.451</pub-id>
        <pub-id pub-id-type="pmid">10871267</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loewenstein</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Portugaly</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Fromer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Linial</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Efficient algorithms for accurate hierarchical clustering of huge datasets: tackling the entire protein space</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <issue>13</issue>
        <fpage>i41</fpage>
        <lpage>i49</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn174</pub-id>
        <pub-id pub-id-type="pmid">18586742</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Uchiyama</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Hierarchical clustering algorithm for comprehensive orthologous-domain classification in multiple genomes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2006</year>
        <volume>34</volume>
        <issue>2</issue>
        <fpage>647</fpage>
        <lpage>658</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkj448</pub-id>
        <pub-id pub-id-type="pmid">16436801</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lloyd</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Least squares quantization in PCM</article-title>
        <source>IEEE Trans Inf Theory</source>
        <year>1982</year>
        <volume>28</volume>
        <issue>2</issue>
        <fpage>129</fpage>
        <lpage>137</lpage>
        <pub-id pub-id-type="doi">10.1109/TIT.1982.1056489</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">MacQueen J. Some methods for classification and analysis of multivariate observations. In: Proceedings of the fifth Berkeley symposium on mathematical statistics and probability, vol 1: statistics: 1967 1967; Berkeley, Calif.: University of California Press. pp. 281–297.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Ashlock D, Warner E. Classifying synthetic and biological DNA sequences with side effect machines. In: 2008 IEEE symposium on computational intelligence in bioinformatics and computational biology: 15-17 Sept. 2008 2008. pp. 22–29.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kelarev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Steane</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Clustering algorithms for ITS sequence data with alignment metrics</article-title>
        <source>Lect Notes Comput Sci</source>
        <year>2006</year>
        <volume>4304</volume>
        <fpage>1027</fpage>
        <lpage>1031</lpage>
        <pub-id pub-id-type="doi">10.1007/11941439_116</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boratyn</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Camacho</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Coulouris</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Fong</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Madden</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Matten</surname>
            <given-names>WT</given-names>
          </name>
          <name>
            <surname>McGinnis</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Merezhuk</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BLAST: a more efficient report with usability improvements</article-title>
        <source>Nucleic Acids Res</source>
        <year>2013</year>
        <volume>41</volume>
        <issue>W1</issue>
        <fpage>W29</fpage>
        <lpage>W33</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt282</pub-id>
        <pub-id pub-id-type="pmid">23609542</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Xiong</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Understanding and enhancement of internal clustering validation measures</article-title>
        <source>IEEE Trans Cybern</source>
        <year>2013</year>
        <volume>43</volume>
        <issue>3</issue>
        <fpage>982</fpage>
        <lpage>994</lpage>
        <pub-id pub-id-type="doi">10.1109/TSMCB.2012.2223671</pub-id>
        <pub-id pub-id-type="pmid">23193245</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rousseeuw</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Silhouettes: a graphical aid to the interpretation and validation of cluster analysis</article-title>
        <source>J Comput Appl Math</source>
        <year>1987</year>
        <volume>20</volume>
        <fpage>53</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1016/0377-0427(87)90125-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wei</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>A novel hierarchical clustering algorithm for gene sequences</article-title>
        <source>BMC Bioinform</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>1</issue>
        <fpage>174</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-13-174</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Niu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>CD-HIT: accelerated for clustering the next-generation sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>23</issue>
        <fpage>3150</fpage>
        <lpage>3152</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts565</pub-id>
        <pub-id pub-id-type="pmid">23060610</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Godzik</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Cd-hit: a fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <issue>13</issue>
        <fpage>1658</fpage>
        <lpage>1659</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl158</pub-id>
        <pub-id pub-id-type="pmid">16731699</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>Search and clustering orders of magnitude faster than BLAST</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>19</issue>
        <fpage>2460</fpage>
        <lpage>2461</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq461</pub-id>
        <pub-id pub-id-type="pmid">20709691</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ghodsi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>DNACLUST: accurate and efficient clustering of phylogenetic marker genes</article-title>
        <source>BMC Bioinform</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>271</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-271</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rognes</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Flouri</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Nichols</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Quince</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Mahé</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>VSEARCH: a versatile open source tool for metagenomics</article-title>
        <source>PeerJ</source>
        <year>2016</year>
        <volume>4</volume>
        <fpage>e2584</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj.2584</pub-id>
        <pub-id pub-id-type="pmid">27781170</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Jaroszewski</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Godzik</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Clustering of highly homologous sequences to reduce the size of large protein databases</article-title>
        <source>Bioinformatics</source>
        <year>2001</year>
        <volume>17</volume>
        <issue>3</issue>
        <fpage>282</fpage>
        <lpage>283</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/17.3.282</pub-id>
        <pub-id pub-id-type="pmid">11294794</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Jaroszewski</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Godzik</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Sequence clustering strategies improve remote homology recognitions while reducing search times</article-title>
        <source>Protein Eng Des Sel</source>
        <year>2002</year>
        <volume>15</volume>
        <issue>8</issue>
        <fpage>643</fpage>
        <lpage>649</lpage>
        <pub-id pub-id-type="doi">10.1093/protein/15.8.643</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>James</surname>
            <given-names>BT</given-names>
          </name>
          <name>
            <surname>Luczak</surname>
            <given-names>BB</given-names>
          </name>
          <name>
            <surname>Girgis</surname>
            <given-names>HZ</given-names>
          </name>
        </person-group>
        <article-title>MeShClust: an intelligent tool for clustering DNA sequences</article-title>
        <source>Nucleic Acids Res</source>
        <year>2018</year>
        <volume>46</volume>
        <issue>14</issue>
        <fpage>e83</fpage>
        <lpage>e83</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky315</pub-id>
        <pub-id pub-id-type="pmid">29718317</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Mean shift, mode seeking, and clustering</article-title>
        <source>IEEE Trans Pattern Anal Mach Intell</source>
        <year>1995</year>
        <volume>17</volume>
        <issue>8</issue>
        <fpage>790</fpage>
        <lpage>799</lpage>
        <pub-id pub-id-type="doi">10.1109/34.400568</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Steinegger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Söding</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>MMseqs2 enables sensitive protein sequence searching for the analysis of massive data sets</article-title>
        <source>Nat Biotechnol</source>
        <year>2017</year>
        <volume>35</volume>
        <fpage>1026</fpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3988</pub-id>
        <pub-id pub-id-type="pmid">29035372</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Steinegger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Söding</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Clustering huge protein sequence sets in linear time</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>2542</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-04964-5</pub-id>
        <pub-id pub-id-type="pmid">29959318</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ondov</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Treangen</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Melsted</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mallonee</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Bergman</surname>
            <given-names>NH</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Mash: fast genome and metagenome distance estimation using MinHash</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>132</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0997-x</pub-id>
        <pub-id pub-id-type="pmid">27323842</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baker</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Dashing: fast and accurate genomic distances with HyperLogLog</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>265</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1875-0</pub-id>
        <pub-id pub-id-type="pmid">31801633</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Traag</surname>
            <given-names>VA</given-names>
          </name>
          <name>
            <surname>Waltman</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>van Eck</surname>
            <given-names>NJ</given-names>
          </name>
        </person-group>
        <article-title>From Louvain to Leiden: guaranteeing well-connected communities</article-title>
        <source>Sci Rep</source>
        <year>2019</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>5233</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-019-41695-z</pub-id>
        <pub-id pub-id-type="pmid">30914743</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Girvan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Newman</surname>
            <given-names>MEJ</given-names>
          </name>
        </person-group>
        <article-title>Community structure in social and biological networks</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2002</year>
        <volume>99</volume>
        <issue>12</issue>
        <fpage>7821</fpage>
        <lpage>7826</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.122653799</pub-id>
        <pub-id pub-id-type="pmid">12060727</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Traag</surname>
            <given-names>VA</given-names>
          </name>
          <name>
            <surname>Van Dooren</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Nesterov</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Narrow scope for resolution-limit-free community detection</article-title>
        <source>Phys Rev E</source>
        <year>2011</year>
        <volume>84</volume>
        <issue>1</issue>
        <fpage>016114</fpage>
        <pub-id pub-id-type="doi">10.1103/PhysRevE.84.016114</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blondel</surname>
            <given-names>VD</given-names>
          </name>
          <name>
            <surname>Guillaume</surname>
            <given-names>J-L</given-names>
          </name>
          <name>
            <surname>Lambiotte</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lefebvre</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Fast unfolding of communities in large networks</article-title>
        <source>J Stat Mech Theory Exp</source>
        <year>2008</year>
        <volume>2008</volume>
        <issue>10</issue>
        <fpage>P10008</fpage>
        <pub-id pub-id-type="doi">10.1088/1742-5468/2008/10/P10008</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Jones I, Wang R, Han J, Liu H. Community cores: removing size bias from community detection. In: Proceedings of the international AAAI conference on web and social media 2016, 10(1).</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alcock</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Raphenya</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Lau</surname>
            <given-names>TTY</given-names>
          </name>
          <name>
            <surname>Tsang</surname>
            <given-names>KK</given-names>
          </name>
          <name>
            <surname>Bouchard</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Edalatmand</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Huynh</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>A-LV</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CARD 2020: antibiotic resistome surveillance with the comprehensive antibiotic resistance database</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>48</volume>
        <issue>1</issue>
        <fpage>517</fpage>
        <lpage>525</lpage>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zankari</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Hasman</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Cosentino</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Vestergaard</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rasmussen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lund</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Aarestrup</surname>
            <given-names>FM</given-names>
          </name>
          <name>
            <surname>Larsen</surname>
            <given-names>MV</given-names>
          </name>
        </person-group>
        <article-title>Identification of acquired antimicrobial resistance genes</article-title>
        <source>J Antimicrob Chemother</source>
        <year>2012</year>
        <volume>67</volume>
        <issue>11</issue>
        <fpage>2640</fpage>
        <lpage>2644</lpage>
        <pub-id pub-id-type="doi">10.1093/jac/dks261</pub-id>
        <pub-id pub-id-type="pmid">22782487</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gupta</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Padmanabhan</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Diene</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Lopez-Rojas</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kempf</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Landraud</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Rolain</surname>
            <given-names>J-M</given-names>
          </name>
        </person-group>
        <article-title>ARG-ANNOT, a new bioinformatic tool to discover antibiotic resistance genes in bacterial genomes</article-title>
        <source>Antimicrob Agents Chemother</source>
        <year>2014</year>
        <volume>58</volume>
        <issue>1</issue>
        <fpage>212</fpage>
        <lpage>220</lpage>
        <pub-id pub-id-type="doi">10.1128/AAC.01310-13</pub-id>
        <pub-id pub-id-type="pmid">24145532</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chiu</surname>
            <given-names>JKH</given-names>
          </name>
        </person-group>
        <article-title>Ong RT-H: ARGDIT: a validation and integration toolkit for antimicrobial resistance gene databases</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>14</issue>
        <fpage>2466</fpage>
        <lpage>2474</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty987</pub-id>
        <pub-id pub-id-type="pmid">30520940</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Galata</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Fehlmann</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Backes</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Keller</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>PLSDB: a resource of complete bacterial plasmids</article-title>
        <source>Nucleic Acids Res</source>
        <year>2018</year>
        <volume>47</volume>
        <issue>D1</issue>
        <fpage>D195</fpage>
        <lpage>D202</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky1050</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Stano M, Beke G, Klucar L. viruSITE—integrated database for viral genomics. Database 2016; 2016.</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">James BT, Girgis HZ: MeShClust2: Application of alignment-free identity scores in clustering long DNA sequences. bioRxiv 2018:451278.</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pedregosa</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Varoquaux</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gramfort</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Michel</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Thirion</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Grisel</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Blondel</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Prettenhofer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Weiss</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Dubourg</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Scikit-learn: machine learning in python</article-title>
        <source>J Mach Learn Res</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>2825</fpage>
        <lpage>2830</lpage>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hunter</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Matplotlib: a 2D graphics environment</article-title>
        <source>Comput Sci Eng</source>
        <year>2007</year>
        <volume>9</volume>
        <issue>3</issue>
        <fpage>90</fpage>
        <lpage>95</lpage>
        <pub-id pub-id-type="doi">10.1109/MCSE.2007.55</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vinh</surname>
            <given-names>NX</given-names>
          </name>
          <name>
            <surname>Epps</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bailey</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Information theoretic measures for clusterings comparison: variants, properties, normalization and correction for chance</article-title>
        <source>J Mach Learn Res</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>2837</fpage>
        <lpage>2854</lpage>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Manning</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Raghavan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Schütze</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <source>Introduction to information retrieval</source>
        <year>2008</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Cambridge University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marchet</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lecompte</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Silva</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Cruaud</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Aury</surname>
            <given-names>J-M</given-names>
          </name>
          <name>
            <surname>Nicolas</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Peterlongo</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>De novo clustering of long reads by gene from transcriptomics data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2018</year>
        <volume>47</volume>
        <issue>1</issue>
        <fpage>e2</fpage>
        <lpage>e2</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky834</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
