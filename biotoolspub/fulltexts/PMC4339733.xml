<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4339733</article-id>
    <article-id pub-id-type="pmid">25652152</article-id>
    <article-id pub-id-type="publisher-id">473</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-015-0473-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MBBC: an efficient approach for metagenomic binning based on clustering</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Ying</given-names>
        </name>
        <address>
          <email>ying2010@knights.ucf.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Hu</surname>
          <given-names>Haiyan</given-names>
        </name>
        <address>
          <email>haihu@cs.ucf.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Li</surname>
          <given-names>Xiaoman</given-names>
        </name>
        <address>
          <email>xiaoman@mail.ucf.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2159 2859</institution-id><institution-id institution-id-type="GRID">grid.170430.1</institution-id><institution>Department of Electric Engineering and Computer Science, </institution><institution>University of Central Florida, </institution></institution-wrap>Orlando, FL 32816 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2159 2859</institution-id><institution-id institution-id-type="GRID">grid.170430.1</institution-id><institution/><institution>Burnett School of Biomedical Science, University of Central Florida, </institution></institution-wrap>Orlando, FL 32816 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>2</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2015</year>
    </pub-date>
    <volume>16</volume>
    <elocation-id>36</elocation-id>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>7</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>1</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Wang et al.; licensee BioMed Central. 2015</copyright-statement>
      <license license-type="open-access">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly credited. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Binning environmental shotgun reads is one of the most fundamental tasks in metagenomic studies, in which mixed reads from different species or operational taxonomical units (OTUs) are separated into different groups. While dozens of binning methods are available, there is still room for improvement.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We developed a novel taxonomy-independent approach called MBBC (<bold>M</bold>etagenomic <bold>B</bold>inning <bold>B</bold>ased on <bold>C</bold>lustering) to cluster environmental shotgun reads, by considering k-mer frequency in reads and Markov properties of the inferred OTUs. Tested on twelve simulated datasets, MBBC reliably estimated the species number, the genome size, and the relative abundance of each species, independent of whether there are errors in reads. Tested on multiple experimental datasets, MBBC outperformed two state-of-the-art taxonomy-independent methods, in terms of the accuracy of the estimated species number, genome sizes, and percentages of correctly assigned reads, among other metrics.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>We have developed a novel method for binning metagenomic reads based on clustering. This method is demonstrated to reliably predict species numbers, genome sizes, relative species abundances, and k-mer coverage in simple datasets. Our method also has a high accuracy in read binning. The MBBC software is freely available at <ext-link ext-link-type="uri" xlink:href="http://eecs.ucf.edu/~xiaoman/MBBC/MBBC.html">http://eecs.ucf.edu/~xiaoman/MBBC/MBBC.html</ext-link>.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s12859-015-0473-8) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Metagenomics</kwd>
      <kwd>Binning</kwd>
      <kwd>Taxonomy-independent</kwd>
      <kwd>EM Algorithm</kwd>
      <kwd>Markov properties</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2015</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Binning environmental shotgun reads is critical to metagenomic studies [<xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR2">2</xref>]. In a metagenomics project, genome sequences of different species from an environmental sample are randomly cut into short DNA fragments and then sequenced [<xref ref-type="bibr" rid="CR1">1</xref>-<xref ref-type="bibr" rid="CR3">3</xref>]. The sequenced DNA fragments are often called reads, and the mixed reads from different species in an environment are thus designated as environmental shotgun reads [<xref ref-type="bibr" rid="CR2">2</xref>]. Because the information of the species origin of reads and the relative order of reads in the genomes is lost during sequencing, it is crucial to cluster the mixed environmental shotgun reads into reads from the same species or operational taxonomical units (OTUs), so called “binning reads” [<xref ref-type="bibr" rid="CR2">2</xref>]. By binning reads, researchers can identify the number and the abundances of species in the environment, and further understand what functional roles each species plays and how these species work together, which are critical for the study of microbes.</p>
    <p>Many computational methods have been developed to bin environmental shotgun reads [<xref ref-type="bibr" rid="CR4">4</xref>-<xref ref-type="bibr" rid="CR22">22</xref>]. These methods can be broadly classified into two categories. One category is taxonomy-dependent [<xref ref-type="bibr" rid="CR5">5</xref>,<xref ref-type="bibr" rid="CR8">8</xref>-<xref ref-type="bibr" rid="CR10">10</xref>,<xref ref-type="bibr" rid="CR16">16</xref>-<xref ref-type="bibr" rid="CR21">21</xref>,<xref ref-type="bibr" rid="CR23">23</xref>,<xref ref-type="bibr" rid="CR24">24</xref>], in which one queries reads in reference databases and utilizes the origin of the hit sequences in reference databases to bin reads. The reference databases commonly used include the non-redundant nucleotide database at the National Center for Biotechnology Information (NCBI), Uniprot [<xref ref-type="bibr" rid="CR25">25</xref>], Pfam [<xref ref-type="bibr" rid="CR26">26</xref>], etc. The other category of methods is taxonomy-independent [<xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR11">11</xref>-<xref ref-type="bibr" rid="CR13">13</xref>,<xref ref-type="bibr" rid="CR27">27</xref>,<xref ref-type="bibr" rid="CR28">28</xref>], in which the composition information of reads is used to group reads. The rationale behind taxonomy-independent methods is that reads from different species have different composition properties. For instance, different <italic>α</italic> -proteobacteria species have GC contents ranging from &lt;30% to &gt;60% [<xref ref-type="bibr" rid="CR29">29</xref>]. In addition to GC content, the frequency of tetranucleotides and other features in reads are also commonly used as the composition information of reads [<xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR22">22</xref>,<xref ref-type="bibr" rid="CR30">30</xref>].</p>
    <p>Despite the existence of many read-binning methods, there is much room for improvement [<xref ref-type="bibr" rid="CR22">22</xref>]. The taxonomy-dependent methods are hampered by the limited number of sequenced microbial genomes, more than 99% of which are still unknown and unstudied [<xref ref-type="bibr" rid="CR31">31</xref>]. The taxonomy-independent methods also have various problems. Early taxonomy-independent methods cannot bin short reads from next generation sequencing technologies [<xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR31">31</xref>]. Recently, a few methods [<xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR15">15</xref>] have been developed to bin reads, including short reads. For instance, AbundanceBin [<xref ref-type="bibr" rid="CR14">14</xref>] utilizes the property that k-mers (k base pair long DNA segments) in reads from the same genome have similar frequencies to group reads. Although these methods have been shown to perform well in certain simulated and experimental datasets, recent studies indicate their limitations [<xref ref-type="bibr" rid="CR22">22</xref>]. One such limitation is that multiple reads have seldom been considered simultaneously to infer their properties other than k-mer frequency. We infer that properties shared by a group of reads are likely useful to cluster short environmental shotgun reads, as demonstrated in the following analyses.</p>
    <p>We developed a novel approach called Metagenomic Binning Based on Clustering (MBBC). MBBC first groups reads based on k-mer frequencies within the reads by an expectation maximization (EM) algorithm [<xref ref-type="bibr" rid="CR32">32</xref>]. The rationale behind this step is that species with different genome coverage usually have different k-mer frequencies and k-mers in reads from the same species often occur similar number of times. Therefore, k-mer frequencies in reads help to separate reads from different species. From the initially grouped reads, MBBC then infers the Markov properties of reads within each group, under the assumption that the majority of reads with similar k-mer frequencies are likely from the same genome and therefore from the same Markov chain. Finally, MBBC iteratively clusters reads based on the learned Markov properties and infers the Markov properties of reads in the same groups until the process converges. Tested on twelve simulated datasets, MBBC reliably clustered reads and determined the species number, genome sizes, and k-mer coverage of each species. The k-mer coverage of a species in this study is the average number of reads covering a random k-mer in the genome of this species, which is an approximation of the genome coverage that is calculated as the sum of the length of all reads from this species divided by the genome length of this species. Tested on multiple real experimental datasets, four of which used 75 base pair long short reads, MBBC performed the same or better than two state-of-the-art taxonomy-independent methods [<xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR15">15</xref>]. MBBC is thus a useful method for metagenomic studies.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>MBBC reliably estimates the species number, genome sizes, relative species abundances, and k-mer coverage</title>
      <p>We applied MBBC to twelve simulated datasets with the initial species number, <italic>m</italic>, set at 10. These datasets used species from three randomly selected genera, from each of which four species were randomly selected (Additional file <xref rid="MOESM1" ref-type="media">1</xref>). We observed that in each dataset, MBBC predicted the exact species number (Additional file <xref rid="MOESM2" ref-type="media">2</xref>). In all datasets, regardless of whether the genome coverage ratio was larger or smaller than 2 and whether there were errors in reads, the predicted genome size, relative species abundance, and k-mer coverage were close to the actual ones (Additional file <xref rid="MOESM2" ref-type="media">2</xref>).</p>
      <p>Figure <xref rid="Fig1" ref-type="fig">1</xref> provided a detailed example of binning reads from four species in the genus <italic>Spiroplasma</italic> by MBBC (Figure <xref rid="Fig1" ref-type="fig">1</xref>). In this example, the genome coverage of the four species was 4, 8, 18, and 32, respectively. MBBC correctly determined the species number. It also reliably predicted the k-mer coverage as 3.34, 6.67, 13.05, and 22.98, respectively, which were close to the actual ones (numbers in the parentheses in Figure <xref rid="Fig1" ref-type="fig">1</xref>). The actual k-mer coverage was calculated by counting the number of times k-mers in a genome covered by reads from this genome. Moreover, MBBC reasonably estimated the genome sizes for the four species (Figure <xref rid="Fig1" ref-type="fig">1</xref>).<fig id="Fig1"><label>Figure 1</label><caption><p><bold>An example of binning reads from four species in the genus of</bold><bold><italic>Spiroplasma</italic></bold><bold>by MBBC.</bold><italic>α</italic> and <italic>λ</italic> represents the estimated relative species abundance and k-mer coverage, respectively. The real genome sizes, <italic>α</italic> and <italic>λ</italic> are listed in the parentheses of the last table in the figure. After updating k-mer occurrences for k-mers occurring fewer than 4 times, the estimated <italic>α</italic> becomes more accurate. After removing small groups, the estimated species number and <italic>α</italic> become more accurate.</p></caption><graphic xlink:href="12859_2015_473_Fig1_HTML" id="MO1"/></fig>
</p>
      <p>It is also evident that two steps in the EM algorithm of the MBBC are important for its accuracy (Figure <xref rid="Fig1" ref-type="fig">1</xref>). One step is to estimate the number of k-mers occurring 0, 1, 2, and 3 times in reads. This step is necessary as the observed numbers of k-mers occurring 0 to 3 times are likely biased due to the existence of low abundance species and sequence errors [<xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR22">22</xref>,<xref ref-type="bibr" rid="CR33">33</xref>]. In fact, after estimating these numbers by iteratively running the EM algorithm, the estimated k-mer coverage becomes much closer to the actual ones. For instance, the predicted k-mer coverage, λ, for the first four groups was changed from (3.88, 11.14, 16.57, 23.61) to (3.34, 6.67, 13.05, 22.98), respectively, and the actual λ was (3.49, 5.83, 12.48, 20.52). The other step is to remove the small groups of k-mers (the estimated genome sizes corresponding to these groups are smaller than 400,000). By removing these small groups and reassigning k-mers, the estimated species abundance, α, becomes much closer to the actual α. For instance, after this step, α for the first four groups was changed from (31.59%, 16.01%, 25.79%, 24.33%) to (16.93%, 11.55%, 23.09%, 48.43%), respectively, while the actual α was (6.98%, 11.36%, 29.95%, 51.70%). These two steps make the EM algorithm in MBBC different from the one implemented in AbundanceBin [<xref ref-type="bibr" rid="CR14">14</xref>], which always separates k-mers into two groups, even when reads are from more than two species, and neglects the inaccuracy of the observed numbers of k-mers occurring 0, 1, 2, 3 times in reads.</p>
      <p>Figure <xref rid="Fig1" ref-type="fig">1</xref> illustrates the importance of the inferred Markov properties to the accuracy of MBBC as well. It is well known that different microbial genomes often follow different Markov properties [<xref ref-type="bibr" rid="CR34">34</xref>,<xref ref-type="bibr" rid="CR35">35</xref>]. Previous studies, such as [<xref ref-type="bibr" rid="CR11">11</xref>], have utilized these properties to assign reads longer than 1000 base pairs in metagenomic studies. Regarding short reads, such as 75 base pairs long reads, it is unlikely to reasonably infer the Markov properties they may have from individual reads. By assuming that most reads grouped by the EM algorithm are likely from one OTU, we have reliably inferred the Markov properties that most reads in a group follow and further filtered reads from other OTUs. To our knowledge, such a strategy has not been explored before. From Figure <xref rid="Fig1" ref-type="fig">1</xref>, it is clear that this strategy significantly improves the accuracy of read clustering, which is shown in the generally more accurate estimation of genome sizes and relative species abundance.</p>
      <p>To investigate how the change in genome coverage ratios affects the accuracy of the estimation, we applied MBBC to simulated datasets with all genome coverage ratios larger or smaller than 2, using the first three species in the above example. The above example demonstrated that MBBC reliably estimates the species number, genome sizes, relative species abundance, and k-mer coverage. We noticed that the species number was still accurately predicted even when the genome coverage ratios were smaller than 2 (Table <xref rid="Tab1" ref-type="table">1</xref>). Moreover, as expected, we observed that when the genome coverage ratios were larger than 2, the predicted genome sizes and k-mer coverage were in general closer to the actual ones than those with genome coverage ratios smaller than 2 (Table <xref rid="Tab1" ref-type="table">1</xref>). In addition, the prediction still agreed well when the genome coverage ratios were smaller than 2. For instance, for the third species (<italic>sps</italic>), the predicted genome size, relative species abundance, and k-mer coverage was 1,139,322 base pairs, 0.5202, and 10.95, respectively, whereas the actual one was 1,107,344 base pairs, 0.5541, and 10.53, respectively (Table <xref rid="Tab1" ref-type="table">1</xref>).<table-wrap id="Tab1"><label>Table 1</label><caption><p><bold>Prediction by MBBC on datasets with different genome coverage ratios or species composition</bold></p></caption><table frame="hsides" rules="groups"><thead><tr valign="top"><th><bold>Datasets</bold></th><th><bold>Predicted genome sizes</bold></th><th><bold>Actual genome sizes</bold></th><th><bold>Predicted relative abundance</bold></th><th><bold>Actual relative abundance</bold></th><th><bold>Predicted k-mer coverage</bold></th><th><bold>Actual k-mer coverage</bold></th></tr></thead><tbody><tr valign="top"><td rowspan="4">spa4spd8sps18spt32</td><td>1498994</td><td>1160554</td><td>9.42%</td><td>6.98%</td><td>3.34</td><td>3.49</td></tr><tr valign="top"><td>825923</td><td>945296</td><td>10.35%</td><td>11.36%</td><td>6.67</td><td>5.83</td></tr><tr valign="top"><td>1138156</td><td>1107344</td><td>27.91%</td><td>29.95%</td><td>13.05</td><td>12.48</td></tr><tr valign="top"><td>1212248</td><td>1075140</td><td>52.33%</td><td>51.70%</td><td>22.98</td><td>20.52</td></tr><tr valign="top"><td rowspan="3">spa4spd8sps18</td><td>1281577</td><td>1160554</td><td>16.16%</td><td>14.45%</td><td>3.24</td><td>3.49</td></tr><tr valign="top"><td>921307</td><td>945296</td><td>22.61%</td><td>23.53%</td><td>6.31</td><td>5.83</td></tr><tr valign="top"><td>1226752</td><td>1107344</td><td>61.23%</td><td>62.02%</td><td>12.83</td><td>12.48</td></tr><tr valign="top"><td rowspan="3">spa5spd8sps15</td><td>1607360</td><td>1160554</td><td>27.03%</td><td>19.36%</td><td>4.03</td><td>4.01</td></tr><tr valign="top"><td>682864</td><td>945296</td><td>20.95%</td><td>25.23%</td><td>7.36</td><td>5.83</td></tr><tr valign="top"><td>1139322</td><td>1107344</td><td>52.02%</td><td>55.41%</td><td>10.95</td><td>10.53</td></tr><tr valign="top"><td rowspan="3">spa5baa8sps15</td><td>1463372</td><td>1160554</td><td>21.50%</td><td>16.49%</td><td>4.13</td><td>4.01</td></tr><tr valign="top"><td>1318685</td><td>1596490</td><td>30.49%</td><td>36.30%</td><td>6.51</td><td>5.87</td></tr><tr valign="top"><td>1250815</td><td>1107344</td><td>48.01%</td><td>47.21%</td><td>10.80</td><td>10.53</td></tr></tbody></table><table-wrap-foot><p>Each species in each dataset is named by the first two letters of their genus name, followed by the first letter from the species name and then the genome coverage. The first dataset is the one used in Figure <xref rid="Fig1" ref-type="fig">1</xref>.</p></table-wrap-foot></table-wrap>
</p>
      <p>We also investigated the performance of MBBC with species from different genera. Intuitively, it should be easier to bin reads from species of different genera than those from the same genus, because the Markov properties of genomes from different genera may be more different than those from the same genus. When we replaced the second species in the third example above with a species from another genus, we noticed an improvement in the accuracy of MBBC (Table <xref rid="Tab1" ref-type="table">1</xref>). For instance, the estimated k-mer coverage of the replaced species was 6.51, compared with 5.87, the actual k-mer coverage of this species. Conversely, the estimated k-mer coverage of the second species before replacement was 7.36, compared with the actual k-mer coverage of 5.83. Because two species were from the same genus in this example, we further generated three additional datasets using species from different phyla. We found that the overall accuracy predicted was improved when species were from different phyla instead of the same genus (Additional file <xref rid="MOESM3" ref-type="media">3</xref>).</p>
    </sec>
    <sec id="Sec4">
      <title>MBBC reliably assigns reads</title>
      <p>In addition to estimating species number, genome sizes, and k-mer coverage, another important task in metagenomic analyses is to group reads from the same OTUs together. We investigated how well MBBC binned reads in twelve simulated datasets, listed in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>. We observed that 75% to 91% of reads were correctly binned together, even when there was 1% errors in reads and some genome coverage ratios were smaller than 2 (Additional file <xref rid="MOESM2" ref-type="media">2</xref>). The accuracy of the binned reads was calculated by assuming the species to be the group with the majority of its reads and then counting how many reads were correctly assigned to these species. We also noticed that the accuracy was genus dependent, in that the accuracy of the binned reads for simulated datasets from one genus was always higher than that from another genus, regardless of whether the genome coverage ratios were smaller than 2 or there were errors in reads, implying that Markov properties of species in certain genera differed more than those of species in other genera. In addition, the genome coverage ratios affected the accuracy of read binning, in that the accuracy for datasets from the same genus was always lowest when the ratios were smaller than 2.</p>
      <p>To further investigate how the genome coverage ratios affected accuracy, we applied MBBC to datasets with different genome coverage ratios. We used the same datasets listed in Table <xref rid="Tab1" ref-type="table">1</xref>. As expected, we observed that the accuracy of read binning decreased when the genome coverage ratios decreased (Additional file <xref rid="MOESM2" ref-type="media">2</xref>). We also noticed that the accuracy was improved with species from different genera, although the genome coverage ratios were still smaller than 2, because of the consideration of Markov properties of genomes of different species. For instance, in the last two simulated datasets in Table <xref rid="Tab1" ref-type="table">1</xref>, the accuracy of read binning by MBBC was 85.39%, compared with 82.01%, when species from different genera compared with species from the same genus were used (Additional files <xref rid="MOESM2" ref-type="media">2</xref> and <xref rid="MOESM3" ref-type="media">3</xref>).</p>
    </sec>
    <sec id="Sec5">
      <title>MBBC works well in real datasets</title>
      <p>We applied MBBC to two simplified real datasets. It is a common practice to use simplified real datasets to test developed binning methods [<xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR15">15</xref>], because most species present and their abundance in original raw read datasets are unknown. One simplified real dataset was the AMD dataset [<xref ref-type="bibr" rid="CR3">3</xref>], in which long Sanger reads were used. MBBC correctly predicted the species number as 2. MBBC also almost perfectly predicted the relative abundances of the two species as 29.1% and 70.9%, as compared with the actual relative abundance as 29.03% and 70.97%. Moreover, the predicted k-mer coverage of the two species was 4.03 and 8.16, respectively, which were close to the actual coverage (5.14 and 7.35, respectively). Overall, the accuracy of read binning by MBBC in this dataset was 94.27%.</p>
      <p>The other simplified real dataset we applied MBBC to was a human gut dataset composed of 4,684,098 short Illumina raw reads from three microbial species. Unexpectedly, MBBC predicted 4 species (Table <xref rid="Tab2" ref-type="table">2</xref>). We noticed that the majority of reads in both the third and fourth groups were from the same species, the third species. Moreover, the sum of the relative abundance of the third and fourth groups was 72.48%, which was close to the relative abundance of the third species, 69.21%. The other two predicted groups agreed well with the corresponding two real species. For instance, the predicted genome size, relative coverage, and k-mer coverage of the second species were 231555 base pairs, 16.87%, and 10.24, respectively, which concurred well with the actual corresponding numbers, 2249085, 16.67%, and 10.24 (Table <xref rid="Tab2" ref-type="table">2</xref>). The accuracy of read binning by MBBC was 74.80% in this dataset, demonstrating that MBBC works well in datasets with long or short reads.<table-wrap id="Tab2"><label>Table 2</label><caption><p><bold>Prediction on the human gut dataset by MBBC</bold></p></caption><table frame="hsides" rules="groups"><thead><tr valign="top"><th/><th colspan="4"><bold>MBBC predictions</bold></th><th colspan="3"><bold>Actual numbers</bold></th></tr></thead><tbody><tr valign="top"><td>genome size</td><td>3524796</td><td>2315047</td><td>1745685</td><td>2274392</td><td>NA</td><td>2249085</td><td>NA</td></tr><tr valign="top"><td>relative abundance</td><td>11.25%</td><td>16.87%</td><td>23.33%</td><td>48.55%</td><td>14.12%</td><td>16.67%</td><td>69.21%</td></tr><tr valign="top"><td>k-mer coverage</td><td>4.48</td><td>10.24</td><td>18.78</td><td>30</td><td>8.28</td><td>10.49</td><td>18.49</td></tr></tbody></table></table-wrap>
</p>
      <p>To understand why MBBC did not automatically combine the third and fourth groups into one predicted species, we examined the mapped reads to the genome corresponding to the third species. We noticed that this genome was almost evenly divided into two halves, with coverage of approximately 18 and 30 for the two halves, respectively. Because both halves were longer than the genome size cutoff (400,000), MBBC considered them as two separate genomes. Since the two groups were from the same genome, we also compared the two Markov models learned from reads from the two halves of the genome. We used the relative entropy to measure the difference of the transition matrix of the two Markov chains. We observed that the relative entropy of the two Markov models was 1.14, which was larger than that of the Markov models of the first two species, which had a relative entropy of 0.68. Thus it makes sense that MBBC considered them to be two separate species. This result also implies that different compositions in different genome regions may contribute to different coverage of these regions in genome sequencing.</p>
    </sec>
    <sec id="Sec6">
      <title>MBBC performs better than AbundanceBin and MetaCluster</title>
      <p>We compared MBBC with two widely used taxonomy-independent methods, AbundanceBin [<xref ref-type="bibr" rid="CR14">14</xref>] and MetaCluster 5.0 [<xref ref-type="bibr" rid="CR15">15</xref>], in the twelve simulated datasets (Additional file <xref rid="MOESM1" ref-type="media">1</xref>) and two simplified real datasets mentioned above. Because AbundanceBin was developed for single-end reads, when paired-end reads were used, we ran AbundanceBin by treating the two paired-end reads as independent reads. Because MetaCluster runs on paired-end read data, we did not apply it to the AMD dataset that used single-end reads [<xref ref-type="bibr" rid="CR3">3</xref>]. Overall, MBBC outperformed the two methods in terms of the estimated species number, genome sizes, relative species abundance, k-mer coverage, and binning accuracy (Additional file <xref rid="MOESM4" ref-type="media">4</xref>).</p>
      <p>First, we compared the predicted species number in these fourteen datasets. MBBC predicted the right species number in all except one dataset. AbundanceBin and MetaCluster often cannot predict the right species number (Additional file <xref rid="MOESM4" ref-type="media">4</xref>). In the twelve simulated datasets, AbundanceBin and MetaCluster correctly predicted the species number in two and zero datasets, respectively. For the AMD dataset, AbundanceBin predicted the correct number of species. For the gut dataset, MetaCluster predicted 512 groups whereas AbundanceBin failed with only one species output. Because the species numbers were not correctly predicted, it was difficult for the two programs to predict other properties of the datasets, such as the genome sizes, the relative abundance, and the k-mer coverage of each species.</p>
      <p>Next, we compared the accuracy of read binning in the fourteen datasets (Table <xref rid="Tab3" ref-type="table">3</xref>). Because AbundanceBin and MetaCluster cannot automatically predict the right species number, we specified the known species number as input for the two programs to output the binned reads. In eleven of the twelve simulated datasets, the accuracy of MBBC was better that of the other two methods, with a median of 15% higher accuracy (Table <xref rid="Tab3" ref-type="table">3</xref>). In the only simulated dataset that MBBC did not achieve the highest accuracy, MBBC had an accuracy of 89%, slightly less than the best accuracy of 90%. AbundanceBin performed better than MetaCluster in all simulated datasets without read errors while MetaCluster performed better than AbundanceBin in simulated datasets with read errors (Table <xref rid="Tab3" ref-type="table">3</xref>). MBBC performed better in terms of estimating genome sizes, relative species abundance, etc. In the two real datasets, we also observed that MBBC had a higher accuracy than the other two methods. For instance, the accuracy of MBBC in the gut dataset was 74.80%, compared with 52.63% and 71.65% by AbundanceBin and MetaCluster, respectively.<table-wrap id="Tab3"><label>Table 3</label><caption><p><bold>Binning accuracy of MBBC, AbundanceBin and MetaCluster</bold></p></caption><table frame="hsides" rules="groups"><thead><tr valign="top"><th><bold>Datasets</bold></th><th><bold>MBBC</bold></th><th><bold>MetaCluster</bold></th><th><bold>AbundanceBin</bold></th></tr></thead><tbody><tr valign="top"><td>lag5lar11las24</td><td>91.34%</td><td>82.93%</td><td>64.60%</td></tr><tr valign="top"><td>lag4lar7las12</td><td>78.97%</td><td>77.66%</td><td>39.09%</td></tr><tr valign="top"><td>laa4lag8lar15las30</td><td>86.43%</td><td>83.49%</td><td>50.98%</td></tr><tr valign="top"><td>laa4lag8lar15las30 (no errors)</td><td>87.13%</td><td>85.64%</td><td>86.41%</td></tr><tr valign="top"><td>spa4spd9sps18</td><td>89.58%</td><td>78.68%</td><td>63.73%</td></tr><tr valign="top"><td>spa5spd8sps15</td><td>82.01%</td><td>73.71%</td><td>52.44%</td></tr><tr valign="top"><td>spa4spd8sps18spt32</td><td>87.35%</td><td>72.64%</td><td>54.60%</td></tr><tr valign="top"><td>spa4spd8sps18spt32 (no errors)</td><td>89.09%</td><td>74.43%</td><td>90.44%</td></tr><tr valign="top"><td>baa3bab7bac15</td><td>79.55%</td><td>64.83%</td><td>61.11%</td></tr><tr valign="top"><td>baa6bab10bac18</td><td>75.80%</td><td>45.12%</td><td>51.13%</td></tr><tr valign="top"><td>baa5bab10bac18bah30</td><td>75.71%</td><td>34.48%</td><td>39.25%</td></tr><tr valign="top"><td>baa5bab10bac18bah30 (no errors)</td><td>79.90%</td><td>45.82%</td><td>66.25%</td></tr><tr valign="top"><td>human gut dataset</td><td>74.94%</td><td>71.65%</td><td>52.63%</td></tr><tr valign="top"><td>AMD dataset</td><td>94.14%</td><td>NA</td><td>73.42%</td></tr></tbody></table></table-wrap>
</p>
      <p>Finally, we compared the speed of the three methods to bin reads in the fourteen datasets (Additional file <xref rid="MOESM5" ref-type="media">5</xref>). All comparisons were performed on the same computer with the following configuration: Intel® Core™ i5-3210 M CPU @ 2.50GHz and 8G RAM. The stacked bars in the additional file <xref rid="MOESM5" ref-type="media">5</xref> displayed the running time of each method on these datasets. We observed that when species number was unknown, the other two methods usually required much more time. When species number was known, MetaCluster was faster (~36.40%) than MBBC, but it only binned reads, and did not predict parameters such as genome sizes, relative species abundance, etc. The most time-consuming part of MBBC was the step to update the number of k-mers occurring 0, 1, 2, and 3 times in reads. AbundanceBin was slow even when the species number was known. This update process required more time to converge, which occupied nearly half of the total running time. Given that MBBC can predict more parameters than MetaCluster, runs faster than AbundanceBin, and can automatically and accurately predict the species number, MBBC is a useful tool for metagenomic data analyses.</p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Discussion</title>
    <p>We developed a novel approach called MBBC to bin reads from metagenomics projects. MBBC bins reads by employing two types of read composition properties that have never been considered together previously. Tested on simulated and experimental datasets, we demonstrated that MBBC could reliably determine the species number, genome sizes, relative species abundance, and k-mer coverage. Moreover, MBBC grouped reads from the same species with high accuracy. Compared with two popular taxonomy-independent methods, MBBC performed better in almost every dataset tested, with higher accuracy of read binning in both simulated and real datasets.</p>
    <p>The inferred Markov property from the binned reads contributes significantly to the success of MBBC. We demonstrated that the Markov property helped to group reads by exploring the differences among species and genera in the above. The Markov properties also help MBBC work better with errors in reads. This is because the majority positions in a read from a species still follow the Markov properties, despite the existence of a few positions with errors.</p>
    <p>The comparison of MBBC with AbundanceBin and MetaCluster may be biased by the parameters we used. Except for specifying <italic>m</italic> as the known species numbers, we used the default values of the other parameters in running AbundanceBin and MetaCluster. It is thus possible that the two tools may produce better results with other parameter choices. However, we believe that MBBC should at least behave similarly to or better than the two methods, as the Markov properties of the grouped reads that are important for correctly binning have not been utilized by the two tools.</p>
    <p>We suggest users use a large <italic>m</italic> as the initial species number. However, how should one determine this large initial <italic>m</italic>? An economical approach is to start with <italic>m</italic> as a smaller number such as 10. If no small group is discovered by the EM algorithm, one can increase <italic>m</italic> slightly, such as <italic>m</italic> = 15, until the EM algorithm produces small groups. This process will result in robust binning of reads.</p>
    <p>The above analyses were mainly based on the twelve simulated datasets and two simplified real datasets. To demonstrate how well MBBC and others perform on original raw read datasets, we also tested them on the original AMD raw read dataset and an original human gut raw read dataset (Additional file <xref rid="MOESM3" ref-type="media">3</xref>). In the original AMD dataset, at least five main species were known to present, which could be grouped into three groups with different abundance. MBBC predicted three OTUs, with reads from three species of similar abundance grouped into the same OTUs. The overall read binning accuracy was 68%, while AbundanceBin did not produce any prediction for this dataset. In the original human gut dataset composed of at least 10 known species, MBBC predicted 5 species. By further studying reads in the predicted species, we found that the predicted 5 species represented two groups of species with similar abundance. The overall read binning accuracy in this dataset was 73.51%. AbundanceBin output “nan” for this dataset, which meant that it could not work on complex datasets. MetaCluster considered most reads as “orphan” and only clustered 28% of reads for this dataset. MBBC thus performed better than AbundanceBin and MetaCluster in these two original real datasets. In addition to the original raw read datasets, we also tested MBBC on the Human Microbiome Project (HMP) real datasets and mock datasets. In the three real datasets and two mock datasets we tested, MBBC did better than AbundanceBin and MetaCluster. However, MBBC failed to distinguish species with similar abundance in a few datasets again. The analysis details of these datasets including the original AMD and gut datasets are in the additional file <xref rid="MOESM3" ref-type="media">3</xref>. These analyses demonstrated that although MBBC performed well on datasets with large abundance ratios (around 1.5 or larger) and/or datasets composed of species with distinct Markov properties, the actual metagenomic datasets were much more complicated, with many species of similar abundance (abundance ratios close to 1) and many species with complicated Markov properties (different regions of the same genome have different Markov properties). There is still much room for further methodology improvement.</p>
    <p>Two aspects may be considered to further improve MBBC. One is the assumption of the Poisson distribution of the frequency of k-mers in reads. The k-mers in reads from one species may not follow a Poisson distribution exactly, and more suitable distributions may be explored. The other aspect is the assumption of the homogeneity of a microbial genome. We demonstrated that the third species in the simplified gut dataset is not homogeneous, which is why MBBC considered it to be two different species. In the future, a better model will be necessary to take the homogeneity of microbial genomes into account when designing methods.</p>
  </sec>
  <sec id="Sec8">
    <title>Conclusions</title>
    <p>We developed a novel method for binning metagenomic reads based on clustering. This method was demonstrated to reliably predict species numbers, genome sizes, relative species abundance, and k-mer coverage in simple datasets. It also displayed a high accuracy in read binning. The free tool implementing the developed method is available at <ext-link ext-link-type="uri" xlink:href="http://eecs.ucf.edu/~xiaoman/MBBC/MBBC.html">http://eecs.ucf.edu/~xiaoman/MBBC/MBBC.html</ext-link>.</p>
  </sec>
  <sec id="Sec9" sec-type="materials|methods">
    <title>Methods</title>
    <sec id="Sec10">
      <title>Experimental datasets retrieved</title>
      <p>We used two simplified real experimental datasets, three HMP real datasets, two HMP mock datasets, and two original raw read datasets to evaluate the MBBC method. The details of the two simplified real datasets were in the following. The HMP datasets and the original real datasets were described in the additional file <xref rid="MOESM3" ref-type="media">3</xref>.</p>
      <p>One simplified real dataset was the Acid Mine Drainage (AMD) dataset [<xref ref-type="bibr" rid="CR3">3</xref>] downloaded from <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/books/NBK6860/">http://www.ncbi.nlm.nih.gov/books/NBK6860/</ext-link>. This dataset contained 180,713 single-end reads, with an average read length of 1005 base pairs long. Following a previous study [<xref ref-type="bibr" rid="CR6">6</xref>], we used the Figaro software [<xref ref-type="bibr" rid="CR36">36</xref>] to remove the vector sequences in these reads. For the remaining portions of each read, only the longest contiguous bases whose quality values were &gt; =17 were kept [<xref ref-type="bibr" rid="CR6">6</xref>]. This filtering resulted in 166,715 reads. These 166,715 reads were then mapped to two dominant species using the MuMmer software [<xref ref-type="bibr" rid="CR37">37</xref>] with the default parameters. In total, 40499 reads were mapped to the two species and used to test the binning methods.</p>
      <p>The other simplified real dataset was the human gut dataset from 15 randomly selected samples (Additional file <xref rid="MOESM1" ref-type="media">1</xref>) and downloaded from <ext-link ext-link-type="uri" xlink:href="ftp://public.genomics.org.cn/BGI/gutmeta/High_quality_reads/">ftp://public.genomics.org.cn/BGI/gutmeta/High_quality_reads/</ext-link>. There were 257,158,754 paired-end reads in this dataset, each of which was 75 base pairs long. These reads were mapped to the following three species using the software SOAP 2.21 [<xref ref-type="bibr" rid="CR38">38</xref>]: <italic>Bacteroides uniformis</italic>, <italic>Alistipes putredinis</italic>, and <italic>Ruminococcusbromii L2-63</italic>. These species were used because they were the most abundant species and/or had more complete genome sequences in the gut dataset. The command used to map reads was ./soap –a &lt; reads_a &gt; −b &lt; reads_b &gt; −D &lt; index.files &gt; −o &lt; PE_output &gt; −2 &lt; SE_output&gt;, which allowed two mismatches and indels during mapping. There were 4,684,098 reads mapped to the three genomes and used to test the metagenomic binning methods.</p>
    </sec>
    <sec id="Sec11">
      <title>Simulated datasets generated</title>
      <p>To generate simulated datasets, we randomly selected three genera that had more than 20 sequenced species in the NCBI Microbial Genome Database (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/genomes/MICROBES/microbial_taxtree.html">http://www.ncbi.nlm.nih.gov/genomes/MICROBES/microbial_taxtree.html</ext-link>). The three genera selected were <italic>Lactobacillus</italic>, <italic>Spiroplasma</italic>, and <italic>Bartonella</italic>. Next, from each genus, we randomly selected four species to generate simulated datasets (Additional file <xref rid="MOESM1" ref-type="media">1</xref>). Note that it is much more challenging to bin reads from species of the same genus than those from different genera. We then generated paired-end reads using MetaSim [<xref ref-type="bibr" rid="CR39">39</xref>] for each of the three or four species in a dataset, with the given genome coverage. We specified the read length to be 75 base pairs and simulated the reads with no error or with the empirical error model in MetaSim (~1% error rate). Similarly, we generated three simulated datasets with species from different phyla (Additional file <xref rid="MOESM3" ref-type="media">3</xref>).</p>
    </sec>
    <sec id="Sec12">
      <title>The framework of the MBBC method</title>
      <p>We developed a novel method called MBBC (Figure <xref rid="Fig2" ref-type="fig">2</xref>). Our method starts from an EM algorithm to group k-mers in reads based on their frequencies in reads. The assumption behind the k-mer grouping is that the frequency of k-mers in reads follows a mixture of Poisson distributions [<xref ref-type="bibr" rid="CR33">33</xref>]. Next, MBBC iteratively estimates the number of k-mers that occur 0 to 3 times in reads and runs the EM algorithm to estimate the parameters of the mixed Poisson distributions. The rationale behind the iterative estimation is that these numbers are either unobserved or inaccurate and thus affect the estimation of other parameters [<xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR15">15</xref>]. Next, MBBC determines the species number and initially groups reads based on the Poisson parameters. MBBC then iteratively models the Markov property of the reads in each group and reassigns reads to groups. Finally, MBBC determines the genome sizes and other metrics based on the assigned reads and the estimated parameters. The details are presented in the following.<fig id="Fig2"><label>Figure 2</label><caption><p><bold>The procedure of read clustering in MBBC.</bold> The output on the right from each of the main steps on the left is connected with the corresponding steps.</p></caption><graphic xlink:href="12859_2015_473_Fig2_HTML" id="MO2"/></fig>
</p>
    </sec>
    <sec id="Sec13">
      <title>EM algorithm for initial binning of reads</title>
      <p>We developed an EM algorithm to group reads based on the frequency of k-mers in reads, where k = 16 is chosen so that the chance that a random k-mer occurs multiple times in a microbial genome is small (&lt;1e-5). The underlying assumption of this EM algorithm is that the frequency of k-mers in reads from a microbial species follows a common distribution. Similar to previous studies [<xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR33">33</xref>], we use Poisson as the common distribution. Under this assumption, all k-mers in reads from a metagenomic project form the samples of a mixture of Poisson distributions, where the number and the parameters of the Poisson distributions are unknown. EM algorithms are widely used to address mixture problems [<xref ref-type="bibr" rid="CR33">33</xref>,<xref ref-type="bibr" rid="CR40">40</xref>], and therefore applied to initially group reads from different Poisson distributions.</p>
      <p>The EM algorithm in MBBC assumes that there are in total <italic>n</italic> different k-mers in reads in a metagenomic project that are from <italic>m</italic> different species, where <italic>m</italic> is unknown. Assume that the frequency of these k-mers in all reads, <italic>x</italic>
<sub>1</sub>, <italic>x</italic>
<sub>2</sub>, …, <italic>x</italic>
<sub><italic>n</italic></sub>, follows a mixture of <italic>m</italic> Poisson distributions with the unknown parameters <italic>λ</italic>
<sub>1</sub>, <italic>λ</italic>
<sub>2</sub>, …, <italic>λ</italic>
<sub><italic>m</italic></sub>. For any i from 1 to <italic>n</italic>, if <italic>x</italic>
<sub><italic>i</italic></sub> is from the j-th Poisson distribution, then <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ P\left({x}_i=x\right)={\alpha}_j{p}_{\mathrm{j}}\left({\lambda}_{\mathrm{j}},x\right)={\alpha}_j\frac{\lambda_j^x}{x!}{e}^{-{\lambda}_j} $$\end{document}</tex-math><mml:math id="M2"><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">j</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi mathvariant="normal">j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mfrac><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>j</mml:mi><mml:mi>x</mml:mi></mml:msubsup><mml:mrow><mml:mi>x</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2015_473_IEq1.gif"/></alternatives></inline-formula>, where <italic>α</italic>
<sub><italic>j</italic></sub> is the unknown probability that a random k-mer is from the j-th distribution and <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\displaystyle \sum_{j=1}^m{\alpha}_j=1} $$\end{document}</tex-math><mml:math id="M4"><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math><inline-graphic xlink:href="12859_2015_473_IEq2.gif"/></alternatives></inline-formula>. Intuitively, <italic>α</italic>
<sub>1</sub>, <italic>α</italic>
<sub>2</sub>, …, <italic>α</italic>
<sub><italic>m</italic></sub> represent the relative species abundance in the environment, and <italic>λ</italic>
<sub>1</sub>, <italic>λ</italic>
<sub>2</sub>, …, <italic>λ</italic>
<sub><italic>m</italic></sub> represent the k-mer coverage of the species. Because we do not know which distribution <italic>x</italic>
<sub><italic>i</italic></sub> is from, we define the missing variable <italic>y</italic>
<sub><italic>i</italic></sub>, where <italic>y</italic>
<sub><italic>i</italic></sub> = <italic>j</italic> indicates that <italic>x</italic>
<sub><italic>i</italic></sub> is from the j-th Poisson distribution. With the above notations, the log complete likelihood function of the observed data <italic>X</italic> = {<italic>x</italic>
<sub>1</sub>, <italic>x</italic>
<sub>2</sub>, …, <italic>x</italic>
<sub><italic>n</italic></sub>} and the missing data <italic>Y</italic> = {<italic>y</italic>
<sub>1</sub>, <italic>y</italic>
<sub>2</sub>, …, <italic>y</italic>
<sub><italic>n</italic></sub>} is <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \log \left(L\left(\theta; X,Y\right)\right)={\displaystyle \sum_{i=1}^n \log}\left({\alpha}_{y_i}\ast {p}_{y_i}\left({\lambda}_{y_i},{x}_i\right)\right) $$\end{document}</tex-math><mml:math id="M6"><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>θ</mml:mi><mml:mo>;</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mo>log</mml:mo></mml:mstyle><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>∗</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2015_473_IEq3.gif"/></alternatives></inline-formula>, where the parameter <italic>θ</italic> = {<italic>α</italic>
<sub>1</sub>, <italic>α</italic>
<sub>2</sub> ⋯, <italic>α</italic>
<sub><italic>m</italic></sub>; <italic>λ</italic>
<sub>1</sub>, <italic>λ</italic>
<sub>2</sub>, ⋯, <italic>λ</italic>
<sub><italic>m</italic></sub>}. The E-step of the EM algorithm is to calculate <italic>Z</italic>
<sub>ij</sub>, which is <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {Z}_{\mathrm{ij}}=P\left({y}_i=\mathrm{j}\Big|X,\theta \right)=\frac{\alpha_j\ast {p}_{\mathrm{j}}\left({\lambda}_{\mathrm{j}},{x}_i\right)}{{\displaystyle \sum_{r=1}^m{\alpha}_r\ast {p}_{\mathrm{r}}\left({\lambda}_{\mathrm{r},}{x}_i\right)}} $$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">j</mml:mi><mml:mo stretchy="true">|</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∗</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">j</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi mathvariant="normal">j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>∗</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mstyle></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2015_473_IEq4.gif"/></alternatives></inline-formula>. The M-step is to estimate the parameters in the following manner: <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\alpha}_j=\frac{1}{n}{\displaystyle \sum_{i=1}^n{Z}_{ij}} $$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math><inline-graphic xlink:href="12859_2015_473_IEq5.gif"/></alternatives></inline-formula>, <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\lambda}_j=\frac{{\displaystyle \sum_{i=1}^n{Z}_{ij}{x}_i}}{{\displaystyle \sum_{i=1}^n{Z}_{ij}}} $$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mi>λ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2015_473_IEq6.gif"/></alternatives></inline-formula>.</p>
      <p>For a given m, to apply the above EM algorithm, we initialize <italic>α</italic>
<sub><italic>j</italic></sub> = 1/<italic>m</italic>, <italic>λ</italic>
<sub><italic>j</italic></sub> = <italic>j</italic> * 10 + 10 for j from 1 to m. We then iterate the E-steps and M-steps until the difference between the updated <italic>θ</italic> and the current <italic>θ</italic> is small (&lt;1e-5). Finally, we output the current <italic>θ</italic> = {<italic>α</italic>
<sub>1</sub>, <italic>α</italic>
<sub>2</sub> ⋯, <italic>α</italic>
<sub><italic>m</italic></sub>; ⋅ <italic>λ</italic>
<sub>1</sub>, <italic>λ</italic>
<sub>2</sub>, ⋯, <italic>λ</italic>
<sub><italic>m</italic></sub>}and assign k-mers to m different groups based on <italic>θ</italic>.</p>
    </sec>
    <sec id="Sec14">
      <title>Estimation of the species number</title>
      <p>The species number m is unknown and required by the above EM algorithm. To estimate <italic>m</italic>, MBBC initializes <italic>m</italic> as a large number so that the output groups from the EM algorithm contain at least a small group that is too small to serve as a k-mer group from a microbial species. To determine whether an output group is small, MBBC first estimates the number of k-mers that occur x = 0, 1, 2, and 3 times, respectively, with the following formula: <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\displaystyle \sum_{j=1}^m\frac{p_{\mathrm{j}}\left({\lambda}_{\mathrm{j}},x\right){\displaystyle \sum_{i=1\&amp;{x}_i\ge 4}^n{Z}_{\mathrm{ij}}}}{1-{\displaystyle \sum_{s=0}^3{p}_{\mathrm{j}}\left({\lambda}_{\mathrm{j}},s\right)}}} $$\end{document}</tex-math><mml:math id="M14"><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">j</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi mathvariant="normal">j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfenced><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>&amp;</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:munderover><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">j</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi mathvariant="normal">j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math><inline-graphic xlink:href="12859_2015_473_IEq7.gif"/></alternatives></inline-formula>. With the estimated number of k-mers that occur x = 0, 1, 2, and 3 times, MBBC iteratively runs the EM algorithm using the estimated <italic>x</italic>
<sub><italic>i</italic></sub> for i from 0 to 3 and the original <italic>x</italic>
<sub><italic>i</italic></sub> for i &gt; 3 until the estimated <italic>x</italic>
<sub><italic>i</italic></sub> for i &lt; 4 do not change. The rationale to iteratively estimate <italic>x</italic>
<sub><italic>i</italic></sub> for i &lt; 4 is that these <italic>x</italic>
<sub><italic>i</italic></sub> are inaccurate because of the existence of low abundance species and sequencing errors [<xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR22">22</xref>,<xref ref-type="bibr" rid="CR33">33</xref>]. Next, MBBC estimates the genome size represented by each group of k-mers output from the EM algorithm as <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \frac{{\displaystyle \sum_{i=1}^{n\hbox{'}}{Z}_{\mathrm{ij}}\ast {x}_i}}{\lambda_{\mathrm{j}}} $$\end{document}</tex-math><mml:math id="M16"><mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mo>∗</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:msub><mml:mi>λ</mml:mi><mml:mi mathvariant="normal">j</mml:mi></mml:msub></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2015_473_IEq8.gif"/></alternatives></inline-formula>, for j from 1 to m, where n’ is used to denote that the estimated k-mers that occur fewer than 4 times are used together with other observed k-mers. Finally, MBBC labels groups of k-mers as small groups if their estimated genome sizes are smaller than 400,000, a cutoff that is smaller than the size of the sequenced smallest genome of living organisms [<xref ref-type="bibr" rid="CR14">14</xref>], and labels other groups as large groups. With the labelled groups, MBBC estimates the species number as the number of the large groups. The <italic>α</italic>
<sub><italic>j</italic></sub> for the large groups is normalized so that their sum is equal to 1. To take the k-mers initially assigned to small groups into account, MBBC then implements one more E-step to calculate <italic>Z</italic>
<sub>ij</sub> and then updates <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\alpha}_j=\frac{1}{n}{\displaystyle \sum_{i=1}^n{Z}_{ij}} $$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math><inline-graphic xlink:href="12859_2015_473_IEq9.gif"/></alternatives></inline-formula>, for i from 1 to n and j from 1 to m.</p>
    </sec>
    <sec id="Sec15">
      <title>Initial read assignment based on the inferred <italic>θ</italic></title>
      <p>With the inferred <italic>θ</italic>, MBBC measures the probability that a read belongs to the j-th species as <italic>p</italic>
<sub>j</sub>(<italic>λ</italic>
<sub>j</sub>, <italic>x</italic>), for j from 1 to m, where x is the median frequency of the k-mers in this read. MBBC then sorts these probabilities from largest to smallest for each read. For a read, if its largest probability minus the second largest probability is larger than a cutoff C (C = 0.5), this read will be assigned to the species corresponding to the largest probability. When paired-end reads are used in a project, MBBC assigns two paired reads to the same species when at least one read can be assigned and there is no conflict between the assignments of the two reads. In this way, MBBC obtains m + 1 groups of read, one of which corresponds to the unassigned reads. In case that there are more than 50% of reads unassigned, MBBC reduces C by 0.01 and repeats this process until at least half of the reads in the datasets are assigned to the m groups that correspond to m species.</p>
    </sec>
    <sec id="Sec16">
      <title>Final read assignment based on the Markov property</title>
      <p>The final assignment of reads is performed by iteratively inferring a 5-th order Markov chain for each group, except for the group corresponding to unassigned reads, and reassigning reads to each group. The rationale of modelling a group of reads by a Markov chain is that most reads in each of the m groups are likely from the same species and Markov chains are widely used to model the microbial genome sequences [<xref ref-type="bibr" rid="CR41">41</xref>,<xref ref-type="bibr" rid="CR42">42</xref>]. In brief, starting from the initially assigned reads in a group, MBBC counts 6-mer frequencies in these reads to obtain the transition matrix and the stationary probability of the Markov chain. Next, MBBC scores all reads in this group using the inferred Markov model and obtains the beta percentile of the score distribution. This percentile is used as a cutoff to determine whether a read belongs to a species. The beta used by MBBC in all tested datasets is 10%. MBBC then scores each read with m trained models and finds the model with the best score for each read. If the best score is larger than the corresponding cutoff, this read is assigned to the species corresponding to the best score. Otherwise, the read is not assigned. With all reads scored and assigned, we have a new set of <italic>m</italic> + <italic>1</italic> groups of reads and infer the Markov models for the m groups again. This process of inferring the Markov models and assigning reads is iteratively implemented, with the beta decreased to beta/2 after one iteration, until the assigned reads in the m + 1 groups do not change. With the final assigned reads, MBBC estimates the genome size of each species using the total number of k-mers in each group divided by the estimated k-mer coverage.</p>
    </sec>
    <sec id="Sec17">
      <title>Comparisons with abundancebin and MetaCluster 5.0</title>
      <p>To run MBBC, we used the following command for each dataset: java –jar –Xmx7g MBBC.jar –i reads_file -m species_number –r read_type, where m was set to be 10, and the read_type = 1 indicates single-end reads and read_type = 0 means paired-end reads. With the known species number <italic>m</italic> as input, we ran AbundanceBin [<xref ref-type="bibr" rid="CR14">14</xref>] using the command “./abundancebin -input reads_file -bin_num m”. We ran MetaCluster 5.0 [<xref ref-type="bibr" rid="CR15">15</xref>] by the command “./ MetaCluster5_1 reads_file --Species m’” for species with the genome coverage larger than 6 first and then using the command “./ MetaCluster5_2 reads_file.2 --Species m” for the species with the genome coverage smaller than 6. When the species number was assumed to be unknown, we ran AbundanceBin and MetaCluster 5.0 using the command “./abundancebin -input reads_file -RECURSIVE_CLASSIFICATION” and “./ MetaCluster5_1 reads_file” followed by “./ MetaCluster5_2 reads_file.2”, respectively.</p>
    </sec>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec18">
        <title>Additional files</title>
        <p>
          <media position="anchor" xlink:href="12859_2015_473_MOESM1_ESM.docx" id="MOESM1">
            <label>Additional file 1: Table S1.</label>
            <caption>
              <p>The human gut dataset from 15 randomly selected samples; <bold>Table S2.</bold> Mapped reads of each of the three species in the human gut dataset; <bold>Table S3.</bold> 12 randomly selected species from three genera; <bold>Table S4.</bold> 12 simulated datasets.</p>
            </caption>
          </media>
          <media position="anchor" xlink:href="12859_2015_473_MOESM2_ESM.docx" id="MOESM2">
            <label>Additional file 2: Table S1.</label>
            <caption>
              <p>Read binning accuracy of MBBC on each of 12 simulated datasets; <bold>Table S2.</bold> MBBC predicted the genome sizes, relative abundance, and the k-mer coverage in each of 12 simulated datasets; <bold>Table S3.</bold> Read binning accuracy of MBBC on datasets listed in Table <xref rid="Tab1" ref-type="table">1</xref>.</p>
            </caption>
          </media>
          <media position="anchor" xlink:href="12859_2015_473_MOESM3_ESM.docx" id="MOESM3">
            <label>Additional file 3: S1.</label>
            <caption>
              <p>MBBC, AbundanceBin and MetaCluster on additional simulated datasets with species from different phyla; <bold>S2.</bold> MBBC, AbundanceBin and MetaCluster on HMP real datasets; <bold>S3.</bold> MBBC and AbundanceBin on HMP mock datasets; <bold>S4.</bold> MBBC, AbundanceBin and MetaCluster on original AMD raw read dataset; <bold>S5.</bold> MBBC, AbundanceBin, and MetaCluster on original human gut raw read dataset.</p>
            </caption>
          </media>
          <media position="anchor" xlink:href="12859_2015_473_MOESM4_ESM.docx" id="MOESM4">
            <label>Additional file 4: Table S1.</label>
            <caption>
              <p>The number of species predicted by MetaCluster and AbundanceBin on 12 simulated datasets and 2 real datasets without inputting the correct species numbers; <bold>Table S2.</bold> The prediction by AbundanceBin and MetaCluster with the correct species number specified.</p>
            </caption>
          </media>
          <media position="anchor" xlink:href="12859_2015_473_MOESM5_ESM.tiff" id="MOESM5">
            <label>Additional file 5:</label>
            <caption>
              <p>
                <bold>The total running time of each method on different datasets.</bold>
              </p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>MBBC</term>
        <def>
          <p>Metagenomic binning based on composition</p>
        </def>
      </def-item>
      <def-item>
        <term>OTUs</term>
        <def>
          <p>Operative taxonomical units</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Competing interests</bold>
      </p>
      <p>The authors declare that they have no competing interests.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors’ contributions</bold>
      </p>
      <p>HH and XL conceived of the idea and wrote the manuscript. All experimental work was conducted by YW. All authors read and approved the final manuscript.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>This work is supported by the National Science Foundation [grants 1149955, 1356524, and 1218275]. Funding for open access charge: The National Science Foundation grant 1218275.</p>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Venter</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Remington</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Heidelberg</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Halpern</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Rusch</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Eisen</surname>
            <given-names>JA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Environmental genome shotgun sequencing of the Sargasso Sea</article-title>
        <source>Science</source>
        <year>2004</year>
        <volume>304</volume>
        <fpage>66</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1093857</pub-id>
        <pub-id pub-id-type="pmid">15001713</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eisen</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Environmental shotgun sequencing: its potential and challenges for studying the hidden world of microbes</article-title>
        <source>PLoS Biol</source>
        <year>2007</year>
        <volume>5</volume>
        <fpage>e82</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pbio.0050082</pub-id>
        <pub-id pub-id-type="pmid">17355177</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tyson</surname>
            <given-names>GW</given-names>
          </name>
          <name>
            <surname>Chapman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Ram</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>PM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Community structure and metabolism through reconstruction of microbial genomes from the environment</article-title>
        <source>Nature</source>
        <year>2004</year>
        <volume>428</volume>
        <fpage>37</fpage>
        <lpage>43</lpage>
        <pub-id pub-id-type="doi">10.1038/nature02340</pub-id>
        <pub-id pub-id-type="pmid">14961025</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leung</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Yiu</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A robust and accurate binning algorithm for metagenomic sequences with arbitrary species abundance ratio</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>1489</fpage>
        <lpage>95</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr186</pub-id>
        <pub-id pub-id-type="pmid">21493653</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schreiber</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Gumrich</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Daniel</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Meinicke</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Treephyler: fast taxonomic profiling of metagenomes</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>960</fpage>
        <lpage>1</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq070</pub-id>
        <pub-id pub-id-type="pmid">20172941</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brady</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Phymm and PhymmBL: metagenomic phylogenetic classification with interpolated Markov models</article-title>
        <source>Nat Methods</source>
        <year>2009</year>
        <volume>6</volume>
        <fpage>673</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1358</pub-id>
        <pub-id pub-id-type="pmid">19648916</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Diaz</surname>
            <given-names>NN</given-names>
          </name>
          <name>
            <surname>Krause</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Goesmann</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Niehaus</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Nattkemper</surname>
            <given-names>TW</given-names>
          </name>
        </person-group>
        <article-title>TACOA: taxonomic classification of environmental genomic fragments using a kernelized nearest neighbor approach</article-title>
        <source>BMC Bioinformatics</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>56</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-10-56</pub-id>
        <pub-id pub-id-type="pmid">19210774</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gerlach</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Junemann</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tille</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Goesmann</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stoye</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>WebCARMA: a web application for the functional and taxonomic classification of unassembled metagenomic reads</article-title>
        <source>BMC Bioinformatics</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>430</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-10-430</pub-id>
        <pub-id pub-id-type="pmid">20021646</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huson</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Auch</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Qi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Schuster</surname>
            <given-names>SC</given-names>
          </name>
        </person-group>
        <article-title>MEGAN analysis of metagenomic data</article-title>
        <source>Genome Res</source>
        <year>2007</year>
        <volume>17</volume>
        <fpage>377</fpage>
        <lpage>86</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.5969107</pub-id>
        <pub-id pub-id-type="pmid">17255551</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krause</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Diaz</surname>
            <given-names>NN</given-names>
          </name>
          <name>
            <surname>Goesmann</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kelley</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nattkemper</surname>
            <given-names>TW</given-names>
          </name>
          <name>
            <surname>Rohwer</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phylogenetic classification of short environmental DNA fragments</article-title>
        <source>Nucleic Acids Res</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>2230</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkn038</pub-id>
        <pub-id pub-id-type="pmid">18285365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McHardy</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>HG</given-names>
          </name>
          <name>
            <surname>Tsirigos</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Rigoutsos</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Accurate phylogenetic classification of variable-length DNA fragments</article-title>
        <source>Nat Methods</source>
        <year>2007</year>
        <volume>4</volume>
        <fpage>63</fpage>
        <lpage>72</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth976</pub-id>
        <pub-id pub-id-type="pmid">17179938</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Chatterji</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yamazaki</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bai</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Eisen</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>CompostBin: A DNA Composition-Based Algorithm for Binning Environmental Shotgun Reads</article-title>
        <source>Proceedings of the 12th annual international conference on Research in computational molecular biology</source>
        <year>2008</year>
        <publisher-loc>Berlin, Heidelberg</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <fpage>17</fpage>
        <lpage>28</lpage>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Yiu</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Chin</surname>
            <given-names>FY</given-names>
          </name>
        </person-group>
        <article-title>Unsupervised binning of environmental genomic fragments based on an error robust selection of l-mers</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <issue>Suppl 2</issue>
        <fpage>S5</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-S2-S5</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>A Novel Abundance-Based Algorithm for Binning Metagenomic Sequences Using l-Tuples</article-title>
        <source>Research in Computational Molecular Biology, 14th Annual International Conference, RECOMB 2010; April 25–28, 2010</source>
        <year>2010</year>
        <publisher-loc>Lisbon, Portugal</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <fpage>535</fpage>
        <lpage>49</lpage>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Yiu</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Chin</surname>
            <given-names>FY</given-names>
          </name>
        </person-group>
        <article-title>MetaCluster 5.0: a two-round binning approach for metagenomic data for low-abundance species in a noisy sample</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>i356</fpage>
        <lpage>62</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts397</pub-id>
        <pub-id pub-id-type="pmid">22962452</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ghosh</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Monzoorul Haque</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mande</surname>
            <given-names>SS</given-names>
          </name>
        </person-group>
        <article-title>DiScRIBinATE: a rapid method for accurate taxonomic classification of metagenomic sequences</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <issue>Suppl 7</issue>
        <fpage>S14</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-S7-S14</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Horton</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bodenhausen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bergelson</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>MARTA: a suite of Java-based tools for assigning taxonomic status to DNA sequences</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>568</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp682</pub-id>
        <pub-id pub-id-type="pmid">20007739</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Matsen</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Kodner</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Armbrust</surname>
            <given-names>EV</given-names>
          </name>
        </person-group>
        <article-title>pplacer: linear time maximum-likelihood and Bayesian phylogenetic placement of sequences onto a fixed reference tree</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>538</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-538</pub-id>
        <pub-id pub-id-type="pmid">21034504</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Monzoorul Haque</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ghosh</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Komanduri</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mande</surname>
            <given-names>SS</given-names>
          </name>
        </person-group>
        <article-title>SOrt-ITEMS: Sequence orthology based approach for improved taxonomic estimation of metagenomic sequences</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1722</fpage>
        <lpage>30</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp317</pub-id>
        <pub-id pub-id-type="pmid">19439565</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stark</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>von Mering</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>MLTreeMap–accurate Maximum Likelihood placement of environmental DNA sequences into taxonomic and functional reference phylogenies</article-title>
        <source>BMC Genomics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>461</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-11-461</pub-id>
        <pub-id pub-id-type="pmid">20687950</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Eisen</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>A simple, fast, and accurate method of phylogenomic inference</article-title>
        <source>Genome Biol</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>R151</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2008-9-10-r151</pub-id>
        <pub-id pub-id-type="pmid">18851752</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mande</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Mohammed</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Ghosh</surname>
            <given-names>TS</given-names>
          </name>
        </person-group>
        <article-title>Classification of metagenomic sequences: methods and challenges</article-title>
        <source>Brief Bioinform</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>669</fpage>
        <lpage>81</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbs054</pub-id>
        <pub-id pub-id-type="pmid">22962338</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meyer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Paarmann</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>D’Souza</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Olson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Glass</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Kubal</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The metagenomics RAST server–a public resource for the automatic phylogenetic and functional analysis of metagenomes</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>386</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-386</pub-id>
        <pub-id pub-id-type="pmid">18803844</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patil</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Haider</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Pope</surname>
            <given-names>PB</given-names>
          </name>
          <name>
            <surname>Turnbaugh</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Morrison</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Scheffer</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Taxonomic metagenome sequence assignment with structured output models</article-title>
        <source>Nat Methods</source>
        <year>2011</year>
        <volume>8</volume>
        <fpage>191</fpage>
        <lpage>2</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth0311-191</pub-id>
        <pub-id pub-id-type="pmid">21358620</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Apweiler</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bairoch</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Barker</surname>
            <given-names>WC</given-names>
          </name>
          <name>
            <surname>Boeckmann</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ferro</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>UniProt: the Universal Protein knowledgebase</article-title>
        <source>Nucleic Acids Res</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>D115</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkh131</pub-id>
        <pub-id pub-id-type="pmid">14681372</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Punta</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Coggill</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Eberhardt</surname>
            <given-names>RY</given-names>
          </name>
          <name>
            <surname>Mistry</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tate</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Boursnell</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Pfam protein families database</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>D290</fpage>
        <lpage>301</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr1065</pub-id>
        <pub-id pub-id-type="pmid">22127870</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pati</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Heath</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>Kyrpides</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Ivanova</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>ClaMS: a classifier for metagenomic sequences</article-title>
        <source>Stand Genomic Sci</source>
        <year>2011</year>
        <volume>5</volume>
        <fpage>248</fpage>
        <pub-id pub-id-type="doi">10.4056/sigs.2075298</pub-id>
        <pub-id pub-id-type="pmid">22180827</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chan</surname>
            <given-names>C-KK</given-names>
          </name>
          <name>
            <surname>Hsu</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Halgamuge</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>S-L</given-names>
          </name>
        </person-group>
        <article-title>Binning sequences using very sparse labels within a metagenome</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>215</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-215</pub-id>
        <pub-id pub-id-type="pmid">18442374</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bentley</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Parkhill</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Comparative genomic structure of prokaryotes</article-title>
        <source>Annu Rev Genet</source>
        <year>2004</year>
        <volume>38</volume>
        <fpage>771</fpage>
        <lpage>92</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev.genet.38.072902.094318</pub-id>
        <pub-id pub-id-type="pmid">15568993</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Teeling</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Meyerdierks</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bauer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Amann</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Glockner</surname>
            <given-names>FO</given-names>
          </name>
        </person-group>
        <article-title>Application of tetranucleotide frequencies for the assignment of genomic fragments</article-title>
        <source>Environ Microbiol</source>
        <year>2004</year>
        <volume>6</volume>
        <fpage>938</fpage>
        <lpage>47</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1462-2920.2004.00624.x</pub-id>
        <pub-id pub-id-type="pmid">15305919</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Teeling</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Glockner</surname>
            <given-names>FO</given-names>
          </name>
        </person-group>
        <article-title>Current opportunities and challenges in microbial metagenome analysis–a bioinformatic perspective</article-title>
        <source>Brief Bioinform</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>728</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbs039</pub-id>
        <pub-id pub-id-type="pmid">22966151</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dempster</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Laird</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Maximum Likelihood from Incomplete Data via the EM Algorithm</article-title>
        <source>J R Stat Soc</source>
        <year>1977</year>
        <volume>39</volume>
        <fpage>1</fpage>
        <lpage>38</lpage>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Waterman</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>Estimating the repeat structure and length of DNA sequences using L-tuples</article-title>
        <source>Genome Res</source>
        <year>2003</year>
        <volume>13</volume>
        <fpage>1916</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="pmid">12902383</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rosen</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Garbarine</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Caseiro</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Polikar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sokhansanj</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Metagenome fragment classification using N-mer frequency profiles</article-title>
        <source>Adv Bioinformatics</source>
        <year>2008</year>
        <volume>2008</volume>
        <fpage>205969</fpage>
        <pub-id pub-id-type="doi">10.1155/2008/205969</pub-id>
        <pub-id pub-id-type="pmid">19956701</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Delcher</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Kasif</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Microbial gene identification using interpolated Markov models</article-title>
        <source>Nucleic Acids Res</source>
        <year>1998</year>
        <volume>26</volume>
        <fpage>544</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/26.2.544</pub-id>
        <pub-id pub-id-type="pmid">9421513</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>White</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Roberts</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yorke</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Figaro: a novel statistical method for vector sequence removal</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>462</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm632</pub-id>
        <pub-id pub-id-type="pmid">18202027</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Delcher</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Using MUMmer to identify similar regions in large sequence sets</article-title>
        <source>Curr Protoc Bioinformatics</source>
        <year>2003</year>
        <volume>Chapter 10</volume>
        <fpage>10</fpage>
        <lpage>3</lpage>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>TW</given-names>
          </name>
          <name>
            <surname>Yiu</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Kristiansen</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SOAP2: an improved ultrafast tool for short read alignment</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1966</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp336</pub-id>
        <pub-id pub-id-type="pmid">19497933</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Richter</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Ott</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Auch</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Schmid</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Huson</surname>
            <given-names>DH</given-names>
          </name>
        </person-group>
        <article-title>MetaSim: a sequencing simulator for genomics and metagenomics</article-title>
        <source>PLoS One</source>
        <year>2008</year>
        <volume>3</volume>
        <fpage>e3373</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0003373</pub-id>
        <pub-id pub-id-type="pmid">18841204</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>VX</given-names>
          </name>
          <name>
            <surname>Paik</surname>
            <given-names>HH</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A mixture model-based discriminate analysis for identifying ordered transcription factor binding site pairs in gene promoters directly regulated by estrogen receptor-alpha</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>2210</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl329</pub-id>
        <pub-id pub-id-type="pmid">16809387</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pride</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Meinersmann</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Wassenaar</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Blaser</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Evolutionary implications of microbial genome tetranucleotide frequency biases</article-title>
        <source>Genome Res</source>
        <year>2003</year>
        <volume>13</volume>
        <fpage>145</fpage>
        <lpage>58</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.335003</pub-id>
        <pub-id pub-id-type="pmid">12566393</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Audic</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Claverie</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Self-identification of protein-coding regions in microbial genomes</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>1998</year>
        <volume>95</volume>
        <fpage>10026</fpage>
        <lpage>31</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.95.17.10026</pub-id>
        <pub-id pub-id-type="pmid">9707594</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
