<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20031101//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput. Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">ploscomp</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2770120</article-id>
    <article-id pub-id-type="pmid">19911049</article-id>
    <article-id pub-id-type="publisher-id">09-PLCB-RA-0348R3</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1000562</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline">
        <subject>Computational Biology/Sequence Motif Analysis</subject>
        <subject>Computational Biology/Transcriptional Regulation</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Discovery of Regulatory Elements is Improved by a Discriminatory Approach</article-title>
      <alt-title alt-title-type="running-head">Discriminatory Discovery of Regulatory Elements</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Valen</surname>
          <given-names>Eivind</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sandelin</surname>
          <given-names>Albin</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Winther</surname>
          <given-names>Ole</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Krogh</surname>
          <given-names>Anders</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>The Bioinformatics Centre, Department of Biology and the Biotech Research and Innovation Centre (BRIC), University of Copenhagen, Copenhagen, Denmark</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>DTU Informatics, Technical University of Denmark, Lyngby, Denmark</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Wasserman</surname>
          <given-names>Wyeth W.</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">University of British Columbia, Canada</aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>eivind@binf.ku.dk</email></corresp>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: EV AS OW AK. Performed the experiments: EV. Analyzed the data: EV. Wrote the paper: EV AS OW AK.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>11</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>11</month>
      <year>2009</year>
    </pub-date>
    <volume>5</volume>
    <issue>11</issue>
    <elocation-id>e1000562</elocation-id>
    <history>
      <date date-type="received">
        <day>3</day>
        <month>4</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>10</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Valen et al.</copyright-statement>
      <copyright-year>2009</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>A major goal in post-genome biology is the complete mapping of the gene regulatory networks for every organism. Identification of regulatory elements is a prerequisite for realizing this ambitious goal. A common problem is finding regulatory patterns in promoters of a group of co-expressed genes, but contemporary methods are challenged by the size and diversity of regulatory regions in higher metazoans. Two key issues are the small amount of information contained in a pattern compared to the large promoter regions and the repetitive characteristics of genomic DNA, which both lead to “pattern drowning”. We present a new computational method for identifying transcription factor binding sites in promoters using a discriminatory approach with a large negative set encompassing a significant sample of the promoters from the relevant genome. The sequences are described by a probabilistic model and the most discriminatory motifs are identified by maximizing the probability of the sets given the motif model and prior probabilities of motif occurrences in both sets. Due to the large number of promoters in the negative set, an enhanced suffix array is used to improve speed and performance. Using our method, we demonstrate higher accuracy than the best of contemporary methods, high robustness when extending the length of the input sequences and a strong correlation between our objective function and the correct solution. Using a large background set of real promoters instead of a simplified model leads to higher discriminatory power and markedly reduces the need for repeat masking; a common pre-processing step for other pattern finders.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author Summary</title>
      <p>In the years following the sequencing of the human genome focus have shifted towards trying to understand how this blueprint results in the diversity of cells that we observe. Part of the answer lies in the regulation of transcription and how the proteins responsible for this recognize where they should attach to the DNA. This is a well studied problem, but most methods developed for this have a hard time dealing with the heterogeneity of the mammalian genomes. Here we present a method that greatly improves the efficiency of this search by contrasting the DNA with a large number of background DNA sequences. This enables us to handle repetitive segments of the genome that may be functional, but are usually considered intractable by most methods.</p>
    </abstract>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>The rapid emergence of experimental techniques that can probe for functional elements at whole-genome scales<xref rid="pcbi.1000562-Birney1" ref-type="bibr">[1]</xref> necessitates computational methods to analyze data in these settings. In particular, methods that locate promoters or measure gene expression on genome-wide scales (e.g. <xref rid="pcbi.1000562-Carninci1" ref-type="bibr">[2]</xref>,<xref rid="pcbi.1000562-Kim1" ref-type="bibr">[3]</xref>) must be complemented by algorithms that can find the active regulatory elements within the larger promoters. <italic>Ab initio</italic> computational search for transcription factor binding sites (TFBS) in DNA sequences is often termed “motif discovery”. “Motif” here refers to a general pattern describing what DNA sequences the transcription factor binds<xref rid="pcbi.1000562-Stormo1" ref-type="bibr">[4]</xref>. Motif discovery is one of the classical problems in computational sequence analysis and can be briefly stated as: Given a set of sequences containing one or several short overrepresented sites, locate these and produce a model describing them.</p>
    <p>There are two main avenues used to attack this problem: i) enumerative algorithms based on word counting, such as <xref rid="pcbi.1000562-Pavesi1" ref-type="bibr">[5]</xref>,<xref rid="pcbi.1000562-Sinha1" ref-type="bibr">[6]</xref>, and ii) pattern-based approaches often using position specific weight matrices (WMs), which scores sites based on position specific weights <xref rid="pcbi.1000562-Stormo1" ref-type="bibr">[4]</xref>. Since the binding preferences of transcription factors (TFs) are not easily captured by a single word or consensus string, pattern-based approaches can give solutions closer to the biological reality and it has been argued that the matrix score is related to the binding energy <xref rid="pcbi.1000562-Stormo2" ref-type="bibr">[7]</xref>,<xref rid="pcbi.1000562-Berg1" ref-type="bibr">[8]</xref>. However, such approaches correspond to the problem of finding local, optimal multiple alignments, which is NP-complete <xref rid="pcbi.1000562-Wang1" ref-type="bibr">[9]</xref>. Therefore, almost all pattern-based motif finders use statistical optimization methods such as Gibbs sampling or expectation maximization <xref rid="pcbi.1000562-Cardon1" ref-type="bibr">[10]</xref>,<xref rid="pcbi.1000562-Lawrence1" ref-type="bibr">[11]</xref>.</p>
    <p>A typical instance of motif discovery starts with a set of upstream promoter regions of co-expressed genes suspected to be co-regulated and by extension more likely to be under control by the same regulatory machinery. This set is called the “positive set” and most methods proceed from here by locating motifs that are in some way statistically overrepresented in this set. The most successful applications of motif discovery have been in organisms whose regulatory information is densely aggregated around transcription start sites, such as <italic>Saccharomyces cerevisiae</italic> (baker's yeast). In mammalian genomes, regulatory information is spread out over wider regions, which makes “pattern drowning” a significant issue; in other words, the information in the regulatory sites is too small to stand out in the large genomic region of interest. In this context, the accuracy of contemporary pattern finders is not sufficient for many biologically important problems <xref rid="pcbi.1000562-Tompa1" ref-type="bibr">[12]</xref>.</p>
    <p>Most methods operate with some notion of a background model describing “generic DNA” against which the over-representation is measured. The model is often a multinomial or a Markov model. The choice of model is important for obtaining good results <xref rid="pcbi.1000562-Thijs1" ref-type="bibr">[13]</xref>,<xref rid="pcbi.1000562-Down1" ref-type="bibr">[14]</xref>. However, most such models have difficulty in capturing the complexity of the highly heterogeneous mammalian genome sequence, which has a multitude of different promoter architectures<xref rid="pcbi.1000562-Carninci2" ref-type="bibr">[15]</xref>, numerous interspersed repeats, low complexity sequences, CpG islands, etc. <xref rid="pcbi.1000562-Lander1" ref-type="bibr">[16]</xref>. Instead of simplifying the underlying DNA sequence by a general model, we take this to its extreme conclusion and use a very large set of promoters as the actual background instead of building a model describing the sequences in the promoters. For simplicity, we use the term “negative set” to describe the background set; this is strictly speaking not true as sites could occur in this set at a much lower frequency, since real promoters are sampled randomly. By contrasting the sets, it is possible to see what common features make the sequences in the positive set unique.</p>
    <p>Discriminatory motif searching is not a new idea; several methods have been developed that take advantage of a negative set <xref rid="pcbi.1000562-Workman1" ref-type="bibr">[17]</xref>–<xref rid="pcbi.1000562-Narlikar1" ref-type="bibr">[24]</xref>. However, many of these use word-based models <xref rid="pcbi.1000562-Sinha2" ref-type="bibr">[19]</xref>–<xref rid="pcbi.1000562-Sumazin1" ref-type="bibr">[21]</xref>, which might not capture the diversity of binding sites. Others again use PWMs, but have binary hit models that do not distinguish between hits as long as they are over a threshold <xref rid="pcbi.1000562-Leung1" ref-type="bibr">[22]</xref>. A discriminatory approach similar to ours has been combined with the use of expression data <xref rid="pcbi.1000562-Segal1" ref-type="bibr">[18]</xref>, but depending on the regions that are being investigated this might often not be available or even possible. We adopt an approach similar to DEME <xref rid="pcbi.1000562-Redhead1" ref-type="bibr">[23]</xref> to identify the most discriminative set of motifs by modeling the sequence labels (positive or negative) rather than using the conventional generative approach<xref rid="pcbi.1000562-Cardon1" ref-type="bibr">[10]</xref>,<xref rid="pcbi.1000562-Lawrence1" ref-type="bibr">[11]</xref>. However, there are some important differences to DEME. Firstly, DEME uses a global string-based search followed by a local gradient refinement, which may miss patterns that are not well-represented by a consensus string, whereas we use a global optimization technique (simulated annealing) for optimizing the model, which does not have this limitation, although it may have others (see below). Secondly, our method (Motif Annealer - MoAn) uses and optimizes a threshold, and uses an enhanced suffix array (ESA) to speed up pattern searches. Thirdly, in MoAn the length of the motif is also optimized. DEME is also particularly targeted towards proteins while our approach is intended for use with DNA.</p>
    <p>Specifically, we use conditional maximum likelihood to estimate the WMs and their thresholds such that the probability of the positive and negative sets is maximized (see <xref ref-type="sec" rid="s4">Methods</xref>). Thus, the resulting matrices cannot be derived from the frequency matrix for the sites found – it is rather the matrices that lead to the best discrimination. The probability of a sequence is calculated as a product of the probabilities given by the matrices matching above a threshold and a simple null model for non-matching regions. From this and prior probabilities for matches in the positive and negative sets, the probability of the set label (positive or negative) is calculated. In this probability the background model cancels. The total likelihood is a product of the class probabilities for all sequences (positive and negative).</p>
    <p>This conditional likelihood leads to a non-trivial optimization problem which is handled using simulated annealing (see <xref ref-type="sec" rid="s4">Methods</xref>), where we iteratively change the WMs and their thresholds, retaining changes that lead to higher discriminatory power using the Metropolis-Hastings algorithm <xref rid="pcbi.1000562-Metropolis1" ref-type="bibr">[25]</xref>,<xref rid="pcbi.1000562-Hastings1" ref-type="bibr">[26]</xref>. Given sufficient iterations, the method guarantees convergence on the optimally discriminatory motifs. To cope with the vast size of the sets we utilize a highly efficient data structure, the ESA, for searching DNA for pattern instances<xref rid="pcbi.1000562-Beckstette1" ref-type="bibr">[27]</xref>. With reasonable cutoffs, this reduces the computation by an order of magnitude<xref rid="pcbi.1000562-Marstrand1" ref-type="bibr">[28]</xref>.</p>
  </sec>
  <sec id="s2">
    <title>Results</title>
    <p>We evaluated our method by comparing its accuracy to a set of widely used motif discovery methods (MEME<xref rid="pcbi.1000562-Bailey1" ref-type="bibr">[29]</xref>, DEME<xref rid="pcbi.1000562-Redhead1" ref-type="bibr">[23]</xref>, Weeder<xref rid="pcbi.1000562-Pavesi1" ref-type="bibr">[5]</xref> and NestedMICA<xref rid="pcbi.1000562-Down1" ref-type="bibr">[14]</xref>) in several different ways. In all runs, we used the same background set, which consists of 1000 experimentally defined promoters randomly sampled from the mouse genome (<xref ref-type="supplementary-material" rid="pcbi.1000562.s009">Text S1</xref>). The evaluation statistics are the same as used in <xref rid="pcbi.1000562-Tompa1" ref-type="bibr">[12]</xref> (see <xref ref-type="sec" rid="s4">Methods</xref>) and we also pooled the results from all motifs (grouped by length of the input sequence; see below) and calculated the compound statistics on this. To reduce the influence of the optimization method, we ran all non-deterministic methods five times on each set selecting the best run according to their own scoring function.</p>
    <p>In line with the recommendations of <xref rid="pcbi.1000562-Tompa1" ref-type="bibr">[12]</xref> we used synthetic data sets for the inter-method comparison. These were constructed by taking experimentally defined promoter regions based on strong CAGE tag clusters <xref rid="pcbi.1000562-Carninci1" ref-type="bibr">[2]</xref> and planting binding sites from various TFs inside these (<xref ref-type="supplementary-material" rid="pcbi.1000562.s009">Text S1</xref>). To decrease possible biases for the methods towards certain specific motif types, we randomly selected one TF from each of the 11 JASPAR<xref rid="pcbi.1000562-Bryne1" ref-type="bibr">[30]</xref> families as well as an example of a zinc-finger factor (<xref ref-type="supplementary-material" rid="pcbi.1000562.s016">Table S1</xref>). For a given matrix, we randomly chose sites from experimentally validated binding sequences used for constructing the JASPAR matrix instead of generating sites using the matrix. Since the accuracy of motif discovery methods normally deteriorates when sequence length is increased (“pattern drowning”), we evaluated the various methods on sets with sequence lengths varying between 200 and 1200 nucleotides (<xref ref-type="supplementary-material" rid="pcbi.1000562.s018">Table S3</xref>). This gave a total of 84 sets (12 motifs ×7 lengths) with 100 sequences in each. Sequences had a site from a given motif planted with a probability of 0.5. For those methods that support it, a background/negative set was provided containing 1000 sequences sampled in the same way and with the same length as the positive sequences. We used default settings for all methods except where there were obvious reasons not to (<xref ref-type="supplementary-material" rid="pcbi.1000562.s010">Text S2</xref>). Since DEME requires motif length as input we decided to input the correct length of the matrix. This provides DEME with an informational advantage over the other methods.</p>
    <p><xref ref-type="fig" rid="pcbi-1000562-g001">Fig. 1</xref> (and <xref ref-type="supplementary-material" rid="pcbi.1000562.s004">Figs. S4</xref>, <xref ref-type="supplementary-material" rid="pcbi.1000562.s005">S5</xref>, <xref ref-type="supplementary-material" rid="pcbi.1000562.s006">S6</xref>, <xref ref-type="supplementary-material" rid="pcbi.1000562.s007">S7</xref>, <xref ref-type="supplementary-material" rid="pcbi.1000562.s008">S8</xref>) shows a significant performance gain in using MoAn compared to the other methods as measured by Matthews correlation coefficient on nucleotide level (nCC) and average site performance (ASP) – an average over the positive predictive value and the sensitivity on binding site level (see <xref ref-type="sec" rid="s4">Methods</xref> for details). With both measures, MoAn performs better than any other method on all sequence lengths. In particular, the performance is not as affected by increasing the input sequence length as the other methods; at certain sequence lengths(800, 1200) MoAn has more than twice as high ASP values as the second best method. We also evaluated MoAn with the applicable subset of the evaluation set proposed by <xref rid="pcbi.1000562-Tompa1" ref-type="bibr">[12]</xref>(<xref ref-type="supplementary-material" rid="pcbi.1000562.s011">Text S3</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000562.s019">Table S4</xref>), where the OligoDyad, AnnSpec and MoAn achieve the highest sASP values. We note that this set is challenging as none of the methods perform well overall, and the difference in performance between methods might not be significant due to this fact. In addition, this set does not evaluate how well the method can deal with increasing lengths of input sequences, which is highly relevant.</p>
    <fig id="pcbi-1000562-g001" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pcbi.1000562.g001</object-id>
      <label>Figure 1</label>
      <caption>
        <title>Synthetic set evaluation.</title>
        <p>The average site performance (lines) and the nucleotide correlation coefficient (bars) of the methods.</p>
      </caption>
      <graphic xlink:href="pcbi.1000562.g001"/>
    </fig>
    <sec id="s2a">
      <title>Correlation of score and solution</title>
      <p>The relationship between our objective function and the correct solution was assessed by plotting the MoAn scores against the sensitivity obtained in all five runs on each of the 84 sets (not just the best from each run) (<xref ref-type="fig" rid="pcbi-1000562-g002">Fig. 2</xref>). There is a clear correlation (Pearson CC: 0.90) between these two measures. There is a similar correlation with other measures, such as the nCC (<xref ref-type="supplementary-material" rid="pcbi.1000562.s001">Fig. S1</xref>).</p>
      <fig id="pcbi-1000562-g002" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1000562.g002</object-id>
        <label>Figure 2</label>
        <caption>
          <title>Correlation of MoAn's objective function (Sc) and site sensitivity (sSn).</title>
          <p>All 5 runs on the 84 synthetic sets are used.</p>
        </caption>
        <graphic xlink:href="pcbi.1000562.g002"/>
      </fig>
      <p>This finding is important, because it indicates that the raw score is an indication of quality independent of the motif analyzed. It also shows that choosing the best scoring run of several will often give the best result.</p>
    </sec>
    <sec id="s2b">
      <title>Repetitive sequences</title>
      <p>Aside from the problem with decreasing sensitivity as the length of the input sequences increase, repetitive sequences represent a severe problem for motif discovery, as these will often seem to be over-represented, and therefore it is common to mask these repeats. However, masking is always arbitrary, and some repeats are functional <xref rid="pcbi.1000562-Romanish1" ref-type="bibr">[31]</xref>,<xref rid="pcbi.1000562-Buzdin1" ref-type="bibr">[32]</xref>, so indiscriminate repeat masking is not optimal. When using a large negative set, repeat masking is unnecessary since repeats, if commonly occurring, will feature in the negative set and therefore be avoided as potential hits in the positive. At the same time, we can avoid the reverse problem – if a type of repeat actually is over-represented in the positive set, it can still be found. To demonstrate the insensitivity to repeats on a practical level, we planted repetitive sequences in each of the positive sets with a slightly higher frequency than the real motifs and ran our predictor on these sets both with the normal background and with a background similarly spiked with repeats. Specifically, we planted 1 to 10 consecutive instances of CACTA with a probability of 60% in each sequence. <xref ref-type="fig" rid="pcbi-1000562-g003">Fig. 3</xref> shows, as expected, that the results do not deviate much from the repeat-less run when repeats are planted in both the positive and negative sequences, while the method picks up the repeats instead when there are no repeats in the negative set. We also performed this test using decoy motifs instead of repeats with similar results (<xref ref-type="supplementary-material" rid="pcbi.1000562.s012">Text S4</xref>, <xref ref-type="supplementary-material" rid="pcbi.1000562.s002">Fig. S2</xref>).</p>
      <fig id="pcbi-1000562-g003" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1000562.g003</object-id>
        <label>Figure 3</label>
        <caption>
          <title>Repeat Assessment.</title>
          <p>The average site performance (lines) and the nucleotide correlation coefficient (bars) of MoAn with repeats planted in the two sets.</p>
        </caption>
        <graphic xlink:href="pcbi.1000562.g003"/>
      </fig>
    </sec>
    <sec id="s2c">
      <title>Real data</title>
      <p>Evaluation of methods on real data is difficult and often a poor indication of general performance due to lack of insight into the correct solution <xref rid="pcbi.1000562-Tompa1" ref-type="bibr">[12]</xref>; on the other hand, it is necessary to show that the method can be applied to real problems.</p>
      <p>MoAn and four other methods were run on a collection of real data sets consisting of the binding sites of four human and mouse factors from the PAZAR database<xref rid="pcbi.1000562-PortalesCasamar1" ref-type="bibr">[33]</xref> and their associated genomic sequence. The sets were split by organism into 7 sets and the regions adjacent on the genome were merged resulting in sets ranging in size from 14 to 118. The merging means that the base sequences can have a varying number of sites and may be of different lengths. The sets were then subsequently enlarged by adding an equal number of randomly selected promoters to increase the difficulty (<xref ref-type="supplementary-material" rid="pcbi.1000562.s014">Text S6</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000562.s020">Table S5</xref>) and also padded with their cognate upstream and downstream regions of varying lengths (200–1200, as in the synthetic evaluation) to estimate the impact of noise.</p>
      <p><xref ref-type="fig" rid="pcbi-1000562-g004">Fig. 4</xref> shows the performance over the real sets. MoAn's performance is clearly superior, but not as spectacular as in the more controlled environment with synthetic sequences.</p>
      <fig id="pcbi-1000562-g004" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1000562.g004</object-id>
        <label>Figure 4</label>
        <caption>
          <title>PAZAR set evaluation.</title>
          <p>The average site performance (lines) and the nucleotide correlation coefficient (bars) of the methods.</p>
        </caption>
        <graphic xlink:href="pcbi.1000562.g004"/>
      </fig>
      <p>We speculate that the reason for this is that the background and foreground of the synthetic sets are essentially sampled from the same pool (RefSeq promoters), while we have made no effort to customize the background for the PAZAR sets. If the genomic environment of the factors differ from normal promoter sequences this could lead to a reduced performance. There are also fewer sets (7 versus 12) in this evaluation leading to a higher variability.</p>
      <p>We report additional trials using ChIP-chip data in supplementary material (<xref ref-type="supplementary-material" rid="pcbi.1000562.s015">Text S7</xref>, <xref ref-type="supplementary-material" rid="pcbi.1000562.s003">Fig. S3</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000562.s021">Tables S6</xref>, <xref ref-type="supplementary-material" rid="pcbi.1000562.s022">S7</xref>). MoAn has also been used successfully to discriminate between binding regions of human ESR1 and its paralog ESR2; the results were comparable with matrix-scanning approaches with pre-defined motifs<xref rid="pcbi.1000562-Liu1" ref-type="bibr">[34]</xref>.</p>
    </sec>
    <sec id="s2d">
      <title>Co-occurrence of binding sites</title>
      <p>An additional aspect of the motif finding problem is that TFs often work by forming complex interactions <xref rid="pcbi.1000562-Wasserman1" ref-type="bibr">[35]</xref>. Examples include mutually exclusive and cooperative binding. Clusters of TFBSs are commonly termed cis-regulatory modules, and are often responsible for tissue-specific expression. We try to capture these interactions by incorporating co-occurrence of sites from different motifs into our model, with the goal of further increasing predictive power. To test whether our objective function is capable of capturing interactions between factors we constructed a set where co-occurrence of sites from different motifs occurs. We randomly chose 5 pairs of new motifs (<xref ref-type="supplementary-material" rid="pcbi.1000562.s017">Table S2</xref>) and planted their corresponding sites in a positive set of 100 promoters with a 40% chance of co-occurrence and 10% of single occurrence. We then spiked the background set with sites from each of the motifs (10% chance each for all sequences) to mimic a situation where it is the interactions of the two sites rather than single sites that are responsible for the regulation. MoAn was then run in co-occurrence mode and compared to two single-occurrence runs in a series. In the serial runs we masked out the predictions from the first iteration before running the second iteration. In <xref ref-type="fig" rid="pcbi-1000562-g005">Fig. 5</xref> the ASP and nCC is plotted. In our experiment three of the pairs turned out to be composed of motifs with relatively low information, leading to poor performance. However, the two remaining ones show that modeling of co-occurrence can significantly improve performance. This extended model is unfortunately computationally taxing and requires more than twice the number of iterations compared to the single prediction.</p>
      <fig id="pcbi-1000562-g005" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1000562.g005</object-id>
        <label>Figure 5</label>
        <caption>
          <title>Performance of co-occurrence vs. serial runs.</title>
          <p>The average site performance (lines) and nucleotide correlation coefficient (bars) of co-occurrence and serial runs on 5 different sets with co-occurring motifs.</p>
        </caption>
        <graphic xlink:href="pcbi.1000562.g005"/>
      </fig>
    </sec>
  </sec>
  <sec id="s3">
    <title>Discussion</title>
    <p>In this work we have shown the value of using a large negative set instead of a pre-defined background model in motif discovery. Using raw sequences more accurately portrays the background than any general model and therefore higher discriminatory power is achieved. This method is also much less sensitive to “pattern drowning” in larger sequences, which is a bottleneck in computational analysis of mammalian regulatory regions. However, while our method takes a significant step towards routine motif discovery on large sequences, the problem cannot be considered fully solved. In particular, MoAn accuracy may be further improved by incorporating information on evolutionary constraints (phylogenetic footprinting)<xref rid="pcbi.1000562-Lenhard1" ref-type="bibr">[36]</xref> or DNA accessibility<xref rid="pcbi.1000562-Narlikar1" ref-type="bibr">[24]</xref>,<xref rid="pcbi.1000562-Mellor1" ref-type="bibr">[37]</xref>.</p>
    <p>In our opinion DEME is the best runner up of the methods. It often predicts the correct motif and has a high sensitivity, but often at the cost of a large number of false positives as it predicts also in those sequences not containing a site. MoAn seems to be better at balancing the sensitivity and specificity. On the other hand DEME is also given an artificial advantage by having the correct motif length as input and it is uncertain how advantageous this is.</p>
    <p>Weeder performed surprisingly poorly given its stellar performance in a recent evaluation<xref rid="pcbi.1000562-Tompa1" ref-type="bibr">[12]</xref>. This might be due to motif selection which we did according to the most redundant motif, but was in <xref rid="pcbi.1000562-Tompa1" ref-type="bibr">[12]</xref> done in a more complicated manner not part of the current Weeder package. This procedure led to no predictions on several of the harder sets which might give Weeder a statistical advantage (as discussed in <xref rid="pcbi.1000562-Tompa1" ref-type="bibr">[12]</xref>).</p>
    <p>A concern that might be raised is that optimizing a cutoff might lead to a conservative estimate of binding sites at the expense of weaker sites. However, assessing this is hard since experiments have their own thresholds in the post-analysis and any evaluation of MoAn's threshold will be dependant upon those. Investigations where we artificially forced the cutoff to remain low, lead to a reduction in performance (data not shown). We address this potential problem indirectly by providing a matrix that can be used to search sequences at a lower threshold.</p>
    <p>Future improvements of MoAn will focus on the optimization algorithm, which currently is not robust enough to always produce reliable results. In our current implementation we avoid this problem by running the algorithm many times to see that the solution is stable.</p>
  </sec>
  <sec id="s4">
    <title>Methods</title>
    <p>Evaluation is done on both site and nucleotide levels. The statistics used are similar to those in the recent large scale evaluation <xref rid="pcbi.1000562-Tompa1" ref-type="bibr">[12]</xref>. To get a compound statistic for all motifs at each length we used what is there described as the “combined” method for summarizing. This consists of treating all sets of a given length as one big set, summing up all the basic statistics below (nTP, nTN … sFN) before calculating the compound statistics. This removes the problem of undefined statistics in those cases where a method does not predict any sites.</p>
    <sec id="s4a">
      <title>Basic statistics</title>
      <p>nTP Number of nts part of a site correctly predicted.</p>
      <p>nTN Number of background nts correctly predicted.</p>
      <p>nFP Number of background nts predicted to be part of a motif.</p>
      <p>nFN Number of nts part of a site predicted as background.</p>
      <p>sTP Number of real sites that share over 50% of its nts with a predicted site.</p>
      <p>sFP Number of predicted sites that share less than 50% of its nts with a real site.</p>
      <p>sFN Number of real sites that share less than 50% of its nts with a predicted site.</p>
      <p>Note that we are more conservative with respect to the site prediction than <xref rid="pcbi.1000562-Tompa1" ref-type="bibr">[12]</xref> in that we demand at least half of the nucleotides overlapped to get a single sTP.</p>
    </sec>
    <sec id="s4b">
      <title>Compound statistics</title>
      <p>Derived from the basic statistics:<disp-formula><graphic xlink:href="pcbi.1000562.e001.jpg" mimetype="image" position="float"/></disp-formula>
<disp-formula><graphic xlink:href="pcbi.1000562.e002.jpg" mimetype="image" position="float"/></disp-formula>
<disp-formula><graphic xlink:href="pcbi.1000562.e003.jpg" mimetype="image" position="float"/></disp-formula>
<disp-formula><graphic xlink:href="pcbi.1000562.e004.jpg" mimetype="image" position="float"/></disp-formula>
</p>
    </sec>
    <sec id="s4c">
      <title>Objective function</title>
      <p>A sequence <inline-formula><inline-graphic xlink:href="pcbi.1000562.e005.jpg" mimetype="image"/></inline-formula> is assumed to be described by a mixture model consisting of a background distribution <inline-formula><inline-graphic xlink:href="pcbi.1000562.e006.jpg" mimetype="image"/></inline-formula> and a set of WMs <inline-formula><inline-graphic xlink:href="pcbi.1000562.e007.jpg" mimetype="image"/></inline-formula> describing the binding affinities of the TFs. The WMs contain log-odds scores of the type:<disp-formula><graphic xlink:href="pcbi.1000562.e008.jpg" mimetype="image" position="float"/><label>(1)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="pcbi.1000562.e009.jpg" mimetype="image"/></inline-formula> is the position in the WM, <inline-formula><inline-graphic xlink:href="pcbi.1000562.e010.jpg" mimetype="image"/></inline-formula> is a letter in the DNA alphabet and <inline-formula><inline-graphic xlink:href="pcbi.1000562.e011.jpg" mimetype="image"/></inline-formula> is the probability of having letter <inline-formula><inline-graphic xlink:href="pcbi.1000562.e012.jpg" mimetype="image"/></inline-formula> at position <inline-formula><inline-graphic xlink:href="pcbi.1000562.e013.jpg" mimetype="image"/></inline-formula> in the motif described by <inline-formula><inline-graphic xlink:href="pcbi.1000562.e014.jpg" mimetype="image"/></inline-formula>. The score of a matrix <inline-formula><inline-graphic xlink:href="pcbi.1000562.e015.jpg" mimetype="image"/></inline-formula> aligned at a position <inline-formula><inline-graphic xlink:href="pcbi.1000562.e016.jpg" mimetype="image"/></inline-formula> in a sequence <inline-formula><inline-graphic xlink:href="pcbi.1000562.e017.jpg" mimetype="image"/></inline-formula> is therefore:<disp-formula><graphic xlink:href="pcbi.1000562.e018.jpg" mimetype="image" position="float"/><label>(2)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="pcbi.1000562.e019.jpg" mimetype="image"/></inline-formula> is the DNA letter at position <inline-formula><inline-graphic xlink:href="pcbi.1000562.e020.jpg" mimetype="image"/></inline-formula> in sequence <inline-formula><inline-graphic xlink:href="pcbi.1000562.e021.jpg" mimetype="image"/></inline-formula>.</p>
      <p>The aim is to discriminate between two sets of sequences <inline-formula><inline-graphic xlink:href="pcbi.1000562.e022.jpg" mimetype="image"/></inline-formula>, where label <inline-formula><inline-graphic xlink:href="pcbi.1000562.e023.jpg" mimetype="image"/></inline-formula> denotes the positive set and <inline-formula><inline-graphic xlink:href="pcbi.1000562.e024.jpg" mimetype="image"/></inline-formula> the negative. The prior probability of binding site occurrence in a sequence contained in set <inline-formula><inline-graphic xlink:href="pcbi.1000562.e025.jpg" mimetype="image"/></inline-formula> is called <inline-formula><inline-graphic xlink:href="pcbi.1000562.e026.jpg" mimetype="image"/></inline-formula>. We assume that there is a marked difference in the site occurrence between the two sets and want to construct a score that captures how well a set of WMs describe this difference. Using two WMs as an example, <inline-formula><inline-graphic xlink:href="pcbi.1000562.e027.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pcbi.1000562.e028.jpg" mimetype="image"/></inline-formula>, there are four possible ways for a sequence <inline-formula><inline-graphic xlink:href="pcbi.1000562.e029.jpg" mimetype="image"/></inline-formula> to be generated. With prior probability <inline-formula><inline-graphic xlink:href="pcbi.1000562.e030.jpg" mimetype="image"/></inline-formula> it contains no sites and is only generated by the background model <inline-formula><inline-graphic xlink:href="pcbi.1000562.e031.jpg" mimetype="image"/></inline-formula>. Or, with prior probability <inline-formula><inline-graphic xlink:href="pcbi.1000562.e032.jpg" mimetype="image"/></inline-formula>, it contains a single site (one of the two) corresponding to one WM <inline-formula><inline-graphic xlink:href="pcbi.1000562.e033.jpg" mimetype="image"/></inline-formula> positioned at nucleotide number <inline-formula><inline-graphic xlink:href="pcbi.1000562.e034.jpg" mimetype="image"/></inline-formula> (<inline-formula><inline-graphic xlink:href="pcbi.1000562.e035.jpg" mimetype="image"/></inline-formula> is equal to 1 or 2 corresponding to the two different matrices). This is written <inline-formula><inline-graphic xlink:href="pcbi.1000562.e036.jpg" mimetype="image"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="pcbi.1000562.e037.jpg" mimetype="image"/></inline-formula> is the score of the matrix aligned to the nucleotides at position <inline-formula><inline-graphic xlink:href="pcbi.1000562.e038.jpg" mimetype="image"/></inline-formula> (eq. 2) and 2 is the base of the log scores contained in the WM. Note that the log scores in a WM are divided by the background model, so the background (<inline-formula><inline-graphic xlink:href="pcbi.1000562.e039.jpg" mimetype="image"/></inline-formula>) cancels out in sites where the motif occurs. The final case, with prior probability <inline-formula><inline-graphic xlink:href="pcbi.1000562.e040.jpg" mimetype="image"/></inline-formula>, is the co-occurrence of two sites in a sequence, which is <inline-formula><inline-graphic xlink:href="pcbi.1000562.e041.jpg" mimetype="image"/></inline-formula>. However, this is only correct when the sites are not overlapping since otherwise the overlapping nucleotides would be included in the product twice. Therefore we disallow overlaps.</p>
      <p>For efficiency reasons, we do not calculate the score in its entirety. We assume that it is the strong sites that contribute the most to the equation and introduce a cutoff for each WM on the minimum score of a site. This enables an efficient search in the ESA. This is not without biological merit since WM scores and binding energies for known TFs are correlated, and at some point the binding energies of a TF and a poor binding sequence must be too small to matter <xref rid="pcbi.1000562-Stormo1" ref-type="bibr">[4]</xref>. It is also a standard method to use when scanning with known matrices <xref rid="pcbi.1000562-Wasserman2" ref-type="bibr">[38]</xref>. So we only consider sites that score above a threshold, which is called <inline-formula><inline-graphic xlink:href="pcbi.1000562.e042.jpg" mimetype="image"/></inline-formula> for matrix <inline-formula><inline-graphic xlink:href="pcbi.1000562.e043.jpg" mimetype="image"/></inline-formula>. Then the probability of a sequence <inline-formula><inline-graphic xlink:href="pcbi.1000562.e044.jpg" mimetype="image"/></inline-formula> from the set <inline-formula><inline-graphic xlink:href="pcbi.1000562.e045.jpg" mimetype="image"/></inline-formula> being generated by the WMs is<disp-formula><graphic xlink:href="pcbi.1000562.e046.jpg" mimetype="image" position="float"/><label>(3)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="pcbi.1000562.e047.jpg" mimetype="image"/></inline-formula> is the expectation over <inline-formula><inline-graphic xlink:href="pcbi.1000562.e048.jpg" mimetype="image"/></inline-formula> of <inline-formula><inline-graphic xlink:href="pcbi.1000562.e049.jpg" mimetype="image"/></inline-formula> over all predicted sites:<disp-formula><graphic xlink:href="pcbi.1000562.e050.jpg" mimetype="image" position="float"/><label>(4)</label></disp-formula>with <inline-formula><inline-graphic xlink:href="pcbi.1000562.e051.jpg" mimetype="image"/></inline-formula> being the step function (1 above 0 and zero otherwise). The co-occurrence expectation <inline-formula><inline-graphic xlink:href="pcbi.1000562.e052.jpg" mimetype="image"/></inline-formula> is defined in a similar way with overlaps disallowed. The effective weight of no sites<disp-formula><graphic xlink:href="pcbi.1000562.e053.jpg" mimetype="image" position="float"/><label>(5)</label></disp-formula>accounts for extra weight given to no sites due to alignments not meeting the threshold. With this definition, <inline-formula><inline-graphic xlink:href="pcbi.1000562.e054.jpg" mimetype="image"/></inline-formula> is the probability or generative model of the sequence conditioned on the WM and threshold, <inline-formula><inline-graphic xlink:href="pcbi.1000562.e055.jpg" mimetype="image"/></inline-formula>.</p>
      <p>To find the WMs that best explain the difference in occurrence between the sets we use a discriminative objective function based on the probability of the labels <inline-formula><inline-graphic xlink:href="pcbi.1000562.e056.jpg" mimetype="image"/></inline-formula> given the sequences <inline-formula><inline-graphic xlink:href="pcbi.1000562.e057.jpg" mimetype="image"/></inline-formula> and WMs, formally:<disp-formula><graphic xlink:href="pcbi.1000562.e058.jpg" mimetype="image" position="float"/><label>(6)</label></disp-formula>
</p>
      <p>This is the logistic likelihood function for binary classification, see e.g. <xref rid="pcbi.1000562-Bishop1" ref-type="bibr">[39]</xref>. The discriminative model can thus be viewed as logistic regression with an adaptive set of basis functions. For multiple sequences assumed to be independent, the joint probability is the product of the single sequence probabilities over all sequences in both the positive and negative set:<disp-formula><graphic xlink:href="pcbi.1000562.e059.jpg" mimetype="image" position="float"/><label>(7)</label></disp-formula>
</p>
      <p>We refer to this function as the (log likelihood) score, <inline-formula><inline-graphic xlink:href="pcbi.1000562.e060.jpg" mimetype="image"/></inline-formula>.</p>
      <p>Based on the sequence density <inline-formula><inline-graphic xlink:href="pcbi.1000562.e061.jpg" mimetype="image"/></inline-formula> we can use Bayes theorem to calculate the probability of the label <inline-formula><inline-graphic xlink:href="pcbi.1000562.e062.jpg" mimetype="image"/></inline-formula> given the WMs <inline-formula><inline-graphic xlink:href="pcbi.1000562.e063.jpg" mimetype="image"/></inline-formula>, the thresholds <inline-formula><inline-graphic xlink:href="pcbi.1000562.e064.jpg" mimetype="image"/></inline-formula>, and the sequence <inline-formula><inline-graphic xlink:href="pcbi.1000562.e065.jpg" mimetype="image"/></inline-formula>:<disp-formula><graphic xlink:href="pcbi.1000562.e066.jpg" mimetype="image" position="float"/><label>(8)</label></disp-formula>
</p>
      <p>We observe that the prior probability of <inline-formula><inline-graphic xlink:href="pcbi.1000562.e067.jpg" mimetype="image"/></inline-formula> is proportional to the number of sequences in the set divided by the total number of sequences <inline-formula><inline-graphic xlink:href="pcbi.1000562.e068.jpg" mimetype="image"/></inline-formula>.</p>
      <p>A very high threshold will give no matches, and the probability will then be a constant given by the priors and the size of the two sets. Matches that score above the threshold in the negative set will lower the score and matches above the threshold in the positive set will increase the score, so the game is to obtain as many high-scoring matches in the positive set as possible without introducing too many matches in the negative set.</p>
      <p>The prior is conservative in our runs in that we are strict about promoting hits in the positive set, but only moderately strict about disallowing negative hits. For a single matrix the prior on <inline-formula><inline-graphic xlink:href="pcbi.1000562.e069.jpg" mimetype="image"/></inline-formula> is 0.01; <inline-formula><inline-graphic xlink:href="pcbi.1000562.e070.jpg" mimetype="image"/></inline-formula>: 0.99; <inline-formula><inline-graphic xlink:href="pcbi.1000562.e071.jpg" mimetype="image"/></inline-formula>: 0.80; <inline-formula><inline-graphic xlink:href="pcbi.1000562.e072.jpg" mimetype="image"/></inline-formula>: 0.20. For two matrices: <inline-formula><inline-graphic xlink:href="pcbi.1000562.e073.jpg" mimetype="image"/></inline-formula>: 0; <inline-formula><inline-graphic xlink:href="pcbi.1000562.e074.jpg" mimetype="image"/></inline-formula>: 0.1; <inline-formula><inline-graphic xlink:href="pcbi.1000562.e075.jpg" mimetype="image"/></inline-formula>: 0.9; <inline-formula><inline-graphic xlink:href="pcbi.1000562.e076.jpg" mimetype="image"/></inline-formula>: 0.80; <inline-formula><inline-graphic xlink:href="pcbi.1000562.e077.jpg" mimetype="image"/></inline-formula>: 0.15; and <inline-formula><inline-graphic xlink:href="pcbi.1000562.e078.jpg" mimetype="image"/></inline-formula>: 0.05. These priors can be set by the user if prior knowledge is available about the set (i.e. a high confidence negative set or an uncertain positive set).</p>
      <p>In the evaluation we deliberately chose a probability of having a site (0.5) in a sequence very different from the model prior (0.99) to avoid giving our own method a big advantage. It shows that the method is not very sensitive to the choice of prior.</p>
    </sec>
    <sec id="s4d">
      <title>Optimization</title>
      <p>The objective function outlined above is optimized using simulated annealing <xref rid="pcbi.1000562-Kirkpatrick1" ref-type="bibr">[40]</xref>. Informally, it proceeds by iteratively proposing a candidate solution and then accepting or rejecting it depending on how good it is compared to the current solution. It sometimes accepts changes for the worse and therefore possesses the power to escape local maxima. The hope is that it will converge on a solution that is close to optimal. Formally, this translates to a walk over the search space <inline-formula><inline-graphic xlink:href="pcbi.1000562.e079.jpg" mimetype="image"/></inline-formula> where in the current state <inline-formula><inline-graphic xlink:href="pcbi.1000562.e080.jpg" mimetype="image"/></inline-formula>, the next state <inline-formula><inline-graphic xlink:href="pcbi.1000562.e081.jpg" mimetype="image"/></inline-formula> is either the same or the candidate solution <inline-formula><inline-graphic xlink:href="pcbi.1000562.e082.jpg" mimetype="image"/></inline-formula> depending on their relative scores and a temperature parameter <inline-formula><inline-graphic xlink:href="pcbi.1000562.e083.jpg" mimetype="image"/></inline-formula>.<disp-formula><graphic xlink:href="pcbi.1000562.e084.jpg" mimetype="image" position="float"/></disp-formula>
</p>
      <p>The temperature parameter is lowered for each iteration using as default an exponential cooling scheme (for details see <xref ref-type="supplementary-material" rid="pcbi.1000562.s013">Text S5</xref>), thus incrementally constraining the neighborhood of accepted changes.</p>
      <p>Candidate solutions are proposed by applying one of several steps outlined in the list below. In the case of multiple matrices, only one is changed at a time. We perform all steps on a integer “count” matrix which is then translated into a log-odds WM prior to searching the ESA, but notice that the “count” matrix does not represent actual letter frequencies in the selected sites. The steps are:</p>
      <list list-type="bullet">
        <list-item>
          <p>Alter the contents of the WM columns by moving counts from one random cell to another within a column. The number of counts moved is selected uniformly from 1 to the current count number for the cell.</p>
        </list-item>
        <list-item>
          <p>Extend the WM in either direction. A uniformly sampled number of columns (1 to 5) is added and counts of these are decided by consulting the sequence locations of hits scoring above <inline-formula><inline-graphic xlink:href="pcbi.1000562.e085.jpg" mimetype="image"/></inline-formula>. The counts are proportional to the counts in the columns from the extended hits, but normalized so that all columns have the same counts.</p>
        </list-item>
        <list-item>
          <p>Decrease the length of the WM by deleting columns. Similarly to adding columns a uniformly selected number between 1 and 5 columns are deleted.</p>
        </list-item>
        <list-item>
          <p>Slide the WM across the sequences. Columns are deleted on one site and extended on the other according to the two steps above.</p>
        </list-item>
        <list-item>
          <p>Alter the cutoff <inline-formula><inline-graphic xlink:href="pcbi.1000562.e086.jpg" mimetype="image"/></inline-formula> of the matrix <inline-formula><inline-graphic xlink:href="pcbi.1000562.e087.jpg" mimetype="image"/></inline-formula>. The cutoff is expressed in bits per column and a new candidate <inline-formula><inline-graphic xlink:href="pcbi.1000562.e088.jpg" mimetype="image"/></inline-formula> is proposed by sampling uniformly from 0.6 to 2 bits.</p>
        </list-item>
      </list>
      <p>Note that for the extend and decrease step there is a minimum and maximum number of columns for a motif. The default for these are 5 and 15 respectively.</p>
      <p>The matrix is initialized with random counts and the cutoff is also selected uniformly according to the last step in the list above. Termination of the optimization is only based on the number of iterations which is by default set to a rather conservative value of 30 million iterations. Time requirements for a single run is variable depending on the set size, but was for our runs comparable to NestedMICA (single threaded) and considerably faster than Weeder's “large” run and DEME.</p>
    </sec>
    <sec id="s4e">
      <title>Availability</title>
      <p>Source code as well as data sets is freely available at the author's web site: <ext-link ext-link-type="uri" xlink:href="http://moan.binf.ku.dk">http://moan.binf.ku.dk</ext-link>
</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="s5">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pcbi.1000562.s001">
      <label>Figure S1</label>
      <caption>
        <p>Correlation of MoAn's objective function (Sc) and nucleotide correlation coefficient (nCC)</p>
        <p>(0.01 MB EPS)</p>
      </caption>
      <media xlink:href="pcbi.1000562.s001.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1000562.s002">
      <label>Figure S2</label>
      <caption>
        <p>Evaluation with decoy motifs. Average site performance (lines) and the nucleotide correlation coefficient (bars) of MoAn with decoy motifs planted in the two sets.</p>
        <p>(0.01 MB EPS)</p>
      </caption>
      <media xlink:href="pcbi.1000562.s002.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1000562.s003">
      <label>Figure S3</label>
      <caption>
        <p>Discriminatory power of matrices. ROC curve showing discriminatory power of matrices produced by MoAn and NestedMICA on the ESR1 data set. The line extends from the highest cutoff possible for that matrix (bottom right) to a cutoff of 0 (top left).</p>
        <p>(0.03 MB EPS)</p>
      </caption>
      <media xlink:href="pcbi.1000562.s003.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1000562.s004">
      <label>Figure S4</label>
      <caption>
        <p>Performance on individual sets for MoAn. The average site performance (lines) and the nucleotide correlation coefficient (bars) on the sets.</p>
        <p>(0.02 MB EPS)</p>
      </caption>
      <media xlink:href="pcbi.1000562.s004.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1000562.s005">
      <label>Figure S5</label>
      <caption>
        <p>Performance on individual sets for DEME. The average site performance (lines) and the nucleotide correlation coefficient (bars) on the sets.</p>
        <p>(0.02 MB EPS)</p>
      </caption>
      <media xlink:href="pcbi.1000562.s005.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1000562.s006">
      <label>Figure S6</label>
      <caption>
        <p>Performance on individual sets for MEME. The average site performance (lines) and the nucleotide correlation coefficient (bars) on the sets.</p>
        <p>(0.02 MB EPS)</p>
      </caption>
      <media xlink:href="pcbi.1000562.s006.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1000562.s007">
      <label>Figure S7</label>
      <caption>
        <p>Performance on individual sets for Weeder. The average site performance (lines) and the nucleotide correlation coefficient (bars) on the sets.</p>
        <p>(0.02 MB EPS)</p>
      </caption>
      <media xlink:href="pcbi.1000562.s007.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1000562.s008">
      <label>Figure S8</label>
      <caption>
        <p>Performance on individual sets for NestedMICA. The average site performance (lines) and the nucleotide correlation coefficient (bars) on the sets.</p>
        <p>(0.02 MB EPS)</p>
      </caption>
      <media xlink:href="pcbi.1000562.s008.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1000562.s009">
      <label>Text S1</label>
      <caption>
        <p>Data set construction</p>
        <p>(0.03 MB PDF)</p>
      </caption>
      <media xlink:href="pcbi.1000562.s009.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1000562.s010">
      <label>Text S2</label>
      <caption>
        <p>Running parameters</p>
        <p>(0.03 MB PDF)</p>
      </caption>
      <media xlink:href="pcbi.1000562.s010.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1000562.s011">
      <label>Text S3</label>
      <caption>
        <p>Tompa assessment</p>
        <p>(0.03 MB PDF)</p>
      </caption>
      <media xlink:href="pcbi.1000562.s011.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1000562.s012">
      <label>Text S4</label>
      <caption>
        <p>Sequences spiked with decoy motifs</p>
        <p>(0.02 MB PDF)</p>
      </caption>
      <media xlink:href="pcbi.1000562.s012.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1000562.s013">
      <label>Text S5</label>
      <caption>
        <p>Annealing schedule</p>
        <p>(0.03 MB PDF)</p>
      </caption>
      <media xlink:href="pcbi.1000562.s013.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1000562.s014">
      <label>Text S6</label>
      <caption>
        <p>PAZAR data sets</p>
        <p>(0.03 MB PDF)</p>
      </caption>
      <media xlink:href="pcbi.1000562.s014.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1000562.s015">
      <label>Text S7</label>
      <caption>
        <p>ChIP-chip data sets</p>
        <p>(0.04 MB PDF)</p>
      </caption>
      <media xlink:href="pcbi.1000562.s015.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1000562.s016">
      <label>Table S1</label>
      <caption>
        <p>Length of upstream and downstream extensions</p>
        <p>(0.01 MB PDF)</p>
      </caption>
      <media xlink:href="pcbi.1000562.s016.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1000562.s017">
      <label>Table S2</label>
      <caption>
        <p>Motifs planted in single occurrence sets</p>
        <p>(0.04 MB PDF)</p>
      </caption>
      <media xlink:href="pcbi.1000562.s017.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1000562.s018">
      <label>Table S3</label>
      <caption>
        <p>Motifs planted in co-occurrence sets</p>
        <p>(0.03 MB PDF)</p>
      </caption>
      <media xlink:href="pcbi.1000562.s018.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1000562.s019">
      <label>Table S4</label>
      <caption>
        <p>Results on the mammalian subset of the Tompa assessment</p>
        <p>(0.01 MB PDF)</p>
      </caption>
      <media xlink:href="pcbi.1000562.s019.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1000562.s020">
      <label>Table S5</label>
      <caption>
        <p>Sizes of PAZAR data sets</p>
        <p>(0.01 MB PDF)</p>
      </caption>
      <media xlink:href="pcbi.1000562.s020.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1000562.s021">
      <label>Table S6</label>
      <caption>
        <p>Sizes of ENCODE data sets</p>
        <p>(0.01 MB PDF)</p>
      </caption>
      <media xlink:href="pcbi.1000562.s021.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1000562.s022">
      <label>Table S7</label>
      <caption>
        <p>Performance on ENCODE data sets</p>
        <p>(0.07 MB PDF)</p>
      </caption>
      <media xlink:href="pcbi.1000562.s022.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>Thanks to Brian Parker for help with the manuscript.</p>
  </ack>
  <fn-group>
    <fn fn-type="COI-statement">
      <p>The authors have declared that no competing interests exist.</p>
    </fn>
    <fn fn-type="financial-disclosure">
      <p>This work was supported by a grant from the Novo Nordisk Foundation and the Novo scholarship programme. The European Research Council has provided financial support to AS under the EU 7th Framework Programme (FP7/2007–2013)/ERC grant agreement 204135. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1000562-Birney1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Birney</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Stamatoyannopoulos</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dutta</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Guigó</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gingeras</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2007</year>
        <article-title>Identification and analysis of functional elements in 1% of the human genome by the ENCODE pilot project.</article-title>
        <source>Nature</source>
        <volume>447</volume>
        <fpage>799</fpage>
        <lpage>816</lpage>
        <pub-id pub-id-type="pmid">17571346</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Carninci1">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carninci</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kasukawa</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Katayama</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gough</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Frith</surname>
            <given-names>MC</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2005</year>
        <article-title>The transcriptional landscape of the mammalian genome.</article-title>
        <source>Science</source>
        <volume>309</volume>
        <fpage>1559</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="pmid">16141072</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Kim1">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Barrera</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Qu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Singer</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2005</year>
        <article-title>A high-resolution map of active promoters in the human genome.</article-title>
        <source>Nature</source>
        <volume>436</volume>
        <fpage>876</fpage>
        <lpage>880</lpage>
        <pub-id pub-id-type="pmid">15988478</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Stormo1">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stormo</surname>
            <given-names>GD</given-names>
          </name>
        </person-group>
        <year>2000</year>
        <article-title>DNA binding sites: representation and discovery.</article-title>
        <source>Bioinformatics</source>
        <volume>16</volume>
        <fpage>16</fpage>
        <lpage>23</lpage>
        <pub-id pub-id-type="pmid">10812473</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Pavesi1">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pavesi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Mauri</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Pesole</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <year>2001</year>
        <article-title>An algorithm for finding signals of unknown length in DNA sequences.</article-title>
        <source>Bioinformatics</source>
        <volume>17</volume>
        <issue>Suppl 1</issue>
        <fpage>S207</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="pmid">11473011</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Sinha1">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sinha</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tompa</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <year>2003</year>
        <article-title>YMF: A program for discovery of novel transcription factor binding sites by statistical overrepresentation.</article-title>
        <source>Nucleic Acids Res</source>
        <volume>31</volume>
        <fpage>3586</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="pmid">12824371</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Stormo2">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stormo</surname>
            <given-names>GD</given-names>
          </name>
        </person-group>
        <year>1998</year>
        <article-title>Information content and free energy in DNA-protein interactions.</article-title>
        <source>J Theor Biol</source>
        <volume>195</volume>
        <fpage>135</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="pmid">9802956</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Berg1">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berg</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>von Hippel</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <year>1987</year>
        <article-title>Selection of DNA binding sites by regulatory proteins.</article-title>
        <source>J Mol Biol</source>
        <volume>193</volume>
        <fpage>723</fpage>
        <lpage>750</lpage>
        <pub-id pub-id-type="pmid">3612791</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Wang1">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <year>1994</year>
        <article-title>On the complexity of multiple sequence alignment.</article-title>
        <source>J Comput Biol</source>
        <volume>1</volume>
        <fpage>337</fpage>
        <lpage>48</lpage>
        <pub-id pub-id-type="pmid">8790475</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Cardon1">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cardon</surname>
            <given-names>LR</given-names>
          </name>
          <name>
            <surname>Stormo</surname>
            <given-names>GD</given-names>
          </name>
        </person-group>
        <year>1992</year>
        <article-title>Expectation maximization algorithm for identifying protein-binding sites with variable lengths from unaligned DNA fragments.</article-title>
        <source>J Mol Biol</source>
        <volume>223</volume>
        <fpage>159</fpage>
        <lpage>70</lpage>
        <pub-id pub-id-type="pmid">1731067</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Lawrence1">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lawrence</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Boguski</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Neuwald</surname>
            <given-names>AF</given-names>
          </name>
          <etal/>
        </person-group>
        <year>1993</year>
        <article-title>Detecting subtle sequence signals: a Gibbs sampling strategy for multiple alignment.</article-title>
        <source>Science</source>
        <volume>262</volume>
        <fpage>208</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="pmid">8211139</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Tompa1">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tompa</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bailey</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Church</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>De Moor</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2005</year>
        <article-title>Assessing computational tools for the discovery of transcription factor binding sites.</article-title>
        <source>Nat Biotechnol</source>
        <volume>23</volume>
        <fpage>137</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="pmid">15637633</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Thijs1">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thijs</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lescot</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Marchal</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Rombauts</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>De Moor</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2001</year>
        <article-title>A higher-order background model improves the detection of promoter regulatory elements by Gibbs sampling.</article-title>
        <source>Bioinformatics</source>
        <volume>17</volume>
        <fpage>1113</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="pmid">11751219</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Down1">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Down</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Hubbard</surname>
            <given-names>TJ</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>NestedMICA: sensitive inference of over-represented motifs in nucleic acid sequence.</article-title>
        <source>Nucleic Acids Res</source>
        <volume>33</volume>
        <fpage>1445</fpage>
        <lpage>53</lpage>
        <pub-id pub-id-type="pmid">15760844</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Carninci2">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carninci</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sandelin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lenhard</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Katayama</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shimokawa</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2006</year>
        <article-title>Genome-wide analysis of mammalian promoter architecture and evolution.</article-title>
        <source>Nat Genet</source>
        <volume>38</volume>
        <fpage>626</fpage>
        <lpage>35</lpage>
        <pub-id pub-id-type="pmid">16645617</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Lander1">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Linton</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Birren</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Nusbaum</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zody</surname>
            <given-names>MC</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2001</year>
        <article-title>Initial sequencing and analysis of the human genome.</article-title>
        <source>Nature</source>
        <volume>409</volume>
        <fpage>860</fpage>
        <lpage>921</lpage>
        <pub-id pub-id-type="pmid">11237011</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Workman1">
      <label>17</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Workman</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Stormo</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <year>2000</year>
        <article-title>ANN-Spec: a method for discovering transcription factor binding sites with improved specificity.</article-title>
        <fpage>464</fpage>
        <lpage>475</lpage>
        <comment>In: Pac Symp Biocomput. volume 5</comment>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Segal1">
      <label>18</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Segal</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Barash</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Simon</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Koller</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>2002</year>
        <article-title>From promoter sequence to expression: a probabilistic framework.</article-title>
        <comment>In: Proceedings of the sixth annual international conference on Computational biology. ACM New York, NY, USA, 263–272</comment>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Sinha2">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sinha</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <year>2003</year>
        <article-title>Discriminative motifs.</article-title>
        <source>Journal of Computational Biology</source>
        <volume>10</volume>
        <fpage>599</fpage>
        <lpage>615</lpage>
        <pub-id pub-id-type="pmid">12935347</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Takusagawa1">
      <label>20</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Takusagawa</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Gifford</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>2004</year>
        <article-title>Negative information for motif discovery. </article-title>
        <size units="page">360</size>
        <comment>In: Pacific Symposium on Biocomputing 2004: Proceedings of the Pacific Symposium. World Scientific,</comment>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Sumazin1">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sumazin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hata</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2005</year>
        <article-title>DWE: discriminating word enumerator.</article-title>
        <source>Bioinformatics</source>
        <volume>21</volume>
        <fpage>31</fpage>
        <lpage>38</lpage>
        <pub-id pub-id-type="pmid">15333453</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Leung1">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leung</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Chin</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>Finding motifs from all sequences with and without binding sites.</article-title>
        <source>Bioinformatics</source>
        <volume>22</volume>
        <fpage>2217</fpage>
        <pub-id pub-id-type="pmid">16870937</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Redhead1">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Redhead</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Bailey</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>Discriminative motif discovery in DNA and protein sequences using the DEME algorithm.</article-title>
        <source>BMC bioinformatics</source>
        <volume>8</volume>
        <fpage>385</fpage>
        <pub-id pub-id-type="pmid">17937785</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Narlikar1">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Narlikar</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Gordân</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hartemink</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Miyano</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>A nucleosome-guided map of transcription factor binding sites in yeast.</article-title>
        <source>PLoS Comput Biol</source>
        <volume>3</volume>
        <fpage>e215</fpage>
        <pub-id pub-id-type="pmid">17997593</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Metropolis1">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Metropolis</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Rosenbluth</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rosenbluth</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Teller</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Teller</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <year>1953</year>
        <article-title>Equation of state calculations by fast computing machines.</article-title>
        <source>The journal of chemical physics</source>
        <volume>21</volume>
        <fpage>1087</fpage>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Hastings1">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hastings</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <year>1970</year>
        <article-title>Monte Carlo sampling methods using Markov chains and their applications.</article-title>
        <source>Biometrika</source>
        <volume>57</volume>
        <fpage>97</fpage>
        <lpage>109</lpage>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Beckstette1">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beckstette</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Homann</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Giegerich</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kurtz</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>Fast index based algorithms and software for matching position specific scoring matrices.</article-title>
        <source>BMC bioinformatics</source>
        <volume>7</volume>
        <fpage>389</fpage>
        <pub-id pub-id-type="pmid">16930469</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Marstrand1">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marstrand</surname>
            <given-names>TT</given-names>
          </name>
          <name>
            <surname>Frellsen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Moltke</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Thiim</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Valen</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2008</year>
        <article-title>Asap: a framework for over-representation statistics for transcription factor binding sites.</article-title>
        <source>PLoS ONE</source>
        <volume>3</volume>
        <fpage>e1623</fpage>
        <pub-id pub-id-type="pmid">18286180</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Bailey1">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bailey</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Elkan</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <year>1994</year>
        <article-title>Fitting a mixture model by expectation maximization to discover motifs in biopolymers.</article-title>
        <source>Proc Int Conf Intell Syst Mol Biol</source>
        <volume>2</volume>
        <fpage>28</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="pmid">7584402</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Bryne1">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bryne</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Valen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Marstrand</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Winther</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2008</year>
        <article-title>JASPAR, the open access database of transcription factor-binding profiles: new content and tools in the 2008 update.</article-title>
        <source>Nucleic Acids Res</source>
        <volume>36</volume>
        <fpage>D102</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="pmid">18006571</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Romanish1">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Romanish</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Lock</surname>
            <given-names>WM</given-names>
          </name>
          <name>
            <surname>van de Lagemaat</surname>
            <given-names>LN</given-names>
          </name>
          <name>
            <surname>Dunn</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Mager</surname>
            <given-names>DL</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>Repeated recruitment of LTR retrotransposons as promoters by the anti-apoptotic locus NAIP during mammalian evolution.</article-title>
        <source>PLoS Genet</source>
        <volume>3</volume>
        <fpage>e10</fpage>
        <pub-id pub-id-type="pmid">17222062</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Buzdin1">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buzdin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kovalskaya-Alexandrova</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Gogvadze</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sverdlov</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>GREM, a technique for genome-wide isolation and quantitative analysis of promoter active repeats.</article-title>
        <source>Nucleic Acids Res</source>
        <volume>34</volume>
        <fpage>e67</fpage>
        <pub-id pub-id-type="pmid">16698959</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-PortalesCasamar1">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Portales-Casamar</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kirov</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lithwick</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Swanson</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2007</year>
        <article-title>PAZAR: a framework for collection and dissemination of cis-regulatory sequence annotation.</article-title>
        <source>Genome Biology</source>
        <volume>8</volume>
        <fpage>R207</fpage>
        <pub-id pub-id-type="pmid">17916232</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Liu1">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Marstrand</surname>
            <given-names>TT</given-names>
          </name>
          <name>
            <surname>Strom</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Valen</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2008</year>
        <article-title>The genome landscape of ERalpha- and ERbeta-binding DNA regions.</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <volume>105</volume>
        <fpage>2604</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="pmid">18272478</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Wasserman1">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wasserman</surname>
            <given-names>WW</given-names>
          </name>
          <name>
            <surname>Fickett</surname>
            <given-names>JW</given-names>
          </name>
        </person-group>
        <year>1998</year>
        <article-title>Identification of regulatory regions which confer muscle-specific gene expression.</article-title>
        <source>J Mol Biol</source>
        <volume>278</volume>
        <fpage>167</fpage>
        <lpage>81</lpage>
        <pub-id pub-id-type="pmid">9571041</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Lenhard1">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lenhard</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Sandelin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mendoza</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Engstrom</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Jareborg</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2003</year>
        <article-title>Identification of conserved regulatory elements by comparative genome analysis.</article-title>
        <source>J Biol</source>
        <volume>2</volume>
        <fpage>13</fpage>
        <pub-id pub-id-type="pmid">12760745</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Mellor1">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mellor</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>Dynamic nucleosomes and gene transcription.</article-title>
        <source>Trends in Genetics</source>
        <volume>22</volume>
        <fpage>320</fpage>
        <lpage>329</lpage>
        <pub-id pub-id-type="pmid">16631276</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Wasserman2">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wasserman</surname>
            <given-names>WW</given-names>
          </name>
          <name>
            <surname>Sandelin</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <year>2004</year>
        <article-title>Applied bioinformatics for the identification of regulatory elements.</article-title>
        <source>Nat Rev Genet</source>
        <volume>5</volume>
        <fpage>276</fpage>
        <lpage>87</lpage>
        <pub-id pub-id-type="pmid">15131651</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Bishop1">
      <label>39</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Bishop</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>Pattern recognition and machine learning. Springer New York.</article-title>
      </element-citation>
    </ref>
    <ref id="pcbi.1000562-Kirkpatrick1">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kirkpatrick</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gelatt J C</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Vecchi</surname>
            <given-names>MP</given-names>
          </name>
        </person-group>
        <year>1983</year>
        <article-title>Optimization by simulated annealing.</article-title>
        <source>Science</source>
        <volume>220</volume>
        <fpage>671</fpage>
        <lpage>680</lpage>
        <pub-id pub-id-type="pmid">17813860</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
