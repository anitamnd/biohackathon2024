<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Immunol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Immunol</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Immunol.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Immunology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1664-3224</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7727328</article-id>
    <article-id pub-id-type="doi">10.3389/fimmu.2020.583013</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Immunology</subject>
        <subj-group>
          <subject>Original Research</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Accurate and Efficient KIR Gene and Haplotype Inference From Genome Sequencing Reads With Novel K-mer Signatures</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Roe</surname>
          <given-names>David</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="author-notes" rid="fn001">
          <sup>*</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="https://loop.frontiersin.org/people/1006778"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kuang</surname>
          <given-names>Rui</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1"><sup>1</sup><institution>Bioinformatics and Computational Biology, University of Minnesota</institution>, <addr-line>Rochester, MN</addr-line>, <country>United States</country></aff>
    <aff id="aff2"><sup>2</sup><institution>Department of Computer Science and Engineering, University of Minnesota</institution>, <addr-line>Minneapolis, MN</addr-line>, <country>United States</country></aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p>Edited by: Malini Raghavan, University of Michigan, United States</p>
      </fn>
      <fn fn-type="edited-by">
        <p>Reviewed by: Sandeep Kumar Dhanda, St. Jude Children’s Research Hospital, United States; Marcia Maria Marques, Barretos Cancer Hospital, Brazil</p>
      </fn>
      <corresp id="fn001">*Correspondence: David Roe, <email xlink:href="mailto:roex0050@umn.edu" xlink:type="simple">roex0050@umn.edu</email>
</corresp>
      <fn fn-type="other" id="fn002">
        <p>This article was submitted to Alloimmunity and Transplantation, a section of the journal Frontiers in Immunology</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>26</day>
      <month>11</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>11</volume>
    <elocation-id>583013</elocation-id>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>7</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>02</day>
        <month>11</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2020 Roe and Kuang</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Roe and Kuang</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>The killer-cell immunoglobulin-like receptor (KIR) proteins evolve to fight viruses and mediate the body’s reaction to pregnancy. These roles provide selection pressure for variation at both the structural/haplotype and base/allele levels. At the same time, the genes have evolved relatively recently by tandem duplication and therefore exhibit very high sequence similarity over thousands of bases. These variation-homology patterns make it impossible to interpret KIR haplotypes from abundant short-read genome sequencing data at population scale using existing methods. Here, we developed an efficient computational approach for <italic>in silico</italic> KIR probe interpretation (KPI) to accurately interpret individual’s KIR genes and haplotype-pairs from KIR sequencing reads. We designed synthetic 25-base sequence probes by analyzing previously reported haplotype sequences, and we developed a bioinformatics pipeline to interpret the probes in the context of 16 KIR genes and 16 haplotype structures. We demonstrated its accuracy on a synthetic data set as well as a real whole genome sequences from 748 individuals from The Genome of the Netherlands (GoNL). The GoNL predictions were compared with predictions from SNP-based predictions. Our results show 100% accuracy rate for the synthetic tests and a 99.6% family-consistency rate in the GoNL tests. Agreement with the SNP-based calls on KIR genes ranges from 72%–100% with a mean of 92%; most differences occur in genes <italic>KIR2DS2</italic>, <italic>KIR2DL2</italic>, <italic>KIR2DS3</italic>, and <italic>KIR2DL5</italic> where KPI predicts presence and the SNP-based interpretation predicts absence. Overall, the evidence suggests that KPI’s accuracy is 97% or greater for both KIR gene and haplotype-pair predictions, and the presence/absence genotyping leads to ambiguous haplotype-pair predictions with 16 reference KIR haplotype structures. KPI is free, open, and easily executable as a Nextflow workflow supported by a Docker environment at <uri xlink:type="simple" xlink:href="https://github.com/droeatumn/kpi">https://github.com/droeatumn/kpi</uri>.</p>
    </abstract>
    <kwd-group>
      <kwd>killer-cell immunoglobulin-like receptor</kwd>
      <kwd>genotype</kwd>
      <kwd>haplotype</kwd>
      <kwd>interpretation</kwd>
      <kwd>natural killer</kwd>
      <kwd>whole genome sequencing (WGS)</kwd>
    </kwd-group>
    <counts>
      <fig-count count="1"/>
      <table-count count="5"/>
      <equation-count count="0"/>
      <ref-count count="21"/>
      <page-count count="9"/>
      <word-count count="5215"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="s1">
    <title>Introduction</title>
    <p>Human chromosome 19q13.4 contains a ~150–250 kilobase region encoding 16 genes of the natural killer-cell immunoglobulin-like receptor (KIR) family. These genes are ~4–16 kilobases long and evolved <italic>via</italic> tandem duplication during primate evolution (<xref rid="B1" ref-type="bibr">1</xref>, <xref rid="B2" ref-type="bibr">2</xref>). The KIR receptors recognize human leukocyte antigen (HLA) class I molecules and contribute to natural killer (NK) cell functions <italic>via</italic> activating or inhibiting signals. These receptor-ligand pairs coevolved under selection pressures from reproduction and pathogenic defense (<xref rid="B3" ref-type="bibr">3</xref>), and it is believed that KIR genes have undergone a balancing selection <italic>via</italic> duplications and deletions into two broad categories of haplotypes, in which one category tends to vary more at the allelic level and the other tends to vary more at the structural (gene content and order) level (<xref rid="B4" ref-type="bibr">4</xref>–<xref rid="B6" ref-type="bibr">6</xref>). A few dozen KIR full haplotype sequences and approximately 2500 full- or inter-gene sequences have been publicly deposited (<xref rid="B5" ref-type="bibr">5</xref>, <xref rid="B7" ref-type="bibr">7</xref>, <xref rid="B8" ref-type="bibr">8</xref>). Haplotype structures are divided into two classes (<xref rid="B9" ref-type="bibr">9</xref>). Class ‘A’ contains one haplotype and its deleted forms. Class ‘B’ haplotypes are more structurally diverse and contain a variety of insertions and deletions. Generally, the A haplotype occurs with 50-60% frequency, haplotypes that are half-A and half-B occur with 30-40%, and the rest of the haplotypes are variants of the B haplotypes. Except for some rarer deleted forms, KIR haplotypes are structurally variable around 4 ‘framework’ genes (<italic>KIR3DL3</italic>, <italic>KIR3DP1</italic>, <italic>KIR2DL4</italic>, <italic>KIR3DL2</italic>), with <italic>KIR3DL3</italic> through <italic>KIR3DP1</italic> defining the proximal (or ‘centromeric’) region and <italic>KIR2DL4</italic> through <italic>KIR3DL2</italic> defining the distal (or ‘telomeric’) region, with the two gene-rich regions separated by the relatively large and recombinant <italic>KIR3DP1-KIR2DL4</italic> intergene region.</p>
    <p>It is difficult to interpret the KIR region with high-throughput sequencing reads for an individual human genome when the structural arrangements are unknown; indeed, it is difficult even when the structural haplotypes are known, since the read length is too short to map unambiguously to the repetitive and homologous KIR genes. As a consequence, the reads from KIR region are ignored, as to the best of our knowledge, there are currently no algorithms to interpret KIR from whole genome sequencing (WGS). SNP (single nucleotide polymorphism)-based KIR interpretation is more commonly applied. For example, KIR*IMP is a web-application to predict genes and haplotypes from microarray SNP genotypes (<xref rid="B10" ref-type="bibr">10</xref>). As an algorithm whose raw data is microarray calls, KIR*IMP can interpret KIR from genome wide SNP arrays, but it is not applicable to interpret KIR from raw sequences.</p>
    <p>Since a general solution for KIR structural interpretation from raw genomic DNA is not currently available, this study implements such an algorithm for the prediction of KIR genes and full structural haplotypes from any type of raw full-region-or-greater genomic sequence at population scale. In particular, we systematically evaluated small markers for KIR genes and then applied those markers to a synthetic KIR probe interpretation (KPI) algorithm for the presence/absence of 16 KIR genes and 16 haplotype structures. Our approach leverages recent bioinformatics innovations for short sequence (‘probe’) genotyping, along recently published KIR reference haplotypes. The KPI algorithm first efficiently counts the occurrence of each kmer probe in the raw sequences, and then uses multiple probes per gene to call its presence/absence. Those 16 genotypes are then used to generate haplotype-pair predictions. In the experiments, we report 100% accuracy on a test set of synthetic haplotypes for comparisons with known truth. We also report that gene and haplotype-pair predictions for the WGS GoNL cohort are family consistent and compare favorably with reference frequencies in comparison to SNP-based predictions using KIR*IMP.</p>
  </sec>
  <sec sec-type="materials|methods" id="s2">
    <title>Materials and Methods</title>
    <sec id="s2_1">
      <title>Overview</title>
      <p>The workflow of KPI consists of three steps,</p>
      <list list-type="order">
        <list-item>
          <p>Discover the 25mer gene markers based on a multiple sequence alignment analysis of 68 full-length haplotype sequences.</p>
        </list-item>
        <list-item>
          <p>Count the 25mer markers in the reads of genomic DNA per individual to generate the individual’s 25mer genotype.</p>
        </list-item>
        <list-item>
          <p>Predict presence/absence per gene from the marker genotypes for each individual.</p>
        </list-item>
        <list-item>
          <p>Predict haplotype pairs from the gene presence/absence calls for each individual.</p>
        </list-item>
      </list>
      <p>In the following, we first explain each step and then describe the synthetic data and GoNL data used for the evaluation.</p>
    </sec>
    <sec id="s2_2">
      <title>Step 1: Discovering 25mer Gene Markers</title>
      <p>To discover gene marker 25mers, first a multiple sequence alignment (MSA) was created with 68 publicly deposited full-length haplotypes sequences (<xref rid="B11" ref-type="bibr">11</xref>). Briefly, each haplotype was annotated at an average resolution of ~4kbp using a set of 15 120-base markers. This high-level annotation was aligned into a MSA representing a structural alignment of all haplotypes. Then, each subregion was aligned to base pair resolution. This resulted in a full resolution, full haplotype MSA that accurately classifies each allele into a haplotype-defined locus, and it aligns the alleles precisely at each locus. The haplotype and gene annotations of the MSA provided a list of full-length alleles for 16 genes: <italic>KIR2DL1-5, KIR2DS1-5, KIR2DP1, KIR3DL1-3, KIR3DP1</italic>, and <italic>KIR3DS1</italic>. Markers for each gene locus were chosen by selecting all sequences of length 25 (25mers) present in every allele of the gene but not elsewhere in the KIR haplotypes nor the rest of the genome reference GRCh38. More details about the algorithm are in <xref ref-type="supplementary-material" rid="SF1"><bold>Supplemental Figure 1</bold></xref>. The marker sequences are in <xref ref-type="supplementary-material" rid="SF2"><bold>Supplemental Data Sheet 1</bold></xref> and also checked in to GitHub at <uri xlink:type="simple" xlink:href="https://github.com/droeatumn/kpi/tree/master/input">https://github.com/droeatumn/kpi/tree/master/input</uri> in text and fasta format.</p>
    </sec>
    <sec id="s2_3">
      <title>Step 2: Count 25mer Markers</title>
      <p>KMC 3, with workflows implemented in Nextflow (<xref rid="B12" ref-type="bibr">12</xref>) and Apache Groovy (<xref rid="B13" ref-type="bibr">13</xref>) and a software environment implemented as a Docker container, is used to create 25mer databases from sequence or short-read data and match the markers across the datasets. Using KMC 3, we generate the list of all 25mers from the short reads of each individual and then match the 25mers in the marker databases to report the hit counts of each 25mer marker in the individual. Details are in <xref ref-type="supplementary-material" rid="SF1"><bold>Supplemental Figure 1</bold></xref>.</p>
    </sec>
    <sec id="s2_4">
      <title>Step 3: Individual Genotyping From 25mer Markers</title>
      <p>KPI calls presence/absence per gene by aggregating the presence/absence genotypes of many small (25mer) markers, each specific to one gene. 25mers with hit counts less than three are considered sequencing errors and set to zero. If the mean hit count of all the markers per gene is zero, then the gene is predicted absent; otherwise, it is called present. Additional details can be found in <xref ref-type="supplementary-material" rid="SF1"><bold>Supplemental Figure 1</bold></xref>.</p>
    </sec>
    <sec id="s2_5">
      <title>Step 4: Individual Haplotyping From Genotypes</title>
      <p>Haplotype-pair predictions were made by fitting the genotype to all possible pairs of the 16 structural reference haplotypes defined in <xref ref-type="fig" rid="f1"><bold>Figure 1</bold></xref>. The numbers and frequencies of the haplotypes are from Jiang et al. 2012 (<xref rid="B4" ref-type="bibr">4</xref>) (<xref rid="T1" ref-type="table"><bold>Table 1</bold></xref>); some of their haplotypes are combined because Jiang et al. consider certain alleles as separate haplotypes, such as full or deleted alleles of <italic>KIR2DS4</italic>. These 16 haplotypes represent 97% of all haplotypes in the Jiang et al. report.</p>
      <fig id="f1" position="float">
        <label>Figure 1</label>
        <caption>
          <p>Reference haplotype definitions. Haplotype numeric labels (Jiang et al. 2012) are shown with their definition <italic>via</italic> gene counts. Following Jiang et al. convention, some haplotypes (e.g., 7, 9) are distinguished by <italic>KIR2DS3</italic>/<italic>KIR2DS5</italic> alleles instead of structural differences. In this study, some haplotypes (e.g., 1, 2) are combined, as <italic>KIR2DS4</italic> full/deleted alleles are not considered in KPI’s genotyping.</p>
        </caption>
        <graphic xlink:href="fimmu-11-583013-g001"/>
      </fig>
      <table-wrap id="T1" position="float">
        <label>Table 1</label>
        <caption>
          <p>Reference haplotype names and frequencies.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th valign="top" align="left" rowspan="1" colspan="1">Jiang et al. 2012 #</th>
              <th valign="top" align="center" rowspan="1" colspan="1">informal names</th>
              <th valign="top" align="center" rowspan="1" colspan="1">Jiang et al. 2012 freq.</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">1/2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">cA01~tA01</td>
              <td valign="top" align="center" rowspan="1" colspan="1">55.2%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">3</td>
              <td valign="top" align="center" rowspan="1" colspan="1">cA01~tB01_2DS5</td>
              <td valign="top" align="center" rowspan="1" colspan="1">10.9%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">11</td>
              <td valign="top" align="center" rowspan="1" colspan="1">cA01~tB01_2DS3</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.4%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">4/5</td>
              <td valign="top" align="center" rowspan="1" colspan="1">cB02~tA01</td>
              <td valign="top" align="center" rowspan="1" colspan="1">12.8%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">6/10</td>
              <td valign="top" align="center" rowspan="1" colspan="1">cB01~tA01_2DS3</td>
              <td valign="top" align="center" rowspan="1" colspan="1">6.9%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">25</td>
              <td valign="top" align="center" rowspan="1" colspan="1">cB01~tA01_2DS5</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.1%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">7</td>
              <td valign="top" align="center" rowspan="1" colspan="1">cB01~tB01_2DS3_2DS5</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2.6%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">9</td>
              <td valign="top" align="center" rowspan="1" colspan="1">cB01~tB01_2DS3_2DS3</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2.1%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">8</td>
              <td valign="top" align="center" rowspan="1" colspan="1">cB02~tB01_2DS5</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2.1%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">17</td>
              <td valign="top" align="center" rowspan="1" colspan="1">cB02~tB01_2DS3</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.3%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">12</td>
              <td valign="top" align="center" rowspan="1" colspan="1">cB04~tB03_2DS5</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.8%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">18</td>
              <td valign="top" align="center" rowspan="1" colspan="1">cB04~tB03_2DS3</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.3%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">13</td>
              <td valign="top" align="center" rowspan="1" colspan="1">cB01~tB05</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.7%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">15</td>
              <td valign="top" align="center" rowspan="1" colspan="1">cB05~tB01</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.4%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">16</td>
              <td valign="top" align="center" rowspan="1" colspan="1">cA01~tB05</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.3%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">21</td>
              <td valign="top" align="center" rowspan="1" colspan="1">cB05~tA01</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.2%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">sum</td>
              <td valign="top" align="left" rowspan="1" colspan="1"> </td>
              <td valign="top" align="center" rowspan="1" colspan="1">97.0%</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn>
            <p>The first column contains the numeric label assigned to haplotypes in Jiang et al. (2012). Column 2 contains the informal names along with a reference frequency in column 3.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>For the GoNL predictions, haplotype ambiguity was reduced by family trio patterns and then further by the EM (Expectation-Maximization)-based methods as described and used in Vierra-Green 2012 (<xref rid="B14" ref-type="bibr">14</xref>). Haplotype frequencies were calculated from the EM-reduced individual haplotype-pair predictions. These haplotype frequency calculations are not possible on the KPI’s haplotype-pair predictions because they can be ambiguous.</p>
    </sec>
    <sec id="s2_6">
      <title>Synthetic Capture on Diploid Data</title>
      <p>KPI was evaluated on a synthetic test set. There are six reference haplotype structures with publicly deposited full-length sequences (<xref ref-type="fig" rid="f1"><bold>Figure 1</bold></xref>, top six rows). For each of these six structures, one sequence was randomly chosen to represent that structure, and it was paired with a random haplotype sequence from the set of all sequences, with an equal probability for each sequence. dwgsim (<xref rid="B12" ref-type="bibr">12</xref>) was used to generate 10,000 2×150 pair reads per haplotype (~20× coverage) with 1% error rate. This provided a simulated six-person validation set of six diploid whole-region short-read sequences, representing all fully sequenced haplotype structures and paired to provide a variety of genotypes. The sequences are included in <xref ref-type="supplementary-material" rid="SF3"><bold>Supplemental Data Sheet 2</bold></xref>.</p>
    </sec>
    <sec id="s2_7">
      <title>GoNL Family WGS and Immunochip SNP Data</title>
      <p>KPI was also run on a large real-world example. WGS was obtained from The Genome of the Netherlands (GoNL) (<xref rid="B13" ref-type="bibr">13</xref>), a genome sequencing project whose goal is to map the genetic variation within the population of Netherlands in 250 family trios (750 individuals). The project provided non-paired sequencing of the whole genomes of the population, which was done on the Illumina HiSeq 2000 platform. Coverage of the KIR region were similar to the previously reported (<xref rid="B13" ref-type="bibr">13</xref>) whole-genome average of ~10–15×. Two individuals from two different families were removed from the GoNL project for data quality reasons, giving a total of 748 individuals.</p>
      <p>KPI’s GoNL predictions were compared with results from microarray-based interpretation algorithm KIR*IMP. Illumina Immunochip microarray SNP data was obtained from GoNL (<xref rid="B13" ref-type="bibr">13</xref>). The data was prepared and executed following instructions using KIR*IMP v1.2.0 on 2019-10-05.</p>
      <p>To the best of our knowledge, there only exists one method to predict KIR gene content from WGS sequences (<xref rid="B15" ref-type="bibr">15</xref>). However, we were unable to obtain results with it for both evaluation data sets. According to the authors, the current version is deprecated and to be replaced soon (<xref rid="B16" ref-type="bibr">16</xref>).</p>
    </sec>
  </sec>
  <sec sec-type="results" id="s3">
    <title>Results</title>
    <p>The predictions were evaluated in the small synthetic test set, where truth is known and a large real-world test set, where truth is unknown except for family relationships. Predictions were evaluated by comparing gene and haplotype-pair predictions to: known truth in the synthetic cohort, and family consistency (real-world cohort only), reference frequencies from Jiang et al.’s family copy number study (<xref rid="B4" ref-type="bibr">4</xref>), and the Allele Frequencies Database (<xref rid="B17" ref-type="bibr">17</xref>) in the real-world cohort. The real-world cohort was also compared with predictions from microarray-based algorithm KIR*IMP, although KIR*IMP was not considered ground truth as it reports accuracies as low as 81% for some genes (<xref rid="B10" ref-type="bibr">10</xref>). Haplotype-pair predictions were considered to be family consistent if each parents’ two haplotype predictions contained at least one of the child’s two predictions and one of the child’s haplotypes occurred in one parent and the other haplotype occurred in the other parent.</p>
    <sec id="s3_1">
      <title>Synthetic Evaluation</title>
      <p><xref rid="T2" ref-type="table"><bold>Table 2</bold></xref> shows the results of the synthetic tests. The gene present/absent calls were 100% accurate for all genes. Although the haplotype predictions are ambiguous in half of the individuals, all are consistent with the ground truth.</p>
      <table-wrap id="T2" position="float">
        <label>Table 2</label>
        <caption>
          <p>Results of synthetic tests.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th valign="top" align="left" rowspan="1" colspan="1">haplotype 1 structure</th>
              <th valign="top" align="center" rowspan="1" colspan="1">haplotype 2 structure</th>
              <th valign="top" align="center" rowspan="1" colspan="1">haplotype 1 GenBank accession</th>
              <th valign="top" align="center" rowspan="1" colspan="1">haplotype 2 GenBank accession</th>
              <th valign="top" align="center" rowspan="1" colspan="1">KPI haplotype prediction</th>
              <th valign="top" align="center" rowspan="1" colspan="1">haplotypes consistent w/ truth?</th>
              <th valign="top" align="center" rowspan="1" colspan="1">gene prediction accuracy</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">cA01~tA01</td>
              <td valign="top" align="left" rowspan="1" colspan="1">cA01~tA01</td>
              <td valign="top" align="left" rowspan="1" colspan="1">GU182344</td>
              <td valign="top" align="left" rowspan="1" colspan="1">GU182340</td>
              <td valign="top" align="left" rowspan="1" colspan="1">cA01~tA01+cA01~tA01</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Y</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">cA01~tB01</td>
              <td valign="top" align="left" rowspan="1" colspan="1">cA01~tA01</td>
              <td valign="top" align="left" rowspan="1" colspan="1">KU645197</td>
              <td valign="top" align="left" rowspan="1" colspan="1">GU182360</td>
              <td valign="top" align="left" rowspan="1" colspan="1">cA01~tA01+cA01~tB01 or<break/>cA01~tB01+cA01~tB05</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Y</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">cB01~tA01</td>
              <td valign="top" align="left" rowspan="1" colspan="1">cA01~tA01</td>
              <td valign="top" align="left" rowspan="1" colspan="1">GU182351</td>
              <td valign="top" align="left" rowspan="1" colspan="1">NC000019.10</td>
              <td valign="top" align="left" rowspan="1" colspan="1">cA01~tA01+cB01~tA01</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Y</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">cB01~tB01</td>
              <td valign="top" align="left" rowspan="1" colspan="1">cB02~tA01</td>
              <td valign="top" align="left" rowspan="1" colspan="1">GU182339</td>
              <td valign="top" align="left" rowspan="1" colspan="1">GU182353</td>
              <td valign="top" align="left" rowspan="1" colspan="1">10 possibilities, including<break/>cB01~tB01+cB02~tA01</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Y</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">cB02~tA01</td>
              <td valign="top" align="left" rowspan="1" colspan="1">cA01~tA01</td>
              <td valign="top" align="left" rowspan="1" colspan="1">GU182341</td>
              <td valign="top" align="left" rowspan="1" colspan="1">KP420442</td>
              <td valign="top" align="left" rowspan="1" colspan="1">cA01~tA01+cB02~tA01</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Y</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">cB02~tB01</td>
              <td valign="top" align="left" rowspan="1" colspan="1">cA01~tA01</td>
              <td valign="top" align="left" rowspan="1" colspan="1">GU182359</td>
              <td valign="top" align="left" rowspan="1" colspan="1">KP420439</td>
              <td valign="top" align="left" rowspan="1" colspan="1">9 possibilities, including<break/>cA01~tA01+cB02~tB01</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Y</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100%</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn>
            <p>The first four columns detail the sequences from which the tests (n=6 haplotype-pairs) were generated. The fifth column is killer-cell immunoglobulin-like receptor probe interpretation’s (KPI’s) haplotype predictions, some of which are summarized for display.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="s3_2">
      <title>GoNL Evaluation</title>
      <p><xref rid="T3" ref-type="table"><bold>Table 3</bold></xref> shows a summary of the gene prediction results from KPI and KIR*IMP on the GoNL data set. A reference frequency range is included from Allele Frequencies Net, selecting European cohorts &gt;= 500 individuals. Overall agreement between KIR*IMP and KPI for the 16 genes (<xref rid="T3" ref-type="table"><bold>Table 3</bold></xref>, column 6) ranges from 72% to 100%, with a mean of 92%. KIR*IMP differs from the reference haplotype (<xref rid="T3" ref-type="table"><bold>Table 3</bold></xref>, column 7) frequency range by &gt;10% in four genes (<italic>KIR2DS2</italic>, <italic>KIR2DL2</italic>, <italic>KIR2DL5</italic>, and <italic>KIR2DS3</italic>) compared with 0 genes for KPI (<xref rid="T3" ref-type="table"><bold>Table 3</bold></xref>, column 8). Both KIR*IMP and KPI differ from the <italic>KIR2DS1</italic> reference by 9-10%, although the two algorithms agree in 98% of individuals for that gene.</p>
      <table-wrap id="T3" position="float">
        <label>Table 3</label>
        <caption>
          <p>Summary of killer-cell immunoglobulin-like receptor (KIR)*IMP and KIR probe interpretation (KPI) gene predictions.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th valign="top" align="left" rowspan="1" colspan="1">gene</th>
              <th valign="top" align="center" rowspan="1" colspan="1">reference freq.</th>
              <th valign="top" align="center" rowspan="1" colspan="1">KIR*IMP freq.</th>
              <th valign="top" align="center" rowspan="1" colspan="1">KPI freq.</th>
              <th valign="top" align="center" rowspan="1" colspan="1">KIR*IMP - KPI</th>
              <th valign="top" align="center" rowspan="1" colspan="1">KIR*IMP &amp; KPI agreement</th>
              <th valign="top" align="center" rowspan="1" colspan="1">KIR*IMP - reference</th>
              <th valign="top" align="center" rowspan="1" colspan="1">KPI - reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">2DS2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">53-54%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">39%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">52%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−13%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">
                <bold>72%</bold>
              </td>
              <td valign="top" align="center" rowspan="1" colspan="1">
                <bold>−14%</bold>
              </td>
              <td valign="top" align="center" rowspan="1" colspan="1">
                <bold>−1%</bold>
              </td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">2DL2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">53-54%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">39%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">51%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−12%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">
                <bold>72%</bold>
              </td>
              <td valign="top" align="center" rowspan="1" colspan="1">
                <bold>−14%</bold>
              </td>
              <td valign="top" align="center" rowspan="1" colspan="1">
                <bold>−2%</bold>
              </td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">2DL3</td>
              <td valign="top" align="center" rowspan="1" colspan="1">90%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">96%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">92%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">4%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">92%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">6%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">2DP1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">96%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">97%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">97%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">3%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">2DL1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">96%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">97%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">97%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">3%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">3DP1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">2DL4</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">3DL1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">93%–94%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">96%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">96%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">3DS1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">38%–44%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">33%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">35%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−2%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">97%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−5%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−3%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">2DL5</td>
              <td valign="top" align="center" rowspan="1" colspan="1">53%–56%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">38%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">47%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−9%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">
                <bold>87%</bold>
              </td>
              <td valign="top" align="center" rowspan="1" colspan="1">
                <bold>−15%</bold>
              </td>
              <td valign="top" align="center" rowspan="1" colspan="1">
                <bold>−6%</bold>
              </td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">2DS3</td>
              <td valign="top" align="center" rowspan="1" colspan="1">30%–31%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">10%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">29%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−18%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">
                <bold>81%</bold>
              </td>
              <td valign="top" align="center" rowspan="1" colspan="1">
                <bold>−20%</bold>
              </td>
              <td valign="top" align="center" rowspan="1" colspan="1">
                <bold>−1%</bold>
              </td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">2DS5</td>
              <td valign="top" align="center" rowspan="1" colspan="1">30%–36%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">25%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">27%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−2%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">96%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−5%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−3%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">2DS4</td>
              <td valign="top" align="center" rowspan="1" colspan="1">92%–94%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">96%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">96%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">2DS1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">43%–44%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">33%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">34%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−1%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">98%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−10%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−9%</td>
            </tr>
            <tr>
              <td valign="top" colspan="5" align="left" rowspan="1">average</td>
              <td valign="top" align="center" rowspan="1" colspan="1">92%</td>
              <td valign="top" align="center" rowspan="1" colspan="1"/>
              <td valign="top" align="center" rowspan="1" colspan="1"/>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn>
            <p>Frequencies relative to Genome of the Netherlands (GoNL) cohort of 748 individuals. The abbreviated gene name is in column 1. Column 2 lists the reference frequencies from The Allele Frequency Net Database. The predicted frequencies from KIR*IMP and KPI are in columns 3 and 4, respectively. The delta between KIR*IMP and KPI is shown in the column 5. Column 6 shows the agreement between KIR*IMP and KPI. Column 7 shows the delta between KIR*IMP and the reference. Column 8 shows the delta between KPI and the reference. Frequencies with differences &gt;10% are in bold.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p><xref rid="T4" ref-type="table"><bold>Table 4</bold></xref> breaks down the differences between KIR*IMP and KPI in a confusion matrix. In the cases where KIR*IMP calls present (‘P’) and KPI calls absent (‘A’) (<xref rid="T4" ref-type="table"><bold>Table 4</bold></xref>, column 2), the largest discrepancies are found in the centromeric genes <italic>KIR2DS2</italic> (8%), <italic>KIR2DL2</italic> (8%), and <italic>KIR2DL3</italic> (6%). In the reverse cases, when KIR*IMP calls absent and KPI calls present (<xref rid="T4" ref-type="table"><bold>Table 4</bold></xref>, column 3), the largest discrepancies are greater and occur with the centromeric <italic>KIR2DS2</italic> (20%), <italic>KIR2DL2</italic> (20%), and the paralogous (centromeric or telomeric) <italic>KIR2DL5</italic> (11%), and <italic>KIR2DS3</italic> (19%).</p>
      <table-wrap id="T4" position="float">
        <label>Table 4</label>
        <caption>
          <p>Confusion matrix of killer-cell immunoglobulin-like receptor (KIR)*IMP and KIR probe interpretation (KPI) gene predictions.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th valign="top" align="left" rowspan="1" colspan="1">gene</th>
              <th valign="top" align="center" rowspan="1" colspan="1">KIR*IMP:P KPI:A</th>
              <th valign="top" align="center" rowspan="1" colspan="1">KIR*IMP:A KPI:P</th>
              <th valign="top" align="center" rowspan="1" colspan="1">KIR*IMP:P KPI:P</th>
              <th valign="top" align="center" rowspan="1" colspan="1">KIR*IMP:A KPI:A</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">2DS2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">8%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">
                <bold>20%</bold>
              </td>
              <td valign="top" align="center" rowspan="1" colspan="1">32%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">40%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">2DL2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">8%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">
                <bold>20%</bold>
              </td>
              <td valign="top" align="center" rowspan="1" colspan="1">31%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">41%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">2DL3</td>
              <td valign="top" align="center" rowspan="1" colspan="1">6%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">90%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">2DP1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">97%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">2DL1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">97%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">3DP1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">2DL4</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">3DL1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">96%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">4%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">3DS1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">3%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">32%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">64%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">2DL5</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">
                <bold>11%</bold>
              </td>
              <td valign="top" align="center" rowspan="1" colspan="1">36%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">51%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">2DS3</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">
                <bold>19%</bold>
              </td>
              <td valign="top" align="center" rowspan="1" colspan="1">10%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">71%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">2DS5</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">3%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">24%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">72%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">2DS4</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">96%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">4%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">2DS1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">33%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">66%</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn>
            <p>Frequencies relative to GoNL cohort size of 748 individuals. The abbreviated gene names are in column 1. Column 2 lists the cases when KIR*IMP calls present (‘P’) and KPI calls absent (‘A’). Column 3 lists the cases when KIR*IMP calls absent (‘A’) and KPI calls present (‘P’). Column 4 is when they both call present. Column 5 is when they both call absent. Discrepancies &gt;10% are in bold.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Per-individual haplotype-pair predictions for the GoNL cohort are included in <xref ref-type="supplementary-material" rid="SM1"><bold>Supplemental Table 1</bold></xref>. Three lists of haplotype-pairs are provided: one for the initial fitting of all possible haplotype-pairs that could explain the genotype (i.e., KPI’s output); another that reduces those possibilities by family relationships; and one for the EM-reduced final haplotype-pair predictions.</p>
      <p>KIR*IMP makes one most-likely prediction for all individuals. KPI’s predictions are sometimes ambiguous, with most predictions (mode) having one haplotype-pair but a mean of 2.3, standard deviation of 2.5, and a maximum of 14 haplotype-pair predictions per individual in the context of the 16 reference haplotypes. The KIR*IMP predictions are family consistent 100% of the time compared with 99.6% for KPI. However, the haplotype pair predictions between the two algorithms are concordant only 58% of the predictions.</p>
      <p><xref rid="T5" ref-type="table"><bold>Table 5</bold></xref> compares the haplotype predictions between KIR*IMP and the EM-reduced haplotype pair predictions from the KPI output. KIR*IMP fit 100% of its predicted genotypes into 15 of its reference haplotypes. KPI fit 97% of its predicted genotypes into its 16 reference haplotypes. KIR*IMP made predictions for two haplotypes (cA01~tB04 and cB04~tB03, numbered 14, 18, and 12), totaling 0.47%, that are not in KPI’s set of reference haplotypes. KPI’s haplotype-pair predictions are too ambiguous to summarize in haplotype frequencies.</p>
      <table-wrap id="T5" position="float">
        <label>Table 5</label>
        <caption>
          <p>Comparison of killer-cell immunoglobulin-like receptor (KIR)*IMP highest probability and EM-reduced haplotype prediction frequencies.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th valign="top" align="left" rowspan="1" colspan="1">hap</th>
              <th valign="top" rowspan="2" align="center" colspan="1">reference frequency</th>
              <th valign="top" rowspan="2" align="center" colspan="1">KIR*IMP</th>
              <th valign="top" rowspan="2" align="center" colspan="1">KPI w/ EM</th>
              <th valign="top" align="center" rowspan="1" colspan="1">KIR*IMP -</th>
              <th valign="top" align="center" rowspan="1" colspan="1">KPI w/ EM -</th>
              <th valign="top" align="center" rowspan="1" colspan="1">KIR*IMP -</th>
            </tr>
            <tr>
              <th valign="top" align="left" rowspan="1" colspan="1">#</th>
              <th valign="top" align="center" rowspan="1" colspan="1">reference</th>
              <th valign="top" align="center" rowspan="1" colspan="1">reference</th>
              <th valign="top" align="center" rowspan="1" colspan="1"> KPI w/ EM</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">1</td>
              <td valign="top" rowspan="2" align="center" colspan="1">55.20%</td>
              <td valign="top" rowspan="2" align="center" colspan="1">71.86%</td>
              <td valign="top" rowspan="2" align="center" colspan="1">59.70%</td>
              <td valign="top" rowspan="2" align="center" colspan="1">16.70%</td>
              <td valign="top" rowspan="2" align="center" colspan="1">4.50%</td>
              <td valign="top" rowspan="2" align="center" colspan="1">12.17%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">2</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">3</td>
              <td valign="top" align="center" rowspan="1" colspan="1">10.90%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">12.57%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">9.60%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.70%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−1.29%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2.95%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">11</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.40%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.47%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.60%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.00%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−0.82%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.85%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">4</td>
              <td valign="top" rowspan="2" align="center" colspan="1">12.80%</td>
              <td valign="top" rowspan="2" align="center" colspan="1">7.49%</td>
              <td valign="top" rowspan="2" align="center" colspan="1">15.30%</td>
              <td valign="top" rowspan="2" align="center" colspan="1">−5.30%</td>
              <td valign="top" rowspan="2" align="center" colspan="1">2.55%</td>
              <td valign="top" rowspan="2" align="center" colspan="1">-7.83%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">5</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">9</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2.10%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">3.41%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2.90%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.30%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.78%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.52%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">7</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2.60%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.33%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">3.60%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−2.20%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.00%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−3.24%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">6</td>
              <td valign="top" rowspan="2" align="center" colspan="1">6.90%</td>
              <td valign="top" rowspan="2" align="center" colspan="1">1.80%</td>
              <td valign="top" rowspan="2" align="center" colspan="1">5.90%</td>
              <td valign="top" rowspan="2" align="center" colspan="1">−5.10%</td>
              <td valign="top" rowspan="2" align="center" colspan="1">−1.08%</td>
              <td valign="top" rowspan="2" align="center" colspan="1">−4.05%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">10</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">8</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2.10%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.60%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.50%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−1.50%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−1.65%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.12%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">17</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.30%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.00%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.00%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−0.30%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−0.23%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−0.03%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">14*</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2.40%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.40%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.00%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−2.00%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.00%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.00%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">18*</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.30%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.07%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.00%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−0.20%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.00%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.00%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">12*</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.80%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.00%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.00%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−0.80%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.00%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.00%</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">mean</td>
              <td valign="top" align="center" rowspan="1" colspan="1">97.00%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100.00%</td>
              <td valign="top" align="center" rowspan="1" colspan="1">98.10%</td>
              <td valign="top" align="center" rowspan="1" colspan="1"> </td>
              <td valign="top" align="center" rowspan="1" colspan="1"> </td>
              <td valign="top" align="center" rowspan="1" colspan="1"> </td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn>
            <p>The table shows the comparison of the predictions between both methods as well as with reference European frequencies from Jiang et al. 2012 (column 2), which is the source of the haplotype numbers (column 1). KIR*IMP’s haplotype frequencies for the 1496 GoNL haplotypes are in column 3; some haplotypes are combined, as the haplotype numbers distinguish KIR2DS4 alleles. Column 4 contains frequencies for EM-reduced KIR probe interpretation (KPI) haplotype predictions Column 5 compares KIR*IMP frequencies with the reference, as column 6 does for EM predictions. Finally, column 7 compares the frequencies of KIR*IMP and the EM-reduced predictions. Haplotypes with a predicted frequency of 0 in both KIR*IMP and KPI are not shown. Haplotypes 14, 18, and 12 are in KIR*IMP’s set of reference haplotypes, but not KPI’s.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s4">
    <title>Discussion</title>
    <p>KPI was evaluated by Chen et al. as part of a larger effort (<xref rid="B18" ref-type="bibr">18</xref>). In a cohort of 72 individuals with ground truth determined by LinkSeq qPCR, Chen et al. report six mismatches in one sample (possibly swapped), and apart from this 95.8% accuracy for <italic>KIR2DS3</italic> and 100% accuracy for the 15 other genes. As they note, it is now possible to interpret HLA binding alleles and the presence/absence of all their KIR receptors from short-read high-throughput sequencing, and this combination is a valuable advancement for research and medicine. Indeed, they compare KPI favorably with respect to clinical accreditation standards.</p>
    <p>The findings by Chen et al. are consistent with the results of our synthetic test, whose accuracy was 100% for all genes. One drawback of the design of the synthetic test is that the haplotypes used in the test were also included in the MSA that was used to generate the per-gene probes. However, the main purposes of the synthetic tests were to test the application of the markers to short reads in a variety of genotypes and recover their original geno- and haplo-types; this is value-added compared with simply demonstrating sequences unique to a gene. The almost-perfect results of the Genentech and synthetic experiments, along with a GoNL results that had a 99.6% family-consistency rate and in line with expected frequencies, provide evidence that KPI’s gene predictions are very accurate.</p>
    <p>The evidence also suggests that KPI’s haplotype results are accurate, although often ambiguous: the accuracy in the synthetic test was 100% and the GoNL family-consistency was 99.6, and the predictions allow EM predictions that align with the expected population frequency from the literature.</p>
    <p>KIR*IMP’s haplotype frequency estimations differ from expectations in some areas. The evidence from comparisons with frequency reports from Jiang et al. 2012 (<xref rid="T5" ref-type="table"><bold>Table 5</bold></xref>, column 5) suggest KIR*IMP overestimated cA01~tA01 (haplotype numbers 1 and 2) and underreported haplotypes containing cB01 or cB02 centromeric regions combined with the tA01 telomeric region (cB01~tA01 and cB02~tA01) in the GoNL cohort. This discrepancy can also be seen in the predicted genotype frequencies, where KIR*IMP relatively under calls the presence of <italic>KIR2DS2</italic>, <italic>KIR2DL2</italic>, and <italic>KIR2DS3</italic> by ~20% and <italic>KIR2DL5</italic> by ~10% compared with KPI and the historical European frequencies from Allele Frequency Net database (<xref rid="T5" ref-type="table"><bold>Table 5</bold></xref>, column 6); all four of those genes are in cB01, and <italic>KIR2DS2</italic> and <italic>KIR2DL2</italic> are also in cB02. GoNL genotyping was done on the Immunochip, which is the best option according to the KIR*IMP manuscript. With that chip, they report accuracies of 100% for <italic>KIR2DS2</italic>, 98% for <italic>KIR2DL2</italic>, 82% for <italic>KIR2DL5</italic>, 81% for <italic>KIR2DS3</italic>, and 95% for <italic>KIR2DS5</italic> in their Norwegian-German validation cohort. Although the family consistency rate is 100% for KIR*IMP and 96.6% for KPI, their haplotype-pair predictions only agree in 58% of individuals. Without ground truth available, without any reason to expect this cohort to deviate from expectations, and considering KIR*IMP’s self-reported accuracy, the evidence suggests that KPI’s predictions are more accurate than KIR*IMP’s in this cohort and specifically that KIR*IMP under called the presence of genes <italic>KIR2DS2</italic>, <italic>KIR2DL2</italic>, <italic>KIR2DS3</italic>, <italic>KIR2DL5</italic> and haplotypes cB01~tA01 and cB02~tA01. As reviewed recently by Wright et al., this may be particularly relevant in the context of hematopoietic stem cell transplantation, where some case/control studies claim an important role for these regions (<xref rid="B19" ref-type="bibr">19</xref>). There are several potential reasons KIR*IMP’s predictions may be less accurate than KPI’s. The reference haplotypes used for marker discovery for KIR*IMP were defined by copy number genotyping and family relationships; KPI defined its haplotypes using a MSA of full haplotype sequences. KIR*IMP’s input is restricted to a few hundred single nucleotide polymorphisms, whereas KPI can use the entire genomic range of KIR sequences of length 25, which provides the potential for more information per marker and a broader base of markers. KIR*IMP uses a small number of SNPs to call one or more genes, whereas KPI uses dozens-to-thousands of 25mers to call a single gene, One of the steps of KIR*IMP’s workflow is to align and phase all the SNPs to one ‘A’ haplotype, which may be a limitation for genes not on that haplotype; all the gene and haplotypes we found to have lower accuracy rates are not located on the ‘A’ haplotype. KPI has no alignment or assembly steps. It is also important to note that the primary purpose for the comparison with KIR*IMP was not to evaluate the potential success of predicting KIR genes and haplotypes using SNPs vs sequence reads, but rather to compare the two algorithms. Although both algorithms predict the presence/absence of KIR genes and structural haplotypes, their solution domains are very different: microarray SNP panels vs raw genomic DNA reads. Both algorithms report the lowest accuracy rates for <italic>KIR2DS3</italic> and a ~10% lower frequency rate for <italic>KIR2DS1</italic> in GoNL compared with reference frequencies.</p>
    <p>The 85% family consistency rate of the EM-reduced haplotype predictions suggest that KIR haplotype ambiguity cannot be accurately reduced at the individual level <italic>via</italic> expectation-maximization. However, since the EM-reduced haplotype frequencies are in line with references, it is possible the predictions might aggregate to population-level in a maximum-likelihood manner and therefore perhaps may still be useful for some population genetics purposes.</p>
    <p>Traditional lab-based SSO presence/absence genotyping relies on a single short-sequence strategy, an approach that can be applied similarly to synthetic analysis of large amounts of WGS. In this virtual context, primer locations are not needed, and kmer searching is efficient and accurate at populations scales. To develop this synthetic SSO-like (kmer) library, we leveraged the information from a multiple sequence alignment of all full-length haplotypes that are available for this study. We believe this is a more accurate approach than using IPD-KIR reference alleles, because the IPD-KIR reference alleles do not require the haplotype location to be known. In addition, fusion alleles are assigned in IPD-KIR to one of the two parent genes, and therefore large sequences of some alleles are not really from the gene in which they are classified. We used 25 for our ‘k’ (i.e., sequence size) because BLAST searching indicated this to be a conservative minimum length needed to distinguish a small set of test markers to the KIR region. We did not experiment with any k size other than 25, since the choice gives a reasonable number of significant markers and their lack of off-KIR hits as tested in the GoNL population WGS confirms the effectiveness as gene/intergenic markers. The only fundamental benefit to shorter markers would be in the case when there were no longer markers; however, 25mer markers were found for every gene. The only fundamental benefit to longer markers would be if the markers were not unique to the region; however, all the markers are unique to their region. Many of the 25mers overlap each other, effectively simulating a single longer marker. Similar to the reasoning about probe length, probe mismatches would only need to be relaxed if a locus did not have any markers. Since at least one marker was discovered for each gene, mismatches did not need to be incorporated. Having thus obtained the region markers, we then used the most common (‘peak’) hit count from each gene/intergene’s library of sequences to make the PA genotype calls (<xref ref-type="supplementary-material" rid="SF1"><bold>Supplemental Figure 1</bold></xref>). This adds a certain amount of allelic flexibility in the algorithm because the ultimate call is an average of all the markers for that gene; if some markers miscall, the overall call for the gene will be unaffected if the majority of the other markers are accurate. Since KPI decomposes the genetic information into 25mers, it works with any collection of DNA reads, as long as the KIR region is included. It works with fasta, fastq, single, paired, short, and long reads. Since the markers are not unique to exons, it will not work with cDNA or exon only reads.</p>
    <p>One limitation of the method is that the markers do not mark DNA segments longer than one gene. Perhaps this is primarily due to the frequent recombination between haplotypes. Although recombination has been reported in multiple loci, the hotspot in between the centromeric and telomeric regions is particularly strong, and, in general, any pairing of the two can be expected. We evaluated single markers for haplotypes, but we did not find any. This is particularly relevant in light of the observation that haplotyping from genotypes seems to have limited accuracy under maximum likelihood assumptions (<xref rid="T5" ref-type="table"><bold>Table 5</bold></xref>). It is possible that an algorithm that uses applies multiple markers in a hierarchical or combinational manner may be more successful. For future work, we plan to further evaluate <italic>KIR2DS3</italic> (95.8% accuracy in the Chen et al. evaluation) and evaluate the genotyping in diverse populations. It is possible that population robustness is a weakness of the method, although the fact that almost half of individuals in the discovery cohort are African or African American provides some optimism.</p>
    <p>For the WGS data set, KPI averaged less than 1 h of computing time per individual, with 32 cores of CPU and 32G RAM. The majority of the time is spent using KMC 3 to build the kmer database. kmer counting is an active area of research. Since KPI can easily be altered to use any such application, it has potential for future efficiency improvements.</p>
    <p>The markers discovered in this study were enabled by a full-haplotype MSA, as described recently by Roe et al. (<xref rid="B11" ref-type="bibr">11</xref>). That manuscript makes observations about the composition and order of sequences within KIR haplotypes, and it reports the implications for our understanding of the relationship between haplotypes, loci, and genes. Here, we have leveraged that basic understanding for practical use by developing a free and open interpretation application, evaluating a SNP interpretation algorithm, and contributing KIR interpretation to an important population genetics resource for Netherlands and many types of human genetic researchers. We described how the gene markers were discovered from the MSA, and we demonstrated their use to predict genes and haplotype-pairs at high accuracy (97%+) with population scale from any kind of sequence data that includes the full KIR region, including WGS. It was tested on synthetic ground-truth sequences and a large cohort of family WGS. In addition, we compared our algorithm to the leading SNP-based interpretation algorithm. KPI is free software with a GPL3 license and is implemented as a Nextflow workflow backed with an optional Docker environment. It is available at <uri xlink:type="simple" xlink:href="https://github.com/droeatumn/kpi">https://github.com/droeatumn/kpi</uri>.</p>
  </sec>
  <sec id="s5">
    <title>Author’s Note</title>
    <p>This manuscript has been released as a pre-print at bioRxiv with the same title and authors (<xref rid="B20" ref-type="bibr">20</xref>).</p>
  </sec>
  <sec sec-type="data-availability" id="s6">
    <title>Data Availability Statement</title>
    <p>The datasets presented in this study can be found in online repositories. The names of the repository/repositories and accession number(s) can be found in the article/<xref ref-type="supplementary-material" rid="SM1"><bold>Supplementary Material</bold></xref>.</p>
  </sec>
  <sec id="s7">
    <title>Ethics Statement</title>
    <p>The studies involving human participants were reviewed and approved by University of Minnesota. Written informed consent for participation was not required for this study in accordance with the national legislation and the institutional requirements.</p>
  </sec>
  <sec id="s8">
    <title>Author Contributions</title>
    <p>DR and RK designed the experiments and wrote the manuscript. DR conducted the experiments. All authors contributed to the article and approved the submitted version.</p>
  </sec>
  <sec sec-type="COI-statement" id="s9">
    <title>Conflict of Interest</title>
    <p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>This study makes use of data generated by the Genome of the Netherlands Project. A full list of the investigators is available from <uri xlink:type="simple" xlink:href="http://www.nlgenome.nl">www.nlgenome.nl</uri>. Funding for the project was provided by the Netherlands Organization for Scientific Research under award number 184021007, dated July 9, 2009 and made available as a Rainbow Project of the Biobanking and Biomolecular Research Infrastructure Netherlands (BBMRI-NL). The sequencing was carried out in collaboration with the Beijing Institute for Genomics (BGI). The samples were provided by The LifeLines Cohort Study (<xref rid="B21" ref-type="bibr">21</xref>), and generation and management of GWAS genotype data for it, is supported by the Netherlands Organization of Scientific Research (NWO, grant 175.010.2007.006), the Dutch government’s Economic Structure Enhancing Fund (FES), the Ministry of Economic Affairs, the Ministry of Education, Culture and Science, the Ministry for Health, Welfare and Sports, the Northern Netherlands Collaboration of Provinces (SNN), the Province of Groningen, the University Medical Center Groningen, the University of Groningen, the Dutch Kidney Foundation and Dutch Diabetes Research Foundation.</p>
    <p>Thanks to Christian Hammer and his team from Genentech for assistance testing and debugging the application. Also, thanks to Cynthia Vierra-Green and Martin Maiers from the Center for International Blood and Marrow Transplant Research (CIMBTR) as well as Julia Udell from Mayo Clinic and the University of Minnesota for KIR consultation and consolation.</p>
  </ack>
  <sec id="s10" sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <p>The Supplementary Material for this article can be found online at: <ext-link ext-link-type="uri" xlink:href="https://www.frontiersin.org/articles/10.3389/fimmu.2020.583013/full#supplementary-material">https://www.frontiersin.org/articles/10.3389/fimmu.2020.583013/full#supplementary-material</ext-link>
</p>
    <supplementary-material content-type="local-data" id="SF1">
      <label>Supplemental Figure 1</label>
      <caption>
        <p>Algorithm details. Data sheet 3 is a Microsoft Word document containing the commands to query the markers per genome and details as to how each region was genotyped.</p>
      </caption>
      <media xlink:href="DataSheet_3.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SF2">
      <label>Supplemental Data Sheet 1</label>
      <caption>
        <p>Zipped text file containing the marker DNA sequences of length 25. The gene markers (column 2) are unique to their label (column 1), but the intergene and haplotype sequences are not.</p>
      </caption>
      <media xlink:href="DataSheet_1.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SF3">
      <label>Supplemental Data Sheet 2</label>
      <caption>
        <p>Raw reads from synthetic evaluation, whose results are in <xref rid="T2" ref-type="table"><bold>Table 2</bold></xref>. Each of the six simulated individuals have a pair of fastq files for each parental haplotype.</p>
      </caption>
      <media xlink:href="DataSheet_2.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SM1">
      <label>Supplemental Table 1</label>
      <caption>
        <p>Individual gene and haplotype-pair predictions. Columns A and B contain the family name and relationship. Column C contains KPI’s haplotype-pair predictions, represented by a haplotype list. Each pair is separated with a ‘|’. For example, ‘cA01~tA01+ cA01~tB01_2DS5|cA01~tB01_2DS5+cA01~tB05’ means the prediction is either haplotype-pairs cA01~tA01 and cA01~tB01_2DS5 or haplotype-pairs cA01~tB01_2DS5 and cA01~tB05. The haplotype list in column C represents all possible haplotype-pairs fitting the presence-absence genotypes. Column D is a count of the number of haplotype-pair predictions in column C’s haplotype list. Column E is the haplotype list in column C reduced by family relationships, and column F indicates whether or not it is different from the original haplotype list in column C. Column G is the original haplotype list in column C reduced by EM; its results should not be used as they have limited accuracy. Columns H-W are the gene presence-absence predictions.</p>
      </caption>
      <media xlink:href="Table_1.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martin</surname><given-names>AM</given-names></name><name><surname>Freitas</surname><given-names>EM</given-names></name><name><surname>Witt</surname><given-names>CS</given-names></name><name><surname>Christiansen</surname><given-names>FT</given-names></name></person-group><article-title>The genomic organization and evolution of the natural killer immunoglobulin-like receptor (KIR) gene cluster</article-title>. <source>Immunogenetics</source> (<year>2000</year>) <volume>51</volume>:<page-range>268–80</page-range>. <pub-id pub-id-type="doi">10.1007/s002510050620</pub-id>
</mixed-citation>
    </ref>
    <ref id="B2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martin</surname><given-names>AM</given-names></name><name><surname>Kulski</surname><given-names>JK</given-names></name><name><surname>Gaudieri</surname><given-names>S</given-names></name><name><surname>Witt</surname><given-names>CS</given-names></name><name><surname>Freitas</surname><given-names>EM</given-names></name><name><surname>Trowsdale</surname><given-names>J</given-names></name><etal/></person-group><article-title>Comparative genomic analysis, diversity and evolution of two KIR haplotypes A and B</article-title>. <source>Gene</source> (<year>2004</year>) <volume>335</volume>:<page-range>121–31</page-range>.  <pub-id pub-id-type="doi">10.1016/j.gene.2004.03.018</pub-id>
</mixed-citation>
    </ref>
    <ref id="B3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parham</surname><given-names>P</given-names></name><name><surname>Moffett</surname><given-names>A</given-names></name></person-group><article-title>Variable NK cell receptors and their MHC class I ligands in immunity, reproduction and human evolution</article-title>. <source>Nat Rev Immunol</source> (<year>2013</year>) <volume>13</volume>:<page-range>133–44</page-range>. <pub-id pub-id-type="doi">10.1038/nri3370</pub-id>
</mixed-citation>
    </ref>
    <ref id="B4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname><given-names>W</given-names></name><name><surname>Johnson</surname><given-names>C</given-names></name><name><surname>Jayaraman</surname><given-names>J</given-names></name><name><surname>Simecek</surname><given-names>N</given-names></name><name><surname>Noble</surname><given-names>J</given-names></name><name><surname>Moffatt</surname><given-names>MF</given-names></name><etal/></person-group><article-title>Copy number variation leads to considerable diversity for B but not A haplotypes of the human KIR genes encoding NK cell receptors</article-title>. <source>Genome Res</source> (<year>2012</year>) <volume>22</volume>:<page-range>1845–54</page-range>.  <pub-id pub-id-type="doi">10.1101/gr.137976.112</pub-id>
</mixed-citation>
    </ref>
    <ref id="B5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pyo</surname><given-names>C-W</given-names></name><name><surname>Guethlein</surname><given-names>LA</given-names></name><name><surname>Vu</surname><given-names>Q</given-names></name><name><surname>Wang</surname><given-names>R</given-names></name><name><surname>Abi-Rached</surname><given-names>L</given-names></name><name><surname>Norman</surname><given-names>PJ</given-names></name><etal/></person-group><article-title>Different Patterns of Evolution in the Centromeric and Telomeric Regions of Group A and B Haplotypes of the Human Killer Cell Ig-Like Receptor Locus</article-title>. <source>PloS One</source> (<year>2010</year>) <volume>5</volume>:<elocation-id>e15115</elocation-id>.  <pub-id pub-id-type="doi">10.1371/journal.pone.0015115</pub-id>
<pub-id pub-id-type="pmid">21206914</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Manser</surname><given-names>AR</given-names></name><name><surname>Weinhold</surname><given-names>S</given-names></name><name><surname>Uhrberg</surname><given-names>M</given-names></name></person-group><article-title>Human KIR repertoires: shaped by genetic diversity and evolution</article-title>. <source>Immunol Rev</source> (<year>2015</year>) <volume>267</volume>:<page-range>178–96</page-range>. <pub-id pub-id-type="doi">10.1111/imr.12316</pub-id>
</mixed-citation>
    </ref>
    <ref id="B7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roe</surname><given-names>D</given-names></name><name><surname>Vierra-Green</surname><given-names>C</given-names></name><name><surname>Pyo</surname><given-names>C-W</given-names></name><name><surname>Eng</surname><given-names>K</given-names></name><name><surname>Hall</surname><given-names>R</given-names></name><name><surname>Kuang</surname><given-names>R</given-names></name><etal/></person-group><article-title>Revealing complete complex KIR haplotypes phased by long-read sequencing technology</article-title>. <source>Genes Immun</source> (<year>2017</year>) <volume>18</volume>:<page-range>127–34</page-range>.  <pub-id pub-id-type="doi">10.1038/gene.2017.10</pub-id>
</mixed-citation>
    </ref>
    <ref id="B8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>J</given-names></name><name><surname>Halliwell</surname><given-names>JA</given-names></name><name><surname>Hayhurst</surname><given-names>JD</given-names></name><name><surname>Flicek</surname><given-names>P</given-names></name><name><surname>Parham</surname><given-names>P</given-names></name><name><surname>Marsh</surname><given-names>SGE</given-names></name></person-group><article-title>The IPD and IMGT/HLA database: allele variant databases</article-title>. <source>Nucleic Acids Res</source> (<year>2014</year>) <volume>43</volume>(D1):<page-range>D423–31</page-range>.  <pub-id pub-id-type="doi">10.1093/nar/gku1161</pub-id>
</mixed-citation>
    </ref>
    <ref id="B9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Uhrberg</surname><given-names>M</given-names></name><name><surname>Valiante</surname><given-names>NM</given-names></name><name><surname>Shum</surname><given-names>BP</given-names></name><name><surname>Shilling</surname><given-names>HG</given-names></name><name><surname>Lienert-Weidenbach</surname><given-names>K</given-names></name><name><surname>Corliss</surname><given-names>B</given-names></name><etal/></person-group><article-title>Human Diversity in Killer Cell Inhibitory Receptor Genes</article-title>. <source>Immunity</source> (<year>1997</year>) <volume>7</volume>:<page-range>753–63</page-range>.  <pub-id pub-id-type="doi">10.1016/S1074-7613(00)80394-5</pub-id>
</mixed-citation>
    </ref>
    <ref id="B10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vukcevic</surname><given-names>D</given-names></name><name><surname>Traherne</surname><given-names>JA</given-names></name><name><surname>Næss</surname><given-names>S</given-names></name><name><surname>Ellinghaus</surname><given-names>E</given-names></name><name><surname>Kamatani</surname><given-names>Y</given-names></name><name><surname>Dilthey</surname><given-names>A</given-names></name><etal/></person-group><article-title>Imputation of KIR Types from SNP Variation Data</article-title>. <source>Am J Hum Genet</source> (<year>2015</year>) <volume>97</volume>:<fpage>593</fpage>–<lpage>607</lpage>.  <pub-id pub-id-type="doi">10.1016/j.ajhg.2015.09.005</pub-id>
<pub-id pub-id-type="pmid">26430804</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roe</surname><given-names>D</given-names></name><name><surname>Vierra-Green</surname><given-names>C</given-names></name><name><surname>Pyo</surname><given-names>C-W</given-names></name><name><surname>Geraghty</surname><given-names>DE</given-names></name><name><surname>Spellman</surname><given-names>SR</given-names></name><name><surname>Maiers</surname><given-names>M</given-names></name><etal/></person-group><article-title>A Detailed View of KIR Haplotype Structures and Gene Families as Provided by a New Motif-based Multiple Sequence Alignment</article-title>. <source>Front Immunol</source> (<year>2020</year>).  <pub-id pub-id-type="doi">10.3389/fimmu.2020.585731</pub-id>
</mixed-citation>
    </ref>
    <ref id="B12">
      <label>12</label>
      <mixed-citation publication-type="webpage"><source>dwgsim</source>. Available at: <uri xlink:type="simple" xlink:href="https://github.com/nh13/dwgsim">https://github.com/nh13/dwgsim</uri>.</mixed-citation>
    </ref>
    <ref id="B13">
      <label>13</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boomsma</surname><given-names>DI</given-names></name><name><surname>Wijmenga</surname><given-names>C</given-names></name><name><surname>Slagboom</surname><given-names>EP</given-names></name><name><surname>Swertz</surname><given-names>MA</given-names></name><name><surname>Karssen</surname><given-names>LC</given-names></name><name><surname>Abdellaoui</surname><given-names>A</given-names></name><etal/></person-group><article-title>The Genome of the Netherlands: design, and project goals</article-title>. <source>Eur J Hum Genet</source> (<year>2014</year>) <volume>22</volume>:<page-range>221–7</page-range>.  <pub-id pub-id-type="doi">10.1038/ejhg.2013.118</pub-id>
</mixed-citation>
    </ref>
    <ref id="B14">
      <label>14</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vierra-Green</surname><given-names>C</given-names></name><name><surname>Roe</surname><given-names>D</given-names></name><name><surname>Jayaraman</surname><given-names>J</given-names></name><name><surname>Trowsdale</surname><given-names>J</given-names></name><name><surname>Traherne</surname><given-names>J</given-names></name><name><surname>Kuang</surname><given-names>R</given-names></name><etal/></person-group><article-title>Estimating KIR Haplotype Frequencies on a Cohort of 10,000 Individuals: A Comprehensive Study on Population Variations, Typing Resolutions, and Reference Haplotypes</article-title>. <source>PloS One</source> (<year>2016</year>) <volume>11</volume>:<elocation-id>e0163973</elocation-id>.  <pub-id pub-id-type="doi">10.1371/journal.pone.0163973</pub-id>
<pub-id pub-id-type="pmid">27723813</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <label>15</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Norman</surname><given-names>PJ</given-names></name><name><surname>Hollenbach</surname><given-names>JA</given-names></name><name><surname>Nemat-Gorgani</surname><given-names>N</given-names></name><name><surname>Marin</surname><given-names>WM</given-names></name><name><surname>Norberg</surname><given-names>SJ</given-names></name><name><surname>Ashouri</surname><given-names>E</given-names></name><etal/></person-group><article-title>Defining KIR and HLA Class I Genotypes at Highest Resolution via High-Throughput Sequencing</article-title>. <source>Am J Hum Genet</source> (<year>2016</year>) <volume>99</volume>:<page-range>375–91</page-range>.  <pub-id pub-id-type="doi">10.1016/j.ajhg.2016.06.023</pub-id>
</mixed-citation>
    </ref>
    <ref id="B16">
      <label>16</label>
      <mixed-citation publication-type="webpage"><source>PING Github issue 5</source>. Available at: <uri xlink:type="simple" xlink:href="https://github.com/Hollenbach-lab/PING/issues/5">https://github.com/Hollenbach-lab/PING/issues/5</uri>.</mixed-citation>
    </ref>
    <ref id="B17">
      <label>17</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>dos Santos</surname><given-names>EJM</given-names></name><name><surname>McCabe</surname><given-names>A</given-names></name><name><surname>Gonzalez-Galarza</surname><given-names>FF</given-names></name><name><surname>Jones</surname><given-names>AR</given-names></name><name><surname>Middleton</surname><given-names>D</given-names></name></person-group><article-title>Allele Frequencies Net Database: Improvements for storage of individual genotypes and analysis of existing data</article-title>. <source>Hum Immunol</source> (<year>2016</year>) <volume>77</volume>:<page-range>238–48</page-range>.  <pub-id pub-id-type="doi">10.1016/j.humimm.2015.11.013</pub-id>
</mixed-citation>
    </ref>
    <ref id="B18">
      <label>18</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Madireddi</surname><given-names>S</given-names></name><name><surname>Nagarkar</surname><given-names>D</given-names></name><name><surname>Migdal</surname><given-names>M</given-names></name><name><surname>Heiden</surname><given-names>JV</given-names></name><name><surname>Chang</surname><given-names>D</given-names></name><etal/></person-group><article-title><italic>In silico</italic> tools for accurate HLA and KIR inference from clinical sequencing data empower immunogenetics on individual-patient and population scales</article-title>. <source>Brief Bioinform</source> (<year>2020</year>) bbaa223.  <pub-id pub-id-type="doi">10.1093/bib/bbaa223</pub-id>
</mixed-citation>
    </ref>
    <ref id="B19">
      <label>19</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wright</surname><given-names>PA</given-names></name></person-group><article-title>Killer-cell immunoglobulin-like receptor assessment algorithms in haemopoietic progenitor cell transplantation: current perspectives and future opportunities</article-title>. <source>HLA</source> (<year>2020</year>) <volume>95(5)</volume>:<page-range>435–48</page-range>.  <pub-id pub-id-type="doi">10.1111/tan.13817</pub-id>
</mixed-citation>
    </ref>
    <ref id="B20">
      <label>20</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roe</surname><given-names>D</given-names></name><name><surname>Kuang</surname><given-names>R</given-names></name></person-group><article-title>Accurate and Efficient KIR Gene and Haplotype Inference from Genome Sequencing Reads with Novel K-mer Signatures</article-title>. <source>bioRxiv</source> (<year>2019</year>).  <pub-id pub-id-type="doi">10.1101/541938</pub-id>
</mixed-citation>
    </ref>
    <ref id="B21">
      <label>21</label>
      <mixed-citation publication-type="webpage"><source>Lifelines Biobank</source>. Available at: <uri xlink:type="simple" xlink:href="http://www.lifelines.nl">http://www.lifelines.nl</uri>.</mixed-citation>
    </ref>
  </ref-list>
</back>
