<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2621365</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-9-474</article-id>
    <article-id pub-id-type="pmid">19014431</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-9-474</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RNAalifold: improved consensus structure prediction for RNA alignments</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" corresp="yes" contrib-type="author">
        <name>
          <surname>Bernhart</surname>
          <given-names>Stephan H</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>berni@tbi.univie.ac.at</email>
      </contrib>
      <contrib id="A2" contrib-type="author">
        <name>
          <surname>Hofacker</surname>
          <given-names>Ivo L</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>ivo@tbi.univie.ac.at</email>
      </contrib>
      <contrib id="A3" contrib-type="author">
        <name>
          <surname>Will</surname>
          <given-names>Sebastian</given-names>
        </name>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>will@informatik.uni-freiburg.de</email>
      </contrib>
      <contrib id="A4" contrib-type="author">
        <name>
          <surname>Gruber</surname>
          <given-names>Andreas R</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>agruber@tbi.univie.ac.at</email>
      </contrib>
      <contrib id="A5" contrib-type="author">
        <name>
          <surname>Stadler</surname>
          <given-names>Peter F</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <xref ref-type="aff" rid="I4">4</xref>
        <xref ref-type="aff" rid="I5">5</xref>
        <email>studla@bioinf.uni-leipzig.de</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Bioinformatics Group, Department of Computer Science, and Interdisciplinary Center
                  for Bioinformatics, University of Leipzig, Härtelstrasse 16-18, D-04107
                  Leipzig, Germany</aff>
    <aff id="I2"><label>2</label>Institute for Theoretical Chemistry, University of Vienna,
                  Währingerstrasse 17, A-1090 Vienna, Austria</aff>
    <aff id="I3"><label>3</label>Bioinformatics Group, Department of Computer Science, University of Freiburg,
                  Georges-Köhler-Allee, Geb. 106, D-79110 Freiburg, Germany</aff>
    <aff id="I4"><label>4</label>RNomics Group, Fraunhofer Institut for Cell Therapy and Immunology (IZI)
                  Perlickstrasse 1, D-04103 Leipzig, Germany</aff>
    <aff id="I5"><label>5</label>The Santa Fe Institute, 1399 Hyde Park Rd., Santa Fe, New Mexico</aff>
    <pub-date pub-type="collection">
      <year>2008</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>11</day>
      <month>11</month>
      <year>2008</year>
    </pub-date>
    <volume>9</volume>
    <fpage>474</fpage>
    <lpage>474</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/9/474"/>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>8</month>
        <year>2008</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>11</month>
        <year>2008</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2008 Bernhart et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2008</copyright-year>
      <copyright-holder>Bernhart et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons
            Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which
            permits unrestricted use, distribution, and reproduction in any medium, provided the
            original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Bernhart
               H
               Stephan
               
               berni@tbi.univie.ac.at
            </dc:author><dc:title>
            RNAalifold: improved consensus structure prediction for RNA alignments
         </dc:title><dc:date>2008</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 9(1): 474-. (2008)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2008)9:1&#x0003c;474&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>The prediction of a consensus structure for a set of related RNAs is an important
                  first step for subsequent analyses. RNAalifold, which computes the minimum energy
                  structure that is simultaneously formed by a set of aligned sequences, is one of
                  the oldest and most widely used tools for this task. In recent years, several
                  alternative approaches have been advocated, pointing to several shortcomings of
                  the original RNAalifold approach.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We show that the accuracy of RNAalifold predictions can be improved substantially
                  by introducing a different, more rational handling of alignment gaps, and by
                  replacing the rather simplistic model of covariance scoring with more
                  sophisticated RIBOSUM-like scoring matrices. These improvements are achieved
                  without compromising the computational efficiency of the algorithm. We show here
                  that the new version of RNAalifold not only outperforms the old one, but also
                  several other tools recently developed, on different datasets.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>The new version of RNAalifold not only can replace the old one for almost any
                  application but it is also competitive with other approaches including those based
                  on SCFGs, maximum expected accuracy, or hierarchical nearest neighbor
               classifiers.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Unbiased surveys of the transcriptomes of higher eukaryotes by multiple techniques
            ranging from tiling arrays and short-read sequencing to large-scale sequencing of
            full-length cDNAs have dramatically changed our perception of genome organization: At
            least 90% of the mammalian genomes are transcribed, the vast majority of this
            transcription is non-protein-coding, and there is mounting evidence that a significant
            fraction of the non-coding transcripts are functional [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>]. The investigation of non-coding RNAs has thus developed into a focal topic
            in molecular biology and bioinformatics alike. Most of the ancient house-keeping RNAs
            (tRNAs, rRNAs, snRNAs, snoRNAs) and many of the newly discovered regulatory RNAs,
            including microRNA precursors, form evolutionarily well-conserved secondary structures,
            reviewed e.g. in [<xref ref-type="bibr" rid="B3">3</xref>]. These structures are tightly linked to the molecules' functions. It is
            therefore a core task in RNA bioinformatics to compute in particular the consensus
            structures of evolutionarily conserved RNAs.</p>
    <p>It has long been known that the accuracy of thermodynamic structure predictions for
            individual sequences is rather limited. On the other hand, computing the <italic>consensus
               structure </italic>common to several related RNA sequences can drastically improve the
            prediction [<xref ref-type="bibr" rid="B4">4</xref>]. The conceptually most elegant approach towards consensus structure
            prediction is to solve the alignment and the structure prediction problem
            simultaneously. The Sankoff algorithm [<xref ref-type="bibr" rid="B5">5</xref>] provides a solution that is practically applicable and has been implemented
            in various variants including dynalign [<xref ref-type="bibr" rid="B6">6</xref>], stemloc [<xref ref-type="bibr" rid="B7">7</xref>], foldalign [<xref ref-type="bibr" rid="B8">8</xref>], LocARNA [<xref ref-type="bibr" rid="B9">9</xref>] or consan [<xref ref-type="bibr" rid="B10">10</xref>]. Still, these approaches are computationally too expensive for large-scale
            routine applications. One basic alternative is to first compute structures for the
            individual sequences and then to align these sequences taking into account the
            structural information. This can be achieved in different ways using sequence-based
            (e.g. stral [<xref ref-type="bibr" rid="B11">11</xref>]), tree-based [<xref ref-type="bibr" rid="B12">12</xref>,<xref ref-type="bibr" rid="B13">13</xref>], or Sankoff-style alignment algorithms [<xref ref-type="bibr" rid="B14">14</xref>]. Alignment-free approaches include RNAspa [<xref ref-type="bibr" rid="B15">15</xref>] and consensus shapes [<xref ref-type="bibr" rid="B16">16</xref>].</p>
    <p>A large group of methods pre-supposes a (sequence) alignment. Most methods of this type
            use the alignment to super-impose predicted structures to global [<xref ref-type="bibr" rid="B17">17</xref>,<xref ref-type="bibr" rid="B18">18</xref>] or local structures [<xref ref-type="bibr" rid="B19">19</xref>]. RNAalifold [<xref ref-type="bibr" rid="B4">4</xref>], on the other hand, in essence averages the contributions of the standard
            Turner energy model [<xref ref-type="bibr" rid="B20">20</xref>] according to a given alignment <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-9-474-i1" overflow="scroll"><mml:semantics><mml:mi mathvariant="double-struck">A</mml:mi></mml:semantics></mml:math></inline-formula> and then solves the thermodynamic folding problem w.r.t. these
            averaged energies. A special case is the ConStruct package [<xref ref-type="bibr" rid="B21">21</xref>], which besides acting as a front-end for several prediction tools provides an
            interface for changing RNA alignments using expert knowledge.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Original RNAalifold</title>
      <p>The original RNAalifold approach combines a thermodynamic energy minimization [<xref ref-type="bibr" rid="B22">22</xref>] with a simple scoring model to assess evolutionary conservation. Both an
               energy minimization and a partition function version are implemented in the Vienna
               RNA package [<xref ref-type="bibr" rid="B4">4</xref>]. Energy minimization uses the following recursions:</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1471-2105-9-474-i2" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mtable columnalign="left">
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>F</mml:mi>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mo>=</mml:mo>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mi>min</mml:mi>
                        <mml:mo>⁡</mml:mo>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>F</mml:mi>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mo>+</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>,</mml:mo>
                                <mml:mi>j</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>,</mml:mo>
                            <mml:munder>
                              <mml:mrow>
                                <mml:mi>min</mml:mi>
                                <mml:mo>⁡</mml:mo>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mo>&lt;</mml:mo>
                                <mml:mi>k</mml:mi>
                                <mml:mo>≤</mml:mo>
                                <mml:mi>j</mml:mi>
                              </mml:mrow>
                            </mml:munder>
                            <mml:msub>
                              <mml:mi>C</mml:mi>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi>k</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>+</mml:mo>
                            <mml:msub>
                              <mml:mi>F</mml:mi>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                                <mml:mo>+</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>,</mml:mo>
                                <mml:mi>j</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>C</mml:mi>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mo>=</mml:mo>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mi>β</mml:mi>
                        <mml:mi>γ</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>j</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>+</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow/>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mo>+</mml:mo>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mi>min</mml:mi>
                        <mml:mo>⁡</mml:mo>
                        <mml:mrow>
                          <mml:mo>{</mml:mo>
                          <mml:mrow>
                            <mml:mtable columnalign="left">
                              <mml:mtr columnalign="left">
                                <mml:mtd columnalign="left">
                                  <mml:mrow>
                                    <mml:mstyle displaystyle="true">
                                      <mml:msub>
                                        <mml:mo>∑</mml:mo>
                                        <mml:mrow>
                                          <mml:mi>α</mml:mi>
                                          <mml:mo>∈</mml:mo>
                                          <mml:mi mathvariant="double-struck">A</mml:mi>
                                        </mml:mrow>
                                      </mml:msub>
                                      <mml:mrow>
                                        <mml:mi>ℌ</mml:mi>
                                        <mml:mo stretchy="false">(</mml:mo>
                                        <mml:mi>i</mml:mi>
                                        <mml:mo>,</mml:mo>
                                        <mml:mi>j</mml:mi>
                                        <mml:mo>,</mml:mo>
                                        <mml:mi>α</mml:mi>
                                        <mml:mo stretchy="false">)</mml:mo>
                                      </mml:mrow>
                                    </mml:mstyle>
                                  </mml:mrow>
                                </mml:mtd>
                              </mml:mtr>
                              <mml:mtr columnalign="left">
                                <mml:mtd columnalign="left">
                                  <mml:mrow>
                                    <mml:munder>
                                      <mml:mrow>
                                        <mml:mi>min</mml:mi>
                                        <mml:mo>⁡</mml:mo>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mi>i</mml:mi>
                                        <mml:mo>&lt;</mml:mo>
                                        <mml:mi>k</mml:mi>
                                        <mml:mo>&lt;</mml:mo>
                                        <mml:mi>l</mml:mi>
                                        <mml:mo>&lt;</mml:mo>
                                        <mml:mi>j</mml:mi>
                                      </mml:mrow>
                                    </mml:munder>
                                    <mml:mrow>
                                      <mml:mo>(</mml:mo>
                                      <mml:mrow>
                                        <mml:mstyle displaystyle="true">
                                          <mml:munder>
                                            <mml:mo>∑</mml:mo>
                                            <mml:mrow>
                                              <mml:mi>α</mml:mi>
                                              <mml:mo>∈</mml:mo>
                                              <mml:mi mathvariant="double-struck">A</mml:mi>
                                            </mml:mrow>
                                          </mml:munder>
                                          <mml:mrow>
                                            <mml:mi mathvariant="fraktur">J</mml:mi>
                                            <mml:mo stretchy="false">(</mml:mo>
                                            <mml:mi>i</mml:mi>
                                            <mml:mi>j</mml:mi>
                                            <mml:mo>,</mml:mo>
                                            <mml:mi>k</mml:mi>
                                            <mml:mi>l</mml:mi>
                                            <mml:mo>,</mml:mo>
                                            <mml:mi>α</mml:mi>
                                            <mml:mo stretchy="false">)</mml:mo>
                                            <mml:mo>+</mml:mo>
                                            <mml:msub>
                                              <mml:mi>C</mml:mi>
                                              <mml:mrow>
                                                <mml:mi>k</mml:mi>
                                                <mml:mo>,</mml:mo>
                                                <mml:mi>l</mml:mi>
                                              </mml:mrow>
                                            </mml:msub>
                                          </mml:mrow>
                                        </mml:mstyle>
                                      </mml:mrow>
                                      <mml:mo>)</mml:mo>
                                    </mml:mrow>
                                  </mml:mrow>
                                </mml:mtd>
                              </mml:mtr>
                              <mml:mtr columnalign="left">
                                <mml:mtd columnalign="left">
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mrow>
                                        <mml:mi>min</mml:mi>
                                        <mml:mo>⁡</mml:mo>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mi>i</mml:mi>
                                        <mml:mo>&lt;</mml:mo>
                                        <mml:mi>k</mml:mi>
                                        <mml:mo>&lt;</mml:mo>
                                        <mml:mi>j</mml:mi>
                                      </mml:mrow>
                                    </mml:msub>
                                    <mml:mrow>
                                      <mml:mo>(</mml:mo>
                                      <mml:mrow>
                                        <mml:msub>
                                          <mml:mi>M</mml:mi>
                                          <mml:mrow>
                                            <mml:mi>i</mml:mi>
                                            <mml:mo>,</mml:mo>
                                            <mml:mi>k</mml:mi>
                                          </mml:mrow>
                                        </mml:msub>
                                        <mml:mo>+</mml:mo>
                                        <mml:msubsup>
                                          <mml:mi>M</mml:mi>
                                          <mml:mrow>
                                            <mml:mi>k</mml:mi>
                                            <mml:mo>+</mml:mo>
                                            <mml:mn>1</mml:mn>
                                            <mml:mo>,</mml:mo>
                                            <mml:mi>j</mml:mi>
                                          </mml:mrow>
                                          <mml:mn>1</mml:mn>
                                        </mml:msubsup>
                                        <mml:mo>+</mml:mo>
                                        <mml:mi mathvariant="fraktur">a</mml:mi>
                                      </mml:mrow>
                                      <mml:mo>)</mml:mo>
                                    </mml:mrow>
                                  </mml:mrow>
                                </mml:mtd>
                              </mml:mtr>
                            </mml:mtable>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>M</mml:mi>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mo>=</mml:mo>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mi>min</mml:mi>
                        <mml:mo>⁡</mml:mo>
                        <mml:mrow>
                          <mml:mo>{</mml:mo>
                          <mml:mrow>
                            <mml:mtable columnalign="left">
                              <mml:mtr columnalign="left">
                                <mml:mtd columnalign="left">
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mi>M</mml:mi>
                                      <mml:mrow>
                                        <mml:mi>i</mml:mi>
                                        <mml:mo>+</mml:mo>
                                        <mml:mn>1</mml:mn>
                                        <mml:mo>,</mml:mo>
                                        <mml:mi>j</mml:mi>
                                      </mml:mrow>
                                    </mml:msub>
                                    <mml:mo>+</mml:mo>
                                    <mml:mi mathvariant="fraktur">c</mml:mi>
                                  </mml:mrow>
                                </mml:mtd>
                              </mml:mtr>
                              <mml:mtr columnalign="left">
                                <mml:mtd columnalign="left">
                                  <mml:mrow>
                                    <mml:munder>
                                      <mml:mrow>
                                        <mml:mi>min</mml:mi>
                                        <mml:mo>⁡</mml:mo>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mi>i</mml:mi>
                                        <mml:mo>&lt;</mml:mo>
                                        <mml:mi>k</mml:mi>
                                        <mml:mo>&lt;</mml:mo>
                                        <mml:mi>j</mml:mi>
                                      </mml:mrow>
                                    </mml:munder>
                                    <mml:msub>
                                      <mml:mi>C</mml:mi>
                                      <mml:mrow>
                                        <mml:mi>i</mml:mi>
                                        <mml:mo>,</mml:mo>
                                        <mml:mi>k</mml:mi>
                                      </mml:mrow>
                                    </mml:msub>
                                    <mml:mo>+</mml:mo>
                                    <mml:msub>
                                      <mml:mi>M</mml:mi>
                                      <mml:mrow>
                                        <mml:mi>k</mml:mi>
                                        <mml:mo>+</mml:mo>
                                        <mml:mn>1</mml:mn>
                                        <mml:mo>,</mml:mo>
                                        <mml:mi>j</mml:mi>
                                      </mml:mrow>
                                    </mml:msub>
                                    <mml:mo>+</mml:mo>
                                    <mml:mi mathvariant="fraktur">b</mml:mi>
                                  </mml:mrow>
                                </mml:mtd>
                              </mml:mtr>
                              <mml:mtr columnalign="left">
                                <mml:mtd columnalign="left">
                                  <mml:mrow>
                                    <mml:msubsup>
                                      <mml:mi>M</mml:mi>
                                      <mml:mrow>
                                        <mml:mi>i</mml:mi>
                                        <mml:mo>,</mml:mo>
                                        <mml:mi>j</mml:mi>
                                      </mml:mrow>
                                      <mml:mn>1</mml:mn>
                                    </mml:msubsup>
                                  </mml:mrow>
                                </mml:mtd>
                              </mml:mtr>
                            </mml:mtable>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mi>M</mml:mi>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                          <mml:mn>1</mml:mn>
                        </mml:msubsup>
                      </mml:mrow>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mo>=</mml:mo>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mi>min</mml:mi>
                        <mml:mo>⁡</mml:mo>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mi>M</mml:mi>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi>j</mml:mi>
                                <mml:mo>−</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mn>1</mml:mn>
                            </mml:msubsup>
                            <mml:mo>+</mml:mo>
                            <mml:mi mathvariant="fraktur">c</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:msub>
                              <mml:mi>C</mml:mi>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi>k</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>As in single-sequence folding, the arrays <italic>F</italic><sub><italic>ij</italic></sub>, <italic>C</italic><sub><italic>ij</italic></sub>, <italic>M</italic><sub><italic>ij</italic></sub>, and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1471-2105-9-474-i3" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> hold, for every sub-sequence from <italic>i </italic>to <italic>j</italic>, the
               energies of the optimal folds of unconstrained structures, of structures enclosed by
                  (<italic>i</italic>, <italic>j</italic>) base pairs, of multi-loop components, and of multi-loop
               components with a single branch, respectively [<xref ref-type="bibr" rid="B23">23</xref>]. The Turner energy parameters for hairpin loops delimited by <italic>alignment
               </italic>positions <italic>i </italic>and <italic>j </italic>in sequence <italic>α </italic>∈ <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="1471-2105-9-474-i1" overflow="scroll"><mml:semantics><mml:mi mathvariant="double-struck">A</mml:mi></mml:semantics></mml:math></inline-formula> are denoted by ℌ(<italic>i</italic>, <italic>j</italic>,
               <italic>α</italic>); similarly ℑ(<italic>ij</italic>, <italic>kl</italic>,
               <italic>α</italic>) encodes the energies of interior loops including stacked base
               pairs. Multi-loops are modeled by a linear model with a "closing" contribution <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" name="1471-2105-9-474-i4" overflow="scroll"><mml:semantics><mml:mi mathvariant="fraktur">a</mml:mi></mml:semantics></mml:math></inline-formula>, and contribution <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" name="1471-2105-9-474-i5" overflow="scroll"><mml:semantics><mml:mi mathvariant="fraktur">b</mml:mi></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" name="1471-2105-9-474-i6" overflow="scroll"><mml:semantics><mml:mi mathvariant="fraktur">c</mml:mi></mml:semantics></mml:math></inline-formula> for each branch and unpaired position, respectively. Note that
               these values are the tabulated single-sequence parameters multiplied by the number
                  <italic>N </italic>= |<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" name="1471-2105-9-474-i1" overflow="scroll"><mml:semantics><mml:mi mathvariant="double-struck">A</mml:mi></mml:semantics></mml:math></inline-formula>| of aligned sequences, since the recursion above computes the sum
               of the folding energies. RNAalifold modifies the energy model by introducing a (base
               pair) conservation score <italic>γ</italic>(<italic>i</italic>, <italic>j</italic>) that evaluates
               the corresponding alignment columns w.r.t. evidence for base pairing. In [<xref ref-type="bibr" rid="B4">4</xref>], we used</p>
      <p>
        <disp-formula id="bmcM1">
          <label>(1)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" name="1471-2105-9-474-i7" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msup>
                  <mml:mi>γ</mml:mi>
                  <mml:mo>′</mml:mo>
                </mml:msup>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>i</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>j</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mn>1</mml:mn>
                  <mml:mn>2</mml:mn>
                </mml:mfrac>
                <mml:mstyle displaystyle="true">
                  <mml:munder>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mtable>
                        <mml:mtr>
                          <mml:mtd>
                            <mml:mrow>
                              <mml:mi>α</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>β</mml:mi>
                              <mml:mo>∈</mml:mo>
                              <mml:mi mathvariant="double-struck">A</mml:mi>
                            </mml:mrow>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd>
                            <mml:mrow>
                              <mml:mi>α</mml:mi>
                              <mml:mo>≠</mml:mo>
                              <mml:mi>β</mml:mi>
                            </mml:mrow>
                          </mml:mtd>
                        </mml:mtr>
                      </mml:mtable>
                    </mml:mrow>
                  </mml:munder>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mo>{</mml:mo>
                      <mml:mrow>
                        <mml:mtable columnalign="left">
                          <mml:mtr columnalign="left">
                            <mml:mtd columnalign="left">
                              <mml:mrow>
                                <mml:mi>h</mml:mi>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:msub>
                                  <mml:mi>α</mml:mi>
                                  <mml:mi>i</mml:mi>
                                </mml:msub>
                                <mml:mo>,</mml:mo>
                                <mml:msub>
                                  <mml:mi>β</mml:mi>
                                  <mml:mi>i</mml:mi>
                                </mml:msub>
                                <mml:mo stretchy="false">)</mml:mo>
                                <mml:mo>+</mml:mo>
                                <mml:mi>h</mml:mi>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:msub>
                                  <mml:mi>α</mml:mi>
                                  <mml:mi>j</mml:mi>
                                </mml:msub>
                                <mml:mo>,</mml:mo>
                                <mml:msub>
                                  <mml:mi>β</mml:mi>
                                  <mml:mi>j</mml:mi>
                                </mml:msub>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:mtd>
                            <mml:mtd columnalign="left">
                              <mml:mrow>
                                <mml:mtext>if </mml:mtext>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:msub>
                                  <mml:mi>α</mml:mi>
                                  <mml:mi>i</mml:mi>
                                </mml:msub>
                                <mml:mo>,</mml:mo>
                                <mml:msub>
                                  <mml:mi>α</mml:mi>
                                  <mml:mi>j</mml:mi>
                                </mml:msub>
                                <mml:mo stretchy="false">)</mml:mo>
                                <mml:mo>∈</mml:mo>
                                <mml:mi>ℬ</mml:mi>
                              </mml:mrow>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr columnalign="left">
                            <mml:mtd columnalign="left">
                              <mml:mrow/>
                            </mml:mtd>
                            <mml:mtd columnalign="left">
                              <mml:mrow>
                                <mml:mo>∧</mml:mo>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:msub>
                                  <mml:mi>β</mml:mi>
                                  <mml:mi>i</mml:mi>
                                </mml:msub>
                                <mml:mo>,</mml:mo>
                                <mml:msub>
                                  <mml:mi>β</mml:mi>
                                  <mml:mi>j</mml:mi>
                                </mml:msub>
                                <mml:mo stretchy="false">)</mml:mo>
                                <mml:mo>∈</mml:mo>
                                <mml:mi>ℬ</mml:mi>
                              </mml:mrow>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr columnalign="left">
                            <mml:mtd columnalign="left">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="left">
                              <mml:mrow>
                                <mml:mtext>otherwise</mml:mtext>
                              </mml:mrow>
                            </mml:mtd>
                          </mml:mtr>
                        </mml:mtable>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mstyle>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where the Hamming distance <italic>h</italic>(<italic>a</italic>, <italic>b</italic>) = 0 if <italic>a </italic>=
                  <italic>b </italic>and <italic>h</italic>(<italic>a</italic>, <italic>b</italic>) = 1 if <italic>a </italic>≠
                  <italic>b </italic>and ℬ = {<italic>AU</italic>, <italic>UA</italic>, <italic>CG</italic>, <italic>GC</italic>, <italic>GU</italic>,
                  <italic>UG</italic>} is the set of possible base pairs. The full covariation score
                  <italic>γ </italic>also includes penalties for sequences in which the
               (<italic>i</italic>, <italic>j</italic>) base pair cannot be realized:</p>
      <p>
        <disp-formula id="bmcM2">
          <label>(2)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" name="1471-2105-9-474-i9" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mi>γ</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>i</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>j</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mi>γ</mml:mi>
                  <mml:mo>′</mml:mo>
                </mml:msup>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>i</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>j</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>+</mml:mo>
                <mml:mi>δ</mml:mi>
                <mml:mstyle displaystyle="true">
                  <mml:munder>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>α</mml:mi>
                      <mml:mo>∈</mml:mo>
                      <mml:mi mathvariant="double-struck">A</mml:mi>
                    </mml:mrow>
                  </mml:munder>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mo>{</mml:mo>
                      <mml:mrow>
                        <mml:mtable columnalign="left">
                          <mml:mtr columnalign="left">
                            <mml:mtd columnalign="left">
                              <mml:mrow>
                                <mml:mn>0</mml:mn>
                                <mml:mtext> if </mml:mtext>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:msub>
                                  <mml:mi>α</mml:mi>
                                  <mml:mi>i</mml:mi>
                                </mml:msub>
                                <mml:msub>
                                  <mml:mi>α</mml:mi>
                                  <mml:mi>j</mml:mi>
                                </mml:msub>
                                <mml:mo stretchy="false">)</mml:mo>
                                <mml:mo>∈</mml:mo>
                                <mml:mi>ℬ</mml:mi>
                              </mml:mrow>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr columnalign="left">
                            <mml:mtd columnalign="left">
                              <mml:mrow>
                                <mml:mn>0.25</mml:mn>
                                <mml:mtext> if </mml:mtext>
                                <mml:msub>
                                  <mml:mi>α</mml:mi>
                                  <mml:mi>i</mml:mi>
                                </mml:msub>
                                <mml:mo>∧</mml:mo>
                                <mml:msub>
                                  <mml:mi>α</mml:mi>
                                  <mml:mi>j</mml:mi>
                                </mml:msub>
                                <mml:mtext> are gaps</mml:mtext>
                              </mml:mrow>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr columnalign="left">
                            <mml:mtd columnalign="left">
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                                <mml:mtext> otherwise</mml:mtext>
                              </mml:mrow>
                            </mml:mtd>
                          </mml:mtr>
                        </mml:mtable>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mstyle>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>Potentially paired columns, in which less than a user-defined number or fraction of
               sequences can form the pair, are considered to be forbidden. RNAalifold therefore
               predicts the structure common to <italic>most </italic>of the sequences in an alignment. A
               prediction for a single molecule that is consistent with the consensus structure can
               be obtained by using the result of RNAalifold as a constraint for single molecule
               folding. Both mfold [<xref ref-type="bibr" rid="B22">22</xref>] and RNAfold [<xref ref-type="bibr" rid="B24">24</xref>] can be used for this purpose.</p>
      <p>The purpose of this contribution is to explore several avenues for improving the
               performance of RNAalifold. Intuitively, there are two leverage points: (1) the
               details of the energy evaluations in the presence of gaps, and (2) the rather <italic>ad
                  hoc </italic>covariance bonuses and penalties.</p>
    </sec>
    <sec>
      <title>Improved Energy Evaluation</title>
      <p>The 2002 implementation of RNAalifold uses a very simplistic way of treating gaps in
               order to save computational resources: gaps within unpaired regions are simply
               ignored, because then only alignment positions appear as indices and loop sizes, for
               instance, do not need to be evaluated separately for every sequence. This can,
               however, distort the energetics in particular if there are many gaps, and in extreme
               cases can lead to the inclusion of unrealistically short hairpins, see Figure <xref ref-type="fig" rid="F1">1</xref>. A second source of error is that gaps do not contribute to the
               dangling end energies in this setting.</p>
      <fig position="float" id="F1">
        <label>Figure 1</label>
        <caption>
          <p><bold>Possible results of treating gaps as bases.</bold> The consensus structure of
                     the alignment in the middle is predicted once with gaps treated as if they were
                     bases (old), and once by removing them before computing the energies (new). The
                     predicted structures (highlighted in red) are shown to the left. As can be seen
                     in <bold>1</bold>, sequence 1 can form a perfect hairpin. In <bold>2</bold>, the sterically
                     impossible hairpin for the other two sequences is shown. Two of the three
                     sequences cannot form the predicted structure. On the other hand, the new
                     version of RNAalifold predicts a stem that has a bulge (<bold>3</bold>), but only in
                     one sequence, the other two sequences can form the perfect stem shown in
                     <bold>4</bold>.</p>
        </caption>
        <graphic xlink:href="1471-2105-9-474-1"/>
      </fig>
      <p>The new implementation thus evaluates ℌ(<italic>i</italic>, <italic>j</italic>,
                  <italic>α</italic>) and ℑ(<italic>ij</italic>, <italic>kl</italic>,
               <italic>α</italic>) by first mapping the alignment indices back to the positions in
                  <italic>α</italic>. Then the correct energy parameters according to the Turner
               model are retrieved. In the same way, the handling of dangling ends is fixed. In
               practice, this is achieved by introducing three arrays of dimension <italic>N
               </italic>× <italic>n</italic>, where <italic>n </italic>is the length of the alignment of <italic>N
               </italic>sequences. For each sequence <italic>α </italic>and each alignment position,
               these arrays hold the 5' neighboring base, the 3' neighboring base, and the position
               in the original sequence. Since in typical applications we have <italic>N
               </italic>≪ <italic>n</italic>, this does not significantly change memory consumption.
               Still, the problem remains that in some sequences hairpin loops with less than three
               unpaired positions may arise. We penalize these sequences with a contribution of the
               same order of magnitude as that of non-canonical base pairs. From here on, we will
               refer to this "gap free" energy computation as the "new RNAalifold".</p>
      <sec>
        <title>Energy Parameters</title>
        <p>Instead of the usual Turner energy parameters, one may use other parametrizations.
                  Andronescu <italic>et al</italic>. [<xref ref-type="bibr" rid="B25">25</xref>] introduced energy parameters that increase the performance of single
                  stranded RNA folding, with striking results in particular on ribosomal RNAs. We
                  found, however, that they provide no significant over-all performance gain for
                  RNAalifold on the broad range of datasets we used to assess performance (see
                  section <italic>Performance Evaluation </italic>below). The results obtained for
                  Andronescu's energy parameters, together with those of other unsuccessful attempts
                  to increase performance, are tabulated in the additional file <xref ref-type="supplementary-material" rid="S1">1</xref>.</p>
      </sec>
      <sec>
        <title>Sequence Weighting</title>
        <p>In practice, many input alignments have a very unbalanced distribution of
                  sequences. Often most sequences are very closely related and outweigh one or a few
                  divergent ones. In this case it seems appropriate to down-weight the influence of
                  closely related sequences [<xref ref-type="bibr" rid="B26">26</xref>] similar to the weighted sum of pairs score frequently used for multiple
                  alignment. The problem with this approach is that distant sequences receive the
                  highest weights, but are also more likely to be misaligned, and hence a rational
                  weighting scheme will also increase the impact of alignment errors.</p>
        <p>One can try to minimize this effect by dividing the score of RNAalifold in two
                  parts, one which does not contain the outliers, thus scoring a smaller alignment,
                  and one which contains all sequences. If the smaller alignment scores
                  significantly better than the complete one, one can assume that the divergent
                  sequence is either misaligned or at least does not share the consensus structure.
                  At present, we have not been able to devise a fail-safe automatic procedure to
                  identify these cases. Since sequence weighting leads to a significant increase in
                  CPU time because the weighting has to be introduced in the inner-most loop of the
                  energy evaluation, we have decided against including the weighting option into the
                  public version of RNAalifold.</p>
      </sec>
    </sec>
    <sec>
      <title>Improving the Evaluation of Sequence-Covariation</title>
      <sec>
        <title>RIBOSUM Matrices</title>
        <p>The covariance term <italic>γ' </italic>of the old RNAalifold implementation is
                  based on qualitative arguments only. A more quantitatively sound approach is to
                  use scoring matrices akin to the RIBOSUM scheme [<xref ref-type="bibr" rid="B27">27</xref>]. As a training set, we selected 13,500 sequences in total from the
                  about 20,000 sequences in the SSU alignment of the European Ribosomal RNA Database [<xref ref-type="bibr" rid="B28">28</xref>], which are available in the DCSE file format. When reading in the DCSE
                  format, one needs to correctly assign helix numbers to concrete helices of the
                  sequences. In some cases, this assignment could not be done in an automated way.
                  Avoiding possible mis-assignments, such base pairs were ignored in the
                  computation. We also kept only sequences with less than 5% undetermined
                  nucleotides and at least 50% of the maximum possible number of base pairs. This
                  set was clustered using single linkage clustering to determine clusters where the
                  sequence identity between different clusters is ≤ <italic>P</italic>. For each
                  cutoff value <italic>P </italic>we determined the frequencies <italic>f</italic>(<italic>ac</italic>) of
                  nucleotides of type <italic>a </italic>and <italic>c </italic>being aligned and
                  <italic>f</italic>(<italic>ab</italic>; <italic>cd</italic>) of base pairs of type <italic>ab </italic>and <italic>cd
                  </italic>being aligned in sequences that are within different clusters. Besides being
                  more different than <italic>P</italic>, the sequences had to have at least a sequence
                  identity of <italic>Q</italic>. For each pair <italic>Q</italic>, <italic>P</italic>, we define the
                  modified RIBOSUM scores as the log-odds scores</p>
        <p>
          <disp-formula id="bmcM3"><label>(3)</label><italic>R</italic>(<italic>ab</italic>, <italic>cd</italic>) = log
                        (<italic>f</italic>(<italic>ab</italic>;
                        <italic>cd</italic>)/<italic>f</italic>(<italic>ac</italic>)<italic>f</italic>(<italic>bd</italic>))</disp-formula>
        </p>
        <p>In practice, we vary <italic>P </italic>and <italic>Q </italic>in steps of 5% sequence identity
                  and obtain altogether 99 matrices. Note that this procedure is somewhat different
                  from the approach reported in [<xref ref-type="bibr" rid="B27">27</xref>]. The frequencies can be determined either for all base pairs including
                  the non-canonical ones or restricted to the six types of canonical base pairs.
                  Only the latter version has proved useful in our context, and will be referred to
                  as RIBOSUM in the following.</p>
        <p>The covariance term is computed as</p>
        <p>
          <disp-formula id="bmcM4">
            <label>(4)</label>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" name="1471-2105-9-474-i10" overflow="scroll">
              <mml:semantics>
                <mml:mrow>
                  <mml:msup>
                    <mml:mi>γ</mml:mi>
                    <mml:mo>′</mml:mo>
                  </mml:msup>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>i</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>j</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mn>1</mml:mn>
                    <mml:mn>2</mml:mn>
                  </mml:mfrac>
                  <mml:mstyle displaystyle="true">
                    <mml:munder>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mtable>
                          <mml:mtr>
                            <mml:mtd>
                              <mml:mrow>
                                <mml:mi>α</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi>β</mml:mi>
                                <mml:mo>∈</mml:mo>
                                <mml:mi>A</mml:mi>
                              </mml:mrow>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd>
                              <mml:mrow>
                                <mml:mi>α</mml:mi>
                                <mml:mo>≠</mml:mo>
                                <mml:mi>β</mml:mi>
                              </mml:mrow>
                            </mml:mtd>
                          </mml:mtr>
                        </mml:mtable>
                      </mml:mrow>
                    </mml:munder>
                    <mml:mrow>
                      <mml:mi>x</mml:mi>
                      <mml:mi>R</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:msub>
                        <mml:mi>α</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:msub>
                        <mml:mi>α</mml:mi>
                        <mml:mi>j</mml:mi>
                      </mml:msub>
                      <mml:mo>;</mml:mo>
                      <mml:msub>
                        <mml:mi>β</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:msub>
                        <mml:mi>β</mml:mi>
                        <mml:mi>j</mml:mi>
                      </mml:msub>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:mstyle>
                  <mml:mo>,</mml:mo>
                </mml:mrow>
              </mml:semantics>
            </mml:math>
          </disp-formula>
        </p>
        <p>i.e., the RIBOSUM matrices replace the Hamming distances <italic>h</italic>(<italic>α</italic><sub><italic>i</italic></sub>, <italic>β</italic><sub><italic>i</italic></sub>) + <italic>h</italic>(<italic>α</italic><sub><italic>j</italic></sub>, <italic>β</italic><sub><italic>j</italic></sub>), and are scaled by a factor <italic>x </italic>so that the entries are in the same
                  range as the entries of the Hamming distance matrix. In order to determine which
                  matrix to use, we determine the minimum <italic>q </italic>and maximum <italic>p </italic>sequence
                  identity in the alignment and select the RIBOSUM matrix with smallest <italic>P
                  </italic>and <italic>Q </italic>so that <italic>p </italic>≤ <italic>P </italic>and <italic>q
                  </italic>≤ <italic>Q</italic>.</p>
        <p>RNAalifold uses two parameters to fine-tune the impact of the covariance score.
                  The first parameter, <italic>β</italic>, controls the influence of the covariance
                  score <italic>γ' </italic>relative to the total folding energy. The second one,
                     <italic>δ</italic>, weights the impact of non-standard pairs. The old default
                  value for both parameters is 1.</p>
        <p>Simply leaving them as they are would lead to a large change in the balance
                  between the thermodynamic and the covariance score. In the old RNAalifold program,
                  less than 10% of the total score is derived from the covariance score. If
                     <italic>β </italic>and <italic>δ </italic>were kept at 1, this fraction would
                  increase to more than 50%. This would presumably overemphasize covariance over
                  thermodynamics. To find appropriate values for <italic>β </italic>and
                     <italic>δ</italic>, we use <italic>k</italic>-fold cross validation, with <italic>k </italic>=
                  11 on the CMfinder-SARSE benchmark dataset described below.</p>
      </sec>
      <sec>
        <title>Pfold-like Scoring</title>
        <p>Inspired by the approach used in Pfold, we also tested a covariance scoring based
                  on an explicit phylogenetic model. More precisely, we used the log-odds ratio of
                  the probabilities of a base pair given a tree and the alignment, and the product
                  of the corresponding probabilities of unpaired bases given the same tree and
                  alignment [<xref ref-type="bibr" rid="B29">29</xref>]. A neighbor joining tree computed from the distances measured within
                  the alignment was used. The probabilities were then computed from this tree using
                  the Pfold rate matrices. This ansatz, however, did not result in more accurate
                  predictions. Therefore, it was not included into RNAalifold.</p>
      </sec>
    </sec>
    <sec>
      <title>Additional features</title>
      <p>In addition to increasing the performance, additional functionalities are included in
               the new RNAalifold software.</p>
      <sec>
        <title>Centroid structure</title>
        <p>The partition function computation now includes the computation of the
                     <italic>centroid structure</italic>, which is defined as the structure with minimal
                  mean base pair distance to all the structures of the ensemble:</p>
        <p>
          <disp-formula id="bmcM5">
            <label>(5)</label>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" name="1471-2105-9-474-i11" overflow="scroll">
              <mml:semantics>
                <mml:mrow>
                  <mml:mi>d</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>S</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mstyle displaystyle="true">
                    <mml:munder>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>j</mml:mi>
                        <mml:mo>∈</mml:mo>
                        <mml:mi>B</mml:mi>
                      </mml:mrow>
                    </mml:munder>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo>{</mml:mo>
                        <mml:mrow>
                          <mml:mtable columnalign="left">
                            <mml:mtr columnalign="left">
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>−</mml:mo>
                                  <mml:mo stretchy="false">(</mml:mo>
                                  <mml:mi>p</mml:mi>
                                  <mml:mo stretchy="false">(</mml:mo>
                                  <mml:mi>i</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>j</mml:mi>
                                  <mml:mo stretchy="false">)</mml:mo>
                                  <mml:mo stretchy="false">)</mml:mo>
                                </mml:mrow>
                              </mml:mtd>
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mtable>
                                    <mml:mtr>
                                      <mml:mtd>
                                        <mml:mrow>
                                          <mml:mtext>if</mml:mtext>
                                        </mml:mrow>
                                      </mml:mtd>
                                      <mml:mtd>
                                        <mml:mrow>
                                          <mml:mi>i</mml:mi>
                                          <mml:mo>,</mml:mo>
                                          <mml:mi>j</mml:mi>
                                          <mml:mo>∈</mml:mo>
                                          <mml:mi>B</mml:mi>
                                          <mml:mo stretchy="false">(</mml:mo>
                                          <mml:mi>S</mml:mi>
                                          <mml:mo stretchy="false">)</mml:mo>
                                        </mml:mrow>
                                      </mml:mtd>
                                    </mml:mtr>
                                  </mml:mtable>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                            <mml:mtr columnalign="left">
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mi>p</mml:mi>
                                  <mml:mo stretchy="false">(</mml:mo>
                                  <mml:mi>i</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>j</mml:mi>
                                  <mml:mo stretchy="false">)</mml:mo>
                                </mml:mrow>
                              </mml:mtd>
                              <mml:mtd columnalign="left">
                                <mml:mrow>
                                  <mml:mtext>else</mml:mtext>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                          </mml:mtable>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mstyle>
                </mml:mrow>
              </mml:semantics>
            </mml:math>
          </disp-formula>
        </p>
        <p>Here, <italic>d</italic>(<italic>S</italic>) is the distance of a structure to the ensemble, <italic>B
                  </italic>denotes the set of all possible base pairs in the ensemble,
                  <italic>B</italic>(<italic>S</italic>) is the set of all base pairs of structure <italic>S</italic>, and
                     <italic>p</italic>(<italic>i</italic>, <italic>j</italic>) is the probability of the base pair
                  <italic>i</italic>, <italic>j </italic>in the ensemble. It can easily be seen that the structure
                  with minimal <italic>d</italic>(<italic>S</italic>) is the structure that contains all base pairs
                  with a probability greater than 0.5. This centroid structure can be seen as the
                  single structure that best describes the ensemble [<xref ref-type="bibr" rid="B30">30</xref>]. The centroid structure usually contains less base pairs than the
                  minimum free energy structure, and is therefore less likely to contain false
                  positives.</p>
      </sec>
      <sec>
        <title>Stochastic Backtracking</title>
        <p>When trying to find out about statistical features of the structure ensemble other
                  than base pair probabilities, it is sometimes of interest to compute a sample of
                  suboptimal structures according to their Boltzmann weights. This can be achieved
                  efficiently using so-called stochastic backtracking. In this variation of the
                  standard backtracking scheme, one uses the matrices of the partition function
                  computation to determine the probability of base pairs or unpaired bases that are
                  included in the structure instead of choosing the alternative with the minimum
                  free energy at each step. The principle of stochastic backtracking in RNA folding
                  has been used already in [<xref ref-type="bibr" rid="B31">31</xref>] for the generation of uniformly distributed random structures. Later,
                  sfold [<xref ref-type="bibr" rid="B32">32</xref>] and the Vienna RNA Package [<xref ref-type="bibr" rid="B24">24</xref>] also implemented energy-weighted variants. These implementations differ
                  from the original algorithm only by the inclusion of the Boltzmann factors of the
                  loop energy contributions instead of treating all structural alternatives with
                  equal weight. The generalization of the stochastic backtracking algorithm to
                  consensus folds is straightforward. See additional file <xref ref-type="supplementary-material" rid="S2">2</xref> for a detailed description. Stochastic backtracking is now implemented
                  in the RNAalifold software.</p>
      </sec>
    </sec>
    <sec>
      <title>Performance Evaluation</title>
      <p>A trusted set of aligned sequences with corresponding structures is needed in order
               to evaluate the performance of consensus structure prediction tools. Most papers on
               this topic use some subset of the Rfam [<xref ref-type="bibr" rid="B33">33</xref>]. However, the structures and alignments contained in Rfam pose several
               problems. The database consists of a large number of snoRNAs (more than 30% of the
               alignments) and micro RNAs (about 7%). Furthermore, many of the Rfam entries contain
               short sequences that can only form simple one stem structures. A serious problem is
               the fact that many of the Rfam structures are predictions, some of which were created
               by the very programs that are to be tested. Not even all of the structures flagged as
               published within the database have been experimentally derived. Mostly because of
               this reasons, only 19 of the more than 600 Rfam families are contained in RNA STRAND [<xref ref-type="bibr" rid="B34">34</xref>], a recently created, curated database of high quality single RNA secondary
               structures.</p>
      <p>We therefore chose several different datasets for performance evaluation. In addition
               to the complete Rfam (version 8.1) seed alignments, we use here the CMfinder-SARSE
               subset compiled from [<xref ref-type="bibr" rid="B35">35</xref>,<xref ref-type="bibr" rid="B36">36</xref>], which contains 44 high quality seed alignments (also used in the recent
               PETfold paper [<xref ref-type="bibr" rid="B37">37</xref>]), the seeds of 19 Rfam families contained in RNA STRAND, and the dataset
               of KNetFold [<xref ref-type="bibr" rid="B38">38</xref>]. A list of these Rfam subsets can be found in the additional file <xref ref-type="supplementary-material" rid="S3">3</xref> or including links in the online supplement.</p>
      <p>The script refold.pl of the Vienna RNA package is used to remove gaps and
               non-standard base pairs from the RNAalifold predictions. The resulting structure is
               compared to the reference structure. For each alignment only the first sequence is
               used for performance evaluation to avoid a bias from the unequal sizes of the aligned
               sequence sets. As performance measure we use the Mathews correlation coefficient
               (MCC) as introduced in a previous benchmark [<xref ref-type="bibr" rid="B39">39</xref>]: Base pairs that are not part of the reference structure are counted as
               false positives only if they are inconsistent with the reference structure, while
               they are ignored if they can be added to the reference structure. Thus additional
               stems and elongated stems are not penalized. While this is a physically reasonable
               way to compute the MCC, the question of comparability might arise. To address this,
               we also used the more simple way of defining false positives as all base pairs
               predicted that were not part of the reference structure, and called it "other MCC".</p>
      <p>For the comparison procedure, we used the web-servers of Pfold [<xref ref-type="bibr" rid="B29">29</xref>] and KNetFold. In case the Rfam seed alignment contained more than 40
               sequences, only the first 40 were used; all-gap columns were removed from such
               alignments. The McCaskill-MEA software McC_mea [<xref ref-type="bibr" rid="B17">17</xref>] was installed locally. The predictions were also filtered with refold.pl
               before scoring.</p>
      <p>In order to evaluate the dependence on the alignment quality, we also realigned the
               Rfam alignments of the CMfinder-SARSE dataset using Clustal [<xref ref-type="bibr" rid="B40">40</xref>], and then proceeded as described above. Furthermore, we also computed the
               MCC for all Rfam seed alignments for those programs that can be run locally (i.e. the
               RNAalifold variants and McC_mea).</p>
      <p>The RNAalifold algorithm has been extensively used for the prediction of
               thermodynamically stable and/or evolutionary conserved RNAs [<xref ref-type="bibr" rid="B41">41</xref>-<xref ref-type="bibr" rid="B43">43</xref>]. The AlifoldZ program [<xref ref-type="bibr" rid="B41">41</xref>] evaluates stability and structural conservation at the same time simply by
               comparing the consensus free energy of an alignment to the consensus free energies of
               a large number of randomly shuffled alignments, relying entirely on RNAalifold. RNAz [<xref ref-type="bibr" rid="B42">42</xref>], on the other hand calculates two separate scores for stability and
               conservation. Structural conservation is assessed by means of the folding energy
               based structure conservation index (SCI). Here, the consensus energy is set in
               relation to the mean free energies of the single sequences. The lower bound of the
               SCI is zero, indicating that RNAalifold is not able to find a consensus structure,
               while a SCI close to one corresponds to perfect structure conservation. Here, we
               investigate whether the improved performance of RNAalifold in terms of correctness of
               the predicted structure can also improve the performance of ncRNA gene finders.</p>
      <p>In order to evaluate the performance of AlifoldZ and the SCI, we re-consider a
               sub-set of the test-set used in a previous benchmark [<xref ref-type="bibr" rid="B44">44</xref>]. As usual, we compute ROC curves to determine our ability to discriminate
               between truly conserved alignments and randomized controls. For simplicity, only the
               area under the ROC curve (AUC) is reported below as a measure of the discrimination
               power.</p>
    </sec>
  </sec>
  <sec>
    <title>Results and Discussion</title>
    <sec>
      <title>Predicting consensus structures</title>
      <p>We first compared the new implementation of RNAalifold with the 2002 version. As
               shown in Figure <xref ref-type="fig" rid="F2">2</xref>, the proper treatment of gaps in the new
               version leads to a consistently improved accuracy. The data also shows that the
               covariance contribution in the 2002 version was too large. Using RIBOSUM matrices
               instead of the naïve Hamming distance score substantially increases the
               beneficial effect of the covariance score. However, if the same parameters as in the
               original RNAalifold were used, the relative portion of the covariance term within the
               score would be greater than the thermodynamic score. We remark that for large values
               of <italic>β</italic>, where the covariance contributions dominate, the performance
               becomes much worse than for a purely thermodynamic energy computation (data not
               shown). As a new default, we therefore use <italic>β </italic>= 0.6 and
                  <italic>δ </italic>= 0.5. Still, the portion of the covariance term in the
               combined energy term is much higher (about 44%) in the RIBOSUM than in the other
               RNAalifold variants (about 7%). We want to remark that with the exception of very low
                  <italic>β</italic>, the performance of the RIBOSUM variant always exceeds the
               performance of the new variant without RIBOSUM, which in turn always performs better
               than the 2002 variant of RNAalifold (see Figures <xref ref-type="fig" rid="F2">2</xref> and <xref ref-type="fig" rid="F3">3</xref>).</p>
      <fig position="float" id="F2">
        <label>Figure 2</label>
        <caption>
          <p><bold>MCC on the CMfinder-SARSE dataset as a function of the <italic>β
                        </italic>and <italic>δ </italic>parameters.</bold> It can be seen that except for
                        <italic>β </italic>= 1.0, using RIBOSUM Matrices improves the performance
                     of the new RNAalifold, which is in turn always better than the 2002 (old)
                     variant. Furthermore, for the RIBOSUM variant, the size of the plateau, i.e.
                     the subset of parameters with a MCC ≥ 0.93 is quite big, containing
                     36 of 100 combinations of parameters (80 are ≥ 0.9, 21 are
                     ≥ 0.935 and 6 are 0.937). <bold>Top</bold>: 3d-plot of the MCC against the
                     parameters <italic>β </italic>and <italic>δ</italic>. <bold>Bottom</bold>: Vertical
                     section along the diagonals <italic>β </italic>= <italic>δ </italic>and
                        <italic>δ </italic>+ <italic>β </italic>= 1.1.</p>
        </caption>
        <graphic xlink:href="1471-2105-9-474-2"/>
      </fig>
      <fig position="float" id="F3">
        <label>Figure 3</label>
        <caption>
          <p><bold>Dependence of RNAalifold on the weights <italic>β </italic>and
                           <italic>δ</italic>.</bold><bold>A</bold>: For all three RNAalifold variants, the
                     accuracy of the structure prediction, measured here as MCC for the
                     CMfinder-SARSE dataset (Table 1), depends on the weight <italic>β </italic>of
                     the covariance term (<italic>δ </italic>= 0.6). <bold>B</bold>: The AUC value for
                     the SCI computation also depends strongly on the values of <italic>β
                     </italic>and <italic>δ</italic>. The green square indicates the optimal parameters
                        (<italic>β </italic>= 1.55, <italic>δ </italic>= 0.6), the red dot is the
                     default (1, 1). As the default is close to the maximum, there is little room
                     for improvement.</p>
        </caption>
        <graphic xlink:href="1471-2105-9-474-3"/>
      </fig>
      <p>Table <xref ref-type="table" rid="T1">1</xref> summarizes the comparison of the consensus structure
               predictions for five alignment-based programs on the CMfinder-SARSE dataset. The new
               RNAalifold with RIBOSUM matrices often yields perfect predictions and appears to have
               a good worst case performance: the smallest observed MCC is 0.64, and in this case
               the input alignment is clearly flawed, see additional file <xref ref-type="supplementary-material" rid="S4">4</xref>.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>Results on the CMfinder-SARSE dataset</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="left">RNA</td>
              <td align="left">#seq</td>
              <td align="left">MPI</td>
              <td align="center">RIBOSUM</td>
              <td align="center">RNAalifold</td>
              <td align="center">Pfold</td>
              <td align="center">KNetFold</td>
              <td align="center">McC_mea</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Antizyme_FSE</td>
              <td align="left">13</td>
              <td align="left">87</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">
                <bold>1.000</bold>
              </td>
            </tr>
            <tr>
              <td align="left">ctRNA_pGA1</td>
              <td align="left">15</td>
              <td align="left">72</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.976</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
            </tr>
            <tr>
              <td align="left">Entero_5_CRE</td>
              <td align="left">160</td>
              <td align="left">84</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.848</td>
              <td align="center">0.478</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.942</td>
            </tr>
            <tr>
              <td align="left">Entero_CRE</td>
              <td align="left">56</td>
              <td align="left">81</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.736</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.953</td>
              <td align="center">0.953</td>
            </tr>
            <tr>
              <td align="left">GcvB</td>
              <td align="left">17</td>
              <td align="left">64</td>
              <td align="center">
                <bold>0.939</bold>
              </td>
              <td align="center">0.799</td>
              <td align="center">0.889</td>
              <td align="center">
                <bold>0.939</bold>
              </td>
              <td align="center">0.921</td>
            </tr>
            <tr>
              <td align="left">glmS</td>
              <td align="left">11</td>
              <td align="left">60</td>
              <td align="center">
                <bold>0.986</bold>
              </td>
              <td align="center">0.972</td>
              <td align="center">0.972</td>
              <td align="center">0.809</td>
              <td align="center">0.837</td>
            </tr>
            <tr>
              <td align="left">HACA_sno_Snake</td>
              <td align="left">22</td>
              <td align="left">90</td>
              <td align="center">0.871</td>
              <td align="center">0.407</td>
              <td align="center">0.414</td>
              <td align="center">
                <bold>0.915</bold>
              </td>
              <td align="center">0.884</td>
            </tr>
            <tr>
              <td align="left">HCV_SLIV</td>
              <td align="left">110</td>
              <td align="left">89</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.922</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.961</td>
            </tr>
            <tr>
              <td align="left">HDV_ribozyme</td>
              <td align="left">15</td>
              <td align="left">95</td>
              <td align="center">
                <bold>0.953</bold>
              </td>
              <td align="center">-0.015</td>
              <td align="center">0.590</td>
              <td align="center">0.460</td>
              <td align="center">0.460</td>
            </tr>
            <tr>
              <td align="left">HepC_CRE</td>
              <td align="left">52</td>
              <td align="left">87</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.962</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">
                <bold>1.000</bold>
              </td>
            </tr>
            <tr>
              <td align="left">Histone3</td>
              <td align="left">64</td>
              <td align="left">78</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">
                <bold>1.000</bold>
              </td>
            </tr>
            <tr>
              <td align="left">Hsp90_CRE</td>
              <td align="left">4</td>
              <td align="left">98</td>
              <td align="center">0.855</td>
              <td align="center">0.855</td>
              <td align="center">0.413</td>
              <td align="center">0.867</td>
              <td align="center">
                <bold>0.874</bold>
              </td>
            </tr>
            <tr>
              <td align="left">IBV_D-RNA</td>
              <td align="left">10</td>
              <td align="left">96</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.928</td>
              <td align="center">0.928</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">
                <bold>1.000</bold>
              </td>
            </tr>
            <tr>
              <td align="left">Intron_gpII</td>
              <td align="left">114</td>
              <td align="left">54</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.779</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">
                <bold>1.000</bold>
              </td>
            </tr>
            <tr>
              <td align="left">IRE</td>
              <td align="left">39</td>
              <td align="left">63</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.938</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.938</td>
            </tr>
            <tr>
              <td align="left">let-7</td>
              <td align="left">14</td>
              <td align="left">73</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.979</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.957</td>
            </tr>
            <tr>
              <td align="left">lin-4</td>
              <td align="left">9</td>
              <td align="left">73</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.973</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">
                <bold>1.000</bold>
              </td>
            </tr>
            <tr>
              <td align="left">Lysine</td>
              <td align="left">43</td>
              <td align="left">49</td>
              <td align="center">
                <bold>0.990</bold>
              </td>
              <td align="center">0.918</td>
              <td align="center">0.960</td>
              <td align="center">
                <bold>0.990</bold>
              </td>
              <td align="center">
                <bold>0.990</bold>
              </td>
            </tr>
            <tr>
              <td align="left">mir-10</td>
              <td align="left">11</td>
              <td align="left">67</td>
              <td align="center">
                <bold>0.973</bold>
              </td>
              <td align="center">0.888</td>
              <td align="center">0.916</td>
              <td align="center">
                <bold>0.973</bold>
              </td>
              <td align="center">
                <bold>0.973</bold>
              </td>
            </tr>
            <tr>
              <td align="left">mir-194</td>
              <td align="left">4</td>
              <td align="left">79</td>
              <td align="center">0.870</td>
              <td align="center">0.849</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.866</td>
              <td align="center">0.698</td>
            </tr>
            <tr>
              <td align="left">mir-BART1</td>
              <td align="left">3</td>
              <td align="left">93</td>
              <td align="center">0.977</td>
              <td align="center">0.977</td>
              <td align="center">0.861</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.977</td>
            </tr>
            <tr>
              <td align="left">nos_TCE</td>
              <td align="left">3</td>
              <td align="left">90</td>
              <td align="center">0.975</td>
              <td align="center">0.975</td>
              <td align="center">0.951</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.975</td>
            </tr>
            <tr>
              <td align="left">Purine</td>
              <td align="left">22</td>
              <td align="left">56</td>
              <td align="center">0.945</td>
              <td align="center">0.917</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.945</td>
              <td align="center">0.945</td>
            </tr>
            <tr>
              <td align="left">Rhino_CRE</td>
              <td align="left">12</td>
              <td align="left">72</td>
              <td align="center">0.734</td>
              <td align="center">0.734</td>
              <td align="center">0.680</td>
              <td align="center">
                <bold>0.974</bold>
              </td>
              <td align="center">0.756</td>
            </tr>
            <tr>
              <td align="left">RNA-OUT</td>
              <td align="left">4</td>
              <td align="left">96</td>
              <td align="center">0.775</td>
              <td align="center">0.775</td>
              <td align="center">
                <bold>0.834</bold>
              </td>
              <td align="center">0.740</td>
              <td align="center">0.775</td>
            </tr>
            <tr>
              <td align="left">rncO</td>
              <td align="left">6</td>
              <td align="left">80</td>
              <td align="center">0.903</td>
              <td align="center">
                <bold>0.923</bold>
              </td>
              <td align="center">0.668</td>
              <td align="center">0.896</td>
              <td align="center">0.825</td>
            </tr>
            <tr>
              <td align="left">Rota_CRE</td>
              <td align="left">14</td>
              <td align="left">86</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.764</td>
              <td align="center">0.682</td>
              <td align="center">0.099</td>
              <td align="center">-0.011</td>
            </tr>
            <tr>
              <td align="left">s2m</td>
              <td align="left">38</td>
              <td align="left">79</td>
              <td align="center">0.739</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.774</td>
              <td align="center">0.652</td>
              <td align="center">0.861</td>
            </tr>
            <tr>
              <td align="left">SCARNA14</td>
              <td align="left">4</td>
              <td align="left">67</td>
              <td align="center">
                <bold>0.969</bold>
              </td>
              <td align="center">0.748</td>
              <td align="center">-0.005</td>
              <td align="center">0.532</td>
              <td align="center">0.777</td>
            </tr>
            <tr>
              <td align="left">SCARNA15</td>
              <td align="left">3</td>
              <td align="left">96</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.601</td>
              <td align="center">0.971</td>
              <td align="center">0.925</td>
            </tr>
            <tr>
              <td align="left">SECIS</td>
              <td align="left">63</td>
              <td align="left">43</td>
              <td align="center">0.941</td>
              <td align="center">0.813</td>
              <td align="center">0.943</td>
              <td align="center">
                <bold>0.971</bold>
              </td>
              <td align="center">0.813</td>
            </tr>
            <tr>
              <td align="left">SNORA14</td>
              <td align="left">3</td>
              <td align="left">92</td>
              <td align="center">0.944</td>
              <td align="center">0.944</td>
              <td align="center">0.853</td>
              <td align="center">
                <bold>0.959</bold>
              </td>
              <td align="center">0.869</td>
            </tr>
            <tr>
              <td align="left">SNORA18</td>
              <td align="left">6</td>
              <td align="left">79</td>
              <td align="center">0.913</td>
              <td align="center">0.503</td>
              <td align="center">0.702</td>
              <td align="center">
                <bold>0.971</bold>
              </td>
              <td align="center">0.893</td>
            </tr>
            <tr>
              <td align="left">SNORA38</td>
              <td align="left">5</td>
              <td align="left">84</td>
              <td align="center">0.759</td>
              <td align="center">0.743</td>
              <td align="center">
                <bold>0.858</bold>
              </td>
              <td align="center">0.410</td>
              <td align="center">0.734</td>
            </tr>
            <tr>
              <td align="left">SNORA40</td>
              <td align="left">7</td>
              <td align="left">80</td>
              <td align="center">
                <bold>0.962</bold>
              </td>
              <td align="center">
                <bold>0.962</bold>
              </td>
              <td align="center">0.704</td>
              <td align="center">0.948</td>
              <td align="center">0.920</td>
            </tr>
            <tr>
              <td align="left">SNORA56</td>
              <td align="left">4</td>
              <td align="left">97</td>
              <td align="center">0.816</td>
              <td align="center">
                <bold>0.922</bold>
              </td>
              <td align="center">0.446</td>
              <td align="center">0.779</td>
              <td align="center">0.741</td>
            </tr>
            <tr>
              <td align="left">SNORD105</td>
              <td align="left">2</td>
              <td align="left">89</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">-0.007</td>
              <td align="center">0.648</td>
              <td align="center">0.971</td>
            </tr>
            <tr>
              <td align="left">SNORD64</td>
              <td align="left">3</td>
              <td align="left">94</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.539</td>
              <td align="center">0.539</td>
              <td align="center">0.661</td>
              <td align="center">-0.014</td>
            </tr>
            <tr>
              <td align="left">SNORD86</td>
              <td align="left">6</td>
              <td align="left">82</td>
              <td align="center">
                <bold>0.641</bold>
              </td>
              <td align="center">-0.012</td>
              <td align="center">-0.007</td>
              <td align="center">0.511</td>
              <td align="center">0.000</td>
            </tr>
            <tr>
              <td align="left">snoU83B</td>
              <td align="left">4</td>
              <td align="left">87</td>
              <td align="center">
                <bold>0.927</bold>
              </td>
              <td align="center">
                <bold>0.927</bold>
              </td>
              <td align="center">0.846</td>
              <td align="center">0.895</td>
              <td align="center">
                <bold>0.927</bold>
              </td>
            </tr>
            <tr>
              <td align="left">TCV_H5</td>
              <td align="left">3</td>
              <td align="left">97</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.685</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">
                <bold>1.000</bold>
              </td>
            </tr>
            <tr>
              <td align="left">TCV_Pr</td>
              <td align="left">4</td>
              <td align="left">95</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.688</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">
                <bold>1.000</bold>
              </td>
            </tr>
            <tr>
              <td align="left">Tymo_tRNA-like</td>
              <td align="left">28</td>
              <td align="left">64</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.916</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.973</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
            </tr>
            <tr>
              <td align="left">ykoK</td>
              <td align="left">36</td>
              <td align="left">61</td>
              <td align="center">0.856</td>
              <td align="center">0.756</td>
              <td align="center">
                <bold>0.906</bold>
              </td>
              <td align="center">0.841</td>
              <td align="center">0.794</td>
            </tr>
            <tr>
              <td colspan="8">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">mean</td>
              <td/>
              <td/>
              <td align="center">
                <bold>0.937</bold>
              </td>
              <td align="center">0.831</td>
              <td align="center">0.765</td>
              <td align="center">0.866</td>
              <td align="center">0.837</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Performance comparisons on the CMfinder-SARSE dataset. We list the MCC for
                     different alignments. Best performance <bold>bold</bold>.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>In Table <xref ref-type="table" rid="T2">2</xref>, the performance of the same five programs on the
               RNA STRAND-Rfam dataset is shown. This curated dataset, in contrast to the other
               datasets we used, has many pseudo-knotted structures (6) and only 2 of the 19
               alignments have simple one-stem structures. In this regard, it is a good extension to
               our other datasets. While the total MCCs of all programs are lower, again the RIBOSUM
               variant of RNAalifold outperforms the other programs – however, on this
               dataset, the centroid structure computed using RIBOSUM RNAalifold has the best
               performance, with an MCC of 0.794. For this table, KNetFold was run using the "check
               pseudoknots" option. Still, it only correctly predicted a part of a single
               pseudo-knot.</p>
      <table-wrap position="float" id="T2">
        <label>Table 2</label>
        <caption>
          <p>Results on the RNA STRAND-Rfam dataset</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="left">RNA</td>
              <td align="left">comment</td>
              <td align="center">RIBOSUM</td>
              <td align="center">RNAalifold</td>
              <td align="center">Pfold</td>
              <td align="center">KNetFold</td>
              <td align="center">McC_mea</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">7SK</td>
              <td/>
              <td align="center">
                <bold>0.507</bold>
              </td>
              <td align="center">0.456</td>
              <td align="center">0.292</td>
              <td align="center">0.429</td>
              <td align="center">0.306</td>
            </tr>
            <tr>
              <td align="left">bicoid_3</td>
              <td/>
              <td align="center">
                <bold>0.949</bold>
              </td>
              <td align="center">0.840</td>
              <td align="center">n.a.</td>
              <td align="center">0.829</td>
              <td align="center">0.927</td>
            </tr>
            <tr>
              <td align="left">Corona_pk3</td>
              <td align="left">Pk</td>
              <td align="center">0.579</td>
              <td align="center">0.646</td>
              <td align="center">0.674</td>
              <td align="center">0.678</td>
              <td align="center">
                <bold>0.705</bold>
              </td>
            </tr>
            <tr>
              <td align="left">CPEB3_ribozyme</td>
              <td align="left">Pk</td>
              <td align="center">
                <bold>0.756</bold>
              </td>
              <td align="center">
                <bold>0.756</bold>
              </td>
              <td align="center">0.663</td>
              <td align="center">
                <bold>0.756</bold>
              </td>
              <td align="center">0.612</td>
            </tr>
            <tr>
              <td align="left">Gammaretro_CES</td>
              <td/>
              <td align="center">
                <bold>0.983</bold>
              </td>
              <td align="center">0.948</td>
              <td align="center">
                <bold>0.983</bold>
              </td>
              <td align="center">0.935</td>
              <td align="center">
                <bold>0.983</bold>
              </td>
            </tr>
            <tr>
              <td align="left">Hammerhead_1</td>
              <td/>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.474</td>
              <td align="center">0.621</td>
              <td align="center">0.831</td>
              <td align="center">0.614</td>
            </tr>
            <tr>
              <td align="left">Hammerhead_3</td>
              <td/>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.960</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">
                <bold>1.000</bold>
              </td>
            </tr>
            <tr>
              <td align="left">HDV_ribozyme</td>
              <td align="left">Pk</td>
              <td align="center">0.709</td>
              <td align="center">-0.018</td>
              <td align="center">
                <bold>0.784</bold>
              </td>
              <td align="center">0.388</td>
              <td align="center">0.396</td>
            </tr>
            <tr>
              <td align="left">IRES_c-myc</td>
              <td/>
              <td align="center">-0.004</td>
              <td align="center">0.079</td>
              <td align="center">0.286</td>
              <td align="center">-0.002</td>
              <td align="center">
                <bold>0.350</bold>
              </td>
            </tr>
            <tr>
              <td align="left">R2_retro_el</td>
              <td/>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.842</td>
              <td align="center">0.946</td>
              <td align="center">0.987</td>
              <td align="center">0.890</td>
            </tr>
            <tr>
              <td align="left">RNAIII</td>
              <td/>
              <td align="center">0.467</td>
              <td align="center">0.595</td>
              <td align="center">n.a.</td>
              <td align="center">0.479</td>
              <td align="center">
                <bold>0.830</bold>
              </td>
            </tr>
            <tr>
              <td align="left">RNase_MRP</td>
              <td align="left">Pk</td>
              <td align="center">
                <bold>0.626</bold>
              </td>
              <td align="center">0.423</td>
              <td align="center">0.457</td>
              <td align="center">0.271</td>
              <td align="center">0.575</td>
            </tr>
            <tr>
              <td align="left">rne5</td>
              <td/>
              <td align="center">
                <bold>0.994</bold>
              </td>
              <td align="center">0.969</td>
              <td align="center">0.975</td>
              <td align="center">0.762</td>
              <td align="center">0.923</td>
            </tr>
            <tr>
              <td align="left">RydC</td>
              <td align="left">Pk</td>
              <td align="center">0.466</td>
              <td align="center">0.562</td>
              <td align="center">
                <bold>0.608</bold>
              </td>
              <td align="center">0.466</td>
              <td align="center">-0.020</td>
            </tr>
            <tr>
              <td align="left">s2m</td>
              <td/>
              <td align="center">0.739</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.774</td>
              <td align="center">0.652</td>
              <td align="center">0.861</td>
            </tr>
            <tr>
              <td align="left">Telomerase-cil</td>
              <td/>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.937</td>
              <td align="center">0.921</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.953</td>
            </tr>
            <tr>
              <td align="left">Telomerase-vert</td>
              <td align="left">pk</td>
              <td align="center">
                <bold>0.918</bold>
              </td>
              <td align="center">0.751</td>
              <td align="center">n.a.</td>
              <td align="center">n.a.</td>
              <td align="center">0.820</td>
            </tr>
            <tr>
              <td align="left">Vimentin3</td>
              <td/>
              <td align="center">0.741</td>
              <td align="center">-0.016</td>
              <td align="center">0.184</td>
              <td align="center">
                <bold>0.771</bold>
              </td>
              <td align="center">0.629</td>
            </tr>
            <tr>
              <td align="left">Y</td>
              <td/>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">0.925</td>
              <td align="center">
                <bold>1.000</bold>
              </td>
              <td align="center">
                <bold>1.000</bold>
              </td>
            </tr>
            <tr>
              <td colspan="7">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">mean</td>
              <td/>
              <td align="center">0.759</td>
              <td align="center">0.651</td>
              <td/>
              <td/>
              <td align="center">0.703</td>
            </tr>
            <tr>
              <td align="left">mean</td>
              <td align="left">knetfold</td>
              <td align="center">0.750</td>
              <td align="center">0.645</td>
              <td/>
              <td align="center">0.680</td>
              <td align="center">0.696</td>
            </tr>
            <tr>
              <td align="left">mean</td>
              <td align="left">pfold</td>
              <td align="center">0.756</td>
              <td align="center">0.635</td>
              <td align="center">0.693</td>
              <td align="center">0.682</td>
              <td align="center">0.673</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Performance comparisons on the RNA STRAND-Rfam dataset. We list the MCC for
                     different alignments. Best performance indicated in <bold>bold</bold>, n.a. means
                     that data is not available due to length restrictions on the respective server,
                     pk denotes structures that contain a pseudo-knot. As there are many
                     pseudo-knotted structures in this dataset, KNetFold was used in the "Check
                     pseudoknot" mode. The MCCs take into account the pseudo-knots.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>We also used the Rfam subset that was used to evaluate the performance of KNetFold [<xref ref-type="bibr" rid="B38">38</xref>]. However, we did not use the same procedure to prune alignments down to a
               maximum of 40 sequences. Therefore, the MCCs reported here cannot directly be
               compared to the ones in [<xref ref-type="bibr" rid="B38">38</xref>]. The MCC we achieve with the RIBOSUM variant of RNAalifold is 0.818. This
               is again a significant improvement over the MCC of 0.604 achieved by the 2002
               variant.</p>
      <p>When considering an almost complete set of about 570 Rfam alignments (a few
               alignments that for various reasons are problematic were removed), the mean MCC of
               RNAalifold 2002 is 0.729, the new RNAalifold with RIBOSUM matrices achieves a mean
               MCC of 0.790, while McC_mea achieves 0.742.</p>
      <p>In Table <xref ref-type="table" rid="T3">3</xref>, the performance of the new RNAalifold variants
               using the "other MCC" variant and the results when using Clustal realigned sequences
               are shown.</p>
      <table-wrap position="float" id="T3">
        <label>Table 3</label>
        <caption>
          <p>Results using alternative MCC and alignment</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="left">Program or variant</td>
              <td align="left">MCC</td>
              <td align="center">Other MCC</td>
              <td align="center">Clustal MCC</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">RNAalifold 2002</td>
              <td align="left">0.831</td>
              <td align="center">0.814</td>
              <td align="center">0.708</td>
            </tr>
            <tr>
              <td align="left">RNAalifold new</td>
              <td align="left">0.845</td>
              <td align="center">0.819</td>
              <td align="center">0.711</td>
            </tr>
            <tr>
              <td align="left">RNAalifold RIBOSUM</td>
              <td align="left">
                <bold>0.937</bold>
              </td>
              <td align="center">0.871</td>
              <td align="center">
                <bold>0.788</bold>
              </td>
            </tr>
            <tr>
              <td align="left">RNAalifold 2002 centroid</td>
              <td align="left">0.828</td>
              <td align="center">0.815</td>
              <td align="center">0.693</td>
            </tr>
            <tr>
              <td align="left">RNAalifold new centroid</td>
              <td align="left">0.848</td>
              <td align="center">0.834</td>
              <td align="center">0.712</td>
            </tr>
            <tr>
              <td align="left">RNAalifold RIBOSUM centroid</td>
              <td align="left">0.934</td>
              <td align="center">
                <bold>0.896</bold>
              </td>
              <td align="center">0.780</td>
            </tr>
            <tr>
              <td align="left">Pfold</td>
              <td align="left">0.765</td>
              <td align="center">0.739</td>
              <td align="center">0.601</td>
            </tr>
            <tr>
              <td align="left">KNetFold</td>
              <td align="left">0.866</td>
              <td align="center">0.808</td>
              <td align="center">0.761</td>
            </tr>
            <tr>
              <td align="left">McC_mea</td>
              <td align="left">0.837</td>
              <td align="center">0.816</td>
              <td align="center">0.716</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Performance comparisons on the CMfinder-SARSE dataset. We list the mean MCC for
                     different programs. Best performance indicated in <bold>bold</bold>. Other MCC is the
                     variant counting every wrongly predicted pair as false positive, Clustal MCC is
                     the MCC as introduced by Gardner <italic>et al</italic>. [<xref ref-type="bibr" rid="B39">39</xref>] applied to alignments realigned using Clustal [<xref ref-type="bibr" rid="B40">40</xref>].</p>
        </table-wrap-foot>
      </table-wrap>
      <sec>
        <title>Effects on predicted structures</title>
        <p>Over all, there are two main reasons why prediction using the RIBOSUM variant of
                  RNAalifold will give better predictions than the 2002 variant. By treating gaps as
                  if they were bases, the 2002 implementation sometimes assigns much too unfavorable
                  energies to loops containing gaps in a small number of sequences. As a
                  consequence, these loops cannot be part of the consensus structure. Examples for
                  this effect are <italic>GcvB</italic>, where an interrupting bulge loop in the consensus
                  structure actually exists in only one sequence, or the Hammerhead ribozyme, where
                  a large insertion within a hairpin loop is present in about a third of the
                  sequences.</p>
        <p>The beneficial effect of using the RIBOSUM matrices is mostly due to the
                  possibility to assign covariance boni to certain base pairs even if not much (or
                  even no) covariation actually occurred. This makes it possible to compensate for a
                  few contradicting base pairs, whether they are due to alignment errors or to a
                  slightly different structure for some sequences. Predictions that benefit from
                  that effect are e.g. the Enterovirus 5' cloverleaf, the Snake H/ACA box small
                  nucleolar RNA or the UnaL2 LINE 3' element. A mixture of both effects is seen in
                  the R2 RNA element as well as in the Hammerhead ribozyme. The detailed results for
                  these molecules can be seen in the additional files <xref ref-type="supplementary-material" rid="S5">5</xref>,
                     <xref ref-type="supplementary-material" rid="S6">6</xref>, <xref ref-type="supplementary-material" rid="S7">7</xref>, <xref ref-type="supplementary-material" rid="S8">8</xref>, <xref ref-type="supplementary-material" rid="S9">9</xref> and <xref ref-type="supplementary-material" rid="S10">10</xref> or in
                  the online supplement.</p>
      </sec>
    </sec>
    <sec>
      <title>Detection of ncRNAs</title>
      <p>AlifoldZ detects structural non-coding RNAs by comparing the energy of the native
               alignment to the energies of a population of randomized control alignments via a
                  <italic>z</italic>-score. Here, the better predictive power of the new RIBOSUM approach
               directly translates into increased ability to distinguish evolutionary conserved RNAs
               from randomized controls. The RIBOSUM approach achieves an AUC of 0.969 compared to
               0.954 for both the 2002 implementation and the new RNAalifold. The performance boost
               comes mainly from additional bonus energies derived from covariance scoring. In the
               RIBOSUM approach these energies have a much higher contribution than in the
               conventional model thereby favoring true conservation patterns by giving a lower
               total free energy and hence a lower <italic>z</italic>-score. This beneficial effect is not
               observed in the case of the SCI, where the RIBOSUM covariance energies even result in
               a performance drop (AUC 0.767) compared to the other two implementations (new: 0.917,
               2002: 0.916). The SCI is a conservation measure that compares the consensus free
               energy to the mean free energy of the single sequences. The covariance energies are
               important for the high discrimination capability of the SCI, but with the RIBOSUM
               scoring model the over-emphasis of the covariance energy contributions blurs the
               signal for true conservation. If we neglect the covariance score for the computation
               of the SCI, the effect is much smaller (AUC 0.907). We expect, however, that the
               RIBOSUM approach will perform well on purely structure-based similarity or distance
               measures.</p>
    </sec>
    <sec>
      <title>Computational requirements</title>
      <p>Theoretically, the new and the old RNAalifold variants have the same space (<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13" name="1471-2105-9-474-i12" overflow="scroll"><mml:semantics><mml:mi mathvariant="script">O</mml:mi></mml:semantics></mml:math></inline-formula>(<italic>n</italic><sup>2</sup>)) and time (<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14" name="1471-2105-9-474-i12" overflow="scroll"><mml:semantics><mml:mi mathvariant="script">O</mml:mi></mml:semantics></mml:math></inline-formula>(<italic>Nn</italic><sup>3</sup>)) complexity, with <italic>N </italic>sequences in
               an alignment of length <italic>n</italic>. However, neglecting possible base pairs with a
               conservation score below a certain cutoff (e.g. if more than 50% of the sequences
               cannot form a base pair) dramatically reduces computation time without affecting the
               results. As an example, folding a subset of five randomly chosen sequences of a
               ribosomal SSU alignment (length 1716 nt) takes an average of about 42.2 seconds,
               while using 10 sequences of the same alignment takes about 3.8 seconds on an Intel
               Xeon 2.8 GHz processor (Figure <xref ref-type="fig" rid="F4">4</xref>). The RIBOSUM matrices make it
               much harder to exclude base pairs from the outset. Thus, the RIBOSUM variant is by
               far the slowest option on alignments with many rather diverse sequences.</p>
      <fig position="float" id="F4">
        <label>Figure 4</label>
        <caption>
          <p><bold>Time series for the old, new and RIBOSUM RNAalifold variants.</bold><bold>A</bold>:
                     Folding different alignments with 4 sequences and different lengths. <bold>B</bold>:
                     Folding a different number of random sequences from the same alignment (1716
                     nt).</p>
        </caption>
        <graphic xlink:href="1471-2105-9-474-4"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>We have shown here that the performance of RNAalifold can be improved to be competitive
            with all recently published alignment-based consensus structure prediction tools. This
            improvement is reached by a more accurate treatment of gaps and an elaborate model for
            the evaluation of sequence covariations that resembles the RIBOSUM matrices. The gain in
            performance is achieved at negligible extra computational cost and without dramatic
            changes to the implementation. While a sequence weighting scheme apparently can yield
            further improvements on good alignments, this makes the procedure less resilient towards
            mis-alignments. It seems, therefore, that the approach is essentially limited by the
            quality of the input alignments.</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>SHB designed and implemented the new version of RNAalifold, ILH and PFS initiated the
            study and contributed to the theory, SW derived and calculated the RIBOSUM-like scores,
            ARG evaluated the performance for structured RNA detection. All authors closely
            collaborated in writing the manuscript.</p>
  </sec>
  <sec>
    <title>Availability and requirements</title>
    <p>RNAalifold is part of the ViennaRNA software package, the new version can be downloaded
            for Linux as a tar archive at: <ext-link ext-link-type="uri" xlink:href="http://www.tbi.univie.ac.at/~ivo/RNA/"/>.</p>
    <p>The electronic supplement of this paper can be found at
               <ext-link ext-link-type="uri" xlink:href="http://www.bioinf.uni-leipzig.de/Publications/SUPPLEMENTS/08-010/"/></p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p><bold>Additional results. </bold>Results of various unsuccessful approaches to
                        increase the accuracy of RNAalifold.</p>
      </caption>
      <media xlink:href="1471-2105-9-474-S1.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional file 2</title>
        <p><bold>Stochastic backtracking.</bold> Detailed description of stochastic
                        backtracking algorithm for consensus structure prediction using
                     RNAalifold.</p>
      </caption>
      <media xlink:href="1471-2105-9-474-S2.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S3">
      <caption>
        <title>Additional file 3</title>
        <p><bold>Datasets.</bold> List of the datasets used for evaluating performance.</p>
      </caption>
      <media xlink:href="1471-2105-9-474-S3.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S4">
      <caption>
        <title>Additional file 4</title>
        <p><bold>Alignment and structure of SNORD86.</bold> The Rfam alignment and reference
                     structure of SNORD86 together with the energies of the structure on the single
                     molecules.</p>
      </caption>
      <media xlink:href="1471-2105-9-474-S4.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S5">
      <caption>
        <title>Additional file 5</title>
        <p><bold>Enterovirus 5' cloverleaf structure.</bold> Analysis of the effects leading
                        to better prediction of the Enterovirus 5' cloverleaf structure.</p>
      </caption>
      <media xlink:href="1471-2105-9-474-S5.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S6">
      <caption>
        <title>Additional file 6</title>
        <p><bold>GcvB structure</bold>. Analysis of the effects leading to better prediction
                        of the GcvB structure.</p>
      </caption>
      <media xlink:href="1471-2105-9-474-S6.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S7">
      <caption>
        <title>Additional file 7</title>
        <p><bold>Snake H/ACA snoRNA structure.</bold> Analysis of the effects leading to
                        better prediction of the Snake H/ACA snoRNA structure.</p>
      </caption>
      <media xlink:href="1471-2105-9-474-S7.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S8">
      <caption>
        <title>Additional file 8</title>
        <p><bold>Hammerhead Rybozyme structure.</bold> Analysis of the effects leading to
                        better prediction of the Hammerhead Rybozyme structure.</p>
      </caption>
      <media xlink:href="1471-2105-9-474-S8.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S9">
      <caption>
        <title>Additional file 9</title>
        <p><bold>R2 RNA element structure.</bold> Analysis of the effects leading to better
                        prediction of the R2 RNA element structure.</p>
      </caption>
      <media xlink:href="1471-2105-9-474-S9.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S10">
      <caption>
        <title>Additional file 10</title>
        <p><bold>UnaL2 LINE 3' element structure.</bold> Analysis of the effects leading to
                        better prediction of the UnaL2 LINE 3' element structure.</p>
      </caption>
      <media xlink:href="1471-2105-9-474-S10.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>This work was supported in part by the European Union as part of the FP-6 <italic>EMBIO
               </italic>project as well as by the Austrian GEN-AU project "Bioinformatics Integration
               Network" and Deutsche Forschungsgemeinschaft as part of SPP-1258 "Sensory and
               Regulatory RNAs in Prokaryotes".</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <collab>The ENCODE Project Consortium</collab>
        </person-group>
        <article-title>Identification and analysis of functional elements in 1% of the human genome by
                  the ENCODE pilot project</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>447</volume>
        <fpage>799</fpage>
        <lpage>816</lpage>
        <pub-id pub-id-type="pmid">17571346</pub-id>
        <pub-id pub-id-type="doi">10.1038/nature05874</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <collab>The FANTOM Consortium</collab>
        </person-group>
        <article-title>The Transcriptional Landscape of the Mammalian Genome</article-title>
        <source>Science</source>
        <year>2005</year>
        <volume>309</volume>
        <fpage>1159</fpage>
        <lpage>1563</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1112014</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <collab>The Athanasius F Bompfünewerer RNA Consortium</collab>
        </person-group>
        <article-title>RNAs Everywhere: Genome-Wide Annotation of Structured RNAs</article-title>
        <source>J Exp Zool B Mol Dev Evol</source>
        <year>2007</year>
        <volume>308B</volume>
        <fpage>1</fpage>
        <lpage>25</lpage>
        <pub-id pub-id-type="doi">10.1002/jez.b.21130</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
          <name>
            <surname>Fekete</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
        </person-group>
        <article-title>Secondary Structure Prediction for Aligned RNA Sequences</article-title>
        <source>J Mol Biol</source>
        <year>2002</year>
        <volume>319</volume>
        <fpage>1059</fpage>
        <lpage>1066</lpage>
        <pub-id pub-id-type="pmid">12079347</pub-id>
        <pub-id pub-id-type="doi">10.1016/S0022-2836(02)00308-X</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sankoff</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Simultaneous solution of the RNA folding, alignment, and proto-sequence
               problems</article-title>
        <source>SIAM J Appl Math</source>
        <year>1985</year>
        <volume>45</volume>
        <fpage>810</fpage>
        <lpage>825</lpage>
        <pub-id pub-id-type="doi">10.1137/0145048</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harmanci</surname>
            <given-names>AO</given-names>
          </name>
          <name>
            <surname>Sharma</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Mathews</surname>
            <given-names>DH</given-names>
          </name>
        </person-group>
        <article-title>Efficient pairwise RNA structure prediction using probabilistic alignment
                  constraints in Dynalign</article-title>
        <source>BMC Bioinformatics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>130</fpage>
        <pub-id pub-id-type="pmid">17445273</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-8-130</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Holmes</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Accelerated probabilistic inference of RNA structure evolution</article-title>
        <source>BMC Bioinformatics</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>73</fpage>
        <pub-id pub-id-type="pmid">15790387</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-6-73</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Havgaard</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Torarinsson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Gorodkin</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Fast pairwise structural RNA alignments by pruning of the dynamical programming
                  matrix</article-title>
        <source>PLoS Comput Biol</source>
        <year>2007</year>
        <volume>3</volume>
        <fpage>1896</fpage>
        <lpage>1908</lpage>
        <pub-id pub-id-type="pmid">17937495</pub-id>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.0030193</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Will</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Reiche</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Backofen</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Inferring noncoding RNA families and classes by means of genome-scale
                  structure-based clustering</article-title>
        <source>PLoS Comput Biol</source>
        <year>2007</year>
        <volume>3</volume>
        <fpage>400</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.0030065</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dowell</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Efficient pairwise RNA structure prediction and alignment using sequence alignment
                  constraints</article-title>
        <source>BMC Bioinformatics</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>400</fpage>
        <pub-id pub-id-type="pmid">16952317</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-7-400</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dalli</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wilm</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mainz</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>G</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>STRAL: progressive alignment of non-coding RNA using base pairing probability
                  vectors in quadratic time</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>1593</fpage>
        <lpage>1599</lpage>
        <pub-id pub-id-type="pmid">16613908</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl142</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Höchsmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Töller</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Giegerich</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kurtz</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Local Similarity in RNA Secondary Structures</article-title>
        <source>Proc IEEE Comput Soc Bioinform Conf</source>
        <year>2003</year>
        <volume>2</volume>
        <fpage>159</fpage>
        <lpage>168</lpage>
        <pub-id pub-id-type="pmid">16452790</pub-id>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Siebert</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Backofen</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>MARNA: multiple alignment and consensus structure prediction of RNAs based on
                  sequence structure comparisons</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>3352</fpage>
        <lpage>3359</lpage>
        <pub-id pub-id-type="pmid">15972285</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti550</pub-id>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Will</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Missal</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Backofen</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Inferring Non-Coding RNA Families and Classes by Means of Genome-Scale
                  Structure-Based Clustering</article-title>
        <source>PLoS Comp Biol</source>
        <year>2007</year>
        <volume>3</volume>
        <fpage>e65</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.0030065</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Horesh</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Doniger</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Michaeli</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Unger</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>RNAspa a shortest path approach for comparative prediction of the secondary
                  structure of ncRNA molecules</article-title>
        <source>BMC Bioinformatics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>366</fpage>
        <pub-id pub-id-type="pmid">17908318</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-8-366</pub-id>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reeder</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Giegerich</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Consensus shapes: an alternative to the Sankoff algorithm for RNA consensus
                  structure prediction</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>3516</fpage>
        <lpage>3523</lpage>
        <pub-id pub-id-type="pmid">16020472</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti577</pub-id>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiryu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Asai</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Robust prediction of consensus secondary structures using averaged base pairing
                  probability matrices</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>434</fpage>
        <lpage>441</lpage>
        <pub-id pub-id-type="pmid">17182698</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl636</pub-id>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilm</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Linnenbrink</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Steger</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>ConStruct: improved construction of RNA consensus structures</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>219</fpage>
        <pub-id pub-id-type="pmid">18442401</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-219</pub-id>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
        </person-group>
        <article-title>Automatic Detection of Conserved Base Pairing Patterns in RNA Virus Genomes</article-title>
        <source>Comp &amp; Chem</source>
        <year>1999</year>
        <volume>23</volume>
        <fpage>401</fpage>
        <lpage>414</lpage>
        <pub-id pub-id-type="pmid">10404627</pub-id>
        <pub-id pub-id-type="doi">10.1016/S0097-8485(99)00013-3</pub-id>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mathews</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>DH</given-names>
          </name>
        </person-group>
        <article-title>Prediction of RNA secondary structure by free energy minimization</article-title>
        <source>Curr Opin Struct Biol</source>
        <year>2006</year>
        <volume>16</volume>
        <fpage>270</fpage>
        <lpage>278</lpage>
        <pub-id pub-id-type="pmid">16713706</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.sbi.2006.05.010</pub-id>
      </citation>
    </ref>
    <ref id="B21">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilm</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Linnenbrink</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Steger</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>ConStruct: Improved construction of RNA consensus structures</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>219</fpage>
        <lpage>219</lpage>
        <pub-id pub-id-type="pmid">18442401</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-219</pub-id>
      </citation>
    </ref>
    <ref id="B22">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zuker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stiegler</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Optimal computer folding of large RNA sequences using thermodynamics and auxiliary
                  information</article-title>
        <source>Nucleic Acids Res</source>
        <year>1981</year>
        <volume>9</volume>
        <fpage>133</fpage>
        <lpage>148</lpage>
        <pub-id pub-id-type="pmid">6163133</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/9.1.133</pub-id>
      </citation>
    </ref>
    <ref id="B23">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
        </person-group>
        <article-title>Memory Efficient Folding Algorithms for Circular RNA Secondary Structures</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>1172</fpage>
        <lpage>1176</lpage>
        <pub-id pub-id-type="pmid">16452114</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl023</pub-id>
      </citation>
    </ref>
    <ref id="B24">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
          <name>
            <surname>Fontana</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Bonhoeffer</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>Tacker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schuster</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Fast Folding and Comparison of RNA Secondary Structures</article-title>
        <source>Monatsh Chem</source>
        <year>1994</year>
        <volume>125</volume>
        <fpage>167</fpage>
        <lpage>188</lpage>
        <pub-id pub-id-type="doi">10.1007/BF00818163</pub-id>
      </citation>
    </ref>
    <ref id="B25">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andronescu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Condon</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hoos</surname>
            <given-names>HH</given-names>
          </name>
          <name>
            <surname>Mathews</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>KP</given-names>
          </name>
        </person-group>
        <article-title>Efficient parameter estimation for RNA secondary structure prediction</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>i19</fpage>
        <lpage>i28</lpage>
        <pub-id pub-id-type="pmid">17646296</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm223</pub-id>
      </citation>
    </ref>
    <ref id="B26">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vingron</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sibbald</surname>
            <given-names>PR</given-names>
          </name>
        </person-group>
        <article-title>Weighting in sequence space: A comparison of methods in terms of generalized
                  sequences</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>1993</year>
        <volume>90</volume>
        <fpage>8777</fpage>
        <lpage>8781</lpage>
        <pub-id pub-id-type="pmid">8415606</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.90.19.8777</pub-id>
      </citation>
    </ref>
    <ref id="B27">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Klein</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>RSEARCH: finding homologs of single structured RNA sequences</article-title>
        <source>BMC Bioinformatics</source>
        <year>2003</year>
        <volume>4</volume>
        <fpage>44</fpage>
        <pub-id pub-id-type="pmid">14499004</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-4-44</pub-id>
      </citation>
    </ref>
    <ref id="B28">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wuyts</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Perrière</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Peer</surname>
            <given-names>Y Van De</given-names>
          </name>
        </person-group>
        <article-title>The European ribosomal RNA database</article-title>
        <source>Nucleic Acids Res</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>:D101</fpage>
        <lpage>D103</lpage>
        <pub-id pub-id-type="pmid">14681368</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gkh065</pub-id>
      </citation>
    </ref>
    <ref id="B29">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Knudsen</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hein</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Pfold: RNA secondary structure prediction using stochastic context-free
               grammars</article-title>
        <source>Nucleic Acids Res</source>
        <year>2003</year>
        <volume>31</volume>
        <fpage>3423</fpage>
        <lpage>3428</lpage>
        <pub-id pub-id-type="pmid">12824339</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gkg614</pub-id>
      </citation>
    </ref>
    <ref id="B30">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carvalho</surname>
            <given-names>LE</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <article-title>Centroid estimation in discrete high-dimensional spaces with applications in
                  biology</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2008</year>
        <volume>105</volume>
        <fpage>3209</fpage>
        <lpage>3214</lpage>
        <pub-id pub-id-type="pmid">18305160</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.0712329105</pub-id>
      </citation>
    </ref>
    <ref id="B31">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tacker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Bornberg-Bauer</surname>
            <given-names>EG</given-names>
          </name>
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
          <name>
            <surname>Schuster</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Algorithm Independent Properties of RNA Structure Prediction</article-title>
        <source>Eur Biophy J</source>
        <year>1996</year>
        <volume>25</volume>
        <fpage>115</fpage>
        <lpage>130</lpage>
        <pub-id pub-id-type="doi">10.1007/s002490050023</pub-id>
      </citation>
    </ref>
    <ref id="B32">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ding</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <article-title>A bayesian statistical algorithm for RNA secondary structure prediction</article-title>
        <source>Comput Chem</source>
        <year>1999</year>
        <volume>23</volume>
        <fpage>387</fpage>
        <lpage>400</lpage>
        <pub-id pub-id-type="pmid">10404626</pub-id>
        <pub-id pub-id-type="doi">10.1016/S0097-8485(99)00010-8</pub-id>
      </citation>
    </ref>
    <ref id="B33">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Griffiths-Jones</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Moxon</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Marshall</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Khanna</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Bateman</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Rfam: annotating non-coding RNAs in complete genomes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>121</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gki081</pub-id>
      </citation>
    </ref>
    <ref id="B34">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andronescu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bereg</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Hoos</surname>
            <given-names>HH</given-names>
          </name>
          <name>
            <surname>Condon</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>RNA STRAND: the RNA secondary structure and statistical analysis database</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>340</fpage>
        <lpage>340</lpage>
        <pub-id pub-id-type="pmid">18700982</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-340</pub-id>
      </citation>
    </ref>
    <ref id="B35">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andersen</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Lind-Thomsen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Knudsen</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kristensen</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Havgaard</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Torarinsson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Larsen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Zwieb</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ses-toft</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kjems</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gorodkin</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Semiautomated improvement of RNA alignments</article-title>
        <source>RNA</source>
        <year>2007</year>
        <volume>13</volume>
        <fpage>1850</fpage>
        <lpage>1859</lpage>
        <pub-id pub-id-type="pmid">17804647</pub-id>
        <pub-id pub-id-type="doi">10.1261/rna.215407</pub-id>
      </citation>
    </ref>
    <ref id="B36">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yao</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Weinberg</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Ruzzo</surname>
            <given-names>WL</given-names>
          </name>
        </person-group>
        <article-title>CMfinder-a covariance model based RNA motif finding algorithm</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>445</fpage>
        <lpage>452</lpage>
        <pub-id pub-id-type="pmid">16357030</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btk008</pub-id>
      </citation>
    </ref>
    <ref id="B37">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Seemann</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Gorodkin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Backofen</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Unifying evolutionary and thermodynamic information for RNA folding of multiple
                  alignments</article-title>
        <source>NAR</source>
        <year>2008</year>
        <pub-id pub-id-type="pmid">18836192</pub-id>
      </citation>
    </ref>
    <ref id="B38">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bindewald</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Shapiro</surname>
            <given-names>BA</given-names>
          </name>
        </person-group>
        <article-title>RNA secondary structure prediction from sequence alignments using a network of
                     <italic>k</italic>-nearest neighbor classifiers</article-title>
        <source>RNA</source>
        <year>2006</year>
        <volume>12</volume>
        <fpage>342</fpage>
        <lpage>352</lpage>
        <pub-id pub-id-type="pmid">16495232</pub-id>
        <pub-id pub-id-type="doi">10.1261/rna.2164906</pub-id>
      </citation>
    </ref>
    <ref id="B39">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gardner</surname>
            <given-names>PP</given-names>
          </name>
          <name>
            <surname>Giegerich</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>A comprehensive comparison of comparative RNA structure prediction approaches</article-title>
        <source>BMC Bioinformatics</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>140</fpage>
        <pub-id pub-id-type="pmid">15458580</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-5-140</pub-id>
      </citation>
    </ref>
    <ref id="B40">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chenna</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sugawara</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Koike</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Lopez</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gibson</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Multiple sequence alignment with the Clustal series of programs</article-title>
        <source>Nucleic Acids Research</source>
        <year>2003</year>
        <volume>31</volume>
        <fpage>3497</fpage>
        <lpage>500</lpage>
        <pub-id pub-id-type="pmid">12824352</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gkg500</pub-id>
      </citation>
    </ref>
    <ref id="B41">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Washietl</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
        </person-group>
        <article-title>Consensus folding of aligned sequences as a new measure for the detection of
                  functional RNAs by comparative genomics</article-title>
        <source>J Mol Biol</source>
        <year>2004</year>
        <volume>342</volume>
        <fpage>19</fpage>
        <lpage>39</lpage>
        <pub-id pub-id-type="pmid">15313604</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.jmb.2004.07.018</pub-id>
      </citation>
    </ref>
    <ref id="B42">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Washietl</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
        </person-group>
        <article-title>Fast and reliable prediction of noncoding RNAs</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2005</year>
        <volume>102</volume>
        <fpage>2454</fpage>
        <lpage>2459</lpage>
        <pub-id pub-id-type="pmid">15665081</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.0409169102</pub-id>
      </citation>
    </ref>
    <ref id="B43">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gesell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Washietl</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Dinucleotide controlled null models for comparative RNA gene prediction</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>248</fpage>
        <lpage>248</lpage>
        <pub-id pub-id-type="pmid">18505553</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-248</pub-id>
      </citation>
    </ref>
    <ref id="B44">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gruber</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Bernhart</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
          <name>
            <surname>Washietl</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Strategies for measuring evolutionary conservation of RNA secondary structures</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>122</fpage>
        <lpage>122</lpage>
        <pub-id pub-id-type="pmid">18302738</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-122</pub-id>
      </citation>
    </ref>
  </ref-list>
</back>
