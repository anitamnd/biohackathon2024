<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7347923</article-id>
    <article-id pub-id-type="publisher-id">17239</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-020-17239-9</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A supervised learning framework for chromatin loop detection in genome-wide contact maps</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Salameh</surname>
          <given-names>Tarik J.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <name>
          <surname>Wang</surname>
          <given-names>Xiaotao</given-names>
        </name>
        <address>
          <email>xiaotao.wang@northwestern.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Song</surname>
          <given-names>Fan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Bo</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0735-5504</contrib-id>
        <name>
          <surname>Wright</surname>
          <given-names>Sage M.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Khunsriraksakul</surname>
          <given-names>Chachrit</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ruan</surname>
          <given-names>Yijun</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7954-5462</contrib-id>
        <name>
          <surname>Yue</surname>
          <given-names>Feng</given-names>
        </name>
        <address>
          <email>Yue@northwestern.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2097 4281</institution-id><institution-id institution-id-type="GRID">grid.29857.31</institution-id><institution>Bioinformatics and Genomics Program, </institution><institution>The Pennsylvania State University, University Park, </institution></institution-wrap>State College, PA 16802 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2299 3507</institution-id><institution-id institution-id-type="GRID">grid.16753.36</institution-id><institution>Department of Biochemistry and Molecular Genetics, </institution><institution>Northwestern University Feinberg School of Medicine, </institution></institution-wrap>Chicago, IL 60611 USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0374 0039</institution-id><institution-id institution-id-type="GRID">grid.249880.f</institution-id><institution>The Jackson Laboratory for Genomic Medicine, </institution></institution-wrap>Farmington, CT USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000000419370394</institution-id><institution-id institution-id-type="GRID">grid.208078.5</institution-id><institution>Department of Genetics and Genome Sciences, </institution><institution>University of Connecticut Health Center, </institution></institution-wrap>Farmington, CT USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2299 3507</institution-id><institution-id institution-id-type="GRID">grid.16753.36</institution-id><institution>Robert H. Lurie Comprehensive Cancer Center of Northwestern University, </institution></institution-wrap>Chicago, IL USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>9</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>9</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>11</volume>
    <elocation-id>3428</elocation-id>
    <history>
      <date date-type="received">
        <day>4</day>
        <month>8</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>6</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Accurately predicting chromatin loops from genome-wide interaction matrices such as Hi-C data is critical to deepening our understanding of proper gene regulation. Current approaches are mainly focused on searching for statistically enriched dots on a genome-wide map. However, given the availability of orthogonal data types such as ChIA-PET, HiChIP, Capture Hi-C, and high-throughput imaging, a supervised learning approach could facilitate the discovery of a comprehensive set of chromatin interactions. Here, we present Peakachu, a Random Forest classification framework that predicts chromatin loops from genome-wide contact maps. We compare Peakachu with current enrichment-based approaches, and find that Peakachu identifies a unique set of short-range interactions. We show that our models perform well in different platforms, across different sequencing depths, and across different species. We apply this framework to predict chromatin loops in 56 Hi-C datasets, and release the results at the 3D Genome Browser.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Predicting chromatin loops from genome-wide interaction matrices such as Hi-C data provides insight into gene regulation events. Here, the authors present Peakachu, a Random Forest classification framework that predicts chromatin loops from genome-wide contact maps, and apply it to systematically predict chromatin loops in 56 Hi-C datasets, with results available at the 3D Genome Browser.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Gene regulatory networks</kwd>
      <kwd>Genome informatics</kwd>
      <kwd>Chromatin structure</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000051</institution-id>
            <institution>U.S. Department of Health &amp; Human Services | NIH | National Human Genome Research Institute (NHGRI)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01HG009906</award-id>
        <principal-award-recipient>
          <name>
            <surname>Yue</surname>
            <given-names>Feng</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000057</institution-id>
            <institution>U.S. Department of Health &amp; Human Services | NIH | National Institute of General Medical Sciences (NIGMS)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R35GM124820</award-id>
        <principal-award-recipient>
          <name>
            <surname>Yue</surname>
            <given-names>Feng</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000062</institution-id>
            <institution>U.S. Department of Health &amp; Human Services | NIH | National Institute of Diabetes and Digestive and Kidney Diseases (National Institute of Diabetes &amp; Digestive &amp; Kidney Diseases)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R24DK106766</award-id>
        <principal-award-recipient>
          <name>
            <surname>Yue</surname>
            <given-names>Feng</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100011541</institution-id>
            <institution>U.S. Department of Health &amp; Human Services | NIH | NCI | Division of Cancer Epidemiology and Genetics, National Cancer Institute (National Cancer Institute Division of Cancer Epidemiology and Genetics)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>U01CA200060</award-id>
        <principal-award-recipient>
          <name>
            <surname>Yue</surname>
            <given-names>Feng</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">The proper gene regulatory programs of mammalian cells are largely influenced by the 3D conformation of chromosomes<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. At kilobase to megabase scales, gene promoters are often connected to their distal regulatory elements, such as enhancers, through chromatin loops; rewiring of such loops has been implicated in developmental diseases and tumorigenesis<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR3">3</xref></sup>. It has been shown that chromatin loops are mediated by architectural proteins CTCF and cohesin via a loop extrusion model, in which CTCF binds to a specific and non-palindromic motif in a convergent orientation at two sites, acting as loop anchors<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR5">5</xref></sup>.</p>
    <p id="Par4">A growing number of experiments have been used to detect chromatin loops. Hi-C<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>, a high-throughput derivative of Chromosome Conformation Capture (3C)<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>, quantifies contacts between all possible pairs of genomic loci using a proximity-ligation procedure. With an improved experimental protocol and deep sequencing, in situ Hi-C<sup><xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR9">9</xref></sup> makes it possible to detect loops at kilobase resolution. By introducing micrococcal nuclease for chromatin fragmentation instead of restriction enzymes, Micro-C<sup><xref ref-type="bibr" rid="CR10">10</xref></sup> further enables nucleosome-resolution analysis of chromatin interactions. Proximity-ligation techniques also include ChIA-PET<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>, PLAC-Seq<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>, and HiChIP<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>, which detect loops bound to target proteins through chromatin immunoprecipitation steps, and include Capture C<sup><xref ref-type="bibr" rid="CR14">14</xref></sup> and Capture Hi-C<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>, which enrich interactions among a given set of sequences. Recently, several ligation-free techniques emerged to measure different aspects of chromatin organization. Genome Architecture Mapping (GAM)<sup><xref ref-type="bibr" rid="CR16">16</xref></sup> quantifies chromatin contacts by sequencing DNA from a set of ultrathin nuclear sections at random orientations. Trac-looping<sup><xref ref-type="bibr" rid="CR17">17</xref></sup> captures multiscale contacts by inserting a transposon linker between interacting regions. DNA SPRITE<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> follows a split-pool procedure to assign unique barcodes to individual complexes, with read pairs sharing identical barcodes treated similarly to contacts in Hi-C. Besides these biomedical protocols, high-throughput imaging approaches such as STORM<sup><xref ref-type="bibr" rid="CR19">19</xref></sup> and HiFISH<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> can directly measure spatial distances at the single-cell level.</p>
    <p id="Par5">As these protocols emerged, investigators accordingly developed computational tools to identify chromatin loops. For Hi-C data: Fit-Hi-C<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> performs a distance-dependent spline fitting procedure to refine its global background and chooses a binomial distribution as the null model to evaluate contact significance, which can output ~1 million cis-interactions from deeply sequenced reads<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. HiCCUPS<sup><xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR23">23</xref></sup> incorporates local background into its model and utilizes the Poisson test with a modified Benjamini–Hochberg adjustment to determine significance, and generally reports thousands of loop interactions. Analysis of ChIA-PET and similar types of data usually starts with peak calling to identify anchor regions for a target protein, but different computational tools may be based on different distributions. For example, the first published ChIA-PET tool<sup><xref ref-type="bibr" rid="CR24">24</xref>,<xref ref-type="bibr" rid="CR25">25</xref></sup> adopts a hyper-geometric distribution to filter out noise, while the more recent Mango<sup><xref ref-type="bibr" rid="CR26">26</xref></sup> software builds a null model by incorporating both the genomic distance and read depth of each anchor. For PLAC-Seq and HiChIP, the recently developed MAPS<sup><xref ref-type="bibr" rid="CR27">27</xref></sup> filters original interactions against ChIP-Seq peaks of the same protein, and conducts a specific normalization procedure before evaluating significance. For Capture Hi-C, the main data analysis challenges are the asymmetry of interaction matrices, the uneven capture efficiency of baits, and the huge number of tests at single-fragment resolution. To address these problems, CHiCAGO adopts a convolution background model and alleviates multiple testing via a p-value weighting procedure<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>. Alternatively, ChiCMaxima avoids statistical tests by using strategies from the signal processing field to find local maxima and integrates biological replicate information to reduce false-positive rates<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. We observe that nearly all available tools are based on testing for significant enrichment compared to a local or global background, with specific calculations being quite empirical and difficult to generalize between techniques. It would be intriguing and potentially beneficial to automatically distinguish loop vs non-loop interactions in a data-driven manner, which is a standard supervised learning task.</p>
    <p id="Par6">Machine learning (ML) has been successfully applied in genomics settings, such as predicting microRNA target activities<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>, annotating chromatin states<sup><xref ref-type="bibr" rid="CR31">31</xref>,<xref ref-type="bibr" rid="CR32">32</xref></sup>, and characterizing functional effects of noncoding variants<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>. In chromatin conformation studies, manifold learning strategies are employed by miniMDS<sup><xref ref-type="bibr" rid="CR34">34</xref></sup> and GEM<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> to estimate 3D structures from 2D contact maps. Some investigators have applied ML algorithms to predict 3D interactions from 1D sequence and epigenomic datasets<sup><xref ref-type="bibr" rid="CR36">36</xref>,<xref ref-type="bibr" rid="CR37">37</xref></sup>. In addition, we recently developed HiCPlus<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>, which can greatly enhance the Hi-C data resolution through a deep convolutional neural network. So far, the potential benefits of ML approaches for loop detection at kilobase scales are relatively unexplored.</p>
    <p id="Par7">Here we present Peakachu (Unveil Hi-C Anchors and Peaks) (Fig. <xref rid="Fig1" ref-type="fig">1</xref>), a supervised ML framework for detecting chromatin loops from genome-wide interaction maps. Peakachu builds loop-classifying models from defined positive and negative training sets: the positive set could be any list of interactions from either biologically enriched experiments such as ChIA-PET/HiChIP and Capture Hi-C, or a high-throughput imaging experiment such as HiFISH. The negative set is generated from loci randomly sampled from two populations: (1) contacts with genomic distances similar to the positive set, and (2) contacts with larger genomic distances than the positive set. Once the training set is defined, Peakachu applies a hyperparameter search to find the best random forest model separating the two classes, which can be used to detect loops from genome-wide contact maps. We show that the predictions made by Peakachu have high precision and recall rates. Further, we demonstrate Peakachu can detect high-resolution chromatin loops with as few as 30 million intrachromosomal Hi-C reads. With pretrained models, we successfully predict chromatin loops in 56 Hi-C datasets at different sequencing depths and make them available at the 3D Genome Browser (3dgenome.org). Finally, we show Peakachu is a platform-agnostic tool by applying it in two additional genome-wide interaction data types, Micro-C, and DNA SPRITE.<fig id="Fig1"><label>Fig. 1</label><caption><title>A binary classification framework for loop detection in genome-wide contact data.</title><p>A contact matrix from Hi-C or similar experiment is decomposed into a training set defined by sub-windows either centered at positive interactions from an orthogonal method (ChIA-PET, PLAC-Seq, HiFISH, Capture Hi-C,…) or random loci of similar genomic distance. Hyperparameter tuning within a 3-fold cross-validation is applied to select a random forest model best able to distinguish the two classes. A trained model can then compute per-pixel probabilities in a different contact map from the same platform, with Hi-C depicted here. A greedy pooling algorithm selects the best-scored contacts from clusters of high-probability pixels.</p></caption><graphic xlink:href="41467_2020_17239_Fig1_HTML" id="d30e511"/></fig></p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Overview of the Peakachu framework</title>
      <p id="Par8">We describe the overall approach by Peakachu in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. There are two parts of the input. The first part is a genome-wide interaction matrix, such as Hi-C or Micro-C data. The second part consists of the positive and negative training datasets. Positive training sets are defined by loops identified from orthogonal techniques such as ChIA-PET, PLAC-Seq, Capture Hi-C, or even high-resolution imaging data as they become available. For negative training sets, an equal number of pixels are randomly selected from nonzero values with a distance distribution derived from the positive set. The negative set always contains contacts with the similar genomic distance resembling the positive set, plus a set of long-range contacts resembling noise inherent to contact maps.</p>
      <p id="Par9">The feature vectors of training samples are defined by the surrounding pixels of each sample. Each vector includes the absolute value of each pixel as well as the relative rank of each pixel within the sample. The exact window size is configurable, and we use 11 × 11 windows at 10 kb resolution for all work presented in this text. Once feature vectors are constructed from the positive and negative training sets, Peakachu applies a 3-fold cross-validation loop to select a random forest model (refer to the Methods section for performance comparisons with other machine-learning frameworks) that best separates the two classes. Briefly, the input is randomly separated into three equal parts and multiple models are trained using several combinations of tuning parameters. Each of these models is trained on two parts of the data; one part is used for scoring. The parameter combination achieving the best score is used to fit a final model using the whole training set.</p>
      <p id="Par10">In the prediction stage, similar feature vectors are defined for all nonzero values in a contact map to compute per-pixel probability scores, then a pooling algorithm is applied to eliminate local loop redundancy. A model trained from a given type of contact map, such as Hi-C, can be used to predict loops from other maps of the same platform. As shown in the following sections, a model trained on one cell type can be used to predict loops from Hi-C matrices in other cell types with comparable performance. Detailed description of the framework can be found in the Methods section.</p>
    </sec>
    <sec id="Sec4">
      <title>Orthogonal datasets reveal different sets of chromatin loops</title>
      <p id="Par11">To train and evaluate the performance of Peakachu, we first used the high-resolution Hi-C data from lymphoblastic cell line GM12878<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, a tier one ENCODE cell line with extensive epigenome data available. There are five types of orthogonal data available in this cell line: CTCF ChIA-PET<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>, RAD21 ChIA-PET<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>, SMC1 HiChIP<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>, H3K27ac HiChIP<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>, and promoter Capture Hi-C<sup><xref ref-type="bibr" rid="CR28">28</xref></sup> (Supplementary Data <xref rid="MOESM3" ref-type="media">1</xref>). First, we observed that each of these enrichment-based assays predicted a unique set of chromatin interactions (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref>). Among them, CTCF ChIA-PET identified the highest number of chromatin loops, while H3K27ac HiChIP only identified 6395 loops. 25% (1584 out of the 6395) H3K27ac HiChIP loops were predicted by all five techniques, while 18% (1144/6395) are uniquely predicted in this dataset. Similarly, 32% of the CTCF ChIA-PET loops are unique, while only 7% of them can be recovered by all techniques, potentially due to the fact that the number of loops in CTCF ChIA-PET is much larger than other data types.</p>
      <p id="Par12">More interestingly, we found that these five datasets identified chromatin loops at different genomic distance. For example, 75% (4810/6395) of the H3K27ac HiChIP loops are within 250 kb (Fig. <xref rid="Fig2" ref-type="fig">2a</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">2a</xref>) and only 8% (500/6395) are over 500 kb. On the contrary, 42% (23,420/55,222) of the pooled CTCF ChIA-PET interactions are long-range (&gt;500 kb) and only 34% are short-range (&lt;250 kb). This is consistent with previous observations that CTCF is more responsible for long-range interactions<sup><xref ref-type="bibr" rid="CR41">41</xref>,<xref ref-type="bibr" rid="CR42">42</xref></sup>, and that CTCF is a key component of both the loop extrusion model<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR5">5</xref></sup> and the formation of TADs<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>. At the same time, H3K27ac is a histone mark for active enhancers and promoters, and therefore it is possible that contacts enriched for H3K27ac are shorter-range interactions between promoters and enhancers, which could be more dynamic than CTCF loops<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>. In the following sections, we first evaluate models trained by both CTCF ChIA-PET and H3K27ac HiChIP and then combine their results to achieve a more comprehensive set of interactions from Hi-C data.<fig id="Fig2"><label>Fig. 2</label><caption><title>Peakachu framework applied in GM12878 Hi-C.</title><p><bold>a</bold> Distance distributions of CTCF ChIA-PET, H3K27ac HiChIP, and HiCCUPS (Hi-C) interactions in GM12878 (top row). Distributions of Peakachu loops predicted from Hi-C after training with CTCF ChIA-PET or H3K27ac HiChIP data, and union of both predictions (bottom row). Interactions in CTCF ChIA-PET were first pooled to remove local redundancy with the same algorithm used by Peakachu. <bold>b</bold> Proportion of predicted loops with different regulatory element combinations at anchor loci. <bold>c</bold> CTCF binding patterns and APA analysis of Peakachu predictions. <bold>d</bold> Overlap of loops predicted by Peakachu models trained with either CTCF ChIA-PET or H3K27ac HiChIP examples, and visualization of interactions predicted from both models. <bold>e</bold> Different features drive the predictions for CTCF and H3K27ac models. APA plots for loops uniquely predicted by CTCF or H3K27ac models (top row). The feature importance metric from random forests showing which pixels drive the classification most strongly (bottom row). <bold>f</bold> Fraction and enrichment of Peakachu loop anchors bound for 133 transcription factors and 10 histone modifications. <bold>g</bold> Fraction of GM12878 interactions in orthogonal experiments recaptured by merged Peakachu loops. <bold>h</bold> Fraction of Peakachu predictions validated by orthogonal experiments. Source data are available in the Source Data file.</p></caption><graphic xlink:href="41467_2020_17239_Fig2_HTML" id="d30e628"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Peakachu captures known interactions from Hi-C data</title>
      <p id="Par13">We first trained our model in GM12878 Hi-C data with the 92,807 published chromatin interactions from CTCF ChIA-PET in the same cell type (Supplementary Fig. <xref rid="MOESM1" ref-type="media">3</xref>). Loops in each chromosome were predicted using models trained in the other 22 chromosomes (Methods). Genome-wide, we identified 13,360 intrachromosomal loops. Aggregate peak analysis (APA) shows that there is an enrichment of Hi-C signals in the predicted loop regions (Fig. <xref rid="Fig2" ref-type="fig">2c</xref>). Among the predicted loops, 51% have convergent CTCF binding motifs in binding sites, 34% contain CTCF binding sites at a single anchor, and 9% contain tandem motifs (Fig. <xref rid="Fig2" ref-type="fig">2c</xref>). 34% of the predicted loops contained promoters at one anchor and enhancers at another, and 41% contained enhancers at both anchors (Fig. <xref rid="Fig2" ref-type="fig">2b</xref>). Seventeen percentage of the predictions contained neither promoters nor enhancers at either anchor.</p>
      <p id="Par14">Next, we trained a model using the 6395 GM12878 H3K27ac HiChIP loops<sup><xref ref-type="bibr" rid="CR40">40</xref></sup> that contain a higher prevalence of short-range interactions (Supplementary Fig. <xref rid="MOESM1" ref-type="media">3</xref>). In total, this model predicted 13,292 loops in the Hi-C matrix. We noticed that 65% of the predictions are the same as from the model trained with CTCF: 65% of which exactly matched 64% of predictions from the CTCF model (8606 of 13,292 and 13,360). When allowing for mismatches of two bins for either anchor, the overlap increases to 69 and 68% (9135 CTCF loops matching 9109 H3K27ac loops) (Fig. <xref rid="Fig2" ref-type="fig">2d</xref>). The enrichment for promoters and enhancers is similar but slightly higher than observed from the CTCF ChIA-PET model (Fig. <xref rid="Fig2" ref-type="fig">2b</xref>): 37% of the predicted loops are between candidate enhancers and promoters, and ~46% are between enhancers and enhancers.</p>
      <p id="Par15">However, there are differences in the predictions from the two models that vividly reflect the difference in the positive training data. Firstly, we observed a higher percentage of short-range interactions in predictions from the H3K27ac HiChIP model. 53% (7000/13,292) are short-range (&lt;250 kb) while 14% are over 500 kb (Fig. <xref rid="Fig2" ref-type="fig">2a</xref>). On the contrary, only 36% (4874/13,360) of predictions by the CTCF model were less than 250 kb, while 25% (3335/13,360) were greater than 500 kb (Fig. <xref rid="Fig2" ref-type="fig">2a</xref>). This suggests that H3K27ac HiChIP model identifies more short-range interactions, and CTCF ChIA-PET model is better at identifying long-range loops. Examining the Random Forest feature importance, we found that the most important predictor in a CTCF model is the center pixel, while the H3K27ac model is additionally driven by the lower-left pixels (Fig. <xref rid="Fig2" ref-type="fig">2e</xref>). Secondly, we observed a lower CTCF percentage when training with H3K27ac HiChIP, compared with the model trained using CTCF ChIA-PET data (Fig. <xref rid="Fig2" ref-type="fig">2c</xref>): 35% of the loops have convergent CTCF binding motifs (vs. 51% in the model trained with CTCF ChIA-PET), 42% contain binding sites at one anchor, and 13% contain no CTCF binding sites. These disparate distributions of CTCF patterns in the prediction are consistent with the patterns in the positive training sets of both models (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2b</xref>).</p>
      <p id="Par16">Despite the difference in genomic distance and CTCF motif composition, we observed high validation rates for both prediction sets (Supplementary Fig. <xref rid="MOESM1" ref-type="media">4</xref>). Eighty-four percent (11,151 of 13,292) of loops from the H3K27ac HiChIP model and 83% (11,143 of 13,360) of the CTCF ChIA-PET models can be supported by at least one source, while 61% of HiChIP model and 55% (7414 of 13,360) of ChIA-PET model can be supported by at least two sources (Supplementary Fig. <xref rid="MOESM1" ref-type="media">4</xref>). Considering predictions unique to either model, we found that 66% (2789 of 4225) of loops from the CTCF model and 68% (2824 of 4183) from the H3K27ac model could be supported by at least one orthogonal source. At least two sources could support 27% (1146 loops) of predictions unique to the CTCF model, and 44% (1827 loops) unique to the H3K27ac model.</p>
      <p id="Par17">Given that both models uniquely predicted valid loops, we decided to use their merged, non-redundant output to report loops from GM12878 and other cell types. This set of predictions from GM12878 Hi-C has high recall and validation rates (Fig. <xref rid="Fig2" ref-type="fig">2g, h</xref>) when compared with four validation sets. Nearly 80% of Peakachu-predicted loops can be supported by at least one orthogonal method. We also found that these predicted loops are usually between distal regulatory elements and CTCF binding sites (Supplementary Figs. <xref rid="MOESM1" ref-type="media">5</xref> and <xref rid="MOESM1" ref-type="media">6</xref>).</p>
      <p id="Par18">To investigate whether models trained with CTCF ChIA-PET and H3K27ac HiChIP data can also predict loops involving other transcription factors (TFs) and histone modification markers, we computed fold enrichment at loop anchors for 133 TFs and 10 histone modifications from the ENCODE consortium, following a similar approach described in Rao et al. (Methods)<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. We observed a full range of TFs and histone modifications were enriched in our predicted loops (Fig. <xref rid="Fig2" ref-type="fig">2f</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">7</xref>), including factors such as YY1<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>, ZNF143<sup><xref ref-type="bibr" rid="CR45">45</xref></sup>, and H3K27me3<sup><xref ref-type="bibr" rid="CR46">46</xref></sup>, which have been shown to play a role in chromatin loops but not used in our training. This suggests that loop patterns learned from CTCF ChIA-PET and H3K27ac HiChIP models can be used to predict loops mediated by other factors.</p>
    </sec>
    <sec id="Sec6">
      <title>Peakachu reveals a unique set of short-range interactions</title>
      <p id="Par19">To benchmark the performance of Peakachu, we compared it with two current popular enrichment-based methods, HiCCUPS<sup><xref ref-type="bibr" rid="CR23">23</xref></sup> and Fit-Hi-C<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). First, we ran both methods on the same GM12878 Hi-C matrix at 10 kb resolution. We noticed Fit-Hi-C detected over 120 million significant interactions even with the FDR cutoff &lt;1e-5 (Supplementary Fig. <xref rid="MOESM1" ref-type="media">8a</xref>). Therefore, to make a fair comparison, we sorted the Fit-Hi-C outputs by p-values and merged the top 140,000 interactions into 14,876 loops (Fig. <xref rid="Fig3" ref-type="fig">3a, b</xref>), with the same pooling algorithm used by Peakachu (Methods). We observed that 72% (12,398 of 17,171) of Peakachu results overlap with either HiCCUPS or Fit-Hi-C predictions (Fig. <xref rid="Fig3" ref-type="fig">3a</xref>).<fig id="Fig3"><label>Fig. 3</label><caption><title>Comparison of Peakachu, HiCCUPS, and Fit-Hi-C in GM12878 Hi-C.</title><p><bold>a</bold> Venn diagram of loops predicted by different methods. The original significant interactions from Fit-Hi-C were pooled by the same algorithm used in Peakachu. Parameters of HiCCUPS and Fit-Hi-C were tuned to make the number of loops uniquely predicted by each method similar. <bold>b</bold> Visualization of loops. <bold>c</bold> Distance distribution of loops uniquely detected by each method. <bold>d</bold> CTCF motif patterns of uniquely detected loops by each method. <bold>e</bold> CTCF binding profile surrounding loop anchors. <bold>f</bold> Overlap loops uniquely detected by each method with ChIA-PET/HiChIP interactions. Source data are available in the Source Data file.</p></caption><graphic xlink:href="41467_2020_17239_Fig3_HTML" id="d30e775"/></fig></p>
      <p id="Par20">We systematically studied the characteristics of loops uniquely detected by each method. Peakachu-specific predictions contain a higher percentage of short-range loops (~79%, 3775/4773), compared with 70 and 72% for HiCCUPS- and Fit-Hi-C-specific loops (Fig. <xref rid="Fig3" ref-type="fig">3c</xref>). As for CTCF binding patterns, we found 85% of Peakachu-specific loops contain active CTCF binding sites at least one anchor, compared with 73% for HiCCUPS and Fit-Hi-C-specific loops (Fig. <xref rid="Fig3" ref-type="fig">3d, e</xref>). Most importantly, 58% (2766/4773) of Peakachu-specific loops could be validated by at least one ChIA-PET or HiChIP dataset, while the validation ratios for HiCCUPS specific and Fit-Hi-C-specific loops are 48% (2205/4632) and 40% (1888/4679), respectively (Fig. <xref rid="Fig3" ref-type="fig">3f</xref>).</p>
      <p id="Par21">Further, we validated Peakachu-specific loops by comparing them with more external data such as ATAC-Seq, PhyloP conservation scores<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>, and five orthogonal experimental data generated from the 4D Nucleome consortium<sup><xref ref-type="bibr" rid="CR48">48</xref></sup>, including Dilution Hi-C<sup><xref ref-type="bibr" rid="CR49">49</xref></sup>, H3K4me3 PLAC-Seq, RNAPII ChIA-PET, TrAC-loop, and DNA SPRITE<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. We found anchors of Peakachu-specific loops are enriched with chromatin accessible loci and highly conserved during the evolution, at all genomic distances (Supplementary Fig. <xref rid="MOESM1" ref-type="media">9</xref>). APA analysis shows that these Peakachu-specific loops have strong signal enrichment in all five orthogonal datasets (Supplementary Fig. <xref rid="MOESM1" ref-type="media">10</xref>), suggesting that Peakachu indeed identified a unique set of chromatin loops at a high validation rate.</p>
      <p id="Par22">We repeated the same aforementioned comparisons in human leukemia cells (K562) and mouse embryonic stem cells (mESC), and found that Peakachu consistently predicted more short-range and CTCF-enriched loops, as well as higher validation rates among orthogonal datasets (Supplementary Figs. <xref rid="MOESM1" ref-type="media">11</xref>, <xref rid="MOESM1" ref-type="media">12</xref>). Therefore, we conclude that while searching only for the strongest dot signals on a Hi-C map can reveal a large set of chromatin interactions, a supervised machine-learning approach, especially when trained with shorter regulatory interactions, can recover a unique set of chromatin interactions.</p>
    </sec>
    <sec id="Sec7">
      <title>Estimating false discovery rate (FDR) for Peakachu</title>
      <p id="Par23">In order to estimate the FDR of our model, we applied Peakachu to predict loops from a system previously used to investigate the impact of cohesin loss on loop formations<sup><xref ref-type="bibr" rid="CR50">50</xref></sup>. This system used a modified human colorectal carcinoma cell line HCT-116, with an AID domain tagging to both RAD21 alleles, an indispensable component of the cohesin complex. When treated with auxin, RAD21 in this cell line is effectively destroyed, and loops concomitantly disappeared in Hi-C maps genome-wide due to loss of cohesin.</p>
      <p id="Par24">Using a model trained with CTCF ChIA-PET interactions, Peakachu identified only 19 loops genome-wide from the Hi-C map of auxin-treated cells. The same model identified 11,814 loops from the Hi-C map of untreated cells (Supplementary Data <xref rid="MOESM4" ref-type="media">2</xref>). Given that the sequencing depths are similar between both maps, we roughly estimated Peakachu’s FDR at ~0.2% (19/11,814).</p>
    </sec>
    <sec id="Sec8">
      <title>Peakachu is robust to sequencing depths</title>
      <p id="Par25">To test the effect of sequencing depth on the performance of Peakachu, we computationally down-sampled the GM12878 dataset to 11 different depths (ranging from 30 million to 2 billion cis-reads) (Methods), with the same 10 kb resolution for each sequencing depth. We then independently trained and predicted loops in each down-sampled Hi-C matrix. First, we observed that lower sequencing depths generally resulted in reduced numbers of predicted loops (Fig. <xref rid="Fig4" ref-type="fig">4a</xref>). However, even at 1.5% down-sample rate (~30 million reads), Peakachu still predict 2363 chromatin loops, 2128 (90%) of which can be validated by at least one orthogonal data. More importantly, we observed that the predicted loops are highly concordant across different sequencing depths, although the models are trained separately. For example, 87% (12,364/14,260) of loops predicted in the 50% down-sampled matrix are also predicted in the original datasets, while 88% (6788/7683) of the loops predicted in the 10% down-sampled matrix are predicted in the original dataset. Even when we used the 1.5% down-sampled matrix, 85% of the predicted loops overlap with loops predicted in the original matrix as well (Fig. <xref rid="Fig4" ref-type="fig">4b, c</xref>).<fig id="Fig4"><label>Fig. 4</label><caption><title>Detection of loops at lower sequencing depths.</title><p><bold>a</bold> Predicted interactions from down-sampled versions of the GM12878 Hi-C map with levels of validation by orthogonal methods. <bold>b</bold> Concordance of predictions from datasets with different down-sampled rates. <bold>c</bold> Visualization of a chromosome 2 locus for Hi-C data and predicted loops using 50% and 1.5% of sequencing reads. <bold>d</bold> APA profiles and CTCF motif orientations of 50% and 1.5% loop predictions. The color bar indicates contact counts normalized by the mean of pixels within their windows. Source data are available in the Source Data file.</p></caption><graphic xlink:href="41467_2020_17239_Fig4_HTML" id="d30e866"/></fig></p>
      <p id="Par26">APA analysis of predicted loops at varying sequencing depths showed similar enrichment of contact signals compared to surrounding pixels (Fig. <xref rid="Fig4" ref-type="fig">4d</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">13</xref>). As sequencing depth decreased, validation rates of predicted loops remained similar while their distance distributions tended toward shorter range (Supplementary Fig. <xref rid="MOESM1" ref-type="media">8b</xref>) and retained a majority of loops predicted by HiCCUPS in the same maps (Supplementary Figs. <xref rid="MOESM1" ref-type="media">14</xref>, <xref rid="MOESM1" ref-type="media">15</xref>).</p>
      <p id="Par27">We noticed that both HiCCUPS and Fit-Hi-C showed more sensitivity to sequencing depths compared with Peakachu (Supplementary Figs. <xref rid="MOESM1" ref-type="media">8a</xref> and <xref rid="MOESM1" ref-type="media">14a</xref>). For example, at 1.5% down-sampling, HiCCUPS could only identify 655 loops (3.6-fold less than Peakachu) even with the most lenient parameters, and Fit-Hi-C only detected 1,732 interactions after specifying an FDR &lt; 0.1. However, only 79% (519/655) and 83% (1433/1732) of HiCCUPS and Fit-Hi-C loops could be validated by at least one ChIA-PET or HiChIP dataset at this sequencing depth (Supplementary Fig. <xref rid="MOESM1" ref-type="media">16a</xref>).</p>
      <p id="Par28">Since we have pretrained 11 models ranging from 30 million to 2 billion read depths, we wanted to investigate whether it is necessary for our users to train a new Peakachu model each time with exactly the same sequencing depths. First, we compared three pretrained models: 100% vs. 90% (2 billion vs 1.8 billion), and 80% vs 90% (1.6 billion vs. 1.8 billion reads). The overlap between each set of prediction is ~85% (Supplementary Fig. <xref rid="MOESM1" ref-type="media">17a</xref>); this variation is comparable to the predictions from two biological replicates with similar sequencing depth (14.6% variation, sequencing depth 382 million vs 389 million, Supplementary Fig. <xref rid="MOESM1" ref-type="media">17b</xref>). We then evaluated the variation of models trained at more disparate sequencing depths (30 million, 200 million and 1.8 billion) (Supplementary Fig. <xref rid="MOESM1" ref-type="media">17c</xref>). We still observed reasonable overlap between models trained from different sequencing depths. Therefore, we believe for any new Hi-C experiments, choosing the pretrained models with the closest sequencing depth will yield satisfactory results.</p>
    </sec>
    <sec id="Sec9">
      <title>Peakachu models are transferrable in different cell types</title>
      <p id="Par29">To test whether models trained in one cell type can be applied in other cell types, we first used the model trained in GM12878 CTCF ChIA-PET to predict loops in the human chronic lymphocytic leukemia cell line K562 (~500 million <italic>cis</italic>-reads)<sup><xref ref-type="bibr" rid="CR8">8</xref></sup> and in mouse embryonic stem cells (1.9 billion <italic>cis-</italic>reads)<sup><xref ref-type="bibr" rid="CR51">51</xref></sup>. To match the sequencing depths in K562 and mESC, we used models trained with 20% and 90% GM12878 Hi-C reads and CTCF ChIA-PET examples (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). In K562, we predicted 13,566 chromatin loops: 37% (5,076/13,566) of which contain convergent CTCF binding sites and 41% (5623/13,566) with CTCF binding at both anchors, and an additional 45% (6066 loops) having CTCF binding at one anchor (Fig. <xref rid="Fig5" ref-type="fig">5b</xref>). We predicted 14,842 loops in mESC: 41% (6102 of 14,842) contained convergent CTCF binding sites and an additional 44% (6546 of 14,842) had one CTCF anchor (Fig. <xref rid="Fig5" ref-type="fig">5e</xref>). Both sets of predictions contained regulatory elements in at least 80% of candidate loops (Fig. <xref rid="Fig5" ref-type="fig">5c, f</xref>).<fig id="Fig5"><label>Fig. 5</label><caption><title>Application of Peakachu in other Hi-C datasets of different tissues and species.</title><p><bold>a</bold> Overlap of loops predicted in K562 Hi-C by Peakachu models trained in either GM12878 or K562 data. Both models were trained with CTCF ChIA-PET examples. <bold>b</bold> CTCF binding orientations for predicted loops. <bold>c</bold> Regulatory elements at anchor loci of predicted loops. <bold>d</bold>–<bold>f</bold> Repeat analysis for loops predicted in mESC Hi-C by Peakachu models trained with either GM12878 CTCF ChIA-PET or mESC SMC1 HiChIP. Source data are available in the Source Data file.</p></caption><graphic xlink:href="41467_2020_17239_Fig5_HTML" id="d30e962"/></fig></p>
      <p id="Par30">Next, we compared predicted loops in K562 from the model trained with GM12878 CTCF ChIA-PET with a model trained with K562 CTCF ChIA-PET<sup><xref ref-type="bibr" rid="CR52">52</xref></sup>. Overall, the predictions are highly similar. A total of 13,566 candidate loops were predicted by the GM12878 model vs 13,515 by K562 model. 78% (10,571/13,566) of GM12878 model and 78% (10,571/13,515) of loops from the K562 model are the same. Their percentage of convergent CTCF binding sites and percentage of enrichment of <italic>cis</italic>-regulatory elements are consequently similar as well (Fig. <xref rid="Fig5" ref-type="fig">5b, c</xref>).</p>
      <p id="Par31">To further validate the transferability of Peakachu models, we compared loops predicted in mESC by models trained with either GM12878 CTCF ChIA-PET or mESC SMC1 HiChIP<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>. Again, the total number of predictions was similar, with 14,842 candidate loops from the GM12878 model and 13,791 from the mESC model. Of these, 10,242 were the same, representing 69% of predictions from the GM12878 model and 74% of those from the mESC model (Fig. <xref rid="Fig5" ref-type="fig">5d</xref>). While the total overlap was slightly less than the comparable K562 analysis, we found that both sets of mESC predictions had similar distributions for both CTCF binding site orientations (Fig. <xref rid="Fig5" ref-type="fig">5e</xref>), and that regulatory elements were slightly more enriched in the model trained with mESC SMC1 HiChIP (Fig. <xref rid="Fig5" ref-type="fig">5f</xref>).</p>
      <p id="Par32">With K562 and mESC loops serving as a proof-of-concept for transferable GM12878-trained models in other cell types and species, we next predicted interactions in 53 additional Hi-C datasets ranging from 25 million to 3.6 billion <italic>cis-</italic>reads using models trained with down-sampled GM12878 contact maps (Supplementary Data <xref rid="MOESM4" ref-type="media">2</xref>). We found that the majority of the predicted loops (&gt;87.5%) are located within the same TADs (Supplementary Fig. <xref rid="MOESM1" ref-type="media">18</xref>) and APA analysis shows there are strong enrichment of Hi-C signals for the loops predicted in all the datasets (Supplementary Fig. <xref rid="MOESM1" ref-type="media">19</xref>). Furthermore, to investigate whether differential chromatin loops are associated with differential gene expression, we first compared loops predicted in GM12878 and K562 cells. By requiring at least 2-fold changes in the Peakachu probability score for a loop, we identified 1134 GM12878-specific loops and 1075 K562-specific loops (Supplementary Fig. <xref rid="MOESM1" ref-type="media">20</xref>). Interestingly, we found that genes located in GM12878-specific loops were also expressed at a higher level in GM12878, while genes in K562-specific loops had higher expression level in K562 cells. We also performed a similar analysis between GM12878 and IMR90, and made a similar observation (Supplementary Fig. <xref rid="MOESM1" ref-type="media">20</xref>). These results suggest loops predicted by Peakachu are closely related to gene regulations and biological functions.</p>
    </sec>
    <sec id="Sec10">
      <title>Applying Peakachu on DNA SPRITE and Micro-C data</title>
      <p id="Par33">We were interested in Peakachu’s potential to perform cross-platform comparisons. To this end, we tested the performance of Peakachu in Micro-C<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>, a variant of Hi-C protocol capable of higher contact resolutions, and DNA SPRITE<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, which interrogates chromatin interactions by using a split-pool procedure and assigning a unique sequence barcode for each chromatin contact. We downloaded the H1-ESC Hi-C and Micro-C data<sup><xref ref-type="bibr" rid="CR53">53</xref></sup> from the 4DN data portal and the GM12878 DNA SPRITE data from Quinodoz et al.<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. In both cell lines, CTCF ChIA-PET data are available and were used as positive training sets for Peakachu models trained for Hi-C, Micro-C, and SPRITE (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). We used the same parameters and search space for all analyses.<fig id="Fig6"><label>Fig. 6</label><caption><title>Cross-platform comparison of Peakachu loops in different tissue types.</title><p><bold>a</bold> Overlap of loops predicted in H1ESC by Micro-C and Hi-C, using the same CTCF ChIA-PET training set. <bold>b</bold> Patterns of CTCF binding site orientations in predicted loops. <bold>c</bold> Regulatory elements at anchor loci of predicted loops. <bold>d</bold>–<bold>f</bold> Repeat analysis comparing DNA SPRITE with Hi-C in GM12878, using the same CTCF ChIA-PET training set. Source data are available in the Source Data file.</p></caption><graphic xlink:href="41467_2020_17239_Fig6_HTML" id="d30e1060"/></fig></p>
      <p id="Par34">In Micro-C, we predicted a total of 16,298 loops, which is higher than the number of loops we predicted in Hi-C data (11,247). This is potentially due to the fact that Micro-C improved upon the Hi-C protocol by using a different crosslinker and fragmenting chromatin with higher-resolution enzyme MNase<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. 74% (8315/11,247) of the Hi-C loops and 51% of the Micro-C loops are the same (Fig. <xref rid="Fig6" ref-type="fig">6a</xref>). Interestingly, the Micro-C predicted loops contain a higher convergent CTCF ratio (58% vs 34%, Fig. <xref rid="Fig6" ref-type="fig">6b</xref>) and in general, a higher CTCF binding rate. Micro-C predicted loops also contain a slightly higher percentage of enhancer-promoter or enhancer-enhancer interactions (Fig. <xref rid="Fig6" ref-type="fig">6c</xref>).</p>
      <p id="Par35">The DNA SPRITE dataset for GM12878 contains 135 million <italic>cis-</italic>reads, resulting in a contact map that was quite sparse compared to the Hi-C map comprised by 2 billion reads. To the best of our knowledge, we are not aware of any successful effort that can identify loops from this set of SPRITE data. Here by training and applying the Peakachu model, we were able to predict 1731 loops, 77% (1338/1731) of which can be validated by Hi-C predicted loops (Fig. <xref rid="Fig6" ref-type="fig">6d</xref>). The majority of SPRITE loops in this dataset (66%, 1140 of 1731) are within 250 kb, potentially due to the sparsity of the contact map. Compared with Hi-C, loops identified in SPRITE have lower convergent CTCF ratios (Fig. <xref rid="Fig6" ref-type="fig">6e</xref>) but have similar percentages of interactions between cis-regulatory elements (Fig. <xref rid="Fig6" ref-type="fig">6f</xref>). To further validate the SPRITE loops predicted by Peakachu, we compared them with four orthogonal types of data, including CTCF ChIA-PET, RAD21 ChIA-PET, SMC1 HiChIP, and H3K27ac HiChIP datasets, and found that 85% (1475/1731) of SPRITE loops could be supported by at least one source (Supplementary Fig. <xref rid="MOESM1" ref-type="media">21</xref>).</p>
      <p id="Par36">Overall, these analyses show that a general data-driven framework can produce viable decision functions to classify loops in a platform-agnostic manner, especially for deeply sequenced contact maps.</p>
    </sec>
  </sec>
  <sec id="Sec11" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par37">Here we present Peakachu, a machine-learning framework to predict chromatin loops from genome-wide contact maps. To the best of our knowledge, all current loop detection algorithms are based on searching for statistically enriched interactions against a global or local background, and vary in choices of statistical model and background definitions<sup><xref ref-type="bibr" rid="CR21">21</xref>–<xref ref-type="bibr" rid="CR29">29</xref></sup>. By learning from enrichment-based platforms such as ChIA-PET/HiChIP or Capture Hi-C, Peakachu can detect high-quality loop interactions from genome-wide interaction data such as Hi-C and SPRITE, even at low sequencing depths.</p>
    <p id="Par38">In total, we tested five sets of interactions to train our model, including CTCF ChIA-PET, RAD21 ChIA-PET, Smc1 HiChIP, H3K27ac HiChIP, and promoter Capture Hi-C (Supplementary Figs. <xref rid="MOESM1" ref-type="media">22</xref> and <xref rid="MOESM1" ref-type="media">23</xref>). We noted that the CTCF ChIA-PET model predicts more long-range loops, while the H3K27ac HiChIP model predicts more short-range loops which link distal regulatory elements to their potential target genes. Examining the Random Forest feature importance, we found that the most important predictor in a CTCF model is the center pixel, while the H3K27ac model is additionally driven by lower-left pixels (Supplementary Fig. <xref rid="MOESM1" ref-type="media">24</xref>). We also noted that although Capture Hi-C is different from antibody-based assays, the models trained with Capture Hi-C also performs well and the results are comparable to models trained with ChIA-PET and HiChIP data (Supplementary Figs. <xref rid="MOESM1" ref-type="media">22</xref> and <xref rid="MOESM1" ref-type="media">23</xref>), suggesting that Peakachu is robust to different types of positive training dataset.</p>
    <p id="Par39">Further, one potential extension of this framework will be training with interactions from more orthogonal data types for the study of higher-order chromatin organization, such as HiFISH imaging data. To evaluate how many positive training data points needed to train a Peakachu model, we manually picked ~200 annotated loops (Supplementary Data <xref rid="MOESM5" ref-type="media">3</xref>) and found it was enough for Peakachu to train a model to perform genome-wide predictions (Supplementary Fig. <xref rid="MOESM1" ref-type="media">25</xref>), indicating that Peakachu is readily applicable to train a working model with only several hundred positive data points.</p>
    <p id="Par40">Since there have been data augmentation methods<sup><xref ref-type="bibr" rid="CR38">38</xref>,<xref ref-type="bibr" rid="CR54">54</xref></sup> to enhance the data resolution of Hi-C data, we evaluated whether they can help further improve the performance of Peakachu. For this purpose, we first down-sampled GM128787 Hi-C matrix at 1.5 and 10%, and then enhanced them genome-wide with Boost-HiC<sup><xref ref-type="bibr" rid="CR54">54</xref></sup>, a method based on detecting the shortest path on the contact graph. We observed that Boost-HiC can help Peakachu identify more loops compared with un-boosted Hi-C matrices (Supplementary Fig. <xref rid="MOESM1" ref-type="media">16</xref>). Depending on the augmentation rate, the overall validation rate of loops from boosted Hi-C matrices can be lower, which may be a reasonable trade-off depending on the design of the study.</p>
    <p id="Par41">By comparing the performance of Peakachu, HiCCUPS, and Fit-Hi-C, we found that although a large proportion of predictions are shared by all three methods, each method detects a unique set of chromatin loops with various distance distributions, CTCF binding, and validation ratios by orthogonal datasets. This result suggests that the complete set of chromatin loops might not follow the same interaction pattern and be captured by a single method. The major improvement of Peakachu is its robustness to sequencing depth, which makes it applicable for predicting chromatin loops in Hi-C data with only ~30 million intrachromosomal reads.</p>
    <p id="Par42">The number of techniques for chromosome conformation study continues to grow, and there are still platforms such as DNA SPRITE that lack dedicated algorithms for chromatin loop detection. Here we show the generalizability of our framework by demonstrating its performance in a DNA SPRITE data matrix. In future studies, we will apply Peakachu framework in more available platforms to investigate advantages and pitfalls of each technique in loop detecting and hope to unveil the complete picture of loop-level structure in mammalian genomes.</p>
  </sec>
  <sec id="Sec12">
    <title>Methods</title>
    <sec id="Sec13">
      <title>Peakachu Framework</title>
      <p id="Par43">Fitting a Peakachu model requires two components: a Hi-C matrix binned to 10 kb and an interaction list that defines a positive training set. For every interaction in the list, a corresponding 11 × 11 window centered at the interaction is collected from the Hi-C matrix. The ratio of the center pixel to the lower-left quadrant (P2LL) of this window is used as an indicator variable prior to training, and the minimum P2LL for the positive class is set to 0.1. In other words, samples from the input training list are rejected if their Hi-C value is less than 10% of the average value within the loop. After collecting the positive class, a comparable number of windows with random coordinates and nonzero centers are collected to define a negative class.</p>
      <p id="Par44">Each sample is decomposed into a vector of 2<italic>n</italic> + 1 features, where <italic>n</italic> is the radius of a sample’s feature space. With <italic>n</italic> = 5, 243 features are constructed from 11×11 windows. One hundred and twenty-one of these represent the values of each pixel in an 11 × 11 window. Another 121 represent the relative ranks of each pixel within the window. A final variable, P2LL, is appended to each vector of features. Using scikit-learn, the training set is then used as input to fit a random forest of 100 decision trees and each tree is trained on a random combination of 15–20 features. To avoid the overfitting problem, the whole dataset is split into a separate training and test dataset in a chromosome-wise manner, i.e., 22 chromosomes are used to train a model that is used to make final predictions in 1 hold-out chromosome. Therefore, the final predicted loops would never be used/seen during training. During the training, we use a 3-fold cross-validation grid search to find the optimal hyperparameters (including splitting criterion, maximum tree depth and class weights) that yield a satisfying generalization performance. Matthew’s Correlation Coefficient is used as the primary metric for selecting the best model.</p>
      <p id="Par45">Trained models can be applied to contact maps of the same platform as the training matrix. Peakachu defines feature vectors for all nonzero pixels within a given genomic span, and scores each using the predict_proba method provided by the scikit-learn library. Usually, highly scored pixels are found grouped together, and only one representative pixel is reported from each cluster. To select representative pixels, we developed a greedy algorithm entailing two steps: first, define 1D loop anchor regions enriched for highly scored (<italic>P</italic> &gt; 0.9) pixels, then run DBSCAN between any two connected anchor regions. The identification of the loop-enriched anchors was performed by counting the candidate pixels and finding peaks along the chromosomes. Specifically, we applied the find_peaks and peak_widths functions from Python’s Scipy package to locate the peak summits and estimate the peak widths, respectively.</p>
    </sec>
    <sec id="Sec14">
      <title>Performance test of different machine-learning frameworks</title>
      <p id="Par46">To train a model best separating defined training sets, we tested 6 machine-learning frameworks implemented in scikit-learn: Gaussian Naïve Bayes, Perceptron, Logistic Regression, SVM (linear kernel), SVM (rbf kernel) and Random Forest. All frameworks used a similar strategy described above to train a model for each chromosome independently using data from the rest of the 22 chromosomes. Except for Gaussian Naïve Bayes, we used the same grid search approach to find the optimal hyperparameters for all frameworks during the training. Below are hyperparameters tuned for each framework:<list list-type="order"><list-item><p id="Par47">Perceptron: penalty/regularization and class weights</p></list-item><list-item><p id="Par48">Logistic Regression: penalty, C (inverse of regularization strength), class weights and the Elastic-Net mixing parameter</p></list-item><list-item><p id="Par49">SVM (linear kernel): the loss function, C and class weights</p></list-item><list-item><p id="Par50">SVM (rbf kernel): C and class weights</p></list-item><list-item><p id="Par51">Random Forest: splitting criterion, maximum tree depth and class weights</p></list-item></list></p>
      <p id="Par52">The prediction performance of each framework was measured by Matthews Correlation Coefficient (MCC), Accuracy (ACC), Receiver Operating Characteristic (ROC) Curves and Area Under the ROC curve (AUC). As shown in the Supplementary Fig. <xref rid="MOESM1" ref-type="media">27</xref>, Random Forest achieved best prediction performance and consumed relatively less training time for both CTCF and H3K27ac training sets used in this study.</p>
    </sec>
    <sec id="Sec15">
      <title>Peakachu probability tuning</title>
      <p id="Par53">Since Peakachu models are standard random forests, the assigned probability value for each pixel can be used as a filtering criterion. Lowering the probability threshold always generates more loops with less ChIA-PET/HiChIP dataset support, while higher probability thresholds achieve fewer but better-quality loops. For most predictions in GM12878 of this work, we set the cutoff to 0.97 and 0.92 for the CTCF model and the H3K27ac model, respectively. In Supplementary Fig. <xref rid="MOESM1" ref-type="media">17a, b</xref>, the probability was tuned to obtain a similar number of loops as the model trained with 90% of Hi-C reads. Similarly, in Supplementary Fig. <xref rid="MOESM1" ref-type="media">17c</xref>, the probability for the models trained with 90% or 1.5% of Hi-C reads was tuned according to the model trained with 10% of Hi-C reads. The cutoffs used in other cell lines are detailed in Supplementary Data <xref rid="MOESM4" ref-type="media">2</xref>.</p>
    </sec>
    <sec id="Sec16">
      <title>Loop detection with HiCCUPS and Fit-Hi-C</title>
      <p id="Par54">We used four kind of HiCCUPS settings in this work: (1) When comparing with Peakachu and Fit-Hi-C, we tuned the −f and −t parameters to make the number of loops uniquely predicted by each method similar. (2) When testing HiCCUPS performance on the down-sampled contact maps, we first ran HiCCUPS with the default parameters (Supplementary Fig. <xref rid="MOESM1" ref-type="media">14</xref>), which generally outputted less than 1/3 of the Peakachu loops at each down-sample rate. (3) We also tuned the parameters to make HiCCUPS detect a similar number of Peakachu loops with 100% Hi-C reads and then applied identical parameters (−f 0.37 −t 1.4,1,1,1) to the rest of the down-sample rates (Supplementary Fig. <xref rid="MOESM1" ref-type="media">15</xref>). (4) At the 1.5% down-sample rate (~30 million reads), no loops could be detected even with the lenient parameters used in (3); therefore, we further tuned the parameters to −f 0.9 −t 3.6,1,1,1 and identified 655 loops (Supplementary Fig. <xref rid="MOESM1" ref-type="media">16</xref>).</p>
      <p id="Par55">Fit-Hi-C was run on the 10 kb Hi-C matrices with the following settings: −p 2 −m 10 −U 3,000,000 -L 50,000. The results of the 2nd spline pass were then filtered with the q-value cutoff &lt; 1e-5 (Supplementary Fig. <xref rid="MOESM1" ref-type="media">8a</xref>). To make a fair comparison with Peakachu and HiCCUPS on the 100% matrix, we sorted the detected interactions by p-values and performed the same pooling algorithm used by Peakachu. At the 1.5% down-sample rate, we changed the q-value cutoff to 0.1 because no interactions remained with q-value &lt; 1e-5.</p>
    </sec>
    <sec id="Sec17">
      <title>Down-sample Hi-C reads to a specified ratio</title>
      <p id="Par56">The contact maps were down-sampled using a binomial probability without re-mapping. For the down-sample rate <italic>α</italic> (0&lt;<italic>α&lt;1</italic>), we iterated each nonzero pixel in the full contact matrix <bold>M</bold><sub><italic>ij</italic></sub> and designated the count frequency a random integer number generated from a binomial distribution of parameters <bold>M</bold><sub><italic>ij</italic></sub> and <italic>α</italic>, where <bold>M</bold><sub><italic>ij</italic></sub> is the contact count of the 100% Hi-C matrix between bin <italic>i</italic> and bin <italic>j</italic>.</p>
    </sec>
    <sec id="Sec18">
      <title>Enrichment analysis of TFs and histone modifications</title>
      <p id="Par57">To validate that Peakachu loops can also involve factors other than CTCF and H3K27ac, we downloaded the ENCODE ChIP-Seq peak files for 133 transcription factors (TFs) and 10 histone modifications in GM12878. Then a fold enrichment score was calculated for each TF or histone modification at loop anchors. Briefly, we first identified non-redundant loop anchors from Peakachu-predicted loops in GM12878. For each TF or histone modification, we iterated this anchor list and counted the number of anchors that overlapped at least one ChIP-Seq peak. Then we randomly shuffled the loops to generate 50 controls and repeated the same procedure for each control. For every control, the genomic distance distribution and the number of random loops on each chromosome stayed the same, and the interval between the two ends of each random loop did not overlap any gaps in the reference genome (hg19). Finally, the fold enrichment score was calculated by dividing the number of anchors containing ChIP-Seq peaks by the average number of random loci containing ChIP-Seq peaks (Fig. <xref rid="Fig2" ref-type="fig">2f</xref>).</p>
    </sec>
    <sec id="Sec19">
      <title>Reporting summary</title>
      <p id="Par58">Further information on research design is available in the <xref rid="MOESM6" ref-type="media">Nature Research Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec20">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2020_17239_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2020_17239_MOESM2_ESM.pdf">
            <caption>
              <p>Description of Additional Supplementary Files</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41467_2020_17239_MOESM3_ESM.xlsx">
            <caption>
              <p>Supplementary Data 1</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="41467_2020_17239_MOESM4_ESM.xlsx">
            <caption>
              <p>Supplementary Data 2</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="41467_2020_17239_MOESM5_ESM.xlsx">
            <caption>
              <p>Supplementary Data 3</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="41467_2020_17239_MOESM6_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec21">
        <title>Source data</title>
        <p id="Par61">
          <media position="anchor" xlink:href="41467_2020_17239_MOESM7_ESM.xlsx" id="MOESM7">
            <caption>
              <p>Source Data</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <fn-group>
    <fn>
      <p><bold>Peer review information</bold><italic>Nature Communications</italic> thanks Raphael Mourad and the other, anonymous, reviewer(s) for their contribution to the peer review of this work.</p>
    </fn>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>These authors contributed equally: Tarik J. Salameh, Xiaotao Wang.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> is available for this paper at 10.1038/s41467-020-17239-9.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This work was supported by NIH grants R35GM124820, R01HG009906, U01CA200060, and R24DK106766 to F.Y. We want to thank Drs. Job Dekker, William Noble, and the rest of 4D Nucleome Project Joint Analysis Workgroup for the discussion and suggestions. We thank Drs. Job Dekker and Oliver Rando’s group (Liyan Yang, Nils Krietenstein, Sergey Venev, Johan Gibcus) for the Micro-C and Hi-C data in H1ESC cells (funded by DK107980), Dr. Keji Zhao for the TrAC-loop data in GM12878 cells, and Dr. Bing Ren’s group for the H3K4me3 PLAC-Seq data in GM12878 cells.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>T.S. and X.W. implemented the Peakachu software and performed the analysis. F.Y. designed and supervised the project. F.S., B.Z., S.M.W., and C.K. contributed to data analysis. Y.R.’s group generated the ChIA-PET data. T.S., X.W., and F.Y. wrote the manuscript with input from all the authors.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>All datasets used in this work are summarized in Supplementary Data <xref rid="MOESM3" ref-type="media">1</xref>. The Hi-C contact maps of GM12878 and K562 were obtained from ftp://cooler.csail.mit.edu/coolers/hg19/. The DNA SPRITE contact map for GM12878 was obtained from 4DN data portal with accession code <ext-link ext-link-type="uri" xlink:href="https://data.4dnucleome.org/files-processed/4DNFIUOOYQC3/">4DNFIUOOYQC3</ext-link>. The Hi-C contact map of H1-ESC was obtained from 4DN data portal with accession code <ext-link ext-link-type="uri" xlink:href="https://data.4dnucleome.org/files-processed/4DNFI6HDY7WZ/">4DNFI6HDY7WZ</ext-link>. The Micro-C contact map of H1-ESC was obtained from 4DN data portal with accession code <ext-link ext-link-type="uri" xlink:href="https://data.4dnucleome.org/files-processed/4DNFI9GMP2J8/">4DNFI9GMP2J8</ext-link>. The CTCF ChIA-PET interactions in GM12878 were obtained from Tang et al.<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>. The Rad21 ChIA-PET interactions in GM12878 were obtained from Heidari et al.<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>. The SMC1 HiChIP interactions in GM12878 were obtained from Mumbach et al.<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>. The H3K27ac HiChIP interactions in GM12878 were obtained from Mumbach et al.<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>. The promoter Capture Hi-C interactions in GM12878 were obtained from Cairns et al.<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>. The CTCF ChIA-PET interactions in K562 were obtained from ENCODE with accession code <ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/files/ENCFF001THV/">ENCFF001THV</ext-link>. The SMC1 HiChIP interactions in mouse ESC were obtained from Mumbach et al.<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>. The CTCF ChIA-PET interactions in H1-ESC were obtained from 4DN data portal with accession code <ext-link ext-link-type="uri" xlink:href="https://data.4dnucleome.org/experiment-set-replicates/4DNESR9S8R38/">4DNESR9S8R38</ext-link>. All aforementioned positive training datasets can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/tariks/peakachu/tree/master/training-sets">https://github.com/tariks/peakachu/tree/master/training-sets</ext-link>. The enhancer and promoter loci in GM12878, K562, H1-ESC, and mouse ESC were extracted from public ChromHMM annotations in ENCODE and can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/tariks/peakachu/tree/master/analysis/annotations">https://github.com/tariks/peakachu/tree/master/analysis/annotations</ext-link>. The genome-wide CTCF motifs in human and mouse were obtained from <ext-link ext-link-type="uri" xlink:href="https://bcm.app.box.com/v/juicerawsmirror/folder/11363582187">https://bcm.app.box.com/v/juicerawsmirror/folder/11363582187</ext-link>. The predicted chromatin loops in 56 Hi-C datasets can be downloaded from the 3D Genome Browser (<ext-link ext-link-type="uri" xlink:href="http://3dgenome.org">http://3dgenome.org</ext-link>). Source data are provided with this paper.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>We used cooler 0.8.5 to store and extract contact matrices. We used Juicer 1.11.09 for HiCCUPS loop detections. For Fit-Hi-C, we used the version 2.0.7. We used deeptools 3.1.3 to generate the heatmaps in Supplementary Fig. <xref rid="MOESM1" ref-type="media">7</xref>. We used hicpeaks 0.3.4 to generate APA plots. The peakachu source code, the down-sampling script, the interaction pooling scripts and the pretrained models are available in GitHub under the MIT License: <ext-link ext-link-type="uri" xlink:href="https://github.com/tariks/peakachu">https://github.com/tariks/peakachu</ext-link>.</p>
  </notes>
  <notes id="FPar1" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par59">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gibcus</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>The hierarchy of the 3D genome</article-title>
        <source>Mol. Cell</source>
        <year>2013</year>
        <volume>49</volume>
        <fpage>773</fpage>
        <lpage>782</lpage>
        <?supplied-pmid 23473598?>
        <pub-id pub-id-type="pmid">23473598</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Spielmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lupianez</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Mundlos</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Structural variation in the 3D genome</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>453</fpage>
        <lpage>467</lpage>
        <?supplied-pmid 29692413?>
        <pub-id pub-id-type="pmid">29692413</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dixon</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrative detection and analysis of structural variation in cancer genomes</article-title>
        <source>Nat. Genet.</source>
        <year>2018</year>
        <volume>50</volume>
        <fpage>1388-+</fpage>
        <?supplied-pmid 30202056?>
        <pub-id pub-id-type="pmid">30202056</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fudenberg</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Formation of chromosomal domains by loop extrusion</article-title>
        <source>Cell Rep.</source>
        <year>2016</year>
        <volume>15</volume>
        <fpage>2038</fpage>
        <lpage>2049</lpage>
        <?supplied-pmid 27210764?>
        <pub-id pub-id-type="pmid">27210764</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sanborn</surname>
            <given-names>AL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Chromatin extrusion explains key features of loop and domain formation in wild-type and engineered genomes</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2015</year>
        <volume>112</volume>
        <fpage>E6456</fpage>
        <lpage>E6465</lpage>
        <?supplied-pmid 26499245?>
        <pub-id pub-id-type="pmid">26499245</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lieberman-Aiden</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive mapping of long-range interactions reveals folding principles of the human genome</article-title>
        <source>Science</source>
        <year>2009</year>
        <volume>326</volume>
        <fpage>289</fpage>
        <lpage>293</lpage>
        <?supplied-pmid 2858594?>
        <pub-id pub-id-type="pmid">19815776</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rippe</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kleckner</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Capturing chromosome conformation</article-title>
        <source>Science</source>
        <year>2002</year>
        <volume>295</volume>
        <fpage>1306</fpage>
        <lpage>1311</lpage>
        <?supplied-pmid 11847345?>
        <pub-id pub-id-type="pmid">11847345</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rao</surname>
            <given-names>SSP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A 3D map of the human genome at kilobase resolution reveals principles of chromatin looping</article-title>
        <source>Cell</source>
        <year>2014</year>
        <volume>159</volume>
        <fpage>1665</fpage>
        <lpage>1680</lpage>
        <?supplied-pmid 25497547?>
        <pub-id pub-id-type="pmid">25497547</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nagano</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparison of Hi-C results using in-solution versus in-nucleus ligation</article-title>
        <source>Genome Biol.</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>175</fpage>
        <?supplied-pmid 26306623?>
        <pub-id pub-id-type="pmid">26306623</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hsieh</surname>
            <given-names>TH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping nucleosome resolution chromosome folding in Yeast by Micro-C</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>162</volume>
        <fpage>108</fpage>
        <lpage>119</lpage>
        <?supplied-pmid 26119342?>
        <pub-id pub-id-type="pmid">26119342</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fullwood</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An oestrogen-receptor-alpha-bound human chromatin interactome</article-title>
        <source>Nature</source>
        <year>2009</year>
        <volume>462</volume>
        <fpage>58</fpage>
        <lpage>64</lpage>
        <?supplied-pmid 19890323?>
        <pub-id pub-id-type="pmid">19890323</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fang</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping of long-range chromatin interactions by proximity ligation-assisted ChIP-seq</article-title>
        <source>Cell Res.</source>
        <year>2016</year>
        <volume>26</volume>
        <fpage>1345</fpage>
        <lpage>1348</lpage>
        <?supplied-pmid 27886167?>
        <pub-id pub-id-type="pmid">27886167</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mumbach</surname>
            <given-names>MR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HiChIP: efficient and sensitive analysis of protein-directed genome architecture</article-title>
        <source>Nat. Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <fpage>919</fpage>
        <lpage>922</lpage>
        <?supplied-pmid 27643841?>
        <pub-id pub-id-type="pmid">27643841</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hughes</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Analysis of hundreds of cis-regulatory landscapes at high resolution in a single, high-throughput experiment</article-title>
        <source>Nat. Genet.</source>
        <year>2014</year>
        <volume>46</volume>
        <fpage>205</fpage>
        <lpage>212</lpage>
        <?supplied-pmid 24413732?>
        <pub-id pub-id-type="pmid">24413732</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mifsud</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping long-range promoter contacts in human cells with high-resolution capture Hi-C</article-title>
        <source>Nat. Genet.</source>
        <year>2015</year>
        <volume>47</volume>
        <fpage>598</fpage>
        <lpage>606</lpage>
        <?supplied-pmid 25938943?>
        <pub-id pub-id-type="pmid">25938943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beagrie</surname>
            <given-names>RA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Complex multi-enhancer contacts captured by genome architecture mapping</article-title>
        <source>Nature</source>
        <year>2017</year>
        <volume>543</volume>
        <fpage>519</fpage>
        <lpage>524</lpage>
        <?supplied-pmid 28273065?>
        <pub-id pub-id-type="pmid">28273065</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lai</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Trac-looping measures genome structure and chromatin accessibility</article-title>
        <source>Nat. Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>741</fpage>
        <lpage>747</lpage>
        <?supplied-pmid 30150754?>
        <pub-id pub-id-type="pmid">30150754</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quinodoz</surname>
            <given-names>SA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Higher-order inter-chromosomal hubs shape 3D genome organization in the nucleus</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>174</volume>
        <fpage>744</fpage>
        <lpage>757</lpage>
        <?supplied-pmid 29887377?>
        <pub-id pub-id-type="pmid">29887377</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Super-resolution imaging of higher-order chromatin structures at different epigenomic states in single mammalian cells</article-title>
        <source>Cell Rep.</source>
        <year>2018</year>
        <volume>24</volume>
        <fpage>873</fpage>
        <lpage>882</lpage>
        <?supplied-pmid 30044984?>
        <pub-id pub-id-type="pmid">30044984</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shachar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pegoraro</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Misteli</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>HIPMap: a high-throughput imaging method for mapping spatial gene positions</article-title>
        <source>Cold Spring Harb. Symp. Quant. Biol.</source>
        <year>2015</year>
        <volume>80</volume>
        <fpage>73</fpage>
        <lpage>81</lpage>
        <?supplied-pmid 26472748?>
        <pub-id pub-id-type="pmid">26472748</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ay</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Bailey</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>Statistical confidence estimation for Hi-C data reveals regulatory chromatin contacts</article-title>
        <source>Genome Res.</source>
        <year>2014</year>
        <volume>24</volume>
        <fpage>999</fpage>
        <lpage>1011</lpage>
        <?supplied-pmid 24501021?>
        <pub-id pub-id-type="pmid">24501021</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Forcato</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparison of computational methods for Hi-C data analysis</article-title>
        <source>Nat. Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>679</fpage>
        <lpage>685</lpage>
        <?supplied-pmid 28604721?>
        <pub-id pub-id-type="pmid">28604721</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durand</surname>
            <given-names>NC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Juicer provides a one-click system for analyzing loop-resolution Hi-C experiments</article-title>
        <source>Cell Syst.</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>95</fpage>
        <lpage>98</lpage>
        <?supplied-pmid 27467249?>
        <pub-id pub-id-type="pmid">27467249</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CTCF-mediated human 3D genome architecture reveals chromatin topology for transcription</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>163</volume>
        <fpage>1611</fpage>
        <lpage>1627</lpage>
        <?supplied-pmid 26686651?>
        <pub-id pub-id-type="pmid">26686651</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ChIA-PET tool for comprehensive chromatin interaction analysis with paired-end tag sequencing</article-title>
        <source>Genome Biol.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R22</fpage>
        <?supplied-pmid 20181287?>
        <pub-id pub-id-type="pmid">20181287</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Phanstiel</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Boyle</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Heidari</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>MP</given-names>
          </name>
        </person-group>
        <article-title>Mango: a bias-correcting ChIA-PET analysis pipeline</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>3092</fpage>
        <lpage>3098</lpage>
        <?supplied-pmid 26034063?>
        <pub-id pub-id-type="pmid">26034063</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Juric</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MAPS: Model-based analysis of long-range chromatin interactions from PLAC-seq and HiChIP experiments</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2019</year>
        <volume>15</volume>
        <fpage>e1006982</fpage>
        <?supplied-pmid 30986246?>
        <pub-id pub-id-type="pmid">30986246</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cairns</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CHiCAGO: robust detection of DNA looping interactions in Capture Hi-C data</article-title>
        <source>Genome Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>127</fpage>
        <?supplied-pmid 27306882?>
        <pub-id pub-id-type="pmid">27306882</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ben Zouari</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Molitor</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Sikorska</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pancaldi</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Sexton</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>ChiCMaxima: a robust and simple pipeline for detection and visualization of chromatin looping in Capture Hi-C</article-title>
        <source>Genome Biol.</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>102</fpage>
        <?supplied-pmid 31118054?>
        <pub-id pub-id-type="pmid">31118054</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Betel</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Koppal</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Agius</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sander</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Leslie</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive modeling of microRNA targets predicts functional non-conserved and non-canonical sites</article-title>
        <source>Genome Biol.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R90</fpage>
        <?supplied-pmid 20799968?>
        <pub-id pub-id-type="pmid">20799968</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoffman</surname>
            <given-names>MM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Unsupervised pattern discovery in human chromatin structure through genomic segmentation</article-title>
        <source>Nat. Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>473</fpage>
        <lpage>476</lpage>
        <?supplied-pmid 22426492?>
        <pub-id pub-id-type="pmid">22426492</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ernst</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kellis</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>ChromHMM: automating chromatin-state discovery and characterization</article-title>
        <source>Nat. Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>215</fpage>
        <lpage>216</lpage>
        <?supplied-pmid 22373907?>
        <pub-id pub-id-type="pmid">22373907</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Troyanskaya</surname>
            <given-names>OG</given-names>
          </name>
        </person-group>
        <article-title>Predicting effects of noncoding variants with deep learning-based sequence model</article-title>
        <source>Nat. Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>931</fpage>
        <lpage>934</lpage>
        <?supplied-pmid 26301843?>
        <pub-id pub-id-type="pmid">26301843</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rieber</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mahony</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>miniMDS: 3D structural inference from high-resolution Hi-C data</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <fpage>i261</fpage>
        <lpage>i266</lpage>
        <?supplied-pmid 28882003?>
        <pub-id pub-id-type="pmid">28882003</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reconstructing spatial organizations of chromosomes through manifold learning</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>e50</fpage>
        <?supplied-pmid 29408992?>
        <pub-id pub-id-type="pmid">29408992</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Singh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Póczos</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Predicting enhancer-promoter interaction from genomic sequence with deep neural networks</article-title>
        <source>Quant. Biol.</source>
        <year>2019</year>
        <volume>7</volume>
        <fpage>122</fpage>
        <lpage>137</lpage>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Constructing 3D interaction maps from 1D epigenomes</article-title>
        <source>Nat. Commun.</source>
        <year>2016</year>
        <volume>7</volume>
        <fpage>10812</fpage>
        <?supplied-pmid 26960733?>
        <pub-id pub-id-type="pmid">26960733</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Enhancing Hi-C data resolution with deep convolutional neural network HiCPlus</article-title>
        <source>Nat. Commun.</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>750</fpage>
        <?supplied-pmid 29467363?>
        <pub-id pub-id-type="pmid">29467363</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heidari</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide map of regulatory interactions in the human genome</article-title>
        <source>Genome Res.</source>
        <year>2014</year>
        <volume>24</volume>
        <fpage>1905</fpage>
        <lpage>1917</lpage>
        <?supplied-pmid 25228660?>
        <pub-id pub-id-type="pmid">25228660</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mumbach</surname>
            <given-names>MR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Enhancer connectome in primary human cells identifies target genes of disease-associated DNA elements</article-title>
        <source>Nat. Genet</source>
        <year>2017</year>
        <volume>49</volume>
        <fpage>1602</fpage>
        <lpage>1612</lpage>
        <?supplied-pmid 28945252?>
        <pub-id pub-id-type="pmid">28945252</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weintraub</surname>
            <given-names>AS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>YY1 is a structural regulator of enhancer-promoter loops</article-title>
        <source>Cell</source>
        <year>2017</year>
        <volume>171</volume>
        <fpage>1573-+</fpage>
        <?supplied-pmid 29224777?>
        <pub-id pub-id-type="pmid">29224777</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Phillips-Cremins</surname>
            <given-names>JE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Architectural protein subclasses shape 3D organization of genomes during lineage commitment</article-title>
        <source>Cell</source>
        <year>2013</year>
        <volume>153</volume>
        <fpage>1281</fpage>
        <lpage>1295</lpage>
        <?supplied-pmid 23706625?>
        <pub-id pub-id-type="pmid">23706625</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Narendra</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Bulajic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mazzoni</surname>
            <given-names>EO</given-names>
          </name>
          <name>
            <surname>Reinberg</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>CTCF-mediated topological boundaries during development foster appropriate gene regulation (vol 30, pg 2657, 2016)</article-title>
        <source>Gene Dev.</source>
        <year>2017</year>
        <volume>31</volume>
        <fpage>1714</fpage>
        <lpage>1714</lpage>
        <?supplied-pmid 28947498?>
        <pub-id pub-id-type="pmid">28947498</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schoenfelder</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fraser</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Long-range enhancer-promoter contacts in gene expression control</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>437</fpage>
        <lpage>455</lpage>
        <?supplied-pmid 31086298?>
        <pub-id pub-id-type="pmid">31086298</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bailey</surname>
            <given-names>SD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ZNF143 provides sequence specificity to secure chromatin interactions at gene promoters</article-title>
        <source>Nat. Commun.</source>
        <year>2015</year>
        <volume>2</volume>
        <fpage>6186</fpage>
        <?supplied-pmid 25645053?>
        <pub-id pub-id-type="pmid">25645053</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eagen</surname>
            <given-names>KP</given-names>
          </name>
          <name>
            <surname>Aiden</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Kornberg</surname>
            <given-names>RD</given-names>
          </name>
        </person-group>
        <article-title>Polycomb-mediated chromatin loops revealed by a subkilobase-resolution chromatin interaction map</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2017</year>
        <volume>114</volume>
        <fpage>8764</fpage>
        <lpage>8769</lpage>
        <?supplied-pmid 28765367?>
        <pub-id pub-id-type="pmid">28765367</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pollard</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Hubisz</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Rosenbloom</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Siepel</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Detection of nonneutral substitution rates on mammalian phylogenies</article-title>
        <source>Genome Res.</source>
        <year>2010</year>
        <volume>20</volume>
        <fpage>110</fpage>
        <lpage>121</lpage>
        <?supplied-pmid 19858363?>
        <pub-id pub-id-type="pmid">19858363</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The 4D nucleome project</article-title>
        <source>Nature</source>
        <year>2017</year>
        <volume>549</volume>
        <fpage>219</fpage>
        <lpage>226</lpage>
        <?supplied-pmid 28905911?>
        <pub-id pub-id-type="pmid">28905911</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Selvaraj</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>J</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Bansal</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Whole-genome haplotype reconstruction using proximity-ligation and shotgun sequencing</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2013</year>
        <volume>31</volume>
        <fpage>1111</fpage>
        <lpage>1118</lpage>
        <?supplied-pmid 24185094?>
        <pub-id pub-id-type="pmid">24185094</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rao</surname>
            <given-names>SSP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cohesin loss eliminates all loop domains</article-title>
        <source>Cell</source>
        <year>2017</year>
        <volume>171</volume>
        <fpage>305−+</fpage>
        <?supplied-pmid 28985562?>
        <pub-id pub-id-type="pmid">28985562</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bonev</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiscale 3D genome rewiring during mouse neural development</article-title>
        <source>Cell</source>
        <year>2017</year>
        <volume>171</volume>
        <fpage>557</fpage>
        <lpage>572</lpage>
        <?supplied-pmid 29053968?>
        <pub-id pub-id-type="pmid">29053968</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davis</surname>
            <given-names>CA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Encyclopedia of DNA elements (ENCODE): data portal update</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>D794</fpage>
        <lpage>D801</lpage>
        <?supplied-pmid 29126249?>
        <pub-id pub-id-type="pmid">29126249</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krietenstein</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ultrastructural details of mammalian chromosome architecture</article-title>
        <source>Mol. Cell</source>
        <year>2020</year>
        <volume>78</volume>
        <fpage>554</fpage>
        <lpage>565</lpage>
        <?supplied-pmid 32213324?>
        <pub-id pub-id-type="pmid">32213324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carron</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Morlot</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Matthys</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Lesne</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mozziconacci</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Boost-HiC: computational enhancement of long-range contacts in chromosomal contact maps</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <fpage>2724</fpage>
        <lpage>2729</lpage>
        <?supplied-pmid 30615061?>
        <pub-id pub-id-type="pmid">30615061</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
