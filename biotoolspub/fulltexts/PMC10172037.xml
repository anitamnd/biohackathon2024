<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10172037</article-id>
    <article-id pub-id-type="pmid">37086439</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad278</article-id>
    <article-id pub-id-type="publisher-id">btad278</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Systems Biology</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ICAT: a novel algorithm to robustly identify cell states following perturbations in single-cell transcriptomes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Hawkins</surname>
          <given-names>Dakota Y</given-names>
        </name>
        <aff><institution>Bioinformatics Program, Boston University</institution>, <addr-line>24 Cummington Mall</addr-line>, Boston, MA 02215, <country country="US">United States</country></aff>
        <aff><institution>Biology Department, Boston University</institution>, <addr-line>24 Cummington Mall</addr-line>, Boston, MA 02215, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zuch</surname>
          <given-names>Daniel T</given-names>
        </name>
        <aff><institution>Biology Department, Boston University</institution>, <addr-line>24 Cummington Mall</addr-line>, Boston, MA 02215, <country country="US">United States</country></aff>
        <aff><institution>Program in Molecular and Cellular Biology and Biochemistry, Boston University</institution>, <addr-line>24 Cummington Mall</addr-line>, Boston, MA 02215, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huth</surname>
          <given-names>James</given-names>
        </name>
        <aff><institution>Biology Department, Boston University</institution>, <addr-line>24 Cummington Mall</addr-line>, Boston, MA 02215, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rodriguez-Sastre</surname>
          <given-names>Nahomie</given-names>
        </name>
        <aff><institution>Biology Department, Boston University</institution>, <addr-line>24 Cummington Mall</addr-line>, Boston, MA 02215, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>McCutcheon</surname>
          <given-names>Kelley R</given-names>
        </name>
        <aff><institution>Biology Department, Boston University</institution>, <addr-line>24 Cummington Mall</addr-line>, Boston, MA 02215, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Glick</surname>
          <given-names>Abigail</given-names>
        </name>
        <aff><institution>Biology Department, Boston University</institution>, <addr-line>24 Cummington Mall</addr-line>, Boston, MA 02215, <country country="US">United States</country></aff>
        <aff><institution>Program in Molecular and Cellular Biology and Biochemistry, Boston University</institution>, <addr-line>24 Cummington Mall</addr-line>, Boston, MA 02215, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lion</surname>
          <given-names>Alexandra T</given-names>
        </name>
        <aff><institution>Biology Department, Boston University</institution>, <addr-line>24 Cummington Mall</addr-line>, Boston, MA 02215, <country country="US">United States</country></aff>
        <aff><institution>Program in Molecular and Cellular Biology and Biochemistry, Boston University</institution>, <addr-line>24 Cummington Mall</addr-line>, Boston, MA 02215, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Thomas</surname>
          <given-names>Christopher F</given-names>
        </name>
        <aff><institution>Biology Department, Boston University</institution>, <addr-line>24 Cummington Mall</addr-line>, Boston, MA 02215, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Descoteaux</surname>
          <given-names>Abigail E</given-names>
        </name>
        <aff><institution>Biology Department, Boston University</institution>, <addr-line>24 Cummington Mall</addr-line>, Boston, MA 02215, <country country="US">United States</country></aff>
        <aff><institution>Program in Molecular and Cellular Biology and Biochemistry, Boston University</institution>, <addr-line>24 Cummington Mall</addr-line>, Boston, MA 02215, <country country="US">United States</country></aff>
        <aff><institution>Biological Design Center, Boston University</institution>, <addr-line>610 Commonwealth Ave</addr-line>, Boston, MA 02215, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6247-6595</contrib-id>
        <name>
          <surname>Johnson</surname>
          <given-names>William Evan</given-names>
        </name>
        <aff><institution>Bioinformatics Program, Boston University</institution>, <addr-line>24 Cummington Mall</addr-line>, Boston, MA 02215, <country country="US">United States</country></aff>
        <aff><institution>Division of Computational Biomedicine, Boston University School of Medicine</institution>, <addr-line>715 Albany St.</addr-line>, Boston, MA 02118, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8309-5807</contrib-id>
        <name>
          <surname>Bradham</surname>
          <given-names>Cynthia A</given-names>
        </name>
        <aff><institution>Bioinformatics Program, Boston University</institution>, <addr-line>24 Cummington Mall</addr-line>, Boston, MA 02215, <country country="US">United States</country></aff>
        <aff><institution>Biology Department, Boston University</institution>, <addr-line>24 Cummington Mall</addr-line>, Boston, MA 02215, <country country="US">United States</country></aff>
        <aff><institution>Program in Molecular and Cellular Biology and Biochemistry, Boston University</institution>, <addr-line>24 Cummington Mall</addr-line>, Boston, MA 02215, <country country="US">United States</country></aff>
        <aff><institution>Biological Design Center, Boston University</institution>, <addr-line>610 Commonwealth Ave</addr-line>, Boston, MA 02215, <country country="US">United States</country></aff>
        <xref rid="btad278-cor1" ref-type="corresp"/>
        <!--cbradham@bu.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Martelli</surname>
          <given-names>Pier Luigi</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad278-cor1">Corresponding author. Bioinformatics Program, Boston University, Boston, MA, USA. E-mail: <email>cbradham@bu.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-04-22">
      <day>22</day>
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>5</issue>
    <elocation-id>btad278</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>9</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>10</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>11</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>10</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad278.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The detection of distinct cellular identities is central to the analysis of single-cell RNA sequencing (scRNA-seq) experiments. However, in perturbation experiments, current methods typically fail to correctly match cell states between conditions or erroneously remove population substructure. Here, we present the novel, unsupervised algorithm Identify Cell states Across Treatments (ICAT) that employs self-supervised feature weighting and control-guided clustering to accurately resolve cell states across heterogeneous conditions.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Using simulated and real datasets, we show ICAT is superior in identifying and resolving cell states compared with current integration workflows. While requiring no a priori knowledge of extant cell states or discriminatory marker genes, ICAT is robust to low signal strength, high perturbation severity, and disparate cell type proportions. We empirically validate ICAT in a developmental model and find that only ICAT identifies a perturbation-unique cellular response. Taken together, our results demonstrate that ICAT offers a significant improvement in defining cellular responses to perturbation in scRNA-seq data.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p><ext-link xlink:href="https://github.com/BradhamLab/icat" ext-link-type="uri">https://github.com/BradhamLab/icat</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Science Foundation Integrative Organismal Systems</institution>
          </institution-wrap>
        </funding-source>
        <award-id>1656752</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>From deconstructing tumor cell compositions (<xref rid="btad278-B28" ref-type="bibr">Schelker et al. 2017</xref>), to reconstructing developmental pathways (<xref rid="btad278-B36" ref-type="bibr">Wagner et al. 2018</xref>), single-cell RNA sequencing (scRNA-seq) has revolutionized scientists’ ability to explore complex tissues and systems. Clustering of individual cells is central to the analysis of scRNA-seq data, in which cell states are identified by grouping cells with similar gene expression profiles (<xref rid="btad278-B18" ref-type="bibr">Luecken and Theis 2019</xref>). Whether to ascertain the effect of drug treatment on cancer viability or to infer the mechanistic role of a given gene in tissue specification, perturbation experiments have long been used to dissect and understand complex biological systems. Oftentimes, this analysis is formalized by identifying changes in the abundance of cell states between treatments (<xref rid="btad278-B8" ref-type="bibr">Haber et al. 2017</xref>; <xref rid="btad278-B14" ref-type="bibr">Kang et al. 2018</xref>; <xref rid="btad278-B18" ref-type="bibr">Luecken and Theis 2019</xref>). Inherently, such analyses are based on the assumption that cell states are readily identified and matched between treatments. Recently, graph-based community detection algorithms such as the Louvain and Leiden methods have become best practice for identifying cell states in single-condition scRNA-seq datasets (<xref rid="btad278-B18" ref-type="bibr">Luecken and Theis 2019</xref>). However, these methods often fail to match identities in datasets containing perturbing treatments, which present particular difficulties due to dominating treatment effects (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>), where it is typical that scRNA-seq datasets segregate by treatments rather than cellular identities (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>), similar to the impact of batch effects (<xref rid="btad278-B14" ref-type="bibr">Kang et al. 2018</xref>; <xref rid="btad278-B18" ref-type="bibr">Luecken and Theis 2019</xref>; <xref rid="btad278-B13" ref-type="bibr">Kagohara et al. 2020</xref>; <xref rid="btad278-B16" ref-type="bibr">Lähnemann et al. 2020</xref>). This challenge presents significant difficulties in correctly evaluating cellular responses to perturbation in scRNA-seq experiments.</p>
    <p>Common techniques for identifying cell states in scRNA-seq perturbation experiments rely on either reference datasets to map cells onto known cell states (<xref rid="btad278-B25" ref-type="bibr">Regev et al. 2017</xref>; <xref rid="btad278-B27" ref-type="bibr">Schaum et al. 2018</xref>), identifying cell states via known marker gene expression (Kang et al. 2017), or the use of an integration algorithm to minimize differences between control and perturbed cells by transforming cells into a shared space prior to clustering cells (<xref rid="btad278-B18" ref-type="bibr">Luecken and Theis 2019</xref>; <xref rid="btad278-B20" ref-type="bibr">Perillo et al. 2020</xref>). The first scenario is problematic for nonmodel systems, where such atlases may not exist, and along with marker gene analysis, is inappropriate when the goal of a given experiment is discovery of novel cell states or subtypes; for these reasons, the latter approach is often preferred. Toward that end, scRNA-seq algorithms have been developed that broadly integrate heterogeneous datasets (<xref rid="btad278-B10" ref-type="bibr">Hie et al. 2019</xref>; <xref rid="btad278-B18" ref-type="bibr">Luecken and Theis 2019</xref>; <xref rid="btad278-B31" ref-type="bibr">Stuart and Satija 2019</xref>). Originally developed to remove batch effects (<xref rid="btad278-B9" ref-type="bibr">Haghverdi et al. 2018</xref>), many of the most widely used integration algorithms work by matching mutual nearest neighbors between batches in order to learn nonlinear transformations that minimize neighbor distance in an embedded space (<xref rid="btad278-B9" ref-type="bibr">Haghverdi et al. 2018</xref>; <xref rid="btad278-B10" ref-type="bibr">Hie et al. 2019</xref>; <xref rid="btad278-B15" ref-type="bibr">Korsunsky et al. 2019</xref>; <xref rid="btad278-B31" ref-type="bibr">Stuart and Satija 2019</xref>). While useful for removing technical variation from datasets, integration algorithms are unable to discriminate technical from biological noise: thus, their use may be inappropriate when biological differences exist between samples, such that a one-to-one correspondence between cell states cannot be assumed. This difficulty is reinforced by recent findings which show that integration methods often smooth over and eliminate biologically meaningful signals, leading to incorrect cell state identification and possibly wholesale erasure of real cell states (<xref rid="btad278-B4" ref-type="bibr">Büttner et al. 2019</xref>; <xref rid="btad278-B18" ref-type="bibr">Luecken and Theis 2019</xref>; <xref rid="btad278-B35" ref-type="bibr">Tyler et al. 2021</xref>; <xref rid="btad278-B17" ref-type="bibr">Luecken et al. 2022</xref>).</p>
    <p>We therefore developed a two-step algorithm to robustly and sensitively Identify Cell states Across Treatments (ICAT) in scRNA-seq data. In contrast to integration approaches that minimize differences between samples, ICAT uses a novel approach that relies on self-supervised feature selection and control-guided clustering to identify cell states using biologically relevant features. While other methods exist to either identify shared clusters between treatments (<xref rid="btad278-B1" ref-type="bibr">Barron et al. 2018</xref>) or to leverage sparse features (<xref rid="btad278-B11" ref-type="bibr">Hua et al. 2020</xref>), to our knowledge, ICAT is the only method capable of doing both while also handling multiple experimental conditions. Our results show that by emphasizing cell state-defining genes, ICAT reliably identifies cell states across scRNA-seq perturbation experiments with high accuracy. Unlike marker-based approaches, ICAT is able to discover novel cell states, making perturbation analysis in under-studied systems feasible. Importantly, ICAT does not require prior knowledge of marker genes or extant cell states, is robust to perturbation severity, identifies cell states with higher accuracy than leading integration workflows with both simulated and real scRNA-seq perturbation experiments, and operates reliably at low signal resolutions.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 ICAT algorithm overview</title>
      <p>To overcome the inability of current clustering algorithms to accurately detect cell states in perturbation experiments (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>), we developed a two-step algorithm (<xref rid="btad278-F1" ref-type="fig">Fig. 1A</xref>). The purpose of the first step is to determine the cluster-defining features and weight them among the control cells alone. The goal of the second step is to use those feature weights to co-cluster the controls and the perturbed cells together, effectively assigning the perturbed cells to control clusters. Perturbed cells may also be optionally clustered separately to determine their feature weights to detect cell states that are asymmetrically present in the perturbed condition. Using the Louvain method (<xref rid="btad278-B3" ref-type="bibr">Blondel et al. 2008</xref>) by default, the first step separately clusters control cells to produce initial cluster labels for each cell. Cluster labels are then used to weight genes by their ability to predict the previously generated labels using Neighborhood Component Feature Selection (NCFS) (<xref rid="btad278-B37" ref-type="bibr">Yang et al. 2012</xref>). NCFS weights genes by using gradient ascent to maximize a regularized leave-one-out classification accuracy metric. By the nature of regularization, most gene weights converge to zero, leaving only the most predictive genes with weights &gt;1. Applying the learned gene weights to the original expression matrix with both control and treated cells transforms the matrix into a “cluster-defined” space, where the distances between cells are dominated by highly weighted marker genes. After this transformation, ICAT retains previously identified cluster labels for control cells, then, in the second step, performs semisupervised Louvain community detection, whereby control labels are held immutable (<xref rid="btad278-F1" ref-type="fig">Fig. 1A</xref>) (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref> for details).</p>
      <fig position="float" id="btad278-F1">
        <label>Figure 1.</label>
        <caption>
          <p>Overview of the ICAT algorithm. (A) The schematic illustrates the ICAT<sub>C</sub> implementation of ICAT. To identify cell states across treatments, ICAT first performs self-supervised feature weighting to find genes that discriminate cell identities among control cells alone, followed by semisupervised clustering using the newly transformed expression matrix. To learn feature weights, ICAT clusters control cells using Louvain community detection, then uses the newly generated cluster labels as input into NCFS to weight genes by their predictiveness. After applying the learned gene weights to the original gene expression matrix, ICAT clusters both treated and control cells together using a semisupervised implementation of Louvain community detection. During this process, ICAT holds the previously identified cluster labels for the control cells immutable. (B) The schematic illustrates the ICAT<sub>C + T</sub> implementation, which expands feature weighting to treated cells to identify asymmetrical populations between treatments. Cells are split along treatments and independently clustered using the Louvain method; then, cluster labels are used to learn gene weights using NCFS in each treatment set independently. To retain asymmetrically informative genes, weights for each treatment are concatenated row wise and subsequently reduced to the maximum weight using a row-wise maxpool function. The reduced weight vector is then used to transform the original count matrix.</p>
        </caption>
        <graphic xlink:href="btad278f1" position="float"/>
      </fig>
      <p>This strategy achieves three goals: (i) Because NCFS is a sparse method, it overtly separates informative and noninformative genes, making it possible to cluster directly on cell-state defining genes while simultaneously removing likely sources of biological noise. (ii) ICAT produces easily interpretable results by clustering on the expression patterns of a few, highly weighted genes. This is a noted benefit over typical integration methods, where transformations are obscured behind neighbor-based approaches (<xref rid="btad278-B10" ref-type="bibr">Hie et al. 2019</xref>; <xref rid="btad278-B31" ref-type="bibr">Stuart and Satija 2019</xref>). (iii) ICAT makes comparing treatment effects on cell states straightforward. By implementing semisupervised clustering with immutable control labels, ICAT ensures cell states discovered in control cells are retained when treated cells are introduced, alleviating concerns of artifact-induced cell states upon integration due to erroneously grouping cells. These three features together produce interpretable results that ease compositional analysis between treatments.</p>
      <p>While similar in approach, ICAT provides several advantages compared with identifying shared cell states via marker gene mapping: first, ICAT does not require previously known marker genes, making ICAT appropriate for situations with previously uncharacterized cell states. Second, by clustering control and treated cells together, ICAT takes advantage of the structure in both datasets compared with clustering both independently. This alleviates issues with imperfect matches between marker genes. Third, by foregoing common marker gene presence–absence comparisons to map cell types, ICAT accurately identifies activated states, which is otherwise difficult. Finally, by generating cell state labels through a clustering step rather than a classification approach, ICAT is able to group cells with treatment-specific phenotypes and identify out-of-sample states.</p>
      <p>One caveat of our approach is that if asymmetrical populations exist in treated cells, but not controls, their identifying genes will likely be collapsed by the control-only feature-weighting step. Depending on the preferred cell-state resolution, this may or may not be desirable. To account for both resolution levels, researchers can choose to perform feature-weighting in all treatment types to identify asymmetrical populations in each condition (<xref rid="btad278-F1" ref-type="fig">Figs 1B</xref>, <xref rid="btad278-F2" ref-type="fig">2A</xref>, and <xref rid="btad278-F3" ref-type="fig">3A</xref>). To reduce gene weights to a single gene-weight vector, only the maximum gene weight among the conditions is retained. During semisupervised clustering, labels for control cells are retained during label initialization, while treated cells are reinitialized as singleton clusters.</p>
      <fig position="float" id="btad278-F2">
        <label>Figure 2.</label>
        <caption>
          <p>ICAT correctly identifies cell states in distinct experimental compositions. (A) UMAP projections of different cellular compositions in simulated datasets. Each dot represents a cell with circles representing control cells and crosses denoting treated cells. Dots are colored by ground truth identity (left column), cluster label produced by performing Louvain community detection on the raw count matrix (middle column), and clusters labeled produced by ICAT (right column). (B) Average agreement between ground truth label and cluster labels produced by clustering the raw data (blue) and ICAT (orange) as measured by the ARI. Error bars represent the 95% CIs for the mean ARI for each method. Five different cellular composition conditions were simulated: “All same,” both control and treated cells share the same two cell states; “Rx Unique,” treated cells contain a treatment-unique cell state; “Control Unique,” control cells contain a unique cell state; “Both Unique,” both treated and control cells contain treatment-specific cell states; and “None Same,” no shared cell states between treated and control cells. Each condition was simulated 15 times (<italic toggle="yes">n</italic> = 15). Simulations were evaluated using the ICAT<sub>C</sub> implementation.</p>
        </caption>
        <graphic xlink:href="btad278f2" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>2.2 Data simulation</title>
      <p>To assess ICAT, we initially tested performance in simulated scRNA-seq data (<xref rid="btad278-F2" ref-type="fig">Figs 2A</xref> and <xref rid="btad278-F3" ref-type="fig">3A–E</xref>). We simulated data using a zero-inflated Negative Binomial distribution to model gene counts per <xref rid="btad278-B4" ref-type="bibr">Büttner et al. (2019)</xref> (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref> for details). To simulate perturbations and apply system-wide disruptions to gene expression patterns, we randomly selected genes as perturbation targets and subsequently sampled scalar multipliers from a <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mo>Γ</mml:mo><mml:mo>(</mml:mo><mml:mn>2,2</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula> distribution to alter average expression values for each disrupted gene. To generate distinct cell types, we randomly selected a separate set of genes to act as markers for each population. Selected marker genes had their average expression shifted by a scalar multiplier following a <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mo>Γ</mml:mo><mml:mo>(</mml:mo><mml:mn>3,3</mml:mn><mml:mo>)</mml:mo><mml:mo> </mml:mo></mml:math></inline-formula>distribution to create population substructure.</p>
      <fig position="float" id="btad278-F3">
        <label>Figure 3.</label>
        <caption>
          <p>ICAT outperforms current methods for cell state identification and is robust to experimental conditions. (A) UMAP projections of raw (left), ICAT<sub>C</sub> processed (middle), and ICAT<sub>C+T</sub> processed count matrices for the simulated data. Projections show ICAT<sub>C</sub> and ICAT<sub>C + T</sub> correctly mix shared populations (red and green), whereas only ICAT<sub>C + T</sub> isolates asymmetrical populations (purple, yellow). ICAT performance for simulated data was further evaluated using the ICAT<sub>C + T</sub> implementation only. (B) Select marker and perturbed gene expression patterns are displayed as violin plots for three simulated control cell types (1–3) under normal (C) and perturbed (P) conditions. P(C1)+ is a stimulated and perturbed version of cell type 1; perturbation-specific cell types P4 and P5 express distinct marker genes. (C) The percentage of perturbed genes used to assess robustness to perturbation severity is shown; values range from 1% to 25%. (D) The average number of marker genes per cell identity used to assess robustness to signal strength is shown; values range from 10 to 105 (0.7%–7% of total genes). (E) The set of cell identity proportions used to test the ability to identify rare cell states is shown. The number of cells per treatment-label pair ranges from 50 to 175. (F) Method performance is compared as the fraction of perturbed genes increases (F1) and as the average number of marker genes per population increases (F2). Left panels display results for stand-alone methods: ICAT, No Int. Seurat, Scanorama, and Harmony; while right panels show results for ICAT-extended workflows: ICAT<sub>Seurat</sub>, ICAT<sub>Scan</sub>, and ICAT<sub>Harm</sub>. Results are depicted as averages with 95% CIs shown by shading. (G) Method performance is compared as the proportion of cell types is varied. The Gini coefficient reflects the degree of population size disproportion among cell states. Left panel: ICAT, Seurat, Scanorama, and Harmony. Right panel: ICAT<sub>Seurat</sub>, ICAT<sub>Scan</sub>, and ICAT<sub>Harm</sub>.</p>
        </caption>
        <graphic xlink:href="btad278f3" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>2.3 ICAT analysis in real datasets</title>
      <p>To assess ICAT’s ability to correctly cluster cells in real perturbation experiments, we made use of three publicly available datasets <xref rid="btad278-B14" ref-type="bibr">(Kang et al. 2018</xref>; <xref rid="btad278-B33" ref-type="bibr">Tian et al. 2019</xref>; <xref rid="btad278-B13" ref-type="bibr">Kagohara et al. 2020</xref>). While no true benchmark datasets currently exist for defining cell states in perturbation experiments, we selected datasets that either contain genotyped cell lines, or are from well-studied cell types with confidently labeled cells. Because NCFS feature-weighting is a computationally intensive task, and since the Kagohara and Kang datasets each contain &gt;20 000 cells, it was necessary to subselect cells for feature weighting (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). To this end, ICAT selects a representative sample of cells via submodular optimization using the <italic toggle="yes">apricot</italic><xref rid="btad278-B29" ref-type="bibr">(Schreiber et al. 2020</xref>) Python package. Submodular optimization via <italic toggle="yes">apricot</italic> was able to effectively represent the data space using only a small number of cells (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>).</p>
      <p>We further validate ICAT’s predictions <italic toggle="yes">in vivo</italic> using a newly generated sea urchin scRNA-seq dataset consisting of one control and two experimental conditions. Treatment-unique cell states were first identified using ICAT; then, empirically assessed using quantitative single-molecule fluorescence <italic toggle="yes">in situ</italic> hybridization (smFISH) to evaluate both the cell state-defining expression patterns and the predicted changes in relative cell state abundance between treatments.</p>
    </sec>
    <sec>
      <title>2.4 Benchmarking ICAT’s performance</title>
      <p>To benchmark ICAT against other general workflows for identifying cell states in multicondition scRNA-seq experiments, we compared four general approaches: (i) ICAT, (ii) integrating datasets across treatments followed by clustering cells via Louvain clustering, (iii) integrating datasets across treatments followed by clustering cells via ICAT, and (iv) naive clustering where we tested the “No Integration” scenario in which cells were clustered using Louvain clustering without accounting for treatment status (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>). Each workflow focuses on identifying cell states, making them intrinsically comparable despite algorithmic differences.</p>
      <p>In our evaluation, we tested three state-of-the-art integration methods: Seurat <xref rid="btad278-B26" ref-type="bibr">(Satija et al. 2015</xref>; <xref rid="btad278-B31" ref-type="bibr">Stuart and Satija 2019</xref>), Scanorama <xref rid="btad278-B10" ref-type="bibr">(Hie et al. 2019</xref>), and Harmony (<xref rid="btad278-B15" ref-type="bibr">Korsunsky et al. 2019</xref>). These methods were chosen due to their ubiquity in single-cell analysis, as well as their top performance in rigorous benchmarks comparisons (<xref rid="btad278-B17" ref-type="bibr">Luecken et al. 2022</xref>). Accordingly, we also evaluated clustering performance for three extended workflows: ICAT<sub>Seurat</sub>, ICAT<sub>Scan</sub>, and ICAT<sub>Harm</sub> whereby data from cells were first integrated using the respective integration algorithm prior to clustering with ICAT. While ICAT is relatively robust to parameter choice (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>), we used standardized nearest neighbor and resolution parameters for each method during clustering for appropriate comparisons (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>).</p>
      <p>When evaluating cell state labels produced in simulated experiments, we considered three criteria reflecting reliable clustering between control and treated cells: (i) Global label conservation: to ensure cluster labels accurately reflect the underlying biology, we used the Adjusted Rand Index (ARI) to measure the extent of mapping between cluster labels and known cell states (<xref rid="btad278-B12" ref-type="bibr">Hubert and Arabie 1985</xref>). (ii) Treatment mixing: the local homogeneity of shared cell types without undo isolation by treatment status was assessed with the Local Inverse Simpson’s Index (LISI; <xref rid="btad278-B15" ref-type="bibr">Korsunsky et al. 2019</xref>); (iii) Unique label separation: the accurate detection of populations of interest was measured using population-specific F1 measures (<xref rid="btad278-B17" ref-type="bibr">Luecken et al. 2022</xref>). Such metrics were used to measure the ability to accurately detect asymmetric populations that exist only in single conditions (F1-Unique), the ability to discriminate stimulated cell states from nonstimulated analogs (F1-Stim), and the identification of rare cell types (F1-Rare). ARI, LISI, and all F1 metrics were standardized between 0 and 1, where 1 indicated stronger performance.</p>
      <p>Because cell state is resolution dependent and likely imperfect in real datasets <xref rid="btad278-B18" ref-type="bibr">(Luecken and Theis 2019</xref>; <xref rid="btad278-B16" ref-type="bibr">Lähnemann et al. 2020</xref>), when evaluating performance using real data, we also calculated the label-free Davies–Bouldin (DB) metric to assess the density of clusters produced by each method <xref rid="btad278-B6" ref-type="bibr">(Davies and Bouldin 1979</xref>). The DB metric measures similarity between a cluster and the next most similar cluster. To facilitate comparison, each score was scaled between 0 and 1 such that 1 represents better clustering, whereas 0 represents worse clustering.</p>
    </sec>
    <sec>
      <title>2.5 Availability of data and materials</title>
      <p><italic toggle="yes">ICAT</italic>, <italic toggle="yes">ncfs</italic>, and <italic toggle="yes">sslouvain</italic> Python packages are freely available on pip and github (github.com/BradhamLab). Scripts to perform simulated data generation and benchmark comparisons are available as a SnakeMake workflow at (github.com/BradhamLab/ICAT_manuscript). Archived data files for both simulated and real data are also available at the same repository. The pipeline to align and quantify SMART-seq2 reads is freely available at (github.com/BradhamLab/scPipe), and the raw sequencing data are available at GEO accession GSE164240. Likewise, all scripts to segment primary mesenchyme cells (PMCs) and quantify HCR FISH signal are available at (github.com/BradhamLab/hcr_quantify) and the image data are available upon request.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 ICAT accurately clusters cells in perturbation experiments regardless of compositional asymmetries</title>
      <p>To validate the general ICAT workflow (<xref rid="btad278-F1" ref-type="fig">Fig. 1</xref>), we simulated data to compare ICAT to naively clustering cells using Louvain community detection without accounting for treatment status (<xref rid="btad278-F2" ref-type="fig">Fig. 2A</xref>). To initially validate the general approach of ICAT, we first performed a set of simple experiments consisting of equal size populations to compare ICAT to naive Louvain clustering (<xref rid="btad278-F2" ref-type="fig">Fig. 2A</xref>, top row). Subsequently, we tested four different simulated experiments with each condition consisting of a different number of shared and unique populations between control and treated cells (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). ICAT exhibited near-perfect clustering with ARI scores near 1 across five different simulated experiments (<xref rid="btad278-F2" ref-type="fig">Fig. 2B</xref>). Without accounting for the systematic noise introduced by perturbations, naive Louvain clustering erroneously separates cell states by treatment status (<xref rid="btad278-F2" ref-type="fig">Fig. 2A</xref>) and only produced accurate cluster labels when no shared cell states between control and treated cells existed (<xref rid="btad278-F2" ref-type="fig">Fig. 2B</xref>). These results not only demonstrate the necessity of accounting for treatment status while identifying cell states in perturbation experiments, but also provide validation for ICAT’s novel approach.</p>
    </sec>
    <sec>
      <title>3.2 ICAT is robust to perturbation severity and better resolves cell states at lower resolutions than leading integration workflows</title>
      <p>To further challenge ICAT’s ability to robustly detect cell states in more complex scenarios, we simulated five populations of cells: three that are present in both control and treated cells, with one of these exhibiting elevated marker gene expression upon treatment and referred to as “stimulated” (population C1 and P(C1)+), and two treatment-only populations (populations P4 and P5) (<xref rid="btad278-F3" ref-type="fig">Fig. 3A</xref> and <xref rid="btad278-F3" ref-type="fig">B</xref>). These populations were simulated under varying conditions to assess ICAT’s robustness to perturbation severity, degree of cell state separation, and different population abundances.</p>
      <p>We first assessed ICAT’s robustness against increasing perturbation severity, testing five conditions with varying proportions of perturbed genes, ranging from 1% to 25% (<xref rid="btad278-F3" ref-type="fig">Fig. 3C</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>). Next, we assessed performance with changing resolutions between cell states by simulating 10 different experimental conditions with a varying number of average marker genes per cell type. Mean marker gene numbers ranged from 10 to 105 per population (0.67%–7.0% of total genes) (<xref rid="btad278-F3" ref-type="fig">Fig. 3D</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>). In both cases, each experiment was simulated 15 times, for a total of 90 independent datasets in the first case (<xref rid="btad278-F3" ref-type="fig">Fig. 3C</xref>) and 150 in the second case (<xref rid="btad278-F3" ref-type="fig">Fig. 3D</xref>). Finally, to test performance as cell type proportions deviate from equality, we simulated three different experimental conditions with varying distributions of each cell type. Experiments ranged from the most similar, with all cell types having 100 cells per treatment, to the most disparate where the minimum and maximum population size per treatment were 50 and 150, respectively (<xref rid="btad278-F3" ref-type="fig">Fig. 3E</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref>). To isolate the effect of differential cell abundance, proportion simulations did not include an activated cell type, and instead were composed of three shared populations and two treatment-unique populations (<xref rid="btad278-F3" ref-type="fig">Fig. 3E</xref>).</p>
      <p>When we tested perturbation severity or variable numbers of marker genes (<xref rid="btad278-F3" ref-type="fig">Fig. 3C and D</xref>), ICAT outperformed both Scanorama and Seurat across all metrics while exhibiting highly stable performance across both increasing perturbation intensities and at varying cell-state resolutions (<xref rid="btad278-F3" ref-type="fig">Fig. 3F</xref>). ICAT provides near-perfect treatment mixing, with LISI scores nearing 1 for all signal levels. In contrast, Scanorama and Seurat only approach 0.5 LISI scores at the highest signal levels. Harmony generally produces higher LISI scores than both Scanorama and Seurat, but displays significant performance loss as perturbation severity increases, while failing to match ICAT performance across cells state resolutions, indicating that ICAT exhibits a substantially improved ability to correctly and robustly mix cell states across treatments, even at low signal levels at which the standard integration algorithms fail (<xref rid="btad278-F3" ref-type="fig">Fig. 3F</xref>).</p>
      <p>Scanorama offered comparable performance to ICAT in global label conservation (ARI) and in the ability to detect asymmetrical populations (F1-Unique) (<xref rid="btad278-F3" ref-type="fig">Fig. 3F</xref>), while ICAT was uniformly better at accurately distinguishing the stimulated population from its nonstimulated analog (<xref rid="btad278-F3" ref-type="fig">Fig. 3F</xref>, F1-Stim). Seurat underperformed both Scanorama and ICAT in label conservation and asymmetrical population detection (ARI, F1-Unique), and offered comparable treatment-mixing performance to Scanorama (LISI), indicating that Seurat does not accurately separate known populations relative to Scanorama or ICAT (<xref rid="btad278-F3" ref-type="fig">Fig. 3F</xref>). Harmony displayed inconsistent performance, showcasing dependence on both perturbation severity and marker gene abundance to correctly identify asymmetrical populations (F1-Stim, F1-Unique).</p>
      <p>For each of the perturbation severity tests and with low marker gene numbers, Seurat and Harmony were surprisingly outperformed by the no-integration scenario for ARI (<xref rid="btad278-F3" ref-type="fig">Fig. 3F</xref>) which can be explained by both methods’ poor identification of asymmetrical populations (F1-Unique and F1-Stim, respectively) reflecting a general under-clustering of cells (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>). Scanorama exhibited a similar drop in ARI performance at low marker numbers, but consistently outperformed no integration (<xref rid="btad278-F3" ref-type="fig">Fig. 3F</xref>). These results show ICAT more accurately and robustly resolves cell states across experimental conditions than either Seurat or Scanorama integration workflows.</p>
    </sec>
    <sec>
      <title>3.3 ICAT most accurately detects rare populations</title>
      <p>ICAT was unaffected by differences in cell state proportions as assessed by global and rare population label conservation via ARI and the F1-Rare metric, respectively, while each integration approach exhibited decreased performance as the disparity in proportions increased (<xref rid="btad278-F3" ref-type="fig">Fig. 3G</xref>, left). The performance of ICAT was robust and stronger than Scanorama, Seurat, and Harmony in each measure.</p>
    </sec>
    <sec>
      <title>3.4 ICAT improves and stabilizes the performance of integration workflows</title>
      <p>Clustering cells in integrated datasets with ICAT, in lieu of traditional Louvain community detection, produced overall higher quality clusters compared with standard integration workflows. Compared with the typical Seurat and Harmony workflows, ICAT<sub>Seurat</sub> and ICAT<sub>Harm</sub> led to significant improvements in all three simulated experiments, leading to greater robustness to perturbation (<xref rid="btad278-F1" ref-type="fig">Fig. 3F1</xref>, left), increased signal sensitivity (<xref rid="btad278-F2" ref-type="fig">Fig. 3F2</xref>, left), and better isolation of rare cells (<xref rid="btad278-F3" ref-type="fig">Fig. 3G</xref>, right). When compared with Scanorama, ICAT<sub>Scan</sub> better isolated rare cells (<xref rid="btad278-F3" ref-type="fig">Fig. 3G</xref>, right), and improved performance in some metrics in perturbation and signal experiments. Gains were more modest compared with ICAT<sub>Seurat</sub> and ICAT<sub>Harm</sub>, primarily since Scanorama with Louvain clustering already exhibits strong performance (<xref rid="btad278-F3" ref-type="fig">Fig. 3F1 and F2</xref>, left). In particular, ICAT<sub>Scan</sub> substantially improved treatment-mixing (LISI) across conditions compared with Scanorama with Louvain (<xref rid="btad278-F1" ref-type="fig">Fig. 3F1</xref>, right). Interestingly, at both signal extremes, stand-alone ICAT scored higher in the F1-Stim metric than integration methods whether combined with Louvain or ICAT for clustering (<xref rid="btad278-F3" ref-type="fig">Fig. 3F2</xref>), indicating that ICAT preserves discriminatory signals better than either integration algorithm.</p>
      <p>In summary, the results from simulated data demonstrate that ICAT offers robust and accurate cell state identification that exceeds three current state-of-the-art integration algorithms, across a range of simulated conditions including severe perturbations, low marker gene numbers, and variations in relative cell abundance. Further analysis shows that identifying cell states with ICAT following integration produces higher quality clusters compared with current integration workflows alone. Thus, the novelty of using learned feature weights combined with control-guided clustering offers a significant performance improvement over state-of-the-art integration approaches in accurately defining the cellular compositions of single-cell datasets; moreover, the results show that, unlike integration approaches, ICAT’s performance is robust across a range of conditions.</p>
    </sec>
    <sec>
      <title>3.5 ICAT produces higher quality clusters in real datasets compared with integration methods</title>
      <p>To ensure ICAT produced clusters that accurately reflect known biological cell states, we evaluated ICAT in three separate real scRNA-seq datasets. We first used the CellMix dataset generated by <xref rid="btad278-B33" ref-type="bibr">Tian et al. (2019)</xref>. The dataset was produced by creating various mixtures of nine cells from combinations of H2228, HCC827, and H1975 adenocarcinoma cell lines, sequencing the cell mixtures, then downsampling the resulting counts to produce pseudocells that are in-line with true single-cell data. While the Tian dataset was developed to test integration across batch effects, we reasoned that variance introduced by batch effects offers an imperfect substitute for a perturbation. To better mimic distinct phenotypes, we selected only four cell “types,” consisting of pure H2228, HCC827, and H1975 cells, along with a single mixture with equal proportions of each cell line, denoted “Mixed” (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>). The second dataset from <xref rid="btad278-B13" ref-type="bibr">Kagohara et al. (2020)</xref> offers a simple perturbation experiment in which three genotyped cell lines of head and neck squamous carcinoma cells were treated with either PBS (control) or the chemotherapeutic cetuximab (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>). Finally, we assessed performance in a peripheral blood mononuclear cell dataset collected by <xref rid="btad278-B14" ref-type="bibr">Kang et al. (2018)</xref> with eight cell types in control and interferon-ß (IFN-β)-stimulated conditions (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>). Both the Tian and Kagohara datasets were chosen for having gold-standard cell labels via genotyping, while the Kang dataset was selected to include a more complex, but well studied, system with silver-standard cell labels identified via known marker genes. Prior to analysis, each dataset was preprocessed by normalizing cell counts and selecting highly variable genes using <italic toggle="yes">Scanpy</italic>. To ensure each tested algorithm analyzed the same input data, we provided the same <italic toggle="yes">Scanpy</italic> preprocessed data to each method.</p>
      <p>In the Tian dataset, ICAT outperformed Seurat and Scanorama in LISI and DB metrics and was comparable to both in ARI, where Harmony and Seurat scored highest (<xref rid="btad278-F4" ref-type="fig">Fig. 4A and B</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>). ICAT outperformed all three integration methods in the Kagohara and Kang datasets (<xref rid="btad278-F4" ref-type="fig">Fig. 4A and B</xref>). Aside from ARI in the Kagohara dataset, in which Scanorama and ICAT scored equally well (<xref rid="btad278-F4" ref-type="fig">Fig. 4B</xref>), ICAT produced the highest scores for ARI, LISI, and DB metrics (<xref rid="btad278-F4" ref-type="fig">Fig. 4B</xref>). Overall, ICAT generated higher quality clusters in real datasets compared with existing integration algorithms (<xref rid="btad278-F4" ref-type="fig">Fig. 4A</xref> and <xref rid="btad278-F4" ref-type="fig">B</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>).</p>
      <fig position="float" id="btad278-F4">
        <label>Figure 4.</label>
        <caption>
          <p>ICAT outperforms current integration methods in identifying cell states across treatments in real datasets. scRNA-seq data from Tian, Kagohara, and Kang studies is compared. (A) Spider plots compare the performance for each algorithm within each dataset for ARI, LISI, and DB quality metrics. (B) Lollipop plots highlight the differences in the metrics for each method across the same datasets. (C) Spider plots comparing Seurat to ICAT<sub>Seurat</sub>, Scanorama to ICAT<sub>Scan</sub>, and Harmony to ICAT<sub>Harm</sub>, respectively. All metrics are scaled from 0 to 1, where 1 is best (closest to the apex of each corner). DB, Davies–Bouldin metric, and otherwise as in <xref rid="btad278-F2" ref-type="fig">Fig. 2</xref>. ICAT performance for the Tian dataset was evaluated using the ICAT<sub>C + T</sub> implementation, whereas Kagohara and Kang datasets were evaluated using the ICAT<sub>C</sub> implementation.</p>
        </caption>
        <graphic xlink:href="btad278f4" position="float"/>
      </fig>
      <p>Compared with Scanorama, ICAT<sub>Scan</sub> led to greater ARI, LISI, and DB scores across the three analyzed datasets (<xref rid="btad278-F4" ref-type="fig">Fig. 4C and</xref><xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>), aside from ARI in the Kagohara dataset where Scanorama and ICAT<sub>Scan</sub> scored equally well (<xref rid="btad278-F4" ref-type="fig">Fig. 4C</xref>). For Seurat and Harmony, ICAT<sub>Seurat</sub> and ICAT<sub>Harm</sub> resulted in improvements that exhibit dataset and metric dependence. ICAT<sub>Seurat</sub> and ICAT<sub>Harm</sub> more readily identified cell states in the Kagohara dataset, shown by the dramatic increase in ARI scores, and clusters were tighter and better separated as shown by large increases in DB scores (<xref rid="btad278-F4" ref-type="fig">Fig. 4C</xref>). In contrast, ARI scores were maintained or marginally reduced compared with traditional Seurat + Louvain or Harmony + Louvain workflows for the Tian and Kang datasets. The results demonstrate that ICAT offers a marked improvement in cell state identification in multicondition scRNA-seq experiments compared with the current integration workflows Seurat, Harmony, and Scanorama. Thus, the performance of ICAT with real data is substantially improved compared with conventional integration + clustering workflows, in agreement with ICAT's performance in simulated data.</p>
    </sec>
    <sec>
      <title>3.6 ICAT alone accurately predicts subpopulation response to perturbation <italic toggle="yes">in vivo</italic></title>
      <p>To empirically test ICAT predictions on cell state compositions following perturbation, we generated scRNA-seq data using the SMART-Seq2 protocol (<xref rid="btad278-B23" ref-type="bibr">Picelli et al. 2014</xref>). Specifically, we isolated and sequenced the skeletogenic lineage in sea urchins known as primary mesenchyme cells (PMCs) at 18 h postfertilization to compare cells from control embryos and embryos subjected to chemical treatments that perturb skeletal patterning, specifically, MK-886 (MK) and chlorate (<xref rid="btad278-B24" ref-type="bibr">Pidgeon et al. 2007</xref>; <xref rid="btad278-B22" ref-type="bibr">Piacentino et al. 2016</xref>; <xref rid="btad278-B30" ref-type="bibr">Simionato et al. 2021</xref>). PMCs are of interest because this population of cells receives patterning cues during development that cause their diversification into subsets; since MK and chlorate each perturb distinct patterning cues, we reasoned that these differences would be reflected in PMC subpopulation composition (<xref rid="btad278-B19" ref-type="bibr">Lyons et al. 2014</xref>; <xref rid="btad278-B32" ref-type="bibr">Sun and Ettensohn 2014</xref>; <xref rid="btad278-B21" ref-type="bibr">Piacentino et al. 2015</xref>, <xref rid="btad278-B22" ref-type="bibr">2016</xref>). After quality control and cell filtering, we retained expression data for 435 cells (147 control, 134 MK886, and 154 chlorate-treated cells).</p>
      <p>ICAT clustered the combined PMC expression profiles into five distinct cell states (<xref rid="btad278-F5" ref-type="fig">Fig. 5A1</xref>). The impacts of MK exposure were more dramatic than those of chlorate (<xref rid="btad278-F5" ref-type="fig">Fig. 5A2</xref>), we therefore focused on the effects of MK. Two clusters showed stark compositional differences between control and MK-treated cells, in that Cluster 3 lacks MK cells compared with controls, while Clusters 2 and 4 show significant enrichment for MK cells (<italic toggle="yes">G</italic>-test FDR &lt; 0.05, <italic toggle="yes">post hoc</italic> Fisher’s Exact test FDR &lt; 0.05; <xref rid="btad278-F5" ref-type="fig">Fig. 5A2</xref> and <xref rid="btad278-F5" ref-type="fig">Supplementary</xref><xref rid="sup1" ref-type="supplementary-material">Tables S7 and S8</xref>). Since MK-treated cells dominated Cluster 4 such that it appears to be an asymmetric population, we more closely examined Clusters 3 and 4. Investigating highly predictive genes identified by ICAT found that Clusters 3 and 4 were distinguished by inverse expression of genes <italic toggle="yes">pks2</italic> and <italic toggle="yes">sm50</italic> (<xref rid="btad278-F5" ref-type="fig">Fig. 5A3</xref> and <xref rid="btad278-F5" ref-type="fig">A4</xref>), such that Cluster 3 displayed a <italic toggle="yes">sm50+/pks2</italic>− phenotype, while cluster 4 exhibited a reciprocal <italic toggle="yes">sm50</italic>−<italic toggle="yes">/pks2+</italic> pattern.</p>
      <fig position="float" id="btad278-F5">
        <label>Figure 5.</label>
        <caption>
          <p>ICAT most accurately defines subpopulation response to perturbation. SMART-seq2 was performed on cells isolated from controls or from embryos treated with the perturbants chlorate or MK-886. (A) ICAT predicts five clusters from the combined data (A1), with treatment-dependent subpopulation compositions (<italic toggle="yes">G</italic>-test likelihood test, FDR &lt; 0.05; ad-hoc pairwise Fisher’s Exact test, FDR &lt; 0.05) (A2). MK-induced differences are defined by reciprocal expression patterns of ICAT-identified genes, <italic toggle="yes">sm50</italic> and <italic toggle="yes">pks2</italic>, in subpopulations 3 (<italic toggle="yes">sm50+/pks2−</italic>) and 4 (<italic toggle="yes">sm50−/pks2+</italic>) (A3). (B) ICAT predictions for control (B1, B3) and MK-866 (B2, B4) are validated by HCR FISH analysis (B5, B6). Automated detection and segmentation of PMCs <italic toggle="yes">in vivo</italic> from 3D image data are shown as various colors; each color represents an individual cell (1–2). The expression of <italic toggle="yes">sm50</italic> (red) and <italic toggle="yes">pks2</italic> (cyan) transcripts are shown in the same embryos; arrowheads indicate PMCs that express only <italic toggle="yes">sm50</italic> or only <italic toggle="yes">pks2</italic> (3–4). MK-866 treated embryos exhibit statistically significantly fewer <italic toggle="yes">sm50+/pks2</italic>− PMCs (B5) and more <italic toggle="yes">sm50</italic>−<italic toggle="yes">/pks2+</italic> PMCs (B6) than controls, consistent with the predictions from ICAT (A). Dot plot error bars denote 95% CIs of the mean with each dot representing an individual embryo [<italic toggle="yes">n</italic><sub>DMSO </sub>= 26, <italic toggle="yes">n</italic><sub>MK886 </sub>= 37; B5 (Binomial GLM, μ<sub>DMSO</sub> = 3.59%, μ<sub>MK886</sub> = 1.91%; <italic toggle="yes">β</italic><sub>MK886</sub> = −0.71, <italic toggle="yes">P</italic> &lt; 10<sup>−3</sup>; B6 Binomial GLM, μ<sub>DMSO</sub> = 0.19%, μ<sub>MK886</sub> = 2.71%; β<sub>MK886</sub> = 2.60, <italic toggle="yes">P</italic> &lt; 10<sup>−4</sup>)]. (C) Seurat (C1) fails to find any treatment effect on PMC subpopulation composition, while Scanorama (C2), and Harmony (C3) predict one and two disrupted populations, respectively (<italic toggle="yes">G</italic>-test likelihood test, FDR &lt; 0.05; <italic toggle="yes">ad hoc</italic> pairwise Fisher’s Exact test, FDR &lt; 0.05).</p>
        </caption>
        <graphic xlink:href="btad278f5" position="float"/>
      </fig>
      <p>To empirically test ICAT’s predicted enrichment of the <italic toggle="yes">sm50−/pks2+</italic> cell state and depletion of <italic toggle="yes">sm50+/pks2</italic> cells in MK886-treated PMCs, we performed smFISH to quantify expression levels for both genes in DMSO (control) and MK-treated embryos (<xref rid="btad278-B5" ref-type="bibr">Choi et al. 2018</xref>; <xref rid="btad278-F5" ref-type="fig">Fig. 5B</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8</xref>). To accurately map FISH signals to PMCs, embryos were stained for PMCs using the PMC-specific 6a9 antibody. Using Ilastik (<xref rid="btad278-B2" ref-type="bibr">Berg et al. 2019</xref>), we trained a random forest classifier (out-of-bag error = 0.14) to predict and segment individual PMCs in each confocal image stack (<xref rid="btad278-F5" ref-type="fig">Fig. 5B1 and B2</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S9</xref>). Following methods for relative FISH quantification from the original paper (<xref rid="btad278-B5" ref-type="bibr">Choi et al. 2018</xref>), we calculated cell-level expression values for each PMC by first restricting fluorescence signal to PMC-labeled voxels, then calculated the average relative intensity for each gene in every PMC (<xref rid="btad278-F5" ref-type="fig">Fig. 5B3 and B4</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8</xref>). Across embryos, we labeled individual PMCs as <italic toggle="yes">sm50+</italic> or <italic toggle="yes">sm50−</italic> if their standardized <italic toggle="yes">sm50</italic> expression values were above the 75th or below the 25th percentiles of all PMCs, respectively (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S10</xref>). The procedure was repeated for <italic toggle="yes">pks2</italic> to determine <italic toggle="yes">pks2+</italic> and <italic toggle="yes">pks2−</italic> PMCs. We found that MK-treated embryos displayed both a significant loss of the <italic toggle="yes">sm50+/pks2−</italic> phenotype, as well as a significant enrichment of the <italic toggle="yes">sm50−/pks2+</italic> cell state relative to controls (adjusted <italic toggle="yes">P</italic> &lt; .05; <xref rid="btad278-F5" ref-type="fig">Fig. 5B5 and B6</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S9 and S10</xref>). These results empirically validate the ability of ICAT to correctly identify affected cell states in scRNA-seq datasets from perturbed samples.</p>
      <p>Integrating the PMC scRNA-seq data using Seurat, Scanorama, or Harmony failed to identify both <italic toggle="yes">sm50/pks2</italic>-defined cell states affected by MK-886 treatment (<xref rid="btad278-F5" ref-type="fig">Fig. 5C</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S11</xref>). In fact, Seurat failed to identify any dependence of cell state composition on treatment status (<italic toggle="yes">G</italic>-test FDR &gt; 0.05; <xref rid="btad278-F5" ref-type="fig">Fig. 5C1</xref>; <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S11A 1</xref> and <xref rid="sup1" ref-type="supplementary-material">B1</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S11</xref>). Scanorama, on the other hand, correctly identified the depletion of <italic toggle="yes">sm50+/pks2−</italic> PMCs in MK embryos (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S11B 2 and B3</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S12 and S13</xref>; <italic toggle="yes">G</italic>-test FDR &lt; 0.05, <italic toggle="yes">post hoc</italic> Fisher’s Exact test FDR &lt; 0.05), but importantly, failed to identify <italic toggle="yes">sm50−/pks2+</italic> enrichment in MK embryos (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S11B 2 and B3</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S12 and S13</xref>; <italic toggle="yes">G</italic>-test FDR &gt; 0.05). Conversely, Harmony correctly identified the enrichment of sm50−/pks2+ PMCs in MK embryos but lacked the sensitivity to identify the depletion of sm50+/pks2− cell states (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S11B 3</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S14 and S15</xref>; <italic toggle="yes">G</italic>-test FDR &lt; 0.05, <italic toggle="yes">post hoc</italic> Fisher’s Exact test FDR &lt; 0.05). ICAT is the only method among these four to correctly identify the cell-state specific <italic toggle="yes">sm50</italic> and <italic toggle="yes">pks2</italic> responses to MK exposure, which accounts for most of the differences in cell groupings between the methods (Jaccard similarity; <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S11C</xref>). Of the compared methods, Seurat failed to produce even qualitatively correct results since it did not identify any treatment-specific effects on PMCs (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S11A 2</xref>), contradicting the known disruptions to PMCs in response to disruption of the ALOX signaling pathways (<xref rid="btad278-B22" ref-type="bibr">Piacentino et al. 2016</xref>).</p>
    </sec>
    <sec>
      <title>3.7 ICAT-selected marker genes reflect underlying biology</title>
      <p>By leveraging weighted expression of learned cell state-defining genes, ICAT is able to more correctly label cells in mixed-condition scRNA-seq experiments compared with traditional integration workflows. A latent assumption in this process is the relative stability of marker genes in nontreatment-affected cell states between conditions. To test this assumption in real data, we performed differential expression (DE) analysis between treatments using MAST (<xref rid="btad278-B7" ref-type="bibr">Finak et al. 2015</xref>; <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S12</xref>). In the Tian and Kagohara datasets, none of the highly weighted genes were found to be DE (log<sub>2</sub> fc &gt; 1, FDR &lt; 0.05; <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S12</xref>), while only a single gene in the Kang dataset was considered DE when a looser log<sub>2</sub> fc threshold was applied (log<sub>2</sub> fc &gt; log<sub>2</sub>(1.5), FDR &lt; 0.05; <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S12</xref>). These results are consistent with the assumption of marker gene stability across perturbations. However, importantly, four marker genes were considered DE in the PMC dataset (log<sub>2</sub> fc &gt;1, FDR &lt; 0.05; <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S12</xref>); these genes contributed to ICAT’s ability to sensitively identify the verified sm50/pks2 perturbed cell states. These outcomes underline the robustness of ICAT when challenged by marker genes whose expression is variable. Together, these results demonstrate that ICAT’s novel combination of learned feature weighting combined with control-guided clustering significantly improves the computational capability to accurately detect and describe cellular responses to perturbation in scRNA-seq data compared with conventional integration workflows.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>One of the key promises of scRNA-seq technology is to more accurately define complex biological systems by offering a more finely resolved perspective on transcriptional landscapes than was previously possible. However, due to technical and biological noise, taking advantage of such a powerful tool in diverse biological conditions has proven to be challenging. We therefore developed the ICAT algorithm to improve the accuracy of cell state identification from scRNA-seq data that includes perturbation treatments. By combining sparse feature weighting with semisupervised Louvain community detection, ICAT not only correctly identifies shared and disparate cell states, but also produces interpretable results that aid in understanding analytical outcomes and selecting the most suitable downstream analyses.</p>
    <p>When comparing the performance of ICAT to state-of-the-art integration algorithms in simulated datasets, we found that ICAT performs more robustly in response to perturbation severity, readily identifies cell states at lower signal levels, better isolates asymmetrical and activated cell states, and more readily identifies rare cell populations when compared with Seurat, Scanorama, and Harmony. ICAT also outperforms the integration workflows in three benchmark datasets, further solidifying ICAT’s ability to better identify cell states across biological conditions compared with either integration method alone. By testing ICAT on datasets with &gt;20 000 cells (<xref rid="btad278-B14" ref-type="bibr">Kang et al. 2018</xref>; <xref rid="btad278-B13" ref-type="bibr">Kagohara et al. 2020</xref>), we demonstrated ICAT’s ability to analyze the large datasets, necessary for any practical scRNA-seq tool. Depending on the experimental system, researchers may still elect to use integration algorithms. Excitingly, the choice between ICAT and integration methods is not mutually exclusive; we show that following Seurat, Scanorama, or Harmony with ICAT produces higher quality clusters compared with either of these integration workflows alone.</p>
    <p>By experimentally validating two uniquely predicted cell states in a developmental model using single-molecule FISH, we empirically demonstrated that the capability of ICAT to accurately identify perturbed cell states surpasses current state-of-the-art integration workflows. ICAT was the only method among the four tested that correctly identified these distinct states and their perturbation responses, whereas integration workflows lacked the sensitivity to properly isolate both sm50/pks2 defined subpopulations, highlighting ICAT as a substantial advancement in identifying and describing cell state behaviors across biological conditions and perturbations.</p>
    <p>With the growing ubiquity of scRNA-seq experiments and the development of ever more sophisticated experimental designs, we anticipate that ICAT will play an important role in highly resolving cell state-specific responses to treatments and differing biological conditions. In the future, the ICAT framework can easily be extended to operate on other single-cell modalities, such as scATAC-seq, and will offer a potential route to intelligently cluster multimodal data from heterogeneous conditions.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad278_Supplementary_Data</label>
      <media xlink:href="btad278_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank Prof. Masanao Yajima (Department of Mathematics and Statistics, Boston University) for helpful discussions, Prof. Charles Ettensohn (Carnegie Mellon University, PA, USA) for the PMC antibody, Jose Ordovas-Montanes and Sanjay Prakadan of the Shalek lab (MIT) for help with scRNA-seq library preparation, and Dr Todd Blute for his advice and help with FACS and microscopy imaging.</p>
  </ack>
  <sec>
    <title>Author contributions</title>
    <p>The study was conceived by C.A.B. and D.Y.H. The computational work was performed by D.Y.H., with advice from W.E.J. J.H. and D.T.Z. collected the urchin scRNA-seq data. N.R.-S., C.F.T., K.R.M., A.T.L., and A.E.D. performed the imaging experiments. D.Y.H., K.R.M., and A.G. trained the PMC prediction model. The article was written by D.Y.H., C.A.B., D.T.Z., and N.R.-S., and edited by all coauthors.</p>
  </sec>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by National Science Foundation Integrative Organismal Systems (NSF IOS) [grant number 1656752 to C.A.B.]. K.R.M. and A.G. were partially supported by awards from the Undergraduate Research Opportunities Program (UROP) at Boston University, and A.E.D. was partially supported by an award from the Multicellular Design Program at Boston University.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad278-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Barron</surname><given-names>M</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>S</given-names></string-name>, <string-name><surname>Li</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>A sparse differential clustering algorithm for tracing cell type changes via single-cell RNA-sequencing data</article-title>. <source>Nucleic Acids Res</source><year>2018</year>;<volume>46</volume>:<fpage>e14</fpage>.<pub-id pub-id-type="pmid">29140455</pub-id></mixed-citation>
    </ref>
    <ref id="btad278-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Berg</surname><given-names>S</given-names></string-name>, <string-name><surname>Kutra</surname><given-names>D</given-names></string-name>, <string-name><surname>Kroeger</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>Ilastik: interactive machine learning for (bio)image analysis</article-title>. <source>Nat Methods</source><year>2019</year>;<volume>12</volume>:<fpage>1226</fpage>–<lpage>32</lpage>.</mixed-citation>
    </ref>
    <ref id="btad278-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Blondel</surname><given-names>VD</given-names></string-name>, <string-name><surname>Guillaume</surname><given-names>J-L</given-names></string-name>, <string-name><surname>Lambiotte</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Fast unfolding of communities in large networks</article-title>. <source>J Stat Mech</source><year>2008</year>;<volume>2008</volume>:<fpage>P10008</fpage>.</mixed-citation>
    </ref>
    <ref id="btad278-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Büttner</surname><given-names>M</given-names></string-name>, <string-name><surname>Miao</surname><given-names>Z</given-names></string-name>, <string-name><surname>Wolf</surname><given-names>FA</given-names></string-name></person-group><etal>et al</etal><article-title>A test metric for assessing single-cell RNA-seq batch correction</article-title>. <source>Nat Methods</source><year>2019</year>;<volume>16</volume>:<fpage>43</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">30573817</pub-id></mixed-citation>
    </ref>
    <ref id="btad278-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Choi</surname><given-names>HMT</given-names></string-name>, <string-name><surname>Schwarzkopf</surname><given-names>M</given-names></string-name>, <string-name><surname>Fornace</surname><given-names>ME</given-names></string-name></person-group><etal>et al</etal><article-title>Third-generation in situ hybridization chain reaction: multiplexed, quantitative, sensitive, versatile, robust</article-title>. <source>Development</source><year>2018</year>;<volume>145</volume>:<fpage>dev165753</fpage>.<pub-id pub-id-type="pmid">29945988</pub-id></mixed-citation>
    </ref>
    <ref id="btad278-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Davies</surname><given-names>DL</given-names></string-name>, <string-name><surname>Bouldin</surname><given-names>DW.</given-names></string-name></person-group><article-title>A cluster separation measure</article-title>. <source>IEEE Trans Pattern Anal Mach Intell</source><year>1979</year>; <volume>2</volume>:<fpage>224</fpage>–<lpage>7</lpage>.</mixed-citation>
    </ref>
    <ref id="btad278-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Finak</surname><given-names>G</given-names></string-name>, <string-name><surname>McDavid</surname><given-names>A</given-names></string-name>, <string-name><surname>Yajima</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>MAST: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing data</article-title>. <source>Genome Biol</source><year>2015</year>;<volume>16</volume>:<fpage>278</fpage>.<pub-id pub-id-type="pmid">26653891</pub-id></mixed-citation>
    </ref>
    <ref id="btad278-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Haber</surname><given-names>AL</given-names></string-name>, <string-name><surname>Biton</surname><given-names>M</given-names></string-name>, <string-name><surname>Rogel</surname><given-names>N</given-names></string-name></person-group><etal>et al</etal><article-title>A single-cell survey of the small intestinal epithelium</article-title>. <source>Nature</source><year>2017</year>;<volume>551</volume>:<fpage>333</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">29144463</pub-id></mixed-citation>
    </ref>
    <ref id="btad278-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Haghverdi</surname><given-names>L</given-names></string-name>, <string-name><surname>Lun</surname><given-names>ATL</given-names></string-name>, <string-name><surname>Morgan</surname><given-names>MD</given-names></string-name></person-group><etal>et al</etal><article-title>Batch effects in single-cell RNA-sequencing data are corrected by matching mutual nearest neighbors</article-title>. <source>Nat Biotechnol</source><year>2018</year>;<volume>36</volume>:<fpage>421</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">29608177</pub-id></mixed-citation>
    </ref>
    <ref id="btad278-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hie</surname><given-names>B</given-names></string-name>, <string-name><surname>Bryson</surname><given-names>B</given-names></string-name>, <string-name><surname>Berger</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>Efficient integration of heterogeneous single-cell transcriptomes using scanorama</article-title>. <source>Nat Biotechnol</source><year>2019</year>;<volume>37</volume>:<fpage>685</fpage>–<lpage>91</lpage>.<pub-id pub-id-type="pmid">31061482</pub-id></mixed-citation>
    </ref>
    <ref id="btad278-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hua</surname><given-names>J</given-names></string-name>, <string-name><surname>Liu</surname><given-names>H</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>LAK: Lasso and K-means based single-cell RNA-seq data clustering analysis</article-title>. <source>IEEE Access</source><year>2020</year>;<volume>8</volume>:<fpage>129679</fpage>–<lpage>88</lpage>.</mixed-citation>
    </ref>
    <ref id="btad278-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hubert</surname><given-names>L</given-names></string-name>, <string-name><surname>Arabie</surname><given-names>P.</given-names></string-name></person-group><article-title>Comparing partitions</article-title>. <source>J Classif</source><year>1985</year>;<volume>2</volume>:<fpage>193</fpage>–<lpage>218</lpage>.</mixed-citation>
    </ref>
    <ref id="btad278-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kagohara</surname><given-names>LT</given-names></string-name>, <string-name><surname>Zamuner</surname><given-names>F</given-names></string-name>, <string-name><surname>Davis-Marcisak</surname><given-names>EF</given-names></string-name></person-group><etal>et al</etal><article-title>Integrated single-cell and bulk gene expression and ATAC-seq reveals heterogeneity and early changes in pathways associated with resistance to cetuximab in HNSCC-sensitive cell lines</article-title>. <source>Br J Cancer</source><year>2020</year>;<volume>123</volume>:<fpage>101</fpage>–<lpage>13</lpage>.<pub-id pub-id-type="pmid">32362655</pub-id></mixed-citation>
    </ref>
    <ref id="btad278-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kang</surname><given-names>HM</given-names></string-name>, <string-name><surname>Subramaniam</surname><given-names>M</given-names></string-name>, <string-name><surname>Targ</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Multiplexed droplet single-cell RNA-sequencing using natural genetic variation</article-title>. <source>Nat Biotechnol</source><year>2018</year>;<volume>36</volume>:<fpage>89</fpage>–<lpage>94</lpage>.<pub-id pub-id-type="pmid">29227470</pub-id></mixed-citation>
    </ref>
    <ref id="btad278-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Korsunsky</surname><given-names>I</given-names></string-name>, <string-name><surname>Millard</surname><given-names>N</given-names></string-name>, <string-name><surname>Fan</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Fast, sensitive and accurate integration of single-cell data with harmony</article-title>. <source>Nat Methods</source><year>2019</year>;<volume>16</volume>:<fpage>1289</fpage>–<lpage>96</lpage>.<pub-id pub-id-type="pmid">31740819</pub-id></mixed-citation>
    </ref>
    <ref id="btad278-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lähnemann</surname><given-names>D</given-names></string-name>, <string-name><surname>Köster</surname><given-names>J</given-names></string-name>, <string-name><surname>Szczurek</surname><given-names>E</given-names></string-name></person-group><etal>et al</etal><article-title>Eleven grand challenges in single-cell data science</article-title>. <source>Genome Biol</source><year>2020</year>;<volume>21</volume>:<fpage>31</fpage>.<pub-id pub-id-type="pmid">32033589</pub-id></mixed-citation>
    </ref>
    <ref id="btad278-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Luecken</surname><given-names>MD</given-names></string-name>, <string-name><surname>Büttner</surname><given-names>M</given-names></string-name>, <string-name><surname>Chaichoompu</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>Benchmarking atlas-level data integration in single-cction ell genomics</article-title>. <source>Nat Methods</source><year>2022</year>;<volume>19</volume>:<fpage>41</fpage>–<lpage>50</lpage>.<pub-id pub-id-type="pmid">34949812</pub-id></mixed-citation>
    </ref>
    <ref id="btad278-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Luecken</surname><given-names>MD</given-names></string-name>, <string-name><surname>Theis</surname><given-names>FJ.</given-names></string-name></person-group><article-title>Current best practices in single-cell RNA-seq analysis: a tutorial</article-title>. <source>Mol Syst Biol</source><year>2019</year>;<volume>15</volume>:<fpage>e8746</fpage>.<pub-id pub-id-type="pmid">31217225</pub-id></mixed-citation>
    </ref>
    <ref id="btad278-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lyons</surname><given-names>DC</given-names></string-name>, <string-name><surname>Martik</surname><given-names>ML</given-names></string-name>, <string-name><surname>Saunders</surname><given-names>LR</given-names></string-name></person-group><etal>et al</etal><article-title>Specification to biomineralization: following a single cell type as it constructs a skeleton</article-title>. <source>Integr Comp Biol</source><year>2014</year>;<volume>54</volume>:<fpage>723</fpage>–<lpage>33</lpage>.<pub-id pub-id-type="pmid">25009306</pub-id></mixed-citation>
    </ref>
    <ref id="btad278-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Perillo</surname><given-names>M</given-names></string-name>, <string-name><surname>Oulhen</surname><given-names>N</given-names></string-name>, <string-name><surname>Foster</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Regulation of dynamic pigment cell states at single-cell resolution</article-title>. <source>eLife</source><year>2020</year>;<volume>9</volume>:<fpage>e60388</fpage>.<pub-id pub-id-type="pmid">32812865</pub-id></mixed-citation>
    </ref>
    <ref id="btad278-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Piacentino</surname><given-names>ML</given-names></string-name>, <string-name><surname>Ramachandran</surname><given-names>J</given-names></string-name>, <string-name><surname>Bradham</surname><given-names>CA</given-names></string-name></person-group><etal>et al</etal><article-title>Late Alk4/5/7 signaling is required for anterior skeletal patterning in sea urchin embryos</article-title>. <source>Development</source><year>2015</year>;<volume>142</volume>:<fpage>943</fpage>–<lpage>52</lpage>.<pub-id pub-id-type="pmid">25633352</pub-id></mixed-citation>
    </ref>
    <ref id="btad278-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Piacentino</surname><given-names>ML</given-names></string-name>, <string-name><surname>Zuch</surname><given-names>DT</given-names></string-name>, <string-name><surname>Fishman</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>RNA-Seq identifies SPGs as a ventral skeletal patterning cue in sea urchins</article-title>. <source>Development</source><year>2016</year>;<volume>143</volume>:<fpage>703</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">26755701</pub-id></mixed-citation>
    </ref>
    <ref id="btad278-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Picelli</surname><given-names>S</given-names></string-name>, <string-name><surname>Faridani</surname><given-names>OR</given-names></string-name>, <string-name><surname>Björklund</surname><given-names>AK</given-names></string-name></person-group><etal>et al</etal><article-title>Full-length RNA-seq from single cells using smart-seq2</article-title>. <source>Nat Protoc</source><year>2014</year>;<volume>9</volume>:<fpage>171</fpage>–<lpage>81</lpage>.<pub-id pub-id-type="pmid">24385147</pub-id></mixed-citation>
    </ref>
    <ref id="btad278-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pidgeon</surname><given-names>GP</given-names></string-name>, <string-name><surname>Lysaght</surname><given-names>J</given-names></string-name>, <string-name><surname>Krishnamoorthy</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Lipoxygenase metabolism: roles in tumor progression and survival</article-title>. <source>Cancer Metastasis Rev</source><year>2007</year>;<volume>26</volume>:<fpage>503</fpage>–<lpage>24</lpage>.<pub-id pub-id-type="pmid">17943411</pub-id></mixed-citation>
    </ref>
    <ref id="btad278-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Regev</surname><given-names>A</given-names></string-name>, <string-name><surname>Teichmann</surname><given-names>SA</given-names></string-name>, <string-name><surname>Lander</surname><given-names>ES</given-names></string-name></person-group><etal>et al</etal>; <collab>Human Cell Atlas Meeting Participants</collab>. <article-title>The human cell atlas</article-title>. <source>eLife</source><year>2017</year>;<volume>6</volume></mixed-citation>
    </ref>
    <ref id="btad278-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Satija</surname><given-names>R</given-names></string-name>, <string-name><surname>Farrell</surname><given-names>JA</given-names></string-name>, <string-name><surname>Gennert</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>Spatial reconstruction of single-cell gene expression data</article-title>. <source>Nat Biotechnol</source><year>2015</year>;<volume>33</volume>:<fpage>495</fpage>–<lpage>502</lpage>.<pub-id pub-id-type="pmid">25867923</pub-id></mixed-citation>
    </ref>
    <ref id="btad278-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schaum</surname><given-names>N</given-names></string-name>, <string-name><surname>Karkanias</surname><given-names>J</given-names></string-name>, <string-name><surname>Neff</surname><given-names>NF</given-names></string-name></person-group><etal>et al</etal><article-title>Single-cell transcriptomics of 20 mouse organs creates a Tabula Muris</article-title>. <source>Nature</source><year>2018</year>;<volume>562</volume>:<fpage>367</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">30283141</pub-id></mixed-citation>
    </ref>
    <ref id="btad278-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schelker</surname><given-names>M</given-names></string-name>, <string-name><surname>Feau</surname><given-names>S</given-names></string-name>, <string-name><surname>Du</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Estimation of immune cell content in tumour tissue using single-cell RNA-seq data</article-title>. <source>Nat Commun</source><year>2017</year>;<volume>8</volume>:<fpage>2032</fpage>.<pub-id pub-id-type="pmid">29230012</pub-id></mixed-citation>
    </ref>
    <ref id="btad278-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schreiber</surname><given-names>J</given-names></string-name>, <string-name><surname>Bilmes</surname><given-names>J</given-names></string-name>, <string-name><surname>Noble</surname><given-names>WS.</given-names></string-name></person-group><article-title>Apricot: submodular selection for data summarization in python</article-title>. <source>J Mach Learn Res</source><year>2020</year>;<volume>21</volume>:<fpage>1</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">34305477</pub-id></mixed-citation>
    </ref>
    <ref id="btad278-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Simionato</surname><given-names>GB</given-names></string-name>, <string-name><surname>da Silva</surname><given-names>ACR</given-names></string-name>, <string-name><surname>de Oliva</surname><given-names>AH</given-names></string-name></person-group><etal>et al</etal><article-title>Lack of 5-lipoxygenase in intramembranous and endochondral 129Sv mice skeleton and intramembranous healing</article-title>. <source>Arch Oral Biol</source><year>2021</year>;<volume>131</volume>:<fpage>105266</fpage>.<pub-id pub-id-type="pmid">34571394</pub-id></mixed-citation>
    </ref>
    <ref id="btad278-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stuart</surname><given-names>T</given-names></string-name>, <string-name><surname>Satija</surname><given-names>R.</given-names></string-name></person-group><article-title>Integrative single-cell analysis</article-title>. <source>Nat Rev Genet</source><year>2019</year>;<volume>20</volume>:<fpage>257</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">30696980</pub-id></mixed-citation>
    </ref>
    <ref id="btad278-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sun</surname><given-names>Z</given-names></string-name>, <string-name><surname>Ettensohn</surname><given-names>CA.</given-names></string-name></person-group><article-title>Signal-dependent regulation of the sea urchin skeletogenic gene regulatory network</article-title>. <source>Gene Expr Patterns</source><year>2014</year>;<volume>16</volume>:<fpage>93</fpage>–<lpage>103</lpage>.<pub-id pub-id-type="pmid">25460514</pub-id></mixed-citation>
    </ref>
    <ref id="btad278-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tian</surname><given-names>L</given-names></string-name>, <string-name><surname>Dong</surname><given-names>X</given-names></string-name>, <string-name><surname>Freytag</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Benchmarking single cell RNA-sequencing analysis pipelines using mixture control experiments</article-title>. <source>Nat Methods</source><year>2019</year>;<volume>16</volume>:<fpage>479</fpage>–<lpage>87</lpage>.<pub-id pub-id-type="pmid">31133762</pub-id></mixed-citation>
    </ref>
    <ref id="btad278-B35">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Tyler</surname><given-names>SR</given-names></string-name>, <string-name><surname>Bunyavanich</surname><given-names>S</given-names></string-name>, <string-name><surname>Schadt</surname><given-names>EE.</given-names></string-name></person-group> PMD uncovers widespread cell-state erasure by scRNAseq batch correction methods. <year>2021</year>. <pub-id pub-id-type="doi">10.1101/2021.11.15.468733</pub-id></mixed-citation>
    </ref>
    <ref id="btad278-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wagner</surname><given-names>DE</given-names></string-name>, <string-name><surname>Weinreb</surname><given-names>C</given-names></string-name>, <string-name><surname>Collins</surname><given-names>ZM</given-names></string-name></person-group><etal>et al</etal><article-title>Single-cell mapping of gene expression landscapes and lineage in the zebrafish embryo</article-title>. <source>Science</source><year>2018</year>;<volume>360</volume>:<fpage>981</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">29700229</pub-id></mixed-citation>
    </ref>
    <ref id="btad278-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>W</given-names></string-name>, <string-name><surname>Wang</surname><given-names>K</given-names></string-name>, <string-name><surname>Zuo</surname><given-names>W.</given-names></string-name></person-group><article-title>Neighborhood component feature selection for high-dimensional data</article-title>. <source>J Comput</source><year>2012</year>;<volume>7</volume>:<fpage>161</fpage>–<lpage>8</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
