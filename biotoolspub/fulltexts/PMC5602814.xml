<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Cheminform</journal-id>
    <journal-id journal-id-type="iso-abbrev">J Cheminform</journal-id>
    <journal-title-group>
      <journal-title>Journal of Cheminformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1758-2946</issn>
    <publisher>
      <publisher-name>Springer International Publishing</publisher-name>
      <publisher-loc>Cham</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5602814</article-id>
    <article-id pub-id-type="publisher-id">238</article-id>
    <article-id pub-id-type="doi">10.1186/s13321-017-0238-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>G.A.M.E.: GPU-accelerated mixture elucidator</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Schurz</surname>
          <given-names>Alioune</given-names>
        </name>
        <address>
          <email>alioune.schurz@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Su</surname>
          <given-names>Bo-Han</given-names>
        </name>
        <address>
          <email>suborhang@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tu</surname>
          <given-names>Yi-Shu</given-names>
        </name>
        <address>
          <email>yishutu@cmdm.tw</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lu</surname>
          <given-names>Tony Tsung-Yu</given-names>
        </name>
        <address>
          <email>joyeuxnoel8@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lin</surname>
          <given-names>Olivia A.</given-names>
        </name>
        <address>
          <email>olivia22lin@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Tseng</surname>
          <given-names>Yufeng J.</given-names>
        </name>
        <address>
          <phone>+886-2-3366-4888</phone>
          <email>yjtseng@csie.ntu.edu.tw</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0546 0241</institution-id><institution-id institution-id-type="GRID">grid.19188.39</institution-id><institution>Graduate Institute of Biomedical Electronics and Bioinformatics, National Taiwan University, </institution></institution-wrap>No. 1 Sec. 4, Roosevelt Road, Taipei, 106 Taiwan </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0546 0241</institution-id><institution-id institution-id-type="GRID">grid.19188.39</institution-id><institution>Department of Computer Science and Information Engineering, </institution><institution>National Taiwan University, </institution></institution-wrap>No. 1 Sec. 4, Roosevelt Road, Taipei, 106 Taiwan </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0546 0241</institution-id><institution-id institution-id-type="GRID">grid.19188.39</institution-id><institution>Drug Research Center, National Taiwan University College of Medicine, </institution></institution-wrap>No. 1 Sec. 1, Jen Ai Rord, Taipei, 106 Taiwan </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>9</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>15</day>
      <month>9</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <volume>9</volume>
    <elocation-id>50</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>1</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>5</day>
        <month>9</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2017</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">GPU acceleration is useful in solving complex chemical information problems. Identifying unknown structures from the mass spectra of natural product mixtures has been a desirable yet unresolved issue in metabolomics. However, this elucidation process has been hampered by complex experimental data and the inability of instruments to completely separate different compounds. Fortunately, with current high-resolution mass spectrometry, one feasible strategy is to define this problem as extending a scaffold database with sidechains of different probabilities to match the high-resolution mass obtained from a high-resolution mass spectrum. By introducing a dynamic programming (DP) algorithm, it is possible to solve this NP-complete problem in pseudo-polynomial time. However, the running time of the DP algorithm grows by orders of magnitude as the number of mass decimal digits increases, thus limiting the boost in structural prediction capabilities. By harnessing the heavily parallel architecture of modern GPUs, we designed a “compute unified device architecture” (CUDA)-based GPU-accelerated mixture elucidator (G.A.M.E.) that considerably improves the performance of the DP, allowing up to five decimal digits for input mass data. As exemplified by four testing datasets with verified constitutions from natural products, G.A.M.E. allows for efficient and automatic structural elucidation of unknown mixtures for practical procedures.<fig position="anchor" id="Figa"><label>Graphical abstract</label><caption><p>.</p></caption><graphic position="anchor" xlink:href="13321_2017_238_Figa_HTML" id="MO11"/></fig>
</p>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s13321-017-0238-7) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Natural product</kwd>
      <kwd>Mass spectrum</kwd>
      <kwd>Structure elucidator</kwd>
      <kwd>GPU acceleration</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004663</institution-id>
            <institution>Ministry of Science and Technology, Taiwan</institution>
          </institution-wrap>
        </funding-source>
        <award-id>105-3011-F-002-010-</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2017</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par11">Mass spectrometry (MS) is one of the most widely used analytical methods for identifying the components of unknown mixtures or natural products. Elucidation of chemical structures, especially from natural products, is important to identify potential drug candidates with fewer adverse effects and structural novelty for drug discovery [<xref ref-type="bibr" rid="CR1">1</xref>]. Mass spectra indicate the mass-to-charge ratio of each component, and the amplitude of each peak roughly represents the relative abundance of the molecule. However, additional techniques such as nuclear magnetic resonance (NMR) [<xref ref-type="bibr" rid="CR2">2</xref>], a time-consuming and complex procedure, are needed to fully identify each component in the mixture. Furthermore, MS itself cannot elucidate the structure of a partially or completely unknown compound [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR5">5</xref>]. Therefore, successful structure elucidation of unknown compounds depends on the development of advanced computational tools for analyzing mass spectral data [<xref ref-type="bibr" rid="CR6">6</xref>].</p>
    <p id="Par12">Several NMR-based expert systems have been developed to facilitate automated structure elucidation [<xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR15">15</xref>]. This type of computer-aided structure elucidation (CASE) approach suffers from the complex and time-consuming nature of NMR experiments, which usually involve multiple runs of different 2D NMR [<xref ref-type="bibr" rid="CR16">16</xref>]. Moreover, the required NMR protocols may differ for different compounds, especially those with few hydrogen atoms or a diverse array of heteroatoms [<xref ref-type="bibr" rid="CR14">14</xref>]. Additionally, the limited sensitivity of NMR relative to vibrational spectroscopy and mass spectroscopy further limits the development of high-throughput automated CASE expert systems [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>]. Recently, Harn et al. [<xref ref-type="bibr" rid="CR19">19</xref>] have developed a new CASE method (NP-StructurePredictor) that can efficiently and accurately predict individual components in a mixture (The detailed method of NP-StructurePredictor is included in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>); this approach is based on a model generated by referencing a collection of 226,949 natural products. NP-StructurePredictor divides each compound into a major scaffold and its sidechains. The relationship between each scaffold is initially constructed, and the probabilities of each sidechain on different possible scaffolds are evaluated. The model then takes the input seed scaffolds provided by users to match scaffolds in the model and automatically generates a list of most probable matching compounds sorted on the basis of evaluated probabilities for a given mass peak. The list is populated by combining possible sidechains at each position of the scaffold and evaluating the probability of the resulting compounds by using the natural products database (NPDB) probability data. Only the resulting compounds whose weight corresponds to the mass peak are retained. Experiments involving real test cases have shown that NP-StructurePredictor can correctly predict most of the compounds in mixtures, but it does so in a computationally inefficient manner.</p>
    <p id="Par13">The computational problem defined in the NP-StructurePredictor system has been formally proven to be NP-complete; it constitutes a chemical substituent core combinatorial problem (CSCCP) [<xref ref-type="bibr" rid="CR20">20</xref>]. Because of the NP-completeness of CSCCPs, the branch and bound strategy used in NP-StructurePredictor lead to long running time for complex scaffolds. To resolve this issue, Su has developed a dynamic programming (DP) algorithm [<xref ref-type="bibr" rid="CR20">20</xref>] to increase computational efficiency (the detailed method of DP algorithm is included in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>). Although the DP algorithm allowed optimization of the NP-complete problem into pseudo-polynomial time, the search for optimal solutions can still be completed in exponential time complexity in the worst-case scenario. Each additional decimal digit of mass in the DP algorithm increases the running time tenfold. For example, the required computational time in the challenging case of <italic>C. chinensis</italic> would exceed 1 month if the number of decimal digits was set to 5. For high-resolution LC–MS experiments, the unreasonable execution time required to elucidate unknown chemical structures based on the DP strategy is still not functional in many cases.</p>
    <p id="Par14">To overcome the computational bottleneck of automatically identifying chemical components of mixtures with the DP algorithm, hardware acceleration via graphical processing units (GPUs) can be directly used to substantially improve the time performance. Indeed, the use of GPUs has recently attracted broad attention in the field of computer science. GPUs are not merely specialized video rendering devices to assist in accelerating the visualization of 3D graphics; they can also be used as a programming interface to support high-performance parallel computing [<xref ref-type="bibr" rid="CR21">21</xref>]. The traditional CPU-based algorithm is no longer an effective way to solve extremely computationally demanding tasks [<xref ref-type="bibr" rid="CR22">22</xref>]. A modern GPU contains thousands of efficient threads that can simultaneously perform multitasking optimization. Consequently, GPU methods are faster than conventional CPU methods and can provide an increase of one or two orders of magnitude [<xref ref-type="bibr" rid="CR23">23</xref>]. Most importantly, the CUDA programming toolkit released by NVIDIA facilitates the development of software parallelism via GPUs. CUDA is an extension of the standard C/C++-like programming language, allowing researchers to implement and explore the parallel computing ability of GPUs. An increasing number of applications for GPU computing have been developed in different fields of cheminformatics, including free energy calculations [<xref ref-type="bibr" rid="CR24">24</xref>], molecular docking [<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>], molecular dynamics simulations [<xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR28">28</xref>], high-throughput screening [<xref ref-type="bibr" rid="CR29">29</xref>], similarity searching [<xref ref-type="bibr" rid="CR30">30</xref>], and classification [<xref ref-type="bibr" rid="CR31">31</xref>]. Therefore, the use of massively GPU parallel architecture is a feasible way to minimize the effects of NP-completeness complexity in CSCCP.</p>
    <p id="Par15">In this study, we present a GPU-accelerated algorithm, the GPU-accelerated mixture elucidator (G.A.M.E.), that can efficiently promote performance improvements of DP algorithms used to resolve chemical structures in the mass spectra of an unknown mixture. G.A.M.E. is a novel GPU-accelerated method implemented by the CUDA toolkit on NVIDIA cards that uses the heavily parallel architecture of modern GPUs. This method significantly decreases the computational time when five decimal digits of mass are required, thus allowing for efficient and automatic structure elucidation in practical cases. All datasets and source code of G.A.M.E. are available on GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/CMDM-Lab/GAME">https://github.com/CMDM-Lab/GAME</ext-link>.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <p id="Par16">The system architecture of G.A.M.E. is identical to the DP algorithm in previous study other than the GPU parallel programming in G.A.M.E. The system utilized molecular weights calculated from a list of m/z values obtained through LC–MS experiments as input information to predict chemical structures matching the input molecular weights in a mixture. Furthermore, possible scaffold structures of the mixture can be provided to the system to accelerate the prediction processes. When possible scaffolds cannot be provided, G.A.M.E. is able to apply all scaffolds collected in our database to search for suitable candidates. After such prediction by the GPU searching algorithm, a list of possible candidates in mixtures and their relative rankings will be provided. In the previous studies, four Chinese herb mixtures with verified structures were used to validate the accuracy of the NP-StructurePredictor system. Since G.A.M.E. is a new GPU programming version of the previous system with the same architecture, we will only focus on the improved time performance of the system in this study.</p>
    <sec id="Sec3">
      <title>Datasets</title>
      <p id="Par17">The G.A.M.E. algorithm searches for possible compounds matching the input molecular weights by expanding a seed scaffold with suitable sidechains. For comparing the feasibility and processing time between G.A.M.E. and its original CPU version, a natural product database (NPDB) was built from curating all of the known structures from the Dictionary of Natural Products (DNP) [<xref ref-type="bibr" rid="CR32">32</xref>], the “ZINC natural products” subset of ZINC [<xref ref-type="bibr" rid="CR33">33</xref>], and the Traditional Chinese Medicine Database [<xref ref-type="bibr" rid="CR34">34</xref>]. The scaffolds are the remaining core structures after all terminal side chains have been deleted. Then, a total of 83,242 scaffold files were generated from the collected 243,130 natural products in the NPDB. The side chains excluded from the natural products were separated curated as our side chain database. Furthermore, we also analyzed possible sets of atoms (positions) on each scaffold structure that can be linked by the side chains, and evaluated linking probabilities of the sidechains to the scaffold. The possible sets of positions on the scaffold were defined as configuration of scaffolds, and were denoted by <italic>N</italic>
<sub><italic>r</italic></sub> in this study. G.A.M.E. uses the configurations of the selected scaffold by linking possible side chains to elucidate suitable chemical structures corresponding to the input molecular weights of a mixture. All datasets are available on GitHub at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.237579">https://doi.org/10.5281/zenodo.237579</ext-link>. After dataset curation, only 26,641 scaffold files are suitable for the following test with <italic>w</italic>
<sub><italic>max</italic></sub> = 500, with total configuration number of 51,562.</p>
      <p id="Par18">In addition, for comparisons with the CPU DP algorithm in real study cases, verified constitutions from four natural products (<italic>Cuscuta chinensis</italic>, <italic>Ophiopogon japonicus</italic>, <italic>Polygonum multiflorum</italic> and <italic>Angelica</italic> sp.) obtained from the Natural Product Laboratory of Taiwan Medical and the Pharmaceutical Industry Technology and Development Center were used as testing datasets. The numbers of verified constitutions in the <italic>Cuscuta chinensis</italic>, <italic>Ophiopogon japonicus</italic>, <italic>Polygonum multiflorum</italic>, and <italic>Angelica</italic> sp. datasets were 5, 7, 7, and 45, respectively; the corresponding molecular ranges were from 286.24 to 478.41, from 328.32 to 370.36, from 270.24 to 578.53 and from 162.03 to 574.29, respectively.</p>
    </sec>
    <sec id="Sec4">
      <title>GPU configuration</title>
      <p id="Par19">Computations were performed on an ASUS<sup>®</sup> ESC4000 G2 Server with two Intel<sup>®</sup> Xeon E5-2630 v2 processors (3.10 GHz) running under CentOS 6.7. We used Python 2.7 and CUDA 7.5 in combination with PyCuda 2017.1. Our graphic card was an NVIDIA<sup>®</sup> Tesla K40c with a compute capability of 3.5, equipped with 15 streaming multiprocessors of 192 cores each, 11,439 MB of global memory and 49 kB of shared memory. The computational resources were provided by Computer and Networking Center, National Taiwan University.</p>
    </sec>
    <sec id="Sec5">
      <title>Problem definitions</title>
      <p id="Par20">Before introducing the GPU algorithm in later sections, we first defined notations used in the algorithms, and illustrated the problem of structural elucidation in this section.</p>
      <sec id="Sec6">
        <title>Input data notations (n, w<sub>min</sub>, w<sub>max</sub>, D, R, K, h, W, P)</title>
        <p id="Par21">The algorithm takes as input nine parameters: six scalars and three matrices. They are defined as follows: <italic>n</italic> ∈ ℕ, <italic>w</italic>
<sub><italic>min</italic></sub> ∈ ℝ<sup>+</sup>, <italic>w</italic>
<sub><italic>max</italic></sub> ∈ ℝ<sup>+</sup> (<italic>w</italic>
<sub><italic>max</italic></sub> ≥ <italic>w</italic>
<sub><italic>min</italic></sub>), <italic>D</italic> ∈ ℕ, <italic>R</italic> ∈ ℕ, <italic>K</italic> = {<italic>k</italic>
<sub><italic>0</italic></sub>, <italic>…</italic>, <italic>k</italic>
<sub><italic>n</italic>−1</sub>} ∈ ℕ<sup><italic>n</italic></sup>, <italic>h</italic> = <italic>max</italic>(<italic>K</italic>), <italic>W</italic> = {<italic>w</italic>
<sub><italic>s,j</italic></sub>}<sub>(<italic>s</italic>,<italic>j</italic>)∈[|<italic>0,n</italic>|]×[|<italic>0,h</italic>−1|]</sub> ⊂ (ℝ<sup>+</sup>)<sup><italic>h</italic>×<italic>n</italic></sup> and <italic>P</italic> = {<italic>p</italic>
<sub><italic>s,j</italic></sub>}<sub>(<italic>s,j</italic>)∈[|0<italic>,n</italic>|]×[|0<italic>,h</italic>−1|]</sub> ⊂ [0,1]<sup><italic>h</italic>×<italic>n</italic></sup>. Moreover, we define ∀<italic>s</italic>∈[|0<italic>,n</italic>|], <italic>j</italic> ≥ <italic>k</italic>
<sub><italic>s</italic></sub> ⇒ <italic>p</italic>
<sub><italic>s,j</italic></sub> = <italic>w</italic>
<sub><italic>s</italic>,<italic>j</italic></sub> = 0. All necessary information in a scaffold used in G.A.M.E. is represented by (<italic>n</italic>, <italic>K</italic>, <italic>W</italic>, <italic>P</italic>). <italic>n</italic> is the number of possible atoms (positions) in the scaffold that can be linked by side chains. <italic>K</italic> = {<italic>k</italic>
<sub><italic>0</italic></sub>, <italic>…</italic>, <italic>k</italic>
<sub><italic>n</italic>−1</sub>} contains the sidechain counts, defined such that <italic>k</italic>
<sub><italic>s</italic></sub> is the number of possible sidechains that can be extended at a position <italic>s</italic> in the scaffold. <italic>W</italic> = {<italic>w</italic>
<sub><italic>s,j</italic></sub>}<sub>(<italic>s</italic>,<italic>j</italic>)</sub> represents molecular weights of the possible extended sidechains, defined such that <italic>w</italic>
<sub><italic>s,j</italic></sub> is the weight of the <italic>j</italic>th sidechain at position <italic>s</italic>. <italic>P</italic> = {<italic>p</italic>
<sub><italic>s,j</italic></sub>}<sub>(<italic>s,j</italic>)</sub> denotes probabilities of the extended sidechains to the scaffold, defined such that <italic>p</italic>
<sub><italic>s,j</italic></sub> is the probability of the <italic>j</italic>th sidechain linked at position <italic>s</italic> of the scaffold. Given a scaffold, <italic>S</italic> = (<italic>n</italic>, <italic>K</italic>, <italic>W</italic>, <italic>P</italic>), Ψ(<italic>S</italic>) = [|0, <italic>k</italic>
<sub><italic>0</italic></sub> − 1|] × … × [|0, <italic>k</italic>
<sub><italic>n</italic>−1</sub> − 1|] is defined as a set of all structures that can be generated by extending the possible sidechains on this scaffold. Furthermore, Ψ<sub>s</sub>(<italic>S</italic>) = [|0, <italic>k</italic>
<sub><italic>0</italic></sub> − 1|] × … × [|0, <italic>k</italic>
<sub><italic>s</italic></sub> − 1|] denotes a set of all structures that can be generated on the sub-scaffold <italic>S</italic>
<sub><italic>s</italic></sub>, containing only the first <italic>s</italic> substituted positions of the scaffold <italic>S</italic> (from position <italic>0</italic> to <italic>s</italic>). Given a compound <italic>x</italic> ∈ Ψ(<italic>S</italic>), the <italic>mass</italic> of <italic>x</italic> is designated as <italic>g</italic>(<italic>x</italic>) = Σ <italic>w</italic>
<sub><italic>s,j</italic></sub>, and the probability of <italic>x</italic> that was generated by extending sidechains to the scaffold <italic>S</italic> is defined by <italic>f</italic>(<italic>x</italic>) = Π <italic>p</italic>
<sub><italic>s,j</italic></sub>. (<italic>w</italic>
<sub><italic>min</italic></sub>, <italic>w</italic>
<sub><italic>max</italic></sub>, <italic>D</italic>) represents a set of <italic>mass</italic> information. [<italic>w</italic>
<sub><italic>min</italic></sub>, <italic>w</italic>
<sub><italic>max</italic></sub>] is the interval of masses corresponding to the <italic>mass</italic> peak from the MS experiment in a mixture. This interval depends on the resolution of the mass spectrometer. <italic>D</italic> is the number of <italic>mass</italic> decimal digits available for <italic>w</italic>
<sub><italic>min</italic></sub> and <italic>w</italic>
<sub><italic>max</italic></sub>. In the DP algorithm [<xref ref-type="bibr" rid="CR20">20</xref>] for structure elucidation, the molecular weights (<italic>mass</italic>) has to be converted to a value of integers format multiplied by 10<sup><italic>D</italic></sup>. The converted value of mass will lead to no loss of significant digits in the DP algorithm.</p>
      </sec>
      <sec id="Sec7">
        <title>Optimization problem</title>
        <p id="Par22">The processes of structure elucidation in a mixture can be represented by an optimization problem. In G.A.M.E., the definition of the optimization problem is same with the CSCCP [<xref ref-type="bibr" rid="CR20">20</xref>]. Given a scaffold <italic>S</italic> = (<italic>n</italic>, <italic>K</italic>, <italic>W</italic>, <italic>P</italic>) and a mass peak M = (<italic>w</italic>
<sub><italic>min</italic></sub>, <italic>w</italic>
<sub><italic>max</italic></sub>, <italic>D</italic>), the CSCCP is to find the top <italic>R</italic> most probable compounds in Ψ(<italic>S</italic>) having weights inside the interval [<italic>w</italic>
<sub><italic>min</italic></sub>, <italic>w</italic>
<sub><italic>max</italic></sub>]. We have noted that a scaffold might contain different configurations in “<xref rid="Sec3" ref-type="sec">Datasets</xref>” section. In one CSCCP, we only manipulate one configuration of the scaffold. The CSCCP is to search optimal chemical structures, <italic>x</italic> ∈ Ψ(<italic>S</italic>), that extend the possible substituents to a configuration of the given scaffold while maximizing the objective function, <italic>f</italic>(<italic>x</italic>), such that two constraints, <italic>x</italic> ∈ Ψ(<italic>S</italic>) and <italic>g</italic>(<italic>x</italic>) ∈ [<italic>w</italic>
<sub><italic>min</italic></sub>, <italic>w</italic>
<sub><italic>max</italic></sub>], are fulfilled. The R compounds, <italic>x</italic> ∈ Ψ(<italic>S</italic>) having highest values of <italic>f</italic>(<italic>x</italic>), and containing total weights between <italic>w</italic>
<sub><italic>min</italic></sub> and <italic>w</italic>
<sub><italic>max</italic></sub> are regarded as the best predicted structures in a CSCCP. The previous studies [<xref ref-type="bibr" rid="CR20">20</xref>] used the DP algorithm to solve the optimization problem, and we modified the DP algorithm based on the GPU parallelism.</p>
      </sec>
      <sec id="Sec8">
        <title>Transformed input (<inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{min}^{\prime}$$\end{document}</tex-math><mml:math id="M2"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq1.gif"/></alternatives></inline-formula>, <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{max}^{\prime}, W^{\prime}$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq2.gif"/></alternatives></inline-formula>)</title>
        <p id="Par23">Because the generated structures must be indexed by its weights in the design of DP algorithm, all <italic>mass</italic> values must be converted to integers by multiplying 10<sup><italic>D</italic></sup> in the program. We therefore define <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{min}^{\prime}$$\end{document}</tex-math><mml:math id="M6"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq3.gif"/></alternatives></inline-formula> = <italic>w</italic>
<sub><italic>min</italic></sub> × 10<sup><italic>D</italic></sup> ∈ ℕ, <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{max}^{\prime}$$\end{document}</tex-math><mml:math id="M8"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq4.gif"/></alternatives></inline-formula> = <italic>w</italic>
<sub><italic>max</italic></sub> × 10<sup><italic>D</italic></sup> ∈ℕ, and <italic>W</italic>′ = {<inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{s,j}^{\prime}$$\end{document}</tex-math><mml:math id="M10"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq5.gif"/></alternatives></inline-formula>}<sub><italic>s,j</italic></sub>, such that <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{s,j}^{\prime}$$\end{document}</tex-math><mml:math id="M12"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq6.gif"/></alternatives></inline-formula> = <italic>w</italic>
<sub><italic>s,j</italic></sub> × 10<sup><italic>D</italic></sup>. (<inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{min}^{\prime}$$\end{document}</tex-math><mml:math id="M14"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq7.gif"/></alternatives></inline-formula>, <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{max}^{\prime}$$\end{document}</tex-math><mml:math id="M16"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq8.gif"/></alternatives></inline-formula>, <italic>W</italic>′) is the integer format of a mass peak.</p>
      </sec>
      <sec id="Sec9">
        <title>Intermediated variables (C, L)</title>
        <p id="Par24">The DP algorithm used two important matrices to traverse a list of selected sidechains, and extend the sidechains to the given scaffold during the process of generating possible structures in a mixture: the cost matrix <italic>C</italic> = {<italic>c</italic>
<sub><italic>s,w,r</italic></sub>}<sub><italic>s,w,r</italic></sub> ∈ <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left[ {0,1} \right]^{{\left( {n \times w_{max}^{\prime} \times R} \right)}}$$\end{document}</tex-math><mml:math id="M18"><mml:msup><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>×</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:mfenced></mml:msup></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq9.gif"/></alternatives></inline-formula> and the sidechain information matrix <italic>L</italic> = {<italic>l</italic>
<sub><italic>s,w,r</italic></sub>}<sub><italic>s,w,r</italic></sub> ∈ <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left[ {\left| {0,h} \right|} \right]\left[ {\left| {0,R} \right|} \right]^{{\left( {n \times w_{max}^{\prime} \times R} \right)}}$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mfenced close="]" open="["><mml:mfenced close="|" open="|" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:mfenced></mml:mfenced><mml:msup><mml:mfenced close="]" open="["><mml:mfenced close="|" open="|" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:mfenced></mml:mfenced><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>×</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:mfenced></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq10.gif"/></alternatives></inline-formula>, with (<italic>s,w,r</italic>) ∈ [|0,<italic>n</italic>|] × [|0, <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{max}^{\prime}$$\end{document}</tex-math><mml:math id="M22"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq11.gif"/></alternatives></inline-formula> |] × [|0,<italic>R</italic>|]. The value of <italic>c</italic>
<sub><italic>s,w,r</italic></sub> represents the probability of the <italic>r</italic>th highest value of <italic>f</italic>(<italic>x</italic>) when only <italic>s</italic> out of <italic>n</italic> substituted positions on a given scaffold <italic>S</italic> has been traversed by the DP program, and the <italic>mass</italic> of compounds in Ψ<sub>s</sub>(<italic>S</italic>) generated by the selected sidechains linking on the <italic>S</italic> is equal to <italic>w</italic>÷10<sup><italic>D</italic></sup> as well. <italic>w</italic> denotes the molecular weight ranging from 0 to <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{max}^{\prime}$$\end{document}</tex-math><mml:math id="M24"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq12.gif"/></alternatives></inline-formula> in integer format. The DP algorithm iteratively evaluates the possible extended sidechains on scaffold <italic>S</italic> from position 0 to <italic>s</italic>, and calculates the values in <italic>C</italic> for all the molecular weight from 0 to <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{max}^{\prime}$$\end{document}</tex-math><mml:math id="M26"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq13.gif"/></alternatives></inline-formula> and <italic>R</italic> values from 0 to <italic>R</italic> for each <italic>s</italic> substituted positions. When all the values in <italic>C</italic> have been calculated by the DP algorithm, the generated compounds with the values of <italic>c</italic>
<sub><italic>n,w,r</italic></sub>, where <italic>w</italic> ∈ [<inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{min}^{\prime}$$\end{document}</tex-math><mml:math id="M28"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq14.gif"/></alternatives></inline-formula>, <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{max}^{\prime}$$\end{document}</tex-math><mml:math id="M30"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq15.gif"/></alternatives></inline-formula>], and <italic>r</italic> ∈ [0,<italic>R</italic>], are the optimal predicted results. The <italic>l</italic>
<sub><italic>s,w,r</italic></sub> is the tuple <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {k_{s,w,r} ,r_{s,w,r}^{prev} } \right)$$\end{document}</tex-math><mml:math id="M32"><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq16.gif"/></alternatives></inline-formula>, where <italic>k</italic>
<sub><italic>s,w,r</italic></sub> is a sidechain index at position <italic>s</italic> of the compound in Ψ<sub>s</sub>(<italic>S</italic>) with <italic>r</italic>th highest probability and total weight <italic>w</italic>, and <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_{s,w,r}^{prev}$$\end{document}</tex-math><mml:math id="M34"><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq17.gif"/></alternatives></inline-formula> is the rank of the compound in Ψ<sub>s-1</sub>(<italic>S</italic>) with the total weight <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w - w_{{s,k_{s,w,r} }}^{\prime}$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi>w</mml:mi><mml:mo>-</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq18.gif"/></alternatives></inline-formula> that was used to construct the <italic>r</italic>th compound in Ψ<sub>s</sub>(<italic>S</italic>). <italic>l</italic>
<sub><italic>s,w,r</italic></sub> were used to traverse a list of selected sidechains generating the <italic>c</italic>
<sub><italic>s,w,r</italic></sub> in the DP algorithm. The detailed DP algorithm is introduced in the next section.</p>
      </sec>
    </sec>
    <sec id="Sec10">
      <title>GPU algorithm implementation</title>
      <p id="Par25">To solve the CSCCP, the DP algorithm that was applied in our GPU system can be implemented in the following two phases.</p>
      <p id="Par26"><italic>First phase</italic>: the first phase comprises four imbricated loops indexed by (<italic>s</italic>,<italic>w</italic>,<italic>r</italic>,<italic>k</italic>). For a loop state, (<italic>s,w,r</italic>) ∈ [|0,<italic>n</italic>|] × [|0, <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{max}^{\prime}$$\end{document}</tex-math><mml:math id="M38"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq19.gif"/></alternatives></inline-formula>|] × [|0,<italic>R</italic>|], we have <italic>k</italic> ∈ [|0,<italic>k</italic>
<sub>s</sub>-1|]. In the first loop, the algorithm evaluates the values of <italic>C</italic> from position 0 to <italic>s</italic> on the given scaffold. At each iteration on <italic>s</italic>, the algorithm computes all the values <italic>c</italic>
<sub><italic>s</italic>,:,:</sub> = {<italic>c</italic>
<sub><italic>s,w,r</italic></sub>|(<italic>w,r</italic>) ∈ [|0, <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{max}^{\prime}$$\end{document}</tex-math><mml:math id="M40"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq20.gif"/></alternatives></inline-formula>|] × [|0,<italic>R</italic>|]}. The second loop is the traverse of all possible weight <italic>w</italic> from 0 to <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{max}^{\prime}$$\end{document}</tex-math><mml:math id="M42"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq21.gif"/></alternatives></inline-formula>. This aim is achieved as follows. For each possible weight <italic>w</italic>, the next (<italic>k</italic>,<italic>r</italic>) loops compute the set <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Tmp = \left\{ {\left( {k,r,p_{s,k} \times c_{{s - 1,w - w^{\prime}_{{s,k_{s,w,r} }} }} } \right)} \right\}_{k.r}$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:mi>T</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mfenced close="}" open="{"><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>-</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mfenced><mml:mrow><mml:mi>k</mml:mi><mml:mo>.</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq22.gif"/></alternatives></inline-formula>. The set is then sorted according to the updated probability in the 3rd component of <italic>Tmp</italic>. Let (<italic>T</italic>
<sub><italic>0</italic></sub>,<italic>T</italic>
<sub>1</sub>,…,<italic>T</italic>
<sub><italic>R</italic>-1</sub>) be the highest <italic>R</italic> ranked elements for the <italic>Tmp</italic> calculation with the following notation: ∀<italic>r</italic> ∈ [|0,<italic>R</italic>|], <italic>T</italic>
<sub><italic>r</italic></sub> = (<italic>t</italic>
<sub arrange="stack"><italic>0</italic></sub><sup arrange="stack">(r)</sup>, <italic>t</italic>
<sub arrange="stack"><italic>1</italic></sub><sup arrange="stack">(r)</sup>, <italic>t</italic>
<sub arrange="stack"><italic>2</italic></sub><sup arrange="stack">(r)</sup>), <italic>c</italic>
<sub><italic>s,w,r</italic></sub> = <italic>t</italic>
<sub arrange="stack"><italic>2</italic></sub><sup arrange="stack">(r)</sup> and <italic>l</italic>
<sub><italic>s,w,r</italic></sub> = (<italic>t</italic>
<sub arrange="stack"><italic>0</italic></sub><sup arrange="stack">(r)</sup>,<italic>t</italic>
<sub arrange="stack"><italic>1</italic></sub><sup arrange="stack">(r)</sup>). Then, <italic>T</italic>
<sub><italic>r</italic></sub> is used to update <italic>C</italic> and <italic>L</italic> in each iteration.</p>
      <p id="Par27">This phase is the main computational part of the DP algorithm. Because the loop on <italic>w</italic> goes from <italic>0</italic> to <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{max}^{\prime}$$\end{document}</tex-math><mml:math id="M46"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq23.gif"/></alternatives></inline-formula> = <italic>w</italic>
<sub><italic>max</italic></sub> × 10<sup><italic>D</italic></sup>, the complexity of the algorithm is proportional to 10<sup><italic>D</italic></sup>; for each additional decimal digit required, the running time extends ten times longer.</p>
      <p id="Par28"><italic>Second phase</italic>: the second phase outputs the final ranking of the generated structures in the first phase corresponding to the mass peak. The top <italic>R</italic> probabilities are simply the top <italic>R</italic> elements in the set {<italic>c</italic>
<sub><italic>n,w,r</italic></sub>|(<italic>w</italic>,<italic>r</italic>) ∈ [|<inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{min}^{\prime}$$\end{document}</tex-math><mml:math id="M48"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq24.gif"/></alternatives></inline-formula>, <inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{max}^{\prime}$$\end{document}</tex-math><mml:math id="M50"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq25.gif"/></alternatives></inline-formula>|] × [|0,<italic>R</italic>|]}. Because of a simple recursive backtracking algorithm, the matrix <italic>L</italic> can be used to compute the compound corresponding to each probability of the above top <italic>R</italic> probabilities. This phase is not computationally demanding and does not require acceleration.</p>
      <p id="Par29">In the next sections, global memory and shared memory requirements for the DP algorithm [<xref ref-type="bibr" rid="CR20">20</xref>] are analyzed. The memory usage is reduced by discarding unnecessary data after each iteration and applying a compression technique. Different parallelization schemes were then designed, and the best scheme was applied according to parameter constraint assessment (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>). We evaluated those schemes on the basis of global memory requirements, shared memory requirements, memory access patterns and the amount of parallelism. For the experimental data analysis section, we compared the difference between the performance of our GPU algorithm and that of the previous CPU version.</p>
      <sec id="Sec11">
        <title>Memory usage reduction</title>
        <p id="Par30">Given that the sizes of <italic>C</italic> and <italic>L</italic> matrix are proportional to 10<sup><italic>D</italic></sup> (as well as <italic>n</italic> and <italic>r</italic>), they become too large to fit in GPU memory for larger values of <italic>D</italic>. In fact, only certain values of <italic>C</italic> are required to be accessible at any time during the execution of the algorithm. At a loop state <italic>s</italic>, only the sub matrices c<sub><italic>s</italic>-1,:,:</sub> and <italic>c</italic>
<sub><italic>s</italic>,:,:</sub> are used to update the matrix <italic>C</italic>; we denote these two matrices as <inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C^{ - } = \left\{ {C_{w,r}^{ - } } \right\}_{w,r}$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:msup><mml:mi>C</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mfenced close="}" open="{" separators=""><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:msubsup></mml:mfenced><mml:mrow><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq26.gif"/></alternatives></inline-formula> and <inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C^{ + } = \left\{ {C_{w,r}^{ + } } \right\}_{w,r}$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:msup><mml:mi>C</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mfenced close="}" open="{" separators=""><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msubsup></mml:mfenced><mml:mrow><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq27.gif"/></alternatives></inline-formula> respectively. At the iteration on position <italic>s</italic>, the size of <italic>C</italic>
<sup>−</sup> and <italic>C</italic>
<sup>+</sup> are each <inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{max}^{\prime}$$\end{document}</tex-math><mml:math id="M56"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq28.gif"/></alternatives></inline-formula> × <italic>R</italic>. Since we used the <italic>C</italic>
<sup>−</sup> and <italic>C</italic>
<sup>+</sup> to replace <italic>C</italic>, we only required 2 × <inline-formula id="IEq29"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{max}^{\prime}$$\end{document}</tex-math><mml:math id="M58"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq29.gif"/></alternatives></inline-formula> × <italic>R</italic> values instead of <italic>n</italic> × <inline-formula id="IEq30"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{max}^{\prime}$$\end{document}</tex-math><mml:math id="M60"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq30.gif"/></alternatives></inline-formula> × <italic>R</italic>, thus representing 100(1 − 2/<italic>n</italic>)% of saved memory. Because the number of bytes per floating type value is 4, 8 × <inline-formula id="IEq31"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{max}^{\prime}$$\end{document}</tex-math><mml:math id="M62"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq31.gif"/></alternatives></inline-formula> × <italic>R</italic> bytes of global memory are used to store <italic>C</italic>. For a scaffold with 10 substituted positions, 80% of the memory can be reduced. On the other hand, all values of <italic>L</italic> from <italic>s</italic> = <italic>0</italic> to <italic>n</italic> must be kept in the device memory until the end of the execution because <italic>L</italic> must be traversed to retrieve the lists of the selected sidechains for generation of compounds having the highest probability values in <italic>C</italic>. To reduce memory usage, we designed a compression technique. We created a compressed matrix <italic>L</italic>
<sup><italic>c</italic></sup>, denoted <inline-formula id="IEq32"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L^{c} = \left\{ {l_{w,r}^{c} } \right\}_{w,r}$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mi>c</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mfenced close="}" open="{" separators=""><mml:msubsup><mml:mi>l</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msubsup></mml:mfenced><mml:mrow><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq32.gif"/></alternatives></inline-formula>, defined by <inline-formula id="IEq33"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\forall \left( {w,r} \right),l_{w,r}^{c} = \overline{{l_{1,w,r} }} \cdot \overline{{l_{2,w,r} }} \cdots \overline{{l_{n - 1,w,r} }} \cdot \overline{{l_{n,w,r} }}$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mo>∀</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:msubsup><mml:mi>l</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mover><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>¯</mml:mo></mml:mover><mml:mo>·</mml:mo><mml:mover><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>¯</mml:mo></mml:mover><mml:mo>⋯</mml:mo><mml:mover><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>¯</mml:mo></mml:mover><mml:mo>·</mml:mo><mml:mover><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq33.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq34"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{{l_{s,w,r} }}$$\end{document}</tex-math><mml:math id="M68"><mml:mover><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq34.gif"/></alternatives></inline-formula> refers to the binary code of <italic>l</italic>
<sub><italic>s,w,r</italic></sub>, and denotes the string concatenation. For a given value (<italic>w,r</italic>), since each of <italic>k</italic>
<sub><italic>s,w,r</italic></sub> and <inline-formula id="IEq35"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_{s,w,r}^{prev}$$\end{document}</tex-math><mml:math id="M70"><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq35.gif"/></alternatives></inline-formula> is declared as 16-bits integer in DP algorithm, we totally require <italic>n</italic> × <italic>32</italic>-bits integer to store <italic>n</italic> values of <italic>k</italic>
<sub><italic>s,w,r</italic></sub> and <inline-formula id="IEq36"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_{s,w,r}^{prev}$$\end{document}</tex-math><mml:math id="M72"><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq36.gif"/></alternatives></inline-formula> without compression. In G.A.M.E., we merged totally <italic>n</italic> values of <inline-formula id="IEq37"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {k_{s,w,r} ,r_{s,w,r}^{prev} } \right)$$\end{document}</tex-math><mml:math id="M74"><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq37.gif"/></alternatives></inline-formula> (<italic>s</italic> = 0 to <italic>n</italic> for a given (<italic>w,r</italic>)) into two 32-bits integers. The number of bits required to store <italic>k</italic>
<sub><italic>s,w,r</italic></sub> and <inline-formula id="IEq38"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_{s,w,r}^{prev}$$\end{document}</tex-math><mml:math id="M76"><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq38.gif"/></alternatives></inline-formula> are ⌊<italic>log</italic>
<sub>2</sub>(<italic>k</italic>
<sub><italic>s</italic></sub>) + 1⌋ and ⌊<italic>log</italic>
<sub>2</sub>(<italic>R</italic>) + 1⌋, respectively. By summation of the total <italic>n</italic> values of bits for <inline-formula id="IEq39"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {k_{s,w,r} ,r_{s,w,r}^{prev} } \right)$$\end{document}</tex-math><mml:math id="M78"><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq39.gif"/></alternatives></inline-formula>, this compression technique were then be limited to the constraints described in Eqs. <xref rid="Equ1" ref-type="">1</xref> and <xref rid="Equ2" ref-type="">2</xref>. After using the <italic>L</italic>
<sup><italic>c</italic></sup> compression technique, only two 32-bit integers are used for each <inline-formula id="IEq40"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l^{{_{w,r}^{c} }}$$\end{document}</tex-math><mml:math id="M80"><mml:msup><mml:mi>l</mml:mi><mml:msubsup><mml:mrow/><mml:mrow><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msubsup></mml:msup></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq40.gif"/></alternatives></inline-formula>. Therefore, only 8 × <inline-formula id="IEq41"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{max}^{\prime}$$\end{document}</tex-math><mml:math id="M82"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq41.gif"/></alternatives></inline-formula> × <italic>R</italic> bytes of global memory are needed to store <italic>L</italic> instead of 8 × <italic>n</italic> × <inline-formula id="IEq42"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{max}^{\prime}$$\end{document}</tex-math><mml:math id="M84"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq42.gif"/></alternatives></inline-formula> × <italic>R</italic> bytes. In this case, 100 (1 − 1/<italic>n</italic>)% memory is saved.<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathop \sum \limits_{{{\text{s}} = 0}}^{{{\text{n}} - 1}} { \lfloor }log_{2} \left( {{\text{k}}_{\text{s}} } \right) + 1{ \rfloor } \le 32$$\end{document}</tex-math><mml:math id="M86" display="block"><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mrow><mml:mtext>s</mml:mtext><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mtext>n</mml:mtext><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mo>⌊</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mtext>k</mml:mtext><mml:mtext>s</mml:mtext></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>⌋</mml:mo><mml:mo>≤</mml:mo><mml:mn>32</mml:mn></mml:mrow></mml:math><graphic xlink:href="13321_2017_238_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n{ \lfloor }log_{2} \left( R \right) + 1{ \rfloor } \le 32$$\end{document}</tex-math><mml:math id="M88" display="block"><mml:mrow><mml:mi>n</mml:mi><mml:mo>⌊</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>R</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>⌋</mml:mo><mml:mo>≤</mml:mo><mml:mn>32</mml:mn></mml:mrow></mml:math><graphic xlink:href="13321_2017_238_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>
</p>
      </sec>
      <sec id="Sec12">
        <title>Parallelization on the GPU</title>
        <p id="Par31">According to the iterative nature of the dynamic programming, it is not possible to parallelize over <italic>n</italic> in the first loop of the DP algorithm. Nevertheless, it would be possible to parallelize the DP program in the following designs: (<italic>a</italic>) have each block handle a range of <italic>w</italic> values, and have each thread in this block process a <italic>w</italic> value, (<italic>b</italic>) have each block handle a <italic>w</italic> value, and have each thread in this block process a <italic>k</italic> value, or (<italic>c</italic>) have each block handle a <italic>w</italic> value, and have each thread in this block process a <italic>r</italic> value. In this study, we implemented the GPU parallelization based on the design (<italic>a</italic>) because it enabled the highest degree of parallelism. According to design (<italic>a</italic>), the pseudocode of our DP CUDA kernel is provided in <italic>Algorithm 1</italic> (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Each thread with thread index (<italic>threadIdx</italic>) processes <italic>Algorithm 1</italic>, and the loops for (<italic>k,r</italic>) ∈ [|0,<italic>h</italic>|] × [|0,<italic>R</italic>|] are implemented sequentially from lines 6 to 17. <italic>BlockDim</italic> is the number of threads per block, and <italic>BlockIdx</italic> represents the Block index of the processing thread on <italic>threadIdx</italic>. Thus, the code in line 2 evaluates the required <italic>mass</italic> (molecular weight) that is processed by the thread on <italic>threadIdx</italic>. <italic>C</italic>
<sup>−</sup>, <italic>C</italic>
<sup>+</sup> and <italic>L</italic>
<sup><italic>c</italic></sup> are allocated in the GPU global memory, whereas <italic>K</italic>, <italic>W</italic>′, <italic>P</italic> are stored in GPU Constant memory (i.e., the constant memory provides a cached access to constants). The pseudocode from lines 18 to 22 is similar to Su’s DP [<xref ref-type="bibr" rid="CR20">20</xref>], which uses a sort algorithm to retrieve the top R values of <italic>T</italic>
<sub><italic>r</italic></sub> and updates the <italic>C</italic> and <italic>L</italic> matrices. The parameter limitations in the G.A.M.E. were described in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>.<fig id="Fig1"><label>Fig. 1</label><caption><p>The <italic>Algorithm 1 Kernel</italic>. The <italic>sharedMem</italic> variable is a pointer to the dynamically allocated shared memory. The <italic>push</italic>(<italic>X,y</italic>) function appends element <italic>y</italic> to array <italic>X</italic> and returns <italic>X</italic>. <italic>sort</italic>(<italic>X,R,i</italic>) returns the top <italic>R</italic> elements when the elements of <italic>X</italic> are sorted by their <italic>i</italic>th component. <italic>encode</italic>(<italic>X,s,y</italic>) writes the binary code of <italic>y</italic> at the <italic>s</italic>th offset of <inline-formula id="IEq44"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X\left( {slog_{2} \left( R \right)} + \sum\nolimits_{i = 0}^{n} {{ \lfloor }log_{2} \left( {k_{i} } \right) + 1{ \rfloor }} \right)$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:mi>X</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>s</mml:mi><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>R</mml:mi></mml:mfenced></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:mo>⌊</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>⌋</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq44.gif"/></alternatives></inline-formula> and returns <italic>X</italic>
</p></caption><graphic xlink:href="13321_2017_238_Fig1_HTML" id="MO3"/></fig>
</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec13">
    <title>Results and discussion</title>
    <sec id="Sec14">
      <title>Parameter tuning of GPU computing</title>
      <p id="Par32">Before exploiting the advantages of GPU computing, several parameters must be determined to ensure the optimal performance of G.A.M.E. We preliminarily analyzed our datasets and inferred the optimal values of <italic>R</italic>, <italic>D</italic> and <italic>w</italic>
<sub><italic>max</italic></sub>, which are all related to the memory usage and time complexity of G.A.M.E. Among them, <italic>R</italic> is the output number of structures, <italic>D</italic> is the number of decimal digits of mass for computing, and <italic>w</italic>
<sub><italic>max</italic></sub> is the maximal total molecular weight of extended side chains on a given scaffold. On the basis of the 83,242 scaffold files, the average number of summation of the molecular weights from all possible substituents in each compound was 89.42, and the average number of maximum possible sidechains of scaffolds, <italic>h</italic>, was 4. Additionally, the average number of required ranks, <italic>R</italic>, that matched the verified searched ground truth data among the four testing datasets was 8. To calculate the top R solutions of a given scaffold, the CSCCP program outputs R × <italic>N</italic>
<sub><italic>r</italic></sub> solutions, where <italic>N</italic>
<sub><italic>r</italic></sub> is the number of configurations in one given scaffold; on average, <italic>N</italic>
<sub><italic>r</italic></sub> is 5. According to the previous studies [<xref ref-type="bibr" rid="CR20">20</xref>], the value of <italic>R</italic> in 3 is sufficient to identify the correct structures in four testing datasets. The number of decimal digits, <italic>D</italic>, with a value of 5 is also sufficient to produce the real optimal solutions among the four testing cases. Therefore, the values 3, 5, and 500 for <italic>R</italic>, <italic>D</italic>, and <italic>w</italic>
<sub><italic>max</italic></sub>, respectively, were adequate to solve the CSCCP using our algorithm.</p>
    </sec>
    <sec id="Sec15">
      <title>Performance of GPU-based G.A.M.E. compared with that of CPU DP</title>
      <p id="Par33">To compare the performance of our G.A.M.E. algorithm with Su’s original CPU DP algorithm, analyses were performed on NPDB, with different <italic>D</italic> and number of threads per block in GPU kernel, as shown in Figs. <xref rid="Fig2" ref-type="fig">2</xref> and <xref rid="Fig3" ref-type="fig">3</xref>. Figure <xref rid="Fig2" ref-type="fig">2</xref> illustrates that the acceleration of G.A.M.E. with respect to CPU DP becomes increasingly significant as <italic>D</italic> increases and is the most significant at <italic>D</italic> = 5. The execution time was calculated from averaging the running time of 1713 suitable scaffolds from the NPDB. The parameters of <italic>ThreadsPerBlock</italic>, <italic>w</italic>
<sub><italic>max</italic></sub>, and <italic>R</italic> are set to 64, 500 and 3, respectively. As expected, the performance of G.A.M.E. grew with the number of decimal digits, <italic>D</italic>, because the amount of computation is proportional to 10<sup><italic>D</italic></sup>. By increasing the value of <italic>D</italic>, the amount of parallelism was maximized. When <italic>D</italic> = 0, the GPU was under-utilized, thus leading G.A.M.E. to be slower than the CPU DP. The average running time of G.A.M.E. was 0.0108 s when <italic>D</italic> = 0, whereas the CPU DP average running time was 0.0029 s. When D = 5, the average running time of G.A.M.E. was 1.54 s. By comparison, CUP DP had an average running time of 146.77 s. In fact, the running time of CPU DP dramatically increased, whereas G.A.M.E. remained within an appropriate time when <italic>D</italic> increased. Overall, G.A.M.E. showed a successful hardware-accelerated performance increase relative to the performance of Su’s original DP algorithm. Furthermore, since the accuracy of the DP algorithm has been demonstrated by Su [<xref ref-type="bibr" rid="CR20">20</xref>], and we did not change the core of the original DP algorithm [<xref ref-type="bibr" rid="CR20">20</xref>] in the G.A.M.E. algorithm, our system must maintain the same accuracy.<fig id="Fig2"><label>Fig. 2</label><caption><p>Acceleration of G.A.M.E. relative to Su’s CPU DP as a function of the number of decimal digits, <italic>D</italic>. Each data point is obtained by averaging the running time of 1713 suitable scaffolds from the NPDBs. Fixed parameters: <italic>ThreadsPerBlock</italic> = 64</p></caption><graphic xlink:href="13321_2017_238_Fig2_HTML" id="MO4"/></fig>
<fig id="Fig3"><label>Fig. 3</label><caption><p>Running time of G.A.M.E. compared with Su’s CPU DP. Each bar was obtained by averaging the running time of the 500 different randomly selected scaffold configurations from the NPDBs, sharing the same number of threads per block. Fixed parameters: <italic>D</italic> = 5, <italic>w</italic>
<sub><italic>max</italic></sub> = 500</p></caption><graphic xlink:href="13321_2017_238_Fig3_HTML" id="MO5"/></fig>
</p>
      <p id="Par34">Whereas Fig. <xref rid="Fig2" ref-type="fig">2</xref> focused on the effect of the number of decimal digits, <italic>D</italic>, on performance, Fig. <xref rid="Fig3" ref-type="fig">3</xref> shows that G.A.M.E. is stable in every case and provides over 64-fold acceleration when the number of threads per block in GPU kernel is 32. In the GPU programming environment, a GPU kernel launches a grid of thread blocks to attain parallel computing. The number of threads in each thread block was denoted by <italic>ThreadsPerBlock</italic> in this study. <italic>ThreadsPerBlock</italic> will dominate both the time performance and memory limitation of the computation. (Detailed definition and relation of blocks, threads, and memory in GPU kernel was described in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). For evaluation of time performance with different <italic>ThreadsPerBlock in G.A.M.E.,</italic> the average running time in seconds was calculated by averaging the running time with samplings of 500 randomly chosen scaffold configurations among the NPDB for cases with 32, 64, 128, 256 and 512 threads per block. In all cases with more than 32 threads per block, the running time was below 3 s, whereas Su’s CPU DP ran in 144 s on average. Among these cases, we obtained an average acceleration factor of 82.38. Therefore, we can expect that for compounds with higher <italic>h</italic> and a larger <italic>w</italic>
<sub><italic>max</italic></sub>, the DP algorithm required longer execution time to solve CSCCP, whereas G.A.M.E. continued to execute in relatively lower running time. Given the different <italic>ThreadsPerBlock</italic>, the average execution time of G.A.M.E. were all similar, stable, and sufficiently short to solve CSCCP in practical cases because of the successful parallel computations.</p>
    </sec>
    <sec id="Sec16">
      <title>Optimal number of mass decimal digits for G.A.M.E.</title>
      <p id="Par35">To determine the applicability of our G.A.M.E. implementation, we first performed a series of tests to estimate what proportion of the NPDB scaffolds could be used as an input for G.A.M.E. We listed the different reasons causing the CSCCP to be non-feasible and evaluated the proportions of unique non-feasible cases. Table <xref rid="Tab1" ref-type="table">1</xref> illustrates the percentage of feasible cases within all configurations of scaffolds of the NPDB for a target weight <inline-formula id="IEq43"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{max}^{\prime}$$\end{document}</tex-math><mml:math id="M92"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_238_Article_IEq43.gif"/></alternatives></inline-formula> = 500 × 10<sup><italic>D</italic></sup> and with the value of <italic>D</italic> increasing from 0 to 7. The feasible cases indicate the configurations of given scaffolds that could be performed well in G.A.M.E., adhering to all hardware-imposed constraints. The proportions were obtained by analyzing 51,562 suitable configurations of all 83,242 scaffolds of the NPDB when <italic>w</italic>
<sub><italic>max</italic></sub> = 500. We found that 99.28% of the cases were feasible for <italic>D</italic> ≤ 5. For <italic>D</italic> = 6, only 32.94% of the cases were feasible, and for <italic>D</italic> = 7, the proportion of feasible cases was 1.06%. In other words, cases with <italic>D</italic> values larger than 6 are beyond the limit of G.A.M.E. Nevertheless, the previous studies [<xref ref-type="bibr" rid="CR20">20</xref>] showed that a value of <italic>D</italic> = 5 is sufficient to identify the correct structures in four testing datasets. It is unnecessary to waste the memory space and delay the execution time by using too many decimal digits, because statistically real solutions can still be output when <italic>D</italic> is less than 6.<table-wrap id="Tab1"><label>Table 1</label><caption><p>The percentage of feasible cases within all configurations of scaffolds of the NPDBs</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Number of decimal digits, <italic>D</italic>
</th><th align="left">≤5</th><th align="left">6</th><th align="left">7</th></tr></thead><tbody><tr><td align="left">Proportion of feasible cases (%)</td><td char="." align="char">99.28</td><td char="." align="char">32.94</td><td char="." align="char">1.06</td></tr></tbody></table><table-wrap-foot><p>The statistics were obtained from all scaffolds of the NPDBs. Fixed parameters: <italic>w</italic>
<sub><italic>max</italic></sub> = 500</p></table-wrap-foot></table-wrap>
</p>
      <p id="Par36">We then analyzed the reason why some cases are not feasible, using the case in which <italic>w</italic>
<sub><italic>max</italic></sub> = 500. Table <xref rid="Tab2" ref-type="table">2</xref> illustrates the different types of problems distributed among non-feasible cases. Most of the cases were not feasible when <italic>D</italic> ≥ 6 because the usage of total global memory exceeded maximal resource of the system. Furthermore, since the design of compression technique (described in “<xref rid="Sec11" ref-type="sec">Memory usage reduction</xref>” section) for memory reduction in G.A.M.E. was limited in Eq. <xref rid="Equ1" ref-type="">1</xref> and <xref rid="Equ2" ref-type="">2</xref>, the compression restraints made 369 configurations were not feasible in all cases of <italic>D</italic>.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Statistics on non-feasible cases</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Configurations with specific problem types</th><th align="left">D ≤ 5</th><th align="left">D = 6</th><th align="left">D = 7</th></tr></thead><tbody><tr><td align="left">Insufficient global memory (Supp. Eq. 1)</td><td char="." align="char">0</td><td char="." align="char">34,209</td><td char="." align="char">50,646</td></tr><tr><td align="left">Compression impossible (Eqs. <xref rid="Equ1" ref-type="">1</xref> and <xref rid="Equ2" ref-type="">2</xref>)</td><td char="." align="char">369</td><td char="." align="char">0</td><td char="." align="char">0</td></tr><tr><td align="left">Both problems</td><td char="." align="char">0</td><td char="." align="char">369</td><td char="." align="char">369</td></tr><tr><td align="left">Total</td><td char="." align="char">369</td><td char="." align="char">34,578</td><td char="." align="char">51,015</td></tr></tbody></table><table-wrap-foot><p>The statistics were obtained on the non-feasible configurations of Table <xref rid="Tab1" ref-type="table">1</xref>. Fixed parameters: <italic>w</italic>
<sub><italic>max</italic></sub> = 500</p></table-wrap-foot></table-wrap>
</p>
    </sec>
    <sec id="Sec17">
      <title>Hardware-imposed limitations</title>
      <p id="Par37">By means of hardware acceleration to speed up the CPU DP algorithm for CSCCP, certain parameters of the developed G.A.M.E. suffered from hardware-imposed constraints. Table <xref rid="Tab3" ref-type="table">3</xref> lists three types of constraints of the observed resources for different parameters on the NVIDIA<sup>®</sup> Tesla K40c. The first row in Table <xref rid="Tab3" ref-type="table">3</xref> shows the evaluated maximum molecular weight (<italic>w</italic>
<sub><italic>max</italic></sub>) for different values in <italic>R</italic> and <italic>D</italic>, according to an assessment of the parameter constraints (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Eq. 3). The <italic>w</italic>
<sub><italic>max</italic></sub> must be less than or equal to 2499 (Da) for <italic>R</italic> = 3, compared with 749 (Da) for <italic>R</italic> = 10. The total required global memory based on different <italic>R</italic> values when <italic>D</italic> = 5 and <italic>w</italic>
<sub><italic>max</italic></sub> = 500 is listed in the second row of Table <xref rid="Tab3" ref-type="table">3</xref>. Whenever the value of <italic>R</italic> is 3 or 10, the required memories (2.24 GB or 7.45 GB) are still under the capacity of the 11,440 MB global memory of the NVIDIA<sup>®</sup> Tesla K40c. From the parameter constraint assessment (See Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Eq. 4), the possible maximum number of threads per block for parallel computation given by different <italic>R</italic> and <italic>h</italic> are shown in the third row of Table <xref rid="Tab3" ref-type="table">3</xref>. Lower values of <italic>R</italic> and <italic>h</italic> correspond to a higher number of threads per block that the algorithm can execute for parallelization. To ensure stable computing, our algorithm automatically calculates the possible maximum number of threads per block according to the parameters <italic>R</italic> and <italic>h</italic>. If there are cases that exceed the constraint of the maximum molecular weight (<italic>w</italic>
<sub><italic>max</italic></sub> = 500) and the compression technique of Eqs. <xref rid="Equ1" ref-type="">1</xref> and <xref rid="Equ2" ref-type="">2</xref>, the system ignores those non-feasible calculations.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Parameter constraints on the NVIDIA<sup>®</sup> Tesla K40c</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Resources</th><th align="left">Constraints</th><th align="left">Parameters</th></tr></thead><tbody><tr><td align="left" rowspan="2">Target weight (<italic>w</italic>
<sub><italic>max</italic></sub>)</td><td align="left">≤2499 Da</td><td align="left"><italic>R</italic> = 3, <italic>D</italic> = 5</td></tr><tr><td align="left">≤749 Da</td><td align="left"><italic>R</italic> = 10, <italic>D</italic> = 5</td></tr><tr><td align="left" rowspan="2">Memory usage</td><td align="left">2.24 GB</td><td align="left"><italic>R</italic> = 3, <italic>D</italic> = 5, <italic>w</italic><sub><italic>max</italic></sub> = 500</td></tr><tr><td align="left">7.45 GB</td><td align="left"><italic>R</italic> = 10, <italic>D</italic> = 5, <italic>w</italic><sub><italic>max</italic></sub> = 500</td></tr><tr><td align="left" rowspan="5">Number of threads per block (<italic>ThreadsPerBlock)</italic>
</td><td align="left">≤512</td><td align="left"><italic>R</italic> = 2, <italic>h</italic> = 4</td></tr><tr><td align="left">≤256</td><td align="left"><italic>R</italic> = 3, <italic>h</italic> = 5</td></tr><tr><td align="left">≤128</td><td align="left"><italic>R</italic> = 3, <italic>h</italic> = 10</td></tr><tr><td align="left">≤64</td><td align="left"><italic>R</italic> = 6, <italic>h</italic> = 10</td></tr><tr><td align="left">≤32</td><td align="left"><italic>R</italic> = 10, <italic>h</italic> = 10</td></tr></tbody></table></table-wrap>
</p>
    </sec>
    <sec id="Sec18">
      <title>Acceleration validation in real cases</title>
      <p id="Par38">In order to validate the accelerated G.A.M.E. system, we used four testing sets from real analysis data of four natural products: <italic>Cuscuta chinensis</italic>, <italic>Ophiopogon aponicas</italic>, <italic>Polygonum multiflorum</italic>, and <italic>Angelica sp.</italic> The execution time was calculated from averaging the running time of 10 random samplings of 20 cases in each sampling within these four testing datasets. The <italic>R</italic> parameter was set to 3; the <italic>w</italic>
<sub><italic>max</italic></sub> parameter was from molecular weights detected from real MS experiments; and the <italic>ThreadsPerBlock</italic> parameter was automatically calculated with the most blocks feasible calculated by the parameter assessment equation (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Eq. 4). The speed up factors, the CPU DP average running time divided by GPU running time, was illustrated in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. In this testing analysis, the GPU was under-utilized when D = 0. The average running time of G.A.M.E. was 0.0207 s when <italic>D</italic> = 0, whereas the CPU DP average running time was 0.0047 s. Although G.A.M.E. cannot show the improved performance when <italic>D</italic> = 0, the GPU programming showed the significant accelerations when <italic>D</italic> is greater than 0. When D = 5, the average running time of G.A.M.E. was 20.72 s. By comparison, CUP DP had an average running time of 324.16 s. As a result, in real cases that <italic>w</italic>
<sub><italic>max</italic></sub> values were set from real experiments, the G.A.M.E. also dramatically accelerated the performance compared with Su’s original DP algorithm. In this section, we have sufficiently demonstrated that G.A.M.E. outperformed the process of the CSCCP problem in real cases, compared with the original DP algorithm.<fig id="Fig4"><label>Fig. 4</label><caption><p>Acceleration of G.A.M.E. relative to Su’s CPU DP as a function of the number of decimal digits, <italic>D</italic>. Each data point is obtained by averaging the running time of 200 randomly sampled scaffolds and molecular mass combinations from the four natural products</p></caption><graphic xlink:href="13321_2017_238_Fig4_HTML" id="MO6"/></fig>
</p>
    </sec>
  </sec>
  <sec id="Sec19">
    <title>Conclusions</title>
    <p id="Par39">Our G.A.M.E. method is executed in silico to predict the constituents of a mixture on the basis of its mass spectral data by exploiting a scaffold database with sidechain probability information, such as Harn’s Natural Product Scaffold database. By harnessing the power of modern GPU graphic cards, G.A.M.E. outperforms Su’s DP algorithm with an average acceleration factor of 33 in 99% of the cases. It can be applied to situations in which up to 5 decimal digits are required. Our studies demonstrate three advantages in using a GPU-accelerated algorithm to solve CSCCP: (a) the algorithm can be implemented easily, (b) CSCCP can be appropriately divided into many small tasks to perform parallel computations, and (c) a stable running time is achieved. We conclude that our hardware-accelerated algorithm is an excellent method to solve CSCCP. As expected, with the rapid development of PC hardware, the use of GPU acceleration or even the application of distributed systems will be a practical way to directly and efficiently identify the components of an unknown mixture.</p>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec20">
        <title>Additional file</title>
        <p>
          <media position="anchor" xlink:href="13321_2017_238_MOESM1_ESM.docx" id="MOESM1">
            <caption>
              <p><bold>Additional file 1.</bold> Contains the supplementary information of the manuscript. This includes (1) overview of GPU programming framework with CUDA; (2) parameter limitations assessment imposed by hardware; (3) an introduction for the prediction procedure in NP-StructurePredictor; (4) an introduction of dynamic algorithm for structure elucidation.</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>G.A.M.E.</term>
        <def>
          <p id="Par2">GPU-accelerated mixture elucidator</p>
        </def>
      </def-item>
      <def-item>
        <term>DP</term>
        <def>
          <p id="Par3">dynamic programming</p>
        </def>
      </def-item>
      <def-item>
        <term>CUDA</term>
        <def>
          <p id="Par4">compute unified device architecture</p>
        </def>
      </def-item>
      <def-item>
        <term>MS</term>
        <def>
          <p id="Par5">mass spectrometry</p>
        </def>
      </def-item>
      <def-item>
        <term>NMR</term>
        <def>
          <p id="Par6">nuclear magnetic resonance</p>
        </def>
      </def-item>
      <def-item>
        <term>CASE</term>
        <def>
          <p id="Par7">computer-aided structure elucidation</p>
        </def>
      </def-item>
      <def-item>
        <term>NPDB</term>
        <def>
          <p id="Par8">natural products database</p>
        </def>
      </def-item>
      <def-item>
        <term>CSCCP</term>
        <def>
          <p id="Par9">chemical substituent core combinatorial problem</p>
        </def>
      </def-item>
      <def-item>
        <term>VGA</term>
        <def>
          <p id="Par10">video graphics array</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Electronic supplementary material</bold>
      </p>
      <p>The online version of this article (doi:10.1186/s13321-017-0238-7) contains supplementary material, which is available to authorized users.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Authors’ contributions</title>
    <p>AS designed and implemented the algorithm. AS, BHS, and YST ran tests. YJT provided guidance to the work. AS drafted the manuscript. BHS, YST, TTL, OAL, and YJT revised the manuscript. All authors read and approved the final manuscript.</p>
    <sec id="FPar1">
      <title>Acknowledgements</title>
      <p id="Par40">The authors thank Yuan Ling Ku, Ph.D. (Medical and Pharmaceutical Industry Technology and Development) for providing the natural product test cases used in our experiments. The authors are also grateful to Computer and Information Networking Center, National Taiwan University for the support of high-performance computing facilities.</p>
    </sec>
    <sec id="FPar2">
      <title>Competing interests</title>
      <p id="Par41">The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="FPar5">
      <title>Funding</title>
      <p id="Par44">Taiwan Ministry of Science and Technology (105-3011-F-002-010-) and the Department of Computer Science and Information Engineering of National Taiwan University.</p>
    </sec>
    <sec id="FPar6">
      <title>Publisher’s Note</title>
      <p id="Par45">Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harvey</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Edrada-Ebel</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Quinn</surname>
            <given-names>RJ</given-names>
          </name>
        </person-group>
        <article-title>The re-emergence of natural products for drug discovery in the genomics era</article-title>
        <source>Nat Rev Drug Discov</source>
        <year>2015</year>
        <volume>14</volume>
        <issue>2</issue>
        <fpage>111</fpage>
        <lpage>129</lpage>
        <pub-id pub-id-type="doi">10.1038/nrd4510</pub-id>
        <pub-id pub-id-type="pmid">25614221</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>HK</given-names>
          </name>
          <name>
            <surname>Choi</surname>
            <given-names>YH</given-names>
          </name>
          <name>
            <surname>Verpoorte</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>NMR-based metabolomic analysis of plants</article-title>
        <source>Nat Protoc</source>
        <year>2010</year>
        <volume>5</volume>
        <issue>3</issue>
        <fpage>536</fpage>
        <lpage>549</lpage>
        <pub-id pub-id-type="doi">10.1038/nprot.2009.237</pub-id>
        <pub-id pub-id-type="pmid">20203669</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Corcoran</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Mortensen</surname>
            <given-names>RW</given-names>
          </name>
          <name>
            <surname>Hansen</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Troke</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nicholson</surname>
            <given-names>JK</given-names>
          </name>
        </person-group>
        <article-title>HPLC/1H NMR spectroscopic studies of the reactive alpha-1-O-acyl isomer formed during acyl migration of S-naproxen beta-1-O-acyl glucuronide</article-title>
        <source>Chem Res Toxicol</source>
        <year>2001</year>
        <volume>14</volume>
        <issue>10</issue>
        <fpage>1363</fpage>
        <lpage>1370</lpage>
        <pub-id pub-id-type="doi">10.1021/tx010015q</pub-id>
        <pub-id pub-id-type="pmid">11599927</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Corcoran</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Spraul</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>LC-NMR-MS in drug discovery</article-title>
        <source>Drug Discov Today</source>
        <year>2003</year>
        <volume>8</volume>
        <issue>14</issue>
        <fpage>624</fpage>
        <lpage>631</lpage>
        <pub-id pub-id-type="doi">10.1016/S1359-6446(03)02749-1</pub-id>
        <pub-id pub-id-type="pmid">12867148</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van der Hooft</surname>
            <given-names>JJJ</given-names>
          </name>
          <name>
            <surname>Mihaleva</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>de Vos</surname>
            <given-names>RCH</given-names>
          </name>
          <name>
            <surname>Bino</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Vervoort</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A strategy for fast structural elucidation of metabolites in small volume plant extracts using automated MS-guided LC-MS-SPE-NMR</article-title>
        <source>Magn Reson Chem</source>
        <year>2011</year>
        <volume>49</volume>
        <fpage>S55</fpage>
        <lpage>S60</lpage>
        <pub-id pub-id-type="doi">10.1002/mrc.2833</pub-id>
        <pub-id pub-id-type="pmid">22290710</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kind</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Fiehn</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Advances in structure elucidation of small molecules using mass spectrometry</article-title>
        <source>Bioanal Rev</source>
        <year>2010</year>
        <volume>2</volume>
        <issue>1–4</issue>
        <fpage>23</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1007/s12566-010-0015-9</pub-id>
        <pub-id pub-id-type="pmid">21289855</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Elyashberg</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Gribov</surname>
            <given-names>LA</given-names>
          </name>
        </person-group>
        <article-title>Formal-logical method for interpreting infrared spectra from characteristic frequencies</article-title>
        <source>J Appl Spectrosc</source>
        <year>1968</year>
        <volume>8</volume>
        <issue>2</issue>
        <fpage>189</fpage>
        <lpage>191</lpage>
        <pub-id pub-id-type="doi">10.1007/BF00604681</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lederberg</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sutherland</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Buchanan</surname>
            <given-names>BG</given-names>
          </name>
          <name>
            <surname>Feigenbaum</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Robertson</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Duffield</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Applications of artificial intelligence for chemical inference. I. The number of possible organic compounds. Acyclic structures containing C, H, O, and N</article-title>
        <source>J Am Chem Soc</source>
        <year>1969</year>
        <volume>91</volume>
        <issue>11</issue>
        <fpage>2973</fpage>
        <lpage>2976</lpage>
        <pub-id pub-id-type="doi">10.1021/ja01039a025</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nelson</surname>
            <given-names>DB</given-names>
          </name>
          <name>
            <surname>Munk</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Gash</surname>
            <given-names>KB</given-names>
          </name>
          <name>
            <surname>Herald</surname>
            <given-names>DL</given-names>
          </name>
        </person-group>
        <article-title>Alanylactinobicyclone. Application of computer techniques to structure elucidation</article-title>
        <source>J Org Chem</source>
        <year>1969</year>
        <volume>34</volume>
        <issue>12</issue>
        <fpage>3800</fpage>
        <lpage>3805</lpage>
        <pub-id pub-id-type="doi">10.1021/jo01264a014</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sasaki</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Abe</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ouki</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sakamoto</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ochiai</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Automated structure elucidation of several kinds of aliphatic and alicyclic compounds</article-title>
        <source>Anal Chem</source>
        <year>1968</year>
        <volume>40</volume>
        <issue>14</issue>
        <fpage>2220</fpage>
        <lpage>2223</lpage>
        <pub-id pub-id-type="doi">10.1021/ac50158a061</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Christie</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Munk</surname>
            <given-names>ME</given-names>
          </name>
        </person-group>
        <article-title>The role of 2-dimensional nuclear-magnetic-resonance spectroscopy in computer-enhanced structure elucidation</article-title>
        <source>J Am Chem Soc</source>
        <year>1991</year>
        <volume>113</volume>
        <issue>10</issue>
        <fpage>3750</fpage>
        <lpage>3757</lpage>
        <pub-id pub-id-type="doi">10.1021/ja00010a018</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peng</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>CZ</given-names>
          </name>
          <name>
            <surname>Hui</surname>
            <given-names>YZ</given-names>
          </name>
        </person-group>
        <article-title>Efficient application of 2D NMR correlation information in computer-assisted structure elucidation of complex natural-products</article-title>
        <source>J Chem Inf Comput Sci</source>
        <year>1994</year>
        <volume>34</volume>
        <issue>4</issue>
        <fpage>805</fpage>
        <lpage>813</lpage>
        <pub-id pub-id-type="doi">10.1021/ci00020a013</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lindel</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Junker</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kock</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>2D-NMR-guided constitutional analysis of organic compounds employing the computer program COCON</article-title>
        <source>Eur J Org Chem</source>
        <year>1999</year>
        <volume>3</volume>
        <fpage>573</fpage>
        <lpage>577</lpage>
        <pub-id pub-id-type="doi">10.1002/(SICI)1099-0690(199903)1999:3&lt;573::AID-EJOC573&gt;3.0.CO;2-N</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blinov</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Carlson</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Elyashberg</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Martirosian</surname>
            <given-names>ER</given-names>
          </name>
          <name>
            <surname>Molodtsov</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Computer-assisted structure elucidation of natural products with limited 2D NMR data: application of the StrucEluc system</article-title>
        <source>Magn Reson Chem</source>
        <year>2003</year>
        <volume>41</volume>
        <issue>5</issue>
        <fpage>359</fpage>
        <lpage>372</lpage>
        <pub-id pub-id-type="doi">10.1002/mrc.1187</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Elyashberg</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Blinov</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Molodtsov</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Martirosian</surname>
            <given-names>ER</given-names>
          </name>
        </person-group>
        <article-title>Structure elucidator: a versatile expert system for molecular structure elucidation from 1D and 2D NMR data and molecular fragments</article-title>
        <source>J Chem Inf Comput Sci</source>
        <year>2004</year>
        <volume>44</volume>
        <issue>3</issue>
        <fpage>771</fpage>
        <lpage>792</lpage>
        <pub-id pub-id-type="doi">10.1021/ci0341060</pub-id>
        <pub-id pub-id-type="pmid">15154743</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Elyashberg</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>GE</given-names>
          </name>
        </person-group>
        <article-title>Computer-assisted structure verification and elucidation tools in NMR-based structure elucidation</article-title>
        <source>Prog Nucl Magn Reson Spectrosc</source>
        <year>2008</year>
        <volume>53</volume>
        <issue>1–2</issue>
        <fpage>1</fpage>
        <lpage>104</lpage>
        <pub-id pub-id-type="doi">10.1016/j.pnmrs.2007.04.003</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Butler</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>The role of natural product chemistry in drug discovery</article-title>
        <source>J Nat Prod</source>
        <year>2004</year>
        <volume>67</volume>
        <issue>12</issue>
        <fpage>2141</fpage>
        <lpage>2153</lpage>
        <pub-id pub-id-type="doi">10.1021/np040106y</pub-id>
        <pub-id pub-id-type="pmid">15620274</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Elyashberg</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Blinov</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Molodtsov</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Elucidating ‘undecipherable’ chemical structures using computer-assisted structure elucidation approaches</article-title>
        <source>Magn Reson Chem</source>
        <year>2012</year>
        <volume>50</volume>
        <issue>1</issue>
        <fpage>22</fpage>
        <lpage>27</lpage>
        <pub-id pub-id-type="doi">10.1002/mrc.2849</pub-id>
        <pub-id pub-id-type="pmid">22259196</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Harn Y-C (2011) Structure hunter: prediction of novel chemical structures in a mixture [Master Dissertation]. Taipei, Taiwan: National Taiwan University</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Su B-H (2012) A chemical substituents-core combinatorial optimization and hERG toxicity prediction in drug design [Ph.D. Dissertation]. Taipei, Taiwan: National Taiwan University</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Owens</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Houston</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Luebke</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Stone</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Phillips</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>GPU computing</article-title>
        <source>Proc IEEE</source>
        <year>2008</year>
        <volume>96</volume>
        <issue>5</issue>
        <fpage>879</fpage>
        <lpage>899</lpage>
        <pub-id pub-id-type="doi">10.1109/JPROC.2008.917757</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Asanovic</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bodik</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Demmel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Keaveny</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Keutzer</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kubiatowicz</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A view of the parallel computing landscape</article-title>
        <source>Commun ACM</source>
        <year>2009</year>
        <volume>52</volume>
        <issue>10</issue>
        <fpage>56</fpage>
        <lpage>67</lpage>
        <pub-id pub-id-type="doi">10.1145/1562764.1562783</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Owens</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Luebke</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Govindaraju</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kruger</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lefohn</surname>
            <given-names>AE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A survey of general-purpose computation on graphics hardware</article-title>
        <source>Comput Graph Forum</source>
        <year>2007</year>
        <volume>26</volume>
        <issue>1</issue>
        <fpage>80</fpage>
        <lpage>113</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1467-8659.2007.01012.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Sinko</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Pierce</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Bucher</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>McCammon</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Improved reweighting of accelerated molecular dynamics simulations for free energy calculation</article-title>
        <source>J Chem Theory Comput</source>
        <year>2014</year>
        <volume>10</volume>
        <issue>7</issue>
        <fpage>2677</fpage>
        <lpage>2689</lpage>
        <pub-id pub-id-type="doi">10.1021/ct500090q</pub-id>
        <pub-id pub-id-type="pmid">25061441</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clark</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Tiwary</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Borrelli</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>EB</given-names>
          </name>
          <name>
            <surname>Abel</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Prediction of protein-ligand binding poses via a combination of induced fit docking and metadynamics simulations</article-title>
        <source>J Chem Theory Comput</source>
        <year>2016</year>
        <volume>12</volume>
        <issue>6</issue>
        <fpage>2990</fpage>
        <lpage>2998</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jctc.6b00201</pub-id>
        <pub-id pub-id-type="pmid">27145262</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gowthaman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lyskov</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Karanicolas</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>DARC, 2.0: improved docking and virtual screening at protein interaction sites</article-title>
        <source>PLoS ONE</source>
        <year>2015</year>
        <volume>10</volume>
        <issue>7</issue>
        <fpage>e0131612</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0131612</pub-id>
        <pub-id pub-id-type="pmid">26181386</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Galindo-Murillo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Roe</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Cheatham</surname>
            <given-names>TE</given-names>
            <suffix>III</suffix>
          </name>
        </person-group>
        <article-title>On the absence of intrahelical DNA dynamics on the μs to ms timescale</article-title>
        <source>Nat Commun</source>
        <year>2014</year>
        <volume>5</volume>
        <fpage>5152</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms6152</pub-id>
        <pub-id pub-id-type="pmid">25351257</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Cui</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GPU-accelerated molecular dynamics simulation to study liquid crystal phase transition using coarse-grained gay-berne anisotropic potential</article-title>
        <source>PLoS ONE</source>
        <year>2016</year>
        <volume>11</volume>
        <issue>3</issue>
        <fpage>e0151704</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0151704</pub-id>
        <pub-id pub-id-type="pmid">26986851</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Karanicolas</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Ultra-high-throughput structure-based virtual screening for small-molecule inhibitors of protein–protein interactions</article-title>
        <source>J Chem Inf Model</source>
        <year>2016</year>
        <volume>56</volume>
        <issue>2</issue>
        <fpage>399</fpage>
        <lpage>411</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.5b00572</pub-id>
        <pub-id pub-id-type="pmid">26726827</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Korpar</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Šošić</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Blažeka</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Šikić</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>SW# db: GPU-accelerated exact sequence similarity database search</article-title>
        <source>PLoS ONE</source>
        <year>2015</year>
        <volume>10</volume>
        <issue>12</issue>
        <fpage>e0145857</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0145857</pub-id>
        <pub-id pub-id-type="pmid">26719890</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tyzack</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Mussa</surname>
            <given-names>HY</given-names>
          </name>
          <name>
            <surname>Williamson</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Kirchmair</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Glen</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>Cytochrome P450 site of metabolism prediction from 2D topological fingerprints using GPU accelerated probabilistic classifiers</article-title>
        <source>J Cheminform</source>
        <year>2014</year>
        <volume>6</volume>
        <fpage>29</fpage>
        <pub-id pub-id-type="doi">10.1186/1758-2946-6-29</pub-id>
        <pub-id pub-id-type="pmid">24959208</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">(2010) The Dictionary of Natural Products database is available from Chapman &amp; Hall/CRC. <ext-link ext-link-type="uri" xlink:href="http://dnp.chemnetbase.com/">http://dnp.chemnetbase.com/</ext-link> [updated 2017; cited 2017]</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Irwin</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Shoichet</surname>
            <given-names>BK</given-names>
          </name>
        </person-group>
        <article-title>ZINC—a free database of commercially available compounds for virtual screening</article-title>
        <source>J Chem Inf Model</source>
        <year>2004</year>
        <volume>45</volume>
        <fpage>177</fpage>
        <lpage>182</lpage>
        <pub-id pub-id-type="doi">10.1021/ci049714+</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>CY-C</given-names>
          </name>
        </person-group>
        <article-title>TCM Database@Taiwan: the world’s largest traditional Chinese medicine database for drug screening in silico</article-title>
        <source>PLOS One</source>
        <year>2011</year>
        <volume>6</volume>
        <fpage>e15939</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0015939</pub-id>
        <pub-id pub-id-type="pmid">21253603</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
