<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle pcbi.1011422.r001?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10491390</article-id>
    <article-id pub-id-type="pmid">37639475</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011422</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-22-01555</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
          <subj-group>
            <subject>Microbial Taxonomy</subject>
            <subj-group>
              <subject>Viral Taxonomy</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
            <subj-group>
              <subject>Microbial Taxonomy</subject>
              <subj-group>
                <subject>Viral Taxonomy</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Virology</subject>
            <subj-group>
              <subject>Viral Taxonomy</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Viruses</subject>
            <subj-group>
              <subject>Bacteriophages</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Metagenomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Microbial Genomics</subject>
              <subj-group>
                <subject>Viral Genomics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Microbial Genomics</subject>
            <subj-group>
              <subject>Viral Genomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Virology</subject>
            <subj-group>
              <subject>Viral Genomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Eukaryota</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Probability theory</subject>
            <subj-group>
              <subject>Markov models</subject>
              <subj-group>
                <subject>Hidden Markov models</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Genome Annotation</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
              <subj-group>
                <subject>Genome Annotation</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>VIRify: An integrated detection, annotation and taxonomic classification pipeline using virus-specific protein profile hidden Markov models</article-title>
      <alt-title alt-title-type="running-head">VIRify, a viral sequence analysis pipeline using virus-specific protein profile HMMs</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3848-4330</contrib-id>
        <name>
          <surname>Rangel-Pineros</surname>
          <given-names>Guillermo</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Almeida</surname>
          <given-names>Alexandre</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
        <xref rid="aff005" ref-type="aff">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3472-3736</contrib-id>
        <name>
          <surname>Beracochea</surname>
          <given-names>Martin</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sakharova</surname>
          <given-names>Ekaterina</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Marz</surname>
          <given-names>Manja</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff006" ref-type="aff">
          <sup>6</sup>
        </xref>
        <xref rid="aff007" ref-type="aff">
          <sup>7</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2907-3265</contrib-id>
        <name>
          <surname>Reyes Muñoz</surname>
          <given-names>Alejandro</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7090-8717</contrib-id>
        <name>
          <surname>Hölzer</surname>
          <given-names>Martin</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="aff007" ref-type="aff">
          <sup>7</sup>
        </xref>
        <xref rid="aff008" ref-type="aff">
          <sup>8</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8626-2148</contrib-id>
        <name>
          <surname>Finn</surname>
          <given-names>Robert D.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>The Globe Institute, Faculty of Health and Medical Sciences, University of Copenhagen, Copenhagen, Denmark</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Max Planck Tandem Group in Computational Biology, Department of Biological Sciences, Universidad de los Andes, Bogota, Colombia</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>European Molecular Biology Laboratory, European Bioinformatics Institute (EMBL-EBI), Wellcome Genome Campus, Hinxton, United Kingdom</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Wellcome Sanger Institute, Wellcome Genome Campus, Hinxton, United Kingdom</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Department of Veterinary Medicine, University of Cambridge, Cambridge, United Kingdom</addr-line>
    </aff>
    <aff id="aff006">
      <label>6</label>
      <addr-line>RNA Bioinformatics, Friedrich Schiller University, Jena, Germany</addr-line>
    </aff>
    <aff id="aff007">
      <label>7</label>
      <addr-line>European Virus Bioinformatics Center, Friedrich Schiller University, Jena, Germany</addr-line>
    </aff>
    <aff id="aff008">
      <label>8</label>
      <addr-line>Methodology and Research Infrastructure, Genome Competence Center (MF1), Robert Koch Institute, Berlin, Germany</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Ouzounis</surname>
          <given-names>Christos A.</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>CPERI, GREECE</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>guillermo.pineros@sund.ku.dk</email> (GRP); <email>rdf@ebi.ac.uk</email> (RDF)</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <volume>19</volume>
    <issue>8</issue>
    <elocation-id>e1011422</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>9</day>
        <month>8</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2023 Rangel-Pineros et al</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Rangel-Pineros et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1011422.pdf"/>
    <abstract>
      <p>The study of viral communities has revealed the enormous diversity and impact these biological entities have on various ecosystems. These observations have sparked widespread interest in developing computational strategies that support the comprehensive characterisation of viral communities based on sequencing data. Here we introduce VIRify, a new computational pipeline designed to provide a user-friendly and accurate functional and taxonomic characterisation of viral communities. VIRify identifies viral contigs and prophages from metagenomic assemblies and annotates them using a collection of viral profile hidden Markov models (HMMs). These include our manually-curated profile HMMs, which serve as specific taxonomic markers for a wide range of prokaryotic and eukaryotic viral taxa and are thus used to reliably classify viral contigs. We tested VIRify on assemblies from two microbial mock communities, a large metagenomics study, and a collection of publicly available viral genomic sequences from the human gut. The results showed that VIRify could identify sequences from both prokaryotic and eukaryotic viruses, and provided taxonomic classifications from the genus to the family rank with an average accuracy of 86.6%. In addition, VIRify allowed the detection and taxonomic classification of a range of prokaryotic and eukaryotic viruses present in 243 marine metagenomic assemblies. Finally, the use of VIRify led to a large expansion in the number of taxonomically classified human gut viral sequences and the improvement of outdated and shallow taxonomic classifications. Overall, we demonstrate that VIRify is a novel and powerful resource that offers an enhanced capability to detect a broad range of viral contigs and taxonomically classify them.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Viruses are the most abundant biological entities on our planet. Some are relevant pathogens for public health or agriculture. Still, many also play ecological roles that are critical for maintaining ecosystems. Most viruses are yet to be cultured, so their identification and characterisation depend solely on the analysis of DNA or RNA obtained from the environment. Unlike cellular organisms, viruses also lack a universal genetic marker that allows taxonomic profiling of an environmental viral community. We have manually curated a set of specific viral protein models that serve as taxonomic markers for a comprehensive range of viral taxa. Using these protein models, we developed VIRify, a computational pipeline for the detection, annotation, and taxonomic classification of viral sequences obtained from environmental DNA or RNA. Our new pipeline was efficient in detecting and classifying sequences of viruses targeting bacteria or eukaryotic organisms in mock microbial communities, samples from the world’s oceans, and a previously assembled collection of human gut viruses. VIRify is user-friendly, requires minimal interaction with the command line, and was developed with portability in mind. VIRify can enhance the exploration of viral diversity in nature and support the detection of pathogenic viruses with pandemic potential.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000268</institution-id>
            <institution>Biotechnology and Biological Sciences Research Council</institution>
          </institution-wrap>
        </funding-source>
        <award-id>BB/P027849/1</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7090-8717</contrib-id>
          <name>
            <surname>Hölzer</surname>
            <given-names>Martin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution>Deutsche Forschungsgemeinschaft</institution>
        </funding-source>
        <award-id>CRC 1076 AquaDiva</award-id>
      </award-group>
      <funding-statement>This work was supported by the Deutsche Forschungsgemeinschaft (CRC 1076 AquaDiva to MH), and the Biotechnology and Biological Sciences Research Council (BB/P027849/1 CABANA project for capacity building for bioinformatics in Latin America to GRP). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="7"/>
      <table-count count="1"/>
      <page-count count="28"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2023-09-08</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The metagenomic assemblies generated for the selected mock communities and the set of informative ViPhOGs are available on OSF at <ext-link xlink:href="https://doi.org/10.17605/OSF.IO/FBRXY" ext-link-type="uri">https://doi.org/10.17605/OSF.IO/FBRXY</ext-link>. All the scripts used for the manual curation of the ViPhOGs and the Nextflow implementation of VIRify are available at <ext-link xlink:href="https://github.com/EBI-Metagenomics/emg-viral-pipeline" ext-link-type="uri">https://github.com/EBI-Metagenomics/emg-viral-pipeline</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The metagenomic assemblies generated for the selected mock communities and the set of informative ViPhOGs are available on OSF at <ext-link xlink:href="https://doi.org/10.17605/OSF.IO/FBRXY" ext-link-type="uri">https://doi.org/10.17605/OSF.IO/FBRXY</ext-link>. All the scripts used for the manual curation of the ViPhOGs and the Nextflow implementation of VIRify are available at <ext-link xlink:href="https://github.com/EBI-Metagenomics/emg-viral-pipeline" ext-link-type="uri">https://github.com/EBI-Metagenomics/emg-viral-pipeline</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Viruses are the most abundant biological entities inhabiting our planet, with an estimated 10<sup>30</sup> virus-like particles (VLP) present in the world’s oceans [<xref rid="pcbi.1011422.ref001" ref-type="bibr">1</xref>]. Even though viruses are often acknowledged as disease-causing agents in animals and plants, many studies to date have demonstrated the pivotal role that viruses play in shaping microbial populations, particularly in the case of phages and their bacterial hosts [<xref rid="pcbi.1011422.ref002" ref-type="bibr">2</xref>–<xref rid="pcbi.1011422.ref005" ref-type="bibr">5</xref>]. The application of metagenomics-based approaches in these studies facilitated the culture-independent exploration of microbial communities, resulting in the expansion of the span of viral-host interactions that could be characterised. This approach has revealed a vast extent of uncharacterised viral genetic diversity known as "viral dark matter" [<xref rid="pcbi.1011422.ref006" ref-type="bibr">6</xref>–<xref rid="pcbi.1011422.ref011" ref-type="bibr">11</xref>] and led to the discovery of numerous uncultivated virus genomes (UViGs) [<xref rid="pcbi.1011422.ref012" ref-type="bibr">12</xref>–<xref rid="pcbi.1011422.ref015" ref-type="bibr">15</xref>]. Studies, especially in oceanic environments, have demonstrated the importance of viruses in biogeochemical cycling and metabolic modulation of ocean microbes [<xref rid="pcbi.1011422.ref012" ref-type="bibr">12</xref>,<xref rid="pcbi.1011422.ref016" ref-type="bibr">16</xref>,<xref rid="pcbi.1011422.ref017" ref-type="bibr">17</xref>].</p>
    <p>A review paper of the TARA Oceans project highlighted the urgent need for automated approaches to systematically organise the enormous virus sequencing data beyond the species level [<xref rid="pcbi.1011422.ref018" ref-type="bibr">18</xref>]. Several computational tools and resources that offer a solution to this challenge have been developed and made publicly available in the last two decades [<xref rid="pcbi.1011422.ref019" ref-type="bibr">19</xref>–<xref rid="pcbi.1011422.ref021" ref-type="bibr">21</xref>]. One of the most prominent and currently available tools is VConTACT2, which employs data on proteins shared between phage genomes to build a similarity network that is further analysed to identify clusters of evolutionarily related phages [<xref rid="pcbi.1011422.ref022" ref-type="bibr">22</xref>]. An alternative approach to the taxonomic classification of viruses involves protein profile HMMs representing clusters of homologous proteins or protein domains, which in turn serve as markers for different viral taxa, a strategy used for example by ClassiPhage [<xref rid="pcbi.1011422.ref023" ref-type="bibr">23</xref>]. Phage classification with ClassiPhage demonstrated agreement with the reference taxonomy from the International Committee on Taxonomy of Viruses (ICTV), although the generation and testing of the taxon-specific profile HMMs was solely focused on phages targeting members of the bacterial family <italic toggle="yes">Vibrionaceae</italic> [<xref rid="pcbi.1011422.ref023" ref-type="bibr">23</xref>]. More recently, a set of 31,150 profile HMMs representing proteins predicted in viral genomes from NCBI were used as the basis for a set of Random Forest classifiers aimed at assigning viral taxonomy at the order, family, and genus ranks [<xref rid="pcbi.1011422.ref024" ref-type="bibr">24</xref>]. These classifiers demonstrated very high classification accuracy (≥ 89%) at all the aforementioned ranks, suggesting that these profile HMMs (or ViPhOGs as they were named) could be the foundation for a new method that taxonomically classifies viral genomic sequences present in metagenomic datasets.</p>
    <p>Existing pipelines such as VirMiner, iVirus and KBase enable taxonomic and functional characterisation of viral contigs in metagenomic datasets [<xref rid="pcbi.1011422.ref025" ref-type="bibr">25</xref>–<xref rid="pcbi.1011422.ref027" ref-type="bibr">27</xref>]. More recently, Hecatomb and MetaPhage were released to provide the scientific community with scalable and portable resources for the taxonomic profiling of viral communities, using metagenomic reads as input [<xref rid="pcbi.1011422.ref028" ref-type="bibr">28</xref>,<xref rid="pcbi.1011422.ref029" ref-type="bibr">29</xref>]. Here we present VIRify, a new pipeline that predicts virus-like sequences using canonical viral signals and annotates contigs using a comprehensive collection of profile HMMs, including our set of manually curated ViPhOGs. VIRify reduces false-positive predictions and prioritises portability via its implementation as a containerised Nextflow workflow [<xref rid="pcbi.1011422.ref030" ref-type="bibr">30</xref>], which can be directly integrated into already existing platforms such as MGnify [<xref rid="pcbi.1011422.ref031" ref-type="bibr">31</xref>]. The VIRify pipeline is freely available at <ext-link xlink:href="https://github.com/EBI-Metagenomics/emg-viral-pipeline" ext-link-type="uri">https://github.com/EBI-Metagenomics/emg-viral-pipeline</ext-link>. We showcase the application of VIRify based on two viral mock communities mostly comprised of phages [<xref rid="pcbi.1011422.ref032" ref-type="bibr">32</xref>] but also eukaryotic viruses [<xref rid="pcbi.1011422.ref033" ref-type="bibr">33</xref>], as well as 243 metagenome assemblies of the TARA Oceans project [<xref rid="pcbi.1011422.ref012" ref-type="bibr">12</xref>], and a previously generated collection of 57,866 viral genomic clusters (VCs) from globally-distributed human gut metagenomic datasets [<xref rid="pcbi.1011422.ref034" ref-type="bibr">34</xref>].</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Methods</title>
    <sec id="sec003">
      <title>Manual curation of virus-specific protein HMMs and definition of model-specific bit score thresholds</title>
      <p>We manually curated a set of taxon-specific profile HMMs by searching the original ViPhOG database [<xref rid="pcbi.1011422.ref024" ref-type="bibr">24</xref>] against all entries in UniProtKB (February 2019 version). This was achieved using hmmsearch (v3.2.1) and setting a per-sequence reporting e-value threshold of 1.0x10<sup>-3</sup>. The resulting output was analysed using in-house python scripts (<ext-link xlink:href="https://github.com/EBI-Metagenomics/emg-viral-pipeline/tree/master/bin/models_vs_uniprot_check" ext-link-type="uri">https://github.com/EBI-Metagenomics/emg-viral-pipeline/tree/master/bin/models_vs_uniprot_check</ext-link>) to identify which ViPhOGs could be used as taxon-specific markers, hereafter referred to as informative ViPhOGs. These were identified after applying the following steps to the hmmsearch output of each ViPhOG:</p>
      <list list-type="order">
        <list-item>
          <p>Reported taxonomy identifiers (taxid) were recorded, along with the highest bit score obtained for each one of them and their associated taxa at the genus, subfamily, family and order ranks.</p>
        </list-item>
        <list-item>
          <p>For each one of the target taxa recorded in the previous step, the corresponding highest bit scores were sorted and a bit score range was defined using the lowest and highest of these values.</p>
        </list-item>
        <list-item>
          <p>Starting with the target taxa at the genus rank, it was determined whether the query ViPhOG was associated with a single taxon or the bit score range for the best taxon did not overlap with the range obtained for the remaining taxa. If either of these conditions was fulfilled, then the query ViPhOG was selected as informative at the genus rank. Otherwise, the procedure was repeated at the subfamily, family and order ranks, until the query ViPhOG could be selected as informative for any of them. If the query ViPhOG was not assigned to any taxon at the searched ranks, it was considered non-informative.</p>
        </list-item>
      </list>
      <p>To leverage the data obtained from the analysis described above and set inclusion bit score thresholds suitable for each model, we defined two bit score thresholds (S1 and S2) for each informative ViPhOG. S1 was defined as the minimum bit score associated with the ViPhOG’s target taxon, whereas S2 was set as the maximum bit score obtained for other viral taxa identified through the previously described procedure. For the cases in which no further taxa were reported at the same rank as the target taxon, only S1 was set for the corresponding informative ViPhOG. Next, we define GA (gathering), TC (trusted cutoff), and NC (noise cutoff) parameters of each informative ViPhOG model. GA thresholds define reliable, curated thresholds for family memberships, NC thresholds describe the highest-scoring known false positive, and TC thresholds refer to the score of the lowest-scoring known true positive that is above all known false positives, which reflects a similar strategy to Pfam [<xref rid="pcbi.1011422.ref035" ref-type="bibr">35</xref>]. In addition, each parameter (GA, TC, NC) defines two thresholds for reporting and inclusion scores: the per-sequence threshold (GA<sub>seq</sub>, TC<sub>seq</sub>, NC<sub>seq</sub>) and the per-domain threshold (GA<sub>dom</sub>, TC<sub>dom</sub>, NC<sub>dom</sub>). We used our previously defined bit score thresholds S1 and S2 to set these six parameters specifically for each informative ViPhOG model as follows:
<disp-formula id="pcbi.1011422.e001"><alternatives><graphic xlink:href="pcbi.1011422.e001.jpg" id="pcbi.1011422.e001g" position="anchor"/><mml:math id="M1" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>G</mml:mi><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1011422.e002"><alternatives><graphic xlink:href="pcbi.1011422.e002.jpg" id="pcbi.1011422.e002g" position="anchor"/><mml:math id="M2" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>G</mml:mi><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mspace width="0.25em"/><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.25em"/><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mo>)</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>S</mml:mi><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.25em"/><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1011422.e003"><alternatives><graphic xlink:href="pcbi.1011422.e003.jpg" id="pcbi.1011422.e003g" position="anchor"/><mml:math id="M3" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>N</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:math></alternatives></disp-formula>
S1 was added as TC and GA per-sequence threshold, and trimmed by three bit to apply a per-domain threshold. Trimming was only applied if S1 did not drop below S2. The S2 bit score was unmodified and used as both per-sequence and per-domain NC. For the cases in which no S2 bit score was recorded, the noise cutoff was omitted and the sequence-specific S1 value was trimmed by three bits to allow less restrictive predictions. Finally, the values set for the GA, TC, and NC parameters were added to the header section of each informative ViPhOG’s HMM file.</p>
    </sec>
    <sec id="sec004">
      <title>Coverage of current viral taxonomy and calculation of taxon-specific ViPhOG-to-CDS ratios</title>
      <p>The set of informative ViPhOGs was screened to keep the ones that were associated with valid taxa in the latest release of ICTV’s viral taxonomy MSL#38. These were subsequently employed to determine the extent to which the lineages comprising the current viral taxonomy are covered by our set of informative ViPhOGs. A cladogram that included all viral genera and corresponding ancestral taxa in NCBI’s Taxonomy database from January 2023 was built using the ete3 python package [<xref rid="pcbi.1011422.ref036" ref-type="bibr">36</xref>,<xref rid="pcbi.1011422.ref037" ref-type="bibr">37</xref>]. The number of informative ViPhOGs identified for each viral genus was mapped on the cladogram using the interactive Tree of Life (iTOL) resource and the associated annotation file for plotting numeric data as bars [<xref rid="pcbi.1011422.ref038" ref-type="bibr">38</xref>]. In addition, taxa in the subfamily, family and order ranks for which at least one informative ViPhOG had been identified were highlighted using iTOL’s annotation file for labelling nodes with symbols (<bold><xref rid="pcbi.1011422.s001" ref-type="supplementary-material">S1 Fig</xref></bold>).</p>
      <p>Viral taxa linked to the informative ViPhOGs were categorized as prokaryotic or eukaryotic based on their target host. Currently known viral-host relationships were retrieved from Virus-Host DB (release 214 from November 2022), which contained 12,032 viral entries targeting eukaryotes and 5,491 viral entries targeting either bacteria or archaea [<xref rid="pcbi.1011422.ref039" ref-type="bibr">39</xref>].</p>
      <p>For each taxon associated with any of the informative ViPhOGs or that is part of the viral lineages covered by them, we determined the ratio between the number of associated informative ViPhOGs and the average number of CDS. To calculate this ratio, the number of informative ViPhOGs for taxa in the subfamily, family and order ranks included the models linked to the corresponding descendant taxa, in addition to those directly linked to them. To determine the average number of CDS per taxon, we identified all viral assemblies from NCBI’s Assembly database that had been deposited until November 2022 and whose CDS had been annotated. We retrieved the corresponding assembly report files and used them to extract the taxids and number of CDS per assembly. The taxids were employed to retrieve the taxa at the genus, subfamily, family and order ranks included in the lineage of each assembly, using the ete3 python package. For each one of these taxa, the average number of CDS and corresponding standard deviation were calculated based on the assemblies belonging to each one of them. Finally, we calculated the ratio between the number of informative ViPhOGs associated with each taxa and the corresponding average number of CDS, which was ultimately defined as taxon-specific ratio (TSR). The value of this parameter was set to 1 for the cases in which the number of informative ViPhOGs was higher than the average number of CDS.</p>
    </sec>
    <sec id="sec005">
      <title>Preparation of mock metagenome assemblies for benchmarking</title>
      <p>Paired-end reads of six virus-enriched samples were downloaded from ENA (study: PRJEB6941; runs: ERR575691, ERR575692, ERR576942, ERR576943, ERR576944, ERR576945) and concatenated to make a single input file [<xref rid="pcbi.1011422.ref032" ref-type="bibr">32</xref>]. Before assembly, host contamination was removed by k-mer-based decontamination against the mouse genome (Ensembl GRCm38, primary assembly) with BBDuK v38.79 from the BBTools suite (<ext-link xlink:href="https://sourceforge.net/projects/bbmap/" ext-link-type="uri">https://sourceforge.net/projects/bbmap/</ext-link>) using a k-mer size of 27. To include a metagenome assembly that also comprised eukaryotic viruses, we further obtained paired-end reads of seven virus-enriched samples (study: PRJNA319556; runs: SRR3458563-3458569) [<xref rid="pcbi.1011422.ref033" ref-type="bibr">33</xref>].</p>
      <p>For the combined data sets within both studies, two individual metagenome assemblies were performed by first cleaning the reads with fastp v0.20.0 [<xref rid="pcbi.1011422.ref040" ref-type="bibr">40</xref>] and passing them to metaSPAdes v3.14 [<xref rid="pcbi.1011422.ref041" ref-type="bibr">41</xref>] using default parameters. The ‘—only-assembler’ parameter was used to generate the assembly of the combined Neto read sets due to memory constraints. We used QUAST v5.0.2 [<xref rid="pcbi.1011422.ref042" ref-type="bibr">42</xref>] to assess basic quality metrics of the assemblies. The two assemblies (hereafter named Kleiner and Neto assemblies) can be downloaded from the Open Science Framework (<ext-link xlink:href="https://doi.org/10.17605/OSF.IO/FBRXY" ext-link-type="uri">https://doi.org/10.17605/OSF.IO/FBRXY</ext-link>).</p>
    </sec>
    <sec id="sec006">
      <title>Selection and comparison of virus prediction tools</title>
      <p>We used the multi-tool workflow “What the Phage” (WtP) [<xref rid="pcbi.1011422.ref043" ref-type="bibr">43</xref>] for comparing different virus prediction tools in an attempt to identify the best tool combination for a comprehensive initial virus prediction of our pipeline. We run WtP release v0.9.0, including VirSorter (with and without virome option), VirFinder (default and VF.modEPV_k8.rda models), PPR-Meta, DeepVirFinder [<xref rid="pcbi.1011422.ref044" ref-type="bibr">44</xref>], MARVEL [<xref rid="pcbi.1011422.ref045" ref-type="bibr">45</xref>], metaPhinder [<xref rid="pcbi.1011422.ref046" ref-type="bibr">46</xref>], VIBRANT [<xref rid="pcbi.1011422.ref047" ref-type="bibr">47</xref>], VIRNET [<xref rid="pcbi.1011422.ref048" ref-type="bibr">48</xref>], Phigaro [<xref rid="pcbi.1011422.ref049" ref-type="bibr">49</xref>] and sourmash [<xref rid="pcbi.1011422.ref050" ref-type="bibr">50</xref>] on the Kleiner and Neto assemblies. The analysis was performed on contigs that were at least 1.5 kb long to filter out shorter contigs with potentially few ORFs, which are less likely to be correctly classified by our ViPhOG-based taxonomic annotation pipeline. Previous studies have revealed that viral genomes shorter than 1.5 kb tend to code for no more than 5 proteins [<xref rid="pcbi.1011422.ref024" ref-type="bibr">24</xref>]. Based on a previous study in which global oceanic viral populations were surveyed, we manually updated the parameter configuration file of WtP to include all VirSorter predictions from categories 1–5 and to filter VirFinder results by p-values &lt; 0.05 and scores ≥ 0.7 [<xref rid="pcbi.1011422.ref012" ref-type="bibr">12</xref>].</p>
      <p>To assess the performance of each viral prediction tool and the tool combination implemented in VIRify, we identified the viral contigs in the Kleiner and Neto assemblies by aligning them to the genomes of the viruses that comprised the corresponding mock communities. For both mock communities, the set of viral genomes used as targets for the alignments included all the viruses listed in the corresponding studies, and the putative prophages predicted in the genomes of the bacteria that were either part of the mock communities or used for propagating the mock community phages. Thus, prophage prediction was conducted for the following bacterial genome sequences: <italic toggle="yes">Pseudomonas savastanoi</italic> pv. <italic toggle="yes">phaseolicola</italic> strain HB10Y (GCF_001294035), <italic toggle="yes">Salmonella enterica</italic> subsp. <italic toggle="yes">enterica</italic> serovar Typhimurium str. LT2 (NC_003197), <italic toggle="yes">Listeria monocytogenes</italic> EGD-e (NC_003210), <italic toggle="yes">Bacteroides thetaiotaomicron</italic> VPI-5482 (NC_004663), <italic toggle="yes">Enterococcus faecalis</italic> V583 (NC_004668), <italic toggle="yes">Escherichia coli</italic> B strain C3029 (NZ_CP014269), <italic toggle="yes">Lactobacillus acidophilus</italic> strain ATCC 4356 (GCF_000786395), <italic toggle="yes">Bifidobacterium animalis</italic> subsp. <italic toggle="yes">lactis</italic> ATCC 27674 (GCF_001263985), <italic toggle="yes">B</italic>. <italic toggle="yes">thetaiotaomicron</italic> strain ATCC 29741 (GCF_004349615) and <italic toggle="yes">E</italic>. <italic toggle="yes">coli</italic> DSM 30083 (NZ_CP033092). Prophages were predicted from the listed bacterial genomes using VirSorter [<xref rid="pcbi.1011422.ref051" ref-type="bibr">51</xref>], selecting the Viromes database and activating the virome decontamination mode, and PHASTER [<xref rid="pcbi.1011422.ref052" ref-type="bibr">52</xref>].</p>
      <p>VirSorter predictions in categories 4 and 5, and PHASTER predictions classified as Intact or Questionable were clustered using cd-hit-est with a sequence identity cut-off of 0.9 and default settings [<xref rid="pcbi.1011422.ref053" ref-type="bibr">53</xref>]. The set of putative prophages selected for each mock community included all VirSorter category 4 predictions, PHASTER Intact prophages, and regions that were reported both as VirSorter category 5 predictions and PHASTER Questionable prophages. Contigs from each mock community assembly were aligned to the corresponding set of viral genomes using nucmer v3.23 with default settings [<xref rid="pcbi.1011422.ref054" ref-type="bibr">54</xref>], and contigs were identified as viral when at least 70% of their length was covered by an alignment with at least 90% sequence identity. Following the identification of viral contigs within the Kleiner and Neto assemblies, the performance of the viral predictions tools tested using WtP and the combination selected for VIRify was measured via the calculation of the F1-score (<bold><xref rid="pcbi.1011422.s002" ref-type="supplementary-material">S2 Fig</xref></bold>).</p>
      <p>The output from WtP was visualised in UpSet plots and presence/absence maps that indicated whether an input contig was predicted as viral or not by each of the assessed tools (<bold><xref rid="pcbi.1011422.s003" ref-type="supplementary-material">S3 Fig</xref></bold>). MARVEL and VIRNET predictions were not included for the Neto assembly because both tools failed to process this assembly for unidentified technical reasons.</p>
    </sec>
    <sec id="sec007">
      <title>VIRify taxonomic annotation pipeline description</title>
      <sec id="sec008">
        <title>Identification of putative viral sequences</title>
        <p>Based on the results obtained with WtP and the procedure previously employed in a global oceanic survey of viral populations, it was determined that VIRify’s detection of putative viral contigs would be carried out with VirFinder, VirSorter and PPR-Meta, while putative prophage detection would be conducted with VirSorter only (<bold><xref rid="pcbi.1011422.g001" ref-type="fig">Fig 1</xref></bold>) [<xref rid="pcbi.1011422.ref012" ref-type="bibr">12</xref>,<xref rid="pcbi.1011422.ref051" ref-type="bibr">51</xref>,<xref rid="pcbi.1011422.ref055" ref-type="bibr">55</xref>,<xref rid="pcbi.1011422.ref056" ref-type="bibr">56</xref>]. Viral prediction with VirSorter is carried out using parameters ‘—db 2’ and ‘—virome’ when the processed metagenomic assemblies are generated from virome datasets (as was the case for VIRify’s benchmarking with the Kleiner and Neto assemblies), otherwise the latter parameter is not set. Putative prophages are retrieved from VirSorter predictions in prophage categories 4 and 5 as defined by the tool. Detection of putative viral contigs with VirFinder is conducted using the classifiers in the model file VF.modEPV_k8.rda, which was trained using sequences from prokaryotic and eukaryotic viruses (available at <ext-link xlink:href="https://github.com/jessieren/VirFinder" ext-link-type="uri">https://github.com/jessieren/VirFinder</ext-link>). Predicted viral contigs are classified into two different categories within the VIRify pipeline as follows: contigs reported by VirSorter in categories 1 and 2 are placed in the high-confidence category, whilst the low-confidence category includes contigs that satisfy any of the following conditions:</p>
        <list list-type="bullet">
          <list-item>
            <p>Reported by VirFinder with <italic toggle="yes">p</italic>&lt;0.05 and <italic toggle="yes">score</italic>≥0.9.</p>
          </list-item>
          <list-item>
            <p>Reported by VirFinder with <italic toggle="yes">p</italic>&lt;0.05 and <italic toggle="yes">score</italic>≥0.7, and also reported by VirSorter in category 3.</p>
          </list-item>
          <list-item>
            <p>Reported by VirFinder with <italic toggle="yes">p</italic>&lt;0.05 and <italic toggle="yes">score</italic>≥0.7, and also reported as phage by PPR-Meta.</p>
          </list-item>
        </list>
        <fig position="float" id="pcbi.1011422.g001">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1011422.g001</object-id>
          <label>Fig 1</label>
          <caption>
            <title>Overview of the VIRify pipeline.</title>
            <p><bold>(A)</bold> Starting from a set of contigs (fasta file) the pipeline preprocesses the input sequences (ID renaming, length filtering) and predicts contigs from a putative viral origin that are split into high confidence (HC), low confidence (LC) and putative prophage (PP) sets. Each selected contig is then annotated and assigned to a taxonomy, if possible. All results (annotated viral contigs) are quality-controlled with CheckV, and finally summarised and visualised. <bold>(B)</bold> The assigned taxonomy is based on the informative ViPhOG hits per contig and performed on genus, family, subfamily and finally order rank. We consider high-confidence and low-confidence ViPhOG hits and discard non-informative models where no clear taxonomy signal could be assigned. TSR—taxon-specific ratio; <inline-formula id="pcbi.1011422.e004"><alternatives><graphic xlink:href="pcbi.1011422.e004" id="pcbi.1011422.e004g" position="anchor"/><mml:math id="M4" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>C</mml:mi><mml:mi>D</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>—taxon average CDS; <italic toggle="yes">σCDS</italic><sub><italic toggle="yes">taxon</italic></sub>—taxon CDS standard deviation.</p>
          </caption>
          <graphic xlink:href="pcbi.1011422.g001" position="float"/>
        </fig>
        <p>Finally, CheckV [<xref rid="pcbi.1011422.ref057" ref-type="bibr">57</xref>] is employed to assess the quality and completeness of the categorised viral genome contigs.</p>
      </sec>
      <sec id="sec009">
        <title>Annotation of putative viral sequences with informative ViPhOGs</title>
        <p>Protein-coding sequences within putative viral contigs and prophages are detected with Prodigal v2.6.3 [<xref rid="pcbi.1011422.ref058" ref-type="bibr">58</xref>], using the standard bacterial/archaeal translation table (-g 11) and the metagenomic prediction mode (-p meta) (<xref rid="pcbi.1011422.g001" ref-type="fig">Fig 1</xref>). A recent study in which the performance of a range of ORF-prediction tools was assessed for the viral genomes available in NCBI’s RefSeq reported that Prodigal was the most accurate tool for DNA viruses, which account for ~97% of the viral genomic sequences currently available in public databases [<xref rid="pcbi.1011422.ref059" ref-type="bibr">59</xref>,<xref rid="pcbi.1011422.ref060" ref-type="bibr">60</xref>]. Amino acid sequences derived from the predicted coding sequences are scanned with the complete ViPhOG database using hmmscan v3.2.1 [<xref rid="pcbi.1011422.ref061" ref-type="bibr">61</xref>] and the model-specific bit score thresholds defined as previously described, to supersede any thresholding based on statistical significance alone. To apply the defined model-specific thresholds, we set the—cut_ga option during execution of the hmmscan command. However, to account for the set of ViPhOGs for which no bit score thresholds were defined (and therefore set to 0), an additional post-processing filter is applied to the full-sequence e-values reported in the hmmscan output (<italic toggle="yes">E</italic>≤1.0×10<sup>−3</sup>).</p>
      </sec>
      <sec id="sec010">
        <title>Taxonomic assignment of putative viral sequences</title>
        <p>In-house python scripts (see <ext-link xlink:href="https://github.com/EBI-Metagenomics/emg-viral-pipeline" ext-link-type="uri">https://github.com/EBI-Metagenomics/emg-viral-pipeline</ext-link>) are employed for parsing the hmmscan results and to provide a taxonomic assignment for all putative viral contigs and prophages, based on the reported hits against the ViPhOG database. Starting at the genus rank, the algorithm checks all taxa associated with the reported informative ViPhOGs, sorts them in descending order based on the proportion of corresponding hits, and iterates through them until it identifies a taxon that fulfils the conditions set in our voting system. The first of these conditions is that the proportion of hits for a candidate taxon must be equal to or higher than 0.6 x TSR. The default value of 0.6 sets a maximum threshold for the number of hits required to call a taxon, but the TSR leads to a reduction in the threshold value that is consistent with the density of informative ViPhOGs linked to each taxon. The second condition checks whether the number of CDS in the contig is not significantly larger than the average number of CDS calculated for the candidate taxon (i.e. <inline-formula id="pcbi.1011422.e005"><alternatives><graphic xlink:href="pcbi.1011422.e005.jpg" id="pcbi.1011422.e005g" position="anchor"/><mml:math id="M5" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>C</mml:mi><mml:mi>D</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>C</mml:mi><mml:mi>D</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mi>σ</mml:mi><mml:mi>C</mml:mi><mml:mi>D</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>). This condition was set to reduce the number of wrong taxonomic assignments, as it prevents the classification of contigs into taxa where the average number of CDS is significantly lower than the contig CDS count. If either of the conditions is not satisfied, the algorithm continues the iteration over the remaining taxa until it finds one that satisfies them. If the iteration finishes without success, the algorithm shifts to the next taxonomic rank and repeats the described procedure. The process is repeated at the subfamily, family, and order ranks until a taxon that satisfies the voting system’s conditions is found, in which case the algorithm reports the corresponding viral lineage (<xref rid="pcbi.1011422.g001" ref-type="fig">Fig 1</xref>).</p>
      </sec>
      <sec id="sec011">
        <title>Visualization of assigned viral taxonomies and ViPhOG hits</title>
        <p>Putative viral contigs with and without an assigned taxonomy are visualized using interactive Krona [<xref rid="pcbi.1011422.ref062" ref-type="bibr">62</xref>] and Sankey plots inspired by the Pavian package [<xref rid="pcbi.1011422.ref063" ref-type="bibr">63</xref>]. ORFs identified with Prodigal and their corresponding informative ViPhOG hits are visualized for each contig using the ChromoMap package v0.2 [<xref rid="pcbi.1011422.ref064" ref-type="bibr">64</xref>]. The package does not visualize exact start and stop positions for each ORF but instead relies on a more general grid view, thus visualizing the general coverage of annotated ORFs for each contig.</p>
      </sec>
    </sec>
    <sec id="sec012">
      <title>Analysis of 243 TARA Oceans assemblies with VIRify</title>
      <p>We obtained 243 ocean microbiome assemblies from ENA (<ext-link xlink:href="https://www.ebi.ac.uk/ena/browser/view/PRJEB22493" ext-link-type="uri">https://www.ebi.ac.uk/ena/browser/view/PRJEB22493</ext-link>), generated as part of the TARA Oceans microbiome study [<xref rid="pcbi.1011422.ref012" ref-type="bibr">12</xref>]. The FASTA identifiers include the size fraction of the corresponding sample; thus samples enriched for viruses are labeled with the suffix _0.1–0.22. All assemblies were filtered to retain contigs that were at least 5 kb long and these were screened for viruses using VIRify and setting the—virome option to activate VirSorter’s virome decontamination mode.</p>
    </sec>
    <sec id="sec013">
      <title>Taxonomic classification of 57,866 VCs from the Gut Phage Database (GPD)</title>
      <p>The GPD is a collection of phage genomic sequences that includes prophages from cultured gut bacteria and putative phage sequences retrieved from assemblies of globally-distributed human gut metagenomes [<xref rid="pcbi.1011422.ref034" ref-type="bibr">34</xref>]. A representative sequence for each of the 57,866 VCs in the GPD was selected by choosing the corresponding entry with the highest CheckV quality and completion values. The complete set of representative sequences was analysed with VIRify, using the “—onlyannotate” option to skip the viral prediction step and apply the taxonomic classification pipeline to all the input sequences. The results obtained for all the classified representative sequences were collated and summarised in a Sankey plot.</p>
    </sec>
    <sec id="sec014">
      <title>Selection and comparison of virus-specific protein profile HMM databases</title>
      <p>The taxonomic assignment of VIRify relies purely on our own protein profile HMM database, their taxonomy, and model-specific bit score cutoffs. In an effort to be comprehensive, our pipeline also provides the option of additional annotations by incorporating 25,399 models from the VOGdb (<ext-link xlink:href="http://vogdb.org/" ext-link-type="uri">http://vogdb.org/</ext-link>), 25,281 viral protein family (VPF) models from IMG/VR [<xref rid="pcbi.1011422.ref060" ref-type="bibr">60</xref>], 9,911 models from RVDB v17.0 [<xref rid="pcbi.1011422.ref065" ref-type="bibr">65</xref>,<xref rid="pcbi.1011422.ref066" ref-type="bibr">66</xref>], and 9,518 models from pVOG [<xref rid="pcbi.1011422.ref067" ref-type="bibr">67</xref>]. VIRify can use all databases to individually annotate proteins from all putative viral contigs, using hmmscan with default values and an e-value cutoff of 0.001. However, the final taxonomic assignment provided for the putative viral contigs relies exclusively on our curated set of ViPhOGs.</p>
      <p>To compare the annotations provided by all five databases, we ran hmmscan on all predicted proteins from putative viral contigs detected in the two mock community assemblies (Neto and Kleiner) and the 243 TARA Oceans assemblies. To allow for a better comparison against the other databases, we distinguished hits against the ViPhOG models into hits only based on an e-value cutoff of 0.001 and hits additionally identified using our predefined model-specific bit score thresholds.</p>
    </sec>
    <sec id="sec015">
      <title>General implementation of VIRify</title>
      <p>VIRify is implemented using the workflow management system Nextflow [<xref rid="pcbi.1011422.ref030" ref-type="bibr">30</xref>], and an overview of the pipeline is given in <xref rid="pcbi.1011422.g001" ref-type="fig">Fig 1</xref>. All third-party tools are encapsulated in software containers to allow easy distribution of the pipeline on local, cluster, or cloud systems. Custom Python scripts connect the output and input of the tools used and are available via GitHub (<ext-link xlink:href="https://github.com/EBI-Metagenomics/emg-viral-pipeline/tree/master/bin" ext-link-type="uri">https://github.com/EBI-Metagenomics/emg-viral-pipeline/tree/master/bin</ext-link>). With configured Nextflow and Docker [<xref rid="pcbi.1011422.ref068" ref-type="bibr">68</xref>] installations, VIRify can be simply downloaded and run with a single command: nextflow run EBI-Metagenomics/emg-viral-pipeline -r v1.0—help. All required databases and metadata files are automatically downloaded and stored for later (offline) reuse. We always recommend running a stable release version from the repository, which can be selected via the -r flag. Different Nextflow profiles allow the execution on a local system or cluster (currently supported are LSF and SLURM). The pipeline may also be run in an “annotation” mode that skips the prediction of putative virus sequences and directly assigns viral taxonomies to all the input contigs. Please note that until version v1.0, the pipeline was implemented back-to-back in Nextflow and CWL [<xref rid="pcbi.1011422.ref069" ref-type="bibr">69</xref>]. Both workflow implementations were using the same scripts and software containers. However, to reduce maintenance and to fully focus on one implementation, from v1.0 all pipeline updates will be introduced only in Nextflow.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec016">
    <title>Results</title>
    <sec id="sec017">
      <title>Viral diversity is comprehensively covered by the set of manually curated informative ViPhOGs</title>
      <p>The original ViPhOG database [<xref rid="pcbi.1011422.ref024" ref-type="bibr">24</xref>] consists of 31,150 profile HMMs that were created using proteins from viral genomes found in NCBI’s databases. Based on the search of homologous sequences in the UniProtKB database and the subsequent analysis conducted on the output data, we identified 20,266 informative ViPhOGs that could serve as taxonomic markers for viral taxa present in the current version of ICTV’s taxonomy (MSL#38). <bold><xref rid="pcbi.1011422.g002" ref-type="fig">Fig 2</xref></bold> indicates the number of informative ViPhOGs obtained for each of the analysed taxonomic ranks (genus, subfamily, family and order), and for each rank, it illustrates the number of targeted taxa that correspond to either prokaryotic or eukaryotic viruses. Overall, 83.1% of the informative ViPhOGs were linked to taxa at the genus level and the numbers identified for the remaining ranks decreased from the subfamily to the order level. Furthermore, the percentage of informative ViPhOGs associated with eukaryotic viral taxa was slightly larger than the percentage of those associated with prokaryotic viral taxa (53.2% and 46.8%, respectively).</p>
      <fig position="float" id="pcbi.1011422.g002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011422.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Number of informative ViPhOGs identified for different viral taxonomic ranks.</title>
          <p>31,150 ViPhOGs were searched against all entries in UniProtKB, and based on the output they were designated as specific for different viral taxa (see <xref rid="sec002" ref-type="sec">Methods</xref>). Purple refers to specific ViPhOGs assigned to prokaryotic viral taxa, whereas yellow indicates specific ViPhOGs for eukaryotic viral taxa.</p>
        </caption>
        <graphic xlink:href="pcbi.1011422.g002" position="float"/>
      </fig>
      <p>Regarding the coverage of currently known viral taxa, the informative ViPhOGs cover 18.6, 31.8, 20.9 and 10.8% of genera, subfamilies, families and orders represented in the viral NCBI taxonomy retrieved in January 2023 (<bold><xref rid="pcbi.1011422.s001" ref-type="supplementary-material">S1 Fig</xref></bold>). A comparison with the coverage of the viral NCBI taxonomy from March 2020 demonstrated an evident reduction in taxonomic coverage for all analysed ranks, which in turn provides a clear picture of the broad changes the viral taxonomy has undergone in the last few years. Nevertheless, our set of informative ViPhOGs includes taxonomy markers for many representative viral lineages within the ubiquitous and widely-described class <italic toggle="yes">Caudoviricetes</italic>, the eukaryotic virus order <italic toggle="yes">Herpesvirales</italic>, and the eukaryotic viral families <italic toggle="yes">Mimiviridae</italic>, <italic toggle="yes">Coronaviridae</italic>, and <italic toggle="yes">Poxviridae</italic>, among others. Moreover, based on the coverage of the NCBI viral taxonomy of January 2023, our set of informative ViPhOGs covers 38.6% of all the lineages represented by the currently known viral diversity in at least one taxonomic rank (<bold><xref rid="pcbi.1011422.s001" ref-type="supplementary-material">S1 Fig</xref></bold>).</p>
    </sec>
    <sec id="sec018">
      <title>VIRify accurately classifies viruses on co-assemblies of two largely viral mock communities</title>
      <p>VIRify was tested on datasets generated from viral mock communities to evaluate its viral sequence prediction performance and compare its taxonomic assignments with the taxonomy of the viruses present in the communities. The selected datasets were generated for two different studies that evaluated a range of viral enrichment and purification procedures that were applied to mock microbial communities. Kleiner et al. [<xref rid="pcbi.1011422.ref032" ref-type="bibr">32</xref>] sequenced a mock microbiome prepared in mouse faeces using bacterial and phage cultures (germ-free C57BL/6 J mice). The samples contained six different phages in varying concentrations: P22, T3, T7, ɸ6, M13 and ɸVPE25. Neto et al. [<xref rid="pcbi.1011422.ref033" ref-type="bibr">33</xref>] constructed a mock microbiome comprised of four common gut bacteria and nine highly diverse viruses, most of which represent the eukaryotic viral families <italic toggle="yes">Circoviridae</italic>, <italic toggle="yes">Parvoviridae</italic>, <italic toggle="yes">Polyomaviridae</italic>, <italic toggle="yes">Alphaflexiviridae</italic>, <italic toggle="yes">Reoviridae</italic>, <italic toggle="yes">Coronaviridae</italic>, <italic toggle="yes">Herpesviridae</italic> and <italic toggle="yes">Mimiviridae</italic>, and including a phage from the family <italic toggle="yes">Ackermannviridae</italic> (formerly classified in the family <italic toggle="yes">Myoviridae</italic>). The nine viruses differ highly in genome length (1.8 kb to 1,180 kb), genome type (dsDNA, dsRNA, ssDNA, ssRNA), and genome compositions (linear, circular, segmented). Co-assemblies of datasets obtained from viral-enriched samples were generated for each of the selected studies and used as input for the VIRify pipeline. The Kleiner co-assembly comprises 5,310 contigs, of which 224 are ≥ 1.5 kb with an N50 of 74,309 bp. The Neto co-assembly comprises 341,587 contigs, of which 1,686 are ≥ 1.5 kb with an N50 of 16,751 bp. Thus, 95.78% of the contigs in the Kleiner assembly, and 99.51% of the contigs in the Neto assembly are shorter than 1500 bp.</p>
      <sec id="sec019">
        <title>VIRify comprehensively selects putative viral contigs</title>
        <p>We ran a modified version of WtP (see <xref rid="sec002" ref-type="sec">Methods</xref>) on both mock community assemblies (Kleiner, Neto) to compare ten different tools for virus prediction. <bold><xref rid="pcbi.1011422.s002" ref-type="supplementary-material">S2 Fig</xref></bold> illustrates the performance of all the assessed tools for each of the analysed mock community assemblies. Our results show that a selection of VirSorter, VirFinder, and PPR-Meta sufficiently represented a common proportion of putative viral contigs from both mock community assemblies across all compared prediction tools (<bold>Figs <xref rid="pcbi.1011422.g003" ref-type="fig">3A</xref></bold>, <bold><xref rid="pcbi.1011422.s002" ref-type="supplementary-material">S2</xref></bold> and <bold><xref rid="pcbi.1011422.s003" ref-type="supplementary-material">S3</xref></bold>). Thus, the combination of these tools was selected as VIRify’s method for viral contig prediction, although the selection of putative viral contigs from this combination is subjected to a set of rules similar to the selection criteria used in a previous study of global oceanic viral populations (see <xref rid="sec002" ref-type="sec">Methods</xref> section for further details) [<xref rid="pcbi.1011422.ref012" ref-type="bibr">12</xref>]. <bold><xref rid="pcbi.1011422.t001" ref-type="table">Table 1</xref></bold> summarises the viral contig prediction results obtained with VIRify for the Kleiner and Neto assemblies.</p>
        <fig position="float" id="pcbi.1011422.g003">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1011422.g003</object-id>
          <label>Fig 3</label>
          <caption>
            <title>Exemplary viral contig selection and annotation procedure for the Kleiner co-assembly.</title>
            <p><bold>(A)</bold> Comparison of virus predictions for the Kleiner co-assembly performed with various tools run via WtP. Shown are the 35 contigs (rows) predicted as viral by at least one of the tested tools. The column with red squares highlights the contigs manually identified as viral, as described in the methods section. Blue squares indicate contigs predicted as viral by VirSorter (virome decontamination mode), VirFinder (VF.modEPV_k8.rda model) or PPR-Meta. The column with green squares indicates the viral contigs reported by the prediction approach implemented in VIRify, based on the results from WtP (see <xref rid="sec002" ref-type="sec">Methods</xref> section). Yellow squares indicate CheckV-quality results for contigs selected by VIRify that are either high-quality, medium-quality, low-quality or not-determined; going from dark (high-quality) to light yellow (not-determined). <bold>(B)</bold> ORFs predicted with Prodigal and annotated with the informative ViPhOGs for the 14 contigs identified as viral by VIRify. Of these, eleven were predicted as high confidence (HC) and three as putative prophages (PP). No low-confidence viral predictions were reported for the Kleiner co-assembly. The coloured contig labels indicate the CheckV scores: red—high-quality, orange—medium-quality, yellow—low-quality, and black—not-determined. Dark grey bars indicate predicted ORFs without any ViPhOG hit, while green bars indicate ViPhOG hits based on the model-specific bitscores. <bold>(C)</bold> Predicted viral sequences and corresponding taxonomic assignments based on informative ViPhOG hits for the Kleiner co-assembly.</p>
          </caption>
          <graphic xlink:href="pcbi.1011422.g003" position="float"/>
        </fig>
        <table-wrap position="float" id="pcbi.1011422.t001">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1011422.t001</object-id>
          <label>Table 1</label>
          <caption>
            <title>VIRify’s viral prediction results for two mock community assemblies.</title>
            <p>The analyses were conducted for all assembled contigs longer than 1.5 kb.</p>
          </caption>
          <alternatives>
            <graphic xlink:href="pcbi.1011422.t001" id="pcbi.1011422.t001g" position="float"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="center" rowspan="1" colspan="1">Assembly</th>
                  <th align="center" rowspan="1" colspan="1">Total contigs</th>
                  <th align="center" rowspan="1" colspan="1">Viral contigs</th>
                  <th align="center" rowspan="1" colspan="1">True positives</th>
                  <th align="center" rowspan="1" colspan="1">True negatives</th>
                  <th align="center" rowspan="1" colspan="1">False positives</th>
                  <th align="center" rowspan="1" colspan="1">False negatives</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="center" rowspan="1" colspan="1">Kleiner</td>
                  <td align="center" rowspan="1" colspan="1">224</td>
                  <td align="center" rowspan="1" colspan="1">17</td>
                  <td align="center" rowspan="1" colspan="1">13</td>
                  <td align="center" rowspan="1" colspan="1">206</td>
                  <td align="center" rowspan="1" colspan="1">1</td>
                  <td align="center" rowspan="1" colspan="1">4</td>
                </tr>
                <tr>
                  <td align="center" rowspan="1" colspan="1">Neto</td>
                  <td align="center" rowspan="1" colspan="1">1686</td>
                  <td align="center" rowspan="1" colspan="1">259</td>
                  <td align="center" rowspan="1" colspan="1">134</td>
                  <td align="center" rowspan="1" colspan="1">1390</td>
                  <td align="center" rowspan="1" colspan="1">37</td>
                  <td align="center" rowspan="1" colspan="1">125</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
        <p>For the Kleiner assembly, 17 contigs were identified as viral based on their alignment to the genome sequences of the phages that comprise the corresponding mock community (<xref rid="pcbi.1011422.g003" ref-type="fig">Fig 3</xref><bold>A</bold>). VIRify identified 76.5% of the viral contigs in the Kleiner assembly and reported only one false positive prediction (NODE_192_length_1740_cov_2.233828), which also received no CheckV quality score. For the remaining contigs that VIRify predicted as viral, CheckV categorised six as high-quality, one as medium-quality, six as low-quality and the rest were undetermined (<xref rid="pcbi.1011422.g003" ref-type="fig">Fig 3A</xref>). All true negative predictions matched entries in NCBI’s RefSeq corresponding to <italic toggle="yes">Salmonella</italic> genomes, an observation consistent with the significant amount of <italic toggle="yes">Salmonella</italic> DNA that was previously detected in all of the viral-enriched samples used for obtaining the Kleiner assembly [<xref rid="pcbi.1011422.ref032" ref-type="bibr">32</xref>]. Regarding the reported false negatives, 3 corresponded to prophages predicted in the genome of <italic toggle="yes">Salmonella enterica</italic> subsp. <italic toggle="yes">enterica</italic> serovar Typhimurium str. LT2 and the remaining one matched entries in NCBI related to phage M13. According to the calculated F1-scores, the viral prediction tools that performed best for this assembly were VirSorter (using the virome decontamination mode) and VIRify, both of which had an F1-score of 0.84 (<bold><xref rid="pcbi.1011422.s002" ref-type="supplementary-material">S2 Fig</xref></bold>).</p>
        <p>Regarding the Neto assembly, alignment of contigs to the genome sequences of the mock community viruses identified 259 of them as viral. In this case, VIRify identified 51.7% of the viral contigs present in the assembly, and 21.6% of the contigs reported as viral were false positives. Among the false negatives, 75.2% of the contigs were derived from the genome of the mimivirus included in the mock community. In addition, 23.2% of the false negatives were contigs that ranged in size from 1,515 to 5,906 bp and that corresponded to prophages identified in the genomes of the <italic toggle="yes">E</italic>. <italic toggle="yes">coli</italic> and <italic toggle="yes">B</italic>. <italic toggle="yes">thetaiotaomicron</italic> strains included in the mock community. Based on the F1-scores, the tools that performed best for the Neto assembly were PPR-Meta (0.84), VirFinder with the VF.modEPV_k8.rda model (0.63) and VIRify (0.62) (<bold><xref rid="pcbi.1011422.s002" ref-type="supplementary-material">S2 Fig</xref></bold>). In total, VIRify predicted 170 contigs of the Neto co-assembly as viral, of which CheckV rated two as high-quality, three as medium-quality, 142 as low-quality, and 24 as indeterminate.</p>
        <p>Overall, the calculated F1-scores revealed that VIRify and PPR-Meta were the tools that performed best for predicting viral contigs from the analysed mock community assemblies (<bold><xref rid="pcbi.1011422.s002" ref-type="supplementary-material">S2 Fig</xref></bold>). VIRify had a better performance than PPR-Meta on the Kleiner assembly, particularly due to its ability to predict prophages from assembled bacterial contigs (e.g. NODE_1_length_514496_cov_72.252612 and NODE_5_length_111535_cov_40.991774) and due to PPR-Meta being less precise than VIRify, as evidenced by the higher number of false positive predictions reported by the former (<bold><xref rid="pcbi.1011422.g003" ref-type="fig">Fig 3A</xref></bold>). By contrast, PPR-Meta performed better than VIRify on the Neto assembly because the former tool had a higher recall rate that allowed the recovery of 87.6% of the mimivirus contigs, whereas VIRify recovered only 55.2% of the contigs derived from this virus.</p>
      </sec>
      <sec id="sec020">
        <title>Taxonomic classification of phage contigs and putative prophage regions down to the subfamily and genus ranks</title>
        <p>The taxonomic annotation performed with VIRIfy on the Kleiner assembly classified six of the putative viral contigs as members of the class <italic toggle="yes">Caudoviricetes</italic> (<bold><xref rid="pcbi.1011422.g003" ref-type="fig">Fig 3B and 3C</xref></bold>). Among them, two within the genus <italic toggle="yes">Teseptimavirus</italic>, three within the subfamily <italic toggle="yes">Sepvirinae</italic>, and one within the subfamily <italic toggle="yes">Tunavirinae</italic>. In addition, one contig corresponding to phage ΦX174, which is commonly used as a positive control in sequencing experiments, was correctly classified as a member of the subfamily <italic toggle="yes">Bullavirinae</italic> (class <italic toggle="yes">Malgrandaviricetes</italic>). Among the seven contigs with an assigned taxonomy, two were predicted by VirSorter to be putative prophage sequences (<bold><xref rid="pcbi.1011422.g003" ref-type="fig">Fig 3B</xref></bold>) which likely derived from bacterial contamination in the samples [<xref rid="pcbi.1011422.ref032" ref-type="bibr">32</xref>]. Of the six phages potentially included in the Kleiner co-assembly, VIRify identified and classified contigs that correspond to phages P22 (NODE_20), T3 (NODE_23), and T7 (NODE_22). While contigs derived from phages T3 and T7 were correctly classified in the <italic toggle="yes">Teseptimavirus</italic> genus, the contig from phage P22 was incorrectly classified as a member of subfamily <italic toggle="yes">Sepvirinae</italic>. However, both phage P22 and subfamily <italic toggle="yes">Sepvirinae</italic> belong to class <italic toggle="yes">Caudoviricetes</italic>, thus VIRify was able to classify the contig from phage P22 into the correct class. Overall, two of the phages from the original mock community present among the putative viral contigs were correctly classified by VIRify at the genus rank, one contig from phage ΦX174 was correctly classified at the subfamily rank, and one additional phage from the mock community was correctly classified at the class rank.</p>
        <p>The pipeline reported a long 86 kb contig (NODE_8) from ɸVPE25 among the high-confidence viral contigs, whose taxonomic lineage was not identified, likely due to the low number of ViPhOG hits reported (<xref rid="pcbi.1011422.g003" ref-type="fig">Fig 3</xref><bold>B</bold>). Phage M13 could not be identified either, as it was only assembled in small fragments due to low sequencing coverage, an observation that was consistent with the results reported previously [<xref rid="pcbi.1011422.ref032" ref-type="bibr">32</xref>]. The M13 genome is 6.4 kb long and metaSPAdes only recovered two contigs in the high confidence set that matched different parts of the phage’s genome (NODE_113 with 2,682 bp and NODE_193 with 1,739 bp). Similarly, phage ɸ6 was not even detected by [<xref rid="pcbi.1011422.ref032" ref-type="bibr">32</xref>] after sequencing their viral-enriched samples, which explains why no contigs were identified for this phage in our coassembly.</p>
      </sec>
      <sec id="sec021">
        <title>Comprehensive detection of prokaryotic and eukaryotic viruses from a highly diverse mock-virome</title>
        <p>Taxonomic annotation of the reported 170 putative viral contigs in the Neto assembly revealed that 6 of them were classified as members of the class <italic toggle="yes">Caudoviricetes</italic> and 115 were classified in the orders <italic toggle="yes">Imitervirales</italic> (107 contigs), <italic toggle="yes">Nidovirales</italic> (2), <italic toggle="yes">Ortervirales</italic> (2), <italic toggle="yes">Herpesvirales</italic> (1), <italic toggle="yes">Petitvirales</italic> (1), <italic toggle="yes">Pimascovirales</italic> (1), and <italic toggle="yes">Reovirales</italic> (1) (<xref rid="pcbi.1011422.g004" ref-type="fig">Fig 4</xref>). Among them, we found members of the virus families <italic toggle="yes">Ackermannviridae</italic>, <italic toggle="yes">Mimiviridae</italic>, <italic toggle="yes">Drexlerviridae</italic>, <italic toggle="yes">Herpesviridae</italic>, <italic toggle="yes">Microviridae</italic>, <italic toggle="yes">Iridoviridae</italic>, <italic toggle="yes">Sedoreoviridae</italic>, <italic toggle="yes">Coronaviridae</italic>, and <italic toggle="yes">Retroviridae</italic>. For all these families, VIRify was also able to classify contigs at the subfamily level and some were also classified at the genus level: 97 contigs to <italic toggle="yes">Mimivirus</italic>, 2 contigs to <italic toggle="yes">Alphacoronavirus</italic>, 1 contig to <italic toggle="yes">Limestonevirus</italic>, and 1 contig to <italic toggle="yes">Rotavirus</italic> (<xref rid="pcbi.1011422.g004" ref-type="fig">Fig 4</xref>). The taxonomic classifications provided by VIRify were compared with the taxonomy of the genomes from which the analysed contigs were derived. We determined as a result that VIRify’s taxonomic classification had an accuracy of 94.2% for the putative viral contigs detected in this assembly.</p>
        <fig position="float" id="pcbi.1011422.g004">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1011422.g004</object-id>
          <label>Fig 4</label>
          <caption>
            <title>Predicted ORFs and corresponding ViPhOG annotations and taxonomy assignments for the Neto co-assembly.</title>
            <p><bold>(A)</bold> ViPhOG-annotated ORFs for all contigs predicted as viral with high confidence (HC) and low confidence (LC) for the Neto assembly. Note that due to the high number of LC hits, only a selection of contigs is shown. The coloured contig labels indicate the CheckV scores: red—high-quality, orange—medium-quality, yellow—low-quality, and black—not-determined. VIRify assigned the genus <italic toggle="yes">Alphacoronavirus</italic> to NODE 82 based on seven informative ViPhOG model hits that are additionally shown as a circular visualization. NA—no taxonomy could be assigned due to missing model support. <bold>(B)</bold> Neto contigs predicted as viral with high and low confidence and their taxonomic assignments based on the ViPhOG model hits. Both visualizations can be automatically produced by VIRify and were only slightly manually adjusted via Inkscape.</p>
          </caption>
          <graphic xlink:href="pcbi.1011422.g004" position="float"/>
        </fig>
        <p>Contigs classified as members of subfamilies <italic toggle="yes">Sepvirinae</italic> and <italic toggle="yes">Tunavirinae</italic> matched entries in NCBI’s nr database corresponding to phages of <italic toggle="yes">E</italic>.<italic toggle="yes">coli</italic>, suggesting that these were most likely derived from DNA contamination by the bacterial component of the mock community. No contigs from the viruses that represented the families <italic toggle="yes">Circoviridae</italic>, <italic toggle="yes">Polyomaviridae</italic>, and <italic toggle="yes">Alphaflexiviridae</italic> were detected among the length-filtered contigs by blastn, and therefore no contigs were assigned to any of the corresponding taxonomic lineages. Eight contigs ranging from 1,543 to 2,356 bp and coming from viruses belonging to the families <italic toggle="yes">Parvoviridae</italic>, <italic toggle="yes">Sedoreoviridae</italic> and <italic toggle="yes">Herpesviridae</italic> were detected among the set of low-confidence viral contigs. One of these was correctly classified at the subfamily rank (<italic toggle="yes">Alphaherpesvirinae</italic>) and another was correctly classified at the genus rank (<italic toggle="yes">Rotavirus</italic>). No contig was classified within the viral lineage that includes the family <italic toggle="yes">Parvoviridae</italic>.</p>
        <p>One 7,051 bp putative viral contig was classified in the subfamily <italic toggle="yes">Orthoretrovirinae</italic>, which does not match the lineage of any of the viruses included in the mock community. However, when this contig was used as query for a search of NCBI’s nr nucleotide database with megablast, the top hits corresponded to porcine endogenous retroviral sequences, including several complete genomes of this type of virus (e.g. accession number EF133960.1, 97.93% identity, e-value 0.0). This result indicates that the classification of the mentioned contig as a member of <italic toggle="yes">Orthoretrovirinae</italic> was correct, and that this virus was a contaminant that was likely present in the stock of the Porcine circovirus included in the mock community.</p>
      </sec>
    </sec>
    <sec id="sec022">
      <title>VIRify comprehensively reveals virus taxonomies in global ocean ecosystems</title>
      <p>To showcase the utility of VIRify in uncovering viral diversity in ocean environments, we ran VIRify on 243 assemblies provided by the TARA Oceans project [<xref rid="pcbi.1011422.ref012" ref-type="bibr">12</xref>,<xref rid="pcbi.1011422.ref017" ref-type="bibr">17</xref>,<xref rid="pcbi.1011422.ref018" ref-type="bibr">18</xref>], including 20 samples processed via 0.1–0.22 μm filters and thus potentially enriched for viral sequences [<xref rid="pcbi.1011422.ref012" ref-type="bibr">12</xref>]. As expected, we identified more complete/high-quality viruses in such samples enriched for smaller viruses in comparison to samples derived from larger 0.45–0.8 μm filters (<bold><xref rid="pcbi.1011422.g005" ref-type="fig">Fig 5A</xref></bold>). Across all assemblies and including high and low confidence viral predictions, the following viral families were detected with at least 10 putative viral sequences assigned to them: <italic toggle="yes">Straboviridae</italic> (n = 4,128), <italic toggle="yes">Mimiviridae</italic> (3,627), <italic toggle="yes">Phycodnaviridae</italic> (2,281), <italic toggle="yes">Drexlerviridae</italic> (931), <italic toggle="yes">Herelleviridae</italic> (764), <italic toggle="yes">Salasmaviridae</italic> (363), <italic toggle="yes">Autographiviridae</italic> (326), <italic toggle="yes">Microviridae</italic> (83), <italic toggle="yes">Poxviridae</italic> (37), and <italic toggle="yes">Iridoviridae</italic> (31) (<bold><xref rid="pcbi.1011422.s004" ref-type="supplementary-material">S4 Fig</xref></bold>). In addition, we saw differences in the amount of predicted viral contigs between samples obtained from the same location but with DNA extracted using different filter sizes. For example, in CEUO01 (TARA_124_MIX) filtered for 0.1–0.22 μm (SAMEA2622799) 219 contigs were assigned to the class <italic toggle="yes">Caudoviricetes</italic>, whereas for the same sample material, but filtered for 0.45–0.8 μm (SAMEA2622801), only 32 <italic toggle="yes">Caudoviricetes</italic> contigs were found (<xref rid="pcbi.1011422.g005" ref-type="fig">Fig 5A</xref>). Interestingly, members of the genus <italic toggle="yes">Prasinovirus</italic> (large double-stranded DNA viruses that belong to the order <italic toggle="yes">Algavirales</italic>) were predominantly found in low confidence sets of 0.22–3 μm filtered fractions, which suggests that these viruses would have been missed if only VirSorter had been used on the data (<xref rid="pcbi.1011422.g005" ref-type="fig">Fig 5B</xref>).</p>
      <fig position="float" id="pcbi.1011422.g005">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011422.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Viruses predicted and annotated by VIRify for 243 TARA Oceans assemblies.</title>
          <p>The assembly identifiers include information about the size fractionation of the corresponding sample. For example, samples obtained by smaller filter size 0.1–0.22 μm (and so expected to be enriched for smaller viruses) are labelled with the suffix _0.1–0.22. <bold>(A)</bold> Shows a selection (filters 0.1–0.22 μm and 0.45–0.8 μm) of 41 samples and the number of predicted viruses based on high confidence (VirSorter categories 1 and 2) and low confidence (VirSorter category 3 and combined VirFinder and PPR-Meta results) hits. More viruses are found for smaller filter sizes, as expected. Assemblies based on smaller filter sizes are highlighted in bold. For visualization purposes, we summarize high and low confidence predictions for samples labelled with the filter sizes 0.1–0.22 and 0.45–0.8. <bold>(B)</bold> Selection of 0.22–3 μm filtered samples with a high number of predicted prasinoviruses, large double-stranded DNA viruses belonging to the order <italic toggle="yes">Algavirales</italic>. These viruses are predominantly found in the low confidence set; thus they would have been missed if only VirSorter were run on the data but are predicted by our combination of VirFinder and PPR-Meta.</p>
        </caption>
        <graphic xlink:href="pcbi.1011422.g005" position="float"/>
      </fig>
      <p>A previous study in which the aforementioned marine samples were analysed reported that the majority of identified viruses were members of the recently abolished viral families <italic toggle="yes">Myoviridae</italic>, <italic toggle="yes">Siphoviridae</italic> and <italic toggle="yes">Podoviridae</italic> [<xref rid="pcbi.1011422.ref012" ref-type="bibr">12</xref>,<xref rid="pcbi.1011422.ref070" ref-type="bibr">70</xref>]. Following these changes in the viral taxonomy, we can assume that the majority of the viruses identified in the mentioned study were members of the class <italic toggle="yes">Caudoviricetes</italic>, as this new taxon groups all tailed viruses formerly classified in the three abolished families. The results obtained with VIRify confirmed this observation, as 52% of the contigs classified at the family rank were assigned to taxa within the class <italic toggle="yes">Caudoviricetes</italic>. Furthermore, the family <italic toggle="yes">Phycodnaviridae</italic> had been identified as one of the most abundant viral families in the marine samples, and the results obtained with VIRify confirmed this observation.</p>
    </sec>
    <sec id="sec023">
      <title>VIRify expanded the number of taxonomically classified VCs from the GPD and provided higher resolution classifications</title>
      <p>Genetically-related entries in the GPD had been previously sorted into 57,866 VCs, using a graph-based clustering approach [<xref rid="pcbi.1011422.ref034" ref-type="bibr">34</xref>]. Using the reported CheckV quality and completion values, we selected a representative sequence from each VC. According to the published GPD metadata, 7,432 of these representative sequences had been previously classified and 99% of them were reported as members of the abolished phage families <italic toggle="yes">Myoviridae</italic>, <italic toggle="yes">Siphoviridae</italic> and <italic toggle="yes">Podoviridae</italic>. We analysed the selected representative sequences with VIRify to assess whether our pipeline could provide updated taxonomic classifications for them.</p>
      <p>VIRify provided taxonomic classifications for 13,651 of the analysed representative sequences, which corresponds to an increase of 83.7% from the number reported previously. The vast majority of these classifications were to lineages within the class <italic toggle="yes">Caudoviricetes</italic> (98%), whereas most of the remaining sequences were classified in the families <italic toggle="yes">Iridoviridae</italic>, <italic toggle="yes">Microviridae</italic> and <italic toggle="yes">Herpesviridae</italic> (<bold><xref rid="pcbi.1011422.g006" ref-type="fig">Fig 6</xref></bold>).</p>
      <fig position="float" id="pcbi.1011422.g006">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011422.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>Taxonomic classification of representative sequences from the GPD.</title>
          <p>One representative sequence from each of the 57,866 VCs present in the GPD was selected based on their reported CheckV quality and completion values. The representative sequences were analysed with VIRify using the ‘—onlyannotate’ option to obtain taxonomic classifications for them. The taxa displayed in the Sankey plot correspond to those in which at least 10 representative sequences were classified.</p>
        </caption>
        <graphic xlink:href="pcbi.1011422.g006" position="float"/>
      </fig>
      <p>The families and subfamilies most commonly reported in the results include phages that target bacteria from the phyla Proteobacteria, Bacillota (i.e. Firmicutes) and Actinomycetota, all of which have been reported as common members of the human gut microbiome [<xref rid="pcbi.1011422.ref071" ref-type="bibr">71</xref>]. In particular, the families <italic toggle="yes">Drexlerviridae</italic>, <italic toggle="yes">Salasmaviridae</italic> and <italic toggle="yes">Herelleviridae</italic> have already been identified as frequent members of the human gut virome [<xref rid="pcbi.1011422.ref072" ref-type="bibr">72</xref>,<xref rid="pcbi.1011422.ref073" ref-type="bibr">73</xref>]. Interestingly, the sequences classified in the subfamilies <italic toggle="yes">Nymbaxtervirinae</italic> and <italic toggle="yes">Arquatrovirinae</italic> corresponded to putative phages targeting bacteria from either the Bacillota or Actinomycetota phyla. Previous studies have provided evidence indicating that phages targeting bacteria from these two phyla share a common ancestry, which hints at the possibility of cross-phyla phage-host interactions [<xref rid="pcbi.1011422.ref074" ref-type="bibr">74</xref>].</p>
    </sec>
    <sec id="sec024">
      <title>ViPhOG models comprehensively cover viral proteins</title>
      <p>Our comparison of virus-specific protein profile HMM databases included in VIRify showed that the ViPhOG models covered a large proportion of potentially viral CDS in agreement with the other databases (<xref rid="pcbi.1011422.g007" ref-type="fig">Fig 7A</xref>). In total, we predicted 1,204,455 CDSs from all high-confidence viral contigs that VIRify reported for the 243 TARA assemblies, of which the ViPhOGs covered 56.7% (49.4% with applied bit score threshold) and thus were only slightly outperformed by the VOGdb (56.8%). The largest set of shared annotations comprised 284,791 CDS annotated as viral based on models from all compared databases except the RVDB (<xref rid="pcbi.1011422.g007" ref-type="fig">Fig 7A</xref>). In addition, the RVDB had the least predictions, with only 15.3% annotated CDS compared to all other databases. Our model-specific bit score filtering reduces the amount of CDS annotations derived from ViPhOGs by 7.3% (87,869 CDS) (<xref rid="pcbi.1011422.g007" ref-type="fig">Fig 7A</xref>). While this might lead to the loss of potentially informative annotations that could be used for taxonomy assignment, we also remove false positive model hits, as shown in <xref rid="pcbi.1011422.g007" ref-type="fig">Fig 7B</xref>. Interestingly, the VPF derived from the IMG/VR database, which also includes novel viral sequences derived from metagenome approaches, comprises a large proportion of unique models that match 117,962 CDS (9.8%) that are not covered by any of the other annotated databases. On the other hand, a significant number of CDS are annotated by models from the other databases but missed by the VPF models.</p>
      <fig position="float" id="pcbi.1011422.g007">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011422.g007</object-id>
        <label>Fig 7</label>
        <caption>
          <p><bold>(A)</bold> Comparison of annotated CDS from VIRify’s high-confidence viral predictions from all 243 TARA Oceans assemblies. Our comparison shows that the ViPhOG models comprehensively cover a large proportion of potentially viral CDS in agreement with other public databases. The RVDB had the fewest predictions, with only 15.3% annotated CDS. Results of the VPF database, where models are derived from the IMG/VR database that also includes novel viral sequences derived from metagenome approaches, comprise a large proportion of unique models that exclusively match 117,962 CDS (9.8%) that are not covered by any of the other databases. However, a significant number of CDS are annotated by models from the other databases but missed by VPF. Our model-specific bit score filtering (ViPhOG—threshold) reduces the number of CDS annotations derived from ViPhOGs by 7.3% <bold>(B)</bold> Visualization of predicted (top row) and annotated ORFs for one exemplar contig from TARA Oceans assembly CEUI01. Grey bars indicate hits against an HMM of the corresponding database, while informative ViPhOG hits with taxonomic information are shown in green. The top ViPhOG track shows hits filtered by bit score (or e-value if no bit score could be assigned for a model, see <xref rid="sec002" ref-type="sec">Methods</xref>) and the bottom ViPhOG track shows e-value-filtered hits. <bold>(C)</bold> While the model-specific ViPhOG bit score threshold can lead to the loss of potentially informative annotations for taxonomy assignment, it can also reduce the number of false positive model hits and thus increase the overall accuracy of VIRify.</p>
        </caption>
        <graphic xlink:href="pcbi.1011422.g007" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec025">
    <title>Discussion</title>
    <p>Metagenomic surveys of different environments during the last few decades have had a profound impact on the rate at which novel viruses are discovered [<xref rid="pcbi.1011422.ref075" ref-type="bibr">75</xref>]. Despite the resulting sharp increase in the number of publicly available viral genomes, viruses remain relatively understudied in many environments and the taxonomic profiling of viral communities is still challenging due to the lack of universal genetic markers that support the phylogenetic resolution of viral taxa [<xref rid="pcbi.1011422.ref076" ref-type="bibr">76</xref>,<xref rid="pcbi.1011422.ref077" ref-type="bibr">77</xref>]. As a contribution to the currently available repertoire of tools designed to address these challenges, we designed and implemented the VIRify pipeline for detecting and taxonomically annotating viral contigs in metagenomic datasets.</p>
    <p>The results presented here for the mock community assemblies demonstrated that VIRify is a suitable pipeline for generating highly accurate taxonomic profiling of viral communities present in metagenomic datasets. Compared with most of the tools currently used for detecting viral contigs in metagenomic assemblies, VIRify demonstrated higher predictive performance for contigs ≥ 1.5 kb in both the Keiner and Neto assemblies (<bold>Figs <xref rid="pcbi.1011422.g003" ref-type="fig">3A</xref></bold>, <bold><xref rid="pcbi.1011422.s002" ref-type="supplementary-material">S2</xref></bold> and <bold><xref rid="pcbi.1011422.s003" ref-type="supplementary-material">S3</xref></bold>). Furthermore, using our manually-curated informative ViPhOGs led to the taxonomic classification of putative viral contigs from the Neto assembly with an accuracy of 94.2%. Regarding the Kleiner assembly, all classified putative viral contigs were assigned to the correct taxonomic lineages at different degrees of resolution, with some classified up to the family rank and others classified up to the genus rank. The pipeline also provided taxonomic classifications for putative prophages identified in contaminant bacterial contigs from both mock assemblies.</p>
    <p>VIRify’s viral prediction performance was the result of combining the effectiveness of VirSorter in predicting phage and prophage sequences [<xref rid="pcbi.1011422.ref051" ref-type="bibr">51</xref>,<xref rid="pcbi.1011422.ref078" ref-type="bibr">78</xref>], with the ability of PPR-Meta and VirFinder’s VF.modEPV_k8.rda model to predict sequences from eukaryotic viruses, as evidenced by their F1-scores for the Neto assembly (<bold><xref rid="pcbi.1011422.s002" ref-type="supplementary-material">S2 Fig</xref></bold>). Overall, most of the viral prediction tools evaluated here demonstrated a low performance for the Neto assembly, which indicates that these tools were mainly developed for the detection of phages and are not suited for the comprehensive detection of eukaryotic viral sequences. Considering that PPR-Meta was originally designed for detecting phages and plasmids [<xref rid="pcbi.1011422.ref056" ref-type="bibr">56</xref>] and that the Neto assembly mainly comprised eukaryotic viruses, it was striking to find that PPR-Meta was the tool that performed best for this assembly. Nonetheless, we decided to keep the combination of VirSorter, VirFinder and PPR-Meta as VIRify’s viral prediction approach for two main reasons. The first is that PPR-Meta’s underlying model was not explicitly trained to detect prophages in bacterial genomic sequences. As the detection of both free viruses and prophages was critical to the aim of providing comprehensive viral community profiling, we needed to include another viral detection tool capable of efficiently predicting prophages. VirSorter provides this functionality, as has been demonstrated by many previous studies in which it was employed to detect prophages in genome sequences from a diverse range of bacteria [<xref rid="pcbi.1011422.ref013" ref-type="bibr">13</xref>,<xref rid="pcbi.1011422.ref078" ref-type="bibr">78</xref>]. The second reason for not using PPR-Meta on its own is that, despite its high sensitivity, it tends to call a relatively higher number of false positives in comparison to other viral predictors [<xref rid="pcbi.1011422.ref079" ref-type="bibr">79</xref>]. Considering PPR-Meta’s performance on the mock community assemblies, we reasoned it would be advantageous to keep this tool within VIRify’s arsenal by combining its predictions with the ones obtained with VirFinder to limit the number of false positive predictions.</p>
    <p>Several studies have reported collections of profile HMMs for groups of orthologous viral genes, such as pVOGs [<xref rid="pcbi.1011422.ref067" ref-type="bibr">67</xref>], vFAMs [<xref rid="pcbi.1011422.ref080" ref-type="bibr">80</xref>], RVDB [<xref rid="pcbi.1011422.ref066" ref-type="bibr">66</xref>] and VOGdb (<ext-link xlink:href="http://vogdb.org/" ext-link-type="uri">http://vogdb.org/</ext-link>). Even though some of these have been employed for viral taxonomic profiling, our informative ViPhOGs stand out due to their bespoke bit score thresholds that were carefully selected to decrease the likelihood of false positive taxonomic assignments. As illustrated in <xref rid="pcbi.1011422.g007" ref-type="fig">Fig 7B</xref>, using the informative ViPhOGs with a single e-value threshold resulted in a higher chance of false positive taxonomic annotations, as was the case for contig seq28589 from the assembly of the TARA Oceans sample CEUI01 (study accession PRJEB7988). Therefore, our results indicate that using curated bit score thresholds offers an adequate balance between predictive power and classification accuracy. This strategy has been successfully implemented previously in Pfam and TIGRFAMs, some of the most widely used protein family databases for the functional annotation of genomes and metagenomes [<xref rid="pcbi.1011422.ref035" ref-type="bibr">35</xref>,<xref rid="pcbi.1011422.ref081" ref-type="bibr">81</xref>].</p>
    <p>Another novelty of our curated set of informative ViPhOGs is the use of TSR to set taxonomic assignment thresholds specific for each taxon. The TSR measures the density of assigned informative ViPhOGs for each taxon present in the viral lineages covered by our set of models. Thus, setting the taxonomic assignment threshold with this parameter allows the algorithm to adjust its level of stringency for each individual taxon. This feature is particularly advantageous for taxa characterised by relatively small genomes, for which there is a fewer number of informative ViPhOGs in our collection. This benefit was especially evident during the analysis of the Neto assembly, where the use of this feature increased the number of classified contigs from several of the eukaryotic viruses present in the mock community. A run of VIRify with the taxonomy assignment threshold set to 0.6 for all taxa resulted in the absence of short contigs (1,543–2,356 bp) classified in the subfamily <italic toggle="yes">Alphaherpesvirinae</italic> and the genus <italic toggle="yes">Rotavirus</italic>. This result indicates that the use of taxon-specific thresholds improves the detection of short contigs, by lowering the taxonomic assignment stringency.</p>
    <p>We further showed that VIRify can be applied to metagenomic assemblies obtained from large environmental studies, such as the TARA Oceans expedition [<xref rid="pcbi.1011422.ref012" ref-type="bibr">12</xref>,<xref rid="pcbi.1011422.ref017" ref-type="bibr">17</xref>,<xref rid="pcbi.1011422.ref018" ref-type="bibr">18</xref>]. In accordance with a previous report, a high proportion of predicted viruses could not be taxonomically classified into a known viral family [<xref rid="pcbi.1011422.ref012" ref-type="bibr">12</xref>]. However, the majority of contigs that VIRify classified were assigned to different families within the class <italic toggle="yes">Caudoviricetes</italic>, which agrees with the previous observation that most of the classified viruses in these samples were members of the former phage families <italic toggle="yes">Myoviridae</italic>, <italic toggle="yes">Siphoviridae</italic> or <italic toggle="yes">Podoviridae</italic>. Also in agreement with the previously reported study, the family <italic toggle="yes">Phycodnaviridae</italic> was one of the taxa most commonly identified by VIRify among the analysed marine samples. Interestingly, prasinoviruses were predominantly found in low confidence sets, thus, would have been missed by only running VirSorter on the data (<bold><xref rid="pcbi.1011422.g005" ref-type="fig">Fig 5B</xref></bold>). Here, our combination of VirFinder and PPR-Meta predictions helped to recover contigs that the pipeline could later taxonomically assign to this genus. Due to their larger size, prasinoviruses are underrepresented in smaller size fractionated samples, underlying the importance of appropriate filtering and enrichment steps and their combination to comprehensively collect viruses from environmental samples.</p>
    <p>The use of VIRify to analyse a set of representative sequences from the GPD resulted in a large increase in the number of taxonomically classified sequences (83.7%). The vast majority of the sequences were assigned to families and subfamilies within the class <italic toggle="yes">Caudoviricetes</italic>, which agrees with the former classifications reported in the GPD metadata. Furthermore, phages classified in the reported taxa have been previously found to target bacteria within some of the most frequently identified bacterial phyla in the human gut [<xref rid="pcbi.1011422.ref071" ref-type="bibr">71</xref>–<xref rid="pcbi.1011422.ref073" ref-type="bibr">73</xref>]. However, a few of the representative sequences were classified in the families <italic toggle="yes">Iridoviridae</italic> and <italic toggle="yes">Herpesviridae</italic>. Although the latter taxon has been reported as a frequent member of the human gut virome, it is likely that these results correspond to false positive assignments considering the phage sequence prediction approach followed in the generation of the GPD [<xref rid="pcbi.1011422.ref034" ref-type="bibr">34</xref>,<xref rid="pcbi.1011422.ref082" ref-type="bibr">82</xref>]. Nonetheless, the number of sequences assigned to these taxa corresponds to only 0.72% of the total number of representative sequences that VIRify classified. Overall, VIRify provided a more comprehensive and updated taxonomic characterisation of the viral sequences that comprise the GPD.</p>
    <p>Despite the great performance observed for the analysed assemblies, our results revealed a few limitations of the current VIRify pipeline. As evidenced by the analysis of the Neto assembly, VIRify’s ability to detect contigs from eukaryotic viruses is currently suboptimal. Increasing the pipeline’s sensitivity will require the careful evaluation of novel viral prediction tools that could easily be incorporated or used to replace the ones currently used. For example, VirSorter might be replaced by the recently released VirSorter2 [<xref rid="pcbi.1011422.ref083" ref-type="bibr">83</xref>] in a future version of VIRify. An additional limitation of VIRify is the existing bias in the extent to which the informative ViPhOGs represent the different genera in the current viral taxonomy. We determined that our current collection of informative ViPhOGs covers 38.6% of the lineages that comprise the current viral taxonomy, which has evidently decreased in comparison with the value calculated for the NCBI viral taxonomy from March 2020 (89.3%). This reduction in coverage reflects the substantial changes that the viral taxonomy has experienced since the ViPhOGs were generated. Our results demonstrate that the informative ViPhOGs are a powerful resource for the taxonomic classification of contigs from covered viral taxa, but it is imperative to generate new ViPhOGs that expand the taxonomic coverage to provide the community with a general-purpose viral analysis tool. This task will be central to the upcoming developments of VIRify. Finally, the quality of the metagenomic assembly is key for VIRify’s performance due to the challenge that short viral contigs pose on their detection by the viral prediction tools currently used in the pipeline (<bold><xref rid="pcbi.1011422.g003" ref-type="fig">Fig 3A</xref></bold>). Furthermore, short contigs will generally contain fewer complete CDS, and thus will be less likely to have the minimum number of ViPhOG hits required by the pipeline to provide a taxonomic assignment.</p>
    <p>VIRify is a novel HMM-based resource for viral taxonomic classification that can be broadly classified as a protein similarity-based method. There are other types of approaches that have been efficiently implemented for viral taxonomic profiling, such as the use of kmer matching to a reference database of complete phage genomes. Phanta, a recently developed tool for phage-inclusive gut microbiome profiling, takes advantage of a much larger number of phages discovered through extensive analyses of the human gut microbiome, in comparison with other biomes [<xref rid="pcbi.1011422.ref084" ref-type="bibr">84</xref>]. This tool uses a large database of gut phages and their associated taxonomic information to perform taxonomic profiling using kmer-based searches, which allows the analysis of phage communities from metagenomic reads. This is an advantage over methods that rely on metagenomic assemblies (such as VIRify) because the analysis of reads allows the detection of low-abundance phages that are difficult to assemble into contigs [<xref rid="pcbi.1011422.ref085" ref-type="bibr">85</xref>,<xref rid="pcbi.1011422.ref086" ref-type="bibr">86</xref>]. However, the advantage of using protein profile HMMs is that they gather viral reference data in a more efficient and compact way, in comparison with databases of complete genomes generally required by kmer-based methods. This is particularly relevant in the case of Phanta, which was designed to perform taxonomic profiling at the species level. Therefore, the combination of VIRify with a larger collection of ViPhOGs covering the entire viral taxonomy would be easier to implement as a general-purpose viral taxonomic profiling, than methods relying on the use of collections of complete reference genomes.</p>
    <p>Although VIRify has been benchmarked and validated with metagenomic data in mind, it is also possible to use the pipeline to detect RNA viruses in metatranscriptome assemblies (e.g. SARS-CoV-2, see [<xref rid="pcbi.1011422.ref087" ref-type="bibr">87</xref>]). Some additional considerations in this regard include 1) quality control, 2) assembly, 3) post-processing, and 4) classification. Some brief recommendations on how to prepare metatranscriptome assemblies and run them through VIRify can be found in the GitHub manual.</p>
    <p>Overall, our results demonstrated the utility of VIRify for analysing viral communities in metagenomic datasets. In contrast with other resources currently available, VIRify offers an enhanced capability to predict contigs from eukaryotic viruses and the ability to taxonomically classify viral contigs using a set of carefully curated HMMs and their bespoke bitscore thresholds. Future versions of VIRify will attempt to improve even further the sensitivity of viral contig prediction and to extend the ViPhOGs’ taxonomic coverage by including sequences from uncultured viruses. In addition, the taxonomic classification of contigs from small viruses could be improved by adjusting the taxonomic voting system to accommodate differences in the number of available informative ViPhOGs and in the average genome size observed between different viral lineages. VIRify will be fully integrated into the MGnify suite of metagenomic analyses hosted at the EMBL-EBI, which is continuously supported and updated to suit the needs of the scientific community.</p>
    <sec id="sec026">
      <title>Runtime and resources</title>
      <p>The pipeline runtime can vary significantly depending on the hardware and data size. For optimal performance, we recommend running VIRify on high-performance computing (HPC) systems or the cloud, especially for larger datasets. On a typical laptop with 8 cores, the pipeline runs reasonably fast for small datasets, such as the two mock community data sets, taking approximately 16 minutes for the Kleiner co-assembly and 30 minutes for the Neto co-assembly. However, for larger datasets like the 243 TARA Ocean assemblies, the pipeline requires 2 days and 13 hours on an HPC system with SLURM and the default configuration profile for cluster execution. This runtime estimate includes the execution time for each process, excluding database downloads. Keep in mind that the actual runtime can be influenced by factors such as fluctuation and pending jobs due to high demand on the HPC. The RAM requirements of the VIRify processes are generally low and can be run on a decent laptop (minimum 8 GB). Experienced users can adjust CPU and RAM resources in the Nextflow configuration to optimize performance on an HPC or cloud infrastructure. The disk space required by VIRify is generally reasonable compared to the input size. While Kleiner and Neto’s output folders comprised 130 and 270 MB, respectively, the full TARA run (including virus prediction and taxonomy assignment) required 174 GB. The GPD run, which skipped virus prediction and performed only CDS detection and taxonomy assignment, required 12 GB of storage. In addition, intermediate files in the Nextflow working directory can take up much space; for example, 263 GB of intermediate data were written to the work directory for all 243 TARA assemblies, while less than 1 GB of space was used for Kleiner and Neto.</p>
    </sec>
  </sec>
  <sec id="sec027" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1011422.s001" position="float" content-type="local-data">
      <label>S1 Fig</label>
      <caption>
        <title>Informative ViPhOGs’ coverage of viral taxonomy.</title>
        <p>Circular dendrograms showing the NCBI virus taxonomy from March 2020 (upper panel) and January 2023 (lower pannel), with taxa covered by informative ViPhOGs highlighted with either dots or bars, and using the same colour scheme as in <bold><xref rid="pcbi.1011422.g002" ref-type="fig">Fig 2</xref></bold>. For the taxonomic ranks (order, family and subfamily) dots were used to indicate whether any informative ViPhOGs were identified for the corresponding taxon. By contrast, bars were used for taxa in the genus rank (tree’s leaves) to indicate the number of different informative ViPhOGs identified for the corresponding genus, as indicated by the numeric scale in the outer rings.</p>
        <p>(PNG)</p>
      </caption>
      <media xlink:href="pcbi.1011422.s001.png">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011422.s002" position="float" content-type="local-data">
      <label>S2 Fig</label>
      <caption>
        <title>F-score comparison for virus prediction results from the Kleiner and Neto assemblies for all tools run via WtP and VIRify (combination of VirSorter, VirFinder with VF.modEPV_k8.rda model and PPR-Meta).</title>
        <p>(PNG)</p>
      </caption>
      <media xlink:href="pcbi.1011422.s002.png">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011422.s003" position="float" content-type="local-data">
      <label>S3 Fig</label>
      <caption>
        <title>UpSet output for the Neto assembly calculated with WtP.</title>
        <p>Viral prediction tools are compared and overlapping sets are shown.</p>
        <p>(PNG)</p>
      </caption>
      <media xlink:href="pcbi.1011422.s003.png">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011422.s004" position="float" content-type="local-data">
      <label>S4 Fig</label>
      <caption>
        <title>Abundance plot of viral ranks predicted for 243 TARA Oceans assemblies (<ext-link xlink:href="https://www.ebi.ac.uk/ena/browser/view/PRJEB22493" ext-link-type="uri">https://www.ebi.ac.uk/ena/browser/view/PRJEB22493</ext-link>) using the VIRify pipeline.</title>
        <p>Combined results for high confidence, low confidence, and putative prophage hits are shown. VIRify was run in v0.2 and with the—virome option and a contig length filtering of 5000 nt.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1011422.s004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>The authors thank Franziska Hufsky for improving the readability of the illustrations. The authors would also like to acknowledge Lorna Richardson for contributing to the edition of the final manuscript version.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1011422.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Bergh</surname><given-names>O</given-names></name>, <name><surname>Børsheim</surname><given-names>KY</given-names></name>, <name><surname>Bratbak</surname><given-names>G</given-names></name>, <name><surname>Heldal</surname><given-names>M</given-names></name>. <article-title>High abundance of viruses found in aquatic environments</article-title>. <source>Nature</source>. <year>1989</year><month>Aug</month><day>10</day>;<volume>340</volume>(<issue>6233</issue>):<fpage>467</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/340467a0</pub-id><?supplied-pmid 2755508?><pub-id pub-id-type="pmid">2755508</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Braga</surname><given-names>LPP</given-names></name>, <name><surname>Soucy</surname><given-names>SM</given-names></name>, <name><surname>Amgarten</surname><given-names>DE</given-names></name>, <name><surname>Silva</surname><given-names>AM da</given-names></name>, <name><surname>Setubal</surname><given-names>JC</given-names></name>. <article-title>Bacterial Diversification in the Light of the Interactions with Phages: The Genetic Symbionts and Their Role in Ecological Speciation.</article-title><source>Frontiers in Ecology and Evolution</source>. <year>2018</year>;<volume>6</volume>:<fpage>6</fpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Clokie</surname><given-names>MRJ</given-names></name>, <name><surname>Millard</surname><given-names>AD</given-names></name>, <name><surname>Letarov</surname><given-names>AV</given-names></name>, <name><surname>Heaphy</surname><given-names>S</given-names></name>. <article-title>Phages in nature</article-title>. <source>Bacteriophage</source>. <year>2011</year>;<volume>1</volume>(<issue>1</issue>):<fpage>31</fpage>–<lpage>45</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.4161/bact.1.1.14942</pub-id><?supplied-pmid 21687533?><pub-id pub-id-type="pmid">21687533</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Stern</surname><given-names>A</given-names></name>, <name><surname>Sorek</surname><given-names>R</given-names></name>. <article-title>The phage-host arms race: shaping the evolution of microbes</article-title>. <source>Bioessays</source>. <year>2011</year>;<volume>33</volume>(<issue>1</issue>):<fpage>43</fpage>–<lpage>51</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/bies.201000071</pub-id><?supplied-pmid 20979102?><pub-id pub-id-type="pmid">20979102</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Weinbauer</surname><given-names>MG</given-names></name>, <name><surname>Rassoulzadegan</surname><given-names>F</given-names></name>. <article-title>Are viruses driving microbial diversification and diversity?</article-title><source>Environ Microbiol</source>. <year>2004</year>;<volume>6</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>11</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1046/j.1462-2920.2003.00539.x</pub-id><?supplied-pmid 14686936?><pub-id pub-id-type="pmid">14686936</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Edwards</surname><given-names>RA</given-names></name>, <name><surname>Rohwer</surname><given-names>F</given-names></name>. <article-title>Viral metagenomics.</article-title><source>Nat Rev Microbiol [Internet].</source><year>2005</year>;<volume>3</volume>(<issue>6</issue>). Available from: <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nrmicro1163</pub-id><?supplied-pmid 15886693?><pub-id pub-id-type="pmid">15886693</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Reyes</surname><given-names>A</given-names></name>, <name><surname>Semenkovich</surname><given-names>NP</given-names></name>, <name><surname>Whiteson</surname><given-names>K</given-names></name>, <name><surname>Rohwer</surname><given-names>F</given-names></name>, <name><surname>Gordon</surname><given-names>JI</given-names></name>. <article-title>Going viral: next-generation sequencing applied to phage populations in the human gut</article-title>. <source>Nat Rev Microbiol</source>. <year>2012</year>;<volume>10</volume>(<issue>9</issue>):<fpage>607</fpage>–<lpage>17</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nrmicro2853</pub-id><?supplied-pmid 22864264?><pub-id pub-id-type="pmid">22864264</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Dutilh</surname><given-names>BE</given-names></name>, <name><surname>Cassman</surname><given-names>N</given-names></name>, <name><surname>McNair</surname><given-names>K</given-names></name>, <name><surname>Sanchez</surname><given-names>SE</given-names></name>, <name><surname>Silva</surname><given-names>GGZ</given-names></name>, <name><surname>Boling</surname><given-names>L</given-names></name>, <etal>et al</etal>. <article-title>A highly abundant bacteriophage discovered in the unknown sequences of human faecal metagenomes.</article-title><source>Nat Commun</source>. <year>2014</year>;<volume>5</volume>(<issue>1</issue>):<fpage>4498</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/ncomms5498</pub-id><?supplied-pmid 25058116?><pub-id pub-id-type="pmid">25058116</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Hurwitz</surname><given-names>BL</given-names></name>, <name><surname>One</surname><given-names>S</given-names></name>. <article-title>MB</article-title>. <source>The Pacific Ocean Virome (POV): a marine viral metagenomic dataset and associated protein clusters for quantitative viral ecology.</source><year>2013</year>; Available from: <pub-id pub-id-type="doi">10.1371/journal.pone.0057355</pub-id>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Reyes</surname><given-names>A</given-names></name>, <name><surname>Haynes</surname><given-names>M</given-names></name>, <name><surname>Hanson</surname><given-names>N</given-names></name>, <name><surname>Angly</surname><given-names>FE</given-names></name>, <name><surname>Heath</surname><given-names>AC</given-names></name>, <name><surname>Rohwer</surname><given-names>F</given-names></name>, <etal>et al</etal>. <article-title>Viruses in the faecal microbiota of monozygotic twins and their mothers</article-title>. <source>Nature</source>. <year>2010</year>;<volume>466</volume>(<issue>7304</issue>):<fpage>334</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature09199</pub-id><?supplied-pmid 20631792?><pub-id pub-id-type="pmid">20631792</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Roux</surname><given-names>S</given-names></name>, <name><surname>Enault</surname><given-names>F</given-names></name>, <name><surname>Robin</surname><given-names>A</given-names></name>, <name><surname>Ravet</surname><given-names>V</given-names></name>, <name><surname>One</surname><given-names>P</given-names></name>. <source>S. Assessing the diversity and specificity of two freshwater viral communities through metagenomics</source>. <year>2012</year>;</mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Gregory</surname><given-names>AC</given-names></name>, <name><surname>Zayed</surname><given-names>AA</given-names></name>, <name><surname>Conceição-Neto</surname><given-names>N</given-names></name>, <name><surname>Temperton</surname><given-names>B</given-names></name>, <name><surname>Bolduc</surname><given-names>B</given-names></name>, <name><surname>Alberti</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Marine DNA Viral Macro- and Microdiversity from Pole to Pole</article-title>. <source>Cell [Internet].</source><year>2019</year>; Available from: <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2019.03.040</pub-id><?supplied-pmid 31031001?><pub-id pub-id-type="pmid">31031001</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Paez-Espino</surname><given-names>D</given-names></name>, <name><surname>Eloe-Fadrosh</surname><given-names>EA</given-names></name>, <name><surname>Nature</surname><given-names>PGA</given-names></name>. <source>Uncovering Earth’s virome</source>. <year>2016</year>; Available from: <pub-id pub-id-type="doi">10.1038/nature19094</pub-id>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Shkoporov</surname><given-names>AN</given-names></name>, <name><surname>Clooney</surname><given-names>AG</given-names></name>, <name><surname>Sutton</surname><given-names>T</given-names></name>, <name><surname>Ryan</surname><given-names>FJ</given-names></name>, <name><surname>Daly</surname><given-names>KM</given-names></name>, <name><surname>Nolan</surname><given-names>JA</given-names></name>, <etal>et al</etal>. <article-title>The Human Gut Virome Is Highly Diverse, Stable, and Individual Specific.</article-title><source>Cell Host Microbe.</source><year>2019</year>;<volume>26</volume>(<issue>4</issue>):<fpage>527</fpage>–<lpage>41.e5.</lpage><comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.chom.2019.09.009</pub-id><?supplied-pmid 31600503?><pub-id pub-id-type="pmid">31600503</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Roux</surname><given-names>S</given-names></name>, <name><surname>Adriaenssens</surname><given-names>EM</given-names></name>, <name><surname>Dutilh</surname><given-names>BE</given-names></name>, <name><surname>Koonin</surname><given-names>EV</given-names></name>, <name><surname>Kropinski</surname><given-names>AM</given-names></name>, <name><surname>Krupovic</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Minimum Information about an Uncultivated Virus Genome (MIUViG).</article-title><source>Nat Biotechnol [Internet].</source><year>2018</year>; Available from: <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nbt.4306</pub-id><?supplied-pmid 30556814?><pub-id pub-id-type="pmid">30556814</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Breitbart</surname><given-names>M</given-names></name>, <name><surname>Bonnain</surname><given-names>C</given-names></name>, <name><surname>Malki</surname><given-names>K</given-names></name>, <name><surname>Sawaya</surname><given-names>NA</given-names></name>. <article-title>Phage puppet masters of the marine microbial realm</article-title>. <source>Nature Microbiology</source>. <year>2018</year>;<volume>3</volume>(<issue>7</issue>):<fpage>754</fpage>–<lpage>66</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41564-018-0166-y</pub-id><?supplied-pmid 29867096?><pub-id pub-id-type="pmid">29867096</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Roux</surname><given-names>S</given-names></name>, <name><surname>Brum</surname><given-names>JR</given-names></name>, <name><surname>Dutilh</surname><given-names>BE</given-names></name>, <name><surname>Sunagawa</surname><given-names>S</given-names></name>, <name><surname>Duhaime</surname><given-names>MB</given-names></name>, <name><surname>Loy</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Ecogenomics and potential biogeochemical impacts of globally abundant ocean viruses</article-title>. <source>Nature</source>. <year>2016</year>;<volume>537</volume>(<issue>7622</issue>):<fpage>689</fpage>–<lpage>93</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature19366</pub-id><?supplied-pmid 27654921?><pub-id pub-id-type="pmid">27654921</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Sunagawa</surname><given-names>S</given-names></name>, <name><surname>Acinas</surname><given-names>SG</given-names></name>, <name><surname>Bork</surname><given-names>P</given-names></name>, <name><surname>Bowler</surname><given-names>C</given-names></name>, <name><surname>Acinas</surname><given-names>SG</given-names></name>, <name><surname>Babin</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Tara Oceans: towards global ocean ecosystems biology</article-title>. <source>Nat Rev Microbiol</source>. <year>2020</year>;<volume>18</volume>(<issue>8</issue>):<fpage>428</fpage>–<lpage>45</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41579-020-0364-5</pub-id><?supplied-pmid 32398798?><pub-id pub-id-type="pmid">32398798</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Rohwer</surname><given-names>F</given-names></name>, <name><surname>Edwards</surname><given-names>R</given-names></name>. <article-title>The Phage Proteomic Tree: a genome-based taxonomy for phage</article-title>. <source>J Bacteriol</source>. <year>2002</year>;<volume>184</volume>(<issue>16</issue>):<fpage>4529</fpage>–<lpage>35</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1128/JB.184.16.4529-4535.2002</pub-id><?supplied-pmid 12142423?><pub-id pub-id-type="pmid">12142423</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Meier-Kolthoff</surname><given-names>JP</given-names></name>, <name><surname>Göker</surname><given-names>M</given-names></name>. <article-title>VICTOR: genome-based phylogeny and classification of prokaryotic viruses</article-title>. <source>Bioinformatics</source>. <year>2017</year>;<volume>33</volume>(<issue>21</issue>):<fpage>3396</fpage>–<lpage>404</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btx440</pub-id><?supplied-pmid 29036289?><pub-id pub-id-type="pmid">29036289</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Aiewsakun</surname><given-names>P</given-names></name>, <name><surname>Adriaenssens</surname><given-names>EM</given-names></name>, <name><surname>Lavigne</surname><given-names>R</given-names></name>, <name><surname>Kropinski</surname><given-names>AM</given-names></name>, <name><surname>Simmonds</surname><given-names>P</given-names></name>. <article-title>Evaluation of the genomic diversity of viruses infecting bacteria, archaea and eukaryotes using a common bioinformatic platform: steps towards a unified taxonomy</article-title>. <source>J Gen Virol</source>. <year>2018</year>;<volume>99</volume>(<issue>9</issue>):<fpage>1331</fpage>–<lpage>43</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1099/jgv.0.001110</pub-id><?supplied-pmid 30016225?><pub-id pub-id-type="pmid">30016225</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Jang</surname><given-names>H</given-names></name>, <name><surname>Bolduc</surname><given-names>B</given-names></name>, <name><surname>Zablocki</surname><given-names>O</given-names></name>, <name><surname>Kuhn</surname><given-names>JH</given-names></name>, <name><surname>Roux</surname><given-names>S</given-names></name>, <name><surname>Adriaenssens</surname><given-names>EM</given-names></name>, <etal>et al</etal>. <article-title>Taxonomic assignment of uncultivated prokaryotic virus genomes is enabled by gene-sharing networks</article-title>. <source>Nat Biotechnol</source>. <year>2019</year>;<fpage>1</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">30605152</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Chibani</surname><given-names>C</given-names></name>, <name><surname>Farr</surname><given-names>A</given-names></name>, <name><surname>Klama</surname><given-names>S</given-names></name>, <name><surname>Dietrich</surname><given-names>S</given-names></name>, <name><surname>Liesegang</surname><given-names>H</given-names></name>. <article-title>Classifying the Unclassified: A Phage Classification Method.</article-title><source>Viruses</source>. <year>2019</year>;<volume>11</volume>(<issue>2</issue>):<fpage>195</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3390/v11020195</pub-id><?supplied-pmid 30813498?><pub-id pub-id-type="pmid">30813498</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Moreno-Gallego</surname><given-names>JL</given-names></name>, <name><surname>Reyes</surname><given-names>A</given-names></name>. <article-title>Informative Regions In Viral Genomes.</article-title><source>Viruses</source>. <year>2021</year>;<volume>13</volume>(<issue>6</issue>):<fpage>1164</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3390/v13061164</pub-id><?supplied-pmid 34207030?><pub-id pub-id-type="pmid">34207030</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Bolduc</surname><given-names>B</given-names></name>, <name><surname>Youens-Clark</surname><given-names>K</given-names></name>, <name><surname>Roux</surname><given-names>S</given-names></name>, <name><surname>Hurwitz</surname><given-names>BL</given-names></name>, <name><surname>Sullivan</surname><given-names>MB</given-names></name>. <article-title>iVirus: facilitating new insights in viral ecology with software and community data sets imbedded in a cyberinfrastructure</article-title>. <source>ISME J</source>. <year>2017</year>;<volume>11</volume>(<issue>1</issue>):<fpage>7</fpage>–<lpage>14</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/ismej.2016.89</pub-id><?supplied-pmid 27420028?><pub-id pub-id-type="pmid">27420028</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Zheng</surname><given-names>T</given-names></name>, <name><surname>Li</surname><given-names>J</given-names></name>, <name><surname>Ni</surname><given-names>Y</given-names></name>, <name><surname>Kang</surname><given-names>K</given-names></name>, <name><surname>Misiakou</surname><given-names>MA</given-names></name>, <name><surname>Imamovic</surname><given-names>L</given-names></name>, <etal>et al</etal>. <article-title>Mining, analyzing, and integrating viral signals from metagenomic data.</article-title><source>Microbiome</source>. <year>2019</year>;<volume>7</volume>(<issue>1</issue>):<fpage>42</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s40168-019-0657-y</pub-id><?supplied-pmid 30890181?><pub-id pub-id-type="pmid">30890181</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Bolduc</surname><given-names>B</given-names></name>, <name><surname>Zablocki</surname><given-names>O</given-names></name>, <name><surname>Guo</surname><given-names>J</given-names></name>, <name><surname>Zayed</surname><given-names>AA</given-names></name>, <name><surname>Vik</surname><given-names>D</given-names></name>, <name><surname>Dehal</surname><given-names>P</given-names></name>, <etal>et al</etal>. <article-title>iVirus 2.0: Cyberinfrastructure-supported tools and data to power DNA virus ecology</article-title>. <source>ISME Communications</source>. <year>2021</year>;<volume>1</volume>(<issue>1</issue>):<fpage>77</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s43705-021-00083-3</pub-id><?supplied-pmid 36765102?><pub-id pub-id-type="pmid">36765102</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Roach</surname><given-names>MJ</given-names></name>, <name><surname>Beecroft</surname><given-names>SJ</given-names></name>, <name><surname>Mihindukulasuriya</surname><given-names>KA</given-names></name>, <name><surname>Wang</surname><given-names>L</given-names></name>, <name><surname>Paredes</surname><given-names>A</given-names></name>, <name><surname>Henry-Cocks</surname><given-names>K</given-names></name>, <etal>et al</etal>. <article-title>Hecatomb: An End-to-End Research Platform for Viral Metagenomics [Internet].</article-title><source>bioRxiv</source>. <year>2022</year> [cited 2023 Jul 9]. p. <fpage>2022</fpage>.05.15.492003. Available from: <ext-link xlink:href="https://www.biorxiv.org/content/10.1101/2022.05.15.492003v2" ext-link-type="uri">https://www.biorxiv.org/content/10.1101/2022.05.15.492003v2</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Pandolfo</surname><given-names>M</given-names></name>, <name><surname>Telatin</surname><given-names>A</given-names></name>, <name><surname>Lazzari</surname><given-names>G</given-names></name>, <name><surname>Adriaenssens</surname><given-names>EM</given-names></name>, <name><surname>Vitulo</surname><given-names>N</given-names></name>. <article-title>MetaPhage: an Automated Pipeline for Analyzing, Annotating, and Classifying Bacteriophages in Metagenomics Sequencing Data.</article-title><source>mSystems</source>. <year>2022</year><month>Oct</month><day>26</day>;<volume>7</volume>(<issue>5</issue>):<fpage>e0074122</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1128/msystems.00741-22</pub-id><?supplied-pmid 36069454?><pub-id pub-id-type="pmid">36069454</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Tommaso</surname><given-names>PD</given-names></name>, <name><surname>Chatzou</surname><given-names>M</given-names></name>, <name><surname>Floden</surname><given-names>EW</given-names></name>, <name><surname>Barja</surname><given-names>PP</given-names></name>, <name><surname>Palumbo</surname><given-names>E</given-names></name>, <name><surname>Notredame</surname><given-names>C</given-names></name>. <article-title>Nextflow enables reproducible computational workflows</article-title>. <source>Nat Biotechnol</source>. <year>2017</year>;<volume>35</volume>(<issue>4</issue>):<fpage>316</fpage>–<lpage>9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nbt.3820</pub-id><?supplied-pmid 28398311?><pub-id pub-id-type="pmid">28398311</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Mitchell</surname><given-names>AL</given-names></name>, <name><surname>Almeida</surname><given-names>A</given-names></name>, <name><surname>Beracochea</surname><given-names>M</given-names></name>, <name><surname>Boland</surname><given-names>M</given-names></name>, <name><surname>Burgin</surname><given-names>J</given-names></name>, <name><surname>Cochrane</surname><given-names>G</given-names></name>, <etal>et al</etal>. <article-title>MGnify: the microbiome analysis resource in 2020</article-title>. <source>Nucleic Acids Res</source>. <year>2019</year>;<volume>48</volume>(<issue>D1</issue>):<fpage>D570</fpage>–<lpage>8</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Kleiner</surname><given-names>M</given-names></name>, <name><surname>Hooper</surname><given-names>LV</given-names></name>, <name><surname>Duerkop</surname><given-names>BA</given-names></name>. <article-title>Evaluation of methods to purify virus-like particles for metagenomic sequencing of intestinal viromes</article-title>. <source>BMC Genomics</source>. <year>2015</year>;<volume>16</volume>:<fpage>7</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s12864-014-1207-4</pub-id><?supplied-pmid 25608871?><pub-id pub-id-type="pmid">25608871</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Conceição-Neto</surname><given-names>N</given-names></name>, <name><surname>Zeller</surname><given-names>M</given-names></name>, <name><surname>Lefrère</surname><given-names>H</given-names></name>, <name><surname>Bruyn</surname><given-names>P</given-names></name>, <name><surname>Beller</surname><given-names>L</given-names></name>, <name><surname>Deboutte</surname><given-names>W</given-names></name>, <etal>et al</etal>. <article-title>Modular approach to customise sample preparation procedures for viral metagenomics: a reproducible protocol for virome analysis.</article-title><source>Sci Rep</source>. <year>2015</year>;<volume>5</volume>(<issue>1</issue>):<fpage>16532</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/srep16532</pub-id><?supplied-pmid 26559140?><pub-id pub-id-type="pmid">26559140</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Camarillo-Guerrero</surname><given-names>LF</given-names></name>, <name><surname>Almeida</surname><given-names>A</given-names></name>, <name><surname>Rangel-Pineros</surname><given-names>G</given-names></name>, <name><surname>Finn</surname><given-names>RD</given-names></name>, <name><surname>Lawley</surname><given-names>TD</given-names></name>. <article-title>Massive expansion of human gut bacteriophage diversity</article-title>. <source>Cell</source>. <year>2021</year><month>Feb</month><day>18</day>;<volume>184</volume>(<issue>4</issue>):<fpage>1098</fpage>–<lpage>109.e9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2021.01.029</pub-id><?supplied-pmid 33606979?><pub-id pub-id-type="pmid">33606979</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Mistry</surname><given-names>J</given-names></name>, <name><surname>Chuguransky</surname><given-names>S</given-names></name>, <name><surname>Williams</surname><given-names>L</given-names></name>, <name><surname>Qureshi</surname><given-names>M</given-names></name>, <name><surname>Salazar</surname><given-names>GA</given-names></name>, <name><surname>Sonnhammer</surname><given-names>ELL</given-names></name>, <etal>et al</etal>. <article-title>Pfam: The protein families database in 2021</article-title>. <source>Nucleic Acids Res</source>. <year>2020</year>;<volume>49</volume>(<issue>D1</issue>):<fpage>gkaa913</fpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Huerta-Cepas</surname><given-names>J</given-names></name>, <name><surname>Serra</surname><given-names>F</given-names></name>, <name><surname>Bork</surname><given-names>P</given-names></name>. <article-title>ETE 3: Reconstruction, Analysis, and Visualization of Phylogenomic Data</article-title>. <source>Mol Biol Evol</source>. <year>2016</year>;<volume>33</volume>(<issue>6</issue>):<fpage>1635</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msw046</pub-id><?supplied-pmid 26921390?><pub-id pub-id-type="pmid">26921390</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Federhen</surname><given-names>S.</given-names></name><article-title>The NCBI Taxonomy database</article-title>. <source>Nucleic Acids Res</source>. <year>2012</year>;<volume>40</volume>(<issue>Database issue</issue>):<fpage>D136</fpage>–<lpage>43</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkr1178</pub-id><?supplied-pmid 22139910?><pub-id pub-id-type="pmid">22139910</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Letunic</surname><given-names>I</given-names></name>, <name><surname>Bork</surname><given-names>P</given-names></name>. <article-title>Interactive Tree Of Life (iTOL) v4: recent updates and new developments.</article-title><source>Nucleic Acids Res</source>. <year>2019</year>;<volume>47</volume>(<issue>W1</issue>):<fpage>gkz239</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkz239</pub-id><?supplied-pmid 30931475?><pub-id pub-id-type="pmid">30931475</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Mihara</surname><given-names>T</given-names></name>, <name><surname>Nishimura</surname><given-names>Y</given-names></name>, <name><surname>Shimizu</surname><given-names>Y</given-names></name>, <name><surname>Nishiyama</surname><given-names>H</given-names></name>, <name><surname>Yoshikawa</surname><given-names>G</given-names></name>, <name><surname>Uehara</surname><given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Linking Virus Genomes with Host Taxonomy.</article-title><source>Viruses</source>. <year>2016</year>;<volume>8</volume>(<issue>3</issue>):<fpage>66</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3390/v8030066</pub-id><?supplied-pmid 26938550?><pub-id pub-id-type="pmid">26938550</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>S</given-names></name>, <name><surname>Zhou</surname><given-names>Y</given-names></name>, <name><surname>Chen</surname><given-names>Y</given-names></name>, <name><surname>Gu</surname><given-names>J</given-names></name>. <article-title>fastp: an ultra-fast all-in-one FASTQ preprocessor</article-title>. <source>Bioinformatics</source>. <year>2018</year>;<volume>34</volume>(<issue>17</issue>):<fpage>i884</fpage>–<lpage>90</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/bty560</pub-id><?supplied-pmid 30423086?><pub-id pub-id-type="pmid">30423086</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Nurk</surname><given-names>S</given-names></name>, <name><surname>Meleshko</surname><given-names>D</given-names></name>, <name><surname>Korobeynikov</surname><given-names>A</given-names></name>, <name><surname>Pevzner</surname><given-names>PA</given-names></name>. <article-title>metaSPAdes: a new versatile metagenomic assembler</article-title>. <source>Genome Res</source>. <year>2017</year>;<volume>27</volume>(<issue>5</issue>):<fpage>824</fpage>–<lpage>34</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1101/gr.213959.116</pub-id><?supplied-pmid 28298430?><pub-id pub-id-type="pmid">28298430</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Gurevich</surname><given-names>A</given-names></name>, <name><surname>Saveliev</surname><given-names>V</given-names></name>, <name><surname>Vyahhi</surname><given-names>N</given-names></name>, <name><surname>Tesler</surname><given-names>G</given-names></name>. <article-title>QUAST: quality assessment tool for genome assemblies</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>(<issue>8</issue>):<fpage>1072</fpage>–<lpage>5</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btt086</pub-id><?supplied-pmid 23422339?><pub-id pub-id-type="pmid">23422339</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Marquet</surname><given-names>M</given-names></name>, <name><surname>Hölzer</surname><given-names>M</given-names></name>, <name><surname>Pletz</surname><given-names>MW</given-names></name>, <name><surname>Viehweger</surname><given-names>A</given-names></name>, <name><surname>Makarewicz</surname><given-names>O</given-names></name>, <name><surname>Ehricht</surname><given-names>R</given-names></name>, <etal>et al</etal>. <article-title>What the Phage: a scalable workflow for the identification and analysis of phage sequences.</article-title><source>Gigascience</source>. <year>2022</year>;<volume>11</volume>:<fpage>giac110</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/gigascience/giac110</pub-id><?supplied-pmid 36399058?><pub-id pub-id-type="pmid">36399058</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Ren</surname><given-names>J</given-names></name>, <name><surname>Song</surname><given-names>K</given-names></name>, <name><surname>Deng</surname><given-names>C</given-names></name>, <name><surname>Ahlgren</surname><given-names>NA</given-names></name>, <name><surname>Fuhrman</surname><given-names>JA</given-names></name>, <name><surname>Li</surname><given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Identifying viruses from metagenomic data using deep learning</article-title>. <source>Quantitative Biology</source>. <year>2020</year>;<volume>8</volume>(<issue>1</issue>):<fpage>64</fpage>–<lpage>77</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s40484-019-0187-4</pub-id><?supplied-pmid 34084563?><pub-id pub-id-type="pmid">34084563</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Amgarten</surname><given-names>D</given-names></name>, <name><surname>Braga</surname><given-names>LPP</given-names></name>, <name><surname>Silva</surname><given-names>AM da</given-names></name>, <name><surname>Setubal</surname><given-names>JC</given-names></name>. <article-title>MARVEL, a Tool for Prediction of Bacteriophage Sequences in Metagenomic Bins.</article-title><source>Front Genet</source>. <year>2018</year>;<volume>9</volume>:<fpage>304</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3389/fgene.2018.00304</pub-id><?supplied-pmid 30131825?><pub-id pub-id-type="pmid">30131825</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Jurtz</surname><given-names>VI</given-names></name>, <name><surname>Villarroel</surname><given-names>J</given-names></name>, <name><surname>Lund</surname><given-names>O</given-names></name>, <name><surname>Larsen</surname><given-names>MV</given-names></name>, <name><surname>Nielsen</surname><given-names>M</given-names></name>. <article-title>MetaPhinder—Identifying Bacteriophage Sequences in Metagenomic Data Sets.</article-title><source>PLoS One.</source><year>2016</year>;<volume>11</volume>(<issue>9</issue>):<fpage>e0163111</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0163111</pub-id><?supplied-pmid 27684958?><pub-id pub-id-type="pmid">27684958</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>Kieft</surname><given-names>K</given-names></name>, <name><surname>Zhou</surname><given-names>Z</given-names></name>, <name><surname>Anantharaman</surname><given-names>K</given-names></name>. <article-title>VIBRANT: automated recovery, annotation and curation of microbial viruses, and evaluation of viral community function from genomic sequences.</article-title><source>Microbiome</source>. <year>2020</year>;<volume>8</volume>(<issue>1</issue>):<fpage>90</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s40168-020-00867-0</pub-id><?supplied-pmid 32522236?><pub-id pub-id-type="pmid">32522236</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Abdelkareem</surname><given-names>AO</given-names></name>, <name><surname>Khalil</surname><given-names>MI</given-names></name>, <name><surname>Elbehery</surname><given-names>AHA</given-names></name>, <name><surname>Abbas</surname><given-names>HM</given-names></name>. <article-title>Viral Sequence Identification in Metagenomes using Natural Language Processing Techniques.</article-title><source>bioRxiv</source>. <year>2020</year>;<fpage>2020</fpage>.01.10.892158.</mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Starikova</surname><given-names>EV</given-names></name>, <name><surname>Tikhonova</surname><given-names>PO</given-names></name>, <name><surname>Prianichnikov</surname><given-names>NA</given-names></name>, <name><surname>Rands</surname><given-names>CM</given-names></name>, <name><surname>Zdobnov</surname><given-names>EM</given-names></name>, <name><surname>Ilina</surname><given-names>EN</given-names></name>, <etal>et al</etal>. <article-title>Phigaro: high-throughput prophage sequence annotation</article-title>. <source>Bioinformatics</source>. <year>2020</year>;<volume>36</volume>(<issue>12</issue>):<fpage>3882</fpage>–<lpage>4</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btaa250</pub-id><?supplied-pmid 32311023?><pub-id pub-id-type="pmid">32311023</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref050">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Pierce</surname><given-names>NT</given-names></name>, <name><surname>Irber</surname><given-names>L</given-names></name>, <name><surname>Reiter</surname><given-names>T</given-names></name>, <name><surname>Brooks</surname><given-names>P</given-names></name>, <name><surname>Brown</surname><given-names>CT</given-names></name>. <article-title>Large-scale sequence comparisons with sourmash.</article-title><source>F1000Res</source>. <year>2019</year>;<volume>8</volume>:<fpage>1006</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.12688/f1000research.19675.1</pub-id><?supplied-pmid 31508216?><pub-id pub-id-type="pmid">31508216</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref051">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Roux</surname><given-names>S</given-names></name>, <name><surname>Enault</surname><given-names>F</given-names></name>, <name><surname>Hurwitz</surname><given-names>BL</given-names></name>, <name><surname>Sullivan</surname><given-names>MB</given-names></name>. <article-title>VirSorter: mining viral signal from microbial genomic data.</article-title><source>PeerJ.</source><year>2015</year>;<volume>3</volume>:<fpage>e985</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.7717/peerj.985</pub-id><?supplied-pmid 26038737?><pub-id pub-id-type="pmid">26038737</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref052">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Arndt</surname><given-names>D</given-names></name>, <name><surname>Grant</surname><given-names>JR</given-names></name>, <name><surname>Marcu</surname><given-names>A</given-names></name>, <name><surname>Sajed</surname><given-names>T</given-names></name>, <name><surname>Pon</surname><given-names>A</given-names></name>, <name><surname>Liang</surname><given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>PHASTER: a better, faster version of the PHAST phage search tool</article-title>. <source>Nucleic Acids Res</source>. <year>2016</year>;<volume>44</volume>(<issue>W1</issue>):<fpage>W16</fpage>–<lpage>21</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkw387</pub-id><?supplied-pmid 27141966?><pub-id pub-id-type="pmid">27141966</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref053">
      <label>53</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>W</given-names></name>, <name><surname>Godzik</surname><given-names>A</given-names></name>. <article-title>Cd-hit: a fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title>. <source>Bioinformatics</source>. <year>2006</year>;<volume>22</volume>(<issue>13</issue>):<fpage>1658</fpage>–<lpage>9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btl158</pub-id><?supplied-pmid 16731699?><pub-id pub-id-type="pmid">16731699</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref054">
      <label>54</label>
      <mixed-citation publication-type="journal"><name><surname>Kurtz</surname><given-names>S</given-names></name>, <name><surname>Phillippy</surname><given-names>A</given-names></name>, <name><surname>Delcher</surname><given-names>AL</given-names></name>, <name><surname>Smoot</surname><given-names>M</given-names></name>, <name><surname>Shumway</surname><given-names>M</given-names></name>, <name><surname>Antonescu</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Versatile and open software for comparing large genomes</article-title>. <source>Genome Biol [Internet].</source><year>2004</year>;<volume>5</volume>(<issue>2</issue>). Available from: <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/gb-2004-5-2-r12</pub-id><?supplied-pmid 14759262?><pub-id pub-id-type="pmid">14759262</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref055">
      <label>55</label>
      <mixed-citation publication-type="journal"><name><surname>Ren</surname><given-names>J</given-names></name>, <name><surname>Ahlgren</surname><given-names>NA</given-names></name>, <name><surname>Lu</surname><given-names>YY</given-names></name>, <name><surname>Fuhrman</surname><given-names>JA</given-names></name>, <name><surname>Sun</surname><given-names>F</given-names></name>. <article-title>VirFinder: a novel k-mer based tool for identifying viral sequences from assembled metagenomic data.</article-title><source>Microbiome.</source><year>2017</year>;<volume>5</volume>(<issue>1</issue>):<fpage>69</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s40168-017-0283-5</pub-id><?supplied-pmid 28683828?><pub-id pub-id-type="pmid">28683828</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref056">
      <label>56</label>
      <mixed-citation publication-type="journal"><name><surname>Fang</surname><given-names>Z</given-names></name>, <name><surname>Tan</surname><given-names>J</given-names></name>, <name><surname>Wu</surname><given-names>S</given-names></name>, <name><surname>Li</surname><given-names>M</given-names></name>, <name><surname>Xu</surname><given-names>C</given-names></name>, <name><surname>Xie</surname><given-names>Z</given-names></name>, <etal>et al</etal>. <article-title>PPR-Meta: a tool for identifying phages and plasmids from metagenomic fragments using deep learning.</article-title><source>Gigascience [Internet].</source><year>2019</year>;<volume>8</volume>(<issue>6</issue>). Available from: <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/gigascience/giz066</pub-id><?supplied-pmid 31220250?><pub-id pub-id-type="pmid">31220250</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref057">
      <label>57</label>
      <mixed-citation publication-type="journal"><name><surname>Nayfach</surname><given-names>S</given-names></name>, <name><surname>Camargo</surname><given-names>AP</given-names></name>, <name><surname>Schulz</surname><given-names>F</given-names></name>, <name><surname>Eloe-Fadrosh</surname><given-names>E</given-names></name>, <name><surname>Roux</surname><given-names>S</given-names></name>, <name><surname>Kyrpides</surname><given-names>NC</given-names></name>. <article-title>CheckV assesses the quality and completeness of metagenome-assembled viral genomes</article-title>. <source>Nat Biotechnol</source>. <year>2021</year>;<volume>39</volume>(<issue>5</issue>):<fpage>578</fpage>–<lpage>85</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41587-020-00774-7</pub-id><?supplied-pmid 33349699?><pub-id pub-id-type="pmid">33349699</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref058">
      <label>58</label>
      <mixed-citation publication-type="journal"><name><surname>Hyatt</surname><given-names>D</given-names></name>, <name><surname>Chen</surname><given-names>GL</given-names></name>, <name><surname>LoCascio</surname><given-names>PF</given-names></name>, <name><surname>Land</surname><given-names>ML</given-names></name>, <name><surname>Larimer</surname><given-names>FW</given-names></name>, <name><surname>Hauser</surname><given-names>LJ</given-names></name>. <article-title>Prodigal: prokaryotic gene recognition and translation initiation site identification</article-title>. <source>BMC Bioinformatics</source>. <year>2010</year>;<volume>11</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>11</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1471-2105-11-119</pub-id><?supplied-pmid 20211023?><pub-id pub-id-type="pmid">20043860</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref059">
      <label>59</label>
      <mixed-citation publication-type="journal"><name><surname>González-Tortuero</surname><given-names>E</given-names></name>, <name><surname>Krishnamurthi</surname><given-names>R</given-names></name>, <name><surname>Allison</surname><given-names>HE</given-names></name>, <name><surname>Goodhead</surname><given-names>IB</given-names></name>, <name><surname>James</surname><given-names>CE</given-names></name>. <article-title>Comparative analysis of gene prediction tools for viral genome annotation</article-title>. <source>bioRxiv</source>. <year>2021</year>;<fpage>2021</fpage>.12.11.472104.</mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref060">
      <label>60</label>
      <mixed-citation publication-type="journal"><name><surname>Roux</surname><given-names>S</given-names></name>, <name><surname>Páez-Espino</surname><given-names>D</given-names></name>, <name><surname>Chen</surname><given-names>IMA</given-names></name>, <name><surname>Palaniappan</surname><given-names>K</given-names></name>, <name><surname>Ratner</surname><given-names>A</given-names></name>, <name><surname>Chu</surname><given-names>K</given-names></name>, <etal>et al</etal>. <article-title>IMG/VR v3: an integrated ecological and evolutionary framework for interrogating genomes of uncultivated viruses</article-title>. <source>Nucleic Acids Res</source>. <year>2020</year>;<volume>49</volume>(<issue>D1</issue>):<fpage>gkaa946</fpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref061">
      <label>61</label>
      <mixed-citation publication-type="journal"><name><surname>Potter</surname><given-names>SC</given-names></name>, <name><surname>Luciani</surname><given-names>A</given-names></name>, <name><surname>Eddy</surname><given-names>SR</given-names></name>, <name><surname>Park</surname><given-names>Y</given-names></name>, <name><surname>Lopez</surname><given-names>R</given-names></name>, <name><surname>Finn</surname><given-names>RD</given-names></name>. <article-title>HMMER web server: 2018 update</article-title>. <source>Nucleic Acids Res</source>. <year>2018</year>;<volume>46</volume>(<issue>W1</issue>):<fpage>W200</fpage>–<lpage>4</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gky448</pub-id><?supplied-pmid 29905871?><pub-id pub-id-type="pmid">29905871</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref062">
      <label>62</label>
      <mixed-citation publication-type="journal"><name><surname>Ondov</surname><given-names>BD</given-names></name>, <name><surname>Bergman</surname><given-names>NH</given-names></name>, <name><surname>Phillippy</surname><given-names>AM</given-names></name>. <article-title>Interactive metagenomic visualization in a Web browser</article-title>. <source>BMC Bioinformatics</source>. <year>2011</year>;<volume>12</volume>(<issue>1</issue>):<fpage>385</fpage>.<pub-id pub-id-type="pmid">21961884</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref063">
      <label>63</label>
      <mixed-citation publication-type="journal"><name><surname>Breitwieser</surname><given-names>FP</given-names></name>, <name><surname>Salzberg</surname><given-names>SL</given-names></name>. <article-title>Pavian: interactive analysis of metagenomics data for microbiome studies and pathogen identification</article-title>. <source>Bioinformatics</source>. <year>2019</year>;<volume>36</volume>(<issue>4</issue>):<fpage>1303</fpage>–<lpage>4</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref064">
      <label>64</label>
      <mixed-citation publication-type="journal"><name><surname>Anand</surname><given-names>L</given-names></name>, <name><surname>Lopez</surname><given-names>CMR</given-names></name>. <article-title>ChromoMap: an R package for interactive visualization of multi-omics data and annotation of chromosomes</article-title>. <source>BMC Bioinformatics</source>. <year>2022</year>;<volume>23</volume>(<issue>1</issue>):<fpage>33</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s12859-021-04556-z</pub-id><?supplied-pmid 35016614?><pub-id pub-id-type="pmid">35016614</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref065">
      <label>65</label>
      <mixed-citation publication-type="journal"><name><surname>Goodacre</surname><given-names>N</given-names></name>, <name><surname>Aljanahi</surname><given-names>A</given-names></name>, <name><surname>Nandakumar</surname><given-names>S</given-names></name>, <name><surname>Mikailov</surname><given-names>M</given-names></name>, <name><surname>Khan</surname><given-names>AS</given-names></name>. <article-title>A Reference Viral Database (RVDB) To Enhance Bioinformatics Analysis of High-Throughput Sequencing for Novel Virus Detection.</article-title><source>mSphere</source>. <year>2018</year>;<volume>3</volume>(<issue>2</issue>):<fpage>e00069</fpage>–<lpage>18</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1128/mSphereDirect.00069-18</pub-id><?supplied-pmid 29564396?><pub-id pub-id-type="pmid">29564396</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref066">
      <label>66</label>
      <mixed-citation publication-type="journal"><name><surname>Bigot</surname><given-names>T</given-names></name>, <name><surname>Temmam</surname><given-names>S</given-names></name>, <name><surname>Pérot</surname><given-names>P</given-names></name>, <name><surname>Eloit</surname><given-names>M</given-names></name>. <article-title>RVDB-prot, a reference viral protein database and its HMM profiles.</article-title><source>F1000Res</source>. <year>2019</year>;<volume>8</volume>:<fpage>530</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.12688/f1000research.18776.2</pub-id><?supplied-pmid 32983411?><pub-id pub-id-type="pmid">32983411</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref067">
      <label>67</label>
      <mixed-citation publication-type="journal"><name><surname>Grazziotin</surname><given-names>AL</given-names></name>, <name><surname>Koonin</surname><given-names>EV</given-names></name>, <name><surname>Kristensen</surname><given-names>DM</given-names></name>. <article-title>Prokaryotic Virus Orthologous Groups (pVOGs): a resource for comparative genomics and protein family annotation.</article-title><source>Nucleic Acids Res</source>. <year>2017</year>;<volume>45</volume>(<issue>D1</issue>):<fpage>D491</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkw975</pub-id><?supplied-pmid 27789703?><pub-id pub-id-type="pmid">27789703</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref068">
      <label>68</label>
      <mixed-citation publication-type="journal"><name><surname>Merkel</surname><given-names>D.</given-names></name><article-title>Docker: Lightweight Linux Containers for Consistent Development and Deployment [Internet].</article-title><source>Linux Journal.</source><year>2014</year> [cited 2023 Jul 4]. Available from: <ext-link xlink:href="https://www.linuxjournal.com/content/docker-lightweight-linux-containers-consistent-development-and-deployment" ext-link-type="uri">https://www.linuxjournal.com/content/docker-lightweight-linux-containers-consistent-development-and-deployment</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref069">
      <label>69</label>
      <mixed-citation publication-type="journal"><name><surname>Amstutz</surname><given-names>P</given-names></name>, <name><surname>Crusoe</surname><given-names>MR</given-names></name>, <name><surname>Tijanić</surname><given-names>N</given-names></name>, <name><surname>Chapman</surname><given-names>B</given-names></name>, <name><surname>Chilton</surname><given-names>J</given-names></name>, <name><surname>Heuer</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Common Workflow Language, v1.0 [Internet].</article-title><source>figshare</source>; <year>2016</year>. Available from: <ext-link xlink:href="https://research.manchester.ac.uk/files/57032693/cwl_1.0_workflow.pdf" ext-link-type="uri">https://research.manchester.ac.uk/files/57032693/cwl_1.0_workflow.pdf</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref070">
      <label>70</label>
      <mixed-citation publication-type="journal"><name><surname>Turner</surname><given-names>D</given-names></name>, <name><surname>Shkoporov</surname><given-names>AN</given-names></name>, <name><surname>Lood</surname><given-names>C</given-names></name>, <name><surname>Millard</surname><given-names>AD</given-names></name>, <name><surname>Dutilh</surname><given-names>BE</given-names></name>, <name><surname>Alfenas-Zerbini</surname><given-names>P</given-names></name>, <etal>et al</etal>. <article-title>Abolishment of morphology-based taxa and change to binomial species names: 2022 taxonomy update of the ICTV bacterial viruses subcommittee</article-title>. <source>Arch Virol</source>. <year>2023</year><month>Jan</month><day>23</day>;<volume>168</volume>(<issue>2</issue>):<fpage>74</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s00705-022-05694-2</pub-id><?supplied-pmid 36683075?><pub-id pub-id-type="pmid">36683075</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref071">
      <label>71</label>
      <mixed-citation publication-type="journal"><name><surname>Almeida</surname><given-names>A</given-names></name>, <name><surname>Mitchell</surname><given-names>AL</given-names></name>, <name><surname>Boland</surname><given-names>M</given-names></name>, <name><surname>Forster</surname><given-names>SC</given-names></name>, <name><surname>Gloor</surname><given-names>GB</given-names></name>, <name><surname>Tarkowska</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>A new genomic blueprint of the human gut microbiota</article-title>. <source>Nature</source>. <year>2019</year><month>Apr</month>;<volume>568</volume>(<issue>7753</issue>):<fpage>499</fpage>–<lpage>504</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41586-019-0965-1</pub-id><?supplied-pmid 30745586?><pub-id pub-id-type="pmid">30745586</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref072">
      <label>72</label>
      <mixed-citation publication-type="journal"><name><surname>Shen</surname><given-names>J</given-names></name>, <name><surname>Zhang</surname><given-names>J</given-names></name>, <name><surname>Mo</surname><given-names>L</given-names></name>, <name><surname>Li</surname><given-names>Y</given-names></name>, <name><surname>Li</surname><given-names>Y</given-names></name>, <name><surname>Li</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Large-scale phage cultivation for commensal human gut bacteria</article-title>. <source>Cell Host Microbe</source>. <year>2023</year><month>Apr</month><day>12</day>;<volume>31</volume>(<issue>4</issue>):<fpage>665</fpage>–<lpage>77.e7</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.chom.2023.03.013</pub-id><?supplied-pmid 37054680?><pub-id pub-id-type="pmid">37054680</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref073">
      <label>73</label>
      <mixed-citation publication-type="journal"><name><surname>Zuo</surname><given-names>W</given-names></name>, <name><surname>Michail</surname><given-names>S</given-names></name>, <name><surname>Sun</surname><given-names>F</given-names></name>. <article-title>Metagenomic Analyses of Multiple Gut Datasets Revealed the Association of Phage Signatures in Colorectal Cancer.</article-title><source>Front Cell Infect Microbiol</source>. <year>2022</year><month>Jun</month><day>15</day>;<volume>12</volume>:<fpage>918010</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3389/fcimb.2022.918010</pub-id><?supplied-pmid 35782128?><pub-id pub-id-type="pmid">35782128</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref074">
      <label>74</label>
      <mixed-citation publication-type="journal"><name><surname>Koert</surname><given-names>M</given-names></name>, <name><surname>López-Pérez</surname><given-names>J</given-names></name>, <name><surname>Mattson</surname><given-names>C</given-names></name>, <name><surname>Caruso</surname><given-names>S</given-names></name>, <name><surname>Erill</surname><given-names>I</given-names></name>. <article-title>Evidence for shared ancestry between Actinobacteria and Firmicutes bacteriophages.</article-title><source>Peer Community J.</source><year>2021</year><month>Nov</month><day>24</day>;<volume>1</volume>(<issue>e16</issue>):<fpage>1</fpage> –<lpage>None</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref075">
      <label>75</label>
      <mixed-citation publication-type="journal"><name><surname>Call</surname><given-names>L</given-names></name>, <name><surname>Nayfach</surname><given-names>S</given-names></name>, <name><surname>Kyrpides</surname><given-names>NC</given-names></name>. <article-title>Illuminating the Virosphere Through Global Metagenomics.</article-title><source>Annual Review of Biomedical Data Science</source>. <year>2021</year>;<volume>4</volume>(<issue>1</issue>):<fpage>369</fpage>–<lpage>91</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1146/annurev-biodatasci-012221-095114</pub-id><?supplied-pmid 34465172?><pub-id pub-id-type="pmid">34465172</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref076">
      <label>76</label>
      <mixed-citation publication-type="journal"><name><surname>Pratama</surname><given-names>AA</given-names></name>, <name><surname>van Elsas</surname><given-names>JD</given-names></name>. <article-title>The “Neglected” Soil Virome–Potential Role and Impact.</article-title><source>Trends Microbiol</source>. <year>2018</year>;<volume>26</volume>(<issue>8</issue>):<fpage>649</fpage>–<lpage>62</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.tim.2017.12.004</pub-id><?supplied-pmid 29306554?><pub-id pub-id-type="pmid">29306554</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref077">
      <label>77</label>
      <mixed-citation publication-type="journal"><name><surname>Dion</surname><given-names>MB</given-names></name>, <name><surname>Oechslin</surname><given-names>F</given-names></name>, <name><surname>Moineau</surname><given-names>S</given-names></name>. <article-title>Phage diversity, genomics and phylogeny</article-title>. <source>Nat Rev Microbiol</source>. <year>2020</year>;<fpage>1</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">31740776</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref078">
      <label>78</label>
      <mixed-citation publication-type="journal"><name><surname>Roux</surname><given-names>S</given-names></name>, <name><surname>Hallam</surname><given-names>SJ</given-names></name>, <name><surname>Woyke</surname><given-names>T</given-names></name>, <name><surname>Sullivan</surname><given-names>MB</given-names></name>. <article-title>Viral dark matter and virus–host interactions resolved from publicly available microbial genomes.</article-title><source>Elife</source>. <year>2015</year>;<volume>4</volume>:<fpage>e08490</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.7554/eLife.08490</pub-id><?supplied-pmid 26200428?><pub-id pub-id-type="pmid">26200428</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref079">
      <label>79</label>
      <mixed-citation publication-type="journal"><name><surname>Ho</surname><given-names>SFS</given-names></name>, <name><surname>Wheeler</surname><given-names>NE</given-names></name>, <name><surname>Millard</surname><given-names>AD</given-names></name>, <name><surname>van Schaik</surname><given-names>W</given-names></name>. <article-title>Gauge your phage: benchmarking of bacteriophage identification tools in metagenomic sequencing data.</article-title><source>Microbiome</source>. <year>2023</year><month>Apr</month><day>21</day>;<volume>11</volume>(<issue>1</issue>):<fpage>84</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s40168-023-01533-x</pub-id><?supplied-pmid 37085924?><pub-id pub-id-type="pmid">37085924</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref080">
      <label>80</label>
      <mixed-citation publication-type="journal"><name><surname>Skewes-Cox</surname><given-names>P</given-names></name>, <name><surname>Sharpton</surname><given-names>TJ</given-names></name>, <name><surname>Pollard</surname><given-names>KS</given-names></name>, <name><surname>DeRisi</surname><given-names>JL</given-names></name>. <article-title>Profile hidden Markov models for the detection of viruses within metagenomic sequence data.</article-title><source>PLoS One</source>. <year>2014</year>;<volume>9</volume>(<issue>8</issue>):<fpage>e105067</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0105067</pub-id><?supplied-pmid 25140992?><pub-id pub-id-type="pmid">25140992</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref081">
      <label>81</label>
      <mixed-citation publication-type="journal"><name><surname>Haft</surname><given-names>DH</given-names></name>, <name><surname>Loftus</surname><given-names>BJ</given-names></name>, <name><surname>Richardson</surname><given-names>DL</given-names></name>, <name><surname>Yang</surname><given-names>F</given-names></name>, <name><surname>Eisen</surname><given-names>JA</given-names></name>, <name><surname>Paulsen</surname><given-names>IT</given-names></name>, <etal>et al</etal>. <article-title>TIGRFAMs: a protein family resource for the functional identification of proteins</article-title>. <source>Nucleic Acids Res</source>. <year>2001</year>;<volume>29</volume>(<issue>1</issue>):<fpage>41</fpage>–<lpage>3</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/29.1.41</pub-id><?supplied-pmid 11125044?><pub-id pub-id-type="pmid">11125044</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref082">
      <label>82</label>
      <mixed-citation publication-type="journal"><name><surname>Liang</surname><given-names>G</given-names></name>, <name><surname>Bushman</surname><given-names>FD</given-names></name>. <article-title>The human virome: assembly, composition and host interactions</article-title>. <source>Nat Rev Microbiol</source>. <year>2021</year><month>Aug</month>;<volume>19</volume>(<issue>8</issue>):<fpage>514</fpage>–<lpage>27</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41579-021-00536-5</pub-id><?supplied-pmid 33785903?><pub-id pub-id-type="pmid">33785903</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref083">
      <label>83</label>
      <mixed-citation publication-type="journal"><name><surname>Guo</surname><given-names>J</given-names></name>, <name><surname>Bolduc</surname><given-names>B</given-names></name>, <name><surname>Zayed</surname><given-names>AA</given-names></name>, <name><surname>Varsani</surname><given-names>A</given-names></name>, <name><surname>Dominguez-Huerta</surname><given-names>G</given-names></name>, <name><surname>Delmont</surname><given-names>TO</given-names></name>, <etal>et al</etal>. <article-title>VirSorter2: a multi-classifier, expert-guided approach to detect diverse DNA and RNA viruses</article-title>. <source>Microbiome</source>. <year>2021</year>;<volume>9</volume>(<issue>1</issue>):<fpage>37</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s40168-020-00990-y</pub-id><?supplied-pmid 33522966?><pub-id pub-id-type="pmid">33522966</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref084">
      <label>84</label>
      <mixed-citation publication-type="journal"><name><surname>Pinto</surname><given-names>Y</given-names></name>, <name><surname>Chakraborty</surname><given-names>M</given-names></name>, <name><surname>Jain</surname><given-names>N</given-names></name>, <name><surname>Bhatt</surname><given-names>AS</given-names></name>. <article-title>Phage-inclusive profiling of human gut microbiomes with Phanta</article-title>. <source>Nat Biotechnol [Internet].</source><year>2023</year><month>May</month><day>25</day>; Available from: <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41587-023-01799-4</pub-id><?supplied-pmid 37231259?><pub-id pub-id-type="pmid">37231259</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref085">
      <label>85</label>
      <mixed-citation publication-type="journal"><name><surname>Rose</surname><given-names>R</given-names></name>, <name><surname>Constantinides</surname><given-names>B</given-names></name>, <name><surname>Tapinos</surname><given-names>A</given-names></name>, <name><surname>Robertson</surname><given-names>DL</given-names></name>, <name><surname>Prosperi</surname><given-names>M</given-names></name>. <article-title>Challenges in the analysis of viral metagenomes.</article-title><source>Virus Evol.</source><year>2016</year><month>Jul</month>;<volume>2</volume>(<issue>2</issue>):<fpage>vew022</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/ve/vew022</pub-id><?supplied-pmid 29492275?><pub-id pub-id-type="pmid">29492275</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref086">
      <label>86</label>
      <mixed-citation publication-type="journal"><name><surname>Bharti</surname><given-names>R</given-names></name>, <name><surname>Grimm</surname><given-names>DG</given-names></name>. <article-title>Current challenges and best-practice protocols for microbiome analysis</article-title>. <source>Brief Bioinform</source>. <year>2021</year><month>Jan</month><day>18</day>;<volume>22</volume>(<issue>1</issue>):<fpage>178</fpage>–<lpage>93</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bib/bbz155</pub-id><?supplied-pmid 31848574?><pub-id pub-id-type="pmid">31848574</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref087">
      <label>87</label>
      <mixed-citation publication-type="journal"><name><surname>Hufsky</surname><given-names>F</given-names></name>, <name><surname>Lamkiewicz</surname><given-names>K</given-names></name>, <name><surname>Almeida</surname><given-names>A</given-names></name>, <name><surname>Aouacheria</surname><given-names>A</given-names></name>, <name><surname>Arighi</surname><given-names>C</given-names></name>, <name><surname>Bateman</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Computational strategies to combat COVID-19: useful tools to accelerate SARS-CoV-2 and coronavirus research</article-title>. <source>Brief Bioinform</source>. <year>2020</year>;<volume>bbaa232</volume>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="aggregated-review-documents" id="pcbi.1011422.r001" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011422.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ouzounis</surname>
          <given-names>Christos A.</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Leitner</surname>
          <given-names>Thomas</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2023 Ouzounis, Leitner</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Ouzounis, Leitner</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1011422" id="rel-obj001" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">10 Jan 2023</named-content>
    </p>
    <p>Dear Dr Rangel-Piñeros,</p>
    <p>Thank you very much for submitting your manuscript "VIRify: an integrated detection, annotation and taxonomic classification pipeline using virus-specific protein profile hidden Markov models" for consideration at PLOS Computational Biology.</p>
    <p>As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. In light of the reviews (below this email), we would like to invite the resubmission of a significantly-revised version that takes into account the reviewers' comments, esp those by Reviewer 3.</p>
    <p>We cannot make any decision about publication until we have seen the revised manuscript and your response to the reviewers' comments. Your revised manuscript is also likely to be sent to reviewers for further evaluation.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Please prepare and submit your revised manuscript within 60 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. Please note that revised manuscripts received after the 60-day due date may require evaluation and peer review similar to newly submitted manuscripts.</p>
    <p>Thank you again for your submission. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Christos A. Ouzounis</p>
    <p>Academic Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Thomas Leitner</p>
    <p>Section Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Lucy Houghton</p>
    <p>Staff</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: The authors have addressed a large issue within the field, although issues remain with annotation, VIRify clearly competes well with other tools in the field.</p>
    <p>The fact that the authors have used two mock communities is great, although I do find the fact that comintamination within them is noted as a potential issue, troubling. Clearly better mocks are required in future studies, but I believe that to beyond the scope of this paper.</p>
    <p>Major issues;</p>
    <p>- The basis for the HMMs is the viral genomes from 2015, this is 7 years ago, meaning alot of diversity is missing. Is this something that can be easily updated? If not, this poses a major limitation which the authors should address in the text of the paper.</p>
    <p>- I see no justification for the 10% ViPhOG annotation cutoff or that atleast 2 hits are reported at a set level with 60% consistency. Please benchmark these factors to define why these thresholds are suitable.</p>
    <p>Reviewer #2: Rangel-Pineros et al are describing a pipeline "VIRify" that can detect viral contigs in a metagenomic assembly and perform taxonomy annotations using protein-similarity. The pipeline takes a pre-assembled set of contigs as an input and classifies them using a combination of several viral-detection software tools. Contigs classified as viral are further subjected to the taxonomy characterization: protein-coding ORFs are predicted for each contig and these ORFs are matched against a set of protein domain models (informative ViPhOGs) representative for different viral genera, families or orders. Authors validate their choice of software packages for each step of the pipeline and then benchmark it against 2 metagenomic datasets with experimentally known combinations of viruses/phages. Selection of protein-domain models ( informative ViPhOGs) is briefly described in the manuscript but has been previously published elsewhere.</p>
    <p>From the software perspective, "VIRify" adheres to the best practices: the pipeline is implemented using 2(!) Workflow management systems (nextflow and CWL), software packages VIRIfy relies on are containerized using docker/singularity for portability, documentations is thorough and contributors appear active on the github page of the repository.</p>
    <p>The manuscript itself is well written and easy to follow for the most part, although it could be shortened somewhat by skipping redundant descriptions and unnecessary details in the introduction (see below).</p>
    <p>I do have several comments that could help improve the manuscript:</p>
    <p>Major:</p>
    <p>1. Elaborate more on the significance of the “TARA Oceans'' analysis - right now it is unclear if ViRIfy provides novel insight into those datasets or if ViRIfy is valuable as a convenient tool/utility here ? Can “Massive expansion of human gut bacteriophage diversity” paper by some of the co-authors be used to strengthen the utility of VIRify’s approach ?</p>
    <p>2. Reading the “Selection and comparison of virus prediction tools” section in Methods 239-286, the choice of 3 viral detection software seems somewhat arbitrary - i.e. according to SFig2 PPR-Meta outperformed most of the other tools - why not use it alone ? Figure 3 helps answer that a bit, but then maybe there is another way to justify the choice of VirSorter, VirFinder, PPR-Meta ?</p>
    <p>Minor:</p>
    <p>1. Shortening of the manuscript would improve readability, here are several examples:</p>
    <p>a. 84-90 lytics vs lysogenic life cycles of phages - interesting - but in my opinion distracting</p>
    <p>b. Shorten ViPhOG related description that were covered in the previous publication - e.g. in the first section of “Results”</p>
    <p>2.Provide references to supplementary figures in “Selection and comparison of virus prediction tools” section</p>
    <p>3.It would be nice to include a paragraph on ViRify’s runtime expectations - i.e. how long it would run on a “typical” dataset, what hardware is recommended</p>
    <p>4.Several of the tools that VIRify depends on are deep learning based - do they require GPUs or CPU is sufficient? Do you take it into account for containerization ?</p>
    <p>5. Could you discuss an alternative approach of taxonomy classification based on “complete” viral genomes (e.g. as in “Phanta: Phage-inclusive profiling of human gut metagenomes” preprint by Pinto et al) - what are some advantages/limitations relative to protein-similarity based approach ?</p>
    <p>Reviewer #3: The manuscript by Rangel-Pineros and colleagues describes the creation of a new pipeline for virome analyses called VIRify. This pipeline is avalaible from GitHub as a Nextflow pipeline or CWL implementation. In brief, the pipeline uses either reads or assemblies, predicts which contigs are viral and provides a taxonomic classification using virus-specific protein profile HMMs derived from a separate study. The pipeline was tested on two virome mock communities and a TARA Oceans metagenomics study. The development included an analysis of the appropriateness of several different virus prediction tools using the “What the Phage” workflow (Marquet et al, 2022).</p>
    <p>VIRify has a great strength that makes it stand out from other pipelines, the use of the ViPhOGs, a well-curated set of 22,013 orthologous protein domains that are informative for virus taxonomy. Using this approach, viral contigs can be rapidly classified against the taxonomy associated with the ViPhOGs, regardless of the type of virus (eukaryotic, bacterial, archaeal) or genome type (DNA/RNA), as long as there are representative ViPhOGs in the database.</p>
    <p>This leads me into my main comment on the manuscript and pipeline, the taxonomy itself is outdated and wrong. On lines 209-2216, the authors write that the Virus-Host DB was used in November 2019 and the NCBI Taxonomy in March 2020. By the time this paper is published, the taxonomy will be at least four years out of date. The NCBI Taxonomy in March 2020 still used the taxonomy release issued by the International Committee on Taxonomy of Viruses in 2019, Master Species List MSL#34 (<ext-link xlink:href="https://ictv.global/taxonomy/history" ext-link-type="uri">https://ictv.global/taxonomy/history</ext-link>) which contains 14 orders, 150 families, 79 subfamilies, 1019 genera and 5560 species. In contrast, the current taxonomy release (MSL#37) comprises additional higher order taxa: 6 realms, 10 kingdoms, 17 phyla, 39 classes, 65 orders, 233 families, 2606 genera and 10434 species (Walker et al, 2022, table 1, <ext-link xlink:href="https://link.springer.com/article/10.1007/s00705-022-05516-5/tables/1" ext-link-type="uri">https://link.springer.com/article/10.1007/s00705-022-05516-5/tables/1</ext-link>). Importantly, this taxonomy release saw the removal of the bacteriophage families Myoviridae, Podoviridae and Siphoviridae which were not monophyletic, and the removal of the order Caudovirales in favour of the class Caudoviricetes, the taxa most commonly recovered from metagenome studies (see Fig 3 and 5 for example). In addition, many new families of archaeal viruses have been established since 2019, and entirely new phyla have been defined with viruses that had never before been classified.</p>
    <p>Since virus taxonomy is dynamic when new sets of viruses are discovered, any pipeline that claims to provide a taxonomic classification of viruses needs to be able to incorporate yearly updates to its taxonomy, or make clear disclaimers that the taxonomic classification is not up-to-date. In the case of VIRify, I presume updating the taxonomy could be achieved in a relatively straightforward way by remapping the ViPhOG database to the latest taxonomy database.</p>
    <p>A second concern related to the taxonomic assignments, is that this pipeline does not seem to have been tested or validated using existing complete virus genomes, only using mock community assemblies which could have many incomplete genome fragments (lines 360-363). In my opinion, it is important to understand how accurate the taxonomic predictions are in the most ideal situation, in order to understand the limitations of the pipeline.</p>
    <p>As part of this review, I have installed and run the pipeline on some test data and will be providing observations and some recommendations.</p>
    <p>Installation: I used an ubuntu virtual machine and used the nextflow install as was suggested on the GitHub page. Installation was seamless and quick. I tried a similar installation locally on a Mac using the terminal and ran into versioning issues with nextflow and the virify pipeline and abandoned this route.</p>
    <p>Running pipeline: I used a mock dataset of 5 complete bacteriophage genomes which were all similar to well-characterised phages but not necessarily identical. The pipeline ran very quickly and easily. I ran a second set of ~5000 contigs from a virome which finished overnight. No issues.</p>
    <p>Results of pipeline:</p>
    <p>Small dataset:</p>
    <p>Four out of the five bacteriophages, including the reference RNA phage MS2 were categorised as low confidence predictions in the first step of the pipeline. For me, this calls into question the thresholds that were used to categorise high confidence versus low confidence. Could the authors benchmark the virus detection categorisation with a set of known viruses from GenBank to see if the distinction between high-confidence and low-confidence needs to be made and what the best thresholds should be?</p>
    <p>Taken into account the outdated taxonomy database used, the taxonomic assignments of the phages were correct at the genus level for only 2 out of 5 phages. MS2 was correctly classified at the family level but no genus level classification. One phage was correctly assigned at the order level and one was unclassified. No incorrect assignments were made. However, low sensitivity at the genus and family level means that there is some optimisation required for the “voting system” or potentially an update to the ViPhOG database itself to include a more up-to-date set. For the smaller viruses, a threshold for at least two hits at the genus level (lines 352-353) may be too stringent. For example, most members of the phylum Cressdnaviricota only encode two proteins.</p>
    <p>Larger dataset:</p>
    <p>Of the ~5000 contigs that I considered potentially viral based on an internal dataset using VirSorter2 and VIBRANT, 921 were considered viral using VIRify. The decision to minimise false positives therefore may have a consequences for an increased amount of false negatives. I consider this a feature, rather than a bug, because it’s a decision that needs to be made in viromics research. However, I do suggest that the authors be clear about this in the manuscript and pipeline.</p>
    <p>The taxonomic assignments that were made were largely unclassified viruses (780) and the rest of them were assigned to the order Caudovirales. The family, subfamily and genus assignments appeared to be correct.</p>
    <p>Overall, I found the pipeline easy to work with and its outputs easy to understand and use. My assessment is that it favours specificity over sensitivity in both the virus detection and taxonomic assignments.</p>
    <p>In terms of the manuscript, my final comment is that the literature/introduction and discussion should be updated to account for pipelines and new tools that have been developed. The authors have already indicated that they may update the tool VirSorter to VirSorter2, but there is also an update of VirFinder to DeepVirFinder and new tools such as VIBRANT that have been developed since the authors started working on VIRify. Similarly, other pipelines have been published, for example MetaPhage and Hecatomb, and potentially others. I do not expect these to be benchmarked but they should at least be acknowledged in the introduction or discussion.</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>Reviewer #3: No</p>
    <p>
      <underline>Figure Files:</underline>
    </p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <underline><ext-link xlink:href="https://pacev2.apexcovantage.com/" ext-link-type="uri">https://pacev2.apexcovantage.com</ext-link></underline>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <underline><email>figures@plos.org</email></underline>.</p>
    <p>
      <underline>Data Requirements:</underline>
    </p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5" ext-link-type="uri">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>
      <underline>Reproducibility:</underline>
    </p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pcbi.1011422.r002">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011422.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1011422" id="rel-obj002" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">11 Jul 2023</named-content>
    </p>
    <supplementary-material id="pcbi.1011422.s005" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Response_to_reviewers.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1011422.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="aggregated-review-documents" id="pcbi.1011422.r003" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011422.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ouzounis</surname>
          <given-names>Christos A.</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Leitner</surname>
          <given-names>Thomas</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2023 Ouzounis, Leitner</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Ouzounis, Leitner</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1011422" id="rel-obj003" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">9 Aug 2023</named-content>
    </p>
    <p>Dear Dr Rangel-Piñeros,</p>
    <p>We are pleased to inform you that your manuscript 'VIRify: an integrated detection, annotation and taxonomic classification pipeline using virus-specific protein profile hidden Markov models' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Christos A. Ouzounis</p>
    <p>Academic Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Thomas Leitner </p>
    <p>Section Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #2: Authors have adequately addressed all of the questions that I've raised.</p>
    <p>I do recommend, however, reading-through newly added sections to improve readability/grammar. Here are a couple of examples of sentences that "sound off" :</p>
    <p>lines 886-888 - VIRify is a ... resource that joins a group of tools ... and **that** can be broadly classified as protein similarity-based methods -&gt; maybe change to ... and are broadly classified as ...</p>
    <p>Line 897, the advantage of using protein profile HMMs is that they allow **the gathering** of viral reference data in a more efficient and compact way - "gathering of viral references" - does it simply mean that viral reference data for protein profile HMMs can be stored in a more compact way ?</p>
    <p>Reviewer #3: No further comments.</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #2: No</p>
    <p>Reviewer #3: No</p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pcbi.1011422.r004" specific-use="acceptance-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011422.r004</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ouzounis</surname>
          <given-names>Christos A.</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Leitner</surname>
          <given-names>Thomas</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2023 Ouzounis, Leitner</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Ouzounis, Leitner</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1011422" id="rel-obj004" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">24 Aug 2023</named-content>
    </p>
    <p>PCOMPBIOL-D-22-01555R1 </p>
    <p>VIRify: an integrated detection, annotation and taxonomic classification pipeline using virus-specific protein profile hidden Markov models</p>
    <p>Dear Dr Rangel-Piñeros,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Zsofi Zombor</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link xlink:href="http://ploscompbiol.org" ext-link-type="uri">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle pcbi.1011422.r001?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10491390</article-id>
    <article-id pub-id-type="pmid">37639475</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011422</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-22-01555</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
          <subj-group>
            <subject>Microbial Taxonomy</subject>
            <subj-group>
              <subject>Viral Taxonomy</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
            <subj-group>
              <subject>Microbial Taxonomy</subject>
              <subj-group>
                <subject>Viral Taxonomy</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Virology</subject>
            <subj-group>
              <subject>Viral Taxonomy</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Viruses</subject>
            <subj-group>
              <subject>Bacteriophages</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Metagenomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Microbial Genomics</subject>
              <subj-group>
                <subject>Viral Genomics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Microbial Genomics</subject>
            <subj-group>
              <subject>Viral Genomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Virology</subject>
            <subj-group>
              <subject>Viral Genomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Eukaryota</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Probability theory</subject>
            <subj-group>
              <subject>Markov models</subject>
              <subj-group>
                <subject>Hidden Markov models</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Genome Annotation</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
              <subj-group>
                <subject>Genome Annotation</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>VIRify: An integrated detection, annotation and taxonomic classification pipeline using virus-specific protein profile hidden Markov models</article-title>
      <alt-title alt-title-type="running-head">VIRify, a viral sequence analysis pipeline using virus-specific protein profile HMMs</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3848-4330</contrib-id>
        <name>
          <surname>Rangel-Pineros</surname>
          <given-names>Guillermo</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Almeida</surname>
          <given-names>Alexandre</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
        <xref rid="aff005" ref-type="aff">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3472-3736</contrib-id>
        <name>
          <surname>Beracochea</surname>
          <given-names>Martin</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sakharova</surname>
          <given-names>Ekaterina</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Marz</surname>
          <given-names>Manja</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff006" ref-type="aff">
          <sup>6</sup>
        </xref>
        <xref rid="aff007" ref-type="aff">
          <sup>7</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2907-3265</contrib-id>
        <name>
          <surname>Reyes Muñoz</surname>
          <given-names>Alejandro</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7090-8717</contrib-id>
        <name>
          <surname>Hölzer</surname>
          <given-names>Martin</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="aff007" ref-type="aff">
          <sup>7</sup>
        </xref>
        <xref rid="aff008" ref-type="aff">
          <sup>8</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8626-2148</contrib-id>
        <name>
          <surname>Finn</surname>
          <given-names>Robert D.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>The Globe Institute, Faculty of Health and Medical Sciences, University of Copenhagen, Copenhagen, Denmark</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Max Planck Tandem Group in Computational Biology, Department of Biological Sciences, Universidad de los Andes, Bogota, Colombia</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>European Molecular Biology Laboratory, European Bioinformatics Institute (EMBL-EBI), Wellcome Genome Campus, Hinxton, United Kingdom</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Wellcome Sanger Institute, Wellcome Genome Campus, Hinxton, United Kingdom</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Department of Veterinary Medicine, University of Cambridge, Cambridge, United Kingdom</addr-line>
    </aff>
    <aff id="aff006">
      <label>6</label>
      <addr-line>RNA Bioinformatics, Friedrich Schiller University, Jena, Germany</addr-line>
    </aff>
    <aff id="aff007">
      <label>7</label>
      <addr-line>European Virus Bioinformatics Center, Friedrich Schiller University, Jena, Germany</addr-line>
    </aff>
    <aff id="aff008">
      <label>8</label>
      <addr-line>Methodology and Research Infrastructure, Genome Competence Center (MF1), Robert Koch Institute, Berlin, Germany</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Ouzounis</surname>
          <given-names>Christos A.</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>CPERI, GREECE</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>guillermo.pineros@sund.ku.dk</email> (GRP); <email>rdf@ebi.ac.uk</email> (RDF)</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <volume>19</volume>
    <issue>8</issue>
    <elocation-id>e1011422</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>9</day>
        <month>8</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2023 Rangel-Pineros et al</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Rangel-Pineros et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1011422.pdf"/>
    <abstract>
      <p>The study of viral communities has revealed the enormous diversity and impact these biological entities have on various ecosystems. These observations have sparked widespread interest in developing computational strategies that support the comprehensive characterisation of viral communities based on sequencing data. Here we introduce VIRify, a new computational pipeline designed to provide a user-friendly and accurate functional and taxonomic characterisation of viral communities. VIRify identifies viral contigs and prophages from metagenomic assemblies and annotates them using a collection of viral profile hidden Markov models (HMMs). These include our manually-curated profile HMMs, which serve as specific taxonomic markers for a wide range of prokaryotic and eukaryotic viral taxa and are thus used to reliably classify viral contigs. We tested VIRify on assemblies from two microbial mock communities, a large metagenomics study, and a collection of publicly available viral genomic sequences from the human gut. The results showed that VIRify could identify sequences from both prokaryotic and eukaryotic viruses, and provided taxonomic classifications from the genus to the family rank with an average accuracy of 86.6%. In addition, VIRify allowed the detection and taxonomic classification of a range of prokaryotic and eukaryotic viruses present in 243 marine metagenomic assemblies. Finally, the use of VIRify led to a large expansion in the number of taxonomically classified human gut viral sequences and the improvement of outdated and shallow taxonomic classifications. Overall, we demonstrate that VIRify is a novel and powerful resource that offers an enhanced capability to detect a broad range of viral contigs and taxonomically classify them.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Viruses are the most abundant biological entities on our planet. Some are relevant pathogens for public health or agriculture. Still, many also play ecological roles that are critical for maintaining ecosystems. Most viruses are yet to be cultured, so their identification and characterisation depend solely on the analysis of DNA or RNA obtained from the environment. Unlike cellular organisms, viruses also lack a universal genetic marker that allows taxonomic profiling of an environmental viral community. We have manually curated a set of specific viral protein models that serve as taxonomic markers for a comprehensive range of viral taxa. Using these protein models, we developed VIRify, a computational pipeline for the detection, annotation, and taxonomic classification of viral sequences obtained from environmental DNA or RNA. Our new pipeline was efficient in detecting and classifying sequences of viruses targeting bacteria or eukaryotic organisms in mock microbial communities, samples from the world’s oceans, and a previously assembled collection of human gut viruses. VIRify is user-friendly, requires minimal interaction with the command line, and was developed with portability in mind. VIRify can enhance the exploration of viral diversity in nature and support the detection of pathogenic viruses with pandemic potential.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000268</institution-id>
            <institution>Biotechnology and Biological Sciences Research Council</institution>
          </institution-wrap>
        </funding-source>
        <award-id>BB/P027849/1</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7090-8717</contrib-id>
          <name>
            <surname>Hölzer</surname>
            <given-names>Martin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution>Deutsche Forschungsgemeinschaft</institution>
        </funding-source>
        <award-id>CRC 1076 AquaDiva</award-id>
      </award-group>
      <funding-statement>This work was supported by the Deutsche Forschungsgemeinschaft (CRC 1076 AquaDiva to MH), and the Biotechnology and Biological Sciences Research Council (BB/P027849/1 CABANA project for capacity building for bioinformatics in Latin America to GRP). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="7"/>
      <table-count count="1"/>
      <page-count count="28"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2023-09-08</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The metagenomic assemblies generated for the selected mock communities and the set of informative ViPhOGs are available on OSF at <ext-link xlink:href="https://doi.org/10.17605/OSF.IO/FBRXY" ext-link-type="uri">https://doi.org/10.17605/OSF.IO/FBRXY</ext-link>. All the scripts used for the manual curation of the ViPhOGs and the Nextflow implementation of VIRify are available at <ext-link xlink:href="https://github.com/EBI-Metagenomics/emg-viral-pipeline" ext-link-type="uri">https://github.com/EBI-Metagenomics/emg-viral-pipeline</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The metagenomic assemblies generated for the selected mock communities and the set of informative ViPhOGs are available on OSF at <ext-link xlink:href="https://doi.org/10.17605/OSF.IO/FBRXY" ext-link-type="uri">https://doi.org/10.17605/OSF.IO/FBRXY</ext-link>. All the scripts used for the manual curation of the ViPhOGs and the Nextflow implementation of VIRify are available at <ext-link xlink:href="https://github.com/EBI-Metagenomics/emg-viral-pipeline" ext-link-type="uri">https://github.com/EBI-Metagenomics/emg-viral-pipeline</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Viruses are the most abundant biological entities inhabiting our planet, with an estimated 10<sup>30</sup> virus-like particles (VLP) present in the world’s oceans [<xref rid="pcbi.1011422.ref001" ref-type="bibr">1</xref>]. Even though viruses are often acknowledged as disease-causing agents in animals and plants, many studies to date have demonstrated the pivotal role that viruses play in shaping microbial populations, particularly in the case of phages and their bacterial hosts [<xref rid="pcbi.1011422.ref002" ref-type="bibr">2</xref>–<xref rid="pcbi.1011422.ref005" ref-type="bibr">5</xref>]. The application of metagenomics-based approaches in these studies facilitated the culture-independent exploration of microbial communities, resulting in the expansion of the span of viral-host interactions that could be characterised. This approach has revealed a vast extent of uncharacterised viral genetic diversity known as "viral dark matter" [<xref rid="pcbi.1011422.ref006" ref-type="bibr">6</xref>–<xref rid="pcbi.1011422.ref011" ref-type="bibr">11</xref>] and led to the discovery of numerous uncultivated virus genomes (UViGs) [<xref rid="pcbi.1011422.ref012" ref-type="bibr">12</xref>–<xref rid="pcbi.1011422.ref015" ref-type="bibr">15</xref>]. Studies, especially in oceanic environments, have demonstrated the importance of viruses in biogeochemical cycling and metabolic modulation of ocean microbes [<xref rid="pcbi.1011422.ref012" ref-type="bibr">12</xref>,<xref rid="pcbi.1011422.ref016" ref-type="bibr">16</xref>,<xref rid="pcbi.1011422.ref017" ref-type="bibr">17</xref>].</p>
    <p>A review paper of the TARA Oceans project highlighted the urgent need for automated approaches to systematically organise the enormous virus sequencing data beyond the species level [<xref rid="pcbi.1011422.ref018" ref-type="bibr">18</xref>]. Several computational tools and resources that offer a solution to this challenge have been developed and made publicly available in the last two decades [<xref rid="pcbi.1011422.ref019" ref-type="bibr">19</xref>–<xref rid="pcbi.1011422.ref021" ref-type="bibr">21</xref>]. One of the most prominent and currently available tools is VConTACT2, which employs data on proteins shared between phage genomes to build a similarity network that is further analysed to identify clusters of evolutionarily related phages [<xref rid="pcbi.1011422.ref022" ref-type="bibr">22</xref>]. An alternative approach to the taxonomic classification of viruses involves protein profile HMMs representing clusters of homologous proteins or protein domains, which in turn serve as markers for different viral taxa, a strategy used for example by ClassiPhage [<xref rid="pcbi.1011422.ref023" ref-type="bibr">23</xref>]. Phage classification with ClassiPhage demonstrated agreement with the reference taxonomy from the International Committee on Taxonomy of Viruses (ICTV), although the generation and testing of the taxon-specific profile HMMs was solely focused on phages targeting members of the bacterial family <italic toggle="yes">Vibrionaceae</italic> [<xref rid="pcbi.1011422.ref023" ref-type="bibr">23</xref>]. More recently, a set of 31,150 profile HMMs representing proteins predicted in viral genomes from NCBI were used as the basis for a set of Random Forest classifiers aimed at assigning viral taxonomy at the order, family, and genus ranks [<xref rid="pcbi.1011422.ref024" ref-type="bibr">24</xref>]. These classifiers demonstrated very high classification accuracy (≥ 89%) at all the aforementioned ranks, suggesting that these profile HMMs (or ViPhOGs as they were named) could be the foundation for a new method that taxonomically classifies viral genomic sequences present in metagenomic datasets.</p>
    <p>Existing pipelines such as VirMiner, iVirus and KBase enable taxonomic and functional characterisation of viral contigs in metagenomic datasets [<xref rid="pcbi.1011422.ref025" ref-type="bibr">25</xref>–<xref rid="pcbi.1011422.ref027" ref-type="bibr">27</xref>]. More recently, Hecatomb and MetaPhage were released to provide the scientific community with scalable and portable resources for the taxonomic profiling of viral communities, using metagenomic reads as input [<xref rid="pcbi.1011422.ref028" ref-type="bibr">28</xref>,<xref rid="pcbi.1011422.ref029" ref-type="bibr">29</xref>]. Here we present VIRify, a new pipeline that predicts virus-like sequences using canonical viral signals and annotates contigs using a comprehensive collection of profile HMMs, including our set of manually curated ViPhOGs. VIRify reduces false-positive predictions and prioritises portability via its implementation as a containerised Nextflow workflow [<xref rid="pcbi.1011422.ref030" ref-type="bibr">30</xref>], which can be directly integrated into already existing platforms such as MGnify [<xref rid="pcbi.1011422.ref031" ref-type="bibr">31</xref>]. The VIRify pipeline is freely available at <ext-link xlink:href="https://github.com/EBI-Metagenomics/emg-viral-pipeline" ext-link-type="uri">https://github.com/EBI-Metagenomics/emg-viral-pipeline</ext-link>. We showcase the application of VIRify based on two viral mock communities mostly comprised of phages [<xref rid="pcbi.1011422.ref032" ref-type="bibr">32</xref>] but also eukaryotic viruses [<xref rid="pcbi.1011422.ref033" ref-type="bibr">33</xref>], as well as 243 metagenome assemblies of the TARA Oceans project [<xref rid="pcbi.1011422.ref012" ref-type="bibr">12</xref>], and a previously generated collection of 57,866 viral genomic clusters (VCs) from globally-distributed human gut metagenomic datasets [<xref rid="pcbi.1011422.ref034" ref-type="bibr">34</xref>].</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Methods</title>
    <sec id="sec003">
      <title>Manual curation of virus-specific protein HMMs and definition of model-specific bit score thresholds</title>
      <p>We manually curated a set of taxon-specific profile HMMs by searching the original ViPhOG database [<xref rid="pcbi.1011422.ref024" ref-type="bibr">24</xref>] against all entries in UniProtKB (February 2019 version). This was achieved using hmmsearch (v3.2.1) and setting a per-sequence reporting e-value threshold of 1.0x10<sup>-3</sup>. The resulting output was analysed using in-house python scripts (<ext-link xlink:href="https://github.com/EBI-Metagenomics/emg-viral-pipeline/tree/master/bin/models_vs_uniprot_check" ext-link-type="uri">https://github.com/EBI-Metagenomics/emg-viral-pipeline/tree/master/bin/models_vs_uniprot_check</ext-link>) to identify which ViPhOGs could be used as taxon-specific markers, hereafter referred to as informative ViPhOGs. These were identified after applying the following steps to the hmmsearch output of each ViPhOG:</p>
      <list list-type="order">
        <list-item>
          <p>Reported taxonomy identifiers (taxid) were recorded, along with the highest bit score obtained for each one of them and their associated taxa at the genus, subfamily, family and order ranks.</p>
        </list-item>
        <list-item>
          <p>For each one of the target taxa recorded in the previous step, the corresponding highest bit scores were sorted and a bit score range was defined using the lowest and highest of these values.</p>
        </list-item>
        <list-item>
          <p>Starting with the target taxa at the genus rank, it was determined whether the query ViPhOG was associated with a single taxon or the bit score range for the best taxon did not overlap with the range obtained for the remaining taxa. If either of these conditions was fulfilled, then the query ViPhOG was selected as informative at the genus rank. Otherwise, the procedure was repeated at the subfamily, family and order ranks, until the query ViPhOG could be selected as informative for any of them. If the query ViPhOG was not assigned to any taxon at the searched ranks, it was considered non-informative.</p>
        </list-item>
      </list>
      <p>To leverage the data obtained from the analysis described above and set inclusion bit score thresholds suitable for each model, we defined two bit score thresholds (S1 and S2) for each informative ViPhOG. S1 was defined as the minimum bit score associated with the ViPhOG’s target taxon, whereas S2 was set as the maximum bit score obtained for other viral taxa identified through the previously described procedure. For the cases in which no further taxa were reported at the same rank as the target taxon, only S1 was set for the corresponding informative ViPhOG. Next, we define GA (gathering), TC (trusted cutoff), and NC (noise cutoff) parameters of each informative ViPhOG model. GA thresholds define reliable, curated thresholds for family memberships, NC thresholds describe the highest-scoring known false positive, and TC thresholds refer to the score of the lowest-scoring known true positive that is above all known false positives, which reflects a similar strategy to Pfam [<xref rid="pcbi.1011422.ref035" ref-type="bibr">35</xref>]. In addition, each parameter (GA, TC, NC) defines two thresholds for reporting and inclusion scores: the per-sequence threshold (GA<sub>seq</sub>, TC<sub>seq</sub>, NC<sub>seq</sub>) and the per-domain threshold (GA<sub>dom</sub>, TC<sub>dom</sub>, NC<sub>dom</sub>). We used our previously defined bit score thresholds S1 and S2 to set these six parameters specifically for each informative ViPhOG model as follows:
<disp-formula id="pcbi.1011422.e001"><alternatives><graphic xlink:href="pcbi.1011422.e001.jpg" id="pcbi.1011422.e001g" position="anchor"/><mml:math id="M1" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>G</mml:mi><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1011422.e002"><alternatives><graphic xlink:href="pcbi.1011422.e002.jpg" id="pcbi.1011422.e002g" position="anchor"/><mml:math id="M2" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>G</mml:mi><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mspace width="0.25em"/><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.25em"/><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mo>)</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>S</mml:mi><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.25em"/><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1011422.e003"><alternatives><graphic xlink:href="pcbi.1011422.e003.jpg" id="pcbi.1011422.e003g" position="anchor"/><mml:math id="M3" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>N</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:math></alternatives></disp-formula>
S1 was added as TC and GA per-sequence threshold, and trimmed by three bit to apply a per-domain threshold. Trimming was only applied if S1 did not drop below S2. The S2 bit score was unmodified and used as both per-sequence and per-domain NC. For the cases in which no S2 bit score was recorded, the noise cutoff was omitted and the sequence-specific S1 value was trimmed by three bits to allow less restrictive predictions. Finally, the values set for the GA, TC, and NC parameters were added to the header section of each informative ViPhOG’s HMM file.</p>
    </sec>
    <sec id="sec004">
      <title>Coverage of current viral taxonomy and calculation of taxon-specific ViPhOG-to-CDS ratios</title>
      <p>The set of informative ViPhOGs was screened to keep the ones that were associated with valid taxa in the latest release of ICTV’s viral taxonomy MSL#38. These were subsequently employed to determine the extent to which the lineages comprising the current viral taxonomy are covered by our set of informative ViPhOGs. A cladogram that included all viral genera and corresponding ancestral taxa in NCBI’s Taxonomy database from January 2023 was built using the ete3 python package [<xref rid="pcbi.1011422.ref036" ref-type="bibr">36</xref>,<xref rid="pcbi.1011422.ref037" ref-type="bibr">37</xref>]. The number of informative ViPhOGs identified for each viral genus was mapped on the cladogram using the interactive Tree of Life (iTOL) resource and the associated annotation file for plotting numeric data as bars [<xref rid="pcbi.1011422.ref038" ref-type="bibr">38</xref>]. In addition, taxa in the subfamily, family and order ranks for which at least one informative ViPhOG had been identified were highlighted using iTOL’s annotation file for labelling nodes with symbols (<bold><xref rid="pcbi.1011422.s001" ref-type="supplementary-material">S1 Fig</xref></bold>).</p>
      <p>Viral taxa linked to the informative ViPhOGs were categorized as prokaryotic or eukaryotic based on their target host. Currently known viral-host relationships were retrieved from Virus-Host DB (release 214 from November 2022), which contained 12,032 viral entries targeting eukaryotes and 5,491 viral entries targeting either bacteria or archaea [<xref rid="pcbi.1011422.ref039" ref-type="bibr">39</xref>].</p>
      <p>For each taxon associated with any of the informative ViPhOGs or that is part of the viral lineages covered by them, we determined the ratio between the number of associated informative ViPhOGs and the average number of CDS. To calculate this ratio, the number of informative ViPhOGs for taxa in the subfamily, family and order ranks included the models linked to the corresponding descendant taxa, in addition to those directly linked to them. To determine the average number of CDS per taxon, we identified all viral assemblies from NCBI’s Assembly database that had been deposited until November 2022 and whose CDS had been annotated. We retrieved the corresponding assembly report files and used them to extract the taxids and number of CDS per assembly. The taxids were employed to retrieve the taxa at the genus, subfamily, family and order ranks included in the lineage of each assembly, using the ete3 python package. For each one of these taxa, the average number of CDS and corresponding standard deviation were calculated based on the assemblies belonging to each one of them. Finally, we calculated the ratio between the number of informative ViPhOGs associated with each taxa and the corresponding average number of CDS, which was ultimately defined as taxon-specific ratio (TSR). The value of this parameter was set to 1 for the cases in which the number of informative ViPhOGs was higher than the average number of CDS.</p>
    </sec>
    <sec id="sec005">
      <title>Preparation of mock metagenome assemblies for benchmarking</title>
      <p>Paired-end reads of six virus-enriched samples were downloaded from ENA (study: PRJEB6941; runs: ERR575691, ERR575692, ERR576942, ERR576943, ERR576944, ERR576945) and concatenated to make a single input file [<xref rid="pcbi.1011422.ref032" ref-type="bibr">32</xref>]. Before assembly, host contamination was removed by k-mer-based decontamination against the mouse genome (Ensembl GRCm38, primary assembly) with BBDuK v38.79 from the BBTools suite (<ext-link xlink:href="https://sourceforge.net/projects/bbmap/" ext-link-type="uri">https://sourceforge.net/projects/bbmap/</ext-link>) using a k-mer size of 27. To include a metagenome assembly that also comprised eukaryotic viruses, we further obtained paired-end reads of seven virus-enriched samples (study: PRJNA319556; runs: SRR3458563-3458569) [<xref rid="pcbi.1011422.ref033" ref-type="bibr">33</xref>].</p>
      <p>For the combined data sets within both studies, two individual metagenome assemblies were performed by first cleaning the reads with fastp v0.20.0 [<xref rid="pcbi.1011422.ref040" ref-type="bibr">40</xref>] and passing them to metaSPAdes v3.14 [<xref rid="pcbi.1011422.ref041" ref-type="bibr">41</xref>] using default parameters. The ‘—only-assembler’ parameter was used to generate the assembly of the combined Neto read sets due to memory constraints. We used QUAST v5.0.2 [<xref rid="pcbi.1011422.ref042" ref-type="bibr">42</xref>] to assess basic quality metrics of the assemblies. The two assemblies (hereafter named Kleiner and Neto assemblies) can be downloaded from the Open Science Framework (<ext-link xlink:href="https://doi.org/10.17605/OSF.IO/FBRXY" ext-link-type="uri">https://doi.org/10.17605/OSF.IO/FBRXY</ext-link>).</p>
    </sec>
    <sec id="sec006">
      <title>Selection and comparison of virus prediction tools</title>
      <p>We used the multi-tool workflow “What the Phage” (WtP) [<xref rid="pcbi.1011422.ref043" ref-type="bibr">43</xref>] for comparing different virus prediction tools in an attempt to identify the best tool combination for a comprehensive initial virus prediction of our pipeline. We run WtP release v0.9.0, including VirSorter (with and without virome option), VirFinder (default and VF.modEPV_k8.rda models), PPR-Meta, DeepVirFinder [<xref rid="pcbi.1011422.ref044" ref-type="bibr">44</xref>], MARVEL [<xref rid="pcbi.1011422.ref045" ref-type="bibr">45</xref>], metaPhinder [<xref rid="pcbi.1011422.ref046" ref-type="bibr">46</xref>], VIBRANT [<xref rid="pcbi.1011422.ref047" ref-type="bibr">47</xref>], VIRNET [<xref rid="pcbi.1011422.ref048" ref-type="bibr">48</xref>], Phigaro [<xref rid="pcbi.1011422.ref049" ref-type="bibr">49</xref>] and sourmash [<xref rid="pcbi.1011422.ref050" ref-type="bibr">50</xref>] on the Kleiner and Neto assemblies. The analysis was performed on contigs that were at least 1.5 kb long to filter out shorter contigs with potentially few ORFs, which are less likely to be correctly classified by our ViPhOG-based taxonomic annotation pipeline. Previous studies have revealed that viral genomes shorter than 1.5 kb tend to code for no more than 5 proteins [<xref rid="pcbi.1011422.ref024" ref-type="bibr">24</xref>]. Based on a previous study in which global oceanic viral populations were surveyed, we manually updated the parameter configuration file of WtP to include all VirSorter predictions from categories 1–5 and to filter VirFinder results by p-values &lt; 0.05 and scores ≥ 0.7 [<xref rid="pcbi.1011422.ref012" ref-type="bibr">12</xref>].</p>
      <p>To assess the performance of each viral prediction tool and the tool combination implemented in VIRify, we identified the viral contigs in the Kleiner and Neto assemblies by aligning them to the genomes of the viruses that comprised the corresponding mock communities. For both mock communities, the set of viral genomes used as targets for the alignments included all the viruses listed in the corresponding studies, and the putative prophages predicted in the genomes of the bacteria that were either part of the mock communities or used for propagating the mock community phages. Thus, prophage prediction was conducted for the following bacterial genome sequences: <italic toggle="yes">Pseudomonas savastanoi</italic> pv. <italic toggle="yes">phaseolicola</italic> strain HB10Y (GCF_001294035), <italic toggle="yes">Salmonella enterica</italic> subsp. <italic toggle="yes">enterica</italic> serovar Typhimurium str. LT2 (NC_003197), <italic toggle="yes">Listeria monocytogenes</italic> EGD-e (NC_003210), <italic toggle="yes">Bacteroides thetaiotaomicron</italic> VPI-5482 (NC_004663), <italic toggle="yes">Enterococcus faecalis</italic> V583 (NC_004668), <italic toggle="yes">Escherichia coli</italic> B strain C3029 (NZ_CP014269), <italic toggle="yes">Lactobacillus acidophilus</italic> strain ATCC 4356 (GCF_000786395), <italic toggle="yes">Bifidobacterium animalis</italic> subsp. <italic toggle="yes">lactis</italic> ATCC 27674 (GCF_001263985), <italic toggle="yes">B</italic>. <italic toggle="yes">thetaiotaomicron</italic> strain ATCC 29741 (GCF_004349615) and <italic toggle="yes">E</italic>. <italic toggle="yes">coli</italic> DSM 30083 (NZ_CP033092). Prophages were predicted from the listed bacterial genomes using VirSorter [<xref rid="pcbi.1011422.ref051" ref-type="bibr">51</xref>], selecting the Viromes database and activating the virome decontamination mode, and PHASTER [<xref rid="pcbi.1011422.ref052" ref-type="bibr">52</xref>].</p>
      <p>VirSorter predictions in categories 4 and 5, and PHASTER predictions classified as Intact or Questionable were clustered using cd-hit-est with a sequence identity cut-off of 0.9 and default settings [<xref rid="pcbi.1011422.ref053" ref-type="bibr">53</xref>]. The set of putative prophages selected for each mock community included all VirSorter category 4 predictions, PHASTER Intact prophages, and regions that were reported both as VirSorter category 5 predictions and PHASTER Questionable prophages. Contigs from each mock community assembly were aligned to the corresponding set of viral genomes using nucmer v3.23 with default settings [<xref rid="pcbi.1011422.ref054" ref-type="bibr">54</xref>], and contigs were identified as viral when at least 70% of their length was covered by an alignment with at least 90% sequence identity. Following the identification of viral contigs within the Kleiner and Neto assemblies, the performance of the viral predictions tools tested using WtP and the combination selected for VIRify was measured via the calculation of the F1-score (<bold><xref rid="pcbi.1011422.s002" ref-type="supplementary-material">S2 Fig</xref></bold>).</p>
      <p>The output from WtP was visualised in UpSet plots and presence/absence maps that indicated whether an input contig was predicted as viral or not by each of the assessed tools (<bold><xref rid="pcbi.1011422.s003" ref-type="supplementary-material">S3 Fig</xref></bold>). MARVEL and VIRNET predictions were not included for the Neto assembly because both tools failed to process this assembly for unidentified technical reasons.</p>
    </sec>
    <sec id="sec007">
      <title>VIRify taxonomic annotation pipeline description</title>
      <sec id="sec008">
        <title>Identification of putative viral sequences</title>
        <p>Based on the results obtained with WtP and the procedure previously employed in a global oceanic survey of viral populations, it was determined that VIRify’s detection of putative viral contigs would be carried out with VirFinder, VirSorter and PPR-Meta, while putative prophage detection would be conducted with VirSorter only (<bold><xref rid="pcbi.1011422.g001" ref-type="fig">Fig 1</xref></bold>) [<xref rid="pcbi.1011422.ref012" ref-type="bibr">12</xref>,<xref rid="pcbi.1011422.ref051" ref-type="bibr">51</xref>,<xref rid="pcbi.1011422.ref055" ref-type="bibr">55</xref>,<xref rid="pcbi.1011422.ref056" ref-type="bibr">56</xref>]. Viral prediction with VirSorter is carried out using parameters ‘—db 2’ and ‘—virome’ when the processed metagenomic assemblies are generated from virome datasets (as was the case for VIRify’s benchmarking with the Kleiner and Neto assemblies), otherwise the latter parameter is not set. Putative prophages are retrieved from VirSorter predictions in prophage categories 4 and 5 as defined by the tool. Detection of putative viral contigs with VirFinder is conducted using the classifiers in the model file VF.modEPV_k8.rda, which was trained using sequences from prokaryotic and eukaryotic viruses (available at <ext-link xlink:href="https://github.com/jessieren/VirFinder" ext-link-type="uri">https://github.com/jessieren/VirFinder</ext-link>). Predicted viral contigs are classified into two different categories within the VIRify pipeline as follows: contigs reported by VirSorter in categories 1 and 2 are placed in the high-confidence category, whilst the low-confidence category includes contigs that satisfy any of the following conditions:</p>
        <list list-type="bullet">
          <list-item>
            <p>Reported by VirFinder with <italic toggle="yes">p</italic>&lt;0.05 and <italic toggle="yes">score</italic>≥0.9.</p>
          </list-item>
          <list-item>
            <p>Reported by VirFinder with <italic toggle="yes">p</italic>&lt;0.05 and <italic toggle="yes">score</italic>≥0.7, and also reported by VirSorter in category 3.</p>
          </list-item>
          <list-item>
            <p>Reported by VirFinder with <italic toggle="yes">p</italic>&lt;0.05 and <italic toggle="yes">score</italic>≥0.7, and also reported as phage by PPR-Meta.</p>
          </list-item>
        </list>
        <fig position="float" id="pcbi.1011422.g001">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1011422.g001</object-id>
          <label>Fig 1</label>
          <caption>
            <title>Overview of the VIRify pipeline.</title>
            <p><bold>(A)</bold> Starting from a set of contigs (fasta file) the pipeline preprocesses the input sequences (ID renaming, length filtering) and predicts contigs from a putative viral origin that are split into high confidence (HC), low confidence (LC) and putative prophage (PP) sets. Each selected contig is then annotated and assigned to a taxonomy, if possible. All results (annotated viral contigs) are quality-controlled with CheckV, and finally summarised and visualised. <bold>(B)</bold> The assigned taxonomy is based on the informative ViPhOG hits per contig and performed on genus, family, subfamily and finally order rank. We consider high-confidence and low-confidence ViPhOG hits and discard non-informative models where no clear taxonomy signal could be assigned. TSR—taxon-specific ratio; <inline-formula id="pcbi.1011422.e004"><alternatives><graphic xlink:href="pcbi.1011422.e004" id="pcbi.1011422.e004g" position="anchor"/><mml:math id="M4" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>C</mml:mi><mml:mi>D</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>—taxon average CDS; <italic toggle="yes">σCDS</italic><sub><italic toggle="yes">taxon</italic></sub>—taxon CDS standard deviation.</p>
          </caption>
          <graphic xlink:href="pcbi.1011422.g001" position="float"/>
        </fig>
        <p>Finally, CheckV [<xref rid="pcbi.1011422.ref057" ref-type="bibr">57</xref>] is employed to assess the quality and completeness of the categorised viral genome contigs.</p>
      </sec>
      <sec id="sec009">
        <title>Annotation of putative viral sequences with informative ViPhOGs</title>
        <p>Protein-coding sequences within putative viral contigs and prophages are detected with Prodigal v2.6.3 [<xref rid="pcbi.1011422.ref058" ref-type="bibr">58</xref>], using the standard bacterial/archaeal translation table (-g 11) and the metagenomic prediction mode (-p meta) (<xref rid="pcbi.1011422.g001" ref-type="fig">Fig 1</xref>). A recent study in which the performance of a range of ORF-prediction tools was assessed for the viral genomes available in NCBI’s RefSeq reported that Prodigal was the most accurate tool for DNA viruses, which account for ~97% of the viral genomic sequences currently available in public databases [<xref rid="pcbi.1011422.ref059" ref-type="bibr">59</xref>,<xref rid="pcbi.1011422.ref060" ref-type="bibr">60</xref>]. Amino acid sequences derived from the predicted coding sequences are scanned with the complete ViPhOG database using hmmscan v3.2.1 [<xref rid="pcbi.1011422.ref061" ref-type="bibr">61</xref>] and the model-specific bit score thresholds defined as previously described, to supersede any thresholding based on statistical significance alone. To apply the defined model-specific thresholds, we set the—cut_ga option during execution of the hmmscan command. However, to account for the set of ViPhOGs for which no bit score thresholds were defined (and therefore set to 0), an additional post-processing filter is applied to the full-sequence e-values reported in the hmmscan output (<italic toggle="yes">E</italic>≤1.0×10<sup>−3</sup>).</p>
      </sec>
      <sec id="sec010">
        <title>Taxonomic assignment of putative viral sequences</title>
        <p>In-house python scripts (see <ext-link xlink:href="https://github.com/EBI-Metagenomics/emg-viral-pipeline" ext-link-type="uri">https://github.com/EBI-Metagenomics/emg-viral-pipeline</ext-link>) are employed for parsing the hmmscan results and to provide a taxonomic assignment for all putative viral contigs and prophages, based on the reported hits against the ViPhOG database. Starting at the genus rank, the algorithm checks all taxa associated with the reported informative ViPhOGs, sorts them in descending order based on the proportion of corresponding hits, and iterates through them until it identifies a taxon that fulfils the conditions set in our voting system. The first of these conditions is that the proportion of hits for a candidate taxon must be equal to or higher than 0.6 x TSR. The default value of 0.6 sets a maximum threshold for the number of hits required to call a taxon, but the TSR leads to a reduction in the threshold value that is consistent with the density of informative ViPhOGs linked to each taxon. The second condition checks whether the number of CDS in the contig is not significantly larger than the average number of CDS calculated for the candidate taxon (i.e. <inline-formula id="pcbi.1011422.e005"><alternatives><graphic xlink:href="pcbi.1011422.e005.jpg" id="pcbi.1011422.e005g" position="anchor"/><mml:math id="M5" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>C</mml:mi><mml:mi>D</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>C</mml:mi><mml:mi>D</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mi>σ</mml:mi><mml:mi>C</mml:mi><mml:mi>D</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>). This condition was set to reduce the number of wrong taxonomic assignments, as it prevents the classification of contigs into taxa where the average number of CDS is significantly lower than the contig CDS count. If either of the conditions is not satisfied, the algorithm continues the iteration over the remaining taxa until it finds one that satisfies them. If the iteration finishes without success, the algorithm shifts to the next taxonomic rank and repeats the described procedure. The process is repeated at the subfamily, family, and order ranks until a taxon that satisfies the voting system’s conditions is found, in which case the algorithm reports the corresponding viral lineage (<xref rid="pcbi.1011422.g001" ref-type="fig">Fig 1</xref>).</p>
      </sec>
      <sec id="sec011">
        <title>Visualization of assigned viral taxonomies and ViPhOG hits</title>
        <p>Putative viral contigs with and without an assigned taxonomy are visualized using interactive Krona [<xref rid="pcbi.1011422.ref062" ref-type="bibr">62</xref>] and Sankey plots inspired by the Pavian package [<xref rid="pcbi.1011422.ref063" ref-type="bibr">63</xref>]. ORFs identified with Prodigal and their corresponding informative ViPhOG hits are visualized for each contig using the ChromoMap package v0.2 [<xref rid="pcbi.1011422.ref064" ref-type="bibr">64</xref>]. The package does not visualize exact start and stop positions for each ORF but instead relies on a more general grid view, thus visualizing the general coverage of annotated ORFs for each contig.</p>
      </sec>
    </sec>
    <sec id="sec012">
      <title>Analysis of 243 TARA Oceans assemblies with VIRify</title>
      <p>We obtained 243 ocean microbiome assemblies from ENA (<ext-link xlink:href="https://www.ebi.ac.uk/ena/browser/view/PRJEB22493" ext-link-type="uri">https://www.ebi.ac.uk/ena/browser/view/PRJEB22493</ext-link>), generated as part of the TARA Oceans microbiome study [<xref rid="pcbi.1011422.ref012" ref-type="bibr">12</xref>]. The FASTA identifiers include the size fraction of the corresponding sample; thus samples enriched for viruses are labeled with the suffix _0.1–0.22. All assemblies were filtered to retain contigs that were at least 5 kb long and these were screened for viruses using VIRify and setting the—virome option to activate VirSorter’s virome decontamination mode.</p>
    </sec>
    <sec id="sec013">
      <title>Taxonomic classification of 57,866 VCs from the Gut Phage Database (GPD)</title>
      <p>The GPD is a collection of phage genomic sequences that includes prophages from cultured gut bacteria and putative phage sequences retrieved from assemblies of globally-distributed human gut metagenomes [<xref rid="pcbi.1011422.ref034" ref-type="bibr">34</xref>]. A representative sequence for each of the 57,866 VCs in the GPD was selected by choosing the corresponding entry with the highest CheckV quality and completion values. The complete set of representative sequences was analysed with VIRify, using the “—onlyannotate” option to skip the viral prediction step and apply the taxonomic classification pipeline to all the input sequences. The results obtained for all the classified representative sequences were collated and summarised in a Sankey plot.</p>
    </sec>
    <sec id="sec014">
      <title>Selection and comparison of virus-specific protein profile HMM databases</title>
      <p>The taxonomic assignment of VIRify relies purely on our own protein profile HMM database, their taxonomy, and model-specific bit score cutoffs. In an effort to be comprehensive, our pipeline also provides the option of additional annotations by incorporating 25,399 models from the VOGdb (<ext-link xlink:href="http://vogdb.org/" ext-link-type="uri">http://vogdb.org/</ext-link>), 25,281 viral protein family (VPF) models from IMG/VR [<xref rid="pcbi.1011422.ref060" ref-type="bibr">60</xref>], 9,911 models from RVDB v17.0 [<xref rid="pcbi.1011422.ref065" ref-type="bibr">65</xref>,<xref rid="pcbi.1011422.ref066" ref-type="bibr">66</xref>], and 9,518 models from pVOG [<xref rid="pcbi.1011422.ref067" ref-type="bibr">67</xref>]. VIRify can use all databases to individually annotate proteins from all putative viral contigs, using hmmscan with default values and an e-value cutoff of 0.001. However, the final taxonomic assignment provided for the putative viral contigs relies exclusively on our curated set of ViPhOGs.</p>
      <p>To compare the annotations provided by all five databases, we ran hmmscan on all predicted proteins from putative viral contigs detected in the two mock community assemblies (Neto and Kleiner) and the 243 TARA Oceans assemblies. To allow for a better comparison against the other databases, we distinguished hits against the ViPhOG models into hits only based on an e-value cutoff of 0.001 and hits additionally identified using our predefined model-specific bit score thresholds.</p>
    </sec>
    <sec id="sec015">
      <title>General implementation of VIRify</title>
      <p>VIRify is implemented using the workflow management system Nextflow [<xref rid="pcbi.1011422.ref030" ref-type="bibr">30</xref>], and an overview of the pipeline is given in <xref rid="pcbi.1011422.g001" ref-type="fig">Fig 1</xref>. All third-party tools are encapsulated in software containers to allow easy distribution of the pipeline on local, cluster, or cloud systems. Custom Python scripts connect the output and input of the tools used and are available via GitHub (<ext-link xlink:href="https://github.com/EBI-Metagenomics/emg-viral-pipeline/tree/master/bin" ext-link-type="uri">https://github.com/EBI-Metagenomics/emg-viral-pipeline/tree/master/bin</ext-link>). With configured Nextflow and Docker [<xref rid="pcbi.1011422.ref068" ref-type="bibr">68</xref>] installations, VIRify can be simply downloaded and run with a single command: nextflow run EBI-Metagenomics/emg-viral-pipeline -r v1.0—help. All required databases and metadata files are automatically downloaded and stored for later (offline) reuse. We always recommend running a stable release version from the repository, which can be selected via the -r flag. Different Nextflow profiles allow the execution on a local system or cluster (currently supported are LSF and SLURM). The pipeline may also be run in an “annotation” mode that skips the prediction of putative virus sequences and directly assigns viral taxonomies to all the input contigs. Please note that until version v1.0, the pipeline was implemented back-to-back in Nextflow and CWL [<xref rid="pcbi.1011422.ref069" ref-type="bibr">69</xref>]. Both workflow implementations were using the same scripts and software containers. However, to reduce maintenance and to fully focus on one implementation, from v1.0 all pipeline updates will be introduced only in Nextflow.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec016">
    <title>Results</title>
    <sec id="sec017">
      <title>Viral diversity is comprehensively covered by the set of manually curated informative ViPhOGs</title>
      <p>The original ViPhOG database [<xref rid="pcbi.1011422.ref024" ref-type="bibr">24</xref>] consists of 31,150 profile HMMs that were created using proteins from viral genomes found in NCBI’s databases. Based on the search of homologous sequences in the UniProtKB database and the subsequent analysis conducted on the output data, we identified 20,266 informative ViPhOGs that could serve as taxonomic markers for viral taxa present in the current version of ICTV’s taxonomy (MSL#38). <bold><xref rid="pcbi.1011422.g002" ref-type="fig">Fig 2</xref></bold> indicates the number of informative ViPhOGs obtained for each of the analysed taxonomic ranks (genus, subfamily, family and order), and for each rank, it illustrates the number of targeted taxa that correspond to either prokaryotic or eukaryotic viruses. Overall, 83.1% of the informative ViPhOGs were linked to taxa at the genus level and the numbers identified for the remaining ranks decreased from the subfamily to the order level. Furthermore, the percentage of informative ViPhOGs associated with eukaryotic viral taxa was slightly larger than the percentage of those associated with prokaryotic viral taxa (53.2% and 46.8%, respectively).</p>
      <fig position="float" id="pcbi.1011422.g002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011422.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Number of informative ViPhOGs identified for different viral taxonomic ranks.</title>
          <p>31,150 ViPhOGs were searched against all entries in UniProtKB, and based on the output they were designated as specific for different viral taxa (see <xref rid="sec002" ref-type="sec">Methods</xref>). Purple refers to specific ViPhOGs assigned to prokaryotic viral taxa, whereas yellow indicates specific ViPhOGs for eukaryotic viral taxa.</p>
        </caption>
        <graphic xlink:href="pcbi.1011422.g002" position="float"/>
      </fig>
      <p>Regarding the coverage of currently known viral taxa, the informative ViPhOGs cover 18.6, 31.8, 20.9 and 10.8% of genera, subfamilies, families and orders represented in the viral NCBI taxonomy retrieved in January 2023 (<bold><xref rid="pcbi.1011422.s001" ref-type="supplementary-material">S1 Fig</xref></bold>). A comparison with the coverage of the viral NCBI taxonomy from March 2020 demonstrated an evident reduction in taxonomic coverage for all analysed ranks, which in turn provides a clear picture of the broad changes the viral taxonomy has undergone in the last few years. Nevertheless, our set of informative ViPhOGs includes taxonomy markers for many representative viral lineages within the ubiquitous and widely-described class <italic toggle="yes">Caudoviricetes</italic>, the eukaryotic virus order <italic toggle="yes">Herpesvirales</italic>, and the eukaryotic viral families <italic toggle="yes">Mimiviridae</italic>, <italic toggle="yes">Coronaviridae</italic>, and <italic toggle="yes">Poxviridae</italic>, among others. Moreover, based on the coverage of the NCBI viral taxonomy of January 2023, our set of informative ViPhOGs covers 38.6% of all the lineages represented by the currently known viral diversity in at least one taxonomic rank (<bold><xref rid="pcbi.1011422.s001" ref-type="supplementary-material">S1 Fig</xref></bold>).</p>
    </sec>
    <sec id="sec018">
      <title>VIRify accurately classifies viruses on co-assemblies of two largely viral mock communities</title>
      <p>VIRify was tested on datasets generated from viral mock communities to evaluate its viral sequence prediction performance and compare its taxonomic assignments with the taxonomy of the viruses present in the communities. The selected datasets were generated for two different studies that evaluated a range of viral enrichment and purification procedures that were applied to mock microbial communities. Kleiner et al. [<xref rid="pcbi.1011422.ref032" ref-type="bibr">32</xref>] sequenced a mock microbiome prepared in mouse faeces using bacterial and phage cultures (germ-free C57BL/6 J mice). The samples contained six different phages in varying concentrations: P22, T3, T7, ɸ6, M13 and ɸVPE25. Neto et al. [<xref rid="pcbi.1011422.ref033" ref-type="bibr">33</xref>] constructed a mock microbiome comprised of four common gut bacteria and nine highly diverse viruses, most of which represent the eukaryotic viral families <italic toggle="yes">Circoviridae</italic>, <italic toggle="yes">Parvoviridae</italic>, <italic toggle="yes">Polyomaviridae</italic>, <italic toggle="yes">Alphaflexiviridae</italic>, <italic toggle="yes">Reoviridae</italic>, <italic toggle="yes">Coronaviridae</italic>, <italic toggle="yes">Herpesviridae</italic> and <italic toggle="yes">Mimiviridae</italic>, and including a phage from the family <italic toggle="yes">Ackermannviridae</italic> (formerly classified in the family <italic toggle="yes">Myoviridae</italic>). The nine viruses differ highly in genome length (1.8 kb to 1,180 kb), genome type (dsDNA, dsRNA, ssDNA, ssRNA), and genome compositions (linear, circular, segmented). Co-assemblies of datasets obtained from viral-enriched samples were generated for each of the selected studies and used as input for the VIRify pipeline. The Kleiner co-assembly comprises 5,310 contigs, of which 224 are ≥ 1.5 kb with an N50 of 74,309 bp. The Neto co-assembly comprises 341,587 contigs, of which 1,686 are ≥ 1.5 kb with an N50 of 16,751 bp. Thus, 95.78% of the contigs in the Kleiner assembly, and 99.51% of the contigs in the Neto assembly are shorter than 1500 bp.</p>
      <sec id="sec019">
        <title>VIRify comprehensively selects putative viral contigs</title>
        <p>We ran a modified version of WtP (see <xref rid="sec002" ref-type="sec">Methods</xref>) on both mock community assemblies (Kleiner, Neto) to compare ten different tools for virus prediction. <bold><xref rid="pcbi.1011422.s002" ref-type="supplementary-material">S2 Fig</xref></bold> illustrates the performance of all the assessed tools for each of the analysed mock community assemblies. Our results show that a selection of VirSorter, VirFinder, and PPR-Meta sufficiently represented a common proportion of putative viral contigs from both mock community assemblies across all compared prediction tools (<bold>Figs <xref rid="pcbi.1011422.g003" ref-type="fig">3A</xref></bold>, <bold><xref rid="pcbi.1011422.s002" ref-type="supplementary-material">S2</xref></bold> and <bold><xref rid="pcbi.1011422.s003" ref-type="supplementary-material">S3</xref></bold>). Thus, the combination of these tools was selected as VIRify’s method for viral contig prediction, although the selection of putative viral contigs from this combination is subjected to a set of rules similar to the selection criteria used in a previous study of global oceanic viral populations (see <xref rid="sec002" ref-type="sec">Methods</xref> section for further details) [<xref rid="pcbi.1011422.ref012" ref-type="bibr">12</xref>]. <bold><xref rid="pcbi.1011422.t001" ref-type="table">Table 1</xref></bold> summarises the viral contig prediction results obtained with VIRify for the Kleiner and Neto assemblies.</p>
        <fig position="float" id="pcbi.1011422.g003">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1011422.g003</object-id>
          <label>Fig 3</label>
          <caption>
            <title>Exemplary viral contig selection and annotation procedure for the Kleiner co-assembly.</title>
            <p><bold>(A)</bold> Comparison of virus predictions for the Kleiner co-assembly performed with various tools run via WtP. Shown are the 35 contigs (rows) predicted as viral by at least one of the tested tools. The column with red squares highlights the contigs manually identified as viral, as described in the methods section. Blue squares indicate contigs predicted as viral by VirSorter (virome decontamination mode), VirFinder (VF.modEPV_k8.rda model) or PPR-Meta. The column with green squares indicates the viral contigs reported by the prediction approach implemented in VIRify, based on the results from WtP (see <xref rid="sec002" ref-type="sec">Methods</xref> section). Yellow squares indicate CheckV-quality results for contigs selected by VIRify that are either high-quality, medium-quality, low-quality or not-determined; going from dark (high-quality) to light yellow (not-determined). <bold>(B)</bold> ORFs predicted with Prodigal and annotated with the informative ViPhOGs for the 14 contigs identified as viral by VIRify. Of these, eleven were predicted as high confidence (HC) and three as putative prophages (PP). No low-confidence viral predictions were reported for the Kleiner co-assembly. The coloured contig labels indicate the CheckV scores: red—high-quality, orange—medium-quality, yellow—low-quality, and black—not-determined. Dark grey bars indicate predicted ORFs without any ViPhOG hit, while green bars indicate ViPhOG hits based on the model-specific bitscores. <bold>(C)</bold> Predicted viral sequences and corresponding taxonomic assignments based on informative ViPhOG hits for the Kleiner co-assembly.</p>
          </caption>
          <graphic xlink:href="pcbi.1011422.g003" position="float"/>
        </fig>
        <table-wrap position="float" id="pcbi.1011422.t001">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1011422.t001</object-id>
          <label>Table 1</label>
          <caption>
            <title>VIRify’s viral prediction results for two mock community assemblies.</title>
            <p>The analyses were conducted for all assembled contigs longer than 1.5 kb.</p>
          </caption>
          <alternatives>
            <graphic xlink:href="pcbi.1011422.t001" id="pcbi.1011422.t001g" position="float"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="center" rowspan="1" colspan="1">Assembly</th>
                  <th align="center" rowspan="1" colspan="1">Total contigs</th>
                  <th align="center" rowspan="1" colspan="1">Viral contigs</th>
                  <th align="center" rowspan="1" colspan="1">True positives</th>
                  <th align="center" rowspan="1" colspan="1">True negatives</th>
                  <th align="center" rowspan="1" colspan="1">False positives</th>
                  <th align="center" rowspan="1" colspan="1">False negatives</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="center" rowspan="1" colspan="1">Kleiner</td>
                  <td align="center" rowspan="1" colspan="1">224</td>
                  <td align="center" rowspan="1" colspan="1">17</td>
                  <td align="center" rowspan="1" colspan="1">13</td>
                  <td align="center" rowspan="1" colspan="1">206</td>
                  <td align="center" rowspan="1" colspan="1">1</td>
                  <td align="center" rowspan="1" colspan="1">4</td>
                </tr>
                <tr>
                  <td align="center" rowspan="1" colspan="1">Neto</td>
                  <td align="center" rowspan="1" colspan="1">1686</td>
                  <td align="center" rowspan="1" colspan="1">259</td>
                  <td align="center" rowspan="1" colspan="1">134</td>
                  <td align="center" rowspan="1" colspan="1">1390</td>
                  <td align="center" rowspan="1" colspan="1">37</td>
                  <td align="center" rowspan="1" colspan="1">125</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
        <p>For the Kleiner assembly, 17 contigs were identified as viral based on their alignment to the genome sequences of the phages that comprise the corresponding mock community (<xref rid="pcbi.1011422.g003" ref-type="fig">Fig 3</xref><bold>A</bold>). VIRify identified 76.5% of the viral contigs in the Kleiner assembly and reported only one false positive prediction (NODE_192_length_1740_cov_2.233828), which also received no CheckV quality score. For the remaining contigs that VIRify predicted as viral, CheckV categorised six as high-quality, one as medium-quality, six as low-quality and the rest were undetermined (<xref rid="pcbi.1011422.g003" ref-type="fig">Fig 3A</xref>). All true negative predictions matched entries in NCBI’s RefSeq corresponding to <italic toggle="yes">Salmonella</italic> genomes, an observation consistent with the significant amount of <italic toggle="yes">Salmonella</italic> DNA that was previously detected in all of the viral-enriched samples used for obtaining the Kleiner assembly [<xref rid="pcbi.1011422.ref032" ref-type="bibr">32</xref>]. Regarding the reported false negatives, 3 corresponded to prophages predicted in the genome of <italic toggle="yes">Salmonella enterica</italic> subsp. <italic toggle="yes">enterica</italic> serovar Typhimurium str. LT2 and the remaining one matched entries in NCBI related to phage M13. According to the calculated F1-scores, the viral prediction tools that performed best for this assembly were VirSorter (using the virome decontamination mode) and VIRify, both of which had an F1-score of 0.84 (<bold><xref rid="pcbi.1011422.s002" ref-type="supplementary-material">S2 Fig</xref></bold>).</p>
        <p>Regarding the Neto assembly, alignment of contigs to the genome sequences of the mock community viruses identified 259 of them as viral. In this case, VIRify identified 51.7% of the viral contigs present in the assembly, and 21.6% of the contigs reported as viral were false positives. Among the false negatives, 75.2% of the contigs were derived from the genome of the mimivirus included in the mock community. In addition, 23.2% of the false negatives were contigs that ranged in size from 1,515 to 5,906 bp and that corresponded to prophages identified in the genomes of the <italic toggle="yes">E</italic>. <italic toggle="yes">coli</italic> and <italic toggle="yes">B</italic>. <italic toggle="yes">thetaiotaomicron</italic> strains included in the mock community. Based on the F1-scores, the tools that performed best for the Neto assembly were PPR-Meta (0.84), VirFinder with the VF.modEPV_k8.rda model (0.63) and VIRify (0.62) (<bold><xref rid="pcbi.1011422.s002" ref-type="supplementary-material">S2 Fig</xref></bold>). In total, VIRify predicted 170 contigs of the Neto co-assembly as viral, of which CheckV rated two as high-quality, three as medium-quality, 142 as low-quality, and 24 as indeterminate.</p>
        <p>Overall, the calculated F1-scores revealed that VIRify and PPR-Meta were the tools that performed best for predicting viral contigs from the analysed mock community assemblies (<bold><xref rid="pcbi.1011422.s002" ref-type="supplementary-material">S2 Fig</xref></bold>). VIRify had a better performance than PPR-Meta on the Kleiner assembly, particularly due to its ability to predict prophages from assembled bacterial contigs (e.g. NODE_1_length_514496_cov_72.252612 and NODE_5_length_111535_cov_40.991774) and due to PPR-Meta being less precise than VIRify, as evidenced by the higher number of false positive predictions reported by the former (<bold><xref rid="pcbi.1011422.g003" ref-type="fig">Fig 3A</xref></bold>). By contrast, PPR-Meta performed better than VIRify on the Neto assembly because the former tool had a higher recall rate that allowed the recovery of 87.6% of the mimivirus contigs, whereas VIRify recovered only 55.2% of the contigs derived from this virus.</p>
      </sec>
      <sec id="sec020">
        <title>Taxonomic classification of phage contigs and putative prophage regions down to the subfamily and genus ranks</title>
        <p>The taxonomic annotation performed with VIRIfy on the Kleiner assembly classified six of the putative viral contigs as members of the class <italic toggle="yes">Caudoviricetes</italic> (<bold><xref rid="pcbi.1011422.g003" ref-type="fig">Fig 3B and 3C</xref></bold>). Among them, two within the genus <italic toggle="yes">Teseptimavirus</italic>, three within the subfamily <italic toggle="yes">Sepvirinae</italic>, and one within the subfamily <italic toggle="yes">Tunavirinae</italic>. In addition, one contig corresponding to phage ΦX174, which is commonly used as a positive control in sequencing experiments, was correctly classified as a member of the subfamily <italic toggle="yes">Bullavirinae</italic> (class <italic toggle="yes">Malgrandaviricetes</italic>). Among the seven contigs with an assigned taxonomy, two were predicted by VirSorter to be putative prophage sequences (<bold><xref rid="pcbi.1011422.g003" ref-type="fig">Fig 3B</xref></bold>) which likely derived from bacterial contamination in the samples [<xref rid="pcbi.1011422.ref032" ref-type="bibr">32</xref>]. Of the six phages potentially included in the Kleiner co-assembly, VIRify identified and classified contigs that correspond to phages P22 (NODE_20), T3 (NODE_23), and T7 (NODE_22). While contigs derived from phages T3 and T7 were correctly classified in the <italic toggle="yes">Teseptimavirus</italic> genus, the contig from phage P22 was incorrectly classified as a member of subfamily <italic toggle="yes">Sepvirinae</italic>. However, both phage P22 and subfamily <italic toggle="yes">Sepvirinae</italic> belong to class <italic toggle="yes">Caudoviricetes</italic>, thus VIRify was able to classify the contig from phage P22 into the correct class. Overall, two of the phages from the original mock community present among the putative viral contigs were correctly classified by VIRify at the genus rank, one contig from phage ΦX174 was correctly classified at the subfamily rank, and one additional phage from the mock community was correctly classified at the class rank.</p>
        <p>The pipeline reported a long 86 kb contig (NODE_8) from ɸVPE25 among the high-confidence viral contigs, whose taxonomic lineage was not identified, likely due to the low number of ViPhOG hits reported (<xref rid="pcbi.1011422.g003" ref-type="fig">Fig 3</xref><bold>B</bold>). Phage M13 could not be identified either, as it was only assembled in small fragments due to low sequencing coverage, an observation that was consistent with the results reported previously [<xref rid="pcbi.1011422.ref032" ref-type="bibr">32</xref>]. The M13 genome is 6.4 kb long and metaSPAdes only recovered two contigs in the high confidence set that matched different parts of the phage’s genome (NODE_113 with 2,682 bp and NODE_193 with 1,739 bp). Similarly, phage ɸ6 was not even detected by [<xref rid="pcbi.1011422.ref032" ref-type="bibr">32</xref>] after sequencing their viral-enriched samples, which explains why no contigs were identified for this phage in our coassembly.</p>
      </sec>
      <sec id="sec021">
        <title>Comprehensive detection of prokaryotic and eukaryotic viruses from a highly diverse mock-virome</title>
        <p>Taxonomic annotation of the reported 170 putative viral contigs in the Neto assembly revealed that 6 of them were classified as members of the class <italic toggle="yes">Caudoviricetes</italic> and 115 were classified in the orders <italic toggle="yes">Imitervirales</italic> (107 contigs), <italic toggle="yes">Nidovirales</italic> (2), <italic toggle="yes">Ortervirales</italic> (2), <italic toggle="yes">Herpesvirales</italic> (1), <italic toggle="yes">Petitvirales</italic> (1), <italic toggle="yes">Pimascovirales</italic> (1), and <italic toggle="yes">Reovirales</italic> (1) (<xref rid="pcbi.1011422.g004" ref-type="fig">Fig 4</xref>). Among them, we found members of the virus families <italic toggle="yes">Ackermannviridae</italic>, <italic toggle="yes">Mimiviridae</italic>, <italic toggle="yes">Drexlerviridae</italic>, <italic toggle="yes">Herpesviridae</italic>, <italic toggle="yes">Microviridae</italic>, <italic toggle="yes">Iridoviridae</italic>, <italic toggle="yes">Sedoreoviridae</italic>, <italic toggle="yes">Coronaviridae</italic>, and <italic toggle="yes">Retroviridae</italic>. For all these families, VIRify was also able to classify contigs at the subfamily level and some were also classified at the genus level: 97 contigs to <italic toggle="yes">Mimivirus</italic>, 2 contigs to <italic toggle="yes">Alphacoronavirus</italic>, 1 contig to <italic toggle="yes">Limestonevirus</italic>, and 1 contig to <italic toggle="yes">Rotavirus</italic> (<xref rid="pcbi.1011422.g004" ref-type="fig">Fig 4</xref>). The taxonomic classifications provided by VIRify were compared with the taxonomy of the genomes from which the analysed contigs were derived. We determined as a result that VIRify’s taxonomic classification had an accuracy of 94.2% for the putative viral contigs detected in this assembly.</p>
        <fig position="float" id="pcbi.1011422.g004">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1011422.g004</object-id>
          <label>Fig 4</label>
          <caption>
            <title>Predicted ORFs and corresponding ViPhOG annotations and taxonomy assignments for the Neto co-assembly.</title>
            <p><bold>(A)</bold> ViPhOG-annotated ORFs for all contigs predicted as viral with high confidence (HC) and low confidence (LC) for the Neto assembly. Note that due to the high number of LC hits, only a selection of contigs is shown. The coloured contig labels indicate the CheckV scores: red—high-quality, orange—medium-quality, yellow—low-quality, and black—not-determined. VIRify assigned the genus <italic toggle="yes">Alphacoronavirus</italic> to NODE 82 based on seven informative ViPhOG model hits that are additionally shown as a circular visualization. NA—no taxonomy could be assigned due to missing model support. <bold>(B)</bold> Neto contigs predicted as viral with high and low confidence and their taxonomic assignments based on the ViPhOG model hits. Both visualizations can be automatically produced by VIRify and were only slightly manually adjusted via Inkscape.</p>
          </caption>
          <graphic xlink:href="pcbi.1011422.g004" position="float"/>
        </fig>
        <p>Contigs classified as members of subfamilies <italic toggle="yes">Sepvirinae</italic> and <italic toggle="yes">Tunavirinae</italic> matched entries in NCBI’s nr database corresponding to phages of <italic toggle="yes">E</italic>.<italic toggle="yes">coli</italic>, suggesting that these were most likely derived from DNA contamination by the bacterial component of the mock community. No contigs from the viruses that represented the families <italic toggle="yes">Circoviridae</italic>, <italic toggle="yes">Polyomaviridae</italic>, and <italic toggle="yes">Alphaflexiviridae</italic> were detected among the length-filtered contigs by blastn, and therefore no contigs were assigned to any of the corresponding taxonomic lineages. Eight contigs ranging from 1,543 to 2,356 bp and coming from viruses belonging to the families <italic toggle="yes">Parvoviridae</italic>, <italic toggle="yes">Sedoreoviridae</italic> and <italic toggle="yes">Herpesviridae</italic> were detected among the set of low-confidence viral contigs. One of these was correctly classified at the subfamily rank (<italic toggle="yes">Alphaherpesvirinae</italic>) and another was correctly classified at the genus rank (<italic toggle="yes">Rotavirus</italic>). No contig was classified within the viral lineage that includes the family <italic toggle="yes">Parvoviridae</italic>.</p>
        <p>One 7,051 bp putative viral contig was classified in the subfamily <italic toggle="yes">Orthoretrovirinae</italic>, which does not match the lineage of any of the viruses included in the mock community. However, when this contig was used as query for a search of NCBI’s nr nucleotide database with megablast, the top hits corresponded to porcine endogenous retroviral sequences, including several complete genomes of this type of virus (e.g. accession number EF133960.1, 97.93% identity, e-value 0.0). This result indicates that the classification of the mentioned contig as a member of <italic toggle="yes">Orthoretrovirinae</italic> was correct, and that this virus was a contaminant that was likely present in the stock of the Porcine circovirus included in the mock community.</p>
      </sec>
    </sec>
    <sec id="sec022">
      <title>VIRify comprehensively reveals virus taxonomies in global ocean ecosystems</title>
      <p>To showcase the utility of VIRify in uncovering viral diversity in ocean environments, we ran VIRify on 243 assemblies provided by the TARA Oceans project [<xref rid="pcbi.1011422.ref012" ref-type="bibr">12</xref>,<xref rid="pcbi.1011422.ref017" ref-type="bibr">17</xref>,<xref rid="pcbi.1011422.ref018" ref-type="bibr">18</xref>], including 20 samples processed via 0.1–0.22 μm filters and thus potentially enriched for viral sequences [<xref rid="pcbi.1011422.ref012" ref-type="bibr">12</xref>]. As expected, we identified more complete/high-quality viruses in such samples enriched for smaller viruses in comparison to samples derived from larger 0.45–0.8 μm filters (<bold><xref rid="pcbi.1011422.g005" ref-type="fig">Fig 5A</xref></bold>). Across all assemblies and including high and low confidence viral predictions, the following viral families were detected with at least 10 putative viral sequences assigned to them: <italic toggle="yes">Straboviridae</italic> (n = 4,128), <italic toggle="yes">Mimiviridae</italic> (3,627), <italic toggle="yes">Phycodnaviridae</italic> (2,281), <italic toggle="yes">Drexlerviridae</italic> (931), <italic toggle="yes">Herelleviridae</italic> (764), <italic toggle="yes">Salasmaviridae</italic> (363), <italic toggle="yes">Autographiviridae</italic> (326), <italic toggle="yes">Microviridae</italic> (83), <italic toggle="yes">Poxviridae</italic> (37), and <italic toggle="yes">Iridoviridae</italic> (31) (<bold><xref rid="pcbi.1011422.s004" ref-type="supplementary-material">S4 Fig</xref></bold>). In addition, we saw differences in the amount of predicted viral contigs between samples obtained from the same location but with DNA extracted using different filter sizes. For example, in CEUO01 (TARA_124_MIX) filtered for 0.1–0.22 μm (SAMEA2622799) 219 contigs were assigned to the class <italic toggle="yes">Caudoviricetes</italic>, whereas for the same sample material, but filtered for 0.45–0.8 μm (SAMEA2622801), only 32 <italic toggle="yes">Caudoviricetes</italic> contigs were found (<xref rid="pcbi.1011422.g005" ref-type="fig">Fig 5A</xref>). Interestingly, members of the genus <italic toggle="yes">Prasinovirus</italic> (large double-stranded DNA viruses that belong to the order <italic toggle="yes">Algavirales</italic>) were predominantly found in low confidence sets of 0.22–3 μm filtered fractions, which suggests that these viruses would have been missed if only VirSorter had been used on the data (<xref rid="pcbi.1011422.g005" ref-type="fig">Fig 5B</xref>).</p>
      <fig position="float" id="pcbi.1011422.g005">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011422.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Viruses predicted and annotated by VIRify for 243 TARA Oceans assemblies.</title>
          <p>The assembly identifiers include information about the size fractionation of the corresponding sample. For example, samples obtained by smaller filter size 0.1–0.22 μm (and so expected to be enriched for smaller viruses) are labelled with the suffix _0.1–0.22. <bold>(A)</bold> Shows a selection (filters 0.1–0.22 μm and 0.45–0.8 μm) of 41 samples and the number of predicted viruses based on high confidence (VirSorter categories 1 and 2) and low confidence (VirSorter category 3 and combined VirFinder and PPR-Meta results) hits. More viruses are found for smaller filter sizes, as expected. Assemblies based on smaller filter sizes are highlighted in bold. For visualization purposes, we summarize high and low confidence predictions for samples labelled with the filter sizes 0.1–0.22 and 0.45–0.8. <bold>(B)</bold> Selection of 0.22–3 μm filtered samples with a high number of predicted prasinoviruses, large double-stranded DNA viruses belonging to the order <italic toggle="yes">Algavirales</italic>. These viruses are predominantly found in the low confidence set; thus they would have been missed if only VirSorter were run on the data but are predicted by our combination of VirFinder and PPR-Meta.</p>
        </caption>
        <graphic xlink:href="pcbi.1011422.g005" position="float"/>
      </fig>
      <p>A previous study in which the aforementioned marine samples were analysed reported that the majority of identified viruses were members of the recently abolished viral families <italic toggle="yes">Myoviridae</italic>, <italic toggle="yes">Siphoviridae</italic> and <italic toggle="yes">Podoviridae</italic> [<xref rid="pcbi.1011422.ref012" ref-type="bibr">12</xref>,<xref rid="pcbi.1011422.ref070" ref-type="bibr">70</xref>]. Following these changes in the viral taxonomy, we can assume that the majority of the viruses identified in the mentioned study were members of the class <italic toggle="yes">Caudoviricetes</italic>, as this new taxon groups all tailed viruses formerly classified in the three abolished families. The results obtained with VIRify confirmed this observation, as 52% of the contigs classified at the family rank were assigned to taxa within the class <italic toggle="yes">Caudoviricetes</italic>. Furthermore, the family <italic toggle="yes">Phycodnaviridae</italic> had been identified as one of the most abundant viral families in the marine samples, and the results obtained with VIRify confirmed this observation.</p>
    </sec>
    <sec id="sec023">
      <title>VIRify expanded the number of taxonomically classified VCs from the GPD and provided higher resolution classifications</title>
      <p>Genetically-related entries in the GPD had been previously sorted into 57,866 VCs, using a graph-based clustering approach [<xref rid="pcbi.1011422.ref034" ref-type="bibr">34</xref>]. Using the reported CheckV quality and completion values, we selected a representative sequence from each VC. According to the published GPD metadata, 7,432 of these representative sequences had been previously classified and 99% of them were reported as members of the abolished phage families <italic toggle="yes">Myoviridae</italic>, <italic toggle="yes">Siphoviridae</italic> and <italic toggle="yes">Podoviridae</italic>. We analysed the selected representative sequences with VIRify to assess whether our pipeline could provide updated taxonomic classifications for them.</p>
      <p>VIRify provided taxonomic classifications for 13,651 of the analysed representative sequences, which corresponds to an increase of 83.7% from the number reported previously. The vast majority of these classifications were to lineages within the class <italic toggle="yes">Caudoviricetes</italic> (98%), whereas most of the remaining sequences were classified in the families <italic toggle="yes">Iridoviridae</italic>, <italic toggle="yes">Microviridae</italic> and <italic toggle="yes">Herpesviridae</italic> (<bold><xref rid="pcbi.1011422.g006" ref-type="fig">Fig 6</xref></bold>).</p>
      <fig position="float" id="pcbi.1011422.g006">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011422.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>Taxonomic classification of representative sequences from the GPD.</title>
          <p>One representative sequence from each of the 57,866 VCs present in the GPD was selected based on their reported CheckV quality and completion values. The representative sequences were analysed with VIRify using the ‘—onlyannotate’ option to obtain taxonomic classifications for them. The taxa displayed in the Sankey plot correspond to those in which at least 10 representative sequences were classified.</p>
        </caption>
        <graphic xlink:href="pcbi.1011422.g006" position="float"/>
      </fig>
      <p>The families and subfamilies most commonly reported in the results include phages that target bacteria from the phyla Proteobacteria, Bacillota (i.e. Firmicutes) and Actinomycetota, all of which have been reported as common members of the human gut microbiome [<xref rid="pcbi.1011422.ref071" ref-type="bibr">71</xref>]. In particular, the families <italic toggle="yes">Drexlerviridae</italic>, <italic toggle="yes">Salasmaviridae</italic> and <italic toggle="yes">Herelleviridae</italic> have already been identified as frequent members of the human gut virome [<xref rid="pcbi.1011422.ref072" ref-type="bibr">72</xref>,<xref rid="pcbi.1011422.ref073" ref-type="bibr">73</xref>]. Interestingly, the sequences classified in the subfamilies <italic toggle="yes">Nymbaxtervirinae</italic> and <italic toggle="yes">Arquatrovirinae</italic> corresponded to putative phages targeting bacteria from either the Bacillota or Actinomycetota phyla. Previous studies have provided evidence indicating that phages targeting bacteria from these two phyla share a common ancestry, which hints at the possibility of cross-phyla phage-host interactions [<xref rid="pcbi.1011422.ref074" ref-type="bibr">74</xref>].</p>
    </sec>
    <sec id="sec024">
      <title>ViPhOG models comprehensively cover viral proteins</title>
      <p>Our comparison of virus-specific protein profile HMM databases included in VIRify showed that the ViPhOG models covered a large proportion of potentially viral CDS in agreement with the other databases (<xref rid="pcbi.1011422.g007" ref-type="fig">Fig 7A</xref>). In total, we predicted 1,204,455 CDSs from all high-confidence viral contigs that VIRify reported for the 243 TARA assemblies, of which the ViPhOGs covered 56.7% (49.4% with applied bit score threshold) and thus were only slightly outperformed by the VOGdb (56.8%). The largest set of shared annotations comprised 284,791 CDS annotated as viral based on models from all compared databases except the RVDB (<xref rid="pcbi.1011422.g007" ref-type="fig">Fig 7A</xref>). In addition, the RVDB had the least predictions, with only 15.3% annotated CDS compared to all other databases. Our model-specific bit score filtering reduces the amount of CDS annotations derived from ViPhOGs by 7.3% (87,869 CDS) (<xref rid="pcbi.1011422.g007" ref-type="fig">Fig 7A</xref>). While this might lead to the loss of potentially informative annotations that could be used for taxonomy assignment, we also remove false positive model hits, as shown in <xref rid="pcbi.1011422.g007" ref-type="fig">Fig 7B</xref>. Interestingly, the VPF derived from the IMG/VR database, which also includes novel viral sequences derived from metagenome approaches, comprises a large proportion of unique models that match 117,962 CDS (9.8%) that are not covered by any of the other annotated databases. On the other hand, a significant number of CDS are annotated by models from the other databases but missed by the VPF models.</p>
      <fig position="float" id="pcbi.1011422.g007">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011422.g007</object-id>
        <label>Fig 7</label>
        <caption>
          <p><bold>(A)</bold> Comparison of annotated CDS from VIRify’s high-confidence viral predictions from all 243 TARA Oceans assemblies. Our comparison shows that the ViPhOG models comprehensively cover a large proportion of potentially viral CDS in agreement with other public databases. The RVDB had the fewest predictions, with only 15.3% annotated CDS. Results of the VPF database, where models are derived from the IMG/VR database that also includes novel viral sequences derived from metagenome approaches, comprise a large proportion of unique models that exclusively match 117,962 CDS (9.8%) that are not covered by any of the other databases. However, a significant number of CDS are annotated by models from the other databases but missed by VPF. Our model-specific bit score filtering (ViPhOG—threshold) reduces the number of CDS annotations derived from ViPhOGs by 7.3% <bold>(B)</bold> Visualization of predicted (top row) and annotated ORFs for one exemplar contig from TARA Oceans assembly CEUI01. Grey bars indicate hits against an HMM of the corresponding database, while informative ViPhOG hits with taxonomic information are shown in green. The top ViPhOG track shows hits filtered by bit score (or e-value if no bit score could be assigned for a model, see <xref rid="sec002" ref-type="sec">Methods</xref>) and the bottom ViPhOG track shows e-value-filtered hits. <bold>(C)</bold> While the model-specific ViPhOG bit score threshold can lead to the loss of potentially informative annotations for taxonomy assignment, it can also reduce the number of false positive model hits and thus increase the overall accuracy of VIRify.</p>
        </caption>
        <graphic xlink:href="pcbi.1011422.g007" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec025">
    <title>Discussion</title>
    <p>Metagenomic surveys of different environments during the last few decades have had a profound impact on the rate at which novel viruses are discovered [<xref rid="pcbi.1011422.ref075" ref-type="bibr">75</xref>]. Despite the resulting sharp increase in the number of publicly available viral genomes, viruses remain relatively understudied in many environments and the taxonomic profiling of viral communities is still challenging due to the lack of universal genetic markers that support the phylogenetic resolution of viral taxa [<xref rid="pcbi.1011422.ref076" ref-type="bibr">76</xref>,<xref rid="pcbi.1011422.ref077" ref-type="bibr">77</xref>]. As a contribution to the currently available repertoire of tools designed to address these challenges, we designed and implemented the VIRify pipeline for detecting and taxonomically annotating viral contigs in metagenomic datasets.</p>
    <p>The results presented here for the mock community assemblies demonstrated that VIRify is a suitable pipeline for generating highly accurate taxonomic profiling of viral communities present in metagenomic datasets. Compared with most of the tools currently used for detecting viral contigs in metagenomic assemblies, VIRify demonstrated higher predictive performance for contigs ≥ 1.5 kb in both the Keiner and Neto assemblies (<bold>Figs <xref rid="pcbi.1011422.g003" ref-type="fig">3A</xref></bold>, <bold><xref rid="pcbi.1011422.s002" ref-type="supplementary-material">S2</xref></bold> and <bold><xref rid="pcbi.1011422.s003" ref-type="supplementary-material">S3</xref></bold>). Furthermore, using our manually-curated informative ViPhOGs led to the taxonomic classification of putative viral contigs from the Neto assembly with an accuracy of 94.2%. Regarding the Kleiner assembly, all classified putative viral contigs were assigned to the correct taxonomic lineages at different degrees of resolution, with some classified up to the family rank and others classified up to the genus rank. The pipeline also provided taxonomic classifications for putative prophages identified in contaminant bacterial contigs from both mock assemblies.</p>
    <p>VIRify’s viral prediction performance was the result of combining the effectiveness of VirSorter in predicting phage and prophage sequences [<xref rid="pcbi.1011422.ref051" ref-type="bibr">51</xref>,<xref rid="pcbi.1011422.ref078" ref-type="bibr">78</xref>], with the ability of PPR-Meta and VirFinder’s VF.modEPV_k8.rda model to predict sequences from eukaryotic viruses, as evidenced by their F1-scores for the Neto assembly (<bold><xref rid="pcbi.1011422.s002" ref-type="supplementary-material">S2 Fig</xref></bold>). Overall, most of the viral prediction tools evaluated here demonstrated a low performance for the Neto assembly, which indicates that these tools were mainly developed for the detection of phages and are not suited for the comprehensive detection of eukaryotic viral sequences. Considering that PPR-Meta was originally designed for detecting phages and plasmids [<xref rid="pcbi.1011422.ref056" ref-type="bibr">56</xref>] and that the Neto assembly mainly comprised eukaryotic viruses, it was striking to find that PPR-Meta was the tool that performed best for this assembly. Nonetheless, we decided to keep the combination of VirSorter, VirFinder and PPR-Meta as VIRify’s viral prediction approach for two main reasons. The first is that PPR-Meta’s underlying model was not explicitly trained to detect prophages in bacterial genomic sequences. As the detection of both free viruses and prophages was critical to the aim of providing comprehensive viral community profiling, we needed to include another viral detection tool capable of efficiently predicting prophages. VirSorter provides this functionality, as has been demonstrated by many previous studies in which it was employed to detect prophages in genome sequences from a diverse range of bacteria [<xref rid="pcbi.1011422.ref013" ref-type="bibr">13</xref>,<xref rid="pcbi.1011422.ref078" ref-type="bibr">78</xref>]. The second reason for not using PPR-Meta on its own is that, despite its high sensitivity, it tends to call a relatively higher number of false positives in comparison to other viral predictors [<xref rid="pcbi.1011422.ref079" ref-type="bibr">79</xref>]. Considering PPR-Meta’s performance on the mock community assemblies, we reasoned it would be advantageous to keep this tool within VIRify’s arsenal by combining its predictions with the ones obtained with VirFinder to limit the number of false positive predictions.</p>
    <p>Several studies have reported collections of profile HMMs for groups of orthologous viral genes, such as pVOGs [<xref rid="pcbi.1011422.ref067" ref-type="bibr">67</xref>], vFAMs [<xref rid="pcbi.1011422.ref080" ref-type="bibr">80</xref>], RVDB [<xref rid="pcbi.1011422.ref066" ref-type="bibr">66</xref>] and VOGdb (<ext-link xlink:href="http://vogdb.org/" ext-link-type="uri">http://vogdb.org/</ext-link>). Even though some of these have been employed for viral taxonomic profiling, our informative ViPhOGs stand out due to their bespoke bit score thresholds that were carefully selected to decrease the likelihood of false positive taxonomic assignments. As illustrated in <xref rid="pcbi.1011422.g007" ref-type="fig">Fig 7B</xref>, using the informative ViPhOGs with a single e-value threshold resulted in a higher chance of false positive taxonomic annotations, as was the case for contig seq28589 from the assembly of the TARA Oceans sample CEUI01 (study accession PRJEB7988). Therefore, our results indicate that using curated bit score thresholds offers an adequate balance between predictive power and classification accuracy. This strategy has been successfully implemented previously in Pfam and TIGRFAMs, some of the most widely used protein family databases for the functional annotation of genomes and metagenomes [<xref rid="pcbi.1011422.ref035" ref-type="bibr">35</xref>,<xref rid="pcbi.1011422.ref081" ref-type="bibr">81</xref>].</p>
    <p>Another novelty of our curated set of informative ViPhOGs is the use of TSR to set taxonomic assignment thresholds specific for each taxon. The TSR measures the density of assigned informative ViPhOGs for each taxon present in the viral lineages covered by our set of models. Thus, setting the taxonomic assignment threshold with this parameter allows the algorithm to adjust its level of stringency for each individual taxon. This feature is particularly advantageous for taxa characterised by relatively small genomes, for which there is a fewer number of informative ViPhOGs in our collection. This benefit was especially evident during the analysis of the Neto assembly, where the use of this feature increased the number of classified contigs from several of the eukaryotic viruses present in the mock community. A run of VIRify with the taxonomy assignment threshold set to 0.6 for all taxa resulted in the absence of short contigs (1,543–2,356 bp) classified in the subfamily <italic toggle="yes">Alphaherpesvirinae</italic> and the genus <italic toggle="yes">Rotavirus</italic>. This result indicates that the use of taxon-specific thresholds improves the detection of short contigs, by lowering the taxonomic assignment stringency.</p>
    <p>We further showed that VIRify can be applied to metagenomic assemblies obtained from large environmental studies, such as the TARA Oceans expedition [<xref rid="pcbi.1011422.ref012" ref-type="bibr">12</xref>,<xref rid="pcbi.1011422.ref017" ref-type="bibr">17</xref>,<xref rid="pcbi.1011422.ref018" ref-type="bibr">18</xref>]. In accordance with a previous report, a high proportion of predicted viruses could not be taxonomically classified into a known viral family [<xref rid="pcbi.1011422.ref012" ref-type="bibr">12</xref>]. However, the majority of contigs that VIRify classified were assigned to different families within the class <italic toggle="yes">Caudoviricetes</italic>, which agrees with the previous observation that most of the classified viruses in these samples were members of the former phage families <italic toggle="yes">Myoviridae</italic>, <italic toggle="yes">Siphoviridae</italic> or <italic toggle="yes">Podoviridae</italic>. Also in agreement with the previously reported study, the family <italic toggle="yes">Phycodnaviridae</italic> was one of the taxa most commonly identified by VIRify among the analysed marine samples. Interestingly, prasinoviruses were predominantly found in low confidence sets, thus, would have been missed by only running VirSorter on the data (<bold><xref rid="pcbi.1011422.g005" ref-type="fig">Fig 5B</xref></bold>). Here, our combination of VirFinder and PPR-Meta predictions helped to recover contigs that the pipeline could later taxonomically assign to this genus. Due to their larger size, prasinoviruses are underrepresented in smaller size fractionated samples, underlying the importance of appropriate filtering and enrichment steps and their combination to comprehensively collect viruses from environmental samples.</p>
    <p>The use of VIRify to analyse a set of representative sequences from the GPD resulted in a large increase in the number of taxonomically classified sequences (83.7%). The vast majority of the sequences were assigned to families and subfamilies within the class <italic toggle="yes">Caudoviricetes</italic>, which agrees with the former classifications reported in the GPD metadata. Furthermore, phages classified in the reported taxa have been previously found to target bacteria within some of the most frequently identified bacterial phyla in the human gut [<xref rid="pcbi.1011422.ref071" ref-type="bibr">71</xref>–<xref rid="pcbi.1011422.ref073" ref-type="bibr">73</xref>]. However, a few of the representative sequences were classified in the families <italic toggle="yes">Iridoviridae</italic> and <italic toggle="yes">Herpesviridae</italic>. Although the latter taxon has been reported as a frequent member of the human gut virome, it is likely that these results correspond to false positive assignments considering the phage sequence prediction approach followed in the generation of the GPD [<xref rid="pcbi.1011422.ref034" ref-type="bibr">34</xref>,<xref rid="pcbi.1011422.ref082" ref-type="bibr">82</xref>]. Nonetheless, the number of sequences assigned to these taxa corresponds to only 0.72% of the total number of representative sequences that VIRify classified. Overall, VIRify provided a more comprehensive and updated taxonomic characterisation of the viral sequences that comprise the GPD.</p>
    <p>Despite the great performance observed for the analysed assemblies, our results revealed a few limitations of the current VIRify pipeline. As evidenced by the analysis of the Neto assembly, VIRify’s ability to detect contigs from eukaryotic viruses is currently suboptimal. Increasing the pipeline’s sensitivity will require the careful evaluation of novel viral prediction tools that could easily be incorporated or used to replace the ones currently used. For example, VirSorter might be replaced by the recently released VirSorter2 [<xref rid="pcbi.1011422.ref083" ref-type="bibr">83</xref>] in a future version of VIRify. An additional limitation of VIRify is the existing bias in the extent to which the informative ViPhOGs represent the different genera in the current viral taxonomy. We determined that our current collection of informative ViPhOGs covers 38.6% of the lineages that comprise the current viral taxonomy, which has evidently decreased in comparison with the value calculated for the NCBI viral taxonomy from March 2020 (89.3%). This reduction in coverage reflects the substantial changes that the viral taxonomy has experienced since the ViPhOGs were generated. Our results demonstrate that the informative ViPhOGs are a powerful resource for the taxonomic classification of contigs from covered viral taxa, but it is imperative to generate new ViPhOGs that expand the taxonomic coverage to provide the community with a general-purpose viral analysis tool. This task will be central to the upcoming developments of VIRify. Finally, the quality of the metagenomic assembly is key for VIRify’s performance due to the challenge that short viral contigs pose on their detection by the viral prediction tools currently used in the pipeline (<bold><xref rid="pcbi.1011422.g003" ref-type="fig">Fig 3A</xref></bold>). Furthermore, short contigs will generally contain fewer complete CDS, and thus will be less likely to have the minimum number of ViPhOG hits required by the pipeline to provide a taxonomic assignment.</p>
    <p>VIRify is a novel HMM-based resource for viral taxonomic classification that can be broadly classified as a protein similarity-based method. There are other types of approaches that have been efficiently implemented for viral taxonomic profiling, such as the use of kmer matching to a reference database of complete phage genomes. Phanta, a recently developed tool for phage-inclusive gut microbiome profiling, takes advantage of a much larger number of phages discovered through extensive analyses of the human gut microbiome, in comparison with other biomes [<xref rid="pcbi.1011422.ref084" ref-type="bibr">84</xref>]. This tool uses a large database of gut phages and their associated taxonomic information to perform taxonomic profiling using kmer-based searches, which allows the analysis of phage communities from metagenomic reads. This is an advantage over methods that rely on metagenomic assemblies (such as VIRify) because the analysis of reads allows the detection of low-abundance phages that are difficult to assemble into contigs [<xref rid="pcbi.1011422.ref085" ref-type="bibr">85</xref>,<xref rid="pcbi.1011422.ref086" ref-type="bibr">86</xref>]. However, the advantage of using protein profile HMMs is that they gather viral reference data in a more efficient and compact way, in comparison with databases of complete genomes generally required by kmer-based methods. This is particularly relevant in the case of Phanta, which was designed to perform taxonomic profiling at the species level. Therefore, the combination of VIRify with a larger collection of ViPhOGs covering the entire viral taxonomy would be easier to implement as a general-purpose viral taxonomic profiling, than methods relying on the use of collections of complete reference genomes.</p>
    <p>Although VIRify has been benchmarked and validated with metagenomic data in mind, it is also possible to use the pipeline to detect RNA viruses in metatranscriptome assemblies (e.g. SARS-CoV-2, see [<xref rid="pcbi.1011422.ref087" ref-type="bibr">87</xref>]). Some additional considerations in this regard include 1) quality control, 2) assembly, 3) post-processing, and 4) classification. Some brief recommendations on how to prepare metatranscriptome assemblies and run them through VIRify can be found in the GitHub manual.</p>
    <p>Overall, our results demonstrated the utility of VIRify for analysing viral communities in metagenomic datasets. In contrast with other resources currently available, VIRify offers an enhanced capability to predict contigs from eukaryotic viruses and the ability to taxonomically classify viral contigs using a set of carefully curated HMMs and their bespoke bitscore thresholds. Future versions of VIRify will attempt to improve even further the sensitivity of viral contig prediction and to extend the ViPhOGs’ taxonomic coverage by including sequences from uncultured viruses. In addition, the taxonomic classification of contigs from small viruses could be improved by adjusting the taxonomic voting system to accommodate differences in the number of available informative ViPhOGs and in the average genome size observed between different viral lineages. VIRify will be fully integrated into the MGnify suite of metagenomic analyses hosted at the EMBL-EBI, which is continuously supported and updated to suit the needs of the scientific community.</p>
    <sec id="sec026">
      <title>Runtime and resources</title>
      <p>The pipeline runtime can vary significantly depending on the hardware and data size. For optimal performance, we recommend running VIRify on high-performance computing (HPC) systems or the cloud, especially for larger datasets. On a typical laptop with 8 cores, the pipeline runs reasonably fast for small datasets, such as the two mock community data sets, taking approximately 16 minutes for the Kleiner co-assembly and 30 minutes for the Neto co-assembly. However, for larger datasets like the 243 TARA Ocean assemblies, the pipeline requires 2 days and 13 hours on an HPC system with SLURM and the default configuration profile for cluster execution. This runtime estimate includes the execution time for each process, excluding database downloads. Keep in mind that the actual runtime can be influenced by factors such as fluctuation and pending jobs due to high demand on the HPC. The RAM requirements of the VIRify processes are generally low and can be run on a decent laptop (minimum 8 GB). Experienced users can adjust CPU and RAM resources in the Nextflow configuration to optimize performance on an HPC or cloud infrastructure. The disk space required by VIRify is generally reasonable compared to the input size. While Kleiner and Neto’s output folders comprised 130 and 270 MB, respectively, the full TARA run (including virus prediction and taxonomy assignment) required 174 GB. The GPD run, which skipped virus prediction and performed only CDS detection and taxonomy assignment, required 12 GB of storage. In addition, intermediate files in the Nextflow working directory can take up much space; for example, 263 GB of intermediate data were written to the work directory for all 243 TARA assemblies, while less than 1 GB of space was used for Kleiner and Neto.</p>
    </sec>
  </sec>
  <sec id="sec027" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1011422.s001" position="float" content-type="local-data">
      <label>S1 Fig</label>
      <caption>
        <title>Informative ViPhOGs’ coverage of viral taxonomy.</title>
        <p>Circular dendrograms showing the NCBI virus taxonomy from March 2020 (upper panel) and January 2023 (lower pannel), with taxa covered by informative ViPhOGs highlighted with either dots or bars, and using the same colour scheme as in <bold><xref rid="pcbi.1011422.g002" ref-type="fig">Fig 2</xref></bold>. For the taxonomic ranks (order, family and subfamily) dots were used to indicate whether any informative ViPhOGs were identified for the corresponding taxon. By contrast, bars were used for taxa in the genus rank (tree’s leaves) to indicate the number of different informative ViPhOGs identified for the corresponding genus, as indicated by the numeric scale in the outer rings.</p>
        <p>(PNG)</p>
      </caption>
      <media xlink:href="pcbi.1011422.s001.png">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011422.s002" position="float" content-type="local-data">
      <label>S2 Fig</label>
      <caption>
        <title>F-score comparison for virus prediction results from the Kleiner and Neto assemblies for all tools run via WtP and VIRify (combination of VirSorter, VirFinder with VF.modEPV_k8.rda model and PPR-Meta).</title>
        <p>(PNG)</p>
      </caption>
      <media xlink:href="pcbi.1011422.s002.png">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011422.s003" position="float" content-type="local-data">
      <label>S3 Fig</label>
      <caption>
        <title>UpSet output for the Neto assembly calculated with WtP.</title>
        <p>Viral prediction tools are compared and overlapping sets are shown.</p>
        <p>(PNG)</p>
      </caption>
      <media xlink:href="pcbi.1011422.s003.png">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011422.s004" position="float" content-type="local-data">
      <label>S4 Fig</label>
      <caption>
        <title>Abundance plot of viral ranks predicted for 243 TARA Oceans assemblies (<ext-link xlink:href="https://www.ebi.ac.uk/ena/browser/view/PRJEB22493" ext-link-type="uri">https://www.ebi.ac.uk/ena/browser/view/PRJEB22493</ext-link>) using the VIRify pipeline.</title>
        <p>Combined results for high confidence, low confidence, and putative prophage hits are shown. VIRify was run in v0.2 and with the—virome option and a contig length filtering of 5000 nt.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1011422.s004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>The authors thank Franziska Hufsky for improving the readability of the illustrations. The authors would also like to acknowledge Lorna Richardson for contributing to the edition of the final manuscript version.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1011422.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Bergh</surname><given-names>O</given-names></name>, <name><surname>Børsheim</surname><given-names>KY</given-names></name>, <name><surname>Bratbak</surname><given-names>G</given-names></name>, <name><surname>Heldal</surname><given-names>M</given-names></name>. <article-title>High abundance of viruses found in aquatic environments</article-title>. <source>Nature</source>. <year>1989</year><month>Aug</month><day>10</day>;<volume>340</volume>(<issue>6233</issue>):<fpage>467</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/340467a0</pub-id><?supplied-pmid 2755508?><pub-id pub-id-type="pmid">2755508</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Braga</surname><given-names>LPP</given-names></name>, <name><surname>Soucy</surname><given-names>SM</given-names></name>, <name><surname>Amgarten</surname><given-names>DE</given-names></name>, <name><surname>Silva</surname><given-names>AM da</given-names></name>, <name><surname>Setubal</surname><given-names>JC</given-names></name>. <article-title>Bacterial Diversification in the Light of the Interactions with Phages: The Genetic Symbionts and Their Role in Ecological Speciation.</article-title><source>Frontiers in Ecology and Evolution</source>. <year>2018</year>;<volume>6</volume>:<fpage>6</fpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Clokie</surname><given-names>MRJ</given-names></name>, <name><surname>Millard</surname><given-names>AD</given-names></name>, <name><surname>Letarov</surname><given-names>AV</given-names></name>, <name><surname>Heaphy</surname><given-names>S</given-names></name>. <article-title>Phages in nature</article-title>. <source>Bacteriophage</source>. <year>2011</year>;<volume>1</volume>(<issue>1</issue>):<fpage>31</fpage>–<lpage>45</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.4161/bact.1.1.14942</pub-id><?supplied-pmid 21687533?><pub-id pub-id-type="pmid">21687533</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Stern</surname><given-names>A</given-names></name>, <name><surname>Sorek</surname><given-names>R</given-names></name>. <article-title>The phage-host arms race: shaping the evolution of microbes</article-title>. <source>Bioessays</source>. <year>2011</year>;<volume>33</volume>(<issue>1</issue>):<fpage>43</fpage>–<lpage>51</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/bies.201000071</pub-id><?supplied-pmid 20979102?><pub-id pub-id-type="pmid">20979102</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Weinbauer</surname><given-names>MG</given-names></name>, <name><surname>Rassoulzadegan</surname><given-names>F</given-names></name>. <article-title>Are viruses driving microbial diversification and diversity?</article-title><source>Environ Microbiol</source>. <year>2004</year>;<volume>6</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>11</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1046/j.1462-2920.2003.00539.x</pub-id><?supplied-pmid 14686936?><pub-id pub-id-type="pmid">14686936</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Edwards</surname><given-names>RA</given-names></name>, <name><surname>Rohwer</surname><given-names>F</given-names></name>. <article-title>Viral metagenomics.</article-title><source>Nat Rev Microbiol [Internet].</source><year>2005</year>;<volume>3</volume>(<issue>6</issue>). Available from: <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nrmicro1163</pub-id><?supplied-pmid 15886693?><pub-id pub-id-type="pmid">15886693</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Reyes</surname><given-names>A</given-names></name>, <name><surname>Semenkovich</surname><given-names>NP</given-names></name>, <name><surname>Whiteson</surname><given-names>K</given-names></name>, <name><surname>Rohwer</surname><given-names>F</given-names></name>, <name><surname>Gordon</surname><given-names>JI</given-names></name>. <article-title>Going viral: next-generation sequencing applied to phage populations in the human gut</article-title>. <source>Nat Rev Microbiol</source>. <year>2012</year>;<volume>10</volume>(<issue>9</issue>):<fpage>607</fpage>–<lpage>17</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nrmicro2853</pub-id><?supplied-pmid 22864264?><pub-id pub-id-type="pmid">22864264</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Dutilh</surname><given-names>BE</given-names></name>, <name><surname>Cassman</surname><given-names>N</given-names></name>, <name><surname>McNair</surname><given-names>K</given-names></name>, <name><surname>Sanchez</surname><given-names>SE</given-names></name>, <name><surname>Silva</surname><given-names>GGZ</given-names></name>, <name><surname>Boling</surname><given-names>L</given-names></name>, <etal>et al</etal>. <article-title>A highly abundant bacteriophage discovered in the unknown sequences of human faecal metagenomes.</article-title><source>Nat Commun</source>. <year>2014</year>;<volume>5</volume>(<issue>1</issue>):<fpage>4498</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/ncomms5498</pub-id><?supplied-pmid 25058116?><pub-id pub-id-type="pmid">25058116</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Hurwitz</surname><given-names>BL</given-names></name>, <name><surname>One</surname><given-names>S</given-names></name>. <article-title>MB</article-title>. <source>The Pacific Ocean Virome (POV): a marine viral metagenomic dataset and associated protein clusters for quantitative viral ecology.</source><year>2013</year>; Available from: <pub-id pub-id-type="doi">10.1371/journal.pone.0057355</pub-id>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Reyes</surname><given-names>A</given-names></name>, <name><surname>Haynes</surname><given-names>M</given-names></name>, <name><surname>Hanson</surname><given-names>N</given-names></name>, <name><surname>Angly</surname><given-names>FE</given-names></name>, <name><surname>Heath</surname><given-names>AC</given-names></name>, <name><surname>Rohwer</surname><given-names>F</given-names></name>, <etal>et al</etal>. <article-title>Viruses in the faecal microbiota of monozygotic twins and their mothers</article-title>. <source>Nature</source>. <year>2010</year>;<volume>466</volume>(<issue>7304</issue>):<fpage>334</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature09199</pub-id><?supplied-pmid 20631792?><pub-id pub-id-type="pmid">20631792</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Roux</surname><given-names>S</given-names></name>, <name><surname>Enault</surname><given-names>F</given-names></name>, <name><surname>Robin</surname><given-names>A</given-names></name>, <name><surname>Ravet</surname><given-names>V</given-names></name>, <name><surname>One</surname><given-names>P</given-names></name>. <source>S. Assessing the diversity and specificity of two freshwater viral communities through metagenomics</source>. <year>2012</year>;</mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Gregory</surname><given-names>AC</given-names></name>, <name><surname>Zayed</surname><given-names>AA</given-names></name>, <name><surname>Conceição-Neto</surname><given-names>N</given-names></name>, <name><surname>Temperton</surname><given-names>B</given-names></name>, <name><surname>Bolduc</surname><given-names>B</given-names></name>, <name><surname>Alberti</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Marine DNA Viral Macro- and Microdiversity from Pole to Pole</article-title>. <source>Cell [Internet].</source><year>2019</year>; Available from: <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2019.03.040</pub-id><?supplied-pmid 31031001?><pub-id pub-id-type="pmid">31031001</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Paez-Espino</surname><given-names>D</given-names></name>, <name><surname>Eloe-Fadrosh</surname><given-names>EA</given-names></name>, <name><surname>Nature</surname><given-names>PGA</given-names></name>. <source>Uncovering Earth’s virome</source>. <year>2016</year>; Available from: <pub-id pub-id-type="doi">10.1038/nature19094</pub-id>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Shkoporov</surname><given-names>AN</given-names></name>, <name><surname>Clooney</surname><given-names>AG</given-names></name>, <name><surname>Sutton</surname><given-names>T</given-names></name>, <name><surname>Ryan</surname><given-names>FJ</given-names></name>, <name><surname>Daly</surname><given-names>KM</given-names></name>, <name><surname>Nolan</surname><given-names>JA</given-names></name>, <etal>et al</etal>. <article-title>The Human Gut Virome Is Highly Diverse, Stable, and Individual Specific.</article-title><source>Cell Host Microbe.</source><year>2019</year>;<volume>26</volume>(<issue>4</issue>):<fpage>527</fpage>–<lpage>41.e5.</lpage><comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.chom.2019.09.009</pub-id><?supplied-pmid 31600503?><pub-id pub-id-type="pmid">31600503</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Roux</surname><given-names>S</given-names></name>, <name><surname>Adriaenssens</surname><given-names>EM</given-names></name>, <name><surname>Dutilh</surname><given-names>BE</given-names></name>, <name><surname>Koonin</surname><given-names>EV</given-names></name>, <name><surname>Kropinski</surname><given-names>AM</given-names></name>, <name><surname>Krupovic</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Minimum Information about an Uncultivated Virus Genome (MIUViG).</article-title><source>Nat Biotechnol [Internet].</source><year>2018</year>; Available from: <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nbt.4306</pub-id><?supplied-pmid 30556814?><pub-id pub-id-type="pmid">30556814</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Breitbart</surname><given-names>M</given-names></name>, <name><surname>Bonnain</surname><given-names>C</given-names></name>, <name><surname>Malki</surname><given-names>K</given-names></name>, <name><surname>Sawaya</surname><given-names>NA</given-names></name>. <article-title>Phage puppet masters of the marine microbial realm</article-title>. <source>Nature Microbiology</source>. <year>2018</year>;<volume>3</volume>(<issue>7</issue>):<fpage>754</fpage>–<lpage>66</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41564-018-0166-y</pub-id><?supplied-pmid 29867096?><pub-id pub-id-type="pmid">29867096</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Roux</surname><given-names>S</given-names></name>, <name><surname>Brum</surname><given-names>JR</given-names></name>, <name><surname>Dutilh</surname><given-names>BE</given-names></name>, <name><surname>Sunagawa</surname><given-names>S</given-names></name>, <name><surname>Duhaime</surname><given-names>MB</given-names></name>, <name><surname>Loy</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Ecogenomics and potential biogeochemical impacts of globally abundant ocean viruses</article-title>. <source>Nature</source>. <year>2016</year>;<volume>537</volume>(<issue>7622</issue>):<fpage>689</fpage>–<lpage>93</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature19366</pub-id><?supplied-pmid 27654921?><pub-id pub-id-type="pmid">27654921</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Sunagawa</surname><given-names>S</given-names></name>, <name><surname>Acinas</surname><given-names>SG</given-names></name>, <name><surname>Bork</surname><given-names>P</given-names></name>, <name><surname>Bowler</surname><given-names>C</given-names></name>, <name><surname>Acinas</surname><given-names>SG</given-names></name>, <name><surname>Babin</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Tara Oceans: towards global ocean ecosystems biology</article-title>. <source>Nat Rev Microbiol</source>. <year>2020</year>;<volume>18</volume>(<issue>8</issue>):<fpage>428</fpage>–<lpage>45</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41579-020-0364-5</pub-id><?supplied-pmid 32398798?><pub-id pub-id-type="pmid">32398798</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Rohwer</surname><given-names>F</given-names></name>, <name><surname>Edwards</surname><given-names>R</given-names></name>. <article-title>The Phage Proteomic Tree: a genome-based taxonomy for phage</article-title>. <source>J Bacteriol</source>. <year>2002</year>;<volume>184</volume>(<issue>16</issue>):<fpage>4529</fpage>–<lpage>35</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1128/JB.184.16.4529-4535.2002</pub-id><?supplied-pmid 12142423?><pub-id pub-id-type="pmid">12142423</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Meier-Kolthoff</surname><given-names>JP</given-names></name>, <name><surname>Göker</surname><given-names>M</given-names></name>. <article-title>VICTOR: genome-based phylogeny and classification of prokaryotic viruses</article-title>. <source>Bioinformatics</source>. <year>2017</year>;<volume>33</volume>(<issue>21</issue>):<fpage>3396</fpage>–<lpage>404</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btx440</pub-id><?supplied-pmid 29036289?><pub-id pub-id-type="pmid">29036289</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Aiewsakun</surname><given-names>P</given-names></name>, <name><surname>Adriaenssens</surname><given-names>EM</given-names></name>, <name><surname>Lavigne</surname><given-names>R</given-names></name>, <name><surname>Kropinski</surname><given-names>AM</given-names></name>, <name><surname>Simmonds</surname><given-names>P</given-names></name>. <article-title>Evaluation of the genomic diversity of viruses infecting bacteria, archaea and eukaryotes using a common bioinformatic platform: steps towards a unified taxonomy</article-title>. <source>J Gen Virol</source>. <year>2018</year>;<volume>99</volume>(<issue>9</issue>):<fpage>1331</fpage>–<lpage>43</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1099/jgv.0.001110</pub-id><?supplied-pmid 30016225?><pub-id pub-id-type="pmid">30016225</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Jang</surname><given-names>H</given-names></name>, <name><surname>Bolduc</surname><given-names>B</given-names></name>, <name><surname>Zablocki</surname><given-names>O</given-names></name>, <name><surname>Kuhn</surname><given-names>JH</given-names></name>, <name><surname>Roux</surname><given-names>S</given-names></name>, <name><surname>Adriaenssens</surname><given-names>EM</given-names></name>, <etal>et al</etal>. <article-title>Taxonomic assignment of uncultivated prokaryotic virus genomes is enabled by gene-sharing networks</article-title>. <source>Nat Biotechnol</source>. <year>2019</year>;<fpage>1</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">30605152</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Chibani</surname><given-names>C</given-names></name>, <name><surname>Farr</surname><given-names>A</given-names></name>, <name><surname>Klama</surname><given-names>S</given-names></name>, <name><surname>Dietrich</surname><given-names>S</given-names></name>, <name><surname>Liesegang</surname><given-names>H</given-names></name>. <article-title>Classifying the Unclassified: A Phage Classification Method.</article-title><source>Viruses</source>. <year>2019</year>;<volume>11</volume>(<issue>2</issue>):<fpage>195</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3390/v11020195</pub-id><?supplied-pmid 30813498?><pub-id pub-id-type="pmid">30813498</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Moreno-Gallego</surname><given-names>JL</given-names></name>, <name><surname>Reyes</surname><given-names>A</given-names></name>. <article-title>Informative Regions In Viral Genomes.</article-title><source>Viruses</source>. <year>2021</year>;<volume>13</volume>(<issue>6</issue>):<fpage>1164</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3390/v13061164</pub-id><?supplied-pmid 34207030?><pub-id pub-id-type="pmid">34207030</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Bolduc</surname><given-names>B</given-names></name>, <name><surname>Youens-Clark</surname><given-names>K</given-names></name>, <name><surname>Roux</surname><given-names>S</given-names></name>, <name><surname>Hurwitz</surname><given-names>BL</given-names></name>, <name><surname>Sullivan</surname><given-names>MB</given-names></name>. <article-title>iVirus: facilitating new insights in viral ecology with software and community data sets imbedded in a cyberinfrastructure</article-title>. <source>ISME J</source>. <year>2017</year>;<volume>11</volume>(<issue>1</issue>):<fpage>7</fpage>–<lpage>14</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/ismej.2016.89</pub-id><?supplied-pmid 27420028?><pub-id pub-id-type="pmid">27420028</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Zheng</surname><given-names>T</given-names></name>, <name><surname>Li</surname><given-names>J</given-names></name>, <name><surname>Ni</surname><given-names>Y</given-names></name>, <name><surname>Kang</surname><given-names>K</given-names></name>, <name><surname>Misiakou</surname><given-names>MA</given-names></name>, <name><surname>Imamovic</surname><given-names>L</given-names></name>, <etal>et al</etal>. <article-title>Mining, analyzing, and integrating viral signals from metagenomic data.</article-title><source>Microbiome</source>. <year>2019</year>;<volume>7</volume>(<issue>1</issue>):<fpage>42</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s40168-019-0657-y</pub-id><?supplied-pmid 30890181?><pub-id pub-id-type="pmid">30890181</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Bolduc</surname><given-names>B</given-names></name>, <name><surname>Zablocki</surname><given-names>O</given-names></name>, <name><surname>Guo</surname><given-names>J</given-names></name>, <name><surname>Zayed</surname><given-names>AA</given-names></name>, <name><surname>Vik</surname><given-names>D</given-names></name>, <name><surname>Dehal</surname><given-names>P</given-names></name>, <etal>et al</etal>. <article-title>iVirus 2.0: Cyberinfrastructure-supported tools and data to power DNA virus ecology</article-title>. <source>ISME Communications</source>. <year>2021</year>;<volume>1</volume>(<issue>1</issue>):<fpage>77</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s43705-021-00083-3</pub-id><?supplied-pmid 36765102?><pub-id pub-id-type="pmid">36765102</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Roach</surname><given-names>MJ</given-names></name>, <name><surname>Beecroft</surname><given-names>SJ</given-names></name>, <name><surname>Mihindukulasuriya</surname><given-names>KA</given-names></name>, <name><surname>Wang</surname><given-names>L</given-names></name>, <name><surname>Paredes</surname><given-names>A</given-names></name>, <name><surname>Henry-Cocks</surname><given-names>K</given-names></name>, <etal>et al</etal>. <article-title>Hecatomb: An End-to-End Research Platform for Viral Metagenomics [Internet].</article-title><source>bioRxiv</source>. <year>2022</year> [cited 2023 Jul 9]. p. <fpage>2022</fpage>.05.15.492003. Available from: <ext-link xlink:href="https://www.biorxiv.org/content/10.1101/2022.05.15.492003v2" ext-link-type="uri">https://www.biorxiv.org/content/10.1101/2022.05.15.492003v2</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Pandolfo</surname><given-names>M</given-names></name>, <name><surname>Telatin</surname><given-names>A</given-names></name>, <name><surname>Lazzari</surname><given-names>G</given-names></name>, <name><surname>Adriaenssens</surname><given-names>EM</given-names></name>, <name><surname>Vitulo</surname><given-names>N</given-names></name>. <article-title>MetaPhage: an Automated Pipeline for Analyzing, Annotating, and Classifying Bacteriophages in Metagenomics Sequencing Data.</article-title><source>mSystems</source>. <year>2022</year><month>Oct</month><day>26</day>;<volume>7</volume>(<issue>5</issue>):<fpage>e0074122</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1128/msystems.00741-22</pub-id><?supplied-pmid 36069454?><pub-id pub-id-type="pmid">36069454</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Tommaso</surname><given-names>PD</given-names></name>, <name><surname>Chatzou</surname><given-names>M</given-names></name>, <name><surname>Floden</surname><given-names>EW</given-names></name>, <name><surname>Barja</surname><given-names>PP</given-names></name>, <name><surname>Palumbo</surname><given-names>E</given-names></name>, <name><surname>Notredame</surname><given-names>C</given-names></name>. <article-title>Nextflow enables reproducible computational workflows</article-title>. <source>Nat Biotechnol</source>. <year>2017</year>;<volume>35</volume>(<issue>4</issue>):<fpage>316</fpage>–<lpage>9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nbt.3820</pub-id><?supplied-pmid 28398311?><pub-id pub-id-type="pmid">28398311</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Mitchell</surname><given-names>AL</given-names></name>, <name><surname>Almeida</surname><given-names>A</given-names></name>, <name><surname>Beracochea</surname><given-names>M</given-names></name>, <name><surname>Boland</surname><given-names>M</given-names></name>, <name><surname>Burgin</surname><given-names>J</given-names></name>, <name><surname>Cochrane</surname><given-names>G</given-names></name>, <etal>et al</etal>. <article-title>MGnify: the microbiome analysis resource in 2020</article-title>. <source>Nucleic Acids Res</source>. <year>2019</year>;<volume>48</volume>(<issue>D1</issue>):<fpage>D570</fpage>–<lpage>8</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Kleiner</surname><given-names>M</given-names></name>, <name><surname>Hooper</surname><given-names>LV</given-names></name>, <name><surname>Duerkop</surname><given-names>BA</given-names></name>. <article-title>Evaluation of methods to purify virus-like particles for metagenomic sequencing of intestinal viromes</article-title>. <source>BMC Genomics</source>. <year>2015</year>;<volume>16</volume>:<fpage>7</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s12864-014-1207-4</pub-id><?supplied-pmid 25608871?><pub-id pub-id-type="pmid">25608871</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Conceição-Neto</surname><given-names>N</given-names></name>, <name><surname>Zeller</surname><given-names>M</given-names></name>, <name><surname>Lefrère</surname><given-names>H</given-names></name>, <name><surname>Bruyn</surname><given-names>P</given-names></name>, <name><surname>Beller</surname><given-names>L</given-names></name>, <name><surname>Deboutte</surname><given-names>W</given-names></name>, <etal>et al</etal>. <article-title>Modular approach to customise sample preparation procedures for viral metagenomics: a reproducible protocol for virome analysis.</article-title><source>Sci Rep</source>. <year>2015</year>;<volume>5</volume>(<issue>1</issue>):<fpage>16532</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/srep16532</pub-id><?supplied-pmid 26559140?><pub-id pub-id-type="pmid">26559140</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Camarillo-Guerrero</surname><given-names>LF</given-names></name>, <name><surname>Almeida</surname><given-names>A</given-names></name>, <name><surname>Rangel-Pineros</surname><given-names>G</given-names></name>, <name><surname>Finn</surname><given-names>RD</given-names></name>, <name><surname>Lawley</surname><given-names>TD</given-names></name>. <article-title>Massive expansion of human gut bacteriophage diversity</article-title>. <source>Cell</source>. <year>2021</year><month>Feb</month><day>18</day>;<volume>184</volume>(<issue>4</issue>):<fpage>1098</fpage>–<lpage>109.e9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2021.01.029</pub-id><?supplied-pmid 33606979?><pub-id pub-id-type="pmid">33606979</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Mistry</surname><given-names>J</given-names></name>, <name><surname>Chuguransky</surname><given-names>S</given-names></name>, <name><surname>Williams</surname><given-names>L</given-names></name>, <name><surname>Qureshi</surname><given-names>M</given-names></name>, <name><surname>Salazar</surname><given-names>GA</given-names></name>, <name><surname>Sonnhammer</surname><given-names>ELL</given-names></name>, <etal>et al</etal>. <article-title>Pfam: The protein families database in 2021</article-title>. <source>Nucleic Acids Res</source>. <year>2020</year>;<volume>49</volume>(<issue>D1</issue>):<fpage>gkaa913</fpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Huerta-Cepas</surname><given-names>J</given-names></name>, <name><surname>Serra</surname><given-names>F</given-names></name>, <name><surname>Bork</surname><given-names>P</given-names></name>. <article-title>ETE 3: Reconstruction, Analysis, and Visualization of Phylogenomic Data</article-title>. <source>Mol Biol Evol</source>. <year>2016</year>;<volume>33</volume>(<issue>6</issue>):<fpage>1635</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msw046</pub-id><?supplied-pmid 26921390?><pub-id pub-id-type="pmid">26921390</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Federhen</surname><given-names>S.</given-names></name><article-title>The NCBI Taxonomy database</article-title>. <source>Nucleic Acids Res</source>. <year>2012</year>;<volume>40</volume>(<issue>Database issue</issue>):<fpage>D136</fpage>–<lpage>43</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkr1178</pub-id><?supplied-pmid 22139910?><pub-id pub-id-type="pmid">22139910</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Letunic</surname><given-names>I</given-names></name>, <name><surname>Bork</surname><given-names>P</given-names></name>. <article-title>Interactive Tree Of Life (iTOL) v4: recent updates and new developments.</article-title><source>Nucleic Acids Res</source>. <year>2019</year>;<volume>47</volume>(<issue>W1</issue>):<fpage>gkz239</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkz239</pub-id><?supplied-pmid 30931475?><pub-id pub-id-type="pmid">30931475</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Mihara</surname><given-names>T</given-names></name>, <name><surname>Nishimura</surname><given-names>Y</given-names></name>, <name><surname>Shimizu</surname><given-names>Y</given-names></name>, <name><surname>Nishiyama</surname><given-names>H</given-names></name>, <name><surname>Yoshikawa</surname><given-names>G</given-names></name>, <name><surname>Uehara</surname><given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Linking Virus Genomes with Host Taxonomy.</article-title><source>Viruses</source>. <year>2016</year>;<volume>8</volume>(<issue>3</issue>):<fpage>66</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3390/v8030066</pub-id><?supplied-pmid 26938550?><pub-id pub-id-type="pmid">26938550</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>S</given-names></name>, <name><surname>Zhou</surname><given-names>Y</given-names></name>, <name><surname>Chen</surname><given-names>Y</given-names></name>, <name><surname>Gu</surname><given-names>J</given-names></name>. <article-title>fastp: an ultra-fast all-in-one FASTQ preprocessor</article-title>. <source>Bioinformatics</source>. <year>2018</year>;<volume>34</volume>(<issue>17</issue>):<fpage>i884</fpage>–<lpage>90</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/bty560</pub-id><?supplied-pmid 30423086?><pub-id pub-id-type="pmid">30423086</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Nurk</surname><given-names>S</given-names></name>, <name><surname>Meleshko</surname><given-names>D</given-names></name>, <name><surname>Korobeynikov</surname><given-names>A</given-names></name>, <name><surname>Pevzner</surname><given-names>PA</given-names></name>. <article-title>metaSPAdes: a new versatile metagenomic assembler</article-title>. <source>Genome Res</source>. <year>2017</year>;<volume>27</volume>(<issue>5</issue>):<fpage>824</fpage>–<lpage>34</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1101/gr.213959.116</pub-id><?supplied-pmid 28298430?><pub-id pub-id-type="pmid">28298430</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Gurevich</surname><given-names>A</given-names></name>, <name><surname>Saveliev</surname><given-names>V</given-names></name>, <name><surname>Vyahhi</surname><given-names>N</given-names></name>, <name><surname>Tesler</surname><given-names>G</given-names></name>. <article-title>QUAST: quality assessment tool for genome assemblies</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>(<issue>8</issue>):<fpage>1072</fpage>–<lpage>5</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btt086</pub-id><?supplied-pmid 23422339?><pub-id pub-id-type="pmid">23422339</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Marquet</surname><given-names>M</given-names></name>, <name><surname>Hölzer</surname><given-names>M</given-names></name>, <name><surname>Pletz</surname><given-names>MW</given-names></name>, <name><surname>Viehweger</surname><given-names>A</given-names></name>, <name><surname>Makarewicz</surname><given-names>O</given-names></name>, <name><surname>Ehricht</surname><given-names>R</given-names></name>, <etal>et al</etal>. <article-title>What the Phage: a scalable workflow for the identification and analysis of phage sequences.</article-title><source>Gigascience</source>. <year>2022</year>;<volume>11</volume>:<fpage>giac110</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/gigascience/giac110</pub-id><?supplied-pmid 36399058?><pub-id pub-id-type="pmid">36399058</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Ren</surname><given-names>J</given-names></name>, <name><surname>Song</surname><given-names>K</given-names></name>, <name><surname>Deng</surname><given-names>C</given-names></name>, <name><surname>Ahlgren</surname><given-names>NA</given-names></name>, <name><surname>Fuhrman</surname><given-names>JA</given-names></name>, <name><surname>Li</surname><given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Identifying viruses from metagenomic data using deep learning</article-title>. <source>Quantitative Biology</source>. <year>2020</year>;<volume>8</volume>(<issue>1</issue>):<fpage>64</fpage>–<lpage>77</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s40484-019-0187-4</pub-id><?supplied-pmid 34084563?><pub-id pub-id-type="pmid">34084563</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Amgarten</surname><given-names>D</given-names></name>, <name><surname>Braga</surname><given-names>LPP</given-names></name>, <name><surname>Silva</surname><given-names>AM da</given-names></name>, <name><surname>Setubal</surname><given-names>JC</given-names></name>. <article-title>MARVEL, a Tool for Prediction of Bacteriophage Sequences in Metagenomic Bins.</article-title><source>Front Genet</source>. <year>2018</year>;<volume>9</volume>:<fpage>304</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3389/fgene.2018.00304</pub-id><?supplied-pmid 30131825?><pub-id pub-id-type="pmid">30131825</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Jurtz</surname><given-names>VI</given-names></name>, <name><surname>Villarroel</surname><given-names>J</given-names></name>, <name><surname>Lund</surname><given-names>O</given-names></name>, <name><surname>Larsen</surname><given-names>MV</given-names></name>, <name><surname>Nielsen</surname><given-names>M</given-names></name>. <article-title>MetaPhinder—Identifying Bacteriophage Sequences in Metagenomic Data Sets.</article-title><source>PLoS One.</source><year>2016</year>;<volume>11</volume>(<issue>9</issue>):<fpage>e0163111</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0163111</pub-id><?supplied-pmid 27684958?><pub-id pub-id-type="pmid">27684958</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>Kieft</surname><given-names>K</given-names></name>, <name><surname>Zhou</surname><given-names>Z</given-names></name>, <name><surname>Anantharaman</surname><given-names>K</given-names></name>. <article-title>VIBRANT: automated recovery, annotation and curation of microbial viruses, and evaluation of viral community function from genomic sequences.</article-title><source>Microbiome</source>. <year>2020</year>;<volume>8</volume>(<issue>1</issue>):<fpage>90</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s40168-020-00867-0</pub-id><?supplied-pmid 32522236?><pub-id pub-id-type="pmid">32522236</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Abdelkareem</surname><given-names>AO</given-names></name>, <name><surname>Khalil</surname><given-names>MI</given-names></name>, <name><surname>Elbehery</surname><given-names>AHA</given-names></name>, <name><surname>Abbas</surname><given-names>HM</given-names></name>. <article-title>Viral Sequence Identification in Metagenomes using Natural Language Processing Techniques.</article-title><source>bioRxiv</source>. <year>2020</year>;<fpage>2020</fpage>.01.10.892158.</mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Starikova</surname><given-names>EV</given-names></name>, <name><surname>Tikhonova</surname><given-names>PO</given-names></name>, <name><surname>Prianichnikov</surname><given-names>NA</given-names></name>, <name><surname>Rands</surname><given-names>CM</given-names></name>, <name><surname>Zdobnov</surname><given-names>EM</given-names></name>, <name><surname>Ilina</surname><given-names>EN</given-names></name>, <etal>et al</etal>. <article-title>Phigaro: high-throughput prophage sequence annotation</article-title>. <source>Bioinformatics</source>. <year>2020</year>;<volume>36</volume>(<issue>12</issue>):<fpage>3882</fpage>–<lpage>4</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btaa250</pub-id><?supplied-pmid 32311023?><pub-id pub-id-type="pmid">32311023</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref050">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Pierce</surname><given-names>NT</given-names></name>, <name><surname>Irber</surname><given-names>L</given-names></name>, <name><surname>Reiter</surname><given-names>T</given-names></name>, <name><surname>Brooks</surname><given-names>P</given-names></name>, <name><surname>Brown</surname><given-names>CT</given-names></name>. <article-title>Large-scale sequence comparisons with sourmash.</article-title><source>F1000Res</source>. <year>2019</year>;<volume>8</volume>:<fpage>1006</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.12688/f1000research.19675.1</pub-id><?supplied-pmid 31508216?><pub-id pub-id-type="pmid">31508216</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref051">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Roux</surname><given-names>S</given-names></name>, <name><surname>Enault</surname><given-names>F</given-names></name>, <name><surname>Hurwitz</surname><given-names>BL</given-names></name>, <name><surname>Sullivan</surname><given-names>MB</given-names></name>. <article-title>VirSorter: mining viral signal from microbial genomic data.</article-title><source>PeerJ.</source><year>2015</year>;<volume>3</volume>:<fpage>e985</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.7717/peerj.985</pub-id><?supplied-pmid 26038737?><pub-id pub-id-type="pmid">26038737</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref052">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Arndt</surname><given-names>D</given-names></name>, <name><surname>Grant</surname><given-names>JR</given-names></name>, <name><surname>Marcu</surname><given-names>A</given-names></name>, <name><surname>Sajed</surname><given-names>T</given-names></name>, <name><surname>Pon</surname><given-names>A</given-names></name>, <name><surname>Liang</surname><given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>PHASTER: a better, faster version of the PHAST phage search tool</article-title>. <source>Nucleic Acids Res</source>. <year>2016</year>;<volume>44</volume>(<issue>W1</issue>):<fpage>W16</fpage>–<lpage>21</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkw387</pub-id><?supplied-pmid 27141966?><pub-id pub-id-type="pmid">27141966</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref053">
      <label>53</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>W</given-names></name>, <name><surname>Godzik</surname><given-names>A</given-names></name>. <article-title>Cd-hit: a fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title>. <source>Bioinformatics</source>. <year>2006</year>;<volume>22</volume>(<issue>13</issue>):<fpage>1658</fpage>–<lpage>9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btl158</pub-id><?supplied-pmid 16731699?><pub-id pub-id-type="pmid">16731699</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref054">
      <label>54</label>
      <mixed-citation publication-type="journal"><name><surname>Kurtz</surname><given-names>S</given-names></name>, <name><surname>Phillippy</surname><given-names>A</given-names></name>, <name><surname>Delcher</surname><given-names>AL</given-names></name>, <name><surname>Smoot</surname><given-names>M</given-names></name>, <name><surname>Shumway</surname><given-names>M</given-names></name>, <name><surname>Antonescu</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Versatile and open software for comparing large genomes</article-title>. <source>Genome Biol [Internet].</source><year>2004</year>;<volume>5</volume>(<issue>2</issue>). Available from: <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/gb-2004-5-2-r12</pub-id><?supplied-pmid 14759262?><pub-id pub-id-type="pmid">14759262</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref055">
      <label>55</label>
      <mixed-citation publication-type="journal"><name><surname>Ren</surname><given-names>J</given-names></name>, <name><surname>Ahlgren</surname><given-names>NA</given-names></name>, <name><surname>Lu</surname><given-names>YY</given-names></name>, <name><surname>Fuhrman</surname><given-names>JA</given-names></name>, <name><surname>Sun</surname><given-names>F</given-names></name>. <article-title>VirFinder: a novel k-mer based tool for identifying viral sequences from assembled metagenomic data.</article-title><source>Microbiome.</source><year>2017</year>;<volume>5</volume>(<issue>1</issue>):<fpage>69</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s40168-017-0283-5</pub-id><?supplied-pmid 28683828?><pub-id pub-id-type="pmid">28683828</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref056">
      <label>56</label>
      <mixed-citation publication-type="journal"><name><surname>Fang</surname><given-names>Z</given-names></name>, <name><surname>Tan</surname><given-names>J</given-names></name>, <name><surname>Wu</surname><given-names>S</given-names></name>, <name><surname>Li</surname><given-names>M</given-names></name>, <name><surname>Xu</surname><given-names>C</given-names></name>, <name><surname>Xie</surname><given-names>Z</given-names></name>, <etal>et al</etal>. <article-title>PPR-Meta: a tool for identifying phages and plasmids from metagenomic fragments using deep learning.</article-title><source>Gigascience [Internet].</source><year>2019</year>;<volume>8</volume>(<issue>6</issue>). Available from: <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/gigascience/giz066</pub-id><?supplied-pmid 31220250?><pub-id pub-id-type="pmid">31220250</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref057">
      <label>57</label>
      <mixed-citation publication-type="journal"><name><surname>Nayfach</surname><given-names>S</given-names></name>, <name><surname>Camargo</surname><given-names>AP</given-names></name>, <name><surname>Schulz</surname><given-names>F</given-names></name>, <name><surname>Eloe-Fadrosh</surname><given-names>E</given-names></name>, <name><surname>Roux</surname><given-names>S</given-names></name>, <name><surname>Kyrpides</surname><given-names>NC</given-names></name>. <article-title>CheckV assesses the quality and completeness of metagenome-assembled viral genomes</article-title>. <source>Nat Biotechnol</source>. <year>2021</year>;<volume>39</volume>(<issue>5</issue>):<fpage>578</fpage>–<lpage>85</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41587-020-00774-7</pub-id><?supplied-pmid 33349699?><pub-id pub-id-type="pmid">33349699</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref058">
      <label>58</label>
      <mixed-citation publication-type="journal"><name><surname>Hyatt</surname><given-names>D</given-names></name>, <name><surname>Chen</surname><given-names>GL</given-names></name>, <name><surname>LoCascio</surname><given-names>PF</given-names></name>, <name><surname>Land</surname><given-names>ML</given-names></name>, <name><surname>Larimer</surname><given-names>FW</given-names></name>, <name><surname>Hauser</surname><given-names>LJ</given-names></name>. <article-title>Prodigal: prokaryotic gene recognition and translation initiation site identification</article-title>. <source>BMC Bioinformatics</source>. <year>2010</year>;<volume>11</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>11</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1471-2105-11-119</pub-id><?supplied-pmid 20211023?><pub-id pub-id-type="pmid">20043860</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref059">
      <label>59</label>
      <mixed-citation publication-type="journal"><name><surname>González-Tortuero</surname><given-names>E</given-names></name>, <name><surname>Krishnamurthi</surname><given-names>R</given-names></name>, <name><surname>Allison</surname><given-names>HE</given-names></name>, <name><surname>Goodhead</surname><given-names>IB</given-names></name>, <name><surname>James</surname><given-names>CE</given-names></name>. <article-title>Comparative analysis of gene prediction tools for viral genome annotation</article-title>. <source>bioRxiv</source>. <year>2021</year>;<fpage>2021</fpage>.12.11.472104.</mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref060">
      <label>60</label>
      <mixed-citation publication-type="journal"><name><surname>Roux</surname><given-names>S</given-names></name>, <name><surname>Páez-Espino</surname><given-names>D</given-names></name>, <name><surname>Chen</surname><given-names>IMA</given-names></name>, <name><surname>Palaniappan</surname><given-names>K</given-names></name>, <name><surname>Ratner</surname><given-names>A</given-names></name>, <name><surname>Chu</surname><given-names>K</given-names></name>, <etal>et al</etal>. <article-title>IMG/VR v3: an integrated ecological and evolutionary framework for interrogating genomes of uncultivated viruses</article-title>. <source>Nucleic Acids Res</source>. <year>2020</year>;<volume>49</volume>(<issue>D1</issue>):<fpage>gkaa946</fpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref061">
      <label>61</label>
      <mixed-citation publication-type="journal"><name><surname>Potter</surname><given-names>SC</given-names></name>, <name><surname>Luciani</surname><given-names>A</given-names></name>, <name><surname>Eddy</surname><given-names>SR</given-names></name>, <name><surname>Park</surname><given-names>Y</given-names></name>, <name><surname>Lopez</surname><given-names>R</given-names></name>, <name><surname>Finn</surname><given-names>RD</given-names></name>. <article-title>HMMER web server: 2018 update</article-title>. <source>Nucleic Acids Res</source>. <year>2018</year>;<volume>46</volume>(<issue>W1</issue>):<fpage>W200</fpage>–<lpage>4</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gky448</pub-id><?supplied-pmid 29905871?><pub-id pub-id-type="pmid">29905871</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref062">
      <label>62</label>
      <mixed-citation publication-type="journal"><name><surname>Ondov</surname><given-names>BD</given-names></name>, <name><surname>Bergman</surname><given-names>NH</given-names></name>, <name><surname>Phillippy</surname><given-names>AM</given-names></name>. <article-title>Interactive metagenomic visualization in a Web browser</article-title>. <source>BMC Bioinformatics</source>. <year>2011</year>;<volume>12</volume>(<issue>1</issue>):<fpage>385</fpage>.<pub-id pub-id-type="pmid">21961884</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref063">
      <label>63</label>
      <mixed-citation publication-type="journal"><name><surname>Breitwieser</surname><given-names>FP</given-names></name>, <name><surname>Salzberg</surname><given-names>SL</given-names></name>. <article-title>Pavian: interactive analysis of metagenomics data for microbiome studies and pathogen identification</article-title>. <source>Bioinformatics</source>. <year>2019</year>;<volume>36</volume>(<issue>4</issue>):<fpage>1303</fpage>–<lpage>4</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref064">
      <label>64</label>
      <mixed-citation publication-type="journal"><name><surname>Anand</surname><given-names>L</given-names></name>, <name><surname>Lopez</surname><given-names>CMR</given-names></name>. <article-title>ChromoMap: an R package for interactive visualization of multi-omics data and annotation of chromosomes</article-title>. <source>BMC Bioinformatics</source>. <year>2022</year>;<volume>23</volume>(<issue>1</issue>):<fpage>33</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s12859-021-04556-z</pub-id><?supplied-pmid 35016614?><pub-id pub-id-type="pmid">35016614</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref065">
      <label>65</label>
      <mixed-citation publication-type="journal"><name><surname>Goodacre</surname><given-names>N</given-names></name>, <name><surname>Aljanahi</surname><given-names>A</given-names></name>, <name><surname>Nandakumar</surname><given-names>S</given-names></name>, <name><surname>Mikailov</surname><given-names>M</given-names></name>, <name><surname>Khan</surname><given-names>AS</given-names></name>. <article-title>A Reference Viral Database (RVDB) To Enhance Bioinformatics Analysis of High-Throughput Sequencing for Novel Virus Detection.</article-title><source>mSphere</source>. <year>2018</year>;<volume>3</volume>(<issue>2</issue>):<fpage>e00069</fpage>–<lpage>18</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1128/mSphereDirect.00069-18</pub-id><?supplied-pmid 29564396?><pub-id pub-id-type="pmid">29564396</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref066">
      <label>66</label>
      <mixed-citation publication-type="journal"><name><surname>Bigot</surname><given-names>T</given-names></name>, <name><surname>Temmam</surname><given-names>S</given-names></name>, <name><surname>Pérot</surname><given-names>P</given-names></name>, <name><surname>Eloit</surname><given-names>M</given-names></name>. <article-title>RVDB-prot, a reference viral protein database and its HMM profiles.</article-title><source>F1000Res</source>. <year>2019</year>;<volume>8</volume>:<fpage>530</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.12688/f1000research.18776.2</pub-id><?supplied-pmid 32983411?><pub-id pub-id-type="pmid">32983411</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref067">
      <label>67</label>
      <mixed-citation publication-type="journal"><name><surname>Grazziotin</surname><given-names>AL</given-names></name>, <name><surname>Koonin</surname><given-names>EV</given-names></name>, <name><surname>Kristensen</surname><given-names>DM</given-names></name>. <article-title>Prokaryotic Virus Orthologous Groups (pVOGs): a resource for comparative genomics and protein family annotation.</article-title><source>Nucleic Acids Res</source>. <year>2017</year>;<volume>45</volume>(<issue>D1</issue>):<fpage>D491</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkw975</pub-id><?supplied-pmid 27789703?><pub-id pub-id-type="pmid">27789703</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref068">
      <label>68</label>
      <mixed-citation publication-type="journal"><name><surname>Merkel</surname><given-names>D.</given-names></name><article-title>Docker: Lightweight Linux Containers for Consistent Development and Deployment [Internet].</article-title><source>Linux Journal.</source><year>2014</year> [cited 2023 Jul 4]. Available from: <ext-link xlink:href="https://www.linuxjournal.com/content/docker-lightweight-linux-containers-consistent-development-and-deployment" ext-link-type="uri">https://www.linuxjournal.com/content/docker-lightweight-linux-containers-consistent-development-and-deployment</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref069">
      <label>69</label>
      <mixed-citation publication-type="journal"><name><surname>Amstutz</surname><given-names>P</given-names></name>, <name><surname>Crusoe</surname><given-names>MR</given-names></name>, <name><surname>Tijanić</surname><given-names>N</given-names></name>, <name><surname>Chapman</surname><given-names>B</given-names></name>, <name><surname>Chilton</surname><given-names>J</given-names></name>, <name><surname>Heuer</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Common Workflow Language, v1.0 [Internet].</article-title><source>figshare</source>; <year>2016</year>. Available from: <ext-link xlink:href="https://research.manchester.ac.uk/files/57032693/cwl_1.0_workflow.pdf" ext-link-type="uri">https://research.manchester.ac.uk/files/57032693/cwl_1.0_workflow.pdf</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref070">
      <label>70</label>
      <mixed-citation publication-type="journal"><name><surname>Turner</surname><given-names>D</given-names></name>, <name><surname>Shkoporov</surname><given-names>AN</given-names></name>, <name><surname>Lood</surname><given-names>C</given-names></name>, <name><surname>Millard</surname><given-names>AD</given-names></name>, <name><surname>Dutilh</surname><given-names>BE</given-names></name>, <name><surname>Alfenas-Zerbini</surname><given-names>P</given-names></name>, <etal>et al</etal>. <article-title>Abolishment of morphology-based taxa and change to binomial species names: 2022 taxonomy update of the ICTV bacterial viruses subcommittee</article-title>. <source>Arch Virol</source>. <year>2023</year><month>Jan</month><day>23</day>;<volume>168</volume>(<issue>2</issue>):<fpage>74</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s00705-022-05694-2</pub-id><?supplied-pmid 36683075?><pub-id pub-id-type="pmid">36683075</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref071">
      <label>71</label>
      <mixed-citation publication-type="journal"><name><surname>Almeida</surname><given-names>A</given-names></name>, <name><surname>Mitchell</surname><given-names>AL</given-names></name>, <name><surname>Boland</surname><given-names>M</given-names></name>, <name><surname>Forster</surname><given-names>SC</given-names></name>, <name><surname>Gloor</surname><given-names>GB</given-names></name>, <name><surname>Tarkowska</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>A new genomic blueprint of the human gut microbiota</article-title>. <source>Nature</source>. <year>2019</year><month>Apr</month>;<volume>568</volume>(<issue>7753</issue>):<fpage>499</fpage>–<lpage>504</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41586-019-0965-1</pub-id><?supplied-pmid 30745586?><pub-id pub-id-type="pmid">30745586</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref072">
      <label>72</label>
      <mixed-citation publication-type="journal"><name><surname>Shen</surname><given-names>J</given-names></name>, <name><surname>Zhang</surname><given-names>J</given-names></name>, <name><surname>Mo</surname><given-names>L</given-names></name>, <name><surname>Li</surname><given-names>Y</given-names></name>, <name><surname>Li</surname><given-names>Y</given-names></name>, <name><surname>Li</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Large-scale phage cultivation for commensal human gut bacteria</article-title>. <source>Cell Host Microbe</source>. <year>2023</year><month>Apr</month><day>12</day>;<volume>31</volume>(<issue>4</issue>):<fpage>665</fpage>–<lpage>77.e7</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.chom.2023.03.013</pub-id><?supplied-pmid 37054680?><pub-id pub-id-type="pmid">37054680</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref073">
      <label>73</label>
      <mixed-citation publication-type="journal"><name><surname>Zuo</surname><given-names>W</given-names></name>, <name><surname>Michail</surname><given-names>S</given-names></name>, <name><surname>Sun</surname><given-names>F</given-names></name>. <article-title>Metagenomic Analyses of Multiple Gut Datasets Revealed the Association of Phage Signatures in Colorectal Cancer.</article-title><source>Front Cell Infect Microbiol</source>. <year>2022</year><month>Jun</month><day>15</day>;<volume>12</volume>:<fpage>918010</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3389/fcimb.2022.918010</pub-id><?supplied-pmid 35782128?><pub-id pub-id-type="pmid">35782128</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref074">
      <label>74</label>
      <mixed-citation publication-type="journal"><name><surname>Koert</surname><given-names>M</given-names></name>, <name><surname>López-Pérez</surname><given-names>J</given-names></name>, <name><surname>Mattson</surname><given-names>C</given-names></name>, <name><surname>Caruso</surname><given-names>S</given-names></name>, <name><surname>Erill</surname><given-names>I</given-names></name>. <article-title>Evidence for shared ancestry between Actinobacteria and Firmicutes bacteriophages.</article-title><source>Peer Community J.</source><year>2021</year><month>Nov</month><day>24</day>;<volume>1</volume>(<issue>e16</issue>):<fpage>1</fpage> –<lpage>None</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref075">
      <label>75</label>
      <mixed-citation publication-type="journal"><name><surname>Call</surname><given-names>L</given-names></name>, <name><surname>Nayfach</surname><given-names>S</given-names></name>, <name><surname>Kyrpides</surname><given-names>NC</given-names></name>. <article-title>Illuminating the Virosphere Through Global Metagenomics.</article-title><source>Annual Review of Biomedical Data Science</source>. <year>2021</year>;<volume>4</volume>(<issue>1</issue>):<fpage>369</fpage>–<lpage>91</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1146/annurev-biodatasci-012221-095114</pub-id><?supplied-pmid 34465172?><pub-id pub-id-type="pmid">34465172</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref076">
      <label>76</label>
      <mixed-citation publication-type="journal"><name><surname>Pratama</surname><given-names>AA</given-names></name>, <name><surname>van Elsas</surname><given-names>JD</given-names></name>. <article-title>The “Neglected” Soil Virome–Potential Role and Impact.</article-title><source>Trends Microbiol</source>. <year>2018</year>;<volume>26</volume>(<issue>8</issue>):<fpage>649</fpage>–<lpage>62</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.tim.2017.12.004</pub-id><?supplied-pmid 29306554?><pub-id pub-id-type="pmid">29306554</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref077">
      <label>77</label>
      <mixed-citation publication-type="journal"><name><surname>Dion</surname><given-names>MB</given-names></name>, <name><surname>Oechslin</surname><given-names>F</given-names></name>, <name><surname>Moineau</surname><given-names>S</given-names></name>. <article-title>Phage diversity, genomics and phylogeny</article-title>. <source>Nat Rev Microbiol</source>. <year>2020</year>;<fpage>1</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">31740776</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref078">
      <label>78</label>
      <mixed-citation publication-type="journal"><name><surname>Roux</surname><given-names>S</given-names></name>, <name><surname>Hallam</surname><given-names>SJ</given-names></name>, <name><surname>Woyke</surname><given-names>T</given-names></name>, <name><surname>Sullivan</surname><given-names>MB</given-names></name>. <article-title>Viral dark matter and virus–host interactions resolved from publicly available microbial genomes.</article-title><source>Elife</source>. <year>2015</year>;<volume>4</volume>:<fpage>e08490</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.7554/eLife.08490</pub-id><?supplied-pmid 26200428?><pub-id pub-id-type="pmid">26200428</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref079">
      <label>79</label>
      <mixed-citation publication-type="journal"><name><surname>Ho</surname><given-names>SFS</given-names></name>, <name><surname>Wheeler</surname><given-names>NE</given-names></name>, <name><surname>Millard</surname><given-names>AD</given-names></name>, <name><surname>van Schaik</surname><given-names>W</given-names></name>. <article-title>Gauge your phage: benchmarking of bacteriophage identification tools in metagenomic sequencing data.</article-title><source>Microbiome</source>. <year>2023</year><month>Apr</month><day>21</day>;<volume>11</volume>(<issue>1</issue>):<fpage>84</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s40168-023-01533-x</pub-id><?supplied-pmid 37085924?><pub-id pub-id-type="pmid">37085924</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref080">
      <label>80</label>
      <mixed-citation publication-type="journal"><name><surname>Skewes-Cox</surname><given-names>P</given-names></name>, <name><surname>Sharpton</surname><given-names>TJ</given-names></name>, <name><surname>Pollard</surname><given-names>KS</given-names></name>, <name><surname>DeRisi</surname><given-names>JL</given-names></name>. <article-title>Profile hidden Markov models for the detection of viruses within metagenomic sequence data.</article-title><source>PLoS One</source>. <year>2014</year>;<volume>9</volume>(<issue>8</issue>):<fpage>e105067</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0105067</pub-id><?supplied-pmid 25140992?><pub-id pub-id-type="pmid">25140992</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref081">
      <label>81</label>
      <mixed-citation publication-type="journal"><name><surname>Haft</surname><given-names>DH</given-names></name>, <name><surname>Loftus</surname><given-names>BJ</given-names></name>, <name><surname>Richardson</surname><given-names>DL</given-names></name>, <name><surname>Yang</surname><given-names>F</given-names></name>, <name><surname>Eisen</surname><given-names>JA</given-names></name>, <name><surname>Paulsen</surname><given-names>IT</given-names></name>, <etal>et al</etal>. <article-title>TIGRFAMs: a protein family resource for the functional identification of proteins</article-title>. <source>Nucleic Acids Res</source>. <year>2001</year>;<volume>29</volume>(<issue>1</issue>):<fpage>41</fpage>–<lpage>3</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/29.1.41</pub-id><?supplied-pmid 11125044?><pub-id pub-id-type="pmid">11125044</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref082">
      <label>82</label>
      <mixed-citation publication-type="journal"><name><surname>Liang</surname><given-names>G</given-names></name>, <name><surname>Bushman</surname><given-names>FD</given-names></name>. <article-title>The human virome: assembly, composition and host interactions</article-title>. <source>Nat Rev Microbiol</source>. <year>2021</year><month>Aug</month>;<volume>19</volume>(<issue>8</issue>):<fpage>514</fpage>–<lpage>27</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41579-021-00536-5</pub-id><?supplied-pmid 33785903?><pub-id pub-id-type="pmid">33785903</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref083">
      <label>83</label>
      <mixed-citation publication-type="journal"><name><surname>Guo</surname><given-names>J</given-names></name>, <name><surname>Bolduc</surname><given-names>B</given-names></name>, <name><surname>Zayed</surname><given-names>AA</given-names></name>, <name><surname>Varsani</surname><given-names>A</given-names></name>, <name><surname>Dominguez-Huerta</surname><given-names>G</given-names></name>, <name><surname>Delmont</surname><given-names>TO</given-names></name>, <etal>et al</etal>. <article-title>VirSorter2: a multi-classifier, expert-guided approach to detect diverse DNA and RNA viruses</article-title>. <source>Microbiome</source>. <year>2021</year>;<volume>9</volume>(<issue>1</issue>):<fpage>37</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s40168-020-00990-y</pub-id><?supplied-pmid 33522966?><pub-id pub-id-type="pmid">33522966</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref084">
      <label>84</label>
      <mixed-citation publication-type="journal"><name><surname>Pinto</surname><given-names>Y</given-names></name>, <name><surname>Chakraborty</surname><given-names>M</given-names></name>, <name><surname>Jain</surname><given-names>N</given-names></name>, <name><surname>Bhatt</surname><given-names>AS</given-names></name>. <article-title>Phage-inclusive profiling of human gut microbiomes with Phanta</article-title>. <source>Nat Biotechnol [Internet].</source><year>2023</year><month>May</month><day>25</day>; Available from: <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41587-023-01799-4</pub-id><?supplied-pmid 37231259?><pub-id pub-id-type="pmid">37231259</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref085">
      <label>85</label>
      <mixed-citation publication-type="journal"><name><surname>Rose</surname><given-names>R</given-names></name>, <name><surname>Constantinides</surname><given-names>B</given-names></name>, <name><surname>Tapinos</surname><given-names>A</given-names></name>, <name><surname>Robertson</surname><given-names>DL</given-names></name>, <name><surname>Prosperi</surname><given-names>M</given-names></name>. <article-title>Challenges in the analysis of viral metagenomes.</article-title><source>Virus Evol.</source><year>2016</year><month>Jul</month>;<volume>2</volume>(<issue>2</issue>):<fpage>vew022</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/ve/vew022</pub-id><?supplied-pmid 29492275?><pub-id pub-id-type="pmid">29492275</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref086">
      <label>86</label>
      <mixed-citation publication-type="journal"><name><surname>Bharti</surname><given-names>R</given-names></name>, <name><surname>Grimm</surname><given-names>DG</given-names></name>. <article-title>Current challenges and best-practice protocols for microbiome analysis</article-title>. <source>Brief Bioinform</source>. <year>2021</year><month>Jan</month><day>18</day>;<volume>22</volume>(<issue>1</issue>):<fpage>178</fpage>–<lpage>93</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bib/bbz155</pub-id><?supplied-pmid 31848574?><pub-id pub-id-type="pmid">31848574</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011422.ref087">
      <label>87</label>
      <mixed-citation publication-type="journal"><name><surname>Hufsky</surname><given-names>F</given-names></name>, <name><surname>Lamkiewicz</surname><given-names>K</given-names></name>, <name><surname>Almeida</surname><given-names>A</given-names></name>, <name><surname>Aouacheria</surname><given-names>A</given-names></name>, <name><surname>Arighi</surname><given-names>C</given-names></name>, <name><surname>Bateman</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Computational strategies to combat COVID-19: useful tools to accelerate SARS-CoV-2 and coronavirus research</article-title>. <source>Brief Bioinform</source>. <year>2020</year>;<volume>bbaa232</volume>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="aggregated-review-documents" id="pcbi.1011422.r001" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011422.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ouzounis</surname>
          <given-names>Christos A.</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Leitner</surname>
          <given-names>Thomas</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2023 Ouzounis, Leitner</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Ouzounis, Leitner</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1011422" id="rel-obj001" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">10 Jan 2023</named-content>
    </p>
    <p>Dear Dr Rangel-Piñeros,</p>
    <p>Thank you very much for submitting your manuscript "VIRify: an integrated detection, annotation and taxonomic classification pipeline using virus-specific protein profile hidden Markov models" for consideration at PLOS Computational Biology.</p>
    <p>As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. In light of the reviews (below this email), we would like to invite the resubmission of a significantly-revised version that takes into account the reviewers' comments, esp those by Reviewer 3.</p>
    <p>We cannot make any decision about publication until we have seen the revised manuscript and your response to the reviewers' comments. Your revised manuscript is also likely to be sent to reviewers for further evaluation.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Please prepare and submit your revised manuscript within 60 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. Please note that revised manuscripts received after the 60-day due date may require evaluation and peer review similar to newly submitted manuscripts.</p>
    <p>Thank you again for your submission. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Christos A. Ouzounis</p>
    <p>Academic Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Thomas Leitner</p>
    <p>Section Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Lucy Houghton</p>
    <p>Staff</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: The authors have addressed a large issue within the field, although issues remain with annotation, VIRify clearly competes well with other tools in the field.</p>
    <p>The fact that the authors have used two mock communities is great, although I do find the fact that comintamination within them is noted as a potential issue, troubling. Clearly better mocks are required in future studies, but I believe that to beyond the scope of this paper.</p>
    <p>Major issues;</p>
    <p>- The basis for the HMMs is the viral genomes from 2015, this is 7 years ago, meaning alot of diversity is missing. Is this something that can be easily updated? If not, this poses a major limitation which the authors should address in the text of the paper.</p>
    <p>- I see no justification for the 10% ViPhOG annotation cutoff or that atleast 2 hits are reported at a set level with 60% consistency. Please benchmark these factors to define why these thresholds are suitable.</p>
    <p>Reviewer #2: Rangel-Pineros et al are describing a pipeline "VIRify" that can detect viral contigs in a metagenomic assembly and perform taxonomy annotations using protein-similarity. The pipeline takes a pre-assembled set of contigs as an input and classifies them using a combination of several viral-detection software tools. Contigs classified as viral are further subjected to the taxonomy characterization: protein-coding ORFs are predicted for each contig and these ORFs are matched against a set of protein domain models (informative ViPhOGs) representative for different viral genera, families or orders. Authors validate their choice of software packages for each step of the pipeline and then benchmark it against 2 metagenomic datasets with experimentally known combinations of viruses/phages. Selection of protein-domain models ( informative ViPhOGs) is briefly described in the manuscript but has been previously published elsewhere.</p>
    <p>From the software perspective, "VIRify" adheres to the best practices: the pipeline is implemented using 2(!) Workflow management systems (nextflow and CWL), software packages VIRIfy relies on are containerized using docker/singularity for portability, documentations is thorough and contributors appear active on the github page of the repository.</p>
    <p>The manuscript itself is well written and easy to follow for the most part, although it could be shortened somewhat by skipping redundant descriptions and unnecessary details in the introduction (see below).</p>
    <p>I do have several comments that could help improve the manuscript:</p>
    <p>Major:</p>
    <p>1. Elaborate more on the significance of the “TARA Oceans'' analysis - right now it is unclear if ViRIfy provides novel insight into those datasets or if ViRIfy is valuable as a convenient tool/utility here ? Can “Massive expansion of human gut bacteriophage diversity” paper by some of the co-authors be used to strengthen the utility of VIRify’s approach ?</p>
    <p>2. Reading the “Selection and comparison of virus prediction tools” section in Methods 239-286, the choice of 3 viral detection software seems somewhat arbitrary - i.e. according to SFig2 PPR-Meta outperformed most of the other tools - why not use it alone ? Figure 3 helps answer that a bit, but then maybe there is another way to justify the choice of VirSorter, VirFinder, PPR-Meta ?</p>
    <p>Minor:</p>
    <p>1. Shortening of the manuscript would improve readability, here are several examples:</p>
    <p>a. 84-90 lytics vs lysogenic life cycles of phages - interesting - but in my opinion distracting</p>
    <p>b. Shorten ViPhOG related description that were covered in the previous publication - e.g. in the first section of “Results”</p>
    <p>2.Provide references to supplementary figures in “Selection and comparison of virus prediction tools” section</p>
    <p>3.It would be nice to include a paragraph on ViRify’s runtime expectations - i.e. how long it would run on a “typical” dataset, what hardware is recommended</p>
    <p>4.Several of the tools that VIRify depends on are deep learning based - do they require GPUs or CPU is sufficient? Do you take it into account for containerization ?</p>
    <p>5. Could you discuss an alternative approach of taxonomy classification based on “complete” viral genomes (e.g. as in “Phanta: Phage-inclusive profiling of human gut metagenomes” preprint by Pinto et al) - what are some advantages/limitations relative to protein-similarity based approach ?</p>
    <p>Reviewer #3: The manuscript by Rangel-Pineros and colleagues describes the creation of a new pipeline for virome analyses called VIRify. This pipeline is avalaible from GitHub as a Nextflow pipeline or CWL implementation. In brief, the pipeline uses either reads or assemblies, predicts which contigs are viral and provides a taxonomic classification using virus-specific protein profile HMMs derived from a separate study. The pipeline was tested on two virome mock communities and a TARA Oceans metagenomics study. The development included an analysis of the appropriateness of several different virus prediction tools using the “What the Phage” workflow (Marquet et al, 2022).</p>
    <p>VIRify has a great strength that makes it stand out from other pipelines, the use of the ViPhOGs, a well-curated set of 22,013 orthologous protein domains that are informative for virus taxonomy. Using this approach, viral contigs can be rapidly classified against the taxonomy associated with the ViPhOGs, regardless of the type of virus (eukaryotic, bacterial, archaeal) or genome type (DNA/RNA), as long as there are representative ViPhOGs in the database.</p>
    <p>This leads me into my main comment on the manuscript and pipeline, the taxonomy itself is outdated and wrong. On lines 209-2216, the authors write that the Virus-Host DB was used in November 2019 and the NCBI Taxonomy in March 2020. By the time this paper is published, the taxonomy will be at least four years out of date. The NCBI Taxonomy in March 2020 still used the taxonomy release issued by the International Committee on Taxonomy of Viruses in 2019, Master Species List MSL#34 (<ext-link xlink:href="https://ictv.global/taxonomy/history" ext-link-type="uri">https://ictv.global/taxonomy/history</ext-link>) which contains 14 orders, 150 families, 79 subfamilies, 1019 genera and 5560 species. In contrast, the current taxonomy release (MSL#37) comprises additional higher order taxa: 6 realms, 10 kingdoms, 17 phyla, 39 classes, 65 orders, 233 families, 2606 genera and 10434 species (Walker et al, 2022, table 1, <ext-link xlink:href="https://link.springer.com/article/10.1007/s00705-022-05516-5/tables/1" ext-link-type="uri">https://link.springer.com/article/10.1007/s00705-022-05516-5/tables/1</ext-link>). Importantly, this taxonomy release saw the removal of the bacteriophage families Myoviridae, Podoviridae and Siphoviridae which were not monophyletic, and the removal of the order Caudovirales in favour of the class Caudoviricetes, the taxa most commonly recovered from metagenome studies (see Fig 3 and 5 for example). In addition, many new families of archaeal viruses have been established since 2019, and entirely new phyla have been defined with viruses that had never before been classified.</p>
    <p>Since virus taxonomy is dynamic when new sets of viruses are discovered, any pipeline that claims to provide a taxonomic classification of viruses needs to be able to incorporate yearly updates to its taxonomy, or make clear disclaimers that the taxonomic classification is not up-to-date. In the case of VIRify, I presume updating the taxonomy could be achieved in a relatively straightforward way by remapping the ViPhOG database to the latest taxonomy database.</p>
    <p>A second concern related to the taxonomic assignments, is that this pipeline does not seem to have been tested or validated using existing complete virus genomes, only using mock community assemblies which could have many incomplete genome fragments (lines 360-363). In my opinion, it is important to understand how accurate the taxonomic predictions are in the most ideal situation, in order to understand the limitations of the pipeline.</p>
    <p>As part of this review, I have installed and run the pipeline on some test data and will be providing observations and some recommendations.</p>
    <p>Installation: I used an ubuntu virtual machine and used the nextflow install as was suggested on the GitHub page. Installation was seamless and quick. I tried a similar installation locally on a Mac using the terminal and ran into versioning issues with nextflow and the virify pipeline and abandoned this route.</p>
    <p>Running pipeline: I used a mock dataset of 5 complete bacteriophage genomes which were all similar to well-characterised phages but not necessarily identical. The pipeline ran very quickly and easily. I ran a second set of ~5000 contigs from a virome which finished overnight. No issues.</p>
    <p>Results of pipeline:</p>
    <p>Small dataset:</p>
    <p>Four out of the five bacteriophages, including the reference RNA phage MS2 were categorised as low confidence predictions in the first step of the pipeline. For me, this calls into question the thresholds that were used to categorise high confidence versus low confidence. Could the authors benchmark the virus detection categorisation with a set of known viruses from GenBank to see if the distinction between high-confidence and low-confidence needs to be made and what the best thresholds should be?</p>
    <p>Taken into account the outdated taxonomy database used, the taxonomic assignments of the phages were correct at the genus level for only 2 out of 5 phages. MS2 was correctly classified at the family level but no genus level classification. One phage was correctly assigned at the order level and one was unclassified. No incorrect assignments were made. However, low sensitivity at the genus and family level means that there is some optimisation required for the “voting system” or potentially an update to the ViPhOG database itself to include a more up-to-date set. For the smaller viruses, a threshold for at least two hits at the genus level (lines 352-353) may be too stringent. For example, most members of the phylum Cressdnaviricota only encode two proteins.</p>
    <p>Larger dataset:</p>
    <p>Of the ~5000 contigs that I considered potentially viral based on an internal dataset using VirSorter2 and VIBRANT, 921 were considered viral using VIRify. The decision to minimise false positives therefore may have a consequences for an increased amount of false negatives. I consider this a feature, rather than a bug, because it’s a decision that needs to be made in viromics research. However, I do suggest that the authors be clear about this in the manuscript and pipeline.</p>
    <p>The taxonomic assignments that were made were largely unclassified viruses (780) and the rest of them were assigned to the order Caudovirales. The family, subfamily and genus assignments appeared to be correct.</p>
    <p>Overall, I found the pipeline easy to work with and its outputs easy to understand and use. My assessment is that it favours specificity over sensitivity in both the virus detection and taxonomic assignments.</p>
    <p>In terms of the manuscript, my final comment is that the literature/introduction and discussion should be updated to account for pipelines and new tools that have been developed. The authors have already indicated that they may update the tool VirSorter to VirSorter2, but there is also an update of VirFinder to DeepVirFinder and new tools such as VIBRANT that have been developed since the authors started working on VIRify. Similarly, other pipelines have been published, for example MetaPhage and Hecatomb, and potentially others. I do not expect these to be benchmarked but they should at least be acknowledged in the introduction or discussion.</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>Reviewer #3: No</p>
    <p>
      <underline>Figure Files:</underline>
    </p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <underline><ext-link xlink:href="https://pacev2.apexcovantage.com/" ext-link-type="uri">https://pacev2.apexcovantage.com</ext-link></underline>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <underline><email>figures@plos.org</email></underline>.</p>
    <p>
      <underline>Data Requirements:</underline>
    </p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5" ext-link-type="uri">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>
      <underline>Reproducibility:</underline>
    </p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pcbi.1011422.r002">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011422.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1011422" id="rel-obj002" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">11 Jul 2023</named-content>
    </p>
    <supplementary-material id="pcbi.1011422.s005" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Response_to_reviewers.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1011422.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="aggregated-review-documents" id="pcbi.1011422.r003" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011422.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ouzounis</surname>
          <given-names>Christos A.</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Leitner</surname>
          <given-names>Thomas</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2023 Ouzounis, Leitner</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Ouzounis, Leitner</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1011422" id="rel-obj003" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">9 Aug 2023</named-content>
    </p>
    <p>Dear Dr Rangel-Piñeros,</p>
    <p>We are pleased to inform you that your manuscript 'VIRify: an integrated detection, annotation and taxonomic classification pipeline using virus-specific protein profile hidden Markov models' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Christos A. Ouzounis</p>
    <p>Academic Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Thomas Leitner </p>
    <p>Section Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #2: Authors have adequately addressed all of the questions that I've raised.</p>
    <p>I do recommend, however, reading-through newly added sections to improve readability/grammar. Here are a couple of examples of sentences that "sound off" :</p>
    <p>lines 886-888 - VIRify is a ... resource that joins a group of tools ... and **that** can be broadly classified as protein similarity-based methods -&gt; maybe change to ... and are broadly classified as ...</p>
    <p>Line 897, the advantage of using protein profile HMMs is that they allow **the gathering** of viral reference data in a more efficient and compact way - "gathering of viral references" - does it simply mean that viral reference data for protein profile HMMs can be stored in a more compact way ?</p>
    <p>Reviewer #3: No further comments.</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #2: No</p>
    <p>Reviewer #3: No</p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pcbi.1011422.r004" specific-use="acceptance-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011422.r004</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ouzounis</surname>
          <given-names>Christos A.</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Leitner</surname>
          <given-names>Thomas</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2023 Ouzounis, Leitner</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Ouzounis, Leitner</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1011422" id="rel-obj004" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">24 Aug 2023</named-content>
    </p>
    <p>PCOMPBIOL-D-22-01555R1 </p>
    <p>VIRify: an integrated detection, annotation and taxonomic classification pipeline using virus-specific protein profile hidden Markov models</p>
    <p>Dear Dr Rangel-Piñeros,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Zsofi Zombor</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link xlink:href="http://ploscompbiol.org" ext-link-type="uri">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
