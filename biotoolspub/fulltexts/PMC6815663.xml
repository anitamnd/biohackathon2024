<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PeerJ</journal-id>
    <journal-id journal-id-type="iso-abbrev">PeerJ</journal-id>
    <journal-id journal-id-type="pmc">PeerJ</journal-id>
    <journal-id journal-id-type="publisher-id">PeerJ</journal-id>
    <journal-title-group>
      <journal-title>PeerJ</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2167-8359</issn>
    <publisher>
      <publisher-name>PeerJ Inc.</publisher-name>
      <publisher-loc>San Diego, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6815663</article-id>
    <article-id pub-id-type="publisher-id">7838</article-id>
    <article-id pub-id-type="doi">10.7717/peerj.7838</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Neuroscience</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Anatomy and Physiology</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Psychiatry and Psychology</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Statistics</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Computational Science</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Unfold: an integrated toolbox for overlap correction, non-linear modeling, and regression-based EEG analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib id="author-1" contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-6276-3332</contrib-id>
        <name>
          <surname>Ehinger</surname>
          <given-names>Benedikt V.</given-names>
        </name>
        <xref ref-type="aff" rid="aff-1">1</xref>
        <xref ref-type="aff" rid="aff-2">2</xref>
        <email>behinger@uos.de</email>
      </contrib>
      <contrib id="author-2" contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-2507-2823</contrib-id>
        <name>
          <surname>Dimigen</surname>
          <given-names>Olaf</given-names>
        </name>
        <xref ref-type="aff" rid="aff-3">3</xref>
        <email>olaf.dimigen@hu-berlin.de</email>
      </contrib>
      <aff id="aff-1"><label>1</label><institution>Institute of Cognitive Science, Universität Osnabrück</institution>, <addr-line>Osnabrück</addr-line>, <country>Germany</country></aff>
      <aff id="aff-2"><label>2</label><institution>Donders Institute for Brain, Cognition and Behaviour, Radboud University</institution>, <addr-line>Nijmegen</addr-line>, <country>Netherlands</country></aff>
      <aff id="aff-3"><label>3</label><institution>Department of Psychology, Humboldt-Universität zu Berlin</institution>, <addr-line>Berlin</addr-line>, <country>Germany</country></aff>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Abdullah</surname>
          <given-names>Jafri</given-names>
        </name>
      </contrib>
    </contrib-group>
    <pub-date pub-type="epub" date-type="pub" iso-8601-date="2019-10-24">
      <day>24</day>
      <month>10</month>
      <year iso-8601-date="2019">2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>7</volume>
    <elocation-id>e7838</elocation-id>
    <history>
      <date date-type="received" iso-8601-date="2019-01-08">
        <day>8</day>
        <month>1</month>
        <year iso-8601-date="2019">2019</year>
      </date>
      <date date-type="accepted" iso-8601-date="2019-09-05">
        <day>5</day>
        <month>9</month>
        <year iso-8601-date="2019">2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2019 Ehinger and Dimigen</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>Ehinger and Dimigen</copyright-holder>
      <license xlink:href="https://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, reproduction and adaptation in any medium and for any purpose provided that it is properly attributed. For attribution, the original author(s), title, publication source (PeerJ) and either DOI or URL of the article must be cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="https://peerj.com/articles/7838"/>
    <abstract>
      <p>Electrophysiological research with event-related brain potentials (ERPs) is increasingly moving from simple, strictly orthogonal stimulation paradigms towards more complex, quasi-experimental designs and naturalistic situations that involve fast, multisensory stimulation and complex motor behavior. As a result, electrophysiological responses from subsequent events often overlap with each other. In addition, the recorded neural activity is typically modulated by numerous covariates, which influence the measured responses in a linear or non-linear fashion. Examples of paradigms where systematic temporal overlap variations and low-level confounds between conditions cannot be avoided include combined electroencephalogram (EEG)/eye-tracking experiments during natural vision, fast multisensory stimulation experiments, and mobile brain/body imaging studies. However, even “traditional,” highly controlled ERP datasets often contain a hidden mix of overlapping activity (e.g., from stimulus onsets, involuntary microsaccades, or button presses) and it is helpful or even necessary to disentangle these components for a correct interpretation of the results. In this paper, we introduce <italic>unfold</italic>, a powerful, yet easy-to-use MATLAB toolbox for regression-based EEG analyses that combines existing concepts of massive univariate modeling (“regression-ERPs”), linear deconvolution modeling, and non-linear modeling with the generalized additive model into one coherent and flexible analysis framework. The toolbox is modular, compatible with EEGLAB and can handle even large datasets efficiently. It also includes advanced options for regularization and the use of temporal basis functions (e.g., Fourier sets). We illustrate the advantages of this approach for simulated data as well as data from a standard face recognition experiment. In addition to traditional and non-conventional EEG/ERP designs, <italic>unfold</italic> can also be applied to other overlapping physiological signals, such as pupillary or electrodermal responses. It is available as open-source software at <uri xlink:href="http://www.unfoldtoolbox.org">http://www.unfoldtoolbox.org</uri>.</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>Overlap correction</kwd>
      <kwd>Generalized additive model</kwd>
      <kwd>Non-linear modeling</kwd>
      <kwd>Regression splines</kwd>
      <kwd>Regularization</kwd>
      <kwd>Regression-ERP</kwd>
      <kwd>Linear modeling of EEG</kwd>
      <kwd>ERP</kwd>
      <kwd>EEG</kwd>
      <kwd>Open source toolbox</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="fund-1">
        <funding-source>European Commission Horizon: H2020-FETPROACT-2014 364 641321-socSMCs</funding-source>
      </award-group>
      <award-group id="fund-2">
        <funding-source>DFG Research Group 868, project A2</funding-source>
      </award-group>
      <funding-statement>The project was supported by the European Commission Horizon (H2020-FETPROACT-2014 364 641321-socSMCs). The collection of the face dataset was supported by DFG Research Group 868, project A2. The funders had no role in the study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>Event-related brain responses in the electroencephalogram (EEG) are traditionally studied in strongly simplified and strictly orthogonal stimulus-response paradigms. In many cases, each experimental trial involves only a single, tightly controlled stimulation, and a single manual response. In recent years, however, there has been a rising interest in recording brain-electric activity also in more complex paradigms and naturalistic situations. Examples include laboratory studies with fast and concurrent streams of visual, auditory, and tactile stimuli (<xref rid="ref-65" ref-type="bibr">Spitzer, Blankenburg &amp; Summerfield, 2016</xref>), experiments that combine EEG recordings with eye-tracking recordings during natural vision (<xref rid="ref-21" ref-type="bibr">Dimigen et al., 2011</xref>), EEG studies in virtual reality (<xref rid="ref-25" ref-type="bibr">Ehinger et al., 2014</xref>) or mobile brain/body imaging studies that investigate real-world interactions of freely moving participants (<xref rid="ref-32" ref-type="bibr">Gramann et al., 2014</xref>). There are two main problems in these types of situations: overlapping neural responses from subsequent events and complex influences of nuisance variables that cannot be fully controlled. However, even traditional event-related brain potential (ERP) experiments often contain a mixture of overlapping neural responses, for example, from stimulus onsets, involuntary microsaccades, or manual button presses.</p>
    <p>Appropriate analysis of such datasets requires a paradigm shift away from simple averaging techniques towards more sophisticated, regression-based approaches (e.g., <xref rid="ref-2" ref-type="bibr">Amsel, 2011</xref>; <xref rid="ref-57" ref-type="bibr">Pernet et al., 2011</xref>; <xref rid="ref-63" ref-type="bibr">Smith &amp; Kutas, 2015b</xref>; <xref rid="ref-28" ref-type="bibr">Frömer, Maier &amp; Abdel Rahman, 2018</xref>; <xref rid="ref-37" ref-type="bibr">Hauk et al., 2006</xref>; <xref rid="ref-67" ref-type="bibr">Van Humbeeck et al., 2018</xref>) that can deconvolve overlapping potentials and also control or model the effects of both linear and non-linear covariates on the neural response. Importantly, the basic algorithms to deconvolve overlapping signals and to model the influences of both linear and non-linear covariates already exist. However, there is not yet a toolbox that integrates all of the necessary methods in one coherent workflow.</p>
    <p>In the present paper, we introduce <italic>unfold</italic>, an open source, easy-to-use, and flexible MATLAB toolbox written to facilitate the use of advanced deconvolution models and spline regression in ERP research. It performs these calculations efficiently even for large models and datasets and allows to run complex models with a few lines of codes. The toolbox is programed in a modular fashion, meaning that intermediate analysis steps can be readily inspected and modified by the user if needed. It is also fully documented, can employ regularization, can model both linear and non-linear effects using spline regression, and is compatible with EEGLAB (<xref rid="ref-18" ref-type="bibr">Delorme &amp; Makeig, 2004</xref>) a widely used toolbox to preprocess electrophysiological data that offers importers for many other biometric data formats, including eye-tracking and pupillometric data. <italic>unfold</italic> offers built-in functions to visualize the model coefficients (betas) of each predictor as waveforms or scalp topographies (i.e. “regression-ERPs,” rERPs, <xref rid="ref-7" ref-type="bibr">Burns et al., 2013</xref>; <xref rid="ref-62" ref-type="bibr">Smith &amp; Kutas, 2015a</xref>). Alternatively, results can be easily exported as plain text or transferred to other toolboxes like EEGLAB or Fieldtrip (<xref rid="ref-52" ref-type="bibr">Oostenveld et al., 2011</xref>). For statistical analyses at the group level, that is, second-level statistics, the resulting rERPs can be treated just like any other subject-level ERPs. As one suggestion, <italic>unfold</italic> integrates threshold-free cluster enhancement (TFCE) permutation tests for this purpose (<xref rid="ref-64" ref-type="bibr">Smith &amp; Nichols, 2009</xref>; <xref rid="ref-50" ref-type="bibr">Mensen &amp; Khatami, 2013</xref>).</p>
    <p>In the following, we first briefly summarize some key concepts of regression-based EEG analysis, with an emphasis on linear deconvolution, spline regression, and temporal basis functions. We then describe the <italic>unfold</italic> toolbox that combines these concepts into one coherent framework. Finally, we illustrate its application to simulated data as well as real data from a standard ERP experiment. In particular, we will go through the typical steps to run and analyze a deconvolution model, using the data of a standard face recognition ERP experiment that contains overlapping potentials from three different sources: from stimulus onsets, from button presses, and from microsaccades, small eye movements that were involuntarily made by the participants during the task. We also give detailed descriptions of the features of the toolbox, including practical recommendations, simulation results, and advanced features such as regularization options or the use of temporal basis functions. We hope that our toolbox will both improve the understanding of traditional EEG datasets (e.g., by separating stimulus- and response-related components) as well as facilitate electrophysiological analyses in complex or (quasi-)natural situations, such as in combined eye-tracking/EEG and mobile brain/body imaging studies.</p>
    <sec>
      <title>A simple simulation example</title>
      <p>Before we introduce a real dataset, let us first consider a simulated simple EEG/ERP study to illustrate the possibilities of the deconvolution approach. For this, let’s imagine a typical stimulus-discrimination task with two conditions (<xref ref-type="fig" rid="fig-1">Fig. 1</xref>): Participants are shown pictures of faces or houses and asked to classify the type of stimulus with a button press. Because this response is speeded, motor activity related to the preparation and execution of the manual response will overlap with the activity elicited by stimulus onset. Furthermore, we also assume that the mean reaction time (RTs) differs between the conditions, as it is the case in most experiments. In our example, if face pictures are on average classified faster than houses pictures (<xref ref-type="fig" rid="fig-1">Fig. 1C</xref>), then a different overlap between stimulus- and response-related potentials will be observed in the two conditions. Importantly, as <xref ref-type="fig" rid="fig-1">Fig. 1F</xref> shows, this will result in spurious conditions effects due to the varying temporal overlap alone, which can be easily mistaken for genuine differences in the brain’s processing of houses and faces.</p>
      <fig id="fig-1" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.7838/fig-1</object-id>
        <label>Figure 1</label>
        <caption>
          <title>A hypothetical simple ERP experiment with overlapping responses and a non-linear covariate.</title>
          <p>(A) A hypothetical simple ERP experiment with overlapping responses and a non-linear covariate. Data in this figure was simulated and then modeled with <italic>unfold</italic>. Participants saw pictures of faces or house and categorized them with a button press. (B) A short interval of the recorded EEG. Every stimulus onset and every button press elicits a brain response (isolated responses). However, because brain responses to the stimulus overlap with that to the response, we can only observe the sum of the overlapping responses in the EEG (upper row). (C) Because humans are experts for faces, we assume here that they reacted faster to faces than houses, meaning that the overlap with the preceding stimulus-onset ERP is larger in the face than house condition. (D) Furthermore, we assume that faces and house stimuli were not perfectly matched in terms of all other stimulus properties (e.g., spectrum, size, shape). For this example, let us simply assume that they differed in mean luminance. (E) The N170 component of the ERP is typically larger for faces than houses. In addition, however, the higher luminance alone increases the amplitude of the visual P1 component of the ERP. Because luminance is slightly higher for faces and houses, this will result in a spurious condition difference. (F) Average ERP for faces and houses, without deconvolution modeling. In addition to the genuine N170 effect (larger N170 for faces), we can see various spurious differences, caused by overlapping responses and the luminance difference. (G) Linear deconvolution corrects for the effects of overlapping potentials. (H) To also remove the confounding luminance effect, we need to also include this predictor in the model. Now we are able to only recover the true N170 effect without confounds (a similar figure was used in <xref rid="ref-20" ref-type="bibr">Dimigen &amp; Ehinger, 2019</xref>).</p>
        </caption>
        <graphic xlink:href="peerj-07-7838-g001"/>
      </fig>
      <p>Human faces are also complex, high-dimensional stimuli with numerous properties that are difficult to perfectly control and orthogonalize in any given study. For simplicity, we assume here that the average luminance of the stimuli was not perfectly matched between conditions and is slightly, but systematically, higher for faces than houses (<xref ref-type="fig" rid="fig-1">Fig. 1D</xref>). From previous studies, we know that the amplitude of the P1 visually-evoked potential increases as a non-linear (log) function of the luminance of the presented stimulus (<xref rid="ref-34" ref-type="bibr">Halliday, 1982</xref>), and thus we also simulate a logarithmic effect of luminance on the P1 of the stimulus-aligned ERP (<xref ref-type="fig" rid="fig-1">Fig. 1E</xref>), which creates another spurious condition difference (<xref ref-type="fig" rid="fig-1">Fig. 1G</xref>) in addition to that of varying response times (<xref ref-type="fig" rid="fig-1">Fig. 1F</xref>).</p>
      <p><xref ref-type="fig" rid="fig-1">Figures 1G</xref> and <xref ref-type="fig" rid="fig-1">1H</xref> show the same data modeled with <italic>unfold</italic>. Fortunately, with deconvolution modeling, we can not only remove the overlap effect (<xref ref-type="fig" rid="fig-1">Fig. 1G</xref>), but by including luminance as a non-linear predictor, we simultaneously also control the influence of this covariate (<xref ref-type="fig" rid="fig-1">Fig. 1H</xref>). How this is done is explained in more detail in the following.</p>
    </sec>
    <sec>
      <title>Existing deconvolution approaches</title>
      <p>Deconvolution methods for EEG have existed for some time (<xref rid="ref-35" ref-type="bibr">Hansen, 1983</xref>; <xref rid="ref-26" ref-type="bibr">Eysholdt &amp; Schreiner, 1982</xref>), but most older deconvolution approaches show severe limitations in their applicability. They are either restricted to just two different events (<xref rid="ref-35" ref-type="bibr">Hansen, 1983</xref>; <xref rid="ref-77" ref-type="bibr">Zhang, 1998</xref>), require special stimulus sequences (<xref rid="ref-26" ref-type="bibr">Eysholdt &amp; Schreiner, 1982</xref>; <xref rid="ref-49" ref-type="bibr">Marsh, 1992</xref>; <xref rid="ref-17" ref-type="bibr">Delgado &amp; Ozdamar, 2004</xref>; <xref rid="ref-39" ref-type="bibr">Jewett et al., 2004</xref>; <xref rid="ref-70" ref-type="bibr">Wang et al., 2006</xref>), rely on semi-automatic, iterative methods like ADJAR (<xref rid="ref-73" ref-type="bibr">Woldorff, 1993</xref>) that can be slow or difficult to converge (<xref rid="ref-66" ref-type="bibr">Talsma &amp; Woldorff, 2004</xref>; <xref rid="ref-42" ref-type="bibr">Kristensen, Rivet &amp; Guérin-Dugué, 2017b</xref>), or were tailored for special applications. In particular, the specialized RIDE algorithm (<xref rid="ref-54" ref-type="bibr">Ouyang et al., 2011</xref>; <xref rid="ref-55" ref-type="bibr">Ouyang, Sommer &amp; Zhou, 2015</xref>) offers a unique feature in that it is able to deconvolve time-jittered ERP components even in the absence of a designated event marker. However, while RIDE has been successfully used to separate stimulus- and response-related ERP components (<xref rid="ref-54" ref-type="bibr">Ouyang et al., 2011</xref>; <xref rid="ref-55" ref-type="bibr">Ouyang, Sommer &amp; Zhou, 2015</xref>), it does not support continuous predictors and is intended for a small number of overlapping events.</p>
      <p>In recent years, an alternative deconvolution method based on the linear model has been proposed and successfully applied to the overlap problem (<xref rid="ref-47" ref-type="bibr">Lütkenhöner, 2010</xref>; <xref rid="ref-14" ref-type="bibr">Dandekar et al., 2012a</xref>; <xref rid="ref-44" ref-type="bibr">Litvak et al., 2013</xref>; <xref rid="ref-65" ref-type="bibr">Spitzer, Blankenburg &amp; Summerfield, 2016</xref>; <xref rid="ref-41" ref-type="bibr">Kristensen, Rivet &amp; Guérin-Dugué, 2017a</xref>, <xref rid="ref-42" ref-type="bibr">2017b</xref>; <xref rid="ref-60" ref-type="bibr">Sassenhagen, 2018</xref>; <xref rid="ref-11" ref-type="bibr">Cornelissen, Sassenhagen &amp; Võ, 2019</xref>; <xref rid="ref-9" ref-type="bibr">Coco, Nuthmann &amp; Dimigen, 2018</xref>; <xref rid="ref-5" ref-type="bibr">Bigdely-Shamlo et al., 2018</xref>; <xref rid="ref-20" ref-type="bibr">Dimigen &amp; Ehinger, 2019</xref>). This deconvolution approach was first applied extensively to fMRI data (<xref rid="ref-13" ref-type="bibr">Dale &amp; Buckner, 1997</xref>) where the slowly varying BOLD signal overlaps between subsequent events. However, in fMRI, the shape of the BOLD response is well-known and this prior knowledge allows the researcher to use model-based deconvolution. If no assumptions about the response shape (i.e., the kernel) are made, the approach used in fMRI is closely related to the basic linear deconvolution approach discussed below.</p>
    </sec>
    <sec>
      <title>Deconvolution within the linear model</title>
      <p>With deconvolution techniques, overlapping EEG activity is understood as the linear convolution of experimental event latencies with isolated neural responses (<xref ref-type="fig" rid="fig-1">Fig. 1B</xref>). The inverse operation is deconvolution, which recovers the unknown isolated neural responses given only the measured (convolved) EEG and the latencies of the experimental events (<xref ref-type="fig" rid="fig-1">Fig. 1H</xref>). Deconvolution is possible if the subsequent events in an experiment occur with varying temporal overlap, in a varying temporal sequence, or both. In classical experiments, stimulus-onset asynchronies and stimulus sequences can be varied experimentally and the latencies of motor actions (such as saccades or button presses) also vary naturally. This varying overlap allows for modeling of the unknown isolated responses, assuming that the overlapping signals add up linearly. More specifically, we assume (1) that the electrical fields generated by the brain sum linearly (a justified assumption, see <xref rid="ref-51" ref-type="bibr">Nunez &amp; Srinivasan, 2006</xref>) and (2) that the overlap, or interval between events, does not influence the computations occurring in the brain—and therefore the underlying waveforms (see also Discussion).</p>
      <p>The benefits of this approach are numerous: The experimental design is not restricted to special stimulus sequences, multiple regression allows modeling of an arbitrary number of different events, and the mathematical properties of the linear model are well understood.</p>
    </sec>
    <sec>
      <title>Linear deconvolution</title>
      <p>The classic massive univariate linear model, <italic>without</italic> overlap correction, is applied to epoched EEG data and can be written as:
<disp-formula id="eqn-1"><alternatives><graphic xlink:href="peerj-07-7838-e001.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$${{\rm{\mu }}_{i,{\rm{\tau }}}} = {X_i}{{\rm{\beta }}_{\rm{\tau }}}\,{\rm{with}}\,{y_{i,{\rm{\tau }}}}\,{\rm{\sim}}\,{\rm{normal(}}{{\rm{\mu }}_{{\rm{i,\tau }}}}{\rm{,}}{{\rm{\sigma }}_{\rm{\tau }}}{\rm{)}}$$\end{document}</tex-math><mml:math id="mml-eqn-1"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mi>τ</mml:mi></mml:msub><mml:mtext> with </mml:mtext><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>∼</mml:mo><mml:mtext>normal</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>τ</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>Here, <italic>X</italic> is the design matrix. It has <italic>i</italic> rows (each describing one instance of an event of type e) and c columns (each describing the status of one predictor).</p>
      <p>Furthermore, let τ be the “local time” relative to onset of the event (e.g., −100 to +500 sampling points). μ<sub><italic>i</italic>,τ</sub> is the expected (average) EEG signal measured after event <italic>i</italic> that we wish to predict at a given time point τ relative to the event onset. β is a vector of unknown parameters that we wish to estimate for each time point in the epoched EEG data. Importantly, therefore, this approach fits a separate linear model at each time point τ. A single entry in the design matrix will be referred by lowercase <italic>x<sub>i</sub></italic><sub>,<italic>c</italic></sub>.</p>
      <p>In contrast, with linear deconvolution we enter the continuous EEG data into the model. We then make use of the knowledge that each observed sample of the continuous EEG can be described as the linear sum of (possibly) several overlapping event-related EEG responses. Depending on the latencies of the neighboring events, these overlapping responses occur at different times τ relative to the current event (see <xref ref-type="fig" rid="fig-2">Fig. 2</xref>). That is, in the example in <xref ref-type="fig" rid="fig-2">Fig. 2</xref>, where the responses of two types of events, A and B, overlap with each other, the observed continuous EEG at time point <italic>t</italic> of the continuous EEG recording can be described as follows:<disp-formula id="eqn-2"><alternatives><graphic xlink:href="peerj-07-7838-e002.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$${\rm{EE}}{{\rm{G}}_{t = 25}} = 1{{\rm{\beta }}_{A,1}} + 0{{\rm{\beta }}_{A,2}} + 0{{\rm{\beta }}_{A,3}} + 0{{\rm{\beta }}_{A,4}} + 1{{\rm{\beta }}_{A,5}} + 0{{\rm{\beta }}_{B,1}} + 0{{\rm{\beta }}_{B,2}} + 0{{\rm{\beta }}_{B,3}} + 1{{\rm{\beta }}_{B,4}} + 0{{\rm{\beta }}_{B,5}}$$\end{document}</tex-math><mml:math id="mml-eqn-2"><mml:mrow><mml:msub><mml:mrow><mml:mtext>EEG</mml:mtext></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>0</mml:mn><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>0</mml:mn><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>0</mml:mn><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>0</mml:mn><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>0</mml:mn><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>0</mml:mn><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>0</mml:mn><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></disp-formula></p>
      <fig id="fig-2" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.7838/fig-2</object-id>
        <label>Figure 2</label>
        <caption>
          <title>Linear deconvolution by time expansion.</title>
          <p>Linear deconvolution explains the continuous (toy) EEG signal within a single regression model. Specifically, we want to estimate the response (betas) evoked by each event so that together, they best explain the observed EEG. For this purpose, we create a time-expanded version of the design matrix (<italic>X</italic><sub>dc</sub>) in which a number of time points around each event (here: only 5 points) are added as predictors. We then solve the model for b, the betas. For instance, in the model above, sample number 25 of the continuous EEG recording can be explained by the sum of responses to three different experimental events: the response to a first event of type “A” (at time point 5 after that event), by the response to an event of type “B” (at time 4 after that event) and by a second occurrence of an event of type “A” (at time 1 after that event). Because the sequences of events and their temporal distances vary throughout the experiment, it is possible to find a unique solution for the betas that best explains the measured EEG signal. These betas, or “regression-ERPs” can then be plotted and analyzed like conventional ERP waveforms. Figure adapted from <xref rid="ref-20" ref-type="bibr">Dimigen &amp; Ehinger (2019</xref>, with permission).</p>
        </caption>
        <graphic xlink:href="peerj-07-7838-g002"/>
      </fig>
      <p>In the example in <xref ref-type="fig" rid="fig-2">Fig. 2</xref>, the spontaneous EEG at time-point <italic>t</italic> is modeled as the linear sum of a to-be-estimated response to the first instance of event type A at local time τ = 5 (i.e., from the point of view of EEG(<italic>t</italic>) this instance occurred 5 time samples before), another response to the second instance of event type A at local time τ = 0 (i.e., this instance just occurred at <italic>t</italic>), and another response to the instance of event type B at local time τ = 4.</p>
      <p>The necessary design matrix to implement this model, <italic>X</italic><sub>dc</sub>, will span the duration of the entire EEG recording. It can be generated from any design matrix <italic>X</italic> by an algorithm we will call <italic>time expansion</italic> in the following. In this process, each predictor in the original design matrix will be expanded to several columns, which then code a number of “local” time points relative to the event onset. An example for a time-expanded design matrix is shown in <xref ref-type="fig" rid="fig-2">Fig. 2</xref>.</p>
    </sec>
    <sec>
      <title>Time expansion</title>
      <p>The process to create the time-expanded design matrix <italic>X</italic><sub>dc</sub> is illustrated in <xref ref-type="fig" rid="fig-2">Fig. 2</xref>. In the following sections, we will describe the construction of <italic>X</italic><sub>dc</sub> more formally.</p>
      <p>Let <italic>t</italic> be the time of the continuous EEG signal <italic>y</italic>, which keeps increasing throughout the experiment. τ is still the local time, that is, the temporal distance of an EEG sample relative to an instance of event <italic>e</italic>. Let <italic>i</italic> be the instance of one such event. <italic>X<sub>i</sub></italic> is therefore the accompanying row of the design matrix <italic>X</italic> which specifies the predictors for each event of type <italic>e</italic>. The design matrix X consists of multiple columns <italic>c</italic>, each representing one predictor (for which we want to estimate the accompanying β).</p>
      <p><italic>X</italic><sub>dc</sub> can be constructed from multiple concatenated, time-expanded square diagonal matrices <italic>G</italic> with size τ one for each instance of the event <italic>e</italic>. For the purpose of illustration, it is helpful to construct the design matrix first for just a single predictor and a single instance of a single type of event (e.g., a manual response). Afterwards, we will add multiple predictors, then multiple instances of a single event type and finally multiple different event types (e.g., stimuli and responses).</p>
      <sec>
        <title>Single predictor, single instance, single event type</title>
        <p>The matrix <italic>G<sub>c</sub></italic> for a single predictor, single type of event, and single instance of this event type is square diagonal where the size is specified by the number of samples around the event instance onsets to be taken into account:
<disp-formula id="eqn-3"><alternatives><graphic xlink:href="peerj-07-7838-e003.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$${G_c} = I{x_{i,c}} = \left[ {\matrix{ {{x_{i,c}}} &amp; 0 &amp; 0 &amp; 0 \cr  0 &amp; {{x_{i,c}}} &amp; 0 &amp; 0 \cr  0 &amp; 0 &amp; {{x_{i,c}}} &amp; 0 \cr  0 &amp; 0 &amp; 0 &amp; {{x_{i,c}}} \cr  } } \right]$$\end{document}</tex-math><mml:math id="mml-eqn-3"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>I</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
        <p>It is a scaling of an identity matrix by the scalar <italic>x<sub>i</sub></italic><sub>,<italic>c</italic></sub> which is a single entry of the design matrix <italic>X</italic> defining the predictor <italic>c</italic> at the single instance <italic>i</italic>. In the case of a dummy-coded variable (0 or 1) we would get either a matrix full of zeros or the identity matrix; in the case of a continuous predictor we get a scalar matrix where the diagonal of <italic>G<sub>i</sub></italic><sub>,<italic>c</italic></sub> contains the continuous predictor value.</p>
      </sec>
      <sec>
        <title>Multiple predictors, single instance, single event type</title>
        <p>In the case of multiple predictors <italic>c</italic>, we generate multiple matrices <italic>G<sub>i</sub></italic><sub>,<italic>c</italic></sub> and concatenate them to <italic>G</italic>* = [<italic>G</italic><sub>1</sub> … <italic>G<sub>c</sub></italic>]. Therefore, a matrix with two predictors at the instance <italic>i</italic> of an event <italic>e</italic> could look like this:<disp-formula id="eqn-4"><alternatives><graphic xlink:href="peerj-07-7838-e004.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$${G^*} = [{G_1}{G_2}] = \left[ {\matrix{
   1 &amp; 0 &amp; 0 &amp; 0 &amp; {10} &amp; 0 &amp; 0 &amp; 0  \cr 
   0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; {10} &amp; 0 &amp; 0  \cr 
   0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; {10} &amp; 0  \cr 
   0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; {10}  \cr 

 } } \right]$$\end{document}</tex-math><mml:math id="mml-eqn-4"><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
      </sec>
      <sec>
        <title>Multiple predictors, multiple instances, single events type</title>
        <p>In the case of multiple instances of the same event, we have one <italic>G</italic>* matrix for every instance. We combine them into a large matrix <italic>X</italic><sub>dc</sub> (where dc stands for deconvolution) by inserting the <italic>G</italic>* matrices into <italic>X</italic><sub>dc</sub> around the time points (in continuous EEG time <italic>t</italic>) where the instance of the event occurred. Because τ (and therefore <italic>G</italic>*) is usually larger than the time distance between two event instances, we insert rows of multiple <italic>G</italic>* matrices in an overlapping (summed) way. Consequently, we model the same time point of the EEG by the combined rows of multiple <italic>G</italic>* matrices (<xref ref-type="fig" rid="fig-2">Figs. 2</xref> and <xref ref-type="fig" rid="fig-3">3A</xref>). By solving the linear system with <italic>X</italic><sub>dc</sub>β for β we effectively deconvolve the original signal.</p>
        <fig id="fig-3" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.7717/peerj.7838/fig-3</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Temporal basis functions.</title>
            <p>Overview over different temporal basis functions. The expanded design matrix <italic>X</italic><sub>dc</sub> is plotted, the <italic>y</italic>-axis represents time and the <italic>x</italic>-axis shows all time-expanded predictors in the model. In <italic>unfold</italic>, three methods are available for time expansion: (A) Stick-functions. Here, each modeled time point relative to the event is represented by a unique predictor. (B) Time-splines allow neighboring time points to smooth themselves. This generally results in less predictors than the stick function set. (C) Truncated time-Fourier set: It is also possible to use a Fourier basis. By omitting high frequencies from the Fourier-set, the data are effectively low-pass filtered during the deconvolution process (see also <xref ref-type="fig" rid="fig-6">Fig. 6</xref>).</p>
          </caption>
          <graphic xlink:href="peerj-07-7838-g003"/>
        </fig>
      </sec>
      <sec>
        <title>Multiple predictors, multiple instances, multiple events types</title>
        <p>We usually have multiple different types of events <italic>e</italic><sub>1</sub>, <italic>e</italic><sub>2</sub>.… For each of these event types, we create one <inline-formula><alternatives><inline-graphic xlink:href="peerj-07-7838-i001.jpg"/><tex-math id="M5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$X_{{\rm{dc}}}^e$\end{document}</tex-math><mml:math id="mml-ieqn-1"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mtext>dc</mml:mtext></mml:mrow><mml:mi>e</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> matrix as described above. Each <inline-formula><alternatives><inline-graphic xlink:href="peerj-07-7838-i002.jpg"/><tex-math id="M6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$X_{{\rm{dc}}}^e$\end{document}</tex-math><mml:math id="mml-ieqn-2"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mtext>dc</mml:mtext></mml:mrow><mml:mi>e</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> matrix spans <italic>t</italic> rows and thus, the continuous EEG signal. To get the final matrix <italic>X</italic><sub>dc</sub> we simply concatenate them along the columns before the model inversion.</p>
        <disp-formula id="eqn-5">
          <alternatives>
            <graphic xlink:href="peerj-07-7838-e005.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/>
            <tex-math id="M7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$${X_{{\rm{dc}}}} = \left[ {X_{{\rm{dc}}}^1 \ldots X_{{\rm{dc}}}^e} \right]$$\end{document}</tex-math>
            <mml:math id="mml-eqn-5">
              <mml:mrow>
                <mml:msub>
                  <mml:mi>X</mml:mi>
                  <mml:mrow>
                    <mml:mtext>dc</mml:mtext>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:mo>[</mml:mo>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mi>X</mml:mi>
                      <mml:mrow>
                        <mml:mtext>dc</mml:mtext>
                      </mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:msubsup>
                    <mml:mo>…</mml:mo>
                    <mml:msubsup>
                      <mml:mi>X</mml:mi>
                      <mml:mrow>
                        <mml:mtext>dc</mml:mtext>
                      </mml:mrow>
                      <mml:mi>e</mml:mi>
                    </mml:msubsup>
                  </mml:mrow>
                  <mml:mo>]</mml:mo>
                </mml:mrow>
              </mml:mrow>
            </mml:math>
          </alternatives>
        </disp-formula>
        <p>Similarly, if we wanted to include a continuous covariate spanning the whole duration of the continuous EEG signal (see Discussion<italic>),</italic> for example some feature of a continuous audio signal (<xref rid="ref-12" ref-type="bibr">Crosse et al., 2016</xref>), we could simply concatenate it as an additional column to the design matrix.</p>
        <p>The formula for the deconvolution model is then:
<disp-formula id="eqn-6"><alternatives><graphic xlink:href="peerj-07-7838-e006.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$${{\rm{\mu }}_t} = {X_{{\rm{dc}},t}}{\rm{\beta }}\,{\rm{with}}\,{y_t}\,\sim{\rm{normal}}({{\rm{\mu }}_t},{\rm{\sigma }})$$\end{document}</tex-math><mml:math id="mml-eqn-6"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mtext>dc</mml:mtext><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi>β</mml:mi><mml:mtext> with </mml:mtext><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mtext> </mml:mtext><mml:mo>∼</mml:mo><mml:mtext>normal</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
        <p>μ<sub><italic>t</italic></sub> is the expected value of the continuous EEG signal <italic>y<sub>t</sub></italic>. This time-expanded linear model simultaneously fits all the parameters β describing the deconvolved rERPs of interest. This comes at the cost of a very large size (<italic>number of continuous EEG samples</italic> × <italic>number of predictor columns</italic>). Fortunately, this matrix is also very sparse (containing mostly zeros) and can therefore be efficiently solved with modern sparse solvers. For further detail see the excellent tutorial reviews by <xref rid="ref-62" ref-type="bibr">Smith &amp; Kutas (2015a</xref>, <xref rid="ref-63" ref-type="bibr">2015b)</xref>.</p>
      </sec>
    </sec>
    <sec>
      <title>Modeling non-linear effects with spline regression</title>
      <p>Spline regression is a method to estimate non-linear relationships between a continuous predictor and an outcome. In the simple case of a single predictor it can be understood as a type of local smoother function. For a detailed introduction to spline regression we recommend <xref rid="ref-36" ref-type="bibr">Harrell (2015)</xref> or <xref rid="ref-74" ref-type="bibr">Wood (2017)</xref>. We will now outline how we can use spline predictors to model non-linear effects within the linear regression framework. We follow the definition of a generalized additive model (GAM) by <xref rid="ref-74" ref-type="bibr">Wood (2017</xref>, pp. 249–250):
<disp-formula id="eqn-7"><alternatives><graphic xlink:href="peerj-07-7838-e007.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$${{\rm{\mu }}_i} = {X_i}{\rm{\beta }} + \mathop \sum \limits_j {z_j}{f_j}({x_i})$$\end{document}</tex-math><mml:math id="mml-eqn-7"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>The sum <inline-formula><alternatives><inline-graphic xlink:href="peerj-07-7838-i003.jpg"/><tex-math id="M10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\sum\nolimits_j {{z_j}{f_j}\left( {{x_i}} \right)}$\end{document}</tex-math><mml:math id="mml-ieqn-3"><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:math></alternatives></inline-formula> represents a basis set with <italic>j</italic> unknown parameters <italic>z</italic> (analog to the β vector). The time-indices were omitted here. The most common example for such a basis set would be polynomial expansion. Using the polynomial basis set with order three would results in the following function:
<disp-formula id="eqn-8"><alternatives><graphic xlink:href="peerj-07-7838-e008.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$${{\rm{\mu }}_i} = {X_i}{\rm{\beta }} + {z_1}{x^1} + {z_2}{x^2} + {z_3}{x^3}$$\end{document}</tex-math><mml:math id="mml-eqn-8"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msup><mml:mi>x</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>However, due to several suboptimalities of the polynomial basis (<xref rid="ref-59" ref-type="bibr">Runge, 1901</xref>) we will make use of the cubic B-spline basis set instead. Spline regression is conceptually related to the better-known polynomial expansion, but instead of using polynomials, one uses locally bounded functions. In other words, whereas a polynomial ranges over the whole range of the continuous predictor, a B-spline is restricted to a local range.</p>
      <p>This basis set is constructed using the De-Casteljau algorithm (<xref rid="ref-16" ref-type="bibr">De Casteljau, 1959</xref>) implemented by <xref rid="ref-46" ref-type="bibr">Luong (2016)</xref>. It is a basis set that is strictly local: Each basis function is non-zero only over a maximum of 5 other basis functions (for cubic splines; see <xref rid="ref-74" ref-type="bibr">Wood, 2017</xref>, p. 204).</p>
      <p>Multiple terms can be concatenated, resulting in a GAM:
<disp-formula id="eqn-9"><alternatives><graphic xlink:href="peerj-07-7838-e009.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$${{\rm{\mu }}_i} = {X_i}{\rm{\beta }} + \mathop \sum \limits_j {z_j}{f_j}({x_{1i}}) + \mathop \sum \limits_j {z_j}{f_j}({x_{2i}})$$\end{document}</tex-math><mml:math id="mml-eqn-9"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>If interactions between two non-linear spline predictors are expected, we can also make use of two-dimensional splines:
<disp-formula id="eqn-10"><alternatives><graphic xlink:href="peerj-07-7838-e010.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$${{\rm{\mu }}_i} = {X_i}{\rm{\beta }} + \mathop \sum \limits_j {z_j}{f_j}({x_{1i}},{x_{2i}})$$\end{document}</tex-math><mml:math id="mml-eqn-10"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>In the <italic>unfold</italic> toolbox, 2D-splines are created based on the pairwise products between <italic>z</italic><sub>1,<italic>j</italic></sub> and <italic>z</italic><sub>2,<italic>j</italic></sub>. Thus, a 2D spline between two spline-predictors with 10 spline-functions each would result in 100 parameters to be estimated.</p>
      <p>The number of basis functions to use for each non-linear spline term is usually determined by either regularization or cross-validation. Cross-validation is difficult in the case of large EEG datasets (see also Discussion) and we therefore recommend to the number of splines (and thus the flexibility of the non-linear predictors) prior to the analysis.</p>
    </sec>
    <sec>
      <title>Using temporal basis functions</title>
      <p>In the previous section, we made use of time-expansion to model the overlap. For this, we used the so-called stick function approach (also referred to as FIR or dummy-coding). That is, each time-point relative to an event (local time) was coded using a 1 or 0 (in the case of dummy-coded variables), resulting in staircase patterns in the design matrix (cf. <xref ref-type="fig" rid="fig-2">Figs. 2</xref> and <xref ref-type="fig" rid="fig-3">3A</xref>). However, this approach is computationally expensive. Due to the high sampling rate of EEG (typically 200–1,000 Hz), already a single second of estimated ERP response requires us to estimate 200–1,000 coefficients per predictor. Therefore, some groups started to use other time basis sets to effectively smooth the estimated rERPs (<xref rid="ref-44" ref-type="bibr">Litvak et al., 2013</xref>; but see <xref rid="ref-63" ref-type="bibr">Smith &amp; Kutas, 2015b</xref>).</p>
      <p>We will discuss two examples here: The time-Fourier set (<xref rid="ref-44" ref-type="bibr">Litvak et al., 2013</xref>; <xref rid="ref-65" ref-type="bibr">Spitzer, Blankenburg &amp; Summerfield, 2016</xref>) and—newly introduced in this paper—the time-spline set. In the time-spline set, adjacent local time coefficients are effectively combined according to a spline set (<xref ref-type="fig" rid="fig-3">Fig. 3B</xref>). Splines are a suitable basis function because EEG signals are smooth and values close in time have similar values. The number of splines chosen here defines the amount of smoothing of the resulting deconvolved ERP. The same principle holds for the time-Fourier set. Here, we replace the stick-function set with a truncated Fourier set (<xref ref-type="fig" rid="fig-3">Fig. 3C</xref>). Truncating the Fourier set at high frequencies effectively removes high frequencies from the modeled ERP and can therefore be thought of as a low-pass filter. A benefit of using (truncated) temporal basis functions rather than the simple stick functions is that fewer unknown parameters need to be estimated, at the cost of temporal precision. It is therefore possible that this results in numerically more stable solutions to the linear problem, because we are constraining the solution space. Low-pass filtering and downsampling of the data followed by using the stick function deconvolution might result in better control of the spectral properties.</p>
    </sec>
    <sec>
      <title>Existing toolboxes</title>
      <p>To our knowledge, no existing toolbox supports non-linear, spline-based general additive modeling of EEG activity. Also, we were missing a toolbox that solely focuses on deconvolving signals and allowed for a simple specification of the model to be fitted, for example, using the commonly used Wilkinson notation (as also used, e.g., in <italic>R</italic>).</p>
      <p>A few other existing EEG toolboxes allow for deconvolution analyses, but we found that each has their limitations. Plain linear modeling (including second-level analyses) can be performed using the LIMO toolbox (<xref rid="ref-57" ref-type="bibr">Pernet et al., 2011</xref>), but this toolbox does not support deconvolution analyses or spline regression. To our knowledge, five toolboxes support some form of deconvolution: SPM (<xref rid="ref-44" ref-type="bibr">Litvak et al., 2013</xref>; <xref rid="ref-56" ref-type="bibr">Penny et al., 2006</xref>), the rERP extension for EEGLAB (<xref rid="ref-7" ref-type="bibr">Burns et al., 2013</xref>), pyrERP (<xref rid="ref-61" ref-type="bibr">Smith, 2013</xref>), mTRF (<xref rid="ref-12" ref-type="bibr">Crosse et al., 2016</xref>), and MNE (<xref rid="ref-33" ref-type="bibr">Gramfort et al., 2014</xref>). SPM allows for deconvolution of linear responses using Fourier temporal basis sets. However, in order to make use of these deconvolution functions, quite a bit of manual coding is needed. The rERP extension for EEGLAB and the pyrERP toolbox for Python both allow for estimation of linear models and deconvolution; however, both toolboxes appear not to be maintained anymore; rERP is currently non-functional (for current MATLAB versions) and no documentation is available for pyERP. The MNE toolbox is a general-purpose Python-based EEG processing toolbox that supports both deconvolution and massive univariate modeling. It is actively maintained and some basic tutorials are available. The mTRF toolbox is a special type of deconvolution toolbox designed to be used with continuous predictors (e.g., auditory streams) that last over the whole continuous EEG recording (see Discussion).</p>
    </sec>
  </sec>
  <sec sec-type="unfold|toolbox">
    <title>The Unfold Toolbox</title>
    <p>In the following, we describe basic and advanced features available in the <italic>unfold</italic> toolbox and also give practical recommendations for problems that researchers might experience in the modeling process. Specifically, we describe how to (1) specify the model via Wilkinson formulas, (2) include non-linear predictors via spline regression, (3) model the data with basis functions over time (e.g., a Fourier basis set), (4) impute missing data in the design matrix, (5) treat intervals of the continuous EEG containing EEG artifacts (e.g., from muscle activity or skin conductance changes), (5) specify alternative solvers (with regularization) that can solve even large models in a reasonable time, and (6) run the same regression model both as a deconvolution model and also a mass multivariate model without deconvolution. Finally, we summarize options for (7) visualizing and (8) exporting the results (<xref ref-type="fig" rid="fig-4">Fig. 4</xref>).</p>
    <fig id="fig-4" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.7717/peerj.7838/fig-4</object-id>
      <label>Figure 4</label>
      <caption>
        <title>Overview over typical analysis steps with <italic>unfold</italic>.</title>
        <p>The first step is to load a continuous EEG dataset into EEGLAB. This dataset should already contain event markers (e.g., for stimulus onsets, button presses, etc.). Afterwards there are four main analysis steps, that can be executed with a few lines of code (see also Box 1). These steps, highlighted in blue, are: (1) Define the model formula and let <italic>unfold</italic> generate the design matrix, (2) time-expand this design matrix, (3) solve the model to obtain the betas (i.e., rERPs), and (4) convert the betas into a convenient format for plotting and statistics. The right column lists several inbuilt plotting functions to visualize intermediate analysis steps or to plot the results (see also <xref ref-type="fig" rid="fig-8">Fig. 8</xref>).</p>
      </caption>
      <graphic xlink:href="peerj-07-7838-g004"/>
    </fig>
    <sec>
      <title>Data import</title>
      <p>As a start, we need a data structure in EEGLAB format (<xref rid="ref-18" ref-type="bibr">Delorme &amp; Makeig, 2004</xref>) that contains the continuous EEG data and event codes. In traditional EEG experiments, events will typically be stimulus and response triggers, but many other types of events are also possible (e.g., voice onsets, the on- or offsets of eye or body movements etc.). In most cases, the EEG data entered into the model should have already been corrected for biological and technical artifacts (e.g., ocular artifacts, scalp muscle EMG, or power line noise), for example, with independent component analysis (ICA).</p>
    </sec>
    <sec>
      <title>Specifying models using Wilkinson notation</title>
      <p>We begin the modeling process by specifying the model formula and by generating the corresponding design matrix <italic>X</italic>. In the <italic>unfold</italic> toolbox, models are specified using the intuitive Wilkinson notation (<xref rid="ref-72" ref-type="bibr">Wilkinson &amp; Rogers, 1973</xref>) also commonly used in <italic>R</italic>, the Matlab statistics toolbox, and python StatsModels. For example, for the hypothetical face/house experiment depicted in <xref ref-type="fig" rid="fig-1">Fig. 1</xref>, we might define the following model:<disp-formula id="eqn-11"><alternatives><graphic xlink:href="peerj-07-7838-e011.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M14">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$${\tt{{EEG}}\;\sim\;1\; + \;{\tt{cat}}({\tt{is}}\_{\tt{face}})\; + \;{\tt{luminance}}}$$\end{document}</tex-math><mml:math id="mml-eqn-11"><mml:mrow><mml:mstyle mathvariant="monospace"><mml:mtext>EEG </mml:mtext><mml:mo>∼</mml:mo><mml:mtext> </mml:mtext><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> cat</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext>is</mml:mtext><mml:mo>_</mml:mo><mml:mtext>face</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> luminance</mml:mtext></mml:mstyle></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>More generally, we can also specify more complex formulas, such as:<disp-formula id="eqn-12"><alternatives><graphic xlink:href="peerj-07-7838-e012.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M15">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$${\rm{EEG \sim 1  +  cat}}\left( {{\rm{predictor1}}} \right) + {\rm{predictor2  +  spl}}\left( {{\rm{predictor3, 5}}} \right)$$\end{document}</tex-math><mml:math id="mml-eqn-12"><mml:mrow><mml:mstyle mathvariant="monospace"><mml:mtext>EEG </mml:mtext><mml:mo>∼</mml:mo><mml:mtext> </mml:mtext><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> cat</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext>predictor</mml:mtext><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mtext> predictor</mml:mtext><mml:mn>2</mml:mn><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> spl</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext>predictor</mml:mtext><mml:mn>3,5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>Here, <monospace>cat()</monospace> specifies that the <monospace>predictor1</monospace> should be dummy encoded as a categorical variable or factor rather than treated as a continuous variable. If a variable is already dummy-coded as 0/1 it is not strictly necessary to add the <monospace>cat()</monospace> command, but it would be necessary to specify multi-level categorical variables (3 levels or more). In contrast, <monospace>predictor2</monospace> should be modeled as continuous linear covariate and <monospace>predictor3</monospace> as a non-linear spline predictor. In the formula, a plus sign (+) means that only the main effects will be modeled. Interactions between predictors are added by replacing the + with a * or a :, depending on whether all main effects and interactions should be modeled (*), or only the interactions (:). In <italic>unfold</italic>, the type of coding (dummy/treatment/reference or effect/contrast/sum coding) can be selected. If the default treatment coding is used, the predictors will represent the difference to the intercept term (coded by the 1). The reference level of the categorical variable and the ordering of the levels is determined alphabetically or can be specified by the user manually. The toolbox also allows to specify different formulas for different events. For example, stimulus onset events can have a different (e.g., more complex) formula than manual response events.</p>
      <p>Once the formula is defined, the design matrix <italic>X</italic> is time-expanded to <italic>X</italic><sub>dc</sub> and now spans the duration of the entire EEG recording. Subsequently for each channel, the equation (EEG = <italic>X</italic><sub>dc</sub> * <italic>b</italic> + <italic>e</italic>) is solved for “<italic>b</italic>”, the betas, which correspond to subject-level rERP waveforms. For example, in the model above, for which we used treatment coding, the intercept term would correspond to the group-average ERP. The other betas, such as those for <monospace>cat(is_face)</monospace>, will capture the partial effect of that particular predictor, corresponding to a difference wave in traditional ERPs (here: face-ERP minus house-ERP).</p>
      <p>In the same linear model, we can simultaneously model brain responses evoked by other experimental events, such as button presses. Each of these other event types can be modeled by its own formula. In our face/house example, we would want to model the response-related ERP that is elicited by the button press at the end of the trial, because this ERP will otherwise overlap to a varying degree with the stimulus-ERP. We do this by defining an additional simple intercept model for all button press events. In this way, the ERP evoked by button presses will be removed from the estimation of the stimulus ERPs. The complete model would then be:<disp-formula id="eqn-13"><alternatives><graphic xlink:href="peerj-07-7838-e013.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M16">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\displaylines{\tt{{{EEG}_{{\tt{fix}}}}\sim1 + {\tt{cat}}({\tt{is}}\_{\tt{face}}) + {\tt{spl}}({\tt{luminance}},5)\quad \{ {\text{for stimulus onset events}}\}} \cr  \tt{{{EE}}{{\tt{G}}_{{\tt{button}}}}\sim1\quad \{ {\text{for manual button press events}}\}} \cr}$$\end{document}</tex-math><mml:math id="mml-eqn-13"><mml:mtable><mml:mtr><mml:mtd><mml:mstyle mathvariant="monospace"><mml:msub><mml:mtext>EEG</mml:mtext><mml:mrow><mml:mtext>fix</mml:mtext></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mtext>cat</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext>is</mml:mtext><mml:mo>_</mml:mo><mml:mtext>face</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mtext>spl</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext>luminance</mml:mtext><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mo>{</mml:mo><mml:mtext>for stimulus onset events</mml:mtext><mml:mo>}</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle mathvariant="monospace"><mml:msub><mml:mtext>EEG</mml:mtext><mml:mrow><mml:mtext>button</mml:mtext></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mo>{</mml:mo><mml:mtext>for manual button press events</mml:mtext><mml:mo>}</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
    </sec>
    <sec>
      <title>Spline regression to model (non-linear) predictors</title>
      <p>As explained earlier, many influences on the EEG are not strictly linear. In addition to linear terms, one can therefore use cubic B-splines to perform spline regression, an approach commonly summarized under the name GAM. An illustration of this approach is provided in <xref ref-type="fig" rid="fig-5">Fig. 5</xref>. In the <italic>unfold</italic> toolbox, spline regression can be performed by adding <monospace>spl()</monospace> around the predictor name, as for <monospace>predictor3</monospace> in the formula above, which specifies a model using 5 B-splines instead of a continuous linear predictor. We can model covariates as non-linear predictors:<disp-formula id="eqn-14"><alternatives><graphic xlink:href="peerj-07-7838-e014.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M17">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$${\tt{{EEG}}\sim1 + {\tt{spl}}\;(\tt{A},\;5) + 2{\tt{dspl}}\;(\tt{B},\;\tt{C},\;5) + {\tt{circspl}}\;(\tt{D},\;{5},\;{0},\;360)}$$\end{document}</tex-math><mml:math id="mml-eqn-14"><mml:mrow><mml:mstyle mathvariant="monospace"><mml:mtext>EEG</mml:mtext><mml:mo>∼</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mtext>spl </mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mtext>dspl </mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext>B</mml:mtext><mml:mo>,</mml:mo><mml:mtext> C</mml:mtext><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mtext>circspl </mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext>D</mml:mtext><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mn>360</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:math></alternatives></disp-formula></p>
      <fig id="fig-5" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.7838/fig-5</object-id>
        <label>Figure 5</label>
        <caption>
          <title>Modeling a non-linear relationship with a set of spline functions.</title>
          <p>(A) Example of a non-linear relationship between a predictor (e.g., stimulus luminance) and a dependent variable (e.g., EEG amplitude). A linear function (black line) does not fit the data well. We will follow one luminance value (dashed line) at which the linear function is evaluated (red dot). (B) Instead of a linear fit, we define a set of overlapping spline functions which are distributed across the range of the predictor. In this example, we are using a set of six b-splines. For our luminance value, we receive six new predictor values. Only three of them are non-zero. (C) We weight each spline with its respective estimated beta value. To predict the dependent variable (EEG amplitude) at our luminance value (dashed line), we sum up the weighted spline functions (red dots). Because the splines are overlapping, this produces a smooth, non-linear fit to the observed data.</p>
        </caption>
        <graphic xlink:href="peerj-07-7838-g005"/>
      </fig>
      <p>With this formula, the effect “A” would be modeled by a basis set consisting of five splines. We would also fit a 2D spline between continuous variable B and C with five splines each. In addition, we would fit a circular spline based on covariate D using five splines with the limits 0° and 360° being the wrapping point of the circular spline.</p>
      <p>In <italic>unfold</italic>, three spline functions are already implemented. For B-splines we use the de Casteljau algorithm implemented by Bruno Luong. For interactions between spline-modeled covariates, first the default spline function is used on each predictor to generate <italic>n</italic> splines. Then the resulting vectors are elementwise multiplied with each other, generating <italic>n</italic><sup>2</sup> final predictors. For cyclical predictors such as the angle of a saccadic eye movement (which ranges, e.g., from 0 to 2π), it is possibly to use cyclical B-splines, as explained above. These are implemented based on code from <italic>patsy</italic>, a python statistical package (<uri xlink:href="https://patsy.readthedocs.io">https://patsy.readthedocs.io</uri>) which follows an algorithm described in <xref rid="ref-74" ref-type="bibr">Wood (2017</xref>, pp. 201–205). For maximal flexibility, we also allow the user to define custom spline functions. This would also allow to implement other basis sets, for example, polynomial expansion.</p>
      <p>In our default B-spline implementation, the so-called <italic>knots</italic> define the peaks of the cubic splines, except for the boundaries (i.e., extremes) of the covariate (see <xref ref-type="fig" rid="fig-5">Fig. 5B</xref>). The resulting number of splines are given by the number of knots minus 4 (4 due to the cubic nature, see <xref rid="ref-74" ref-type="bibr">Wood, 2017</xref>, p. 204), but the user only has to specify the number of basis functions, not the exact number of knots. The placement of knots (and therefore the number of splines) are critical parameters to appropriately model the predictor and to avoid over- or underfitting the data. The toolbox’s default knot placement is on the quantiles of the predictor, which will increase resolution of the splines in areas where there are a lot of data points and offers stronger smoothing in other areas, where predictor values are sparser (similar to <xref rid="ref-36" ref-type="bibr">Harrell, 2015</xref>, p. 26). This can be changed by users who want to use a custom sequence of knots. Generalized cross-validation or penalized regression could be used to narrow down the number of knots to be used but is computational expensive and currently not supported in <italic>unfold</italic>.</p>
    </sec>
    <sec>
      <title>Using time basis functions</title>
      <p>Temporal basis functions were introduced earlier. The stick-function approach, as also illustrated in <xref ref-type="fig" rid="fig-2">Figs. 2</xref> and <xref ref-type="fig" rid="fig-3">3A</xref>, is the default option in <italic>unfold</italic>. As alternatives, it is also possible to employ either a Fourier basis set or a set of <italic>temporal</italic> spline function. For example, for the time-expansion step, <xref rid="ref-44" ref-type="bibr">Litvak et al. (2013</xref>; <xref rid="ref-65" ref-type="bibr">Spitzer, Blankenburg &amp; Summerfield, 2016)</xref> used a Fourier basis sets instead of stick-functions. <xref ref-type="fig" rid="fig-6">Figure 6</xref> compares simulation results for stick functions with those obtained with a Fourier basis set and a spline basis set in terms of the spectral components and the resulting filter artifacts. At this point, more simulation studies are needed to understand the effects of temporal basis sets on EEG data. We therefore follow the recommendation of <xref rid="ref-63" ref-type="bibr">Smith &amp; Kutas (2015b)</xref> to use stick-functions for now.</p>
      <fig id="fig-6" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.7838/fig-6</object-id>
        <label>Figure 6</label>
        <caption>
          <title>Using temporal basis functions.</title>
          <p>Effect of using different time basis functions on the recovery of the original signal using deconvolution. (A–C) Show three different example signals without deconvolution (in black) and with convolution using different methods for the time-expansion (stick, Fourier, spline). We zero-padded the original signal to be able to show boundary artifacts. For the analysis we used 45 time-splines and in order to keep the number of parameters equivalent, the first 22 cosine and sine functions of the Fourier set. The smoothing effects of using a time-basis set can be best seen in the difference between the blue curve and the orange/red curves in (D). Artifacts introduced due to the time-basis set are highlighted with arrows and can be seen best in (E) and (F). Note that in the case of realistic EEG data, the signal is typically smooth, meaning that ripples like in (E) rarely occur. (G) The impulse response spectrum of the different smoothers. Clearly, the Fourier-set filters better than the splines, but splines allow for a sparser description of the data and could benefit in the fitting stage.</p>
        </caption>
        <graphic xlink:href="peerj-07-7838-g006"/>
      </fig>
    </sec>
    <sec>
      <title>Imputation of missing values</title>
      <p>If a predictor has a missing value in massive univariate regression models, it is typically necessary to remove the whole trial. One workaround for this practical problem is to impute (i.e., interpolate) the value of missing predictors. In the deconvolution case, imputation is even more important for a reliable model fit, because if a whole event is removed, then overlapping activity from this event with that of the neighboring events would not be accounted for. In <italic>unfold</italic> we therefore offer several algorithms to treat missing values: the dropping of events with missing information, or imputation by the marginal, mean, or median values of the other events.</p>
    </sec>
    <sec>
      <title>Dealing with EEG artifacts</title>
      <p>Linear deconvolution needs to be performed on continuous, rather than epoched data. This creates challenges with regard to the treatment of intervals that contain EEG artifacts. The way to handle artifacts in a linear deconvolution model is therefore to detect—but not to remove—the intervals containing artifacts in the continuous dataset. For these contaminated intervals, the time-expanded design matrix (<italic>X</italic><sub>dc</sub>) is then blanked out, that is, filled with zeros, so that the artifacts do not affect the model estimation (<xref rid="ref-63" ref-type="bibr">Smith &amp; Kutas, 2015b</xref>). If the data would have been cleaned prior to the time-expansion step, then events might have been removed that would overlap with clean data segments.</p>
      <p>Of course, this requires the researcher to use methods for artifact correction that can be applied to continuous rather than segmented data (such as ICA). Similarly, we need methods that can detect residual artifacts in the continuous rather than epoched EEG. One example would be a peak-to-peak voltage threshold that is applied within a moving time window (shifted step-by-step across the entire recording). Whenever the peak-to-peak voltage within the window exceeds a given threshold, the corresponding interval would then be blanked out in the design matrix. Detecting artifacts in the continuous rather than segmented EEG also has some small additional benefit, because if the data of a trial is only partially contaminated, the clean parts can still enter the model estimation (<xref rid="ref-63" ref-type="bibr">Smith &amp; Kutas, 2015b</xref>).</p>
      <p>The <italic>unfold</italic> toolbox includes a function to remove artifactual intervals from the design matrix before fitting the model. In addition, we offer basic functionality, adapted from ERPLAB (<xref rid="ref-45" ref-type="bibr">Lopez-Calderon &amp; Luck, 2014</xref>), to detect artifacts in the continuous EEG.</p>
    </sec>
    <sec>
      <title>Multiple solvers: LSMR &amp; <italic>glmnet</italic></title>
      <p>Solving for the betas is not always easy in such a large model. We offer several algorithms to solve for the parameters. The currently recommended one is LSMR (<xref rid="ref-27" ref-type="bibr">Fong &amp; Saunders, 2011</xref>), an iterative algorithm for sparse least-squares problems. This algorithm allows to use very large design matrices as long as they are sparse (i.e., contain mostly zeroes) which is usually the case if one uses time-expansion based on stick-functions (cf. <xref ref-type="fig" rid="fig-2">Figs. 2</xref> and <xref ref-type="fig" rid="fig-3">3A</xref>).</p>
      <p>However, especially with data containing a high level of noise, the tradeoff between bias and variance (i.e., between under- and overfitting) might be suboptimal, meaning that the parameters estimated from the data might be only weakly predictive for held-out data (i.e., they show a high variance and tend to overfit the data). Regularization is one way to prevent overfitting of parameter estimates. In short, regularization introduces a penalty term for high beta values, effectively finding a trade-off between overfit and out-of-sample prediction. The <italic>unfold</italic> toolbox allows the user to specify alternative solvers that use regularization. In particular, we include the <italic>glmnet</italic>-solver (<xref rid="ref-58" ref-type="bibr">Qian et al., 2013</xref>), which allows for ridge (L2-norm), lasso (L1, leads to sparse solutions) and elastic net regularization. The regularization parameter is automatically estimated using cross-validation but the elastic-net parameter (deciding between L1 and L2 norm) has to be specified manually. Procedures to regularize with linear deconvolution have recently been examined and validated by <xref rid="ref-41" ref-type="bibr">Kristensen, Rivet &amp; Guérin-Dugué (2017a)</xref>. Effects of regularization on noisy data are also depicted in <xref ref-type="fig" rid="fig-7">Fig. 7</xref>, which compares deconvolution results for noisy simulated data with and without regularization. In this simulation we used strongly correlated predictors (<italic>r</italic> = 0.85), thereby increasing collinearity. Note that collinearity in itself is only a problem for very extreme cases; specifically, if the matrix becomes ill-conditioned, the parameter solution might be instable and the estimands will “explode.” Regularization can help in this situation. As can be seen in <xref ref-type="fig" rid="fig-7">Fig. 7</xref>, the non-regularized estimates show strong variance (<xref ref-type="fig" rid="fig-7">Figs. 7B</xref> and <xref ref-type="fig" rid="fig-7">7C</xref>), whereas the regularized estimates show strong bias (<xref ref-type="fig" rid="fig-7">Figs. 7D</xref> and <xref ref-type="fig" rid="fig-7">7E</xref>), that is, the estimated effects are shrunk towards zero but, simultaneously, the variance of the estimate over time is greatly reduced. At this point, it is not yet clear whether and what type of regularization should be used for the standard analysis of EEG data, but we provide different solvers in <italic>unfold</italic> to facilitate future work on this topic. Please also see <xref rid="ref-41" ref-type="bibr">Kristensen, Rivet &amp; Guérin-Dugué (2017a)</xref> for more simulation work.</p>
      <fig id="fig-7" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.7838/fig-7</object-id>
        <label>Figure 7</label>
        <caption>
          <title>Regularization options.</title>
          <p>Effects of regularization on deconvolving noisy data. Results of regularization are shown both for a model with stick-functions and for a model with a temporal spline basis set. (A) To create an overlapped EEG signal, we convolved 38 instances of the original signal depicted in (A). The effect of a continuous covariate was randomly added to each event (see different colors in A). To make the data noisy, we added Gaussian white noise with a standard deviation of 1. Finally, to illustrate the power of regularization, we also added another random covariate to the model. This covariate had no relation to the EEG signal but was highly correlated (<italic>r</italic> = 0.85) to the first covariate. Thus, the model formula was: EEG ∼ 1 + covariate + randomCovariate. (B) Parameters recovered based on ordinary least squares regression. Due to the low signal-to-noise ratio of the data, the estimates are extremely noisy. (C) Some smoothing effect can be achieved by using time-splines as a temporal basis set instead of stick functions. (D) The same data, but deconvolved using a L2-regularized estimate (ridge regression). It is obvious that the variance of the estimate is a lot smaller. However, compared to the original signal shown in (A), the estimated signal is also much weaker, i.e., there is a strong bias. (E) L2-regularized estimates, computed with a time-spline basis set. This panel shows the usefulness of regularization: the effect structure can be recovered despite strong noise, although the recovered effect is again strongly biased (due to the variance/bias tradeoff).</p>
        </caption>
        <graphic xlink:href="peerj-07-7838-g007"/>
      </fig>
    </sec>
    <sec>
      <title>Spatial vs. temporal deconvolution</title>
      <p>Many researchers use source reconstruction (e.g., MNE, LORETA) or blind source separation methods (e.g., ICA) to try to isolate the signal contributions of individual neural sources. In our framework, this can be understood as performing a <italic>spatial</italic> deconvolution of the signal that addresses the problem of volume conduction. Nevertheless, the activity time courses of each neural source may still overlap in time, for example, due to repeated stimulus presentations. To apply the deconvolution, it does not matter whether the input time series consist of raw EEG signals, or whether they are the result of spatial filtering (e.g., beamformer: <xref rid="ref-69" ref-type="bibr">Van Veen et al., 1997</xref>), blind source separation (<xref rid="ref-48" ref-type="bibr">Makeig et al., 1996</xref>; <xref rid="ref-19" ref-type="bibr">Delorme et al., 2012</xref>) or some other transformation (<xref rid="ref-10" ref-type="bibr">Cohen, 2017</xref>). To use our toolbox with other types of time series, the data has to be simply copied into the EEG.data matrix in EEGLAB. For convenience, we also offer a flag (“<monospace>ica,</monospace>” “<monospace>true</monospace>”), which allows the researcher to directly model ICA activations (stored in <monospace>EEG.icaact</monospace>), instead of the raw EEG. While we can only speculate about this issue at this point, it seem likely that a prior spatial decomposition of the data improves the performance and interpretability of the final, spatially <italic>and</italic> temporally deconvolved signals (<xref rid="ref-8" ref-type="bibr">Burwell et al., 2019</xref>).</p>
    </sec>
    <sec>
      <title>Comparison to a mass univariate model (without deconvolution)</title>
      <p>The <italic>unfold</italic> toolbox offers the option to compute a mass univariate regression model on the same data using the exact same model but without correction for overlap. In our experience, running this model in addition to the linear deconvolution model can be helpful to understand the impact of overlap on the results. However, with this function, <italic>unfold</italic> can also be used as a standalone toolbox for Mass-Univariate modeling, for the (rare) cases in which an experiment does not involve any overlapping activity (e.g., from small saccades; <xref rid="ref-22" ref-type="bibr">Dimigen et al., 2009</xref>).</p>
    </sec>
    <sec>
      <title>Visualization of results</title>
      <p><italic>unfold</italic> offers multiple inbuilt functions to visualize rERP results (<xref ref-type="fig" rid="fig-8">Fig. 8</xref>). We provide functions for marginal plots over splines and continuous variables, and functions to evaluate splines/continuous covariates at specific values. For the topographical output we make use of functions from the EEGVIS toolbox (<xref rid="ref-24" ref-type="bibr">Ehinger, 2018</xref>).</p>
      <fig id="fig-8" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.7838/fig-8</object-id>
        <label>Figure 8</label>
        <caption>
          <title>Inbuilt data visualization options.</title>
          <p>Shown are some of the figures currently produced by the <italic>unfold</italic> toolbox. While setting up the model, it is possible to visualize intermediate steps of the analysis, such as the design matrix (A) covariance matrix of the predictors (B) or the time-expanded design matrix (C). After the model is computed, the beta coefficients for one or more predictors can be plotted as ERP-like waveforms with a comparison of with and without deconvolution (D), as ERP images with time against predictor value and color-coded amplitude (E), or as topographical time series (F).</p>
        </caption>
        <graphic xlink:href="peerj-07-7838-g008"/>
      </fig>
    </sec>
    <sec>
      <title>Exporting the results</title>
      <p><italic>unfold</italic> focuses on two main things: linear deconvolution and (non)-linear modeling at the single-subject level. In contrast, the toolbox itself does not offer functions for group-level statistics. However, the betas for each participant can be easily exported as plain text (.csv) or as different MATLAB structures to apply statistics with other toolboxes. A tutorial to process <italic>unfold</italic> results using group-level permutation tests with the TFCE-toolbox (<xref rid="ref-50" ref-type="bibr">Mensen &amp; Khatami, 2013</xref>) is provided in the online documentation.</p>
    </sec>
    <sec>
      <title>A minimal but complete analysis script</title>
      <p><xref ref-type="fig" rid="fig-9">Figure 9</xref> shows a complete analysis script for the hypothetical face/house experiment introduced above (see <xref ref-type="fig" rid="fig-1">Fig. 1</xref>). The complete analysis can be run with a few lines of code.</p>
      <fig id="fig-9" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.7838/fig-9</object-id>
        <label>Figure 9</label>
        <caption>
          <title>A complete analysis script with <italic>unfold</italic>.</title>
          <p>For further documentation and interactive tutorials visit <uri xlink:href="https://www.unfoldtoolbox.org">https://www.unfoldtoolbox.org</uri>.</p>
        </caption>
        <graphic xlink:href="peerj-07-7838-g009"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <p>In this section, we validate the <italic>unfold</italic> toolbox based on (1) simulated data and (2) a real dataset from a standard face recognition ERP experiment containing overlapping activities.</p>
    <sec>
      <title>Simulated data</title>
      <p>To create simulated data, we produced overlapped data using four different response shapes, shown in the first column of <xref ref-type="fig" rid="fig-10">Fig. 10</xref>: (1) a boxcar function, (2) a Dirac delta function, (3) a simulated auditory ERP (the same as used by <xref rid="ref-47" ref-type="bibr">Lütkenhöner, 2010</xref>), and (4) random pink noise. We then simulated 5 s of continuous data, during which 18 experimental events happened. Intervals between subsequent events were randomly drawn from a normal distribution (<italic>M</italic> = 0.25 s, SD = 0.05 s). Convolving the simulated responses with the randomly generated event latencies produced the continuous overlapped signal depicted in the third column of <xref ref-type="fig" rid="fig-10">Fig. 10</xref>. The last column of <xref ref-type="fig" rid="fig-10">Fig. 10</xref> shows the non-overlapped responses recovered by <italic>unfold</italic> (orange lines). For comparison, overlapped responses without deconvolution are plotted in dark red. As can be seen, <italic>unfold</italic> recovered the original response in all cases. The data of <xref ref-type="fig" rid="fig-1">Fig. 1</xref> were also simulated and then analyzed using our toolbox. Together, these simulations show that <italic>unfold</italic> successfully deconvolves heavily overlapping simulated signals.</p>
      <fig id="fig-10" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.7838/fig-10</object-id>
        <label>Figure 10</label>
        <caption>
          <title>Deconvolution results for simulated signals.</title>
          <p>Four types of responses (first column: box car, Dirac function, auditory ERP, pink noise) were convolved with random event latencies (second column). A section of the resulting overlapped signal is shown in the third column. The fourth column shows the deconvolved response recovered by the <italic>unfold</italic> toolbox (orange lines). Overlapped responses (without deconvolution) are plotted as violet lines for comparison.</p>
        </caption>
        <graphic xlink:href="peerj-07-7838-g010"/>
      </fig>
    </sec>
    <sec>
      <title>Real data example</title>
      <p>Finally, we will also analyze a real dataset from a single participant who performed a standard ERP face discrimination experiment<xref ref-type="fn" rid="fn1"><sup>1</sup></xref>
<fn id="fn1"><p><sup>1</sup>The same example data was also analyzed in our accompanying paper (<xref rid="ref-20" ref-type="bibr">Dimigen &amp; Ehinger, 2019</xref>), but with a different focus. Further details on this dataset are given in <xref rid="ref-22" ref-type="bibr">Dimigen et al. (2009)</xref> or <xref rid="ref-20" ref-type="bibr">Dimigen &amp; Ehinger (2019)</xref>.</p></fn>. In this experiment, previously described in the supplementary materials of <xref rid="ref-22" ref-type="bibr">Dimigen et al. (2009)</xref>, participants were shown 120 different color images of human faces (7.5° × 8.5°) with a happy, angry, or neutral expression. All participants providing written informed consent before taking part in the study (at the time of data collection, there was no requirement to obtain institutional review board approval for individual ERP experiments that used standard procedures at the Department of Psychology at Humboldt University). The participants’ task was to categorize the emotion of the presented face as quickly as possible using three response buttons, operated with the index, middle, and ring finger of the right hand. Each stimulus was presented for 1,350 ms. The participant’s mean RT was 836 ms.</p>
      <p>Although a central fixation cross was presented prior to each trial and participants were instructed to avoid eye movements during the task, concurrent video-based eye-tracking revealed that participants executed at least one involuntary (micro)saccades during the vast majority of trials (see also <xref rid="ref-22" ref-type="bibr">Dimigen et al., 2009</xref>; <xref rid="ref-76" ref-type="bibr">Yuval-Greenberg et al., 2008</xref>). For the participant analyzed here, the median amplitude of these small saccades was 0.6° and most were aimed at the mouth region of the presented faces, which was most informative for the emotion discrimination task.</p>
      <p>This means that our stimulus-locked ERPs are contaminated with two other processes: visually-evoked potentials (lambda waves) generated by the retinal image motion produced by the (micro)saccades (<xref rid="ref-29" ref-type="bibr">Gaarder et al., 1964</xref>; <xref rid="ref-22" ref-type="bibr">Dimigen et al., 2009</xref>) and motor processes related to preparing and executing the finger movement.</p>
      <p>To disentangle these potentials with <italic>unfold</italic>, we specified three events: Stimulus onset, saccade onset, and button press. For this simple demonstration, we modeled both stimulus onsets and button press events using only an intercept term (y ∼ 1), that is, regardless of emotion. For the saccade onsets, we included both an intercept as well as saccade amplitude as a continuous predictor, because larger saccades are followed by larger lambda waves (<xref rid="ref-29" ref-type="bibr">Gaarder et al., 1964</xref>; <xref rid="ref-22" ref-type="bibr">Dimigen et al., 2009</xref>). Because this relationship is non-linear (<xref rid="ref-15" ref-type="bibr">Dandekar et al., 2012b</xref>) we used a set of 5 splines in the formula, <monospace>y ∼ 1 + spl(saccade_amplitude,5)</monospace>. Brain responses were modeled in the time window from −1.5 to 1 s around each event. Before fitting the model, we removed all intervals from the design matrix in which the recorded activity at any channels differed by &gt;250 μV within a window of 2 s.</p>
      <p><xref ref-type="fig" rid="fig-11">Figure 11</xref> presents the results for occipital electrode Oz and the signal both with (in red) and without (blue) the modeling and removal of overlapping activity. The large effect of overlapping activity can be clearly seen in the averaged ERP waveforms (top row in <xref ref-type="fig" rid="fig-11">Figs. 11C</xref>–<xref ref-type="fig" rid="fig-11">11E</xref>). In the corresponding panels below that, we see the color-coded single trial activity (<italic>erpimages</italic>), in which segments time-locked to one type of event (e.g., stimulus onset) were sorted by the latency of the temporally adjacent event (e.g., saccade onset). These panels clearly show the overlapping activity and how it was successfully removed by the deconvolution. In particular, we wish to highlight the substantial effect of overlap correction on the shape of both the stimulus-onset ERP (elicited by the faces) and the response-related ERP (elicited by the button press), despite the fact that average RT was relatively long (&gt;800 ms) in this task. Microsaccades have an additional distorting effect (<xref rid="ref-22" ref-type="bibr">Dimigen et al., 2009</xref>). We can therefore easily imagine how without any overlap correction, differences in mean RT and microsaccade occurrence between conditions will create spurious condition effects in the stimulus-ERP. A more complex application where we correct for similar spurious effects in a natural reading EEG experiment with 48 participants is found in <xref rid="ref-20" ref-type="bibr">Dimigen &amp; Ehinger (2019)</xref>. The data and code to reproduce <xref ref-type="fig" rid="fig-11">Fig. 11</xref> can be found at <uri xlink:href="https://osf.io/wbz7x/">https://osf.io/wbz7x/</uri>.</p>
      <fig id="fig-11" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.7838/fig-11</object-id>
        <label>Figure 11</label>
        <caption>
          <title>Example dataset with stimulus onsets, eye movements, and button presses.</title>
          <p>(A) Panel adapted from <xref rid="ref-20" ref-type="bibr">Dimigen &amp; Ehinger (2019)</xref>. The participant was shown a stimulus for 1,350 ms. (B) The subject was instructed to keep fixation, but as the heatmap shows, made many small involuntary saccades towards the mouth region of the presented stimuli. Each saccade also elicits a visually-evoked response (lambda waves). (C–E) Latency-sorted and color-coded single-trial potentials at electrode Oz over visual cortex (second row) reveal that the vast majority of trials contain not only the neural response to the face (C) but also hidden visual potentials evoked by involuntary microsaccades (D) as well as motor potentials from preparing the button press (E). Deconvolution modeling with <italic>unfold</italic> allows us to isolate and remove these different signal contributions (see “no deconvolution” vs. “with deconvolution”), resulting in corrected ERP waveforms for each process (blue vs. red waveforms). This reveals, for example, that a significant part of the P300 evoked by faces (arrow in (C)) is really due to microsaccades and button presses and not the stimulus presentation.</p>
        </caption>
        <graphic xlink:href="peerj-07-7838-g011"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>Human behavior in natural environments is characterized by complex motor actions and quasi-continuous, multisensory stimulation. Brain signals recorded under such conditions are characterized by overlapping activity evoked by different processes and typically also influenced by a host of confounding variables that are difficult or impossible to orthogonalize under quasi-experimental conditions. However, even in traditional, highly controlled laboratory experiments, it is often unrealistic to match all stimulus properties between conditions, in particular if the stimuli are high-dimensional, such as words (e.g., word length, lexical frequency, orthographic neighborhood size, semantic richness, number of meanings, etc.) or faces (e.g., luminance, contrast, power spectrum, size, gender, age, facial expression, familiarity, etc.). In addition, as we demonstrate here, even simple EEG experiments often contain overlapping neural responses from multiple different processes such as stimulus onsets, eye movements, or button presses. Deconvolution modeling allows us to disentangle and isolate these different influences to improve our understanding of the data.</p>
    <p>In this article, we presented <italic>unfold</italic>, which deconvolves overlapping potentials and controls for linear or non-linear influences of covariates on the EEG. In the following, we will discuss in more detail the assumptions, possibilities, and existing limitations of this approach as well as current and future applications.</p>
    <sec>
      <title>Where can linear deconvolution be applied?</title>
      <p>Linear deconvolution can be applied to many types of paradigms and data. As shown above, one application is to separate stimulus- and response-related components in traditional ERP studies (see also <xref rid="ref-54" ref-type="bibr">Ouyang et al., 2011</xref>; <xref rid="ref-55" ref-type="bibr">Ouyang, Sommer &amp; Zhou, 2015</xref>). Deconvolution is also particularly useful with complex ERP designs that involve, for example, multimodal streams of visual, tactile, and auditory stimuli (<xref rid="ref-65" ref-type="bibr">Spitzer, Blankenburg &amp; Summerfield, 2016</xref>). Deconvolution is also helpful in paradigms where it is problematic to find a neutral interval to place a baseline, for example, in experiments with fast tone sequences (<xref rid="ref-47" ref-type="bibr">Lütkenhöner, 2010</xref>). In ERP research, the interval for baseline correction is usually placed immediately before stimulus onset, but activity in this interval can vary systematically between conditions due to overlapping activity, for example, in self-paced paradigms (<xref rid="ref-23" ref-type="bibr">Ditman, Holcomb &amp; Kuperberg, 2007</xref>). This problem can be solved by first deconvolving the signal and then applying the baseline subtraction to the resulting isolated responses.</p>
    </sec>
    <sec>
      <title>Time-continuous covariates</title>
      <p>It is also possible to add time-continuous signals as predictors to the design matrix (<xref rid="ref-43" ref-type="bibr">Lalor et al., 2006</xref>; <xref rid="ref-12" ref-type="bibr">Crosse et al., 2016</xref>). Examples for continuous signals that could be added as predictors include the luminance profile of a continuously flickering stimulus (<xref rid="ref-43" ref-type="bibr">Lalor et al., 2006</xref>; <xref rid="ref-68" ref-type="bibr">VanRullen &amp; MacDonald, 2012</xref>), the sound envelope of an audio or speech signal (with temporal lags to model the auditory temporal response function <xref rid="ref-12" ref-type="bibr">Crosse et al., 2016</xref>), the participants’ gaze position or pupil size (from concurrent eye-tracking <xref rid="ref-20" ref-type="bibr">Dimigen &amp; Ehinger, 2019</xref>), but also more abstract time series, such as predictions from a cognitive computational model. Including time-continuous covariates such as gait-signals, movement features, or environmental sounds could also improve the model fit in mobile EEG situations (<xref rid="ref-25" ref-type="bibr">Ehinger et al., 2014</xref>; <xref rid="ref-32" ref-type="bibr">Gramann et al., 2014</xref>). The resulting betas of time-continuous covariates are often named (multivariate) temporal response functions (mTRFs, but not consistently so, e.g., <xref rid="ref-6" ref-type="bibr">Broderick et al., 2018</xref> call FIR-deconvolved betas TRFs). We propose to follow this nomenclature to distinguish it from (stick-function-fitted) rERPs as we have been using in this paper. Of course, one could combine both approaches and fit mTRFs and rERPs simultaneously.</p>
    </sec>
    <sec>
      <title>Underlying assumptions</title>
      <p>A fundamental assumption of traditional ERP averaging is that the shape of the underlying neural response is identical in all trials belonging to the same condition. Trials with short and long manual RTs are therefore usually averaged together. Similarly, with linear deconvolution modeling, we assume that the brain response is the same for all events of a given type. However, like in traditional ERP analyses, we also assume that the neural response is independent of the interval between two subsequent events (e.g., the interval between a stimulus and a manual response). This is probably a simplification, since neural activity will likely differ between trials with a slow or fast reaction.</p>
      <p>A related assumption concerns sequences of events: processing one stimulus can change the processing of a following stimulus, for instance due to adaptation, priming, or attentional effects. We want to note that if such sequential effects occur often enough in an experiment, they can be explicitly modeled; for example, on could add an additional predictors coding whether a stimulus is repeated or not or whether it occurred early or late in a sequence of stimuli. We hope that the <italic>unfold</italic> toolbox will facilitate the analysis of simulations on these issues and also propose to analyze experiments where temporal overlap is experimentally varied.</p>
    </sec>
    <sec>
      <title>Modeling non-linear effects</title>
      <p>Non-linear predictors can have considerable advantages over linear predictors. However, one issue that is currently unresolved is how to select an appropriate number of spline functions to model a non-linear effect without under- or overfitting the data. While automatic selection methods exist (e.g., based on generalized cross-validation, <xref rid="ref-74" ref-type="bibr">Wood, 2017</xref>), their high computational cost of repeatedly deconvolving the data precluded us from using these techniques. In the current implementation of <italic>unfold</italic>, we assume the same number of splines are needed for all parts of the response. But it is possible, for example, that with a constant number of splines the baseline interval is overfitted, whereas the true response is underfitted. Therefore, algorithms to find smoothing parameters need to take into account that the amount of smoothing changes throughout the response. Choosing the correct number of splines that neither overfit nor underfit the data is an important question to resolve, and again, we hope that the <italic>unfold</italic> toolbox will facilitate future simulation studies, new algorithms, and new experiments on this issue.</p>
    </sec>
    <sec>
      <title>Time-frequency analysis</title>
      <p>While all example analyses presented here were conducted in the time domain, it is also possible to model and deconvolve overlapping time-frequency representations with <italic>unfold</italic> (see also <xref rid="ref-44" ref-type="bibr">Litvak et al., 2013</xref>). One simple option is to enter the band-bass filtered EEG signal into the model (or alternatively bandpass filter the estimated betas, but be aware of boundary filter artefacts). This would model the evoked potentials. One could also estimate the instantaneous power for induced potentials. For instance <xref rid="ref-53" ref-type="bibr">Ossandón, König &amp; Heed (2019)</xref> deconvolved the instantaneous power after band pass filtering the alpha band. But this assumes that the overlap is linear in power. <xref rid="ref-44" ref-type="bibr">Litvak et al. (2013)</xref> used an empirical approach based on model fit to decide between three possible power transformations (power, sqrt(power), and log(power)) and found slightly better model fit for the sqrt(power) transform. Alternatively, complex linear regression could be a solution (<xref rid="ref-38" ref-type="bibr">Hussin, Abdullah &amp; Mohamed, 2010</xref>), but future work is needed here and we recommend more simulation studies prior to such time-frequency work.</p>
    </sec>
    <sec>
      <title>Choice of modeling parameters</title>
      <p>In a traditional ERP analysis, the researcher has to set numerous analysis parameters, which will influence the final ERP results (e.g., filter settings, epoch length, baseline interval). Similarly, with deconvolution we have to make these and additional choices. Because the deconvolution approach is still in its infancy, there are not yet clearly established best-practices for all of the necessary settings. However, in the following, we discuss some basic and advanced parameters:
<list list-type="simple"><list-item><p>Basic settings/options
<list list-type="simple"><list-item><label>1)</label><p><italic>Sampling rate</italic>. Deconvolution can be applied to data recorded at any sampling rate, but some researchers have temporally downsampled their data (e.g., to 100 Hz; <xref rid="ref-60" ref-type="bibr">Sassenhagen, 2018</xref>) before deconvolution. Aside from the obvious loss of temporal resolution that results from downsampling, we (anecdotally) have not observed a benefit for the stability of the estimation; in our experience, downsampling made the fitting process faster but not necessarily better.</p></list-item><list-item><label>2)</label><p><italic>Epoch size.</italic> The time limits for the deconvolution should be chosen so that the entire event-related response is modeled. For motor responses, such as saccades or button presses, it is therefore necessary to also include a sufficient number of timepoints before the event in order to capture (pre)motor potentials.</p></list-item><list-item><label>3)</label><p><italic>Baseline correction</italic>. Baseline correction can be applied directly to the resulting betas (<xref rid="ref-63" ref-type="bibr">Smith &amp; Kutas, 2015b</xref>). Whether baseline correction is always a good idea is still up to debate and in future work, it might be possible to include the baseline voltages directly into the GLM (<xref rid="ref-1" ref-type="bibr">Alday, 2019</xref>).</p><p>Advanced settings/options</p></list-item><list-item><label>4)</label><p><italic>Number of splines</italic>. The number of splines for a non-linear predictor is a difficult parameter to set, because it clearly depends on the underlying relation between predictor and ERP. Usually the number of splines is determined by penalized least squares, which is not supported by <italic>unfold</italic>. In our application to combined EEG and eye-tracking experiments (<xref rid="ref-20" ref-type="bibr">Dimigen &amp; Ehinger, 2019</xref>) we found that EEG effects like that of saccade size can be modeled by about 5 splines, whereas a much higher number of splines (e.g., 10) clearly overfitted the single-subject data. In future implementations it might be possible to estimate the splines using penalized regression, mixed model fitting (<xref rid="ref-74" ref-type="bibr">Wood, 2017</xref>) or using cross-validation.</p></list-item><list-item><label>5)</label><p><italic>Placement of splines</italic>. The splines have to be placed along the range of the predictor variable. In <italic>unfold</italic>, the default placement of splines is on the (N<sub>splines</sub>-2) quantiles of the predictor. Other placements are possible, and users can specify their own placements if necessary (<xref rid="ref-36" ref-type="bibr">Harrell, 2015</xref>, p. 26).</p></list-item><list-item><label>6)</label><p><italic>Regularization.</italic> Whether to use regularization at all and if so, what type of regularization to use, is currently not established. We recommend <xref rid="ref-41" ref-type="bibr">Kristensen, Rivet &amp; Guérin-Dugué (2017a)</xref> as a starting point.</p></list-item><list-item><label>7)</label><p><italic>Time basis used to generate X</italic><sub>dc</sub>. As described above, it is also possible to use a set of <italic>temporal</italic> basis functions (e.g., a Fourier set or set of temporal splines) to reduce the number of columns added to the design matrix in the time-expansion step. While <italic>unfold</italic> already implements this option, we follow for now the recommendation of <xref rid="ref-63" ref-type="bibr">Smith &amp; Kutas (2015b)</xref> that simple stick functions (FIR) should be used for most applications.</p></list-item></list></p></list-item></list></p>
    </sec>
    <sec>
      <title>Outlook: integration with linear mixed models</title>
      <p>In recent years, linear mixed-effects models (LMM, e.g., <xref rid="ref-31" ref-type="bibr">Gelman &amp; Hill, 2007</xref>) have been slowly superseding traditional models like repeated-measures ANOVA or the two-stage hierarchical approach used here. LMMs allow to model the hierarchical structure of single-subject and group-level data directly and have several other advantages, for example, when analyzing unbalanced designs (<xref rid="ref-3" ref-type="bibr">Baayen, Davidson &amp; Bates, 2007</xref>; <xref rid="ref-40" ref-type="bibr">Kliegl et al., 2010</xref>). Combining LMMs with linear deconvolution is theoretically possible (<xref rid="ref-78" ref-type="bibr">Ehinger, 2019</xref>). The main challenge is that one needs to fit all continuous EEG datasets of all participants at the same time. Thus, currently, the high computational cost of fitting such large models precludes us from taking advantage of mixed models. Nevertheless, recent progress with similarly large models (<xref rid="ref-75" ref-type="bibr">Wood et al., 2017</xref>) shows that the combination of LMMs with deconvolution modeling might be computationally feasible in future implementations.</p>
    </sec>
    <sec>
      <title>Other physiological signals</title>
      <p>Finally, it is also possible to model other types of overlapping psychophysiological signals with <italic>unfold</italic>, such as overlapping magnetic fields (MEG, <xref rid="ref-44" ref-type="bibr">Litvak et al., 2013</xref>), pupil dilations (<xref rid="ref-71" ref-type="bibr">Wierda et al., 2012</xref>; <xref rid="ref-30" ref-type="bibr">Gagl, Hawelka &amp; Hutzler, 2011</xref>) or skin conductance responses (<xref rid="ref-4" ref-type="bibr">Bach et al., 2009</xref>).</p>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p>In summary, <italic>unfold</italic> offers an integrated environment to analyze psychophysiological data influenced by overlapping responses, (non)linear covariates, or both. As we show above, this analysis strategy can be beneficial even in the case of “traditional,” highly-controlled ERP experiments. It also allows us to record EEG data under more natural situations, for example, those with unconstrained eye movement behavior, which is typical for the emerging fields of virtual reality and mobile brain/body imaging studies. Applications of <italic>unfold</italic> to free viewing studies can be found in an accompanying paper (<xref rid="ref-20" ref-type="bibr">Dimigen &amp; Ehinger, 2019</xref>). The toolbox is freely available at <uri xlink:href="http://www.unfoldtoolbox.org">http://www.unfoldtoolbox.org</uri> with tutorials and documentation.</p>
  </sec>
</body>
<back>
  <sec sec-type="additional-information">
    <title>Additional Information and Declarations</title>
    <fn-group content-type="competing-interests">
      <title>Competing Interests</title>
      <fn fn-type="COI-statement" id="conflict-1">
        <p>The authors declare that they have no competing interests.</p>
      </fn>
    </fn-group>
    <fn-group content-type="author-contributions">
      <title>Author Contributions</title>
      <fn fn-type="con" id="contribution-1">
        <p><xref ref-type="contrib" rid="author-1">Benedikt V. Ehinger</xref> analyzed the data, contributed reagents/materials/analysis tools, prepared figures and/or tables, authored or reviewed drafts of the paper, approved the final draft, wrote the toolbox.</p>
      </fn>
      <fn fn-type="con" id="contribution-2">
        <p><xref ref-type="contrib" rid="author-2">Olaf Dimigen</xref> conceived and designed the experiments, performed the experiments, analyzed the data, contributed reagents/materials/analysis tools, prepared figures and/or tables, authored or reviewed drafts of the paper, approved the final draft, co-developed the toolbox.</p>
      </fn>
    </fn-group>
    <fn-group content-type="other">
      <title>Human Ethics</title>
      <fn id="addinfo-1">
        <p>The following information was supplied relating to ethical approvals (i.e., approving body and any reference numbers):</p>
        <p>For this methods paper, we reanalyzed data of a single subject from an ERP dataset that was previously published elsewhere (in: <xref rid="ref-22" ref-type="bibr">Dimigen et al., 2009</xref>, Journal of Neuroscience, Supplementary Materials). These data were originally recorded in 2008 and therefore at a time before it was required to apply for a study-specific ethics commission approval to run standard ERP experiments at the Humboldt-University at Berlin.</p>
      </fn>
    </fn-group>
    <fn-group content-type="other">
      <title>Data Availability</title>
      <fn id="addinfo-2">
        <p>The following information was supplied regarding data availability:</p>
        <p>Data is available at the Open Science Foundation (<uri xlink:href="https://osf.io/wbz7x">https://osf.io/wbz7x</uri>) and Github (<uri xlink:href="https://github.com/unfoldtoolbox/unfold">https://github.com/unfoldtoolbox/unfold</uri>).</p>
      </fn>
    </fn-group>
  </sec>
  <ref-list content-type="authoryear">
    <title>References</title>
    <ref id="ref-1">
      <label>Alday (2019)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alday</surname>
            <given-names>PM</given-names>
          </name>
        </person-group>
        <article-title>How much baseline correction do we need in ERP research? Extended GLM model can replace baseline correction while lifting its limits</article-title>
        <source>Psychophysiology</source>
        <year>2019</year>
        <volume>94</volume>
        <issue>1</issue>
        <fpage>206</fpage>
        <pub-id pub-id-type="doi">10.1111/psyp.13451</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-2">
      <label>Amsel (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Amsel</surname>
            <given-names>BD</given-names>
          </name>
        </person-group>
        <article-title>Tracking real-time neural activation of conceptual knowledge using single-trial event-related potentials</article-title>
        <source>Neuropsychologia</source>
        <year>2011</year>
        <volume>49</volume>
        <issue>5</issue>
        <fpage>970</fpage>
        <lpage>983</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuropsychologia.2011.01.003</pub-id>
        <pub-id pub-id-type="pmid">21219919</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-3">
      <label>Baayen, Davidson &amp; Bates (2007)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baayen</surname>
            <given-names>HR</given-names>
          </name>
          <name>
            <surname>Davidson</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Bates</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>Mixed-effects modeling with crossed random effects for subjects and items</article-title>
        <source>Journal of Memory and Language</source>
        <year>2007</year>
        <volume>59</volume>
        <issue>4</issue>
        <fpage>390</fpage>
        <lpage>412</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jml.2007.12.005</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-4">
      <label>Bach et al. (2009)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bach</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Flandin</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Friston</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Dolan</surname>
            <given-names>RJ</given-names>
          </name>
        </person-group>
        <article-title>Time-series analysis for rapid event-related skin conductance responses</article-title>
        <source>Journal of Neuroscience Methods</source>
        <year>2009</year>
        <volume>184</volume>
        <issue>2</issue>
        <fpage>224</fpage>
        <lpage>234</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jneumeth.2009.08.005</pub-id>
        <pub-id pub-id-type="pmid">19686778</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-5">
      <label>Bigdely-Shamlo et al. (2018)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bigdely-Shamlo</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Touyran</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ojeda</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kothe</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Mullen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Robbins</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Automated EEG mega-analysis II: cognitive aspects of event related features</article-title>
        <source>BiorXiv</source>
        <year>2018</year>
        <pub-id pub-id-type="doi">10.1101/411371</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-6">
      <label>Broderick et al. (2018)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Broderick</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Di Liberto</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Crosse</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Lalor</surname>
            <given-names>EC</given-names>
          </name>
        </person-group>
        <article-title>Electrophysiological correlates of semantic dissimilarity reflect the comprehension of natural, narrative speech</article-title>
        <source>Current Biology</source>
        <year>2018</year>
        <volume>28</volume>
        <issue>5</issue>
        <fpage>803</fpage>
        <lpage>809.e3</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cub.2018.01.080</pub-id>
        <pub-id pub-id-type="pmid">29478856</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-7">
      <label>Burns et al. (2013)</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Burns</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Bigdely-Shamlo</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Kreutz-Delgado</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Makeig</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Comparison of averaging and regression techniques for estimating event related potentials</article-title>
        <year>2013</year>
        <conf-name>Conference Proceedings: Annual International Conference of the IEEE Engineering in Medicine and Biology Society</conf-name>
        <publisher-loc>Piscataway</publisher-loc>
        <publisher-name>IEEE</publisher-name>
        <fpage>1680</fpage>
        <lpage>1683</lpage>
        <pub-id pub-id-type="doi">10.1109/EMBC.2013.6609841</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-8">
      <label>Burwell et al. (2019)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Burwell</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Makeig</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Iacono</surname>
            <given-names>WG</given-names>
          </name>
          <name>
            <surname>Malone</surname>
            <given-names>SM</given-names>
          </name>
        </person-group>
        <article-title>Reduced premovement positivity during the stimulus-response interval precedes errors: using single-trial and regression ERPs to understand performance deficits in ADHD</article-title>
        <source>Psychophysiology</source>
        <year>2019</year>
        <volume>190</volume>
        <issue>2</issue>
        <elocation-id>e13392</elocation-id>
        <pub-id pub-id-type="doi">10.1111/psyp.13392</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-9">
      <label>Coco, Nuthmann &amp; Dimigen (2018)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coco</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Nuthmann</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dimigen</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Fixation-related brain activity during semantic integration of object-scene information</article-title>
        <source>PsyArXiv</source>
        <year>2018</year>
        <pub-id pub-id-type="doi">10.31234/osf.io/efq48</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-10">
      <label>Cohen (2017)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cohen</surname>
            <given-names>MX</given-names>
          </name>
        </person-group>
        <article-title>Comparison of linear spatial filters for identifying oscillatory activity in multichannel data</article-title>
        <source>Journal of Neuroscience Methods</source>
        <year>2017</year>
        <volume>278</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jneumeth.2016.12.016</pub-id>
        <pub-id pub-id-type="pmid">28034726</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-11">
      <label>Cornelissen, Sassenhagen &amp; Võ (2019)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cornelissen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sassenhagen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Võ</surname>
            <given-names>ML-H</given-names>
          </name>
        </person-group>
        <article-title>Improving free-viewing fixation-related EEG potentials with continuous-time regression</article-title>
        <source>Journal of Neuroscience Methods</source>
        <year>2019</year>
        <volume>313</volume>
        <fpage>77</fpage>
        <lpage>94</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jneumeth.2018.12.010</pub-id>
        <pub-id pub-id-type="pmid">30590085</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-12">
      <label>Crosse et al. (2016)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crosse</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Di Liberto</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Bednar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lalor</surname>
            <given-names>EC</given-names>
          </name>
        </person-group>
        <article-title>The multivariate temporal response function (mTRF) toolbox: a MATLAB toolbox for relating neural signals to continuous stimuli</article-title>
        <source>Frontiers in Human Neuroscience</source>
        <year>2016</year>
        <volume>10</volume>
        <fpage>3958</fpage>
        <pub-id pub-id-type="doi">10.3389/fnhum.2016.00604</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-13">
      <label>Dale &amp; Buckner (1997)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dale</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Buckner</surname>
            <given-names>RL</given-names>
          </name>
        </person-group>
        <article-title>Selective averaging of rapidly presented individual trials using fMRI</article-title>
        <source>Human Brain Mapping</source>
        <year>1997</year>
        <volume>5</volume>
        <issue>5</issue>
        <fpage>329</fpage>
        <lpage>340</lpage>
        <pub-id pub-id-type="doi">10.1002/(SICI)1097-0193(1997)5:5&lt;329::AID-HBM1&gt;3.0.CO;2-5</pub-id>
        <pub-id pub-id-type="pmid">20408237</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-14">
      <label>Dandekar et al. (2012a)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dandekar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ding</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Privitera</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Carney</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>The Fixation and Saccade P3</article-title>
        <source>PLOS ONE</source>
        <year>2012a</year>
        <volume>7</volume>
        <issue>11</issue>
        <elocation-id>e48761</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0048761</pub-id>
        <pub-id pub-id-type="pmid">23144959</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-15">
      <label>Dandekar et al. (2012b)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dandekar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Privitera</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Carney</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>Neural saccadic response estimation during natural viewing</article-title>
        <source>Journal of Neurophysiology</source>
        <year>2012b</year>
        <volume>107</volume>
        <issue>6</issue>
        <fpage>1776</fpage>
        <lpage>1790</lpage>
        <pub-id pub-id-type="doi">10.1152/jn.00237.2011</pub-id>
        <pub-id pub-id-type="pmid">22170971</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-16">
      <label>De Casteljau (1959)</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>De Casteljau</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <source>Courbes à pôles</source>
        <year>1959</year>
        <publisher-loc>Paris</publisher-loc>
        <publisher-name>Citroen</publisher-name>
      </element-citation>
    </ref>
    <ref id="ref-17">
      <label>Delgado &amp; Ozdamar (2004)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Delgado</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Ozdamar</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Deconvolution of evoked responses obtained at high stimulus rates</article-title>
        <source>Journal of the Acoustical Society of America</source>
        <year>2004</year>
        <volume>115</volume>
        <issue>3</issue>
        <fpage>1242</fpage>
        <lpage>1251</lpage>
        <pub-id pub-id-type="doi">10.1121/1.1639327</pub-id>
        <pub-id pub-id-type="pmid">15058345</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-18">
      <label>Delorme &amp; Makeig (2004)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Delorme</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Makeig</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>EEGLAB: an open source toolbox for analysis of single-trial EEG dynamics including independent component analysis</article-title>
        <source>Journal of Neuroscience Methods</source>
        <year>2004</year>
        <volume>134</volume>
        <issue>1</issue>
        <fpage>9</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jneumeth.2003.10.009</pub-id>
        <pub-id pub-id-type="pmid">15102499</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-19">
      <label>Delorme et al. (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Delorme</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Palmer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Onton</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Oostenveld</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Makeig</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Independent EEG sources are dipolar</article-title>
        <source>PLOS ONE</source>
        <year>2012</year>
        <volume>7</volume>
        <issue>2</issue>
        <elocation-id>e30135</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0030135</pub-id>
        <pub-id pub-id-type="pmid">22355308</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-20">
      <label>Dimigen &amp; Ehinger (2019)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dimigen</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Ehinger</surname>
            <given-names>BV</given-names>
          </name>
        </person-group>
        <article-title>Analyzing combined eye-tracking/EEG experiments with (non)linear deconvolution models</article-title>
        <source>BioRxiv</source>
        <year>2019</year>
        <pub-id pub-id-type="doi">10.1101/735530</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-21">
      <label>Dimigen et al. (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dimigen</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Sommer</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Hohlfeld</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jacobs</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Kliegl</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Coregistration of eye movements and EEG in natural reading: analyses and review</article-title>
        <source>Journal of Experimental Psychology: General</source>
        <year>2011</year>
        <volume>140</volume>
        <issue>4</issue>
        <fpage>552</fpage>
        <lpage>572</lpage>
        <pub-id pub-id-type="doi">10.1037/a0023885</pub-id>
        <pub-id pub-id-type="pmid">21744985</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-22">
      <label>Dimigen et al. (2009)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dimigen</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Valsecchi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sommer</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Kliegl</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Human microsaccade-related visual brain responses</article-title>
        <source>Journal of Neuroscience</source>
        <year>2009</year>
        <volume>29</volume>
        <issue>39</issue>
        <fpage>12321</fpage>
        <lpage>12331</lpage>
        <pub-id pub-id-type="doi">10.1523/JNEUROSCI.0911-09.2009</pub-id>
        <pub-id pub-id-type="pmid">19793991</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-23">
      <label>Ditman, Holcomb &amp; Kuperberg (2007)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ditman</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Holcomb</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Kuperberg</surname>
            <given-names>GR</given-names>
          </name>
        </person-group>
        <article-title>An investigation of concurrent ERP and self-paced reading methodologies</article-title>
        <source>Psychophysiology</source>
        <year>2007</year>
        <volume>44</volume>
        <issue>6</issue>
        <fpage>927</fpage>
        <lpage>935</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1469-8986.2007.00593.x</pub-id>
        <pub-id pub-id-type="pmid">17850242</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-24">
      <label>Ehinger (2018)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Ehinger</surname>
            <given-names>BV</given-names>
          </name>
        </person-group>
        <article-title>EEGVIS toolbox</article-title>
        <year>2018</year>
        <uri>https: //Github.Com/Behinger/Eegvis/</uri>
      </element-citation>
    </ref>
    <ref id="ref-78">
      <label>Ehinger (2019)</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Ehinger</surname>
            <given-names>BV</given-names>
          </name>
        </person-group>
        <article-title>Unmixed: Linear Mixed Models combined with Overlap Correction for M/EEG analyses. An Extension to the unfold Toolbox</article-title>
        <year>2019</year>
        <conf-name>Conference on Cognitive Computational Neuroscience</conf-name>
        <conf-loc>Berlin, Germany</conf-loc>
      </element-citation>
    </ref>
    <ref id="ref-25">
      <label>Ehinger et al. (2014)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ehinger</surname>
            <given-names>BV</given-names>
          </name>
          <name>
            <surname>Fischer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gert</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Kaufhold</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Pipa</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>König</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Kinesthetic and vestibular information modulate alpha activity during spatial navigation: a mobile EEG study</article-title>
        <source>Frontiers in Human Neuroscience</source>
        <year>2014</year>
        <volume>8</volume>
        <fpage>71</fpage>
        <pub-id pub-id-type="doi">10.3389/fnhum.2014.00071</pub-id>
        <pub-id pub-id-type="pmid">24616681</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-26">
      <label>Eysholdt &amp; Schreiner (1982)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eysholdt</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Schreiner</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Maximum length sequences-a fast method for measuring brain-stem-evoked responses</article-title>
        <source>Audiology</source>
        <year>1982</year>
        <volume>21</volume>
        <issue>3</issue>
        <fpage>242</fpage>
        <lpage>250</lpage>
        <pub-id pub-id-type="doi">10.3109/00206098209072742</pub-id>
        <pub-id pub-id-type="pmid">7092727</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-27">
      <label>Fong &amp; Saunders (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fong</surname>
            <given-names>DC-L</given-names>
          </name>
          <name>
            <surname>Saunders</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>LSMR: an iterative algorithm for sparse least-squares problems</article-title>
        <source>SIAM Journal on Scientific Computing</source>
        <year>2011</year>
        <volume>33</volume>
        <issue>5</issue>
        <fpage>2950</fpage>
        <lpage>2971</lpage>
        <pub-id pub-id-type="doi">10.1137/10079687X</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-28">
      <label>Frömer, Maier &amp; Abdel Rahman (2018)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frömer</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Maier</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Abdel Rahman</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Group-level EEG-processing pipeline for flexible single trial-based analyses including linear mixed models</article-title>
        <source>Frontiers in Neuroscience</source>
        <year>2018</year>
        <volume>12</volume>
        <fpage>970</fpage>
        <pub-id pub-id-type="doi">10.3389/fnins.2018.00048</pub-id>
        <pub-id pub-id-type="pmid">30618589</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-29">
      <label>Gaarder et al. (1964)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gaarder</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Krauskopf</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Graf</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Kropfl</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Armington</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Averaged brain activity following saccadic eye movement</article-title>
        <source>Science</source>
        <year>1964</year>
        <volume>146</volume>
        <issue>3650</issue>
        <fpage>1481</fpage>
        <lpage>1483</lpage>
        <pub-id pub-id-type="doi">10.1126/science.146.3650.1481</pub-id>
        <pub-id pub-id-type="pmid">14208580</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-30">
      <label>Gagl, Hawelka &amp; Hutzler (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gagl</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hawelka</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hutzler</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Systematic influence of gaze position on pupil size measurement: analysis and correction</article-title>
        <source>Behavior Research Methods</source>
        <year>2011</year>
        <volume>43</volume>
        <issue>4</issue>
        <fpage>1171</fpage>
        <lpage>1181</lpage>
        <pub-id pub-id-type="doi">10.3758/s13428-011-0109-5</pub-id>
        <pub-id pub-id-type="pmid">21637943</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-31">
      <label>Gelman &amp; Hill (2007)</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Gelman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <source>Data analysis using regression and multilevel/hierarchical models</source>
        <year>2007</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Policy Analysis</publisher-name>
      </element-citation>
    </ref>
    <ref id="ref-32">
      <label>Gramann et al. (2014)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gramann</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Jung</surname>
            <given-names>T-P</given-names>
          </name>
          <name>
            <surname>Ferris</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>C-T</given-names>
          </name>
          <name>
            <surname>Makeig</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Toward a new cognitive neuroscience: modeling natural brain dynamics</article-title>
        <source>Frontiers in Human Neuroscience</source>
        <year>2014</year>
        <volume>8</volume>
        <issue>271</issue>
        <fpage>9</fpage>
        <pub-id pub-id-type="doi">10.3389/fnhum.2014.00444</pub-id>
        <pub-id pub-id-type="pmid">24478675</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-33">
      <label>Gramfort et al. (2014)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gramfort</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Luessi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Larson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Engemann</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Strohmeier</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Brodbeck</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Parkkonen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hämäläinen</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>MNE software for processing MEG and EEG data</article-title>
        <source>NeuroImage</source>
        <year>2014</year>
        <volume>86</volume>
        <fpage>446</fpage>
        <lpage>460</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2013.10.027</pub-id>
        <pub-id pub-id-type="pmid">24161808</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-34">
      <label>Halliday (1982)</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Halliday</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Halliday</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>The visual evoked potentials in healthy subjects</article-title>
        <source>Evoked Potentials in Clinical Testing</source>
        <year>1982</year>
        <publisher-loc>London</publisher-loc>
        <publisher-name>Churghill Livingstone</publisher-name>
        <fpage>57</fpage>
        <lpage>113</lpage>
      </element-citation>
    </ref>
    <ref id="ref-35">
      <label>Hansen (1983)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hansen</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Separation of overlapping waveforms having known temporal distributions</article-title>
        <source>Journal of Neuroscience Methods</source>
        <year>1983</year>
        <volume>9</volume>
        <issue>2</issue>
        <fpage>127</fpage>
        <lpage>139</lpage>
        <pub-id pub-id-type="doi">10.1016/0165-0270(83)90126-7</pub-id>
        <pub-id pub-id-type="pmid">6316039</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-36">
      <label>Harrell (2015)</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Harrell</surname>
            <given-names>FE</given-names>
          </name>
        </person-group>
        <article-title>Multivariable modeling strategies</article-title>
        <source>Regression Modeling Strategies. Springer Series in Statistics</source>
        <year>2015</year>
        <publisher-loc>Cham</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="ref-37">
      <label>Hauk et al. (2006)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hauk</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Ford</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pulvermüller</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Marslen-Wilson</surname>
            <given-names>WD</given-names>
          </name>
        </person-group>
        <article-title>The time course of visual word recognition as revealed by linear regression analysis of ERP data</article-title>
        <source>NeuroImage</source>
        <year>2006</year>
        <volume>30</volume>
        <issue>4</issue>
        <fpage>1383</fpage>
        <lpage>1400</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2005.11.048</pub-id>
        <pub-id pub-id-type="pmid">16460964</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-38">
      <label>Hussin, Abdullah &amp; Mohamed (2010)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hussin</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Abdullah</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Mohamed</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>A complex linear regression model</article-title>
        <source>Sains Malaysiana</source>
        <year>2010</year>
        <volume>39</volume>
        <issue>3</issue>
        <fpage>491</fpage>
        <lpage>494</lpage>
      </element-citation>
    </ref>
    <ref id="ref-39">
      <label>Jewett et al. (2004)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jewett</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Caplovitz</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Baird</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Trumpis</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Olson</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Larson-Prior</surname>
            <given-names>LJ</given-names>
          </name>
        </person-group>
        <article-title>The use of QSD (q-sequence deconvolution) to recover superposed, transient evoked-responses</article-title>
        <source>Clinical Neurophysiology</source>
        <year>2004</year>
        <volume>115</volume>
        <issue>12</issue>
        <fpage>2754</fpage>
        <lpage>2775</lpage>
        <pub-id pub-id-type="doi">10.1016/j.clinph.2004.06.014</pub-id>
        <pub-id pub-id-type="pmid">15546784</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-40">
      <label>Kliegl et al. (2010)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kliegl</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Dambacher</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Experimental effects and individual differences in linear mixed models: estimating the relationship between spatial, object, and attraction effects in visual attention</article-title>
        <source>Frontiers in Psychology</source>
        <year>2010</year>
        <volume>1</volume>
        <fpage>238</fpage>
        <pub-id pub-id-type="doi">10.3389/fpsyg.2010.00238</pub-id>
        <pub-id pub-id-type="pmid">21833292</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-41">
      <label>Kristensen, Rivet &amp; Guérin-Dugué (2017a)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kristensen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Rivet</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Guérin-Dugué</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Regularization and a general linear model for event-related potential estimation</article-title>
        <source>Behavior Research Methods</source>
        <year>2017a</year>
        <volume>49</volume>
        <issue>6</issue>
        <fpage>2255</fpage>
        <lpage>2274</lpage>
        <pub-id pub-id-type="doi">10.3758/s13428-017-0856-z</pub-id>
        <pub-id pub-id-type="pmid">28275950</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-42">
      <label>Kristensen, Rivet &amp; Guérin-Dugué (2017b)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kristensen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Rivet</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Guérin-Dugué</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Estimation of overlapped eye fixation related potentials: the general linear model, a more flexible framework than the ADJAR algorithm</article-title>
        <source>Journal of Eye Movement Research</source>
        <year>2017b</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>27</lpage>
        <pub-id pub-id-type="doi">10.16910/JEMR.10.1.7</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-43">
      <label>Lalor et al. (2006)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lalor</surname>
            <given-names>EC</given-names>
          </name>
          <name>
            <surname>Pearlmutter</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Reilly</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>McDarby</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Foxe</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>The VESPA: a method for the rapid estimation of a visual evoked potential</article-title>
        <source>NeuroImage</source>
        <year>2006</year>
        <volume>32</volume>
        <issue>4</issue>
        <fpage>1549</fpage>
        <lpage>1561</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2006.05.054</pub-id>
        <pub-id pub-id-type="pmid">16875844</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-44">
      <label>Litvak et al. (2013)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Litvak</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Jha</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Flandin</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Friston</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Convolution models for induced electromagnetic responses</article-title>
        <source>NeuroImage</source>
        <year>2013</year>
        <volume>64</volume>
        <issue>1</issue>
        <fpage>388</fpage>
        <lpage>398</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2012.09.014</pub-id>
        <pub-id pub-id-type="pmid">22982359</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-45">
      <label>Lopez-Calderon &amp; Luck (2014)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lopez-Calderon</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Luck</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>ERPLAB: an open-source toolbox for the analysis of event-related potentials</article-title>
        <source>Frontiers in Human Neuroscience</source>
        <year>2014</year>
        <volume>8</volume>
        <fpage>213</fpage>
        <pub-id pub-id-type="doi">10.3389/fnhum.2014.00213</pub-id>
        <pub-id pub-id-type="pmid">24782741</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-46">
      <label>Luong (2016)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Luong</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Free-knot spline approximation</article-title>
        <year>2016</year>
        <uri xlink:href="https://de.mathworks.com/matlabcentral/fileexchange/25872-free-knot-spline-approximation">https://de.mathworks.com/matlabcentral/fileexchange/25872-free-knot-spline-approximation</uri>
      </element-citation>
    </ref>
    <ref id="ref-47">
      <label>Lütkenhöner (2010)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lütkenhöner</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Baseline correction of overlapping event-related responses using a linear deconvolution technique</article-title>
        <source>NeuroImage</source>
        <year>2010</year>
        <volume>52</volume>
        <issue>1</issue>
        <fpage>86</fpage>
        <lpage>96</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2010.03.053</pub-id>
        <pub-id pub-id-type="pmid">20347999</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-48">
      <label>Makeig et al. (1996)</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Makeig</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bell</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Jung</surname>
            <given-names>T-P</given-names>
          </name>
          <name>
            <surname>Sejnowski</surname>
            <given-names>TJ</given-names>
          </name>
        </person-group>
        <article-title>Independent component analysis of electroencephalographic data</article-title>
        <source>Advances in Neural Information Processing Systems</source>
        <year>1996</year>
        <volume>8</volume>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>MIT Press</publisher-name>
        <fpage>145</fpage>
        <lpage>151</lpage>
      </element-citation>
    </ref>
    <ref id="ref-49">
      <label>Marsh (1992)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marsh</surname>
            <given-names>RR</given-names>
          </name>
        </person-group>
        <article-title>Signal to noise constraints on maximum length sequence auditory Brain-Stem responses</article-title>
        <source>Ear and Hearing</source>
        <year>1992</year>
        <volume>13</volume>
        <issue>6</issue>
        <fpage>396</fpage>
        <lpage>400</lpage>
        <pub-id pub-id-type="doi">10.1097/00003446-199212000-00004</pub-id>
        <pub-id pub-id-type="pmid">1487100</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-50">
      <label>Mensen &amp; Khatami (2013)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mensen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Khatami</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Advanced EEG analysis using threshold-free cluster-enhancement and non-parametric statistics</article-title>
        <source>NeuroImage</source>
        <year>2013</year>
        <volume>67</volume>
        <fpage>111</fpage>
        <lpage>118</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2012.10.027</pub-id>
        <pub-id pub-id-type="pmid">23123297</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-51">
      <label>Nunez &amp; Srinivasan (2006)</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Nunez</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Srinivasan</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <source>Electric fields of the brain: the neurophysics of EEG</source>
        <year>2006</year>
        <publisher-loc>Oxford</publisher-loc>
        <publisher-name>Oxford University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="ref-52">
      <label>Oostenveld et al. (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oostenveld</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Fries</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Maris</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Schoffelen</surname>
            <given-names>J-M</given-names>
          </name>
        </person-group>
        <article-title>FieldTrip: open source software for advanced analysis of MEG, EEG, and invasive electrophysiological data</article-title>
        <source>Computational Intelligence and Neuroscience</source>
        <year>2011</year>
        <volume>2011</volume>
        <issue>1</issue>
        <fpage>156869</fpage>
        <pub-id pub-id-type="doi">10.1155/2011/156869</pub-id>
        <pub-id pub-id-type="pmid">21253357</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-53">
      <label>Ossandón, König &amp; Heed (2019)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ossandón</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>König</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Heed</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Spatially modulated alpha-band activity does not mediate tactile remapping and fast overt orienting behavior</article-title>
        <source>BioRxiv</source>
        <year>2019</year>
        <pub-id pub-id-type="doi">10.1101/576850</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-54">
      <label>Ouyang et al. (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ouyang</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Herzmann</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sommer</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Residue iteration decomposition (RIDE): a new method to separate ERP components on the basis of latency variability in single trials</article-title>
        <source>Psychophysiology</source>
        <year>2011</year>
        <volume>48</volume>
        <issue>12</issue>
        <fpage>1631</fpage>
        <lpage>1647</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1469-8986.2011.01269.x</pub-id>
        <pub-id pub-id-type="pmid">21895682</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-55">
      <label>Ouyang, Sommer &amp; Zhou (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ouyang</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sommer</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>A toolbox for residue iteration decomposition (RIDE)—A method for the decomposition, reconstruction, and single trial analysis of event related potentials</article-title>
        <source>Journal of Neuroscience Methods</source>
        <year>2015</year>
        <volume>250</volume>
        <fpage>7</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jneumeth.2014.10.009</pub-id>
        <pub-id pub-id-type="pmid">25455337</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-56">
      <label>Penny et al. (2006)</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Penny</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Friston</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ashburner</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kiebel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nichols</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <source>Statistical parametric mapping: the analysis of functional brain images</source>
        <year>2006</year>
        <volume>8</volume>
        <publisher-loc>London</publisher-loc>
        <publisher-name>Elsevier/Academic Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="ref-57">
      <label>Pernet et al. (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pernet</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Chauveau</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Gaspar</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Rousselet</surname>
            <given-names>GA</given-names>
          </name>
        </person-group>
        <article-title>LIMO EEG: a toolbox for Hierarchical LInear MOdeling of ElectroEncephaloGraphic data</article-title>
        <source>Computational Intelligence and Neuroscience</source>
        <year>2011</year>
        <volume>2011</volume>
        <issue>3</issue>
        <fpage>831409</fpage>
        <pub-id pub-id-type="doi">10.1155/2011/831409</pub-id>
        <pub-id pub-id-type="pmid">21403915</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-58">
      <label>Qian et al. (2013)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Qian</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Simon</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Glmnet for Matlab</article-title>
        <year>2013</year>
        <uri xlink:href="http://www.stanford.edu/~hastie/glmnet_matlab/">http://www.stanford.edu/∼hastie/glmnet_matlab/</uri>
      </element-citation>
    </ref>
    <ref id="ref-59">
      <label>Runge (1901)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Runge</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Über empirische Funktionen und die Interpolation zwischen äquidistanten Ordinaten</article-title>
        <source>Zeitschrift Für Mathematik Und Physik</source>
        <year>1901</year>
        <volume>46</volume>
        <fpage>224</fpage>
        <lpage>243</lpage>
      </element-citation>
    </ref>
    <ref id="ref-60">
      <label>Sassenhagen (2018)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sassenhagen</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>How to analyse electrophysiological responses to naturalistic language with time-resolved multiple regression</article-title>
        <source>Language, Cognition and Neuroscience</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>474</fpage>
        <lpage>490</lpage>
        <pub-id pub-id-type="doi">10.1080/23273798.2018.1502458</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-61">
      <label>Smith (2013)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>NJ</given-names>
          </name>
        </person-group>
        <article-title>pyrERP</article-title>
        <year>2013</year>
        <uri xlink:href="https://github.com/njsmith/pyrerp/">https://github.com/njsmith/pyrerp/</uri>
      </element-citation>
    </ref>
    <ref id="ref-62">
      <label>Smith &amp; Kutas (2015a)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Kutas</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Regression-based estimation of ERP waveforms: I. The rERP framework</article-title>
        <source>Psychophysiology</source>
        <year>2015a</year>
        <volume>52</volume>
        <issue>2</issue>
        <fpage>157</fpage>
        <lpage>168</lpage>
        <pub-id pub-id-type="doi">10.1111/psyp.12317</pub-id>
        <pub-id pub-id-type="pmid">25141770</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-63">
      <label>Smith &amp; Kutas (2015b)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Kutas</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Regression-based estimation of ERP waveforms: II. Nonlinear effects, overlap correction, and practical considerations</article-title>
        <source>Psychophysiology</source>
        <year>2015b</year>
        <volume>52</volume>
        <issue>2</issue>
        <fpage>169</fpage>
        <lpage>181</lpage>
        <pub-id pub-id-type="doi">10.1111/psyp.12320</pub-id>
        <pub-id pub-id-type="pmid">25195691</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-64">
      <label>Smith &amp; Nichols (2009)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Nichols</surname>
            <given-names>TE</given-names>
          </name>
        </person-group>
        <article-title>Threshold-free cluster enhancement: addressing problems of smoothing, threshold dependence and localisation in cluster inference</article-title>
        <source>NeuroImage</source>
        <year>2009</year>
        <volume>44</volume>
        <issue>1</issue>
        <fpage>83</fpage>
        <lpage>98</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2008.03.061</pub-id>
        <pub-id pub-id-type="pmid">18501637</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-65">
      <label>Spitzer, Blankenburg &amp; Summerfield (2016)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Spitzer</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Blankenburg</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Summerfield</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Rhythmic gain control during supramodal integration of approximate number</article-title>
        <source>NeuroImage</source>
        <year>2016</year>
        <volume>129</volume>
        <fpage>470</fpage>
        <lpage>479</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2015.12.024</pub-id>
        <pub-id pub-id-type="pmid">26707891</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-66">
      <label>Talsma &amp; Woldorff (2004)</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Talsma</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Woldorff</surname>
            <given-names>MG</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Handy</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Methods for the estimation and removal of artifacts and overlap in ERP waveforms</article-title>
        <source>Event-Related Potentials: A Methods Handbook</source>
        <year>2004</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>MIT Press</publisher-name>
        <fpage>115</fpage>
        <lpage>148</lpage>
      </element-citation>
    </ref>
    <ref id="ref-67">
      <label>Van Humbeeck et al. (2018)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van Humbeeck</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Meghanathan</surname>
            <given-names>RN</given-names>
          </name>
          <name>
            <surname>Wagemans</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Van Leeuwen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Nikolaev</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <article-title>Presaccadic EEG activity predicts visual saliency in free-viewing contour integration</article-title>
        <source>Psychophysiology</source>
        <year>2018</year>
        <volume>55</volume>
        <issue>12</issue>
        <elocation-id>e13267</elocation-id>
        <pub-id pub-id-type="doi">10.1111/psyp.13267</pub-id>
        <pub-id pub-id-type="pmid">30069911</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-68">
      <label>VanRullen &amp; MacDonald (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>VanRullen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>MacDonald</surname>
            <given-names>JSP</given-names>
          </name>
        </person-group>
        <article-title>Perceptual echoes at 10 Hz in the human brain</article-title>
        <source>Current Biology</source>
        <year>2012</year>
        <volume>22</volume>
        <issue>11</issue>
        <fpage>995</fpage>
        <lpage>999</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cub.2012.03.050</pub-id>
        <pub-id pub-id-type="pmid">22560609</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-69">
      <label>Van Veen et al. (1997)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van Veen</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Van Drongelen</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Yuchtman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Suzuki</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Localization of brain electrical activity via linearly constrained minimum variance spatial filtering</article-title>
        <source>IEEE Transactions on Biomedical Engineering</source>
        <year>1997</year>
        <volume>44</volume>
        <issue>9</issue>
        <fpage>867</fpage>
        <lpage>880</lpage>
        <pub-id pub-id-type="doi">10.1109/10.623056</pub-id>
        <pub-id pub-id-type="pmid">9282479</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-70">
      <label>Wang et al. (2006)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Özdamar</surname>
            <given-names>Ö</given-names>
          </name>
          <name>
            <surname>Bohórquez</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Cheour</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Wiener filter deconvolution of overlapping evoked potentials</article-title>
        <source>Journal of Neuroscience Methods</source>
        <year>2006</year>
        <volume>158</volume>
        <issue>2</issue>
        <fpage>260</fpage>
        <lpage>270</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jneumeth.2006.05.023</pub-id>
        <pub-id pub-id-type="pmid">16814393</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-71">
      <label>Wierda et al. (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wierda</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Van Rijn</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Taatgen</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Martens</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Pupil dilation deconvolution reveals the dynamics of attention at high temporal resolution</article-title>
        <source>Proceedings of the National Academy of Sciences of the United States of America</source>
        <year>2012</year>
        <volume>109</volume>
        <issue>22</issue>
        <fpage>8456</fpage>
        <lpage>8460</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1201858109</pub-id>
        <pub-id pub-id-type="pmid">22586101</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-72">
      <label>Wilkinson &amp; Rogers (1973)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilkinson</surname>
            <given-names>GN</given-names>
          </name>
          <name>
            <surname>Rogers</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <article-title>Symbolic description of factorial models for analysis of variance</article-title>
        <source>Applied Statistics</source>
        <year>1973</year>
        <volume>22</volume>
        <issue>3</issue>
        <fpage>392</fpage>
        <pub-id pub-id-type="doi">10.2307/2346786</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-73">
      <label>Woldorff (1993)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Woldorff</surname>
            <given-names>MG</given-names>
          </name>
        </person-group>
        <article-title>Distortion of ERP averages due to overlap from temporally adjacent ERPs: analysis and correction</article-title>
        <source>Psychophysiology</source>
        <year>1993</year>
        <volume>30</volume>
        <issue>1</issue>
        <fpage>98</fpage>
        <lpage>119</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1469-8986.1993.tb03209.x</pub-id>
        <pub-id pub-id-type="pmid">8416067</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-74">
      <label>Wood (2017)</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Wood</surname>
            <given-names>SN</given-names>
          </name>
        </person-group>
        <source>Generalized additive models: an introduction with R</source>
        <year>2017</year>
        <volume>17</volume>
        <publisher-loc>Boca Raton</publisher-loc>
        <publisher-name>Texts in Statistical Science</publisher-name>
        <fpage>392</fpage>
      </element-citation>
    </ref>
    <ref id="ref-75">
      <label>Wood et al. (2017)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wood</surname>
            <given-names>SN</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Shaddick</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Augustin</surname>
            <given-names>NH</given-names>
          </name>
        </person-group>
        <article-title>Generalized additive models for Gigadata: modeling the U.K. black smoke network daily data</article-title>
        <source>Journal of the American Statistical Association</source>
        <year>2017</year>
        <volume>112</volume>
        <issue>519</issue>
        <fpage>1199</fpage>
        <lpage>1210</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.2016.1195744</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-76">
      <label>Yuval-Greenberg et al. (2008)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yuval-Greenberg</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tomer</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Keren</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Nelken</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Deouell</surname>
            <given-names>LY</given-names>
          </name>
        </person-group>
        <article-title>Transient induced gamma-band response in EEG as a manifestation of miniature saccades</article-title>
        <source>Neuron</source>
        <year>2008</year>
        <volume>58</volume>
        <issue>3</issue>
        <fpage>429</fpage>
        <lpage>441</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuron.2008.03.027</pub-id>
        <pub-id pub-id-type="pmid">18466752</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-77">
      <label>Zhang (1998)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Decomposing stimulus and response component waveforms in ERP</article-title>
        <source>Journal of Neuroscience Methods</source>
        <year>1998</year>
        <volume>80</volume>
        <issue>1</issue>
        <fpage>49</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1016/S0165-0270(97)00194-5</pub-id>
        <pub-id pub-id-type="pmid">9606050</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
