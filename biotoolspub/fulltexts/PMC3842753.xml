<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3842753</article-id>
    <article-id pub-id-type="pmid">24058055</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btt543</article-id>
    <article-id pub-id-type="publisher-id">btt543</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="heading">
          <subject>Data and Text Mining</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>customProDB</italic>: an R package to generate customized protein databases from RNA-Seq data for proteomics search</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Xiaojing</given-names>
        </name>
        <xref ref-type="aff" rid="btt543-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Bing</given-names>
        </name>
        <xref ref-type="aff" rid="btt543-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btt543-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="btt543-AFF1">
          <sup>3</sup>
        </xref>
        <xref ref-type="corresp" rid="btt543-COR1">*</xref>
      </contrib>
      <aff id="btt543-AFF1"><sup>1</sup>Department of Biomedical Informatics, <sup>2</sup>Vanderbilt-Ingram Cancer Center and <sup>3</sup>Department of Cancer Biology, Vanderbilt University School of Medicine, Nashville, TN 37232, USA</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btt543-COR1">*To whom correspondence should be addressed.</corresp>
      <fn id="fn1" fn-type="other">
        <p>Associate Editor: Jonathan Wren</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>12</month>
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>9</month>
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>9</month>
      <year>2013</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>29</volume>
    <issue>24</issue>
    <fpage>3235</fpage>
    <lpage>3237</lpage>
    <history>
      <date date-type="received">
        <day>6</day>
        <month>6</month>
        <year>2013</year>
      </date>
      <date date-type="rev-recd">
        <day>4</day>
        <month>9</month>
        <year>2013</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>9</month>
        <year>2013</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Â© The Author 2013. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2013</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial-NoDerivs licence (<uri xlink:type="simple" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">http://creativecommons.org/licenses/by-nc/3.0/</uri>) which permits non-commercial reproduction and distribution of the work, in any medium, provided the original work is not altered or transformed in any way, and that the work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> Database search is the most widely used approach for peptide and protein identification in mass spectrometry-based proteomics studies. Our previous study showed that sample-specific protein databases derived from RNA-Seq data can better approximate the real protein pools in the samples and thus improve protein identification. More importantly, single nucleotide variations, short insertion and deletions and novel junctions identified from RNA-Seq data make protein database more complete and sample-specific. Here, we report an R package <italic>customProDB</italic> that enables the easy generation of customized databases from RNA-Seq data for proteomics search. This work bridges genomics and proteomics studies and facilitates cross-omics data integration.</p>
      <p><bold>Availability and implementation:</bold><italic>customProDB</italic> and related documents are freely available at <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/2.13/bioc/html/customProDB.html">http://bioconductor.org/packages/2.13/bioc/html/customProDB.html</ext-link>.</p>
      <p>
        <bold>Contact:</bold>
        <email>bing.zhang@vanderbilt.edu</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt543/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 INTRODUCTION</title>
    <p>Sequence database search is the primary method for peptide and protein identification in mass spectrometry-based shotgun proteomics (<xref rid="btt543-B7" ref-type="bibr">Nesvizhskii, 2010</xref>). The completeness and specificity of the sequence databases directly affect the searching results. We recently showed that sample-specific databases derived from RNA-Seq data can better represent the real protein catalogs in biological samples and thus improve protein identification. In addition, sample-specific databases allow the identification of variant peptides (<xref rid="btt543-B10" ref-type="bibr">Wang <italic>et al.</italic>, 2012</xref>).</p>
    <p>With the advancements of both shotgun proteomics and next-generation sequencing (NGS) technologies, many researchers have started to apply both technologies to the same samples in parallel to gain a multi-dimensional understanding of cellular systems (<xref rid="btt543-B1" ref-type="bibr">Chen <italic>et al.</italic>, 2012</xref>; <xref rid="btt543-B6" ref-type="bibr">Nagaraj <italic>et al.</italic>, 2011</xref>). Even for proteomics studies without corresponding RNA-Seq data, it is highly likely to find sequencing data (e.g. whole-genome sequencing, exome sequencing) for similar samples. Here, we report an R package, <italic>customProDB</italic>, which is dedicated to generate customized database from NGS data, with a focus on RNA-Seq data, for proteomics search.</p>
    <p>Based on the assumption that undetected or lowly expressed transcripts are less likely to produce detectable proteins, the package allows users to filter out proteins with undetected or lowly expressed transcripts. It also allows users to incorporate single nucleotide variations, short insertion and deletions and novel junctions identified from RNA-Seq data into the protein database.</p>
    <p><xref ref-type="fig" rid="btt543-F1">Figure 1</xref> illustrates the overall structure of the package. Methods and functions implemented in the <italic>customProDB</italic> package are described in detail in a tutorial available as online <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt543/-/DC1">Supplementary Material</ext-link> (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt543/-/DC1">Supplementary File 1</ext-link>). In section 2, we briefly present the main functionalities of the <italic>customProDB</italic> package.
<fig id="btt543-F1" position="float"><label>Fig. 1.</label><caption><p>Schematic overview of the <italic>customProDB</italic> package</p></caption><graphic xlink:href="btt543f1p"/></fig></p>
  </sec>
  <sec id="SEC2">
    <title>2 DESCRIPTION</title>
    <sec id="SEC2.1">
      <title>2.1 Preparing annotation files</title>
      <p>For model organisms, <italic>customProDB</italic> allows users to download annotation data from the University of California, Santa Cruz (UCSC) table browser using <italic>rtracklayer</italic> (<xref rid="btt543-B3" ref-type="bibr">Lawrence <italic>et al.</italic>, 2009</xref>) or from ENSEMBL using <italic>biomaRt</italic> (<xref rid="btt543-B2" ref-type="bibr">Durinck <italic>et al.</italic>, 2009</xref>) and then process them to generate a standardized data structure. For non-model organisms, users can manually provide the annotation data in the format of UCSC or ENSEMBL. </p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Building customized protein databases</title>
      <sec id="SEC2.2.1">
        <title>2.2.1 Input data</title>
        <p><italic>customProDB</italic> requires a Binary-sequence Alignment Format (BAM) file and a Variant Call Format (VCF) file as input for each sample of interest. The latter can be generated from a BAM file using single nucleotide polymorphism calling tools such as SAMtools and The Genome Analysis Toolkit (GATK). <italic>customProDB</italic> also accepts transcript expression estimates when available.</p>
        <p>For junction analysis, a Browser Extensible Data (BED) file that contains putative splice junctions is needed. This file can be generated by software such as Tophat (<xref rid="btt543-B9" ref-type="bibr">Trapnell <italic>et al.</italic>, 2009</xref>) during read alignment.</p>
      </sec>
      <sec id="SEC2.2.2">
        <title>2.2.2 Expression filter</title>
        <p>For a given BAM file, the <italic>calculateRPKM</italic> function computes the reads per kilobase per million reads sequenced (RPKM) for each transcript based on reads mapped to the exon region. Then the <italic>Outputproseq</italic> function outputs a FASTA file for proteins with an RPKM value greater than a user-defined cutoff. </p>
        <p>For generating a consensus database from <italic>n</italic> (<italic>n</italic> &gt; 1) related samples, a function <italic>Outputsharedpro</italic> is provided to output protein sequences for transcripts with an RPKM value greater than a user-defined cutoff in <italic>k</italic> (1 &lt; <italic>k</italic> &lt; <italic>n</italic>) out of the <italic>n</italic> samples.</p>
      </sec>
      <sec id="SEC2.2.3">
        <title>2.2.3 Variation annotation</title>
        <p>The <italic>InputVcf</italic> function generates a <italic>GRange</italic> (<xref rid="btt543-B4" ref-type="bibr">Lawrence <italic>et al.</italic>, 2013</xref>) object from a VCF file, which contains variation information from one or multiple samples. The <italic>Multiple_VCF</italic> function outputs a <italic>GRange</italic> object with variations presenting in multiple samples.</p>
        <p>For a given <italic>GRange</italic> object, the <italic>Varlocation</italic> function provides an overview of the genomic locations for all variations. Then protein level variations are identified for both single nucleotide variations and short insertion and deletions.</p>
        <p>VCF files derived from whole-genome or exome sequencing data can also be used to generate customized databases. </p>
      </sec>
      <sec id="SEC2.2.4">
        <title>2.2.4 Junction analysis</title>
        <p>Based on an input BED file that contains splice junctions derived from RNA-Seq data, the function <italic>JunctionType</italic> classifies all junctions into different categories. Then the function <italic>OutputNovelJun</italic> can be used to generate three-frame translated peptide sequences for all putative novel junctions.</p>
      </sec>
    </sec>
  </sec>
  <sec id="SEC3">
    <title>3 APPLICATION</title>
    <p>The development of the <italic>customProDB</italic> package was mainly driven by two demands: (i) to provide a customized protein database from RNA-Seq data for a specific sample, and (ii) to provide a consensus database from a pool of genetically similar samples. Therefore, we provide two integrated functions to help accomplish these tasks in a single step (<xref ref-type="fig" rid="btt543-F1">Fig. 1</xref>).</p>
    <p>The value of customized databases for individual samples has already been demonstrated (<xref rid="btt543-B10" ref-type="bibr">Wang <italic>et al.</italic>, 2012</xref>). Here, we provide an example of a consensus database. A consensus database was generated based on RNA-Seq data from 64 colon cancer samples from The Cancer Genome Atlas project (<xref rid="btt543-B8" ref-type="bibr">TCGA, 2012</xref>). Previously published proteomics data from three colon cancer patients (<xref rid="btt543-B5" ref-type="bibr">Li <italic>et al.</italic>, 2011</xref>) were searched against the consensus database (<xref ref-type="fig" rid="btt543-F2">Fig. 2</xref>). By including variation and novel junction information in the consensus database, we were able to identify variant peptides and novel junction peptides from the proteomics datasets (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt543/-/DC1">Supplementary File 2</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt543/-/DC1">3</ext-link>). We did not gain significant improvements in protein identification by applying the transcript expression threshold, possibly because of the high inter-patient heterogeneity. However, compared with the regular REfSeq database search, more peptide-spectrum matches were identified using the consensus database. This example shows the potential of using a consensus database to capture protein features shared by a cohort of samples.
<fig id="btt543-F2" position="float"><label>Fig. 2.</label><caption><p>Consensus protein database generation and proteomics search results for three independent colon cancer patients (400T, 782T, 823T)</p></caption><graphic xlink:href="btt543f2p"/></fig></p>
  </sec>
  <sec>
    <title>4 CONCLUSION</title>
    <p>The huge amount of genomic and transcriptomic data available from NGS experiments has enhanced and will continue to enhance shotgun proteomics studies. However, it is non-trivial for ordinary proteomics researchers to use such data directly. The <italic>customProDB</italic> package fills this gap by providing an efficient tool to generate customized protein databases using expression and variation information available from NGS data.</p>
    <p><italic>Funding</italic>: <funding-source>National Institutes of Health</funding-source> (grant <award-id>U24 CA159988</award-id>).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_29_24_3235__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btt543_supplementary_file1_customProDB.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="vnd.ms-excel" xlink:href="supp_btt543_supplementary_file2_variant_peptides.xlsx"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="vnd.ms-excel" xlink:href="supp_btt543_supplementary_file3_novel_junction_peptides.xlsx"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="btt543-B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Personal omics profiling reveals dynamic molecular and medical phenotypes</article-title>
        <source>Cell</source>
        <year>2012</year>
        <volume>148</volume>
        <fpage>1293</fpage>
        <lpage>1307</lpage>
        <pub-id pub-id-type="pmid">22424236</pub-id>
      </element-citation>
    </ref>
    <ref id="btt543-B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durinck</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping identifiers for the integration of genomic datasets with the R/Bioconductor package biomaRt</article-title>
        <source>Nat. Protoc.</source>
        <year>2009</year>
        <volume>4</volume>
        <fpage>1184</fpage>
        <lpage>1191</lpage>
        <pub-id pub-id-type="pmid">19617889</pub-id>
      </element-citation>
    </ref>
    <ref id="btt543-B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lawrence</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>rtracklayer: an R package for interfacing with genome browsers</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1841</fpage>
        <lpage>1842</lpage>
        <pub-id pub-id-type="pmid">19468054</pub-id>
      </element-citation>
    </ref>
    <ref id="btt543-B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lawrence</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Software for computing and annotating genomic ranges</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2013</year>
        <volume>9</volume>
        <fpage>e1003118</fpage>
        <pub-id pub-id-type="pmid">23950696</pub-id>
      </element-citation>
    </ref>
    <ref id="btt543-B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A bioinformatics workflow for variant peptide detection in shotgun proteomics</article-title>
        <source>Mol. Cell Proteomics</source>
        <year>2011</year>
        <volume>10</volume>
        <fpage>M110.006536</fpage>
      </element-citation>
    </ref>
    <ref id="btt543-B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nagaraj</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deep proteome and transcriptome mapping of a human cancer cell line</article-title>
        <source>Mol. Syst. Biol.</source>
        <year>2011</year>
        <volume>7</volume>
        <fpage>548</fpage>
        <pub-id pub-id-type="pmid">22068331</pub-id>
      </element-citation>
    </ref>
    <ref id="btt543-B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nesvizhskii</surname>
            <given-names>AI</given-names>
          </name>
        </person-group>
        <article-title>A survey of computational methods and error rate estimation procedures for peptide and protein identification in shotgun proteomics</article-title>
        <source>J. Proteomics</source>
        <year>2010</year>
        <volume>73</volume>
        <fpage>2092</fpage>
        <lpage>2123</lpage>
        <pub-id pub-id-type="pmid">20816881</pub-id>
      </element-citation>
    </ref>
    <ref id="btt543-B8">
      <element-citation publication-type="journal">
        <collab>TCGA</collab>
        <article-title>Comprehensive molecular characterization of human colon and rectal cancer</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>487</volume>
        <fpage>330</fpage>
        <lpage>337</lpage>
        <pub-id pub-id-type="pmid">22810696</pub-id>
      </element-citation>
    </ref>
    <ref id="btt543-B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>TopHat: discovering splice junctions with RNA-Seq</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1105</fpage>
        <lpage>1111</lpage>
        <pub-id pub-id-type="pmid">19289445</pub-id>
      </element-citation>
    </ref>
    <ref id="btt543-B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Protein identification using customized protein sequence databases derived from RNA-Seq data</article-title>
        <source>J. Proteome Res.</source>
        <year>2012</year>
        <volume>11</volume>
        <fpage>1009</fpage>
        <lpage>1017</lpage>
        <pub-id pub-id-type="pmid">22103967</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
