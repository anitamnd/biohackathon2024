<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7266320</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-19-29175</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0232946</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Transcriptome Analysis</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
              <subj-group>
                <subject>Transcriptome Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Alignment</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Renal System</subject>
            <subj-group>
              <subject>Kidneys</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Renal System</subject>
            <subj-group>
              <subject>Kidneys</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Molecular biology</subject>
          <subj-group>
            <subject>Molecular biology techniques</subject>
            <subj-group>
              <subject>Sequencing techniques</subject>
              <subj-group>
                <subject>RNA sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and analysis methods</subject>
        <subj-group>
          <subject>Molecular biology techniques</subject>
          <subj-group>
            <subject>Sequencing techniques</subject>
            <subj-group>
              <subject>RNA sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Molecular biology</subject>
          <subj-group>
            <subject>Macromolecular structure analysis</subject>
            <subj-group>
              <subject>RNA structure</subject>
              <subj-group>
                <subject>RNA alignment</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>RNA</subject>
              <subj-group>
                <subject>RNA structure</subject>
                <subj-group>
                  <subject>RNA alignment</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>RNA</subject>
              <subj-group>
                <subject>Messenger RNA</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genetic Loci</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RefShannon: A genome-guided transcriptome assembler using sparse flow decomposition</article-title>
      <alt-title alt-title-type="running-head">A genome-guided transcriptome assembler using sparse flow decomposition</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8203-0507</contrib-id>
        <name>
          <surname>Mao</surname>
          <given-names>Shunfu</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pachter</surname>
          <given-names>Lior</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tse</surname>
          <given-names>David</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kannan</surname>
          <given-names>Sreeram</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Electrical and Computer Engineering, University of Washington, Seattle, WA, United States of America</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Division of Biology and Biological Engineering, Caltech, Pasadena, CA, United States of America</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Department of Electrical Engineering, Stanford University, Stanford, CA, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Chen</surname>
          <given-names>Zhong-Hua</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Western Sydney, AUSTRALIA</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>ksreeram@ece.uw.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>6</month>
      <year>2020</year>
    </pub-date>
    <volume>15</volume>
    <issue>6</issue>
    <elocation-id>e0232946</elocation-id>
    <history>
      <date date-type="received">
        <day>18</day>
        <month>10</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>4</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 Mao et al</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Mao et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0232946.pdf"/>
    <abstract>
      <p>High throughput sequencing of RNA (RNA-Seq) has become a staple in modern molecular biology, with applications not only in quantifying gene expression but also in isoform-level analysis of the RNA transcripts. To enable such an isoform-level analysis, a transcriptome assembly algorithm is utilized to stitch together the observed short reads into the corresponding transcripts. This task is complicated due to the complexity of alternative splicing - a mechanism by which the same gene may generate multiple distinct RNA transcripts. We develop a novel genome-guided transcriptome assembler, RefShannon, that <italic>exploits the varying abundances</italic> of the different transcripts, in enabling an accurate reconstruction of the transcripts. Our evaluation shows RefShannon is able to improve sensitivity effectively (up to 22%) at a given specificity in comparison with other state-of-the-art assemblers. RefShannon is written in Python and is available from Github (<ext-link ext-link-type="uri" xlink:href="https://github.com/shunfumao/RefShannon">https://github.com/shunfumao/RefShannon</ext-link>).</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>1R01HG008164</award-id>
        <principal-award-recipient>
          <name>
            <surname>Pachter</surname>
            <given-names>Lior</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This project is funded by NIH award 1R01HG008164, NSF CCF-1651236, and NSF CIF-1703403.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="6"/>
      <table-count count="1"/>
      <page-count count="14"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All relevant data are within the manuscript and its Supporting Information files.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All relevant data are within the manuscript and its Supporting Information files.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>In many higher organisms including mammals, the genomic DNA is comprised of thousands of genes, along with other sequences that regulate when, where and how the genes are produced. These genes have distinct regions called exons and introns [<xref rid="pone.0232946.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0232946.ref002" ref-type="bibr">2</xref>]. By combining its exons in various ways—a procedure called alternative splicing [<xref rid="pone.0232946.ref003" ref-type="bibr">3</xref>–<xref rid="pone.0232946.ref005" ref-type="bibr">5</xref>], a gene, especially in eukaryotes, can produce multiple different messenger RNAs (mRNA [<xref rid="pone.0232946.ref006" ref-type="bibr">6</xref>], or RNA transcript in this document) that can be converted into different protein products in cells.</p>
    <p>Transcriptome is the set of RNA transcripts. With RNA sequencing technology [<xref rid="pone.0232946.ref007" ref-type="bibr">7</xref>], we can now obtain millions of short RNA fragments (RNA-seq reads) from the transcriptome. The transcriptome assembly [<xref rid="pone.0232946.ref008" ref-type="bibr">8</xref>] problem is to obtain a complete and accurate recovery of transcriptome based on observed RNA-seq reads. This helps us find new RNA transcripts as well as their expression levels (or abundance) in order to better understand proteins and cells.</p>
    <p>Transcriptome assembly is not an easy task due to several factors. Because of alternative splicing, it is possible that different set of transcripts can yield the same observation of RNA-seq reads. Adding to this complexity is the fact that distinct transcripts are expressed at different expression levels [<xref rid="pone.0232946.ref009" ref-type="bibr">9</xref>]. Thus transcripts which have low expression levels are harder to reconstruct; also, transcripts which are part of complex isoform [<xref rid="pone.0232946.ref004" ref-type="bibr">4</xref>] families are difficult to assemble correctly.</p>
    <p>There are two flavors of the transcriptome assembly problem [<xref rid="pone.0232946.ref008" ref-type="bibr">8</xref>]: de novo assembly and genome-guided (or reference-based) assembly. For de novo assembly, there is no knowledge other than that of the observed reads. This is common in non-model organisms or when an approach unbiased by prior knowledge is needed (e.g. cancer transcriptome). For genome-guided assembly, in addition to the observed reads there is also knowledge of the genome of the organism. This is common in scenarios where a model organism [<xref rid="pone.0232946.ref010" ref-type="bibr">10</xref>] is sequenced.</p>
    <p>De novo assembly is typically more challenging and less accurate than genome-guided assembly, since the latter utilizes additional side information. While algorithms and software packages are available for both the de novo (TransAByss [<xref rid="pone.0232946.ref011" ref-type="bibr">11</xref>], Trinity [<xref rid="pone.0232946.ref012" ref-type="bibr">12</xref>], OASES [<xref rid="pone.0232946.ref013" ref-type="bibr">13</xref>], SOAPdenovo-Trans [<xref rid="pone.0232946.ref014" ref-type="bibr">14</xref>] etc) and genome-guided assembly problems (Scripture [<xref rid="pone.0232946.ref015" ref-type="bibr">15</xref>], Cufflinks [<xref rid="pone.0232946.ref016" ref-type="bibr">16</xref>], StringTie [<xref rid="pone.0232946.ref017" ref-type="bibr">17</xref>], TransComb [<xref rid="pone.0232946.ref018" ref-type="bibr">18</xref>] and CLASS2 [<xref rid="pone.0232946.ref019" ref-type="bibr">19</xref>], Ryuto [<xref rid="pone.0232946.ref020" ref-type="bibr">20</xref>], Strawberry [<xref rid="pone.0232946.ref021" ref-type="bibr">21</xref>], Trinity (reference-guided mode) [<xref rid="pone.0232946.ref012" ref-type="bibr">12</xref>] etc), much remains to be done [<xref rid="pone.0232946.ref022" ref-type="bibr">22</xref>, <xref rid="pone.0232946.ref023" ref-type="bibr">23</xref>]. Recently Kannan et al [<xref rid="pone.0232946.ref024" ref-type="bibr">24</xref>] developed an assembler called Shannon assembler that utilized principles from information theory to solve the de novo transcriptome assembly problem, and demonstrated benefits over state-of-the-art assemblers. Here we develop a genome-guided assembler called RefShannon by exploiting the framework from Shannon.</p>
    <p>To begin with we note that, while genome-guided algorithms have an advantage in general, Shannon is able to recover even more transcripts than the leading genome-guided assembler StringTie when the coverage of the transcripts is high (<xref ref-type="supplementary-material" rid="pone.0232946.s001">S1 File</xref>). We attribute this to the careful utilization of transcript abundances while performing assembly in Shannon. However, as expected, for transcripts of low abundance, Shannon is inferior because the k-mer graph utilized by Shannon needs a higher coverage in order to stay connected. Therefore, it should be possible to design a genome-guided assembler, that combines the superior reconstruction method of Shannon along with the aid of the genome side-information in order to deliver optimal performance. This is the main motivation for this work—to build a superior genome-guided assembler.</p>
  </sec>
  <sec sec-type="results" id="sec002">
    <title>Results</title>
    <p>In this section, we will describe the overall work flow of RefShannon, and highlight its main ideas. To demonstrate its superior performance, we have compared RefShannon to two widely used assemblers StringTie [<xref rid="pone.0232946.ref017" ref-type="bibr">17</xref>] and Cufflinks [<xref rid="pone.0232946.ref015" ref-type="bibr">15</xref>], which are recommended in previous benchmark work [<xref rid="pone.0232946.ref023" ref-type="bibr">23</xref>]. We have also compared RefShannon to guided Trinity [<xref rid="pone.0232946.ref012" ref-type="bibr">12</xref>] and recently published Ryuto [<xref rid="pone.0232946.ref020" ref-type="bibr">20</xref>], as they show relatively good performance among various assemblers in our initial analysis using smaller datasets (<xref ref-type="supplementary-material" rid="pone.0232946.s003">S3 File</xref>). Our performance evaluation metrics include ROC (including sensitivity and false positive) for simulated datasets and sensitivity for real datasets. Lastly, we also discuss its computational complexity.</p>
    <sec id="sec003">
      <title>Overall workflow</title>
      <p>To do genome-guided transcriptome assembly based on sampled RNA-Seq reads, RefShannon takes a graph preparation step and a graph traversal step, as other assembly methods [<xref rid="pone.0232946.ref016" ref-type="bibr">16</xref>–<xref rid="pone.0232946.ref021" ref-type="bibr">21</xref>] usually do.</p>
      <p>In particular as <xref ref-type="fig" rid="pone.0232946.g001">Fig 1</xref> illustrates, RNA-Seq reads sampled from transcriptome will be aligned onto a reference genome using external tools such as STAR [<xref rid="pone.0232946.ref025" ref-type="bibr">25</xref>], Tophat2 [<xref rid="pone.0232946.ref026" ref-type="bibr">26</xref>], Hisat2 [<xref rid="pone.0232946.ref027" ref-type="bibr">27</xref>], GMAP [<xref rid="pone.0232946.ref028" ref-type="bibr">28</xref>], minimap2 [<xref rid="pone.0232946.ref029" ref-type="bibr">29</xref>] and so on. These tools are able to capture splice events (e.g. a read crossing two distinct exons of an RNA transcript can be split aligned onto the genome), which enable us to infer exon regions from read alignments and consequently do not need existing gene annotations for transcriptome assembly.</p>
      <fig id="pone.0232946.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0232946.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Overall flow of RefShannon.</title>
          <p>In this example, the true transcriptome contain 3 RNA transcripts <italic>t</italic><sub>1</sub>, <italic>t</italic><sub>2</sub>, <italic>t</italic><sub>3</sub> with expression levels <italic>f</italic><sub>1</sub> = 1, <italic>f</italic><sub>2</sub> = 2, <italic>f</italic><sub>3</sub> = 4. RNA reads are sampled from the transcriptome first, and are aligned onto a reference genome using external aligners. RefShannon will take the read alignment as input, generate splice graphs, and apply a novel sparse flow decomposition algorithm to recover the transcriptome as <inline-formula id="pone.0232946.e001"><alternatives><graphic id="pone.0232946.e001g" xlink:href="pone.0232946.e001"/><mml:math id="M1"><mml:mover accent="true"><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>
<italic>i</italic> ∈ {1, 2, 3}. The corresponding <inline-formula id="pone.0232946.e002"><alternatives><graphic id="pone.0232946.e002g" xlink:href="pone.0232946.e002"/><mml:math id="M2"><mml:mover accent="true"><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> estimates related abundance.</p>
        </caption>
        <graphic xlink:href="pone.0232946.g001"/>
      </fig>
      <p>Based on read alignments, RefShannon produces splice graphs, where each node represents a unique exonic region that is supported by aligned reads and each edge between two nodes implies there exist reads going through those nodes. Additional known paths are also collected, indicating that the nodes along the path belong to some transcript. This helps resolve flow decomposition ambiguity, as will be discussed later.</p>
      <p>Based on splice graphs, RefShannon applies a sparse flow decomposition algorithm, originally proposed in [<xref rid="pone.0232946.ref024" ref-type="bibr">24</xref>], to reconstruct the minimum number of flow paths (as assembled transcriptome) that satisfy node and edge constraints.</p>
    </sec>
    <sec id="sec004">
      <title>Main ideas</title>
      <p>We would like to highlight several main ideas (as summarized in <xref ref-type="fig" rid="pone.0232946.g002">Fig 2</xref>) that distinguish RefShannon from the existing methods (such as Cufflinks [<xref rid="pone.0232946.ref016" ref-type="bibr">16</xref>], StringTie [<xref rid="pone.0232946.ref017" ref-type="bibr">17</xref>], Ryuto [<xref rid="pone.0232946.ref020" ref-type="bibr">20</xref>] and guided Trinity [<xref rid="pone.0232946.ref012" ref-type="bibr">12</xref>] which we’ll mainly compare to) and bring its superior performance.</p>
      <fig id="pone.0232946.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0232946.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Main ideas of RefShannon.</title>
          <p>In these conceptual examples, each graph means a splice graph where nodes represent exonic regions and edges indicate there are reads aligned across the nodes. The edge weights are abundance, calculated by the number of supporting reads. (A) RefShannon explores the utility of varying abundance, which is essential for a correct decomposition of paths. For example, given that AC, CE, BC, CD have weights 1, 1, 4, 4 respectively, we’re confident to decompose the graph into two paths as ACE and BCD. (B) RefShannon adopts a sparse flow algorithm that tries to find the minimum number of paths that explains edge weight constraints (e.g. the decomposition of graph into ACE with weight 15, BCD with weight 10 and FCD with weight 8 explain the splice graph well). If we follow a greedy approach (as used by StringTie) that iteratively finds and remove the heaviest path, we will get an inaccurate transcript ACD first. (C) RefShannon extracts known path information from read alignments to resolve decomposition ambiguity. For example, when node C is decomposed, a flow ambiguity (i.e. non unique decomposition) happens: both ACE, BCE, BCD and ACE, ACD, BCE explain node C’s edge weight constraints. Suppose ACD is a known path, then the first decomposition of ACE, BCE, BCD can be excluded.</p>
        </caption>
        <graphic xlink:href="pone.0232946.g002"/>
      </fig>
      <p>To begin with, RefShannon takes a graph preparation step and graph traversal step as most existing methods do. The constructed graph is consistent with the reference genome, similar to Cufflinks, Stringtie and Ryuto. Trinity in genome-guided mode also utilizes the reference genome, but mainly to group together the reads within the same region. Essentially it still applies de novo assembly, but to smaller regions. Consequently, guided Trinity is computationally much more complicated (<xref ref-type="supplementary-material" rid="pone.0232946.s007">S7 File</xref>).</p>
      <p>One of the main ideas of RefShannon is to utilize the varying abundance information while traversing the splice graph (<xref ref-type="fig" rid="pone.0232946.g002">Fig 2A</xref>). This information is essential for a correct decomposition of flow paths. Cufflinks [<xref rid="pone.0232946.ref016" ref-type="bibr">16</xref>] does not exploit the abundance information during assembly; Instead, it relies on overlap graphs, which require a strict partial order between read alignments. Consequently Cufflinks may throw away reads (especially pair end reads) of uncertain compatibility, while those read alignments can contain useful information to construct a more accurate graph.</p>
      <p>Another idea RefShannon has adopted is the sparse flow decomposition algorithm that was initially proposed in the Shannon assembler [<xref rid="pone.0232946.ref024" ref-type="bibr">24</xref>], which applies linear programming to efficiently decompose for the minimum number of paths (flows) at each node restricted by the node’s in-edge and out-edge weights. This approach has been proved in [<xref rid="pone.0232946.ref024" ref-type="bibr">24</xref>] to work toward optimal transcriptome assembly. The similar goal of parsimonious assembly is pursued by Cufflinks [<xref rid="pone.0232946.ref016" ref-type="bibr">16</xref>], which as mentioned earlier is based on overlap graph and does not exploit abundance information. StringTie [<xref rid="pone.0232946.ref017" ref-type="bibr">17</xref>] also explores the abundance information, but it follows a sub-optimal greedy approach by iteratively extracting the heaviest path as transcript. As illustrated in <xref ref-type="fig" rid="pone.0232946.g002">Fig 2B</xref>, this will lead to incorrect assembly.</p>
      <p>In addition RefShannon has utilized pair end reads to supplement additional edge and path information so that an originally disconnected transcript could be found. A similar idea was also used in Scripture [<xref rid="pone.0232946.ref015" ref-type="bibr">15</xref>] and Ryuto [<xref rid="pone.0232946.ref020" ref-type="bibr">20</xref>]. However Scripture exhaustively enumerates all possible transcript candidates first and filter them later based on certain significance criteria. Ryuto has also adopted these information mainly during the graph construction stage. Differently, RefShannon has also applied these additional edge and path information in the graph decomposition stage so that certain assembly ambiguity can be resolved (<xref ref-type="fig" rid="pone.0232946.g002">Fig 2C</xref>). StringTie [<xref rid="pone.0232946.ref017" ref-type="bibr">17</xref>] on the other hand, does not explore these information directly; instead it relies on external software MaSuRCA [<xref rid="pone.0232946.ref030" ref-type="bibr">30</xref>] to generate super reads to fully utilize pair end reads.</p>
    </sec>
    <sec id="sec005">
      <title>Datasets</title>
      <p>Our performance evaluation is based on both simulated datasets and real datasets, as summarized in <xref rid="pone.0232946.t001" ref-type="table">Table 1</xref>.</p>
      <table-wrap id="pone.0232946.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0232946.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Data statistics.</title>
          <p>There’re three real datasets (HESC—human embryonic stem cells, LC—Lymphoblastoid cells, Kidney) and three simulated datasets (HESC-Sim, LC-Sim, Kidney-Sim) used for evaluation. PE stands for pair-end reads and SE for single-end reads. Oracle Set contains fully covered transcripts from the available reference transcripts.</p>
        </caption>
        <alternatives>
          <graphic id="pone.0232946.t001g" xlink:href="pone.0232946.t001"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" style="border-bottom:thick" rowspan="1" colspan="1"/>
                <th align="center" style="border-bottom:thick" rowspan="1" colspan="1">HESC</th>
                <th align="center" style="border-bottom:thick" rowspan="1" colspan="1">LC</th>
                <th align="center" style="border-bottom:thick" rowspan="1" colspan="1">Kidney</th>
                <th align="center" style="border-bottom:thick" rowspan="1" colspan="1">HESC-Sim</th>
                <th align="center" style="border-bottom:thick" rowspan="1" colspan="1">LC-Sim</th>
                <th align="center" style="border-bottom:thick" rowspan="1" colspan="1">Kidney-Sim</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">PE or SE</td>
                <td align="center" rowspan="1" colspan="1">SE</td>
                <td align="center" rowspan="1" colspan="1">PE</td>
                <td align="center" rowspan="1" colspan="1">PE</td>
                <td align="center" rowspan="1" colspan="1">SE</td>
                <td align="center" rowspan="1" colspan="1">PE</td>
                <td align="center" rowspan="1" colspan="1">PE</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Read Length</td>
                <td align="center" rowspan="1" colspan="1">50</td>
                <td align="center" rowspan="1" colspan="1">101</td>
                <td align="center" rowspan="1" colspan="1">100</td>
                <td align="center" rowspan="1" colspan="1">50</td>
                <td align="center" rowspan="1" colspan="1">101</td>
                <td align="center" rowspan="1" colspan="1">100</td>
              </tr>
              <tr>
                <td align="center" style="border-bottom:thick" rowspan="1" colspan="1">Num of Reads (SE) or Read Pairs (PE)</td>
                <td align="center" style="border-bottom:thick" rowspan="1" colspan="1">132.05M</td>
                <td align="center" style="border-bottom:thick" rowspan="1" colspan="1">115.36M</td>
                <td align="center" style="border-bottom:thick" rowspan="1" colspan="1">183.53M</td>
                <td align="center" style="border-bottom:thick" rowspan="1" colspan="1">150M</td>
                <td align="center" style="border-bottom:thick" rowspan="1" colspan="1">150M</td>
                <td align="center" style="border-bottom:thick" rowspan="1" colspan="1">150M</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Num of Reference Transcripts</td>
                <td align="center" rowspan="1" colspan="1">13274</td>
                <td align="center" rowspan="1" colspan="1">207266</td>
                <td align="center" rowspan="1" colspan="1">207266</td>
                <td align="center" rowspan="1" colspan="1">207266</td>
                <td align="center" rowspan="1" colspan="1">207266</td>
                <td align="center" rowspan="1" colspan="1">207266</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Num of Reference Transcripts (Oracle Set)</td>
                <td align="center" rowspan="1" colspan="1">2694</td>
                <td align="center" rowspan="1" colspan="1">32394</td>
                <td align="center" rowspan="1" colspan="1">15605</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">-</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>The real datasets include 132.05M Illumina single end reads (50-bp) sampled from human embryonic stem cells (HESC) (GSE51861 [<xref rid="pone.0232946.ref031" ref-type="bibr">31</xref>]) with 13274 reference transcripts, 115.36M Illuminar pair end reads (101-bp) sampled from Lymphoblastoid cells (LC) (SRP036136 [<xref rid="pone.0232946.ref032" ref-type="bibr">32</xref>]) with 207266 reference transcripts. We also use 183.53M Illuminar pair end reads (100-bp) sampled from HEK293T (Kidney) cells (SRX541227) previously produced and studied in StringTie [<xref rid="pone.0232946.ref017" ref-type="bibr">17</xref>]. The HESC reference transcripts are assembled by hybrid assembler IDP from the 135M short reads together with 7.8M long PacBio reads [<xref rid="pone.0232946.ref031" ref-type="bibr">31</xref>]. The LC reference transcripts are based on GENCODE annotations augmented by utilizing a combination of short reads with long PacBio reads line (700K CCS reads) [<xref rid="pone.0232946.ref032" ref-type="bibr">32</xref>]. We also use LC reference transcripts for Kidney dataset.</p>
      <p>The simulated datasets are generated based on the real ones. Specifically, we choose LC reference transcripts as the ground truth transcriptome for all simulated datasets. We then use RSEM [<xref rid="pone.0232946.ref033" ref-type="bibr">33</xref>] to learn parameters from each real dataset based on the alignments of real reads onto the reference transcripts. Based on the gound truth and learned parameters, we finally generate the relevant simulated reads.</p>
    </sec>
    <sec id="sec006">
      <title>Experiment procedure</title>
      <p>The experiment procedure is as follows. For each dataset, we first use STAR aligner [<xref rid="pone.0232946.ref025" ref-type="bibr">25</xref>] to align reads onto reference genome (human genome hg19, downloaded from <ext-link ext-link-type="uri" xlink:href="http://hgdownload.cse.ucsc.edu/goldenpath/hg19/bigZips/">http://hgdownload.cse.ucsc.edu/goldenpath/hg19/bigZips/</ext-link>) that contains multiple chromosomes. We choose STAR aligner since it offers better performance for most of the assemblers in our evaluation than using alternative aligners such as Tophat2 [<xref rid="pone.0232946.ref026" ref-type="bibr">26</xref>] and Hisat2 [<xref rid="pone.0232946.ref027" ref-type="bibr">27</xref>] (<xref ref-type="supplementary-material" rid="pone.0232946.s006">S6 File</xref>); in addition different aligners do not affect the comparison conclusions (<xref ref-type="supplementary-material" rid="pone.0232946.s003">S3 File</xref>). We then apply assemblers onto read alignments to reconstruct transcripts for all chromosomes. The assemblers which we have selected to compare RefShannon to include Cufflinks (v2.2.1), StringTie (v1.3.4d), Ryuto (v1.3m) and Trinity (v2.9.1) as they show relatively good performance in our initial analysis of various assemblers using smaller datasets (<xref ref-type="supplementary-material" rid="pone.0232946.s003">S3 File</xref>). Finally we evaluate the reconstructed transcripts, and compare them with relevant reference transcripts to see the performance of ROC (including sensitivity and false positive) for simulated datasets and sensitivity for real datasets.</p>
    </sec>
    <sec id="sec007">
      <title>ROC of simulated datasets</title>
      <p>For simulated datasets (HESC-Sim, LC-Sim, Kidney-Sim in <xref rid="pone.0232946.t001" ref-type="table">Table 1</xref>), since we know the ground truth reference transcripts, we check the performance of receiver operating characteristic curves (ROC), which includes sensitivity as well as false positive.</p>
      <p>The metric of sensitivity describes how many reference transcripts have been correctly reconstructed. To evaluate sensitivity, we first use blat (<ext-link ext-link-type="uri" xlink:href="https://genome.ucsc.edu/goldenpath/help/blatSpec.html">https://genome.ucsc.edu/goldenpath/help/blatSpec.html</ext-link>) to create a mapping between reconstructed transcripts <italic>T</italic><sub><italic>rec</italic></sub> and reference transcripts <italic>T</italic><sub><italic>ref</italic></sub>. We associate each reference transcript <italic>t</italic> ∈ <italic>T</italic><sub><italic>ref</italic></sub> with a reconstructed transcript <italic>r</italic> ∈ <italic>T</italic><sub><italic>rec</italic></sub> that mostly matches <italic>t</italic>. We then consider each <italic>t</italic> ∈ <italic>T</italic><sub><italic>ref</italic></sub> is correctly recovered if it is over 90% matched with its associated <italic>r</italic> ∈ <italic>T</italic><sub><italic>rec</italic></sub>.</p>
      <p>The metric of false positive describes how many transcripts are falsely reconstructed and do not belong to the true reference transcripts. Based on the blat result, we consider a reconstructed transcript <italic>r</italic> ∈ <italic>T</italic><sub><italic>rec</italic></sub> to be a false positive if it is below 90% matched with any reference transcript <italic>t</italic> ∈ <italic>T</italic><sub><italic>ref</italic></sub>. Note if <italic>r</italic> ∈ <italic>T</italic><sub><italic>rec</italic></sub> is contained in a reference transcript <italic>t</italic> ∈ <italic>T</italic><sub><italic>ref</italic></sub>, it is not considered to be a false positive.</p>
      <p>In addition to the threshold of 90%, we have also tried other thresholds, and it does not affect our comparison conclusions (<xref ref-type="supplementary-material" rid="pone.0232946.s005">S5 File</xref>).</p>
      <p>To have a comprehensive understanding of the ROC performance, we run StringTie and Cufflinks in both default mode and max sensitivity mode; we run Ryuto and guided Trinity in their default modes after tuning several parameters which don’t affect sensitivity much (<xref ref-type="supplementary-material" rid="pone.0232946.s004">S4 File</xref>). We also tune RefShannon so that it is able to adaptively adjust its splice graph generation as well as sparse flow decomposition output in order to trade off its sensitivity and false positive performance (<xref ref-type="supplementary-material" rid="pone.0232946.s002">S2 File</xref>).</p>
      <p><xref ref-type="fig" rid="pone.0232946.g003">Fig 3</xref> illustrates the ROC performance. Overall RefShannon shows higher sensitivity at a given false positive ratio than other assemblers. For example in simulated LC dataset, the max sensitivity point of RefShannon (the top right blue point) has higher sensitivity and lower false positive than StringTie in max sensitivity setting and the min false positive point of RefShannon (the lower left blue point) has higher sensitivity and lower false positive than Cufflinks in default setting. Quantitatively, if we fix false positive ratio at 15.5%, we obtain a sensitivity gain of 13.5% over guided Trinity which has the second best ROC point. The conclusion is similar in the Kidney dataset, where RefShannon obtains a sensitivity gain of 22% over guided Trinity at 19% false positive ratio. In the HESC dataset, RefShannon shows an ROC trend similar to guided Trinity, and has a sensitivity gain of 10.6% over Cufflinks which shows the next best ROC point at 12% false positive ratio. There is a larger gain in LC and Kidney datasets of pair-end reads than in HESC dataset of single-end reads probably because RefShannon is able to better utilize the pair-end information not only in the splice graph construction but also in the flow decomposition stage.</p>
      <fig id="pone.0232946.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0232946.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>ROC analysis of simulated datasets.</title>
        </caption>
        <graphic xlink:href="pone.0232946.g003"/>
      </fig>
    </sec>
    <sec id="sec008">
      <title>Sensitivity of real datasets</title>
      <p>For real datasets, since it’s hard to judge if a reconstructed transcript is a false positive one or an unknown transcript yet to be discovered. Therefore, we focus only on sensitivity performance which means among the known reference transcripts, how many of them are correctly recovered.</p>
      <p>The sensitivity calculation is similar to previous ROC approach. The difference is (1) For fair evaluation of sensitivity, we run assemblers all in their max sensitivity settings (detailed configurations in <xref ref-type="supplementary-material" rid="pone.0232946.s004">S4 File</xref>). (2) We only use the oracle set of reference transcripts (statistics in <xref rid="pone.0232946.t001" ref-type="table">Table 1</xref>) for each real dataset. The oracle set contains reference transcripts that are fully covered by reads (tolerated by 25 bp from both ends). We expect these well expressed reference transcripts shall be reconstructed by assemblers.</p>
      <p><xref ref-type="fig" rid="pone.0232946.g004">Fig 4</xref> shows our sensitivity evaluation for the three (i.e. LC, HESC, Kidney) real datasets. In the three subplots of first column, reference transcripts in the oracle set are grouped according to their read coverage. If a reference transcript has a low (or high) read coverage, it implies its expression level in cells is low (or high). Note the oracle sets of reference transcripts are different among three datasets, so the group values per dataset are different. For LC and Kidney datasets, most of the reference transcripts are within lower coverage. Therefore, we group the reference transcripts into read coverage of 60, 10, 10, 10 and 10 percentile. For HESC, the reference transcripts are grouped into 20 percentile each. For each dataset under various read coverage conditions, RefShannon has recovered reference transcripts better than all other assemblers. In the three subplots of second column, reference transcripts are grouped according to their isoform multiplicity. Recall that a gene may contain multiple transcripts (i.e. isoforms) due to alternative splicing, and the isoform multiplicity of a transcript refers to the number of isoforms of that transcript’s gene. A higher isoform multiplicity value implies a more complex splice graph for recovery and also implies longer transcript length. Here the reference transcripts for HESC have relatively simple isoform multiplicity (most equals to 1), so we group reference transcripts into about 70, 15 and 15 percentile, while the reference transcripts for LC and Kidney datasets are grouped into 20 percentile each. For each dataset under various isoform multiplicity regions, RefShannon has also recovered more reference transcripts than all other assemblers. Note also that Cufflinks’s performance drops in LC and Kidney compared to HESC, this could be because reads from LC and Kidney datasets are pair end and there are more read alignments Cufflinks may consider to be compatibility uncertain and thus throw away. In addition, guided Trinity does a good job to recover the transcripts of high expression levels in HESC dataset, this could be because the relevant underlying assembly graphs are less fragmented.</p>
      <fig id="pone.0232946.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0232946.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Sensitivity analysis of real datasets.</title>
          <p>The y-axis of each subplot is recovery ratio, the ratio of the number of correctly reconstructed reference transcripts over the total number of (oracle) reference transcripts. The x-axis of each subplot in left column is read coverage, and the x-axis of each subplot in right column is isoform multiplicity. A lower read coverage implies less expression level of reference transcript in cells, and a higher isoform multiplicity implies more complex splicing patterns. Isoform multiplicity in HESC is lower than that of LC data, implying a simpler splicing structure of reference transcripts in HESC data.</p>
        </caption>
        <graphic xlink:href="pone.0232946.g004"/>
      </fig>
    </sec>
    <sec id="sec009">
      <title>Computation resources</title>
      <p>To understand how much time/memory RefShannon requires for assembly tasks, we have monitored assembly procedures using the cgmemtime tool (<ext-link ext-link-type="uri" xlink:href="https://github.com/gsauthof/cgmemtime">https://github.com/gsauthof/cgmemtime</ext-link>), which was previously adopted to compare the computational complexities among read aligners [<xref rid="pone.0232946.ref034" ref-type="bibr">34</xref>]. We put details in <xref ref-type="supplementary-material" rid="pone.0232946.s007">S7 File</xref>. RefShannon is overall faster than guided Trinity, Cufflinks, and Ryuto (for large dataset and more processes). RefShannon consumes more memory compared to other assemblers (except guided Trinity which essentially conducts de novo assembly). This could be because RefShannon is written in Python and memory sharing is less efficient especially for multiprocessing. Currently, a typical lab server with at least 20 CPU cores and over 200GB memory would be sufficient to run RefShannon on large real datasets. One of our future direction is to further improve its computational efficiency.</p>
    </sec>
  </sec>
  <sec id="sec010">
    <title>Discussions</title>
    <p>We have developed RefShannon—a new genome-guided transcriptome assembler as an extension of the original de novo Shannon project [<xref rid="pone.0232946.ref024" ref-type="bibr">24</xref>]. It utilizes a careful splice graph generation procedure aimed at capturing as much information as possible from read alignments, and utilizes a sparse flow decomposition algorithm aims at reconstructing as small number of transcripts as possible under splice graph constraints. Our evaluation shows performance gain of RefShannon over state-of-art genome guided assemblers for both simulated and real datasets. We expect RefShannon will help discover novel genes and isoforms that may be missed by existing transcriptome assemblers. We also expect its intermediately generated splice graphs (with nodes, edges and paths) will provide helpful interface to be used by other relevant research.</p>
    <p>There are several future directions. One of them is to further improve the computational efficiency as described previously.</p>
    <p>In addition, it shall be useful to incorporate the third generation long reads (e.g. PacBio [<xref rid="pone.0232946.ref035" ref-type="bibr">35</xref>] and Nanopore reads [<xref rid="pone.0232946.ref036" ref-type="bibr">36</xref>]) to assist the short read assembly process. Compared to the short RNA reads (e.g. &lt;300 bp), long reads (e.g. &gt;10000 bp) will be able to better bridge multi-exons and resolve repetitive regions. However they are more expensive (e.g. 100 to 280 Euro per isolate) and have higher errors (typically 10% to 15%), whereas short reads are more cost-effective (e.g. 40 Euro per isolate) and also much more accurate (typically below 0.1% error rate) [<xref rid="pone.0232946.ref037" ref-type="bibr">37</xref>, <xref rid="pone.0232946.ref038" ref-type="bibr">38</xref>]. Ideally, applying long contigs (or reads) into short read assemblers could be an effective feature [<xref rid="pone.0232946.ref017" ref-type="bibr">17</xref>, <xref rid="pone.0232946.ref020" ref-type="bibr">20</xref>].</p>
    <p>Moreover, it could be interesting to apply RefShannon onto the downstream analysis such as variant calling (e.g. SNP or small indels). RefShannon shows a better sensitivity (under a similar false positive rate) than existing assemblers, which implies additional new RNA transcripts could be discovered. Using variant callers (e.g. GATK [<xref rid="pone.0232946.ref039" ref-type="bibr">39</xref>] or recently developed abSNP [<xref rid="pone.0232946.ref040" ref-type="bibr">40</xref>]) to look for variants from newly discovered transcripts may help scientists gain new medical insights.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec011">
    <title>Methods</title>
    <p>As the overall work flow is described in Results, in this section, we will describe the graph generation and traversal steps of RefShannon.</p>
    <sec id="sec012">
      <title>Splice graph generation</title>
      <p>The splice graph generation consists of three steps: split, merge and connect. The pseudo code can be obtained from Algorithm 1 in <xref ref-type="supplementary-material" rid="pone.0232946.s002">S2 File</xref>.</p>
      <p>In the split step (<xref ref-type="fig" rid="pone.0232946.g005">Fig 5B</xref>), we divide inferred exon regions (<xref ref-type="fig" rid="pone.0232946.g005">Fig 5A</xref>) into sub exon regions where splice junctions may occur. Splice junctions represent the exon or sub-exon boundaries where alternative splicing could occur. They can be determined according to the read alignments, because a read sampled across two exon parts in a transcript can be split aligned onto disconnected genome regions, with the locus where the read leaves as the splice donor and the locus where the read enters as the splice acceptor. For example, a 100-bp read could be split-aligned onto the genome (chromosome 15) at loci [78837259, 78837318] and loci [78837519, 78837558], then we consider there is a splice junction at locus 78837318 (as splice donor) and at locus 78837519 (as splice acceptor). We determine a splice junction if there’s at least one supporting alignment. This is a loose criteria and may bring false edges in the splice graph. However, this is alleviated by the next step of flow decomposition because such edges have low weights and usually will be ignored as there can be no flow decomposed to go through these edges. Once we determine a splice junction (splice donor or acceptor) in the middle of an exon, we need to divide the exon further into sub exons, because the splice junction indicates that a divided sub exon could link to another non-adjacent (sub) exon that may belong to the same RNA transcript.</p>
      <fig id="pone.0232946.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0232946.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Illustrations of splice graph generation.</title>
          <p>(A) Exon regions are identified based on read alignments. (B) A splice event happens in the middle of Exon A, which implies Exon A should be further split into two sub exons at splice donor location. (C) Exon A1 and A2 should not be merged due to a splice event after A1. Exon B and C shall be merged if their gap is small. Exon D and E shall be merged if their gap is moderate but their coverage is high. (D) Exon A1 and A2 are connected because there’re read alignments (green color) crossing them. Exon A1 and BC are connected because there’re splice junctions (brown color) between them. Exon BC and DE are connected because they each contain one side of read pair alignment (brown color) and there are no other exon regions between them. A known path (A1, BC, DE) is collected because the read pair alignment (brown color) involves these three nodes.</p>
        </caption>
        <graphic xlink:href="pone.0232946.g005"/>
      </fig>
      <p>In the merge step (<xref ref-type="fig" rid="pone.0232946.g005">Fig 5C</xref>), we empirically merge two exon regions based on their gap and expression levels in order to reduce the chances that the gap is actually part of exon but not covered by reads. For example, we merge two exon regions if they are very close to each other. Statistics have shown that less than 0.01% of introns are smaller than 20 bp in length [<xref rid="pone.0232946.ref041" ref-type="bibr">41</xref>], so a gap within 10 bp is highly unlikely intronic but should be an uncovered exonic region. We also merge two exon regions if they are moderately close to each other and have high read coverages. However, all merge procedures require two regions have no splice donors or acceptors between them, otherwise the genome gap between them should not occur together with the two regions in true transcripts.</p>
      <p>In the connect step (<xref ref-type="fig" rid="pone.0232946.g005">Fig 5D</xref>), we establish weighted edges among nodes and collect known path information.</p>
      <p>Two nodes are connected by a directed edge if there is a read alignment crossing one node to the other. The two nodes can be continuous, or discontinuous on the genome when there’s a splice junction between them. The related edge weight is proportional to the number of crossing read alignments. Another situation to augment edges may occur only for pair end reads. As illustrated in <xref ref-type="fig" rid="pone.0232946.g005">Fig 5D</xref>, if a read pair alignment has its first segment onto one node and the second segment onto another node, and there’re no other nodes between them, these two nodes should be adjacent in some true transcript and hereby an edge should be added to connect them, even if there’re no read alignments crossing these two nodes. A similar idea has also occurred in Scripture [<xref rid="pone.0232946.ref015" ref-type="bibr">15</xref>]. The weight for the augmented edge here is proportional to the number of related read pair alignments.</p>
      <p>A known path is a sequence of nodes inferred from read alignments. Known paths are collected when a read alignment crosses more than two nodes, or a read pair alignment for an augmented edge involves more than two nodes (also illustrated in <xref ref-type="fig" rid="pone.0232946.g005">Fig 5D</xref>). We store known paths as a tuple of triple nodes. This not only provides sufficient extra information for flow decomposition later, but also helps reduce memory.</p>
    </sec>
    <sec id="sec013">
      <title>Sparse flow decomposition</title>
      <p>Sparse flow decomposition has been proposed in [<xref rid="pone.0232946.ref024" ref-type="bibr">24</xref>] for de novo assembly and here we modify it into the RefShannon framework for genome-guided assembly. Given a splice graph, it finds the minimum set of flows (e.g. paths with weights) that explains the splice graph.</p>
      <p>Mathematically, given graph <italic>G</italic> = (<italic>V</italic>, <italic>E</italic>), we need to find argmin<sub><italic>T</italic></sub>|<italic>T</italic>| such that ∀<italic>v</italic> ∈ <italic>V</italic>, ∀<italic>e</italic> ∈ InEdges(<italic>v</italic>)∪OutEdges(<italic>v</italic>), <italic>w</italic><sub><italic>e</italic></sub> = ∑<sub><italic>t</italic>∈<italic>T</italic>,<italic>e</italic>∈<italic>t</italic></sub>
<italic>f</italic>(<italic>t</italic>) where <italic>t</italic> ∈ <italic>T</italic> is a path in <italic>G</italic> corresponds to an RNA transcript and <italic>f</italic>(<italic>t</italic>) represents the flow weight of <italic>t</italic>. This is a hard task, because there can be |<italic>P</italic>| = 2<sup>|<italic>V</italic>|</sup> paths, and thus 2<sup>|<italic>P</italic>|</sup> possible sets of flows.</p>
      <p>Instead, we try to decompose a set of flows out of the splice graph node by node in topological order, as illustrated in <xref ref-type="fig" rid="pone.0232946.g006">Fig 6</xref> (For more details, please refer to Algorithm2 and Algorithm3 in <xref ref-type="supplementary-material" rid="pone.0232946.s002">S2 File</xref>). Specifically, we first add a special source node to connect all nodes without in-edges and a special sink node to connect all nodes without out-edges. We then do local sparse flow decomposition iteratively for each node. Finally we collect flows that start from source node and stop at sink node as reconstructed RNA transcripts.</p>
      <fig id="pone.0232946.g006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0232946.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>Example of sparse flow decomposition.</title>
          <p>In this figure, starting from the initial splice graph on the top left side, we try to recover transcriptome by doing local decomposition for node C,E and F iteratively.</p>
        </caption>
        <graphic xlink:href="pone.0232946.g006"/>
      </fig>
      <p>The local sparse flow decomposition at node <italic>v</italic> tries to find the minimum number of flows through <italic>v</italic> restricted by edge weight constraints. It can be formally described as: find argmin<sub><italic>f</italic></sub>∥<italic>f</italic>∥<sub>0</sub> such that ∑<sub><italic>i</italic>∈InEdges(<italic>v</italic>)</sub>
<italic>f</italic><sub><italic>i</italic>,<italic>j</italic></sub> = <italic>w</italic><sub><italic>j</italic></sub>, ∀<italic>j</italic> ∈ OutEdges(<italic>v</italic>) and ∑<sub><italic>j</italic>∈OutEdges(<italic>v</italic>)</sub>
<italic>f</italic><sub><italic>i</italic>,<italic>j</italic></sub> = <italic>w</italic><sub><italic>i</italic></sub>, ∀<italic>i</italic> ∈ InEdges(<italic>v</italic>) and <italic>f</italic><sub><italic>i</italic>,<italic>j</italic></sub> ≥ 0. Here ∥<italic>f</italic>∥<sub>0</sub> means the support set of {<italic>f</italic><sub><italic>i</italic>,<italic>j</italic></sub>}, or the number of positive <italic>f</italic><sub><italic>i</italic>,<italic>j</italic></sub>s.</p>
      <p>Solving this problem may not be practically efficient. Consider for each node <italic>v</italic>, we have <italic>m</italic> × <italic>n</italic> possible flows (<italic>m</italic> = |InEdges(<italic>v</italic>)|, <italic>n</italic> = |OutEdges(<italic>v</italic>)|). We need to enumerate all 2<sup>mn</sup> path combinations to figure out which combination offers us min ∥<italic>f</italic>∥<sub>0</sub> and keeps the edge weight constraints.</p>
      <p>One possible thought to ease the problem, as commonly used in signal processing, is to approximate ∥<italic>f</italic>∥<sub>0</sub> by ∥<italic>f</italic>∥<sub>1</sub>, which unfortunately turns out to be a constant: ∥<italic>f</italic>∥<sub>1</sub> = ∑<sub><italic>i</italic>,<italic>j</italic></sub>
<italic>f</italic><sub><italic>i</italic>,<italic>j</italic></sub> = ∑<sub><italic>i</italic></sub><italic>w</italic><sub><italic>i</italic></sub> = ∑<sub><italic>j</italic></sub><italic>w</italic><sub><italic>j</italic></sub>. Meanwhile, we have noticed that ∥<italic>f</italic>∥<sub>0</sub> = ∥<italic>f</italic> ⊙ <italic>r</italic>∥<sub>0</sub>, <italic>r</italic> = {<italic>r</italic><sub><italic>i</italic>,<italic>j</italic></sub>|<italic>r</italic><sub><italic>i</italic>,<italic>j</italic></sub> &gt; 0}(⊙ is element-wise product). So instead of approximating ∥<italic>f</italic>∥<sub>0</sub> by ∥<italic>f</italic>∥<sub>1</sub>, we try to approxiate ∥<italic>f</italic>∥<sub>0</sub> by ∥<italic>f</italic> ⊙ <italic>r</italic>∥<sub>1</sub> = ∑<sub><italic>i</italic>,<italic>j</italic></sub>
<italic>f</italic><sub><italic>i</italic>,<italic>j</italic></sub>
<italic>r</italic><sub><italic>i</italic>,<italic>j</italic></sub>.</p>
      <p>Therefore, we have relaxed the original problem as: find argmin<sub><italic>f</italic></sub>∑<sub><italic>i</italic>,<italic>j</italic></sub>
<italic>f</italic><sub><italic>i</italic>,<italic>j</italic></sub>
<italic>r</italic><sub><italic>i</italic>,<italic>j</italic></sub> such that ∑<sub><italic>i</italic> ∈ InEdges(<italic>v</italic>)</sub>
<italic>f</italic><sub><italic>i</italic>,<italic>j</italic></sub> = <italic>w</italic><sub><italic>j</italic></sub>, ∀<italic>j</italic> ∈ OutEdges(<italic>v</italic>) and ∑<sub><italic>j</italic> ∈ OutEdges(<italic>v</italic>)</sub>
<italic>f</italic><sub><italic>i</italic>,<italic>j</italic></sub> = <italic>w</italic><sub><italic>i</italic></sub>, ∀<italic>i</italic> ∈ InEdges(<italic>v</italic>) and <italic>f</italic><sub><italic>i</italic>,<italic>j</italic></sub> ≥ 0, <italic>r</italic><sub><italic>i</italic>,<italic>j</italic></sub> &gt; 0. We could use linear programming (e.g Python CVXOPT package (<ext-link ext-link-type="uri" xlink:href="http://cvxopt.org/">http://cvxopt.org/</ext-link>)) to solve the above problem. Since the result may contain noise, we also need to do some thresholding to get a sparse solution. To get the sparsest result, we generate <italic>r</italic> by a number of times and select the sparsest <italic>f</italic> as the final local sparse flow decomposition solution. An illustration of why the solution tends to be sparse is provided in Fig 3 in <xref ref-type="supplementary-material" rid="pone.0232946.s002">S2 File</xref>.</p>
      <p>It is also possible that the local sparse flow decomposition may bring two results that have the same lowest sparsity and satisfy the edge constraints. This can be resolved if one of them includes a known path, as illustrated in <xref ref-type="fig" rid="pone.0232946.g006">Fig 6</xref> as well as <xref ref-type="fig" rid="pone.0232946.g002">Fig 2C</xref>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="sec014">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pone.0232946.s001">
      <label>S1 File</label>
      <caption>
        <title>Compare Shannon with StringTie.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0232946.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0232946.s002">
      <label>S2 File</label>
      <caption>
        <title>RefShannon algorithm details.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0232946.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0232946.s003">
      <label>S3 File</label>
      <caption>
        <title>Additional comparisons among different assemblers.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0232946.s003.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0232946.s004">
      <label>S4 File</label>
      <caption>
        <title>Parameter setting for different assemblers.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0232946.s004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0232946.s005">
      <label>S5 File</label>
      <caption>
        <title>Different thresholds on sensitivity and false positive.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0232946.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0232946.s006">
      <label>S6 File</label>
      <caption>
        <title>Comparison of assembly performance (ROC) using different aligners.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0232946.s006.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0232946.s007">
      <label>S7 File</label>
      <caption>
        <title>Compare memory and time consumption of RefShannon to other assemblers.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0232946.s007.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>The authors would like to thank Joseph Hui and Kayvon Mazooji for their support at the initial stage of the project.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0232946.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Witkowski</surname><given-names>JA</given-names></name>. <article-title>The discovery of ‘split’ genes: a scientific revolution</article-title>. <source>Trends in Biochemical Sciences</source>. <year>1988</year>;<volume>13</volume>(<issue>3</issue>):<fpage>110</fpage>–<lpage>113</lpage>. <pub-id pub-id-type="doi">10.1016/0968-0004(88)90052-7</pub-id><?supplied-pmid 3072705?><pub-id pub-id-type="pmid">3072705</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Michael</surname><given-names>D</given-names></name>, <name><surname>Manyuan</surname><given-names>L</given-names></name>. <article-title>Intron–exon structures of eukaryotic model organisms</article-title>. <source>Nucleic Acids Research</source>. <year>1999</year>;<volume>27</volume>(<issue>15</issue>):<fpage>3219</fpage>–<lpage>3228</lpage>. <pub-id pub-id-type="doi">10.1093/nar/27.15.3219</pub-id><pub-id pub-id-type="pmid">10454621</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Gilbert</surname><given-names>W</given-names></name>. <article-title>Why genes in pieces?</article-title><source>Nature</source>. <year>1978</year>;<volume>271</volume>(<issue>5645</issue>):<fpage>501</fpage>–<lpage>501</lpage>. <pub-id pub-id-type="doi">10.1038/271501a0</pub-id><?supplied-pmid 622185?><pub-id pub-id-type="pmid">622185</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Breitbart</surname><given-names>RE</given-names></name>, <name><surname>Andreadis</surname><given-names>A</given-names></name>, <name><surname>Nadal-Ginard</surname><given-names>B</given-names></name>. <article-title>Alternative Splicing: A Ubiquitous Mechanism for the Generation of Multiple Protein Isoforms from Single Genes</article-title>. <source>Annual Review of Biochemistry</source>. <year>1987</year>;<volume>56</volume>(<issue>1</issue>):<fpage>467</fpage>–<lpage>495</lpage>. <pub-id pub-id-type="doi">10.1146/annurev.bi.56.070187.002343</pub-id><?supplied-pmid 3304142?><pub-id pub-id-type="pmid">3304142</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Black</surname><given-names>DL</given-names></name>. <article-title>Mechanisms of Alternative Pre-Messenger RNA Splicing</article-title>. <source>Annual Review of Biochemistry</source>. <year>2003</year>;<volume>72</volume>(<issue>1</issue>):<fpage>291</fpage>–<lpage>336</lpage>. <pub-id pub-id-type="doi">10.1146/annurev.biochem.72.121801.161720</pub-id><?supplied-pmid 12626338?><pub-id pub-id-type="pmid">12626338</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref006">
      <label>6</label>
      <mixed-citation publication-type="book"><name><surname>Meister</surname><given-names>G</given-names></name>. <source>RNA Biology: An Introduction</source>. <publisher-name>Wiley-VCH</publisher-name>; <year>2011</year>.</mixed-citation>
    </ref>
    <ref id="pone.0232946.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>Z</given-names></name>, <name><surname>Gerstein</surname><given-names>M</given-names></name>, <name><surname>Snyder</surname><given-names>M</given-names></name>. <article-title>RNA-Seq: a revolutionary tool for transcriptomics</article-title>. <source>Nature Reviews Genetics</source>. <year>2009</year>;<volume>10</volume>(<issue>1</issue>):<fpage>57</fpage>–<lpage>63</lpage>. <pub-id pub-id-type="doi">10.1038/nrg2484</pub-id><?supplied-pmid 19015660?><pub-id pub-id-type="pmid">19015660</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Martin</surname><given-names>JA</given-names></name>, <name><surname>Wang</surname><given-names>Z</given-names></name>. <article-title>Next-generation transcriptome assembly</article-title>. <source>Nature Reviews Genetics</source>. <year>2011</year>;<volume>12</volume>(<issue>10</issue>):<fpage>671</fpage>–<lpage>682</lpage>. <pub-id pub-id-type="doi">10.1038/nrg3068</pub-id><?supplied-pmid 21897427?><pub-id pub-id-type="pmid">21897427</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref009">
      <label>9</label>
      <mixed-citation publication-type="book"><name><surname>Alberts</surname><given-names>B</given-names></name>, <name><surname>Hopkin</surname><given-names>K</given-names></name>, <name><surname>Johnson</surname><given-names>AD</given-names></name>, <name><surname>Morgan</surname><given-names>D</given-names></name>, <name><surname>Raff</surname><given-names>M</given-names></name>, <name><surname>Roberts</surname><given-names>K</given-names></name>, <etal>et al</etal><source>Essential Cell Biology (Fifth Edition)</source>. <publisher-name>W. W. Norton &amp; Company</publisher-name>; <year>2019</year>.</mixed-citation>
    </ref>
    <ref id="pone.0232946.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Leonelli</surname><given-names>S</given-names></name>, <name><surname>Ankeny</surname><given-names>RA</given-names></name>. <article-title>What makes a model organism?</article-title><source>Endeavour</source>. <year>2013</year>;<volume>37</volume>(<issue>4</issue>):<fpage>209</fpage>–<lpage>212</lpage>. <pub-id pub-id-type="doi">10.1016/j.endeavour.2013.06.001</pub-id><?supplied-pmid 23849606?><pub-id pub-id-type="pmid">23849606</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Robertson</surname><given-names>G</given-names></name>, <name><surname>Schein</surname><given-names>J</given-names></name>, <name><surname>Chiu</surname><given-names>R</given-names></name>, <name><surname>Corbett</surname><given-names>R</given-names></name>, <name><surname>Field</surname><given-names>M</given-names></name>, <name><surname>Jackman</surname><given-names>SD</given-names></name>, <etal>et al</etal><article-title>De novo assembly and analysis of RNA-seq data</article-title>. <source>Nature Methods</source>. <year>2010</year>;<volume>7</volume>(<issue>11</issue>):<fpage>909</fpage>–<lpage>912</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.1517</pub-id><?supplied-pmid 20935650?><pub-id pub-id-type="pmid">20935650</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Grabherr</surname><given-names>MG</given-names></name>, <name><surname>Haas</surname><given-names>BJ</given-names></name>, <name><surname>Yassour</surname><given-names>M</given-names></name>, <name><surname>Levin</surname><given-names>JZ</given-names></name>, <name><surname>Thompson</surname><given-names>DA</given-names></name>, <name><surname>Amit</surname><given-names>I</given-names></name>, <etal>et al</etal><article-title>Full-length transcriptome assembly from RNA-Seq data without a reference genome</article-title>. <source>Nature Biotechnology</source>. <year>2011</year>;<volume>29</volume>(<issue>7</issue>):<fpage>644</fpage>–<lpage>652</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.1883</pub-id><?supplied-pmid 21572440?><pub-id pub-id-type="pmid">21572440</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Schulz</surname><given-names>MH</given-names></name>, <name><surname>Zerbino</surname><given-names>DR</given-names></name>, <name><surname>Vingron</surname><given-names>M</given-names></name>, <name><surname>Birney</surname><given-names>E</given-names></name>. <article-title>Oases: robust de novo RNA-seq assembly across the dynamic range of expression levels</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>(<issue>8</issue>):<fpage>1086</fpage>–<lpage>1092</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bts094</pub-id><?supplied-pmid 22368243?><pub-id pub-id-type="pmid">22368243</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Xie</surname><given-names>Y</given-names></name>, <name><surname>Wu</surname><given-names>G</given-names></name>, <name><surname>Tang</surname><given-names>J</given-names></name>, <name><surname>Luo</surname><given-names>R</given-names></name>, <name><surname>Patterson</surname><given-names>J</given-names></name>, <name><surname>Liu</surname><given-names>S</given-names></name>, <etal>et al</etal><article-title>SOAPdenovo-Trans: de novo transcriptome assembly with short RNA-Seq reads</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>(<issue>12</issue>):<fpage>1660</fpage>–<lpage>1666</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btu077</pub-id><?supplied-pmid 24532719?><pub-id pub-id-type="pmid">24532719</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Guttman</surname><given-names>MTcioAcR</given-names></name>, <name><surname>Garber</surname><given-names>M</given-names></name>, <name><surname>Levin</surname><given-names>JZ</given-names></name>, <name><surname>Donaghey</surname><given-names>J</given-names></name>, <name><surname>Robinson</surname><given-names>J</given-names></name>, <name><surname>Adiconis</surname><given-names>X</given-names></name>, <etal>et al</etal><article-title>Ab initio reconstruction of cell type-specific transcriptomes in mouse reveals the conserved multi-exonic structure of lincRNAs</article-title>. <source>Nat Biotech</source>. <year>2010</year>;<volume>28</volume>(<issue>5</issue>):<fpage>503</fpage>–<lpage>510</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.1633</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Trapnell</surname><given-names>C</given-names></name>, <name><surname>Williams</surname><given-names>BA</given-names></name>, <name><surname>Pertea</surname><given-names>G</given-names></name>, <name><surname>Mortazavi</surname><given-names>A</given-names></name>, <name><surname>Kwan</surname><given-names>G</given-names></name>, <name><surname>van Baren</surname><given-names>MJ</given-names></name>, <etal>et al</etal><article-title>Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title>. <source>Nat Biotechnol</source>. <year>2010</year>;<volume>28</volume>(<issue>5</issue>):<fpage>511</fpage>–<lpage>515</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.1621</pub-id><?supplied-pmid 20436464?><pub-id pub-id-type="pmid">20436464</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Pertea</surname><given-names>M</given-names></name>, <name><surname>Pertea</surname><given-names>GM</given-names></name>, <name><surname>Antonescu</surname><given-names>CM</given-names></name>, <name><surname>Chang</surname><given-names>TC</given-names></name>, <name><surname>Mendell</surname><given-names>JT</given-names></name>, <name><surname>Salzberg</surname><given-names>SL</given-names></name>. <article-title>StringTie enables improved reconstruction of a transcriptome from RNA-seq reads</article-title>. <source>Nat Biotech</source>. <year>2015</year>;<volume>33</volume>:<fpage>290</fpage>–<lpage>295</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.3122</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>J</given-names></name>, <name><surname>Yu</surname><given-names>T</given-names></name>, <name><surname>Jiang</surname><given-names>T</given-names></name>, <name><surname>Li</surname><given-names>G</given-names></name>. <article-title>TransComb: genome-guided transcriptome assembly via combing junctions in splicing graphs</article-title>. <source>Genome Biology</source>. <year>2016</year>;<volume>17</volume>(<issue>1</issue>). <pub-id pub-id-type="doi">10.1186/s13059-016-1074-1</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Song</surname><given-names>L</given-names></name>, <name><surname>Sabunciyan</surname><given-names>S</given-names></name>, <name><surname>Florea</surname><given-names>L</given-names></name>. <article-title>CLASS2: accurate and efficient splice variant annotation from RNA-seq reads</article-title>. <source>Nucleic Acids Research</source>. <year>2016</year>;<volume>44</volume>(<issue>10</issue>):<fpage>e98</fpage>–<lpage>e98</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkw158</pub-id><?supplied-pmid 26975657?><pub-id pub-id-type="pmid">26975657</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Gatter</surname><given-names>T</given-names></name>, <name><surname>Stadler</surname><given-names>PF</given-names></name>. <article-title>Ryūtō: network-flow based transcriptome reconstruction</article-title>. <source>BMC Bioinformatics</source>. <year>2019</year>;<volume>20</volume>(<issue>1</issue>). <pub-id pub-id-type="doi">10.1186/s12859-019-2786-5</pub-id><?supplied-pmid 30991937?><pub-id pub-id-type="pmid">30991937</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>R</given-names></name>, <name><surname>Dickerson</surname><given-names>J</given-names></name>. <article-title>Strawberry: Fast and accurate genome-guided transcript reconstruction and quantification from RNA-Seq</article-title>. <source>PLOS Computational Biology</source>. <year>2017</year>;<volume>13</volume>(<issue>11</issue>):<fpage>e1005851</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005851</pub-id><?supplied-pmid 29176847?><pub-id pub-id-type="pmid">29176847</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Steijger</surname><given-names>T</given-names></name>, <name><surname>Abril</surname><given-names>JF</given-names></name>, <name><surname>Engstrom</surname><given-names>PG</given-names></name>, <name><surname>Kokocinski</surname><given-names>F</given-names></name>, <name><surname>Consortium</surname><given-names>TR</given-names></name>, <name><surname>Hubbard</surname><given-names>TJ</given-names></name>, <etal>et al</etal><article-title>Assessment of transcript reconstruction methods for RNA-seq</article-title>. <source>Nat Meth</source>. <year>2013</year>;<volume>10</volume>(<issue>12</issue>):<fpage>1177</fpage>–<lpage>1184</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.2714</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Hayer</surname><given-names>KE</given-names></name>, <name><surname>Pizarro</surname><given-names>A</given-names></name>, <name><surname>Lahens</surname><given-names>NF</given-names></name>, <name><surname>Hogenesch</surname><given-names>JB</given-names></name>, <name><surname>Grant</surname><given-names>GR</given-names></name>. <article-title>Benchmark analysis of algorithms for determining and quantifying full-length mRNA splice forms from RNA-seq data</article-title>. <source>Bioinformatics</source>. <year>2015</year>; p. btv488. <pub-id pub-id-type="doi">10.1093/bioinformatics/btv488</pub-id><?supplied-pmid 26338770?><pub-id pub-id-type="pmid">26338770</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Kannan</surname><given-names>S</given-names></name>, <name><surname>Hui</surname><given-names>J</given-names></name>, <name><surname>Mazooji</surname><given-names>K</given-names></name>, <name><surname>Pachter</surname><given-names>L</given-names></name>, <name><surname>Tse</surname><given-names>D</given-names></name>. <article-title>Shannon: An Information-Optimal de Novo RNA-Seq Assembler</article-title>. <source>bioRxiv</source>. <year>2016</year>.</mixed-citation>
    </ref>
    <ref id="pone.0232946.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Dobin</surname><given-names>A</given-names></name>, <name><surname>Davis</surname><given-names>CA</given-names></name>, <name><surname>Schlesinger</surname><given-names>F</given-names></name>, <name><surname>Drenkow</surname><given-names>J</given-names></name>, <name><surname>Zaleski</surname><given-names>C</given-names></name>, <name><surname>Jha</surname><given-names>S</given-names></name>, <etal>et al</etal><article-title>STAR: ultrafast universal RNA-seq aligner</article-title>. <source>Bioinformatics</source>. <year>2012</year><pub-id pub-id-type="doi">10.1093/bioinformatics/bts635</pub-id><?supplied-pmid 23104886?><pub-id pub-id-type="pmid">23104886</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Kim</surname><given-names>D</given-names></name>, <name><surname>Pertea</surname><given-names>G</given-names></name>, <name><surname>Trapnell</surname><given-names>C</given-names></name>, <name><surname>Pimentel</surname><given-names>H</given-names></name>, <name><surname>Kelley</surname><given-names>R</given-names></name>, <name><surname>Salzberg</surname><given-names>SL</given-names></name>. <article-title>TopHat2: accurate alignment of transcriptomes in the presence of insertions, deletions and gene fusions</article-title>. <source>Genome Biology</source>. <year>2013</year>;<volume>14</volume>(<issue>4</issue>):<fpage>R36</fpage><pub-id pub-id-type="doi">10.1186/gb-2013-14-4-r36</pub-id><?supplied-pmid 23618408?><pub-id pub-id-type="pmid">23618408</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Kim</surname><given-names>D</given-names></name>, <name><surname>Langmead</surname><given-names>B</given-names></name>, <name><surname>Salzberg</surname><given-names>SL</given-names></name>. <article-title>HISAT: a fast spliced aligner with low memory requirements</article-title>. <source>Nat Meth</source>. <year>2015</year>;<volume>12</volume>(<issue>4</issue>):<fpage>357</fpage>–<lpage>360</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.3317</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Wu</surname><given-names>TD</given-names></name>, <name><surname>Watanabe</surname><given-names>CK</given-names></name>. <article-title>GMAP: a genomic mapping and alignment program for mRNA and EST sequences</article-title>. <source>Bioinformatics</source>. <year>2005</year>;<volume>21</volume>(<issue>9</issue>):<fpage>1859</fpage>–<lpage>1875</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bti310</pub-id><?supplied-pmid 15728110?><pub-id pub-id-type="pmid">15728110</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>. <article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>. <source>Bioinformatics</source>. <year>2018</year>;<volume>34</volume>(<issue>18</issue>):<fpage>3094</fpage>–<lpage>3100</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bty191</pub-id><?supplied-pmid 29750242?><pub-id pub-id-type="pmid">29750242</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Zimin</surname><given-names>AV</given-names></name>, <name><surname>Marcais</surname><given-names>G</given-names></name>, <name><surname>Puiu</surname><given-names>D</given-names></name>, <name><surname>Roberts</surname><given-names>M</given-names></name>, <name><surname>Salzberg</surname><given-names>SL</given-names></name>, <name><surname>Yorke</surname><given-names>JA</given-names></name>. <article-title>The MaSuRCA genome assembler</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>(<issue>21</issue>):<fpage>2669</fpage>–<lpage>2677</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btt476</pub-id><?supplied-pmid 23990416?><pub-id pub-id-type="pmid">23990416</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Au</surname><given-names>KF</given-names></name>, <name><surname>Sebastiano</surname><given-names>V</given-names></name>, <name><surname>Afshar</surname><given-names>PT</given-names></name>, <name><surname>Durruthy</surname><given-names>JD</given-names></name>, <name><surname>Lee</surname><given-names>L</given-names></name>, <name><surname>Williams</surname><given-names>BA</given-names></name>, <etal>et al</etal><article-title>Characterization of the human ESC transcriptome by hybrid sequencing</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>2013</year>;<volume>110</volume>(<issue>50</issue>):<fpage>E4821</fpage>–<lpage>4830</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1320101110</pub-id><?supplied-pmid 24282307?><pub-id pub-id-type="pmid">24282307</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Tilgner</surname><given-names>H</given-names></name>, <name><surname>Grubert</surname><given-names>F</given-names></name>, <name><surname>Sharon</surname><given-names>D</given-names></name>, <name><surname>Snyder</surname><given-names>MP</given-names></name>. <article-title>Defining a personal, allele-specific, and single-molecule long-read transcriptome</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>2014</year>;<volume>111</volume>(<issue>27</issue>):<fpage>9869</fpage>–<lpage>9874</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1400447111</pub-id><?supplied-pmid 24961374?><pub-id pub-id-type="pmid">24961374</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>B</given-names></name>, <name><surname>Dewey</surname><given-names>CN</given-names></name>. <article-title>RSEM: accurate transcript quantification from RNA-Seq data with or without a reference genome</article-title>. <source>BMC Bioinformatics</source>. <year>2011</year>;<volume>12</volume>(<issue>1</issue>):<fpage>323</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-12-323</pub-id><?supplied-pmid 21816040?><pub-id pub-id-type="pmid">21816040</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Križanović</surname><given-names>K</given-names></name>, <name><surname>Echchiki</surname><given-names>A</given-names></name>, <name><surname>Roux</surname><given-names>J</given-names></name>, <name><surname>Šikić</surname><given-names>M</given-names></name>. <article-title>Evaluation of tools for long read RNA-seq splice-aware alignment</article-title>. <source>Bioinformatics</source>. <year>2017</year>;<volume>34</volume>(<issue>5</issue>):<fpage>748</fpage>–<lpage>754</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0232946.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Roberts</surname><given-names>RJ</given-names></name>, <name><surname>Carneiro</surname><given-names>MO</given-names></name>, <name><surname>Schatz</surname><given-names>MC</given-names></name>. <article-title>The advantages of SMRT sequencing</article-title>. <source>Genome Biology</source>. <year>2013</year>;<volume>14</volume>(<issue>6</issue>). <pub-id pub-id-type="doi">10.1186/gb-2013-14-7-405</pub-id><?supplied-pmid 23822731?><pub-id pub-id-type="pmid">23822731</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Maitra</surname><given-names>RD</given-names></name>, <name><surname>Kim</surname><given-names>J</given-names></name>, <name><surname>Dunbar</surname><given-names>WB</given-names></name>. <article-title>Recent advances in nanopore sequencing</article-title>. <source>ELECTROPHORESIS</source>. <year>2012</year>;<volume>33</volume>(<issue>23</issue>):<fpage>3418</fpage>–<lpage>3428</lpage>. <pub-id pub-id-type="doi">10.1002/elps.201200272</pub-id><?supplied-pmid 23138639?><pub-id pub-id-type="pmid">23138639</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><article-title>The long view on sequencing</article-title>. <source>Nature Biotechnology</source>. <year>2018</year>;<volume>36</volume>(<issue>4</issue>):<fpage>287</fpage>–<lpage>287</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.4125</pub-id><?supplied-pmid 29621212?><pub-id pub-id-type="pmid">29621212</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Maio</surname><given-names>ND</given-names></name>, <name><surname>Shaw</surname><given-names>LP</given-names></name>, <name><surname>Hubbard</surname><given-names>A</given-names></name>, <name><surname>George</surname><given-names>S</given-names></name>, <name><surname>Sanderson</surname><given-names>ND</given-names></name>, <name><surname>Swann</surname><given-names>J</given-names></name>, <etal>et al</etal><article-title>Comparison of long-read sequencing technologies in the hybrid assembly of complex bacterial genomes</article-title>. <source>Microbial Genomics</source>. <year>2019</year>;<volume>5</volume>(<issue>9</issue>). <pub-id pub-id-type="doi">10.1099/mgen.0.000294</pub-id><?supplied-pmid 31483244?><pub-id pub-id-type="pmid">31483244</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>DePristo</surname><given-names>MA</given-names></name>, <name><surname>Banks</surname><given-names>E</given-names></name>, <name><surname>Poplin</surname><given-names>R</given-names></name>, <name><surname>Garimella</surname><given-names>KV</given-names></name>, <name><surname>Maguire</surname><given-names>JR</given-names></name>, <name><surname>Hartl</surname><given-names>C</given-names></name>, <etal>et al</etal><article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title>. <source>Nature Genetics</source>. <year>2011</year>;<volume>43</volume>(<issue>5</issue>):<fpage>491</fpage>–<lpage>498</lpage>. <pub-id pub-id-type="doi">10.1038/ng.806</pub-id><?supplied-pmid 21478889?><pub-id pub-id-type="pmid">21478889</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232946.ref040">
      <label>40</label>
      <mixed-citation publication-type="other">Mao S, Mohajer S, Ramachandran K, Tse D, Kannan S. abSNP: RNA-Seq SNP Calling in Repetitive Regions via Abundance Estimation. In: Schwartz R, Reinert K, editors. 17th International Workshop on Algorithms in Bioinformatics (WABI 2017). vol. 88 of Leibniz International Proceedings in Informatics (LIPIcs). Dagstuhl, Germany: Schloss Dagstuhl–Leibniz-Zentrum fuer Informatik; 2017. p. 15:1–15:14. Available from: <ext-link ext-link-type="uri" xlink:href="http://drops.dagstuhl.de/opus/volltexte/2017/7658">http://drops.dagstuhl.de/opus/volltexte/2017/7658</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0232946.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Sakharkar MK KP Chow</surname><given-names>VT</given-names></name>. <article-title>Distributions of exons and introns in the human genome</article-title>. <source>In Silico Biol</source>. <year>2004</year>;<volume>4</volume>:<fpage>387</fpage>–<lpage>93</lpage>.<pub-id pub-id-type="pmid">15217358</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
