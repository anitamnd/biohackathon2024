<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with OASIS Tables with MathML3 v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archive-oasis-article1-mathml3.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats-oasis2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Mitochondrial DNA B Resour</journal-id>
    <journal-id journal-id-type="iso-abbrev">Mitochondrial DNA B Resour</journal-id>
    <journal-title-group>
      <journal-title>Mitochondrial DNA. Part B, Resources</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2380-2359</issn>
    <publisher>
      <publisher-name>Taylor &amp; Francis</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8386716</article-id>
    <article-id pub-id-type="doi">10.1080/23802359.2021.1966334</article-id>
    <article-id pub-id-type="publisher-id">1966334</article-id>
    <article-version vocab="JAV" vocab-identifier="http://www.niso.org/publications/rp/RP-8-2008.pdf" vocab-term="Version of Record" article-version-type="VoR">Version of Record</article-version>
    <article-categories>
      <subj-group subj-group-type="article-type">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Rapid Communication</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Aln2tbl: building a mitochondrial features table from a assembly alignment in fasta format</article-title>
      <alt-title alt-title-type="left-running-head">J. Pons et al.</alt-title>
      <alt-title alt-title-type="right-running-head">Rapid Communication</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-4683-8840</contrib-id>
        <name>
          <surname>Pons</surname>
          <given-names>Joan</given-names>
        </name>
        <xref rid="AF0001" ref-type="aff">a</xref>
        <xref rid="AN0001" ref-type="corresp"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4970-0668</contrib-id>
        <name>
          <surname>Ensenyat</surname>
          <given-names>Juan José</given-names>
        </name>
        <xref rid="AF0002" ref-type="aff">b</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-2942-2840</contrib-id>
        <name>
          <surname>Bover</surname>
          <given-names>Pere</given-names>
        </name>
        <xref rid="AF0003" ref-type="aff">c</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1889-6373</contrib-id>
        <name>
          <surname>Serra</surname>
          <given-names>Miquel</given-names>
        </name>
        <xref rid="AF0002" ref-type="aff">b</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0271-9855</contrib-id>
        <name>
          <surname>Nardi</surname>
          <given-names>Francesco</given-names>
        </name>
        <xref rid="AF0004" ref-type="aff">d</xref>
      </contrib>
      <aff id="AF0001"><label>a</label><institution>Departament de Biodiversitat Animal i Microbiana, Institut Mediterrani d’Estudis Avançats (IMEDEA, CSIC-UIB)</institution>, <city>Esporles</city>, <country>Spain</country></aff>
      <aff id="AF0002"><label>b</label><institution>Tecnologies de la informació i la comunicació, Institut Mediterrani d’Estudis Avançats (IMEDEA, CSIC-UIB)</institution>, <city>Esporles</city>, <country>Spain</country></aff>
      <aff id="AF0003"><label>c</label><institution>Instituto Universitario de Investigación en Ciencias Ambientales (IUCA), Grupo Aragosaurus - Departamento de Ciencias de la Tierra, Facultad de Ciencias, Universidad de Zaragoza</institution>, <city>Zaragoza</city>, <country>Spain</country></aff>
      <aff id="AF0004"><label>d</label><institution>Department of Life Sciences, University of Siena</institution>, <city>Siena</city>, <country>Italy</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="AN0001">CONTACT Joan Pons <email>jpons@imedea.uib-csic.es</email>
<institution>Departament de Biodiversitat Animal i Microbiana, Institut Mediterrani d’Estudis Avançats (IMEDEA, CSIC-UIB)</institution>, <city>Esporles</city>, <country>Spain</country></corresp>
      <fn id="AUF0800">
        <p content-type="appended text">Supplemental data for this article can be accessed <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://doi.org/10.1080/23802359.2021.1966334" ext-link-type="uri"><underline>here</underline></ext-link>.</p>
      </fn>
    </author-notes>
    <pub-date date-type="pub" publication-format="electronic">
      <day>24</day>
      <month>8</month>
      <year>2021</year>
    </pub-date>
    <pub-date date-type="collection" publication-format="electronic">
      <year>2021</year>
    </pub-date>
    <volume>6</volume>
    <issue>9</issue>
    <fpage seq="108">2732</fpage>
    <lpage>2735</lpage>
    <pub-history>
      <event event-type="received">
        <date>
          <day>4</day>
          <month>5</month>
          <year>2021</year>
        </date>
      </event>
      <event event-type="accepted">
        <date>
          <day>4</day>
          <month>8</month>
          <year>2021</year>
        </date>
      </event>
      <event event-type="tagger">
        <event-desc>KnowledgeWorks Global Ltd.</event-desc>
        <date>
          <day>23</day>
          <month>8</month>
          <year>2021</year>
        </date>
      </event>
      <event event-type="build-issue-online">
        <event-desc>published online ahead of issue</event-desc>
        <date>
          <day>23</day>
          <month>8</month>
          <year>2021</year>
        </date>
      </event>
    </pub-history>
    <permissions>
      <copyright-statement>© 2021 The Author(s). Published by Informa UK Limited, trading as Taylor &amp; Francis Group.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>The Author(s)</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xmlns:xlink="http://www.w3.org/1999/xlink" content-type="pdf" xlink:href="TMDN_6_1966334.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>The sequencing, annotation and analysis of complete mitochondrial genomes is an important research tool in phylogeny and evolution. Starting with the primary sequence, genes/features are generally annotated automatically to obtain preliminary annotations in the form of a feature table. Further manual curation in a graphic alignment editor is nevertheless necessary to revise annotations. As such, the automatically generated feature table is invalidated and has to be modified manually before submission to data banks. We developed aln2tbl.py, a python script that recreates a feature table from a manually refined alignment of genes mapped on the mitochondrial genome in fasta format. The feature table is populated with notes and annotations specific to mitochondrial genomes. The table can be used to create a sqn file to be submitted directly to data banks. In summary, our scripts fills one gap in the available toolbox and, combined with other software, allows the automation of the entire process, from primary sequence to annotated genome submission, even if a manual curation step is conducted in a visual sequence editor.</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <title>Keywords</title>
      <kwd>Mitochondrial genome</kwd>
      <kwd>gene annotation</kwd>
      <kwd>feature table</kwd>
      <kwd>Python</kwd>
      <kwd>GenBank submission</kwd>
    </kwd-group>
    <support-group>
      <funding-group>
        <award-group>
          <funding-source>
            <institution-wrap>
              <institution>Ministerio de Ciencia, Innovación y Universidades</institution>
              <institution-id institution-id-type="open-funder-registry">10.13039/100014440</institution-id>
            </institution-wrap>
          </funding-source>
          <award-id>PID2019-107481GA-I00 </award-id>
        </award-group>
        <award-group>
          <funding-source>
            <institution-wrap>
              <institution>Ministerio de Economía y Competitividad</institution>
              <institution-id institution-id-type="open-funder-registry">10.13039/501100003329</institution-id>
            </institution-wrap>
          </funding-source>
          <award-id>CGL2016-76164-P. </award-id>
        </award-group>
        <funding-statement>This work was supported by the Ministerio de Ciencia, Innovación y Universidades under Grant PID2019-107481GA-I00, and Ministerio de Economía y Competitividad under Grant CGL2016-76164-P.</funding-statement>
      </funding-group>
    </support-group>
    <counts>
      <fig-count count="1"/>
      <table-count count="0"/>
      <page-count count="4"/>
      <word-count count="3094"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" disp-level="1" id="S0001">
    <label>1.</label>
    <title>Introduction</title>
    <p>The collection of complete mitochondrial genome sequences from a genome project at low coverage is now straightforward due to advances in high-throughput sequencing. Several bioinformatic pipelines were developed to automatically annotate the 37 genes generally encoded in animal mitogenomes, with MITOS (Bernt et al. <xref rid="CIT0002" ref-type="bibr">2013</xref>) and MITOS2 (Donath et al. <xref rid="CIT0005" ref-type="bibr">2019</xref>) being a popular option. This pipeline puts together BLAST searches based on sequence identity and hidden Markov models (HMM) to annotate protein and ribosomal coding genes, and covariance models based on cloverleaf-like structures and other relaxed models to annotate tRNA coding genes. Other programs were designed to find mitochondrial genes with intron sequences (Mfannot; Lang et al. <xref rid="CIT0009" ref-type="bibr">2007</xref>), to work on specific taxa such as fish (MitoAnnotator; Iwasaki et al. <xref rid="CIT0007" ref-type="bibr">2013</xref>) or seed plants (MITOFY; Alverson et al. <xref rid="CIT0001" ref-type="bibr">2010</xref>), to annotate both organelle genomes (GeSeq; Tillich et al. <xref rid="CIT0014" ref-type="bibr">2017</xref>; and GetOrganelle; Jin et al. <xref rid="CIT0008" ref-type="bibr">2020</xref>) and even to perform the full pipeline from reads assembly, gene annotation and mitogenome visualization in a single tool (MitoZ; Yang et al. <xref rid="CIT0015" ref-type="bibr">2019</xref>). These annotation programs generally produce a feature table that could be used to submit mitogenome annotations to data banks directly using online (e.g. Webin and Bankit) and offline tools (e.g. Sequin and tbl2asn). The feature table used by DDBJ/ENA/GenBank (Definition Version 10.9 November 2019) includes all gene annotations as a five-column, tab-delimited table of feature locations and qualifiers.</p>
    <p>Nevertheless, automatic annotations generally require some sort of manual curation in a visual alignment editor, as the comparison of gene sequences w.ecies may reveal inconsistencies, particularly at the beginnings and ends of CDS and ribosomal genes, less frequently in tRNA genes. Manual curation of an alignment of individual genes mapped on complete mitochondrial sequences in fasta format is a fairly straightforward process that can be appropriately performed in visual alignment editors such as Aliview (Larsson <xref rid="CIT0011" ref-type="bibr">2014</xref>) and Seaview (Gouy et al. <xref rid="CIT0006" ref-type="bibr">2010</xref>). Editing, nevertheless, invalidates the automatically produced feature table and introduces the need to manually update the table based on modifications manually introduced in the alignment. Minor corrections of locations and qualifiers in the feature table are easily accomplished manually, but continuous refinement, update, addition and deletion of gene features is a lengthy process prone to errors. A new workaround was recently proposed in the context of mitoconstrictor (Lubośny et al. <xref rid="CIT0012" ref-type="bibr">2020</xref>) to update feature tables from sequence files in gbk format. We propose a new python3 script aln2tbl.py that, starting from a modified alignment in fasta format, such as those produced in Aliview and Seaview, recreates the corresponding feature table as a standard five-column and tab-delimited table compatible with downstream applications. The feature table is further populated with information specific to the mitochondrial genome. Notably, this feature table file can be used as input in tbl2asn, along with the complete nucleotide sequence of mitogenome and the submitter information, to automatically create a sqn file to be directly submitted to data banks. The new script fills a gap in the available pipeline and allows the full automation of the procedure from primary sequence to genome submission (apart from the actual step of manual visualization/editing of annotations). This should foster manual curation of newly sequenced genomes, something that is emerging as a priority in the field of mitochondrial genomics.</p>
  </sec>
  <sec sec-type="materials" disp-level="1" id="S0002">
    <label>2.</label>
    <title>Materials and methods</title>
    <p>The aln2tbl.py script is written in python v3.8.3 and is freely available, including documentation and examples, from GitHub (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/IMEDEA/mitogenomics" ext-link-type="uri">https://github.com/IMEDEA/mitogenomics</ext-link>). An older python v2 version is also available in GitHub but will not be maintained further. The script requires two python modules (biopython and argparse) as dependencies. As long as the python interpreter and dependencies are installed, the script is platform independent. See the Results section and GitHub page for additional details on implementation and usage.</p>
    <p>The script aln2tbl.py was tested on 35 mitogenomes from different taxonomic groups (see <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://doi.org/10.1080/23802359.2021.1966334" ext-link-type="uri">Supplementary Table 1</ext-link>) downloaded from GenBank. Individual genes were extracted based on the original GenBank annotations to simulate a MITOS output. A mitogenome contig was constructed in Bowtie2 (Langmead and Salzberg <xref rid="CIT0010" ref-type="bibr">2012</xref>) to be visualized in Aliview. The new script aln2tbl.py was used to recreate the corresponding feature table. This, alongside the primary sequence and ancillary information, was used as input for tbl2asn (v25.8) to create a sqn file ready for submission and the corresponding GenBank file. This latter was compared with the original GenBank file deposited in NCBI to assess script accuracy.</p>
  </sec>
  <sec sec-type="results" disp-level="1" id="S0003">
    <label>3.</label>
    <title>Results</title>
    <sec disp-level="2" id="S0003-S2001">
      <label>3.1.</label>
      <title>Implementation and usage</title>
      <p>The aln2tbl.py script takes as input (a) a fasta file including, as separate sequences, the entire genome and each subsequence to be annotated, generally the 37 genes and a control region; (b) a text file listing genes that are encoded on the sequenced strand; (c) an indication of the genetic code to be used. The script can be run using the following command:</p>
      <p>aln2tbl.py -f assembly_file.fas -g forward_genes_file.txt -c number_genetic_code &gt; feature_table_file.tbl</p>
      <p>This assumes python3 is the default interpreter in the environment <monospace>/usr/bin/env python3</monospace>. If this is not the case, or multiple python installations are available, the full path to python3 interpreter can be added to the command line (e.g. <monospace>/usr/bin/python3 aln2tbl.py</monospace>).</p>
      <p>The fasta alignment (contig or assembly) file (-f/–fasta) must include the complete nucleotide sequence of the mitogenome as well as the sequence of each mapped gene aligned below, with a single line per gene sequence. Gene names must comply with the names proposed by Boore and Brown (<xref rid="CIT0003" ref-type="bibr">2000</xref>) as in most recent GenBank annotations. Names for the protein coding genes are as follows: atp6, atp8, cob, cox1, cox2, cox3, nad1, nad2, nad3, nad4, nad4L, nad5 and nad6. Accepted names for ribosomal genes are rrnL (or 16S) and rrnS (or 12S) for the large and small ribosomal subunit, respectively. tRNAs are indicated using the single letter corresponding to the encoded tRNA (e.g. M for methionine). The two tRNA genes that are generally present for Leucine and Serine must be differentiated by post-pending the correct number to the gene name: L1 for <italic toggle="yes">tRNA<sup>Leu(CUN)</sup></italic>, L2 for <italic toggle="yes">tRNA<sup>Leu(UUR)</sup></italic>, S1 for <italic toggle="yes">tRNA<sup>Ser(AGN)</sup></italic> and S2 for <italic toggle="yes">tRNA<sup>Ser(UCN)</sup></italic>). The control region, if included, must be named 'control_region' or 'CR'. If two or more control regions are present, they can be differentiated and named as 'CR1' and 'CR2'. Control regions, like PCGs, rRNAs and tRNAs, should be identified based on strong evidences prior to annotation such as position, base composition, and presence of specific conserved elements. Hence, we suggest not to annotate any long non-coding region as control region. Any additional annotation, if present, will be annotated as miscellaneous feature. In order to produce a well organized and easily readable feature table, gene sequences should be sorted by the position of the first nucleotide. If not, they will nevertheless be reordered automatically by tbl2asn at a later stage (see below).</p>
      <p>The initial fasta alignment of automatically annotated gene sequences against the complete mitogenome can be obtained in several ways starting from the results of an automatic annotation (e.g. MITOS). One flexible option, using free software that can be called using bash scripting, is to build the contig using Bowtie2, sort the bam file by coordinate in picard tools (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://broadinstitute.github.io/picard" ext-link-type="uri">http://broadinstitute.github.io/picard</ext-link>), and finally convert the bam file to fasta with the python3 script sam2fasta.py (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://sourceforge.net/projects/sam2fasta/files/" ext-link-type="uri">https://sourceforge.net/projects/sam2fasta/files/</ext-link>). Another option, provided that gene and genome sequences are position ordered, identical and ungapped (e.g. in the MITOS output), is to use the python v3 script mitos2aln.py, provided as companion to aln2tbl.phy. This script produces a fasta alignment of each gene nucleotide sequence relative to complete mitogenome sequence and parses MITOS gene nomenclature of fasta headers with four semicolon separated fields to single names compatible with aln2tbl.py naming (see below for duplicated genes). This fasta contig with automatic gene annotations obtained in MITOS can now be the easily refined manually in a visual alignment editor such as SeaView or Aliview prior to further processing in aln2tbl.py.</p>
      <p>The second argument (-g/–genes) takes a plain text file with the list of genes encoded on the sequenced strand (i.e. in forward orientation in the sequence that is being submitted), identified by name, separated by commas and without spaces. This information allows the script to correctly reverse/complement the nucleotide sequence of genes encoded on the opposite strand prior to annotation. The control region should be also included in the gene file (–genes) if it has to be annotated in forward orientation.</p>
      <p>The last argument (-c/–code) parses the number of the appropriated mitochondrial genetic code (e.g. 2 for vertebrate mitochondrial code, 5 for invertebrate mitochondrial code; see <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.ncbi.nlm.nih.gov/Taxonomy/Utils/wprintgc.cgi" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/Taxonomy/Utils/wprintgc.cgi</ext-link> for a complete list). The output should be saved as a text file with tbl extension to be readily identified as a feature table.</p>
      <p>The aln2tbl.py script is able to annotate non-canonical start and truncated stop codons in CDS genes correctly as translation exceptions. An appropriate description is added as a qualifier note following standard practices. Both truncated stop codons (TA, T) are correctly processed. Nevertheless the use of truncated TA stop codons is discouraged as this is not recognized by some downstream applications (e.g. tbl2asn). A truncated T codon can be used as a substitute. The script also detects CDS ending with a non-canonical stop codon and prints an error in the output feature table (“ERROR IN STOP CODON”) so input alignment can be corrected and the script run again. The aln2tbl.py script can not handle partial or split genes, though this is an uncommon circumstance in mitogenomes. If present, the feature table must be manually corrected by adding the symbols &lt; and &gt; for partial 5′ and 3′ ends, respectively. The presence of duplicated tRNA genes, which is also uncommon, cannot be handled as it results in a duplicated gene name, and must be manually annotated in the feature table.</p>
      <p>Once the final feature table is created with aln2tbl.py, the program tbl2asn (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.ncbi.nlm.nih.gov/genbank/tbl2asn2/" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/genbank/tbl2asn2/</ext-link>) can be used to generate a sqn file to be submitted to data banks. The program tbl2asn takes as input: (a) the complete genome sequence in fasta format (-i argument, with extension fas), which header should correspond to the genome sequence name in the feature table, and may optionally include source modifiers in square brackets (e.g. topology and specimen-voucher; see <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.ncbi.nlm.nih.gov/Sequin/modifiers.html" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/Sequin/modifiers.html</ext-link> for a complete list). Alternatively, source modifiers can be added using the -j command; (b) the feature table (-f command, with extension tbl) as recreated using aln2tbl.py; (c) submitter and manuscript information (-t argument, with extension sbt) that can be prepared using the NCBI web service <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://submit.ncbi.nlm.nih.gov/genbank/template/submission/" ext-link-type="uri">https://submit.ncbi.nlm.nih.gov/genbank/template/submission/</ext-link>. The program tbl2asn may also include the sub-command -T to remotely check and include full taxonomy of the species. Additional details on tbl2asn can be found at its home page on NCBI: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.ncbi.nlm.nih.gov/genbank/tbl2asn2/" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/genbank/tbl2asn2/</ext-link>. The script can be run using the following command:
<disp-formula id="M0001"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="TMDN_A_1966334_M0001.jpg" position="float"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="d2e330" display="block"><mml:mi>tbl</mml:mi><mml:mn>2</mml:mn><mml:mi mathvariant="normal">a</mml:mi><mml:mi>sn</mml:mi><mml:mo>−</mml:mo><mml:mtext>i mitogenome</mml:mtext><mml:mo>.</mml:mo><mml:mi>fas</mml:mi><mml:mo>−</mml:mo><mml:mtext>f featuretable</mml:mtext><mml:mo>_</mml:mo><mml:mi>file</mml:mi><mml:mo>.</mml:mo><mml:mi>tbl</mml:mi><mml:mo>−</mml:mo><mml:mtext>t submission_template</mml:mtext><mml:mo>.</mml:mo><mml:mi>sbt</mml:mi><mml:mo>−</mml:mo><mml:mtext>a s</mml:mtext><mml:mo>−</mml:mo><mml:mtext>V bv</mml:mtext><mml:mo>−</mml:mo><mml:mi mathvariant="normal">T</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="normal">j</mml:mi><mml:mo>"</mml:mo><mml:mo>[</mml:mo><mml:mi>mgcode</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>]</mml:mo><mml:mo>[</mml:mo><mml:mi>location</mml:mi><mml:mo>=</mml:mo><mml:mi>mitochondrion</mml:mi><mml:mo>]</mml:mo><mml:mo>[</mml:mo><mml:mi>organism</mml:mi><mml:mo>=</mml:mo><mml:mtext>Hyalella solida</mml:mtext><mml:mo>]</mml:mo><mml:mo>"</mml:mo></mml:math></alternatives></disp-formula>
</p>
      <p>This will produce four files. The file mitogenome.sqn is the main output file and can be used to directly submit the annotated genome sequence to GenBank. The file mitogenome.gbf corresponds to the GenBank record in human readable format, as it will be visible after processing and publication, while mitogenome.val includes warnings or errors. The file errorsummary.val also summarize errors. The pipeline described here is summarized in <xref rid="F0001" ref-type="fig">Figure 1</xref> and a full example, scripts and pipeline are deposited in GitHub.</p>
      <fig position="float" id="F0001">
        <label>Figure 1.</label>
        <caption>
          <p>Procedure from primary mitochondrial sequence to submission to GenBank. *Indicates the position of the aln2tbl script.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="TMDN_A_1966334_F0001_B" content-type="black-white" position="float"/>
      </fig>
    </sec>
    <sec disp-level="2" id="S0003-S2002">
      <label>3.2.</label>
      <title>Testing</title>
      <p>Comparison of the 35 genomes annotations produced using aln2tbl.py with the original GenBank annotation of the same genomes (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://doi.org/10.1080/23802359.2021.1966334" ext-link-type="uri">Supplementary Table 1</ext-link>, <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://doi.org/10.1080/23802359.2021.1966334" ext-link-type="uri">Supplementary Material</ext-link>) produced no inconsistency overall, indicating that the script is fully functional and capable of addressing idiosyncrasies of individual genome annotations from different lineages. The programs aln2tbl.py and tbl2asn can not handle duplicated genes with identical name so this issue must be solved manually.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" disp-level="1" id="S0004">
    <label>4.</label>
    <title>Discussion</title>
    <p>The manual curation of automatic annotations is a necessary step in the process of genome analysis prior to submission to a databank. Manual editing in a visual sequence editor nevertheless invalidates the automatically produced feature table. Our script aln2tbl.py can easily recreate the feature table based on the modified contig and allows further processing in tbl2aln to produce a sqn file that can be directly submitted to databanks. Besides filling a gap in the current pipeline, allowing the automation of the entire process using scripting, aln2tbl.py is specifically designed with mitochondrial genomes in mind. It can handle non canonical start and stop codons (e.g. 'transl_except (pos:11922,aa:TERM)'), it introduces annotations specific to the mitochondrial genome following current good practices in the field (e.g. 'TAA stop codon is completed by the addition of 3′ A residues to the mRNA') and transforms abbreviated gene names into full names in the product field (e.g. 'product NADH dehydrogenase subunit 3′). We hope that, by facilitating the entire process, more authors will introduce a manual curation step of annotations in their production pipelines, something that is frequently advocated but not always accomplished (Prada and Boore <xref rid="CIT0013" ref-type="bibr">2019</xref>; Cucini et al. <xref rid="CIT0004" ref-type="bibr">2021</xref>).</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="SM8066" position="float" content-type="local-data">
      <caption>
        <title>Supplemental Material</title>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="TMDN_A_1966334_SM8066.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We thanks all IMEDEA, CSIC and UIB staff for their collaboration and support to achieve the research goals of our institutions, and to Dr. Claudio Cucini for testing the scripts. We are indebted to the three anonymous reviewers which greatly improved the manuscript, the script and its usage and description in GitHub (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/IMEDEA/mitogenomics" ext-link-type="uri">https://github.com/IMEDEA/mitogenomics</ext-link>).</p>
  </ack>
  <sec sec-type="COI-statement" disp-level="1" id="S0005">
    <title>Disclosure statement</title>
    <p>Authors declare that there is no relevant financial or non-financial competing interests.</p>
  </sec>
  <sec sec-type="data-availability" disp-level="1" id="S0006">
    <title>Data availability statement</title>
    <p>The Python scripts aln2tbl.py, alongside its companion mitos2aln.py, documentation and examples, is freely available on GitHub (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/IMEDEA/mitogenomics" ext-link-type="uri">https://github.com/IMEDEA/mitogenomics</ext-link>) under the license GNU GPLv3.</p>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="CIT0001">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alverson</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Wei</surname><given-names>X</given-names></string-name>, <string-name><surname>Rice</surname><given-names>DW</given-names></string-name>, <string-name><surname>Stern</surname><given-names>DB</given-names></string-name>, <string-name><surname>Barry</surname><given-names>K</given-names></string-name>, <string-name><surname>Palmer</surname><given-names>JD.</given-names></string-name></person-group><year>2010</year>. <article-title>Insights into the evolution of mitochondrial genome size from complete sequences of <italic toggle="yes">Citrullus lanatus</italic> and <italic toggle="yes">Cucurbita pepo (Cucurbitaceae)</italic></article-title>. <source>Mol Biol Evol</source>. <volume>27</volume>(<issue>6</issue>):<fpage>1436</fpage>–<lpage>1448</lpage>.<pub-id pub-id-type="pmid">20118192</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0002">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bernt</surname><given-names>M</given-names></string-name>, <string-name><surname>Donath</surname><given-names>A</given-names></string-name>, <string-name><surname>Jühling</surname><given-names>F</given-names></string-name>, <string-name><surname>Externbrink</surname><given-names>F</given-names></string-name>, <string-name><surname>Florentz</surname><given-names>C</given-names></string-name>, <string-name><surname>Fritzsch</surname><given-names>G</given-names></string-name>, <string-name><surname>Pütz</surname><given-names>J</given-names></string-name>, <string-name><surname>Middendorf</surname><given-names>M</given-names></string-name>, <string-name><surname>Stadler</surname><given-names>PF.</given-names></string-name></person-group><year>2013</year>. <article-title>MITOS: improved de novo metazoan mitochondrial genome annotation</article-title>. <source>Mol Phylogenet Evol</source>. <volume>69</volume>(<issue>2</issue>):<fpage>313</fpage>–<lpage>319</lpage>.<pub-id pub-id-type="pmid">22982435</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0003">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Boore</surname><given-names>JL</given-names></string-name>, <string-name><surname>Brown</surname><given-names>WM.</given-names></string-name></person-group><year>2000</year>. <article-title>Mitochondrial genomes of <italic toggle="yes">Galathealinum</italic>, <italic toggle="yes">Helobdella</italic>, and <italic toggle="yes">Platynereis</italic>: sequence and gene arrangement comparisons indicate that pogonophora is not a phylum and annelida and arthropoda are not sister taxa</article-title>. <source>Mol Biol Evol</source>. <volume>17</volume>(<issue>1</issue>):<fpage>87</fpage>–<lpage>106</lpage>.<pub-id pub-id-type="pmid">10666709</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0004">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cucini</surname><given-names>C</given-names></string-name>, <string-name><surname>Fanciulli</surname><given-names>PP</given-names></string-name>, <string-name><surname>Frati</surname><given-names>F</given-names></string-name>, <string-name><surname>Convey</surname><given-names>P</given-names></string-name>, <string-name><surname>Nardi</surname><given-names>F</given-names></string-name>, <string-name><surname>Carapelli</surname><given-names>A.</given-names></string-name></person-group><year>2021</year>. <article-title>Re-evaluating the internal phylogenetic relationships of Collembola by means of mitogenome data</article-title>. <source>Genes</source>. <volume>12</volume>:<fpage>44</fpage>.</mixed-citation>
    </ref>
    <ref id="CIT0005">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Donath</surname><given-names>A</given-names></string-name>, <string-name><surname>Jühling</surname><given-names>F</given-names></string-name>, <string-name><surname>Al-Arab</surname><given-names>M</given-names></string-name>, <string-name><surname>Bernhart</surname><given-names>SH</given-names></string-name>, <string-name><surname>Reinhardt</surname><given-names>F</given-names></string-name>, <string-name><surname>Stadler</surname><given-names>PF</given-names></string-name>, <string-name><surname>Middendorf</surname><given-names>M</given-names></string-name>, <string-name><surname>Bernt</surname><given-names>M.</given-names></string-name></person-group><year>2019</year>. <article-title>Improved annotation of protein-coding genes boundaries in metazoan mitochondrial genomes</article-title>. <source>Nucleic Acids Res</source>. <volume>47</volume>(<issue>20</issue>):<fpage>10543</fpage>–<lpage>10552</lpage>.<pub-id pub-id-type="pmid">31584075</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0006">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gouy</surname><given-names>M</given-names></string-name>, <string-name><surname>Guindon</surname><given-names>S</given-names></string-name>, <string-name><surname>Gascuel</surname><given-names>O.</given-names></string-name></person-group><year>2010</year>. <article-title>SeaView version 4: a multiplatform graphical user interface for sequence alignment and phylogenetic tree building</article-title>. <source>Mol Biol Evol</source>. <volume>27</volume>(<issue>2</issue>):<fpage>221</fpage>–<lpage>224</lpage>.<pub-id pub-id-type="pmid">19854763</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0007">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Iwasaki</surname><given-names>W</given-names></string-name>, <string-name><surname>Fukunaga</surname><given-names>T</given-names></string-name>, <string-name><surname>Isagozawa</surname><given-names>R</given-names></string-name>, <string-name><surname>Yamada</surname><given-names>K</given-names></string-name>, <string-name><surname>Maeda</surname><given-names>Y</given-names></string-name>, <string-name><surname>Satoh</surname><given-names>TP</given-names></string-name>, <string-name><surname>Sado</surname><given-names>T</given-names></string-name>, <string-name><surname>Mabuchi</surname><given-names>K</given-names></string-name>, <string-name><surname>Takeshima</surname><given-names>H</given-names></string-name>, <string-name><surname>Miya</surname><given-names>M</given-names></string-name>, <etal>et al.</etal></person-group><year>2013</year>. <article-title>MitoFish and MitoAnnotator: a mitochondrial genome database of fish with an accurate and automatic annotation pipeline</article-title>. <source>Mol Biol Evol</source>. <volume>30</volume>(<issue>11</issue>):<fpage>2531</fpage>–<lpage>2540</lpage>.<pub-id pub-id-type="pmid">23955518</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0008">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jin</surname><given-names>JJ</given-names></string-name>, <string-name><surname>Yu</surname><given-names>WB</given-names></string-name>, <string-name><surname>Yang</surname><given-names>JB</given-names></string-name>, <string-name><surname>Song</surname><given-names>Y</given-names></string-name>, <string-name><surname>dePamphilis</surname><given-names>CW</given-names></string-name>, <string-name><surname>Yi</surname><given-names>TS</given-names></string-name>, <string-name><surname>Li</surname><given-names>DZ.</given-names></string-name></person-group><year>2020</year>. <article-title>GetOrganelle: a fast and versatile toolkit for accurate de novo assembly of organelle genomes</article-title>. <source>Genome Biol</source>. <volume>21</volume>(<issue>1</issue>):<fpage>241</fpage>.<pub-id pub-id-type="pmid">32912315</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0009">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lang</surname><given-names>BF</given-names></string-name>, <string-name><surname>Laforest</surname><given-names>M-J</given-names></string-name>, <string-name><surname>Burger</surname><given-names>G.</given-names></string-name></person-group><year>2007</year>. <article-title>Mitochondrial introns: a critical view</article-title>. <source>Trends Genet</source>. <volume>23</volume>(<issue>3</issue>):<fpage>119</fpage>–<lpage>125</lpage>.<pub-id pub-id-type="pmid">17280737</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0010">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Langmead</surname><given-names>B</given-names></string-name>, <string-name><surname>Salzberg</surname><given-names>S.</given-names></string-name></person-group><year>2012</year>. <article-title>Fast gapped-read alignment with Bowtie 2</article-title>. <source>Nat Methods</source>. <volume>9</volume>(<issue>4</issue>):<fpage>357</fpage>–<lpage>359</lpage>.<pub-id pub-id-type="pmid">22388286</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0011">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Larsson</surname><given-names>A.</given-names></string-name></person-group><year>2014</year>. <article-title>AliView: a fast and lightweight alignment viewer and editor for large datasets</article-title>. <source>Bioinformatics</source>. <volume>30</volume>(<issue>22</issue>):<fpage>3276</fpage>–<lpage>3278</lpage>.<pub-id pub-id-type="pmid">25095880</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0012">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lubośny</surname><given-names>M</given-names></string-name>, <string-name><surname>Przyłucka</surname><given-names>A</given-names></string-name>, <string-name><surname>Śmietanka</surname><given-names>B</given-names></string-name>, <string-name><surname>Burzyński</surname><given-names>A.</given-names></string-name></person-group><year>2020</year>. <article-title><italic toggle="yes">Semimytilus algosus</italic>: first known hermaphroditic mussel with doubly uniparental inheritance of mitochondrial DNA</article-title>. <source>Sci Rep</source>. <volume>10</volume>(<issue>1</issue>):<fpage>11256</fpage>.<pub-id pub-id-type="pmid">32647112</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0013">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Prada</surname><given-names>CF</given-names></string-name>, <string-name><surname>Boore</surname><given-names>JL.</given-names></string-name></person-group><year>2019</year>. <article-title>Gene annotation errors are common in the mammalian mitochondrial genomes database</article-title>. <source>BMC Genomics</source>. <volume>20</volume>(<issue>1</issue>):<fpage>73</fpage>.<pub-id pub-id-type="pmid">30669991</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0014">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tillich</surname><given-names>M</given-names></string-name>, <string-name><surname>Lehwark</surname><given-names>P</given-names></string-name>, <string-name><surname>Pellizzer</surname><given-names>T</given-names></string-name>, <string-name><surname>Ulbricht-Jones</surname><given-names>ES</given-names></string-name>, <string-name><surname>Fischer</surname><given-names>A</given-names></string-name>, <string-name><surname>Bock</surname><given-names>R</given-names></string-name>, <string-name><surname>Greiner</surname><given-names>S.</given-names></string-name></person-group><year>2017</year>. <article-title>GeSeq - versatile and accurate annotation of organelle genomes</article-title>. <source>Nucleic Acids Res</source>. <volume>45</volume>(<issue>W1</issue>):<fpage>W6</fpage>–<lpage>W11</lpage>.<pub-id pub-id-type="pmid">28486635</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0015">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>C</given-names></string-name>, <string-name><surname>Meng</surname><given-names>G</given-names></string-name>, <string-name><surname>Liu</surname><given-names>S</given-names></string-name>, <string-name><surname>Li</surname><given-names>Y.</given-names></string-name></person-group><year>2019</year>. <article-title>MitoZ: a toolkit for animal mitochondrial genome assembly, annotation and visualization</article-title>. <source>Nucleic Acids Res</source>. <volume>47</volume>(<issue>11</issue>):<fpage>e63</fpage>.<pub-id pub-id-type="pmid">30864657</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
