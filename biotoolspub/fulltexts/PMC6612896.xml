<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6612896</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bty1007</article-id>
    <article-id pub-id-type="publisher-id">bty1007</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Alfred: interactive multi-sample BAM alignment statistics, feature counting and feature annotation for long- and short-read sequencing</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-5773-5620</contrib-id>
        <name>
          <surname>Rausch</surname>
          <given-names>Tobias</given-names>
        </name>
        <xref ref-type="aff" rid="bty1007-aff1">bty1007-aff1</xref>
        <xref ref-type="aff" rid="bty1007-aff2">bty1007-aff2</xref>
        <xref ref-type="corresp" rid="COR1"/>
        <xref ref-type="author-notes" rid="bty1007-FM3"/>
        <!--<email>tobias.rausch@embl.de</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hsi-Yang Fritz</surname>
          <given-names>Markus</given-names>
        </name>
        <xref ref-type="aff" rid="bty1007-aff2">bty1007-aff2</xref>
        <xref ref-type="author-notes" rid="bty1007-FM3"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Korbel</surname>
          <given-names>Jan O</given-names>
        </name>
        <xref ref-type="aff" rid="bty1007-aff2">bty1007-aff2</xref>
        <xref ref-type="author-notes" rid="bty1007-FM4"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Benes</surname>
          <given-names>Vladimir</given-names>
        </name>
        <xref ref-type="aff" rid="bty1007-aff1">bty1007-aff1</xref>
        <xref ref-type="author-notes" rid="bty1007-FM4"/>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Birol</surname>
          <given-names>Inanc</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="bty1007-aff1"><label>bty1007-aff1</label>Genomics Core Facility, European Molecular Biology Laboratory (EMBL), Meyerhofstrasse 1, Heidelberg, Germany</aff>
    <aff id="bty1007-aff2"><label>bty1007-aff2</label>Genome Biology Unit, European Molecular Biology Laboratory (EMBL), Meyerhofstrasse 1, Heidelberg, Germany</aff>
    <author-notes>
      <corresp id="COR1">To whom correspondence should be addressed. Email: <email>tobias.rausch@embl.de</email></corresp>
      <fn id="bty1007-FM3">
        <p>The authors wish it to be known that, in their opinion, Tobias Rausch and Markus Hsi-Yang Fritz authors should be regarded as Joint First Authors.</p>
      </fn>
      <fn id="bty1007-FM4">
        <p>The authors wish it to be known that, in their opinion, Jan O. Korbel and Vladimir Benes authors should be regarded as Joint Co-senior Authors.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2018-12-06">
      <day>06</day>
      <month>12</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>06</day>
      <month>12</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>35</volume>
    <issue>14</issue>
    <fpage>2489</fpage>
    <lpage>2491</lpage>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>9</month>
        <year>2018</year>
      </date>
      <date date-type="rev-recd">
        <day>20</day>
        <month>11</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>05</day>
        <month>12</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bty1007.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Harmonizing quality control (QC) of large-scale second and third-generation sequencing datasets is key for enabling downstream computational and biological analyses. We present Alfred, an efficient and versatile command-line application that computes multi-sample QC metrics in a read-group aware manner, across a wide variety of sequencing assays and technologies. In addition to standard QC metrics such as GC bias, base composition, insert size and sequencing coverage distributions it supports haplotype-aware and allele-specific feature counting and feature annotation. The versatility of Alfred allows for easy pipeline integration in high-throughput settings, including DNA sequencing facilities and large-scale research initiatives, enabling continuous monitoring of sequence data quality and characteristics across samples. Alfred supports haplo-tagging of BAM/CRAM files to conduct haplotype-resolved analyses in conjunction with a variety of next-generation sequencing based assays. Alfred’s companion web application enables interactive exploration of results and comparison to public datasets.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>Alfred is open-source and freely available at <ext-link ext-link-type="uri" xlink:href="https://tobiasrausch.com/alfred/">https://tobiasrausch.com/alfred/</ext-link>.</p>
      </sec>
      <sec id="s3">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">NIH</named-content>
          <named-content content-type="funder-identifier">10.13039/100000002</named-content>
        </funding-source>
        <award-id>U41HG007497</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Many methods have been developed to perform quality control (QC) on specific types of sequencing assays (<xref rid="bty1007-B3" ref-type="bibr">Endrullat <italic>et al.</italic>, 2016</xref>), such as RNA-SeQC (<xref rid="bty1007-B1" ref-type="bibr">DeLuca <italic>et al.</italic>, 2012</xref>) for RNA-Seq data, Chance (<xref rid="bty1007-B2" ref-type="bibr">Diaz <italic>et al.</italic>, 2012</xref>) for ChIP-seq data or Poretools (<xref rid="bty1007-B6" ref-type="bibr">Loman and Quinlan, 2014</xref>) for Oxford Nanopore sequencing data. Popular general purpose alignment QC methods are, for instance, QualiMap2 (<xref rid="bty1007-B7" ref-type="bibr">Okonechnikov <italic>et al.</italic>, 2016</xref>) and NGS QC Toolkit (<xref rid="bty1007-B8" ref-type="bibr">Patel and Jain, 2012</xref>). Despite these developments, it remains challenging for DNA sequencing facilities and large genomics projects to find a versatile QC method that is computationally efficient, easy to use and install, robust to diverse sequencing assays as well as protocols and accessible to Bioinformaticians, experimentalists and wet-lab technicians alike. An installation-free, easy to use, interactive interface that allows exploration of the QC data across samples and data types is often not available and a direct comparison to public data frequently entails downloading gigabytes of alignment files to compute background distributions and to estimate acceptable ranges for each quality parameter.</p>
    <p>Alfred fills an important gap in this context by computing key quality statistics rapidly, across hundreds of samples and with a versatile web front end for data exploration and comparison to publicly available data resources. For each sample, the method generates an extensible JSON file with the key QC metrics that can be merged across samples and then explored interactively at <ext-link ext-link-type="uri" xlink:href="https://gear.embl.de/alfred">https://gear.embl.de/alfred</ext-link>. The Alfred command-line interface is available as a statically linked binary on GitHub, via Bioconda or as a minimal Docker container. Alfred provides a wide range of QC metrics, some of general relevance such as the insert size distribution and others more targeted to specific sequencing assays, such as the on-target rate for capture assays (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>). Grouping of charts can be pursued to facilitate comparison of relevant distributions: the insert size distribution, for instance, is stratified by paired-end orientation to distinguish paired-end and mate-pair libraries frequently employed in structural variant calling (<xref rid="bty1007-B10" ref-type="bibr">Rausch <italic>et al.</italic>, 2012</xref>). Alfred additionally provides fast methods for feature counting and feature annotation, generation of browser tracks and methods to analyze alignments in a haplotype-resolved manner. All of these functions are competitive with respect to runtime and memory usage compared to commonly used tools in each of these application areas (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S2</xref>). As input, Alfred supports BAM and CRAM files (<xref rid="bty1007-B4" ref-type="bibr">Hsi-Yang Fritz <italic>et al.</italic>, 2011</xref>).</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>Alfred uses sub-commands for BAM/CRAM statistics, feature counting and feature annotation. The main methods are outlined below. All backend code is open-source and written in C++ using HTSlib (<xref rid="bty1007-B5" ref-type="bibr">Li <italic>et al.</italic>, 2009</xref>) and Boost (<xref rid="bty1007-B11" ref-type="bibr">Schaeling, 2011</xref>).</p>
    <sec>
      <title>2.1 BAM QC metrics</title>
      <p>Alfred parses the BAM file only once and pre-allocates data structures for counting primary, secondary, supplementary and spliced alignments. Paired-end orientations are counted by type (F-, F+, R-, R+) and sequencing error rates are computed separately for mismatch, insertion and deletion errors (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>). InDel sizes are cataloged and potential homopolymer sequence regions and a fragment-based GC bias curve is estimated from the reference context. If a BED file of target regions is provided, Alfred computes the on-target rate and the target coverage distribution as well as overall enrichment of targeted regions. For tagged BAM files that utilize unique molecular identifiers (UMIs), the number of UMIs and the fraction of tagged molecules are computed. For haplotype-tagged files, the number of phased blocks and the N50 phased block length are computed. All QC output files are gzip-compressed to save space. Two output formats are available: first, a block structured tab-delimited file format as in samtools stats to efficiently filter (‘grep’) desired statistics in pipelines and computational workflows and second, a succinct and extensible JSON format that can be visualized in our companion web application.</p>
    </sec>
    <sec>
      <title>2.2 Feature counting and feature annotation</title>
      <p>Alfred supports counting reads in overlapping or non-overlapping windows, at pre-defined intervals in BED format or as gene and transcript counting for RNA-Seq in stranded or unstranded mode using a gtf or gff3 gene annotation file. Expression values can be normalized as raw counts, FPKM or FPKM-UQ values. Additionally, browser tracks in UCSC bedgraph format can be computed with configurable resolution. Alfred also supports annotation of ChIP-Seq and ATAC-Seq peaks for neighboring genes or transcription factor binding sites based on motif alignments.</p>
    </sec>
    <sec>
      <title>2.3 Haplotype tagging and allele-specific applications</title>
      <p>With the advent of long reads and haplotype resolved sequencing protocols such as 10X Genomics or Strand-Seq (<xref rid="bty1007-B9" ref-type="bibr">Porubsky <italic>et al.</italic>, 2017</xref>), there is an increasing need to split BAM files by haplotype and perform haplotype-aware downstream analyses. Alfred provides basic functions to haplo-tag BAM files based on phased VCF files and generates allele-specific count tables for subsequent analyses. For error-prone long read datasets, haplotype-resolved BAM files in conjunction with Alfred’s alignment methods can also be used to generate highly accurate haplotype-specific consensus sequences (<xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>).</p>
    </sec>
    <sec>
      <title>2.4 Multi-sample web application</title>
      <p>Alfred’s JSON files can be visualized with the companion web application that is built with standard web technologies (HTML, CSS, JavaScript and SVG) and thus can readily be used with common web browsers. Importantly, this allows using the application from different operating systems and without any installation procedure. All charts are interactive, supporting panning and zooming and all charts and tables can be downloaded as png and csv files, respectively. Due to its client-only design (i.e. no server is involved), the application can also be installed easily and used offline or embedded in other websites, for example paper companion sites, to provide QC statistics transparently across all samples analyzed in a given study. The application is adaptive to different sequencing protocols, and several features are geared towards specific applications such as the on-target rate measurement available for capture-based sequence assays. The web application also hosts a set of JSON QC files that span a wide range of sequencing assays (DNA-Seq, RNA-Seq, ATAC-Seq, ChIP-Seq, HiC) and sequencing technologies (PacBio, Oxford Nanopore Technologies, Illumina), providing an ideal resource for researchers in need of comparing QC statistics.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Discussion</title>
    <p>Alfred is a comprehensive alignment QC, feature counting and feature annotation method that complements specialized QC packages available for a specific sequencing assay by providing an easy to use, cross-platform interface that allows read-group aware multi-sample comparisons. Alfred supports third generation sequencing technologies and can handle 10X Genomics datasets, Strand-Seq data and reads derived from nanopore sequencing where it readily enables haplotype-resolved analyses.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>bty1007_Supplementary_Data</label>
      <media xlink:href="bty1007_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ACK1">
    <title>Acknowledgements</title>
    <p>The authors thank the Human Genome Structural Variation Consortium for data access, and EMBL GeneCore, GBCS and IT for technical support. The study was supported by funding from the NIH (U41HG007497).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list id="REF1">
    <title>References</title>
    <ref id="bty1007-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>DeLuca</surname><given-names>D.S.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>RNA-SeQC: RNA-seq metrics for quality control and process optimization</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>1530</fpage>–<lpage>1532</lpage>.<pub-id pub-id-type="pmid">22539670</pub-id></mixed-citation>
    </ref>
    <ref id="bty1007-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Diaz</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>CHANCE: comprehensive software for quality control and validation of ChIP-seq data</article-title>. <source>Genome Biol</source>., <volume>13</volume>, <fpage>R98.</fpage><pub-id pub-id-type="pmid">23068444</pub-id></mixed-citation>
    </ref>
    <ref id="bty1007-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Endrullat</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Standardization and quality management in next-generation sequencing</article-title>. <source>Appl. Transl. Genom</source>., <volume>10</volume>, <fpage>2</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">27668169</pub-id></mixed-citation>
    </ref>
    <ref id="bty1007-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hsi-Yang Fritz</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Efficient storage of high throughput DNA sequencing data using reference-based compression</article-title>. <source>Genome Res</source>., <volume>21</volume>, <fpage>734</fpage>–<lpage>740</lpage>.<pub-id pub-id-type="pmid">21245279</pub-id></mixed-citation>
    </ref>
    <ref id="bty1007-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>The sequence alignment/map format and SAMtools</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>2078</fpage>–<lpage>2079</lpage>.<pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="bty1007-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Loman</surname><given-names>N.J.</given-names></name>, <name name-style="western"><surname>Quinlan</surname><given-names>A.R.</given-names></name></person-group> (<year>2014</year>) 
<article-title>Poretools: a toolkit for analyzing nanopore sequence data</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>3399</fpage>–<lpage>3401</lpage>.<pub-id pub-id-type="pmid">25143291</pub-id></mixed-citation>
    </ref>
    <ref id="bty1007-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Okonechnikov</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Qualimap 2: advanced multi-sample quality control for high-throughput sequencing data</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>292</fpage>–<lpage>294</lpage>.<pub-id pub-id-type="pmid">26428292</pub-id></mixed-citation>
    </ref>
    <ref id="bty1007-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Patel</surname><given-names>R.K.</given-names></name>, <name name-style="western"><surname>Jain</surname><given-names>M.</given-names></name></person-group> (<year>2012</year>) 
<article-title>NGS QC toolkit: a toolkit for quality control of next generation sequencing data</article-title>. <source>PLoS One</source>, <volume>7</volume>, <fpage>e30619.</fpage><pub-id pub-id-type="pmid">22312429</pub-id></mixed-citation>
    </ref>
    <ref id="bty1007-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Porubsky</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Dense and accurate whole-chromosome haplotyping of individual genomes</article-title>. <source>Nat. Commun</source>., <volume>8</volume>, <fpage>1293</fpage>.<pub-id pub-id-type="pmid">29101320</pub-id></mixed-citation>
    </ref>
    <ref id="bty1007-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rausch</surname><given-names>T.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>DELLY: structural variant discovery by integrated paired-end and split-read analysis</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>i333</fpage>–<lpage>i339</lpage>.<pub-id pub-id-type="pmid">22962449</pub-id></mixed-citation>
    </ref>
    <ref id="bty1007-B11">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Schaeling</surname><given-names>B.</given-names></name></person-group> (<year>2011</year>) <source>The Boost C++ Libraries</source>. 
<publisher-name>XML Press</publisher-name>
<ext-link ext-link-type="uri" xlink:href="https://scholar.google.com/scholar_lookup?title=The+boost+C+++libraries&amp;author=B.+Sch%C3%A4ling&amp;publication_year=2011">https://scholar.google.com/scholar_lookup?title=The+boost+C+++libraries&amp;author=B.+Sch%C3%A4ling&amp;publication_year=2011</ext-link></mixed-citation>
    </ref>
  </ref-list>
</back>
