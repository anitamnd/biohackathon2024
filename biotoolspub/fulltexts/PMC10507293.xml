<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle d1e1808?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
    <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
    <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
    <journal-title-group>
      <journal-title>GigaByte</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2709-4715</issn>
    <publisher>
      <publisher-name>GigaScience Press</publisher-name>
      <publisher-loc>Sha Tin, New Territories, Hong Kong SAR</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10507293</article-id>
    <article-id pub-id-type="publisher-manuscript">TRR-202305-01</article-id>
    <article-id pub-id-type="publisher-id">91</article-id>
    <article-id pub-id-type="doi">10.46471/gigabyte.91</article-id>
    <article-id pub-id-type="arxiv" specific-use="preprint">https://doi.org/10.48550/arXiv.2308.06792</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Technical Release</subject>
      </subj-group>
      <subj-group subj-group-type="classification">
        <subject>Software and Workflows</subject>
        <subject>Bioinformatics</subject>
        <subject>Genetics</subject>
        <subject>Software Engineering</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ensemblQueryR: fast, flexible and high-throughput querying of Ensembl LD API endpoints in R</article-title>
      <alt-title alt-title-type="right-running-head">ensemblQueryR: fast, flexible and high-throughput querying of Ensembl LD API endpoints in R</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-7196-1410</contrib-id>
        <name>
          <surname>Fairbrother-Browne</surname>
          <given-names>Aine</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff000b" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff000c" ref-type="aff">
          <sup>3</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/conceptualization/" vocab-term="Conceptualization" degree-contribution="lead">Conceptualization</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/formal-analysis/" vocab-term="Formal analysis" degree-contribution="lead">Formal analysis</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/methodology/" vocab-term="Methodology" degree-contribution="lead">Methodology</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/software/" vocab-term="Software" degree-contribution="lead">Software</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-original-draft/" vocab-term="Writing - original draft" degree-contribution="lead">Writing - original draft</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-review-editing/" vocab-term="Writing - review editing" degree-contribution="lead">Writing - review editing</role>
        <xref rid="cor1" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0003-4913-5312</contrib-id>
        <name>
          <surname>García-Ruiz</surname>
          <given-names>Sonia</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff000d" ref-type="aff">
          <sup>4</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/methodology/" vocab-term="Methodology" degree-contribution="supporting">Methodology</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-review-editing/" vocab-term="Writing - review editing" degree-contribution="supporting">Writing - review editing</role>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-6470-7919</contrib-id>
        <name>
          <surname>Hertfelder Reynolds</surname>
          <given-names>Regina</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff000d" ref-type="aff">
          <sup>4</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/conceptualization/" vocab-term="Conceptualization" degree-contribution="supporting">Conceptualization</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-review-editing/" vocab-term="Writing - review editing" degree-contribution="supporting">Writing - review editing</role>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-9520-6957</contrib-id>
        <name>
          <surname>Ryten</surname>
          <given-names>Mina</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff000d" ref-type="aff">
          <sup>4</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/supervision/" vocab-term="Supervision">Supervision</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-review-editing/" vocab-term="Writing - review editing">Writing - review editing</role>
        <xref rid="fn0001" ref-type="author-notes">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0003-1636-491X</contrib-id>
        <name>
          <surname>Hodgkinson</surname>
          <given-names>Alan</given-names>
        </name>
        <xref rid="aff000b" ref-type="aff">
          <sup>2</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/supervision/" vocab-term="Supervision">Supervision</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-review-editing/" vocab-term="Writing - review editing">Writing - review editing</role>
        <xref rid="fn0001" ref-type="author-notes">
          <sup>†</sup>
        </xref>
      </contrib>
      <aff id="aff000a"><label><sup>1</sup></label><addr-line content-type="department">Department of Genetics and Genomic Medicine Research &amp; Teaching</addr-line>, <institution>UCL GOS Institute of Child Health</institution>, <addr-line content-type="city">London</addr-line>, <country>UK</country></aff>
      <aff id="aff000b"><label><sup>2</sup></label><addr-line content-type="department">Department of Medical and Molecular Genetics</addr-line>, <institution>School of Basic and Medical Biosciences, King’s College London</institution>, <addr-line content-type="city">London</addr-line>, <country>UK</country></aff>
      <aff id="aff000c"><label><sup>3</sup></label><addr-line content-type="department">Department of Neurodegenerative Disease</addr-line>, <addr-line>Queen Square Institute of Neurology</addr-line>, <institution>UCL</institution>, <addr-line content-type="city">London</addr-line>, <country>UK</country></aff>
      <aff id="aff000d"><label><sup>4</sup></label><addr-line>NIHR Great Ormond Street Hospital Biomedical Research Centre</addr-line>, <institution>University College London</institution>, <addr-line content-type="city">London</addr-line>, <country>UK</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label><sup>*</sup></label> Corresponding author. E-mail: <email xlink:href="ucbtas8@ucl.ac.uk">ucbtas8@ucl.ac.uk</email>
</corresp>
      <fn id="fn0001">
        <label>
          <sup>†</sup>
        </label>
        <p>Contributed equally.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>2023</volume>
    <fpage>1</fpage>
    <lpage>10</lpage>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>9</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" specific-use="url" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>We present ensemblQueryR, an R package for querying Ensembl linkage disequilibrium (LD) endpoints. This package is flexible, fast and user-friendly, and optimised for high-throughput querying. ensemblQueryR uses functions that are intuitive and amenable to custom code integration, familiar R object types as inputs and outputs as well as providing parallelisation functionality. For each Ensembl LD endpoint, ensemblQueryR provides two functions, permitting both single- and multi-query modes of operation. The multi-query functions are optimised for large query sizes and provide optional parallelisation to leverage available computational resources and minimise processing time. We demonstrate improved computational performance of ensemblQueryR over an exisiting tool in terms of random access memory (RAM) usage and speed, delivering a 10-fold speed increase whilst using a third of the RAM. Finally, ensemblQueryR is near-agnostic to operating system and computational architecture through Docker and singularity images, making this tool widely accessible to the scientific community.</p>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution>Biotechnology and Biological Sciences Research Council</institution>
          </institution-wrap>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7196-1410</contrib-id>
          <name>
            <surname>Fairbrother-Browne</surname>
            <given-names>A.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution>Tenure Track Clinician Scientist Fellowship</institution>
          </institution-wrap>
        </funding-source>
        <award-id>MR/N008324/1</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4913-5312</contrib-id>
          <name>
            <surname>García-Ruiz</surname>
            <given-names>S.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution>Tenure Track Clinician Scientist Fellowship</institution>
          </institution-wrap>
        </funding-source>
        <award-id>MR/N008324/1</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9520-6957</contrib-id>
          <name>
            <surname>Ryten</surname>
            <given-names>M.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution>BBSRC</institution>
          </institution-wrap>
        </funding-source>
        <award-id>BB/R006075/1</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-1636-491X</contrib-id>
          <name>
            <surname>Hodgkinson</surname>
            <given-names>A.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>AFB was supported through the award of a Biotechnology and Biological Sciences Research Council (BBSRC UK) London Interdisciplinary Doctoral Fellowship. SGR and MR were supported through the award of a Tenure Track Clinician Scientist Fellowship to MR (MR/N008324/1). AH was funded by a BBSRC award (BB/R006075/1).</funding-statement>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec id="s0001">
    <title>Statement of need</title>
    <sec id="s0002">
      <title>Background</title>
      <p>Linkage disequilibrium (LD) is the non-random association of alleles arising from different loci <styled-content style-type="bibr-wrapper">[<xref rid="ref1" ref-type="bibr">1</xref>]</styled-content>. In population genetics, LD is a measure of the frequency with which an allele of one variant is correlated with an allele of a proximal variant within a particular population <styled-content style-type="bibr-wrapper">[<xref rid="ref2" ref-type="bibr">2</xref>]</styled-content>. There are many applications for LD measures in genomics workflows. For example, in the context of genome-wide association studies (GWAS), which have been used to detect associations between genetic variants and a wide range of human phenotypes, downstream interrogation of local LD structure is required to identify the potential ‘causal’ variant at a nominated locus that exerts an effect on the downstream phenotype. Equally, in expression quantitative trait loci (eQTL) analyses, which aim to uncover associations between genetic variants and the expression of a <italic toggle="yes">cis</italic> or <italic toggle="yes">trans</italic> gene (eGene), LD information is required for the identification of the potential causal variant affecting the expression of the eGene. Further downstream, LD information is useful for functional annotations, where genetic variants or regions in LD with a target variant can aid in the identification of biological processes that might be affected by the GWAS- or eQTL-implicated target variant. As such, it is important that the LD information for a range of human populations can be easily queried by researchers in an efficient and accessible way.</p>
      <p>Despite the widespread usage of LD measures in genomic research, the majority of tools available at present are web-based. Although these offer user-friendly interfaces and can be useful for one-off or small queries, they do not promote reproducibility and are not suited to workflow-oriented researchers wishing to submit multiple large queries. Programmatic tools offer a solution to these problems; however, very few tools for the retrieval of LD metrics exist.</p>
      <p>To our knowledge, only one R package provides a programmatic interface for LD metric retrieval. LDlinkR (version 1.2.3) <styled-content style-type="bibr-wrapper">[<xref rid="ref3" ref-type="bibr">3</xref>]</styled-content> provides an R-based interface to the web-based tool LDlink <styled-content style-type="bibr-wrapper">[<xref rid="ref4" ref-type="bibr">4</xref>]</styled-content>, permitting retrieval of LD metrics using a range of query types. However, LDlinkR has a number of key limitations with respect to speed and query handling. Firstly, the user is required to obtain an access token by signing up on the NCBI website, which is then supplied as an argument to all LDlinkR functions. This requirement is in place to limit user queries, meaning that attempts to speed up the tool using parallelisation easily exceed query limits and cause the tool to return timeout errors. This can result in the user’s access token being blocked. Secondly, a number of functions for retrieving LD metrics are configured for singular queries only – such as the LDpair and LDproxy functions – meaning that the user must write custom code to submit more than one query at one time. As such, although LDlinkR is a useful programmatic alternative to the LDlink web tool, it is not suited to fast, high-throughput multi-query retrieval of LD metrics.</p>
      <p>Ensembl (RRID:<named-content content-type="rrid">SCR_002344</named-content>) is another widely used source of LD metrics, offering an application programming interface (API) that supports an array of query configurations<styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>, <xref rid="ref6" ref-type="bibr">6</xref>]</styled-content>. However, some challenges are presented by direct API usage as its usage requires some technical expertise. Additionally, it is not easily integrable with typical R workflows, precludes the input of standard R objects (such as data frames, lists or vectors), does not output data in an intuitive format and is not easily adaptable to high-throughput workflows. To our knowledge, no R package has been developed to facilitate querying the Ensembl API and, in particular, to retrieve Ensembl LD metrics. In light of this, and to address the limitations of current tools, we present ensemblQueryR. Our R package provides fast, efficient, user-friendly querying of Ensembl LD data, with a focus on intuitive, high-throughput R workflow integration.</p>
      <p>ensemblQueryR has been made freely available (DOI: <ext-link xlink:href="https://doi.org/10.5281/zenodo.7837882" ext-link-type="uri" specific-use="url">10.5281/zenodo.7837882</ext-link>) <styled-content style-type="bibr-wrapper">[<xref rid="ref7" ref-type="bibr">7</xref>, <xref rid="ref8" ref-type="bibr">8</xref>]</styled-content>. The package can also be used in Docker (RRID:<named-content content-type="rrid">SCR_016445</named-content>) <styled-content style-type="bibr-wrapper">[<xref rid="ref9" ref-type="bibr">9</xref>]</styled-content> or Singularity <styled-content style-type="bibr-wrapper">[<xref rid="ref10" ref-type="bibr">10</xref>]</styled-content> containers, for which the images can be found on Docker Hub <styled-content style-type="bibr-wrapper">[<xref rid="ref11" ref-type="bibr">11</xref>]</styled-content> or the Singularity image repository <styled-content style-type="bibr-wrapper">[<xref rid="ref12" ref-type="bibr">12</xref>]</styled-content>.</p>
    </sec>
    <sec id="s0003">
      <title>Implementation</title>
      <sec id="s0004">
        <title>Our approach</title>
        <p>ensemblQueryR provides a suite of functions that wrap around three Ensembl API ‘endpoints’. These endpoints operate to retrieve data from Ensembl databases through the following query configurations:<list list-type="simple"><list-item><label>1.</label><p>Window: retrieval of the LD metrics for a variant and all the other variants in a window around the target variant;</p></list-item><list-item><label>2.</label><p>Pair: retrieval of the LD metrics between a pair of target variants;</p></list-item><list-item><label>3.</label><p>Region: retrieval of the LD metrics between all pairs of variants in a defined target region.</p></list-item></list></p>
        <p>Single-query and multi-query wrapper functions are provided for each of these Ensembl API endpoints, all of which are described in detail in Table <xref rid="gigabyte-2023-91-t001" ref-type="table">1</xref>.</p>
        <table-wrap position="float" id="gigabyte-2023-91-t001">
          <label>Table 1</label>
          <caption>
            <p>The functions comprising the ensemblQueryR package and their relationship to the three LD Ensembl API endpoints.</p>
          </caption>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col span="1" align="left" width="20%"/>
              <col span="1" align="left" width="11%"/>
              <col span="1" align="left" width="10%"/>
              <col span="1" align="left" width="33%"/>
              <col span="1" align="left" width="26%"/>
            </colgroup>
            <thead valign="top">
              <tr>
                <th align="left" rowspan="1" colspan="1">ensemblQueryR function</th>
                <th align="left" rowspan="1" colspan="1">Ensembl API endpoint</th>
                <th align="left" rowspan="1" colspan="1">Arguments</th>
                <th align="left" rowspan="1" colspan="1">Output</th>
                <th align="left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">ensemblQueryGetPops</td>
                <td align="left" rowspan="1" colspan="1">Information <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>
</td>
                <td align="left" rowspan="1" colspan="1">N/A</td>
                <td align="left" rowspan="1" colspan="1">A list of human populations for which LD metrics can be retrieved. <styled-content style-type="bibr-wrapper"/>
</td>
                <td align="left" rowspan="1" colspan="1">This function retrieves a list of the Ensembl populations for which LD metrics can be queried (for further information on the available populations, see Ensembl [<xref rid="ref13" ref-type="bibr">13</xref>]). These can be supplied to the ‘pop’ argument across ensemblQueryR functions.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">pingEnsembl</td>
                <td align="left" rowspan="1" colspan="1">Information <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>
</td>
                <td align="left" rowspan="1" colspan="1">N/A</td>
                <td align="left" rowspan="1" colspan="1">An integer (and a message) to indicate the status of the Ensembl API. Returns 1 and reports “Server OK.” if the server is up.</td>
                <td align="left" rowspan="1" colspan="1">This function checks and informs the user of the status of the Ensembl API.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ensemblQueryLDwithSNPwindow</td>
                <td align="left" rowspan="1" colspan="1">Window <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>
</td>
                <td align="left" rowspan="1" colspan="1">rsid<break/>r2<break/>d.prime<break/>window.size<break/>pop</td>
                <td align="left" rowspan="1" colspan="1">A data frame with five columns: ‘query’ (the variant input to ‘rsid’), snp_in_ld (variant(s) in LD with ‘query’), r2 (r-squared statistic), d_prime (D′ statistic), population_name (the population supplied to ‘pop’).</td>
                <td align="left" rowspan="1" colspan="1">This function retrieves variants in LD with the query variant within a given genomic window.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ensemblQueryLDwithSNPwindowDataframe</td>
                <td align="left" rowspan="1" colspan="1">Window <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>
</td>
                <td align="left" rowspan="1" colspan="1">in.table<break/>r2<break/>d.prime<break/>window.size<break/>pop<break/>cores</td>
                <td align="left" rowspan="1" colspan="1">A data frame with five columns: ‘query’ (the variant input to ‘rsid’), snp_in_ld (variant(s) in LD with ‘query’), r2 (r-squared statistic), d_prime (D′ statistic), population_name (the population supplied to ‘pop’).</td>
                <td align="left" rowspan="1" colspan="1">This function takes a data frame with a column of variant rsIDs (Reference SNP cluster IDs). It retrieves variants in LD with each query variant within a given genomic window.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ensemblQueryLDwithSNPpair</td>
                <td align="left" rowspan="1" colspan="1">Pair <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>
</td>
                <td align="left" rowspan="1" colspan="1">rsid1<break/>rsid2<break/>pop</td>
                <td align="left" rowspan="1" colspan="1">A data frame with five columns: ‘query1’ (the variant input to ‘rsid1’), ‘query2’ (the variant input to ‘rsid2’), r2 (r-squared statistic), d_prime (D′ statistic), population_name (the population supplied to ‘pop’).</td>
                <td align="left" rowspan="1" colspan="1">This function takes a pair of rsIDs and retrieves their LD metrics (D′ and R<sup>2</sup>).</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ensemblQueryLDwithSNPpairDataframe</td>
                <td align="left" rowspan="1" colspan="1">Pair <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>
</td>
                <td align="left" rowspan="1" colspan="1">in.table<break/>pop<break/>cores</td>
                <td align="left" rowspan="1" colspan="1">A data frame with five columns: ‘query1’ (the variant input to ‘rsid1’), ‘query2’ (the variant input to ‘rsid2’), r2 (r-squared statistic), d_prime (D′ statistic), population_name (the population supplied to ‘pop’).</td>
                <td align="left" rowspan="1" colspan="1">This function takes a data.frame containing paired rsIDs, retrieving LD metrics (D′ and R<sup>2</sup>) for all pairs.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ensemblQueryLDwithSNPregion</td>
                <td align="left" rowspan="1" colspan="1">Region <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>
</td>
                <td align="left" rowspan="1" colspan="1">chr<break/>start<break/>end<break/>pop</td>
                <td align="left" rowspan="1" colspan="1">A data frame with eight columns: ‘query_chr’ (the query chromosome supplied to ‘chr’), ‘query_start’ (the query start coordinate supplied to ‘start’), ‘query_end’ (the query end coordinate supplied to ‘end’), ‘rsid1’ (variant one of two in the pair), ‘rsid2’ (variant two of two in the pair), r2 (r-squared statistic), d_prime (D′ statistic), population_name (the population supplied to ‘pop’).</td>
                <td align="left" rowspan="1" colspan="1">This function takes a genomic coordinate, retrieving LD metrics (D′ and R<sup>2</sup>) for all rsID within the defined region.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ensemblQueryLDwithSNPregionDataframe</td>
                <td align="left" rowspan="1" colspan="1">Region <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>
</td>
                <td align="left" rowspan="1" colspan="1">in.table<break/>pop<break/>cores</td>
                <td align="left" rowspan="1" colspan="1">A data frame with eight columns: ‘query_chr’ (the query chromosome supplied to ‘chr’), ‘query_start’ (the query start coordinate supplied to ‘start’), ‘query_end’ (the query end coordinate supplied to ‘end’), ‘rsid1’ (variant one of two in the pair), ‘rsid2’ (variant two of two in the pair), r2 (r-squared statistic), d_prime (D′ statistic), population_name (the population supplied to ‘pop’).</td>
                <td align="left" rowspan="1" colspan="1">This function takes a data frame containing genomic coordinate(s) and retrieves LD metrics (D′ and R<sup>2</sup>) for all rsID within the defined region(s).</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
        <p>To make ensemblQueryR useful in a high-throughput context, the main challenge is that the Ensembl API endpoints are configured to handle single queries. To address this, ensemblQueryR’s three multi-query functions (with names ending in ‘Dataframe’, as described in Table <xref rid="gigabyte-2023-91-t001" ref-type="table">1</xref>) take data frame objects as input, where each row needs to be submitted as a separate query to the Ensembl API. The base R lapply function (Version 4.0.5) <styled-content style-type="bibr-wrapper">[<xref rid="ref14" ref-type="bibr">14</xref>]</styled-content> is then used to apply the corresponding single-query function over the ﻿input data frame, iteratively formulating an API query from each data frame row.</p>
        <p>Building on ensemblQueryR’s high-throughput capabilities, we implemented optional parallelisation for all multi-query functions. Each multi-query function (those with names ending in ‘Dataframe’ in Table <xref rid="gigabyte-2023-91-t001" ref-type="table">1</xref>) has an argument that allows the user to set a number of ‘cores’ to parallelise the query across. Using this functionality can significantly reduce run-time, particularly for larger queries where the parallelisation overheads represent a small proportion of the overall memory requirements. For example, with a query size of 1,000, the ensemblQueryLDwithSNPpairDataframe function running on a single core takes ∼2.4 min, whereas ten cores speed the process up by 22 times, reducing the execution time to ∼0.11 min (System tested on: Ubuntu server 16.04 LTS with kernel version 4.4.0-210-generic, total RAM 251G).</p>
        <p>Consistency of the data output format is an important feature of ensemblQueryR, making it amenable to R workflow integration. All functions (single- and multi-query) return a data frame object, including instances where the query returns a null result or an error. This consistent output format simplifies writing custom code, allowing users to incorporate ensemblQueryR functionality into bespoke workflows. It is important to note that when data cannot be retrieved, for example, if a variant is not found in Ensembl databases or the user input is invalid, console messages alert the user of this and a data frame row containing ‘NA’ values is returned for that query.</p>
      </sec>
      <sec id="s0005">
        <title>Benchmarking</title>
        <p>LDlinkR is an alternative R package that offers LD metric retrieval. As such, it was important to benchmark against this tool to demonstrate the utility of ensemblQueryR for high-throughput querying. Of the functions contained in the LDlinkR and ensemblQueryR packages, two functions are particularly comparable in their functionality. Both LDpair (from LDlinkR) and ensemblQueryLDwithSNPpair (from ensemblQueryR) take a pair of reference SNP cluster identifiers (rsIDs) as input, while the output is a table containing the LD metrics for the query pair. As such, these functions were selected for benchmarking. To compare the performance of the two functions, the computation speed and RAM usage at three query sizes representing a range of throughputs – 100, 1,000 and 10,000 queries – were assessed (Figure <xref rid="gigabyte-2023-91-g001" ref-type="fig">1</xref>). For each function and query size combination, performance (speed and peak RAM usage) was tested ten times to account for temporal ﻿fluctuations in ﻿processing ﻿speed and peak RAM usage, thus enabling a precise performance ﻿assessment.</p>
        <fig position="float" id="gigabyte-2023-91-g001">
          <label>Figure 1.</label>
          <caption>
            <p>Comparison of performance metrics between analogous functions of the ensemblQueryR and LDlinkR R packages. (a) Plot showing, for query sizes of 100, 1,000 and 10,000, the maximum RAM usage (mebibytes, MiB) during the execution of ensemblQueryR’s ensemblQueryLDwithSNPpair (red) and LDlinkR’s LDpair (blue). (b) Plot showing, for query sizes of 100, 1,000 and 10,000, the execution time (minutes, mins) of ensemblQueryR’s ensemblQueryLDwithSNPpair (red) and LDlinkR’s LDpair (blue).</p>
          </caption>
          <graphic xlink:href="gigabyte-2023-91-g001" position="float"/>
        </fig>
        <p> Firstly, comparing execution speed, we found that, on average (across the ten tests), ensemblQueryLDwithSNPpair was 10.2 times faster in the 100-query test, taking an average of 0.208 min compared to the 2.12 min for LDpair (Figure <xref rid="gigabyte-2023-91-g001" ref-type="fig">1</xref>b). The 1,000-query test found that ensemblQueryLDwithSNPpair was, on average, 9.92 times faster than LDlinkR, taking an average of 1.97 min compared to the 19.5 min for LDpair. Finally, in the 10,000-query test, LDpair was unable to produce a final results table in seven out of ten tests, in these instances returning an error message (‘Bad Gateway (HTTP 502)’). In contrast, ensemblQueryLDwithSNPpair produced a final results table in all tests, demonstrating its reliability for high-throughput querying. Looking at the only three successful tests of LDpair, we found that ensemblQueryLDwithSNPpair was, on average, 10.9 times faster than LDpair, taking an average of 18.5 min compared to the 202 min (&gt;3 h) for LDpair. These speed improvements are likely due to request rate limits from the server side, which are higher for Ensembl, thus enabling fast concurrent or parallel requests.</p>
        <p>Secondly, we compared the peak RAM usage – the maximum RAM utilised at any time during function execution – between ensemblQueryLDwithSNPpair and LDpair (Figure <xref rid="gigabyte-2023-91-g001" ref-type="fig">1</xref>a). We found that across query sizes, ensemblQueryLDwithSNPpair had approximately a third (range: 20.8–49.6%) of the peak RAM usage of LDpair. These peak RAM usage improvements are likely due to a focus on within-function reductions of intermediate object storage and a reduction of the number of operations carried out within the ensemblQueryLDwithSNPpair function.</p>
        <p>We conclude that, by comparing analogous functions (ensemblQueryLDwithSNPpair and LDpair), ensemblQueryR provides a performance improvement over LDlinkR with respect to both speed (×10) and memory usage (1/3), underscoring the utility of our tool in the context of high-throughput workflows.</p>
      </sec>
      <sec id="s0006">
        <title>Usage</title>
        <p>The following code provides an implementation example for ensemblQueryR. In this case, the target variant was taken from the OpenTargets homepage <styled-content style-type="bibr-wrapper">[<xref rid="ref15" ref-type="bibr">15</xref>]</styled-content> with rsID <ext-link xlink:href="https://identifiers.org/ensembl:rs4129267" ext-link-type="uri">rs4129267</ext-link>. To find out which variants, within a set of genomic window sizes, are in LD (R<sup>2</sup> &gt; 0.8 and D<italic toggle="yes">′</italic> &gt; 0.8) with the target variant, the ensemblQueryLDwithSNPWindow function was implemented as in Figure <xref rid="gigabyte-2023-91-g002" ref-type="fig">2</xref>.</p>
        <fig position="float" id="gigabyte-2023-91-g002">
          <label>Figure 2.</label>
          <caption>
            <p>Working example of an ensemblQueryR implementation.</p>
          </caption>
          <graphic xlink:href="gigabyte-2023-91-g002" position="float"/>
        </fig>
      </sec>
      <sec id="s0007">
        <title>Methods</title>
        <sec id="s0008">
          <title>Docker and singularity images</title>
          <p>In order to make this tool widely accessible to the research community, we have provided a Docker image (Figure <xref rid="gigabyte-2023-91-g003" ref-type="fig">3</xref>). It is based on a Rocker (RRID:<named-content content-type="rrid">SCR_024215</named-content>) <styled-content style-type="bibr-wrapper">[<xref rid="ref16" ref-type="bibr">16</xref>]</styled-content> with R version 4.0.0 and Ubuntu version 20.04 LTS (Focal Fossa) pre-installed. To start a container using the ‘ensemblqueryr’ Docker image and launch an interactive R session within which the tool can be used, the following command can be executed on the command line: </p>
          <p>
            <monospace>docker pull ainefairbrotherbrowne/ensemblqueryr:1.0; ∖</monospace>
          </p>
          <p>
            <monospace>docker run -t -d --name ensemblqueryr ainefairbrotherbrowne/ensemblqueryr:1.0; ∖</monospace>
          </p>
          <p>
            <monospace>docker exec -i -t ensemblqueryr R</monospace>
          </p>
          <p>To mount a local volume that contains a file of variant IDs, the following command can be used:</p>
          <p>
            <monospace>docker pull ainefairbrotherbrowne/ensemblqueryr:1.0; ∖</monospace>
          </p>
          <p>
            <monospace>docker run -t -d --name ensemblqueryr ainefairbrotherbrowne/ensemblqueryr:1.0 -- path/to/volume; ∖</monospace>
          </p>
          <p>
            <monospace>docker exec -i -t ensemblqueryr R</monospace>
          </p>
          <fig position="float" id="gigabyte-2023-91-g003">
            <label>Figure 3.</label>
            <caption>
              <p>Dockerfile containing the setup for the ensemblQueryR Docker image.</p>
            </caption>
            <graphic xlink:href="gigabyte-2023-91-g003" position="float"/>
          </fig>
          <p> Additionally, for use-cases wherein the user does not have sufficient permissions to use Docker, such as on HPC clusters, a singularity image can be used instead. To generate a singularity image, we converted the ensemblQueryR docker image <styled-content style-type="bibr-wrapper">[<xref rid="ref11" ref-type="bibr">11</xref>]</styled-content> into a singularity image using the Docker-based tool docker2singularity (Version 2.6) <styled-content style-type="bibr-wrapper">[<xref rid="ref17" ref-type="bibr">17</xref>]</styled-content>. This image can be found on the sylabs.io singularity repository <styled-content style-type="bibr-wrapper">[<xref rid="ref12" ref-type="bibr">12</xref>]</styled-content>. The singularity image can be pulled and executed, launching a command line R session as follows:</p>
          <p>
            <monospace>singularity pull --arch amd64 library://ainefairbrother/ensemblqueryr/ensemblqueryr:sha256.e387ea11ae4eaea8f94d81c625c2c1d5a22dd351858ebcd03910a7736d76ca30; ∖</monospace>
          </p>
          <p>
            <monospace>singularity exec ensemblqueryr_sha256.e387ea11ae4eaea8f94d81c625c2c1d5a22dd351858ebcd03910a7736d76ca30.sif R</monospace>
          </p>
        </sec>
        <sec id="s0009">
          <title>Benchmarking</title>
          <p>To benchmark our package against LDlinkR, we first selected functions that performed similar tasks. The most comparable functions in this context were LDlinkR’s ‘LDpair’ and ensemblQueryR’s ‘ensemblQueryLDwithSNPpair’. Both are configured for single queries and take a pair of variant IDs as input, retrieving the corresponding LD metrics through an API query. To run multiple queries using these single-query functions, both functions were applied over variant identifier (ID) vectors using the base R lapply (Version 4.0.5) <styled-content style-type="bibr-wrapper">[<xref rid="ref14" ref-type="bibr">14</xref>]</styled-content>.</p>
          <p>To compare the utility of these functions for LD metric querying in the context of high-throughput workflows, we measured the peak RAM usage and execution speed using the R package peakRAM (version 1.0.2) <styled-content style-type="bibr-wrapper">[<xref rid="ref18" ref-type="bibr">18</xref>]</styled-content> 10 times for each function and at three query sizes (100, 1,000 and 10,000). The standard deviation (sd) of the performance metric for each function at each time point across the ten iterations was calculated. Mean performance metrics were plotted with error bars to show the sd from the mean for peak RAM usage (Figure <xref rid="gigabyte-2023-91-g001" ref-type="fig">1</xref>a) and time measured in minutes (Figure <xref rid="gigabyte-2023-91-g001" ref-type="fig">1</xref>b) for the three query sizes.</p>
        </sec>
      </sec>
      <sec id="s0010">
        <title>Limitations</title>
        <p>It is important to note that there are some limitations to this R package. First, although this package enables high-throughput querying of the Ensembl API, there is an inherent limit to the number of queries that can be submitted arising from the API query limit, which is set at 54,000 requests per hour <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>, <xref rid="ref6" ref-type="bibr">6</xref>]</styled-content>. On the Ubuntu system used to develop ensemblQueryR (Ubuntu server 16.04 LTS with kernel version 4.4.0-210-generic, total RAM 251 G), 54,000 API requests via ensemblQueryLDwithSNPpairDataframe took ∼1.93 h on a single core, making the per-hour request rate 27,867. As such, even query sizes of 54,000 can be run unparallelised and are unlikely to exceed the Ensembl API hourly rate. However, this request limit must be considered by users when applying parallelisation to large queries. The second limitation is that the parallelisation library used to enable the multi-core functionality is the R package ‘parallel’ (version 3.6.2) <styled-content style-type="bibr-wrapper">[<xref rid="ref19" ref-type="bibr">19</xref>]</styled-content>, which works on OSIX systems (Mac, Linux and other Unix-based operating systems) but does not work on Windows.</p>
      </sec>
      <sec id="s0011">
        <title>Scope for future development</title>
        <p>At present, this package provides wrappers for the Ensembl API endpoints that retrieve LD data. However, the Ensembl API offers ∼109 other endpoints <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>, all of which have the potential to be wrapped into R functions and included in this package. As such, there is scope for the usefulness of this package beyond LD metrics and further development will expand its utility to R users across an array of bioscience disciplines.</p>
      </sec>
    </sec>
  </sec>
  <sec id="s0012">
    <title>Availability of source code and requirements</title>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>Project name: ensemblQueryR</p>
        </list-item>
        <list-item>
          <p>Project home page: <ext-link xlink:href="https://github.com/ainefairbrother/ensemblQueryR" ext-link-type="uri" specific-use="url">https://github.com/ainefairbrother/ensemblQueryR</ext-link></p>
        </list-item>
        <list-item>
          <p>Operating system(s): Platform independent</p>
        </list-item>
        <list-item>
          <p>Programming language: R</p>
        </list-item>
        <list-item>
          <p>Licence: MIT</p>
        </list-item>
        <list-item>
          <p>RRID: <named-content content-type="rrid">SCR_024216</named-content>.</p>
        </list-item>
      </list>
    </p>
  </sec>
</body>
<back>
  <sec sec-type="data-availability" id="s0013">
    <title>Data Availability</title>
    <p>Snapshots of the code are available in GigaDB <styled-content style-type="bibr-wrapper">[<xref rid="ref20" ref-type="bibr">20</xref>]</styled-content>. </p>
  </sec>
  <sec id="s0014">
    <title>Abbreviations</title>
    <p>API, Application Programming Interface; eGene, expression of a cis or trans gene; eQTL: Expression Quantitative Trait Loci; GWAS: Genome-Wide Association Study; ID, identifier; LD: Linkage Disequilibrium; RAM: Random Access Memory; REST: Representational State Transfer; rsID: Reference SNP cluster IDs; sd: standard deviation. </p>
  </sec>
  <sec id="s0015">
    <title>Declarations</title>
    <sec id="s0016">
      <title>Ethical approval</title>
      <p>The authors declare that ethical approval was not required for this type of research.</p>
    </sec>
    <sec sec-type="COI-statement" id="s0017">
      <title>Competing Interests</title>
      <p>RHR is currently employed by CoSyne Therapeutics (Lead Bioinformatician). All work performed for this publication was performed in her own time, and not as a part of her duties as an employee.</p>
    </sec>
    <sec id="s0018">
      <title>Author contributions</title>
      <p>AFB and RHR: conceptualisation. AFB: software. AFB and SGR: docker image. AFB: benchmarking. AFB: writing - original draft. AFB, SGR, AH, MR and RHR: writing - review and editing. MR and AH: supervision.</p>
    </sec>
    <sec id="s0019">
      <title>Funding</title>
      <p>AFB was supported through the award of a Biotechnology and Biological Sciences Research Council (BBSRC UK) London Interdisciplinary Doctoral Fellowship. SGR and MR were supported through the award of a Tenure Track Clinician Scientist Fellowship to MR (MR/N008324/1). AH was funded by a BBSRC award (BB/R006075/1).</p>
    </sec>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="ref1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Slatkin</surname><given-names>M</given-names></name>. </person-group><article-title>Linkage disequilibrium — understanding the evolutionary past and mapping the medical future</article-title>. <source>Nat. Rev. Genet.</source>, <year>2008</year>; <volume>9</volume>: <fpage>477</fpage>–<lpage>485</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nrg2361</pub-id>.<pub-id pub-id-type="pmid">18427557</pub-id></mixed-citation>
    </ref>
    <ref id="ref2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bush</surname><given-names>WS</given-names></name>, <name><surname>Moore</surname><given-names>JH</given-names></name>. </person-group><article-title>Chapter 11: Genome-wide association studies</article-title>. <source>PLoS Comput. Biol.</source>, <year>2012</year>; <volume>8</volume>(<issue>12</issue>): <elocation-id content-type="artnum">e1002822</elocation-id>. doi:<pub-id pub-id-type="doi">10.1371/journal.pcbi.1002822</pub-id>.<pub-id pub-id-type="pmid">23300413</pub-id></mixed-citation>
    </ref>
    <ref id="ref3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Myers</surname><given-names>TA</given-names></name>, <name><surname>Chanock</surname><given-names>SJ</given-names></name>, <name><surname>Machiela</surname><given-names>MJ</given-names></name>. </person-group><article-title>LDlinkR: An R package for rapidly calculating linkage disequilibrium statistics in diverse populations</article-title>. <source>Front. Genet.</source>, <year>2020</year>; <volume>11</volume>: <elocation-id content-type="artnum">157</elocation-id>.<pub-id pub-id-type="pmid">32180801</pub-id></mixed-citation>
    </ref>
    <ref id="ref4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Machiela</surname><given-names>MJ</given-names></name>, <name><surname>Chanock</surname><given-names>SJ</given-names></name>. </person-group><article-title>LDlink: a web-based application for exploring population-specific haplotype structure and linking correlated alleles of possible functional variants</article-title>. <source>Bioinformatics</source>, <year>2015</year>; <volume>31</volume>(<issue>21</issue>): <fpage>3555</fpage>–<lpage>3557</lpage>. doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btv402</pub-id>.<pub-id pub-id-type="pmid">26139635</pub-id></mixed-citation>
    </ref>
    <ref id="ref5">
      <label>5</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><collab collab-type="corporate-author">Ensembl Rest API - Ensembl REST API Endpoints</collab></person-group>. <year>2015</year>; <ext-link xlink:href="https://rest.ensembl.org/" ext-link-type="uri" specific-use="url">https://rest.ensembl.org/</ext-link>. Accessed 5 Nov 2022.</mixed-citation>
    </ref>
    <ref id="ref6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yates</surname><given-names>A</given-names></name>, <name><surname>Beal</surname><given-names>K</given-names></name>, <name><surname>Keenan</surname><given-names>S</given-names></name><etal/></person-group><article-title>The ensembl REST API: Ensembl data for any language</article-title>. <source>Bioinformatics</source>, <year>2015</year>; <volume>31</volume>(<issue>1</issue>): <fpage>143</fpage>–<lpage>145</lpage>. doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btu613</pub-id>.<pub-id pub-id-type="pmid">25236461</pub-id></mixed-citation>
    </ref>
    <ref id="ref7">
      <label>7</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><name><surname>Fairbrother-Browne</surname><given-names>A</given-names></name>. </person-group>ensemblQueryR (Version 2.0.0). Zenodo, <year>23 May 2023</year>; <pub-id pub-id-type="doi">10.5281/zenodo.7837882</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref8">
      <label>8</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><name><surname>Fairbrother-Browne</surname><given-names>A</given-names></name>. </person-group>ensemblQueryR (Version 2.0.0). GitHub, <year>23 May 2023</year>; <ext-link xlink:href="https://github.com/ainefairbrother/ensemblQueryR" ext-link-type="uri" specific-use="url">https://github.com/ainefairbrother/ensemblQueryR</ext-link>.</mixed-citation>
    </ref>
    <ref id="ref9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Merkel</surname><given-names>D</given-names></name>. </person-group><article-title>Docker: lightweight Linux containers for consistent development and deployment</article-title>. <source>Linux J.</source>, <year>2014</year>; <volume>2014</volume>(<issue>239</issue>): <elocation-id content-type="artnum">2</elocation-id>.</mixed-citation>
    </ref>
    <ref id="ref10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kurtzer</surname><given-names>GM</given-names></name>, <name><surname>Sochat</surname><given-names>V</given-names></name>, <name><surname>Bauer</surname><given-names>MW</given-names></name>. </person-group><article-title>Singularity: Scientific containers for mobility of compute</article-title>. <source>PLOS One</source>, <year>2017</year>; <volume>12</volume>(<issue>5</issue>): <elocation-id content-type="artnum">e0177459</elocation-id>. doi:<pub-id pub-id-type="doi">10.1371/journal.pone.0177459</pub-id>.<pub-id pub-id-type="pmid">28494014</pub-id></mixed-citation>
    </ref>
    <ref id="ref11">
      <label>11</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><name><surname>Fairbrother-Browne</surname><given-names>A</given-names></name>. </person-group>ensemblqueryr (Version 1.0). Docker Hub, <year>22 May 2023</year>; <ext-link xlink:href="https://hub.docker.com/r/ainefairbrotherbrowne/ensemblqueryr" ext-link-type="uri" specific-use="url">https://hub.docker.com/r/ainefairbrotherbrowne/ensemblqueryr</ext-link>.</mixed-citation>
    </ref>
    <ref id="ref12">
      <label>12</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><name><surname>Fairbrother-Browne</surname><given-names>A</given-names></name>. </person-group>ensemblqueryr (Version 1.0). sylabs.io, <year>22 May 2023</year>; <ext-link xlink:href="https://cloud.sylabs.io/library/ainefairbrother/ensemblqueryr/ensemblqueryr" ext-link-type="uri" specific-use="url">https://cloud.sylabs.io/library/ainefairbrother/ensemblqueryr/ensemblqueryr</ext-link>.</mixed-citation>
    </ref>
    <ref id="ref13">
      <label>13</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><collab collab-type="corporate-author">Ensembl Population Frequencies &amp; Genotypes</collab></person-group>. <ext-link xlink:href="https://www.ensembl.org/info/genome/variation/species/populations.html" ext-link-type="uri" specific-use="url">https://www.ensembl.org/info/genome/variation/species/populations.html</ext-link>. Accessed 23 May 2023.</mixed-citation>
    </ref>
    <ref id="ref14">
      <label>14</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><collab collab-type="corporate-author">R Core</collab></person-group>. <article-title>R: A language and environment for statistical computing</article-title>, <year>2021</year>; Available at: <ext-link xlink:href="https://cran.r-project.org/doc/manuals/r-release/fullrefman.pdf" ext-link-type="uri" specific-use="url">https://cran.r-project.org/doc/manuals/r-release/fullrefman.pdf</ext-link>.</mixed-citation>
    </ref>
    <ref id="ref15">
      <label>15</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><collab collab-type="corporate-author">Open Targets Genetics</collab></person-group>. <ext-link xlink:href="https://genetics.opentargets.org/" ext-link-type="uri" specific-use="url">https://genetics.opentargets.org/</ext-link>. Accessed 23 May 2023.</mixed-citation>
    </ref>
    <ref id="ref16">
      <label>16</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boettiger</surname><given-names>C</given-names></name>, <name><surname>Eddelbuettel</surname><given-names>D</given-names></name>. </person-group><article-title>An introduction to Rocker: Docker containers for R</article-title>. <source>R J.</source>, <year>2017</year>; <volume>9</volume>(<issue>2</issue>): <fpage>527</fpage>–<lpage>536</lpage>. doi:<pub-id pub-id-type="doi">10.32614/RJ-2017-065</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref17">
      <label>17</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><collab collab-type="corporate-author">Singularity Hub</collab></person-group>. Docker2singularity (Version 2.6), <year>2018</year>; <ext-link xlink:href="https://github.com/singularityhub/docker2singularity/releases/tag/v2.6-release" ext-link-type="uri" specific-use="url">https://github.com/singularityhub/docker2singularity/releases/tag/v2.6-release</ext-link>.</mixed-citation>
    </ref>
    <ref id="ref18">
      <label>18</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><name><surname>Quinn</surname><given-names>T</given-names></name>. </person-group>peakRAM (Version 1.0.2), <year>2017</year>; <ext-link xlink:href="https://cran.r-project.org/web/packages/peakRAM/vignettes/peakRAM.html" ext-link-type="uri" specific-use="url">https://cran.r-project.org/web/packages/peakRAM/vignettes/peakRAM.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="ref19">
      <label>19</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><collab collab-type="corporate-author">R-core</collab>. Parallel (Version 3.6.2), </person-group><year>2023</year>; <ext-link xlink:href="https://www.rdocumentation.org/packages/parallel/versions/3.6.2" ext-link-type="uri" specific-use="url">https://www.rdocumentation.org/packages/parallel/versions/3.6.2</ext-link>.</mixed-citation>
    </ref>
    <ref id="ref20">
      <label>20</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fairbrother-Browne</surname><given-names>A</given-names></name>, <name><surname>García-Ruiz</surname><given-names>S</given-names></name>, <name><surname>Reynolds</surname><given-names>RH</given-names></name><etal/></person-group><article-title>Supporting data for “ensemblQueryR: fast, flexible and high-throughput querying of Ensembl API LD endpoints in R”</article-title>. <source>GigaScience Database</source>, <year>2023</year>; <pub-id pub-id-type="doi">10.5524/102435</pub-id>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="author-comment" id="d1e1808">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Article Submission</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Fairbrother-Browne</surname>
            <given-names>Aine</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Author</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>23</day>
          <month>5</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>23</day>
          <month>5</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e1814">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Assign Handling Editor</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Edmunds</surname>
            <given-names>Scott</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Editor in Chief</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>25</day>
          <month>5</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>25</day>
          <month>5</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e1820">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Editor Assess MS</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Zhang</surname>
            <given-names>Hongfang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Handling Editor</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>25</day>
          <month>5</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>26</day>
          <month>5</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e1826">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Curator Assess MS</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Armit</surname>
            <given-names>Chris</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Curator</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>26</day>
          <month>5</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>26</day>
          <month>5</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="reviewer-report" id="d1e1832">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Review MS</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Khan</surname>
            <given-names>Aziz</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Reviewer 1</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>30</day>
          <month>6</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>09</day>
          <month>8</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
  <body>
    <p>
      <array>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">Reviewer name and names of any other individual's who aided in reviewer</td>
            <td rowspan="1" colspan="1">Aziz Khan</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Do you understand and agree to our policy of having open and named reviews, and having your review included with the published manuscript. (If no, please inform the editor that you cannot review this manuscript.)</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the language of sufficient quality?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Please add additional comments on language quality to clarify if needed</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there a clear statement of need explaining what problems the software is designed to solve and who the target audience is? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the source code available, and has an appropriate Open Source Initiative license &lt;a href="https://opensource.org/licenses" target="_blank"&gt;(https://opensource.org/licenses)&lt;/a&gt; been assigned to the code?</td>
            <td rowspan="1" colspan="1">No</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1">There are two license files (the LICENSE, LICENSE.md) and both are conflicting. The authors should use one to make sure it is an appropriate Open Source Initiative license.</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">As Open Source Software are there guidelines on how to contribute, report issues or seek support on the code?</td>
            <td rowspan="1" colspan="1">No</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1">There are no guidelines on how to contribute.</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the code executable?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is installation/deployment sufficiently outlined in the paper and documentation, and does it proceed as outlined?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1">Installation was straightforward.</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the documentation provided clear and user friendly?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there enough clear information in the documentation to install, run and test this tool, including information on where to seek help if required?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there a clearly-stated list of dependencies, and is the core functionality of the software documented to a satisfactory level?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1">The DESCRIPTION file has all the required packages. </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Have any claims of performance been sufficiently tested and compared to other commonly-used packages? </td>
            <td rowspan="1" colspan="1">No</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Are there (ideally real world) examples demonstrating use of the software? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1">There are some use cases in the minimal documentation. Some of these are not working. </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is automated testing used or are there manual steps described so that the functionality of the software can be verified?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1">The package is already in the CRAN, which means it passed its checks. It does have example snippets of code to be run. </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Any Additional Overall Comments to the Author</td>
            <td rowspan="1" colspan="1">The ensemblQueryR package offers an R interface for querying Ensembl REST API linkage disequilibrium (LD) endpoints. The package aims to support high-throughput querying, utilizing familiar R object types and parallelization. The package is already in CRAN and comes with Docker/Singularity options. While the paper highlights notable strengths, such as the R interface, high-throughput support, parallelization, and performance improvements, a few points warrant further consideration and clarification.&#13; &#13; (1). The package is already in CRAN, which is good, but there are issues with the use-case examples. When I executed the test case to query LD metrics for a variant within a window, the package returned a tibble containing NAs.&#13; (2). The title claims the package supports querying "several" Ensembl API endpoints, but the current version is limited to LD endpoints. Revising the title to reflect the package's current capabilities accurately is recommended.&#13; (3). Two conflicting license files exist (the LICENSE, LICENSE.md). The authors should select one to ensure it aligns with an appropriate Open Source Initiative license. Additionally, there are no guidelines provided for contributing to the project.&#13; (4). I have encountered this R package to get Ensembl data in R using the REST API - https://github.com/dwinter/rensembl. Can the authors comment on this? </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Recommendation</td>
            <td rowspan="1" colspan="1">Minor Revisions</td>
          </tr>
        </tbody>
      </array>
    </p>
  </body>
</sub-article>
<sub-article article-type="reviewer-report" id="d1e1838">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Review MS</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Yates</surname>
            <given-names>Andrew</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Reviewer 2</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>30</day>
          <month>6</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>30</day>
          <month>6</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
  <body>
    <p>
      <array>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">Reviewer name and names of any other individual's who aided in reviewer</td>
            <td rowspan="1" colspan="1">Andy Yates</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Do you understand and agree to our policy of having open and named reviews, and having your review included with the published manuscript. (If no, please inform the editor that you cannot review this manuscript.)</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the language of sufficient quality?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Please add additional comments on language quality to clarify if needed</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there a clear statement of need explaining what problems the software is designed to solve and who the target audience is? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the source code available, and has an appropriate Open Source Initiative license &lt;a href="https://opensource.org/licenses" target="_blank"&gt;(https://opensource.org/licenses)&lt;/a&gt; been assigned to the code?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">As Open Source Software are there guidelines on how to contribute, report issues or seek support on the code?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1">Whilst nothing explicit is there the code is hosted on GitHub &amp; therefore using the issue tracker would appear to be the right way to do this</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the code executable?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is installation/deployment sufficiently outlined in the paper and documentation, and does it proceed as outlined?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the documentation provided clear and user friendly?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there enough clear information in the documentation to install, run and test this tool, including information on where to seek help if required?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there a clearly-stated list of dependencies, and is the core functionality of the software documented to a satisfactory level?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Have any claims of performance been sufficiently tested and compared to other commonly-used packages? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is test data available, either included with the submission or openly available via cited third party sources (e.g. accession numbers, data DOIs)?</td>
            <td rowspan="1" colspan="1">No</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1">The code uses data from Ensembl so this is somewhat sufficient and uses rsIDs</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Are there (ideally real world) examples demonstrating use of the software? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is automated testing used or are there manual steps described so that the functionality of the software can be verified?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Any Additional Overall Comments to the Author</td>
            <td rowspan="1" colspan="1">The authors present in their manuscript “ensemblQueryR: fast, flexible and high-throughput querying of Ensembl API endpoints in R”; a library for the popular R programming language and specifically addresses fast retrieval of linkage disequilibrium from Ensembl’s REST APIs. The toolkit provides a convenient set of functions which mediates queries into the Ensembl REST API and presents results in a manner which is optimised and familiar for R users.&#13; &#13; Overall I find the manuscript good and provides a useful toolkit for R developers. It is pleasing to see more people use the Ensembl REST APIs and to expand its user base. The analysis benchmarks also appear appropriate. I have only two minor comments.&#13; &#13; 1. Code examples&#13; &#13; Whilst I was able to execute the given example I did encounter some issues. Namely that when executing the code&#13; &#13; ensemblQueryR::ensemblQueryLDwithSNPwindow(rsid="rs4129267", r2=0.8, d.prime=0.8, window.size=500, pop="1000GENOMES:phase_3:EUR")&#13; &#13; I got the following result&#13; &#13; query snp_in_ld r2 d_prime population_name&#13; &lt;chr&gt; &lt;lgl&gt; &lt;lgl&gt; &lt;lgl&gt; &lt;lgl&gt;&#13; 1 rs4129267 NA NA NA NA&#13; &#13; It was disconcerting to not get any results back and now I am unsure if I did the right thing. I then found the GitHub repository was a far better reference for the correct commands to run and would encourage perhaps less information in the manuscript and the authors pointing readers to the GitHub repository or the site https://ainefairbrother.github.io/ensemblQueryR/.&#13; &#13; 2. Extensions&#13; &#13; The authors suggest possible extensions to ensemblQueryR but it would be useful to know if there are any specific developments planned by the authors. </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Recommendation</td>
            <td rowspan="1" colspan="1">Minor Revisions</td>
          </tr>
        </tbody>
      </array>
    </p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="d1e1845">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Editor Decision</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Zhang</surname>
            <given-names>Hongfang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Handling Editor</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>09</day>
          <month>8</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>09</day>
          <month>8</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="author-comment" id="d1e1549">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Minor Revision</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Fairbrother-Browne</surname>
            <given-names>Aine</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Author</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>11</day>
          <month>8</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>11</day>
          <month>8</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e1555">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Assess Revision</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Zhang</surname>
            <given-names>Hongfang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Handling Editor</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>11</day>
          <month>8</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>13</day>
          <month>8</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e1561">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Final Data Preparation</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Armit</surname>
            <given-names>Chris</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Curator</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>15</day>
          <month>8</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>15</day>
          <month>8</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e1567">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Editor Decision</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Zhang</surname>
            <given-names>Hongfang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Handling Editor</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>15</day>
          <month>8</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>11</day>
          <month>9</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e1573">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Accept</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Edmunds</surname>
            <given-names>Scott</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Editor in Chief</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>11</day>
          <month>9</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>11</day>
          <month>9</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
  <body>
    <p>
      <array>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">Editor’s Assessment</td>
            <td rowspan="1" colspan="1">ENSEMBL is a crucial resource for the vertebrate genomics community. And ensemblQueryR is an R interface to the Ensembl API that facilitates flexible, fast, user-friendly and R workflow integrable querying of the database linkage disequilibrium endpoints. It’s been presented as easy to deploy, and after some debugging the work demonstrate that ensemblQueryR has improved performance memory usage and speed, delivering a 10-fold speed increase over analogous software whilst using a third of the RAM. As the Ensembl API offers &gt;100 other endpoints, all of these have the potential to be wrapped into R functions and included in this package.</td>
          </tr>
        </tbody>
      </array>
    </p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="d1e1579">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Export to Production</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Edmunds</surname>
            <given-names>Scott</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Editor in Chief</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>11</day>
          <month>9</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>11</day>
          <month>9</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle d1e1808?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
    <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
    <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
    <journal-title-group>
      <journal-title>GigaByte</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2709-4715</issn>
    <publisher>
      <publisher-name>GigaScience Press</publisher-name>
      <publisher-loc>Sha Tin, New Territories, Hong Kong SAR</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10507293</article-id>
    <article-id pub-id-type="publisher-manuscript">TRR-202305-01</article-id>
    <article-id pub-id-type="publisher-id">91</article-id>
    <article-id pub-id-type="doi">10.46471/gigabyte.91</article-id>
    <article-id pub-id-type="arxiv" specific-use="preprint">https://doi.org/10.48550/arXiv.2308.06792</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Technical Release</subject>
      </subj-group>
      <subj-group subj-group-type="classification">
        <subject>Software and Workflows</subject>
        <subject>Bioinformatics</subject>
        <subject>Genetics</subject>
        <subject>Software Engineering</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ensemblQueryR: fast, flexible and high-throughput querying of Ensembl LD API endpoints in R</article-title>
      <alt-title alt-title-type="right-running-head">ensemblQueryR: fast, flexible and high-throughput querying of Ensembl LD API endpoints in R</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-7196-1410</contrib-id>
        <name>
          <surname>Fairbrother-Browne</surname>
          <given-names>Aine</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff000b" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff000c" ref-type="aff">
          <sup>3</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/conceptualization/" vocab-term="Conceptualization" degree-contribution="lead">Conceptualization</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/formal-analysis/" vocab-term="Formal analysis" degree-contribution="lead">Formal analysis</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/methodology/" vocab-term="Methodology" degree-contribution="lead">Methodology</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/software/" vocab-term="Software" degree-contribution="lead">Software</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-original-draft/" vocab-term="Writing - original draft" degree-contribution="lead">Writing - original draft</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-review-editing/" vocab-term="Writing - review editing" degree-contribution="lead">Writing - review editing</role>
        <xref rid="cor1" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0003-4913-5312</contrib-id>
        <name>
          <surname>García-Ruiz</surname>
          <given-names>Sonia</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff000d" ref-type="aff">
          <sup>4</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/methodology/" vocab-term="Methodology" degree-contribution="supporting">Methodology</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-review-editing/" vocab-term="Writing - review editing" degree-contribution="supporting">Writing - review editing</role>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-6470-7919</contrib-id>
        <name>
          <surname>Hertfelder Reynolds</surname>
          <given-names>Regina</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff000d" ref-type="aff">
          <sup>4</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/conceptualization/" vocab-term="Conceptualization" degree-contribution="supporting">Conceptualization</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-review-editing/" vocab-term="Writing - review editing" degree-contribution="supporting">Writing - review editing</role>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-9520-6957</contrib-id>
        <name>
          <surname>Ryten</surname>
          <given-names>Mina</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff000d" ref-type="aff">
          <sup>4</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/supervision/" vocab-term="Supervision">Supervision</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-review-editing/" vocab-term="Writing - review editing">Writing - review editing</role>
        <xref rid="fn0001" ref-type="author-notes">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0003-1636-491X</contrib-id>
        <name>
          <surname>Hodgkinson</surname>
          <given-names>Alan</given-names>
        </name>
        <xref rid="aff000b" ref-type="aff">
          <sup>2</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/supervision/" vocab-term="Supervision">Supervision</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-review-editing/" vocab-term="Writing - review editing">Writing - review editing</role>
        <xref rid="fn0001" ref-type="author-notes">
          <sup>†</sup>
        </xref>
      </contrib>
      <aff id="aff000a"><label><sup>1</sup></label><addr-line content-type="department">Department of Genetics and Genomic Medicine Research &amp; Teaching</addr-line>, <institution>UCL GOS Institute of Child Health</institution>, <addr-line content-type="city">London</addr-line>, <country>UK</country></aff>
      <aff id="aff000b"><label><sup>2</sup></label><addr-line content-type="department">Department of Medical and Molecular Genetics</addr-line>, <institution>School of Basic and Medical Biosciences, King’s College London</institution>, <addr-line content-type="city">London</addr-line>, <country>UK</country></aff>
      <aff id="aff000c"><label><sup>3</sup></label><addr-line content-type="department">Department of Neurodegenerative Disease</addr-line>, <addr-line>Queen Square Institute of Neurology</addr-line>, <institution>UCL</institution>, <addr-line content-type="city">London</addr-line>, <country>UK</country></aff>
      <aff id="aff000d"><label><sup>4</sup></label><addr-line>NIHR Great Ormond Street Hospital Biomedical Research Centre</addr-line>, <institution>University College London</institution>, <addr-line content-type="city">London</addr-line>, <country>UK</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label><sup>*</sup></label> Corresponding author. E-mail: <email xlink:href="ucbtas8@ucl.ac.uk">ucbtas8@ucl.ac.uk</email>
</corresp>
      <fn id="fn0001">
        <label>
          <sup>†</sup>
        </label>
        <p>Contributed equally.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>2023</volume>
    <fpage>1</fpage>
    <lpage>10</lpage>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>9</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" specific-use="url" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>We present ensemblQueryR, an R package for querying Ensembl linkage disequilibrium (LD) endpoints. This package is flexible, fast and user-friendly, and optimised for high-throughput querying. ensemblQueryR uses functions that are intuitive and amenable to custom code integration, familiar R object types as inputs and outputs as well as providing parallelisation functionality. For each Ensembl LD endpoint, ensemblQueryR provides two functions, permitting both single- and multi-query modes of operation. The multi-query functions are optimised for large query sizes and provide optional parallelisation to leverage available computational resources and minimise processing time. We demonstrate improved computational performance of ensemblQueryR over an exisiting tool in terms of random access memory (RAM) usage and speed, delivering a 10-fold speed increase whilst using a third of the RAM. Finally, ensemblQueryR is near-agnostic to operating system and computational architecture through Docker and singularity images, making this tool widely accessible to the scientific community.</p>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution>Biotechnology and Biological Sciences Research Council</institution>
          </institution-wrap>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7196-1410</contrib-id>
          <name>
            <surname>Fairbrother-Browne</surname>
            <given-names>A.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution>Tenure Track Clinician Scientist Fellowship</institution>
          </institution-wrap>
        </funding-source>
        <award-id>MR/N008324/1</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4913-5312</contrib-id>
          <name>
            <surname>García-Ruiz</surname>
            <given-names>S.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution>Tenure Track Clinician Scientist Fellowship</institution>
          </institution-wrap>
        </funding-source>
        <award-id>MR/N008324/1</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9520-6957</contrib-id>
          <name>
            <surname>Ryten</surname>
            <given-names>M.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution>BBSRC</institution>
          </institution-wrap>
        </funding-source>
        <award-id>BB/R006075/1</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-1636-491X</contrib-id>
          <name>
            <surname>Hodgkinson</surname>
            <given-names>A.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>AFB was supported through the award of a Biotechnology and Biological Sciences Research Council (BBSRC UK) London Interdisciplinary Doctoral Fellowship. SGR and MR were supported through the award of a Tenure Track Clinician Scientist Fellowship to MR (MR/N008324/1). AH was funded by a BBSRC award (BB/R006075/1).</funding-statement>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec id="s0001">
    <title>Statement of need</title>
    <sec id="s0002">
      <title>Background</title>
      <p>Linkage disequilibrium (LD) is the non-random association of alleles arising from different loci <styled-content style-type="bibr-wrapper">[<xref rid="ref1" ref-type="bibr">1</xref>]</styled-content>. In population genetics, LD is a measure of the frequency with which an allele of one variant is correlated with an allele of a proximal variant within a particular population <styled-content style-type="bibr-wrapper">[<xref rid="ref2" ref-type="bibr">2</xref>]</styled-content>. There are many applications for LD measures in genomics workflows. For example, in the context of genome-wide association studies (GWAS), which have been used to detect associations between genetic variants and a wide range of human phenotypes, downstream interrogation of local LD structure is required to identify the potential ‘causal’ variant at a nominated locus that exerts an effect on the downstream phenotype. Equally, in expression quantitative trait loci (eQTL) analyses, which aim to uncover associations between genetic variants and the expression of a <italic toggle="yes">cis</italic> or <italic toggle="yes">trans</italic> gene (eGene), LD information is required for the identification of the potential causal variant affecting the expression of the eGene. Further downstream, LD information is useful for functional annotations, where genetic variants or regions in LD with a target variant can aid in the identification of biological processes that might be affected by the GWAS- or eQTL-implicated target variant. As such, it is important that the LD information for a range of human populations can be easily queried by researchers in an efficient and accessible way.</p>
      <p>Despite the widespread usage of LD measures in genomic research, the majority of tools available at present are web-based. Although these offer user-friendly interfaces and can be useful for one-off or small queries, they do not promote reproducibility and are not suited to workflow-oriented researchers wishing to submit multiple large queries. Programmatic tools offer a solution to these problems; however, very few tools for the retrieval of LD metrics exist.</p>
      <p>To our knowledge, only one R package provides a programmatic interface for LD metric retrieval. LDlinkR (version 1.2.3) <styled-content style-type="bibr-wrapper">[<xref rid="ref3" ref-type="bibr">3</xref>]</styled-content> provides an R-based interface to the web-based tool LDlink <styled-content style-type="bibr-wrapper">[<xref rid="ref4" ref-type="bibr">4</xref>]</styled-content>, permitting retrieval of LD metrics using a range of query types. However, LDlinkR has a number of key limitations with respect to speed and query handling. Firstly, the user is required to obtain an access token by signing up on the NCBI website, which is then supplied as an argument to all LDlinkR functions. This requirement is in place to limit user queries, meaning that attempts to speed up the tool using parallelisation easily exceed query limits and cause the tool to return timeout errors. This can result in the user’s access token being blocked. Secondly, a number of functions for retrieving LD metrics are configured for singular queries only – such as the LDpair and LDproxy functions – meaning that the user must write custom code to submit more than one query at one time. As such, although LDlinkR is a useful programmatic alternative to the LDlink web tool, it is not suited to fast, high-throughput multi-query retrieval of LD metrics.</p>
      <p>Ensembl (RRID:<named-content content-type="rrid">SCR_002344</named-content>) is another widely used source of LD metrics, offering an application programming interface (API) that supports an array of query configurations<styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>, <xref rid="ref6" ref-type="bibr">6</xref>]</styled-content>. However, some challenges are presented by direct API usage as its usage requires some technical expertise. Additionally, it is not easily integrable with typical R workflows, precludes the input of standard R objects (such as data frames, lists or vectors), does not output data in an intuitive format and is not easily adaptable to high-throughput workflows. To our knowledge, no R package has been developed to facilitate querying the Ensembl API and, in particular, to retrieve Ensembl LD metrics. In light of this, and to address the limitations of current tools, we present ensemblQueryR. Our R package provides fast, efficient, user-friendly querying of Ensembl LD data, with a focus on intuitive, high-throughput R workflow integration.</p>
      <p>ensemblQueryR has been made freely available (DOI: <ext-link xlink:href="https://doi.org/10.5281/zenodo.7837882" ext-link-type="uri" specific-use="url">10.5281/zenodo.7837882</ext-link>) <styled-content style-type="bibr-wrapper">[<xref rid="ref7" ref-type="bibr">7</xref>, <xref rid="ref8" ref-type="bibr">8</xref>]</styled-content>. The package can also be used in Docker (RRID:<named-content content-type="rrid">SCR_016445</named-content>) <styled-content style-type="bibr-wrapper">[<xref rid="ref9" ref-type="bibr">9</xref>]</styled-content> or Singularity <styled-content style-type="bibr-wrapper">[<xref rid="ref10" ref-type="bibr">10</xref>]</styled-content> containers, for which the images can be found on Docker Hub <styled-content style-type="bibr-wrapper">[<xref rid="ref11" ref-type="bibr">11</xref>]</styled-content> or the Singularity image repository <styled-content style-type="bibr-wrapper">[<xref rid="ref12" ref-type="bibr">12</xref>]</styled-content>.</p>
    </sec>
    <sec id="s0003">
      <title>Implementation</title>
      <sec id="s0004">
        <title>Our approach</title>
        <p>ensemblQueryR provides a suite of functions that wrap around three Ensembl API ‘endpoints’. These endpoints operate to retrieve data from Ensembl databases through the following query configurations:<list list-type="simple"><list-item><label>1.</label><p>Window: retrieval of the LD metrics for a variant and all the other variants in a window around the target variant;</p></list-item><list-item><label>2.</label><p>Pair: retrieval of the LD metrics between a pair of target variants;</p></list-item><list-item><label>3.</label><p>Region: retrieval of the LD metrics between all pairs of variants in a defined target region.</p></list-item></list></p>
        <p>Single-query and multi-query wrapper functions are provided for each of these Ensembl API endpoints, all of which are described in detail in Table <xref rid="gigabyte-2023-91-t001" ref-type="table">1</xref>.</p>
        <table-wrap position="float" id="gigabyte-2023-91-t001">
          <label>Table 1</label>
          <caption>
            <p>The functions comprising the ensemblQueryR package and their relationship to the three LD Ensembl API endpoints.</p>
          </caption>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col span="1" align="left" width="20%"/>
              <col span="1" align="left" width="11%"/>
              <col span="1" align="left" width="10%"/>
              <col span="1" align="left" width="33%"/>
              <col span="1" align="left" width="26%"/>
            </colgroup>
            <thead valign="top">
              <tr>
                <th align="left" rowspan="1" colspan="1">ensemblQueryR function</th>
                <th align="left" rowspan="1" colspan="1">Ensembl API endpoint</th>
                <th align="left" rowspan="1" colspan="1">Arguments</th>
                <th align="left" rowspan="1" colspan="1">Output</th>
                <th align="left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">ensemblQueryGetPops</td>
                <td align="left" rowspan="1" colspan="1">Information <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>
</td>
                <td align="left" rowspan="1" colspan="1">N/A</td>
                <td align="left" rowspan="1" colspan="1">A list of human populations for which LD metrics can be retrieved. <styled-content style-type="bibr-wrapper"/>
</td>
                <td align="left" rowspan="1" colspan="1">This function retrieves a list of the Ensembl populations for which LD metrics can be queried (for further information on the available populations, see Ensembl [<xref rid="ref13" ref-type="bibr">13</xref>]). These can be supplied to the ‘pop’ argument across ensemblQueryR functions.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">pingEnsembl</td>
                <td align="left" rowspan="1" colspan="1">Information <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>
</td>
                <td align="left" rowspan="1" colspan="1">N/A</td>
                <td align="left" rowspan="1" colspan="1">An integer (and a message) to indicate the status of the Ensembl API. Returns 1 and reports “Server OK.” if the server is up.</td>
                <td align="left" rowspan="1" colspan="1">This function checks and informs the user of the status of the Ensembl API.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ensemblQueryLDwithSNPwindow</td>
                <td align="left" rowspan="1" colspan="1">Window <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>
</td>
                <td align="left" rowspan="1" colspan="1">rsid<break/>r2<break/>d.prime<break/>window.size<break/>pop</td>
                <td align="left" rowspan="1" colspan="1">A data frame with five columns: ‘query’ (the variant input to ‘rsid’), snp_in_ld (variant(s) in LD with ‘query’), r2 (r-squared statistic), d_prime (D′ statistic), population_name (the population supplied to ‘pop’).</td>
                <td align="left" rowspan="1" colspan="1">This function retrieves variants in LD with the query variant within a given genomic window.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ensemblQueryLDwithSNPwindowDataframe</td>
                <td align="left" rowspan="1" colspan="1">Window <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>
</td>
                <td align="left" rowspan="1" colspan="1">in.table<break/>r2<break/>d.prime<break/>window.size<break/>pop<break/>cores</td>
                <td align="left" rowspan="1" colspan="1">A data frame with five columns: ‘query’ (the variant input to ‘rsid’), snp_in_ld (variant(s) in LD with ‘query’), r2 (r-squared statistic), d_prime (D′ statistic), population_name (the population supplied to ‘pop’).</td>
                <td align="left" rowspan="1" colspan="1">This function takes a data frame with a column of variant rsIDs (Reference SNP cluster IDs). It retrieves variants in LD with each query variant within a given genomic window.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ensemblQueryLDwithSNPpair</td>
                <td align="left" rowspan="1" colspan="1">Pair <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>
</td>
                <td align="left" rowspan="1" colspan="1">rsid1<break/>rsid2<break/>pop</td>
                <td align="left" rowspan="1" colspan="1">A data frame with five columns: ‘query1’ (the variant input to ‘rsid1’), ‘query2’ (the variant input to ‘rsid2’), r2 (r-squared statistic), d_prime (D′ statistic), population_name (the population supplied to ‘pop’).</td>
                <td align="left" rowspan="1" colspan="1">This function takes a pair of rsIDs and retrieves their LD metrics (D′ and R<sup>2</sup>).</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ensemblQueryLDwithSNPpairDataframe</td>
                <td align="left" rowspan="1" colspan="1">Pair <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>
</td>
                <td align="left" rowspan="1" colspan="1">in.table<break/>pop<break/>cores</td>
                <td align="left" rowspan="1" colspan="1">A data frame with five columns: ‘query1’ (the variant input to ‘rsid1’), ‘query2’ (the variant input to ‘rsid2’), r2 (r-squared statistic), d_prime (D′ statistic), population_name (the population supplied to ‘pop’).</td>
                <td align="left" rowspan="1" colspan="1">This function takes a data.frame containing paired rsIDs, retrieving LD metrics (D′ and R<sup>2</sup>) for all pairs.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ensemblQueryLDwithSNPregion</td>
                <td align="left" rowspan="1" colspan="1">Region <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>
</td>
                <td align="left" rowspan="1" colspan="1">chr<break/>start<break/>end<break/>pop</td>
                <td align="left" rowspan="1" colspan="1">A data frame with eight columns: ‘query_chr’ (the query chromosome supplied to ‘chr’), ‘query_start’ (the query start coordinate supplied to ‘start’), ‘query_end’ (the query end coordinate supplied to ‘end’), ‘rsid1’ (variant one of two in the pair), ‘rsid2’ (variant two of two in the pair), r2 (r-squared statistic), d_prime (D′ statistic), population_name (the population supplied to ‘pop’).</td>
                <td align="left" rowspan="1" colspan="1">This function takes a genomic coordinate, retrieving LD metrics (D′ and R<sup>2</sup>) for all rsID within the defined region.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ensemblQueryLDwithSNPregionDataframe</td>
                <td align="left" rowspan="1" colspan="1">Region <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>
</td>
                <td align="left" rowspan="1" colspan="1">in.table<break/>pop<break/>cores</td>
                <td align="left" rowspan="1" colspan="1">A data frame with eight columns: ‘query_chr’ (the query chromosome supplied to ‘chr’), ‘query_start’ (the query start coordinate supplied to ‘start’), ‘query_end’ (the query end coordinate supplied to ‘end’), ‘rsid1’ (variant one of two in the pair), ‘rsid2’ (variant two of two in the pair), r2 (r-squared statistic), d_prime (D′ statistic), population_name (the population supplied to ‘pop’).</td>
                <td align="left" rowspan="1" colspan="1">This function takes a data frame containing genomic coordinate(s) and retrieves LD metrics (D′ and R<sup>2</sup>) for all rsID within the defined region(s).</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
        <p>To make ensemblQueryR useful in a high-throughput context, the main challenge is that the Ensembl API endpoints are configured to handle single queries. To address this, ensemblQueryR’s three multi-query functions (with names ending in ‘Dataframe’, as described in Table <xref rid="gigabyte-2023-91-t001" ref-type="table">1</xref>) take data frame objects as input, where each row needs to be submitted as a separate query to the Ensembl API. The base R lapply function (Version 4.0.5) <styled-content style-type="bibr-wrapper">[<xref rid="ref14" ref-type="bibr">14</xref>]</styled-content> is then used to apply the corresponding single-query function over the ﻿input data frame, iteratively formulating an API query from each data frame row.</p>
        <p>Building on ensemblQueryR’s high-throughput capabilities, we implemented optional parallelisation for all multi-query functions. Each multi-query function (those with names ending in ‘Dataframe’ in Table <xref rid="gigabyte-2023-91-t001" ref-type="table">1</xref>) has an argument that allows the user to set a number of ‘cores’ to parallelise the query across. Using this functionality can significantly reduce run-time, particularly for larger queries where the parallelisation overheads represent a small proportion of the overall memory requirements. For example, with a query size of 1,000, the ensemblQueryLDwithSNPpairDataframe function running on a single core takes ∼2.4 min, whereas ten cores speed the process up by 22 times, reducing the execution time to ∼0.11 min (System tested on: Ubuntu server 16.04 LTS with kernel version 4.4.0-210-generic, total RAM 251G).</p>
        <p>Consistency of the data output format is an important feature of ensemblQueryR, making it amenable to R workflow integration. All functions (single- and multi-query) return a data frame object, including instances where the query returns a null result or an error. This consistent output format simplifies writing custom code, allowing users to incorporate ensemblQueryR functionality into bespoke workflows. It is important to note that when data cannot be retrieved, for example, if a variant is not found in Ensembl databases or the user input is invalid, console messages alert the user of this and a data frame row containing ‘NA’ values is returned for that query.</p>
      </sec>
      <sec id="s0005">
        <title>Benchmarking</title>
        <p>LDlinkR is an alternative R package that offers LD metric retrieval. As such, it was important to benchmark against this tool to demonstrate the utility of ensemblQueryR for high-throughput querying. Of the functions contained in the LDlinkR and ensemblQueryR packages, two functions are particularly comparable in their functionality. Both LDpair (from LDlinkR) and ensemblQueryLDwithSNPpair (from ensemblQueryR) take a pair of reference SNP cluster identifiers (rsIDs) as input, while the output is a table containing the LD metrics for the query pair. As such, these functions were selected for benchmarking. To compare the performance of the two functions, the computation speed and RAM usage at three query sizes representing a range of throughputs – 100, 1,000 and 10,000 queries – were assessed (Figure <xref rid="gigabyte-2023-91-g001" ref-type="fig">1</xref>). For each function and query size combination, performance (speed and peak RAM usage) was tested ten times to account for temporal ﻿fluctuations in ﻿processing ﻿speed and peak RAM usage, thus enabling a precise performance ﻿assessment.</p>
        <fig position="float" id="gigabyte-2023-91-g001">
          <label>Figure 1.</label>
          <caption>
            <p>Comparison of performance metrics between analogous functions of the ensemblQueryR and LDlinkR R packages. (a) Plot showing, for query sizes of 100, 1,000 and 10,000, the maximum RAM usage (mebibytes, MiB) during the execution of ensemblQueryR’s ensemblQueryLDwithSNPpair (red) and LDlinkR’s LDpair (blue). (b) Plot showing, for query sizes of 100, 1,000 and 10,000, the execution time (minutes, mins) of ensemblQueryR’s ensemblQueryLDwithSNPpair (red) and LDlinkR’s LDpair (blue).</p>
          </caption>
          <graphic xlink:href="gigabyte-2023-91-g001" position="float"/>
        </fig>
        <p> Firstly, comparing execution speed, we found that, on average (across the ten tests), ensemblQueryLDwithSNPpair was 10.2 times faster in the 100-query test, taking an average of 0.208 min compared to the 2.12 min for LDpair (Figure <xref rid="gigabyte-2023-91-g001" ref-type="fig">1</xref>b). The 1,000-query test found that ensemblQueryLDwithSNPpair was, on average, 9.92 times faster than LDlinkR, taking an average of 1.97 min compared to the 19.5 min for LDpair. Finally, in the 10,000-query test, LDpair was unable to produce a final results table in seven out of ten tests, in these instances returning an error message (‘Bad Gateway (HTTP 502)’). In contrast, ensemblQueryLDwithSNPpair produced a final results table in all tests, demonstrating its reliability for high-throughput querying. Looking at the only three successful tests of LDpair, we found that ensemblQueryLDwithSNPpair was, on average, 10.9 times faster than LDpair, taking an average of 18.5 min compared to the 202 min (&gt;3 h) for LDpair. These speed improvements are likely due to request rate limits from the server side, which are higher for Ensembl, thus enabling fast concurrent or parallel requests.</p>
        <p>Secondly, we compared the peak RAM usage – the maximum RAM utilised at any time during function execution – between ensemblQueryLDwithSNPpair and LDpair (Figure <xref rid="gigabyte-2023-91-g001" ref-type="fig">1</xref>a). We found that across query sizes, ensemblQueryLDwithSNPpair had approximately a third (range: 20.8–49.6%) of the peak RAM usage of LDpair. These peak RAM usage improvements are likely due to a focus on within-function reductions of intermediate object storage and a reduction of the number of operations carried out within the ensemblQueryLDwithSNPpair function.</p>
        <p>We conclude that, by comparing analogous functions (ensemblQueryLDwithSNPpair and LDpair), ensemblQueryR provides a performance improvement over LDlinkR with respect to both speed (×10) and memory usage (1/3), underscoring the utility of our tool in the context of high-throughput workflows.</p>
      </sec>
      <sec id="s0006">
        <title>Usage</title>
        <p>The following code provides an implementation example for ensemblQueryR. In this case, the target variant was taken from the OpenTargets homepage <styled-content style-type="bibr-wrapper">[<xref rid="ref15" ref-type="bibr">15</xref>]</styled-content> with rsID <ext-link xlink:href="https://identifiers.org/ensembl:rs4129267" ext-link-type="uri">rs4129267</ext-link>. To find out which variants, within a set of genomic window sizes, are in LD (R<sup>2</sup> &gt; 0.8 and D<italic toggle="yes">′</italic> &gt; 0.8) with the target variant, the ensemblQueryLDwithSNPWindow function was implemented as in Figure <xref rid="gigabyte-2023-91-g002" ref-type="fig">2</xref>.</p>
        <fig position="float" id="gigabyte-2023-91-g002">
          <label>Figure 2.</label>
          <caption>
            <p>Working example of an ensemblQueryR implementation.</p>
          </caption>
          <graphic xlink:href="gigabyte-2023-91-g002" position="float"/>
        </fig>
      </sec>
      <sec id="s0007">
        <title>Methods</title>
        <sec id="s0008">
          <title>Docker and singularity images</title>
          <p>In order to make this tool widely accessible to the research community, we have provided a Docker image (Figure <xref rid="gigabyte-2023-91-g003" ref-type="fig">3</xref>). It is based on a Rocker (RRID:<named-content content-type="rrid">SCR_024215</named-content>) <styled-content style-type="bibr-wrapper">[<xref rid="ref16" ref-type="bibr">16</xref>]</styled-content> with R version 4.0.0 and Ubuntu version 20.04 LTS (Focal Fossa) pre-installed. To start a container using the ‘ensemblqueryr’ Docker image and launch an interactive R session within which the tool can be used, the following command can be executed on the command line: </p>
          <p>
            <monospace>docker pull ainefairbrotherbrowne/ensemblqueryr:1.0; ∖</monospace>
          </p>
          <p>
            <monospace>docker run -t -d --name ensemblqueryr ainefairbrotherbrowne/ensemblqueryr:1.0; ∖</monospace>
          </p>
          <p>
            <monospace>docker exec -i -t ensemblqueryr R</monospace>
          </p>
          <p>To mount a local volume that contains a file of variant IDs, the following command can be used:</p>
          <p>
            <monospace>docker pull ainefairbrotherbrowne/ensemblqueryr:1.0; ∖</monospace>
          </p>
          <p>
            <monospace>docker run -t -d --name ensemblqueryr ainefairbrotherbrowne/ensemblqueryr:1.0 -- path/to/volume; ∖</monospace>
          </p>
          <p>
            <monospace>docker exec -i -t ensemblqueryr R</monospace>
          </p>
          <fig position="float" id="gigabyte-2023-91-g003">
            <label>Figure 3.</label>
            <caption>
              <p>Dockerfile containing the setup for the ensemblQueryR Docker image.</p>
            </caption>
            <graphic xlink:href="gigabyte-2023-91-g003" position="float"/>
          </fig>
          <p> Additionally, for use-cases wherein the user does not have sufficient permissions to use Docker, such as on HPC clusters, a singularity image can be used instead. To generate a singularity image, we converted the ensemblQueryR docker image <styled-content style-type="bibr-wrapper">[<xref rid="ref11" ref-type="bibr">11</xref>]</styled-content> into a singularity image using the Docker-based tool docker2singularity (Version 2.6) <styled-content style-type="bibr-wrapper">[<xref rid="ref17" ref-type="bibr">17</xref>]</styled-content>. This image can be found on the sylabs.io singularity repository <styled-content style-type="bibr-wrapper">[<xref rid="ref12" ref-type="bibr">12</xref>]</styled-content>. The singularity image can be pulled and executed, launching a command line R session as follows:</p>
          <p>
            <monospace>singularity pull --arch amd64 library://ainefairbrother/ensemblqueryr/ensemblqueryr:sha256.e387ea11ae4eaea8f94d81c625c2c1d5a22dd351858ebcd03910a7736d76ca30; ∖</monospace>
          </p>
          <p>
            <monospace>singularity exec ensemblqueryr_sha256.e387ea11ae4eaea8f94d81c625c2c1d5a22dd351858ebcd03910a7736d76ca30.sif R</monospace>
          </p>
        </sec>
        <sec id="s0009">
          <title>Benchmarking</title>
          <p>To benchmark our package against LDlinkR, we first selected functions that performed similar tasks. The most comparable functions in this context were LDlinkR’s ‘LDpair’ and ensemblQueryR’s ‘ensemblQueryLDwithSNPpair’. Both are configured for single queries and take a pair of variant IDs as input, retrieving the corresponding LD metrics through an API query. To run multiple queries using these single-query functions, both functions were applied over variant identifier (ID) vectors using the base R lapply (Version 4.0.5) <styled-content style-type="bibr-wrapper">[<xref rid="ref14" ref-type="bibr">14</xref>]</styled-content>.</p>
          <p>To compare the utility of these functions for LD metric querying in the context of high-throughput workflows, we measured the peak RAM usage and execution speed using the R package peakRAM (version 1.0.2) <styled-content style-type="bibr-wrapper">[<xref rid="ref18" ref-type="bibr">18</xref>]</styled-content> 10 times for each function and at three query sizes (100, 1,000 and 10,000). The standard deviation (sd) of the performance metric for each function at each time point across the ten iterations was calculated. Mean performance metrics were plotted with error bars to show the sd from the mean for peak RAM usage (Figure <xref rid="gigabyte-2023-91-g001" ref-type="fig">1</xref>a) and time measured in minutes (Figure <xref rid="gigabyte-2023-91-g001" ref-type="fig">1</xref>b) for the three query sizes.</p>
        </sec>
      </sec>
      <sec id="s0010">
        <title>Limitations</title>
        <p>It is important to note that there are some limitations to this R package. First, although this package enables high-throughput querying of the Ensembl API, there is an inherent limit to the number of queries that can be submitted arising from the API query limit, which is set at 54,000 requests per hour <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>, <xref rid="ref6" ref-type="bibr">6</xref>]</styled-content>. On the Ubuntu system used to develop ensemblQueryR (Ubuntu server 16.04 LTS with kernel version 4.4.0-210-generic, total RAM 251 G), 54,000 API requests via ensemblQueryLDwithSNPpairDataframe took ∼1.93 h on a single core, making the per-hour request rate 27,867. As such, even query sizes of 54,000 can be run unparallelised and are unlikely to exceed the Ensembl API hourly rate. However, this request limit must be considered by users when applying parallelisation to large queries. The second limitation is that the parallelisation library used to enable the multi-core functionality is the R package ‘parallel’ (version 3.6.2) <styled-content style-type="bibr-wrapper">[<xref rid="ref19" ref-type="bibr">19</xref>]</styled-content>, which works on OSIX systems (Mac, Linux and other Unix-based operating systems) but does not work on Windows.</p>
      </sec>
      <sec id="s0011">
        <title>Scope for future development</title>
        <p>At present, this package provides wrappers for the Ensembl API endpoints that retrieve LD data. However, the Ensembl API offers ∼109 other endpoints <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>, all of which have the potential to be wrapped into R functions and included in this package. As such, there is scope for the usefulness of this package beyond LD metrics and further development will expand its utility to R users across an array of bioscience disciplines.</p>
      </sec>
    </sec>
  </sec>
  <sec id="s0012">
    <title>Availability of source code and requirements</title>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>Project name: ensemblQueryR</p>
        </list-item>
        <list-item>
          <p>Project home page: <ext-link xlink:href="https://github.com/ainefairbrother/ensemblQueryR" ext-link-type="uri" specific-use="url">https://github.com/ainefairbrother/ensemblQueryR</ext-link></p>
        </list-item>
        <list-item>
          <p>Operating system(s): Platform independent</p>
        </list-item>
        <list-item>
          <p>Programming language: R</p>
        </list-item>
        <list-item>
          <p>Licence: MIT</p>
        </list-item>
        <list-item>
          <p>RRID: <named-content content-type="rrid">SCR_024216</named-content>.</p>
        </list-item>
      </list>
    </p>
  </sec>
</body>
<back>
  <sec sec-type="data-availability" id="s0013">
    <title>Data Availability</title>
    <p>Snapshots of the code are available in GigaDB <styled-content style-type="bibr-wrapper">[<xref rid="ref20" ref-type="bibr">20</xref>]</styled-content>. </p>
  </sec>
  <sec id="s0014">
    <title>Abbreviations</title>
    <p>API, Application Programming Interface; eGene, expression of a cis or trans gene; eQTL: Expression Quantitative Trait Loci; GWAS: Genome-Wide Association Study; ID, identifier; LD: Linkage Disequilibrium; RAM: Random Access Memory; REST: Representational State Transfer; rsID: Reference SNP cluster IDs; sd: standard deviation. </p>
  </sec>
  <sec id="s0015">
    <title>Declarations</title>
    <sec id="s0016">
      <title>Ethical approval</title>
      <p>The authors declare that ethical approval was not required for this type of research.</p>
    </sec>
    <sec sec-type="COI-statement" id="s0017">
      <title>Competing Interests</title>
      <p>RHR is currently employed by CoSyne Therapeutics (Lead Bioinformatician). All work performed for this publication was performed in her own time, and not as a part of her duties as an employee.</p>
    </sec>
    <sec id="s0018">
      <title>Author contributions</title>
      <p>AFB and RHR: conceptualisation. AFB: software. AFB and SGR: docker image. AFB: benchmarking. AFB: writing - original draft. AFB, SGR, AH, MR and RHR: writing - review and editing. MR and AH: supervision.</p>
    </sec>
    <sec id="s0019">
      <title>Funding</title>
      <p>AFB was supported through the award of a Biotechnology and Biological Sciences Research Council (BBSRC UK) London Interdisciplinary Doctoral Fellowship. SGR and MR were supported through the award of a Tenure Track Clinician Scientist Fellowship to MR (MR/N008324/1). AH was funded by a BBSRC award (BB/R006075/1).</p>
    </sec>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="ref1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Slatkin</surname><given-names>M</given-names></name>. </person-group><article-title>Linkage disequilibrium — understanding the evolutionary past and mapping the medical future</article-title>. <source>Nat. Rev. Genet.</source>, <year>2008</year>; <volume>9</volume>: <fpage>477</fpage>–<lpage>485</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nrg2361</pub-id>.<pub-id pub-id-type="pmid">18427557</pub-id></mixed-citation>
    </ref>
    <ref id="ref2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bush</surname><given-names>WS</given-names></name>, <name><surname>Moore</surname><given-names>JH</given-names></name>. </person-group><article-title>Chapter 11: Genome-wide association studies</article-title>. <source>PLoS Comput. Biol.</source>, <year>2012</year>; <volume>8</volume>(<issue>12</issue>): <elocation-id content-type="artnum">e1002822</elocation-id>. doi:<pub-id pub-id-type="doi">10.1371/journal.pcbi.1002822</pub-id>.<pub-id pub-id-type="pmid">23300413</pub-id></mixed-citation>
    </ref>
    <ref id="ref3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Myers</surname><given-names>TA</given-names></name>, <name><surname>Chanock</surname><given-names>SJ</given-names></name>, <name><surname>Machiela</surname><given-names>MJ</given-names></name>. </person-group><article-title>LDlinkR: An R package for rapidly calculating linkage disequilibrium statistics in diverse populations</article-title>. <source>Front. Genet.</source>, <year>2020</year>; <volume>11</volume>: <elocation-id content-type="artnum">157</elocation-id>.<pub-id pub-id-type="pmid">32180801</pub-id></mixed-citation>
    </ref>
    <ref id="ref4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Machiela</surname><given-names>MJ</given-names></name>, <name><surname>Chanock</surname><given-names>SJ</given-names></name>. </person-group><article-title>LDlink: a web-based application for exploring population-specific haplotype structure and linking correlated alleles of possible functional variants</article-title>. <source>Bioinformatics</source>, <year>2015</year>; <volume>31</volume>(<issue>21</issue>): <fpage>3555</fpage>–<lpage>3557</lpage>. doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btv402</pub-id>.<pub-id pub-id-type="pmid">26139635</pub-id></mixed-citation>
    </ref>
    <ref id="ref5">
      <label>5</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><collab collab-type="corporate-author">Ensembl Rest API - Ensembl REST API Endpoints</collab></person-group>. <year>2015</year>; <ext-link xlink:href="https://rest.ensembl.org/" ext-link-type="uri" specific-use="url">https://rest.ensembl.org/</ext-link>. Accessed 5 Nov 2022.</mixed-citation>
    </ref>
    <ref id="ref6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yates</surname><given-names>A</given-names></name>, <name><surname>Beal</surname><given-names>K</given-names></name>, <name><surname>Keenan</surname><given-names>S</given-names></name><etal/></person-group><article-title>The ensembl REST API: Ensembl data for any language</article-title>. <source>Bioinformatics</source>, <year>2015</year>; <volume>31</volume>(<issue>1</issue>): <fpage>143</fpage>–<lpage>145</lpage>. doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btu613</pub-id>.<pub-id pub-id-type="pmid">25236461</pub-id></mixed-citation>
    </ref>
    <ref id="ref7">
      <label>7</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><name><surname>Fairbrother-Browne</surname><given-names>A</given-names></name>. </person-group>ensemblQueryR (Version 2.0.0). Zenodo, <year>23 May 2023</year>; <pub-id pub-id-type="doi">10.5281/zenodo.7837882</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref8">
      <label>8</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><name><surname>Fairbrother-Browne</surname><given-names>A</given-names></name>. </person-group>ensemblQueryR (Version 2.0.0). GitHub, <year>23 May 2023</year>; <ext-link xlink:href="https://github.com/ainefairbrother/ensemblQueryR" ext-link-type="uri" specific-use="url">https://github.com/ainefairbrother/ensemblQueryR</ext-link>.</mixed-citation>
    </ref>
    <ref id="ref9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Merkel</surname><given-names>D</given-names></name>. </person-group><article-title>Docker: lightweight Linux containers for consistent development and deployment</article-title>. <source>Linux J.</source>, <year>2014</year>; <volume>2014</volume>(<issue>239</issue>): <elocation-id content-type="artnum">2</elocation-id>.</mixed-citation>
    </ref>
    <ref id="ref10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kurtzer</surname><given-names>GM</given-names></name>, <name><surname>Sochat</surname><given-names>V</given-names></name>, <name><surname>Bauer</surname><given-names>MW</given-names></name>. </person-group><article-title>Singularity: Scientific containers for mobility of compute</article-title>. <source>PLOS One</source>, <year>2017</year>; <volume>12</volume>(<issue>5</issue>): <elocation-id content-type="artnum">e0177459</elocation-id>. doi:<pub-id pub-id-type="doi">10.1371/journal.pone.0177459</pub-id>.<pub-id pub-id-type="pmid">28494014</pub-id></mixed-citation>
    </ref>
    <ref id="ref11">
      <label>11</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><name><surname>Fairbrother-Browne</surname><given-names>A</given-names></name>. </person-group>ensemblqueryr (Version 1.0). Docker Hub, <year>22 May 2023</year>; <ext-link xlink:href="https://hub.docker.com/r/ainefairbrotherbrowne/ensemblqueryr" ext-link-type="uri" specific-use="url">https://hub.docker.com/r/ainefairbrotherbrowne/ensemblqueryr</ext-link>.</mixed-citation>
    </ref>
    <ref id="ref12">
      <label>12</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><name><surname>Fairbrother-Browne</surname><given-names>A</given-names></name>. </person-group>ensemblqueryr (Version 1.0). sylabs.io, <year>22 May 2023</year>; <ext-link xlink:href="https://cloud.sylabs.io/library/ainefairbrother/ensemblqueryr/ensemblqueryr" ext-link-type="uri" specific-use="url">https://cloud.sylabs.io/library/ainefairbrother/ensemblqueryr/ensemblqueryr</ext-link>.</mixed-citation>
    </ref>
    <ref id="ref13">
      <label>13</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><collab collab-type="corporate-author">Ensembl Population Frequencies &amp; Genotypes</collab></person-group>. <ext-link xlink:href="https://www.ensembl.org/info/genome/variation/species/populations.html" ext-link-type="uri" specific-use="url">https://www.ensembl.org/info/genome/variation/species/populations.html</ext-link>. Accessed 23 May 2023.</mixed-citation>
    </ref>
    <ref id="ref14">
      <label>14</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><collab collab-type="corporate-author">R Core</collab></person-group>. <article-title>R: A language and environment for statistical computing</article-title>, <year>2021</year>; Available at: <ext-link xlink:href="https://cran.r-project.org/doc/manuals/r-release/fullrefman.pdf" ext-link-type="uri" specific-use="url">https://cran.r-project.org/doc/manuals/r-release/fullrefman.pdf</ext-link>.</mixed-citation>
    </ref>
    <ref id="ref15">
      <label>15</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><collab collab-type="corporate-author">Open Targets Genetics</collab></person-group>. <ext-link xlink:href="https://genetics.opentargets.org/" ext-link-type="uri" specific-use="url">https://genetics.opentargets.org/</ext-link>. Accessed 23 May 2023.</mixed-citation>
    </ref>
    <ref id="ref16">
      <label>16</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boettiger</surname><given-names>C</given-names></name>, <name><surname>Eddelbuettel</surname><given-names>D</given-names></name>. </person-group><article-title>An introduction to Rocker: Docker containers for R</article-title>. <source>R J.</source>, <year>2017</year>; <volume>9</volume>(<issue>2</issue>): <fpage>527</fpage>–<lpage>536</lpage>. doi:<pub-id pub-id-type="doi">10.32614/RJ-2017-065</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref17">
      <label>17</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><collab collab-type="corporate-author">Singularity Hub</collab></person-group>. Docker2singularity (Version 2.6), <year>2018</year>; <ext-link xlink:href="https://github.com/singularityhub/docker2singularity/releases/tag/v2.6-release" ext-link-type="uri" specific-use="url">https://github.com/singularityhub/docker2singularity/releases/tag/v2.6-release</ext-link>.</mixed-citation>
    </ref>
    <ref id="ref18">
      <label>18</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><name><surname>Quinn</surname><given-names>T</given-names></name>. </person-group>peakRAM (Version 1.0.2), <year>2017</year>; <ext-link xlink:href="https://cran.r-project.org/web/packages/peakRAM/vignettes/peakRAM.html" ext-link-type="uri" specific-use="url">https://cran.r-project.org/web/packages/peakRAM/vignettes/peakRAM.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="ref19">
      <label>19</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><collab collab-type="corporate-author">R-core</collab>. Parallel (Version 3.6.2), </person-group><year>2023</year>; <ext-link xlink:href="https://www.rdocumentation.org/packages/parallel/versions/3.6.2" ext-link-type="uri" specific-use="url">https://www.rdocumentation.org/packages/parallel/versions/3.6.2</ext-link>.</mixed-citation>
    </ref>
    <ref id="ref20">
      <label>20</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fairbrother-Browne</surname><given-names>A</given-names></name>, <name><surname>García-Ruiz</surname><given-names>S</given-names></name>, <name><surname>Reynolds</surname><given-names>RH</given-names></name><etal/></person-group><article-title>Supporting data for “ensemblQueryR: fast, flexible and high-throughput querying of Ensembl API LD endpoints in R”</article-title>. <source>GigaScience Database</source>, <year>2023</year>; <pub-id pub-id-type="doi">10.5524/102435</pub-id>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="author-comment" id="d1e1808">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Article Submission</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Fairbrother-Browne</surname>
            <given-names>Aine</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Author</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>23</day>
          <month>5</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>23</day>
          <month>5</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e1814">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Assign Handling Editor</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Edmunds</surname>
            <given-names>Scott</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Editor in Chief</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>25</day>
          <month>5</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>25</day>
          <month>5</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e1820">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Editor Assess MS</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Zhang</surname>
            <given-names>Hongfang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Handling Editor</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>25</day>
          <month>5</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>26</day>
          <month>5</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e1826">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Curator Assess MS</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Armit</surname>
            <given-names>Chris</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Curator</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>26</day>
          <month>5</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>26</day>
          <month>5</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="reviewer-report" id="d1e1832">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Review MS</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Khan</surname>
            <given-names>Aziz</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Reviewer 1</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>30</day>
          <month>6</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>09</day>
          <month>8</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
  <body>
    <p>
      <array>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">Reviewer name and names of any other individual's who aided in reviewer</td>
            <td rowspan="1" colspan="1">Aziz Khan</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Do you understand and agree to our policy of having open and named reviews, and having your review included with the published manuscript. (If no, please inform the editor that you cannot review this manuscript.)</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the language of sufficient quality?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Please add additional comments on language quality to clarify if needed</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there a clear statement of need explaining what problems the software is designed to solve and who the target audience is? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the source code available, and has an appropriate Open Source Initiative license &lt;a href="https://opensource.org/licenses" target="_blank"&gt;(https://opensource.org/licenses)&lt;/a&gt; been assigned to the code?</td>
            <td rowspan="1" colspan="1">No</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1">There are two license files (the LICENSE, LICENSE.md) and both are conflicting. The authors should use one to make sure it is an appropriate Open Source Initiative license.</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">As Open Source Software are there guidelines on how to contribute, report issues or seek support on the code?</td>
            <td rowspan="1" colspan="1">No</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1">There are no guidelines on how to contribute.</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the code executable?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is installation/deployment sufficiently outlined in the paper and documentation, and does it proceed as outlined?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1">Installation was straightforward.</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the documentation provided clear and user friendly?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there enough clear information in the documentation to install, run and test this tool, including information on where to seek help if required?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there a clearly-stated list of dependencies, and is the core functionality of the software documented to a satisfactory level?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1">The DESCRIPTION file has all the required packages. </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Have any claims of performance been sufficiently tested and compared to other commonly-used packages? </td>
            <td rowspan="1" colspan="1">No</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Are there (ideally real world) examples demonstrating use of the software? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1">There are some use cases in the minimal documentation. Some of these are not working. </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is automated testing used or are there manual steps described so that the functionality of the software can be verified?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1">The package is already in the CRAN, which means it passed its checks. It does have example snippets of code to be run. </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Any Additional Overall Comments to the Author</td>
            <td rowspan="1" colspan="1">The ensemblQueryR package offers an R interface for querying Ensembl REST API linkage disequilibrium (LD) endpoints. The package aims to support high-throughput querying, utilizing familiar R object types and parallelization. The package is already in CRAN and comes with Docker/Singularity options. While the paper highlights notable strengths, such as the R interface, high-throughput support, parallelization, and performance improvements, a few points warrant further consideration and clarification.&#13; &#13; (1). The package is already in CRAN, which is good, but there are issues with the use-case examples. When I executed the test case to query LD metrics for a variant within a window, the package returned a tibble containing NAs.&#13; (2). The title claims the package supports querying "several" Ensembl API endpoints, but the current version is limited to LD endpoints. Revising the title to reflect the package's current capabilities accurately is recommended.&#13; (3). Two conflicting license files exist (the LICENSE, LICENSE.md). The authors should select one to ensure it aligns with an appropriate Open Source Initiative license. Additionally, there are no guidelines provided for contributing to the project.&#13; (4). I have encountered this R package to get Ensembl data in R using the REST API - https://github.com/dwinter/rensembl. Can the authors comment on this? </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Recommendation</td>
            <td rowspan="1" colspan="1">Minor Revisions</td>
          </tr>
        </tbody>
      </array>
    </p>
  </body>
</sub-article>
<sub-article article-type="reviewer-report" id="d1e1838">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Review MS</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Yates</surname>
            <given-names>Andrew</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Reviewer 2</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>30</day>
          <month>6</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>30</day>
          <month>6</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
  <body>
    <p>
      <array>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">Reviewer name and names of any other individual's who aided in reviewer</td>
            <td rowspan="1" colspan="1">Andy Yates</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Do you understand and agree to our policy of having open and named reviews, and having your review included with the published manuscript. (If no, please inform the editor that you cannot review this manuscript.)</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the language of sufficient quality?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Please add additional comments on language quality to clarify if needed</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there a clear statement of need explaining what problems the software is designed to solve and who the target audience is? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the source code available, and has an appropriate Open Source Initiative license &lt;a href="https://opensource.org/licenses" target="_blank"&gt;(https://opensource.org/licenses)&lt;/a&gt; been assigned to the code?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">As Open Source Software are there guidelines on how to contribute, report issues or seek support on the code?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1">Whilst nothing explicit is there the code is hosted on GitHub &amp; therefore using the issue tracker would appear to be the right way to do this</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the code executable?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is installation/deployment sufficiently outlined in the paper and documentation, and does it proceed as outlined?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the documentation provided clear and user friendly?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there enough clear information in the documentation to install, run and test this tool, including information on where to seek help if required?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there a clearly-stated list of dependencies, and is the core functionality of the software documented to a satisfactory level?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Have any claims of performance been sufficiently tested and compared to other commonly-used packages? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is test data available, either included with the submission or openly available via cited third party sources (e.g. accession numbers, data DOIs)?</td>
            <td rowspan="1" colspan="1">No</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1">The code uses data from Ensembl so this is somewhat sufficient and uses rsIDs</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Are there (ideally real world) examples demonstrating use of the software? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is automated testing used or are there manual steps described so that the functionality of the software can be verified?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Any Additional Overall Comments to the Author</td>
            <td rowspan="1" colspan="1">The authors present in their manuscript “ensemblQueryR: fast, flexible and high-throughput querying of Ensembl API endpoints in R”; a library for the popular R programming language and specifically addresses fast retrieval of linkage disequilibrium from Ensembl’s REST APIs. The toolkit provides a convenient set of functions which mediates queries into the Ensembl REST API and presents results in a manner which is optimised and familiar for R users.&#13; &#13; Overall I find the manuscript good and provides a useful toolkit for R developers. It is pleasing to see more people use the Ensembl REST APIs and to expand its user base. The analysis benchmarks also appear appropriate. I have only two minor comments.&#13; &#13; 1. Code examples&#13; &#13; Whilst I was able to execute the given example I did encounter some issues. Namely that when executing the code&#13; &#13; ensemblQueryR::ensemblQueryLDwithSNPwindow(rsid="rs4129267", r2=0.8, d.prime=0.8, window.size=500, pop="1000GENOMES:phase_3:EUR")&#13; &#13; I got the following result&#13; &#13; query snp_in_ld r2 d_prime population_name&#13; &lt;chr&gt; &lt;lgl&gt; &lt;lgl&gt; &lt;lgl&gt; &lt;lgl&gt;&#13; 1 rs4129267 NA NA NA NA&#13; &#13; It was disconcerting to not get any results back and now I am unsure if I did the right thing. I then found the GitHub repository was a far better reference for the correct commands to run and would encourage perhaps less information in the manuscript and the authors pointing readers to the GitHub repository or the site https://ainefairbrother.github.io/ensemblQueryR/.&#13; &#13; 2. Extensions&#13; &#13; The authors suggest possible extensions to ensemblQueryR but it would be useful to know if there are any specific developments planned by the authors. </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Recommendation</td>
            <td rowspan="1" colspan="1">Minor Revisions</td>
          </tr>
        </tbody>
      </array>
    </p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="d1e1845">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Editor Decision</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Zhang</surname>
            <given-names>Hongfang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Handling Editor</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>09</day>
          <month>8</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>09</day>
          <month>8</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="author-comment" id="d1e1549">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Minor Revision</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Fairbrother-Browne</surname>
            <given-names>Aine</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Author</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>11</day>
          <month>8</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>11</day>
          <month>8</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e1555">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Assess Revision</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Zhang</surname>
            <given-names>Hongfang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Handling Editor</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>11</day>
          <month>8</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>13</day>
          <month>8</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e1561">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Final Data Preparation</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Armit</surname>
            <given-names>Chris</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Curator</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>15</day>
          <month>8</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>15</day>
          <month>8</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e1567">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Editor Decision</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Zhang</surname>
            <given-names>Hongfang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Handling Editor</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>15</day>
          <month>8</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>11</day>
          <month>9</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e1573">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Accept</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Edmunds</surname>
            <given-names>Scott</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Editor in Chief</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>11</day>
          <month>9</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>11</day>
          <month>9</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
  <body>
    <p>
      <array>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">Editor’s Assessment</td>
            <td rowspan="1" colspan="1">ENSEMBL is a crucial resource for the vertebrate genomics community. And ensemblQueryR is an R interface to the Ensembl API that facilitates flexible, fast, user-friendly and R workflow integrable querying of the database linkage disequilibrium endpoints. It’s been presented as easy to deploy, and after some debugging the work demonstrate that ensemblQueryR has improved performance memory usage and speed, delivering a 10-fold speed increase over analogous software whilst using a third of the RAM. As the Ensembl API offers &gt;100 other endpoints, all of these have the potential to be wrapped into R functions and included in this package.</td>
          </tr>
        </tbody>
      </array>
    </p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="d1e1579">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Export to Production</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Edmunds</surname>
            <given-names>Scott</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Editor in Chief</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>11</day>
          <month>9</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>11</day>
          <month>9</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle d1e1808?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
    <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
    <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
    <journal-title-group>
      <journal-title>GigaByte</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2709-4715</issn>
    <publisher>
      <publisher-name>GigaScience Press</publisher-name>
      <publisher-loc>Sha Tin, New Territories, Hong Kong SAR</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10507293</article-id>
    <article-id pub-id-type="publisher-manuscript">TRR-202305-01</article-id>
    <article-id pub-id-type="publisher-id">91</article-id>
    <article-id pub-id-type="doi">10.46471/gigabyte.91</article-id>
    <article-id pub-id-type="arxiv" specific-use="preprint">https://doi.org/10.48550/arXiv.2308.06792</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Technical Release</subject>
      </subj-group>
      <subj-group subj-group-type="classification">
        <subject>Software and Workflows</subject>
        <subject>Bioinformatics</subject>
        <subject>Genetics</subject>
        <subject>Software Engineering</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ensemblQueryR: fast, flexible and high-throughput querying of Ensembl LD API endpoints in R</article-title>
      <alt-title alt-title-type="right-running-head">ensemblQueryR: fast, flexible and high-throughput querying of Ensembl LD API endpoints in R</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-7196-1410</contrib-id>
        <name>
          <surname>Fairbrother-Browne</surname>
          <given-names>Aine</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff000b" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff000c" ref-type="aff">
          <sup>3</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/conceptualization/" vocab-term="Conceptualization" degree-contribution="lead">Conceptualization</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/formal-analysis/" vocab-term="Formal analysis" degree-contribution="lead">Formal analysis</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/methodology/" vocab-term="Methodology" degree-contribution="lead">Methodology</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/software/" vocab-term="Software" degree-contribution="lead">Software</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-original-draft/" vocab-term="Writing - original draft" degree-contribution="lead">Writing - original draft</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-review-editing/" vocab-term="Writing - review editing" degree-contribution="lead">Writing - review editing</role>
        <xref rid="cor1" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0003-4913-5312</contrib-id>
        <name>
          <surname>García-Ruiz</surname>
          <given-names>Sonia</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff000d" ref-type="aff">
          <sup>4</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/methodology/" vocab-term="Methodology" degree-contribution="supporting">Methodology</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-review-editing/" vocab-term="Writing - review editing" degree-contribution="supporting">Writing - review editing</role>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-6470-7919</contrib-id>
        <name>
          <surname>Hertfelder Reynolds</surname>
          <given-names>Regina</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff000d" ref-type="aff">
          <sup>4</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/conceptualization/" vocab-term="Conceptualization" degree-contribution="supporting">Conceptualization</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-review-editing/" vocab-term="Writing - review editing" degree-contribution="supporting">Writing - review editing</role>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-9520-6957</contrib-id>
        <name>
          <surname>Ryten</surname>
          <given-names>Mina</given-names>
        </name>
        <xref rid="aff000a" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff000d" ref-type="aff">
          <sup>4</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/supervision/" vocab-term="Supervision">Supervision</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-review-editing/" vocab-term="Writing - review editing">Writing - review editing</role>
        <xref rid="fn0001" ref-type="author-notes">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0003-1636-491X</contrib-id>
        <name>
          <surname>Hodgkinson</surname>
          <given-names>Alan</given-names>
        </name>
        <xref rid="aff000b" ref-type="aff">
          <sup>2</sup>
        </xref>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/supervision/" vocab-term="Supervision">Supervision</role>
        <role vocab="Casrai/NISO CRediT" vocab-identifier="http://credit.niso.org/contributor-roles/writing-review-editing/" vocab-term="Writing - review editing">Writing - review editing</role>
        <xref rid="fn0001" ref-type="author-notes">
          <sup>†</sup>
        </xref>
      </contrib>
      <aff id="aff000a"><label><sup>1</sup></label><addr-line content-type="department">Department of Genetics and Genomic Medicine Research &amp; Teaching</addr-line>, <institution>UCL GOS Institute of Child Health</institution>, <addr-line content-type="city">London</addr-line>, <country>UK</country></aff>
      <aff id="aff000b"><label><sup>2</sup></label><addr-line content-type="department">Department of Medical and Molecular Genetics</addr-line>, <institution>School of Basic and Medical Biosciences, King’s College London</institution>, <addr-line content-type="city">London</addr-line>, <country>UK</country></aff>
      <aff id="aff000c"><label><sup>3</sup></label><addr-line content-type="department">Department of Neurodegenerative Disease</addr-line>, <addr-line>Queen Square Institute of Neurology</addr-line>, <institution>UCL</institution>, <addr-line content-type="city">London</addr-line>, <country>UK</country></aff>
      <aff id="aff000d"><label><sup>4</sup></label><addr-line>NIHR Great Ormond Street Hospital Biomedical Research Centre</addr-line>, <institution>University College London</institution>, <addr-line content-type="city">London</addr-line>, <country>UK</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label><sup>*</sup></label> Corresponding author. E-mail: <email xlink:href="ucbtas8@ucl.ac.uk">ucbtas8@ucl.ac.uk</email>
</corresp>
      <fn id="fn0001">
        <label>
          <sup>†</sup>
        </label>
        <p>Contributed equally.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>2023</volume>
    <fpage>1</fpage>
    <lpage>10</lpage>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>9</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" specific-use="url" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>We present ensemblQueryR, an R package for querying Ensembl linkage disequilibrium (LD) endpoints. This package is flexible, fast and user-friendly, and optimised for high-throughput querying. ensemblQueryR uses functions that are intuitive and amenable to custom code integration, familiar R object types as inputs and outputs as well as providing parallelisation functionality. For each Ensembl LD endpoint, ensemblQueryR provides two functions, permitting both single- and multi-query modes of operation. The multi-query functions are optimised for large query sizes and provide optional parallelisation to leverage available computational resources and minimise processing time. We demonstrate improved computational performance of ensemblQueryR over an exisiting tool in terms of random access memory (RAM) usage and speed, delivering a 10-fold speed increase whilst using a third of the RAM. Finally, ensemblQueryR is near-agnostic to operating system and computational architecture through Docker and singularity images, making this tool widely accessible to the scientific community.</p>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution>Biotechnology and Biological Sciences Research Council</institution>
          </institution-wrap>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7196-1410</contrib-id>
          <name>
            <surname>Fairbrother-Browne</surname>
            <given-names>A.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution>Tenure Track Clinician Scientist Fellowship</institution>
          </institution-wrap>
        </funding-source>
        <award-id>MR/N008324/1</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4913-5312</contrib-id>
          <name>
            <surname>García-Ruiz</surname>
            <given-names>S.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution>Tenure Track Clinician Scientist Fellowship</institution>
          </institution-wrap>
        </funding-source>
        <award-id>MR/N008324/1</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9520-6957</contrib-id>
          <name>
            <surname>Ryten</surname>
            <given-names>M.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution>BBSRC</institution>
          </institution-wrap>
        </funding-source>
        <award-id>BB/R006075/1</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-1636-491X</contrib-id>
          <name>
            <surname>Hodgkinson</surname>
            <given-names>A.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>AFB was supported through the award of a Biotechnology and Biological Sciences Research Council (BBSRC UK) London Interdisciplinary Doctoral Fellowship. SGR and MR were supported through the award of a Tenure Track Clinician Scientist Fellowship to MR (MR/N008324/1). AH was funded by a BBSRC award (BB/R006075/1).</funding-statement>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec id="s0001">
    <title>Statement of need</title>
    <sec id="s0002">
      <title>Background</title>
      <p>Linkage disequilibrium (LD) is the non-random association of alleles arising from different loci <styled-content style-type="bibr-wrapper">[<xref rid="ref1" ref-type="bibr">1</xref>]</styled-content>. In population genetics, LD is a measure of the frequency with which an allele of one variant is correlated with an allele of a proximal variant within a particular population <styled-content style-type="bibr-wrapper">[<xref rid="ref2" ref-type="bibr">2</xref>]</styled-content>. There are many applications for LD measures in genomics workflows. For example, in the context of genome-wide association studies (GWAS), which have been used to detect associations between genetic variants and a wide range of human phenotypes, downstream interrogation of local LD structure is required to identify the potential ‘causal’ variant at a nominated locus that exerts an effect on the downstream phenotype. Equally, in expression quantitative trait loci (eQTL) analyses, which aim to uncover associations between genetic variants and the expression of a <italic toggle="yes">cis</italic> or <italic toggle="yes">trans</italic> gene (eGene), LD information is required for the identification of the potential causal variant affecting the expression of the eGene. Further downstream, LD information is useful for functional annotations, where genetic variants or regions in LD with a target variant can aid in the identification of biological processes that might be affected by the GWAS- or eQTL-implicated target variant. As such, it is important that the LD information for a range of human populations can be easily queried by researchers in an efficient and accessible way.</p>
      <p>Despite the widespread usage of LD measures in genomic research, the majority of tools available at present are web-based. Although these offer user-friendly interfaces and can be useful for one-off or small queries, they do not promote reproducibility and are not suited to workflow-oriented researchers wishing to submit multiple large queries. Programmatic tools offer a solution to these problems; however, very few tools for the retrieval of LD metrics exist.</p>
      <p>To our knowledge, only one R package provides a programmatic interface for LD metric retrieval. LDlinkR (version 1.2.3) <styled-content style-type="bibr-wrapper">[<xref rid="ref3" ref-type="bibr">3</xref>]</styled-content> provides an R-based interface to the web-based tool LDlink <styled-content style-type="bibr-wrapper">[<xref rid="ref4" ref-type="bibr">4</xref>]</styled-content>, permitting retrieval of LD metrics using a range of query types. However, LDlinkR has a number of key limitations with respect to speed and query handling. Firstly, the user is required to obtain an access token by signing up on the NCBI website, which is then supplied as an argument to all LDlinkR functions. This requirement is in place to limit user queries, meaning that attempts to speed up the tool using parallelisation easily exceed query limits and cause the tool to return timeout errors. This can result in the user’s access token being blocked. Secondly, a number of functions for retrieving LD metrics are configured for singular queries only – such as the LDpair and LDproxy functions – meaning that the user must write custom code to submit more than one query at one time. As such, although LDlinkR is a useful programmatic alternative to the LDlink web tool, it is not suited to fast, high-throughput multi-query retrieval of LD metrics.</p>
      <p>Ensembl (RRID:<named-content content-type="rrid">SCR_002344</named-content>) is another widely used source of LD metrics, offering an application programming interface (API) that supports an array of query configurations<styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>, <xref rid="ref6" ref-type="bibr">6</xref>]</styled-content>. However, some challenges are presented by direct API usage as its usage requires some technical expertise. Additionally, it is not easily integrable with typical R workflows, precludes the input of standard R objects (such as data frames, lists or vectors), does not output data in an intuitive format and is not easily adaptable to high-throughput workflows. To our knowledge, no R package has been developed to facilitate querying the Ensembl API and, in particular, to retrieve Ensembl LD metrics. In light of this, and to address the limitations of current tools, we present ensemblQueryR. Our R package provides fast, efficient, user-friendly querying of Ensembl LD data, with a focus on intuitive, high-throughput R workflow integration.</p>
      <p>ensemblQueryR has been made freely available (DOI: <ext-link xlink:href="https://doi.org/10.5281/zenodo.7837882" ext-link-type="uri" specific-use="url">10.5281/zenodo.7837882</ext-link>) <styled-content style-type="bibr-wrapper">[<xref rid="ref7" ref-type="bibr">7</xref>, <xref rid="ref8" ref-type="bibr">8</xref>]</styled-content>. The package can also be used in Docker (RRID:<named-content content-type="rrid">SCR_016445</named-content>) <styled-content style-type="bibr-wrapper">[<xref rid="ref9" ref-type="bibr">9</xref>]</styled-content> or Singularity <styled-content style-type="bibr-wrapper">[<xref rid="ref10" ref-type="bibr">10</xref>]</styled-content> containers, for which the images can be found on Docker Hub <styled-content style-type="bibr-wrapper">[<xref rid="ref11" ref-type="bibr">11</xref>]</styled-content> or the Singularity image repository <styled-content style-type="bibr-wrapper">[<xref rid="ref12" ref-type="bibr">12</xref>]</styled-content>.</p>
    </sec>
    <sec id="s0003">
      <title>Implementation</title>
      <sec id="s0004">
        <title>Our approach</title>
        <p>ensemblQueryR provides a suite of functions that wrap around three Ensembl API ‘endpoints’. These endpoints operate to retrieve data from Ensembl databases through the following query configurations:<list list-type="simple"><list-item><label>1.</label><p>Window: retrieval of the LD metrics for a variant and all the other variants in a window around the target variant;</p></list-item><list-item><label>2.</label><p>Pair: retrieval of the LD metrics between a pair of target variants;</p></list-item><list-item><label>3.</label><p>Region: retrieval of the LD metrics between all pairs of variants in a defined target region.</p></list-item></list></p>
        <p>Single-query and multi-query wrapper functions are provided for each of these Ensembl API endpoints, all of which are described in detail in Table <xref rid="gigabyte-2023-91-t001" ref-type="table">1</xref>.</p>
        <table-wrap position="float" id="gigabyte-2023-91-t001">
          <label>Table 1</label>
          <caption>
            <p>The functions comprising the ensemblQueryR package and their relationship to the three LD Ensembl API endpoints.</p>
          </caption>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col span="1" align="left" width="20%"/>
              <col span="1" align="left" width="11%"/>
              <col span="1" align="left" width="10%"/>
              <col span="1" align="left" width="33%"/>
              <col span="1" align="left" width="26%"/>
            </colgroup>
            <thead valign="top">
              <tr>
                <th align="left" rowspan="1" colspan="1">ensemblQueryR function</th>
                <th align="left" rowspan="1" colspan="1">Ensembl API endpoint</th>
                <th align="left" rowspan="1" colspan="1">Arguments</th>
                <th align="left" rowspan="1" colspan="1">Output</th>
                <th align="left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">ensemblQueryGetPops</td>
                <td align="left" rowspan="1" colspan="1">Information <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>
</td>
                <td align="left" rowspan="1" colspan="1">N/A</td>
                <td align="left" rowspan="1" colspan="1">A list of human populations for which LD metrics can be retrieved. <styled-content style-type="bibr-wrapper"/>
</td>
                <td align="left" rowspan="1" colspan="1">This function retrieves a list of the Ensembl populations for which LD metrics can be queried (for further information on the available populations, see Ensembl [<xref rid="ref13" ref-type="bibr">13</xref>]). These can be supplied to the ‘pop’ argument across ensemblQueryR functions.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">pingEnsembl</td>
                <td align="left" rowspan="1" colspan="1">Information <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>
</td>
                <td align="left" rowspan="1" colspan="1">N/A</td>
                <td align="left" rowspan="1" colspan="1">An integer (and a message) to indicate the status of the Ensembl API. Returns 1 and reports “Server OK.” if the server is up.</td>
                <td align="left" rowspan="1" colspan="1">This function checks and informs the user of the status of the Ensembl API.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ensemblQueryLDwithSNPwindow</td>
                <td align="left" rowspan="1" colspan="1">Window <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>
</td>
                <td align="left" rowspan="1" colspan="1">rsid<break/>r2<break/>d.prime<break/>window.size<break/>pop</td>
                <td align="left" rowspan="1" colspan="1">A data frame with five columns: ‘query’ (the variant input to ‘rsid’), snp_in_ld (variant(s) in LD with ‘query’), r2 (r-squared statistic), d_prime (D′ statistic), population_name (the population supplied to ‘pop’).</td>
                <td align="left" rowspan="1" colspan="1">This function retrieves variants in LD with the query variant within a given genomic window.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ensemblQueryLDwithSNPwindowDataframe</td>
                <td align="left" rowspan="1" colspan="1">Window <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>
</td>
                <td align="left" rowspan="1" colspan="1">in.table<break/>r2<break/>d.prime<break/>window.size<break/>pop<break/>cores</td>
                <td align="left" rowspan="1" colspan="1">A data frame with five columns: ‘query’ (the variant input to ‘rsid’), snp_in_ld (variant(s) in LD with ‘query’), r2 (r-squared statistic), d_prime (D′ statistic), population_name (the population supplied to ‘pop’).</td>
                <td align="left" rowspan="1" colspan="1">This function takes a data frame with a column of variant rsIDs (Reference SNP cluster IDs). It retrieves variants in LD with each query variant within a given genomic window.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ensemblQueryLDwithSNPpair</td>
                <td align="left" rowspan="1" colspan="1">Pair <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>
</td>
                <td align="left" rowspan="1" colspan="1">rsid1<break/>rsid2<break/>pop</td>
                <td align="left" rowspan="1" colspan="1">A data frame with five columns: ‘query1’ (the variant input to ‘rsid1’), ‘query2’ (the variant input to ‘rsid2’), r2 (r-squared statistic), d_prime (D′ statistic), population_name (the population supplied to ‘pop’).</td>
                <td align="left" rowspan="1" colspan="1">This function takes a pair of rsIDs and retrieves their LD metrics (D′ and R<sup>2</sup>).</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ensemblQueryLDwithSNPpairDataframe</td>
                <td align="left" rowspan="1" colspan="1">Pair <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>
</td>
                <td align="left" rowspan="1" colspan="1">in.table<break/>pop<break/>cores</td>
                <td align="left" rowspan="1" colspan="1">A data frame with five columns: ‘query1’ (the variant input to ‘rsid1’), ‘query2’ (the variant input to ‘rsid2’), r2 (r-squared statistic), d_prime (D′ statistic), population_name (the population supplied to ‘pop’).</td>
                <td align="left" rowspan="1" colspan="1">This function takes a data.frame containing paired rsIDs, retrieving LD metrics (D′ and R<sup>2</sup>) for all pairs.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ensemblQueryLDwithSNPregion</td>
                <td align="left" rowspan="1" colspan="1">Region <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>
</td>
                <td align="left" rowspan="1" colspan="1">chr<break/>start<break/>end<break/>pop</td>
                <td align="left" rowspan="1" colspan="1">A data frame with eight columns: ‘query_chr’ (the query chromosome supplied to ‘chr’), ‘query_start’ (the query start coordinate supplied to ‘start’), ‘query_end’ (the query end coordinate supplied to ‘end’), ‘rsid1’ (variant one of two in the pair), ‘rsid2’ (variant two of two in the pair), r2 (r-squared statistic), d_prime (D′ statistic), population_name (the population supplied to ‘pop’).</td>
                <td align="left" rowspan="1" colspan="1">This function takes a genomic coordinate, retrieving LD metrics (D′ and R<sup>2</sup>) for all rsID within the defined region.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ensemblQueryLDwithSNPregionDataframe</td>
                <td align="left" rowspan="1" colspan="1">Region <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>
</td>
                <td align="left" rowspan="1" colspan="1">in.table<break/>pop<break/>cores</td>
                <td align="left" rowspan="1" colspan="1">A data frame with eight columns: ‘query_chr’ (the query chromosome supplied to ‘chr’), ‘query_start’ (the query start coordinate supplied to ‘start’), ‘query_end’ (the query end coordinate supplied to ‘end’), ‘rsid1’ (variant one of two in the pair), ‘rsid2’ (variant two of two in the pair), r2 (r-squared statistic), d_prime (D′ statistic), population_name (the population supplied to ‘pop’).</td>
                <td align="left" rowspan="1" colspan="1">This function takes a data frame containing genomic coordinate(s) and retrieves LD metrics (D′ and R<sup>2</sup>) for all rsID within the defined region(s).</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
        <p>To make ensemblQueryR useful in a high-throughput context, the main challenge is that the Ensembl API endpoints are configured to handle single queries. To address this, ensemblQueryR’s three multi-query functions (with names ending in ‘Dataframe’, as described in Table <xref rid="gigabyte-2023-91-t001" ref-type="table">1</xref>) take data frame objects as input, where each row needs to be submitted as a separate query to the Ensembl API. The base R lapply function (Version 4.0.5) <styled-content style-type="bibr-wrapper">[<xref rid="ref14" ref-type="bibr">14</xref>]</styled-content> is then used to apply the corresponding single-query function over the ﻿input data frame, iteratively formulating an API query from each data frame row.</p>
        <p>Building on ensemblQueryR’s high-throughput capabilities, we implemented optional parallelisation for all multi-query functions. Each multi-query function (those with names ending in ‘Dataframe’ in Table <xref rid="gigabyte-2023-91-t001" ref-type="table">1</xref>) has an argument that allows the user to set a number of ‘cores’ to parallelise the query across. Using this functionality can significantly reduce run-time, particularly for larger queries where the parallelisation overheads represent a small proportion of the overall memory requirements. For example, with a query size of 1,000, the ensemblQueryLDwithSNPpairDataframe function running on a single core takes ∼2.4 min, whereas ten cores speed the process up by 22 times, reducing the execution time to ∼0.11 min (System tested on: Ubuntu server 16.04 LTS with kernel version 4.4.0-210-generic, total RAM 251G).</p>
        <p>Consistency of the data output format is an important feature of ensemblQueryR, making it amenable to R workflow integration. All functions (single- and multi-query) return a data frame object, including instances where the query returns a null result or an error. This consistent output format simplifies writing custom code, allowing users to incorporate ensemblQueryR functionality into bespoke workflows. It is important to note that when data cannot be retrieved, for example, if a variant is not found in Ensembl databases or the user input is invalid, console messages alert the user of this and a data frame row containing ‘NA’ values is returned for that query.</p>
      </sec>
      <sec id="s0005">
        <title>Benchmarking</title>
        <p>LDlinkR is an alternative R package that offers LD metric retrieval. As such, it was important to benchmark against this tool to demonstrate the utility of ensemblQueryR for high-throughput querying. Of the functions contained in the LDlinkR and ensemblQueryR packages, two functions are particularly comparable in their functionality. Both LDpair (from LDlinkR) and ensemblQueryLDwithSNPpair (from ensemblQueryR) take a pair of reference SNP cluster identifiers (rsIDs) as input, while the output is a table containing the LD metrics for the query pair. As such, these functions were selected for benchmarking. To compare the performance of the two functions, the computation speed and RAM usage at three query sizes representing a range of throughputs – 100, 1,000 and 10,000 queries – were assessed (Figure <xref rid="gigabyte-2023-91-g001" ref-type="fig">1</xref>). For each function and query size combination, performance (speed and peak RAM usage) was tested ten times to account for temporal ﻿fluctuations in ﻿processing ﻿speed and peak RAM usage, thus enabling a precise performance ﻿assessment.</p>
        <fig position="float" id="gigabyte-2023-91-g001">
          <label>Figure 1.</label>
          <caption>
            <p>Comparison of performance metrics between analogous functions of the ensemblQueryR and LDlinkR R packages. (a) Plot showing, for query sizes of 100, 1,000 and 10,000, the maximum RAM usage (mebibytes, MiB) during the execution of ensemblQueryR’s ensemblQueryLDwithSNPpair (red) and LDlinkR’s LDpair (blue). (b) Plot showing, for query sizes of 100, 1,000 and 10,000, the execution time (minutes, mins) of ensemblQueryR’s ensemblQueryLDwithSNPpair (red) and LDlinkR’s LDpair (blue).</p>
          </caption>
          <graphic xlink:href="gigabyte-2023-91-g001" position="float"/>
        </fig>
        <p> Firstly, comparing execution speed, we found that, on average (across the ten tests), ensemblQueryLDwithSNPpair was 10.2 times faster in the 100-query test, taking an average of 0.208 min compared to the 2.12 min for LDpair (Figure <xref rid="gigabyte-2023-91-g001" ref-type="fig">1</xref>b). The 1,000-query test found that ensemblQueryLDwithSNPpair was, on average, 9.92 times faster than LDlinkR, taking an average of 1.97 min compared to the 19.5 min for LDpair. Finally, in the 10,000-query test, LDpair was unable to produce a final results table in seven out of ten tests, in these instances returning an error message (‘Bad Gateway (HTTP 502)’). In contrast, ensemblQueryLDwithSNPpair produced a final results table in all tests, demonstrating its reliability for high-throughput querying. Looking at the only three successful tests of LDpair, we found that ensemblQueryLDwithSNPpair was, on average, 10.9 times faster than LDpair, taking an average of 18.5 min compared to the 202 min (&gt;3 h) for LDpair. These speed improvements are likely due to request rate limits from the server side, which are higher for Ensembl, thus enabling fast concurrent or parallel requests.</p>
        <p>Secondly, we compared the peak RAM usage – the maximum RAM utilised at any time during function execution – between ensemblQueryLDwithSNPpair and LDpair (Figure <xref rid="gigabyte-2023-91-g001" ref-type="fig">1</xref>a). We found that across query sizes, ensemblQueryLDwithSNPpair had approximately a third (range: 20.8–49.6%) of the peak RAM usage of LDpair. These peak RAM usage improvements are likely due to a focus on within-function reductions of intermediate object storage and a reduction of the number of operations carried out within the ensemblQueryLDwithSNPpair function.</p>
        <p>We conclude that, by comparing analogous functions (ensemblQueryLDwithSNPpair and LDpair), ensemblQueryR provides a performance improvement over LDlinkR with respect to both speed (×10) and memory usage (1/3), underscoring the utility of our tool in the context of high-throughput workflows.</p>
      </sec>
      <sec id="s0006">
        <title>Usage</title>
        <p>The following code provides an implementation example for ensemblQueryR. In this case, the target variant was taken from the OpenTargets homepage <styled-content style-type="bibr-wrapper">[<xref rid="ref15" ref-type="bibr">15</xref>]</styled-content> with rsID <ext-link xlink:href="https://identifiers.org/ensembl:rs4129267" ext-link-type="uri">rs4129267</ext-link>. To find out which variants, within a set of genomic window sizes, are in LD (R<sup>2</sup> &gt; 0.8 and D<italic toggle="yes">′</italic> &gt; 0.8) with the target variant, the ensemblQueryLDwithSNPWindow function was implemented as in Figure <xref rid="gigabyte-2023-91-g002" ref-type="fig">2</xref>.</p>
        <fig position="float" id="gigabyte-2023-91-g002">
          <label>Figure 2.</label>
          <caption>
            <p>Working example of an ensemblQueryR implementation.</p>
          </caption>
          <graphic xlink:href="gigabyte-2023-91-g002" position="float"/>
        </fig>
      </sec>
      <sec id="s0007">
        <title>Methods</title>
        <sec id="s0008">
          <title>Docker and singularity images</title>
          <p>In order to make this tool widely accessible to the research community, we have provided a Docker image (Figure <xref rid="gigabyte-2023-91-g003" ref-type="fig">3</xref>). It is based on a Rocker (RRID:<named-content content-type="rrid">SCR_024215</named-content>) <styled-content style-type="bibr-wrapper">[<xref rid="ref16" ref-type="bibr">16</xref>]</styled-content> with R version 4.0.0 and Ubuntu version 20.04 LTS (Focal Fossa) pre-installed. To start a container using the ‘ensemblqueryr’ Docker image and launch an interactive R session within which the tool can be used, the following command can be executed on the command line: </p>
          <p>
            <monospace>docker pull ainefairbrotherbrowne/ensemblqueryr:1.0; ∖</monospace>
          </p>
          <p>
            <monospace>docker run -t -d --name ensemblqueryr ainefairbrotherbrowne/ensemblqueryr:1.0; ∖</monospace>
          </p>
          <p>
            <monospace>docker exec -i -t ensemblqueryr R</monospace>
          </p>
          <p>To mount a local volume that contains a file of variant IDs, the following command can be used:</p>
          <p>
            <monospace>docker pull ainefairbrotherbrowne/ensemblqueryr:1.0; ∖</monospace>
          </p>
          <p>
            <monospace>docker run -t -d --name ensemblqueryr ainefairbrotherbrowne/ensemblqueryr:1.0 -- path/to/volume; ∖</monospace>
          </p>
          <p>
            <monospace>docker exec -i -t ensemblqueryr R</monospace>
          </p>
          <fig position="float" id="gigabyte-2023-91-g003">
            <label>Figure 3.</label>
            <caption>
              <p>Dockerfile containing the setup for the ensemblQueryR Docker image.</p>
            </caption>
            <graphic xlink:href="gigabyte-2023-91-g003" position="float"/>
          </fig>
          <p> Additionally, for use-cases wherein the user does not have sufficient permissions to use Docker, such as on HPC clusters, a singularity image can be used instead. To generate a singularity image, we converted the ensemblQueryR docker image <styled-content style-type="bibr-wrapper">[<xref rid="ref11" ref-type="bibr">11</xref>]</styled-content> into a singularity image using the Docker-based tool docker2singularity (Version 2.6) <styled-content style-type="bibr-wrapper">[<xref rid="ref17" ref-type="bibr">17</xref>]</styled-content>. This image can be found on the sylabs.io singularity repository <styled-content style-type="bibr-wrapper">[<xref rid="ref12" ref-type="bibr">12</xref>]</styled-content>. The singularity image can be pulled and executed, launching a command line R session as follows:</p>
          <p>
            <monospace>singularity pull --arch amd64 library://ainefairbrother/ensemblqueryr/ensemblqueryr:sha256.e387ea11ae4eaea8f94d81c625c2c1d5a22dd351858ebcd03910a7736d76ca30; ∖</monospace>
          </p>
          <p>
            <monospace>singularity exec ensemblqueryr_sha256.e387ea11ae4eaea8f94d81c625c2c1d5a22dd351858ebcd03910a7736d76ca30.sif R</monospace>
          </p>
        </sec>
        <sec id="s0009">
          <title>Benchmarking</title>
          <p>To benchmark our package against LDlinkR, we first selected functions that performed similar tasks. The most comparable functions in this context were LDlinkR’s ‘LDpair’ and ensemblQueryR’s ‘ensemblQueryLDwithSNPpair’. Both are configured for single queries and take a pair of variant IDs as input, retrieving the corresponding LD metrics through an API query. To run multiple queries using these single-query functions, both functions were applied over variant identifier (ID) vectors using the base R lapply (Version 4.0.5) <styled-content style-type="bibr-wrapper">[<xref rid="ref14" ref-type="bibr">14</xref>]</styled-content>.</p>
          <p>To compare the utility of these functions for LD metric querying in the context of high-throughput workflows, we measured the peak RAM usage and execution speed using the R package peakRAM (version 1.0.2) <styled-content style-type="bibr-wrapper">[<xref rid="ref18" ref-type="bibr">18</xref>]</styled-content> 10 times for each function and at three query sizes (100, 1,000 and 10,000). The standard deviation (sd) of the performance metric for each function at each time point across the ten iterations was calculated. Mean performance metrics were plotted with error bars to show the sd from the mean for peak RAM usage (Figure <xref rid="gigabyte-2023-91-g001" ref-type="fig">1</xref>a) and time measured in minutes (Figure <xref rid="gigabyte-2023-91-g001" ref-type="fig">1</xref>b) for the three query sizes.</p>
        </sec>
      </sec>
      <sec id="s0010">
        <title>Limitations</title>
        <p>It is important to note that there are some limitations to this R package. First, although this package enables high-throughput querying of the Ensembl API, there is an inherent limit to the number of queries that can be submitted arising from the API query limit, which is set at 54,000 requests per hour <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>, <xref rid="ref6" ref-type="bibr">6</xref>]</styled-content>. On the Ubuntu system used to develop ensemblQueryR (Ubuntu server 16.04 LTS with kernel version 4.4.0-210-generic, total RAM 251 G), 54,000 API requests via ensemblQueryLDwithSNPpairDataframe took ∼1.93 h on a single core, making the per-hour request rate 27,867. As such, even query sizes of 54,000 can be run unparallelised and are unlikely to exceed the Ensembl API hourly rate. However, this request limit must be considered by users when applying parallelisation to large queries. The second limitation is that the parallelisation library used to enable the multi-core functionality is the R package ‘parallel’ (version 3.6.2) <styled-content style-type="bibr-wrapper">[<xref rid="ref19" ref-type="bibr">19</xref>]</styled-content>, which works on OSIX systems (Mac, Linux and other Unix-based operating systems) but does not work on Windows.</p>
      </sec>
      <sec id="s0011">
        <title>Scope for future development</title>
        <p>At present, this package provides wrappers for the Ensembl API endpoints that retrieve LD data. However, the Ensembl API offers ∼109 other endpoints <styled-content style-type="bibr-wrapper">[<xref rid="ref5" ref-type="bibr">5</xref>]</styled-content>, all of which have the potential to be wrapped into R functions and included in this package. As such, there is scope for the usefulness of this package beyond LD metrics and further development will expand its utility to R users across an array of bioscience disciplines.</p>
      </sec>
    </sec>
  </sec>
  <sec id="s0012">
    <title>Availability of source code and requirements</title>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>Project name: ensemblQueryR</p>
        </list-item>
        <list-item>
          <p>Project home page: <ext-link xlink:href="https://github.com/ainefairbrother/ensemblQueryR" ext-link-type="uri" specific-use="url">https://github.com/ainefairbrother/ensemblQueryR</ext-link></p>
        </list-item>
        <list-item>
          <p>Operating system(s): Platform independent</p>
        </list-item>
        <list-item>
          <p>Programming language: R</p>
        </list-item>
        <list-item>
          <p>Licence: MIT</p>
        </list-item>
        <list-item>
          <p>RRID: <named-content content-type="rrid">SCR_024216</named-content>.</p>
        </list-item>
      </list>
    </p>
  </sec>
</body>
<back>
  <sec sec-type="data-availability" id="s0013">
    <title>Data Availability</title>
    <p>Snapshots of the code are available in GigaDB <styled-content style-type="bibr-wrapper">[<xref rid="ref20" ref-type="bibr">20</xref>]</styled-content>. </p>
  </sec>
  <sec id="s0014">
    <title>Abbreviations</title>
    <p>API, Application Programming Interface; eGene, expression of a cis or trans gene; eQTL: Expression Quantitative Trait Loci; GWAS: Genome-Wide Association Study; ID, identifier; LD: Linkage Disequilibrium; RAM: Random Access Memory; REST: Representational State Transfer; rsID: Reference SNP cluster IDs; sd: standard deviation. </p>
  </sec>
  <sec id="s0015">
    <title>Declarations</title>
    <sec id="s0016">
      <title>Ethical approval</title>
      <p>The authors declare that ethical approval was not required for this type of research.</p>
    </sec>
    <sec sec-type="COI-statement" id="s0017">
      <title>Competing Interests</title>
      <p>RHR is currently employed by CoSyne Therapeutics (Lead Bioinformatician). All work performed for this publication was performed in her own time, and not as a part of her duties as an employee.</p>
    </sec>
    <sec id="s0018">
      <title>Author contributions</title>
      <p>AFB and RHR: conceptualisation. AFB: software. AFB and SGR: docker image. AFB: benchmarking. AFB: writing - original draft. AFB, SGR, AH, MR and RHR: writing - review and editing. MR and AH: supervision.</p>
    </sec>
    <sec id="s0019">
      <title>Funding</title>
      <p>AFB was supported through the award of a Biotechnology and Biological Sciences Research Council (BBSRC UK) London Interdisciplinary Doctoral Fellowship. SGR and MR were supported through the award of a Tenure Track Clinician Scientist Fellowship to MR (MR/N008324/1). AH was funded by a BBSRC award (BB/R006075/1).</p>
    </sec>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="ref1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Slatkin</surname><given-names>M</given-names></name>. </person-group><article-title>Linkage disequilibrium — understanding the evolutionary past and mapping the medical future</article-title>. <source>Nat. Rev. Genet.</source>, <year>2008</year>; <volume>9</volume>: <fpage>477</fpage>–<lpage>485</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nrg2361</pub-id>.<pub-id pub-id-type="pmid">18427557</pub-id></mixed-citation>
    </ref>
    <ref id="ref2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bush</surname><given-names>WS</given-names></name>, <name><surname>Moore</surname><given-names>JH</given-names></name>. </person-group><article-title>Chapter 11: Genome-wide association studies</article-title>. <source>PLoS Comput. Biol.</source>, <year>2012</year>; <volume>8</volume>(<issue>12</issue>): <elocation-id content-type="artnum">e1002822</elocation-id>. doi:<pub-id pub-id-type="doi">10.1371/journal.pcbi.1002822</pub-id>.<pub-id pub-id-type="pmid">23300413</pub-id></mixed-citation>
    </ref>
    <ref id="ref3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Myers</surname><given-names>TA</given-names></name>, <name><surname>Chanock</surname><given-names>SJ</given-names></name>, <name><surname>Machiela</surname><given-names>MJ</given-names></name>. </person-group><article-title>LDlinkR: An R package for rapidly calculating linkage disequilibrium statistics in diverse populations</article-title>. <source>Front. Genet.</source>, <year>2020</year>; <volume>11</volume>: <elocation-id content-type="artnum">157</elocation-id>.<pub-id pub-id-type="pmid">32180801</pub-id></mixed-citation>
    </ref>
    <ref id="ref4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Machiela</surname><given-names>MJ</given-names></name>, <name><surname>Chanock</surname><given-names>SJ</given-names></name>. </person-group><article-title>LDlink: a web-based application for exploring population-specific haplotype structure and linking correlated alleles of possible functional variants</article-title>. <source>Bioinformatics</source>, <year>2015</year>; <volume>31</volume>(<issue>21</issue>): <fpage>3555</fpage>–<lpage>3557</lpage>. doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btv402</pub-id>.<pub-id pub-id-type="pmid">26139635</pub-id></mixed-citation>
    </ref>
    <ref id="ref5">
      <label>5</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><collab collab-type="corporate-author">Ensembl Rest API - Ensembl REST API Endpoints</collab></person-group>. <year>2015</year>; <ext-link xlink:href="https://rest.ensembl.org/" ext-link-type="uri" specific-use="url">https://rest.ensembl.org/</ext-link>. Accessed 5 Nov 2022.</mixed-citation>
    </ref>
    <ref id="ref6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yates</surname><given-names>A</given-names></name>, <name><surname>Beal</surname><given-names>K</given-names></name>, <name><surname>Keenan</surname><given-names>S</given-names></name><etal/></person-group><article-title>The ensembl REST API: Ensembl data for any language</article-title>. <source>Bioinformatics</source>, <year>2015</year>; <volume>31</volume>(<issue>1</issue>): <fpage>143</fpage>–<lpage>145</lpage>. doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btu613</pub-id>.<pub-id pub-id-type="pmid">25236461</pub-id></mixed-citation>
    </ref>
    <ref id="ref7">
      <label>7</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><name><surname>Fairbrother-Browne</surname><given-names>A</given-names></name>. </person-group>ensemblQueryR (Version 2.0.0). Zenodo, <year>23 May 2023</year>; <pub-id pub-id-type="doi">10.5281/zenodo.7837882</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref8">
      <label>8</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><name><surname>Fairbrother-Browne</surname><given-names>A</given-names></name>. </person-group>ensemblQueryR (Version 2.0.0). GitHub, <year>23 May 2023</year>; <ext-link xlink:href="https://github.com/ainefairbrother/ensemblQueryR" ext-link-type="uri" specific-use="url">https://github.com/ainefairbrother/ensemblQueryR</ext-link>.</mixed-citation>
    </ref>
    <ref id="ref9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Merkel</surname><given-names>D</given-names></name>. </person-group><article-title>Docker: lightweight Linux containers for consistent development and deployment</article-title>. <source>Linux J.</source>, <year>2014</year>; <volume>2014</volume>(<issue>239</issue>): <elocation-id content-type="artnum">2</elocation-id>.</mixed-citation>
    </ref>
    <ref id="ref10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kurtzer</surname><given-names>GM</given-names></name>, <name><surname>Sochat</surname><given-names>V</given-names></name>, <name><surname>Bauer</surname><given-names>MW</given-names></name>. </person-group><article-title>Singularity: Scientific containers for mobility of compute</article-title>. <source>PLOS One</source>, <year>2017</year>; <volume>12</volume>(<issue>5</issue>): <elocation-id content-type="artnum">e0177459</elocation-id>. doi:<pub-id pub-id-type="doi">10.1371/journal.pone.0177459</pub-id>.<pub-id pub-id-type="pmid">28494014</pub-id></mixed-citation>
    </ref>
    <ref id="ref11">
      <label>11</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><name><surname>Fairbrother-Browne</surname><given-names>A</given-names></name>. </person-group>ensemblqueryr (Version 1.0). Docker Hub, <year>22 May 2023</year>; <ext-link xlink:href="https://hub.docker.com/r/ainefairbrotherbrowne/ensemblqueryr" ext-link-type="uri" specific-use="url">https://hub.docker.com/r/ainefairbrotherbrowne/ensemblqueryr</ext-link>.</mixed-citation>
    </ref>
    <ref id="ref12">
      <label>12</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><name><surname>Fairbrother-Browne</surname><given-names>A</given-names></name>. </person-group>ensemblqueryr (Version 1.0). sylabs.io, <year>22 May 2023</year>; <ext-link xlink:href="https://cloud.sylabs.io/library/ainefairbrother/ensemblqueryr/ensemblqueryr" ext-link-type="uri" specific-use="url">https://cloud.sylabs.io/library/ainefairbrother/ensemblqueryr/ensemblqueryr</ext-link>.</mixed-citation>
    </ref>
    <ref id="ref13">
      <label>13</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><collab collab-type="corporate-author">Ensembl Population Frequencies &amp; Genotypes</collab></person-group>. <ext-link xlink:href="https://www.ensembl.org/info/genome/variation/species/populations.html" ext-link-type="uri" specific-use="url">https://www.ensembl.org/info/genome/variation/species/populations.html</ext-link>. Accessed 23 May 2023.</mixed-citation>
    </ref>
    <ref id="ref14">
      <label>14</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><collab collab-type="corporate-author">R Core</collab></person-group>. <article-title>R: A language and environment for statistical computing</article-title>, <year>2021</year>; Available at: <ext-link xlink:href="https://cran.r-project.org/doc/manuals/r-release/fullrefman.pdf" ext-link-type="uri" specific-use="url">https://cran.r-project.org/doc/manuals/r-release/fullrefman.pdf</ext-link>.</mixed-citation>
    </ref>
    <ref id="ref15">
      <label>15</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><collab collab-type="corporate-author">Open Targets Genetics</collab></person-group>. <ext-link xlink:href="https://genetics.opentargets.org/" ext-link-type="uri" specific-use="url">https://genetics.opentargets.org/</ext-link>. Accessed 23 May 2023.</mixed-citation>
    </ref>
    <ref id="ref16">
      <label>16</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boettiger</surname><given-names>C</given-names></name>, <name><surname>Eddelbuettel</surname><given-names>D</given-names></name>. </person-group><article-title>An introduction to Rocker: Docker containers for R</article-title>. <source>R J.</source>, <year>2017</year>; <volume>9</volume>(<issue>2</issue>): <fpage>527</fpage>–<lpage>536</lpage>. doi:<pub-id pub-id-type="doi">10.32614/RJ-2017-065</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref17">
      <label>17</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><collab collab-type="corporate-author">Singularity Hub</collab></person-group>. Docker2singularity (Version 2.6), <year>2018</year>; <ext-link xlink:href="https://github.com/singularityhub/docker2singularity/releases/tag/v2.6-release" ext-link-type="uri" specific-use="url">https://github.com/singularityhub/docker2singularity/releases/tag/v2.6-release</ext-link>.</mixed-citation>
    </ref>
    <ref id="ref18">
      <label>18</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><name><surname>Quinn</surname><given-names>T</given-names></name>. </person-group>peakRAM (Version 1.0.2), <year>2017</year>; <ext-link xlink:href="https://cran.r-project.org/web/packages/peakRAM/vignettes/peakRAM.html" ext-link-type="uri" specific-use="url">https://cran.r-project.org/web/packages/peakRAM/vignettes/peakRAM.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="ref19">
      <label>19</label>
      <mixed-citation publication-type="misc"><person-group person-group-type="author"><collab collab-type="corporate-author">R-core</collab>. Parallel (Version 3.6.2), </person-group><year>2023</year>; <ext-link xlink:href="https://www.rdocumentation.org/packages/parallel/versions/3.6.2" ext-link-type="uri" specific-use="url">https://www.rdocumentation.org/packages/parallel/versions/3.6.2</ext-link>.</mixed-citation>
    </ref>
    <ref id="ref20">
      <label>20</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fairbrother-Browne</surname><given-names>A</given-names></name>, <name><surname>García-Ruiz</surname><given-names>S</given-names></name>, <name><surname>Reynolds</surname><given-names>RH</given-names></name><etal/></person-group><article-title>Supporting data for “ensemblQueryR: fast, flexible and high-throughput querying of Ensembl API LD endpoints in R”</article-title>. <source>GigaScience Database</source>, <year>2023</year>; <pub-id pub-id-type="doi">10.5524/102435</pub-id>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="author-comment" id="d1e1808">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Article Submission</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Fairbrother-Browne</surname>
            <given-names>Aine</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Author</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>23</day>
          <month>5</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>23</day>
          <month>5</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e1814">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Assign Handling Editor</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Edmunds</surname>
            <given-names>Scott</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Editor in Chief</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>25</day>
          <month>5</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>25</day>
          <month>5</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e1820">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Editor Assess MS</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Zhang</surname>
            <given-names>Hongfang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Handling Editor</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>25</day>
          <month>5</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>26</day>
          <month>5</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e1826">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Curator Assess MS</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Armit</surname>
            <given-names>Chris</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Curator</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>26</day>
          <month>5</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>26</day>
          <month>5</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="reviewer-report" id="d1e1832">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Review MS</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Khan</surname>
            <given-names>Aziz</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Reviewer 1</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>30</day>
          <month>6</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>09</day>
          <month>8</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
  <body>
    <p>
      <array>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">Reviewer name and names of any other individual's who aided in reviewer</td>
            <td rowspan="1" colspan="1">Aziz Khan</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Do you understand and agree to our policy of having open and named reviews, and having your review included with the published manuscript. (If no, please inform the editor that you cannot review this manuscript.)</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the language of sufficient quality?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Please add additional comments on language quality to clarify if needed</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there a clear statement of need explaining what problems the software is designed to solve and who the target audience is? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the source code available, and has an appropriate Open Source Initiative license &lt;a href="https://opensource.org/licenses" target="_blank"&gt;(https://opensource.org/licenses)&lt;/a&gt; been assigned to the code?</td>
            <td rowspan="1" colspan="1">No</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1">There are two license files (the LICENSE, LICENSE.md) and both are conflicting. The authors should use one to make sure it is an appropriate Open Source Initiative license.</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">As Open Source Software are there guidelines on how to contribute, report issues or seek support on the code?</td>
            <td rowspan="1" colspan="1">No</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1">There are no guidelines on how to contribute.</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the code executable?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is installation/deployment sufficiently outlined in the paper and documentation, and does it proceed as outlined?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1">Installation was straightforward.</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the documentation provided clear and user friendly?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there enough clear information in the documentation to install, run and test this tool, including information on where to seek help if required?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there a clearly-stated list of dependencies, and is the core functionality of the software documented to a satisfactory level?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1">The DESCRIPTION file has all the required packages. </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Have any claims of performance been sufficiently tested and compared to other commonly-used packages? </td>
            <td rowspan="1" colspan="1">No</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Are there (ideally real world) examples demonstrating use of the software? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1">There are some use cases in the minimal documentation. Some of these are not working. </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is automated testing used or are there manual steps described so that the functionality of the software can be verified?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1">The package is already in the CRAN, which means it passed its checks. It does have example snippets of code to be run. </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Any Additional Overall Comments to the Author</td>
            <td rowspan="1" colspan="1">The ensemblQueryR package offers an R interface for querying Ensembl REST API linkage disequilibrium (LD) endpoints. The package aims to support high-throughput querying, utilizing familiar R object types and parallelization. The package is already in CRAN and comes with Docker/Singularity options. While the paper highlights notable strengths, such as the R interface, high-throughput support, parallelization, and performance improvements, a few points warrant further consideration and clarification.&#13; &#13; (1). The package is already in CRAN, which is good, but there are issues with the use-case examples. When I executed the test case to query LD metrics for a variant within a window, the package returned a tibble containing NAs.&#13; (2). The title claims the package supports querying "several" Ensembl API endpoints, but the current version is limited to LD endpoints. Revising the title to reflect the package's current capabilities accurately is recommended.&#13; (3). Two conflicting license files exist (the LICENSE, LICENSE.md). The authors should select one to ensure it aligns with an appropriate Open Source Initiative license. Additionally, there are no guidelines provided for contributing to the project.&#13; (4). I have encountered this R package to get Ensembl data in R using the REST API - https://github.com/dwinter/rensembl. Can the authors comment on this? </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Recommendation</td>
            <td rowspan="1" colspan="1">Minor Revisions</td>
          </tr>
        </tbody>
      </array>
    </p>
  </body>
</sub-article>
<sub-article article-type="reviewer-report" id="d1e1838">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Review MS</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Yates</surname>
            <given-names>Andrew</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Reviewer 2</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>30</day>
          <month>6</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>30</day>
          <month>6</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
  <body>
    <p>
      <array>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">Reviewer name and names of any other individual's who aided in reviewer</td>
            <td rowspan="1" colspan="1">Andy Yates</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Do you understand and agree to our policy of having open and named reviews, and having your review included with the published manuscript. (If no, please inform the editor that you cannot review this manuscript.)</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the language of sufficient quality?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Please add additional comments on language quality to clarify if needed</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there a clear statement of need explaining what problems the software is designed to solve and who the target audience is? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the source code available, and has an appropriate Open Source Initiative license &lt;a href="https://opensource.org/licenses" target="_blank"&gt;(https://opensource.org/licenses)&lt;/a&gt; been assigned to the code?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">As Open Source Software are there guidelines on how to contribute, report issues or seek support on the code?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1">Whilst nothing explicit is there the code is hosted on GitHub &amp; therefore using the issue tracker would appear to be the right way to do this</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the code executable?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is installation/deployment sufficiently outlined in the paper and documentation, and does it proceed as outlined?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is the documentation provided clear and user friendly?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there enough clear information in the documentation to install, run and test this tool, including information on where to seek help if required?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is there a clearly-stated list of dependencies, and is the core functionality of the software documented to a satisfactory level?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Have any claims of performance been sufficiently tested and compared to other commonly-used packages? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is test data available, either included with the submission or openly available via cited third party sources (e.g. accession numbers, data DOIs)?</td>
            <td rowspan="1" colspan="1">No</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1">The code uses data from Ensembl so this is somewhat sufficient and uses rsIDs</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Are there (ideally real world) examples demonstrating use of the software? </td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Is automated testing used or are there manual steps described so that the functionality of the software can be verified?</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Additional Comments</td>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Any Additional Overall Comments to the Author</td>
            <td rowspan="1" colspan="1">The authors present in their manuscript “ensemblQueryR: fast, flexible and high-throughput querying of Ensembl API endpoints in R”; a library for the popular R programming language and specifically addresses fast retrieval of linkage disequilibrium from Ensembl’s REST APIs. The toolkit provides a convenient set of functions which mediates queries into the Ensembl REST API and presents results in a manner which is optimised and familiar for R users.&#13; &#13; Overall I find the manuscript good and provides a useful toolkit for R developers. It is pleasing to see more people use the Ensembl REST APIs and to expand its user base. The analysis benchmarks also appear appropriate. I have only two minor comments.&#13; &#13; 1. Code examples&#13; &#13; Whilst I was able to execute the given example I did encounter some issues. Namely that when executing the code&#13; &#13; ensemblQueryR::ensemblQueryLDwithSNPwindow(rsid="rs4129267", r2=0.8, d.prime=0.8, window.size=500, pop="1000GENOMES:phase_3:EUR")&#13; &#13; I got the following result&#13; &#13; query snp_in_ld r2 d_prime population_name&#13; &lt;chr&gt; &lt;lgl&gt; &lt;lgl&gt; &lt;lgl&gt; &lt;lgl&gt;&#13; 1 rs4129267 NA NA NA NA&#13; &#13; It was disconcerting to not get any results back and now I am unsure if I did the right thing. I then found the GitHub repository was a far better reference for the correct commands to run and would encourage perhaps less information in the manuscript and the authors pointing readers to the GitHub repository or the site https://ainefairbrother.github.io/ensemblQueryR/.&#13; &#13; 2. Extensions&#13; &#13; The authors suggest possible extensions to ensemblQueryR but it would be useful to know if there are any specific developments planned by the authors. </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Recommendation</td>
            <td rowspan="1" colspan="1">Minor Revisions</td>
          </tr>
        </tbody>
      </array>
    </p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="d1e1845">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Editor Decision</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Zhang</surname>
            <given-names>Hongfang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Handling Editor</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>09</day>
          <month>8</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>09</day>
          <month>8</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="author-comment" id="d1e1549">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Minor Revision</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Fairbrother-Browne</surname>
            <given-names>Aine</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Author</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>11</day>
          <month>8</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>11</day>
          <month>8</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e1555">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Assess Revision</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Zhang</surname>
            <given-names>Hongfang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Handling Editor</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>11</day>
          <month>8</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>13</day>
          <month>8</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e1561">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Final Data Preparation</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Armit</surname>
            <given-names>Chris</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Curator</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>15</day>
          <month>8</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>15</day>
          <month>8</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e1567">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Editor Decision</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Zhang</surname>
            <given-names>Hongfang</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Handling Editor</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>15</day>
          <month>8</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>11</day>
          <month>9</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
<sub-article article-type="editor-report" id="d1e1573">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Accept</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Edmunds</surname>
            <given-names>Scott</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Editor in Chief</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>11</day>
          <month>9</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>11</day>
          <month>9</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
  <body>
    <p>
      <array>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">Editor’s Assessment</td>
            <td rowspan="1" colspan="1">ENSEMBL is a crucial resource for the vertebrate genomics community. And ensemblQueryR is an R interface to the Ensembl API that facilitates flexible, fast, user-friendly and R workflow integrable querying of the database linkage disequilibrium endpoints. It’s been presented as easy to deploy, and after some debugging the work demonstrate that ensemblQueryR has improved performance memory usage and speed, delivering a 10-fold speed increase over analogous software whilst using a third of the RAM. As the Ensembl API offers &gt;100 other endpoints, all of these have the potential to be wrapped into R functions and included in this package.</td>
          </tr>
        </tbody>
      </array>
    </p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="d1e1579">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">GigaByte</journal-id>
      <journal-id journal-id-type="iso-abbrev">GigaByte</journal-id>
      <journal-id journal-id-type="publisher-id">Gigabyte</journal-id>
      <journal-title-group>
        <journal-title>GigaByte</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2709-4715</issn>
      <publisher>
        <publisher-name>Gigascience Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>Export to Production</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Edmunds</surname>
            <given-names>Scott</given-names>
            <prefix>Dr</prefix>
          </name>
          <role>Editor in Chief</role>
        </contrib>
      </contrib-group>
      <history>
        <date date-type="event_start_date">
          <day>11</day>
          <month>9</month>
          <year>2023</year>
        </date>
        <date date-type="event_complete_date">
          <day>11</day>
          <month>9</month>
          <year>2023</year>
        </date>
      </history>
    </article-meta>
  </front>
</sub-article>
