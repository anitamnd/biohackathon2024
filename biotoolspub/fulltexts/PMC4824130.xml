<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d1 20130915//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4824130</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btv735</article-id>
    <article-id pub-id-type="publisher-id">btv735</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>DNAshapeR: an R/Bioconductor package for DNA shape prediction and feature encoding</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Chiu</surname>
          <given-names>Tsu-Pei</given-names>
        </name>
        <xref ref-type="aff" rid="btv735-aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="author-notes" rid="btv735-FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Comoglio</surname>
          <given-names>Federico</given-names>
        </name>
        <xref ref-type="aff" rid="btv735-aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="author-notes" rid="btv735-FN1">
          <sup>†</sup>
        </xref>
        <xref ref-type="author-notes" rid="btv735-FN2">
          <sup>‡</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhou</surname>
          <given-names>Tianyin</given-names>
        </name>
        <xref ref-type="aff" rid="btv735-aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="author-notes" rid="btv735-FN3">
          <sup>§</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>Lin</given-names>
        </name>
        <xref ref-type="aff" rid="btv735-aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Paro</surname>
          <given-names>Renato</given-names>
        </name>
        <xref ref-type="aff" rid="btv735-aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="btv735-aff3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rohs</surname>
          <given-names>Remo</given-names>
        </name>
        <xref ref-type="aff" rid="btv735-aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="btv735-cor1">*</xref>
      </contrib>
      <aff id="btv735-aff1"><sup>1</sup>Molecular and Computational Biology Program, Departments of Biological Sciences, Chemistry, Physics, and Computer Science, University of Southern California, Los Angeles, CA 90089, USA, </aff>
      <aff id="btv735-aff2"><sup>2</sup>Department of Biosystems Science and Engineering, ETH Zürich, Mattenstrasse 26, 4058 Basel, Switzerland and </aff>
      <aff id="btv735-aff3"><sup>3</sup>Faculty of Science, University of Basel, Klingelbergstrasse 50, 4056 Basel, Switzerland</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btv735-cor1">*To whom correspondence should be addressed.</corresp>
      <fn id="btv735-FN1">
        <p><sup>†</sup>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
      </fn>
      <fn id="btv735-FN2">
        <p><sup>‡</sup>Present address: Cambridge Institute for Medical Research, Wellcome Trust/MRC Stem Cell Institute, University of Cambridge, Cambridge CB2 0XY, UK</p>
      </fn>
      <fn id="btv735-FN3">
        <p><sup>§</sup>Present address: Google Inc., 1600 Amphitheatre Parkway, Mountain View, CA 94043, USA</p>
      </fn>
      <fn id="btv735-FN4">
        <p>Associate Editor: John Hancock</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>4</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>12</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>12</month>
      <year>2015</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>32</volume>
    <issue>8</issue>
    <fpage>1211</fpage>
    <lpage>1213</lpage>
    <history>
      <date date-type="received">
        <day>01</day>
        <month>11</month>
        <year>2015</year>
      </date>
      <date date-type="rev-recd">
        <day>08</day>
        <month>12</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>09</day>
        <month>12</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2015. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2015</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by-nc/4.0/" license-type="creative-commons">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> DNAshapeR predicts DNA shape features in an ultra-fast, high-throughput manner from genomic sequencing data. The package takes either nucleotide sequence or genomic coordinates as input and generates various graphical representations for visualization and further analysis. DNAshapeR further encodes DNA sequence and shape features as user-defined combinations of <italic>k</italic>-mer and DNA shape features. The resulting feature matrices can be readily used as input of various machine learning software packages for further modeling studies.</p>
      <p><bold>Availability and implementation:</bold> The DNAshapeR software package was implemented in the statistical programming language R and is freely available through the Bioconductor project at <ext-link ext-link-type="uri" xlink:href="https://www.bioconductor.org/packages/devel/bioc/html/DNAshapeR.html">https://www.bioconductor.org/packages/devel/bioc/html/DNAshapeR.html</ext-link> and at the GitHub developer site, <ext-link ext-link-type="uri" xlink:href="http://tsupeichiu.github.io/DNAshapeR/">http://tsupeichiu.github.io/DNAshapeR/</ext-link>.</p>
      <p>
        <bold>Contact:</bold>
        <email>rohs@usc.edu</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv735/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Two distinct readout modes have emerged as crucial components of protein–DNA recognition (<xref rid="btv735-B1" ref-type="bibr">Abe <italic>et al.</italic>, 2015</xref>). These modes include sequence-based readout of direct contacts with the functional groups of the bases (base readout) and structure-based readout of intrinsic deviations from a canonical double helix (shape readout). DNA shape readout was originally described based on the analysis of co-crystal structures of protein–DNA complexes. Studies of DNA shape readout were then extended to massive datasets of protein-interacting DNA sequences via the use of DNAshape, a method for the high-throughput prediction of DNA structural features (<xref rid="btv735-B7" ref-type="bibr">Zhou <italic>et al.</italic>, 2013</xref>). Using DNAshape as the underlying tool, a motif database for transcription factor (TF) binding sites, TFBSshape (<xref rid="btv735-B6" ref-type="bibr">Yang <italic>et al.</italic>, 2014</xref>) and a genome browser database for DNA shape annotations, GBshape (<xref rid="btv735-B2" ref-type="bibr">Chiu <italic>et al.</italic>, 2015</xref>), were developed.</p>
    <p>Rules that determine the binding affinity between TFs and their binding sites can be statistically learned from the data derived from <italic>in vitro</italic> high-throughput binding assays. Although sequence-based methods have long been used to model TF binding specificities, high-throughput prediction of DNA shape enabled us to develop methods that leverage both DNA sequence and shape information. Trained with either linear regression or support vector regression algorithms, shape-augmented models were consistently shown to outperform sequence-based methods in modeling the <italic>in vitro</italic> binding of TFs quantitatively (<xref rid="btv735-B8" ref-type="bibr">Zhou <italic>et al.</italic>, 2015</xref>).</p>
    <p>DNAshape is currently released as a stand-alone web service (<xref rid="btv735-B7" ref-type="bibr">Zhou <italic>et al.</italic>, 2013</xref>). Its pre-defined functionality and internet bandwidth-bounded performance made it difficult to use in genome-wide studies. To address these issues, we developed DNAshapeR, an R/Bioconductor package that can generate DNA shape predictions in an easy-to-use, easy-to-integrate and easy-to-extend manner. The output can be readily integrated into other high-throughput genomic analysis platforms.</p>
  </sec>
  <sec>
    <title>2 High-throughput DNA shape prediction</title>
    <p>The core of DNAshapeR is the DNAshape prediction method (<xref rid="btv735-B7" ref-type="bibr">Zhou <italic>et al.</italic>, 2013</xref>), which uses a sliding pentamer window to derive the structural features minor groove width (MGW), helix twist (HelT), propeller twist (ProT) and Roll (<xref ref-type="fig" rid="btv735-F1">Fig. 1</xref>) from all-atom Monte Carlo simulations. These DNA shape features were observed in various cocrystal structures as playing an important role in achieving protein–DNA binding specificity. High-throughput predictions of DNA shape have shed light on the DNA binding specificity of TFs (<xref rid="btv735-B4" ref-type="bibr">He <italic>et al.</italic>, 2015</xref>; <xref rid="btv735-B5" ref-type="bibr">Murphy <italic>et al.</italic>, 2015</xref>) and were shown to be predictive of replication origins (<xref rid="btv735-B3" ref-type="bibr">Comoglio <italic>et al.</italic>, 2015</xref>).
<fig id="btv735-F1" orientation="portrait" position="float"><label>Fig. 1.</label><caption><p>Flowchart of DNAshapeR analysis. The input data can be either nucleotide sequence(s) in FASTA file format or genomic intervals, provided by the user in BED format or derived from public databases. The core of DNAshapeR includes a high-throughput approach for the prediction of DNA shape features. MGW, HelT, ProT and Roll can then be visualized in the form of plots, heat maps or genome browser tracks or used for the assembly of feature vectors of user-defined combinations of <italic>k</italic>-mer and shape features</p></caption><graphic xlink:href="btv735f1p"/></fig>
</p>
    <p>The DNAshapeR package enables ultra-fast, high-throughput predictions of shape features for thousands of genomic sequences and generates various graphical outputs of the data (<xref ref-type="fig" rid="btv735-F1">Fig. 1</xref>; <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv735/-/DC1">Supplementary Data</ext-link>). The modular design of DNAshapeR enables the expansion to additional features, such as conformational flexibility, biophysical properties and methylation status, to be added in future releases of the DNAshapeR package.</p>
  </sec>
  <sec>
    <title>3 DNA shape and <italic>k</italic>-mer feature encoding</title>
    <p>Besides DNA shape predictions and data visualization, DNAshapeR can also be used to generate feature vectors for user-defined models. These models consist of sequence features (1mer, 2mer, 3mer), shape features (MGW, Roll, ProT, HelT) or any combination of those features (<xref ref-type="fig" rid="btv735-F1">Fig. 1</xref>; <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv735/-/DC1">Supplementary Data</ext-link>). DNAshapeR encodes sequence as binary features. DNA shape features are normalized by default and can include second-order shape features. The detailed definitions of sequence and shape features were provided in an earlier study (<xref rid="btv735-B8" ref-type="bibr">Zhou <italic>et al.</italic>, 2015</xref>).</p>
    <p>The feature encoding function of DNAshapeR enables the generation of any user-defined subset of these features. The result of the feature encoding for each sequence is a chimera feature vector. Feature encoding of multiple sequences thus results in a feature matrix, which can be used as input for a variety of statistical machine learning methods.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the <funding-source>NIH</funding-source> (<award-id>R01GM106056</award-id>, <award-id>R01HG003008</award-id> in part, and <award-id>U01GM103804</award-id> to R.R.). Open-source software release and open-access publication were supported by the NSF (<award-id>MCB-1413539</award-id> to R.R.). R.R. is an Alfred P. Sloan Research Fellow.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_32_8_1211__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btv735_btv735_supplementary_data.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="btv735-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abe</surname><given-names>N</given-names></name></person-group><etal/> (<year>2015</year>) <article-title>Deconvolving the recognition of DNA shape from sequence</article-title>. <source>Cell</source>, <volume>161</volume>, <fpage>307</fpage>–<lpage>318</lpage>.<pub-id pub-id-type="pmid">25843630</pub-id></mixed-citation>
    </ref>
    <ref id="btv735-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chiu</surname><given-names>T.P</given-names></name></person-group><etal/> (<year>2015</year>) <article-title>GBshape: a genome browser database for DNA shape annotations</article-title>. <source>Nucleic Acids Res</source>, <volume>43</volume>, <fpage>D103</fpage>–<lpage>D109</lpage>.<pub-id pub-id-type="pmid">25326329</pub-id></mixed-citation>
    </ref>
    <ref id="btv735-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Comoglio</surname><given-names>F</given-names></name></person-group><etal/> (<year>2015</year>) <article-title>High-resolution profiling of <italic>Drosophila</italic> replication start sites reveals a DNA shape and chromatin signature of metazoan origins</article-title>. <source>Cell Rep</source>., <volume>11</volume>, <fpage>821</fpage>–<lpage>834</lpage>.<pub-id pub-id-type="pmid">25921534</pub-id></mixed-citation>
    </ref>
    <ref id="btv735-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>He</surname><given-names>Q.</given-names></name></person-group><etal/> (<year>2015</year>) <article-title>ChIP-nexus enables improved detection of in vivo transcription factor binding footprints</article-title>. <source>Nat. Biotechnol</source>., <volume>33</volume>, <fpage>395</fpage>–<lpage>401</lpage>.<pub-id pub-id-type="pmid">25751057</pub-id></mixed-citation>
    </ref>
    <ref id="btv735-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Murphy</surname><given-names>M.W</given-names></name></person-group><etal/> (<year>2015</year>) <article-title>An ancient protein-DNA interaction underlying metazoan sex determination</article-title>. <source>Nat. Struct. Mol. Biol</source>., <volume>22</volume>, <fpage>442</fpage>–<lpage>451</lpage>.<pub-id pub-id-type="pmid">26005864</pub-id></mixed-citation>
    </ref>
    <ref id="btv735-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>L</given-names></name></person-group><etal/> (<year>2014</year>) <article-title>TFBSshape: a motif database for DNA shape features of transcription factor binding sites</article-title>. <source>Nucleic Acids Res</source>., <volume>42</volume>(Database issue), <fpage>D148</fpage>–<lpage>D155</lpage>.<pub-id pub-id-type="pmid">24214955</pub-id></mixed-citation>
    </ref>
    <ref id="btv735-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>T</given-names></name></person-group><etal/> (<year>2013</year>) <article-title>DNAshape: a method for the high-throughput prediction of DNA structural features on a genomic scale</article-title>. <source>Nucleic Acids Res</source>., <volume>41</volume> (Web Server issue), <fpage>W56</fpage>–<lpage>W62</lpage>.<pub-id pub-id-type="pmid">23703209</pub-id></mixed-citation>
    </ref>
    <ref id="btv735-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>T</given-names></name></person-group><etal/> (<year>2015</year>) <article-title>Quantitative modeling of transcription factor binding specificities using DNA shape</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>112</volume>, <fpage>4654</fpage>–<lpage>4659</lpage>.<pub-id pub-id-type="pmid">25775564</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
