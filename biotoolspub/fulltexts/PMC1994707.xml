<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.0 20040830//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Genet</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Genet</journal-id>
    <journal-id journal-id-type="publisher-id">pgen</journal-id>
    <journal-id journal-id-type="publisher-id">plge</journal-id>
    <journal-id journal-id-type="pmc">plosgen</journal-id>
    <journal-title-group>
      <journal-title>PLoS Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-7390</issn>
    <issn pub-type="epub">1553-7404</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">1994707</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pgen.0030161</article-id>
    <article-id pub-id-type="publisher-id">07-PLGE-RA-0237R2</article-id>
    <article-id pub-id-type="sici">plge-03-09-20</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline">
        <subject>Computational Biology</subject>
      </subj-group>
      <subj-group subj-group-type="System Taxonomy">
        <subject>Homo (Human)</subject>
        <subject>Saccharomyces</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Capturing Heterogeneity in Gene Expression Studies by Surrogate Variable Analysis</article-title>
      <alt-title alt-title-type="running-head">Surrogate Variable Analysis</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Leek</surname>
          <given-names>Jeffrey T</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Storey</surname>
          <given-names>John D</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">1</xref>
        <xref ref-type="aff" rid="aff2">2</xref>
        <xref ref-type="corresp" rid="cor1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff1"><label>1</label> Department of Biostatistics, University of Washington, Seattle, Washington, United States of America
</aff>
    <aff id="aff2"><label>2</label> Department of Genome Sciences, University of Washington, Seattle, Washington, United States of America
</aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Gibson</surname>
          <given-names>Greg</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">North Carolina State University, United States of America</aff>
    <author-notes>
      <corresp id="cor1">* To whom correspondence should be addressed. E-mail: <email>jstorey@u.washington.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>9</month>
      <year>2007</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>9</month>
      <year>2007</year>
    </pub-date>
    <pub-date pub-type="epreprint">
      <day>1</day>
      <month>8</month>
      <year>2007</year>
    </pub-date>
    <volume>3</volume>
    <issue>9</issue>
    <elocation-id>e161</elocation-id>
    <history>
      <date date-type="received">
        <day>9</day>
        <month>4</month>
        <year>2007</year>
      </date>
      <date date-type="accepted">
        <day>1</day>
        <month>8</month>
        <year>2007</year>
      </date>
    </history>
    <permissions>
      <copyright-statement><bold>Copyright:</bold> © 2007 Leek and Storey. This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</copyright-statement>
      <copyright-year>2007</copyright-year>
    </permissions>
    <!--<related-article preprintResearch Article10.1371/journal.pgen.0030161.eorRA1doisimple>Capturing Heterogeneity in Gene Expression Studies by Surrogate Variable Analysis</related-article>-->
    <abstract>
      <p>It has unambiguously been shown that genetic, environmental, demographic, and technical factors may have substantial effects on gene expression levels. In addition to the measured variable(s) of interest, there will tend to be sources of signal due to factors that are unknown, unmeasured, or too complicated to capture through simple models. We show that failing to incorporate these sources of heterogeneity into an analysis can have widespread and detrimental effects on the study. Not only can this reduce power or induce unwanted dependence across genes, but it can also introduce sources of spurious signal to many genes. This phenomenon is true even for well-designed, randomized studies. We introduce “surrogate variable analysis” (SVA) to overcome the problems caused by heterogeneity in expression studies. SVA can be applied in conjunction with standard analysis techniques to accurately capture the relationship between expression and any modeled variables of interest. We apply SVA to disease class, time course, and genetics of gene expression studies. We show that SVA increases the biological accuracy and reproducibility of analyses in genome-wide expression studies.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author Summary</title>
      <sec id="st1">
        <title/>
        <p>In scientific and medical studies, great care must be taken when collecting data to understand the relationship between two variables, such as a drug and its effect on a disease. In any given study there will be many other variables at play, such as the effects of age and sex on the disease. We show that in studies where the expression levels of thousands of genes are measured at once, these issues become surprisingly critical. Due to the complexity of our genomes, environment, and demographic features, there are many sources of variation when analyzing gene expression levels. In any given study, it is impossible to measure every single variable that may be influencing how our genes are expressed. Despite this, we show that by considering all expression levels simultaneously, one can actually recover the effects of these important missed variables and essentially produce an analysis as if all relevant variables were included. As opposed to traditional studies, the massive amount of data available in this setting is what makes the method, called surrogate variable analysis, possible. We hypothesize that surrogate variable analysis will be useful in many large-scale gene expression studies.</p>
      </sec>
    </abstract>
    <counts>
      <page-count count="12"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>citation</meta-name>
        <meta-value>Leek JT, Storey JD (2007) Capturing heterogeneity in gene expression studies by surrogate variable analysis. PLoS Genet 3(9): e161. doi:<ext-link ext-link-type="doi" xlink:href="10.1371/journal.pgen.0030161">10.1371/journal.pgen.0030161</ext-link></meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>Large-scale gene expression studies allow one to characterize transcriptional variation with respect to measured variables of interest, such as differing environments, treatments, time points, phenotypes, or clinical outcomes. However, a number of unmeasured or unmodeled factors may also influence the expression of any particular gene. Besides inducing widespread dependence in measurements across genes [<xref rid="pgen-0030161-b001" ref-type="bibr">1</xref>,<xref rid="pgen-0030161-b002" ref-type="bibr">2</xref>], these influential factors create additional sources of differential expression, which, unlike gene-specific fluctuations, represent common sources of variation in gene expression that can be observed among multiple genes.</p>
    <p>We call “primary measured variables” (or primary variables) those variables that are explicitly modeled in the analysis of an expression study. These variables may or may not be associated with any given gene's expression variation. We classify all the remaining sources of expression variation into three basic types. “Unmodeled factors” are sources of variation explained by measured variables, but are not explicitly included in the statistical model (e.g., because their relationship to expression is intractable or the relevant measured variables were excluded because of sample size restrictions). “Unmeasured factors” are sources of expression variation that are not measured in the course of the study, so we also call these unmodeled factors. Finally, “gene-specific noise” refers to random fluctuations in gene expression independently realized from gene to gene.</p>
    <p>As a simple example meant only for illustrative purposes, consider a human expression study where disease state on a particular tissue type is the primary variable. Suppose that in addition to changes in expression being associated with disease state, the age of the individuals also has a substantial influence on expression. Thus, some genes exhibit differential expression with respect to disease state, some with respect to age, and some with respect to both. If age is not included in the model when identifying differential expression with respect to disease state, we show that this may (a) induce extra variability in the expression levels due to the effect of age, decreasing our power to detect associations with disease state, (b) introduce spurious signal due to the fact that the effect of age on expression may be confounded with disease state, or (c) induce long-range dependence in the apparent “noise” of the expression data, complicating any assessment of statistical significance for differential expression. In practice, even if age were known, it may be one of dozens of available measured factors, making it statistically intractable to determine which to include in the model. Furthermore, even measured factors such as age may act on distinct sets of genes in different ways, or may interact with an unobserved factor, making the effect of age on expression difficult to model. “Expression heterogeneity” (EH) is used here to describe patterns of variation due to any unmodeled factor.</p>
    <p>Major sources of expression variation are due to technical [<xref rid="pgen-0030161-b003" ref-type="bibr">3</xref>,<xref rid="pgen-0030161-b004" ref-type="bibr">4</xref>], environmental [<xref rid="pgen-0030161-b005" ref-type="bibr">5</xref>,<xref rid="pgen-0030161-b006" ref-type="bibr">6</xref>], demographic [<xref rid="pgen-0030161-b007" ref-type="bibr">7</xref>,<xref rid="pgen-0030161-b008" ref-type="bibr">8</xref>], or genetic [<xref rid="pgen-0030161-b009" ref-type="bibr">9</xref>–<xref rid="pgen-0030161-b011" ref-type="bibr">11</xref>] factors. It is well known that sources of variation due to experimental design or large-scale systematic sources of signal may be present in expression data [<xref rid="pgen-0030161-b003" ref-type="bibr">3</xref>,<xref rid="pgen-0030161-b004" ref-type="bibr">4</xref>,<xref rid="pgen-0030161-b012" ref-type="bibr">12</xref>,<xref rid="pgen-0030161-b013" ref-type="bibr">13</xref>], sometimes even after normalization has been applied [<xref rid="pgen-0030161-b014" ref-type="bibr">14</xref>]. Genetic factors can also have a large-scale impact on gene expression levels. Specific genetic loci have been shown to influence the expression of hundreds or thousands of genes in several organisms [<xref rid="pgen-0030161-b010" ref-type="bibr">10</xref>,<xref rid="pgen-0030161-b011" ref-type="bibr">11</xref>,<xref rid="pgen-0030161-b015" ref-type="bibr">15</xref>]. Expression heterogeneity is particularly pronounced in human expression data, especially in the study of complex systems, such as cancer or responses to stress [<xref rid="pgen-0030161-b016" ref-type="bibr">16</xref>–<xref rid="pgen-0030161-b018" ref-type="bibr">18</xref>]. Recently, Lamb et al. proposed the “Connectivity Map” for identifying functional connections between cancer subtypes, genetic background, and drug action [<xref rid="pgen-0030161-b019" ref-type="bibr">19</xref>]. Lamb et al. noted EH (e.g., due to cell type and batch effects) presented a major hurdle for extracting relevant biological signal from the Connectivity Map.</p>
    <p>In each of these studies, expression variation with respect to one or at most a handful of variables is explored. However, it is likely that in each study multiple sources of EH will act on distinct, but possibly overlapping, sets of genes. Normalization techniques are commonly used to detect and adjust for systematic expression variation due to well-characterized laboratory and technical sources [<xref rid="pgen-0030161-b012" ref-type="bibr">12</xref>,<xref rid="pgen-0030161-b013" ref-type="bibr">13</xref>,<xref rid="pgen-0030161-b020" ref-type="bibr">20</xref>]. However, to date there has been no approach for identifying and accounting for all sources of systematic expression variation, including variation due to unmeasured or unmodeled factors of both biological and technical sources. We show here that biological sources of variation not modeled in the analysis can be just as problematic as technical sources of variation.</p>
    <p>Here, we introduce “surrogate variable analysis” (SVA) to identify, estimate, and utilize the components of EH. <xref ref-type="fig" rid="pgen-0030161-g001">Figure 1</xref> shows the effects of failing to account for unmodeled factors in a differential expression analysis, and the potential benefits of the SVA approach. EH causes drastic increases in the variability of the ranking of genes for differential expression (<xref ref-type="fig" rid="pgen-0030161-g001">Figure 1</xref>A), distorts the null distribution potentially causing highly conservative or anticonservative significance estimates (<xref ref-type="fig" rid="pgen-0030161-g001">Figure 1</xref>B), and reduces the power to distinguish true associations between a measured variable of interest and gene expression (<xref ref-type="fig" rid="pgen-0030161-g001">Figure 1</xref>C). However, employing SVA in these studies produces operating characteristics nearly equivalent to what one would obtain with no EH at all.</p>
    <fig id="pgen-0030161-g001" position="float">
      <label>Figure 1</label>
      <caption>
        <title>Impact of Expression Heterogeneity</title>
        <p>One thousand gene expression datasets containing EH were simulated, tested, and ranked for differential expression as detailed in Simulated Examples.</p>
        <p>(A) A boxplot of the standard deviation of the ranks of each gene for differential expression over repeated simulated studies. Results are shown for analyses that ignore expression heterogeneity (Unadjusted), take expression heterogeneity into account by SVA (Adjusted), and for simulated data unaffected by expression heterogeneity (Ideal).</p>
        <p>(B) For each simulated dataset, a Kolmogorov-Smirnov test was employed to assess whether the <italic>p-</italic>values of null genes followed the correct null Uniform distribution (<xref ref-type="supplementary-material" rid="pgen-0030161-se001">Text S1</xref>). A quantile–quantile plot of the 1,000 Kolmogorov-Smirnov <italic>p-</italic>values are shown for the SVA-adjusted analysis (solid line) and the unadjusted analysis (dashed line). It can be seen that the SVA-adjusted analysis provides correctly distributed null <italic>p-</italic>values, whereas the unadjusted analysis does not due to EH.</p>
        <p>(C) A plot of expected true positives versus FDR for the SVA-adjusted (solid) and -unadjusted (dashed) analyses. The SVA-adjusted analysis shows increased power to detect true differential expression.</p>
      </caption>
      <graphic xlink:href="pgen.0030161.g001"/>
    </fig>
    <p>We apply SVA to three distinct expression studies [<xref rid="pgen-0030161-b007" ref-type="bibr">7</xref>,<xref rid="pgen-0030161-b021" ref-type="bibr">21</xref>,<xref rid="pgen-0030161-b022" ref-type="bibr">22</xref>], where each study contains clear patterns of EH (<xref ref-type="supplementary-material" rid="pgen-0030161-sg001">Figure S1</xref>). These studies represent major classes of gene expression studies performed in practice: genetic dissection of expression variation, differential expression analysis between disease classes, and differential expression over time. We show that SVA is able to accurately identify and estimate the impact of unmodeled factors in each type of study, using only the expression data itself. We further show that SVA improves accuracy and consistency in detecting differential expression. SVA orders the significant gene lists to more accurately and reproducibly reflect the ordering of the genes with respect to their true differential expression signal. SVA is particularly useful in producing reproducible results in microarray studies, because adjusting for surrogate variables reduces differential expression due to sources other than the primary variables. These results indicate that EH is prevalent across a range of studies and that SVA can be used to capture and account for these patterns to improve the characterization of biological signal in expression analyses.</p>
  </sec>
  <sec id="s2">
    <title>Results</title>
    <sec id="s2a">
      <title>Surrogate Variables</title>
      <p>We have developed an approach called surrogate variable analysis that appropriately borrows information across genes to estimate the large-scale effects of all unmodeled factors directly from the expression data. <xref ref-type="fig" rid="pgen-0030161-g002">Figure 2</xref>A shows a simulated example of EH. The primary variable distinguishes the first ten arrays from the last ten (<xref ref-type="fig" rid="pgen-0030161-g002">Figure 2</xref>B); however, the unmodeled factor may have a variety of effects on expression (<xref ref-type="fig" rid="pgen-0030161-g002">Figure 2</xref>C). The SVA approach flexibly captures signatures of EH, including highly irregular patterns not following any simple model, by estimating the signatures of EH in the expression data themselves rather than attempting to estimate specific unmodeled factors such as age or gender. After the surrogate variables are constructed, they are then incorporated into any subsequent analysis as covariates in the usual way. The SVA algorithm, described in mathematical detail in <xref ref-type="sec" rid="s4">Materials and Methods</xref>, can conceptually be broken down into four basic steps: (Step 1) Remove the signal due to the primary variable(s) of interest to obtain a residual expression matrix. Apply a decomposition to the residual expression matrix to identify signatures of EH in terms of an orthogonal basis of singular vectors that completely reproduces these signatures. Use a statistical test to determine the singular vectors that represent significantly more variation than would be expected by chance. (Step 2) Identify the subset of genes driving each orthogonal signature of EH through a significance analysis of associations between the genes and the EH signatures on the residual expression matrix. (Step 3) For each subset of genes, build a surrogate variable based on the full EH signature of that subset in the original expression data. (Step 4) Include all significant surrogate variables as covariates in subsequent regression analyses, allowing for gene-specific coefficients for each surrogate variable.</p>
      <fig id="pgen-0030161-g002" position="float">
        <label>Figure 2</label>
        <caption>
          <title>Example of Expression Heterogeneity</title>
          <p>(A) A heatmap of a simulated microarray study consisting of 1,000 genes measured on 20 arrays.</p>
          <p>(B) Genes 1–300 in this simulated study are differentially expressed between two hypothetical treatment groups; here the two groups are shown as an indicator variable for each array.</p>
          <p>(C) Genes 201–500 in each simulated study are affected by an independent factor that causes EH. This factor is distinct from, but possibly correlated with, the group variable. Here, the factor is shown as a quantitative variable, but it could also be an indicator variable or some linear or nonlinear function of the covariates.</p>
        </caption>
        <graphic xlink:href="pgen.0030161.g002"/>
      </fig>
      <p>The four-step procedure is necessary both to ensure that the surrogate variables indeed estimate EH and not the signal from the primary variable (Step 1), to ensure an accurate estimate of each surrogate variable by identifying the specific subset of genes driving each EH signature (Step 2), to allow for correlation between the primary variable and the surrogate variables by building the surrogate variables on the original expression data (Step 3), and to take into account the fact that a surrogate variable may have a different effect on each gene (Step 4). The third and fourth steps are particularly important for maintaining unbiased significance with SVA, as demonstrated below.</p>
    </sec>
    <sec id="s2b">
      <title>Definition of a Correct Procedure</title>
      <p>The overall goal of SVA is to provide a more accurate and reproducible parsing of signal and noise in the analysis of an expression study when EH is present. One way in which signal is commonly quantified is through a significance analysis [<xref rid="pgen-0030161-b023" ref-type="bibr">23</xref>]. The most basic definition of a significance analysis being performed “correctly” is if the null distribution is calculated properly [<xref rid="pgen-0030161-b024" ref-type="bibr">24</xref>]. A straightforward means for determining whether this is true is to assess whether the <italic>p-</italic>values corresponding to true null hypotheses are Uniformly distributed between zero and one. Indeed, <italic>p-</italic>values are specifically defined so that those corresponding to true null hypotheses have a Uniform(0,1) distribution if and only if the null distribution has been correctly calculated [<xref rid="pgen-0030161-b025" ref-type="bibr">25</xref>]. Throughout this paper, we examine the distribution of <italic>p-</italic>values from null genes to determine whether various procedures are able to recover the correct null distribution in the presence of EH. To assess statistically any deviations from the Uniform distribution for the null <italic>p-</italic>values, we apply a nested Kolmogorov-Smirnov test that is robust to chance fluctuations that may be present in a single simulated dataset (see <xref ref-type="supplementary-material" rid="pgen-0030161-se001">Text S1</xref>).</p>
    </sec>
    <sec id="s2c">
      <title>Simulated Examples</title>
      <p>We performed a simulation study to investigate the properties of SVA with respect to large-scale significance testing. Specifically, we show that the SVA algorithm (a) accurately estimates signatures of expression heterogeneity, (b) corrects the null distribution of <italic>p-</italic>values from multiple hypothesis tests, (c) improves estimation of the false discovery rate (FDR) [<xref rid="pgen-0030161-b023" ref-type="bibr">23</xref>,<xref rid="pgen-0030161-b026" ref-type="bibr">26</xref>], and (d) is robust to confounding between the primary variable and surrogate variables. The primary variable for our simulation was a binary variable indicating two disease classes. We simulated 1,000 expression studies, drawn from the same hypothetical population. For each study, we simulated expression for 1,000 genes on 20 arrays divided between the two disease states. The first 300 genes were simulated to be differentially expressed between disease states and genes 200–500 were affected by an independent unobserved factor to simulate a randomized study (<xref ref-type="sec" rid="s4">Materials and Methods</xref>).</p>
      <sec id="s2c1">
        <title>Surrogate variables accurately estimated.</title>
        <p>We first assessed the accuracy of the surrogate variables estimated from SVA. In 99.5% of the simulated studies, a permutation procedure [<xref rid="pgen-0030161-b027" ref-type="bibr">27</xref>] correctly identified one significant surrogate variable. Since there is only one unmodeled factor that was simulated in this study, we assessed the accuracy of the surrogate variable estimation by correlation. (If there is more than one surrogate variable or more than one unmodeled factor, then one must assess the accuracy by using some sort of multiple regression and calculating an <italic>R</italic><sup>2</sup> value.) The average correlation between the estimated surrogate variable and the true unmodeled factor over all 1,000 experiments was 0.95 with a standard deviation of 0.05. Each surrogate variable is a weighted average of the expression measurements over a subset of genes. We chose a liberal adaptive cutoff for determining the number of genes affected by each orthogonal EH signal to avoid overfitting. The SVA algorithm correctly identifies the genes affected by the unmodeled factor. On average, 30.5% of the truly affected genes were identified as affected, whereas only 9.9% of the truly unaffected genes were identified as affected.</p>
      </sec>
      <sec id="s2c2">
        <title>Correct <italic>p</italic>-value distribution.</title>
        <p>It is well known that in a significance analysis, <italic>p-</italic>values corresponding to null genes should be Uniformly distributed (i.e., “flat”) [<xref rid="pgen-0030161-b028" ref-type="bibr">28</xref>]. Statistics has classically dealt with effects from unmodeled factors by performing randomized studies. In our simulations, the unmodeled factor was independently realized, which is equivalent to randomizing the unmodeled factor with respect to the primary variable. Because of this, the <italic>p-</italic>values corresponding to any single null gene over many simulated datasets follow the Uniform distribution. However, for any given experiment, a single randomization is applied to all genes. Therefore, the thousands of <italic>p-</italic>values resulting from a single microarray study are not the same as thousands of <italic>p-</italic>values resulting from independent randomizations of an unmodeled factor. The dependence across genes induced by EH can result in major fluctuations and bias in the <italic>p-</italic>values for the null genes for any single expression study, even in a well designed, randomized study. This bias generally takes the form of a global deviation of the null <italic>p-</italic>values from the Uniform distribution. Specifically, if the unmodeled factor is correlated with the primary variable, the null <italic>p-</italic>values will be too small, biased towards zero. If the unmodeled factor is uncorrelated with the primary variable, the null <italic>p-</italic>values will be too big, biased towards one.</p>
        <p>These noteworthy fluctuations and biases in the null <italic>p-</italic>values can be seen in nine representative datasets from our simulation study in <xref ref-type="supplementary-material" rid="pgen-0030161-sg002">Figure S2</xref> and across all 1,000 simulated datasets in <xref ref-type="fig" rid="pgen-0030161-g001">Figure 1</xref>B. The bias results in incorrect assessment of significance, regardless of the particular significance measure chosen [<xref rid="pgen-0030161-b024" ref-type="bibr">24</xref>]. By applying the SVA algorithm to adjust the significance analysis, the <italic>p-</italic>values from the null genes for any single experiment are now corrected toward the Uniform distribution. This can be seen when SVA is applied to these same nine datasets in <xref ref-type="supplementary-material" rid="pgen-0030161-sg003">Figure S3</xref> and across all 1,000 simulated datasets in <xref ref-type="fig" rid="pgen-0030161-g001">Figure 1</xref>B. <xref ref-type="fig" rid="pgen-0030161-g001">Figure 1</xref>B shows that the null <italic>p-</italic>values consistently follow the Uniform distribution when SVA is applied, but they consistently do not follow the Uniform in a typical unadjusted analysis. To confirm that SVA is robust to the distribution of the gene specific error, we ran a second independent simulation study where the residuals were drawn from a published microarray study (<xref ref-type="sec" rid="s4">Materials and Methods</xref>). <xref ref-type="supplementary-material" rid="pgen-0030161-sg004">Figure S4</xref> shows that behavior of the null <italic>p-</italic>values is corrected by SVA, which is qualitatively the same as in the case of purely simulated data.</p>
        <p>It should also be noted that <italic>p-</italic>values corresponding to differentially expressed genes will be similarly affected; the loss in power can be seen in <xref ref-type="fig" rid="pgen-0030161-g001">Figure 1</xref>C. Although, note that power versus FDR is calculated in <xref ref-type="fig" rid="pgen-0030161-g001">Figure 1</xref>C when we know the correct answers, which clearly will not be reflected in actual studies where an unadjusted analysis produces an incorrect set of null <italic>p-</italic>values. Therefore, the application of SVA can result in empirical increases or decreases in power, depending on whether the null <italic>p-</italic>values are spuriously pushed towards zero or one, even though SVA tends to only provide increases in the true power.</p>
      </sec>
      <sec id="s2c3">
        <title>Gene ranking more accurate and stable.</title>
        <p>Perhaps most importantly, SVA also results in a more powerful and reproducible ranking of genes for differential expression. This can be seen in <xref ref-type="fig" rid="pgen-0030161-g001">Figures 1</xref>A and <xref ref-type="supplementary-material" rid="pgen-0030161-sg005">S5</xref>; SVA-adjusted analyses provide gene rankings comparable to the scenario where there is no heterogeneity, whereas an unadjusted analysis allows for incorrect and highly variable gene rankings. This is arguably the most important feature of SVA, since an accurate and reproducible gene ranking is key for making biological inference when only a subset of genes will be selected for future study. In other words, these results suggest that SVA would yield results reproducible on the level that we would expect given that the primary variable is the only source of signal.</p>
      </sec>
      <sec id="s2c4">
        <title>Improved FDR estimation.</title>
        <p>There has been much recent interest in the effect of expression dependence across genes on estimates of multiple testing significance measures. Large-scale dependence has been shown to be particularly problematic for estimating FDR, as dependence across genes increases the variance of most standard FDR estimators [<xref rid="pgen-0030161-b001" ref-type="bibr">1</xref>,<xref rid="pgen-0030161-b002" ref-type="bibr">2</xref>,<xref rid="pgen-0030161-b029" ref-type="bibr">29</xref>–<xref rid="pgen-0030161-b035" ref-type="bibr">35</xref>]. EH represents large-scale dependence across genes that may significantly affect estimates of the FDR and related measures. To evaluate the potential impact of SVA in this situation, we performed a simulation study as described above. However, in this case, to create large-scale dependence, we let genes 201–1,000 be affected by the unmodeled factor. SVA reduces the variability in both the estimate of the proportion of null hypotheses and the <italic>q</italic>-values for each study (<xref ref-type="supplementary-material" rid="pgen-0030161-sg006">Figure S6</xref>). Furthermore, the behavior of the SVA-adjusted FDR estimates is almost identical to the behavior under the scenario with no EH.</p>
      </sec>
      <sec id="s2c5">
        <title>Robustness to confounding in observational studies.</title>
        <p>To assess the accuracy of the SVA algorithm in the case where the primary variable and unmodeled factors are heavily correlated, we performed a second simulation study. The set-up for the second simulation study was identical to that for the original study above, except in this case the unmodeled factor was simulated such that the average correlation with the primary variable was 0.50 with a standard deviation of 0.16. Under this model, the unobserved factor is both correlated with the primary variable and affects an overlapping set of genes. This is representative of the potential confounding present in observational microarray studies (see Disease Class below) and that which happens by chance in a non-negligible subset of randomized studies. Even in this set-up, the permutation hypothesis test correctly identified a single surrogate variable in 94.5% of the simulated datasets. Further, the average correlation between the estimated surrogate variable and the true unmodeled factor over 1,000 datasets was 0.94 with a standard deviation of 0.22. Thus, SVA accurately estimates the unobserved factor even when there is strong dependence between the primary and unobserved factors, with a subset of genes affected by both. SVA also provided a correct Uniform distribution of null <italic>p-</italic>values as in the above randomized study scenario.</p>
      </sec>
    </sec>
    <sec id="s2d">
      <title>Proof of Concept: Genetics of Gene Expression in Yeast</title>
      <p>Several recent studies have carried out the genetic dissection of expression variation at the genome-wide level [<xref rid="pgen-0030161-b010" ref-type="bibr">10</xref>,<xref rid="pgen-0030161-b011" ref-type="bibr">11</xref>,<xref rid="pgen-0030161-b015" ref-type="bibr">15</xref>]. Brem et al. [<xref rid="pgen-0030161-b010" ref-type="bibr">10</xref>, <xref rid="pgen-0030161-b021" ref-type="bibr">21</xref>] measured expression genome wide in 112 segregants of a cross between two isogenic strains of yeast. They also obtained genotypes for each segregant at markers covering 99% of the genome (<xref ref-type="sec" rid="s4">Materials and Methods</xref>). It was shown that many gene expression traits are <italic>cis</italic>-linking, i.e., the quantitative trait locus (QTL) linkage peak coincided with the physical location of the open reading frame for the expression trait [<xref rid="pgen-0030161-b036" ref-type="bibr">36</xref>]. At the same time, it was also shown that a number of gene expression traits are <italic>trans</italic>-linking, with linkage peaks at loci distant from the physical location of their open reading frames. In particular, several “pivotal” loci each appear to influence the expression of hundreds or even thousands of gene expression traits. Similar highly influential loci have been observed in other organisms [<xref rid="pgen-0030161-b011" ref-type="bibr">11</xref>,<xref rid="pgen-0030161-b015" ref-type="bibr">15</xref>]. These pivotal loci act as a major source of EH, regardless of whether genotypes have been measured in an expression study.</p>
      <p>As proof of concept, the Brem et al. [<xref rid="pgen-0030161-b010" ref-type="bibr">10</xref>,<xref rid="pgen-0030161-b021" ref-type="bibr">21</xref>] dataset was used to show that well-defined EH exists in actual studies and that SVA can properly capture and incorporate this EH structure into the statistical analysis of measured variables of interest. First, we analyzed the full dataset to identify the expression traits under the influence of these pivotal <italic>trans</italic>-acting loci, as well as the patterns of EH induced by these loci. Then we applied SVA to only the expression data, ignoring the genotype data to identify relevant surrogate variables capturing EH. Linkage analysis was performed again including the surrogate variables as covariates, showing that the effects from the pivotal loci are now negligible. In other words, SVA was able to capture and remove the effects of these few pivotal loci without the need for genotypes.</p>
      <p>A number of expression traits have significant <italic>trans</italic>-linking eQTL mapping to pivotal loci on Chromosomes II, III, VIII, XII, XIV, and XV (<xref ref-type="fig" rid="pgen-0030161-g003">Figure 3</xref>A). In the SVA-adjusted analysis, the majority of the <italic>trans</italic>-linkages to the pivotal loci have been eliminated (<xref ref-type="fig" rid="pgen-0030161-g003">Figure 3</xref>B). The pervasive <italic>trans</italic>-linkage signal mapping to the pivotal loci can be viewed as global expression heterogeneity. The reduction in <italic>trans</italic>-linkage to these loci in the SVA-adjusted significance analysis indicates that SVA effectively captures genetic EH.</p>
      <fig id="pgen-0030161-g003" position="float">
        <label>Figure 3</label>
        <caption>
          <title>SVA Captures EH Due to Genotype</title>
          <p>(A) A plot of significant linkage peaks (<italic>p</italic>-value &lt; 1e−7) for expression QTL in the Brem et al. [<xref rid="pgen-0030161-b010" ref-type="bibr">10</xref>,<xref rid="pgen-0030161-b021" ref-type="bibr">21</xref>] study by marker location (<italic>x</italic>-axis) and expression trait location (<italic>y</italic>-axis).</p>
          <p>(B) Significant linkage peaks (<italic>p</italic>-value &lt; 1e−7) after adjusting for surrogate variables. Large <italic>trans</italic>-linkage peaks on Chromosomes II, III, VII, XII, XIV, and XV have been eliminated without reducing <italic>cis</italic>-linkage peaks.</p>
        </caption>
        <graphic xlink:href="pgen.0030161.g003"/>
      </fig>
      <p>Pivotal <italic>trans</italic>-linkage signals indicate large-scale effects of a few loci. However, subtle and potentially more interesting <italic>cis</italic>-linkage may be lost in the presence of substantial genetic heterogeneity. To assess the impact of SVA on power to detect <italic>cis</italic>-linkage, we calculated linkage <italic>p-</italic>values only for markers located within three centimorgans of the open reading frame of each trait. On chromosomes without a pivotal locus (Chromosomes I, IV, V, VI, VII, IX, X, XI, and XIII) the SVA-adjusted analysis finds substantially more <italic>cis</italic>-linkage signal. At an FDR cutoff of 0.05, the adjusted analysis finds 1,894 significant <italic>cis</italic>-linkages, compared with 1,604 for the unadjusted analysis. This increase is consistent across a range of FDR cutoffs (<xref ref-type="table" rid="pgen-0030161-t001">Table 1</xref>) and illustrates the potential increase in power obtained from applying SVA.</p>
      <table-wrap id="pgen-0030161-t001" content-type="1col" position="float">
        <label>Table 1</label>
        <caption>
          <p>Significance Results</p>
        </caption>
        <graphic xlink:href="pgen.0030161.t001"/>
      </table-wrap>
    </sec>
    <sec id="s2e">
      <title>SVA Applied to Human Expression Studies</title>
      <p>We applied the SVA approach to two human studies [<xref rid="pgen-0030161-b007" ref-type="bibr">7</xref>,<xref rid="pgen-0030161-b022" ref-type="bibr">22</xref>], representing the two common human study designs: disease state and timecourse.</p>
      <sec id="s2e1">
        <title>Disease class.</title>
        <p>Hedenfalk et al. [<xref rid="pgen-0030161-b022" ref-type="bibr">22</xref>] measured expression in seven <italic>BRCA1</italic> and eight <italic>BRCA2</italic> mutation-positive tumor samples (<xref ref-type="sec" rid="s4">Materials and Methods</xref>). The goal of the study was to identify genes that showed differential expression across breast cancer tumor subtypes defined by these germline mutations.</p>
        <p>Hierarchical clustering [<xref rid="pgen-0030161-b037" ref-type="bibr">37</xref>] of the data reveals notable substructure within the <italic>BRCA2</italic> samples [<xref rid="pgen-0030161-b038" ref-type="bibr">38</xref>]. We applied SVA and identified a single surrogate variable that appears to capture this trend (<xref ref-type="fig" rid="pgen-0030161-g004">Figures 4</xref>A and S7A). We included this surrogate variable in a significance analysis comparing <italic>BRCA1</italic> and <italic>BRCA2</italic> tumors (<xref ref-type="sec" rid="s4">Materials and Methods</xref>). The adjusted analysis finds fewer significant genes at standard FDR cutoffs (<xref ref-type="table" rid="pgen-0030161-t001">Table 1</xref>). This can be understood in the context of substructure within the <italic>BRCA2</italic> group. Many of the genes declared differentially expressed at the most extreme levels of significance are highly associated with the top surrogate variable. Thus, differential expression for a number of genes is driven primarily by expression heterogeneity. Adjusting for the top surrogate variable eliminates spurious differential expression due to EH. As an example, eukaryotic translation initiation factor 2 (<italic>EIF2S2</italic>) is declared differentially expressed with a <italic>q</italic>-value of 0.09 in the unadjusted analysis. However, the first four <italic>BRCA2</italic> samples show nearly identical expression values to the <italic>BRCA1</italic> samples for this gene (<xref ref-type="supplementary-material" rid="pgen-0030161-sg007">Figure S7</xref>B). Thus, it is unlikely that differential expression is being driven by the difference in <italic>BRCA</italic> genotypes, but rather by some other confounding factor due to the observational nature and small sample size of the study.</p>
        <fig id="pgen-0030161-g004" position="float">
          <label>Figure 4</label>
          <caption>
            <title>Surrogate Variables from Human Studies</title>
            <p>(A) A plot of the top surrogate variable estimated from the breast cancer data [<xref rid="pgen-0030161-b022" ref-type="bibr">22</xref>]. The <italic>BRCA1</italic> group is relatively homogeneous (triangles), but the <italic>BRCA2</italic> group shows substantial heterogeneity (pluses).</p>
            <p>(B) A plot of tissue type versus array for the Rodwell et al. [<xref rid="pgen-0030161-b007" ref-type="bibr">7</xref>] study (dotted line) and the top surrogate variable estimated from the expression data when tissue was ignored (dashed line). There is strong correlation between the top surrogate variable and the tissue type variable.</p>
          </caption>
          <graphic xlink:href="pgen.0030161.g004"/>
        </fig>
        <p>As shown above, SVA also increases the accuracy and stability of the ordering of the significant gene lists (see Simulated Examples). Since it is standard practice to examine only the most significant genes for further study, an SVA-adjusted analysis may result in completely distinct biological conclusions. For example, <xref ref-type="supplementary-material" rid="pgen-0030161-sg008">Figure S8</xref> shows a substantial reordering of genes for significance when applying SVA, including a number of highly significant genes in an adjusted analysis that moved substantially down in ranking when SVA was applied. These genes may represent spurious signal due to the confounding shown earlier that would reduce the quality of the gene list.</p>
      </sec>
      <sec id="s2e2">
        <title>Time-course sampling.</title>
        <p>Rodwell et al. [<xref rid="pgen-0030161-b007" ref-type="bibr">7</xref>] measured genome-wide expression in kidney tissue samples from 133 patients (<xref ref-type="sec" rid="s4">Materials and Methods</xref>). The goal of the study was to identify genes whose expression changed with age. We applied a recently developed procedure for time-course significance analysis to identify differential expression with respect to age [<xref rid="pgen-0030161-b008" ref-type="bibr">8</xref>]. In these data, tissue type had a strong impact on the expression of thousands of genes. We first performed a time-course differential expression analysis with tissue type included as a covariate. We also performed a second differential expression analysis ignoring tissue type.</p>
        <p>We then applied SVA to the expression data ignoring the tissue information. The top surrogate variable identified by SVA had a correlation of 0.86 with tissue type (<xref ref-type="fig" rid="pgen-0030161-g004">Figure 4</xref>B). The SVA algorithm identified 84% of the genes as likely to be associated with the top surrogate variable, indicating pervasive signal due to tissue type, as can be directly verified. To determine if this surrogate variable captured the overall effect of tissue type, we performed a third differential expression analysis ignoring tissue type and including the top surrogate variable as a covariate.</p>
        <p>At standard <italic>q</italic>-value cutoffs, the results of the analysis adjusted for the top surrogate variable appeared to be very similar to the results when the true tissue type was included (<xref ref-type="table" rid="pgen-0030161-t001">Table 1</xref>). At a standard <italic>q</italic>-value cutoff of 0.05, 100% of the 422 genes declared significant by the unadjusted analysis were declared significant by the tissue-adjusted analysis. At the same cutoff, 96% of the 538 genes declared significant in the SVA-adjusted analysis were also declared significant in the tissue-adjusted analysis. That is, 116 genes were significant in the SVA-adjusted analysis that were also significant in the tissue-adjusted analysis, but were not significant in the unadjusted analysis. These genes represent an increase in power to detect differential expression after adjusting for a surrogate variable in place of an unmodeled confounding factor.</p>
      </sec>
    </sec>
    <sec id="s2f">
      <title>Comparison with Existing Methods</title>
      <sec id="s2f1">
        <title>Regression on eigenvectors.</title>
        <p>There are several well-established statistical approaches for partitioning of sources of variation among multiple variables into components [<xref rid="pgen-0030161-b039" ref-type="bibr">39</xref>]. The classical singular value decomposition (or principal components) approach has been successfully applied in several areas of genomics. For example, Alter et al<italic>.</italic> applied the singular value decomposition to identify significant trends in gene expression studies [<xref rid="pgen-0030161-b040" ref-type="bibr">40</xref>]. They showed that the right singular vectors, or “eigengenes,” represent trends that account for a large proportion of the variation in the expression matrix. Recently, Price et al. [<xref rid="pgen-0030161-b041" ref-type="bibr">41</xref>] also performed this singular value decomposition of whole-genome SNP genotypes (coded as 0, 1, or 2) in order to account for systematic sources of variation due to population substructure. Both of these methods extract and utilize patterns of variation from the entire matrix of genomic data without supervision from primary variables.</p>
        <p>When performing a significance analysis of an expression study with respect to primary variables, one cannot employ this classical approach. As opposed to association studies, where population structure has genome-wide effects at a signal relatively much stronger than the primary variable, the signal structure in expression studies tends to be much more complex. There can be multiple levels of signal from multiple sources that each affect certain subsets of genes, making it important to supervise the decomposition with respect to known primary variables and these subsets of genes.</p>
        <p>To demonstrate these issues, we considered two straightforward significance analysis applications of the well-established singular value decomposition approach previously utilized in genomics [<xref rid="pgen-0030161-b040" ref-type="bibr">40</xref>,<xref rid="pgen-0030161-b041" ref-type="bibr">41</xref>]. The first application identifies significant eigengenes by the same permutation-based algorithm as in our SVA approach. The eigengene with the highest absolute correlation with the primary variable is removed and the remaining significant eigengenes are included as covariates in the significance analysis. The second algorithm identifies significant eigengenes in the residuals of the regression of gene expression on the primary variable, again using a permutation-based algorithm. All significant eigengenes identified in the residuals are included in the significance analysis. Both algorithms do not produce consistently accurate results (<xref ref-type="supplementary-material" rid="pgen-0030161-sg009">Figures S9</xref> and <xref ref-type="supplementary-material" rid="pgen-0030161-sg010">S10</xref>), and sometimes their adjustments produce more bias than making no adjustment at all. The eigengenes calculated from the entire expression matrix capture the signal due to both the unmodeled factor and the primary variable, which results in biased estimation of the unmodeled factor. The eigengenes calculated from the residuals do not take into account possible overlapping signal between the primary variable and unmodeled factors, often resulting in over-fitting.</p>
        <p>SVA is a new methodological development aimed at overcoming the issues not addressed by existing methods. Rather than decomposing the entire expression matrix (or genotype matrix), SVA performs what could be called a “supervised factor analysis” of the expression data (<xref ref-type="sec" rid="s4">Materials and Methods</xref>). Specifically, SVA decomposes the expression variation with respect to the primary variables already included in the model. Our multi-step approach for estimating surrogate variables uses the eigengenes from carefully defined subsets of genes in the original expression matrix that correspond to patterns observed in a residual expression matrix where the main effects of the primary variables have been removed. This allows us to decompose the variation in such a way that distinct sets of genes (but possibly overlapping) drive each surrogate variable, where the surrogate variables may be correlated with the primary variables. It also does not require any assumptions about the relative strength of signal due to each source of variation.</p>
      </sec>
      <sec id="s2f2">
        <title>Multiple testing dependence.</title>
        <p>It is clear that EH induces widespread dependence in expression variation across genes. EH is therefore related to the issue of multiple testing dependence, which has been recognized as an important problem [<xref rid="pgen-0030161-b001" ref-type="bibr">1</xref>,<xref rid="pgen-0030161-b002" ref-type="bibr">2</xref>,<xref rid="pgen-0030161-b030" ref-type="bibr">30</xref>]. A number of methods have been proposed for adjusting for dependence in multiple tests that make adjustments directly once the tests are summarized as <italic>p-</italic>values or test-statistics, rather than the original dataset [<xref rid="pgen-0030161-b031" ref-type="bibr">31</xref>–<xref rid="pgen-0030161-b035" ref-type="bibr">35</xref>]. It does not appear that these multiple testing procedures can solve the problem of EH at the level of generality of SVA. <xref ref-type="fig" rid="pgen-0030161-g005">Figure 5</xref> shows a histogram composed of all null <italic>p-</italic>values affected by EH from the simulation study. Without the presence of EH, these null <italic>p-</italic>values would be Uniformly distributed between zero and one. However, it is also possible to produce a set of <italic>p-</italic>values from an experiment unaffected by EH, where a subset of tests are true alternatives and have <italic>p-</italic>values pushed towards zero so that they are indistinguishable from <xref ref-type="fig" rid="pgen-0030161-g005">Figure 5</xref>. In other words, by only observing the set of <italic>p-</italic>values in <xref ref-type="fig" rid="pgen-0030161-g005">Figure 5</xref>, it is not possible to know whether they are all null and affected by EH, or whether they are unaffected by EH and a subset are true alternatives.</p>
        <fig id="pgen-0030161-g005" position="float">
          <label>Figure 5</label>
          <caption>
            <title>Null <italic>p</italic>-Values under Heterogeneity</title>
            <p>A histogram of the null <italic>p-</italic>values from a single simulated experiment affected by heterogeneity. The distribution of these <italic>p-</italic>values appears identical to a complete set of <italic>p-</italic>values from an experiment that is not subject to heterogeneity. Therefore, it is not possible to identify and account for heterogeneity by analyzing one-dimensional <italic>p-</italic>values or test-statistics (see also <xref ref-type="supplementary-material" rid="pgen-0030161-se001">Text S1</xref>).</p>
          </caption>
          <graphic xlink:href="pgen.0030161.g005"/>
        </fig>
        <p>If the original data are ignored and an adjustment for EH is applied to the <italic>p-</italic>values, then the only unbiased adjustment is to make all <italic>p-</italic>values larger so that the histogram in <xref ref-type="fig" rid="pgen-0030161-g005">Figure 5</xref> is transformed to a flat, Uniformly distributed histogram. Therefore, if one adjusts for EH based only on <italic>p-</italic>values, then all <italic>p-</italic>value histograms that look like <xref ref-type="fig" rid="pgen-0030161-g005">Figure 5</xref> should be made flat. By producing datasets with stronger EH, it is possible to produce histograms where the <italic>p-</italic>values are pushed even more strongly towards zero because of the stronger dependence. This argument shows that any method that adjusts for EH in general at the level of <italic>p-</italic>values must make all <italic>p-</italic>value histograms Uniformly distributed. The same argument holds for test-statistics, where they would have to be transformed to be distributed as their “theoretical null” distribution (<xref ref-type="supplementary-material" rid="pgen-0030161-sg011">Figure S11</xref>). Therefore, it does not appear that one can generally adjust for EH based only on <italic>p-</italic>values or test-statistics, especially when considering examples such as that in <xref ref-type="fig" rid="pgen-0030161-g005">Figure 5</xref>. This point can be further supported with a more theoretical argument (<xref ref-type="supplementary-material" rid="pgen-0030161-se001">Text S1</xref>). Additionally, methods that adjust for what is typically defined as multiple testing dependence do not usually take into account the fact that the sources of dependence may have signal that overlaps with the primary variables of interest, whereas SVA does. It appears that the framework presented here may be a generalization of the multiple testing problem, but this issue requires further investigation.</p>
      </sec>
    </sec>
  </sec>
  <sec id="s3">
    <title>Discussion</title>
    <p>Expression heterogeneity due to technical, genetic, environmental, or demographic variables is common in gene expression studies. Here we have introduced a new method, SVA, for identifying, estimating, and incorporating sources of EH in an expression analysis. SVA uses the expression data itself to identify groups of genes affected by each unobserved factor and estimates the factor based on the expression of those genes. Simulations show that SVA accurately detects expression heterogeneity and improves significance analyses. We performed SVA on experiments involving recombinant inbred lines, individuals of varying disease state, and expression measured over time to illustrate the broad range of studies on which SVA can be applied. One advantage of the SVA approach is the ability to disentangle correlated and overlapping differential expression signals. This approach may be particularly useful in clinical studies, where a large number of clinical variables may have a complicated joint impact on expression. We have implemented SVA in an open source package available for downloading at <ext-link ext-link-type="uri" xlink:href="http://www.genomine.org/sva/">http://www.genomine.org/sva/</ext-link>.</p>
  </sec>
  <sec id="s4">
    <title>Materials and Methods</title>
    <sec id="s4a">
      <title>Expression data.</title>
      <p>Three publicly available datasets were employed to represent a broad range of gene expression studies performed in practice. The first dataset consists of gene expression measurements for 6,216 genes in 112 segregants of a cross between two isogenic strains of yeast, as well as genotypes across 3,312 markers [<xref rid="pgen-0030161-b010" ref-type="bibr">10</xref>,<xref rid="pgen-0030161-b021" ref-type="bibr">21</xref>]. The second dataset consists of gene expression for 3,226 genes in seven <italic>BRCA1</italic> and eight <italic>BRCA2</italic> mutation–positive tumor samples [<xref rid="pgen-0030161-b022" ref-type="bibr">22</xref>]; several genes with apparent outliers were removed as described [<xref rid="pgen-0030161-b023" ref-type="bibr">23</xref>] for a total of 3,170 genes. The third dataset consists of gene expression measurements in kidney samples from normal kidney tissue obtained at nephrectomy from 133 patients [<xref rid="pgen-0030161-b007" ref-type="bibr">7</xref>]; the 34,061 genes analyzed in [<xref rid="pgen-0030161-b008" ref-type="bibr">8</xref>] were also analyzed here. Seventy-four of the tissue samples were obtained from the cortex and 59 from the medulla. Details of the protocol for each study appear in the corresponding references. All expression data were analyzed on the log scale.</p>
    </sec>
    <sec id="s4b">
      <title>Linkage analysis of yeast cross.</title>
      <p>The SVA algorithm identified 14 significant surrogate variables from the expression data. We performed both an unadjusted and an SVA-adjusted linkage analysis for each expression trait. In the unadjusted analysis, linkage <italic>p-</italic>values were calculated from an <italic>F</italic>-test comparing an additive genetic model to the null model of no genetic association [<xref rid="pgen-0030161-b042" ref-type="bibr">42</xref>]. SVA-adjusted <italic>p-</italic>values were calculated from an <italic>F</italic>-test comparing the full model of genetic association and the null model of no association, both models including all significant surrogate variables as additive terms.</p>
    </sec>
    <sec id="s4c">
      <title>Simulation details.</title>
      <p>For each study, we simulated expression for 1,000 genes on 20 arrays divided between the two disease states. For simplicity, the expression measurements for each gene were drawn from a normal distribution with mean zero and variance one. We simulated expression heterogeneity with a dichotomous unmodeled factor independent of the disease state. The mean differences between disease states and states of the unmodeled factor were drawn from two independent normal distributions. For the real data example, we calculated the residuals from the regression of <italic>BRCA</italic> tumor type on expression for the Hedenfalk data [<xref rid="pgen-0030161-b022" ref-type="bibr">22</xref>]. Then, for each simulated study, we independently permuted each row of the expression data to create a matrix of residuals. To this matrix, we added signal, as in the case of the purely simulated data. The simulation studies were based on data generated using the R programming language [<xref rid="pgen-0030161-b043" ref-type="bibr">43</xref>]. All differential expression analyses were performed by a <italic>t</italic>-test based on standard linear regression. The genes were ranked for relative significance by the absolute values of their <italic>t</italic>-statistics.</p>
    </sec>
    <sec id="s4d">
      <title>Analysis of the human studies.</title>
      <p>Differential expression was calculated using a <italic>t</italic>-test based on standard linear regression for the disease class data. The method of Storey et al. [<xref rid="pgen-0030161-b008" ref-type="bibr">8</xref>] was applied for the time-course data. <italic>q</italic>-Values were estimated using previously described methodology [<xref rid="pgen-0030161-b023" ref-type="bibr">23</xref>].</p>
    </sec>
    <sec id="s4e">
      <title>Statistical model for SVA.</title>
      <p>Let <bold>X</bold><italic><sub>mxn</sub></italic> = (<bold>x</bold><sub>1</sub>,..,<bold>x</bold><italic><sub>m</sub></italic>)<italic><sup>T</sup></italic> be the normalized <italic>m</italic> × <italic>n</italic> expression matrix with <italic>n</italic> arrays for <italic>m</italic> genes, where <bold>x</bold><italic><sub>i</sub></italic> = (<bold>x</bold><italic><sub>i</sub></italic><sub>1</sub><italic>,..,</italic><bold>x</bold><italic><sub>in</sub></italic>)<italic><sup>T</sup></italic> is the vector of normalized expression for gene <italic>i</italic>. Let <bold>y</bold><italic/> = (y<sub>1</sub><italic>,..,</italic>y<italic><sub>n</sub></italic>)<italic><sup>T</sup></italic> be a vector of length <italic>n</italic> representing the primary variable of interest.</p>
      <p>Without loss of generality model x<italic><sub>ij</sub> = μ<sub>i</sub> + f<sub>i</sub></italic>(<italic>y<sub>j</sub></italic>) <italic>+ e<sub>ij</sub></italic>, where <italic>μ<sub>i</sub></italic> is the baseline level of expression, <italic>f<sub>i</sub></italic>(<italic>y<sub>j</sub></italic>) <italic>= E</italic>(<italic>x<sub>ij</sub></italic> | <italic>y<sub>j</sub></italic>)<italic> − μ<sub>i</sub></italic> gives the relationship between measured variable of interest and gene <italic>i</italic>, and <italic>e<sub>ij</sub></italic> is random noise with mean zero. As a simple example, for a dichotomous outcomes <italic>y<sub>j</sub></italic> ∈ (−1,1} we would employ the linear model <italic>x<sub>ij</sub></italic> = <italic>μ<sub>i</sub></italic> + <italic>β<sub>i</sub> y<sub>j</sub></italic> +<italic>e<sub>ij</sub></italic> and estimate <italic>μ<sub>i</sub></italic> and <italic>β<sub>i</sub></italic> by least squares. We could then perform a standard test of whether <italic>β<sub>i</sub></italic> = <italic>0</italic> or not for each gene. This hypothesis test is exactly equivalent to performing a test of differential expression between the two classes.</p>
      <p>Suppose in a microarray study there are <italic>L</italic> biologically meaningful unmodeled factors, such as age, environmental exposure, genotype, etc. Let <bold>g</bold><sub>ℓ</sub> = (g<sub>ℓ1</sub>,...,g<sub>ℓ<italic>n</italic></sub>) be an arbitrarily complicated function of the ℓth factor across all <italic>n</italic> arrays, for ℓ=1,2,...,<italic>L</italic>. Therefore, we can now model the expression for gene <italic>i</italic> on array <italic>j</italic> as <italic>x<sub>ij</sub></italic> = <italic>μ<sub>i</sub></italic> + <italic>f<sub>i</sub></italic> (<italic>y<sub>j</sub></italic>)+<inline-formula id="pgen-0030161-ex001"><inline-graphic xlink:href="pgen.0030161.ex001.jpg" mimetype="image"/></inline-formula>
, where <italic>γ</italic><sub>ℓ<italic>i</italic></sub> is a gene-specific coefficient for the ℓth unmodeled factor. If unmodeled factor ℓ does not influence the expression of gene <italic>i</italic>, then <italic>γ</italic><sub>ℓ<italic>i</italic></sub> = 0. The fact that we employ an additive model is actually quite general: it has been shown that even complicated nonlinear functions of factors can be represented in an additive fashion for a reasonable choice of a nonlinear basis [<xref rid="pgen-0030161-b044" ref-type="bibr">44</xref>]; we simply define the <bold>g</bold><sub>ℓ</sub> to be as nonlinear as necessary and make <italic>L</italic> as large as necessary to best fit the additive effect. Since there are <italic>n</italic> arrays, each gene's expression can be modeled by at most <italic>n</italic> linearly independent factors, and hence any dependence structure between genes can be represented using <italic>L</italic> ≤ <italic>n</italic> vectors in this additive fashion.
</p>
      <p>Due to this formulation, the inter-gene dependent <italic>e<sub>ij</sub></italic> have now been replaced with <inline-formula id="pgen-0030161-ex002"><inline-graphic xlink:href="pgen.0030161.ex002.jpg" mimetype="image"/></inline-formula>
, where <inline-formula id="pgen-0030161-ex003"><inline-graphic xlink:href="pgen.0030161.ex003.jpg" mimetype="image"/></inline-formula>
is the true gene-specific noise, now sufficiently independent across genes. In other words, we have broken the error <italic>e<sub>ij</sub></italic> into two terms, one that represents dependent variation across genes due to unmodeled factors, <inline-formula id="pgen-0030161-ex004"><inline-graphic xlink:href="pgen.0030161.ex004.jpg" mimetype="image"/></inline-formula>
, and one that represents gene-specific independent fluctuations in expression <inline-formula id="pgen-0030161-ex005"><inline-graphic xlink:href="pgen.0030161.ex005.jpg" mimetype="image"/></inline-formula>
.
</p>
      <p>It is not possible in general to directly estimate the unmodeled <bold>g</bold><sub>ℓ</sub>, and SVA does not attempt to do so. The key observation is to note that for <italic>L</italic> vectors in <italic>n</italic> space, it is possible to identify an orthogonal set of vectors <bold>h</bold><italic><sub>k</sub></italic> , <italic>k</italic> = 1,...,<italic>K</italic> (<italic>K</italic>≤<italic>L</italic>) that spans the same linear space as the <bold>g</bold><sub>ℓ</sub> In other words, for any set of vectors <bold>g</bold><sub>ℓ</sub> and coefficients <italic>γ</italic><sub>ℓ<italic>i</italic></sub>, it is possible to identify mutually orthogonal vectors <bold>h</bold><sub>k</sub> and coefficients <italic>λ<sub>ki</sub></italic> such that <inline-formula id="pgen-0030161-ex006"><inline-graphic xlink:href="pgen.0030161.ex006.jpg" mimetype="image"/></inline-formula>
and
<disp-formula id="pgen-0030161-e001"><graphic xlink:href="pgen.0030161.e001.jpg" position="anchor" mimetype="image"/></disp-formula>
</p>
      <p>Therefore, we do not need to estimate the specific variables <bold>g</bold><sub>ℓ</sub>. We only need to estimate the linear combination <inline-formula id="pgen-0030161-ex007"><inline-graphic xlink:href="pgen.0030161.ex007.jpg" mimetype="image"/></inline-formula>
, so we can choose a set of vectors that spans the same space but is statistically tractable. Here we choose the set of <italic>K</italic> orthogonal vectors (denoted by the <bold>h</bold><italic><sub>k</sub></italic>) to be those that are the right non-zero singular vectors provided by the singular value decomposition of the <italic>m</italic> × <italic>n</italic> matrix with (<italic>i</italic>, <italic>j</italic>) entry <inline-formula id="pgen-0030161-ex008"><inline-graphic xlink:href="pgen.0030161.ex008.jpg" mimetype="image"/></inline-formula>
. This justifies the use of the singular value decomposition to identify orthogonal signatures of expression heterogeneity for surrogate variable estimates. We call these <bold>h</bold><sub>1</sub>,<bold>h</bold><sub>2</sub>,...,<bold>h</bold><italic><sub>K</sub></italic> the “surrogate variables.”
</p>
      <p>An intuitive question that arises from an inspection of this formulation is about the model assumptions of the g<sub>ℓ<italic>j</italic></sub>. Whereas the term <italic>f<sub>i</sub></italic> (<italic>y<sub>j</sub></italic>) is a model of the measured variable, <italic>y<sub>j</sub></italic>, it is not generally possible to analogously formulate g<sub>ℓ<italic>j</italic></sub> as a function of a well-defined, measured variable. Since we estimate the outcomes <inline-formula id="pgen-0030161-ex009"><inline-graphic xlink:href="pgen.0030161.ex009.jpg" mimetype="image"/></inline-formula>
directly from the expression data (as <inline-formula id="pgen-0030161-ex010"><inline-graphic xlink:href="pgen.0030161.ex010.jpg" mimetype="image"/></inline-formula>
), it is not necessary to determine a model of the g<sub>ℓ<italic>j</italic></sub> in terms of a biologically meaningful variable. Thus, we can bypass the need to know what the most relevant model of a measured variable is for g<sub>ℓ<italic>j</italic></sub> for the purposes of estimating the EH.
</p>
    </sec>
    <sec id="s4f">
      <title>SVA algorithm.</title>
      <p>The goal of the SVA algorithm is therefore to identify and estimate the surrogate variables, <bold>h</bold><italic><sub>k</sub></italic> , = (<italic>h<sub>k</sub></italic><sub>1</sub>,...,<italic>h<sub>kn</sub></italic>)<italic><sup>T</sup></italic>, based on certain consistent patterns of expression variation. Methods for empirically identifying [<xref rid="pgen-0030161-b037" ref-type="bibr">37</xref>] and estimating [<xref rid="pgen-0030161-b040" ref-type="bibr">40</xref>] expression trends or clusters have previously been developed. However, care must be taken when estimating expression trends for use in subsequent analyses of measured variables of interest. Specifically, surrogate variables must represent signal due to sources other than the primary variable and allow for potential overlap with the primary variable. The SVA algorithm is designed to estimate surrogate variables that meet both requirements. We assume that <italic>n</italic> &lt; <italic>m</italic> and, for simplicity, that there is only a single primary variable; the extension to multiple primary variables simply requires one to include all of them in the model fit occurring in each Step 1 below.</p>
      <p>The algorithm is decomposed into two parts: detection of unmodeled factors and construction of surrogate variables. The basic form of the first algorithm has been proposed previously [<xref rid="pgen-0030161-b027" ref-type="bibr">27</xref>]. The second algorithm has been proposed and justified in this manuscript</p>
      <p>Algorithm to detect unmodeled factors.</p>
      <p>1. Form estimates <inline-formula id="pgen-0030161-ex011"><inline-graphic xlink:href="pgen.0030161.ex011.jpg" mimetype="image"/></inline-formula>
and <inline-formula id="pgen-0030161-ex012"><inline-graphic xlink:href="pgen.0030161.ex012.jpg" mimetype="image"/></inline-formula>
by fitting the model <italic>x<sub>ij</sub></italic> = <italic>μ<sub>i</sub></italic> + <italic>f<sub>i</sub></italic> (<italic>y<sub>j</sub></italic>) + <italic>e<sub>ij</sub></italic>, and calculate the residuals r<italic><sub>ij</sub></italic> = <italic>x<sub>ij</sub></italic> −<inline-formula id="pgen-0030161-ex013"><inline-graphic xlink:href="pgen.0030161.ex013.jpg" mimetype="image"/></inline-formula>
(<italic>y<sub>j</sub></italic>) to remove the effect of the primary variable on expression. Form the <italic>m</italic> × <italic>n</italic> residual matrix <bold>R</bold>, where the (<italic>i</italic>, <italic>j</italic>) element of <bold>R</bold> is <italic>r<sub>ij</sub></italic>.
</p>
      <p>2. Calculate the singular value decomposition of the residual expression matrix <bold>R = UDV</bold><italic><sup>T</sup></italic>.</p>
      <p>3. Let <italic>d</italic><sub>ℓ</sub> be the ℓth eigenvalue, which is the ℓth diagonal element of <bold>D</bold>, for ℓ=1,...,<italic>n</italic>. If <italic>df</italic> is the degrees of freedom of the model fit <italic>μ̂<sub>i</sub></italic> + <italic>
f̂<sub>i</sub></italic> (<italic>y<sub>j</sub></italic>), then by construction the last <italic>df</italic> eigenvalues are exactly zero and we remove them from consideration. For eigengene <italic>k</italic>=1,..., <italic>n</italic>-<italic>df</italic> set the observed statistic to be
<disp-formula id="pgen-0030161-e002"><graphic xlink:href="pgen.0030161.e002.jpg" position="anchor" mimetype="image"/></disp-formula>which is the variance explained by the <italic>k</italic>th eigengene.
</p>
      <p>4. Form a matrix <bold>R<sup>*</sup></bold> by permuting each row of <bold>R</bold> independently to remove any structure in the matrix. Denote the (<italic>i</italic>, <italic>j</italic>) entry of <bold>R<sup>*</sup></bold> by <inline-formula id="pgen-0030161-ex014"><inline-graphic xlink:href="pgen.0030161.ex014.jpg" mimetype="image"/></inline-formula>
.
</p>
      <p>5. Fit the model <inline-formula id="pgen-0030161-ex015"><inline-graphic xlink:href="pgen.0030161.ex015.jpg" mimetype="image"/></inline-formula>
and calculate the residuals <inline-formula id="pgen-0030161-ex016"><inline-graphic xlink:href="pgen.0030161.ex016.jpg" mimetype="image"/></inline-formula>
to form the <italic>m</italic> × <italic>n</italic> model-subtracted null matrix <bold>R</bold><sub>0</sub>.
</p>
      <p>6. Calculate the singular value decomposition of the centered and permuted expression matrix <bold>R</bold><sub>0</sub> = <bold>U</bold><sub>0</sub><bold>D</bold><sub>0</sub><inline-formula id="pgen-0030161-ex017"><inline-graphic xlink:href="pgen.0030161.ex017.jpg" mimetype="image"/></inline-formula>
.
</p>
      <p>7. For eigengene <italic>k</italic> form a null statistic
<disp-formula id="pgen-0030161-e003"><graphic xlink:href="pgen.0030161.e003.jpg" position="anchor" mimetype="image"/></disp-formula>as above, where <italic>d</italic><sub>0ℓ</sub> is the ℓth diagonal element of <bold>D</bold><sub>0</sub>.
</p>
      <p>8. Repeat steps 4−7 a total of <italic>B</italic> times to obtain null statistics <inline-formula id="pgen-0030161-ex018"><inline-graphic xlink:href="pgen.0030161.ex018.jpg" mimetype="image"/></inline-formula>
for <italic>b</italic> = 1,...,<italic>B</italic> and <italic>k</italic> = 1,...,<italic>n</italic>-<italic>df</italic>.
</p>
      <p>9. Compute the <italic>p</italic>-value for eigengene <italic>k</italic> as:
<disp-formula id="pgen-0030161-e004"><graphic xlink:href="pgen.0030161.e004.jpg" position="anchor" mimetype="image"/></disp-formula>
</p>
      <p>Since eigengene <italic>k</italic> should be significant whenever eigengene <italic>k</italic>′ is (where <italic>k</italic>′&gt;<italic>k</italic>), we conservatively force monotonicity among the <italic>p</italic>-values. Thus, set <italic>p<sub>k</sub></italic> = max (<italic>p<sub>k</sub></italic><sub>−1</sub>, <italic>p<sub>k</sub></italic>) for <italic>k</italic> = 2,...,<italic>n</italic>-<italic>df</italic>.</p>
      <p>10. For a user-chosen significance level 0≤α≤1, call eigengene <italic>k</italic> a significant signature of residual EH if <italic>p<sub>k</sub></italic> ≤ α.</p>
      <p>Algorithm to construct surrogate variables.</p>
      <p>1. Form estimates <inline-formula id="pgen-0030161-ex019"><inline-graphic xlink:href="pgen.0030161.ex019.jpg" mimetype="image"/></inline-formula>
and <inline-formula id="pgen-0030161-ex020"><inline-graphic xlink:href="pgen.0030161.ex020.jpg" mimetype="image"/></inline-formula>
by fitting the model <italic>x<sub>ij</sub></italic>.= <italic>μ<sub>i</sub></italic> + <italic>f<sub>i</sub></italic>(<italic>y<sub>j</sub></italic>) + <italic>e<sub>ij</sub></italic>, and calculate the residuals r<italic><sub>ij</sub></italic> = <italic>x<sub>ij</sub></italic> −<inline-formula id="pgen-0030161-ex021"><inline-graphic xlink:href="pgen.0030161.ex021.jpg" mimetype="image"/></inline-formula>
(<italic>y<sub>j</sub></italic>) to remove the effect of the primary variable on expression. Form the <italic>m</italic> × <italic>n</italic> residual matrix <bold>R</bold>, where the (<italic>i</italic>, <italic>j</italic>) element of <bold>R</bold> is <italic>r<sub>ij</sub></italic>.
</p>
      <p>2. Calculate the singular value decomposition of the residual expression matrix <bold>R</bold> = <bold>UDV</bold><italic><sup>T</sup></italic>. Let <bold>e</bold><italic><sub>k</sub></italic> = (e<italic><sub>k</sub></italic><sub>1</sub><italic>,...,</italic>e<italic><sub>kn</sub></italic>)<italic><sup>T</sup></italic> be the <italic>k</italic>th column of <bold>V</bold> (for <italic>k</italic>=1,...,<italic>n</italic>). These <bold>e</bold><italic><sub>k</sub></italic> are the residual eigengenes and represent orthogonal residual EH signals independent of the signal due to the primary variable.</p>
      <p>3. Set <inline-formula id="pgen-0030161-ex022"><inline-graphic xlink:href="pgen.0030161.ex022.jpg" mimetype="image"/></inline-formula>
to the number of significant eigengenes found by the above algorithm. Note that “significant” means that the eigengene represents a greater proportion of variation than expected by chance.
</p>
      <p><italic>For each significant eigengene</italic><bold>e</bold><italic><sub>k</sub> k=1,...,</italic><inline-formula id="pgen-0030161-ex023"><inline-graphic xlink:href="pgen.0030161.ex023.jpg" mimetype="image"/></inline-formula>
.
</p>
      <p>4. Regress <bold>e</bold><italic><sub>k</sub></italic> on the <bold>x</bold><italic><sub>i</sub></italic> (<italic>i</italic> = 1,...,<italic>m</italic>) and calculate a <italic>p</italic>-value testing for an association between the residual eigengene and each gene's expression. This <italic>p</italic>-value measures the strength of association between the residual eigengene <bold>e</bold><italic><sub>k</sub></italic> and the expression for gene <italic>i</italic>.</p>
      <p>5. Let <italic>π</italic><sub>0</sub> be the proportion of genes with expression not truly associated with <bold>e</bold><italic><sub>k</sub></italic>; form an estimate <inline-formula id="pgen-0030161-ex024"><inline-graphic xlink:href="pgen.0030161.ex024.jpg" mimetype="image"/></inline-formula>
, as described previously [<xref rid="pgen-0030161-b023" ref-type="bibr">23</xref>] and estimate the number of genes associated with the residual eigengene by <inline-formula id="pgen-0030161-ex025"><inline-graphic xlink:href="pgen.0030161.ex025.jpg" mimetype="image"/></inline-formula>
. Let <inline-formula id="pgen-0030161-ex026"><inline-graphic xlink:href="pgen.0030161.ex026.jpg" mimetype="image"/></inline-formula>
be the indices of the genes with <inline-formula id="pgen-0030161-ex027"><inline-graphic xlink:href="pgen.0030161.ex027.jpg" mimetype="image"/></inline-formula>
smallest <italic>p</italic>-values from this test.
</p>
      <p>6. Form the <inline-formula id="pgen-0030161-ex028"><inline-graphic xlink:href="pgen.0030161.ex028.jpg" mimetype="image"/></inline-formula>
× <italic>n</italic> reduced expression matrix <inline-formula id="pgen-0030161-ex029"><inline-graphic xlink:href="pgen.0030161.ex029.jpg" mimetype="image"/></inline-formula>
. Since <inline-formula id="pgen-0030161-ex030"><inline-graphic xlink:href="pgen.0030161.ex030.jpg" mimetype="image"/></inline-formula>
is an estimate of the number of genes associated with residual eigengene <italic>k</italic>, the reduced expression matrix represents the expression of those genes estimated to contain the EH signature represented by some <bold>h</bold><italic><sub>k</sub></italic> as described above. As was done for <bold>R</bold>, calculate the eigengenes of <bold>X</bold><italic><sub>r</sub></italic>, and denote these by <inline-formula id="pgen-0030161-ex031"><inline-graphic xlink:href="pgen.0030161.ex031.jpg" mimetype="image"/></inline-formula>
for <italic>j</italic>=1,...,<italic>n</italic>.
</p>
      <p>7. Let <italic>j</italic><sup>*</sup> = argmax<sub>1≤<italic>j</italic>≤<italic>n</italic></sub>
<bold>cor</bold>
<inline-formula id="pgen-0030161-ex032"><inline-graphic xlink:href="pgen.0030161.ex032.jpg" mimetype="image"/></inline-formula>
and set <inline-formula id="pgen-0030161-ex033"><inline-graphic xlink:href="pgen.0030161.ex033.jpg" mimetype="image"/></inline-formula>
. In other words, set the estimate of the surrogate variable to be the eigengene of the reduced matrix most correlated with the corresponding residual eigengene. Since the reduced matrix is enriched for genes associated with this residual eigengene, this is a principled choice for the estimated surrogate variable that allows for correlation with the primary variable.
</p>
      <p>8. In any subsequent analysis, employ the model <italic>x<sub>ij</sub></italic> = <italic>μ<sub>i</sub></italic> + <italic>f<sub>i</sub></italic>(<italic>y<sub>j</sub></italic>) + <inline-formula id="pgen-0030161-ex034"><inline-graphic xlink:href="pgen.0030161.ex034.jpg" mimetype="image"/></inline-formula>
, which serves as an estimate of the ideal model <italic>x<sub>ij</sub></italic> = <italic>μ<sub>i</sub></italic> + <italic>f<sub>i</sub></italic>(<italic>y<sub>j</sub></italic>) + <inline-formula id="pgen-0030161-ex035"><inline-graphic xlink:href="pgen.0030161.ex035.jpg" mimetype="image"/></inline-formula>
.
</p>
      <p>The singular value decomposition is employed in these SVA algorithms. It may be possible to utilize other decomposition methods, but since the singular value decomposition provides uncorrelated variables that decompose the data in an additive linear fashion with the goal of minimizing the sum of squares, we found this to be the most appropriate decomposition. If the primary variables are modeled for data that are not continuous, then it may make sense to decompose the variation with respect to whatever model-fitting criteria will be employed</p>
    </sec>
    <sec id="s4g">
      <title>Software.</title>
      <p>SVA has been made freely available as an R package at <ext-link ext-link-type="uri" xlink:href="http://www.genomine.org/sva/">http://www.genomine.org/sva/</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="s5">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pgen-0030161-sg001">
      <label>Figure S1</label>
      <caption>
        <title>Examples of Expression Heterogeneity</title>
        <p>Heatmaps of hierarchically clustered gene expression data for a random subset of 1,000 genes from three studies are shown. (A) Hedenfalk et al. [<xref rid="pgen-0030161-b022" ref-type="bibr">22</xref>] compared gene expression across tumor subtypes defined by germline <italic>BRCA</italic> mutations (yellow divides <italic>BRCA</italic> tumor subtypes), (B) Brem et al. [<xref rid="pgen-0030161-b010" ref-type="bibr">10</xref>,<xref rid="pgen-0030161-b021" ref-type="bibr">21</xref>] measured expression in naturally recombining yeast populations, and (C) Rodwell et al. [<xref rid="pgen-0030161-b007" ref-type="bibr">7</xref>] measured gene expression in kidney samples for patients ranging in age from 27–92 y.</p>
        <p>(849 KB PDF)</p>
      </caption>
      <media xlink:href="pgen.0030161.sg001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen-0030161-sg002">
      <label>Figure S2</label>
      <caption>
        <title>Unadjusted <italic>p</italic>-Values Show Bias and Fluctuations</title>
        <p>Histograms of the null <italic>p-</italic>values for nine independent realizations of the simulated gene expression data. The null <italic>p-</italic>values should be Uniformly distributed, or “flat,” for each experiment. However, across independently simulated datasets, the null <italic>p-</italic>values range from being conservatively biased to anticonservatively biased depending on the configuration of the unmeasured or unmodeled factor.</p>
        <p>(17 KB PDF)</p>
      </caption>
      <media xlink:href="pgen.0030161.sg002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen-0030161-sg003">
      <label>Figure S3</label>
      <caption>
        <title>SVA-Adjusted <italic>p</italic>-Values Are Uniform</title>
        <p>Histograms of the null <italic>p-</italic>values for nine independent realizations of the simulated gene expression experiment, adjusted by SVA. The <italic>p-</italic>values for the null genes in each simulated experiment are Uniformly distributed. None of these deviates from the Uniform according to a Kolmogorov-Smirnov test.</p>
        <p>(18 KB PDF)</p>
      </caption>
      <media xlink:href="pgen.0030161.sg003.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen-0030161-sg004">
      <label>Figure S4</label>
      <caption>
        <title>Behavior of Simulated Null <italic>p</italic>-Values from Microarray Data</title>
        <p>For each simulated dataset based on the permuted residuals from the Hedenfalk et al. study, a nested Kolmogorov-Smirnov test was employed to assess whether the <italic>p-</italic>values of null genes followed the correct null Uniform distribution. A quantile–quantile plot of the one thousand Kolmogorov-Smirnov <italic>p-</italic>values are shown for the SVA-adjusted analysis (solid line) and the unadjusted analysis (dashed line). The grey line represents the expected quantiles. It can be seen that the SVA-adjusted analysis provides correctly distributed null <italic>p-</italic>values, whereas the unadjusted analysis does not, due to EH.</p>
        <p>(62 KB PDF)</p>
      </caption>
      <media xlink:href="pgen.0030161.sg004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen-0030161-sg005">
      <label>Figure S5</label>
      <caption>
        <title>Effect of EH on Gene Ranks</title>
        <p>A plot of the true rank (according to signal-to-noise ratio) versus the significance test–based average rank (black) plus or minus one standard deviation (red) for each differentially expressed gene in simulated studies (A) affected by EH with an unadjusted analysis, (B) affected by EH with an SVA-adjusted analysis, and (C) unaffected by EH.</p>
        <p>(439 KB PDF)</p>
      </caption>
      <media xlink:href="pgen.0030161.sg005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen-0030161-sg006">
      <label>Figure S6</label>
      <caption>
        <title>Effect of SVA on FDR Calculations</title>
        <p>(A) A histogram of the estimates of the proportion of true nulls <italic>π</italic><sub>0</sub> for studies affected by EH. (B) A histogram of the estimates of the proportion of true nulls <italic>π</italic><sub>0</sub> for studies affected by EH, after adjusting for SVA. (C) A histogram of the estimates of the proportion of true nulls <italic>π</italic><sub>0</sub> for studies without EH. (D) A plot of observed FDR versus true FDR (grey) and average observed FDR versus true FDR (red) for simulated studies affected by EH. (E) A plot of observed FDR versus true FDR (grey) and average observed FDR versus true FDR (red) for simulated studies affected by EH, adjusted by SVA. (F) A plot of observed FDR versus true FDR (grey) and average observed FDR versus true FDR (red) for simulated studies without EH.</p>
        <p>(265 KB PDF)</p>
      </caption>
      <media xlink:href="pgen.0030161.sg006.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen-0030161-sg007">
      <label>Figure S7</label>
      <caption>
        <title>BRCA Surrogate Variables</title>
        <p>(A) A plot of the top surrogate variable from the breast cancer data of Hedenfalk et al. [<xref rid="pgen-0030161-b022" ref-type="bibr">22</xref>]; triangles are <italic>BRCA1</italic>, pluses are <italic>BRCA2</italic>. (B) A plot of the expression for eukaryotic translation initiation factor 2, <italic>EIF2S2</italic>, which follows a similar pattern to the top surrogate variable.</p>
        <p>(87 KB PDF)</p>
      </caption>
      <media xlink:href="pgen.0030161.sg007.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen-0030161-sg008">
      <label>Figure S8</label>
      <caption>
        <title>SVA-Induced Change in Gene Ranking for Differential Expression</title>
        <p>A plot of the <italic>p-</italic>value rankings for the SVA-adjusted versus unadjusted significance analysis of the breast cancer data [<xref rid="pgen-0030161-b022" ref-type="bibr">22</xref>], showing substantial differences in the rankings obtained from the two analyses. The red line represents equality of ranking between the two procedures.</p>
        <p>(181 KB PDF)</p>
      </caption>
      <media xlink:href="pgen.0030161.sg008.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen-0030161-sg009">
      <label>Figure S9</label>
      <caption>
        <title>Regression on Standard Eigengenes (Version 1) Adjusted <italic>p</italic>-Values</title>
        <p>Histograms of the null <italic>p-</italic>values for nine independent realizations of the simulated gene expression experiment, after adjustment by the first regression on standard eigengenes algorithm.</p>
        <p>(16 KB PDF)</p>
      </caption>
      <media xlink:href="pgen.0030161.sg009.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen-0030161-sg010">
      <label>Figure S10</label>
      <caption>
        <title>Regression on Standard Eigengenes (Version 2) Adjusted <italic>p</italic>-Values</title>
        <p>Histograms of the null <italic>p-</italic>values for nine independent realizations of the simulated gene expression experiment, after adjustment by the second regression on standard eigengenes algorithm.</p>
        <p>(16 KB PDF)</p>
      </caption>
      <media xlink:href="pgen.0030161.sg010.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen-0030161-sg011">
      <label>Figure S11</label>
      <caption>
        <title>“Empirical Null” <italic>p</italic>-Values Show Bias</title>
        <p>For 1,000 simulated datasets based on the Normal residuals, a nested Kolmogorov-Smirnov test was employed to assess whether the <italic>p-</italic>values of null genes followed the correct null Uniform distribution. A quantile–quantile plot of the one thousand Kolmogorov-Smirnov <italic>p-</italic>values are shown for the SVA-adjusted analysis (solid line) and the “Empirical Null” technique [<xref rid="pgen-0030161-b031" ref-type="bibr">31</xref>,<xref rid="pgen-0030161-b032" ref-type="bibr">32</xref>]. The grey line represents the expected quantiles. It can be seen that the SVA-adjusted analysis provides correctly distributed null <italic>p-</italic>values, whereas the “Empirical Null” adjusted null <italic>p-</italic>values do not.</p>
        <p>(62 KB PDF)</p>
      </caption>
      <media xlink:href="pgen.0030161.sg011.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen-0030161-se001">
      <label>Text S1</label>
      <caption>
        <title>Supplementary Text for Capturing Heterogeneity in Gene Expression Studies by Surrogate Variable Analysis</title>
        <p>(50 KB PDF)</p>
      </caption>
      <media xlink:href="pgen.0030161.sd001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank the investigators of the Inflammation and the Host Response to Injury Consortium (<ext-link ext-link-type="uri" xlink:href="http://www.gluegrant.org/">http://www.gluegrant.org/</ext-link>) for their helpful feedback and support on this work. We also thank Gary Churchill for several helpful conversations related to this work.</p>
  </ack>
  <fn-group>
    <fn id="n102" fn-type="previously-at">
      <p>A previous version of this article appeared as an Early Online Release on August 1, 2007 (doi:<ext-link ext-link-type="doi" xlink:href="10.1371/journal.pgen.0030161.eor">10.1371/journal.pgen.0030161.eor</ext-link>).</p>
    </fn>
    <fn id="ack1" fn-type="con">
      <p><bold>Author contributions.</bold> JTL and JDS conceived and designed the experiments, performed the experiments, contributed reagents/materials/analysis tools, and wrote the paper. JTL analyzed the data.</p>
    </fn>
    <fn id="ack2" fn-type="financial-disclosure">
      <p><bold>Funding.</bold> This research was supported in part by NIH grants U54 GM2119 (PI: Ronald Tompkins) and R01 HG002913.</p>
    </fn>
    <fn id="ack3" fn-type="COI-statement">
      <p><bold>Competing interests.</bold> The authors have declared that no competing interests exist.</p>
    </fn>
  </fn-group>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>EH</term>
        <def>
          <p>expression heterogeneity</p>
        </def>
      </def-item>
      <def-item>
        <term>FDR</term>
        <def>
          <p>false discovery rate</p>
        </def>
      </def-item>
      <def-item>
        <term>QTL</term>
        <def>
          <p>quantitative trait locus</p>
        </def>
      </def-item>
      <def-item>
        <term>SVA</term>
        <def>
          <p>surrogate variable analysis</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <ref-list>
    <title>References</title>
    <ref id="pgen-0030161-b001">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qiu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Xiao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Gordon</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yakovlev</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>Assessing stability of gene selection in microarray data analysis</article-title>
        <source>BMC Bioinformatics</source>
        <volume>7</volume>
        <fpage>50</fpage>
        <pub-id pub-id-type="pmid">16451725</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b002">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Klebanov</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yakovlev</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>Treating expression levels of different genes as a sample in microarray data analysis: is it worth a risk?</article-title>
        <source>Stat Appl Genet Mol Biol</source>
        <volume>5</volume>
        <fpage>art9</fpage>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b003">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kerr</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Churchill</surname>
            <given-names>GA</given-names>
          </name>
        </person-group>
        <year>2000</year>
        <article-title>Analysis of variance for gene expression microarray data</article-title>
        <source>J Comput Biol</source>
        <volume>7</volume>
        <fpage>819</fpage>
        <lpage>837</lpage>
        <pub-id pub-id-type="pmid">11382364</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b004">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kerr</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Churchill</surname>
            <given-names>GA</given-names>
          </name>
        </person-group>
        <year>2001</year>
        <article-title>Experimental design for gene expression microarrays</article-title>
        <source>Biostatistics</source>
        <volume>2</volume>
        <fpage>183</fpage>
        <lpage>201</lpage>
        <pub-id pub-id-type="pmid">12933549</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b005">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Holter</surname>
            <given-names>NS</given-names>
          </name>
          <name>
            <surname>Mitra</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Maritan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cieplak</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Banavar</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2000</year>
        <article-title>Fundamental patterns underlying gene expression profiles: simplicity from complexity</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <volume>97</volume>
        <fpage>8409</fpage>
        <lpage>8414</lpage>
        <pub-id pub-id-type="pmid">10890920</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b006">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gasch</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Spellman</surname>
            <given-names>PT</given-names>
          </name>
          <name>
            <surname>Kao</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Carmel-Harel</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Eisen</surname>
            <given-names>MB</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2000</year>
        <article-title>Genomic expression programs in the response of yeast cells to environmental changes</article-title>
        <source>Mol Biol Cell</source>
        <volume>11</volume>
        <fpage>4241</fpage>
        <lpage>4257</lpage>
        <pub-id pub-id-type="pmid">11102521</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b007">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rodwell</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Sonu</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Zahn</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Lund</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wilhelmy</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2004</year>
        <article-title>A transcriptional profile of aging in the human kidney</article-title>
        <source>PLoS Biol</source>
        <volume>2</volume>
        <fpage>2191</fpage>
        <lpage>2201</lpage>
        <comment>doi:<ext-link ext-link-type="doi" xlink:href="10.1371/journal.pbio.0020427">10.1371/journal.pbio.0020427</ext-link></comment>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b008">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Xiao</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>T</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Tompkins</surname>
            <given-names>RG</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>RW</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>Significance analysis of time course microarray experiments</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <volume>102</volume>
        <fpage>12837</fpage>
        <lpage>12842</lpage>
        <pub-id pub-id-type="pmid">16141318</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b009">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DeRisi</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Iyer</surname>
            <given-names>VR</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>PO</given-names>
          </name>
        </person-group>
        <year>1997</year>
        <article-title>Exploring the metabolic and genetic control of gene expression on a genomic scale</article-title>
        <source>Science</source>
        <volume>278</volume>
        <fpage>680</fpage>
        <lpage>686</lpage>
        <pub-id pub-id-type="pmid">9381177</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b010">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brem</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Yvert</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Clinton</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kruglyak</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <year>2002</year>
        <article-title>Genetic dissection of transcriptional regulation in budding yeast</article-title>
        <source>Science</source>
        <volume>296</volume>
        <fpage>752</fpage>
        <lpage>755</lpage>
        <pub-id pub-id-type="pmid">11923494</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b011">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schadt</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Monks</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Drake</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Lusis</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Che</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2003</year>
        <article-title>Genetics of gene expression surveyed in maize, mouse and man</article-title>
        <source>Nature</source>
        <volume>422</volume>
        <fpage>297</fpage>
        <lpage>302</lpage>
        <pub-id pub-id-type="pmid">12646919</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b012">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tseng</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Oh</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rohlin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Liao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <year>2001</year>
        <article-title>Issues in cDNA microarray analysis: quality filtering, channel normalization, models of variations and assessment of gene effects</article-title>
        <source>Nucleic Acids Res</source>
        <volume>29</volume>
        <fpage>2540</fpage>
        <lpage>2557</lpage>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b013">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Luu</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2002</year>
        <article-title>Normalization for cDNA microarray data: a robust composite method addressing single and multiple slide systematic variation</article-title>
        <source>Nucleic Acids Res</source>
        <volume>30</volume>
        <fpage>e15</fpage>
        <pub-id pub-id-type="pmid">11842121</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b014">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qui</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Klebanov</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yakovlev</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>Correlation between gene expression levels and limitations of the empirical bayes methodology for finding differentially expressed genes</article-title>
        <source>Stat Appl Genet Mol Biol</source>
        <volume>4</volume>
        <fpage>art34</fpage>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b015">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morley</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Molony</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Devlin</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Ewens</surname>
            <given-names>KG</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2004</year>
        <article-title>Genetic analysis of genome-wide variation in human gene expression</article-title>
        <source>Nature</source>
        <volume>430</volume>
        <fpage>743</fpage>
        <lpage>747</lpage>
        <pub-id pub-id-type="pmid">15269782</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b016">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rhodes</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Chinnaiyan</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>Integrative analysis of the cancer transcriptome</article-title>
        <source>Nat Genet</source>
        <volume>37</volume>
        <fpage>31</fpage>
        <lpage>37</lpage>
        <pub-id pub-id-type="pmid">15608638</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b017">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Sam</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Tsimelzon</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2006</year>
        <article-title>Molecular heterogeneity of inflammatory breast cancer: A hyperproliferative phenotype</article-title>
        <source>Clin Cancer Res</source>
        <volume>12</volume>
        <fpage>5047</fpage>
        <lpage>5054</lpage>
        <pub-id pub-id-type="pmid">16951220</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b018">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Amundson</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Bittner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Trent</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Meltzer</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <year>1999</year>
        <article-title>Flourescent cdna microarray hybridization reveals complexity and heterogeneity of cellular genotoxic stress response</article-title>
        <source>Oncogene</source>
        <volume>18</volume>
        <fpage>3666</fpage>
        <lpage>3672</lpage>
        <pub-id pub-id-type="pmid">10380890</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b019">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lamb</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Crawford</surname>
            <given-names>ED</given-names>
          </name>
          <name>
            <surname>Peck</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Modell</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Blat</surname>
            <given-names>IC</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2006</year>
        <article-title>The connectivity map: using gene-expression signatures to connect small molecules, genes and disease</article-title>
        <source>Science</source>
        <volume>313</volume>
        <fpage>1929</fpage>
        <lpage>1935</lpage>
        <pub-id pub-id-type="pmid">17008526</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b020">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dabney</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>A new approach to intensity-dependent normalization of two-channel microarrays</article-title>
        <source>Biostatistics</source>
        <volume>8</volume>
        <fpage>128</fpage>
        <lpage>139</lpage>
        <pub-id pub-id-type="pmid">16636140</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b021">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brem</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Whittle</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kruglyak</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>Genetic interactions between polymorphisms that affect gene expression in yeast</article-title>
        <source>Nature</source>
        <volume>436</volume>
        <fpage>701</fpage>
        <lpage>703</lpage>
        <pub-id pub-id-type="pmid">16079846</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b022">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hedenfalk</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Duggan</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Radmacher</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bittner</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2001</year>
        <article-title>Gene-expression profiles in hereditary breast cancer</article-title>
        <source>New Engl J Med</source>
        <volume>344</volume>
        <fpage>539</fpage>
        <lpage>548</lpage>
        <pub-id pub-id-type="pmid">11207349</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b023">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2003</year>
        <article-title>Statistical significance for genome-wide studies</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <volume>100</volume>
        <fpage>9440</fpage>
        <lpage>9445</lpage>
        <pub-id pub-id-type="pmid">12883005</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b024">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dabney</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>A reanalysis of a published Affymetrix genechip control dataset</article-title>
        <source>Genome Biol</source>
        <volume>7</volume>
        <fpage>401</fpage>
        <pub-id pub-id-type="pmid">16563185</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b025">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Rice</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <year>1995</year>
        <source>Mathematical statistics and data analysis. 2nd edition</source>
        <publisher-loc>Belmont (California)</publisher-loc>
        <publisher-name>Duxbury Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b026">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <year>2002</year>
        <article-title>A direct approach to false discovery rates</article-title>
        <source>J Royal Stat Soc Ser B</source>
        <volume>64</volume>
        <fpage>479</fpage>
        <lpage>498</lpage>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b027">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buja</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eyuboglu</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <year>1992</year>
        <article-title>Remarks on parallel analysis</article-title>
        <source>Multivariate Behav Res</source>
        <volume>27</volume>
        <fpage>509</fpage>
        <lpage>540</lpage>
        <pub-id pub-id-type="pmid">26811132</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b028">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Lehman</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Romano</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <source>Testing statistical hypotheses</source>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer-Verlag</publisher-name>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b029">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Owen</surname>
            <given-names>AB</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>Variance of the number of false discoveries</article-title>
        <source>J Royal Stat Soc Ser B</source>
        <volume>67</volume>
        <fpage>411</fpage>
        <lpage>426</lpage>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b030">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qiu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Yakovlev</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>Some comments on instability of false discovery rate estimation</article-title>
        <source>J Bioinform Comput Biol</source>
        <volume>4</volume>
        <fpage>1057</fpage>
        <lpage>1068</lpage>
        <pub-id pub-id-type="pmid">17099941</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b031">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <year>2004</year>
        <article-title>Large-scale simultaneous hypothesis testing: the choice of a null hypothesis</article-title>
        <source>J Am Stat Assoc</source>
        <volume>99</volume>
        <fpage>96</fpage>
        <lpage>104</lpage>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b032">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>Correlation and large-scale simultaneous significance testing</article-title>
        <source>J Am Stat Assoc</source>
        <volume>102</volume>
        <fpage>93</fpage>
        <lpage>103</lpage>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b033">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cai</surname>
            <given-names>GQ</given-names>
          </name>
          <name>
            <surname>Sarkar</surname>
            <given-names>SK</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>Modified simes' critical values under positive dependence</article-title>
        <source>J Stat Plan Inference</source>
        <volume>136</volume>
        <fpage>4129</fpage>
        <lpage>4146</lpage>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b034">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yekultieli</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>2001</year>
        <article-title>The control of the false discovery rate in multiple testing under dependency</article-title>
        <source>Ann Stat</source>
        <volume>29</volume>
        <fpage>1165</fpage>
        <lpage>1188</lpage>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b035">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pawitan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Calza</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ploner</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>Estimation of false discovery proportion under general dependence</article-title>
        <source>Bioinformatics</source>
        <volume>22</volume>
        <fpage>3025</fpage>
        <lpage>3031</lpage>
        <pub-id pub-id-type="pmid">17046978</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b036">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yvert</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Brem</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Whittle</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Akey</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Foss</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2003</year>
        <article-title><italic>Trans</italic>-acting regulatory variation in <named-content content-type="genus-species">Saccharomyces cerevisiae</named-content> and the role of transcription factors</article-title>
        <source>Nat Genet</source>
        <volume>35</volume>
        <fpage>57</fpage>
        <lpage>64</lpage>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b037">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eisen</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Spellman</surname>
            <given-names>PT</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>PO</given-names>
          </name>
          <name>
            <surname>Botstein</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>1998</year>
        <article-title>Cluster analysis and display of genome-wide expression patterns Proc</article-title>
        <source>Natl Acad Sci U S A</source>
        <volume>95</volume>
        <fpage>14863</fpage>
        <lpage>14868</lpage>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b038">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hedenfalk</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Ringer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ben-Dor</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yakhini</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2003</year>
        <article-title>Molecular classification of familial non-brca1/brca2 breast cancer</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <volume>100</volume>
        <fpage>2532</fpage>
        <lpage>2537</lpage>
        <pub-id pub-id-type="pmid">12610208</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b039">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Mardia</surname>
            <given-names>KV</given-names>
          </name>
          <name>
            <surname>Kent</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Bibby</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <year>1980</year>
        <source>Multivariate analysis</source>
        <publisher-loc>London</publisher-loc>
        <publisher-name>Academic Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b040">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alter</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>PO</given-names>
          </name>
          <name>
            <surname>Botstein</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>2000</year>
        <article-title>Singular value decomposition for genome-wide expression data processing and modeling</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <volume>97</volume>
        <fpage>10101</fpage>
        <lpage>10106</lpage>
        <pub-id pub-id-type="pmid">10963673</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b041">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Patterson</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Plenge</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Weinblatt</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>SN</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2006</year>
        <article-title>Principal components analysis corrects for stratification in genome-wide association studies</article-title>
        <source>Nat Genet</source>
        <volume>38</volume>
        <fpage>904</fpage>
        <lpage>909</lpage>
        <pub-id pub-id-type="pmid">16862161</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b042">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Akey</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Kruglyak</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>Multiple locus linkage analysis of genomewide expression in yeast</article-title>
        <source>PLoS Biol</source>
        <volume>3</volume>
        <fpage>1380</fpage>
        <lpage>1390</lpage>
        <elocation-id>e267</elocation-id>
        <comment>doi:<ext-link ext-link-type="doi" xlink:href="10.1371/journal.pbio.0030267">10.1371/journal.pbio.0030267</ext-link></comment>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b043">
      <element-citation publication-type="book">
        <collab>R Development Core Team</collab>
        <year>2004</year>
        <source>R: a language and environment for statistical computing</source>
        <publisher-loc>Vienna</publisher-loc>
        <publisher-name>R Foundation for Statistical Computing</publisher-name>
      </element-citation>
    </ref>
    <ref id="pgen-0030161-b044">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>1990</year>
        <source>Generalized additive models</source>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Chapman &amp; Hall</publisher-name>
      </element-citation>
    </ref>
  </ref-list>
</back>
