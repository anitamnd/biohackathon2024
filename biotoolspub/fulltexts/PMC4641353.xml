<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4641353</article-id>
    <article-id pub-id-type="pmid">26554718</article-id>
    <article-id pub-id-type="publisher-id">812</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-015-0812-9</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>QQ-SNV: single nucleotide variant detection at low frequency by comparing the quality quantiles</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Van der Borght</surname>
          <given-names>Koen</given-names>
        </name>
        <address>
          <email>kvdborgh@its.jnj.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Thys</surname>
          <given-names>Kim</given-names>
        </name>
        <address>
          <email>kthys@its.jnj.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wetzels</surname>
          <given-names>Yves</given-names>
        </name>
        <address>
          <email>ywetzel@its.jnj.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Clement</surname>
          <given-names>Lieven</given-names>
        </name>
        <address>
          <email>lieven.clement@ugent.be</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Verbist</surname>
          <given-names>Bie</given-names>
        </name>
        <address>
          <email>bverbis2@its.jnj.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Reumers</surname>
          <given-names>Joke</given-names>
        </name>
        <address>
          <email>jreumers@its.jnj.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>van Vlijmen</surname>
          <given-names>Herman</given-names>
        </name>
        <address>
          <email>hvvlijme@its.jnj.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Aerssens</surname>
          <given-names>Jeroen</given-names>
        </name>
        <address>
          <email>jaerssen@its.jnj.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0623 0341</institution-id><institution-id institution-id-type="GRID">grid.419619.2</institution-id><institution/><institution>Janssen Infectious Diseases-Diagnostics BVBA, </institution></institution-wrap>B-2340 Beerse, Belgium </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0668 7884</institution-id><institution-id institution-id-type="GRID">grid.5596.f</institution-id><institution>Interuniversity Institute for Biostatistics and statistical Bioinformatics, </institution><institution>Katholieke Universiteit Leuven, </institution></institution-wrap>B-3000 Leuven, Belgium </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2069 7798</institution-id><institution-id institution-id-type="GRID">grid.5342.0</institution-id><institution/><institution>Ghent University, Applied Mathematics, Informatics and Statistics, </institution></institution-wrap>B-9000 Ghent, Belgium </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>10</day>
      <month>11</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2015</year>
    </pub-date>
    <volume>16</volume>
    <elocation-id>379</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>7</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>31</day>
        <month>10</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Van der Borght et al. 2015</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Next generation sequencing enables studying heterogeneous populations of viral infections. When the sequencing is done at high coverage depth (“deep sequencing”), low frequency variants can be detected. Here we present QQ-SNV (<ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/qqsnv">http://sourceforge.net/projects/qqsnv</ext-link>), a logistic regression classifier model developed for the Illumina sequencing platforms that uses the quantiles of the quality scores, to distinguish <italic>true</italic> single nucleotide variants from sequencing errors based on the estimated SNV probability. To train the model, we created a dataset of an <italic>in silico</italic> mixture of five HIV-1 plasmids. Testing of our method in comparison to the existing methods LoFreq, ShoRAH, and V-Phaser 2 was performed on two HIV and four HCV plasmid mixture datasets and one influenza H1N1 clinical dataset.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>For default application of QQ-SNV, variants were called using a SNV probability cutoff of 0.5 (QQ-SNV<sub>D</sub>). To improve the sensitivity we used a SNV probability cutoff of 0.0001 (QQ-SNV<sub>HS</sub>). To also increase specificity, SNVs called were overruled when their frequency was below the 80<sup>th</sup> percentile calculated on the distribution of error frequencies (QQ-SNV<sub>HS-P80</sub>).</p>
        <p>When comparing QQ-SNV versus the other methods on the plasmid mixture test sets, QQ-SNV<sub>D</sub> performed similarly to the existing approaches. QQ-SNV<sub>HS</sub> was more sensitive on all test sets but with more false positives. QQ-SNV<sub>HS-P80</sub> was found to be the most accurate method over all test sets by balancing sensitivity and specificity. When applied to a paired-end HCV sequencing study, with lowest spiked-in <italic>true</italic> frequency of 0.5 %, QQ-SNV<sub>HS-P80</sub> revealed a sensitivity of 100 % (<italic>vs.</italic> 40–60 % for the existing methods) and a specificity of 100 % (<italic>vs.</italic> 98.0–99.7 % for the existing methods). In addition, QQ-SNV required the least overall computation time to process the test sets.</p>
        <p>Finally, when testing on a clinical sample, four putative <italic>true</italic> variants with frequency below 0.5 % were consistently detected by QQ-SNV<sub>HS-P80</sub> from different generations of Illumina sequencers.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>We developed and successfully evaluated a novel method, called QQ-SNV, for highly efficient single nucleotide variant calling on Illumina deep sequencing virology data.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s12859-015-0812-9) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Classifier model</kwd>
      <kwd>Illumina deep sequencing</kwd>
      <kwd>Logistic regression</kwd>
      <kwd>Single nucleotide variant</kwd>
      <kwd><italic>True</italic> variant</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2015</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Background</title>
    <p>Next generation sequencing (NGS) at high coverage depth (deep sequencing) has proven to be valuable within clinical virology [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR4">4</xref>]. In order to guide the treatment of HIV-1 patients, the viral DNA is routinely sequenced to study the accumulation over time of resistance associated mutations to antiretroviral drugs. With the advent of NGS technologies, single nucleotide variants (SNVs) present at low prevalence (minor variants) can be detected, whereas with traditional Sanger sequencing, SNVs could be identified only when present in &gt;20 % of the genomes in a patient’s sample. However, as NGS technologies are error-prone, <italic>true</italic> variants need to be distinguished from sequencing errors, which is especially challenging for low frequency variations.</p>
    <p>Currently, the Illumina sequencing systems are dominating the NGS market [<xref ref-type="bibr" rid="CR5">5</xref>] and novel methodologies to accurately and efficiently determine genotypic variations from ultra-deep sequencing (UDS) data for this technology of sequencers are needed. Moreover, the NGS system that has in the past most often been used within virology, i.e. the Roche 454 pyrosequencing [<xref ref-type="bibr" rid="CR6">6</xref>] system, will be phased-out by 2016.</p>
    <p>Over the last several years multiple groups have devised algorithms to perform SNV calling on UDS data: ShoRAH [<xref ref-type="bibr" rid="CR7">7</xref>], V-Phaser 2 [<xref ref-type="bibr" rid="CR8">8</xref>], LoFreq [<xref ref-type="bibr" rid="CR9">9</xref>], deepSNV [<xref ref-type="bibr" rid="CR10">10</xref>], and RVD [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. Whereas the latter two rare variant detection approaches can robustly detect <italic>true</italic> variants with a prevalence of 0.1 %, the use of these so-called ultrasensitive methods is limited to experiments where reference control samples have been included. The former two algorithms represent 454 legacy methods. Given that for the Illumina sequencing systems most of the errors observed are mismatches, rather than insertion or deletion errors [<xref ref-type="bibr" rid="CR13">13</xref>] which are the most prominent errors in pyrosequencing-based NGS data, these methods may not work optimal for Illumina NGS data. Lastly, the LoFreq method constitutes an approach that is developed for variant analysis that calculates p-values assuming a Poisson binomial distribution as null model for the number of variant bases at a position in the alignment. In this method, the Illumina sequencer quality values associated to each base in a column are taken as input for the null model. While LoFreq is efficient in detecting low frequency SNVs in high-coverage datasets, efficiency decreases with both the coverage depth of the dataset and the variant percentage. This means that LoFreq will need more runtime e.g. to detect a variant at 10 % than at 0.5 % at the same coverage depth.</p>
    <p>In this manuscript, we describe Quality Quantile-SNV (QQ-SNV), a novel logistic regression method for the highly sensitive and specific detection of <italic>true</italic> variants from Illumina UDS data without the need to incorporate reference control samples in the sequencing experiment. As opposed to LoFreq we do not model per base the variant frequency but apply a trained logistic regression model. Therefore, our novel method does not have the counterintuitive and undesirable property of being less efficient in detecting variants at higher frequency. Instead of considering all types of variations, such as indels (as e.g. in [<xref ref-type="bibr" rid="CR8">8</xref>]), our aim was to develop a novel SNV caller for detection of <italic>true</italic> single nucleotide variants only (cf in [<xref ref-type="bibr" rid="CR7">7</xref>] and [<xref ref-type="bibr" rid="CR9">9</xref>]), that is applicable to NGS data of any read length from different Illumina sequencers. Different from most of the existing algorithms, QQ-SNV utilizes primarily the Illumina quality scores associated with individual nucleotides by the sequence basecaller. This approach consequently enables to effectively deal with the alignment of raw sequence data (“reads”) without any filtering or trimming applied. To improve the classification performance (“no error” <italic>vs.</italic> error) of QQ-SNV we first recalibrated the “raw” quality scores (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S1 and S2) by means of a companion logistic regression “recalibration” model. After recalibration [<xref ref-type="bibr" rid="CR14">14</xref>–<xref ref-type="bibr" rid="CR16">16</xref>], less discrete (or more continuous) quality score values are obtained (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S3 an S4) and the quality score distribution for the errors is more distinct from the quality score distributions obtained for the nucleotide reference or <italic>true</italic> variants as seen from the density plots and Quality Quantile plots. This led to the selection of more stable and information-rich quality score derived model parameters for the QQ-SNV classifier and convergence of the model fit. Moreover, as the sequencing error frequencies in forward and reverse reads differ [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR17">17</xref>–<xref ref-type="bibr" rid="CR19">19</xref>], the directionality of the reads is also taken into account within the regression.</p>
  </sec>
  <sec id="Sec2" sec-type="materials|methods">
    <title>Data and methods</title>
    <sec id="Sec3">
      <title>Data</title>
      <sec id="Sec4">
        <title>Sequencing</title>
        <p>For the HIV and HCV plasmids datasets processed in-house for training and testing respectively, the Illumina Genome Analyzer IIx (GAIIx) was used for the paired-end sequencing. Basecalling was done using Bustard (CASAVA 1.7.0), the Illumina default basecaller, producing after de-multiplexing two FASTQ [<xref ref-type="bibr" rid="CR20">20</xref>] files per plasmid: FASTQ/1 (reads 1 of paired-end reads) and FASTQ/2 (reads 2 of paired-end reads, sequenced after paired-end turn), containing the nucleotide sequences with a quality score assigned to each nucleotide. Training of the classifier model was then done on an <italic>in silico</italic> plasmid mixture dataset which we created with known <italic>true</italic> variant percentages.</p>
      </sec>
      <sec id="Sec5">
        <title>Training data</title>
        <sec id="Sec6">
          <title>FASTQ/1 Illumina GAIIx retrieved HIV plasmid sequence data</title>
          <p>For the training of the classifier model the HIV PR-RT region (nt 1–1497) was sequenced. Five HIV-1 plasmids, with different mutational and error profile in the HIV protease-reverse transcriptase region (PR-RT) were processed together in one lane. The length of the reads was 51 base pairs. As the quality of the FASTQ/2 reads is typically lower than for the FASTQ/1 reads, for training of the QQ-SNV classifier model and the companion quality score recalibration model we used the FASTQ/1 data only. This allowed for better estimation of the model parameters with applicability of the model on paired-end or single-end data. Whereas the recalibration model was directly trained on the FASTQ/1 data, to train the classifier model the FASTQ/1 data was first mixed <italic>in silico</italic> (see next section).</p>
          <p>The mapping of the FASTQ/1 reads was done per plasmid, where as reference sequence a HXB2 wild type background was used with the respective plasmid inserted in the region, at nucleotide position 2253–3749, where the <italic>true</italic> sequence was known. Within this 1497 bp region, 12 SNV positions contained a <italic>true</italic> variant (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S1), hence all differences to the HXB2 reference seen at other positions are <italic>true</italic> errors. Note that for this read mapping, we opted to not make a choice between the different read mapping tools [<xref ref-type="bibr" rid="CR21">21</xref>]. Instead, regular expressions (perl) were used to search for the best possible ungapped alignment for the reads in forward or reverse direction. In total 1,183,162 reads covering the region 2253-3749 and having &lt; 20 % mismatch nucleotide errors (including mismatch errors caused by not considering insertions or deletions) were retained for training of the quality score recalibration model. In this training data an equal percentage of reads in forward and reverse direction was observed (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S2). Coverage of the reads was comparable for all plasmids, with a similar average coverage range: 8388–9871 reads with exception of plasmid 2 where the average coverage was found to be lower (N = 3788 reads) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5).</p>
          <p>In Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3, for each of the five plasmids, the total number of errors observed in the region 2253–3749 is given as well as the per plasmid PHRED quality scores calculated from the plasmid error probabilities, where a high quality score indicates a smaller probability of error.</p>
        </sec>
        <sec id="Sec7">
          <title>In silico HIV plasmid mixtures data set for training the QQ-SNV classifier</title>
          <p>To train a model with high sensitivity and specificity to detect <italic>true</italic> variants present at low frequency, a dataset (hereafter called the ground set) was generated of 960 HIV plasmid mixture re-samplings of the FASTQ/1 reads from five plasmids (described in the previous section), as mapped in the region 2253–3749 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5, Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S2). For each re-sampling, reads were mixed <italic>in silico</italic> from a multinomial distribution in the plasmid mixture proportion 63, 30, 5, 1.5, and 0.5 %, and having a coverage depth of N = 5000. In total, the number of <italic>true</italic> variants in the ground set was 11,520 (=960 × 12), with <italic>true</italic> variant percentages populated in the range [0.22–100 %] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6). In order to obtain a larger coverage depth for training of the QQ-SNV model ten re-samplings in the ground set were repeated for the same plasmid mixture proportion and their read mappings were combined. This resulted in a training dataset consisting of 96 read sets (training samples) with a coverage depth of 50,000 reads at each nucleotide position.</p>
        </sec>
      </sec>
      <sec id="Sec8">
        <title>Test data</title>
        <sec id="Sec9">
          <title>HIV plasmid mixture dataset 1</title>
          <p>The HIV PR-RT region (nt 1–3332) was sequenced using the Illumina GAIIx sequencer with a single-end library layout mixing 6 plasmids at the ratio of 88.889, 10, 1, 0.1, 0.01, and 0.001 % [<xref ref-type="bibr" rid="CR10">10</xref>]. The FASTQ file was obtained from the European Nucleotide Archive (ERX097243), and the length of the reads was 31 base pairs. Mapping to the HXB2 reference sequence (nt 2044–3615) was done using CLC Genomics Workbench (CLC bio, Aarhus, Denmark) using the default alignment settings. The average coverage depth of the plasmid mixture in the PR-RT region considered for the analysis (nucleotide position 2253–3584) was 103,142 reads.</p>
        </sec>
        <sec id="Sec10">
          <title>HIV plasmid mixture dataset 2</title>
          <p>The HIV IN region (nt 145–545) was sequenced using the Illumina HiSeq 2000 sequencer with a single-end library layout mixing 6 plasmids at the ratio of 60, 33.4, 5, 1, 0.5, and 0.1 % [<xref ref-type="bibr" rid="CR22">22</xref>]. The FASTQ file was obtained from the European Nucleotide Archive (PRJEB5053), and the length of the reads was 50 base pairs. Mapping to the HXB2 reference sequence (nt 4349–4799) was done using CLC Genomics Workbench (CLC bio, Aarhus, Denmark) using the default alignment settings. The average coverage depth of the plasmid mixture in the IN region considered for the analysis (nucleotide position 4374–4774) was 3,857,069 reads.</p>
        </sec>
        <sec id="Sec11">
          <title>HCV plasmid mixture datasets</title>
          <p>The HCV NS3 region (nt 1–543) was sequenced using the Illumina GAIIx sequencer with a paired-end library layout. In the lab experiment, a HCV reference plasmid was mixed four times with a non-reference plasmid containing five <italic>true</italic> variants in the NS3 region (nucleotide position 3420–3962) considered for the analysis: 3525G &gt; A, 3527C &gt; G, 3882C &gt; A, 3883G &gt; A, and 3884G &gt; A, where the spike-in percentage of the non-reference plasmid (and thus all five <italic>true</italic> variants) was 0.5, 1, 2, and 10 %, respectively. The four resulting HCV “spiked-in” plasmids were sequenced in different lanes, and the length of the reads was 70 base pairs. Mapping to the HCV subtype b reference sequence (nt 3420–3962, Genbank accession number AJ238799) was done using CLC Genomics Workbench (CLC bio, Aarhus, Denmark) using single-end alignment with the default settings, and the average coverage depth (reads 1 and 2) for the plasmids was 93,130 reads. Illumina sequencing data has been deposited in the European Nucleotide Archive under study accession number PRJEB5028. To test our method in comparison to the existing methods at different sequencing depths we generated lower coverage data by randomly downsampling the sequence alignment files (SAM files) of the four HCV “spiked-in” plasmid mixtures containing all paired-end reads using Picard command line tools v1.86 DownsampleSam. Reads were retained with a probability of 40, 10, 2.5 and 0.625 % resulting in average coverage depths of 37,270, 9291, 2295, and 561 reads, respectively.</p>
        </sec>
        <sec id="Sec12">
          <title>H1N1 clinical dataset</title>
          <p>The H1N1 neuraminidase (NA) reference and single-end alignments of the paired-end reads of the H1N1 BN3 clinical data sample, sequenced with both Illumina GAIIx (on one lane) and Illumina MiSeq, were obtained from [<xref ref-type="bibr" rid="CR12">12</xref>]. The length of the reads was 37 base pairs. To test the performance in variant detection of QQ-SNV, the region at position 405–425 was considered, containing four SNVs called in [<xref ref-type="bibr" rid="CR12">12</xref>], at the positions 410, 413, 415, and 421. After merging the alignments of the paired-end reads 1 and 2 using samtools v0.1.18 [<xref ref-type="bibr" rid="CR23">23</xref>], the average coverage depth in this region was 360,359 reads and 36,812 reads for GAIIx and MiSeq, respectively.</p>
          <p>No ethics approval was required for the use of the NGS data of the clinical isolate in this study. The BN3 clinical sample is one of the H1N1 infected patient samples of which the Illumina GAIIx and MiSeq sequencing data was made publicly available by Stanford University as publication material with the RVD method [<xref ref-type="bibr" rid="CR12">12</xref>] on their server at URL: <ext-link ext-link-type="uri" xlink:href="http://hamachi.stanford.edu/publication-material/rvd/clinical/">http://hamachi.stanford.edu/publication-material/rvd/clinical/</ext-link>.</p>
        </sec>
      </sec>
    </sec>
    <sec id="Sec13" sec-type="materials|methods">
      <title>Methods</title>
      <p>The goal of this paper is to build a logistic regression model to classify a nucleotide variant as SNV (<italic>true</italic> variant) or as error by exploiting the information that is in the distribution of the quality scores in the reads covering the variant location. Therefore in this section we first introduce the Illumina quality scores of which we assume that the empirical estimate of the distribution differs for <italic>true</italic> variants or nucleotide reference compared to an error at each location (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S1 and S2). Second, we put forward our companion logistic regression “recalibration” model to recalibrate these quality scores with as purpose to further increase the “distance” between the quality score distribution of “no error” <italic>vs.</italic> error (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S3 and S4). Third, we define the “distance metrics” which are derived from the per nucleotide recalibrated quality score distributions and are considered to be selected as predictors for the QQ-SNV classifier to model the probability of “no error” <italic>vs.</italic> error for each nucleotide at each position (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S7-S9). Then, we describe how the <italic>in silico</italic> plasmid mixture QQ-SNV training data was generated by utilizing a resampling scheme and present the QQ-SNV model and how we selected and estimated the QQ-SNV model parameters by applying stepwise regression and weighted logistic regression, respectively. The latter approach corrects for imbalances in the training data (less SNVs than errors) and allows to use a probability threshold of 0.5 for default application of QQ-SNV. Next, we give the complete workflow for running the QQ-SNV classifier on new data, including the implementation of a high sensitivity threshold of 0.0001 and frequency-based variant filtering to increase sensitivity and reduce the number of false positives, respectively. Lastly, we give the parameter settings used for the competing SNV calling methods on the test datasets.</p>
      <sec id="Sec14">
        <title>Quality scores and derived predictors</title>
        <sec id="Sec15">
          <title>Quality scores</title>
          <p>Illumina quality scores QUAL are retrieved from a FASTQ file and indicate the base call accuracy as assigned to the nucleotides by the basecaller software of the Illumina sequencer. Quality scores <italic>Q</italic> are so-called PHRED scores when they have the property of being logarithmically related to the base calling error probability <italic>P</italic>: <italic>Q</italic> = − 10 log<sub>10</sub>
<italic>P</italic>. While on the FASTQ/1 training data the llumina quality scores <italic>QUAL</italic> are in the <italic>Q</italic>-range 2–40, quality score recalibration (described in the next section) gave quality scores in the <italic>Q</italic>-range 1.62–27.6 – thus estimating the error probability <italic>P</italic> to be higher.</p>
        </sec>
        <sec id="Sec16">
          <title>Recalibrated quality scores</title>
          <p>While correct interpretation of the quality scores may not seem to be required when mainly used for constructing predictors in the QQ-SNV model, we found that quality score recalibration improved the QQ-SNV classification performance (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S4 and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S10). When evaluating the QQ-SNV model generation procedure, a major observation was that more continuous quality score values led to the selection of more stable and information-rich quality score derived model parameters as well as convergence of the model fit and an increased “distance” between the quality score distribution of “no error” <italic>vs.</italic> error. Hence, we have integrated quality score recalibration in the QQ-SNV workflow by means of logistic regression, as previously employed in [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. Here, to calculate the recalibrated quality scores for deriving the predictors of the QQ-SNV model, we trained the following companion binary logistic regression model on the FASTQ/1 HIV plasmid sequence data (1,183,162 reads from five HIV plasmids, see section Training data) with as outcome Y<sub>FASTQ/1</sub> = 0 (no error) or 1 (error): <disp-formula id="Equd"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \log \kern0.3em  it\left(\mathrm{Probability}\ \mathrm{of}\ {Y}_{FASTQ/ 1}=1\right)={\alpha}_0+{\alpha}_1\times QUAL+{\alpha}_2\times RELPOS, $$\end{document}</tex-math><mml:math id="M2"><mml:mi mathvariant="normal">log</mml:mi><mml:mspace width="0.3em"/><mml:mi mathvariant="italic">it</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="normal">Probability</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">of</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mi mathvariant="italic">Y</mml:mi><mml:mi mathvariant="italic">FASTQ/1</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi mathvariant="italic">QUAL</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi mathvariant="italic">RELPOS</mml:mi><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12859_2015_812_Equd.gif" position="anchor"/></alternatives></disp-formula>where <italic>Y</italic>
<sub><italic>FASTQ</italic>/1 <italic>i</italic>,<italic>j</italic>,<italic>k</italic>,<italic>r</italic></sub> =<italic>I</italic>{nucleotide <italic>k</italic> at position <italic>j</italic> in read <italic>r</italic> of sample <italic>i</italic> is a sequencing error} and the probability that <italic>Y</italic>
<sub><italic>FASTQ</italic>/1 <italic>i</italic>,<italic>j</italic>,<italic>k</italic>,<italic>r</italic></sub> is a sequencing error is calculated from the covariates <italic>QUAL</italic>
<sub><italic>i</italic>,<italic>j</italic>,<italic>k</italic>,<italic>r</italic></sub> and <italic>RELPOS</italic>
<sub><italic>i</italic>,<italic>j</italic>,<italic>k</italic>,<italic>r</italic></sub>. <italic>QUAL</italic> is the original nucleotide Illumina PHRED quality score to be recalibrated. <italic>RELPOS</italic> is the distance of the nucleotide position in the read from the 3’ end, normalized by the read length. The recalibrated PHRED quality score is then calculated as: <italic>Q. RECAL</italic>
<sub><italic>i</italic>,<italic>j</italic>,<italic>k</italic>,<italic>r</italic></sub> = − 10 log<sub>10</sub>(Probability <italic>Y</italic>
<sub><italic>FASTQ</italic>/1 <italic>i</italic>,<italic>j</italic>,<italic>k</italic>,<italic>r</italic></sub> is a sequencing error).</p>
          <p>The coefficients of the QQ-SNV recalibration model are given in Table <xref rid="Tab1" ref-type="table">1</xref> (confidence intervals in Additional file <xref rid="MOESM3" ref-type="media">3</xref>), and were fitted using a mixed effects model, using a random effect for factor PLASMID to take the difference in plasmid error probability into account (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3) [<xref ref-type="bibr" rid="CR24">24</xref>]. The random effect variance was 0.199.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Quality score recalibration model trained on FASTQ/1 GAIIx data</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Parameter</th><th>Coefficient</th><th>Significance (<italic>P</italic>-value)</th></tr></thead><tbody><tr><td>Intercept</td><td>0.84 (<italic>α</italic>
<sub>0</sub>)</td><td>2.27e-5</td></tr><tr><td><italic>QUAL</italic></td><td>−0.16 (<italic>α</italic>
<sub>1</sub>)</td><td>&lt;2e-16</td></tr><tr><td><italic>RELPOS</italic></td><td>−0.89 (<italic>α</italic>
<sub>2</sub>)</td><td>&lt;2e-16</td></tr></tbody></table></table-wrap>
</p>
        </sec>
        <sec id="Sec17">
          <title>Quality score derived predictors</title>
          <p>Whereas the quality score recalibration model is a logistic regression model that predicts the probability of sequencing error at the nucleotide level for each individual read <italic>r</italic>, the QQ-SNV model calculates the probability of “no sequencing error” of a nucleotide <italic>k</italic> for all reads of a sample <italic>i</italic> mapped at a position <italic>j</italic>, using the recalibrated quality 100-quantiles (percentiles) <italic>p</italic> – calculated from multiple reads with the same direction <italic>d</italic> (forward/reverse) and containing the same nucleotide <italic>k</italic> (A/C/G/T) at an aligned position <italic>j</italic> – as summarized quality scores. The following “distance metrics” were derived per read direction from the per nucleotide recalibrated quality score distributions: <italic>QQnorm. dir</italic> calculates the recalibrated quality quantile percentages after normalization to the “per position <italic>j</italic>” recalibrated quality quantile (calculated irrespective of nucleotide) in the range [0,1] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S11), thus independent of the Illumina recalibrated Q-range (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4). <italic>QQ. dir</italic> then calculates per percentile <italic>p</italic> the nucleotide distance in the range [0,1] as the difference of the normalized nucleotide <italic>k</italic> recalibrated quality quantile from the reference value of 100 %, relative to the distance calculated for the nucleotide with the worst quality (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S12). After that <italic>D. dir</italic> is calculated as the total distance summed over all nineteen percentiles <italic>p</italic> considered (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S13). In the formula given below <italic>QQnorm. dir</italic>
<sub><italic>p</italic>,<italic>i</italic>,<italic>j</italic>,<italic>k</italic>,<italic>d</italic></sub>, <italic>QQ. dir</italic>
<sub><italic>p</italic>,<italic>i</italic>,<italic>j</italic>,<italic>k</italic>,<italic>d</italic></sub>, and <italic>D. dir</italic>
<sub><italic>i</italic>,<italic>j</italic>,<italic>k</italic>,<italic>d</italic></sub> are calculated for nucleotide <italic>k</italic> in the aligned reads for sample <italic>i</italic> at position <italic>j</italic> in a sequenced region of interest and per read direction <italic>d</italic>.<disp-formula id="Equa"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{array}{l} QQnorm.di{r}_{p,i,j,k,d}=\frac{percentil{e}_p\left(Q. RECA{L}_{i,j,k}\left| read. direction=d\right.\right)}{percentil{e}_p\left(Q. RECA{L}_{i,j}\left|\begin{array}{l} read. direction=d,\;\\ {} nt\in \left\{A,C,G,T,N\right\}\end{array}\right.\right)},\mathrm{with}\;p\in \left\{{5}^{th},\;{10}^{th}, \dots,\;{95}^{th}\right\},\;d\in \left\{ forward,\; reverse\right\}\hfill \\ {}QQ.di{r}_{p,i,j,k,d}=\frac{ \max \left(0,\;\left(1- QQnorm.di{r}_{p,i,j,k,d}\right)\right)}{\left(1-{ \min}_{nt=k}\left( QQnorm.di{r}_{p,i,j,k,d}\right)\right)}, with\;k\in \left\{A,C,G,T\right\}\hfill \\ {}D.di{r}_{i,j,k,d}={\displaystyle {\sum}_{p\in P}QQ.di{r}_{p,i,j,k,d}},\kern0.24em \mathrm{with}\;P=\left\{{5}^{th},\;{10}^{th}, \dots,\;{95}^{th}\right\},\;d\in \left\{ forward,\; reverse\right\}\hfill \end{array} $$\end{document}</tex-math><mml:math id="M4"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mi mathvariant="italic">QQnorm</mml:mi><mml:mo>.</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">percentil</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>Q</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="italic">RECA</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mfenced close="" open="|"><mml:mrow><mml:mi mathvariant="italic">read</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="italic">direction</mml:mi><mml:mo>=</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="italic">percentil</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>Q</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="italic">RECA</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close="" open="|"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi mathvariant="italic">read</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="italic">direction</mml:mi><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.12em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi mathvariant="italic">nt</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{" separators=",,,,"><mml:mi>A</mml:mi><mml:mi>C</mml:mi><mml:mi>G</mml:mi><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mi mathvariant="normal">with</mml:mi><mml:mspace width="0.12em"/><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:msup><mml:mn>5</mml:mn><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="0.12em"/><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="0.12em"/><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.12em"/><mml:msup><mml:mn>95</mml:mn><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.12em"/><mml:mi>d</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mi mathvariant="italic">forward</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.12em"/><mml:mi mathvariant="italic">reverse</mml:mi></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mi>Q</mml:mi><mml:mi>Q</mml:mi><mml:mo>.</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>max</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.12em"/><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi mathvariant="italic">QQnorm</mml:mi><mml:mo>.</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mo>min</mml:mo><mml:mrow><mml:mi mathvariant="italic">nt</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="italic">QQnorm</mml:mi><mml:mo>.</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mfrac><mml:mo>,</mml:mo><mml:mi mathvariant="italic">with</mml:mi><mml:mspace width="0.12em"/><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{" separators=",,,"><mml:mi>A</mml:mi><mml:mi>C</mml:mi><mml:mi>G</mml:mi><mml:mi>T</mml:mi></mml:mfenced></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mi>D</mml:mi><mml:mo>.</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>Q</mml:mi><mml:mi>Q</mml:mi><mml:mo>.</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo>,</mml:mo><mml:mspace width="0.24em"/><mml:mi mathvariant="normal">with</mml:mi><mml:mspace width="0.12em"/><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:msup><mml:mn>5</mml:mn><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="0.12em"/><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="0.12em"/><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.12em"/><mml:msup><mml:mn>95</mml:mn><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.12em"/><mml:mi>d</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mi mathvariant="italic">forward</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.12em"/><mml:mi mathvariant="italic">reverse</mml:mi></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2015_812_Equa.gif" position="anchor"/></alternatives></disp-formula>
</p>
          <p>Next, the “distance metrics” selectable for the QQ-SNV model: <italic>QQnorm</italic> (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S7), <italic>QQ</italic> (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S8), and <italic>D</italic> (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S9) are calculated as follows:<disp-formula id="Equb"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{array}{l} QQnor{m}_{p,i,j,k}= \min \left( QQnorm.di{r}_{p,i,j,k, forward}, QQnorm.di{r}_{p,i,j,k, reverse}\right)\hfill \\ {}Q{Q}_{p,i,j,k}= \max \left(QQ.di{r}_{p,i,j,k, forward},QQ.di{r}_{p,i,j,k, reverse}\right)\hfill \\ {}{D}_{i,j,k}= \max \left(D.di{r}_{i,j,k, forward},D.di{r}_{i,j,k, reverse}\right)\hfill \end{array} $$\end{document}</tex-math><mml:math id="M6"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mi mathvariant="italic">QQnor</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>min</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="italic">QQnorm</mml:mi><mml:mo>.</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">forward</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="italic">QQnorm</mml:mi><mml:mo>.</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">reverse</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mi>Q</mml:mi><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>max</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>Q</mml:mi><mml:mi>Q</mml:mi><mml:mo>.</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">forward</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>Q</mml:mi><mml:mi>Q</mml:mi><mml:mo>.</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">reverse</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>max</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>D</mml:mi><mml:mo>.</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">forward</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo>.</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">reverse</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2015_812_Equb.gif" position="anchor"/></alternatives></disp-formula>
</p>
          <p>Thus, they retain the distance terms corresponding to the read direction <italic>d</italic> (forward/reverse) having the largest difference between the nucleotide <italic>k</italic> and the “per position <italic>j</italic>” recalibrated PHRED quality quantile scores. Hence, as read directionality is taken into account, SNV calling using the QQ-SNV model can be performed for all variants present at least once in both forward and reverse direction.</p>
        </sec>
      </sec>
      <sec id="Sec18">
        <title>Training dataset for classifier model selection and parameter estimation</title>
        <sec id="Sec19">
          <title>Resampling scheme for the generation of the training data</title>
          <p>To generate the training dataset of 96 <italic>in silico</italic> HIV plasmid mixtures, 96 (=5! – 4!) plasmid mixture re-samplings were generated ten times for each of the permutations of plasmid percentages at the ratio of 63, 30, 5, 1.5, and 0.5 %. Note that for plasmid 2 the highest percentage (63 %) could not be assigned because of the lower number of available reads. The ten repeats per permutation were then combined to have a larger coverage depth for training the QQ-SNV model. Moreover, to also have a balanced training dataset in terms of coverage, the coverage depth at each nucleotide position in the mapping region 2253-3749 of the 96 plasmid mixture training samples was chosen to be N = 50,000 reads. Thereto, the re-samplings in the ground set of 960 (96 × 10) plasmid mixtures were guided by filling up each row in the read mapping with reads from the same plasmid, starting at a nucleotide position with the same sampled offset position (0–50). Consequently N = 5000 reads were multinomially distributed over the five plasmids with probabilities cf a given permutation, covering the whole region 2253–3749. Next, to allow for additional errors the bases were recalled and the alignment steps were performed separately for the 960 read sets, each containing a selection of ~150,000 reads (12.7 %) from the original FASTQ/1 dataset. This implies that for each of the read sets first the Illumina Cluster Intensity Files (CIFs) were recreated, retaining the intensities of the subset of reads from the respective re-sampling. Second the basecalling was executed with the Bustard Off-Line Basecaller. Third, the read set was mapped to the HXB2 reference sequence (nt 2203-3799) using CLC Genomics Workbench (CLC bio, Aarhus, Denmark) using the default alignment settings.</p>
        </sec>
        <sec id="Sec20">
          <title>QQ-SNV classifier model selection and parameter estimation</title>
          <p>Training of the QQ-SNV classifier model was performed on 96 <italic>in silico</italic> HIV plasmid mixture data samples (see section Training data), resulting in the following binary logistic regression model with as outcome Y<sub><italic>in silico</italic></sub> = 0 (no error) or 1 (error): <disp-formula id="Equc"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ logit\left(\mathrm{Probability}\ \mathrm{of}\ {\mathrm{Y}}_{in\; silico}=0\right)={\beta}_0+{\beta}_1\times QQnor{m}_{5^{th}}+{\beta}_2\times QQnor{m}_{25^{th}}+{\beta}_3\times QQnor{m}_{95^{th}}+{\beta}_4\times Q{Q}_{80^{th}}+{\beta}_5\times D $$\end{document}</tex-math><mml:math id="M8"><mml:mi mathvariant="italic">logit</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="normal">Probability</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">of</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mi mathvariant="normal">Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">in</mml:mi><mml:mspace width="0.12em"/><mml:mi mathvariant="italic">silico</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi mathvariant="italic">QQnor</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:msup><mml:mn>5</mml:mn><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi mathvariant="italic">QQnor</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:msup><mml:mn>25</mml:mn><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi mathvariant="italic">QQnor</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:msup><mml:mn>95</mml:mn><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>Q</mml:mi><mml:msub><mml:mi>Q</mml:mi><mml:msup><mml:mn>80</mml:mn><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>D</mml:mi></mml:math><graphic xlink:href="12859_2015_812_Equc.gif" position="anchor"/></alternatives></disp-formula>
</p>
          <p>where <italic>Y</italic>
<sub><italic>in silico i</italic>,<italic>j</italic>,<italic>k</italic></sub> = <italic>I</italic>{nucleotide <italic>k</italic> at position <italic>j</italic> of sample <italic>i</italic> is a sequencing error}.</p>
          <p>In a stepwise regression procedure, using a significance level (<italic>p</italic>-value threshold) of 5E-4 for entering or removing of covariates, the following five quality score derived predictors were selected for the QQ-SNV model: <inline-formula id="IEq2"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ QQnor{m}_{5^{th}} $$\end{document}</tex-math><mml:math id="M10"><mml:mi mathvariant="italic">QQnor</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:msup><mml:mn>5</mml:mn><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="12859_2015_812_IEq2.gif"/></alternatives></inline-formula>, <inline-formula id="IEq3"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ QQnor{m}_{25^{th}} $$\end{document}</tex-math><mml:math id="M12"><mml:mi mathvariant="italic">QQnor</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:msup><mml:mn>25</mml:mn><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="12859_2015_812_IEq3.gif"/></alternatives></inline-formula>, <inline-formula id="IEq4"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ QQnor{m}_{95^{th}} $$\end{document}</tex-math><mml:math id="M14"><mml:mi mathvariant="italic">QQnor</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:msup><mml:mn>95</mml:mn><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="12859_2015_812_IEq4.gif"/></alternatives></inline-formula>, <inline-formula id="IEq5"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ Q{Q}_{80^{th}} $$\end{document}</tex-math><mml:math id="M16"><mml:mi>Q</mml:mi><mml:msub><mml:mi>Q</mml:mi><mml:msup><mml:mn>80</mml:mn><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="12859_2015_812_IEq5.gif"/></alternatives></inline-formula>, and <italic>D</italic>. To increase the sensitivity of the QQ-SNV model when classifying variants, having a predicted SNV probability above 0.5, as being <italic>true</italic>, the QQ-SNV model coefficients (Table <xref rid="Tab2" ref-type="table">2</xref>) were fitted using weighted binary logistic regression to correct for the imbalances in the training data (less SNVs than errors), with weighting factors of 25 and 1 in case of “no sequencing error” and sequencing error, respectively. These weighting factors for rescaling of the probabilities for a SNV probability threshold of 0.5 were chosen to match the false positive : false negative ratio of the unweighted trained model as used to select the quality score derived predictors using as cutoff 0.008 (=12/1497 = the percentage of SNV positions in training region) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S14).<table-wrap id="Tab2"><label>Table 2</label><caption><p>QQ-SNV model trained on 96 <italic>in silico</italic> HIV plasmid mixture data samples</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Parameter</th><th>Coefficient</th><th>Significance (P-value)</th></tr></thead><tbody><tr><td>Intercept</td><td char="." align="char">−117.66 (<italic>β</italic>
<sub>0</sub>)</td><td>&lt;2e-16</td></tr><tr><td><inline-formula id="IEq6"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ QQnor{m}_{5^{th}} $$\end{document}</tex-math><mml:math id="M18"><mml:mi mathvariant="italic">QQnor</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:msup><mml:mn>5</mml:mn><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="12859_2015_812_IEq6.gif"/></alternatives></inline-formula></td><td char="." align="char">4.38 (<italic>β</italic>
<sub>1</sub>)</td><td>&lt;2e-16</td></tr><tr><td><inline-formula id="IEq7"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ QQnor{m}_{25^{th}} $$\end{document}</tex-math><mml:math id="M20"><mml:mi mathvariant="italic">QQnor</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:msup><mml:mn>25</mml:mn><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="12859_2015_812_IEq7.gif"/></alternatives></inline-formula></td><td char="." align="char">7.37 (<italic>β</italic>
<sub>2</sub>)</td><td>&lt;2e-16</td></tr><tr><td><inline-formula id="IEq8"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ QQnor{m}_{95^{th}} $$\end{document}</tex-math><mml:math id="M22"><mml:mi mathvariant="italic">QQnor</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:msup><mml:mn>95</mml:mn><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="12859_2015_812_IEq8.gif"/></alternatives></inline-formula></td><td char="." align="char">116.78 (<italic>β</italic>
<sub>3</sub>)</td><td>&lt;2e-16</td></tr><tr><td><inline-formula id="IEq9"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ Q{Q}_{80^{th}} $$\end{document}</tex-math><mml:math id="M24"><mml:mi>Q</mml:mi><mml:msub><mml:mi>Q</mml:mi><mml:msup><mml:mn>80</mml:mn><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="12859_2015_812_IEq9.gif"/></alternatives></inline-formula></td><td char="." align="char">−3.06 (<italic>β</italic>
<sub>4</sub>)</td><td>&lt;2e-16</td></tr><tr><td><italic>D</italic></td><td char="." align="char">−0.70 (<italic>β</italic>
<sub>5</sub>)</td><td>&lt;2e-16</td></tr></tbody></table></table-wrap>
</p>
        </sec>
      </sec>
      <sec id="Sec21">
        <title>Running QQ-SNV</title>
        <p>We have developed a workflow to perform QQ-SNV classification on a new dataset (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>). First, an alignment containing the reference mapped FASTQ/1 and/or FASTQ/2 reads needs to be exported as a SAM file [<xref ref-type="bibr" rid="CR23">23</xref>]. In case the alignment has been saved as a BAM file (binary format) instead, a conversion to the SAM format can be made using samtools [<xref ref-type="bibr" rid="CR23">23</xref>]. Second, the quality scores of the nucleotides in the reads are to be recalibrated using the quality score recalibration model, and the nucleotide recalibrated quality percentiles and distance metrics, needed in the QQ-SNV model, are to be calculated per aligned nucleotide position and direction of the reads (forward/reverse). Finally, the QQ-SNV classifier model is used for the SNV calling, classifying a variant as SNV (<italic>true</italic> variant) – if the QQ-SNV model predicted SNV probability is above a threshold value of 0.5 (QQ-SNV<sub>D (default)</sub>) – or as a sequencing error (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>). While in the training of the QQ-SNV model we rescaled the SNV probabilities for a probability cutoff of 0.5 (see previous section), when applying logistic regression on multiple different datasets the optimal classification threshold on these datasets is rarely exactly 0.5 [<xref ref-type="bibr" rid="CR25">25</xref>]. Therefore, to increase the sensitivity of the QQ-SNV classifier in detecting low frequency variants, for QQ-SNV<sub>HS (high sensitivity)</sub> the model coefficients as shown in Table <xref rid="Tab2" ref-type="table">2</xref> were still used, but now using a SNV probability threshold of 0.0001 (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>). Thus, in order to obtain high sensitivity on new data this high sensitivity threshold is taken 15 times lower than the lowest SNV probability obtained for a <italic>true</italic> variant in the ground set of 960 samples, which was 0.00153. However, to avoid the occurrence of many false positives by taking a much lower SNV probability threshold than default, we calculated in addition the 50<sup>th</sup>/75<sup>th</sup>/80<sup>th</sup>/85<sup>th</sup>/90<sup>th</sup>/95<sup>th</sup> percentile of the QQ-SNV<sub>HS</sub> distribution (frequency cutoff <bold>c</bold>) of “error” (variants with P(SNV) ≤ 0.0001) frequencies. To reduce false positives, “SNVs” (variants with P(SNV) &gt; 0.0001) are overruled when their frequency is lower than <bold>c</bold> (Fig. <xref rid="Fig1" ref-type="fig">1d</xref>). The specificity of QQ-SNV<sub>HS</sub> will increase when choosing a higher percentile to calculate the frequency threshold. When evaluating QQ-SNV<sub>HS</sub> using the above different percentiles on the test sets (see section Test data), using the 80<sup>th</sup> percentile (P80) as frequency cutoff was overall most accurate (see section Results). Therefore, we suggest to use QQ-SNV<sub>HS-P80</sub> on new datasets.<fig id="Fig1"><label>Fig. 1</label><caption><p>QQ-SNV variant calling. Schematic view of QQ-SNV variant calling methodology starting from Illumina NGS data. <bold>a</bold> QQ-SNV workflow <bold>b</bold> QQ-SNV<sub>D</sub>
<bold>c</bold> QQ-SNV<sub>HS</sub>
<bold>d</bold> QQ-SNV<sub>HS-P80</sub>, 80<sup>th</sup> percentile (P80) of the QQ-SNV<sub>HS</sub> distribution of “error” frequencies was used as frequency cutoff to decrease the number of false positives obtained with QQ-SNV<sub>HS</sub>
</p></caption><graphic xlink:href="12859_2015_812_Fig1_HTML" id="MO1"/></fig>
</p>
        <p>To run QQ-SNV on the different datasets as analyzed in this paper, we wrote a perl script QQ-SNV_workflow.pl (Additional file <xref rid="MOESM4" ref-type="media">4</xref>). Within the QQ-SNV workflow, SAS 9.2 was used for the SNV calling. The SAS default percentile definition was used for calculation of the quality quantiles and frequency thresholds.</p>
      </sec>
      <sec id="Sec22">
        <title>Parameter settings of competing methods</title>
        <sec id="Sec23">
          <title>ShoRAH</title>
          <p>ShoRAH v0.8 was run. The largest window size was used that worked with the software, corresponding to the sequencing read length. For the other parameters, the default settings were used.</p>
        </sec>
        <sec id="Sec24">
          <title>V-Phaser 2</title>
          <p>V-Phaser 2 v2.0 was run using the default settings, applying strand bias test and correction for multiple testing.</p>
        </sec>
        <sec id="Sec25">
          <title>LoFreq</title>
          <p>LoFreq v0.5.0 was run using the default settings.</p>
        </sec>
      </sec>
    </sec>
  </sec>
  <sec id="Sec26" sec-type="results">
    <title>Results</title>
    <sec id="Sec27">
      <title>Training performance and method validation of QQ-SNV</title>
      <p>Training of QQ-SNV<sub>D</sub> on the <italic>in silico</italic> HIV plasmid mixture data with coverage N = 50,000 reads (96 samples with different plasmid mixture proportion), sequenced on the Illumina GAIIx platform (51 bp reads), resulted in 99.2 % sensitivity, 99.9 % specificity, and Positive Predictive Value (PPV) of 75 % (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S4). The 9 <italic>true</italic> variants not detected were present at the lowest frequency of 0.5 %. In addition, we analyzed the performance of QQ-SNV on the ground set <italic>in silico</italic> HIV plasmid mixture data with coverage N = 5000 reads (960 samples with ten repeats re-sampled for the 96 plasmid mixture proportions as used in the training data) (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S5). Here, besides QQ-SNV<sub>D</sub> we evaluated QQ-SNV<sub>HS</sub> and QQ-SNV<sub>HS-P50/75/90</sub> using as frequency threshold the 50<sup>th</sup>/75<sup>th</sup>/90<sup>th</sup> percentile (P50, P75 and P90) of the frequency distribution of variants called as error by QQ-SNV<sub>HS</sub>. The sensitivity of the methods in detecting the <italic>true</italic> variants was calculated for different intervals on the <italic>true</italic> variant frequencies. For QQ-SNV<sub>D</sub> both sensitivity and specificity are above 95 %, but the PPV of 19.6 % is low. The latter is due to the <italic>in silico</italic> resampling at a relatively low coverage depth of 5000 reads and the presence of variants at <italic>true</italic> percentages below 0.5 % (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6). QQ-SNV<sub>HS</sub> achieves 100 % sensitivity, but the number of false positives is much higher. When applying QQ-SNV<sub>HS-P90</sub> the number of false positives is clearly reduced in comparison to QQ-SNV<sub>HS</sub> and the sensitivity in detecting variants with prevalence &lt; 0.5 % is high (99.7 %) (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S5), thus validating the extended version of the QQ-SNV<sub>HS</sub> approach (Fig. <xref rid="Fig1" ref-type="fig">1d</xref>). On the test data in the next sections, then in addition the 80<sup>th</sup>, 85<sup>th</sup> and 95<sup>th</sup> percentile (P80, P85 and P95) were calculated of the QQ-SNV<sub>HS</sub> distribution of “error” frequencies. QQ-SNV<sub>HS-P80</sub> resulted in the best overall performance.</p>
    </sec>
    <sec id="Sec28">
      <title>Performance evaluation of QQ-SNV on HIV plasmid mixture datasets</title>
      <p>The results of the performance comparison of the different methods on the HIV plasmid mixture dataset 1 sequenced on the Illumina GAIIx platform (31 bp reads) are given in Table <xref rid="Tab3" ref-type="table">3</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S15A and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S6. The sensitivity in detecting variants ≥ 1 % is similar for the different methods, except for V-Phaser 2. However, the latter method was equally sensitive as QQ-SNV<sub>HS-P80</sub> in detecting SNVs at 0.1 %. Note that QQ-SNV<sub>HS-P80</sub> was also more robust than QQ-SNV<sub>D</sub> in detecting variants at percentages ≥ 10 %. By overruling 92 % of the QQ-SNV<sub>HS</sub> false positives, the specificity of QQ-SNV<sub>HS-P80</sub> is similar as for the existing methods. The computationally most efficient method was QQ-SNV (14 m), followed by V-Phaser 2 (33 m), LoFreq (53 m), and ShoRAH (6h25m).<table-wrap id="Tab3"><label>Table 3</label><caption><p>Performance on HIV plasmid mixture dataset 1</p></caption><table frame="hsides" rules="groups"><tbody><tr><td/><td>QQ-SNV<sub>D</sub>
</td><td>QQ-SNV<sub>HS-P80</sub>
<sup>a</sup>
</td><td>LoFreq</td><td>ShoRAH</td><td>V-Phaser 2</td></tr><tr><td>Variant %</td><td>sens.<sup>b</sup>
</td><td>sens.<sup>b</sup>
</td><td>sens.<sup>b</sup>
</td><td>sens.<sup>b</sup>
</td><td>sens.<sup>b</sup>
</td></tr><tr><td> 88.889 %</td><td>57/61</td><td>60/61</td><td>59/61</td><td>56/61</td><td>20/61</td></tr><tr><td> 10 %</td><td>44/50</td><td>49/50</td><td>47/50</td><td>45/50</td><td>13/50</td></tr><tr><td> 1 %</td><td>28/34</td><td>30/34</td><td>23/34</td><td>26/34</td><td>10/34</td></tr><tr><td> 0.1 %</td><td>2/42</td><td>20/42</td><td>0/42</td><td>7/42</td><td>22/42</td></tr><tr><td> 0.01 %</td><td>0/40</td><td>1/40</td><td>0/40</td><td>3/40</td><td>8/40</td></tr><tr><td> 0.001 %</td><td>0/30</td><td>0/30</td><td>0/30</td><td>0/30</td><td>0/30</td></tr><tr><td/><td>FP<sup>c</sup>
</td><td>FP<sup>c</sup>
</td><td>FP<sup>c</sup>
</td><td>FP<sup>c</sup>
</td><td>FP<sup>c</sup>
</td></tr><tr><td/><td>2</td><td>4</td><td>0</td><td>6</td><td>2</td></tr><tr><td/><td>time<sup>de</sup>
</td><td>time<sup>de</sup>
</td><td>time<sup>df</sup>
</td><td>time<sup>dg</sup>
</td><td>time<sup>dg</sup>
</td></tr><tr><td/><td>14m11s</td><td>14m11s</td><td>53m24s</td><td>6h25m</td><td>33m5s</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>80<sup>th</sup> percentile of the QQ-SNV<sub>HS</sub> distribution of “error” frequencies was used as frequency cutoff to decrease the number of false positives obtained with QQ-SNV<sub>HS</sub>
</p><p><sup>b</sup>sens. is the percentage of <italic>true</italic> variants that were correctly called as SNV</p><p><sup>c</sup>FP is the number of variants incorrectly called as SNV</p><p><sup>d</sup>computation time in hours (h), minutes (m) and seconds (s)</p><p><sup>e</sup>Windows 7 64 bit, 8GB RAM, 3.2GHz</p><p><sup>f</sup>Linux Ubuntu 12.04.4, 57.6 GB RAM, one core (2.3GHz) used</p><p><sup>g</sup>Linux Ubuntu 12.04.4, 57.6 GB RAM, 8 cores (2.3GHz) used in parallel</p></table-wrap-foot></table-wrap>
</p>
      <p>The results of the performance comparison of the different methods on the HIV plasmid mixture dataset 2 sequenced on the Illumina HiSeq 2000 platform (50 bp reads) are given in Table <xref rid="Tab4" ref-type="table">4</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S15B and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S7. V-Phaser 2 failed on this dataset. Although ShoRAH was the fastest method in producing results, too many variants at high and low frequencies were not detected. Thus QQ-SNV and LoFreq remain for the comparison. QQ-SNV<sub>HS-P80</sub> was more sensitive than LoFreq at 1.0 % (100 <italic>vs.</italic> 90 %) and at 0.1 % (60 <italic>vs.</italic> 20 %). For QQ-SNV<sub>HS-P80</sub> one false positive was returned which was not eliminated when applying a P95 frequency threshold (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S7), while for LoFreq there were no false positives. On this dataset QQ-SNV was twenty times faster than LoFreq (2h29m <italic>vs.</italic> 2d4h11m). This confirms that LoFreq is slow in detecting variants at high frequency, whereas for QQ-SNV the runtime is entirely due to the high coverage depth (&gt;1 million reads).<table-wrap id="Tab4"><label>Table 4</label><caption><p>Performance on HIV plasmid mixture dataset 2</p></caption><table frame="hsides" rules="groups"><tbody><tr><td/><td>QQ-SNV<sub>D</sub>
</td><td>QQ-SNV<sub>HS-P80</sub>
<sup>a</sup>
</td><td>LoFreq</td><td>ShoRAH</td><td>V-Phaser 2</td></tr><tr><td>Variant %</td><td>sens.<sup>b</sup>
</td><td>sens.<sup>b</sup>
</td><td>sens.<sup>b</sup>
</td><td>sens.<sup>b</sup>
</td><td>sens.<sup>b</sup>
</td></tr><tr><td> 40.0 %</td><td>2/2</td><td>2/2</td><td>2/2</td><td>1/2</td><td>na<sup>h</sup>
</td></tr><tr><td> 39.9 %</td><td>1/1</td><td>1/1</td><td>1/1</td><td>1/1</td><td>na<sup>h</sup>
</td></tr><tr><td> 39.5 %</td><td>1/1</td><td>1/1</td><td>1/1</td><td>0/1</td><td>na<sup>h</sup>
</td></tr><tr><td> 38.9 %</td><td>1/1</td><td>1/1</td><td>1/1</td><td>0/1</td><td>na<sup>h</sup>
</td></tr><tr><td> 38.4 %</td><td>2/2</td><td>2/2</td><td>2/2</td><td>2/2</td><td>na<sup>h</sup>
</td></tr><tr><td> 34.4 %</td><td>2/2</td><td>2/2</td><td>2/2</td><td>1/2</td><td>na<sup>h</sup>
</td></tr><tr><td> 34.0 %</td><td>1/1</td><td>1/1</td><td>1/1</td><td>1/1</td><td>na<sup>h</sup>
</td></tr><tr><td> 33.5 %</td><td>1/1</td><td>1/1</td><td>1/1</td><td>1/1</td><td>na<sup>h</sup>
</td></tr><tr><td> 33.4 %</td><td>8/8</td><td>8/8</td><td>8/8</td><td>7/8</td><td>na<sup>h</sup>
</td></tr><tr><td> 6.6 %</td><td>1/1</td><td>1/1</td><td>1/1</td><td>1/1</td><td>na<sup>h</sup>
</td></tr><tr><td> 6.1 %</td><td>1/1</td><td>1/1</td><td>1/1</td><td>0/1</td><td>na<sup>h</sup>
</td></tr><tr><td> 5.1 %</td><td>1/1</td><td>1/1</td><td>1/1</td><td>1/1</td><td>na<sup>h</sup>
</td></tr><tr><td> 5.0 %</td><td>8/8</td><td>8/8</td><td>8/8</td><td>8/8</td><td>na<sup>h</sup>
</td></tr><tr><td> 1.0 %</td><td>10/10</td><td>10/10</td><td>9/10</td><td>7/10</td><td>na<sup>h</sup>
</td></tr><tr><td> 0.6 %</td><td>0/1</td><td>1/1</td><td>1/1</td><td>0/1</td><td>na<sup>h</sup>
</td></tr><tr><td> 0.5 %</td><td>5/8</td><td>8/8</td><td>8/8</td><td>2/8</td><td>na<sup>h</sup>
</td></tr><tr><td> 0.1 %</td><td>1/10</td><td>6/10</td><td>2/10</td><td>2/10</td><td>na<sup>h</sup>
</td></tr><tr><td/><td>FP<sup>c</sup>
</td><td>FP<sup>c</sup>
</td><td>FP<sup>c</sup>
</td><td>FP<sup>c</sup>
</td><td>FP<sup>c</sup>
</td></tr><tr><td/><td>0</td><td>1</td><td>0</td><td>3</td><td>na<sup>h</sup>
</td></tr><tr><td/><td>time<sup>de</sup>
</td><td>time<sup>de</sup>
</td><td>time<sup>df</sup>
</td><td>time<sup>dg</sup>
</td><td>time<sup>dg</sup>
</td></tr><tr><td/><td>2h29m</td><td>2h29m</td><td>2d4h11m</td><td>57m45s</td><td>na<sup>h</sup>
</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>80<sup>th</sup> percentile of the QQ-SNV<sub>HS</sub> distribution of “error” frequencies was used as frequency cutoff to decrease the number of false positives obtained with QQ-SNV<sub>HS</sub>
</p><p><sup>b</sup>sens. is the percentage of <italic>true</italic> variants that were correctly called as SNV</p><p><sup>c</sup>FP is the number of variants incorrectly called as SNV</p><p><sup>d</sup>computation time in days (d), hours (h), minutes (m) and seconds (s)</p><p><sup>e</sup>Windows 7 64 bit, 8GB RAM, 3.2GHz</p><p><sup>f</sup>Linux Ubuntu 12.04.4, 57.6 GB RAM, one core (2.3GHz) used</p><p><sup>g</sup>Linux Ubuntu 12.04.4, 57.6 GB RAM, 8 cores (2.3GHz) used in parallel</p><p><sup>h</sup>No results could be obtained for the V-Phaser 2 algorithm due to failure of the V-Phaser 2 software tool on our server</p></table-wrap-foot></table-wrap>
</p>
    </sec>
    <sec id="Sec29">
      <title>Performance evaluation on HCV plasmid mixture datasets</title>
      <p>The results of the performance comparison of the different methods on the HCV plasmid mixture datasets sequenced on the Illumina GAIIx platform (70 bp reads) are given in Table <xref rid="Tab5" ref-type="table">5</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S15C-D and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S8. Similarly as on HIV plasmid mixture dataset 1, for V-Phaser 2 the sensitivity in detecting variants at higher percentages is low. Both QQ-SNV<sub>HS</sub> and LoFreq were the only methods with 100 % sensitivity for the reads 1, reads 2, and combined reads 1 and reads 2 data for <italic>true</italic> variant frequencies ≥ 1 %. While QQ-SNV<sub>HS</sub> detects all variants but one (reads 2 at 0.5 %), the number of false positives on reads 1 data is higher than for the other methods. On the reads 1 data, best performance was seen for ShoRAH. When applying a P80 frequency threshold on the QQ-SNV<sub>HS</sub> SNVs, similar specificity as LoFreq was obtained on the reads 1 data. On the combined reads 1 and reads 2 data only QQ-SNV<sub>HS-P75</sub> and QQ-SNV<sub>HS-P80</sub> achieved an accuracy of 100 % (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S8) at all <italic>true</italic> variant frequencies. As seen from the Receiver Operating Characteristic (ROC) curves at different coverage depth (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S16-S19), the performance of QQ-SNV is best at the highest sequencing depth and becomes worse for non-UDS datasets (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S9). The same is observed for the other methods, although for ShoRAH we note better performance at 10 % downsampling than at 40 % downsampling or for the full HCV plasmid mixture datasets (all paired-end reads) (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S9 and Table <xref rid="Tab5" ref-type="table">5</xref>).<table-wrap id="Tab5"><label>Table 5</label><caption><p>Performance on HCV plasmid mixture datasets</p></caption><table frame="hsides" rules="groups"><tbody><tr><td/><td/><td colspan="2">QQ-SNV<sub>D</sub>
</td><td colspan="2">QQ-SNV<sub>HS-P80</sub>
<sup>a</sup>
</td><td colspan="2">LoFreq</td><td colspan="2">ShoRAH</td><td colspan="2">V-Phaser 2</td></tr><tr><td>Variant %</td><td>Pair</td><td>sens.<sup>b</sup>
</td><td>FP<sup>c</sup>
</td><td>sens.<sup>b</sup>
</td><td>FP<sup>c</sup>
</td><td>sens.<sup>b</sup>
</td><td>FP<sup>c</sup>
</td><td>sens.<sup>b</sup>
</td><td>FP<sup>c</sup>
</td><td>sens.<sup>b</sup>
</td><td>FP<sup>c</sup>
</td></tr><tr><td> 0.50 %</td><td>1<sup>d</sup>
</td><td>5/5</td><td>10</td><td>5/5</td><td>38</td><td>5/5</td><td>36</td><td>5/5</td><td>2</td><td>5/5</td><td>11</td></tr><tr><td> 0.50 %</td><td>2<sup>e</sup>
</td><td>0/5</td><td>0</td><td>0/5</td><td>0</td><td>0/5</td><td>0</td><td>0/5</td><td>0</td><td>3/5</td><td>15</td></tr><tr><td> 0.50 %</td><td>1 + 2<sup>f</sup>
</td><td>1/5</td><td>0</td><td>5/5</td><td>0</td><td>2/5</td><td>5</td><td>2/5</td><td>7</td><td>3/5</td><td>32</td></tr><tr><td> 1 %</td><td>1<sup>d</sup>
</td><td>5/5</td><td>11</td><td>5/5</td><td>53</td><td>5/5</td><td>62</td><td>5/5</td><td>2</td><td>5/5</td><td>13</td></tr><tr><td> 1 %</td><td>2<sup>e</sup>
</td><td>1/5</td><td>0</td><td>5/5</td><td>0</td><td>5/5</td><td>1</td><td>2/5</td><td>1</td><td>2/5</td><td>28</td></tr><tr><td> 1 %</td><td>1 + 2<sup>f</sup>
</td><td>3/5</td><td>1</td><td>5/5</td><td>0</td><td>5/5</td><td>7</td><td>4/5</td><td>1</td><td>3/5</td><td>45</td></tr><tr><td> 2 %</td><td>1<sup>d</sup>
</td><td>5/5</td><td>13</td><td>5/5</td><td>64</td><td>5/5</td><td>72</td><td>5/5</td><td>4</td><td>2/5</td><td>20</td></tr><tr><td> 2 %</td><td>2<sup>e</sup>
</td><td>3/5</td><td>0</td><td>5/5</td><td>0</td><td>5/5</td><td>1</td><td>3/5</td><td>0</td><td>3/5</td><td>14</td></tr><tr><td> 2 %</td><td>1 + 2<sup>f</sup>
</td><td>5/5</td><td>0</td><td>5/5</td><td>0</td><td>5/5</td><td>7</td><td>5/5</td><td>2</td><td>3/5</td><td>28</td></tr><tr><td> 10 %</td><td>1<sup>d</sup>
</td><td>5/5</td><td>6</td><td>5/5</td><td>42</td><td>5/5</td><td>75</td><td>5/5</td><td>0</td><td>3/5</td><td>10</td></tr><tr><td> 10 %</td><td>2<sup>e</sup>
</td><td>5/5</td><td>0</td><td>5/5</td><td>0</td><td>5/5</td><td>0</td><td>5/5</td><td>0</td><td>2/5</td><td>28</td></tr><tr><td> 10 %</td><td>1 + 2<sup>f</sup>
</td><td>5/5</td><td>0</td><td>5/5</td><td>0</td><td>5/5</td><td>8</td><td>5/5</td><td>1</td><td>2/5</td><td>56</td></tr><tr><td/><td/><td>time<sup>gh</sup>
</td><td/><td>time<sup>gh</sup>
</td><td/><td>time<sup>gi</sup>
</td><td/><td>time<sup>gj</sup>
</td><td/><td>time<sup>gj</sup>
</td><td/></tr><tr><td> 0.50 %</td><td>1<sup>d</sup>
</td><td>2m27s</td><td/><td>2m27s</td><td/><td>1m30s</td><td/><td>1h45m</td><td/><td>8m7s</td><td/></tr><tr><td> 0.50 %</td><td>2<sup>e</sup>
</td><td>2m18s</td><td/><td>2m18s</td><td/><td>1m33s</td><td/><td>9h29m</td><td/><td>22m3s</td><td/></tr><tr><td> 0.50 %</td><td>1 + 2<sup>f</sup>
</td><td>4m42s</td><td/><td>4m42s</td><td/><td>3m36s</td><td/><td>15h4m</td><td/><td>2h31m</td><td/></tr><tr><td> 1 %</td><td>1<sup>d</sup>
</td><td>2m56s</td><td/><td>2m56s</td><td/><td>2m27s</td><td/><td>1h38m</td><td/><td>10m51s</td><td/></tr><tr><td> 1 %</td><td>2<sup>e</sup>
</td><td>3m1s</td><td/><td>3m1s</td><td/><td>2m6s</td><td/><td>8h46m</td><td/><td>46m44s</td><td/></tr><tr><td> 1 %</td><td>1 + 2<sup>f</sup>
</td><td>5m48s</td><td/><td>5m48s</td><td/><td>5m56s</td><td/><td>13h13m</td><td/><td>3h46m</td><td/></tr><tr><td> 2 %</td><td>1<sup>d</sup>
</td><td>2m35s</td><td/><td>2m35s</td><td/><td>2m6s</td><td/><td>1h34m</td><td/><td>10m25s</td><td/></tr><tr><td> 2 %</td><td>2<sup>e</sup>
</td><td>2m32s</td><td/><td>2m32s</td><td/><td>1m53s</td><td/><td>8h50m</td><td/><td>41m1s</td><td/></tr><tr><td> 2 %</td><td>1 + 2<sup>f</sup>
</td><td>4m59s</td><td/><td>4m59s</td><td/><td>4m34s</td><td/><td>14h56m</td><td/><td>1h47m</td><td/></tr><tr><td> 10 %</td><td>1<sup>d</sup>
</td><td>3m5s</td><td/><td>3m5s</td><td/><td>4m26s</td><td/><td>1h46m</td><td/><td>13m45s</td><td/></tr><tr><td> 10 %</td><td>2<sup>e</sup>
</td><td>2m30s</td><td/><td>2m30s</td><td/><td>2m35s</td><td/><td>14h13m</td><td/><td>33m24s</td><td/></tr><tr><td> 10 %</td><td>1 + 2<sup>f</sup>
</td><td>5m29s</td><td/><td>5m29s</td><td/><td>9m53s</td><td/><td>7h57m</td><td/><td>1h47m</td><td/></tr></tbody></table><table-wrap-foot><p><sup>a</sup>80<sup>th</sup> percentile of the QQ-SNV<sub>HS</sub> distribution of “error” frequencies was used as frequency cutoff to decrease the number of false positives obtained with QQ-SNV<sub>HS</sub>
</p><p><sup>b</sup>sens. is the percentage of <italic>true</italic> variants that were correctly called as SNV</p><p><sup>c</sup>FP is the number of variants incorrectly called as SNV</p><p><sup>d</sup>Reads 1 of paired-end reads</p><p><sup>e</sup>Reads 2 of paired-end reads (sequenced after paired-end turn)</p><p><sup>f</sup>All paired-end reads</p><p><sup>g</sup>computation time in hours (h), minutes (m) and seconds (s)</p><p><sup>h</sup>Windows 7 64 bit, 8GB RAM, 3.2GHz</p><p><sup>i</sup>Linux Ubuntu 12.04.4, 57.6 GB RAM, one core (2.3GHz) used</p><p><sup>j</sup>Linux Ubuntu 12.04.4, 57.6 GB RAM, 8 cores (2.3GHz) used in parallel</p></table-wrap-foot></table-wrap>
</p>
      <sec id="Sec30">
        <title>Paired-end vs. single-end data</title>
        <p>Although, on these HCV data sets QQ-SNV<sub>HS-P80</sub> obtained perfect performance on the combined reads 1 and reads 2 data, on the reads 1 data QQ-SNV<sub>D</sub> is more accurate than QQ-SNV<sub>HS-P80</sub>.</p>
      </sec>
      <sec id="Sec31">
        <title>Computational efficiency</title>
        <p>For QQ-SNV the runtime needed increased linearly with coverage and was independent of variant frequency (Fig. <xref rid="Fig2" ref-type="fig">2</xref> and Table <xref rid="Tab5" ref-type="table">5</xref>), whereas for LoFreq computational efficiency decreased for detection of variants at 10 %. At a coverage depth of 98,800 reads for the combined reads 1 and reads 2 data QQ-SNV was 1.8 times faster than LoFreq (5m29s <italic>vs.</italic> 9m53s). V-Phaser 2 and ShoRAH needed considerably more time: 1h47m and 7h57m, respectively. For detection of variants ≤ 2 % computational efficiency of QQ-SNV was similar as for LoFreq (Fig. <xref rid="Fig2" ref-type="fig">2</xref> and Table <xref rid="Tab5" ref-type="table">5</xref>).<fig id="Fig2"><label>Fig. 2</label><caption><p>QQ-SNV <italic>vs.</italic> other methods: computational efficiency on HCV plasmid mixture datasets. On the x-axis is the coverage, which is the average number of reads per position. On the y-axis is the computation time in minutes. A reference line is shown at 5 and 60 min. The size of the data points (reads 1, reads 2 and reads 1 + 2) shown for the different HCV datasets corresponds to the variant percentage (0.5 %, 1 %, 2 % and 10 %)</p></caption><graphic xlink:href="12859_2015_812_Fig2_HTML" id="MO2"/></fig>
</p>
      </sec>
    </sec>
    <sec id="Sec32">
      <title>Performance evaluation on H1N1 clinical dataset</title>
      <p>The results of the performance comparison of the different methods on a H1N1 clinical sample, sequenced on Illumina GAIIx and MiSeq platforms (37 bp reads) are given in Table <xref rid="Tab6" ref-type="table">6</xref> and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S10. Here, variants in the region 405–425 of the neuraminidase gene were all present at a very low frequency below 0.5 %. In [<xref ref-type="bibr" rid="CR12">12</xref>], four SNVs were called at the positions 410, 413, 415, and 421, and the other seventeen positions were considered “non-variant”.<table-wrap id="Tab6"><label>Table 6</label><caption><p>Performance on H1N1 clinical sample</p></caption><table frame="hsides" rules="groups"><tbody><tr><td/><td/><td colspan="2">QQ-SNV<sub>D</sub>
</td><td colspan="2">QQ-SNV<sub>HS-P80</sub>
<sup>a</sup>
</td><td colspan="2">LoFreq</td><td colspan="2">ShoRAH</td><td colspan="2">V-Phaser 2</td></tr><tr><td>Illumina sequencer</td><td>Pair</td><td>sens.<sup>b</sup>
</td><td>FP<sup>c</sup>
</td><td>sens.<sup>b</sup>
</td><td>FP<sup>c</sup>
</td><td>sens.<sup>b</sup>
</td><td>FP<sup>c</sup>
</td><td>sens.<sup>b</sup>
</td><td>FP<sup>c</sup>
</td><td>sens.<sup>b</sup>
</td><td>FP<sup>c</sup>
</td></tr><tr><td> GAIIx</td><td>1<sup>d</sup>
</td><td>0/4</td><td>0</td><td>4/4</td><td>2</td><td>2/4</td><td>0</td><td>0/4</td><td>0</td><td>1/4</td><td>0</td></tr><tr><td> GAIIx</td><td>2<sup>e</sup>
</td><td>0/4</td><td>0</td><td>4/4</td><td>1</td><td>3/4</td><td>0</td><td>0/4</td><td>0</td><td>0/4</td><td>0</td></tr><tr><td> GAIIx</td><td>1 + 2<sup>f</sup>
</td><td>0/4</td><td>0</td><td>4/4</td><td>4</td><td>3/4</td><td>0</td><td>0/4</td><td>0</td><td>na<sup>k</sup>
</td><td>na<sup>k</sup>
</td></tr><tr><td> MiSeq</td><td>1<sup>d</sup>
</td><td>2/4</td><td>1</td><td>4/4</td><td>5</td><td>0/4</td><td>0</td><td>0/4</td><td>0</td><td>0/4</td><td>0</td></tr><tr><td> MiSeq</td><td>2<sup>e</sup>
</td><td>2/4</td><td>0</td><td>4/4</td><td>2</td><td>0/4</td><td>0</td><td>na<sup>k</sup>
</td><td>na<sup>k</sup>
</td><td>0/4</td><td>0</td></tr><tr><td> MiSeq</td><td>1 + 2<sup>f</sup>
</td><td>4/4</td><td>3</td><td>4/4</td><td>6</td><td>0/4</td><td>0</td><td>na<sup>k</sup>
</td><td>na<sup>k</sup>
</td><td>na<sup>k</sup>
</td><td>na<sup>k</sup>
</td></tr><tr><td/><td/><td>time<sup>gh</sup>
</td><td/><td>time<sup>gh</sup>
</td><td/><td>time<sup>gi</sup>
</td><td/><td>time<sup>gj</sup>
</td><td/><td>time<sup>gj</sup>
</td><td/></tr><tr><td> GAIIx</td><td>1<sup>d</sup>
</td><td>12m51s</td><td/><td>12m51s</td><td/><td>7m46s</td><td/><td>6h1m</td><td/><td>43m15s</td><td/></tr><tr><td> GAIIx</td><td>2<sup>e</sup>
</td><td>13m5s</td><td/><td>13m5s</td><td/><td>7m55s</td><td/><td>6h41m</td><td/><td>43m6s</td><td/></tr><tr><td> GAIIx</td><td>1 + 2<sup>f</sup>
</td><td>21m56s</td><td/><td>21m56s</td><td/><td>19m1s</td><td/><td>2h18m</td><td/><td>na<sup>k</sup>
</td><td/></tr><tr><td> MiSeq</td><td>1<sup>d</sup>
</td><td>1m11s</td><td/><td>1m11s</td><td/><td>26 s</td><td/><td>5h46m</td><td/><td>3m40s</td><td/></tr><tr><td> MiSeq</td><td>2<sup>e</sup>
</td><td>1m23s</td><td/><td>1m23s</td><td/><td>24 s</td><td/><td>na<sup>k</sup>
</td><td/><td>3m55s</td><td/></tr><tr><td> MiSeq</td><td>1 + 2<sup>f</sup>
</td><td>2m45s</td><td/><td>2m45s</td><td/><td>1 m</td><td/><td>na<sup>k</sup>
</td><td/><td>na<sup>k</sup>
</td><td/></tr></tbody></table><table-wrap-foot><p><sup>a</sup>80<sup>th</sup> percentile of the QQ-SNV<sub>HS</sub> distribution of “error” frequencies was used as frequency cutoff to decrease the number of false positives obtained with QQ-SNV<sub>HS</sub>
</p><p><sup>b</sup>sens. is the percentage of SNVs as identified in [<xref ref-type="bibr" rid="CR12">12</xref>] that were called as SNV by QQ-SNV in region 405–425 of NA gene in H1N1 BN3 sample</p><p><sup>c</sup>FP is the number of “non-variants” in [<xref ref-type="bibr" rid="CR12">12</xref>] that were called as SNV by QQ-SNV</p><p><sup>d</sup>Reads 1 of paired-end reads</p><p><sup>e</sup>Reads 2 of paired-end reads (sequenced after paired-end turn)</p><p><sup>f</sup>All paired-end reads</p><p><sup>g</sup>computation time in hours (h), minutes (m) and seconds (s)</p><p><sup>h</sup>Windows 7 64 bit, 8GB RAM, 3.2GHz</p><p><sup>i</sup>Linux Ubuntu 12.04.4, 57.6 GB RAM, one core (2.3GHz) used</p><p><sup>j</sup>Linux Ubuntu 12.04.4, 57.6 GB RAM, 8 cores (2.3GHz) used in parallel</p><p><sup>k</sup>No result could be obtained for the ShoRAH/V-Phaser 2 algorithm due to failure of the ShoRAH/V-Phaser 2 software tool on our server</p></table-wrap-foot></table-wrap>
</p>
      <sec id="Sec33">
        <title>Paired-end vs. single-end data</title>
        <p>From the GAIIx data, QQ-SNV<sub>D</sub> did not detect any of these four SNVs (Table <xref rid="Tab6" ref-type="table">6</xref>). From the MiSeq reads 1 or reads 2 data, 2/4 of these SNVs could be detected by QQ-SNV<sub>D</sub>. Only for the MiSeq combined reads 1 and reads 2 data QQ-SNV<sub>D</sub> had 100 % sensitivity in detecting these four SNVs, at a specificity of 82.4 % (percentage of “non-variants” in [<xref ref-type="bibr" rid="CR12">12</xref>], also classified as “non-variant” by QQ-SNV) (Table <xref rid="Tab6" ref-type="table">6</xref>). In contrast, QQ-SNV<sub>HS</sub> and QQ-SNV<sub>HS-P50/P75/P80/P85/P90/P95</sub> was 100 % sensitive when presented with either GAIIx/MiSeq reads 1 data, reads 2 data, or the combined reads 1 and reads 2 data (Table <xref rid="Tab6" ref-type="table">6</xref> and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S10). Due to failure, paired-end results could not be obtained for V-Phaser 2 on both the GAIIx and MiSeq data and for ShoRAH on the MiSeq data.</p>
      </sec>
      <sec id="Sec34">
        <title>Effect on different Illumina sequencer types</title>
        <p>Whereas, the four SNVs were consistently detected from both GAIIx and MiSeq data using QQ-SNV<sub>HS</sub> or QQ-SNV<sub>HS</sub> applying a SNV frequency threshold (Table <xref rid="Tab6" ref-type="table">6</xref> and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S10), none of the SNVs were detected from the other methods on the MiSeq data (Table <xref rid="Tab6" ref-type="table">6</xref>). However, V-Phaser 2 and LoFreq were able to detect one and three SNVs from the GAIIx data, respectively. ShoRAH did also not detect any of the SNVs from the GAIIx data (Table <xref rid="Tab6" ref-type="table">6</xref>).</p>
        <p>When comparing the specificity of QQ-SNV<sub>HS-P80</sub> for the two platforms, a higher specificity was obtained from GAIIx versus MiSeq data: 76.5–94.1 % <italic>vs.</italic> 64.7–88.2 %. Table <xref rid="Tab7" ref-type="table">7</xref> lists the different positions where a nucleotide variant was classified as SNV by QQ-SNV<sub>HS-P80</sub> from the combined reads 1 and reads 2 data for GAIIx and MiSeq. For the GAIIx data, the four SNVs considered to be <italic>true</italic> were detected in the frequency range [0.25–0.35 %], whereas the variants called as SNV by QQ-SNV<sub>HS-P80</sub> only were in the frequency range [0.13–0.18 %]. For the MiSeq data, the four SNVs were detected in the frequency range [0.14–0.28 %], and the variants called as SNV by QQ-SNV<sub>HS-P80</sub> only were in the frequency range [0.07–0.10 %]. For the MiSeq data, two variants with frequency &lt; 0.1 % had high predicted SNV probabilities 0.882 and 0.999 (Table <xref rid="Tab7" ref-type="table">7</xref>), although they were not called as SNV on the GAIIx. While a reason could be that a higher coverage was used on the GAIIx compared to MiSeq, it might indicate that the lower limit of reliable detection was exceeded.<table-wrap id="Tab7"><label>Table 7</label><caption><p>SNVs called by QQ-SNV<sub>HS-P80</sub> on H1N1 clinical sample (all paired-end reads)</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th colspan="2">GAIIx</th><th colspan="2">MiSeq</th><th rowspan="2">SNV identified in [<xref ref-type="bibr" rid="CR12">12</xref>]</th></tr><tr><th>Position<sup>a</sup>
</th><th>Percentage<sup>b</sup>
</th><th>P(SNV)<sup>c</sup>
</th><th>Percentage<sup>b</sup>
</th><th>P(SNV)<sup>c</sup>
</th></tr></thead><tbody><tr><td>406</td><td>na<sup>d</sup>
</td><td>na<sup>d</sup>
</td><td>0.09 %</td><td char="." align="char">0.99923</td><td>No</td></tr><tr><td>409</td><td>0.13 %</td><td>0.00110</td><td>0.10 %</td><td char="." align="char">0.00517</td><td>No</td></tr><tr><td>410</td><td>0.35 %</td><td>0.05514</td><td>0.28 %</td><td char="." align="char">0.60047</td><td>Yes</td></tr><tr><td>411</td><td>0.13 %</td><td>0.00016</td><td>0.09 %</td><td char="." align="char">0.00318</td><td>No</td></tr><tr><td>413</td><td>0.26 %</td><td>0.00482</td><td>0.14 %</td><td char="." align="char">0.98815</td><td>Yes</td></tr><tr><td>415</td><td>0.25 %</td><td>0.00207</td><td>0.16 %</td><td char="." align="char">0.98665</td><td>Yes</td></tr><tr><td>418</td><td>0.18 %</td><td>0.00011</td><td>0.09 %</td><td char="." align="char">0.00769</td><td>No</td></tr><tr><td>421</td><td>0.26 %</td><td>0.04058</td><td>0.16 %</td><td char="." align="char">0.94675</td><td>Yes</td></tr><tr><td>423</td><td>0.15 %</td><td>0.00012</td><td>0.08 %</td><td char="." align="char">0.02083</td><td>No</td></tr><tr><td>425</td><td>na<sup>d</sup>
</td><td>na<sup>d</sup>
</td><td>0.07 %</td><td char="." align="char">0.88219</td><td>No</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>Nucleotide position in neuraminidase (NA) gene</p><p><sup>b</sup>Observed frequency of single nucleotide variant called by QQ-SNV</p><p><sup>c</sup>Probability that variant is a SNV, as predicted by QQ-SNV</p><p><sup>d</sup>Not classified as SNV by QQ-SNV<sub>HS-P80</sub>, P(SNV) ≤ 0.0001</p></table-wrap-foot></table-wrap>
</p>
        <p>The Quality Quantile plot for the nucleotides at NA position 410 for the combined reads 1 and reads 2 data, and for both GAIIx and MiSeq is shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. The distance between the recalibrated quality quantile curves of the nucleotide C and the reference nucleotide T is small enough for QQ-SNV<sub>HS-P80</sub> to detect the SNV 410 T &gt; C. This distance is smaller for the MiSeq data compared to the GAIIx data, which is reflected in a higher QQ-SNV predicted SNV probability for MiSeq (0.60 <italic>vs.</italic> 0.055). For sequencing errors the curve in forward direction can look very different from the curve reflecting the reverse direction (e.g. 410 T &gt; G for MiSeq).<fig id="Fig3"><label>Fig. 3</label><caption><p>Quality Quantile plot. SNV 410 T &gt; C is called by QQ-SNV<sub>HS-P80</sub> both on GAIIx and MiSeq for H1N1 clinical sample BN3 [<xref ref-type="bibr" rid="CR12">12</xref>] at position 410 of the neuraminidase (NA) gene</p></caption><graphic xlink:href="12859_2015_812_Fig3_HTML" id="MO3"/></fig>
</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec35" sec-type="discussion">
    <title>Discussion</title>
    <p>We described our novel method for SNV calling on NGS data of viral populations, called QQ-SNV, and compared its performance to the existing methods LoFreq, V-Phaser 2 and ShoRAH. Our methodology differs from these other methods in using a logistic regression model. Therefore, QQ-SNV is more related to the regression classifier methods in [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR18">18</xref>] that were developed for SNV detection in a genome wide and low coverage situation, whereas the goal of our method is to detect <italic>true</italic> variants at low frequency on ultra-deep sequencing datasets. Furthermore, we aimed for a method that can be applied on different Illumina datasets without retraining of the model. Thereto, the QQ-SNV model was trained on a multi-sample dataset of <italic>in silico</italic> plasmid mixtures, without using any sequence context specific covariates for the model. Instead, we introduced “distance metrics” as covariates to compare the nucleotide quality quantiles to the “per position” reference quality. For future research, incremental further improvement of the QQ-SNV model might be possible, e.g. by exploration of other distance metrics in a simulation study or by implementing an extension of our method to enable to call variants at the codon level [<xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR27">27</xref>] in addition to SNVs.</p>
    <p>In comparison with many of the existing methods, the QQ-SNV method is a computational lightweight variant detection method that limits pre- and post-processing of the data. This results from taking as input the “raw” read mapping data, no filtering or trimming is required. Error-recalibration is incorporated, but QQ-SNV does not perform error-correction (unlike e.g. ShoRAH). Although QQ-SNV returns the “observed” frequency percentages of the <italic>true</italic> variants (thus, biased by the errors), the nucleotide counts are not used inside the method. For QQ-SNV a strand bias test filter is not needed as read directionality is already used in the regression, whereas for e.g. V-Phaser 2 applying a strand bias test led to not detecting SNVs at the higher percentages. Moreover, whereas in a strand bias test one assesses differences in frequency, the novelty of the QQ-SNV method is in evaluating differences in quality instead. For default application of QQ-SNV, using a SNV probability cutoff of 0.5 (QQ-SNV<sub>D</sub>), no filtering needs to be applied after classification. Whereas QQ-SNV<sub>D</sub> has similar performance as the existing methods, to increase sensitivity a QQ-SNV probability cutoff of 0.0001 was used (QQ-SNV<sub>HS</sub>). Here, to avoid many false positives one frequency based variant filtering step was implemented to overrule SNVs called by QQ-SNV<sub>HS</sub> when the observed frequency is below the 80<sup>th</sup> percentile calculated on the QQ-SNV<sub>HS</sub> distribution of “error” frequencies (QQ-SNV<sub>HS-P80</sub>). On the test sets the results obtained with QQ-SNV<sub>HS-P80</sub> were consistent for the different Illumina platforms: GAIIx, MiSeq and HiSeq 2000. Although the training of our model has been performed on a fixed read length of 51 bp, QQ-SNV is developed for any read length. Therefore, for verification we performed the QQ-SNV workflow (Fig. <xref rid="Fig1" ref-type="fig">1</xref>) on 250 bp sequencing reads of an influenza A plasmid mixture dataset [<xref ref-type="bibr" rid="CR28">28</xref>]. This confirmed applicability of QQ-SNV for read lengths enabled by the current Illumina sequencers (Additional file <xref rid="MOESM5" ref-type="media">5</xref>). Based on the presented results we suggest, regardless of quality of the data obtained or the Illumina platform used for the sequencing, to use QQ-SNV<sub>HS-P80</sub> to detect <italic>true</italic> variants at low frequency as well as at higher frequencies on the combined reads 1 and reads 2 data (in case of paired-end data), or on reads 1 data (in case no paired end data is available). However, in case specificity is considered more important than sensitivity QQ-SNV<sub>D</sub> can be applied instead. In case single end data is processed separately and paired end data is also available, our recommendation to use QQ-SNV<sub>D</sub>
<italic>vs.</italic> QQ-SNV<sub>HS-P80</sub> on the single end data is cf given below. QQ-SNV does not need reference control samples. Yet in case these are available, running QQ-SNV on the controls might give indication on how to more optimally choose the SNV probability cutoff and/or the variant frequency threshold to be used for the clinical samples in the experiment.</p>
    <p>Although on the newest Illumina machines quality degradation should no longer be a major issue for reads 2 data of paired-end reads [<xref ref-type="bibr" rid="CR13">13</xref>], for both the HIV and HCV plasmids data, a lower quality was observed for the reads 2 compared to the reads 1 data. Therefore, it could be valuable in case paired-end sequencing data was obtained not to perform the variant detection on the combined reads 1 and reads 2 data only, but as a quality check also for the reads 1 and/or reads 2 data, separately. When separately processing the reads 1 and/or reads 2 data, paired end information could then also be used in deciding whether to apply QQ-SNV<sub>D</sub> or QQ-SNV<sub>HS-P80</sub> for the “final” single-end variant calling, by using the following two rules: I) If the number of variants identified using QQ-SNV<sub>HS-P80</sub> on the reads 1 and reads 2 data combined is lower than the number of variants identified using QQ-SNV<sub>HS-P80</sub> on the reads 1 data, then use QQ-SNV<sub>D</sub> for the final variant calling on the reads 1 data, else use QQ-SNV<sub>HS-P80</sub>. II) If by the above rule QQ-SNV<sub>D</sub> is used for the final variant calling on the reads 1 data and if the number of variants identified using QQ-SNV<sub>D</sub> on the reads 2 data is larger than the number of variants identified using QQ-SNV<sub>D</sub> on the reads 1 data then use QQ-SNV<sub>D</sub> for the final variant calling on the reads 2 data, else use QQ-SNV<sub>HS-P80</sub>. While we did not notice quality degradation of the reads 2 data for the H1N1 clinical sample, the predicted SNV probabilities were higher for MiSeq than for GAIIx. However, we note that on the MiSeq the experiment was performed with a 10-fold lower coverage depth than on the GAIIx.</p>
  </sec>
  <sec id="Sec36" sec-type="conclusion">
    <title>Conclusions</title>
    <p>We have developed QQ-SNV for single nucleotide variant detection from NGS deep sequencing data. Different from the existing methods ShoRAH and V-Phaser 2, QQ-SNV is tailor-made for the Illumina NGS systems, a platform expected to be increasingly used for clinical diagnostic purposes. Our focus on the error profile of a single NGS technology, combined with the fact that we trained a regression model on a multi-sample dataset designed to contain <italic>true</italic> variants with percentages populated in the range [0.5-100 %], contributed to the improved performance of QQ-SNV in detecting variants in comparison to the ShoRAH, and V-Phaser 2 algorithms, and in detecting low frequency variants in comparison to LoFreq.</p>
    <p>Importantly, instead of modeling nucleotide counts or using any particular sequence specific knowledge, we use the recalibrated quality quantiles, which were calculated per read direction, as the only main parameters in the QQ-SNV model to predict SNV probabilities from the observed quality distributions of the nucleotides present at a particular position in the read mapping. Therefore, in addition to the analysis of viral population data, as exemplified in this manuscript, QQ-SNV could potentially also be applied to any other type of heterogeneous population data.</p>
    <p>Finally, QQ-SNV has the advantage of being extremely computationally efficient in handling “ultradeep” read sets, since SNV calling is reduced to a classification method based on logistic regression.</p>
  </sec>
  <sec id="Sec37">
    <title>Availability and requirements</title>
    <p><bold>Project name:</bold> QQ-SNV</p>
    <p>
      <bold>Project home page:</bold>
      <ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/qqsnv/">http://sourceforge.net/projects/qqsnv/</ext-link>
    </p>
    <p><bold>Operating system:</bold> Platform independent</p>
    <p><bold>Programming language:</bold> SAS 9.2, perl</p>
    <p><bold>Other requirements:</bold> Illumina sequencing</p>
    <p><bold>License:</bold> GNU GPL</p>
    <p>Any restrictions to use by non-academics: none</p>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec38">
        <title>Additional files</title>
        <p>
          <media position="anchor" xlink:href="12859_2015_812_MOESM1_ESM.pdf" id="MOESM1">
            <label>Additional file 1:</label>
            <caption>
              <p><bold>Supplementary Figures.</bold> Quality scores Illumina and Quality Quantile plot “raw” (<bold>Figures S1 and S2</bold>). Quality scores and Quality Quantile plot after recalibration (<bold>Figures S3 and S4</bold>). Coverage of plasmids in the training data (<bold>Figure S5</bold>) and distribution of <italic>true</italic> frequencies of <italic>in silico</italic> SNVs in the ground set of 960 samples (<bold>Figure S6</bold>). Distance metrics considered for the QQ-SNV model: QQnorm, QQ, and D (<bold>Figures S7-S9</bold>). ROC curves for QQ-SNV comparing quality score recalibration <italic>vs.</italic> no quality score recalibration on the HCV plasmid mixture test datasets (<bold>Figure S10</bold>). Distance metrics per read direction: QQnorm.dir, QQ.dir, and D.dir (<bold>Figures S11-S13</bold>). Choice of weights for fitting the QQ-SNV model parameters (<bold>Figure S14</bold>). Performance of QQ-SNV<sub>HS-P80</sub>, LoFreq, ShoRAH and V-Phaser 2 on the plasmid mixture test datasets (<bold>Figure S15</bold>). ROC curves for QQ-SNV at different coverage depths (<bold>Figures S16-S19</bold>). (PDF 420 kb)</p>
            </caption>
          </media>
          <media position="anchor" xlink:href="12859_2015_812_MOESM2_ESM.pdf" id="MOESM2">
            <label>Additional file 2:</label>
            <caption>
              <p><bold>Supplementary Tables.</bold> Sequence and error profile of HIV plasmids (<bold>Tables S1-S3</bold>). Training performance of QQ-SNV (<bold>Table S4</bold>), performance of QQ-SNV on <italic>in silico</italic> HIV plasmid mixture ground set (<bold>Table S5</bold>) and performance of QQ-SNV on HIV, HCV and H1N1 test sets (<bold>Tables S6-S10</bold>). (PDF 84 kb)</p>
            </caption>
          </media>
          <media position="anchor" xlink:href="12859_2015_812_MOESM3_ESM.pdf" id="MOESM3">
            <label>Additional file 3:</label>
            <caption>
              <p><bold>Supporting evidence for stability of coefficients in the QQ-SNV companion logistic regression recalibration model.</bold> (PDF 6 kb)</p>
            </caption>
          </media>
          <media position="anchor" xlink:href="12859_2015_812_MOESM4_ESM.zip" id="MOESM4">
            <label>Additional file 4:</label>
            <caption>
              <p><bold>QQ-SNV.</bold> The ZIP archive contains the following three files: the main perl script file to be executed QQ-SNV_workflow.pl and the SAS files QQ-SNV.sas and get_quantiles.sas. To test QQ-SNV, the read alignment files in SAM format for the HCV plasmid mixture data (downsampled 40 %) and the HCV 1b reference file in FASTA format can be downloaded from http://sourceforge.net/projects/qqsnv. To run QQ-SNV execute the following command: perl QQ-SNV_workflow.pl. (ZIP 5 kb)</p>
            </caption>
          </media>
          <media position="anchor" xlink:href="12859_2015_812_MOESM5_ESM.pdf" id="MOESM5">
            <label>Additional file 5:</label>
            <caption>
              <p><bold>Supporting evidence for applicability of QQ-SNV for SNV calling on Illumina NGS sequencing data of any read length.</bold> (PDF 32 kb)</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <fn-group>
    <fn>
      <p>
        <bold>Competing interests</bold>
      </p>
      <p>The authors declare that they have no competing interests.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors’ contributions</bold>
      </p>
      <p>KVdB developed and implemented the QQ-SNV methodology, and drafted the manuscript. YW assisted with the Illumina software and running of the ShoRAH, V-Phaser 2 and LoFreq algorithms. BV, LC, JR and HvV assisted in study design. KT and JA conceived of the study and assisted in its design. All authors read and approved the final manuscript.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors would like to thank the team members who conducted the Illumina lab experiments, and acknowledge Herwig Van Marck for his insights at the start of the project.</p>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barzon</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Lavezzo</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Militello</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Toppo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Palu</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Applications of next-generation sequencing technologies to diagnostic virology</article-title>
        <source>Int J Mol Sci</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>7861</fpage>
        <lpage>7884</lpage>
        <pub-id pub-id-type="doi">10.3390/ijms12117861</pub-id>
        <pub-id pub-id-type="pmid">22174638</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Gunthard</surname>
            <given-names>HF</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Metzner</surname>
            <given-names>KJ</given-names>
          </name>
        </person-group>
        <article-title>Challenges and opportunities in estimating viral genetic diversity from next-generation sequencing data</article-title>
        <source>Front Microbiol</source>
        <year>2012</year>
        <volume>3</volume>
        <fpage>329</fpage>
        <pub-id pub-id-type="doi">10.3389/fmicb.2012.00329</pub-id>
        <pub-id pub-id-type="pmid">22973268</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Capobianchi</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Giombini</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Rozera</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Next-generation sequencing technology in clinical virology</article-title>
        <source>Clin Microbiol Infect</source>
        <year>2013</year>
        <volume>19</volume>
        <fpage>15</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.1111/1469-0691.12056</pub-id>
        <pub-id pub-id-type="pmid">23279287</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cruz-Rivera</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Forbi</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Yamasaki</surname>
            <given-names>LH</given-names>
          </name>
          <name>
            <surname>Vazquez-Chacon</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Martinez-Guarneros</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Carpio-Pedroza</surname>
            <given-names>JC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Molecular epidemiology of viral diseases in the era of next generation sequencing</article-title>
        <source>J Clin Virol</source>
        <year>2013</year>
        <volume>57</volume>
        <fpage>378</fpage>
        <lpage>380</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jcv.2013.04.021</pub-id>
        <pub-id pub-id-type="pmid">23726419</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Metzker</surname>
            <given-names>ML</given-names>
          </name>
        </person-group>
        <article-title>Sequencing technologies – the next generation</article-title>
        <source>Nat Rev Genet</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>31</fpage>
        <lpage>46</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2626</pub-id>
        <pub-id pub-id-type="pmid">19997069</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ronaghi</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Pyrosequencing sheds light on DNA sequencing</article-title>
        <source>Genome Res</source>
        <year>2001</year>
        <volume>11</volume>
        <fpage>3</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.11.1.3</pub-id>
        <pub-id pub-id-type="pmid">11156611</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McElroy</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Zagordi</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Bull</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Luciani</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Accurate single nucleotide variant detection in viral populations by combining probabilistic clustering with a statistical test of strand bias</article-title>
        <source>BMC Genomics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>501</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-14-501</pub-id>
        <pub-id pub-id-type="pmid">23879730</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Charlebois</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Macalalad</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Henn</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Zody</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>V-Phaser 2: variant inference for viral populations</article-title>
        <source>BMC Genomics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>674</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-14-674</pub-id>
        <pub-id pub-id-type="pmid">24088188</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilm</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Aw</surname>
            <given-names>PP</given-names>
          </name>
          <name>
            <surname>Bertrand</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Yeo</surname>
            <given-names>GH</given-names>
          </name>
          <name>
            <surname>Ong</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>CH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>LoFreq: a sequence-quality aware, ultra-sensitive variant caller for uncovering cell-population heterogeneity from high-throughput sequencing datasets</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>11189</fpage>
        <lpage>11201</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks918</pub-id>
        <pub-id pub-id-type="pmid">23066108</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gerstung</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Beisel</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Rechsteiner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wild</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Schraml</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Moch</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reliable detection of subclonal single-nucleotide variants in tumour cell populations</article-title>
        <source>Nat Commun</source>
        <year>2012</year>
        <volume>3</volume>
        <fpage>811</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms1814</pub-id>
        <pub-id pub-id-type="pmid">22549840</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Flaherty</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Natsoulis</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Muralidharan</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Winters</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Buenrostro</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bell</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ultrasensitive detection of rare mutations using next-generation targeted resequencing</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <pub-id pub-id-type="doi">10.1093/nar/gkr861</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cushing</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Flaherty</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hopmans</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Bell</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>HP</given-names>
          </name>
        </person-group>
        <article-title>RVD: a command-line program for ultrasensitive rare single nucleotide variant detection using targeted next-generation DNA resequencing</article-title>
        <source>BMC Res Notes</source>
        <year>2013</year>
        <volume>6</volume>
        <fpage>206</fpage>
        <pub-id pub-id-type="doi">10.1186/1756-0500-6-206</pub-id>
        <pub-id pub-id-type="pmid">23701658</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Minoche</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Dohm</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Himmelbauer</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of genomic high-throughput sequencing data generated on Illumina HiSeq and genome analyzer systems</article-title>
        <source>Genome Biol</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>R112</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2011-12-11-r112</pub-id>
        <pub-id pub-id-type="pmid">22067484</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cabanski</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Cavin</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bizon</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wilkerson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Parker</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Wilhelmsen</surname>
            <given-names>KC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ReQON: a Bioconductor package for recalibrating quality scores from next-generation sequencing data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>221</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-13-221</pub-id>
        <pub-id pub-id-type="pmid">22946927</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DePristo</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Banks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Poplin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Garimella</surname>
            <given-names>KV</given-names>
          </name>
          <name>
            <surname>Maguire</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Hartl</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title>
        <source>Nat Genet</source>
        <year>2011</year>
        <volume>43</volume>
        <fpage>491</fpage>
        <lpage>498</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.806</pub-id>
        <pub-id pub-id-type="pmid">21478889</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Coarfa</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Drabek</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ostrowski</surname>
            <given-names>EA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A SNP discovery method to assess variant allele probability from next-generation resequencing data</article-title>
        <source>Genome Res</source>
        <year>2010</year>
        <volume>20</volume>
        <fpage>273</fpage>
        <lpage>280</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.096388.109</pub-id>
        <pub-id pub-id-type="pmid">20019143</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bansal</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>A statistical method for the detection of variants from next-generation resequencing of DNA pools</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>i318</fpage>
        <lpage>i324</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq214</pub-id>
        <pub-id pub-id-type="pmid">20529923</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meacham</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Boffelli</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Dhahbi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>DI</given-names>
          </name>
          <name>
            <surname>Singer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Identification and correction of systematic error in high-throughput sequence data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>451</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-451</pub-id>
        <pub-id pub-id-type="pmid">22099972</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wei</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lyon</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Hakonarson</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>SNVer: a statistical tool for variant calling in analysis of pooled or individual next-generation sequencing data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2011</year>
        <volume>39</volume>
        <pub-id pub-id-type="doi">10.1093/nar/gkr599</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cock</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Fields</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Goto</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Heuer</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Rice</surname>
            <given-names>PM</given-names>
          </name>
        </person-group>
        <article-title>The Sanger FASTQ file format for sequences with quality scores, and the Solexa/Illumina FASTQ variants</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>1767</fpage>
        <lpage>1771</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkp1137</pub-id>
        <pub-id pub-id-type="pmid">20015970</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fonseca</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Rung</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Brazma</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Tools for mapping high-throughput sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>3169</fpage>
        <lpage>3177</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts605</pub-id>
        <pub-id pub-id-type="pmid">23060614</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>JZ</given-names>
          </name>
          <name>
            <surname>Chapman</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Charlebois</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hofmann</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Weiner</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Porter</surname>
            <given-names>AJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparison of illumina and 454 deep sequencing in participants failing raltegravir-based antiretroviral therapy</article-title>
        <source>PLoS One</source>
        <year>2014</year>
        <volume>9</volume>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0090485</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Handsaker</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wysoker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Homer</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Sequence Alignment/Map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Molenberghs</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Verbeke</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <source>Models for discrete longitudinal data</source>
        <year>2005</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rogers</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Models for vectors and vector-borne diseases</article-title>
        <source>Adv Parasitol</source>
        <year>2006</year>
        <volume>62</volume>
        <fpage>1</fpage>
        <lpage>35</lpage>
        <pub-id pub-id-type="doi">10.1016/S0065-308X(05)62001-5</pub-id>
        <pub-id pub-id-type="pmid">16647966</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Verbist</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Thys</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Reumers</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wetzels</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Van der Borght</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Talloen</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>VirVarSeq: a low-frequency virus variant detection pipeline for Illumina sequencing using adaptive base-calling accuracy filtering</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>94</fpage>
        <lpage>101</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu587</pub-id>
        <pub-id pub-id-type="pmid">25178459</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Verbist</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Clement</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Reumers</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Thys</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Vapirev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Talloen</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ViVaMBC: estimating viral sequence variation in complex populations from illumina deep-sequencing data using model-based clustering</article-title>
        <source>BMC Bioinformatics</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>59</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-015-0458-7</pub-id>
        <pub-id pub-id-type="pmid">25887734</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van den Hoecke</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Verhelst</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Vuylsteke</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Saelens</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Analysis of the genetic diversity of influenza A viruses using next-generation DNA sequencing</article-title>
        <source>BMC Genomics</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>79</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-015-1284-z</pub-id>
        <pub-id pub-id-type="pmid">25758772</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
