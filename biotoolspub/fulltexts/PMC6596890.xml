<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6596890</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bty946</article-id>
    <article-id pub-id-type="publisher-id">bty946</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genetics and Population Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Pair Matcher (<italic>PaM</italic>): fast model-based optimization of treatment/case-control matches</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Elhaik</surname>
          <given-names>Eran</given-names>
        </name>
        <xref ref-type="aff" rid="bty946-aff1">1</xref>
        <xref ref-type="aff" rid="bty946-aff2">2</xref>
        <xref ref-type="corresp" rid="bty946-cor1"/>
        <!--<email>e.elhaik@sheffield.ac.uk</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ryan</surname>
          <given-names>Desmond M</given-names>
        </name>
        <xref ref-type="aff" rid="bty946-aff1">1</xref>
      </contrib>
    </contrib-group>
    <aff id="bty946-aff1"><label>1</label>Department of Animal and Plant Sciences, University of Sheffield, Sheffield UK, UK</aff>
    <aff id="bty946-aff2"><label>2</label>INSIGNEO Institute for In Silico Medicine, University of Sheffield, Sheffield UK, UK</aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Berger</surname>
          <given-names>Bonnie</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="bty946-cor1">To whom correspondence should be addressed. E-mail: <email>e.elhaik@sheffield.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2018-11-16">
      <day>16</day>
      <month>11</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>11</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>35</volume>
    <issue>13</issue>
    <fpage>2243</fpage>
    <lpage>2250</lpage>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>8</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>3</day>
        <month>11</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>11</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bty946.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>In clinical trials, individuals are matched using demographic criteria, paired and then randomly assigned to treatment and control groups to determine a drug’s efficacy. A chief cause for the irreproducibility of results across pilot to Phase-III trials is population stratification bias caused by the uneven distribution of ancestries in the treatment and control groups.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Pair Matcher (<italic>PaM</italic>) addresses stratification bias by optimizing pairing assignments <italic>a priori</italic> and/or <italic>a posteriori</italic> to the trial using both genetic and demographic criteria. Using simulated and real datasets, we show that <italic>PaM</italic> identifies ideal and near-ideal pairs that are more genetically homogeneous than those identified based on competing methods, including the commonly used principal component analysis (PCA). Homogenizing the treatment (or case) and control groups can be expected to improve the accuracy and reproducibility of the trial or genetic study. <italic>PaM’s</italic> ancestral inferences also allow characterizing responders and developing a precision medicine approach to treatment.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p><italic>PaM</italic> is freely available via <italic>R</italic><ext-link ext-link-type="uri" xlink:href="https://github.com/eelhaik/PAM">https://github.com/eelhaik/PAM</ext-link> and a web-interface at <ext-link ext-link-type="uri" xlink:href="http://elhaik-matcher.sheffield.ac.uk/ElhaikLab/">http://elhaik-matcher.sheffield.ac.uk/ElhaikLab/</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">UK Medical Research Council</named-content>
        </funding-source>
        <award-id>MC_PC_14115</award-id>
        <award-id>MR/R025126/1</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>1 Introduction</title>
    <p>It is well recognized that pharmaceutical research and development (R&amp;D) is in crisis. The number of new drugs approved per billion US dollars spent on R&amp;D has halved roughly every 9 years since 1950 (<xref rid="bty946-B29" ref-type="bibr">Scannell <italic>et al</italic>., 2012</xref>) as spending in the industry has inflated to an average of ∼$5.8 billion per drug in 2011 compared to $1.3 billion per drug in 2005 (<xref rid="bty946-B28" ref-type="bibr">Roy, 2012</xref>). The latter phases of clinical trials test the drug’s efficacy compared to a placebo or other treatments in a randomized trial setting and require assessing tens, hundreds (Phase II trials) and eventually tens of thousands (Phase-III trials) of volunteers over a long period of time to prove that there is substantial evidence of a clinical benefit of the drug. Only 1 in 12 drugs that enters human clinical trials ends up gaining approval from the Food and Drug Administration. It is acknowledged that one of the biggest drivers of the increase in R&amp;D costs is the regulatory process governing Phase-III clinical trials of new pharmaceuticals (<xref rid="bty946-B28" ref-type="bibr">Roy, 2012</xref>). As the regulatory environment is unlikely to relax (<xref rid="bty946-B29" ref-type="bibr">Scannell <italic>et al</italic>., 2012</xref>), it is important to understand why randomized control trials may be more successful in smaller trials.</p>
    <p>Matching treatment (or case) with control groups is the most elementary and critical part of any trial (or study). Mismatched groups introduce genetic heterogeneity that may obscure performance of the trialled drug, e.g. due to genetic pre-disposition to response to the treatment, and result in reduced reproducibility between different cohorts (<xref rid="bty946-B29" ref-type="bibr">Scannell <italic>et al</italic>., 2012</xref>). Currently, individuals are matched based on demographic criteria (e.g. age, gender and self-reported ‘race’) and then randomly assigned to treatment and controls groups. It is well acknowledged that due to the significant heterogeneity among humans, demographic-based matching alone is inadequate. Trials are, thereby, vulnerable to ‘stratification bias,’ i.e. differences in genetic ancestry between individuals, which are not factored in when trial participants are grouped based on demographics alone. This undetected bias may contribute to biased interpretation of trial results due to lack of genetic information that may confound interpretation, leading to alterations in the false negative or false positive results, with subsequent financial and patient health consequences (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>). In large groups, the stratification bias may be less pronounced, however, it is practically unavoidable in the case of rare diseases due to the difficulties in recruiting genetically homogeneous participants (<xref rid="bty946-B35" ref-type="bibr">Yusuf and Wittes, 2016</xref>). Crucially, this bias is more severe in small cohorts, leading to an applied misinterpretation of the drug’s efficacy that will be difficult to replicate in larger trials.</p>
    <p>Population stratification can be addressed by optimizing the treatment-control matches <italic>a priori</italic> or/and <italic>a posteriori</italic> to the trial using a variety of tools applied to the genotype data and selecting matched pairs for downstream analyses. Due to the historically high cost of genotyping and sequencing, <italic>a priori</italic> methods rely heavily on demographic-based matching criteria followed by statistical corrections made <italic>a posteriori</italic>, if at all. <italic>A priori</italic> methods have long been considered biased, inaccurate and unhelpful (<xref rid="bty946-B7" ref-type="bibr">De Bono, 1996</xref>; <xref rid="bty946-B12" ref-type="bibr">Fustinoni and Biller, 2000</xref>; <xref rid="bty946-B21" ref-type="bibr">McAuley <italic>et al.</italic>, 1996</xref>) due to their reliance on self-reported ‘race’ (‘Africans’, ‘Asians’ and ‘European-Americans’ or ‘Whites’) or regional similarity, which does not eliminate the bias (<xref rid="bty946-B3" ref-type="bibr">Campbell <italic>et al</italic>., 2005</xref>; <xref rid="bty946-B4" ref-type="bibr">Chikhi <italic>et al</italic>., 2010</xref>; <xref rid="bty946-B9" ref-type="bibr">Elhaik <italic>et al</italic>., 2014</xref>; <xref rid="bty946-B32" ref-type="bibr">Wang <italic>et al.</italic>, 2006</xref>; <xref rid="bty946-B35" ref-type="bibr">Yusuf and Wittes, 2016</xref>). Unable to completely account for choices made at the <italic>a priori</italic> stage, <italic>a posteriori</italic> methods may make over-simplified, unrealistic or problematic assumptions (<xref rid="bty946-B15" ref-type="bibr">Kimmel <italic>et al</italic>., 2007</xref>), particularly concerning population structure. Computing the principal components (PCs) of the genotype matrix and adjusting the genotype vectors by their projections on the PCs is a popular method of accounting for population structure (<xref rid="bty946-B26" ref-type="bibr">Price <italic>et al</italic>., 2006</xref>). However, linear projections cannot be assumed to sufficiently correct for the effect of stratification due to other unaccounted confounders (<xref rid="bty946-B15" ref-type="bibr">Kimmel <italic>et al</italic>., 2007</xref>). PCs also ignore the complexity of population structure, are influenced by uneven sampling, and cannot properly represent individuals of mixed origins (<xref rid="bty946-B9" ref-type="bibr">Elhaik <italic>et al</italic>., 2014</xref>; <xref rid="bty946-B16" ref-type="bibr">Lacour <italic>et al</italic>., 2015</xref>; <xref rid="bty946-B22" ref-type="bibr">McVean, 2009</xref>; <xref rid="bty946-B34" ref-type="bibr">Yang <italic>et al.</italic>, 2012</xref>;). Even newer tools (<xref rid="bty946-B11" ref-type="bibr">Epstein <italic>et al.</italic>, 2007</xref>; <xref rid="bty946-B15" ref-type="bibr">Kimmel <italic>et al</italic>., 2007</xref>; <xref rid="bty946-B16" ref-type="bibr">Lacour <italic>et al</italic>., 2015</xref>) can make only basic assumptions concerning population structure and may ignore admixture or demographic criteria.</p>
    <p>We developed Pair Matcher (<italic>PaM</italic>)—a genetic-based tool that optimizes pairing assignments <italic>a priori</italic> and/or <italic>a posteriori</italic> to the trial. <italic>PaM</italic> matches samples by demographic and genetic criteria and allows trial designers to make informed decisions in real time (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>). <italic>PaM</italic> models individual genomes as consisting of gene pools (or admixture components) that correspond to their recent demographic history (<xref rid="bty946-B6" ref-type="bibr">Das <italic>et al.</italic>, 2016</xref>; <xref rid="bty946-B9" ref-type="bibr">Elhaik <italic>et al</italic>., 2014</xref>). <italic>PaM</italic> then matches individuals based on their age, gender and the similarity of their admixture components. We first compared the accuracy of <italic>PaM<sub>simple</sub></italic> and <italic>PaM<sub>full</sub></italic> and then the accuracy of the best performing tool to pairings made either at random, based on racial-criteria, or through PC analysis (PCA). Finally, we compared <italic>PaM</italic>’s pairing accuracy to those of clustering tools used in population genetic and genome-wide association studies (GWAS) in analyzing unmixed and mixed individuals. We also assessed reproducibility.</p>
    <p>Optimizing the trial design can be expected to homogenize the treatment (or case) and control pairs and improve the accuracy and reproducibility of the trial or genetic study. This can be expected to lower drug developmental costs and benefit patients. Together with biogeographical tools that can predict the geographical origins of the responders (<xref rid="bty946-B9" ref-type="bibr">Elhaik <italic>et al</italic>., 2014</xref>), <italic>PaM</italic> can also be used to guide precision medicine approaches to treatment, for instance, in characterizing a subgroup of responders or mutation carriers (<xref rid="bty946-B2" ref-type="bibr">Baughn <italic>et al</italic>., 2018</xref>) and designing follow up trials focussing on this group.</p>
  </sec>
  <sec sec-type="materials|methods">
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Simulated population datasets</title>
      <p>We generated 24 datasets composed of 980–1000 individuals each in ADMIXTURE’s Q file format (individuals × proportion of admixture components) (<xref rid="bty946-B1" ref-type="bibr">Alexander <italic>et al.</italic>, 2009</xref>). Here and throughout this work, we adopted the admixture model of <xref rid="bty946-B9" ref-type="bibr">Elhaik <italic>et al.</italic> (2014)</xref> of nine admixture components representing: <italic>North East Asia</italic>, the <italic>Mediterranean</italic>, <italic>South Africa</italic>, <italic>South West Asia, Native America</italic>, <italic>Oceania</italic>, <italic>South East Asia</italic>, <italic>Northern Europe</italic> and <italic>Sub-Saharan Africa.</italic> Each dataset consisted of a file with nine admixture components generated randomly for individuals and their matching pairs and normalized so that each row would sum to 1. Dataset 1 consisted of 500 identical pairs (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S2</xref>). The genetic heterogeneity between the pairs of Datasets 2–8 was increased in a controlled manner by modifying the admixture components of one individual from each pair of Dataset 1 through an increasing perturbation of <italic>X</italic> [0…20%] subtracted from the odd numbered admixture components and added to the even numbered admixture components. The perturbation percentage was applied alternately (negative to the first component, positive to second component etc.) to prevent normalization to reverse the perturbation.</p>
      <p>To assess pairing in more imperfect datasets, the remaining datasets were created by removing random individuals from the original datasets. Datasets 9–16 were created by removing one individual from each cohort (<italic>remove-1</italic>) and Datasets 17–24 were created by removing 20 individuals from each cohort (<italic>remove-20</italic>), leaving datasets of 999 and 980 individuals, respectively.</p>
    </sec>
    <sec>
      <title>2.2 Worldwide population dataset</title>
      <p>We used the Genographic dataset, which comprises of ∼128 000 markers genotyped in 633 unrelated worldwide individuals of known geographic origins who have four grandparents from their population affiliation and geographic region of origin (<xref rid="bty946-B9" ref-type="bibr">Elhaik <italic>et al</italic>., 2014</xref>). We created a database of 13 mixed individuals of distinct ancestries by hybridizing 13 Indians with 13 British to yield a final cohort of 646 individuals. The hybridization was done by merging an even amount of random single nucleotide polymorphisms (SNPs) from random Indian and British individuals and calculating the admixture components of these genomes (<xref rid="bty946-B9" ref-type="bibr">Elhaik <italic>et al</italic>., 2014</xref>). The admixture components of the Genographic and simulated individuals (<xref rid="bty946-B9" ref-type="bibr">Elhaik <italic>et al</italic>., 2014</xref>) (<xref ref-type="fig" rid="bty946-F1">Fig. 1</xref>) were provided as input to <italic>PaM.</italic> We also analyzed 40 Bedouin and 40 Pakistani (25 Brahui and 15 Burusho) individuals (<xref rid="bty946-B24" ref-type="bibr">Patterson <italic>et al</italic>., 2012</xref>) and calculated their nine admixture components as in <xref rid="bty946-B9" ref-type="bibr">Elhaik <italic>et al.</italic> (2014)</xref>.</p>
      <fig id="bty946-F1" orientation="portrait" position="float">
        <label>Fig. 1.</label>
        <caption>
          <p><italic>PaM<sub>simple</sub></italic> performances on simulated datasets. Rows show the results of eight perturbed datasets [full dataset (left), <italic>remove-1</italic> (centre) and <italic>remove-20</italic> (right)]. <italic>PaM<sub>simple</sub></italic> was applied without a threshold (dashed) and with a threshold of 7 (solid red). Columns show the number of individuals assigned to a different pair than their original counterpart per dataset (<italic>x</italic>-axis), total GD between all matched pairs and total score (maximum of 10 per pair with the three datasets having <italic>n</italic><sub>1</sub> = 500, <italic>n</italic><sub>2</sub> = 499, and <italic>n</italic><sub>3</sub> = 480 pairs, respectively)</p>
        </caption>
        <graphic xlink:href="bty946f1"/>
      </fig>
    </sec>
    <sec>
      <title>2.3 Unmixed and mixed population datasets</title>
      <p>We used the <xref rid="bty946-B17" ref-type="bibr">Lazaridis <italic>et al.</italic> (2014)</xref> dataset that comprises of ∼600 841 markers genotyped in 2345 unrelated worldwide individuals. From each population that had at least four individuals, we selected two pairs of individuals who showed the highest identity-by-state (IBS) similarity to each other as inferred by PLINK (—cluster—matrix) (<xref rid="bty946-B27" ref-type="bibr">Purcell <italic>et al</italic>., 2007</xref>). From the 42 populations (168 individuals) identified in that manner, 100 random individuals were paired to a random member of their population, creating the unmixed dataset (<italic>n</italic> = 200). A mixed dataset was next created by randomly selecting three individuals and using the consecutive thirds of their genomes to create a 3 × hybrid individual. A matching pair was created in a similar way using different individuals from the same populations. This process was repeated 100 times (<italic>n</italic> = 200). Similarly, we created 5× and 7× datasets of the same size. Finally, we assembled three combined datasets that consist of: unmixed +3× mixed (<italic>n</italic> = 400), the latter dataset +5× mixed (<italic>n</italic> = 600) and the latter dataset +7× mixed (<italic>n</italic> = 800).</p>
    </sec>
    <sec>
      <title>2.4 Comparing <italic>PaM</italic><sub>simple</sub> and <italic>PaM</italic><sub>full</sub></title>
      <p>To optimize matches, <italic>PaM</italic> analyzes the age (optional), gender (optional) and admixture components for each individual in the studied cohort. These three parameters are obtained from PLINK’s fam file [using columns 4 (age) and 6 (gender)] and ADMIXTURE’s <italic>Q</italic> file. The Genetic Distance (GD) between the paired individual is defined as <inline-formula><mml:math id="IM1"><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:msup><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mtext> </mml:mtext></mml:msup></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>, where <italic>i</italic> and <italic>j</italic> are the individuals with <italic>k</italic> admixture components. <italic>PaM</italic> calculates the <italic>nxn</italic> GD matrix for each possible pairing, where <italic>n</italic> is the number of individuals in the <italic>Q</italic> file. Each element of the matrix, specified by row <italic>i</italic> and column <italic>j</italic>, corresponds to a pair (<italic>i</italic>, <italic>j</italic>). The matrix is symmetric with respect to the diagonal, which contains all zeros. A corresponding <italic>nxn</italic> score matrix is calculated as follows: pairs that are age (within 5 years by default) and gender matched get one point. Nine additional points are awarded for every matching admixture component if |<italic>i<sub>k</sub>–j<sub>k</sub></italic>| ≤ 1% for the pair (<italic>i</italic>, <italic>j</italic>). An ideally matched pair has a score of 10 (age/gender and nine admixture components). An optimal pairing solution for Dataset 1 that consists of 500 pairs would be a GD of 0 between all pairs, a total score of 5000 (top score of 10 for 500 pairs), and no unpaired individuals (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S3</xref>).</p>
      <p><italic>PaM</italic> operates in two modes: <italic>PaM<sub>simple</sub></italic> and <italic>PaM<sub>full</sub>.</italic> The <italic>PaM<sub>simple</sub></italic> algorithm starts by selecting matrix row 1 (individual 1) and finding the column <italic>j</italic> which yields the minimum GD for pair (1, <italic>j</italic>). This matrix element corresponds to the first pair with row index 1 and column index <italic>j.</italic> Row 1 and column <italic>j</italic> and their symmetric element (<italic>j</italic>, 1) are removed from the GD matrix. Row 2 is next selected (provided it has not been removed in the previous step) and the column which yields the minimum GD is selected to form the second pairing. The corresponding rows and columns are then removed from the matrix. The optimization proceeds until all possible pairings are created and all unpaired individuals are stored. If the test cohort is an odd number then at least one unpaired individual is expected. The paired and unpaired individuals are reported in separate text files. To filter pairings with a score lower than a specified acceptable value, a user-controlled threshold was implemented.</p>
      <p>The threshold is related to the expected genetic homogeneity of the pairs. A high threshold would result in homogeneous pairs and a large number of unpaired individuals. A threshold of 7 indicates that the pair’s age and gender matched as well as six of their admixture components.</p>
      <p>When matrix rows have multiple identical minima, there is a potential dilemma since the specific row minimum selection could affect subsequent pairings (due to the row/column removal upon pair selection), and the final pairing solution may not be optimal. We explored different selection schemes through exhaustive testing using single and random selection of the row minima, as well as a more complex method of minimizing the sum of the remaining row minima, however, the end results were very similar. Therefore, <italic>PaM</italic> uses a single minimum selection for each row, and this selection is the minimum with the lowest column index <italic>j.</italic></p>
      <p><italic>PaM<sub>full</sub></italic> extends <italic>PaM<sub>simple</sub></italic> by carrying out a more exhaustive pairing search. <italic>PaM<sub>full</sub></italic> sorts the test cohort data iteratively in ascending order using the admixture components. The pairing procedure starts at a random row index (multiple times). The model starts by sorting the cohort data by the first admixture component then commences the search starting with a random row, <italic>i</italic>, index. The best pairing solution is stored. The cohort data is next sorted by the second admixture component, and the best pairing solution is found. If this solution minimizes the total GD of the final solution compared to the previous iteration then, the ‘sorted admixture component 2’ solution is stored. The model proceeds stepwise by successively sorting the remaining admixture components to find the best pairing solution. Poor pairs are handled in a similar manner to <italic>PaM<sub>simple</sub>.</italic> However, when the data are re-ordered, all previously discarded individuals are included in the new solution search.</p>
    </sec>
    <sec>
      <title>2.5 Comparing <italic>PaM</italic> with demographic matches</title>
      <p><italic>PaM</italic> matches for the simulated datasets (Section 2.1) were compared with <italic>a priori</italic> matches based on age (within 5 years), gender and ‘race’ defined as ‘African’, ‘Asian’, ‘Latino’ or ‘White’. Following <xref rid="bty946-B9" ref-type="bibr">Elhaik <italic>et al.</italic> (2014)</xref> (<xref ref-type="fig" rid="bty946-F1">Fig. 1</xref>), ancestry was inferred from the admixture components as follows: ‘African’ ancestry was assigned if the sum of Sub-Saharan Africa and South Africa admixture components was larger than 50%; ‘Asian’ ancestry was assigned when the North East Asian component was larger than 10% and ‘Latino’ ancestry was assigned when the Native American component was larger than 50%. All the remaining individuals were considered ‘White’. Since self-reported ‘race’ differs between studies, we considered three models: (i) an individual is either African, Asian, Latino or White. (ii) An individual is considered either an African or non-African; (iii) an individual is considered a mixture of Africans, Asians, Latinos and Whites. The assignment accuracy of all matches was measured based on the correct pairing of individuals and their known pairs with some individuals expected to be unpaired due to the removal of their exact match.</p>
    </sec>
    <sec>
      <title>2.6 Comparing <italic>PaM</italic> with PCA matches</title>
      <p><italic>PaM</italic> matches for the Genographic dataset (Section 2.2) were compared with PCA-based methods. PCA’s top two eigenvectors were calculated using SNPRelate (<xref rid="bty946-B36" ref-type="bibr">Zheng <italic>et al</italic>., 2012</xref>). Clustering was achieved using the <italic>k</italic>-means method <italic>kmeans</italic> in <italic>R.</italic> Similar to <xref rid="bty946-B19" ref-type="bibr">Luca <italic>et al.</italic> (2008)</xref>, pairs were determined by a random assignment within each cluster. To compare the quality of the results, the pairing solutions for <italic>PaM</italic> and PCA were evaluated using IBS clusters as an impartial GD independent of admixture or PCA and geographic distances calculated with the Haversine formula (<xref rid="bty946-B14" ref-type="bibr">Gellert <italic>et al</italic>., 1989</xref>). Due to the data’s high heterogeneity, <italic>PaM</italic> was employed with a threshold of 5.</p>
    </sec>
    <sec>
      <title>2.7 Assessing <italic>PaM’</italic>s performances on small datasets</title>
      <p>To evaluate <italic>PaM</italic>’s performances on small datasets (Section 2.2), we constructed four datasets consisting of 20, 40, 60 and 80 individuals. Each dataset consisted of an even number of Bedouins and Pakistanis. We applied <italic>PaM<sub>simple</sub></italic> without a threshold to each dataset. To examine their effect, we also applied <italic>PaM</italic> with various thresholds (3, 5, and 7) to the largest dataset.</p>
    </sec>
    <sec>
      <title>2.8 Comparing <italic>PaM</italic> with other clustering tools on unmixed and mixed individuals</title>
      <p><italic>PaM</italic> matches were compared with those of several clustering tools: PCA and multidimensional scaling (MDS), both available from PLINK, whose pairs were calculated as in Section 2.6; and genetic relationship matrix (GRM) (<xref rid="bty946-B33" ref-type="bibr">Yang <italic>et al</italic>., 2011</xref>) (version 1.91.2beta) and TreeMix (<xref rid="bty946-B25" ref-type="bibr">Pickrell and Pritchard, 2012</xref>) (version 1.13), whose pairs were identified using a greedy approach that paired individuals with the highest covariance. All the tools were assessed by their ability to match individuals in each dataset and reproduce the results in the combined datasets. The tools were applied to the complete and LD-pruned (PLINK command—indep 50 5 2) datasets and to the SNPs that overlapped <italic>PaM</italic>’s gene pools, which consist of ancestry informative markers (AIMs). <italic>PaM</italic> was utilized with three thresholds.</p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>3 Results</title>
    <sec>
      <title>3.1 Assessing <italic>PaM</italic>’s performances</title>
      <p>We first evaluated the performances of <italic>PaM<sub>simple</sub></italic> without a threshold (no limit placed on the acceptable score of pairs) and with a threshold of 7 (necessitating the matching of age/gender and at least six admixture components) across all simulated datasets. As expected, when applying <italic>PaM</italic> without a threshold, the GD increased with increasing perturbation or heterogeneity while the score decreased, and the number of misassigned pairs increased (<xref ref-type="fig" rid="bty946-F1">Fig. 1</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>). However, despite the perturbation and removal of individuals, most of the original pairs (80–100%) were correctly identified, particularly in Datasets 1–16. The increase in the number of misassigned pairs is related to how <italic>PaM<sub>simple</sub></italic> searches for an optimum solution. <italic>PaM<sub>simple</sub></italic> selects a case index <italic>i</italic> (row <italic>i</italic> of the GD matrix) and finds the best match for this index by locating the minimum GD in the row corresponding to the best possible match. This, however, does not constitute an ideal match considering all other individuals, some of whom are best left unpaired. Since <italic>PaM<sub>simple</sub></italic> does not leave any individual unpaired (for an even cohort), a poor pairing may create a ‘snowball’ effect triggering other poor pairings, resulting in an overall increased GD and reduced score for the final pairing solution.</p>
      <p>We addressed this problem by applying a threshold of 7 on the match score. Under these settings, the GD curve decreased sharply at a perturbation level of ∼5%; identifying genetically homogeneous pairs, despite the increased perturbation and discarding genetically mismatched pairs. The score, which represents the conservative choice of what is considered an acceptable pair, decreased due to the growing number of unpaired individuals. The trade-off for the low GD of acceptable pairs is that more individuals are left unpaired due to their low pairing score and are omitted from the total GD score (<xref ref-type="fig" rid="bty946-F1">Fig. 1</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>). The advantage of applying a threshold is that it reduces the number of misassigned pairs by allowing only pairs with a high match score (genetically homogeneous). This prevents the model from selecting pairs that satisfy the low GD minimum but do not have a favourable match score, thus avoiding the ‘snowball’ effect. Since the matrix is symmetric and each row has all possible pairing for each individual, individuals with a match score lower than the threshold are considered too genetically heterogeneous and placed on the unpaired list (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S2</xref>).</p>
      <p>For Datasets 1–8, the best solution was obtained with a threshold at a perturbation level of 11%, where the GD was close to 0 for all matched pairs, nearly half the individuals had an acceptable score, and the number of misassigned pairs was 0. We note that for heavier perturbations, not all the misassignments are false positives since the perturbation created, by chance, more suitable pairing matches than the pre-defined ones. Considering the low GD between all pairs, the majority of matches were near-optimal ones even after removing individuals from the dataset. Interestingly, we observed a repeated single misassignment in most of the <italic>remove-20</italic> datasets (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S2</xref>). Examination of this unexpected misassignment showed it to be a pairing with a very low GD and a match score of 7, making it an acceptable assignment though not between the original partners, which could potentially be suboptimal.</p>
      <p>There are two ways to address the vexing issue of ‘rogue’ misassignments. The first is to set a higher threshold, and the second is to use <italic>PaM<sub>full</sub></italic>, which carries out a more exhaustive pairing search by iteratively sorting (in ascending order) the cohort data by the admixture components. The pairing procedure for the cohort commences at a random row index (multiple times). This approach does not produce rogue misassignments and hence finds an optimum or near-optimum pairing solution. The numerical results for the three datasets using <italic>PaM<sub>full</sub></italic> are shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Tables S3</xref> and <xref ref-type="supplementary-material" rid="sup1">S4</xref>. P<italic>aM<sub>full</sub></italic> results are similar to those of <italic>PaM<sub>simple</sub></italic>, except that they do not allow the accidental misassignments (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S4</xref>, perturbation &lt;11%) observed with <italic>PaM<sub>simple</sub></italic> (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S2</xref>).</p>
      <p>As before, the misassignments detected beyond the 11% threshold are due to the high similarity in admixture components in the post-perturbation stage and are not truly false positives. The cost of using <italic>PaM<sub>full</sub></italic> is increased computation time, almost an order of magnitude greater than <italic>PaM<sub>simple</sub></italic>’s run time. Due to its superior performances, the remaining analyses were done with <italic>PaM<sub>simple</sub>.</italic></p>
    </sec>
    <sec>
      <title>3.2 Comparing the performances of <italic>PaM</italic> and alternative methods on simulated datasets</title>
      <p>We next compared the assignment accuracy of <italic>PaM<sub>simple</sub></italic> and alternative solutions in terms of misassigned pairs with the GD and Score illustrating the quality of the matches (<xref ref-type="fig" rid="bty946-F2">Fig. 2</xref>). <italic>PaM</italic> correctly identified nearly all pairs. The GDs for the random assignment, where the age and gender matched but ‘race’ was randomly determined, were much larger than the competing solutions. Correspondingly, the random assignment’s score is mostly lower than the alternative solutions. Nearly none of the pairs randomly assigned were with their original counterparts.</p>
      <fig id="bty946-F2" orientation="portrait" position="float">
        <label>Fig. 2.</label>
        <caption>
          <p><italic>PaM<sub>simple</sub></italic> (threshold of 7) performances on 16 simulated datasets against 5 competing methods. Columns show the number of misassigned individuals, total GD and pair score for Random assignment (red), Race model 1 (cyan), Race model 2 (yellow), Race model 3 (green) and <italic>PaM</italic> (black). Results for Datasets 9–16 were identical to those of Datasets 1–8 and are no shown</p>
        </caption>
        <graphic xlink:href="bty946f2"/>
      </fig>
      <p>The first two self-reported ‘race’ models (African, Asian, Latino or White; African/non-African) perform only slightly better than the random assignment in terms of GD and the score. The results of the third model (mixtures of African, Asian, Latino or White) are considerably better than the previous models or random assignments. This is to be expected, since this model can be considered a reduced form of <italic>PaM</italic>’s nine-admixture components model. Our results indicate that pairs obtained through standard demographics criteria (age, gender and self-defined ‘race’) are as poor as those obtained at random. We note, that since the simulated datasets comprised of the same admixture components used by <italic>PaM,</italic> and therefore, the performances observed in simulation may not reflect the algorithm’s accuracy for real populations.</p>
    </sec>
    <sec>
      <title>3.3 Comparing <italic>PaM</italic>’s performances with PCA’s</title>
      <p>We next compared the performances of <italic>PaM</italic> with a PCA-based approach on the Genographic dataset consisting of worldwide individuals alongside 13 simulated Indian–British individuals. <italic>PaM</italic> was applied to the admixture components of all individuals and PCA was applied to the SNP data.</p>
      <p>We evaluated the homogeneity of the pairs inferred by <italic>PaM</italic> and PCA using both geographic and GDs. All of <italic>PaM’s</italic> inferred pairs had higher genetic similarity (i.e. smaller IBS distances) than PCA’s inferred pairs (<xref ref-type="fig" rid="bty946-F3">Fig. 3</xref>). We identified 12 IBS clusters (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S4</xref>) and divided all inferred pairs to ‘matches’ if individuals were in the same cluster and ‘mismatches’ if otherwise. PCA pairs had 270 ‘matches’ and 46 ‘mismatches’ with mean distances of 1042 and 6124 km, respectively, and 10 unpaired individuals (<xref ref-type="fig" rid="bty946-F4">Fig. 4</xref>). <italic>PaM</italic> pairs had 284 ‘matches’ and 17 ‘mismatches’ with mean distances of 484 and 557 km, respectively, and 40 unpaired individuals. Compared to PCA, individuals matched by <italic>PaM</italic> were significantly geographically closer regardless of the category (Kolmogorov–Smirnov goodness-of-fit test, <italic>P-</italic>value<sub>(matches</sub><sub>)</sub> = 2.74*10 <sup>− </sup><sup>6</sup>, <italic>P-</italic>value<sub>(mismatches</sub><sub>)</sub> = 3.58*10 <sup>− </sup><sup>4</sup>, <italic>P-</italic>value<sub>(all</sub><sub>)</sub> = 4.85*10 <sup>− </sup><sup>10</sup>). In one ‘match’ case, <italic>PaM</italic> paired an individual from Papua New Guinea with a Peruvian, which yielded a geographic distance of over 13 000 km. However, <xref rid="bty946-B30" ref-type="bibr">Skoglund <italic>et al.</italic> (2015)</xref> showed that some Native American populations can trace their origins to Papua New Guinea, suggesting that <italic>PaM’s</italic> assignment may have been appropriate. The 13 mixed Indo-British individuals formed a part of the Tartar/Tajikistan IBS cluster (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S4</xref>). PCA paired the Indo-British individuals with people from Tajikistan (4), Iran (2), Tatar (1), Russia (1), Ingush (1) and India (1). It correctly made one Indo-British pair and left out one individual. By contrast, <italic>PaM</italic> formed six Indo-British pairings, leaving the 13th individual unpaired (although the Indo-British were part of the same IBS cluster consisting of Tartars and Tajikistanians). Overall <italic>PaM</italic> produced pairs that are significantly more genetically (<xref ref-type="fig" rid="bty946-F3">Fig. 3</xref>) and geographically (<xref ref-type="fig" rid="bty946-F4">Fig. 4</xref>) homogeneous than PCA. These results highlight the accuracy of <italic>PaM</italic> and its ability to handle admixed individuals.</p>
      <fig id="bty946-F3" orientation="portrait" position="float">
        <label>Fig. 3.</label>
        <caption>
          <p>IBS distance between <italic>PaM</italic> (solid) and PCA (dashed) inferred pairs</p>
        </caption>
        <graphic xlink:href="bty946f3"/>
      </fig>
      <fig id="bty946-F4" orientation="portrait" position="float">
        <label>Fig. 4.</label>
        <caption>
          <p>The geographical distance between individual pairs inferred by <italic>PaM</italic> and PCA. Geographic distances are calculated between pairs where both individuals are within the IBS-defined clusters (<bold>A</bold>), where individuals are in different clusters (<bold>B</bold>) and for all individuals regardless of cluster assignment (<bold>C</bold>)</p>
        </caption>
        <graphic xlink:href="bty946f4"/>
      </fig>
    </sec>
    <sec>
      <title>3.4 Evaluating <italic>PaM</italic>’s performances on small datasets</title>
      <p>Applied to datasets ranging from 20 to 80 individuals of Bedouin and Pakistani descent (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S5</xref>), <italic>PaM</italic> (no threshold) perfectly paired all individuals with members of their populations each time. Applying <italic>PaM</italic> with higher thresholds to the largest dataset created slightly fewer pairs but more genetically homogeneous ones (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S5</xref>).</p>
    </sec>
    <sec>
      <title>3.5 Comparing the performances of <italic>PaM</italic> and various clustering tools for unmixed and mixed individuals</title>
      <p>Clustering accuracy is typically demonstrated by showing that well-curated individuals are predicted to geographic regions, whereas mixed individuals are more challenging to analyze under various population and data settings. Here, we evaluated the pairing accuracy of five tools that implement different clustering strategies in datasets that consist of unmixed and mixed individuals and combinations of those datasets. <italic>PaM</italic> significantly outperformed all tools in each test (<xref ref-type="fig" rid="bty946-F5">Fig. 5</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S6</xref>), except in comparison to MDS in the 3 × Mixed dataset, with an average accuracy of 87 ± 9% compared to PCA (68 ± 16%), MDS (72 ± 14%), GRM (29 ± 16%) and TreeMix (7 ± 18%). The accuracy for PCA and MDS varied with the number of loadings used. The pairing with both 10 [76 ± 15% (PCA) and 79 ± 17% (MDS)] and 20 [71 ± 9% (PCA) and 78 ± 9% (MDS)] loadings was similar and higher than with two loadings [58 ± 10% (PCA) and 57 ± 10% (MDS)]. MDS outperformed PCA in nearly every test. TreeMix performed the worst. When admixed individuals were provided TreeMix reports were highly inaccurate (see a simplistic example in <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S6</xref>). The combined datasets (unmixed + mixed), designed to test reproducibility, proved challenging, with <italic>PaM</italic> exhibiting the smallest drop in average accuracy (−5%), compared to PCA (−12%), MDS (−7%) and GRM (−9%). All tools performed better on the gene pool SNP set (59%) than on the LD-pruned (53%) and genome-wide datasets (57%).</p>
      <fig id="bty946-F5" orientation="portrait" position="float">
        <label>Fig. 5.</label>
        <caption>
          <p>Pairing accuracy for various tools across multiple datasets. Boxplots summarize the pairing accuracy of all the trials in each population dataset (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S6</xref>), e.g. the PCA for unmixed individuals include the three analyses (PCA2/10/20) for each of the three datasets. The order of the tools’ results per population dataset is shown in the legend. Significance was estimated for <italic>PaM</italic> using Wilcoxon rank-sum test (<italic>P</italic>-value ≤ *0.05, ** ≤ 0.01)</p>
        </caption>
        <graphic xlink:href="bty946f5"/>
      </fig>
    </sec>
    <sec>
      <title>3.6 Running time</title>
      <p>Running on a single core Intel i5 computer, <italic>PaM<sub>simple</sub></italic> finds the near-optimum pairings in ∼15 min for a test cohort of 1000 individuals, whereas <italic>PaM<sub>full</sub></italic> finds the optimized pairings in ∼3 h. If accessed online, results are typically emailed within 20 min.</p>
    </sec>
    <sec>
      <title>3.7 Software availability</title>
      <p><italic>PaM</italic> is freely available as a downloadable <italic>R</italic> package from <ext-link ext-link-type="uri" xlink:href="https://github.com/eelhaik/PAM">https://github.com/eelhaik/PAM</ext-link> (16 Mb). In addition, a web-service has been created that allows users to upload genetic and demographic data for their test cohort in PLINK format and receive the optimized pairings solution by email (<ext-link ext-link-type="uri" xlink:href="http://elhaik-matcher.sheffield.ac.uk/ElhaikLab/">http://elhaik-matcher.sheffield.ac.uk/ElhaikLab/</ext-link>).</p>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>4 Discussion</title>
    <p>Clinical trials are required to determine drug efficacy on multiple cohorts of sizes ranging from 40 to 10 000, where participants are split into treatment and control groups. The outcomes of these trials determine whether a drug should be tested in a larger cohort and, if successful, approved for use (<xref rid="bty946-B28" ref-type="bibr">Roy, 2012</xref>). To evaluate the therapeutic effects of the tested drug, treatment and control pairs have to be genetically homogeneous to minimize the variation in the response that is due to different genetic backgrounds. Therefore, pairing of cohort individuals is typically done at random after controlling for demographic criteria (e.g. age, sex and self-reported ‘race’) <italic>a priori</italic> to the trial. However, randomization does not resolve <italic>population stratification</italic>, particularly in very small cohorts or multiple strata with few individuals (<xref rid="bty946-B13" ref-type="bibr">Ganju and Zhou, 2011</xref>) and the results may not be replicated in a follow up larger trial, which may disqualify an effective drug. Correcting for population stratification <italic>a posteriori</italic> to the trial is also problematic due to the difficulty in modelling ancestry and admixture and the reliance on self-defined ‘race’, a highly unreliable predictor (<xref rid="bty946-B7" ref-type="bibr">De Bono, 1996</xref>; <xref rid="bty946-B12" ref-type="bibr">Fustinoni and Biller, 2000</xref>). A similar challenge exists in case-control genetic investigations intended to find a loci associated with a phenotype of interest. Unfortunately, even after decades of genetic research, the use of self-defined racial categorization is still highly prevalent in clinical settings. Though most of the genetic variation in humans is between continental populations (12%) (<xref rid="bty946-B8" ref-type="bibr">Elhaik, 2012</xref>) who exhibit biological variety, like different drug responses, racial terminology is an ineffective mean to classify mixed people, even those believed to be unmixed due to ignorance of their demographic history (e.g. <xref rid="bty946-B5" ref-type="bibr">Das <italic>et al.</italic>, 2017</xref>; <xref rid="bty946-B20" ref-type="bibr">Marshall <italic>et al</italic>., 2016</xref>).</p>
    <p>Applying various tools to unmixed and mixed datasets provided a unique view of their clustering accuracy. We demonstrated that using standard demographic criteria, such as self-reported ‘race’ yields random results, suggesting that ancestry should be identified genetically (e.g. <xref rid="bty946-B2" ref-type="bibr">Baughn <italic>et al</italic>., 2018</xref>). We further showed that PCA pairings are geographically and genetically suboptimal and that it is incapable of modelling mixed populations (<xref ref-type="fig" rid="bty946-F4">Figs 4</xref> and <xref ref-type="fig" rid="bty946-F5">5</xref>), representing the vast majority of the population in countries like the USA. That PCA and PCA-like tools are still being used in GWAS and even considered the ‘gold standard’ by some and that PCA loadings from past GWAS are being used in GWAS meta-analyses is puzzling given PCA’s known weaknesses. The uneven sampling, for instance, which exists in any dataset biases PCA predictions (<xref rid="bty946-B9" ref-type="bibr">Elhaik <italic>et al</italic>., 2014</xref>; <xref rid="bty946-B22" ref-type="bibr">McVean, 2009</xref>). There is no consensus on the number of PCs to analyze: although <xref rid="bty946-B26" ref-type="bibr">Price <italic>et al.</italic> (2006)</xref> used a default of 10 PCs and <xref rid="bty946-B23" ref-type="bibr">Patterson <italic>et al.</italic> (2006)</xref> advised using the Tracy–Widom statistic to determine the number of components, in practic, authors use an arbitrary number of PCs or adopt <italic>ad hoc</italic> strategies to aid in their decision (e.g. <xref rid="bty946-B31" ref-type="bibr">Solovieff <italic>et al</italic>., 2010</xref>). This may be due to the high sensitivity of the Tracy–Widom statistics to linkage disequilibrium, which inflates the number of PCs (<xref rid="bty946-B23" ref-type="bibr">Patterson <italic>et al.</italic>, 2006</xref>) and the expectation that the PCs would reflect genetic similarities that are difficult to observe in higher PCs. PCA is also sensitive to the choice of markers (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S6</xref>). The GRM estimates the genetic relationship between two individuals and is one of the core functions of the GWAS package GCTA (<xref rid="bty946-B33" ref-type="bibr">Yang <italic>et al</italic>., 2011</xref>). It calculates the average ratio of the covariance over the expected heterogeneity across all genes. In other words, it represents how much two individuals covary relative to what is expected on average for an average SNP. This measure is susceptible to LD and cannot be expected to handle mixed individuals. Indeed, its best performances were for the unmixed individuals (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S6</xref>). Its prioritization over PCA (<xref rid="bty946-B33" ref-type="bibr">Yang <italic>et al</italic>., 2011</xref>) is, thereby, inconsistent with its low performances compared to PCA with two PCs. Remarkably, the less popular MDS outperformed PCA in almost every trial. This may be explained by the tendency of MDS to preserve pairwise distances between the points, which is in line with how the data were generated and evaluated. By contrast, PCA attempts to preserve the covariance of the data, which may be less sensitive to population structure. PCA’s requirement that the data will follow a multivariate normal distribution may also pose a challenge that does not exist in MDS. Our analysis of TreeMix results was based on the covariance matrix, which limitations were already discussed, rather than on the tree’s topology. This is because TreeMix’s furthest assumption that the history of the sampled populations is approximately tree-like (<xref rid="bty946-B25" ref-type="bibr">Pickrell and Pritchard, 2012</xref>) is not met in the mixed and combined datasets. Nonetheless, the limitations of the covariance matrix observed here (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S6</xref>) and TreeMix’s limitation in capturing complex admixture events (<xref rid="bty946-B18" ref-type="bibr">Lipson <italic>et al</italic>., 2013</xref>) are reflected in the poor performances of TreeMix (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S6</xref>). Interestingly, TreeMix also attempts to model migration, i.e. explain shared genetic similarity that cannot be properly modelled in a tree configuration. However, its predictions for humans (<xref rid="bty946-B25" ref-type="bibr">Pickrell and Pritchard, 2012</xref>) appear inconsistent, incomplete, and fit only partially with known population history. Phylogenetic models that represent admixture were proposed (<xref rid="bty946-B18" ref-type="bibr">Lipson <italic>et al</italic>., 2013</xref>); however, it is unclear how they can be applied to pair individuals. The dissonance between the commonality of these tools and their accuracy raises concerns that their popularity may be due to other factors than rigorousness and that these tools contribute to the reproducibility problem in clinical and medical studies.</p>
    <p>As expected, all the methods performed better on the AIMs dataset than on the complete or LD-pruned ones as AIMs amplify the ancestral differences between individuals, whereas non-AIMs act to even the population differences. These findings imply that correcting for population structure will be more difficult in exome studies. In such studies investigators should utilize the few AIMs captured on their platform or genotype their samples on a dedicated population microarray (e.g. <xref rid="bty946-B10" ref-type="bibr">Elhaik <italic>et al</italic>., 2017</xref>).</p>
    <p>Evaluated on simulated and real datasets, <italic>PaM</italic> outperformed all alternative classifiers. Among its advantages are high accuracy, a sample-independent approach that allows reproducibility (<xref ref-type="fig" rid="bty946-F5">Fig. 5</xref>), and the use of a finite set of AIMs that improve the depiction of population structure (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S6</xref>). PaM’s admixture model has several more advantages. The admixture components are calculated relative to the putative ancestral populations so their meaning remains the same between different analyses. The admixture components allow intuitive and accurate insight into the ancestry (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S6</xref>) and geographical origins (<xref rid="bty946-B9" ref-type="bibr">Elhaik <italic>et al</italic>., 2014</xref>) of individuals. The genetic characterization of individuals can be used to identify subgroups of responders in drug trials, which can promote personalized medicine solutions tailored to population groups. To avoid suboptimal pairings when all pairs are assigned, we introduced a threshold for the minimum acceptable genetic similarity between tested pairs, which significantly reduced spurious assignments. The score and GD provided in the output allow further prioritization of the pairs. Though <italic>PaM</italic> seeks the best matching pair for each individual and is agnostic to the size of the dataset and admixture scheme, we caution from applying <italic>PaM</italic> to poorly constructed admixture schemes, which fail to capture the global genetic biodiversity. Finally, due to its short computational time, we recommend using <italic>PaM<sub>simple</sub></italic> over <italic>PaM<sub>full</sub></italic> the latter which performs a nearly exhaustive search.</p>
    <p>In summary, we developed <italic>PaM</italic>—a software tool that employs demographic and genetic criteria to find optimized or near-optimized pairings solution for test cohorts consisting of unmixed and mixed individuals. <italic>PaM</italic> can be accessed online or be installed on the local computer.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>bty946_Supplementary_Data</label>
      <media xlink:href="bty946_supplementary_data.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ACK1">
    <title>Acknowledgement</title>
    <p>We thank Winston Hide for useful discussions.</p>
  </ack>
  <sec>
    <title>Funding</title>
    <p>This work was partially supported by the UK Medical Research Council [MC_PC_14115, MR/R025126/1].</p>
    <p><italic>Conflict of Interest:</italic> E.E. is a consultant to DNA Diagnostics Centre.</p>
  </sec>
  <ref-list id="REF1">
    <title>References</title>
    <ref id="bty946-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Alexander</surname><given-names>D.H.</given-names></name><etal>et al</etal></person-group> (<year>2009</year>) 
<article-title>Fast model-based estimation of ancestry in unrelated individuals</article-title>. <source>Genome Res.</source>, <volume>19</volume>, <fpage>1655</fpage>–<lpage>1664</lpage>.<pub-id pub-id-type="pmid">19648217</pub-id></mixed-citation>
    </ref>
    <ref id="bty946-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Baughn</surname><given-names>L.B.</given-names></name><etal>et al</etal></person-group> (<year>2018</year>) 
<article-title>Differences in genomic abnormalities among African individuals with monoclonal gammopathies using calculated ancestry</article-title>. <source>Blood Cancer J.</source>, <volume>8</volume>, <fpage>96</fpage>.<pub-id pub-id-type="pmid">30305608</pub-id></mixed-citation>
    </ref>
    <ref id="bty946-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Campbell</surname><given-names>C.D.</given-names></name><etal>et al</etal></person-group> (<year>2005</year>) 
<article-title>Demonstrating stratification in a European American population</article-title>. <source>Nat. Genet.</source>, <volume>37</volume>, <fpage>868</fpage>–<lpage>872</lpage>.<pub-id pub-id-type="pmid">16041375</pub-id></mixed-citation>
    </ref>
    <ref id="bty946-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chikhi</surname><given-names>L.</given-names></name><etal>et al</etal></person-group> (<year>2010</year>) 
<article-title>The confounding effects of population structure, genetic diversity and the sampling scheme on the detection and quantification of population size changes</article-title>. <source>Genetics</source>, <volume>186</volume>, <fpage>983</fpage>–<lpage>995</lpage>.<pub-id pub-id-type="pmid">20739713</pub-id></mixed-citation>
    </ref>
    <ref id="bty946-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Das</surname><given-names>R.</given-names></name><etal>et al</etal></person-group> (<year>2017</year>) 
<article-title>The Origins of Ashkenaz, Ashkenazic Jews, and Yiddish</article-title>. <source>Front. Genet.</source>, <volume>8</volume>, <fpage>87</fpage>.<pub-id pub-id-type="pmid">28680441</pub-id></mixed-citation>
    </ref>
    <ref id="bty946-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Das</surname><given-names>R.</given-names></name><etal>et al</etal></person-group> (<year>2016</year>) 
<article-title>Localizing Ashkenazic Jews to primeval villages in the ancient Iranian lands of Ashkenaz</article-title>. <source>Genome Biol. Evol.</source>, <volume>8</volume>, <fpage>1132</fpage>–<lpage>1149</lpage>.<pub-id pub-id-type="pmid">26941229</pub-id></mixed-citation>
    </ref>
    <ref id="bty946-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>De Bono</surname><given-names>D.</given-names></name></person-group> (<year>1996</year>) 
<article-title>Describing race, ethnicity, and culture in medical research</article-title>. <source>BMJ</source>, <volume>313</volume>, <fpage>425</fpage>–<lpage>426</lpage>.</mixed-citation>
    </ref>
    <ref id="bty946-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Elhaik</surname><given-names>E.</given-names></name></person-group> (<year>2012</year>) 
<article-title>Empirical distributions of <italic>F</italic><sub>ST</sub> from large-scale human polymorphism data</article-title>. <source>PLoS One</source>, <volume>7</volume>, <fpage>e49837</fpage>.<pub-id pub-id-type="pmid">23185452</pub-id></mixed-citation>
    </ref>
    <ref id="bty946-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Elhaik</surname><given-names>E.</given-names></name><etal>et al</etal></person-group> (<year>2014</year>) 
<article-title>Geographic population structure analysis of worldwide human populations infers their biogeographical origins</article-title>. <source>Nat. Commun.</source>, <volume>5</volume>, <fpage>1</fpage>–<lpage>12</lpage>.</mixed-citation>
    </ref>
    <ref id="bty946-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Elhaik</surname><given-names>E.</given-names></name><etal>et al</etal></person-group> (<year>2017</year>) 
<article-title>The Diversity of REcent and Ancient huMan (DREAM): a new microarray for genetic anthropology and genealogy, forensics, and personalized medicine</article-title>. <source>Genome Biol. Evol.</source>, <volume>9</volume>, <fpage>3225</fpage>–<lpage>3237</lpage>.<pub-id pub-id-type="pmid">29165562</pub-id></mixed-citation>
    </ref>
    <ref id="bty946-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Epstein</surname><given-names>M.P.</given-names></name><etal>et al</etal></person-group> (<year>2007</year>) 
<article-title>A simple and improved correction for population stratification in case-control studies</article-title>. <source>Am. J. Hum. Genet.</source>, <volume>80</volume>, <fpage>921</fpage>–<lpage>930</lpage>.<pub-id pub-id-type="pmid">17436246</pub-id></mixed-citation>
    </ref>
    <ref id="bty946-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fustinoni</surname><given-names>O.</given-names></name>, <name name-style="western"><surname>Biller</surname><given-names>J.</given-names></name></person-group> (<year>2000</year>) 
<article-title>Ethnicity and stroke beware of the fallacies</article-title>. <source>Stroke</source>, <volume>31</volume>, <fpage>1013</fpage>–<lpage>1015</lpage>.<pub-id pub-id-type="pmid">10797159</pub-id></mixed-citation>
    </ref>
    <ref id="bty946-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ganju</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Zhou</surname><given-names>K.</given-names></name></person-group> (<year>2011</year>) 
<article-title>The benefit of stratification in clinical trials revisited</article-title>. <source>Stat. Med.</source>, <volume>30</volume>, <fpage>2881</fpage>–<lpage>2889</lpage>.<pub-id pub-id-type="pmid">21905064</pub-id></mixed-citation>
    </ref>
    <ref id="bty946-B14">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Gellert</surname><given-names>W.</given-names></name><etal>et al</etal></person-group> (<year>1989</year>) <source>The VNR Concise Encyclopedia of Mathematics</source>. <edition>2</edition>nd edn. 
<publisher-name>Van Nostrand Reinhold</publisher-name>, 
<publisher-loc>New York</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="bty946-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kimmel</surname><given-names>G.</given-names></name><etal>et al</etal></person-group> (<year>2007</year>) 
<article-title>A randomization test for controlling population stratification in whole-genome association studies</article-title>. <source>Am. J. Hum. Genet.</source>, <volume>81</volume>, <fpage>895</fpage>–<lpage>905</lpage>.<pub-id pub-id-type="pmid">17924333</pub-id></mixed-citation>
    </ref>
    <ref id="bty946-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lacour</surname><given-names>A.</given-names></name><etal>et al</etal></person-group> (<year>2015</year>) 
<article-title>Novel genetic matching methods for handling population stratification in genome-wide association studies</article-title>. <source>BMC Bioinformatics</source>, <volume>16</volume>, <fpage>84</fpage>.<pub-id pub-id-type="pmid">25880419</pub-id></mixed-citation>
    </ref>
    <ref id="bty946-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lazaridis</surname><given-names>I.</given-names></name><etal>et al</etal></person-group> (<year>2014</year>) 
<article-title>Ancient human genomes suggest three ancestral populations for present-day Europeans</article-title>. <source>Nature</source>, <volume>513</volume>, <fpage>409</fpage>–<lpage>413</lpage>.<pub-id pub-id-type="pmid">25230663</pub-id></mixed-citation>
    </ref>
    <ref id="bty946-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lipson</surname><given-names>M.</given-names></name><etal>et al</etal></person-group> (<year>2013</year>) 
<article-title>Efficient moment-based inference of admixture parameters and sources of gene flow</article-title>. <source>Mol. Biol. Evol.</source>, <volume>30</volume>, <fpage>1788</fpage>–<lpage>1802</lpage>.<pub-id pub-id-type="pmid">23709261</pub-id></mixed-citation>
    </ref>
    <ref id="bty946-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Luca</surname><given-names>D.</given-names></name><etal>et al</etal></person-group> (<year>2008</year>) 
<article-title>On the use of general control samples for genome-wide association studies: genetic matching highlights causal variants</article-title>. <source>Am. J. Hum. Genet.</source>, <volume>82</volume>, <fpage>453</fpage>–<lpage>463</lpage>.<pub-id pub-id-type="pmid">18252225</pub-id></mixed-citation>
    </ref>
    <ref id="bty946-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Marshall</surname><given-names>S.</given-names></name><etal>et al</etal></person-group> (<year>2016</year>) 
<article-title>Reconstructing Druze population history</article-title>. <source>Sci. Rep.</source>, <volume>6</volume>, <fpage>35837</fpage>.<pub-id pub-id-type="pmid">27848937</pub-id></mixed-citation>
    </ref>
    <ref id="bty946-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>McAuley</surname><given-names>J.</given-names></name><etal>et al</etal></person-group> (<year>1996</year>) 
<article-title>Self defined ethnicity is unhelpful</article-title>. <source>BMJ</source>, <volume>313</volume>, <fpage>425</fpage>.</mixed-citation>
    </ref>
    <ref id="bty946-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>McVean</surname><given-names>G.</given-names></name></person-group> (<year>2009</year>) 
<article-title>A genealogical interpretation of principal components analysis</article-title>. <source>PLoS Genet.</source>, <volume>5</volume>, <fpage>e1000686</fpage>.<pub-id pub-id-type="pmid">19834557</pub-id></mixed-citation>
    </ref>
    <ref id="bty946-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Patterson</surname><given-names>N.</given-names></name><etal>et al</etal></person-group> (<year>2006</year>) 
<article-title>Population structure and eigenanalysis</article-title>. <source>PLoS Genet.</source>, <volume>2</volume>, <fpage>e190</fpage>.<pub-id pub-id-type="pmid">17194218</pub-id></mixed-citation>
    </ref>
    <ref id="bty946-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Patterson</surname><given-names>N.J.</given-names></name><etal>et al</etal></person-group> (<year>2012</year>) 
<article-title>Ancient admixture in human history</article-title>. <source>Genetics</source>, <volume>192</volume>, <fpage>1065</fpage>–<lpage>1093</lpage>.<pub-id pub-id-type="pmid">22960212</pub-id></mixed-citation>
    </ref>
    <ref id="bty946-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pickrell</surname><given-names>J.K.</given-names></name>, <name name-style="western"><surname>Pritchard</surname><given-names>J.K.</given-names></name></person-group> (<year>2012</year>) 
<article-title>Inference of population splits and mixtures from genome-wide allele frequency data</article-title>. <source>PLoS Genet.</source>, <volume>8</volume>, <fpage>e1002967</fpage>.<pub-id pub-id-type="pmid">23166502</pub-id></mixed-citation>
    </ref>
    <ref id="bty946-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Price</surname><given-names>A.L.</given-names></name><etal>et al</etal></person-group> (<year>2006</year>) 
<article-title>Principal components analysis corrects for stratification in genome-wide association studies</article-title>. <source>Nat. Genet.</source>, <volume>38</volume>, <fpage>904</fpage>–<lpage>909</lpage>.<pub-id pub-id-type="pmid">16862161</pub-id></mixed-citation>
    </ref>
    <ref id="bty946-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Purcell</surname><given-names>S.</given-names></name><etal>et al</etal></person-group> (<year>2007</year>) 
<article-title>PLINK: a tool set for whole-genome association and population-based linkage analyses</article-title>. <source>Am. J. Hum. Genet.</source>, <volume>81</volume>, <fpage>559</fpage>–<lpage>575</lpage>.<pub-id pub-id-type="pmid">17701901</pub-id></mixed-citation>
    </ref>
    <ref id="bty946-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Roy</surname><given-names>A.S.</given-names></name></person-group> (<year>2012</year>) 
<article-title>Stifling new cures: the true cost of lengthy clinical drug trials</article-title>. <source><italic toggle="yes">Project FDA Report.</italic></source></mixed-citation>
    </ref>
    <ref id="bty946-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Scannell</surname><given-names>J.W.</given-names></name><etal>et al</etal></person-group> (<year>2012</year>) 
<article-title>Diagnosing the decline in pharmaceutical R&amp;D efficiency</article-title>. <source>Nat. Rev. Drug Discov.</source>, <volume>11</volume>, <fpage>191</fpage>–<lpage>200</lpage>.<pub-id pub-id-type="pmid">22378269</pub-id></mixed-citation>
    </ref>
    <ref id="bty946-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Skoglund</surname><given-names>P.</given-names></name><etal>et al</etal></person-group> (<year>2015</year>) 
<article-title>Genetic evidence for two founding populations of the Americas</article-title>. <source>Nature</source>, <volume>525</volume>, <fpage>104</fpage>–<lpage>108</lpage>.<pub-id pub-id-type="pmid">26196601</pub-id></mixed-citation>
    </ref>
    <ref id="bty946-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Solovieff</surname><given-names>N.</given-names></name><etal>et al</etal></person-group> (<year>2010</year>) 
<article-title>Clustering by genetic ancestry using genome-wide SNP data</article-title>. <source>BMC Genet.</source>, <volume>11</volume>, <fpage>108</fpage>.<pub-id pub-id-type="pmid">21143920</pub-id></mixed-citation>
    </ref>
    <ref id="bty946-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>Y.</given-names></name><etal>et al</etal></person-group> (<year>2006</year>) 
<article-title>Evaluating bias due to population stratification in epidemiologic studies of gene-gene or gene-environment interactions</article-title>. <source>Cancer Epidemiol. Biomarkers Prev.</source>, <volume>15</volume>, <fpage>124</fpage>–<lpage>132</lpage>.<pub-id pub-id-type="pmid">16434597</pub-id></mixed-citation>
    </ref>
    <ref id="bty946-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>J.</given-names></name><etal>et al</etal></person-group> (<year>2011</year>) 
<article-title>GCTA: a tool for genome-wide complex trait analysis</article-title>. <source>Am. J. Hum. Genet.</source>, <volume>88</volume>, <fpage>76</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">21167468</pub-id></mixed-citation>
    </ref>
    <ref id="bty946-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>W.Y.</given-names></name><etal>et al</etal></person-group> (<year>2012</year>) 
<article-title>A model-based approach for analysis of spatial structure in genetic data</article-title>. <source>Nat. Genet.</source>, <volume>44</volume>, <fpage>725</fpage>–<lpage>731</lpage>.<pub-id pub-id-type="pmid">22610118</pub-id></mixed-citation>
    </ref>
    <ref id="bty946-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yusuf</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Wittes</surname><given-names>J.</given-names></name></person-group> (<year>2016</year>) 
<article-title>Interpreting geographic variations in results of randomized, controlled trials</article-title>. <source>N. Engl. J. Med.</source>, <volume>375</volume>, <fpage>2263</fpage>–<lpage>2271</lpage>.<pub-id pub-id-type="pmid">27959693</pub-id></mixed-citation>
    </ref>
    <ref id="bty946-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zheng</surname><given-names>X.</given-names></name><etal>et al</etal></person-group> (<year>2012</year>) 
<article-title>A high-performance computing toolset for relatedness and principal component analysis of SNP data</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>3326</fpage>–<lpage>3328</lpage>.<pub-id pub-id-type="pmid">23060615</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
