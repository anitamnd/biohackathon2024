<?all-math-mml yes?>
<?use-mml?>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName nihms2pmcx2.xsl?>
<?ConverterInfo.Version 1?>
<?origin ukpmcpa?>
<?ManuscriptPrefix new?>
<?iso-abbr Nat Methods?>
<?submitter-system ukmss?>
<?submitter-canonical-name Nature Publishing Group?>
<?submitter-canonical-id NATURE-STRUCTUR?>
<?submitter-userid 0?>
<?submitter-authority publisher?>
<?submitter-login NPG?>
<?submitter-name Nature Publishing Group?>
<?domain wtpa?>
<?pmc-id-preallocated 7610486?>
<?properties manuscript?>
<?origin ukpmcpa?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-journal-id">101215604</journal-id>
    <journal-id journal-id-type="nlm-ta">Nat Methods</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Methods</journal-id>
    <journal-title-group>
      <journal-title>Nature methods</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1548-7091</issn>
    <issn pub-type="epub">1548-7105</issn>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7610486</article-id>
    <article-id pub-id-type="manuscript">ems118464</article-id>
    <article-id pub-id-type="pmid">32541853</article-id>
    <article-id pub-id-type="doi">10.1038/s41592-020-0853-5</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>DeepSTORM3D: dense 3D localization microscopy and PSF design by deep learning</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Nehme</surname>
          <given-names>Elias</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Freedman</surname>
          <given-names>Daniel</given-names>
        </name>
        <xref ref-type="aff" rid="A3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gordon</surname>
          <given-names>Racheli</given-names>
        </name>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ferdman</surname>
          <given-names>Boris</given-names>
        </name>
        <xref ref-type="aff" rid="A2">2</xref>
        <xref ref-type="aff" rid="A4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Weiss</surname>
          <given-names>Lucien E.</given-names>
        </name>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Alalouf</surname>
          <given-names>Onit</given-names>
        </name>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Naor</surname>
          <given-names>Tal</given-names>
        </name>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Orange</surname>
          <given-names>Reut</given-names>
        </name>
        <xref ref-type="aff" rid="A2">2</xref>
        <xref ref-type="aff" rid="A4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Michaeli</surname>
          <given-names>Tomer</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shechtman</surname>
          <given-names>Yoav</given-names>
        </name>
        <xref ref-type="aff" rid="A2">2</xref>
        <xref ref-type="aff" rid="A4">4</xref>
        <xref ref-type="corresp" rid="CR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="A1"><label>1</label>Department of Electrical Engineering, Technion, Haifa, Israel</aff>
    <aff id="A2"><label>2</label>Department of Biomedical Engineering &amp; Lorry I. Lokey Center for Life Sciences and Engineering, Technion, Haifa, Israel</aff>
    <aff id="A3"><label>3</label>Google Research, Haifa, Israel</aff>
    <aff id="A4"><label>4</label>Russel Berrie Nanotechnology Intitute, Technion, Haifa, Israel</aff>
    <author-notes>
      <corresp id="CR1"><label>*</label>Corresponding author: <email>yoavsh@bm.technion.ac.il</email></corresp>
    </author-notes>
    <pub-date pub-type="nihms-submitted">
      <day>04</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>6</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <volume>17</volume>
    <issue>7</issue>
    <fpage>734</fpage>
    <lpage>740</lpage>
    <permissions>
      <ali:free_to_read xmlns:ali="http://www.niso.org/schemas/ali/1.0/"/>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/">http://www.nature.com/authors/editorial_policies/license.html#terms</ali:license_ref>
        <license-p>Users may view, print, copy, and download text and data-mine the content in such documents, for the purposes of academic research, subject always to the full Conditions of use: <ext-link ext-link-type="uri" xlink:href="http://www.nature.com/authors/editorial_policies/license.html#terms">http://www.nature.com/authors/editorial_policies/license.html#terms</ext-link></license-p>
      </license>
    </permissions>
    <abstract>
      <p id="P1">Localization microscopy is an imaging technique in which the positions of individual point emitters (e.g. fluorescent molecules) are precisely determined from their images. This is a key ingredient in single/multiple-particle-tracking and super-resolution microscopy. Localization in three-dimensions (3D) can be performed by modifying the image that a point-source creates on the camera, namely, the point-spread function (PSF). The PSF is engineered to vary distinctively with emitter depth, using additional optical elements. However, localizing multiple adjacent emitters in 3D poses a significant algorithmic challenge, due to the lateral overlap of their PSFs. Here, we train a neural network to localize multiple emitters with densely overlapping PSFs over a large axial range. Furthermore, we then use the network to design the optimal PSF for the multi-emitter case. We demonstrate our approach experimentally with super-resolution reconstructions of mitochondria and volumetric imaging of fluorescently labeled telomeres in cells.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="S1">
    <label>1</label>
    <title>Introduction</title>
    <p id="P2">Determining the nanoscale positions of point emitters forms the basis of localization microscopy techniques such as single particle tracking [<xref rid="R1" ref-type="bibr">1</xref>, <xref rid="R2" ref-type="bibr">2</xref>], (fluorescence) photoactivated localization microscopy (f)PALM [<xref rid="R3" ref-type="bibr">3</xref>, <xref rid="R4" ref-type="bibr">4</xref>], stochastic optical reconstruction microscopy (STORM) [<xref rid="R5" ref-type="bibr">5</xref>], and related single molecule localization microscopy (SMLM) methods. These techniques have revolutionized biological imaging, revealing cellular processes and structures at the nanoscale [<xref rid="R6" ref-type="bibr">6</xref>]. Notably, most samples of interest extend in three dimensions, necessitating three-dimensional (3D) localization microscopy [<xref rid="R7" ref-type="bibr">7</xref>].</p>
    <p id="P3">In a standard microscope, the precise z position of an emitter is difficult to ascertain because the change of the point-spread function (PSF) near the focus is approximately symmetric. Furthermore, outside of this focal range (≈ ± 350 nm for a high numerical aperture imaging system), the rapid defocusing of the PSF reduces the signal-to-noise ratio causing the localization precision to quickly degrade. One method to extend the useful z-range and explicitly encode the z position is PSF engineering [<xref rid="R8" ref-type="bibr">8</xref>–<xref rid="R10" ref-type="bibr">10</xref>]. Here, an additional optical element, e.g. a phase mask, is placed in the emission path of the microscope, modifying the image formed on the detector [<xref rid="R11" ref-type="bibr">11</xref>] (<xref ref-type="fig" rid="F1">Fig. 1a</xref>); the axial position can then be recovered via image processing using a theoretical or experimentally-calibrated PSF model [<xref rid="R10" ref-type="bibr">10</xref>, <xref rid="R12" ref-type="bibr">12</xref>–<xref rid="R15" ref-type="bibr">15</xref>].</p>
    <p id="P4">In practically all applications, it is desirable to be able to localize nearby emitters simultaneously. For example, in super-resolution SMLM experiments, the number of emitters localized per frame determines the temporal resolution. In tracking applications, PSF overlap from multiple emitters often precludes localization, potentially biasing results in emitter-dense regions. The problem is that localizing overlapping emitters poses a significant algorithmic challenge even in 2D localization, and much more so in 3D. Specifically, encoding the axial position of an emitter over large axial ranges (&gt;3 <italic>μ</italic>m) requires the use of laterally large PSFs, e.g. the Tetrapod [<xref rid="R10" ref-type="bibr">10</xref>, <xref rid="R16" ref-type="bibr">16</xref>] (<xref ref-type="fig" rid="F1">Fig. 1b</xref>), increasing the possibility of overlap. Consequently, while a variety of methods have been developed to cope with overlapping emitters for the in-focus, standard-PSF [<xref rid="R17" ref-type="bibr">17</xref>–<xref rid="R19" ref-type="bibr">19</xref>], the performance in high-density 3D localization situations is far from satisfactory [<xref rid="R20" ref-type="bibr">20</xref>].</p>
    <p id="P5">Deep learning has proven to be adept at analyzing microscopic data [<xref rid="R21" ref-type="bibr">21</xref>–<xref rid="R29" ref-type="bibr">29</xref>], especially for single-molecule localization, handling dense fields of emitters over small axial ranges (&lt;1.5 <italic>μ</italic>m) [<xref rid="R19" ref-type="bibr">19</xref>, <xref rid="R30" ref-type="bibr">30</xref>–<xref rid="R37" ref-type="bibr">37</xref>] or sparse emitters spread over larger ranges [<xref rid="R38" ref-type="bibr">38</xref>]. Moreover, an emerging application is to jointly design the optical system alongside the data processing algorithm, enabling end-to-end optimization of both components [<xref rid="R36" ref-type="bibr">36</xref>, <xref rid="R39" ref-type="bibr">39</xref>–<xref rid="R46" ref-type="bibr">46</xref>]. Here we present DeepSTORM3D, consisting of two fundamental contributions to high-density 3D localization microscopy over large axial ranges. First, we employ a convolutional neural network (CNN) for analyzing dense fields of overlapping emitters with engineered PSFs, demonstrated with the large-axial-range Tetrapod PSF [<xref rid="R10" ref-type="bibr">10</xref>, <xref rid="R16" ref-type="bibr">16</xref>]. Second, we design an optimal PSF for 3D localization of dense emitters over a large axial range of 4 <italic>μ</italic>m. By incorporating a physical-simulation layer in the CNN with an adjustable phase modulation, we jointly learn the optimal PSF (encoding) and associated localization algorithm (decoding). This approach is highly flexible and easily adapted for any 3D SMLM dataset parameters, <italic>i.e</italic>. emitter density, SNRs, and z-range. We quantify the performance of the method by simulation, and demonstrate the applicability to 3D biological samples, <italic>i.e</italic>. mitochondria and telomere.</p>
  </sec>
  <sec sec-type="results" id="S2">
    <label>2</label>
    <title>Results</title>
    <sec id="S3">
      <title>Dense 3D localization with DeepSTORM3D</title>
      <p id="P6">To solve the high-density localization problem in 3D, we trained a CNN that receives a 2D image of overlapping Tetrapod PSFs spanning an axial range of 4 <italic>μ</italic>m, and outputs a 3D grid with a voxel-size of 27.5 × 27.5 × 33 <italic>nm</italic>
<sup>3</sup> (<xref ref-type="fig" rid="F1">Fig. 1c</xref>). For architecture details and learning hyper-parameters see <xref ref-type="supplementary-material" rid="SD1">Supplementary Notes 2.1</xref> and <xref ref-type="supplementary-material" rid="SD1">4</xref>. To compile a list of localizations, we apply simple thresholding, local maximum finding, and local averaging on the output 3D grid (<xref ref-type="supplementary-material" rid="SD1">Supplementary Note 5</xref>).</p>
      <p id="P7">We compare our method to a fit-and-subtract based Matching Pursuit (MP) approach [<xref rid="R47" ref-type="bibr">47</xref>] (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Note 7</xref>) as we are unaware of any other methods capable of localizing overlapping Tetrapod PSFs. To quantitatively compare our method with MP solely in terms of density, we simulated emitters with high signal-to-noise ratio (30K signal counts, 150 background counts per pixel) at 10 different densities ranging from 1 to 75 emitters per 13 × 13 <italic>μm</italic>
<sup>2</sup> field-of-view (for the definition of density see <xref ref-type="supplementary-material" rid="SD1">Supplementary Note 1</xref>). The results are shown in <xref ref-type="fig" rid="F2">Fig. 2</xref>. As evident in both the Jaccard index [<xref rid="R20" ref-type="bibr">20</xref>] (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Note 6</xref>) and the lateral/axial RMSE (<xref ref-type="fig" rid="F2">Fig. 2a</xref>), the CNN achieves remarkable performance in localizing high-density Tetrapods. In the single-emitter (very low density) case, where the performance of the CNN is bounded by the discretization on the 3D grid, the RMSE of the MP localization is lower (better). This is because for a single-emitter, MP is equivalent to a continuous Maximum Likelihood Estimator (MLE) (<xref ref-type="supplementary-material" rid="SD1">Supplementary Note 7</xref>), which is asymptotically optimal [<xref rid="R48" ref-type="bibr">48</xref>], whereas the CNN’s precision is bounded by pixilation of the grid (<italic>i.e</italic>. half voxel of 13.75 nm in xy and 16.5 nm in z). However, quickly beyond the single-emitter case, the CNN drastically outperforms MP at both high and low SNR (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Note 7.3</xref>). A similar result was obtained when compared to a leading single-emitter fitting method [<xref rid="R14" ref-type="bibr">14</xref>] applicable also for the multiple emitter case [<xref rid="R20" ref-type="bibr">20</xref>] (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Note 8.2</xref>). Furthermore, to put our method in context with other existing approaches, we tested DeepSTORM3D on the EPFL Double Helix (DH) high density challenge [<xref rid="R20" ref-type="bibr">20</xref>], and got favorable results (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Note 8.1</xref>).</p>
      <p id="P8">Next, we validated our method for super-resolution imaging of fluorescently labeled mitochondria in COS7 cells (<xref ref-type="fig" rid="F3">Fig. 3</xref> and <xref ref-type="supplementary-material" rid="SD2">Supplementary Videos 1</xref>-<xref ref-type="supplementary-material" rid="SD4">3</xref>). We acquired 20K diffraction limited frames of a 50 × 30 <italic>μm</italic>
<sup>2</sup> FOV and localized them using the CNN in about ≈3h 20m, resulting in ≈360K localizations. The Tetrapod PSF was implemented using a fabricated fused-silica phase-mask (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Note 9.1</xref>), and the CNN was trained solely on simulations matching the experimental conditions (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Note 4.1</xref>). The estimated resolution was ≈40 nm in xy, and ≈ 50 nm in z (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Note 9.3</xref>). To visually evaluate localization performance in a single frame (<xref ref-type="fig" rid="F3">Fig. 3a</xref> top), we regenerated the corresponding 2D low-resolution image, and overlayed the recovered image with a uniform photons scaling on top of the experimental frame (<xref ref-type="fig" rid="F3">Fig. 3a</xref> bottom and <xref ref-type="supplementary-material" rid="SD2">Supplementary Video 1</xref>). As seen in the overlay image, the emitter PSFs (3D positions) are faithfully recovered by the CNN. Moreover, emitters with extremely low number of signal photons were ignored. For further acceleration in acquisition time see <xref ref-type="supplementary-material" rid="SD1">Supplementary Note 9.2</xref>.</p>
    </sec>
    <sec id="S4">
      <title>Optimal PSF design for dense 3D imaging</title>
      <p id="P9">The Tetrapod is a special PSF that has been optimized for the single emitter case by Fisher information maximization [<xref rid="R10" ref-type="bibr">10</xref>, <xref rid="R16" ref-type="bibr">16</xref>]. However, when considering the multiple-emitter case, an intriguing question arises: What is the optimal PSF for high density 3D localization over a large axial range? To answer this question we need to rethink the design metric; extending the Fisher information criterion [<xref rid="R10" ref-type="bibr">10</xref>] to account for emitter density is not-trivial, and while it is intuitive that a smaller-footprint PSF would be preferable for dense emitters, it is not clear how to mathematically balance this demand with the requirement for high localization precision per emitter.</p>
      <p id="P10">Our PSF-design logic is based on the following: since we have already established that a CNN yields superior reconstruction for high-density 3D localization, we <italic>are interested in a PSF (encoder) that would be optimally localized by a CNN (decoder)</italic>. Therefore, in contrast to a sequential paradigm where the PSF and the localization algorithm are optimized separately, we adopt a co-design approach (<xref ref-type="fig" rid="F4">Fig. 4a</xref>). To jointly optimize the PSF and the localization CNN, we introduce a differentiable physical simulation layer, which is parametrized by a phase mask that dictates the microscope’s PSF. This layer encodes 3D point sources to their respective low-resolution 2D image (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Note 3</xref>). This image is then fed to the localization CNN which decodes it and recovers the underlying 3D source positions. During training, the net is presented with simulated point sources at random locations (projected on a fine grid) and, using the difference between the CNN recovery and the simulated 3D positions quantified by our loss function (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Note 4.2</xref>), we optimize both the phase mask and the localization CNN parameters in an end-to-end fashion using the backpropagation algorithm [<xref rid="R49" ref-type="bibr">49</xref>] (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Note 3.3</xref> and <xref ref-type="supplementary-material" rid="SD5">Supplementary Video 4</xref>). The learned PSF (<xref ref-type="fig" rid="F4">Fig. 4b</xref>) has a small lateral footprint, which is critical for minimizing overlap at high densities. Moreover, the learned phase mask twists in a spiral trajectory causing the PSF to rapidly rotate throughout the axial range, a trait that was previously shown to be valuable for encoding depth [<xref rid="R8" ref-type="bibr">8</xref>].</p>
      <p id="P11">To quantify the improvement introduced by our new PSF, we first compare it to the Tetrapod PSF in simulations. Specifically, we train a similar reconstruction net for both the Tetrapod and the learned PSF using a matching training set composed of simulated continuous 3D positions along with their corresponding 2D low-resolution images. The learned PSF performs similar to the Tetrapod PSF for low emitter densities (<xref ref-type="fig" rid="F4">Fig. 4d-f</xref>). However, as the density goes up (higher than ≈0.2 <inline-formula><mml:math id="M1"><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mtext>emitters</mml:mtext></mml:mrow><mml:mrow><mml:mi>μ</mml:mi><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math></inline-formula>) the learned PSF outperforms the Tetrapod PSF in both localization precision (<xref ref-type="fig" rid="F4">Fig. 4e</xref>,<xref ref-type="fig" rid="F4">f</xref>) and in emitter detectability (Jaccard index) (<xref ref-type="fig" rid="F4">Fig. 4d</xref>). This result is not surprising, as the learned PSF has a smaller spatial footprint, and hence it is less likely to overlap than the Tetrapod (<xref ref-type="fig" rid="F4">Fig. 4c</xref>). For further analysis of the learned PSF see <xref ref-type="supplementary-material" rid="SD1">Supplementary Note 10</xref>.</p>
    </sec>
    <sec id="S5">
      <title>Volumetric telomere imaging and tracking</title>
      <p id="P12">Next, we demonstrate the superiority of the new PSF experimentally by imaging fluorescently labeled telomeres (DsRed-hTRF1) in fixed U2OS cells. The cell contains tens of telomeres squeezed in the volume of a nucleus with ≈ 20 <italic>μ</italic>m diameter (<xref ref-type="fig" rid="F5">Fig. 5a, b</xref>). From a single snapshot focused inside the nucleus, the CNN outputs a list of 3D positions of telomeres spanning an axial range of ≈ 3 <italic>μ</italic>m. Using the Tetrapod PSF snapshot, the Tetrapod-trained CNN was able to recover 49 out of 62 telomeres with a single false positive, yielding a Jaccard index of 0.77 (<xref ref-type="fig" rid="F5">Fig. 5d</xref>). In comparison, using the learned PSF snapshot, the corresponding CNN was able to recover 57 out of the 62 telomeres with only 2 false positives, yielding a Jaccard index of 0.89 (<xref ref-type="fig" rid="F5">Fig. 5e</xref>). The recovered positions were compared to approximated ground-truth 3D positions (<xref ref-type="fig" rid="F5">Fig. 5c</xref>), obtained by axial scanning and 3D fitting (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Note 12</xref> and <xref ref-type="supplementary-material" rid="SD6">Supplementary Video 5</xref>). The precision of both PSFs was calibrated experimentally using a z-scan of a fluorescent micro-sphere (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Note 10.4</xref> and <xref ref-type="supplementary-material" rid="SD7">Supplementary Video 6</xref>).</p>
      <p id="P13">To qualitatively compare the recovered list of localizations to the acquired snapshot, we fed this list to the physical simulation layer and generated the matching 2D low-resolution image (<xref ref-type="fig" rid="F5">Fig. 5d</xref>,<xref ref-type="fig" rid="F5">e</xref>). As verified by the regenerated images, the 3D positions of the telomeres are faithfully recovered by the CNNs. Moreover, the misses in both snapshots were either due to local aberrations and/or an extremely low number of signal photons (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Note 13.1</xref> for more experimental results).</p>
      <p id="P14">Finally, a great advantage facilitated by our scan-free learned PSF is increased volumetric temporal resolution. To demonstrate the full capability of our method for dense multi-particle localization, we simultaneously track 48 telomeres diffusing within the volume of a live MEF cell, at 10 Hz over 50 seconds (<xref ref-type="fig" rid="F6">Fig. 6</xref>). Such a measurement can provide information on 3D nuclear rotation (<xref ref-type="fig" rid="F6">Fig. 6a</xref> and <xref ref-type="supplementary-material" rid="SD8">Supplementary Video 7</xref>) and heterogeneity in motion-type (<xref ref-type="fig" rid="F6">Fig. 6b-d</xref>), at time-scales that are typically unexplored by volumetric localization microscopy [<xref rid="R50" ref-type="bibr">50</xref>].</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="S6">
    <label>3</label>
    <title>Discussion</title>
    <p id="P15">In this work we demonstrated 3D localization of dense emitters over a large axial range both numerically and experimentally. The described network architecture exhibits excellent flexibility in dealing with various experimental challenges, e.g. low signal-to-noise ratios and optical aberrations. This versatility is facilitated in three ways: (1) the net was trained solely on simulated data, thus producing sufficiently large datasets for optimization; (2) the phase mask which governs the PSF was optimized with respect to the implementation in the imaging system, <italic>i.e</italic>. the pixels of the spatial light modular, rather than over a smaller subspace, e.g. Zernike polynomials [<xref rid="R10" ref-type="bibr">10</xref>]; (3) the CNN localization algorithm was designed in coordination with the development of the PSF, thus the system was optimized for the desired output [<xref rid="R36" ref-type="bibr">36</xref>] rather than a proxy.</p>
    <p id="P16">Attaining a sufficiently large training dataset has thus far been a major limitation for most applications of CNNs. With this limitation in mind, the application of CNNs to single-molecule localization would seemingly be an ideal one, since each emitter’s behavior should be approximately the same. This uniformity is broken, however, by spatially-varying background, sample density, and variable emitter size in biological samples (<xref ref-type="supplementary-material" rid="SD1">Supplementary Note 4.1</xref>), all of which diversify datasets and necessitate relevant training data. By implementing an accurate simulator, we have shown that it is possible to build a robust network entirely in silico, generating arbitrarily large, realistic datasets with a known ground truth to optimize the nets. This aligns with our previous work in 2D SMLM [<xref rid="R19" ref-type="bibr">19</xref>].</p>
    <p id="P17">For super-resolution reconstructions using the Tetrapod PSF, the simulator was particularly important due to the highly variable SNR of emitters in the sample. Here, our net was able to selectively localize the emitters even in very dense regions by focusing on those with a high SNR (<xref ref-type="fig" rid="F3">Fig. 3</xref>). To optimize a PSF while simultaneously training the net, the simulator was also essential, as it would be prohibitively time consuming to experimentally vary the PSF, while recording and analyzing images to train the net.</p>
    <p id="P18">An intriguing aspect of our optimization approach is that the optimized PSF is found by continuously varying the pixels of an initialized mask while evaluating the output of the localization net, thus the final result represents a local minimum (<xref ref-type="fig" rid="F4">Fig. 4</xref>). By changing the initialization conditions, we have recognized several patterns that indicate how the optimal PSF varies with the experimental conditions: namely, density, axial range, and SNR (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Note 2.2</xref>). Some of the recurrent features are intuitive: for example, in dense fields of emitters with limited SNR, the optimized PSFs have a small footprint over the designed axial range, enabling high density and compacting precious signal photons into as few pixels as possible. What distinguishes the net PSFs over predetermined designs is the utilization of multiple types of depth encoding; namely, simultaneously employing astigmatism, rotation, and side lobe movement (<xref ref-type="fig" rid="F4">Fig. 4</xref>), all of which have been conceived of and implemented previously, but never simultaneously!</p>
    <p id="P19">This work, therefore, triggers many possible questions and research directions regarding its capabilities and limitations. For example, how globally-optimal is the resulting PSF? Similarly, how sensitive is the resulting PSF and its performance to different loss functions, CNN architectures, initializations (e.g. with an existing phase mask), and the sampled training set of locations? Currently, it is unclear how each of these components affects the learning process although we began to partially answer them in simulations (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Notes 2.2</xref> and <xref ref-type="supplementary-material" rid="SD1">10</xref>). Finally, the co-design approach employed here paves the way to a wide variety of interesting applications in microscopy where imaging systems have traditionally been designed separately from the processing algorithm.</p>
  </sec>
  <sec sec-type="methods" id="S7" specific-use="web-only">
    <title>Methods</title>
    <sec id="S8">
      <title>Sample preparation</title>
      <p id="P20">COS7 cells were grown for 24 hr on cleaned 22 × 22 mm, 170 <italic>μ</italic>m thick coverslips in 6-well plate in Dulbecco’s Modified Eagle Medium (DMEM) With 1g/l D-Glucose (Low Glucose), supplemented with Fetal bovine serum, Penicillin-Streptomycin and glutamine, at 37°<italic>C</italic>, and 5%<italic>CO</italic>
<sub>2</sub>. The cells were fixed with 4% paraformaldehyde and 0.2% glutaraldehyde in PBS, pH 6.2, for 45 min, washed and incubated in 0.3M glycine/PBS solution for 10 minutes. The coverslips were transferred into a clean 6-well plate and incubated in a blocking solution for 2 hr (10% goat serum, 3% BSA, 2.2% glycine, and 0.1% Triton-X in PBS, filtered with 0.45 <italic>μ</italic>m PVDF filter unit, Millex). The cells were then immunostained overnight with anti TOMM20-AF647 (Abcam, ab209606) 1:230 diluted in the blocking buffer, and washed X5 with PBS. Cover glasses (22 × 22 mm, 170 <italic>μ</italic>m thick) were cleaned in an ultrasonic bath with 5% Decon90 at 60°C for 30 min, then washed with water, incubated in ethanol absolute for 30 min and sterilized with 70% filtered ethanol for 30 min.</p>
      <p id="P21">U2OS cells were grown on cleaned 0.18 <italic>μ</italic>m coverslips in 12-well plate in Dulbecco’s Modified Eagle Medium (DMEM) With 1g/l D-Glucose (Low Glucose), supplemented with Fetal bovine serum, Penicillin-Streptomycin and glutamine, at 37°<italic>C</italic>, and 5%<italic>CO</italic>
<sub>2</sub>. The day after cells were transfected with a plasmid encoding the fluorescently-tagged telomeric repeat binding factor 1 (DsRed-hTRF1) [<xref rid="R50" ref-type="bibr">50</xref>] using Lipofectamine 3000 reagent. 24 hr after transfection cells were fixed with 4% paraformaldehyde for 20 minutes, washed 3 times with PBS and attached to a slide together with mounting medium.</p>
      <p id="P22">Lamin A double knockout (lmna-/-) Mouse Embryonic Fibroblasts (MEFs) were cultured in phenol red-free DMEM/F-12 media (Gibco, Thermo-fisher Scientific), which was supplemented with 10% fetal bovine serum (FBS) and 1% Penicillin-Streptomycin solution (Biological industries, Bet Ha-emek, Israel). Two days prior to imaging, cells were transferred to 15 mm coverglass-bottom culture plates (Nest scientific). After 24 hours, cells were transfected with a plasmid encoding DsRed-hTRF1. The transfection mix was prepared by diluting 8 <italic>μ</italic>g of the plasmid in 50 <italic>μ</italic>l of serum-free DMEM/F-12 and separately diluting 24 <italic>μ</italic>l of transfection reagent Polyjet™ (SignaGen Laboratories, USA) in 26 <italic>μ</italic>l of serum-free DMEM/F-12, then immediately adding the diluted Polyjet solution to the DNA mixture and incubating at room temperature for 20 minutes. The 100 <italic>μ</italic>l DNA-Polyjet mix was then added dropwise to the cell plates. Imaging experiments were conducted about 26 hours after transfection and lasted for 1-2 hours.</p>
    </sec>
    <sec id="S9">
      <title>Optical setup</title>
      <p id="P23">Imaging experiments were performed on the experimental system shown schematically in <xref ref-type="fig" rid="F1">Fig. 1b</xref>. The 4f optical processing system was built alongside the side-port of a Nikon Eclipse Ti inverted fluorescence microscope, with a × 100/1.45 numerical aperture (NA) oil-immersion objective lens (Plan Apo × 100/1.45 NA, Nikon).</p>
    </sec>
    <sec id="S10">
      <title>STORM imaging</title>
      <p id="P24">For super-resolution imaging, a PDMS chamber was attached to a glass coverslip containing fixed COS7 cells. Blinking buffer (100 mM <italic>β</italic>-mercaptoethylamine hydrochloride, 20% sodium lactate, and 3% OxyFluor (Sigma, SAE0059), modified from [<xref rid="R51" ref-type="bibr">51</xref>], was then added and a glass coverslip was placed on top to prevent evaporation. Low-intensity illumination for recording diffraction-limited images was applied using a Topica laser (640 nm), on the Nikon TI imaging setup described previously, and recorded with an EMCCD (iXon, Andor) in a standard imaging setup. For super-resolution blinking using the Tetrapod PSF, high-intensity (1W at the back of the objective lens) 640 nm light was applied using a 638 nm 2000 mW red dot laser module, whose beam shape was cleaned using a 25 <italic>μ</italic>m pinhole (Thorlabs) in coordination with low-intensity (&lt;5mW) 405 nm light. Emission light was filtered through a 500 nm Long pass dichroic and a 650 nm long pass (Chroma), projected through a 4f system containing the dielectric Tetrapod phase mask (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Note 9.1</xref>), and imaged on a Prime95b Photometrics camera.</p>
    </sec>
    <sec id="S11">
      <title>Super-resolution image rendering</title>
      <p id="P25">Prior to rendering the super-resolved image (<xref ref-type="fig" rid="F3">Fig. 3b</xref>), we first corrected for sample drift using the ThunderSTORM [<xref rid="R52" ref-type="bibr">52</xref>] ImageJ [<xref rid="R53" ref-type="bibr">53</xref>] plugin. Afterwards, we rendered the 3D localizations as a 2D average shifted histogram, with color encoding the z position.</p>
    </sec>
    <sec id="S12">
      <title>Telomere imaging</title>
      <p id="P26">For telomere imaging in fixed cells, the 4f system consisted of two f=15 cm lenses (Thorlabs), a linear polarizer (Thorlabs) to filter out the light that is polarized in the unmodulated direction of the LC-SLM, a 1920 × 1080 pixel LC-SLM (PLUTO-VIS, Holoeye) and a mirror for beam-steering. A sCMOS camera (Prime95B, Photometrics) was used to record the data. The sample was illuminated with 561 nm fiber-coupled laser-light source (iChrome MLE, Toptica). The excitation light was reflected up through the microscope objective by a multibandpass dichroic filter (TRF89902-EM - ET - 405/488/561/647 nm Laser Quad Band Set, Chroma). Emission light was filtered by the same dichroic and also filtered by another 617 nm band pass filter (FF02-617/73 Semrock).</p>
      <p id="P27">For volumetric telomere tracking in live cells, images were recorded with an EMCCD camera (Andor iXON), exposure time 100 ms and EM-gain 170. The sample was illuminated at ≈2 kW/cm<sup>2</sup> with 561 nm light from a fiber-coupled laser (iChrome MLE, Toptica). All movies were recorded for 50 s (500 frames).</p>
    </sec>
    <sec id="S13">
      <title>CNN Architecture</title>
      <p id="P28">In a nutshell, our localization CNN architecture is composed of 3 main modules. First, a multi-scale context aggregation module process the input 2D low-resolution image and extracts features with a growing receptive field using dilated convolutions [<xref rid="R54" ref-type="bibr">54</xref>]. Second, an up-sampling module increase the lateral resolution of the predicted volume by a factor of x4. Finally, the last module refines the depth and lateral position of the emitters and outputs the predicted vacancy-grid. For more details regarding the architecture see <xref ref-type="supplementary-material" rid="SD1">Supplementary Note 2</xref>.</p>
    </sec>
    <sec id="S14">
      <title>Statistics and reproducibility</title>
      <p id="P29">The STORM experiment was repeated independently for <italic>n</italic> = 3 cells, twice analyzing 20K frames and once analyzing 10K frames all leading to similar performance. The fixed telomere experiment was repeated independently for <italic>n</italic> = 10 U2OS cells all showing similar characteristics and performance. The live telomere experiment was repeated independently for <italic>n</italic> = 10 MEF cells all showing similar characteristics and performance.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="SM">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="SD1">
      <label>Supplementary Information</label>
      <media xlink:href="EMS118464-supplement-Supplementary_Information.pdf" mimetype="application" mime-subtype="pdf" orientation="portrait" id="d40e817" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD2">
      <label>Supplementary Video 1</label>
      <media xlink:href="EMS118464-supplement-Supplementary_Video_1.gif" mimetype="image" mime-subtype="gif" orientation="portrait" id="d40e821" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD3">
      <label>Supplementary Video 2</label>
      <media xlink:href="EMS118464-supplement-Supplementary_Video_2.gif" mimetype="image" mime-subtype="gif" orientation="portrait" id="d40e825" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD4">
      <label>Supplementary Video 3</label>
      <media xlink:href="EMS118464-supplement-Supplementary_Video_3.gif" mimetype="image" mime-subtype="gif" orientation="portrait" id="d40e829" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD5">
      <label>Supplementary Video 4</label>
      <media xlink:href="EMS118464-supplement-Supplementary_Video_4.gif" mimetype="image" mime-subtype="gif" orientation="portrait" id="d40e833" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD6">
      <label>Supplementary Video 5</label>
      <media xlink:href="EMS118464-supplement-Supplementary_Video_5.gif" mimetype="image" mime-subtype="gif" orientation="portrait" id="d40e837" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD7">
      <label>Supplementary Video 6</label>
      <media xlink:href="EMS118464-supplement-Supplementary_Video_6.gif" mimetype="image" mime-subtype="gif" orientation="portrait" id="d40e841" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD8">
      <label>Supplementary Video 7</label>
      <media xlink:href="EMS118464-supplement-Supplementary_Video_7.gif" mimetype="image" mime-subtype="gif" orientation="portrait" id="d40e845" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="S15">
    <title>Acknowledgements</title>
    <p>The authors wish to thank the Garini lab (Bar-Ilan University, Israel) for the U2OS cells, lamin A double knockout (lmna-/-) Mouse Embryonic Fibroblasts (MEFs), and the plasmid encoding for DsRed-hTRF1. We also thank J. Ries for his help with the application of SMAP-2018 to Tetrapod PSFs. We gratefully acknowledge the support of NVIDIA Corporation with the donation of the Titan V GPU used for this research. We thank the staff of the Micro-NanoFabrication &amp; Printing Unit (MNF-PU) at the Technion for their assist with the phase mask fabrication. Finally, we thank Google for the research cloud units provided to accelerate this research. E.N., O.A., B.F. and R.O. are supported by H2020 European Research Council Horizon 2020 (802567); T.M. is supported by the Israel Science Foundation (ISF) (grant No. 852/17) and by the Ollendorff Foundation; R.G. and O.A. are supported by Israel Science Foundation (ISF) (grant No. 450/18); Y.S. is supported by the Technion-Israel Institute of Technology Career Advancement Chairship; L.E.W. and Y.S. are supported by the Zuckerman Foundation. D. F. is supported by Google.</p>
  </ack>
  <fn-group>
    <fn id="FN1" fn-type="con">
      <p id="P32">
        <bold>Author contributions</bold>
      </p>
      <p id="P33">E.N., D.F., T.M. and Y.S. conceived the approach. E.N. performed the simulations and analyzed the data with contributions from all authors. E.N., R.G., B.F., L.E.W., O.A. and T.N. took the data. R.O. fabricated the physical phase mask. T.N. prepared the MEF cells. E.N., D.F., L.E.W., T.M. and Y.S. wrote the paper with contributions from all authors.</p>
    </fn>
    <fn fn-type="COI-statement" id="FN2">
      <p id="P34">
        <bold>Competing interests</bold>
      </p>
      <p id="P35">The authors declare no competing interests.</p>
    </fn>
    <fn id="FN3">
      <p id="P36"><bold>Reporting Summary.</bold> Further information on research design is available in the Life Sciences Reporting Summary linked to this article.</p>
    </fn>
  </fn-group>
  <sec id="S16" sec-type="data-availability">
    <title>Data Availability</title>
    <p id="P30">The data that support the findings of this study are available from the corresponding author upon reasonable request.</p>
  </sec>
  <sec id="S17" sec-type="data-availability">
    <title>Code Availability</title>
    <p id="P31">Code is made publicly available at <ext-link ext-link-type="uri" xlink:href="https://github.com/EliasNehme/DeepSTORM3D">https://github.com/EliasNehme/DeepSTORM3D</ext-link>.</p>
  </sec>
  <ref-list>
    <ref id="R1">
      <label>[1]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katayama</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Real-time nanomicroscopy via three-dimensional single-particle tracking</article-title>
        <source>ChemPhysChem</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>2458</fpage>
        <lpage>2464</lpage>
        <pub-id pub-id-type="pmid">19760694</pub-id>
      </element-citation>
    </ref>
    <ref id="R2">
      <label>[2]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Manzo</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Garcia-Parajo</surname>
            <given-names>MF</given-names>
          </name>
        </person-group>
        <article-title>A review of progress in single particle tracking: from methods to biophysical insights</article-title>
        <source>Reports on progress in physics</source>
        <year>2015</year>
        <volume>78</volume>
        <fpage>124601</fpage>
        <pub-id pub-id-type="pmid">26511974</pub-id>
      </element-citation>
    </ref>
    <ref id="R3">
      <label>[3]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Betzig</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Imaging intracellular fluorescent proteins at nanometer resolution</article-title>
        <source>Science</source>
        <year>2006</year>
        <volume>313</volume>
        <fpage>1642</fpage>
        <lpage>1645</lpage>
        <pub-id pub-id-type="pmid">16902090</pub-id>
      </element-citation>
    </ref>
    <ref id="R4">
      <label>[4]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hess</surname>
            <given-names>ST</given-names>
          </name>
          <name>
            <surname>Girirajan</surname>
            <given-names>TP</given-names>
          </name>
          <name>
            <surname>Mason</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>Ultra-high resolution imaging by fluorescence photoactivation localization microscopy</article-title>
        <source>Biophysical journal</source>
        <year>2006</year>
        <volume>91</volume>
        <fpage>4258</fpage>
        <lpage>4272</lpage>
        <pub-id pub-id-type="pmid">16980368</pub-id>
      </element-citation>
    </ref>
    <ref id="R5">
      <label>[5]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rust</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Bates</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhuang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Sub-diffraction-limit imaging by stochastic optical reconstruction microscopy (storm)</article-title>
        <source>Nature methods</source>
        <year>2006</year>
        <volume>3</volume>
        <fpage>793</fpage>
        <lpage>796</lpage>
        <pub-id pub-id-type="pmid">16896339</pub-id>
      </element-citation>
    </ref>
    <ref id="R6">
      <label>[6]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sahl</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Moerner</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Super-resolution fluorescence imaging with single molecules</article-title>
        <source>Current opinion in structural biology</source>
        <year>2013</year>
        <volume>23</volume>
        <fpage>778</fpage>
        <lpage>787</lpage>
        <pub-id pub-id-type="pmid">23932284</pub-id>
      </element-citation>
    </ref>
    <ref id="R7">
      <label>[7]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>von Diezmann</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shechtman</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Moerner</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Three-dimensional localization of single molecules for superresolution imaging and single-particle tracking</article-title>
        <source>Chemical reviews</source>
        <year>2017</year>
        <volume>117</volume>
        <fpage>7244</fpage>
        <lpage>7275</lpage>
        <pub-id pub-id-type="pmid">28151646</pub-id>
      </element-citation>
    </ref>
    <ref id="R8">
      <label>[8]</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Pavani</surname>
            <given-names>SRP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Three-dimensional, single-molecule fluorescence imaging beyond the diffraction limit by using a double-helix point spread function</article-title>
        <conf-name>Proceedings of the National Academy of Sciences</conf-name>
        <year>2009</year>
        <volume>106</volume>
        <fpage>2995</fpage>
        <lpage>2999</lpage>
      </element-citation>
    </ref>
    <ref id="R9">
      <label>[9]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Bates</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhuang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Three-dimensional super-resolution imaging by stochastic optical reconstruction microscopy</article-title>
        <source>Science</source>
        <year>2008</year>
        <volume>319</volume>
        <fpage>810</fpage>
        <lpage>813</lpage>
        <pub-id pub-id-type="pmid">18174397</pub-id>
      </element-citation>
    </ref>
    <ref id="R10">
      <label>[10]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shechtman</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Sahl</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Backer</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Moerner</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Optimal point spread function design for 3d imaging</article-title>
        <source>Physical review letters</source>
        <year>2014</year>
        <volume>113</volume>
        <fpage>133902</fpage>
        <pub-id pub-id-type="pmid">25302889</pub-id>
      </element-citation>
    </ref>
    <ref id="R11">
      <label>[11]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Backer</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Moerner</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Extending single-molecule microscopy using optical fourier processing</article-title>
        <source>The Journal of Physical Chemistry B</source>
        <year>2014</year>
        <volume>118</volume>
        <fpage>8313</fpage>
        <lpage>8329</lpage>
        <pub-id pub-id-type="pmid">24745862</pub-id>
      </element-citation>
    </ref>
    <ref id="R12">
      <label>[12]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kromann</surname>
            <given-names>EB</given-names>
          </name>
          <name>
            <surname>Krueger</surname>
            <given-names>WD</given-names>
          </name>
          <name>
            <surname>Bewersdorf</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lidke</surname>
            <given-names>KA</given-names>
          </name>
        </person-group>
        <article-title>Three dimensional single molecule localization using a phase retrieved pupil function</article-title>
        <source>Optics express</source>
        <year>2013</year>
        <volume>21</volume>
        <fpage>29462</fpage>
        <lpage>29487</lpage>
        <pub-id pub-id-type="pmid">24514501</pub-id>
      </element-citation>
    </ref>
    <ref id="R13">
      <label>[13]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Babcock</surname>
            <given-names>HP</given-names>
          </name>
          <name>
            <surname>Zhuang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Analyzing single molecule localization microscopy data using cubic splines</article-title>
        <source>Scientific reports</source>
        <year>2017</year>
        <volume>7</volume>
        <fpage>552</fpage>
        <pub-id pub-id-type="pmid">28373678</pub-id>
      </element-citation>
    </ref>
    <ref id="R14">
      <label>[14]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Real-time 3d single-molecule localization using experimental point spread functions</article-title>
        <source>Nature methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>367</fpage>
        <pub-id pub-id-type="pmid">29630062</pub-id>
      </element-citation>
    </ref>
    <ref id="R15">
      <label>[15]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aristov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lelandais</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Rensen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Zimmer</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Zola-3d allows flexible 3d localization microscopy over an adjustable axial range</article-title>
        <source>Nature communications</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>2409</fpage>
      </element-citation>
    </ref>
    <ref id="R16">
      <label>[16]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shechtman</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Weiss</surname>
            <given-names>LE</given-names>
          </name>
          <name>
            <surname>Backer</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Sahl</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Moerner</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Precise three-dimensional scan-free multiple-particle tracking over large axial ranges with tetrapod point spread functions</article-title>
        <source>Nano letters</source>
        <year>2015</year>
        <volume>15</volume>
        <fpage>4194</fpage>
        <lpage>4199</lpage>
        <pub-id pub-id-type="pmid">25939423</pub-id>
      </element-citation>
    </ref>
    <ref id="R17">
      <label>[17]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Min</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Falcon: fast and unbiased reconstruction of high-density super-resolution microscopy data</article-title>
        <source>Scientific reports</source>
        <year>2014</year>
        <volume>4</volume>
        <fpage>4577</fpage>
        <pub-id pub-id-type="pmid">24694686</pub-id>
      </element-citation>
    </ref>
    <ref id="R18">
      <label>[18]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boyd</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Schiebinger</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Recht</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>The alternating descent conditional gradient method for sparse inverse problems</article-title>
        <source>SIAM Journal on Optimization</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>616</fpage>
        <lpage>639</lpage>
      </element-citation>
    </ref>
    <ref id="R19">
      <label>[19]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nehme</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Weiss</surname>
            <given-names>LE</given-names>
          </name>
          <name>
            <surname>Michaeli</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Shechtman</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Deep-storm: super-resolution single-molecule microscopy by deep learning</article-title>
        <source>Optica</source>
        <year>2018</year>
        <volume>5</volume>
        <fpage>458</fpage>
        <lpage>464</lpage>
      </element-citation>
    </ref>
    <ref id="R20">
      <label>[20]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sage</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Super-resolution fight club: assessment of 2d and 3d single-molecule localization microscopy software</article-title>
        <source>Nature methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>387</fpage>
        <pub-id pub-id-type="pmid">30962624</pub-id>
      </element-citation>
    </ref>
    <ref id="R21">
      <label>[21]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rivenson</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Günaydin</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Teng</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ozcan</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Phase recovery and holographic image reconstruction using deep learning in neural networks</article-title>
        <source>Light: Science &amp; Applications</source>
        <year>2018</year>
        <volume>7</volume>
        <fpage>17141</fpage>
      </element-citation>
    </ref>
    <ref id="R22">
      <label>[22]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Xue</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Nehmetallah</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Deep learning approach for fourier ptychography microscopy</article-title>
        <source>Optics express</source>
        <year>2018</year>
        <volume>26</volume>
        <fpage>26470</fpage>
        <lpage>26484</lpage>
        <pub-id pub-id-type="pmid">30469733</pub-id>
      </element-citation>
    </ref>
    <ref id="R23">
      <label>[23]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weigert</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Content-aware image restoration: pushing the limits of fluorescence microscopy</article-title>
        <source>Nature methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>1090</fpage>
        <pub-id pub-id-type="pmid">30478326</pub-id>
      </element-citation>
    </ref>
    <ref id="R24">
      <label>[24]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ounkomol</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Seshamani</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Maleckar</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Collman</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>GR</given-names>
          </name>
        </person-group>
        <article-title>Label-free prediction of threedimensional fluorescence images from transmitted-light microscopy</article-title>
        <source>Nature methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>917</fpage>
        <lpage>920</lpage>
        <pub-id pub-id-type="pmid">30224672</pub-id>
      </element-citation>
    </ref>
    <ref id="R25">
      <label>[25]</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Krull</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Buchholz</surname>
            <given-names>T-O</given-names>
          </name>
          <name>
            <surname>Jug</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Noise2void-learning denoising from single noisy images</article-title>
        <conf-name>Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</conf-name>
        <year>2019</year>
        <fpage>2129</fpage>
        <lpage>2137</lpage>
      </element-citation>
    </ref>
    <ref id="R26">
      <label>[26]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Falk</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>U-net: deep learning for cell counting, detection, and morphometry</article-title>
        <source>Nature methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>67</fpage>
        <lpage>70</lpage>
        <pub-id pub-id-type="pmid">30559429</pub-id>
      </element-citation>
    </ref>
    <ref id="R27">
      <label>[27]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rivenson</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phasestain: the digital staining of label-free quantitative phase microscopy images using deep learning</article-title>
        <source>Light: Science &amp; Applications</source>
        <year>2019</year>
        <volume>8</volume>
        <fpage>23</fpage>
      </element-citation>
    </ref>
    <ref id="R28">
      <label>[28]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deep learning-based super-resolution in coherent imaging systems</article-title>
        <source>Scientific reports</source>
        <year>2019</year>
        <volume>9</volume>
        <fpage>3926</fpage>
        <pub-id pub-id-type="pmid">30850721</pub-id>
      </element-citation>
    </ref>
    <ref id="R29">
      <label>[29]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>JT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ultra-fast fit-free analysis of complex fluorescence lifetime imaging via deep learning</article-title>
        <source>bioRxiv</source>
        <year>2019</year>
        <fpage>523928</fpage>
      </element-citation>
    </ref>
    <ref id="R30">
      <label>[30]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boyd</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Jonas</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Babcock</surname>
            <given-names>HP</given-names>
          </name>
          <name>
            <surname>Recht</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Deeploco: Fast 3d localization microscopy using neural networks</article-title>
        <source>bioRxiv</source>
        <year>2018</year>
        <fpage>267096</fpage>
      </element-citation>
    </ref>
    <ref id="R31">
      <label>[31]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ouyang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Aristov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lelek</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zimmer</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Deep learning massively accelerates super-resolution localization microscopy</article-title>
        <source>Nature biotechnology</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>460</fpage>
        <lpage>468</lpage>
      </element-citation>
    </ref>
    <ref id="R32">
      <label>[32]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Diederich</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Then</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Jugler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Förster</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Heintzmann</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>cellstorm—cost-effective super-resolution on a cellphone using dstorm</article-title>
        <source>PloS one</source>
        <year>2019</year>
        <volume>14</volume>
      </element-citation>
    </ref>
    <ref id="R33">
      <label>[33]</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Newby</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Schaefer</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>PT</given-names>
          </name>
          <name>
            <surname>Forest</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Lai</surname>
            <given-names>SK</given-names>
          </name>
        </person-group>
        <article-title>Convolutional neural networks automate detection for tracking of submicron-scale particles in 2d and 3d</article-title>
        <conf-name>Proceedings of the National Academy of Sciences</conf-name>
        <year>2018</year>
        <volume>115</volume>
        <fpage>9026</fpage>
        <lpage>9031</lpage>
      </element-citation>
    </ref>
    <ref id="R34">
      <label>[34]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zelger</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Three-dimensional localization microscopy using deep learning</article-title>
        <source>Optics express</source>
        <year>2018</year>
        <volume>26</volume>
        <fpage>33166</fpage>
        <lpage>33179</lpage>
        <pub-id pub-id-type="pmid">30645473</pub-id>
      </element-citation>
    </ref>
    <ref id="R35">
      <label>[35]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fast 3d cell tracking with wide-field fluorescence microscopy through deep learning</article-title>
        <source>arXiv</source>
        <year>2018</year>
        <comment>preprint arXiv:1805.05139</comment>
      </element-citation>
    </ref>
    <ref id="R36">
      <label>[36]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hershko</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Weiss</surname>
            <given-names>LE</given-names>
          </name>
          <name>
            <surname>Michaeli</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Shechtman</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Multicolor localization microscopy and point-spread-function engineering by deep learning</article-title>
        <source>Optics express</source>
        <year>2019</year>
        <volume>27</volume>
        <fpage>6158</fpage>
        <lpage>6183</lpage>
        <pub-id pub-id-type="pmid">30876208</pub-id>
      </element-citation>
    </ref>
    <ref id="R37">
      <label>[37]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Speiser</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Turaga</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Macke</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>Teaching deep neural networks to localize sources in super-resolution microscopy by combining simulation-based learning and unsupervised learning</article-title>
        <source>arXiv</source>
        <year>2019</year>
        <comment>preprint arXiv:1907.00770</comment>
      </element-citation>
    </ref>
    <ref id="R38">
      <label>[38]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Analyzing complex single-molecule emission patterns with deep learning</article-title>
        <source>Nature methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>913</fpage>
        <pub-id pub-id-type="pmid">30377349</pub-id>
      </element-citation>
    </ref>
    <ref id="R39">
      <label>[39]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chakrabarti</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Learning sensor multiplexing design through back-propagation</article-title>
        <source>Advances in Neural Information Processing Systems</source>
        <year>2016</year>
        <fpage>3081</fpage>
        <lpage>3089</lpage>
      </element-citation>
    </ref>
    <ref id="R40">
      <label>[40]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Horstmeyer</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>RY</given-names>
          </name>
          <name>
            <surname>Kappes</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Judkewitz</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Convolutional neural networks that teach microscopes how to image</article-title>
        <source>arXiv</source>
        <year>2017</year>
        <comment>preprint arXiv:1709.07223</comment>
      </element-citation>
    </ref>
    <ref id="R41">
      <label>[41]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Turpin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vishniakou</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>d Seelig</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Light scattering control in transmission and reflection with neural networks</article-title>
        <source>Optics express</source>
        <year>2018</year>
        <volume>26</volume>
        <fpage>30911</fpage>
        <lpage>30929</lpage>
        <pub-id pub-id-type="pmid">30469982</pub-id>
      </element-citation>
    </ref>
    <ref id="R42">
      <label>[42]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haim</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Elmalem</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Giryes</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bronstein</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Marom</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Depth estimation from a single image using deep learned phase coded mask</article-title>
        <source>IEEE Transactions on Computational Imaging</source>
        <year>2018</year>
        <volume>4</volume>
        <fpage>298</fpage>
        <lpage>310</lpage>
      </element-citation>
    </ref>
    <ref id="R43">
      <label>[43]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>He</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Learning depth from single images with deep neural network embedding focal length</article-title>
        <source>IEEE Transactions on Image Processing</source>
        <year>2018</year>
        <volume>27</volume>
        <fpage>4676</fpage>
        <lpage>4689</lpage>
      </element-citation>
    </ref>
    <ref id="R44">
      <label>[44]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sitzmann</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>End-to-end optimization of optics and image processing for achromatic extended depth of field and super-resolution imaging</article-title>
        <source>ACM Transactions on Graphics (TOG)</source>
        <year>2018</year>
        <volume>37</volume>
        <fpage>114</fpage>
      </element-citation>
    </ref>
    <ref id="R45">
      <label>[45]</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Chang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wetzstein</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Deep optics for monocular depth estimation and 3d object detection</article-title>
        <conf-name>Proceedings of the IEEE International Conference on Computer Vision</conf-name>
        <year>2019</year>
        <fpage>10193</fpage>
        <lpage>10202</lpage>
      </element-citation>
    </ref>
    <ref id="R46">
      <label>[46]</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Boominathan</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Sankaranarayanan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Veeraraghavan</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Phasecam3d—learning phase masks for passive single view depth estimation</article-title>
        <conf-name>2019 IEEE International Conference on Computational Photography (ICCP)</conf-name>
        <conf-loc>IEEE</conf-loc>
        <year>2019</year>
        <fpage>1</fpage>
        <lpage>12</lpage>
      </element-citation>
    </ref>
    <ref id="R47">
      <label>[47]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shechtman</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Weiss</surname>
            <given-names>LE</given-names>
          </name>
          <name>
            <surname>Backer</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>MY</given-names>
          </name>
          <name>
            <surname>Moerner</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Multicolour localization microscopy by point-spread-function engineering</article-title>
        <source>Nature photonics</source>
        <year>2016</year>
        <volume>10</volume>
        <fpage>590</fpage>
        <pub-id pub-id-type="pmid">28413434</pub-id>
      </element-citation>
    </ref>
    <ref id="R48">
      <label>[48]</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Bickel</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Doksum</surname>
            <given-names>KA</given-names>
          </name>
        </person-group>
        <source>Mathematical Statistics: Basic Ideas and Selected Topics, Volumes I-II Package</source>
        <publisher-name>Chapman and Hall/CRC</publisher-name>
        <year>2015</year>
      </element-citation>
    </ref>
    <ref id="R49">
      <label>[49]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>LeCun</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Bengio</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hinton</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Deep learning</article-title>
        <source>nature</source>
        <year>2015</year>
        <volume>521</volume>
        <fpage>436</fpage>
        <lpage>444</lpage>
        <pub-id pub-id-type="pmid">26017442</pub-id>
      </element-citation>
    </ref>
    <ref id="R50">
      <label>[50]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bronshtein</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Loss of lamin a function increases chromatin dynamics in the nuclear interior</article-title>
        <source>Nature communications</source>
        <year>2015</year>
        <volume>6</volume>
        <fpage>8044</fpage>
      </element-citation>
    </ref>
    <ref id="R51">
      <label>[51]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nahidiazar</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Agronskaia</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Broertjes</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>van den Broek</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Jalink</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Optimizing imaging conditions for demanding multi-color super resolution localization microscopy</article-title>
        <source>PLoS One</source>
        <year>2016</year>
        <volume>11</volume>
      </element-citation>
    </ref>
    <ref id="R52">
      <label>[52]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ovesnỳ</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Křížek</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Borkovec</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Švindrych</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Hagen</surname>
            <given-names>GM</given-names>
          </name>
        </person-group>
        <article-title>Thunderstorm: a comprehensive imagej plug-in for palm and storm data analysis and super-resolution imaging</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>2389</fpage>
        <lpage>2390</lpage>
        <pub-id pub-id-type="pmid">24771516</pub-id>
      </element-citation>
    </ref>
    <ref id="R53">
      <label>[53]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schindelin</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fiji: an open-source platform for biological-image analysis</article-title>
        <source>Nature methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>676</fpage>
        <pub-id pub-id-type="pmid">22743772</pub-id>
      </element-citation>
    </ref>
    <ref id="R54">
      <label>[54]</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Koltun</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Multi-scale context aggregation by dilated convolutions</article-title>
        <source>arXiv</source>
        <year>2015</year>
        <comment>preprint arXiv:1511.07122</comment>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="F1" orientation="portrait" position="float">
    <label>Figure 1</label>
    <caption>
      <title>Optical setup and approach overview.</title>
      <p><bold>a</bold> The light emitted from a fluorescent microscopic particle is collected by the objective and focused through the tube lens into an image at the intermediate image-plane. This plane is extended using a 4f system with a phase mask placed at the Fourier plane in between the two 4f lenses. <bold>b</bold> The implemented phase mask (using either a Liquid Crystal Spatial Light Modulator (LC-SLM) or fabricated fused-silica) dictates the shape of the PSF as function of the emitter’s axial position. <bold>c</bold> After training, our CNN receives a 2D low resolution image of overlapping PSFs and outputs a 3D high-resolution volume which is translated to a list of 3D localizations. Blue empty spheres denote simulated GT positions along the surface of an ellipsoid. Red spheres denote CNN detections. The Tetrapod PSF is depicted here, however the approach is applicable to any PSF, including those optimized by the net itself (<xref ref-type="fig" rid="F4">Fig. 4</xref>). Scale bars are 3 <italic>μ</italic>m.</p>
    </caption>
    <graphic xlink:href="EMS118464-f001"/>
  </fig>
  <fig id="F2" orientation="portrait" position="float">
    <label>Figure 2</label>
    <caption>
      <title>Comparison to MP.</title>
      <p><bold>a</bold> Performance comparison of a trained CNN (black) and the matching pursuit approach (red) in both detectability (Jaccard index) and in precision (Lateral\Axial RMSE). Matching of points was computed with a threshold distance of 150 nm using the Hungarian algorithm. Each data point is an average of <italic>n</italic> = 100 simulated images. Average standard deviation in Jaccard index was ≈ 6% for both methods, and average standard deviation in precision was ≈ 6 nm for the CNN, and ≈ 15 nm for MP. <bold>b</bold> Example of a simulated frame of density 0.124 <inline-formula><mml:math id="M2"><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mtext>emitters</mml:mtext></mml:mrow><mml:mrow><mml:mi>μ</mml:mi><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math></inline-formula> alongside 3D comparisons of the recovered positions by MP (middle) and by the CNN (right). Scale bar is 2 <italic>μ</italic>m.</p>
    </caption>
    <graphic xlink:href="EMS118464-f002"/>
  </fig>
  <fig id="F3" orientation="portrait" position="float">
    <label>Figure 3</label>
    <caption>
      <title>Super-resolution 3D imaging over a 4 <italic>μ</italic>m z-range.</title>
      <p><bold>a</bold> Representative experimental frame (top), and rendered frame from the 3D recovered positions by the CNN overlaid on top (bottom). Scale bar is 5 <italic>μ</italic>m. <bold>b</bold> Superresolved image of mitochondria spanning a ≈4 <italic>μ</italic>m z-range rendered as a 2D histogram where z is encoded by color. Scale bar is 5 <italic>μ</italic>m. <bold>c</bold> Zoom-in on white rectangle (i) in <bold>b</bold>. Scale bar is 0.5 <italic>μ</italic>m. <bold>d</bold> Relative intensity averaged along the shorter side of the white rectangle in <bold>c</bold>. <bold>e</bold> XZ cross-section of white rectangle (ii) in <bold>b</bold>. Scale bar is 0.5 <italic>μ</italic>m. <bold>f</bold> Relative intensity along the dashed white line in <bold>e</bold>. The experiment was repeated independently for <italic>n</italic> = 3 cells, twice analyzing 20K frames and once analyzing 10K frames all leading to similar performance.</p>
    </caption>
    <graphic xlink:href="EMS118464-f003"/>
  </fig>
  <fig id="F4" orientation="portrait" position="float">
    <label>Figure 4</label>
    <caption>
      <title>PSF learning for high density 3D imaging.</title>
      <p><bold>a</bold> Simulated 3D emitter positions are fed to the image formation model to simulate their low resolution CCD image (Encoding). Next, this image is fed to a CNN that tries to recover the simulated emitter positions (Decoding). The difference between the simulated positions and the positions recovered by the CNN is used to jointly optimize the phase mask at the Fourier plane, and the recovery CNN parameters. <bold>b</bold> Simulation of the learned PSF as function of the emitter axial position (left). 3D isosurface rendering of the learned PSF (right). <bold>c</bold> Example frame of density 0.197 <inline-formula><mml:math id="M3"><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mtext>emitters</mml:mtext></mml:mrow><mml:mrow><mml:mi>μ</mml:mi><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math></inline-formula> with the same simulated emitter positions, using the Tetrapod (left) and the learned PSF (right). <bold>d</bold> Jaccard index comparison between two CNNs with the same architecture, one trained to recover 3D positions from 2D images of Tetrapod PSF (black), and the second trained to recover 3D positions from 2D images of the learned PSF (orange). Each data point is an average of <italic>n</italic> = 100 simulated images. Average standard deviation was ≈ 6% for both PSFs. <bold>e-f</bold> Lateral and axial RMSE comparison between the same two CNNs from <bold>d</bold>. Average standard deviation was ≈ 6 nm for both PSFs. Scale bars are 3 <italic>μ</italic>m.</p>
    </caption>
    <graphic xlink:href="EMS118464-f004"/>
  </fig>
  <fig id="F5" orientation="portrait" position="float">
    <label>Figure 5</label>
    <caption>
      <title>Three dimensional imaging of telomeres in a single-snapshot.</title>
      <p><bold>a</bold> Schematic of imaging fixed U2OS cells with fluorescently labeled telomeres inside their nucleus. <bold>b</bold> Focus slice with the standard PSF inside a U2OS cell nucleus, obtained via a z-scan. The yellow rectangles mark the same emitter in all three orthogonal planes. <bold>c</bold> Example fit of the mean intensity in sequential axial slices used to estimate the approximate emitter axial position. <bold>d</bold> Experimental snapshot with the Tetrapod PSF (left), rendered image from the 3D recovered positions by the Tetrapod CNN (middle), and a 3D comparison of the recovered positions and the approximate experimental ground truth (right). <bold>e</bold> Experimental snapshot with the learned PSF (left), rendered image from the 3D recovered positions by the learned PSF CNN (middle), and a 3D comparison of the recovered positions and the approximate experimental ground truth (right). Scale bars are 3 <italic>μ</italic>m. The experiment was repeated independently for <italic>n</italic> = 10 U2OS cells all showing similar characteristics and performance.</p>
    </caption>
    <graphic xlink:href="EMS118464-f005"/>
  </fig>
  <fig id="F6" orientation="portrait" position="float">
    <label>Figure 6</label>
    <caption>
      <title>Volumetric tracking of telomeres in live MEF cells.</title>
      <p><bold>a</bold> 3D trajectories of tracked teloemres on top of the first experimental snapshot. White sticks mark the starting point, and color encodes time. XZ and YZ projections are plotted in gray. Scale bar is 2 <italic>μ</italic>m. <bold>b</bold> Example trajectory of a telomere (white box in <bold>a</bold>) with a large mean displacement. <bold>c</bold> Example trajectory of a telomere (white box in <bold>a</bold>) with a small mean displacement. <bold>d</bold> Mean Squared Displacement (MSD) of the trajectories in <bold>b</bold> and <bold>c</bold>. Shaded area marks one standard deviation. The experiment was repeated independently for <italic>n</italic> =10 MEF cells all showing similar characteristics and performance.</p>
    </caption>
    <graphic xlink:href="EMS118464-f006"/>
  </fig>
</floats-group>
