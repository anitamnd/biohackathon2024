<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6377781</article-id>
    <article-id pub-id-type="publisher-id">2657</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-019-2657-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Functional Heatmap: an automated and interactive pattern recognition tool to integrate time with multi-omics assays</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Williams</surname>
          <given-names>Joshua R.</given-names>
        </name>
        <address>
          <email>Joshua.williams2@nih.gov</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8289-1999</contrib-id>
        <name>
          <surname>Yang</surname>
          <given-names>Ruoting</given-names>
        </name>
        <address>
          <email>ruoting.yang.ctr@mail.mil</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Clifford</surname>
          <given-names>John L.</given-names>
        </name>
        <address>
          <email>john.l.clifford11.civ@mail.mil</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Watson</surname>
          <given-names>Daniel</given-names>
        </name>
        <address>
          <email>daniel.watson@nih.gov</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Campbell</surname>
          <given-names>Ross</given-names>
        </name>
        <address>
          <email>ross.campbell@nih.gov</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Getnet</surname>
          <given-names>Derese</given-names>
        </name>
        <address>
          <email>derese.getnet.mil@mail.mil</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kumar</surname>
          <given-names>Raina</given-names>
        </name>
        <address>
          <email>kumarr2@mail.nih.gov</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hammamieh</surname>
          <given-names>Rasha</given-names>
        </name>
        <address>
          <email>Rasha.hammamieh1.civ@mail.mil</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Jett</surname>
          <given-names>Marti</given-names>
        </name>
        <address>
          <email>marti.jett-tilton.civ@mail.mil</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0535 8394</institution-id><institution-id institution-id-type="GRID">grid.418021.e</institution-id><institution>Advanced Biomedical Computational Science, </institution><institution>Frederick National Laboratory for Cancer Research sponsored by the National Cancer Institute, </institution></institution-wrap>Frederick, MD 21702-5010 USA </aff>
      <aff id="Aff2"><label>2</label>Integrative Systems Biology Program, US Army Center for Environmental Health Research, Fort Detrick, Frederick, MD 21702-5010 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>2</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>15</day>
      <month>2</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>81</elocation-id>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>10</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>1</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Life science research is moving quickly towards large-scale experimental designs that are comprised of multiple tissues, time points, and samples. Omic time-series experiments offer answers to three big questions: what collective patterns do most analytes follow, which analytes follow an identical pattern or synchronize across multiple cohorts, and how do biological functions evolve over time. Existing tools fall short of robustly answering and visualizing all three questions in a unified interface.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Functional Heatmap offers time-series data visualization through a Master Panel page, and Combined page to answer each of the three time-series questions. It dissects the complex multi-omics time-series readouts into patterned clusters with associated biological functions. It allows users to identify a cascade of functional changes over a time variable. Inversely, Functional Heatmap can compare a pattern with specific biology respond to multiple experimental conditions. All analyses are interactive, searchable, and exportable in a form of heatmap, line-chart, or text, and the results are easy to share, maintain, and reproduce on the web platform.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Functional Heatmap is an automated and interactive tool that enables pattern recognition in time-series multi-omics assays. It significantly reduces the manual labour of pattern discovery and comparison by transferring statistical models into visual clues. The new pattern recognition feature will help researchers identify hidden trends driven by functional changes using multi-tissues/conditions on a time-series fashion from omic assays.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s12859-019-2657-0) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000182</institution-id>
            <institution>Medical Research and Materiel Command</institution>
          </institution-wrap>
        </funding-source>
        <award-id>09284002</award-id>
        <principal-award-recipient>
          <name>
            <surname>Jett</surname>
            <given-names>Marti</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par4">Many diagnostic and therapeutic studies are rapidly adopting a time-series experimental design including microarray gene expression and RNA-seq. The number of time-series transcriptome data sets have grown exponentially over the last decade, enabling researchers to identify the complete set of activated genes in a biological process, to infer rates of change or causal effects, and to model dynamic events in the cell [<xref ref-type="bibr" rid="CR1">1</xref>]. Researchers are particularly interested in transcriptomic patterns that correlate with clinical or experimental observations. However, the traditional hierarchical clustering heatmap [<xref ref-type="bibr" rid="CR2">2</xref>], k-means clustering [<xref ref-type="bibr" rid="CR3">3</xref>], or biclustering [<xref ref-type="bibr" rid="CR4">4</xref>] do not consider time dependent patterns innately, and thus are inadequate to search specific patterns that underpin mechanisms of biology. Few common statistical models are currently used to fit time series data on other observations. These tools include autoregressive models [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>], Bayesian approaches [<xref ref-type="bibr" rid="CR7">7</xref>], self-organizing maps [<xref ref-type="bibr" rid="CR8">8</xref>], and triclustering [<xref ref-type="bibr" rid="CR9">9</xref>]. All of these models result in global parent clusters of components, while many distinct subpatterns may be neglected or over fitted due to assumptions and inherent biases built in the statistical models of choice. For example, lower degree polynomial autoregressive models tend to have only few patterns while higher degree polynomial modes can lead to over fitting in short time-series. Phang et al. proposed a trajectory clustering method that defined gene profiles by the direction of change between adjacent time points, and concatenated the direction into a key [<xref ref-type="bibr" rid="CR10">10</xref>]. This trajectory method is an example of the symbolic representation method that has been popularly used in video streaming. The symbolic representation discretizes the profile and maps it to symbols, thus gene profiles can be represented as a concatenation of symbols. The discrete representation becomes very powerful in matching and comparing patterns. For example, we have sectional gene expression data, and the genes may be discretized into three levels of Fold Change (FC) between treatments and controls: “+” if FC ≥ 2; “-” if FC ≤ − 2; and “0” if − 2 &lt; FC &lt; 2. However, one can also design more levels or designate the slope of adjacent time points as symbols, and use different cutoffs for levels. Most researchers compute differentially expressed genes (DEGs) in terms of the t-test <italic>p</italic>-value at individual time points and compare the common DEGs across time. This is also an example of symbolic representation, such as up−/down-regulated DEGs that are “+” and “-”, respectively, and the rest are “0”. When all these characters are concatenated into a string, such as ‘++−’, then the string means a temporal profile ‘up’ ‘up’ ‘down’. We then group the genes by their profile and display in a heatmap. This heatmap can help researchers answer, but are not limited to, the following questions: 1) the collective trends (the patterns that most genes follow), 2) the consistent trends (the genes that exhibit identical patterns across multiple datasets), 3) the sequential trends (the cascade response of genes across time or across conditions) and 4) the stage trends (early-responsive or late-responsive genes). Answering these questions in multi-tissue and multi-condition time-series data becomes a multi-dimensional comparison problem (e.g., N-dimension Venn diagram) and it is difficult to trace genes with the same pattern of expression in current tools. In this paper, we developed a comprehensive interactive transcriptomics analysis and visualization tool, Functional Heatmap, based on the concept of symbolic representation. Functional Heatmap offers time-series data visualization through a Master Panel page and a Combined page to answer each of the multi-dimensional time-series questions. All analyses are interactive, searchable, and exportable in the form of heatmap, line-chart, and text, and the results are easy to share, maintain, and reproducible on the web platform. The pathway enrichment can also be conducted based on a merged pathway database that collapses highly similar pathways curated from different resources, including KEGG version 80 [<xref ref-type="bibr" rid="CR11">11</xref>], Wiki pathway [<xref ref-type="bibr" rid="CR12">12</xref>], Biocarta [<xref ref-type="bibr" rid="CR13">13</xref>], Reactome [<xref ref-type="bibr" rid="CR14">14</xref>], and GSEA [<xref ref-type="bibr" rid="CR15">15</xref>]. To avoid the potential bias of super large pathways such as cancer pathway and duplicate pathways curated from different resources, we trimmed and merged the pathway database before further pathway enrichment. First, we filtered out the super large pathways with thousands of genes. Next, we calculated the overlap rate (Eq. <xref rid="Equ1" ref-type="">1</xref>) between each pathway pair <italic>i</italic> and <italic>j</italic>,<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ Overlap\left(i,j\right)=\min \left({Length}_i,{Length}_j\right)/\left({Length}_i+{Length}_j-{Length}_{\left(i\cap j\right)}\right) $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mtext mathvariant="italic">Overlap</mml:mtext><mml:mfenced close=")" open="(" separators=","><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mo>min</mml:mo><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mtext mathvariant="italic">Length</mml:mtext><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mtext mathvariant="italic">Length</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mfenced><mml:mo>/</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mtext mathvariant="italic">Length</mml:mtext><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mtext mathvariant="italic">Length</mml:mtext><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mtext mathvariant="italic">Length</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:mi>i</mml:mi><mml:mo>∩</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12859_2019_2657_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
    <p id="Par5">Then the overlap rates were used as the distance matrix in hierarchical clustering with average linkage. All the tree under height 1.5 (roughly corresponding to 85% overlap rate) were merged into new pathways. The pathway enrichment was conducted by standard one-side hypergeometric test.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par6">Functional Heatmap is hosted online at <ext-link ext-link-type="uri" xlink:href="https://bioinfo-abcc.ncifcrf.gov/Heatmap">https://bioinfo-abcc.ncifcrf.gov/Heatmap</ext-link>/. It is written in PhP 5 and open-source JavaScript libraries D3.js and jquery.js. Since the Functional Heatmap software application is completely web-based, there are no installation requirements and no restrictions on operating systems. The software can be launched on any computer system that is connected to the internet and capable of running one of the current web browser applications with JavaScript capabilities enabled (i.e., Internet Explorer, Google Chrome, Mozilla Firefox, Safari). Mozilla Firefox or Google Chrome are recommended for use with the tool. Functional Heatmap efficiently incorporates robust clustering of genes based on expression profiles, heatmap visualizations, and annotation of like-groups together in one web-based tool as compared to other tools (Table <xref rid="Tab1" ref-type="table">1</xref>). Functional Heatmap supports abstraction of data multi-dimensionality by representing observations (e.g., individuals or time points) as a primary heatmap, and displaying relative correlations with a feature of interest. Each panel in the primary heatmap encapsulates a subpattern of the individual gene expression values unique to that data point (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a).<table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison to existing tools</p></caption><graphic xlink:href="12859_2019_2657_Tab1_HTML" id="MO3"/></table-wrap><fig id="Fig1"><label>Fig. 1</label><caption><p>Available display modes in Functional Heatmap. <bold>a</bold> Master panel page displays side-by-side visualizations of several heatmaps simultaneously. A given row can be selected to display pathway enrichment. <bold>b</bold> Combined page displays the primary heatmap of all the patterns combined on the left, with trends in the middle and the subpatterns of gene expression to the side. Below are the flipped subpatterns to display line charts of the data</p></caption><graphic xlink:href="12859_2019_2657_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par7">The users must provide an input file that contains ID, Entrez Gene (optional), Symbol (optional), <italic>P</italic>-value (optional), and fold change (FC) for each time point (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supporting Material User Manual, Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Sample input file S2). The users can select different significance cutoffs in the filter menu to down-select genes for the clustering analysis. The users also can apply other DEG analysis tools, such as EDGE [<xref ref-type="bibr" rid="CR16">16</xref>], and upload the DEG list the Functional Heatmap. Users may notice that there are many miscellaneous applications for Functional Heatmap besides genetics. These include multi-dimensional continuous time-series data from biological analytes (protein, metabolite, microbiome, etc.), financial data, or engineering data.</p>
    <sec id="Sec3">
      <title>Availability and requirements</title>
      <p id="Par8">Functional Heatmap is publicly available at <ext-link ext-link-type="uri" xlink:href="https://bioinfo-abcc.ncifcrf.gov/Heatmap/">https://bioinfo-abcc.ncifcrf.gov/Heatmap/</ext-link>. An illustrative video for Functional Heatmap is available in Additional file 3.</p>
      <p id="Par100">
        <media xlink:href="12859_2019_2657_MOESM3_ESM.mp4" id="MOESM3">
          <caption>
            <p><bold>Additional file 3:</bold> Illustrative video. (MP4 12800 kb)</p>
          </caption>
        </media>
      </p>
      <p id="Par9">Operating systems: Windows/OSX</p>
      <p id="Par10">Programming language: PHP and JavaScript</p>
      <p id="Par11">Browsers: IE 9, Firefox 31, Chrome 31, Safari 5.1, Opera 24, Opera Mini 8, iOS safari 7.1, Android Browser 4.4, or later.</p>
    </sec>
  </sec>
  <sec id="Sec4">
    <title>Results</title>
    <p id="Par12">Functional Heatmap offers two pages: 1) Master Panel page, and 2) Combined page. The Master Panel page (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a) displays the patterns from each file uploaded side by side. The Combined page (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b.) combines the contents of each file in the Master Panel and displays genes that follow the same pattern across cohorts. These clusters of genes behave the same and are synchronized independent of the conditions being evaluated. Patterns of association with a measured statistic (such as disease severity) can be visualized in the primary heatmap (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, far left panel), while the corresponding gene expression patterns can be simultaneously viewed on the Subpatterns heatmaps (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, far right 2 panels). Additionally, each pattern in the primary heatmap can be further broken down into trends and the heatmap trends for that pattern are displayed between the primary and subpattern heatmaps (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). The trends show the expression difference across time points. If there is a gene with fold changes 2, 3 and 4 at time points 1, 2, and 3, respectively, this would have an upward trend because the values are increasing. Conversely if there was a gene with fold changes 5, 4, 3 at time points 1, 2, and 3, respectively, this would have a downward trend. Both of these genes would be in the primary pattern of “up up up” or “+++” symbol, which is why this further breakdown is necessary to distinguish between the complex behavior of genes-of-interest in a more precise manner. By selecting a particular trend, such as the downward trend, the genes in the subpattern with a matching trend will be displayed. This allows the user to view the groups of trends that genes follow based on a particular higher level parent pattern and can filter out all other trends to see exactly which genes of the primary pattern follow a particular trend-of-interest. As illustrated in the example, such a capability allows the user to see particular sets of genes that may have had a spike in expression early on but were on a steady decline or back to a normal state after a given time point. The user can also toggle the subgroup heatmaps (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b) to show data in the form of a line chart of expression levels. The rest of the genes from the primary heatmap will still be visible as faded lines, when a trend is selected. A searchable list of genes comprised of each level of the heatmap is dynamically displayed when the user selects a pattern in the primary heatmap.</p>
    <p id="Par13">To further illustrate the capabilities of the Functional Heatmap as compared to traditional Venn diagrams, we present data from a study in rats which evaluated gene expression differences in the cingulate cortex across days 1, 3, 7, 14 and 21, post-injury in a chronic pain model. Here, one can use the traditional Venn diagram to show the overlap in DEG identities at the different time points in this tissue (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). However, the Venn diagram is neither able to stratify those genes into different expression patterns, nor can the identities of the genes be readily displayed. Using Functional Heatmap’s Combined page, we can see that the 72 DEGs common on days 1, 3, and 21 within the cingulate cortex can be further stratified into eight different combinations of up/down-regulation across the three selected time points (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). While a Venn diagram only shows the total number of DEGs in that group (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a), Functional Heatmap allows the user to discern trends within those 72 genes that may signify underlying biological functions. This function enables the user to dynamically select the type of overlap of interest such as genes that overlap across time, but are highly upregulated, and then return that particular subset of genes and pattern information to the user. The user can further see the identity and expression pattern of these overlapping genes (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c), as well as the corresponding line chart (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d), by selecting the flip heatmap option.<fig id="Fig2"><label>Fig. 2</label><caption><p>Viewing Overlap. <bold>a</bold> Traditional Venn diagrams showing the overlap between genes across time for two different tissues. The circled overlap is what is displayed in sections <bold>c</bold> and D.B) Primary patterns selected which have expression +/− on columns 1, 2 and 5. <bold>c</bold> Shows the gene expression heatmaps split out by tissue. <bold>d</bold> Line charts for the heatmaps above where each column is day 1, 3, 7, 14 and 21, respectively. The y-axis is log base 2-fold change values. Line colors represent the corresponding row selected in <bold>b</bold></p></caption><graphic xlink:href="12859_2019_2657_Fig2_HTML" id="MO2"/></fig></p>
    <p id="Par14">In addition, automatic pathway enrichment information for sets of genes is generated at each level of analysis, allowing users to efficiently interpret the selected patterns and view the biological processes underlying the data in greater detail and more quickly than with any previous tools. Data can be sorted in a variety of ways quickly and intuitively revealing patterns that would otherwise remain undetected using traditional static visualization tools. In additional, Functional Heatmap can consolidate differing numbers of data points with their mean. For example, suppose an experiment compares multiple mouse strains with differing numbers of time points for each mouse. Functional Heatmap can consolidate the time points by taking the mean values at the two time points seamlessly within the analysis, removing the need for extensive data preprocessing. Once each experiment has an identical number of time points, they can easily be compared.</p>
    <p id="Par15">Functional Heatmap application provides users with a robust automated, yet interactive, analytical framework that requires no prior computational expertise. Researchers and bioinformaticians alike can easily access a combination of powerful computational tools without having to develop a customized code to handle each use case. By intuitively answering the three most widely sought after questions from time-series experiments, Functional Heatmap allows scientists to rapidly and reproducibly extract biological meaning and create publication-quality figures from their time-series data simultaneously by using a single tool. Functional Heatmap represents a one-stop shop for analyzing high-throughput gene expression experiments. Furthermore, by encapsulating all the computational elements of the tool on a remote server, Functional Heatmap is universally compatible, and offers high-resolution and comprehensive gene expression analysis resources to any scientist with an internet connection regardless of their local resource availability. Finally, by alleviating the need for the user to write and maintain customized analysis scripts, Functional Heatmap presents a greatly simplified platform for reproducing large-scale data analyses. A detailed comparison to available time-series tools is listed in Table <xref rid="Tab1" ref-type="table">1</xref>.</p>
    <p id="Par16">In the future, Functional Heatmap will connect to the time-series network suite PanoromiX (<ext-link ext-link-type="uri" xlink:href="https://bioinfo-abcc.ncifcrf.gov/panormics/">https://bioinfo-abcc.ncifcrf.gov/panormics/</ext-link>), which allows the users to review dynamic changes of different functional modules in the progression of biological conditions. Furthermore, more statistical comparison and pattern recognition tools will be implemented to the back-end server.</p>
    <sec id="Sec5">
      <title>Example from an ongoing multidimensional study</title>
      <p id="Par17">The following provides an actual example of the use of Functional Heatmap to facilitate analysis of a multidimensional transcriptomic dataset. Recently, investigators at our institution, along with collaborators, have conducted a radiation dose response (1, 3, and 6 Gy [Gy] X-ray exposure) and time course (2 h, and 4, 7, 21, and 28 days post-exposure) experiment in mice, in an effort to gain detailed insight into the effects of ionizing radiation (IR) on skin. A comprehensive assessment of the transcriptome of the skin was conducted across all doses and time points, using DNA microarrays [manuscript under review]. The differentially expressed genes (DEGs) were identified as log fold mRNA expression values for each dose and time point, comparing irradiated to time-matched non-irradiated controls. The DEG lists (FC &gt; 2, <italic>P</italic> &gt; 0.05) for each dose were used to generate the Master Panel of expression patterns, and then combined to generate the primary heatmap of all patterns (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, depiction of Combined Page). The primary patterns were sorted by descending DEG number (Sort by count), and the most abundant pattern, containing 296 genes, was chosen for identification of trends (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). Genes fitting this pattern have a differential expression of less than 2-fold between irradiated and non-irradiated controls at every time point (black color) except for the last time point at day 28 (blue color), where expression was twofold or less in the irradiated group compared to controls. The first and second most abundant trends, containing 99 and 54 DEGs, respectively, were next chosen for assessment of subpatterns for each dose (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c). Interestingly, the 99 DEGs having the trend of + − + − -, were predominantly contained in the 3Gy and 6Gy treated skin groups, with only five genes matching this trend for the 1Gy treated skin. Conversely, the 54 DEGs having the trend of ++ − --, were predominantly present in the 1Gy treated skin (45 of the 54 DEGs). This comparison reveals a striking difference in expression trend between the 1Gy dose and the others. Further analysis of these specific DEGs, as well as others that are being identified using the Functional Heatmap, is ongoing. It is anticipated that this tool will both focus the effort and speed the discovery of the underlying biology and the corresponding gene networks that are most important for understanding the effects of varying doses of IR on skin over time.<fig id="Fig3"><label>Fig. 3</label><caption><p>Combined Page with Example. <bold>a</bold> The primary heatmap of all the patterns sorted by number of genes per pattern, highest to lowest. <bold>b</bold> The trends which come from the selected pattern in the Primary Patterns heatmap. The trends make up the 296 genes in the selected pattern. <bold>c</bold> The subpatterns filtered by the 99 and 54 genes from the trends. This allows the user to visualize which subpatterns of the 54 and 99 genes are associated with. This figure shows that most of the 54 genes showing a spike up then a drop are mostly from the 1Gy dose. The most abundant trend of 99 genes are mostly from the high 6Gy dose followed closely by the 3Gy dose</p></caption><graphic xlink:href="12859_2019_2657_Fig3_HTML" id="MO4"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Conclusions</title>
    <p id="Par18">Functional Heatmap is an automated and interactive tool to enhance pattern recognition on time-series multi-omics assays. It reduces the manual labour of pattern discovery and comparison by transferring statistical models into visual clues. The new pattern recognition will greatly help the researchers identify hidden trends of functional changes using multi-tissues/condition time-series omic assays. Researchers can easily access a combination of powerful computational tools without having to develop customized code to handle each use case.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional files</title>
    <sec id="Sec7">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2019_2657_MOESM1_ESM.docx">
            <label>Additional file 1:</label>
            <caption>
              <p>User Guide. (DOCX 3051 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2019_2657_MOESM2_ESM.txt">
            <label>Additional file 2:</label>
            <caption>
              <p>A sample input file Additional file. (TXT 42 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We very much appreciate Dr. Linda Brennan and Dr. David Jackson reviewed and improved the manuscript.</p>
    <sec id="FPar1">
      <title>Funding</title>
      <p id="Par19">This project has been funded in part or whole with federal funds from the Office of the Assistant Secretary of Defense for Health Affairs, the US Army Medical research and Materiel Command, and the National Cancer Institute, National Institutes of Health, under contract HHSN261200800001E and IAA number XCO15002–001-02001. The content of this publication does not necessarily reflect the views or policies of the Department of Health and Human Services and Department of the Army, nor does mention of trade names, commercial products, or organizations imply endorsement by the U.S. Government.</p>
    </sec>
    <sec id="FPar2" sec-type="data-availability">
      <title>Availability of data and materials</title>
      <p id="Par20">The source code is available at <ext-link ext-link-type="uri" xlink:href="https://bioinfo-abcc.ncifcrf.gov/Heatmap/">https://bioinfo-abcc.ncifcrf.gov/Heatmap/</ext-link>.</p>
    </sec>
    <sec id="FPar3">
      <title>Disclaimers</title>
      <p id="Par21">The views, opinions, and/or findings contained in this report are those of the authors and should not be construed as official Department of the Army position, policy, or decision, unless so designated by other official documentation. Citations of commercial organizations or trade names in this report do not constitute an official Department of the Army endorsement or approval of the products or services of these organizations.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>RY, JW, JC, DW DG, RC, RH, and MJ conceived and designed the research. RY, JW, and DW developed the platform, RY, JW, JC, RC, and DG wrote the paper. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="FPar4">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="FPar5">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="FPar6">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="FPar7">
      <title>Publisher’s Note</title>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bar-Joseph</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Gitter</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Simon</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Studying and modelling dynamic biological processes using time-series gene expression data</article-title>
        <source>Nat Rev Genet</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>8</issue>
        <fpage>552</fpage>
        <pub-id pub-id-type="doi">10.1038/nrg3244</pub-id>
        <pub-id pub-id-type="pmid">22805708</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eisen</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Spellman</surname>
            <given-names>PT</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>PO</given-names>
          </name>
          <name>
            <surname>Botstein</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Cluster analysis and display of genome-wide expression patterns</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>1998</year>
        <volume>95</volume>
        <issue>25</issue>
        <fpage>14863</fpage>
        <lpage>14868</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.95.25.14863</pub-id>
        <pub-id pub-id-type="pmid">9843981</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sinha</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Markatou</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A platform for processing expression of short time series (PESTS)</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>13</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-13</pub-id>
        <pub-id pub-id-type="pmid">21223570</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gonçalves</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Madeira</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Oliveira</surname>
            <given-names>AL</given-names>
          </name>
        </person-group>
        <article-title>BiGGEsTS: integrated environment for biclustering analysis of time series gene expression data</article-title>
        <source>BMC Res Notes</source>
        <year>2009</year>
        <volume>2</volume>
        <issue>1</issue>
        <fpage>124</fpage>
        <pub-id pub-id-type="doi">10.1186/1756-0500-2-124</pub-id>
        <pub-id pub-id-type="pmid">19583847</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ramoni</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Sebastiani</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kohane</surname>
            <given-names>IS</given-names>
          </name>
        </person-group>
        <article-title>Cluster analysis of gene expression dynamics</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2002</year>
        <volume>99</volume>
        <issue>14</issue>
        <fpage>9121</fpage>
        <lpage>9126</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.132656399</pub-id>
        <pub-id pub-id-type="pmid">12082179</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nueda</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Carbonell</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Medina</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Dopazo</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Conesa</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Serial expression analysis: a web tool for the analysis of serial gene expression data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <volume>38</volume>
        <issue>suppl_2</issue>
        <fpage>W239</fpage>
        <lpage>W245</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkq488</pub-id>
        <pub-id pub-id-type="pmid">20525784</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Angelini</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cutillo</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>De Canditiis</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mutarelli</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pensky</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>BATS: a Bayesian user-friendly software for analyzing time series microarray experiments</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>415</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-415</pub-id>
        <pub-id pub-id-type="pmid">18837969</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ernst</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bar-Joseph</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>STEM: a tool for the analysis of short time series gene expression data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2006</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>191</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-7-191</pub-id>
        <pub-id pub-id-type="pmid">16597342</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jung</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Jo</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ahn</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>TimesVector: a vectorized clustering approach to the analysis of time series transcriptome data from multiple phenotypes</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <issue>23</issue>
        <fpage>3827</fpage>
        <lpage>3835</lpage>
        <?supplied-pmid 28096084?>
        <pub-id pub-id-type="pmid">28096084</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Phang TL, Neville MC, Rudolph M, Hunter L. Trajectory clustering: a non-parametric method for grouping gene expression time courses, with applications to mammary development. Pac Symp Biocomput. 2003;(5):351–62.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kanehisa</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Goto</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>KEGG: Kyoto encyclopedia of genes and genomes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2000</year>
        <volume>28</volume>
        <issue>1</issue>
        <fpage>27</fpage>
        <lpage>30</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/28.1.27</pub-id>
        <pub-id pub-id-type="pmid">10592173</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Slenter</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Kutmon</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hanspers</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Riutta</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Windsor</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nunes</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Mélius</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cirillo</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Coort</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Digles</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>WikiPathways: a multifaceted pathway database bridging metabolomics to other omics research</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>46</volume>
        <issue>D1</issue>
        <fpage>D661</fpage>
        <lpage>D667</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx1064</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nishimura</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>BioCarta</article-title>
        <source>Biotech Softw Internet Rep</source>
        <year>2001</year>
        <volume>2</volume>
        <issue>3</issue>
        <fpage>117</fpage>
        <lpage>120</lpage>
        <pub-id pub-id-type="doi">10.1089/152791601750294344</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Joshi-Tope</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gillespie</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vastrik</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>D'Eustachio</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>de Bono</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Jassal</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gopinath</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Matthews</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Reactome: a knowledgebase of biological pathways</article-title>
        <source>Nucleic Acids Res</source>
        <year>2005</year>
        <volume>33</volume>
        <issue>suppl_1</issue>
        <fpage>D428</fpage>
        <lpage>D432</lpage>
        <?supplied-pmid 15608231?>
        <pub-id pub-id-type="pmid">15608231</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Subramanian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tamayo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mootha</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>Mukherjee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ebert</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Gillette</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Paulovich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pomeroy</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Golub</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
        </person-group>
        <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2005</year>
        <volume>102</volume>
        <issue>43</issue>
        <fpage>15545</fpage>
        <lpage>15550</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0506580102</pub-id>
        <pub-id pub-id-type="pmid">16199517</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leek</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Monsen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Dabney</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>EDGE: extraction and analysis of differential gene expression</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <issue>4</issue>
        <fpage>507</fpage>
        <lpage>508</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btk005</pub-id>
        <pub-id pub-id-type="pmid">16357033</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
