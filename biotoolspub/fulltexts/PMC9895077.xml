<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id>
    <journal-title-group>
      <journal-title>Scientific Reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-2322</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9895077</article-id>
    <article-id pub-id-type="pmid">36732615</article-id>
    <article-id pub-id-type="publisher-id">29073</article-id>
    <article-id pub-id-type="doi">10.1038/s41598-023-29073-2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>An open source Python library for environmental isotopic modelling</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Hassanzadeh</surname>
          <given-names>Ashkan</given-names>
        </name>
        <address>
          <email>ashkan.hassanzadeh@csic.es</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Valdivielso</surname>
          <given-names>Sonia</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vázquez-Suñé</surname>
          <given-names>Enric</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Criollo</surname>
          <given-names>Rotman</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Corbella</surname>
          <given-names>Mercè</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.420247.7</institution-id><institution-id institution-id-type="ISNI">0000 0004 1762 9198</institution-id><institution>Institute of Environmental Assessment and Water Research (IDAEA/CSIC), </institution></institution-wrap>C/ Jordi Girona 18-26, 08034 Barcelona, Spain </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.7080.f</institution-id><institution-id institution-id-type="ISNI">0000 0001 2296 0625</institution-id><institution>Departament de Geologia, </institution><institution>Universitat Autònoma de Barcelona (UAB), </institution></institution-wrap>Edificis C, Bellaterra, 08193 Barcelona, Spain </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.466857.e</institution-id><institution-id institution-id-type="ISNI">0000 0000 8518 7126</institution-id><institution>Mediterranean Institute for Advanced Studies (IMEDEA, UIB-CSIC), </institution></institution-wrap>07190 Esporles, Spain </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>2</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>2</day>
      <month>2</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>13</volume>
    <elocation-id>1895</elocation-id>
    <history>
      <date date-type="received">
        <day>7</day>
        <month>9</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>1</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Isotopic composition modelling is a key aspect in many environmental studies. This work presents Isocompy, an open source Python library that estimates isotopic compositions through machine learning algorithms with user-defined variables. Isocompy includes dataset preprocessing, outlier detection, statistical analysis, feature selection, model validation and calibration and postprocessing. This tool has the flexibility to operate with discontinuous inputs in time and space. The automatic decision-making procedures are knitted in different stages of the algorithm, although it is possible to manually complete each step. The extensive output reports, figures and maps generated by Isocompy facilitate the comprehension of stable water isotope studies. The functionality of Isocompy is demonstrated with an application example involving the meteorological features and isotopic composition of precipitation in N Chile, which are compared with the results produced in previous studies. In essence, Isocompy offers an open source foundation for isotopic studies that ensures reproducible research in environmental fields.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Hydrogeology</kwd>
      <kwd>Hydrology</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Severo Ochoa</institution>
        </funding-source>
        <award-id>CEX2018-000794-S</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Margalida Comas postdoctoral fellowship programme</institution>
        </funding-source>
        <award-id>PD/036/2020</award-id>
        <principal-award-recipient>
          <name>
            <surname>Criollo</surname>
            <given-names>Rotman</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par2">Water isotopic composition is of paramount importance for decision making in many fields of study, including environmental resource management<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. The stable water isotopes <sup>18</sup>O and <sup>2</sup>H are indicators of diverse aspects of the hydrological cycle. δ<sup>18</sup>O and δ<sup>2</sup>H measurements in precipitation are utilized in different meteorological and hydrological studies to identify the origin of precipitation, recognize local effects in water cycle studies, define the relative shares of water with different origins in a water body, describe aquifer recharging and characterization process and investigate various aspects of runoff and stream flow generation. All these features are essential for the optimal and sustainable management of water resources<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR3">3</xref></sup>.</p>
    <p id="Par3">The isotopic composition of rainwater is influenced by different physical variables and processes: temperature; pressure; humidity during condensation (to generate precipitation)<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR5">5</xref></sup>; mixtures of air masses with distinct origins<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>; the isotopic composition of the seawater from which air moisture condenses<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>; in-cloud microphysical processes<sup><xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR12">12</xref></sup>; the moisture conditions below clouds and the partial evaporation of precipitation along the path between clouds and the ground<sup><xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR15">15</xref></sup>; and the mixture of recycled precipitation from evapotranspiration over continents<sup><xref ref-type="bibr" rid="CR16">16</xref>–<xref ref-type="bibr" rid="CR18">18</xref></sup>. Therefore, detailed isotopic signature studies are used to discern these effects in any study area.</p>
    <p id="Par4">A linear relationship called the global meteoric water line (GMWL) is present between the δ<sup>18</sup>O and δ<sup>2</sup>H of meteoric water at the global scale, and this relationship is defined as δ<sup>18</sup>O = 8*δ<sup>2</sup>H + 10<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>. The characteristic isotopic signature of meteoric water in a particular region is caused by the various temperatures, relative humidity values, amounts of precipitation, latitudes and landmass proximities. The water molecules components (O, H) undergo isotope fractionation during phase transitions and the ratios of heavy versus light isotopes acts as a traceable feature of the physical processes<sup><xref ref-type="bibr" rid="CR19">19</xref>–<xref ref-type="bibr" rid="CR23">23</xref></sup>.</p>
    <p id="Par5">Two common approaches are available for studying the global distribution of the isotopic composition of precipitation: isotope-enabled atmospheric general circulation models (IGCMs) and regression statistics-based approaches<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>. IGCMs are numerical models that improve our understanding and reveal valuable information of the atmosphere by considering different physical processes (diffusion, advection, convection, etc.), including the physics of water isotopes (e.g., isotope fractionation, evaporation, condensation, among others)<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>. Computational power and numerical modelling advancements in recent decades have played an important role in the development of IGCMs, as they have resulted in a variety of models at different regional scales with diverse levels of complexity, such as CAM5<sup><xref ref-type="bibr" rid="CR26">26</xref>–<xref ref-type="bibr" rid="CR28">28</xref></sup>, ECHAM5<sup><xref ref-type="bibr" rid="CR29">29</xref>,<xref ref-type="bibr" rid="CR30">30</xref></sup>, MIROC<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> and LMDZ4<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>. IGCMs are usually complex, time consuming and computationally demanding simulations. On the other hand, regression statistics-based models are generally useful in identifying the possible processes suffered by water samples based on their isotopic signature. Statistical models are simple to apply and are more intuitive to interpret. Consequently, they are used as stand-alone or complementary–preliminary tools for interpreting IGCM models and evaluating their results<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>.</p>
    <p id="Par6">Statistical models exhibit some shortcomings that can limit their usage or lower their precision. First, in contrast with IGCMs, there is no specific standalone tool that allows the user to determine the input features and databases for developing a statistical isotopic model. Second, some study areas possess scarce isotopic data or different types of isotopic samples (individual rain events versus accumulated events) and/or contain meteorological measurements with diverse spatiotemporal resolutions. This may limit the usage of the available variables that can affect statistical isotopic models<sup><xref ref-type="bibr" rid="CR24">24</xref>,<xref ref-type="bibr" rid="CR33">33</xref></sup>. Third, most statistical regression studies are based on simple linear models, which can neglect some of the underlying processes of the water isotopic signature by not exploring the more complex relationship between the variables. The use of both standard and novel mathematical approaches can explore these possibilities and could potentially result in discovering unforeseen aspects<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>. Fourth, the use of statistical analyses can be time- and effort-consuming, depending on the type and number of models needed or the output desired (meteoric water lines, estimation graphs, detailed maps, etc.). Automatically creating an extensive output could prevent systematic errors without compromising the possibility to carefully examine the significance and relevance of the inputs and results by the user, if it is accompanied by the informative reports of each underlying processes.</p>
    <p id="Par7">To address these shortcomings, we present Isocompy, an open source, Python-based, multistage isotopic composition analysis and modelling library. The main objectives of Isocompy are (i) to introduce an open source framework that integrates the diverse steps of stable statistical isotope modelling in a dedicated library; (ii) to incorporate novel data management, statistical analysis and machine learning regression methods accompanied by decision-making algorithms; (iii) to exhibit flexibility regarding the available input data and function with measurements that are scarce and discontinuous in time and heterogeneous in space.; (iv) to be intuitive and user friendly, which speeds up the process of forming an isotope model; and (v) to generate reports and figures in every step if needed so that the user can understand the ongoing procedure.</p>
    <p id="Par8">In the following sections, we describe the methods used (“<xref rid="Sec2" ref-type="sec">Methods</xref>”) and the different aspects of Isocompy (“<xref rid="Sec3" ref-type="sec">Under the hood of Isocompy</xref>”), and we demonstrate its functionality by applying it to an example involving Salar de Atacama (Chile) (“<xref rid="Sec11" ref-type="sec">Application to the example of Salar de Atacama</xref>”).</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <p id="Par9">To create the Isocompy algorithm, bibliographical research is performed to define the innovative capabilities that would be needed for isotopic modelling. The workflow of the program is then chosen accordingly. In this section, we discuss the necessity of the capabilities that are included in Isocompy and the methodology used in the proposed workflow to form the isotopic precipitation composition models with respect to the aforementioned objectives.</p>
    <p id="Par10">Various input parameters can affect the isotopic composition of rainwater. Meteorological (precipitation, relative humidity, temperature, etc.) and geospatial parameters are two groups of input data that are widely used in isotopic modelling<sup><xref ref-type="bibr" rid="CR35">35</xref>–<xref ref-type="bibr" rid="CR41">41</xref></sup>. However, other information may be needed, such as sea surface temperatures, atmospheric pressures, outgoing longwave radiation (OLR) values<sup><xref ref-type="bibr" rid="CR10">10</xref>,<xref ref-type="bibr" rid="CR42">42</xref>–<xref ref-type="bibr" rid="CR45">45</xref></sup>, features derived from air mass trajectories<sup><xref ref-type="bibr" rid="CR39">39</xref>,<xref ref-type="bibr" rid="CR46">46</xref></sup> or features resulting from reanalysis (such as wind components, dewpoint temperatures, and evaporation values)<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>. Therefore, the workflow must allow the user to choose the nature of the input features. Moreover, in cases where the database contains unwanted data for the ongoing study, it can be modified easily.</p>
    <p id="Par11">Furthermore, some industrial and scientific projects are carried out in regions with limited or discontinuous spatiotemporal data. For example, in some cases, the meteorological stations are continuously maintained, which results in the production of a long-term dataset. Conversely, isotopic measurements are often sparse in time and poorly distributed in space and are not necessarily measured at the same position as other input parameters (e.g., weather parameters); this is mostly due to the complexity and costs of the analyses. Figure <xref rid="Fig1" ref-type="fig">1</xref>(1) illustrates an imaginary example of two independent parameters (red crosses and blue circles) that potentially affect the isotopic measurements (green triangles), but since they are not available at the same location, a one-to-one relation between the features cannot be made to perform regression. Moreover, the densities of the available data are different among the red crosses, blue circles and green triangles. To obtain of the features at the green triangle positions, first, regression models for the red and blue points, which are variables dependent on other features (in this case, geospatial features), must be generated. Figure <xref rid="Fig1" ref-type="fig">1</xref>(2,3) illustrate the estimations of each red and blue feature obtained at the green triangle positions derived from two separate regression models (F1 and F2, respectively).<fig id="Fig1"><label>Figure 1</label><caption><p>Workflow scheme for estimating isotopic values by using two independent parameters that are available in different locations than the isotopic measurements. Blue circles and red crosses represent two independent features that are potential candidates affecting the green triangles (isotopic precipitation composition). (1) Imaginary map of all available points. Green triangles are points with field isotopic measurements, and red crosses and blue circles are two independent parameter measurements. (2, 3) Estimation of the red and blue parameters from the constructed F1 and F2 regression models at the location points where isotopic data are available. (4) As a result of the algorithms, in the yellow diamonds, estimated red and blue data and measured green (isotopic composition) data are available.</p></caption><graphic xlink:href="41598_2023_29073_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par12">In the yellow diamonds in Fig. <xref rid="Fig1" ref-type="fig">1</xref>(4), the calculated values of the red and blue parameters (estimated from F1 and F2) and the corresponding green measurements are available, which makes it possible to construct a regression model with red and blue parameters as independent variables and the green parameter as a dependent variable. By using this model, it is possible to create a map of the green parameter (isotopic composition).</p>
    <p id="Par13">Data can also vary within a time window. Utilizing the example in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, let us assume that a continuous and dense amount of data are available for the blue parameter in a specific month during ten consecutive years. However, in the red crosses, data are available in the same month for six years. To overcome the limitations derived from different measurement frequencies and time windows, one solution is to average the 10- and 6-year measurements in the blue and red points, respectively, to obtain a single set of data for each feature in each location. Although averaging the measurements may result in a loss of information while producing less precision and higher model uncertainty, these effects would also occur with other data treatment techniques, such as filling the gaps in data series. The final workflow must also account for different parameters that are measured directly alongside the isotopic water composition or estimated via other methods, such as features derived from reanalysis<sup><xref ref-type="bibr" rid="CR48">48</xref>,<xref ref-type="bibr" rid="CR49">49</xref></sup>. Another important aspect of the workflow is to analyse the degrees of influence of suspected features on the dependent variable. Considering that the goal is to produce a workflow that is simple yet precise, an automatic statistical analysis procedure based on multicollinearity examination and a feature selection algorithm must be crucial parts of the workflow.</p>
    <p id="Par14">The fact that the relations between earth science variables may be linear or nonlinear suggests the capability to apply different regression methods in the workflow. The regressions must be accompanied by calibration and validation procedures to find the regression method with the highest estimation power that avoids common modelling errors such as overfitting. A total of eight regression models are considered in this study: Elasticnet<sup><xref ref-type="bibr" rid="CR50">50</xref></sup>, Bayesian ridge regression<sup><xref ref-type="bibr" rid="CR51">51</xref></sup>, least-angle regression<sup><xref ref-type="bibr" rid="CR52">52</xref></sup>, Bayesian automatic relevance determination (ARD)<sup><xref ref-type="bibr" rid="CR53">53</xref></sup> and orthogonal matching pursuit<sup><xref ref-type="bibr" rid="CR54">54</xref></sup>, support vector regression<sup><xref ref-type="bibr" rid="CR55">55</xref></sup>, a random forest<sup><xref ref-type="bibr" rid="CR56">56</xref></sup>, and a multilayer perceptron<sup><xref ref-type="bibr" rid="CR57">57</xref></sup>. Since some of these methods are sensitive to the data scale, all inputs are standardized before applying the regressions. Hyperparameters are parameters of machine learning methods whose values control the learning process<sup><xref ref-type="bibr" rid="CR58">58</xref></sup>. The brute-force hyperparameter search algorithm is used to obtain a suitable set of hyperparameters<sup><xref ref-type="bibr" rid="CR59">59</xref></sup>; it is optional to fit regression methods to the transformed <italic>ln</italic>(<italic>1</italic> + <italic>x</italic>) of the input data alongside the original data which can potentially result in a better model in case the features have log-normal distributions. Other data transformation techniques can be applied on the input data by the user.</p>
    <p id="Par15">In Elasticnet, both L1 and L2 regularization terms are used to avoid overfitting. The Lasso (L1) and ridge (L2) regression methods are specific forms of Elasticnet regression, where the former adds the absolute value of the magnitude and the latter adds the squared magnitude as a regularization term to the cost function. Lasso and ridge regressions are achieved by introducing an L2 to L1 ratios equal to zero and one, respectively. A more detailed description of this method can be found in<sup><xref ref-type="bibr" rid="CR50">50</xref></sup>.</p>
    <p id="Par16">The orthogonal matching pursuit method constrains the number of zero coefficients. Its residuals are calculated by using an orthogonal n-dimensional projection, which assumes, similar to independent variables, that the dependent variable can contain measurement errors<sup><xref ref-type="bibr" rid="CR54">54</xref></sup>.</p>
    <p id="Par17">Least-angle regression is a stepwise linear regression method that moves in the direction of the most correlated feature in each step. This method is beneficial when the number of features is higher than the number of samples. Least-angle regression is sensitive to outlier data<sup><xref ref-type="bibr" rid="CR52">52</xref></sup>.</p>
    <p id="Par18">The Bayesian ridge and Bayesian automatic relevance determination methods (also known as sparse Bayesian learning and relevance vector machine regression, respectively) form probabilistic models that include regularization parameters that are tuned according to the available data instead of being defined prior to regression<sup><xref ref-type="bibr" rid="CR51">51</xref></sup>.</p>
    <p id="Par19">Random forest regression is a method based on the average of randomized independent decision tree estimator outputs. The main concept of this method is that the integrated final estimator may produce better results than any of the single decision trees since combining them decreases the standard deviation of the estimates<sup><xref ref-type="bibr" rid="CR56">56</xref></sup>.</p>
    <p id="Par20">Support vector machines are versatile supervised learning methods that are used in various environmental science fields<sup><xref ref-type="bibr" rid="CR60">60</xref></sup>. They can be used in high-dimensional environments and are flexible depending on the chosen seed functions. It must be taken into account that support vector regression can be computationally demanding<sup><xref ref-type="bibr" rid="CR61">61</xref></sup>. Moreover, if the number of features is higher than the number of samples, the seed functions must be selected in a way that avoids overfitting<sup><xref ref-type="bibr" rid="CR62">62</xref></sup>.</p>
    <p id="Par21">Neural networks have proven to be effective estimation techniques in various branches of science. Multilayer perceptron regression is a supervised learning method that uses L2 regularization to avoid overfitting the weights. An MLP uses a backpropagation technique. The ability to determine the number of hidden layers, the size of each layer and diverse type of activation functions mark an MLP as a flexible technique<sup><xref ref-type="bibr" rid="CR57">57</xref></sup>. However, an MLP is complex during the process of choosing the correct estimator hyperparameters.</p>
  </sec>
  <sec id="Sec3">
    <title>Under the hood of Isocompy</title>
    <sec id="Sec4">
      <title>Isocompy workflow</title>
      <p id="Par22">Considering the abovementioned aspects of isotopic composition modelling, Fig. <xref rid="Fig2" ref-type="fig">2</xref> illustrates the general scheme of our proposed workflow. It consists of data preparation and two main stages. The independent variables are introduced in the data preparation step. The goal of the first stage is to estimate the independent parameters that affect the isotopic composition model in the same space–time framework as the empirical data. The results of the first stage, accompanied by the empirical data, are incorporated into the second stage to obtain δ<sup>18</sup>O and δ<sup>2</sup>H models. Stage one of the workflow begins with a statistical analysis of the independent variables that are introduced in the data preparation step to determine their degrees of influence on the dependent variable and select the substantial variables for the regression model. The regressions are applied, and the most calibrated model is selected. Then, the variables that influence the water isotopes are estimated in the same time and space as the isotopic measurements. By preparing the data from three source groups [estimated variable data, measured variable data and measured isotopic data, (1.4, c,b in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, respectively)], it is possible to obtain isotopic models in stage two. Again, a statistical analysis leads to the extraction of the substantial independent variables over which the regressions will be applied to select the best model. Once the models are available, the isotopic composition values can be estimated. The underlying sections of each stage are explained below.<fig id="Fig2"><label>Figure 2</label><caption><p>Scheme of the Isocompy workflow utilized to design the Isocompy architecture. It consists of data preparation (red boxes) and two main stages. Each stage includes statistical analysis (yellow boxes 1.1 and 2.1), regression (green boxes 1.2 and 2.2), model selection (violet boxes 1.3 and 2.3) and feature estimation steps (blue boxes 1.4 and 2.4).</p></caption><graphic xlink:href="41598_2023_29073_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par23">Data preparation (the red a, b and c boxes in Fig. <xref rid="Fig2" ref-type="fig">2</xref>) is a key step that defines many major properties of the constructed model. Box a in Fig. <xref rid="Fig2" ref-type="fig">2</xref> shows the input features named indirect features since they are not measured with isotopic values; box b represents the isotopic input measurements, and box c illustrates other features measured directly with isotopic values (direct features). In the data preparation step, different aspects of the model must be determined by the user.<list list-type="bullet"><list-item><p id="Par24">The dependent and independent variables.</p></list-item><list-item><p id="Par25">The temporal window of the input measurement choice.</p></list-item><list-item><p id="Par26">Input filtration based on specific time properties, if needed (El Niño or La Niña Southern Oscillation).</p></list-item><list-item><p id="Par27">Outlier removal based on diverse methods, if needed.</p></list-item><list-item><p id="Par28">The data averaging technique.</p></list-item><list-item><p id="Par29">Brute-force searching hyperparameter definition.</p></list-item></list></p>
      <p id="Par30">The statistical analysis step (yellow boxes in Fig. <xref rid="Fig2" ref-type="fig">2</xref>) allows the algorithm to select the most considerable features to be used afterwards in the regression models. Feature selection is crucial in environmental models that normally use spatial features as inputs since autocorrelations in data may distort the estimation power of the model<sup><xref ref-type="bibr" rid="CR63">63</xref></sup>. As shown in the yellow boxes in Fig. <xref rid="Fig3" ref-type="fig">3</xref>, in this stage, the algorithm calculates the p values determined by one-tailed F-test on centred data, mutual information<sup><xref ref-type="bibr" rid="CR64">64</xref></sup>, correlation coefficients and variation inflation factors (VIFs) of the variables. The p values and mutual information help to determine the linear and nonlinear relationships between parameters and evaluate the significance of the parameters<sup><xref ref-type="bibr" rid="CR65">65</xref>,<xref ref-type="bibr" rid="CR66">66</xref></sup>. The VIFs and correlation coefficients are useful for detecting multicollinearity.<fig id="Fig3"><label>Figure 3</label><caption><p>Yellow, green and violet boxes show the techniques used in the statistical analysis step, the regression methods available in Isocompy and the implemented techniques in the model selection steps, respectively.</p></caption><graphic xlink:href="41598_2023_29073_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par31">Since one of the main objectives of the algorithm is to facilitate and speed up the model generation process, the feature selection procedure that is derived from the statistical analysis can be performed automatically or controlled by user-defined or predefined values. In the automatic mode, the algorithm first uses the VIFs, correlation coefficients and optional pairs of features defined by the user to remove the features with multicollinearity effects that higher than a defined threshold. Then, p values are used to select the statistically significant features, based on the user-defined alpha level.</p>
      <p id="Par32">It is important to mention that since the F-test assumes that the features are distributed normally, the user have to check the normality of the features that are chosen as important features in VIF test.</p>
      <p id="Par33">The regression steps are performed in two stages of the algorithm (green boxes in Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Various linear and nonlinear regression methods are available, as shown in the green boxes in Fig. <xref rid="Fig3" ref-type="fig">3</xref>, which can be selected by the user based on the nature of the given study or computational power, among other strategies. The regression methods implemented in Isocompy are described in detail in “Methods”. Nevertheless, it is worth mentioning that users with coding knowledge can add other methods of their own.</p>
      <p id="Par34">Model selection steps are also implemented in two stages of the algorithm. To find the best model, the algorithm includes and combines cross validation, brute force hyperparameter searching, R-squared fitness and goodness of fit to the GMWL or local meteoric water line (LMWL), as shown in the violet boxes in Fig. <xref rid="Fig3" ref-type="fig">3</xref>.</p>
      <p id="Par35">Finally, the estimation step is performed in the first and second stages, as illustrated in the blue 1.4 and 2.4 boxes of Fig. <xref rid="Fig2" ref-type="fig">2</xref>, by determining the substantial features determined in previous steps. This workflow ensures the flexibility of the input features, time steps and geospatial scale and, at the same time, promotes and speeds up the model generation process in an integrated algorithm.</p>
    </sec>
    <sec id="Sec5">
      <title>Isocompy architecture</title>
      <p id="Par36">The Isocompy tool examines the relationship among the input variables with various linear and nonlinear regression methods, performs a statistical analysis and dimensionality reduction, and chooses the best available regression method and its respective parameters via calibration and evaluation techniques. This is done by implementing novel machine learning, data management and statistical analysis libraries such as pandas<sup><xref ref-type="bibr" rid="CR67">67</xref></sup>, geopandas<sup><xref ref-type="bibr" rid="CR68">68</xref></sup>, numpy<sup><xref ref-type="bibr" rid="CR69">69</xref></sup>, pylr2<sup><xref ref-type="bibr" rid="CR70">70</xref></sup>, statsmodels<sup><xref ref-type="bibr" rid="CR71">71</xref></sup> and scikit_learn<sup><xref ref-type="bibr" rid="CR72">72</xref></sup>. Isocompy generates extensive reports alongside figures and maps to facilitate the procedure of statistical water isotope modelling and support the user in interpreting and evaluating the results.</p>
      <p id="Par37">In this section, we describe the architecture of the underlying components and the outputs of Isocompy. It is built into six classes and 18 methods, as shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. A list of the Python libraries used in Isocompy can be found in “<xref rid="Sec17" ref-type="sec">Isocompy library information</xref>”.<fig id="Fig4"><label>Figure 4</label><caption><p>The Isocompy algorithm architecture. It contains 6 classes and 18 methods.</p></caption><graphic xlink:href="41598_2023_29073_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>Preprocessing</title>
      <p id="Par38">The <italic>preprocess</italic> class holds the data preparation step (red frames in Fig. <xref rid="Fig4" ref-type="fig">4</xref>), whose inputs are pandas dataframes. This class has the ability to filter outliers based on upper and lower limit percentiles or modified IQR functions<sup><xref ref-type="bibr" rid="CR73">73</xref>,<xref ref-type="bibr" rid="CR74">74</xref></sup>. Outlier detection can be performed with or without zero values included in the data removal procedure. This is possible since there are geospatial states where zero values can result in unreasonable outlier filtration (e.g., removing the 5% lowest precipitation values from an arid zone with very few precipitation events). Data averaging can be performed based on arithmetic or geometric averaging. It is also possible to define specific time periods and limit the outputs to these episodes. Another decisive feature of <italic>preprocess</italic> is that the user specifies the brute-force search hyperparameters of the corresponding regression models. This selection is closely dependent on the format (i.e., volume and quality of the data) and correlation of the dataset<sup><xref ref-type="bibr" rid="CR75">75</xref></sup>. Therefore, it is crucial that the user have an experienced-based, focused, theoretically sound, and practical search approach. Nevertheless, the default values which are described in detail in “Isocompy library information”, could be useful for dealing with complex datasets in our experience.</p>
      <p id="Par39">The <italic>model</italic> class (green frames in Fig. <xref rid="Fig4" ref-type="fig">4</xref>) is designed to handle the statistical analysis, feature selection, model regression and model selection procedures in the first and second stages; the flowchart of this stage is shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>, and it can be performed manually or automatically. The statistical analysis and feature selection parameters are defined as arguments of the class. In the manual mode, the statistical analysis data are shown, and the user must choose the considerable features. In the automatic mode, Isocompy finds the parameters with the most influence on the dependent variable by comparing their correlation coefficients and VIFs with predefined thresholds in an iterative process. However, the usage of correlation coefficients, VIFs or threshold values can also be defined by the user. The output features of this statistical analysis and feature selection step (Fig. <xref rid="Fig5" ref-type="fig">5</xref>) feed the regression models.<fig id="Fig5"><label>Figure 5</label><caption><p>Feature selection flowchart of the model class. Red lines indicate false arguments.</p></caption><graphic xlink:href="41598_2023_29073_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par40">Figure <xref rid="Fig6" ref-type="fig">6</xref> illustrates the workflow of the regression modelling, model evaluation and calibration processes that result in selecting the best model. In each regression method, all combinations of hyperparameters are defined. For each combination, the random k-fold cross-validation technique is used to avoid overfitting. The score of a determined hyperparameter set is defined as the average score of the k models. The selected set of hyperparameters for each model is defined as the one with the highest average score. The best model among different regression methods can be selected based on preferred criteria. In the first stage, the best models are selected based on higher R-squared values, whereas in the second stage, the best model can also be selected based on three different criteria: the smallest point-to-point estimation-observation distance, the pair of models with the most similar results to the LMWL or the pair of models with the most similar results to any defined line between the water isotopes. The predefined arguments for this line are eight and ten coefficient and intercept values, respectively, that represent the GMWL. To test the different options available for selecting the best model in the second stage, it is possible to change the criteria and generate corresponding outputs.<fig id="Fig6"><label>Figure 6</label><caption><p>Workflow of the model regression, model validation, model calibration and best model selection processes. Black dots show that these processes are performed for each regression method selected.</p></caption><graphic xlink:href="41598_2023_29073_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par41">Isocompy generates reports that include the details of all the executed models and the selected models with their R-squared values, adjusted R-squared values, VIF values, correlation coefficients, mutual information, chosen input features and sets of hyperparameters. For the chosen regression models, Isocompy also reports the cross validation averages and standard deviations obtained on the training and test data to evaluate the model estimation uncertainties.</p>
    </sec>
    <sec id="Sec7">
      <title>Model evaluation</title>
      <p id="Par42">The <italic>evaluation</italic> class follows the algorithm shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref> to calculate the outputs of the second-stage estimations. All the independent features introduced in data preparation go through the statistical analysis, and only the substantial features are used in the regression models to obtain the desired spatial–temporal estimations. Only the samples with independent determined features must be introduced, while all other data are ignored in the isotopic estimation process.<fig id="Fig7"><label>Figure 7</label><caption><p>Workflow of the evaluation class for estimating the second-stage regressions.</p></caption><graphic xlink:href="41598_2023_29073_Fig7_HTML" id="MO7"/></fig></p>
      <p id="Par43">The indirect input features (box a in Fig. <xref rid="Fig2" ref-type="fig">2</xref>) go through the stage one estimation procedure, which are unified with the introduced direct features and are used as isotopic composition input variables for the final isotopic estimation.</p>
    </sec>
    <sec id="Sec8">
      <title>Postprocessing tools</title>
      <p id="Par44">The <italic>stats</italic> class generates statistical reports for each stage (pink frames in Fig. <xref rid="Fig4" ref-type="fig">4</xref>). They include the characteristics and details of all executed models and the selected models: their R-squared s, adjusted R-squared values, VIF values, correlation coefficients, mutual information, chosen input features and sets of hyperparameters. Isocompy also reports the chosen regression models, cross validation averages, and standard deviations of the training and test data to evaluate the model estimation uncertainties. The reports can be generated for the whole or the separate parts of the time series.</p>
      <p id="Par45">The <italic>plot</italic> class generates diverse kinds of graphics to illustrate the results (orange frames in Fig. <xref rid="Fig4" ref-type="fig">4</xref>). The shapely<sup><xref ref-type="bibr" rid="CR76">76</xref></sup>, Bokeh<sup><xref ref-type="bibr" rid="CR77">77</xref></sup> and matplotlib<sup><xref ref-type="bibr" rid="CR78">78</xref></sup> libraries are employed to develop the methods of this class. The <italic>partial_dep_plots</italic> method generates partial dependency plots. The <italic>best_estimator_plot</italic> method constructs the plots of the best estimator in each determined time window. The <italic>isotope_meteoline_plot</italic> method is designed to illustrate and compare the output data and observed data with the GMWL and LMWL. This method uses the reduced major axis (RMA) regression method to calculate the local line of the input data. It is shown that the RMA approach explains water isotope relationships better than least-squares regression since it takes the measurement errors in box axes into account<sup><xref ref-type="bibr" rid="CR79">79</xref>–<xref ref-type="bibr" rid="CR81">81</xref></sup>. The <italic>isotope_meteoline_plot</italic> method can also generate residual plots of each isotopic station for each isotopic composition and accompanies them with a report including the mean absolute errors, mean square errors and means and standard deviations of the residuals, observations and estimations.</p>
      <p id="Par46">The <italic>map_generator</italic> method generates maps of the desired features, whether they are observed or estimated. The maps are generated based on the estimated data limits introduced by the user to the <italic>evaluation class</italic> in the time periods defined by the user. The results can be limited to positive values and/or to percentages if needed. The user has the ability to add a desired shapefile to the maps, display the measured data and define the aesthetics. The results can be saved as an interactive HTML file or in an image format.</p>
    </sec>
    <sec id="Sec9">
      <title>Project management</title>
      <p id="Par47">The <italic>session</italic> class enables the functionality of saving and loading one or all defined objects of a session (yellow frames in Fig. <xref rid="Fig4" ref-type="fig">4</xref>). The session class is powered by the Dill python library<sup><xref ref-type="bibr" rid="CR82">82</xref></sup> because of its capacity to save the executed Isocompy project as a compressed file along with its results in a single command. Hence, it would be feasible to save and close an interpreter session, send the compressed session file to another computer, open a new interpreter, decompress the session and thus continue from the point of work saved in the original interpreter session.</p>
    </sec>
    <sec id="Sec10">
      <title>Outputs</title>
      <p id="Par48">Isocompy outputs can be categorized into four groups: reports, figures, maps and datasheets. It is possible to obtain this information at different steps to clarify the underlying processes. Reports are generated to address the input data characteristics, partial and whole time period statistics, the best first- and second-stage model characteristics, all models in the first and second stages, the best second-stage model selection scoring details based on the chosen function, prediction model uncertainty statistics, residuals, observed and estimated isotopic value statistics and errors.</p>
      <p id="Par49">Figures can be created for partial dependencies, observed-estimated regressions, residual plots and meteoric line plots, as explained in “Postprocessing tools”. The bottom-left and top-right parts of Fig. <xref rid="Fig8" ref-type="fig">8</xref> show examples of partial dependencies and residual plots, respectively. Examples of observed-estimated plots can be seen in the figures of the next section.<fig id="Fig8"><label>Figure 8</label><caption><p>Screenshots of the outputs generated by Isocompy. Top left: an example report. Bottom left: partial dependency plots of the selected features. The values are standardized between zero and one. Vertical ticks on the x-axis illustrate the percentile of the data. Top right: a residual plot at each observation point generated by Isocompy via the <italic>isotope_meteoline_plot</italic> method. Bottom right: an interactive map generated by Isocompy without an available shape file.</p></caption><graphic xlink:href="41598_2023_29073_Fig8_HTML" id="MO8"/></fig></p>
      <p id="Par50">Maps can be created in different formats for any desired feature by using the <italic>map_generator</italic> function, as mentioned in “<xref rid="Sec5" ref-type="sec">Isocompy architecture</xref>”. Examples of maps can be seen in the figures of the next section. The bottom-right part of Fig. <xref rid="Fig8" ref-type="fig">8</xref> shows a screenshot of an interactive map created by Isocompy.</p>
      <p id="Par51">Datasheets are produced in the data preprocessing stage, and they include outlier-removed data, monthly averages for each year at each station and station averages. First- and second-stage estimations are also saved in datasheets. Refer to “<xref rid="Sec18" ref-type="sec">Application on Salar de Atacama</xref>” for an example datasheet.</p>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Application to the example of Salar de Atacama</title>
    <p id="Par52">The Salar de Atacama is the ideal target zone for demonstrating Isocompy capabilities due to its particular climate and topographic features. The scope of this investigation is not a comprehensive isotopic analysis, as it has been published already<sup><xref ref-type="bibr" rid="CR83">83</xref>–<xref ref-type="bibr" rid="CR90">90</xref></sup>, but rather validate Isocompy performance. Therefore, using the scarce information that is currently available, the climatic characteristics and isotopic composition of the precipitation in this area are compared with that of previous studies.</p>
    <p id="Par53">The Salar de Atacama basin is located in northern Chile in the Antofagasta region (Fig. <xref rid="Fig9" ref-type="fig">9</xref>). This zone is the largest salt flat in Chile and the third-largest salt flat in the world. The Salar de Atacama is one of the driest places on the Earth’s surface, contains vast amounts of lithium reserves and is a valuable lagoon ecosystem (RAMSAR). For these reasons, in recent decades, many studies have been carried out on the water resources of this area<sup><xref ref-type="bibr" rid="CR83">83</xref>–<xref ref-type="bibr" rid="CR90">90</xref></sup>. No continuous monitoring is performed on individual precipitation events in the basin, and the available data do not have a high spatial density.<fig id="Fig9"><label>Figure 9</label><caption><p>Left: location map of the study area in South America with published isotopic precipitation data (red circles) and automatic weather stations that monitor temperature (crosses), precipitation levels (blue squares) and relative humidity (yellow triangles). The solid red line delineates the Salar de Atacama basin, and the solid brown line shows the Altiplano-Puna plateau basins. The base map is derived from satellite data (SRTM from <ext-link ext-link-type="uri" xlink:href="http://earthexplorer.usgs.gov/">http://earthexplorer.usgs.gov/</ext-link>). All location data are in UTM Zone 19 S coordinates based on the WGS of 1984. The utilized DEM is an ALOS PALSAR RTC product that has a resolution of 12.5 × 12.5 m and is provided by the Alaska Satellite Facility. Right: elevation map of the Salar de Atacama basin.</p></caption><graphic xlink:href="41598_2023_29073_Fig9_HTML" id="MO9"/></fig></p>
    <p id="Par54">The distribution of isotopic precipitation samples is heterogeneous in time, space and type of sample. Specific rain samples are taken in the basin, and permanent rain collectors are installed close to automatic meteorological stations<sup><xref ref-type="bibr" rid="CR91">91</xref></sup>. Isotopic samples are mostly collected during the summer months (January, February and March) since this is the period containing important precipitation events (during the so-called “Altiplanic winter”). As a result, Isocompy is applied only during these time periods.</p>
    <sec id="Sec12">
      <title>Input data</title>
      <p id="Par55">The available meteorological variables that potentially influence the δ<sup>18</sup>O and δ<sup>2</sup>H values in this study are air temperature, relative air humidity and amount of precipitation. They are recorded daily at the meteorological stations of the Salar de Atacama basin and its surroundings and compiled from the automatic weather stations belonging to the General Directorate of Waters<sup><xref ref-type="bibr" rid="CR92">92</xref>,<xref ref-type="bibr" rid="CR93">93</xref></sup> of Chile and the Soquimich (SQM) mining company. Temperature value records are provided for the period from 1974 to 2019, relative humidity values are from 1987 to 2019 and precipitation volume data are from 1959 to 2019. The basic statistical indicators of the aforementioned meteorological variables can be seen in Table <xref rid="Tab1" ref-type="table">1</xref>.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Statistical indicators of temperature, relative humidity and precipitation in January, February and March for Salar de Atacama study area.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">Number of stations</th><th align="left">Unit</th><th align="left">Min</th><th align="left">Max</th><th align="left">Mean</th><th align="left">Median</th><th align="left">Std.dev</th></tr></thead><tbody><tr><td align="left">Temperature</td><td align="left">28</td><td align="left">°C</td><td align="left">−4.3</td><td align="left">22.6</td><td char="." align="char">12.8</td><td align="left">13.2</td><td char="." align="char">5.5</td></tr><tr><td align="left">Relative humidity</td><td align="left">24</td><td align="left">%</td><td align="left">15</td><td align="left">69.8</td><td char="." align="char">23.6</td><td align="left">20.8</td><td char="." align="char">11.6</td></tr><tr><td align="left">Precipitation</td><td align="left">31</td><td align="left">Mm</td><td align="left">0</td><td align="left">219</td><td char="." align="char">4.7</td><td align="left">0</td><td char="." align="char">16.9</td></tr></tbody></table></table-wrap></p>
      <p id="Par56">The precipitation samples for the isotopic analysis are compiled from previously published studies<sup><xref ref-type="bibr" rid="CR94">94</xref>–<xref ref-type="bibr" rid="CR99">99</xref></sup> for the period from 2002 to 2021 for δ<sup>18</sup>O and δ<sup>2</sup>H and correspond to 31 different points (Fig. <xref rid="Fig9" ref-type="fig">9</xref>). These samples are heterogeneous: some are individual precipitation events, others are monthly accumulated or multimonth samples, and others are mixtures of rainfall and snow. The main statistical indicators of δ<sup>18</sup>O and δ<sup>2</sup>H can be seen in Table <xref rid="Tab2" ref-type="table">2</xref>. Refer to “<xref rid="Sec18" ref-type="sec">Application on Salar de Atacama</xref>” for the input data file.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Statistical indicators of δ<sup>18</sup>O and δ<sup>2</sup>H in January, February and March for Salar de Atacama study area.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">Number of samples</th><th align="left">Unit</th><th align="left">Min</th><th align="left">Max</th><th align="left">Mean</th><th align="left">Median</th><th align="left">Std.dev</th></tr></thead><tbody><tr><td align="left">δ<sup>18</sup>O </td><td align="left" rowspan="2">52</td><td align="left" rowspan="2">‰ VSMOW</td><td align="left">−15.2</td><td align="left">−0.2</td><td align="left">−8.1</td><td align="left">−8.0</td><td align="left">4.3</td></tr><tr><td align="left">δ<sup>2</sup>H</td><td align="left">−102.5</td><td align="left">0.9</td><td align="left">−53.3</td><td align="left">−52.7</td><td align="left">32.2</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec13">
      <title>Implementation</title>
      <p id="Par57">The data preparation steps for the input parameters are shown in Fig. <xref rid="Fig10" ref-type="fig">10</xref> Lines 7 to 25 align with the <italic>preprocess</italic> classes for precipitation, air temperature and cumulative humidity. These three indirect variables are estimated in stage one and are dependent on the spatial variables (latitude, longitude and altitude).<fig id="Fig10"><label>Figure 10</label><caption><p>Isocompy data preparation. Location information (X, Y: coordinates; Z: altitude) is used to calculate the feature information in these positions<italic>. Preprocess</italic> classes are created for the precipitation, temperature, cumulative humidity, δ<sup>18</sup>O and δ<sup>2</sup>H of precipitation. <italic>Rain</italic>, <italic>temp</italic> and <italic>hum</italic> are panda dataframes that contain <italic>ID</italic>, <italic>Date</italic> and <italic>Value</italic> columns.</p></caption><graphic xlink:href="41598_2023_29073_Fig10_HTML" id="MO10"/></fig></p>
      <p id="Par58">Lines 26 to 32 create the <italic>preprocess</italic> class for the δ<sup>18</sup>O and δ<sup>2</sup>H values of precipitation used in the second stage of the model. The spatial variables here act as direct variables since they are measured in the same location as the isotopic data. In this study, outlier removal techniques, such as those explained in “<xref rid="Sec4" ref-type="sec">Isocompy workflow</xref>”, are not needed.</p>
      <p id="Par59">The steps needed to execute the first-stage models for the desired <italic>preprocess</italic> classes in January, February and March of all years can be seen in Fig. <xref rid="Fig11" ref-type="fig">11</xref>. Each <italic>preprocessing</italic> class contains the dependent and independent variables, as shown in Fig. <xref rid="Fig10" ref-type="fig">10</xref>. The models for each process class and for each month are isolated from the rest. The feature selection options of the first stage are not changed from the predefined default Isocompy values (line 5 in Fig. <xref rid="Fig11" ref-type="fig">11</xref>), so the feature selection process in the first stage runs automatically. Isocompy reports the VIF and correlation coefficient values but does not consider them in the feature selection procedure. Executing lines 9 and 10 generates the estimated-versus-observed values and partial dependency plots for each regression model in stage one.<fig id="Fig11"><label>Figure 11</label><caption><p>Stage-one estimation models, estimator and partial dependency plots.</p></caption><graphic xlink:href="41598_2023_29073_Fig11_HTML" id="MO11"/></fig></p>
      <p id="Par60">To create the second-stage models, the precipitation, temperature and humidity values must be predicted at the same coordinates as the isotopic measurements. Line 2 in Fig. <xref rid="Fig12" ref-type="fig">12</xref> three estimates these values for three months based on the stage-one models. The dependent and independent (direct and indirect) variables must be determined as shown in lines 7 to 10.<fig id="Fig12"><label>Figure 12</label><caption><p>Stage-one estimation calculations (line 2). Stage-two model argument definitions (lines 7–10). Stage-two model execution (line 16). Statistical reports and plots (lines 26–27).</p></caption><graphic xlink:href="41598_2023_29073_Fig12_HTML" id="MO12"/></fig></p>
      <p id="Par61">The feature selection process of the second-stage models is the <italic>st2_fit</italic> method, which is performed automatically if it is not specified. In this example, some aspects of the feature selection process are specified. Thus, as seen in line 13 of Fig. <xref rid="Fig12" ref-type="fig">12</xref>, in cases with high VIF and correlation coefficient values, one of the parameters is removed: temperature is preferred over altitude to respect the seasonality of the data. Line 16 executes the model based on the defined variables, and lines 19 to 23 generate the statistical reports of the given month and the whole period. Similar to the first stage, lines 26 and 27 generate the estimated-versus-observed values and partial dependency plots for each generated isotopic regression model.</p>
      <p id="Par62">The reader is referred to “<xref rid="Sec18" ref-type="sec">Application on Salar de Atacama</xref>” for the complete version of the Jupyter notebook in this study that contains the <italic>evaluation</italic> class, visualization options, evaluations, estimated value datasheets, meteoric lines for observed and newly defined coordinates, residual plots and feature maps.</p>
    </sec>
  </sec>
  <sec id="Sec14">
    <title>Results and discussion</title>
    <p id="Par63">The first stage of statistical analysis shows that altitude and longitude are significant variables for temperature and relative humidity in all 3 months, while latitude is also significant in March (Table <xref rid="Tab3" ref-type="table">3</xref>). This is consistent with the DICTUC<sup><xref ref-type="bibr" rid="CR100">100</xref></sup> results. For precipitation, latitude and altitude are significant variables in the three summer months, as Houston and Harley<sup><xref ref-type="bibr" rid="CR101">101</xref></sup> mentioned, while longitude is also significant in February and March. The influence of altitude on the amount of precipitation that falls in the eastern part of the basin is recognized by all existing studies<sup><xref ref-type="bibr" rid="CR86">86</xref>,<xref ref-type="bibr" rid="CR102">102</xref>,<xref ref-type="bibr" rid="CR103">103</xref></sup>.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Results of the first-stage statistical analysis and models per month.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Month</th><th align="left" rowspan="2">Dependent feature</th><th align="left" colspan="3">p-value</th><th align="left" rowspan="2">R<sup>2</sup></th><th align="left" rowspan="2">Standardized standard deviation<sup>a</sup></th><th align="left" rowspan="2">Ln (x + 1)</th></tr><tr><th align="left">Longitude</th><th align="left">Latitude</th><th align="left">Altitude</th></tr></thead><tbody><tr><td align="left" rowspan="3">January</td><td align="left">Temperature</td><td align="left"><bold>7.04E−03</bold></td><td align="left">6.96E<bold>−</bold>02</td><td align="left"><bold>8.06E−18</bold></td><td align="left">0.98</td><td align="left">0.23</td><td align="left">No</td></tr><tr><td align="left">Relative humidity</td><td align="left"><bold>1.10E−05</bold></td><td align="left">7.06E<bold>−</bold>02</td><td align="left"><bold>1.10E−05</bold></td><td align="left">0.87</td><td align="left">1</td><td align="left">Yes</td></tr><tr><td align="left">Precipitation</td><td align="left">2.34E<bold>−</bold>01</td><td align="left">1.73E<bold>−</bold>01</td><td align="left"><bold>7.15E−11</bold></td><td align="left">0.97</td><td align="left">0.09</td><td align="left">Yes</td></tr><tr><td align="left" rowspan="3">February</td><td align="left">Temperature</td><td align="left"><bold>1.68E−03</bold></td><td align="left">1.16E<bold>−</bold>01</td><td align="left"><bold>1.18E−20</bold></td><td align="left">0.98</td><td align="left">0.28</td><td align="left">No</td></tr><tr><td align="left">Relative humidity</td><td align="left"><bold>8.09E−03</bold></td><td align="left">9.58E<bold>−</bold>02</td><td align="left"><bold>7.01E−03</bold></td><td align="left">0.84</td><td align="left">0.13</td><td align="left">No</td></tr><tr><td align="left">Precipitation</td><td align="left"><bold>6.67E−03</bold></td><td align="left"><bold>1.52E−02</bold></td><td align="left"><bold>5.74E−08</bold></td><td align="left">0.96</td><td align="left">0.68</td><td align="left">Yes</td></tr><tr><td align="left" rowspan="3">March</td><td align="left">Temperature</td><td align="left"><bold>1.80E−02</bold></td><td align="left"><bold>2.87E−02</bold></td><td align="left"><bold>2.05E−17</bold></td><td align="left">0.99</td><td align="left">0</td><td align="left">No</td></tr><tr><td align="left">Relative humidity</td><td align="left"><bold>6.38E−04</bold></td><td align="left"><bold>1.14E−02</bold></td><td align="left"><bold>3.32E−04</bold></td><td align="left">0.82</td><td align="left">0.78</td><td align="left">No</td></tr><tr><td align="left">Precipitation</td><td align="left">2.55E<bold>−</bold>01</td><td align="left"><bold>1.03E−03</bold></td><td align="left"><bold>2.00E−06</bold></td><td align="left">0.94</td><td align="left">0.09</td><td align="left">No</td></tr></tbody></table><table-wrap-foot><p>The bold p values denote significant parameters (&lt; 0.05).</p><p><sup>a</sup>Standardized standard deviation of the cross-validation scores of the estimation models.</p></table-wrap-foot></table-wrap></p>
    <p id="Par64">Monthly models for temperature, relative humidity and precipitation are created by using the significant features. The estimation method with the highest scores in all models is the random forest, whose R-squared values are shown in Table <xref rid="Tab3" ref-type="table">3</xref>. Column <italic>Ln </italic>(<italic>x</italic> + <italic>1</italic>) shows the models whose feature <italic>Ln </italic>(<italic>x</italic> + <italic>1</italic>) values are used since they result in higher R-squared values.</p>
    <p id="Par65">The estimation uncertainties can be evaluated by the standardized standard deviation of the cross-validation scores for the randomly selected test dataset in each iteration (Table <xref rid="Tab3" ref-type="table">3</xref>). The limited spatial distribution of the available data in the Salar de Atacama basin can play an important role in high estimated standard deviation values obtained for some features. Figure <xref rid="Fig13" ref-type="fig">13</xref> shows the observed-versus-estimated values of the three features in three months.<fig id="Fig13"><label>Figure 13</label><caption><p>Plots of the estimated-versus-observed values generated by Isocompy for temperature, precipitation and relative humidity in January, February and March.</p></caption><graphic xlink:href="41598_2023_29073_Fig13_HTML" id="MO13"/></fig></p>
    <p id="Par66">The map of the temperature distribution estimated by Isocompy for the Salar de Atacama in the three summer months is shown in Fig. <xref rid="Fig14" ref-type="fig">14</xref>. It can be observed that the maximum temperatures are recorded in the central area with values between 19 and 20.4 °C, which are slightly lower than those of Marazuela et al. (24 °C) and Kampf et al. (23 °C)<sup><xref ref-type="bibr" rid="CR102">102</xref>,<xref ref-type="bibr" rid="CR104">104</xref></sup> in February. It is observed that temperature decreases with altitude, reaching minimum values of 4 to 5.3 °C in the volcanic arc that surrounds the eastern side of the basin, with a gradient of approximately −0.55 °C/100 m. These gradients are similar to those presented by DICTUC and MOP-DGA (−0.56 °C/100 m and −0.65 °C/100 m, respectively)<sup><xref ref-type="bibr" rid="CR100">100</xref>,<xref ref-type="bibr" rid="CR105">105</xref></sup>.<fig id="Fig14"><label>Figure 14</label><caption><p>Maps of the temperature, precipitation, relative humidity and δ<sup>18</sup>O values of precipitation estimated by Isocompy in January, February and March in the Salar de Atacama basin.</p></caption><graphic xlink:href="41598_2023_29073_Fig14_HTML" id="MO14"/></fig></p>
    <p id="Par67">The relative humidity values estimated by Isocompy in the Salar de Atacama basin for the three summer months can also be seen in Fig. <xref rid="Fig14" ref-type="fig">14</xref>. The lowest values of relative humidity are recorded in the core (24–29%) and in the west, and they increase with altitude, reaching their maximum values in the east of the basin (42–55%) and resulting in a gradient of 0.49%/100 m. In Valdivielso et al.<sup><xref ref-type="bibr" rid="CR99">99</xref></sup>, who used a larger study area (N Chile), the estimated values of relative humidity in the salt flat nucleus were similar to those in the present study, although the estimated values for high altitudes were lower.</p>
    <p id="Par68">Summer storms in the Salar de Atacama basin are convective and are characterized by highly variable intensity<sup><xref ref-type="bibr" rid="CR84">84</xref>,<xref ref-type="bibr" rid="CR86">86</xref>,<xref ref-type="bibr" rid="CR106">106</xref>,<xref ref-type="bibr" rid="CR107">107</xref></sup>, with years that are much wetter than others and some with practically no precipitation. This high variability, accompanied by the nature of the available precipitation data, results in a low correlation between the precipitation values recorded in different seasons, as well as between the precipitation values recorded in the same season for different periods. Therefore, the precipitation models exhibit high sensitivity to anomalous values since they greatly affect the average precipitation at a station.</p>
    <p id="Par69">From the precipitation model, zero precipitation (0 mm) is estimated in the salt flat nucleus (Fig. <xref rid="Fig14" ref-type="fig">14</xref>), increasing with altitude up to 55 mm in the summits at the eastern limit of the basin; there is little precipitation at the western limits. A comparison with many studies that have presented annual isohyets maps of the Salar de Atacama<sup><xref ref-type="bibr" rid="CR90">90</xref>,<xref ref-type="bibr" rid="CR100">100</xref>,<xref ref-type="bibr" rid="CR105">105</xref>,<xref ref-type="bibr" rid="CR108">108</xref></sup> shows that the magnitude of precipitation is lower in the present study since only the summer precipitation is considered, but the overall distribution of precipitation is similar. The summer precipitation gradient from the salt flat nucleus to the eastern peaks is 3.7 mm/100 m, which is slightly less than the annual gradients calculated in Salas et al., Valdivielso et al. (5 mm/100 m) and IDAEA-CSIC (4.6 mm/100 m)<sup><xref ref-type="bibr" rid="CR90">90</xref>,<xref ref-type="bibr" rid="CR91">91</xref>,<xref ref-type="bibr" rid="CR109">109</xref></sup>, as these studies considered all precipitation events during the year. In contrast, DGA<sup><xref ref-type="bibr" rid="CR84">84</xref></sup> calculated values of 2.7 mm/100 m in January, 2.2 mm/100 m in February and 1.8 mm/100 m in March for the period from 1970 to 2008.</p>
    <p id="Par70">Precipitation is depleted in heavy isotopes with elevation, with an average gradient of −0.19‰/100 m in summer (Fig. <xref rid="Fig14" ref-type="fig">14</xref>). This gradient is slightly lower than the others calculated in this region (−0.34‰/100 m in Herrera et al. and −0.26‰/100 m in Villablanca<sup><xref ref-type="bibr" rid="CR96">96</xref>,<xref ref-type="bibr" rid="CR111">111</xref></sup>. The distribution map of the stable isotopic signature is consistent with the distributions of the highest temperatures, the lowest relative humidity values and precipitation in the salt flat nucleus; at higher elevations, the precipitation and relative humidity are higher, and the temperatures are lower<sup><xref ref-type="bibr" rid="CR98">98</xref>,<xref ref-type="bibr" rid="CR112">112</xref></sup>.</p>
    <p id="Par71">In the statistical analysis and feature selection processes of the second stage, the initial VIF values are higher than the defined threshold (VIF = 5) for longitude, altitude and temperature. Furthermore, these variables have high correlations with each other (Table <xref rid="Tab4" ref-type="table">4</xref>). Therefore, as these variables have high multicolinearity and strong correlations, altitude and longitude are iteratively removed as important features until VIF values below the threshold are reached for all the features, as seen in the VIF_fin column of Table <xref rid="Tab4" ref-type="table">4</xref>. Then, the p values of latitude, temperature, precipitation and humidity are evaluated, and as a result, temperature and relative humidity are selected as significant features for the δ<sup>18</sup>O and δ<sup>2</sup>H regression models (Table <xref rid="Tab4" ref-type="table">4</xref>). The R-squared values of the δ<sup>18</sup>O and δ<sup>2</sup>H estimation models are 0.82 and 0.79, and the standard deviations of the associated cross-validation scores are 0.58 and 0.46, respectively. The top-left and top-right plots in Fig. <xref rid="Fig15" ref-type="fig">15</xref> show the estimation-versus-real measurements of δ<sup>18</sup>O and δ<sup>2</sup>H, respectively.<table-wrap id="Tab4"><label>Table 4</label><caption><p>The VIF values and correlation coefficients of the second-stage input features.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">p-value</th><th align="left">VIF_fin</th><th align="left">VIF_init</th><th align="left"/><th align="left">Cor. lon</th><th align="left">Cor. lat</th><th align="left">Cor. alt</th><th align="left">Cor. temp</th><th align="left">Cor. prec</th><th align="left">Cor. hum</th></tr></thead><tbody><tr><td align="left">–</td><td align="left">–</td><td align="left"><bold>8.6</bold></td><td align="left">Lon</td><td align="left">1.00</td><td align="left">–</td><td align="left">–</td><td align="left">–</td><td align="left">–</td><td align="left">–</td></tr><tr><td align="left">0.78</td><td align="left"><bold>1.1</bold></td><td align="left">2.0</td><td align="left">Lat</td><td align="left">−0.30</td><td align="left">1.00</td><td align="left">–</td><td align="left">–</td><td align="left">–</td><td align="left">–</td></tr><tr><td align="left">–</td><td align="left">–</td><td align="left"><bold>33.3</bold></td><td align="left">Alt</td><td align="left"><bold>0.83</bold></td><td align="left">0.09</td><td align="left">1.00</td><td align="left">–</td><td align="left">–</td><td align="left">–</td></tr><tr><td align="left">0.00</td><td align="left"><bold>2.6</bold></td><td align="left"><bold>43.0</bold></td><td align="left">Temp</td><td align="left">−<bold>0.87</bold></td><td align="left">−0.06</td><td align="left">−<bold>0.98</bold></td><td align="left">1.00</td><td align="left">–</td><td align="left">–</td></tr><tr><td align="left">0.66</td><td align="left"><bold>2.3</bold></td><td align="left">2.6</td><td align="left">Prec</td><td align="left">0.60</td><td align="left">−0.05</td><td align="left">0.61</td><td align="left">−0.60</td><td align="left">1.00</td><td align="left">–</td></tr><tr><td align="left">0.04</td><td align="left"><bold>3.7</bold></td><td align="left">4.5</td><td align="left">Hum</td><td align="left">0.78</td><td align="left">−0.09</td><td align="left">0.72</td><td align="left">−0.77</td><td align="left">0.75</td><td align="left">1.00</td></tr></tbody></table><table-wrap-foot><p>VIF_init and VIF_fin show the initial and final VIF values, respectively. Cor. shows the correlation coefficients of the features. The p values of the parameters selected by the VIF process are shown.</p><p>Significant p values are displayed in bold fonts (&lt; 0.05).</p></table-wrap-foot></table-wrap><fig id="Fig15"><label>Figure 15</label><caption><p>Top left and top right: estimations versus the measurements of δ<sup>18</sup>O and δ<sup>2</sup>H, respectively. Bottom: plots of the estimated (circles) and observed (triangles) δ<sup>18</sup>O versus δ<sup>2</sup>H values of precipitation. The red line is the GMWL, the brown dashed line is the estimated LMWL, and the yellow dashed line is the observed LMWL. Bottom left: the plot obtained using the δ<sup>18</sup>O and δ<sup>2</sup>H values estimated at the same points as the measurements. Bottom right: the plot obtained using the δ<sup>18</sup>O and δ<sup>2</sup>H values estimated in the study area. The reader is referred to “<xref rid="Sec18" ref-type="sec">Application on Salar de Atacama</xref>” for the monthly meteoric line plots, residual plots and reports. All plots are generated by Isocompy.</p></caption><graphic xlink:href="41598_2023_29073_Fig15_HTML" id="MO15"/></fig></p>
    <p id="Par72">The LMWL is calculated with the isotopic measurements (observed LMWL: yellow line in Fig. <xref rid="Fig15" ref-type="fig">15</xref>), the average estimated δ<sup>18</sup>O and δ<sup>2</sup>H values at the same points as the measurements (estimated LMWL in Fig. <xref rid="Fig15" ref-type="fig">15</xref>; bottom left) and the average estimated δ<sup>18</sup>O and δ<sup>2</sup>H values in all the study areas (estimated LMWL in Fig. <xref rid="Fig15" ref-type="fig">15</xref>;—bottom right). Based on the estimated LMWL at the observation points, the isotopic model has slightly different slope (7.5) and intercept (7.8) values than those obtained with the LMWL defined in different areas of northern Chile<sup><xref ref-type="bibr" rid="CR110">110</xref>,<xref ref-type="bibr" rid="CR113">113</xref>–<xref ref-type="bibr" rid="CR117">117</xref></sup>. However, these differences are expected since the LMWL is calculated based on a different group of points in a larger area. Figure <xref rid="Fig15" ref-type="fig">15</xref> also demonstrates that the slope and intercept of the estimated and observed LMWLs are similar, which indicates that the estimated isotopic values have the same behaviour as the measured values that validates the statistical built-in capabilities of Isocompy.</p>
  </sec>
  <sec id="Sec15">
    <title>Conclusion</title>
    <p id="Par73">Isocompy is an open-source Python library dedicated to regression, statistical analysis and modelling for isotopic compositions of natural water. It considers the features that potentially affect the isotopic signature in a multistage procedure. These features can be meteorological measurements, particle trajectory-related parameters, sea surface temperatures, variables derived from reanalysis or any other parameter desired by the user.</p>
    <p id="Par74">The code simplifies and optimizes the analyses of the isotopic characteristics of natural water. The isotopic composition obtained using the Isocompy applications are consistent with those obtained in previous studies in the Salar de Atacama, which was used as an example of a study area with scarce and heterogeneous data, for validation. Therefore, Isocompy is capable of producing accurate estimated isotopic spatial distribution and estimated LMWL data. The application of Isocompy in this complex area (with unequal datasets in space and time) demonstrate the versatility on using machine learning techniques in environmental studies. Isocompy can deliver reasonable outputs, accompanied by an automatic feature selection procedure that enables a fast yet extensive study of the features that affect the isotopic composition of precipitation. The easily generated statistical analysis reports, feature maps and meteoric line plots from the observed and estimated values make the evaluation process simple and user friendly.</p>
    <p id="Par75">Nevertheless, choosing the right set of regression methods and defining a suitable set of hyperparameters for each method in a specific study area, considering the available computation power and time, is always challenging, as is selecting a suitable time window. In cases with high data densities, the number of regression models in the first stage of Isocompy can be increased by shortening the time window of each model and proceeding with the same time window in the second stage. In contrast, similar to the example of the Salar de Atacama, when the data do not have high density, it is possible to widen the time window and use data integration techniques to include more input data in the first stage, integrating the different first-stage outputs into a single model in the second stage.</p>
    <p id="Par76">Another important aspect to consider is the sensitivity of the models to anomalies in the input data. This effect is more visible when the data are scarce. Data treatment techniques such as outlier detection and data filling can be effective with Isocompy in decreasing the sensitivity of the models, but the anomalies must be considered when interpreting the results.</p>
    <p id="Par77">Although Isocompy focuses mainly on the isotopic composition of precipitation, the code could assist researchers to further environmental investigations such as paleoclimate change studies which obtaining the environmental variables from stable isotopes could be challenging. In studies where data preprocessing, statistical analysis, feature selection and machine learning are needed to investigate an environmental feature, Isocompy can be an integral solution for facilitating the workflow. In addition, Isocompy is an open-source library in a widely used programming language, which makes it a good candidate for further additions/implementations and customizations in different study areas.</p>
    <p id="Par78">Isocompy is a flexible tool that can be adapted based on the amount of data available in time and space, and it has the capability to apply diverse regression methods. It provides the user with reports, figures, datasheets and maps to facilitate the comprehension of the underlying process of each step and to speed up isotopic composition studies. Isocompy is designed to be easy to use but at the same time maintain adaptability to different studies.</p>
    <sec id="Sec17">
      <title>Isocompy library information</title>
      <p id="Par80">Year first available: 2022. Dependencies: pandas, pylr2, dill, geopandas, bokeh, statsmodels, numpy, tabulate, matplotlib, Shapely, scikit_learn. Contact information: ashkan.hassanzadeh@csic.es. Refer to <ext-link ext-link-type="uri" xlink:href="https://github.com/IDAEA-EVS/Isocompy/wiki">https://github.com/IDAEA-EVS/Isocompy/wiki</ext-link> or <ext-link ext-link-type="uri" xlink:href="https://isocompy.readthedocs.io">https://isocompy.readthedocs.io</ext-link> for additional information about the installation, default values of the arguments, explanation and the usage.</p>
    </sec>
    <sec id="Sec18">
      <title>Application on Salar de Atacama</title>
      <p id="Par81">The input data, the output reports, plots, figures and maps alongside the Jupyter notebook are available free of charge in <ext-link ext-link-type="uri" xlink:href="https://github.com/IDAEA-EVS/Isocompy">https://github.com/IDAEA-EVS/Isocompy</ext-link>.</p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors acknowledge Carlos Ayora and anonymous reviewers that helped us to improve this article. This study was supported by the “Agencia Estatal de Investigación” from the Spanish Ministry of Science and Innovation and the IDAEA-CSIC, a Centre of Excellence Severo Ochoa (CEX2018-000794-S). R. Criollo gratefully acknowledges the financial support from the Balearic Island Government through the Margalida Comas postdoctoral fellowship programme (PD/036/2020).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>A.H., S.V., E.V.-S. and R.C. devised the conceptual idea. A.H. developed the algorithm and the code. A.H. and S.V. contributed to the validation of the code, example application and interpretation of the results. A.H. took the lead in writing the manuscript. S.V., E.V., R.C. and M.C. provided critical feedback and helped shape the manuscript. This research article is part of the PhD thesis of A.H. at the Geology Program, UAB.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The datasets generated and analysed during the current study are available in the GitHub repository, <ext-link ext-link-type="uri" xlink:href="https://github.com/IDAEA-EVS/Isocompy">https://github.com/IDAEA-EVS/Isocompy</ext-link> under AGPL-3.0 license.</p>
  </notes>
  <notes id="FPar1" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par83">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aléon</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Determination of the initial hydrogen isotopic composition of the solar system</article-title>
        <source>Nat. Astron.</source>
        <year>2022</year>
        <volume>2022</volume>
        <fpage>1</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/s41550-021-01595-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Custodio</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Llamas</surname>
            <given-names>MR</given-names>
          </name>
        </person-group>
        <source>Hidrología Subterránea</source>
        <year>1983</year>
        <publisher-name>Omega</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Custodio, E. &amp; Jódar Bermúdez, J. <italic>Recarga Natural a Los Acuíferos, Metodología y Soporte de la Isotopía del Agua</italic>. (2019).</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gonfiantini</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Roche</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Olivry</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Fontes</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Zuppi</surname>
            <given-names>GM</given-names>
          </name>
        </person-group>
        <article-title>The altitude effect on the isotopic composition of tropical rains</article-title>
        <source>Chem. Geol.</source>
        <year>2001</year>
        <volume>181</volume>
        <fpage>147</fpage>
        <lpage>167</lpage>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Merlivat</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Jouzel</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Global climatic interpretation of the deuterium-oxygen 16 relationship for precipitation</article-title>
        <source>J. Geophys. Res.</source>
        <year>1979</year>
        <volume>84</volume>
        <fpage>5029</fpage>
        <lpage>5033</lpage>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Araguás-Araguás</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Froehlich</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Rozanski</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Deuterium and oxygen-18 isotope composition of precipitation and atmospheric moisture</article-title>
        <source>Hydrol. Process.</source>
        <year>2000</year>
        <volume>14</volume>
        <fpage>1341</fpage>
        <lpage>1355</lpage>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jasechko</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Global isotope hydrogeology—Review</article-title>
        <source>Rev. Geophys.</source>
        <year>2019</year>
        <volume>57</volume>
        <fpage>835</fpage>
        <lpage>965</lpage>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hurley</surname>
            <given-names>JV</given-names>
          </name>
          <name>
            <surname>Galewsky</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A last-saturation diagnosis of subtropical water vapor response to global warming</article-title>
        <source>Geophys. Res. Lett.</source>
        <year>2010</year>
        <volume>37</volume>
        <fpage>06702</fpage>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Galewsky</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Samuels-Crow</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Summertime moisture transport to the southern South American Altiplano: Constraints from in situ measurements of water vapor isotopic composition</article-title>
        <source>J. Clim.</source>
        <year>2015</year>
        <volume>28</volume>
        <fpage>2635</fpage>
        <lpage>2649</lpage>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Risi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bony</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Vimeux</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Influence of convective processes on the isotopic composition (δ<sup>18</sup>O and δD) of precipitation and water vapor in the tropics: 2. Physical interpretation of the amount effect</article-title>
        <source>J. Geophys. Res. Atmos.</source>
        <year>2008</year>
        <volume>113</volume>
        <fpage>19305</fpage>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tharammal</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bala</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Noone</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Impact of deep convection on the isotopic amount effect in tropical precipitation</article-title>
        <source>J. Geophys. Res.</source>
        <year>2017</year>
        <volume>122</volume>
        <fpage>1505</fpage>
        <lpage>1523</lpage>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vimeux</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Tremoy</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Risi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gallaire</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>A strong control of the South American SeeSaw on the intra-seasonal variability of the isotopic composition of precipitation in the Bolivian Andes</article-title>
        <source>Earth Planet. Sci. Lett.</source>
        <year>2011</year>
        <volume>307</volume>
        <fpage>47</fpage>
        <lpage>58</lpage>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bailey</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Posmentier</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Patterns of evaporation and precipitation drive global isotopic changes in atmospheric moisture</article-title>
        <source>Geophys. Res. Lett.</source>
        <year>2018</year>
        <volume>45</volume>
        <fpage>7093</fpage>
        <lpage>7101</lpage>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Craig</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Isotopic variations in meteoric waters</article-title>
        <source>Science (80-)</source>
        <year>1961</year>
        <volume>133</volume>
        <fpage>1702</fpage>
        <lpage>1703</lpage>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feng</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Faiia</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Posmentier</surname>
            <given-names>ES</given-names>
          </name>
        </person-group>
        <article-title>Seasonality of isotopes in precipitation: A global perspective</article-title>
        <source>J. Geophys. Res. Atmos.</source>
        <year>2009</year>
        <volume>114</volume>
        <fpage>08116</fpage>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gat</surname>
            <given-names>JR</given-names>
          </name>
        </person-group>
        <article-title>Atmospheric water balance—The isotopic perspective</article-title>
        <source>Hydrol. Process.</source>
        <year>2000</year>
        <volume>14</volume>
        <fpage>1357</fpage>
        <lpage>1369</lpage>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gat</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Matsui</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Atmospheric water balance in the Amazon Basin: An isotopic evapotranspiration model</article-title>
        <source>J. Geophys. Res.</source>
        <year>1991</year>
        <volume>96</volume>
        <fpage>13179</fpage>
        <lpage>13188</lpage>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Salati</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Dall’Olio</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Matsui</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Gat</surname>
            <given-names>JR</given-names>
          </name>
        </person-group>
        <article-title>Recycling of water in the Amazon Basin: An isotopic study</article-title>
        <source>Water Resour. Res.</source>
        <year>1979</year>
        <volume>15</volume>
        <fpage>1250</fpage>
        <lpage>1258</lpage>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thomas</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Rose</surname>
            <given-names>TP</given-names>
          </name>
        </person-group>
        <article-title>Environmental isotopes in hydrogeology</article-title>
        <source>Environ. Geol.</source>
        <year>2003</year>
        <volume>43</volume>
        <fpage>1</fpage>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Cook, P. G. &amp; Herczeg, A. L. <italic>Environmental Tracers in Subsurface Hydrology</italic>. <italic>Environmental Tracers in Subsurface Hydrology</italic>. 10.1007/978-1-4615-4557-6 (Springer US, 2000). </mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Coplen, T. <italic>Stable Isotope Hydrology: Deuterium and Oxygen-18 in the Water Cycle</italic>. <italic>Eos, Transactions American Geophysical Union</italic>. Vol. 63. (International Atomic Energy Agency, 1982).</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Kendall, C. &amp; McDonnell, J. J. <italic>Isotope Tracers in Catchment Hydrology</italic>. 10.1029/99eo00193 (Elsevier, 1998). </mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Mook, W.G. <italic>Environmental Isotopes in the Hydrological Cycle Volume I.pdf</italic>. <italic>Technical Documents in Hydrology</italic>. Vol. 1 (2000).</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Putman</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Fiorella</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Bowen</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>A global perspective on local meteoric water lines: Meta-analytic insight into fundamental controls and practical constraints</article-title>
        <source>Water Resour. Res.</source>
        <year>2019</year>
        <volume>55</volume>
        <fpage>6896</fpage>
        <lpage>6910</lpage>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xi</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>A review of water isotopes in atmospheric general circulation models: Recent advances and future prospects</article-title>
        <source>Int. J. Atmos. Sci.</source>
        <year>2014</year>
        <volume>2014</volume>
        <fpage>1</fpage>
        <lpage>16</lpage>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wong</surname>
            <given-names>TE</given-names>
          </name>
          <name>
            <surname>Nusbaumer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Noone</surname>
            <given-names>DC</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of modeled land-atmosphere exchanges with a comprehensive water isotope fractionation scheme in version 4 of the community land model</article-title>
        <source>J. Adv. Model. Earth Syst.</source>
        <year>2017</year>
        <volume>9</volume>
        <fpage>978</fpage>
        <lpage>1001</lpage>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nusbaumer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>TE</given-names>
          </name>
          <name>
            <surname>Bardeen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Noone</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Evaluating hydrological processes in the community atmosphere model version 5 (CAM5) using stable isotope ratios of water</article-title>
        <source>J. Adv. Model. Earth Syst.</source>
        <year>2017</year>
        <volume>9</volume>
        <fpage>949</fpage>
        <lpage>977</lpage>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Neale, R. B. <italic>et al.</italic><italic>Description of the NCAR Community Atmosphere Model</italic><italic>(CAM 5.0). Ncar/Tn-464+Str 214</italic> (2004).</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Steiger</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Steig</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Dee</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Roe</surname>
            <given-names>GH</given-names>
          </name>
          <name>
            <surname>Hakim</surname>
            <given-names>GJ</given-names>
          </name>
        </person-group>
        <article-title>Climate reconstruction using data assimilation of water isotope ratios from ice cores</article-title>
        <source>J. Geophys. Res.</source>
        <year>2017</year>
        <volume>122</volume>
        <fpage>1545</fpage>
        <lpage>1568</lpage>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Werner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Langebroek</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Carlsen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Herold</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lohmann</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Stable water isotopes in the ECHAM5 general circulation model: Toward high-resolution isotope modeling on a global scale</article-title>
        <source>J. Geophys. Res. Atmos.</source>
        <year>2011</year>
        <volume>116</volume>
        <fpage>15109</fpage>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kurita</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Intraseasonal isotopic variation associated with the Madden-Julian oscillation</article-title>
        <source>J. Geophys. Res. Atmos.</source>
        <year>2011</year>
        <volume>116</volume>
        <fpage>24101</fpage>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Risi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bony</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Vimeux</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Jouzel</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Water-stable isotopes in the LMDZ4 general circulation model: Model evaluation for present-day and past climates and applications to climatic interpretations of tropical isotopic records</article-title>
        <source>J. Geophys. Res. Atmos.</source>
        <year>2010</year>
        <volume>115</volume>
        <fpage>12118</fpage>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Steen-Larsen</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Risi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Werner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yoshimura</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Masson-Delmotte</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Evaluating the skills of isotope-enabled general circulation models against in situ atmospheric water vapor isotope observations</article-title>
        <source>J. Geophys. Res. Atmos.</source>
        <year>2017</year>
        <volume>122</volume>
        <fpage>246</fpage>
        <lpage>263</lpage>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tsuchihara</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Shirahata</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ishida</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yoshimoto</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Application of a self-organizing map of isotopic and chemical data for the identification of groundwater recharge sources in Nasunogahara alluvial fan, Japan</article-title>
        <source>Water (Switzerland)</source>
        <year>2020</year>
        <volume>12</volume>
        <fpage>278</fpage>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fiorella</surname>
            <given-names>RP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spatiotemporal variability of modern precipitation δ 18 O in the central Andes and implications for paleoclimate and paleoaltimetry estimates</article-title>
        <source>J. Geophys. Res.</source>
        <year>2015</year>
        <volume>120</volume>
        <fpage>4630</fpage>
        <lpage>4656</lpage>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">Garcia, M., Villalba, F., Araguas Araguas, L. &amp; Rozanski, K. The role of atmospheric circulation patterns in controlling the regional distribution of stable isotope contents in precipitation: Preliminary results from two transects in the Ecuadorian Andes. in <italic>Isotope Techniques in the Study of Environmental Change. Proceedings of a Symposium, Vienna, April 1997.</italic> 127–140 (1998).</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guo</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Qu</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Controls of precipitation δ<sup>18</sup>O on the northwestern Tibetan Plateau: A case study at Ngari station</article-title>
        <source>Atmos. Res.</source>
        <year>2017</year>
        <volume>189</volume>
        <fpage>141</fpage>
        <lpage>151</lpage>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Garzione</surname>
            <given-names>CN</given-names>
          </name>
        </person-group>
        <article-title>Spatial distribution and controlling factors of stable isotopes in meteoric waters on the Tibetan Plateau: Implications for paleoelevation reconstruction</article-title>
        <source>Earth Planet. Sci. Lett.</source>
        <year>2017</year>
        <volume>460</volume>
        <fpage>302</fpage>
        <lpage>314</lpage>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="data">
        <name>
          <surname>Nguyen</surname>
          <given-names>LD</given-names>
        </name>
        <name>
          <surname>Heidbüchel</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Meyer</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Merz</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Apel</surname>
          <given-names>H</given-names>
        </name>
        <year>2017</year>
        <data-title>What controls the stable isotope composition of precipitation in the Asian monsoon region?</data-title>
        <source>Hydrol. Earth Syst. Sci. Discuss.</source>
        <pub-id pub-id-type="doi">10.5194/hess-2017-164</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ren</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Yao</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Key drivers controlling the stable isotopes in precipitation on the Leeward side of the central Himalayas</article-title>
        <source>Atmos. Res.</source>
        <year>2017</year>
        <volume>189</volume>
        <fpage>134</fpage>
        <lpage>140</lpage>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rozanski</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sonntag</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Munnich</surname>
            <given-names>KO</given-names>
          </name>
        </person-group>
        <article-title>Factors controlling stable isotope composition of European precipitation</article-title>
        <source>Tellus</source>
        <year>1982</year>
        <volume>34</volume>
        <fpage>142</fpage>
        <lpage>150</lpage>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liebmann</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Description of a complete (interpolated) outgoing longwave radiation dataset</article-title>
        <source>Bull. Am. Meteorol. Soc.</source>
        <year>1996</year>
        <volume>77</volume>
        <fpage>1275</fpage>
        <lpage>1277</lpage>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morales</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Christie</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Neukom</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Rojas</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Villalba</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Variabilidad hidroclimática en el sur del Altiplano: Pasado, presente y futuro</article-title>
        <source>La Puna Argentina Nat. Cult.</source>
        <year>2018</year>
        <volume>24</volume>
        <fpage>75</fpage>
        <lpage>91</lpage>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Risi</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>What controls the isotopic composition of the African monsoon precipitation? Insights from event-based precipitation collected during the 2006 AMMA field campaign</article-title>
        <source>Geophys. Res. Lett.</source>
        <year>2008</year>
        <volume>35</volume>
        <fpage>1</fpage>
        <lpage>6</lpage>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vuille</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Climate change and tropical Andean glaciers: Past, present and future</article-title>
        <source>Earth-Sci. Rev.</source>
        <year>2008</year>
        <volume>89</volume>
        <fpage>79</fpage>
        <lpage>96</lpage>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stein</surname>
            <given-names>AF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>NOAA’s HYSPLIT atmospheric transport and dispersion modeling system</article-title>
        <source>Bull. Am. Meteorol. Soc.</source>
        <year>2015</year>
        <volume>96</volume>
        <fpage>2059</fpage>
        <lpage>2077</lpage>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Muñoz-Sabater</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ERA5-Land: A state-of-the-art global reanalysis dataset for land applications</article-title>
        <source>Earth Syst. Sci. Data</source>
        <year>2021</year>
        <volume>13</volume>
        <fpage>4349</fpage>
        <lpage>4383</lpage>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmidt</surname>
            <given-names>GA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Present-day atmospheric simulations using GISS ModelE: Comparison to in situ, satellite, and reanalysis data</article-title>
        <source>J. Clim.</source>
        <year>2006</year>
        <volume>19</volume>
        <fpage>153</fpage>
        <lpage>192</lpage>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yoshimura</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kanamitsu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Noone</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Oki</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Historical isotope simulation using reanalysis atmospheric data</article-title>
        <source>J. Geophys. Res. Atmos.</source>
        <year>2008</year>
        <volume>113</volume>
        <fpage>19108</fpage>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Boyd</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>A method for large-scale ℓ 1-regularized logistic regression</article-title>
        <source>Proc. Natl. Conf. Artif. Intell.</source>
        <year>2007</year>
        <volume>1</volume>
        <fpage>565</fpage>
        <lpage>571</lpage>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tipping</surname>
            <given-names>ME</given-names>
          </name>
        </person-group>
        <article-title>Sparse Bayesian learning and the relevance vector machine</article-title>
        <source>J. Mach. Learn. Res.</source>
        <year>2001</year>
        <volume>1</volume>
        <fpage>211</fpage>
        <lpage>244</lpage>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Least angle regression</article-title>
        <source>ArXiv</source>
        <year>2004</year>
        <pub-id pub-id-type="doi">10.1214/00905360400000006732,407-499</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>MacKay</surname>
            <given-names>DJC</given-names>
          </name>
        </person-group>
        <article-title>Bayesian nonlinear modeling for the prediction competition</article-title>
        <source>ASHRAE Trans.</source>
        <year>1994</year>
        <volume>100</volume>
        <fpage>1053</fpage>
        <lpage>1062</lpage>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mallat</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Matching pursuits with time-frequency dictionaries</article-title>
        <source>IEEE Trans. Signal Process.</source>
        <year>1993</year>
        <volume>41</volume>
        <fpage>3397</fpage>
        <lpage>3415</lpage>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Platt</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Probabilistic outputs for support vector machines and comparisons to regularized likelihood methods</article-title>
        <source>Adv. Large Margin Classif.</source>
        <year>1999</year>
        <volume>10</volume>
        <fpage>61</fpage>
        <lpage>74</lpage>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Geurts</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ernst</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wehenkel</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Extremely randomized trees</article-title>
        <source>Mach. Learn.</source>
        <year>2006</year>
        <volume>63</volume>
        <fpage>3</fpage>
        <lpage>42</lpage>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <mixed-citation publication-type="other">Hinton, G. E. <italic>Connectionist Learning Procedures</italic>. (1989).</mixed-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <mixed-citation publication-type="other">Claesen, M. &amp; De Moor, B. <italic>Hyperparameter Search in Machine Learning</italic>. (2015).</mixed-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <mixed-citation publication-type="other">He, K., Zhang, X., Ren, S. &amp; Sun, J. Delving deep into rectifiers: Surpassing human-level performance on imagenet classification. in <italic>Proceedings of the IEEE International Conference on Computer Vision</italic>. Vol. 2015. 1026–1034 (2015).</mixed-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cranganu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Breaban</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Using support vector regression to estimate sonic log distributions: A case study from the Anadarko Basin</article-title>
        <source>Oklahoma. J. Pet. Sci. Eng.</source>
        <year>2013</year>
        <volume>103</volume>
        <fpage>1</fpage>
        <lpage>13</lpage>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chang</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>CJ</given-names>
          </name>
        </person-group>
        <article-title>LIBSVM: A library for support vector machines</article-title>
        <source>ACM Trans. Intell. Syst. Technol.</source>
        <year>2011</year>
        <volume>2</volume>
        <fpage>27</fpage>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>T-F</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>C-J</given-names>
          </name>
          <name>
            <surname>Weng</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>Probability estimates for multi-class classification by pairwise coupling</article-title>
        <source>J. Mach. Learn. Res.</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>975</fpage>
        <lpage>1005</lpage>
      </element-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ploton</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spatial validation reveals poor predictive performance of large-scale ecological mapping models</article-title>
        <source>Nat. Commun.</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="pmid">31911652</pub-id>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <mixed-citation publication-type="other">Kraskov, A., Stögbauer, H. &amp; Grassberger, P. Estimating mutual information. <italic>Phys. Rev. E Stat. Phys. Plasmas Fluids Relat. Interdiscip. Top.</italic><bold>69</bold>, 16 (2004).</mixed-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Mutual information functions versus correlation functions</article-title>
        <source>J. Stat. Phys.</source>
        <year>1990</year>
        <volume>60</volume>
        <fpage>823</fpage>
        <lpage>837</lpage>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>A mutual information approach to calculating nonlinearity</article-title>
        <source>Statistics</source>
        <year>2015</year>
        <volume>4</volume>
        <fpage>291</fpage>
        <lpage>303</lpage>
      </element-citation>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <mixed-citation publication-type="other"><italic>The Pandas Development Team</italic>. pandas-dev/pandas: Pandas. 10.5281/zenodo.3509134 (2020). </mixed-citation>
    </ref>
    <ref id="CR68">
      <label>68.</label>
      <mixed-citation publication-type="other">Jordahl, K. <italic>et al.</italic> geopandas/geopandas: v0.10.2. 10.5281/ZENODO.5573592 (2021). </mixed-citation>
    </ref>
    <ref id="CR69">
      <label>69.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harris</surname>
            <given-names>CR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Array programming with NumPy</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>585</volume>
        <fpage>357</fpage>
        <lpage>362</lpage>
        <pub-id pub-id-type="pmid">32939066</pub-id>
      </element-citation>
    </ref>
    <ref id="CR70">
      <label>70.</label>
      <mixed-citation publication-type="other">Haentjens, N. <italic>pylr2 · PyPI</italic>. <ext-link ext-link-type="uri" xlink:href="https://pypi.org/project/pylr2/">https://pypi.org/project/pylr2/</ext-link>. Accessed 3 Mar 2022 (2018).</mixed-citation>
    </ref>
    <ref id="CR71">
      <label>71.</label>
      <mixed-citation publication-type="other">Seabold, S. &amp; Perktold, J. statsmodels: Econometric and statistical modeling with python. in <italic>9th Python in Science Conference</italic> (2010).</mixed-citation>
    </ref>
    <ref id="CR72">
      <label>72.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pedregosa</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Scikit-learn: Machine learning in Python</article-title>
        <source>J. Mach. Learn. Res.</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>2825</fpage>
        <lpage>2830</lpage>
      </element-citation>
    </ref>
    <ref id="CR73">
      <label>73.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>González Rouco</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jiménez</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Quesada</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Valero Rodríguez</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Quality control and homogeneity of precipitation data in the southwest of Europe</article-title>
        <source>J. Clim.</source>
        <year>2001</year>
        <volume>14</volume>
        <fpage>964</fpage>
        <lpage>978</lpage>
      </element-citation>
    </ref>
    <ref id="CR74">
      <label>74.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peterson</surname>
            <given-names>TC</given-names>
          </name>
          <name>
            <surname>Vose</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Schmoyer</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Razuvaëv</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Global historical climatology network (GHCN) quality control of monthly temperature data</article-title>
        <source>Int. J. Climatol.</source>
        <year>1998</year>
        <volume>18</volume>
        <fpage>1169</fpage>
        <lpage>1179</lpage>
      </element-citation>
    </ref>
    <ref id="CR75">
      <label>75.</label>
      <mixed-citation publication-type="other">Somaya, H. &amp; Tomader, M. <italic>Tuning the Hyperparameters for Supervised Machine Learning Classification, to Optimize Detection of IoT Botnet</italic>. 1–6. 10.1109/ISIVC54825.2022.9800742 (2022). </mixed-citation>
    </ref>
    <ref id="CR76">
      <label>76.</label>
      <mixed-citation publication-type="other">Gillies, S. <italic>et al</italic>. <italic>Shapely: Manipulation and Analysis of Geometric Objects</italic>. (2007).</mixed-citation>
    </ref>
    <ref id="CR77">
      <label>77.</label>
      <mixed-citation publication-type="other">Bokeh Development Team. <italic>Bokeh: Python Library for Interactive Visualization</italic>. (2018).</mixed-citation>
    </ref>
    <ref id="CR78">
      <label>78.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hunter</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Matplotlib: A 2D graphics environment</article-title>
        <source>Comput. Sci. Eng.</source>
        <year>2007</year>
        <volume>9</volume>
        <fpage>90</fpage>
        <lpage>95</lpage>
      </element-citation>
    </ref>
    <ref id="CR79">
      <label>79.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Friedman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bohonak</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Levine</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>When are two pieces better than one: Fitting and testing OLS and RMA regressions</article-title>
        <source>Environmetrics</source>
        <year>2013</year>
        <volume>24</volume>
        <fpage>306</fpage>
        <lpage>316</lpage>
      </element-citation>
    </ref>
    <ref id="CR80">
      <label>80.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Local meteoric water lines in a semi-arid setting of northwest China using multiple methods</article-title>
        <source>Water</source>
        <year>2021</year>
        <volume>13</volume>
        <fpage>2380</fpage>
      </element-citation>
    </ref>
    <ref id="CR81">
      <label>81.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crawford</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hughes</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Lykoudis</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Alternative least squares methods for determining the meteoric water line, demonstrated using GNIP data</article-title>
        <source>J. Hydrol.</source>
        <year>2014</year>
        <volume>519</volume>
        <fpage>2331</fpage>
        <lpage>2340</lpage>
      </element-citation>
    </ref>
    <ref id="CR82">
      <label>82.</label>
      <mixed-citation publication-type="other">McKerns, M., Strand, L., Sullivan, T., Fang, A. &amp; Aivazis, M. Building a framework for predictive science. in <italic>Proceedings of the 10th Python in Science Conference</italic>. 76–86. 10.25080/majora-ebaa42b7-00d (2011). </mixed-citation>
    </ref>
    <ref id="CR83">
      <label>83.</label>
      <mixed-citation publication-type="other">Amphos21. <italic>Estudio de Modelos Hidrogeológicos Conceptuales Integrados, para los Salares de Atacama, Maricunga y Pedernales. Etapa III. Informe Final. Modelo Hidrogeológico Consolidad Cuenca Salar de Atacama</italic>. (2018).</mixed-citation>
    </ref>
    <ref id="CR84">
      <label>84.</label>
      <mixed-citation publication-type="other">DGA. <italic>Análisis de la Oferta Hídrica del Salar de Atacama</italic>. <italic>Sdt No. 339</italic> (2013).</mixed-citation>
    </ref>
    <ref id="CR85">
      <label>85.</label>
      <mixed-citation publication-type="other">DGA. <italic>Evaporación desde salares: Metodología para Evaluar Los Recursos Hídricos Renovables. Aplicación en las Regiones I y II</italic>. Vol. 1. (Revista de la Sociedad Chilena de lngenierfa HidriÍulica, 1986).</mixed-citation>
    </ref>
    <ref id="CR86">
      <label>86.</label>
      <mixed-citation publication-type="other">Hess, R. A. Simplified approach for modelling pilot pursuit control behaviour in multi-loop flight control tasks. in <italic>Proceedings of the Institution of Mechanical Engineers, Part G: Journal of Aerospace Engineering</italic>. Vol. 220 (2006).</mixed-citation>
    </ref>
    <ref id="CR87">
      <label>87.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marazuela</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Vázquez-Suñé</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Ayora</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>García-Gil</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Towards more sustainable brine extraction in salt flats: Learning from the Salar de Atacama</article-title>
        <source>Sci. Total Environ.</source>
        <year>2020</year>
        <volume>703</volume>
        <fpage>135605</fpage>
        <pub-id pub-id-type="pmid">31767297</pub-id>
      </element-citation>
    </ref>
    <ref id="CR88">
      <label>88.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marazuela</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Vázquez-Suñé</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Ayora</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>García-Gil</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Palma</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>The effect of brine pumping on the natural hydrodynamics of the Salar de Atacama: The damping capacity of salt flats</article-title>
        <source>Sci. Total Environ.</source>
        <year>2019</year>
        <volume>654</volume>
        <fpage>1118</fpage>
        <lpage>1131</lpage>
        <pub-id pub-id-type="pmid">30841387</pub-id>
      </element-citation>
    </ref>
    <ref id="CR89">
      <label>89.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marazuela</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>3D mapping, hydrodynamics and modelling of the freshwater-brine mixing zone in salt flats similar to the Salar de Atacama (Chile)</article-title>
        <source>J. Hydrol.</source>
        <year>2018</year>
        <volume>561</volume>
        <fpage>223</fpage>
        <lpage>235</lpage>
      </element-citation>
    </ref>
    <ref id="CR90">
      <label>90.</label>
      <mixed-citation publication-type="other">IDAEA-CSIC. <italic>Cuarta Actualización del Modelo Hidrogeológico del Salar de Atacama. SNIFA. </italic><ext-link ext-link-type="uri" xlink:href="https://snifa.sma.gob.cl">https://snifa.sma.gob.cl</ext-link> (2017).</mixed-citation>
    </ref>
    <ref id="CR91">
      <label>91.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Valdivielso</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Vázquez-Suñé</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Herrera</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Custodio</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Characterization of precipitation and recharge in the peripheral aquifer of the Salar de Atacama</article-title>
        <source>Sci. Total Environ.</source>
        <year>2022</year>
        <volume>806</volume>
        <fpage>150271</fpage>
        <pub-id pub-id-type="pmid">34560455</pub-id>
      </element-citation>
    </ref>
    <ref id="CR92">
      <label>92.</label>
      <mixed-citation publication-type="other">DGA. <italic>Servicios Hidrometeorológicos</italic>. <ext-link ext-link-type="uri" xlink:href="https://www.dga.cl/servicioshidrometeorologicos/Paginas/default.aspx">https://www.dga.cl/servicioshidrometeorologicos/Paginas/default.aspx</ext-link> (2020).</mixed-citation>
    </ref>
    <ref id="CR93">
      <label>93.</label>
      <mixed-citation publication-type="other">Centre for Climate and Resilience Research. <italic>Datos de Precipitación, Datos de Temperaturas</italic>. <ext-link ext-link-type="uri" xlink:href="https://www.cr2.cl/datos-de-precipitacion/">https://www.cr2.cl/datos-de-precipitacion/</ext-link> (2018).</mixed-citation>
    </ref>
    <ref id="CR94">
      <label>94.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cortecci</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>New chemical and original isotopic data on waters from El Tatio geothermal field, northern Chile</article-title>
        <source>Geochem. J.</source>
        <year>2005</year>
        <volume>39</volume>
        <fpage>547</fpage>
        <lpage>571</lpage>
      </element-citation>
    </ref>
    <ref id="CR95">
      <label>95.</label>
      <mixed-citation publication-type="other">CRICYT. <italic>Segundo Informe de Avance Sobre Estudios e Investigaciones que Intentan Explicar el Estado Actual de Ejemplares de Algarrobo, en una Población Ubicada en las Proximidades del Pozo CAMAR 2 de SQM, en el Salar de Atacama, Chile</italic>. 10.1079/BJN20041276 (2017). </mixed-citation>
    </ref>
    <ref id="CR96">
      <label>96.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Herrera</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Groundwater flow in a closed basin with a saline shallow lake in a volcanic area: Laguna Tuyajto, northern Chilean Altiplano of the Andes</article-title>
        <source>Sci. Total Environ.</source>
        <year>2016</year>
        <volume>541</volume>
        <fpage>303</fpage>
        <lpage>318</lpage>
        <pub-id pub-id-type="pmid">26410705</pub-id>
      </element-citation>
    </ref>
    <ref id="CR97">
      <label>97.</label>
      <mixed-citation publication-type="other">Lagos Durán, L. V. <italic>Hidrogeoquímica de Fuentes Termales en Ambientes Salinos Relacionados Con Salares en Los Andes del Norte de Chile. MSc Thesis</italic> (Universidad de Chile, Thesis for Degree of Master of Sciences Mention in Geology, 2016).</mixed-citation>
    </ref>
    <ref id="CR98">
      <label>98.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moran</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Boutt</surname>
            <given-names>DF</given-names>
          </name>
          <name>
            <surname>Munk</surname>
            <given-names>LA</given-names>
          </name>
        </person-group>
        <article-title>Stable and radioisotope systematics reveal fossil water as fundamental characteristic of arid orogenic-scale groundwater systems</article-title>
        <source>Water Resour. Res.</source>
        <year>2019</year>
        <volume>55</volume>
        <fpage>11295</fpage>
        <lpage>11315</lpage>
      </element-citation>
    </ref>
    <ref id="CR99">
      <label>99.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Valdivielso</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hassanzadeh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vázquez-Suñé</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Custodio</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Criollo</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Spatial distribution of meteorological factors controlling stable isotopes in precipitation in Northern Chile</article-title>
        <source>J. Hydrol.</source>
        <year>2022</year>
        <volume>605</volume>
        <fpage>127380</fpage>
      </element-citation>
    </ref>
    <ref id="CR100">
      <label>100.</label>
      <mixed-citation publication-type="other">DICTUC. <italic>Levantamiento Hidrogeológico Para el Desarrollo de Nuevas Fuentes de Agua en Áreas Prioritarias de la Zona Norte de Chile, Regiones XV, I, II y III. Etapa 2. Informe Final Parte IX. Sistema Hidrogeoquímica e Isotopía Regional del Altiplano de Chile. Sistem</italic>. Parte IX. (2009).</mixed-citation>
    </ref>
    <ref id="CR101">
      <label>101.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Houston</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hartley</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>The central andean west-slope rainshadow and its potential contribution to the origin of hyper-aridity in the Atacama Desert</article-title>
        <source>Int. J. Climatol.</source>
        <year>2003</year>
        <volume>23</volume>
        <fpage>1453</fpage>
        <lpage>1464</lpage>
      </element-citation>
    </ref>
    <ref id="CR102">
      <label>102.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marazuela</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Vázquez-Suñé</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Ayora</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>García-Gil</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Palma</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Hydrodynamics of salt flat basins: The Salar de Atacama example</article-title>
        <source>Sci. Total Environ.</source>
        <year>2019</year>
        <volume>651</volume>
        <fpage>668</fpage>
        <lpage>683</lpage>
        <pub-id pub-id-type="pmid">30245423</pub-id>
      </element-citation>
    </ref>
    <ref id="CR103">
      <label>103.</label>
      <mixed-citation publication-type="other">Vazquez, Enric &amp; Ayora, C. <italic>Cuarta Actualización del Modelo Hidrogeológico del Salar de Atacama</italic>. (2017).</mixed-citation>
    </ref>
    <ref id="CR104">
      <label>104.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kampf</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Tyler</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Ortiz</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Muñoz</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Adkins</surname>
            <given-names>PL</given-names>
          </name>
        </person-group>
        <article-title>Evaporation and land surface energy budget at the Salar de Atacama, Northern Chile</article-title>
        <source>J. Hydrol.</source>
        <year>2005</year>
        <volume>310</volume>
        <fpage>236</fpage>
        <lpage>252</lpage>
      </element-citation>
    </ref>
    <ref id="CR105">
      <label>105.</label>
      <mixed-citation publication-type="other">MOP-DGA. <italic>Balance Hídrico de América del Sur</italic>. (1988).</mixed-citation>
    </ref>
    <ref id="CR106">
      <label>106.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Valdivielso</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Vázquez-Suñé</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Custodio</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Origin and variability of oxygen and hydrogen isotopic composition of precipitation in the Central Andes: A review</article-title>
        <source>J. Hydrol.</source>
        <year>2020</year>
        <volume>587</volume>
        <fpage>124899</fpage>
      </element-citation>
    </ref>
    <ref id="CR107">
      <label>107.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Valdivielso</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Vázquez-Suñé</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Custodio</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Environmental isotope concepts of precipitation and surface water and groundwater in the central andes: A review</article-title>
        <source>Bol. Geol. y Min.</source>
        <year>2021</year>
        <volume>132</volume>
        <fpage>147</fpage>
        <lpage>156</lpage>
      </element-citation>
    </ref>
    <ref id="CR108">
      <label>108.</label>
      <mixed-citation publication-type="other">SGA. <italic>Estudio Hidrogeológico y Modelo Numérico sector sur del Salar de Atacama</italic>. (2015).</mixed-citation>
    </ref>
    <ref id="CR109">
      <label>109.</label>
      <mixed-citation publication-type="other">Salas, J., Moreno, R., Moreno, R. &amp; Bruno, J. <italic>Interpretación y Contexto Hidrogeológico de Los Puntos de Control del Plan de Contingencia del Sistema Soncor. Análisis de su Representatividad</italic>. (2010).</mixed-citation>
    </ref>
    <ref id="CR110">
      <label>110.</label>
      <mixed-citation publication-type="other">Geol, X. I. I. C., Santiago, C., Geol, C., Ambiente, M. &amp; Cient, S. Estudio de la relación isotópica δ <sup>18</sup>O/δ<sup>2</sup>H de los manantiales en el sector de las nacientes del Loa, Región de Antofagasta. in <italic>XII Congress Geológico Chile.</italic> 16–19 (2009).</mixed-citation>
    </ref>
    <ref id="CR111">
      <label>111.</label>
      <mixed-citation publication-type="other">Villablanca, D. Estudio de la relación isotópica δ<sup>18</sup>O/δ<sup>2</sup>H de los manantiales en el sector de las nacientes del Loa, Región de Antofagasta. in <italic>XII Congress Geológico Chile.</italic> 22–26 (2009).</mixed-citation>
    </ref>
    <ref id="CR112">
      <label>112.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Valdivielso</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hassanzadeh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vázquez-Suñé</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Custodio</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Criollo</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Spatial distribution of meteorological factors controlling stable isotopes in precipitation in Northern Chile</article-title>
        <source>J. Hydrol.</source>
        <year>2022</year>
        <volume>605</volume>
        <fpage>127380</fpage>
      </element-citation>
    </ref>
    <ref id="CR113">
      <label>113.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fritz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Suzuki</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Silva</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Salati</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Isotope hydrology of groundwaters in the Pampa del Tamarugal</article-title>
        <source>Chile J. Hydrol.</source>
        <year>1981</year>
        <volume>53</volume>
        <fpage>161</fpage>
        <lpage>184</lpage>
      </element-citation>
    </ref>
    <ref id="CR114">
      <label>114.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aravena</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Isotopic composition and origin of the precipitation in Northern Chile</article-title>
        <source>Appl. Geochem.</source>
        <year>1999</year>
        <volume>14</volume>
        <fpage>411</fpage>
        <lpage>422</lpage>
      </element-citation>
    </ref>
    <ref id="CR115">
      <label>115.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaffaut</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Coudrain-Ribstein</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Michelot</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Pouyaud</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Précipitation d’altitude du nord-Chili, origine des sources de vapeur et données isotopiques</article-title>
        <source>Bull. l’Inst. Français d’Études Andin.</source>
        <year>1998</year>
        <volume>27</volume>
        <fpage>367</fpage>
        <lpage>384</lpage>
      </element-citation>
    </ref>
    <ref id="CR116">
      <label>116.</label>
      <mixed-citation publication-type="other">Chaffaut, I. <italic>Precipitations d’Altitude</italic><italic>, </italic><italic>Eaux Souterraines et Changements Climatiques de l’Altiplano Nord-Chilien</italic>. (PhD Thesis of Université Paris Sud U.F.R. Scientifique D´Orsay, 1998).</mixed-citation>
    </ref>
    <ref id="CR117">
      <label>117.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boschetti</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Cifuentes</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Iacumin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Selmo</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Local meteoric water line of northern Chile (18°S–30°S): An application of error-in-variables regression to the oxygen and hydrogen stable isotope ratio of precipitation</article-title>
        <source>Water (Switzerland)</source>
        <year>2019</year>
        <volume>11</volume>
        <fpage>4</fpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
