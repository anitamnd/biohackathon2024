<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10039786</article-id>
    <article-id pub-id-type="pmid">36897019</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad127</article-id>
    <article-id pub-id-type="publisher-id">btad127</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genetics and Population Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SLEMM: million-scale genomic predictions with window-based SNP weighting</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Cheng</surname>
          <given-names>Jian</given-names>
        </name>
        <aff><institution>Department of Animal Science, North Carolina State University</institution>, Raleigh, NC 27695, <country country="US">United States</country></aff>
        <xref rid="btad127-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9996-4680</contrib-id>
        <name>
          <surname>Maltecca</surname>
          <given-names>Christian</given-names>
        </name>
        <aff><institution>Department of Animal Science, North Carolina State University</institution>, Raleigh, NC 27695, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>VanRaden</surname>
          <given-names>Paul M</given-names>
        </name>
        <aff><institution>Animal Genomics and Improvement Laboratory, USDA-ARS</institution>, Beltsville, MD 20705, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>O'Connell</surname>
          <given-names>Jeffrey R</given-names>
        </name>
        <aff><institution>Department of Medicine, University of Maryland School of Medicine</institution>, Baltimore, MD 21201, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Li</given-names>
        </name>
        <aff><institution>Department of Animal and Avian Sciences, University of Maryland</institution>, College Park, MD 20742, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6890-7539</contrib-id>
        <name>
          <surname>Jiang</surname>
          <given-names>Jicai</given-names>
        </name>
        <aff><institution>Department of Animal Science, North Carolina State University</institution>, Raleigh, NC 27695, <country country="US">United States</country></aff>
        <xref rid="btad127-cor1" ref-type="corresp"/>
        <!--jjiang26@ncsu.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schwartz</surname>
          <given-names>Russell</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad127-cor1">Corresponding author. Department of Animal Science, North Carolina State University, Raleigh, NC 27695, United States. E-mail: <email>jjiang26@ncsu.edu</email></corresp>
      <fn id="btad127-FM1">
        <p>Present address for Jian Cheng: Bayer Research &amp; Development Services LLC, St. Louis, MO 63167, United States</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-03-10">
      <day>10</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>3</issue>
    <elocation-id>btad127</elocation-id>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>27</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>07</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>07</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>25</day>
        <month>3</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad127.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The amount of genomic data is increasing exponentially. Using many genotyped and phenotyped individuals for genomic prediction is appealing yet challenging.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present SLEMM (short for Stochastic-Lanczos-Expedited Mixed Models), a new software tool, to address the computational challenge. SLEMM builds on an efficient implementation of the stochastic Lanczos algorithm for REML in a framework of mixed models. We further implement SNP weighting in SLEMM to improve its predictions. Extensive analyses on seven public datasets, covering 19 polygenic traits in three plant and three livestock species, showed that SLEMM with SNP weighting had overall the best predictive ability among a variety of genomic prediction methods including GCTA’s empirical BLUP, BayesR, KAML, and LDAK’s BOLT and BayesR models. We also compared the methods using nine dairy traits of ∼300k genotyped cows. All had overall similar prediction accuracies, except that KAML failed to process the data. Additional simulation analyses on up to 3 million individuals and 1 million SNPs showed that SLEMM was advantageous over counterparts as for computational performance. Overall, SLEMM can do million-scale genomic predictions with an accuracy comparable to BayesR.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The software is available at <ext-link xlink:href="https://github.com/jiang18/slemm" ext-link-type="uri">https://github.com/jiang18/slemm</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>USDA National Institute of Food and Agriculture</institution>
            <institution-id institution-id-type="DOI">10.13039/100005825</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>1023267</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>In modern animal and plant breeding, individuals are selected for breeding based on predictions of genetic merit. Pedigree-based predictions of genetic merits have been used for selection in animals and plants for many decades and achieved steady genetic progress. With the advancement of sequencing technologies, millions of genetic markers (e.g. SNPs) have been discovered in the genome of many species. With the availability of cost-effective SNP chips, genomic predictions that use many genotyped SNPs across the genome (<xref rid="btad127-B12" ref-type="bibr">Meuwissen et al. 2001</xref>) have been widely applied to animals and plants to improve genetic progress (<xref rid="btad127-B1" ref-type="bibr">Bernardo and Yu 2007</xref>; <xref rid="btad127-B24" ref-type="bibr">VanRaden et al. 2009</xref>) and to humans to predict polygenic risks of diseases (<xref rid="btad127-B3" ref-type="bibr">Chatterjee et al. 2016</xref>). Genomic selection is particularly attractive for complex traits with a low heritability that are often underlain by many loci with small effects (<xref rid="btad127-B6" ref-type="bibr">Goddard and Hayes 2009</xref>). One common method for genomic predictions is the genomic best linear unbiased prediction (GBLUP), which assumes that SNP effects are independent and identically distributed normal variables (<xref rid="btad127-B12" ref-type="bibr">Meuwissen et al. 2001</xref>; <xref rid="btad127-B22" ref-type="bibr">VanRaden 2008</xref>). This assumption, however, can adversely affect the predictions where major QTLs or genes underlie a trait. Various Bayesian methods that assume different prior distributions of SNP effects, such as BayesA, BayesB, and BayesR, have been developed and proven to outperform GBLUP for predicting phenotypes underlain by major QTLs (<xref rid="btad127-B12" ref-type="bibr">Meuwissen et al. 2001</xref>; <xref rid="btad127-B13" ref-type="bibr">Moser et al. 2015</xref>). BayesR is one of the widely used Bayesian methods, which assumes that SNP effects follow a mixture of four zero-mean normal distributions with relative variance weights of 0, 0.01, 0.1, and 1 (<xref rid="btad127-B13" ref-type="bibr">Moser et al. 2015</xref>). Bayesian methods can have flexible priors on SNP effects; however, the Markov chain Monte Carlo (MCMC) algorithms often used by these Bayesian methods are time consuming.</p>
    <p>It is appealing to tackle the computational challenge of Bayesian methods but maintain their advantage over GBLUP. One way is to implement the Bayesian methods with variational Bayes, e.g. LDAK (<xref rid="btad127-B32" ref-type="bibr">Zhang et al. 2021</xref>). Alternatively, many studies have attempted to weight SNPs to enable weighted GBLUP (<xref rid="btad127-B21" ref-type="bibr">Tiezzi and Maltecca 2015</xref>; <xref rid="btad127-B34" ref-type="bibr">Zhang et al. 2015</xref>, <xref rid="btad127-B33" ref-type="bibr">2016</xref>; <xref rid="btad127-B20" ref-type="bibr">Teissier et al. 2018</xref>; <xref rid="btad127-B11" ref-type="bibr">Mehrban et al. 2021</xref>; <xref rid="btad127-B34" ref-type="bibr">Zhang et al. 2015</xref>, <xref rid="btad127-B33" ref-type="bibr">2016</xref>). In particular, <xref rid="btad127-B29" ref-type="bibr">Yin et al. (2020)</xref> proposed a machine-learning-based method named KAML, which can optimize the SNP weights and fit large-effect SNPs as fixed effects in the GBLUP model. KAML outperformed GBLUP and had comparable accuracies to BayesR (<xref rid="btad127-B29" ref-type="bibr">Yin et al. 2020</xref>); however, this method has not been tested using a large dataset. The amount of genomic data is increasing exponentially in animal and plant breeding and in human disease risk prediction. It is appealing yet challenging to use millions of genotyped and phenotyped individuals for genomic predictions.</p>
    <p>This article presents a new software tool to address the challenge, which we refer to as SLEMM (short for Stochastic-Lanczos-Expedited Mixed Models). SLEMM can efficiently perform Stochastic Lanczos Restricted Maximum Likelihood (REML) analysis (<xref rid="btad127-B2" ref-type="bibr">Border and Becker, 2019</xref>) for millions of genotyped individuals and weight SNPs based on proximity and minor allele frequency (MAF). Because of linkage disequilibrium (LD) between SNPs, effect sizes of SNPs that are close to each other tend to be similar in model fitting (<xref rid="btad127-B28" ref-type="bibr">Yang and Tempelman 2012</xref>; <xref rid="btad127-B30" ref-type="bibr">Zeng et al. 2018</xref>), which stimulates proximity-based SNP weighting. SNP heritability estimation can be affected by the assumption of the relationship between MAF and SNP effect size (<xref rid="btad127-B18" ref-type="bibr">Speed et al. 2017</xref>). Such a relationship may be modeled to improve genomic predictions. We evaluated SLEMM with seven public datasets covering multiple animal and plant species, a large dairy cow dataset (300k animals) from the U.S. Council of Dairy Cattle Breeding (CDCB), and large simulation data. We compared SLEMM with GBLUP implemented in GCTA (<xref rid="btad127-B26" ref-type="bibr">Yang et al. 2015</xref>), BayesR (one of the fastest MCMC methods), LDAK (featuring variational Bayes implementation of mixture models), and KAML (highlighting machine learning), and demonstrated that SLEMM can do million-scale genomic predictions with an accuracy comparable to BayesR.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Statistical models</title>
      <p>SLEMM fits the following linear mixed model:</p>
      <disp-formula id="E1">
        <label>(1)</label>
        <mml:math id="M1" display="block" overflow="scroll">
          <mml:mtable>
            <mml:mtr>
              <mml:mtd>
                <mml:mi mathvariant="bold">y</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mi mathvariant="bold">X</mml:mi>
                <mml:mo mathvariant="bold">β</mml:mo>
                <mml:mo>+</mml:mo>
                <mml:mi mathvariant="bold">Z</mml:mi>
                <mml:mo mathvariant="bold">α</mml:mo>
                <mml:mo>+</mml:mo>
                <mml:mi mathvariant="bold">e</mml:mi>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mi mathvariant="bold">α</mml:mi>
                <mml:mo>∼</mml:mo>
                <mml:mi>N</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mn>0</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mi mathvariant="bold">W</mml:mi>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mo>σ</mml:mo>
                  </mml:mrow>
                  <mml:mo>α</mml:mo>
                  <mml:mn>2</mml:mn>
                </mml:msubsup>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mi mathvariant="bold">e</mml:mi>
                <mml:mo>∼</mml:mo>
                <mml:mi>N</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mn>0</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mi mathvariant="bold">R</mml:mi>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mo>σ</mml:mo>
                  </mml:mrow>
                  <mml:mi>e</mml:mi>
                  <mml:mn>2</mml:mn>
                </mml:msubsup>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>where <bold>y</bold> is a vector of phenotypes for a quantitative trait, <bold>β</bold> is a vector of fixed effects including mean, <bold>X</bold> is the design matrix for <bold>β</bold>, <bold>α</bold> is a vector of SNP effects with a diagonal covariance matrix <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mi mathvariant="bold">W</mml:mi><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula>, <bold>Z</bold> is a matrix of standardized genotypes, and <bold>e</bold> is a vector of residuals with diagonal covariance matrix <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mi mathvariant="bold">R</mml:mi><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula>. <bold>R</bold> is often equal to an identity matrix; however, when using deregressed estimated breeding values as <bold>y</bold> in a farm animal population, we need to precompute <bold>R</bold> to model their reliability (<xref rid="btad127-B22" ref-type="bibr">VanRaden 2008</xref>). Diagonal elements of <bold>W</bold> are weights with a mean of one for SNP effect variance; that is, <italic toggle="yes">W<sub>jj</sub></italic> represents the relative contribution of SNP <italic toggle="yes">j</italic> to genetic variance. Optimal SNP weighting can improve genomic prediction.</p>
    </sec>
    <sec>
      <title>2.2 SNP weighting</title>
      <p>We provide two schemes to optimize SNP weighting for genomic predictions. The first scheme is based on the MAF dependence of SNP effect sizes, which has been well studied for complex traits in humans (<xref rid="btad127-B26" ref-type="bibr">Yang et al. 2015</xref>; <xref rid="btad127-B18" ref-type="bibr">Speed et al. 2017</xref>; <xref rid="btad127-B17" ref-type="bibr">Schoech et al. 2019</xref>). It can be represented by the probability density function of the beta distribution (<xref rid="btad127-B25" ref-type="bibr">Wu et al. 2011</xref>):
where <italic toggle="yes">C</italic> is a scaling constant for achieving a mean weight of one, <italic toggle="yes">p<sub>j</sub></italic> is the MAF of SNP <italic toggle="yes">j</italic>, and <italic toggle="yes">a</italic> and <italic toggle="yes">b</italic> are two shape parameters of the beta distribution. As in the sequence kernel association test (<xref rid="btad127-B25" ref-type="bibr">Wu et al. 2011</xref>), setting 0 &lt; <italic toggle="yes">a </italic>≤<italic toggle="yes"> </italic>1 and <italic toggle="yes">b </italic>≥<italic toggle="yes"> </italic>1 can be used to increase the weight of rarer variants and decrease the weight of more common variants if rarer variants are expected to have larger effects. Setting <italic toggle="yes">a </italic>=<italic toggle="yes"> b </italic>=<italic toggle="yes"> </italic>1 denotes that all SNPs equally contribute to heritability regardless of their MAFs. It is common to assume that an SNP’s contribution to heritability is proportional to 2<italic toggle="yes">p</italic>(1−<italic toggle="yes">p</italic>) in animal breeding, which is equivalent to <italic toggle="yes">a </italic>=<italic toggle="yes"> b </italic>=<italic toggle="yes"> </italic>2 in our method. We can use grid search to determine the optimal values of <italic toggle="yes">a</italic> and <italic toggle="yes">b</italic> based on REML log-likelihood. In practice, we can set <italic toggle="yes">a </italic>=<italic toggle="yes"> b</italic> and search among a small set of values (e.g. {0.5, 1, 1.5, 2, 2.5} or {1, 1.25, 1.5, 1.75, 2}) to reduce search space.</p>
      <disp-formula id="E2">
        <label>(2)</label>
        <mml:math id="M2" display="block" overflow="scroll">
          <mml:mrow>
            <mml:msub>
              <mml:mrow>
                <mml:mi>W</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>j</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:mi>C</mml:mi>
            <mml:mo>⋅</mml:mo>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi>p</mml:mi>
              </mml:mrow>
              <mml:mi>j</mml:mi>
              <mml:mrow>
                <mml:mi>a</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:msubsup>
            <mml:msup>
              <mml:mrow>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>−</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                    </mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:msub>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>b</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:msup>
          </mml:mrow>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>Our second SNP weighting scheme is based on estimates of SNP effects with <bold>W</bold> equal to the identity. A QTL’s effect can be captured by its nearby SNPs because of LD, and SNPs in proximity to each other tend to show similar effects in model fitting. This leads us to develop the following window-based weighting scheme:
where <italic toggle="yes">C</italic> is defined the same as in <xref rid="E2" ref-type="disp-formula">equation (2)</xref>, <italic toggle="yes">S</italic> is the number of SNPs on each side of SNP <italic toggle="yes">j</italic>, and <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the estimate of <italic toggle="yes">k</italic>th SNP’s effect in an existing BLUP with <bold>W</bold> equal to the identity. This specification of <italic toggle="yes">j</italic>th SNP’s weight borrows information from a window of 2<italic toggle="yes">S </italic>+<italic toggle="yes"> </italic>1 SNPs. It is similar to the window-based weighting used in weighted ssGBLUP (<xref rid="btad127-B33" ref-type="bibr">Zhang et al. 2016</xref>). SLEMM fits <xref rid="E1" ref-type="disp-formula">model (1)</xref> with training data twice, first with <bold>W</bold> equal to identity and second with <bold>W</bold> computed by <xref rid="E3" ref-type="disp-formula">equation (3)</xref>.</p>
      <disp-formula id="E3">
        <label>(3)</label>
        <mml:math id="M3" display="block" overflow="scroll">
          <mml:mrow>
            <mml:msub>
              <mml:mrow>
                <mml:mi>W</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>j</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:mi>C</mml:mi>
            <mml:mo>⋅</mml:mo>
            <mml:mfrac>
              <mml:mn>1</mml:mn>
              <mml:mrow>
                <mml:mn>2</mml:mn>
                <mml:mi>S</mml:mi>
                <mml:mo>+</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:mfrac>
            <mml:munderover>
              <mml:mo>∑</mml:mo>
              <mml:mrow>
                <mml:mi>k</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mi>j</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mi>S</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>j</mml:mi>
                <mml:mo>+</mml:mo>
                <mml:mi>S</mml:mi>
              </mml:mrow>
            </mml:munderover>
            <mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mover accent="true">
                      <mml:mi>α</mml:mi>
                      <mml:mo>^</mml:mo>
                    </mml:mover>
                  </mml:mrow>
                </mml:mrow>
                <mml:mi>k</mml:mi>
                <mml:mn>2</mml:mn>
              </mml:msubsup>
            </mml:mrow>
          </mml:mrow>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>Assuming that the two SNP weighting schemes produce independent weights, we can combine them using
in which all parameters are the same as defined in <xref rid="E2" ref-type="disp-formula">equations (2)</xref> and <xref rid="E3" ref-type="disp-formula">(3)</xref>. In this case, SLEMM fits <xref rid="E1" ref-type="disp-formula">model (1)</xref> with training data twice, first with <bold>W</bold> equal to identity and second with <bold>W</bold> computed by <xref rid="E4" ref-type="disp-formula">equation (4)</xref>.</p>
      <disp-formula id="E4">
        <label>(4)</label>
        <mml:math id="M4" display="block" overflow="scroll">
          <mml:mrow>
            <mml:msub>
              <mml:mrow>
                <mml:mi>W</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>j</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:mi>C</mml:mi>
            <mml:mo>⋅</mml:mo>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi>p</mml:mi>
              </mml:mrow>
              <mml:mi>j</mml:mi>
              <mml:mrow>
                <mml:mi>a</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:msubsup>
            <mml:msup>
              <mml:mrow>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>−</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                    </mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:msub>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>b</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mo>⋅</mml:mo>
            <mml:mfrac>
              <mml:mn>1</mml:mn>
              <mml:mrow>
                <mml:mn>2</mml:mn>
                <mml:mi>S</mml:mi>
                <mml:mo>+</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:mfrac>
            <mml:munderover>
              <mml:mo>∑</mml:mo>
              <mml:mrow>
                <mml:mi>k</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mi>j</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mi>S</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>j</mml:mi>
                <mml:mo>+</mml:mo>
                <mml:mi>S</mml:mi>
              </mml:mrow>
            </mml:munderover>
            <mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mover accent="true">
                      <mml:mi>α</mml:mi>
                      <mml:mo>^</mml:mo>
                    </mml:mover>
                  </mml:mrow>
                </mml:mrow>
                <mml:mi>k</mml:mi>
                <mml:mn>2</mml:mn>
              </mml:msubsup>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
    </sec>
    <sec>
      <title>2.3 Stochastic Lanczos algorithms and software</title>
      <p>SLEMM builds on efficient REML for <xref rid="E1" ref-type="disp-formula">model (1)</xref>. Following <xref rid="btad127-B2" ref-type="bibr">Border and Becker (2019)</xref>, we applied the stochastic Lanczos REML (SL-REML) algorithms in the linear mixed model. Compared to the previous SL-REML method (<xref rid="btad127-B2" ref-type="bibr">Border and Becker 2019</xref>), SLEMM allows <bold>W</bold> and <bold>R</bold> to be non-identity, which is important for genomic prediction, particularly in animal breeding. Given the REML estimates of variance components, it is straightforward to compute BLUPs of SNP effects. Details on the algorithms are provided in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>.</p>
      <p>SLEMM is written in C++ and powered by the Eigen library. It uses bool vectors to store genotypes in memory, occupying two bits per SNP per individual. SLEMM has a time complexity of <italic toggle="yes">O</italic>(<italic toggle="yes">mn</italic><sup>1.5</sup>) and uses <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mo>&lt;</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="italic">mn</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> bytes for <italic toggle="yes">n</italic> individuals and <italic toggle="yes">m</italic> SNPs.</p>
    </sec>
    <sec>
      <title>2.4 Benchmarking</title>
      <p>We compared SLEMM to GCTA’s empirical GBLUP (<xref rid="btad127-B26" ref-type="bibr">Yang et al. 2015</xref>), KAML (<xref rid="btad127-B29" ref-type="bibr">Yin et al. 2020</xref>), BayesR (specifically, BayesRv2 at <ext-link xlink:href="https://github.com/syntheke/bayesR" ext-link-type="uri">https://github.com/syntheke/bayesR</ext-link>) (<xref rid="btad127-B13" ref-type="bibr">Moser et al. 2015</xref>), and LDAK’s BOLT and BayesR methods (<xref rid="btad127-B32" ref-type="bibr">Zhang et al. 2021</xref>). GCTA’s empirical GBLUP assumes that all SNPs contribute equally to SNP heritability. KAML fits large SNPs effects as fixed in a linear mixed model and optimizes SNP weights in the genomic relationship matrix (GRM) using a machine learning method. BayesR uses a Bayesian mixture model along with a computationally optimized Gibbs sampling algorithm, which assumes that SNP effects follow a mixture of four zero-mean normal distributions with relative variance weights of 0, 0.01, 0.1, and 1. LDAK-BayesR is based on largely the same model as BayesR but uses a variational Bayes method instead of Gibbs sampling to fit the model. LDAK-BOLT adopts the prediction method of BOLT-LMM (<xref rid="btad127-B9" ref-type="bibr">Loh et al. 2015</xref>), which is based on a mixture of two zero-mean normal distributions, one with a relatively small variance and the other with a relatively large variance. Both the LDAK prediction methods use grid search and cross-validation to optimize the hyper-parameters in the mixture priors. They have two versions, one for using individual data and the other for using summary statistics. In addition, LDAK can use pre-specified weights for individual SNPs in the predictions. In our analysis, we used the versions for individual data and MAF-based SNP weighting.</p>
      <p>We applied the following key settings to all our analyses: optimized MAF-based SNP weighting for SLEMM-MAFopt; a fixed window size of 20 and optimized MAF-based SNP weighting for SLEMM-WW-MAFopt; defaults for KAML; blocksize = 4, msize = 500, number of MCMC iterations = 50 000, and burn-in = 20 000 iterations for BayesR; and defaults for LDAK with MAF-based SNP weighting the same as SLEMM-MAFopt.</p>
      <p>We used repeated random sub-sampling validation to evaluate the predictive ability of the aforementioned methods with seven public datasets. Each dataset was randomly split into a training population (about 80% of individuals) and a validation population (about 20% of individuals) for 20 replicates. Five-fold cross-validation was used for the large dairy cow data to reduce computational time. Predictive ability was calculated as the Pearson correlation in the validation population between genomic estimated breeding values (GEBVs) and pre-adjusted phenotypes or (de-regressed) EBVs.</p>
      <p>Computational speed and memory usage were evaluated using simulated data for SLEMM, KAML, BayesR, and LDAK. All evaluations were conducted on a Linux server with 2x Intel(R) Xeon(R) Gold 6258R CPU and 512 GB of memory. Ten threads were used for SLEMM, KAML, and LDAK, whereas four threads (=block size) were used for BayesR. Ten threads were tried for BayesR, but it slowed down the computation and sometimes led to failure.</p>
    </sec>
    <sec>
      <title>2.5 Real data</title>
      <p>We analyzed 19 livestock and plant traits in seven public datasets and nine dairy traits in a large cow dataset from the U.S. CDCB. A summary of the datasets is shown in <xref rid="btad127-T1" ref-type="table">Table 1</xref>, and a detailed description on each dataset is available in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>.</p>
      <table-wrap position="float" id="btad127-T1">
        <label>Table 1.</label>
        <caption>
          <p>Summary of datasets.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Species</th>
              <th align="center" rowspan="1" colspan="1">Sample size</th>
              <th align="center" rowspan="1" colspan="1">Trait ([pseudo-] heritability)</th>
              <th align="center" rowspan="1" colspan="1">Genotype (# SNPs)</th>
              <th align="center" rowspan="1" colspan="1">Genotyping platform</th>
              <th align="center" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Dairy bull</td>
              <td rowspan="1" colspan="1">5024</td>
              <td rowspan="1" colspan="1">MY (0.94), MFP (0.95), SCS (0.88)</td>
              <td rowspan="1" colspan="1">42 551</td>
              <td rowspan="1" colspan="1">Illumina Bovine SNP50 Beadchip</td>
              <td rowspan="1" colspan="1">
                <xref rid="btad127-B34" ref-type="bibr">Zhang et al. (2015)</xref>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Duroc pig</td>
              <td rowspan="1" colspan="1">2785</td>
              <td rowspan="1" colspan="1">BF (0.25), LMD (0.35), TTN (0.30)</td>
              <td rowspan="1" colspan="1">49 564</td>
              <td rowspan="1" colspan="1">Low-coverage whole-genome sequencing</td>
              <td rowspan="1" colspan="1">
                <xref rid="btad127-B27" ref-type="bibr">Yang et al. (2021)</xref>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Four pig breeds</td>
              <td rowspan="1" colspan="1">4260</td>
              <td rowspan="1" colspan="1">ADG (0.49), AGE (0.51)</td>
              <td rowspan="1" colspan="1">47 157</td>
              <td rowspan="1" colspan="1">Illumina PorcineSNP50 Beadchip</td>
              <td rowspan="1" colspan="1">
                <xref rid="btad127-B19" ref-type="bibr">Tang et al. (2019)</xref>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Chicken</td>
              <td rowspan="1" colspan="1">1063</td>
              <td rowspan="1" colspan="1">EW1 (0.31), EW36 (0.36), EW56 (0.23)</td>
              <td rowspan="1" colspan="1">44 430</td>
              <td rowspan="1" colspan="1">Affymetrix 600K chicken SNP chip</td>
              <td rowspan="1" colspan="1">
                <xref rid="btad127-B8" ref-type="bibr">Liu et al. (2018)</xref>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Maize</td>
              <td rowspan="1" colspan="1">1868</td>
              <td rowspan="1" colspan="1">Sweet (0.60), GDD (0.70)</td>
              <td rowspan="1" colspan="1">45 426</td>
              <td rowspan="1" colspan="1">Genotyping by sequencing</td>
              <td rowspan="1" colspan="1">
                <xref rid="btad127-B16" ref-type="bibr">Romay et al. (2013)</xref>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Wheat</td>
              <td rowspan="1" colspan="1">599</td>
              <td rowspan="1" colspan="1">GY1 (0.29), GY2 (0.26), GY3 (0.28), GY4 (0.27)</td>
              <td rowspan="1" colspan="1">1,279</td>
              <td rowspan="1" colspan="1">Diversity Array Technology (DArT)</td>
              <td rowspan="1" colspan="1">
                <ext-link xlink:href="http://cran.r-project.org/web/packages/BLR/index.html" ext-link-type="uri">http://cran.r-project.org/web/packages/BLR/index.html</ext-link>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Pine</td>
              <td rowspan="1" colspan="1">861</td>
              <td rowspan="1" colspan="1">DBH (0.31), HT (0.31)</td>
              <td rowspan="1" colspan="1">4853</td>
              <td rowspan="1" colspan="1">Illumina Infinium assay</td>
              <td rowspan="1" colspan="1">
                <xref rid="btad127-B15" ref-type="bibr">Resende et al. (2012)</xref>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Dairy cow</td>
              <td rowspan="1" colspan="1">294 079</td>
              <td rowspan="1" colspan="1">Milk (0.34), Fat (0.31), Pro (0.27), FPC (0.42), PPC (0.44),</td>
              <td rowspan="1" colspan="1">60 671</td>
              <td rowspan="1" colspan="1">Imputed from 18 SNP chips with 2710 to 60 671 original SNPs</td>
              <td rowspan="1" colspan="1">
                <xref rid="btad127-B7" ref-type="bibr">Jiang et al. (2019)</xref>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">SCS (0.10), DPR (0.04), CCR (0.05), HCR (0.01)</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p>MY, milk yield; MFP, milk fat percentage; SCS, somatic cell score; BF, backfat; LMD, loin muscle depth; TTN, total teat number; ADG, average daily gain; AGE, off-test age; EW1, first egg weight; EW36, egg weight at 36 weeks old; EW56, egg weight at 56 weeks old; Sweet, kernel is sweet or starchy; GDD, growing degree days; GY1, grain yield in environment 1; GY2, grain yield in environment 2; GY3, grain yield in environment 3; GY4, grain yield in environment 4; DBH, stem diameter; HT, total stem height; Milk, milk yield; Fat, fat yield; Pro, protein yield; FPC, milk fat percentage; PPC, milk protein percentage; CCR, cow conception rate; HCR, heifer conception rate; DPR, daughter pregnancy rate.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>2.6 Simulation</title>
      <p>We simulated two datasets, one with 3M unrelated animals and 50k SNPs and the other with 1M SNPs and 100k unrelated animals. The former dataset was used to evaluate the computational performance with respect to sample size (100k, 200k, 300k, 400k, 500k, 1M, and 3M animals), while the latter dataset was used to evaluate the computational performance with respect to the number of SNPs (200k, 400k, 600k, 800k, and 1M SNPs). Genotypes were simulated using the software genosim (<xref rid="btad127-B23" ref-type="bibr">VanRaden et al. 2015</xref>) with default input parameters; in particular, we set LDparam = 0.965 to mimic a high level of LD. We randomly selected 5000 SNPs as QTLs and sampled QTL effects from the standard normal distribution. Phenotypes with a heritability of 0.3 were simulated by adding the additive genetic effects and residual effects.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>Considering the involvedness of the genetic architecture of complex traits, we used only real data to evaluate prediction accuracy, including 19 traits from publicly available plant and livestock data and 9 traits of 300k dairy cows from the U.S. CDCB. We used simulation to benchmark computing time and memory usage. We considered three types of empirical GBLUP analyses in SLEMM: (i) non-weighted GBLUP (SLEMM-NW) that assumes all SNPs contribute equally to SNP heritability without SNP weighting, (ii) SLEMM-MAFopt that optimizes SNP weighting based on MAF, and (iii) SLEMM-WW-MAFopt that weights SNPs based on both MAF and proximity. We compared SLEMM to non-weighted empirical GBLUP implemented in GCTA (GCTA-NW), KAML, BayesR, and two LDAK models (LDAK-BayesR and LDAK-BOLT).</p>
    <sec>
      <title>3.1 Public livestock and plant data</title>
      <p><xref rid="btad127-T2" ref-type="table">Table 2</xref> shows the prediction accuracies for 11 traits in four livestock (dairy bull, pig, and chicken) datasets and eight traits in three plant (maize, wheat, and pine) datasets (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S1–S7</xref> for each individual dataset). BayesR performed abnormally for the dataset of four pig breeds and the maize dataset, and KAML failed in the maize data. So, the two datasets were excluded from the software comparison. SLEMM-NW had exactly the same prediction accuracy as GCTA-NW, which is expected because they are the same non-weighted empirical GBLUP. SLEMM-WW-MAFopt, KAML, BayesR, LDAK-BayesR, and LDAK-BOLT (with an overall accuracy of 0.489, 0.486, 0.492, 0.489, and 0.488, respectively) outperformed SLEMM-NW (0.475) for livestock traits. SLEMM-WW-MAFopt (with an overall accuracy of 0.453) performed similarly to SLEMM-NW (0.452) for plant traits, and they both outperformed KAML (0.434), BayesR (0.441), LDAK-BayesR (0.422), and LDAK-BOLT (0.431). Additionally, SLEMM-MAFopt which optimizes SNP weighting based on MAF had an overall accuracy similar to SLEMM-NW for both livestock (0.480 versus 0.475) and plant (0.455 versus 0.452) traits. Collectively, SLEMM-WW-MAFopt had the best predictive ability.</p>
      <table-wrap position="float" id="btad127-T2">
        <label>Table 2.</label>
        <caption>
          <p>Average predictive ability across 20 replicates in repeated random sub-sampling validation for each trait in seven public datasets.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Trait</th>
              <th rowspan="1" colspan="1">GCTA-NW (SD<xref rid="tblfn2" ref-type="table-fn"><sup>a</sup></xref>)</th>
              <th rowspan="1" colspan="1">SLEMM-NW</th>
              <th rowspan="1" colspan="1">SLEMM-MAFopt</th>
              <th rowspan="1" colspan="1">SLEMM-WW–MAFopt</th>
              <th rowspan="1" colspan="1">KAML</th>
              <th rowspan="1" colspan="1">BayesR</th>
              <th rowspan="1" colspan="1">LDAK-BayesR</th>
              <th rowspan="1" colspan="1">LDAK-BOLT</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Dairy bull</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> MY</td>
              <td rowspan="1" colspan="1">0.766 (0.009)</td>
              <td rowspan="1" colspan="1">0.766</td>
              <td rowspan="1" colspan="1">0.770</td>
              <td rowspan="1" colspan="1">0.784</td>
              <td rowspan="1" colspan="1">0.785</td>
              <td rowspan="1" colspan="1">0.786</td>
              <td rowspan="1" colspan="1">0.780</td>
              <td rowspan="1" colspan="1">0.783</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> MFP</td>
              <td rowspan="1" colspan="1">0.803 (0.011)</td>
              <td rowspan="1" colspan="1">0.803</td>
              <td rowspan="1" colspan="1">0.816</td>
              <td rowspan="1" colspan="1">0.865</td>
              <td rowspan="1" colspan="1">0.862</td>
              <td rowspan="1" colspan="1">0.870</td>
              <td rowspan="1" colspan="1">0.856</td>
              <td rowspan="1" colspan="1">0.860</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> SCS</td>
              <td rowspan="1" colspan="1">0.737 (0.011)</td>
              <td rowspan="1" colspan="1">0.737</td>
              <td rowspan="1" colspan="1">0.739</td>
              <td rowspan="1" colspan="1">0.742</td>
              <td rowspan="1" colspan="1">0.741</td>
              <td rowspan="1" colspan="1">0.740</td>
              <td rowspan="1" colspan="1">0.739</td>
              <td rowspan="1" colspan="1">0.738</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> Average</td>
              <td rowspan="1" colspan="1">0.769</td>
              <td rowspan="1" colspan="1">0.769</td>
              <td rowspan="1" colspan="1">0.775</td>
              <td rowspan="1" colspan="1">0.797</td>
              <td rowspan="1" colspan="1">0.796</td>
              <td rowspan="1" colspan="1">0.799</td>
              <td rowspan="1" colspan="1">0.792</td>
              <td rowspan="1" colspan="1">0.794</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Duroc pig</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> BF</td>
              <td rowspan="1" colspan="1">0.321 (0.053)</td>
              <td rowspan="1" colspan="1">0.321</td>
              <td rowspan="1" colspan="1">0.321</td>
              <td rowspan="1" colspan="1">0.327</td>
              <td rowspan="1" colspan="1">0.321</td>
              <td rowspan="1" colspan="1">0.329</td>
              <td rowspan="1" colspan="1">0.321</td>
              <td rowspan="1" colspan="1">0.318</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> LMD</td>
              <td rowspan="1" colspan="1">0.345 (0.038)</td>
              <td rowspan="1" colspan="1">0.345</td>
              <td rowspan="1" colspan="1">0.345</td>
              <td rowspan="1" colspan="1">0.343</td>
              <td rowspan="1" colspan="1">0.351</td>
              <td rowspan="1" colspan="1">0.354</td>
              <td rowspan="1" colspan="1">0.350</td>
              <td rowspan="1" colspan="1">0.352</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> TTN</td>
              <td rowspan="1" colspan="1">0.388 (0.033)</td>
              <td rowspan="1" colspan="1">0.388</td>
              <td rowspan="1" colspan="1">0.392</td>
              <td rowspan="1" colspan="1">0.405</td>
              <td rowspan="1" colspan="1">0.413</td>
              <td rowspan="1" colspan="1">0.415</td>
              <td rowspan="1" colspan="1">0.408</td>
              <td rowspan="1" colspan="1">0.403</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> Average</td>
              <td rowspan="1" colspan="1">0.351</td>
              <td rowspan="1" colspan="1">0.351</td>
              <td rowspan="1" colspan="1">0.353</td>
              <td rowspan="1" colspan="1">0.358</td>
              <td rowspan="1" colspan="1">0.362</td>
              <td rowspan="1" colspan="1">0.366</td>
              <td rowspan="1" colspan="1">0.360</td>
              <td rowspan="1" colspan="1">0.358</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Four pig breeds</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> ADG</td>
              <td rowspan="1" colspan="1">0.572 (0.017)</td>
              <td rowspan="1" colspan="1">0.572</td>
              <td rowspan="1" colspan="1">0.572</td>
              <td rowspan="1" colspan="1">0.564</td>
              <td rowspan="1" colspan="1">0.567</td>
              <td rowspan="1" colspan="1">–</td>
              <td rowspan="1" colspan="1">0.568</td>
              <td rowspan="1" colspan="1">0.571</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> AGE</td>
              <td rowspan="1" colspan="1">0.563 (0.016)</td>
              <td rowspan="1" colspan="1">0.563</td>
              <td rowspan="1" colspan="1">0.563</td>
              <td rowspan="1" colspan="1">0.555</td>
              <td rowspan="1" colspan="1">0.557</td>
              <td rowspan="1" colspan="1">–</td>
              <td rowspan="1" colspan="1">0.559</td>
              <td rowspan="1" colspan="1">0.561</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> Average</td>
              <td rowspan="1" colspan="1">0.568</td>
              <td rowspan="1" colspan="1">0.568</td>
              <td rowspan="1" colspan="1">0.568</td>
              <td rowspan="1" colspan="1">0.560</td>
              <td rowspan="1" colspan="1">0.562</td>
              <td rowspan="1" colspan="1">–</td>
              <td rowspan="1" colspan="1">0.564</td>
              <td rowspan="1" colspan="1">0.566</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Chicken</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> EW1</td>
              <td rowspan="1" colspan="1">0.300 (0.053)</td>
              <td rowspan="1" colspan="1">0.300</td>
              <td rowspan="1" colspan="1">0.299</td>
              <td rowspan="1" colspan="1">0.307</td>
              <td rowspan="1" colspan="1">0.280</td>
              <td rowspan="1" colspan="1">0.301</td>
              <td rowspan="1" colspan="1">0.298</td>
              <td rowspan="1" colspan="1">0.300</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> EW36</td>
              <td rowspan="1" colspan="1">0.362 (0.066)</td>
              <td rowspan="1" colspan="1">0.362</td>
              <td rowspan="1" colspan="1">0.378</td>
              <td rowspan="1" colspan="1">0.374</td>
              <td rowspan="1" colspan="1">0.380</td>
              <td rowspan="1" colspan="1">0.373</td>
              <td rowspan="1" colspan="1">0.384</td>
              <td rowspan="1" colspan="1">0.383</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> EW56</td>
              <td rowspan="1" colspan="1">0.255 (0.059)</td>
              <td rowspan="1" colspan="1">0.255</td>
              <td rowspan="1" colspan="1">0.263</td>
              <td rowspan="1" colspan="1">0.253</td>
              <td rowspan="1" colspan="1">0.239</td>
              <td rowspan="1" colspan="1">0.257</td>
              <td rowspan="1" colspan="1">0.261</td>
              <td rowspan="1" colspan="1">0.259</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> Average</td>
              <td rowspan="1" colspan="1">0.306</td>
              <td rowspan="1" colspan="1">0.306</td>
              <td rowspan="1" colspan="1">0.313</td>
              <td rowspan="1" colspan="1">0.311</td>
              <td rowspan="1" colspan="1">0.300</td>
              <td rowspan="1" colspan="1">0.310</td>
              <td rowspan="1" colspan="1">0.314</td>
              <td rowspan="1" colspan="1">0.314</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Livestock average</td>
              <td rowspan="1" colspan="1">0.475</td>
              <td rowspan="1" colspan="1">0.475</td>
              <td rowspan="1" colspan="1">0.480</td>
              <td rowspan="1" colspan="1">0.489</td>
              <td rowspan="1" colspan="1">0.486</td>
              <td rowspan="1" colspan="1">0.492</td>
              <td rowspan="1" colspan="1">0.489</td>
              <td rowspan="1" colspan="1">0.488</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Maize</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> Sweet</td>
              <td rowspan="1" colspan="1">0.895 (0.039)</td>
              <td rowspan="1" colspan="1">0.895</td>
              <td rowspan="1" colspan="1">0.895</td>
              <td rowspan="1" colspan="1">0.900</td>
              <td rowspan="1" colspan="1">–</td>
              <td rowspan="1" colspan="1">–</td>
              <td rowspan="1" colspan="1">0.898</td>
              <td rowspan="1" colspan="1">0.900</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> GDD</td>
              <td rowspan="1" colspan="1">0.904 (0.011)</td>
              <td rowspan="1" colspan="1">0.904</td>
              <td rowspan="1" colspan="1">0.900</td>
              <td rowspan="1" colspan="1">0.899</td>
              <td rowspan="1" colspan="1">–</td>
              <td rowspan="1" colspan="1">–</td>
              <td rowspan="1" colspan="1">0.888</td>
              <td rowspan="1" colspan="1">0.896</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> Average</td>
              <td rowspan="1" colspan="1">0.900</td>
              <td rowspan="1" colspan="1">0.900</td>
              <td rowspan="1" colspan="1">0.898</td>
              <td rowspan="1" colspan="1">0.900</td>
              <td rowspan="1" colspan="1">–</td>
              <td rowspan="1" colspan="1">–</td>
              <td rowspan="1" colspan="1">0.893</td>
              <td rowspan="1" colspan="1">0.898</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Wheat</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> GY1</td>
              <td rowspan="1" colspan="1">0.503 (0.063)</td>
              <td rowspan="1" colspan="1">0.503</td>
              <td rowspan="1" colspan="1">0.509</td>
              <td rowspan="1" colspan="1">0.502</td>
              <td rowspan="1" colspan="1">0.477</td>
              <td rowspan="1" colspan="1">0.491</td>
              <td rowspan="1" colspan="1">0.465</td>
              <td rowspan="1" colspan="1">0.488</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> GY2</td>
              <td rowspan="1" colspan="1">0.506 (0.052)</td>
              <td rowspan="1" colspan="1">0.506</td>
              <td rowspan="1" colspan="1">0.512</td>
              <td rowspan="1" colspan="1">0.511</td>
              <td rowspan="1" colspan="1">0.502</td>
              <td rowspan="1" colspan="1">0.496</td>
              <td rowspan="1" colspan="1">0.485</td>
              <td rowspan="1" colspan="1">0.491</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> GY3</td>
              <td rowspan="1" colspan="1">0.411 (0.071)</td>
              <td rowspan="1" colspan="1">0.411</td>
              <td rowspan="1" colspan="1">0.406</td>
              <td rowspan="1" colspan="1">0.417</td>
              <td rowspan="1" colspan="1">0.390</td>
              <td rowspan="1" colspan="1">0.406</td>
              <td rowspan="1" colspan="1">0.373</td>
              <td rowspan="1" colspan="1">0.384</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> GY4</td>
              <td rowspan="1" colspan="1">0.431 (0.051)</td>
              <td rowspan="1" colspan="1">0.431</td>
              <td rowspan="1" colspan="1">0.447</td>
              <td rowspan="1" colspan="1">0.443</td>
              <td rowspan="1" colspan="1">0.431</td>
              <td rowspan="1" colspan="1">0.424</td>
              <td rowspan="1" colspan="1">0.412</td>
              <td rowspan="1" colspan="1">0.417</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> Average</td>
              <td rowspan="1" colspan="1">0.463</td>
              <td rowspan="1" colspan="1">0.463</td>
              <td rowspan="1" colspan="1">0.469</td>
              <td rowspan="1" colspan="1">0.468</td>
              <td rowspan="1" colspan="1">0.450</td>
              <td rowspan="1" colspan="1">0.454</td>
              <td rowspan="1" colspan="1">0.434</td>
              <td rowspan="1" colspan="1">0.445</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Pine</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> DBH</td>
              <td rowspan="1" colspan="1">0.464 (0.052)</td>
              <td rowspan="1" colspan="1">0.464</td>
              <td rowspan="1" colspan="1">0.460</td>
              <td rowspan="1" colspan="1">0.459</td>
              <td rowspan="1" colspan="1">0.442</td>
              <td rowspan="1" colspan="1">0.453</td>
              <td rowspan="1" colspan="1">0.443</td>
              <td rowspan="1" colspan="1">0.447</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> HT</td>
              <td rowspan="1" colspan="1">0.394 (0.050)</td>
              <td rowspan="1" colspan="1">0.394</td>
              <td rowspan="1" colspan="1">0.394</td>
              <td rowspan="1" colspan="1">0.384</td>
              <td rowspan="1" colspan="1">0.362</td>
              <td rowspan="1" colspan="1">0.377</td>
              <td rowspan="1" colspan="1">0.351</td>
              <td rowspan="1" colspan="1">0.359</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> Average</td>
              <td rowspan="1" colspan="1">0.429</td>
              <td rowspan="1" colspan="1">0.429</td>
              <td rowspan="1" colspan="1">0.427</td>
              <td rowspan="1" colspan="1">0.422</td>
              <td rowspan="1" colspan="1">0.402</td>
              <td rowspan="1" colspan="1">0.415</td>
              <td rowspan="1" colspan="1">0.397</td>
              <td rowspan="1" colspan="1">0.403</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Plant average</td>
              <td rowspan="1" colspan="1">0.452</td>
              <td rowspan="1" colspan="1">0.452</td>
              <td rowspan="1" colspan="1">0.455</td>
              <td rowspan="1" colspan="1">0.453</td>
              <td rowspan="1" colspan="1">0.434</td>
              <td rowspan="1" colspan="1">0.441</td>
              <td rowspan="1" colspan="1">0.422</td>
              <td rowspan="1" colspan="1">0.431</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn2">
            <label>a</label>
            <p>SD is the standard deviation of predictive ability across 20 replicates in repeated random sub-sampling validation for each trait. It was only provided for GCTA-NW because SD was similar across different methods.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>3.2 CDCB dairy cow data</title>
      <p><xref rid="btad127-T3" ref-type="table">Table 3</xref> shows the predictive ability of the methods in comparison for production, reproduction, and health traits in the large dairy cow data. LDAK-BayesR was not included in this comparison, because its predictive ability is close to that of LDAK-BOLT as shown in an earlier study (<xref rid="btad127-B32" ref-type="bibr">Zhang et al. 2021</xref>) and in our analysis of the public livestock and plant data. KAML failed to process such a large dataset. We particularly added ordinary least squares (OLS) for comparison, as it was feasible for the cow data. All the methods except OLS had overall similar predictive abilities. SLEMM-WW-MAFopt and LDAK slightly outperformed SLEMM-NW for milk fat and protein percentage traits. OLS had a much lower predictive ability than other methods for all the dairy traits.</p>
      <table-wrap position="float" id="btad127-T3">
        <label>Table 3.</label>
        <caption>
          <p>Average predictive ability of five-fold cross-validation for each trait in the large dairy cow data.<xref rid="tblfn3" ref-type="table-fn"><sup>a</sup></xref></p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="2" colspan="1">Method</th>
              <th colspan="6" align="center" rowspan="1">Production traits<hr/></th>
              <th align="center" rowspan="1" colspan="1">Health<hr/></th>
              <th colspan="4" align="center" rowspan="1">Reproduction traits<hr/></th>
            </tr>
            <tr>
              <th align="center" rowspan="1" colspan="1">FPC</th>
              <th align="center" rowspan="1" colspan="1">PPC</th>
              <th align="center" rowspan="1" colspan="1">Milk</th>
              <th align="center" rowspan="1" colspan="1">Fat</th>
              <th align="center" rowspan="1" colspan="1">Pro</th>
              <th align="center" rowspan="1" colspan="1">Average</th>
              <th align="center" rowspan="1" colspan="1">SCS</th>
              <th align="center" rowspan="1" colspan="1">CCR</th>
              <th align="center" rowspan="1" colspan="1">HCR</th>
              <th align="center" rowspan="1" colspan="1">DPR</th>
              <th align="center" rowspan="1" colspan="1">Average</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">SLEMM-NW</td>
              <td rowspan="1" colspan="1">0.636</td>
              <td rowspan="1" colspan="1">0.659</td>
              <td rowspan="1" colspan="1">0.479</td>
              <td rowspan="1" colspan="1">0.449</td>
              <td rowspan="1" colspan="1">0.425</td>
              <td rowspan="1" colspan="1">0.530</td>
              <td rowspan="1" colspan="1">0.243</td>
              <td rowspan="1" colspan="1">0.136</td>
              <td rowspan="1" colspan="1">0.073</td>
              <td rowspan="1" colspan="1">0.160</td>
              <td rowspan="1" colspan="1">0.123</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SLEMM-MAFopt</td>
              <td rowspan="1" colspan="1">0.636</td>
              <td rowspan="1" colspan="1">0.659</td>
              <td rowspan="1" colspan="1">0.479</td>
              <td rowspan="1" colspan="1">0.449</td>
              <td rowspan="1" colspan="1">0.426</td>
              <td rowspan="1" colspan="1">0.530</td>
              <td rowspan="1" colspan="1">0.243</td>
              <td rowspan="1" colspan="1">0.135</td>
              <td rowspan="1" colspan="1">0.073</td>
              <td rowspan="1" colspan="1">0.160</td>
              <td rowspan="1" colspan="1">0.123</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SLEMM-WW-MAFopt</td>
              <td rowspan="1" colspan="1">0.643</td>
              <td rowspan="1" colspan="1">0.665</td>
              <td rowspan="1" colspan="1">0.481</td>
              <td rowspan="1" colspan="1">0.451</td>
              <td rowspan="1" colspan="1">0.427</td>
              <td rowspan="1" colspan="1">0.533</td>
              <td rowspan="1" colspan="1">0.244</td>
              <td rowspan="1" colspan="1">0.134</td>
              <td rowspan="1" colspan="1">0.071</td>
              <td rowspan="1" colspan="1">0.159</td>
              <td rowspan="1" colspan="1">0.121</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">BayesR</td>
              <td rowspan="1" colspan="1">0.641</td>
              <td rowspan="1" colspan="1">0.654</td>
              <td rowspan="1" colspan="1">0.481</td>
              <td rowspan="1" colspan="1">0.450</td>
              <td rowspan="1" colspan="1">0.426</td>
              <td rowspan="1" colspan="1">0.530</td>
              <td rowspan="1" colspan="1">0.243</td>
              <td rowspan="1" colspan="1">0.135</td>
              <td rowspan="1" colspan="1">0.073</td>
              <td rowspan="1" colspan="1">0.160</td>
              <td rowspan="1" colspan="1">0.123</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">LDAK-BOLT</td>
              <td rowspan="1" colspan="1">0.642</td>
              <td rowspan="1" colspan="1">0.663</td>
              <td rowspan="1" colspan="1">0.480</td>
              <td rowspan="1" colspan="1">0.450</td>
              <td rowspan="1" colspan="1">0.426</td>
              <td rowspan="1" colspan="1">0.532</td>
              <td rowspan="1" colspan="1">0.243</td>
              <td rowspan="1" colspan="1">0.135</td>
              <td rowspan="1" colspan="1">0.073</td>
              <td rowspan="1" colspan="1">0.160</td>
              <td rowspan="1" colspan="1">0.123</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">OLS</td>
              <td rowspan="1" colspan="1">0.544</td>
              <td rowspan="1" colspan="1">0.571</td>
              <td rowspan="1" colspan="1">0.357</td>
              <td rowspan="1" colspan="1">0.319</td>
              <td rowspan="1" colspan="1">0.295</td>
              <td rowspan="1" colspan="1">0.417</td>
              <td rowspan="1" colspan="1">0.118</td>
              <td rowspan="1" colspan="1">0.029</td>
              <td rowspan="1" colspan="1">0.012</td>
              <td rowspan="1" colspan="1">0.031</td>
              <td rowspan="1" colspan="1">0.024</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn3">
            <label>a</label>
            <p>The sample size for training (80% of whole data) is ∼234 774 for production traits and SCS and ∼102 306 for reproduction traits.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>3.3 SLEMM tuning</title>
      <p>We evaluated the impact of MAF-based SNP weighting, window size, and the number of window-based SNP weighting rounds on genomic prediction accuracy in SLEMM. To find the optimal MAF weighting parameter in <xref rid="E2" ref-type="disp-formula">equation (2)</xref>, we explored the relationship between REML log-likelihood and the MAF weighting parameter. It has been reported that the optimal MAF weighting parameter may be affected by large-effect QTLs (<xref rid="btad127-B18" ref-type="bibr">Speed et al. 2017</xref>). This was also observed in our analysis on the dairy bull data (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8</xref>). Fitting significant SNP effects as fixed changed the optimal MAF weighting parameter value and made the trend across traits more consistent: REML log-likelihood peaked at around 1.5 for all three bull traits. As shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S9</xref> on the dairy bull data, randomly selecting 80% of individuals as training data for 20 replicates resulted in largely the same relationship between the REML log-likelihood and the MAF weighting parameter. This suggests that the MAF weighting parameter is a robust parameter for each trait in a population. In addition, the large-scale dairy cow data analysis also showed that REML log-likelihood peaked at around 1.5 for all nine cow traits regardless of fitting significant SNP effects as fixed (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S10A</xref>) or not (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S10B</xref>).</p>
      <p>Besides a window size of 20, we further tried a much larger window size (500 for livestock traits and 1000 for plant traits) in SLEMM-WW-MAFopt for all seven public datasets. The large window size resulted in similar predictive abilities to the window size of 20 for most traits (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S11–S17</xref>). In particular, using the larger window size decreased the predictive ability for milk fat percentage in dairy bulls (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S11</xref>) but increased that for average daily weight gain and off-test age in the four-breed pig population (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S13</xref>).</p>
      <p>The iterative weighting in SLEMM is set to one round by default. We further tried two rounds of window-based SNP weighting for the dairy bull traits. Increasing the number of weighting rounds marginally improved the predictive ability for MFP (0.864 versus 0.866) but decreased that for MY and SCS (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S18</xref>).</p>
    </sec>
    <sec>
      <title>3.4 Computational speed and memory usage</title>
      <p>Simulation data were used to evaluate computing speed and peak memory usage. Ten threads were used for SLEMM, KAML, and LDAK, whereas four threads were used for BayesR. KAML and GCTA-NW could not handle large datasets. It took KAML 11 days to estimate SNP effects with 50k animals and 45k SNPs. SLEMM-NW is 0.5–2 times faster and uses slightly less memory than SLEMM-WW (SLEMM with window-based SNP weighting) (<xref rid="btad127-F1" ref-type="fig">Fig. 1</xref>). SLEMM-WW is orders of magnitude faster than BayesR and 0.8-3 times faster than LDAK-BOLT (<xref rid="btad127-F1" ref-type="fig">Fig. 1A and C</xref>). It is noteworthy that the LDAK-BOLT computation did not include <italic toggle="yes">h</italic><sup>2</sup> estimation. Both SLEMM and LDAK are much more memory-efficient than BayesR (<xref rid="btad127-F1" ref-type="fig">Fig. 1B and D</xref>). LDAK-BOLT is slightly more memory-efficient than SLEMM when the number of SNPs is 50k (<xref rid="btad127-F1" ref-type="fig">Fig. 1B</xref>). As the number of SNPs increases, SLEMM becomes more memory-efficient than LDAK-BOLT (<xref rid="btad127-F1" ref-type="fig">Fig. 1D</xref>). In particular, SLEMM-WW used ∼330 min and 63 GB of peak memory for 3M individuals and 50k SNPs, and it used 59.3 min and 24.4 GB of peak memory for 100k individuals and 1M SNPs. The peak memory usage and computing time of SLEMM are largely proportional to sample size and sample size to the power of 1.5, respectively.</p>
      <fig position="float" id="btad127-F1">
        <label>Figure 1</label>
        <caption>
          <p>Computational performance of SLEMM, BayesR, and LDAK using simulation. (A and B) The number of SNPs is fixed to 50k. (C and D) The number of individuals is fixed to 100k. The line of SLEMM-NW overlaps that of SLEMM-WW in (D). LDAK computation did not include heritability estimation. The time of SLEMM-WW included two rounds of model fitting by REML</p>
        </caption>
        <graphic xlink:href="btad127f1" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>It is challenging to use many genotyped and phenotyped individuals for genomic prediction. In this work, we present a new software tool, SLEMM, to address the challenge. SLEMM uses the Stochastic Lanczos REML and SNP weighting to effectively and accurately estimate SNP effects for large datasets. SLEMM is fast enough for million-scale genomic predictions (<xref rid="btad127-F1" ref-type="fig">Fig. 1</xref>). In addition, SLEMM with window-based SNP weighting had an overall comparable predictive ability to BayesR for a variety of plant and livestock traits as shown in this work. BayesR has been demonstrated to outperform a variety of existing prediction methods (<xref rid="btad127-B31" ref-type="bibr">Zeng and Zhou 2017</xref>; <xref rid="btad127-B29" ref-type="bibr">Yin et al. 2020</xref>).</p>
    <p>The choice of priors on SNP effects usually has a considerable impact on genomic prediction accuracy for traits underlain by a small number of large-effect QTLs (<xref rid="btad127-B4" ref-type="bibr">de los Campos et al. 2013</xref>). This was observed in our analysis; for example, SLEMM-WW, BayesR, and LDAK considerably improved predictions compared to SLEMM-NW for MY (milk) and MFP (milk fat percentage) in dairy bulls (<xref rid="btad127-T2" ref-type="table">Table 2</xref>). Such an improvement, however, nearly disappeared for the same traits in the much larger dairy cow data (<xref rid="btad127-T3" ref-type="table">Table 3</xref>). The result is in line with our expectation: priors become less influential as sample size increases.</p>
    <p>The prediction accuracy of SNP weighting in SLEMM can be affected by the following settings: MAF weighting parameter, SNP window size, and the number of SNP weighting rounds. Our analysis on the two dairy datasets showed that the optimal MAF weighting parameter was consistent across traits and robust for each trait. We also found that genomic prediction benefited little from MAF-optimized SNP weighting compared to non-weighted SLEMM (<xref rid="btad127-T2" ref-type="table">Tables 2</xref> and <xref rid="btad127-T3" ref-type="table">3</xref>). SLEMM generally worked well with a window size of 20 SNPs for medium-density SNP chip data, though tuning it with cross-validation might improve predictive ability. A larger SNP window size may work better for a trait not underlain by large-effect QTLs. The number of iterative SNP weighting rounds can be fixed to one in SLEMM for all traits, because increasing it does not help even for a trait underlain by large-effect QTLs (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S18</xref>). Collectively, SLEMM requires little tuning on the three settings in most cases.</p>
    <p>There have been several methods for leveraging functional annotations to improve genomic predictions, e.g. LDpred-funct (<xref rid="btad127-B10" ref-type="bibr">Márquez-Luna et al. 2021</xref>), LDAK (<xref rid="btad127-B32" ref-type="bibr">Zhang et al. 2021</xref>), and GMRM (<xref rid="btad127-B14" ref-type="bibr">Orliac et al. 2022</xref>). It is feasible to do so in SLEMM similar to LDAK and LDpred-funct: first, a software tool like S-LDSC (<xref rid="btad127-B5" ref-type="bibr">Finucane et al. 2015</xref>) is used to get functionally informed variance estimates for individual SNPs; second, SLEMM takes these variance estimates as input to weight SNPs. Further research is needed to develop this approach for livestock and plant data.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad127_Supplementary_Data</label>
      <media xlink:href="btad127_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The Council of Dairy Cattle Breeding is acknowledged for providing access to the large dairy cow data used in this study.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> is available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by USDA National Institute of Food and Agriculture (NIFA) Hatch project [1023267] and Agriculture and Food Research Initiative (AFRI) [2020-67015-31398 and 2021-67015-33409].</p>
    <p>Conflict of interest: None declared.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p><xref rid="btad127-T1" ref-type="table">Table 1</xref> lists all the public datasets used in this study. The large dairy cow dataset is managed by CDCB. A request to CDCB that is necessary for getting data on research may be sent to João Dürr, CDCB Chief Executive Officer (joao.durr@cdcb.us).</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad127-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bernardo</surname><given-names>R</given-names></string-name>, <string-name><surname>Yu</surname><given-names>J.</given-names></string-name></person-group><article-title>Prospects for genomewide selection for quantitative traits in maize</article-title>. <source><italic toggle="yes">Crop Sci</italic></source><year>2007</year>;<volume>47</volume>:<fpage>1082</fpage>–<lpage>90</lpage>. <pub-id pub-id-type="doi">10.2135/cropsci2006.11.0690</pub-id>.</mixed-citation>
    </ref>
    <ref id="btad127-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Border</surname><given-names>R</given-names></string-name>, <string-name><surname>Becker</surname><given-names>S.</given-names></string-name></person-group><article-title>Stochastic Lanczos estimation of genomic variance components for linear mixed-effects models</article-title>. <italic toggle="yes">BMC Bioinformatics</italic> <year>2019</year>;<volume>20</volume>:<fpage>411</fpage>.</mixed-citation>
    </ref>
    <ref id="btad127-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chatterjee</surname><given-names>N</given-names></string-name>, <string-name><surname>Shi</surname><given-names>J</given-names></string-name>, <string-name><surname>García-Closas</surname><given-names>M.</given-names></string-name></person-group><article-title>Developing and evaluating polygenic risk prediction models for stratified disease prevention</article-title>. <source><italic toggle="yes">Nat Rev Genet</italic></source><year>2016</year>;<volume>17</volume>:<fpage>392</fpage>–<lpage>406</lpage>. <pub-id pub-id-type="doi">10.1038/nrg.2016.27</pub-id>.<pub-id pub-id-type="pmid">27140283</pub-id></mixed-citation>
    </ref>
    <ref id="btad127-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>De Los Campos</surname><given-names>G</given-names></string-name>, <string-name><surname>Hickey</surname><given-names>JM</given-names></string-name>, <string-name><surname>Pong-Wong</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Whole-genome regression and prediction methods applied to plant and animal breeding</article-title>. <source><italic toggle="yes">Genetics</italic></source><year>2013</year>;<volume>193</volume>:<fpage>327</fpage>–<lpage>45</lpage>. <pub-id pub-id-type="doi">10.1534/genetics.112.143313</pub-id>.<pub-id pub-id-type="pmid">22745228</pub-id></mixed-citation>
    </ref>
    <ref id="btad127-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Finucane</surname><given-names>HK</given-names></string-name>, <string-name><surname>Bulik-Sullivan</surname><given-names>B</given-names></string-name>, <string-name><surname>Gusev</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Partitioning heritability by functional annotation using genome-wide association summary statistics</article-title>. <source><italic toggle="yes">Nat Genet</italic></source><year>2015</year>;<volume>47</volume>:<fpage>1228</fpage>–<lpage>35</lpage>. <pub-id pub-id-type="doi">10.1038/ng.3404</pub-id>.<pub-id pub-id-type="pmid">26414678</pub-id></mixed-citation>
    </ref>
    <ref id="btad127-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Goddard</surname><given-names>ME</given-names></string-name>, <string-name><surname>Hayes</surname><given-names>BJ.</given-names></string-name></person-group><article-title>Mapping genes for complex traits in domestic animals and their use in breeding programmes</article-title>. <source><italic toggle="yes">Nat Rev Genet</italic></source><year>2009</year>;<volume>10</volume>:<fpage>381</fpage>–<lpage>91</lpage>. <pub-id pub-id-type="doi">10.1038/nrg2575</pub-id>.<pub-id pub-id-type="pmid">19448663</pub-id></mixed-citation>
    </ref>
    <ref id="btad127-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jiang</surname><given-names>J, Ma L, Prakapenka D</given-names></string-name></person-group> <etal>et al.</etal><article-title>A large-scale genome-wide association study in U.S. Holstein cattle</article-title>. <italic toggle="yes">Front Genet</italic> <year>2019</year>;<volume>10</volume>:<fpage>412</fpage>.</mixed-citation>
    </ref>
    <ref id="btad127-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>Z</given-names></string-name>, <string-name><surname>Sun</surname><given-names>C</given-names></string-name>, <string-name><surname>Yan</surname><given-names>Y</given-names></string-name></person-group> <etal>et al.</etal><article-title>Genome-wide association analysis of age-dependent egg weights in chickens</article-title>. <italic toggle="yes">Front Genet</italic> <year>2018</year>;<volume>9</volume>:<fpage>128</fpage>.</mixed-citation>
    </ref>
    <ref id="btad127-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Loh</surname><given-names>P-R</given-names></string-name>, <string-name><surname>Tucker</surname><given-names>G</given-names></string-name>, <string-name><surname>Bulik-Sullivan</surname><given-names>BK</given-names></string-name></person-group><etal>et al</etal><article-title>Efficient bayesian mixed-model analysis increases association power in large cohorts</article-title>. <source><italic toggle="yes">Nat Genet</italic></source><year>2015</year>;<volume>47</volume>:<fpage>284</fpage>–<lpage>90</lpage>. <pub-id pub-id-type="doi">10.1038/ng.3190</pub-id>.<pub-id pub-id-type="pmid">25642633</pub-id></mixed-citation>
    </ref>
    <ref id="btad127-B10">
      <mixed-citation publication-type="journal">Márquez-Luna C, Gazal S, Loh PR <etal>et al.</etal><article-title>Incorporating functional priors improves polygenic prediction accuracy in UK biobank and 23andMe data sets</article-title>. <italic toggle="yes">Nat Commun</italic> <year>2021</year>;<volume>12</volume>:<fpage>6052</fpage>.</mixed-citation>
    </ref>
    <ref id="btad127-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mehrban</surname><given-names>H</given-names></string-name>, <string-name><surname>Naserkheil</surname><given-names>M</given-names></string-name>, <string-name><surname>Lee</surname><given-names>DH</given-names></string-name></person-group><etal>et al</etal><article-title>Genomic prediction using alternative strategies of weighted single-step genomic BLUP for yearling weight and carcass traits in hanwoo beef cattle</article-title>. <source><italic toggle="yes">Genes</italic></source><year>2021</year>;<volume>12</volume>:<fpage>266</fpage>. <pub-id pub-id-type="doi">10.3390/genes12020266</pub-id>.<pub-id pub-id-type="pmid">33673102</pub-id></mixed-citation>
    </ref>
    <ref id="btad127-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meuwissen</surname><given-names>TH</given-names></string-name>, <string-name><surname>Hayes</surname><given-names>BJ</given-names></string-name>, <string-name><surname>Goddard</surname><given-names>ME.</given-names></string-name></person-group><article-title>Prediction of total genetic value using genome-wide dense marker maps</article-title>. <source><italic toggle="yes">Genetics</italic></source><year>2001</year>;<volume>157</volume>:<fpage>1819</fpage>–<lpage>29</lpage>. <pub-id pub-id-type="doi">10.1093/genetics/157.4.1819</pub-id>.<pub-id pub-id-type="pmid">11290733</pub-id></mixed-citation>
    </ref>
    <ref id="btad127-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moser</surname><given-names>G</given-names></string-name>, <string-name><surname>Lee</surname><given-names>SH</given-names></string-name>, <string-name><surname>Hayes</surname><given-names>BJ</given-names></string-name></person-group><etal>et al</etal><article-title>Simultaneous discovery, estimation and prediction analysis of complex traits using a bayesian mixture model</article-title>. <source><italic toggle="yes">PLoS Genet</italic></source><year>2015</year>;<volume>11</volume>:<fpage>e1004969</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pgen.1004969</pub-id>.<pub-id pub-id-type="pmid">25849665</pub-id></mixed-citation>
    </ref>
    <ref id="btad127-B14">
      <mixed-citation publication-type="journal">Orliac EJ, Trejo Banos D, Ojavee SE <etal>et al.</etal><article-title>Improving GWAS discovery and genomic prediction accuracy in biobank data</article-title>. <italic toggle="yes">Proc Natl Acad Sci USA</italic> <year>2022</year>;<volume>119</volume>(<issue>31</issue>):<fpage>e2121279119</fpage>.</mixed-citation>
    </ref>
    <ref id="btad127-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Resende</surname><given-names>MFR</given-names></string-name>, <string-name><surname>Muñoz</surname><given-names>P</given-names></string-name>, <string-name><surname>Resende</surname><given-names>MDV</given-names></string-name></person-group><etal>et al</etal><article-title>Accuracy of genomic selection methods in a standard data set of loblolly pine (Pinus taeda L.)</article-title>. <source><italic toggle="yes">Genetics</italic></source><year>2012</year>;<volume>190</volume>:<fpage>1503</fpage>–<lpage>10</lpage>. <pub-id pub-id-type="doi">10.1534/genetics.111.137026</pub-id>.<pub-id pub-id-type="pmid">22271763</pub-id></mixed-citation>
    </ref>
    <ref id="btad127-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Romay</surname><given-names>MC, Millard MJ, Glaubitz JC</given-names></string-name></person-group> <etal>et al.</etal><article-title>Comprehensive genotyping of the USA national maize inbred seed bank</article-title>. <italic toggle="yes">Genome Biol</italic> <year>2013</year>;<volume>14</volume>(<issue>6</issue>):<fpage>R55</fpage>.</mixed-citation>
    </ref>
    <ref id="btad127-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schoech</surname><given-names>AP, Jordan DM, Loh PR</given-names></string-name></person-group> <etal>et al.</etal><article-title>Quantification of frequency-dependent genetic architectures in 25 UK biobank traits reveals action of negative selection</article-title>. <italic toggle="yes">Nat Commun</italic> <year>2019</year>;<volume>10</volume>:<fpage>790</fpage>.</mixed-citation>
    </ref>
    <ref id="btad127-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Speed</surname><given-names>D</given-names></string-name>, <string-name><surname>Cai</surname><given-names>N</given-names></string-name>, <string-name><surname>Johnson</surname><given-names>MR</given-names></string-name></person-group><etal>et al</etal><article-title>Reevaluation of SNP heritability in complex human traits</article-title>. <source><italic toggle="yes">Nat Genet</italic></source><year>2017</year>;<volume>49</volume>:<fpage>986</fpage>–<lpage>92</lpage>. <pub-id pub-id-type="doi">10.1038/ng.3865</pub-id>.<pub-id pub-id-type="pmid">28530675</pub-id></mixed-citation>
    </ref>
    <ref id="btad127-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tang</surname><given-names>Z</given-names></string-name>, <string-name><surname>Xu</surname><given-names>J</given-names></string-name>, <string-name><surname>Yin</surname><given-names>L</given-names></string-name></person-group> <etal>et al.</etal><article-title>Genome-wide association study reveals candidate genes for growth relevant traits in pigs</article-title>. <italic toggle="yes">Front Genet</italic> <year>2019</year>;<volume>10</volume>:<fpage>302</fpage>.</mixed-citation>
    </ref>
    <ref id="btad127-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Teissier</surname><given-names>M</given-names></string-name></person-group> <etal>et al.</etal><article-title>Weighted single-step genomic BLUP improves accuracy of genomic breeding values for protein content in french dairy goats: a quantitative trait influenced by a major gene</article-title>. <italic toggle="yes">Genet Sel Evol</italic> <year>2018</year>;<volume>50</volume>:<fpage>31</fpage>.</mixed-citation>
    </ref>
    <ref id="btad127-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tiezzi</surname><given-names>F</given-names></string-name>, <string-name><surname>Maltecca</surname><given-names>C.</given-names></string-name></person-group><article-title>Accounting for trait architecture in genomic predictions of US holstein cattle using a weighted realized relationship matrix</article-title>. <source>Genet Sel Evol</source><year>2015</year>;<volume>47</volume>.</mixed-citation>
    </ref>
    <ref id="btad127-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>VanRaden</surname><given-names>PM.</given-names></string-name></person-group><article-title>Efficient methods to compute genomic predictions</article-title>. <source><italic toggle="yes">Journal of Dairy Science</italic></source><year>2008</year>;<volume>91</volume>:<fpage>4414</fpage>–<lpage>23</lpage>. <pub-id pub-id-type="doi">10.3168/jds.2007-0980</pub-id>.<pub-id pub-id-type="pmid">18946147</pub-id></mixed-citation>
    </ref>
    <ref id="btad127-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>VanRaden</surname><given-names>PM</given-names></string-name></person-group> <etal>et al.</etal><article-title>Fast imputation using medium or low-coverage sequence data</article-title>. <italic toggle="yes">BMC Genet</italic> <year>2015</year>;<volume>16</volume>:<fpage>82</fpage>.</mixed-citation>
    </ref>
    <ref id="btad127-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>VanRaden</surname><given-names>PM</given-names></string-name>, <string-name><surname>Van Tassell</surname><given-names>CP</given-names></string-name>, <string-name><surname>Wiggans</surname><given-names>GR</given-names></string-name></person-group><etal>et al</etal><article-title>Invited review: reliability of genomic predictions for North american holstein bulls</article-title>. <source><italic toggle="yes">J Dairy Sci</italic></source><year>2009</year>;<volume>92</volume>:<fpage>16</fpage>–<lpage>24</lpage>. <pub-id pub-id-type="doi">10.3168/jds.2008-1514</pub-id>.<pub-id pub-id-type="pmid">19109259</pub-id></mixed-citation>
    </ref>
    <ref id="btad127-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname><given-names>MC</given-names></string-name>, <string-name><surname>Lee</surname><given-names>S</given-names></string-name>, <string-name><surname>Cai</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>Rare-variant association testing for sequencing data with the sequence kernel association test</article-title>. <source><italic toggle="yes">Am J Hum Genet</italic></source><year>2011</year>;<volume>89</volume>:<fpage>82</fpage>–<lpage>93</lpage>. <pub-id pub-id-type="doi">10.1016/j.ajhg.2011.05.029</pub-id>.<pub-id pub-id-type="pmid">21737059</pub-id></mixed-citation>
    </ref>
    <ref id="btad127-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>J</given-names></string-name>, <string-name><surname>Bakshi</surname><given-names>A</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>Genetic variance estimation with imputed variants finds negligible missing heritability for human height and body mass index</article-title>. <source><italic toggle="yes">Nat Genet</italic></source><year>2015</year>;<volume>47</volume>:<fpage>1114</fpage>–<lpage>20</lpage>. <pub-id pub-id-type="doi">10.1038/ng.3390</pub-id>.<pub-id pub-id-type="pmid">26323059</pub-id></mixed-citation>
    </ref>
    <ref id="btad127-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>R, Guo X, Zhu D</given-names></string-name></person-group> <etal>et al.</etal><article-title>Accelerated deciphering of the genetic architecture of agricultural economic traits in pigs using a low-coverage whole-genome sequencing strategy</article-title>. <italic toggle="yes">GigaScience</italic> <year>2021</year>;<volume>10</volume>(<issue>7</issue>):giab048.</mixed-citation>
    </ref>
    <ref id="btad127-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>W</given-names></string-name>, <string-name><surname>Tempelman</surname><given-names>RJ.</given-names></string-name></person-group><article-title>A bayesian antedependence model for whole genome prediction</article-title>. <source><italic toggle="yes">Genetics</italic></source><year>2012</year>;<volume>190</volume>:<fpage>1491</fpage>–<lpage>501</lpage>. <pub-id pub-id-type="doi">10.1534/genetics.111.131540</pub-id>.<pub-id pub-id-type="pmid">22135352</pub-id></mixed-citation>
    </ref>
    <ref id="btad127-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yin</surname><given-names>L</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>H</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>X</given-names></string-name></person-group> <etal>et al.</etal><article-title>KAML: improving genomic prediction accuracy of complex traits using machine learning determined parameters</article-title>. <italic toggle="yes">Genome Biol</italic> <year>2020</year>;<volume>21</volume>:<fpage>146</fpage>.</mixed-citation>
    </ref>
    <ref id="btad127-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zeng</surname><given-names>J</given-names></string-name>, <string-name><surname>Garrick</surname><given-names>D</given-names></string-name>, <string-name><surname>Dekkers</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>A nested mixture model for genomic prediction using whole-genome SNP genotypes</article-title>. <source><italic toggle="yes">PLoS ONE</italic></source><year>2018</year>;<volume>13</volume>:<fpage>e0194683</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0194683</pub-id>.<pub-id pub-id-type="pmid">29561877</pub-id></mixed-citation>
    </ref>
    <ref id="btad127-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zeng</surname><given-names>P</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>X.</given-names></string-name></person-group><article-title>Non-parametric genetic prediction of complex traits with latent Dirichlet process regression models</article-title>. <italic toggle="yes">Nat Commun</italic> <year>2017</year>;<volume>8</volume>:<fpage>456</fpage>.</mixed-citation>
    </ref>
    <ref id="btad127-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>Q</given-names></string-name>, <string-name><surname>Privé</surname><given-names>F</given-names></string-name>, <string-name><surname>Vilhjálmsson</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>Improved genetic prediction of complex traits from individual-level data or summary statistics</article-title>. <source>Nat Commun</source><year>2021</year>;<volume>12</volume>:<fpage>4192</fpage>.<pub-id pub-id-type="pmid">34234142</pub-id></mixed-citation>
    </ref>
    <ref id="btad127-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>X</given-names></string-name>, <string-name><surname>Lourenco</surname><given-names>D</given-names></string-name>, <string-name><surname>Aguilar</surname><given-names>I</given-names></string-name></person-group><etal>et al</etal><article-title>Weighting strategies for single-step genomic BLUP: an iterative approach for accurate calculation of GEBV and GWAS</article-title>. <source>Front Genet</source><year>2016</year>;<volume>7</volume>:<fpage>151</fpage>.<pub-id pub-id-type="pmid">27594861</pub-id></mixed-citation>
    </ref>
    <ref id="btad127-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>Z</given-names></string-name>, <string-name><surname>Erbe</surname><given-names>M</given-names></string-name>, <string-name><surname>He</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Accuracy of whole-genome prediction using a genetic architecture-enhanced variance-covariance matrix</article-title>. <source><italic toggle="yes">G3 (Bethesda)</italic></source><year>2015</year>;<volume>5</volume>:<fpage>615</fpage>–<lpage>27</lpage>. <pub-id pub-id-type="doi">10.1534/g3.114.016261</pub-id>.<pub-id pub-id-type="pmid">25670771</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
