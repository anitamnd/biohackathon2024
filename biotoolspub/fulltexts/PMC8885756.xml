<?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.6.0//EN//XML?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName art560.dtd?>
<?SourceDTD.Version 5.6.0?>
<?ConverterInfo.XSLTName elsevier2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<?origin publisher?>
<?FILEmeta_XPRO101208 xml ?>
<?FILEmain xml ?>
<?FILEmain pdf ?>
<?FILEgr1 jpg ?>
<?FILEgr2 jpg ?>
<?FILEgr3 jpg ?>
<?FILEgr4 jpg ?>
<?FILEfx1 jpg ?>
<?FILEfx2 jpg ?>
<?FILEfx3 jpg ?>
<?FILEfx4 jpg ?>
<?FILEsi1 gif ?>
<?FILEsi2 gif ?>
<?FILEsi3 gif ?>
<?FILEsi4 gif ?>
<?FILEsi5 gif ?>
<?FILEsi6 gif ?>
<?FILEsi7 gif ?>
<?FILEsi8 gif ?>
<?FILEsi9 gif ?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">STAR Protoc</journal-id>
    <journal-id journal-id-type="iso-abbrev">STAR Protoc</journal-id>
    <journal-title-group>
      <journal-title>STAR Protocols</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2666-1667</issn>
    <publisher>
      <publisher-name>Elsevier</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8885756</article-id>
    <article-id pub-id-type="pii">S2666-1667(22)00088-0</article-id>
    <article-id pub-id-type="doi">10.1016/j.xpro.2022.101208</article-id>
    <article-id pub-id-type="publisher-id">101208</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Protocol</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Gene coexpression analysis in <italic>Arabidopsis thaliana</italic> based on public microarray data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="au1">
        <name>
          <surname>Zogopoulos</surname>
          <given-names>Vasileios L.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author" id="au2">
        <name>
          <surname>Malatras</surname>
          <given-names>Apostolos</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author" id="au3">
        <name>
          <surname>Michalopoulos</surname>
          <given-names>Ioannis</given-names>
        </name>
        <email>imichalop@bioacademy.gr</email>
        <xref rid="aff1" ref-type="aff">1</xref>
        <xref rid="fn1" ref-type="fn">3</xref>
        <xref rid="fn2" ref-type="fn">4</xref>
        <xref rid="cor1" ref-type="corresp">∗</xref>
      </contrib>
      <aff id="aff1"><label>1</label>Centre of Systems Biology, Biomedical Research Foundation, Academy of Athens, 11527 Athens, Greece</aff>
      <aff id="aff2"><label>2</label>biobank.cy Center of Excellence in Biobanking and Biomedical Research, University of Cyprus, 2029 Nicosia, Cyprus</aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>∗</label>Corresponding author <email>imichalop@bioacademy.gr</email></corresp>
      <fn id="fn1">
        <label>3</label>
        <p id="ntpara0010">Technical contact</p>
      </fn>
      <fn id="fn2">
        <label>4</label>
        <p id="ntpara0015">Lead contact</p>
      </fn>
    </author-notes>
    <pub-date pub-type="pmc-release">
      <day>26</day>
      <month>2</month>
      <year>2022</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.-->
    <pub-date pub-type="collection">
      <day>18</day>
      <month>3</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>26</day>
      <month>2</month>
      <year>2022</year>
    </pub-date>
    <volume>3</volume>
    <issue>1</issue>
    <elocation-id>101208</elocation-id>
    <permissions>
      <copyright-statement>© 2022 The Author(s)</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article under the CC BY license (http://creativecommons.org/licenses/by/4.0/).</license-p>
      </license>
    </permissions>
    <abstract id="abs0010">
      <title>Summary</title>
      <p>Coexpressed genes tend to participate in related biological processes. Gene coexpression analysis allows the discovery of functional gene partners or the assignment of biological roles to genes of unknown function. In this protocol, we describe the steps necessary to create a gene coexpression tree for <italic>Arabidopsis thaliana</italic>, using publicly available Affymetrix CEL microarray data. Because the computational analysis described here is highly dependent on sample quality, we detail an automatic quality control approach.</p>
      <p>For complete details on the use and execution of this protocol, please refer to <xref rid="bib25" ref-type="bibr">Zogopoulos et al. (2021)</xref>.</p>
    </abstract>
    <abstract abstract-type="graphical" id="abs0015">
      <title>Graphical abstract</title>
      <fig id="undfig1" position="anchor">
        <graphic xlink:href="fx1"/>
      </fig>
    </abstract>
    <abstract abstract-type="author-highlights" id="abs0020">
      <title>Highlights</title>
      <p>
        <list list-type="simple" id="ulist0010">
          <list-item id="u0010">
            <label>•</label>
            <p id="p0010">Download and quality control of raw microarray data from multiple public repositories</p>
          </list-item>
          <list-item id="u0015">
            <label>•</label>
            <p id="p0015">Normalization of microarray samples using SCAN algorithm and the latest BrainArray CDF</p>
          </list-item>
          <list-item id="u0020">
            <label>•</label>
            <p id="p0020">Creation of a gene coexpression tree using UPGMA hierarchical clustering</p>
          </list-item>
          <list-item id="u0025">
            <label>•</label>
            <p id="p0025">Biological term enrichment analysis in gene coexpression tree subclades</p>
          </list-item>
        </list>
      </p>
    </abstract>
    <abstract abstract-type="teaser" id="abs0025">
      <p>Coexpressed genes tend to participate in related biological processes. Gene coexpression analysis allows the discovery of functional gene partners or the assignment of biological roles to genes of unknown function. In this protocol, we describe the steps necessary to create a gene coexpression tree for <italic>Arabidopsis thaliana</italic>, using publicly available Affymetrix CEL microarray data. Because the computational analysis described here is highly dependent on sample quality, we detail an automatic quality control approach.</p>
    </abstract>
    <kwd-group id="kwrds0010">
      <title>Subject areas</title>
      <kwd>Bioinformatics</kwd>
      <kwd>Genomics</kwd>
      <kwd>Model Organisms</kwd>
      <kwd>Plant sciences</kwd>
      <kwd>Systems biology</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <title>Before you begin</title>
    <p id="p0045">The protocol below describes the specific steps for performing gene coexpression analysis on <italic>Arabidopsis thaliana</italic> Affymetrix microarray data. The same protocol can be used for any species, provided that at least 20 samples of the same Affymetrix chip are available (<xref rid="bib13" ref-type="bibr">Langfelder and Horvath, 2017</xref>). By examining the gene coexpression tree created by following this protocol, hypotheses for gene partnership and pathway participation can be made, which can be, in turn, experimentally validated. The advantages described in this protocol include: the hierarchical clustering approach for displaying gene coexpression which outperforms the more commonly used gene coexpression list output (<xref rid="bib17" ref-type="bibr">Obayashi et al., 2018</xref>; <xref rid="bib24" ref-type="bibr">Yim et al., 2013</xref>), the automatic quality control procedure and the meticulous representative sample selection which eliminates tissue bias, as well as the usage of modern normalization algorithms along with up-to-date CDFs. Execution of this protocol has resulted in several use-cases, where a gene of interest was discovered to be grouped with genes of similar functions, which are supported by already existing bibliography (<xref rid="bib25" ref-type="bibr">Zogopoulos et al., 2021</xref>).</p>
    <sec id="sec1.1">
      <title>Operating system and necessary hardware</title>
      <p id="p0050">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx2.gif"/>
            <bold>Timing: 1 h</bold>
          </p>
        </disp-quote>
      </p>
      <p id="p0055">Ubuntu 20.04 LTS Linux operating system was installed on a 16-core, 64 GB RAM machine. Ubuntu 20.04 and all necessary software can run on a minimum of 2 GHz dual core CPU, 4 GB RAM and 100 GB hard drive computer setup. However, RAM requirements for the calculation of sample or gene pairwise correlations and hierarchical clustering, depends on the number of available samples and studied genes. At least 64 GB of RAM is recommended for both those steps and that amount should also speed up sample normalization step. The required disk space is proportional to the number of samples and genes. In our case, where 19887 samples and 20430 genes were studied, around 300 GB were required.<list list-type="simple" id="olist0010"><list-item id="o0010"><label>1.</label><p id="p0060">Perform an installation of Ubuntu 20.04 or equivalent operating system, unless a machine with such an operating system already installed is available.</p></list-item></list><disp-quote><p><bold><italic>Note:</italic></bold> For software installation on Ubuntu, a sudo user (i.e., a user account granted with root privileges) is required.</p></disp-quote></p>
      <p id="p0065">After this step, users can proceed either with a Docker installation or by performing a full manual installation.<disp-quote><p><inline-graphic xlink:href="fx3.gif"/><bold>CRITICAL:</bold> All commands listed correspond to a Ubuntu 20.04 installation.</p></disp-quote></p>
    </sec>
    <sec id="sec1.2">
      <title>Installation using docker</title>
      <p id="p0070a">
        <list list-type="simple" id="olist0015">
          <list-item id="o0015">
            <label>2.</label>
            <p id="p0070">Install Docker by typing the following commands in Ubuntu:<disp-quote><p><bold><italic>Note:</italic></bold> This installation is for Ubuntu 20.04. For different operating systems users can refer to: <ext-link ext-link-type="uri" xlink:href="https://www.docker.com/get-started" id="intref0020">https://www.docker.com/get-started</ext-link></p></disp-quote><list list-type="simple" id="olist0020"><list-item id="o0020"><label>a.</label><p id="p0075">Install the Docker image of the protocol by typing in Ubuntu:<boxed-text id="dtbox1"><p id="p0080">sudo docker pull imichalop/act:latest</p></boxed-text></p></list-item><list-item id="o0025"><label>b.</label><p id="p0090">The container can be run in Ubuntu using:<boxed-text id="dtbox3"><p id="p0095">sudo docker run -it imichalop/act:latest</p></boxed-text></p></list-item><list-item id="o0030"><label>c.</label><p id="p0105">Inside the docker container, MySQL needs to be started before starting the analysis:<boxed-text id="dtbox5"><p id="p0110">service mysql start</p></boxed-text></p></list-item><list-item id="o0035"><label>d.</label><p id="p0120">Enter MySQL as root:<boxed-text id="dtbox7"><p id="p0125">mysql -u root -p</p></boxed-text></p></list-item><list-item id="o0040"><label>e.</label><p id="p0135">default root password is “1234” and can be changed using:<boxed-text id="dtbox9"><p id="p0140">ALTER USER 'root'@'localhost' IDENTIFIED WITH</p><p id="p0145">mysql_native_password BY '&lt;password&gt;';</p></boxed-text></p></list-item><list-item id="o0045"><label>f.</label><p id="p0160">In order to enable local file loading the following command must be typed in MySQL as root:<boxed-text id="dtbox11"><p id="p0165">SET GLOBAL local_infile=1;</p></boxed-text></p></list-item><list-item id="o0050"><label>g.</label><p id="p0175">Local Athaliana MySQL database is already created. The local username is “user” with password “1234”. User password can be changed in MySQL as root using:<boxed-text id="dtbox13"><p id="p0180">ALTER USER 'user'@'localhost' IDENTIFIED BY '&lt;new_password&gt;';</p><p id="p0185">FLUSH PRIVILEGES;</p></boxed-text><disp-quote><p><bold><italic>Note:</italic></bold> If the user password is changed, then the password field inside /home/ACT/Parsers/config.ini must also be changed</p></disp-quote></p></list-item><list-item id="o0055"><label>h.</label><p id="p0200">Exit MySQL by typing:<boxed-text id="dtbox15"><p id="p0205">exit</p></boxed-text></p></list-item><list-item id="o0060"><label>i.</label><p id="p0215">The system setup is complete and the users can begin the execution of the protocol.</p></list-item></list></p>
          </list-item>
        </list>
      </p>
    </sec>
    <sec id="sec1.3">
      <title>Full installation</title>
      <p id="p0220">To perform a full installation, the following commands must be typed in Ubuntu terminal:<list list-type="simple" id="olist0025"><list-item id="o0065"><label>3.</label><p id="p0225">Install system updates, git, unzip and gunzip:</p></list-item></list><boxed-text id="dtbox17"><p id="p0230">sudo apt-get update</p><p id="p0235">sudo apt-get dist-upgrade</p><p id="p0240">sudo apt-get install git unzip gzip</p></boxed-text></p>
    </sec>
    <sec id="sec1.4">
      <title>Install ACT scripts</title>
      <p id="p0245">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx2.gif"/>
            <bold>Timing: 1 min</bold>
          </p>
        </disp-quote>
        <list list-type="simple" id="olist0030">
          <list-item id="o0070">
            <label>4.</label>
            <p id="p0250">Download the necessary codes for this protocol from GitHub:</p>
          </list-item>
        </list>
        <boxed-text id="dtbox18">
          <p id="p0255">
git clone
<ext-link ext-link-type="uri" xlink:href="https://github.com/imichalop/ACT.git" id="intref0025">https://github.com/imichalop/ACT.git</ext-link>
</p>
        </boxed-text>
        <disp-quote>
          <p><bold><italic>Note:</italic></bold> ACT folder is created automatically through git and all custom programs, scripts and files described in this protocol are included or produced inside.</p>
        </disp-quote>
      </p>
    </sec>
    <sec id="sec1.5">
      <title>Install R &amp; RStudio</title>
      <p id="p0260">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx2.gif"/>
            <bold>Timing: 15 min</bold>
          </p>
        </disp-quote>
        <list list-type="simple" id="olist0035">
          <list-item id="o0075">
            <label>5.</label>
            <p id="p0265">R and optionally RStudio, need to be installed on the Ubuntu machine.<list list-type="simple" id="olist0040"><list-item id="o0080"><label>a.</label><p id="p0270">Install latest version of R and necessary dependencies:<boxed-text id="dtbox19"><p id="p0275">sudo apt install --no-install-recommends software-properties-common</p><p id="p0280">dirmngr</p><p id="p0285">wget -qO- https://cloud.r-</p><p id="p0290">project.org/bin/linux/ubuntu/marutter_pubkey.asc | sudo tee -a</p><p id="p0295">/etc/apt/trusted.gpg.d/cran_ubuntu_key.asc</p><p id="p0300">sudo add-apt-repository "deb https://cloud.r-</p><p id="p0305">project.org/bin/linux/ubuntu $(lsb_release -cs)-cran40/"</p><p id="p0310">sudo apt-get install r-base gcc make perl libclang-dev libpq5</p><p id="p0315">libcurl4-openssl-dev libssl-dev libxml2-dev</p></boxed-text></p></list-item><list-item id="o0085"><label>b.</label><p id="p0365">Install RStudio:<list list-type="simple" id="olist0045"><list-item id="o0090"><label>i.</label><p id="p0370">Download the latest version of RStudio for Ubuntu: <ext-link ext-link-type="uri" xlink:href="https://www.rstudio.com/products/rstudio/download" id="intref0030">https://www.rstudio.com/products/rstudio/download</ext-link></p></list-item><list-item id="o0095"><label>ii.</label><p id="p0375">Install the .deb file using:<boxed-text id="dtbox21"><p id="p0380">sudo dpkg -i &lt;rstudio-∗-amd64.deb&gt;</p></boxed-text></p></list-item></list></p></list-item></list></p>
          </list-item>
        </list>
      </p>
    </sec>
    <sec id="sec1.6">
      <title>Install MySQL and PHP</title>
      <p id="p0390">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx2.gif"/>
            <bold>Timing: 10 min</bold>
          </p>
        </disp-quote>
        <list list-type="simple" id="olist0050">
          <list-item id="o0100">
            <label>6.</label>
            <p id="p0395">MySQL database management system (DBMS) needs to be installed on the Ubuntu machine, to store and access data, using relevant SQL queries.<list list-type="simple" id="olist0055"><list-item id="o0105"><label>a.</label><p id="p0400">Setup MySQL client and server:<boxed-text id="dtbox23"><p id="p0405">sudo apt-get install mysql-server mysql-client</p></boxed-text><list list-type="simple" id="olist0060"><list-item id="o0110"><label>i.</label><p id="p0410">Access MySQL as root after installation using the following command in Ubuntu terminal:<boxed-text id="dtbox24"><p id="p0415">sudo mysql -u root -p</p></boxed-text><disp-quote><p><bold><italic>Note:</italic></bold> Press “Enter” when asked for MySQL root password, unless a root password is already set up.</p></disp-quote></p><p id="p0420">The following commands must be typed in MySQL environment:</p></list-item><list-item id="o0115"><label>ii.</label><p id="p0430">Set up MySQL root password using:<boxed-text id="dtbox26"><p id="p0435">ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY</p><p id="p0440">'&lt;password&gt;';</p></boxed-text></p></list-item><list-item id="o0120"><label>iii.</label><p id="p0455">Enable local file loading using:<boxed-text id="dtbox28"><p id="p0460">SET GLOBAL local_infile=1;</p></boxed-text></p></list-item><list-item id="o0125"><label>iv.</label><p id="p0470">Create a MySQL user account using:<boxed-text id="dtbox30"><p id="p0475">CREATE USER '&lt;user&gt;'@'localhost' IDENTIFIED BY '&lt;password&gt;';</p></boxed-text></p></list-item><list-item id="o0130"><label>v.</label><p id="p0485">Create the database using:<boxed-text id="dtbox32"><p id="p0490">CREATE DATABASE &lt;database name&gt;;</p><p id="p0495">GRANT ALL PRIVILEGES ON &lt;database name&gt;.∗ TO '&lt;user&gt;'@'localhost';</p></boxed-text><disp-quote><p><bold><italic>Note:</italic></bold> In our example, the &lt;database name&gt; is “Athaliana”.</p></disp-quote></p></list-item></list></p></list-item></list></p>
          </list-item>
        </list>
        <list list-type="simple" id="olist0065">
          <list-item id="o0135">
            <label>7.</label>
            <p id="p0515">PHP is used in this protocol to run all scripts necessary for data file parsing, format conversion and database access.<list list-type="simple" id="olist0070"><list-item id="o0140"><label>a.</label><p id="p0520">Install PHP and MySQL module for PHP:<boxed-text id="dtbox35"><p id="p0525">sudo apt-get install php-cli php-mysql</p></boxed-text></p></list-item><list-item id="o0145"><label>b.</label><p id="p0535">Get data from MySQL using PHP:</p><p id="p0540">ACT/Parsers/config.ini includes the local MySQL credentials and should be changed accordingly.<boxed-text id="dtbox37"><p id="p0545">username = &lt;user&gt;</p><p id="p0550">password = "&lt;password&gt;"</p><p id="p0555">dbname = &lt;database&gt;</p></boxed-text></p></list-item></list></p>
          </list-item>
        </list>
      </p>
    </sec>
    <sec id="sec1.7">
      <title>Install MySQL workbench and create the ERD and the tables of the database</title>
      <p id="p0575">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx2.gif"/>
            <bold>Timing: 30 min</bold>
          </p>
        </disp-quote>
      </p>
      <p id="p0580">MySQL Workbench is a visual database design tool to create the Entity-Relation Diagram (ERD) and the tables of the database.<list list-type="simple" id="olist0075"><list-item id="o0150"><label>8.</label><p id="p0585">Install MySQL Workbench:<list list-type="simple" id="olist0080"><list-item id="o0155"><label>a.</label><p id="p0590">Install necessary packages:<boxed-text id="dtbox39"><p id="p0595">sudo apt-get install proj-bin libatkmm-1.6-1v5 libcairomm-1.0-1v5 libglibmm-2.4-1v5</p><p id="p0600">libgtkmm-3.0-1v5 libopengl0 libpangomm-1.4-1v5 libsigc++-2.0-0v5</p></boxed-text></p></list-item><list-item id="o0160"><label>b.</label><p id="p0615">Download MySQL Workbench for Ubuntu 20.04: <ext-link ext-link-type="uri" xlink:href="https://dev.mysql.com/downloads/workbench/" id="intref0035">https://dev.mysql.com/downloads/workbench/</ext-link></p></list-item><list-item id="o0165"><label>c.</label><p id="p0620">Install the .deb file using:<boxed-text id="dtbox41"><p id="p0625">sudo dpkg -i &lt; mysql-workbench-community_∗ubuntu20.04_amd64.deb&gt;</p></boxed-text></p></list-item></list></p></list-item></list><list list-type="simple" id="olist0085"><list-item id="o0170"><label>9.</label><p id="p0635">The local MySQL database ERD is designed using MySQL Workbench and consists of 8 tables (<xref rid="fig1" ref-type="fig">Figure 1</xref>). “Expression” will be used to save the expression values of each probeset in each sample. “Probeset” contains the association between probesets and genes. “Probesets” contains the probesets as well as a unique numeric ID associated with each probeset. “ENSG” contains the AGI code, gene symbol, gene name and brief descriptions of <italic>Arabidopsis thaliana</italic> genes. “Selected_Genes” contains the AGI codes of genes that will be studied. “Sample” contains details of all samples. “Samples” contains the same details as “Sample”, except there is a unique numeric ID associated with each sample. “Selected_Samples” contains the unique numeric ID of the representative samples after quality control is over. Athaliana.mwb is the MySQL workbench file of the proposed ERD in this protocol.<list list-type="simple" id="olist0090"><list-item id="o0175"><label>a.</label><p id="p0640">Open a new Ubuntu terminal instance and access local MySQL database from using:<boxed-text id="dtbox43"><p id="p0645">mysql –u &lt;user&gt; –p &lt;database name&gt; --local-infile</p></boxed-text><disp-quote><p><inline-graphic xlink:href="fx3.gif"/><bold>CRITICAL:</bold> All commands requiring MySQL will be performed from this distinct terminal instance.</p></disp-quote></p></list-item><list-item id="o0180"><label>b.</label><p id="p0655">Create the tables by copying and pasting the SQL table creation commands from the MySQL Workbench ERD (Right click an ERD table &gt; Copy SQL to Clipboard).</p></list-item></list></p></list-item></list></p>
      <p id="p0660">
        <fig id="fig1">
          <label>Figure 1</label>
          <caption>
            <p>Entity-relation diagram (ERD) in crow’s foot notation of local MySQL database</p>
          </caption>
          <graphic xlink:href="gr1"/>
        </fig>
      </p>
    </sec>
    <sec id="sec1.8">
      <title>Install Array Power Tools</title>
      <p id="p0665">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx2.gif"/>
            <bold>Timing: 5 min</bold>
          </p>
        </disp-quote>
        <list list-type="simple" id="olist0095">
          <list-item id="o0185">
            <label>10.</label>
            <p id="p0670">Install Array Power Tools (<xref rid="bib7" ref-type="bibr">Thermo Fisher Scientific, 2020</xref>):<list list-type="simple" id="olist0100"><list-item id="o0190"><label>a.</label><p id="p0675">Download the APT package for Linux: <ext-link ext-link-type="uri" xlink:href="https://www.thermofisher.com/us/en/home/life-science/microarray-analysis/microarray-analysis-partners-programs/affymetrix-developers-network/affymetrix-power-tools.html" id="intref0040">https://www.thermofisher.com/us/en/home/life-science/microarray-analysis/microarray-analysis-partners-programs/affymetrix-developers-network/affymetrix-power-tools.html</ext-link></p></list-item><list-item id="o0195"><label>b.</label><p id="p0680">Install Array Power Tools using the following commands in Ubuntu terminal:<boxed-text id="dtbox45"><p id="p0685">sudo mv apt_∗_linux_64_bit_x86_binaries.zip /usr/local/bin/</p><p id="p0690">cd /usr/local/bin/</p><p id="p0695">sudo unzip apt_∗_linux_64_bit_x86_binaries.zip</p><p id="p0700">sudo rm apt_∗_linux_64_bit_x86_binaries.zip</p><p id="p0705">cd apt_∗_linux_64_bit_x86_binaries/bin/</p><p id="p0710">sudo chmod 755 ∗</p><p id="p0715">sudo chmod 644 axiom_param_conversion.txt apt-annotation-</p><p id="p0720">converter.config</p></boxed-text></p></list-item><list-item id="o0200"><label>c.</label><p id="p0765">In Ubuntu terminal, type:<boxed-text id="dtbox47"><p id="p0770">pico ∼/.bashrc</p></boxed-text></p><p id="p0775">to append the following line:<boxed-text id="dtbox48"><p id="p0780">export</p><p id="p0785">PATH="/usr/local/bin/apt_∗_linux_64_bit_x86_binaries/bin:$PATH"</p></boxed-text></p><p id="p0790">Save and exit the file<disp-quote><p><bold><italic>Note:</italic></bold> Replace ∗ in the previous line with the downloaded version of APT.</p></disp-quote></p></list-item><list-item id="o0205"><label>d.</label><p id="p0810">To add the bin directory to the path, type:<boxed-text id="dtbox51"><p id="p0815">source ∼/.bashrc</p></boxed-text></p><p id="p0820">When you relogin, there is no need to execute this command again.</p></list-item></list></p>
          </list-item>
        </list>
      </p>
    </sec>
    <sec id="sec1.9">
      <title>Install R packages</title>
      <p id="p0830">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx2.gif"/>
            <bold>Timing: 1 h</bold>
          </p>
        </disp-quote>
        <list list-type="simple" id="olist0105">
          <list-item id="o0210">
            <label>11.</label>
            <p id="p0835">Execute RStudio in Ubuntu terminal as root:</p>
          </list-item>
        </list>
        <boxed-text id="dtbox53">
          <p id="p0840">
sudo rstudio &amp;
</p>
        </boxed-text>
        <list list-type="simple" id="olist0110">
          <list-item id="o0215">
            <label>12.</label>
            <p id="p0845">Execute the following commands in RStudio environment:<list list-type="simple" id="olist0115"><list-item id="o0220"><label>a.</label><p id="p0850">Install latest version of Bioconductor:<boxed-text id="dtbox54"><p id="p0855">if (!requireNamespace("BiocManager", quietly = TRUE))</p><p id="p0860"> install.packages("BiocManager")</p><p id="p0865">BiocManager::install()</p></boxed-text></p></list-item><list-item id="o0225"><label>b.</label><p id="p0885">Install the necessary Bioconductor packages:<list list-type="simple" id="olist0120"><list-item id="o0230"><label>i.</label><p id="p0890">SCAN (<xref rid="bib20" ref-type="bibr">Piccolo et al., 2012</xref>) and oligo (<xref rid="bib4" ref-type="bibr">Carvalho and Irizarry, 2010</xref>):<boxed-text id="dtbox56"><p id="p0895">if (!requireNamespace("BiocManager", quietly = TRUE))</p><p id="p0900"> install.packages("BiocManager")</p><p id="p0905">BiocManager::install("SCAN.UPC")</p></boxed-text></p></list-item><list-item id="o0235"><label>ii.</label><p id="p0925">InterMineR (<xref rid="bib12" ref-type="bibr">Kyritsis et al., 2019</xref>):<boxed-text id="dtbox58"><p id="p0930">if (!requireNamespace("BiocManager", quietly = TRUE))</p><p id="p0935"> install.packages("BiocManager")</p><p id="p0940">BiocManager::install("InterMineR")</p></boxed-text></p></list-item></list></p></list-item><list-item id="o0240"><label>c.</label><p id="p0960">Install Phangorn (<xref rid="bib21" ref-type="bibr">Schliep et al., 2017</xref>), using:<boxed-text id="dtbox60"><p id="p0965">install.packages("phangorn")</p></boxed-text></p></list-item></list></p>
          </list-item>
        </list>
      </p>
    </sec>
    <sec id="sec1.10">
      <title>Install Newick Utilities</title>
      <p id="p0975">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx2.gif"/>
            <bold>Timing: 5 min</bold>
          </p>
        </disp-quote>
        <list list-type="simple" id="olist0125">
          <list-item id="o0245">
            <label>13.</label>
            <p id="p0980">Install Newick Utilities (<xref rid="bib9" ref-type="bibr">Junier and Zdobnov, 2010</xref>), typing the following commands in Ubuntu terminal:</p>
          </list-item>
        </list>
        <boxed-text id="dtbox62">
          <p id="p0985">
sudo apt-get install flex bison
</p>
          <p id="p0990">
wget
</p>
          <p id="p0995">
            <ext-link ext-link-type="uri" xlink:href="https://web.archive.org/web/20190914014444/http://cegg.unige.ch/pub/newick-utils-1.6-Linux-x86_64-disabled-extra.tar.gz" id="intref0045">https://web.archive.org/web/20190914014444/http://cegg.unige.ch/pub/newick-utils-1.6-Linux-x86_64-disabled-extra.tar.gz</ext-link>
          </p>
          <p id="p1000">
tar -zxvf newick-utils-1.6-Linux-x86_64-disabled-
</p>
          <p id="p1005">
extra.tar.gz
</p>
          <p id="p1010">
cd newick-utils-1.6/src/
</p>
          <p id="p1015">
sudo cp nw_∗ /usr/local/bin/.
</p>
        </boxed-text>
      </p>
    </sec>
    <sec id="sec1.11">
      <title>Install Dendroscope</title>
      <p id="p1020">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx2.gif"/>
            <bold>Timing: 5 min</bold>
          </p>
        </disp-quote>
        <list list-type="simple" id="olist0130">
          <list-item id="o0250">
            <label>14.</label>
            <p id="p1025">Install Dendroscope (<xref rid="bib8" ref-type="bibr">Huson and Scornavacca, 2012</xref>) using the following:<list list-type="simple" id="olist0135"><list-item id="o0255"><label>a.</label><p id="p1030">Visit <ext-link ext-link-type="uri" xlink:href="https://software-ab.informatik.uni-tuebingen.de/download/dendroscope3/welcome.html" id="intref0050">https://software-ab.informatik.uni-tuebingen.de/download/dendroscope3/welcome.html</ext-link> and download Dendroscope installation script for Linux</p></list-item><list-item id="o0260"><label>b.</label><p id="p1035">Type the following command in Ubuntu terminal:<boxed-text id="dtbox63"><p id="p1040">chmod 755 Dendroscope_unix_∗sh</p></boxed-text></p></list-item><list-item id="o0265"><label>c.</label><p id="p1050">Run the installation using:<boxed-text id="dtbox65"><p id="p1055">sudo ./Dendroscope_unix_∗.sh</p></boxed-text></p></list-item><list-item id="o0270"><label>d.</label><p id="p1065">During the installation, select the “Check for updates: On every start” option and set max memory usage to at least 16,384 Megabytes.</p></list-item></list></p>
          </list-item>
        </list>
      </p>
    </sec>
  </sec>
  <sec id="sec8">
    <title>Key resources table</title>
    <p id="p2625">
      <table-wrap position="float" id="undtbl1">
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th>REAGENT or RESOURCE</th>
              <th>SOURCE</th>
              <th>IDENTIFIER</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="3">
                <bold>Deposited data</bold>
              </td>
            </tr>
            <tr>
              <td colspan="3">
                <hr/>
              </td>
            </tr>
            <tr>
              <td><italic>Arabidopsis thaliana</italic> Microarray Samples - ArrayExpress</td>
              <td>(<xref rid="bib11" ref-type="bibr">Kolesnikov et al., 2015</xref>)</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/arrayexpress/" id="intref0090">https://www.ebi.ac.uk/arrayexpress/</ext-link>
              </td>
            </tr>
            <tr>
              <td><italic>Arabidopsis thaliana</italic> Microarray Samples - GEO</td>
              <td>(<xref rid="bib1" ref-type="bibr">Barrett et al., 2013</xref>)</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/" id="intref0095">https://www.ncbi.nlm.nih.gov/geo/</ext-link>
              </td>
            </tr>
            <tr>
              <td><italic>Arabidopsis thaliana</italic> Microarray Samples - NASCArrays</td>
              <td>(<xref rid="bib5" ref-type="bibr">Craigon et al., 2004</xref>)</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="http://bar.utoronto.ca/NASCArrays/index.php" id="intref0100">http://bar.utoronto.ca/NASCArrays/index.php</ext-link>
              </td>
            </tr>
            <tr>
              <td>Full list of Microarray Samples used</td>
              <td>(<xref rid="bib25" ref-type="bibr">Zogopoulos et al., 2021</xref>)</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://data.mendeley.com/datasets/hgvk669v89/" id="intref0105">https://data.mendeley.com/datasets/hgvk669v89/</ext-link>
              </td>
            </tr>
            <tr>
              <td colspan="3">
                <hr/>
              </td>
            </tr>
            <tr>
              <td colspan="3">
                <bold>Software and algorithms</bold>
              </td>
            </tr>
            <tr>
              <td colspan="3">
                <hr/>
              </td>
            </tr>
            <tr>
              <td>MySQL Workbench</td>
              <td>(<xref rid="bib27" ref-type="bibr">Oracle, 2021</xref>)</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://www.mysql.com/products/workbench/" id="intref0110">https://www.mysql.com/products/workbench/</ext-link>
              </td>
            </tr>
            <tr>
              <td>Single Channel Array Normalization (SCAN)</td>
              <td>(<xref rid="bib20" ref-type="bibr">Piccolo et al., 2012</xref>)</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://www.bioconductor.org/packages/release/bioc/html/SCAN.UPC.html" id="intref0115">https://www.bioconductor.org/packages/release/bioc/html/SCAN.UPC.html</ext-link>
              </td>
            </tr>
            <tr>
              <td>Brainarray Custom CDF</td>
              <td>(<xref rid="bib6" ref-type="bibr">Dai et al., 2005</xref>)</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="http://brainarray.mbni.med.umich.edu/Brainarray/Database/CustomCDF/genomic_curated_CDF.asp" id="intref0120">http://brainarray.mbni.med.umich.edu/Brainarray/Database/CustomCDF/genomic_curated_CDF.asp</ext-link>
              </td>
            </tr>
            <tr>
              <td>Array Power Tools</td>
              <td>(<xref rid="bib7" ref-type="bibr">Thermo Fisher Scientific, 2020</xref>)</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://www.thermofisher.com/gr/en/home/life-science/microarray-analysis/microarray-analysis-partners-programs/affymetrix-developers-network/affymetrix-power-tools.html" id="intref0125">https://www.thermofisher.com/gr/en/home/life-science/microarray-analysis/microarray-analysis-partners-programs/affymetrix-developers-network/affymetrix-power-tools.html</ext-link>
              </td>
            </tr>
            <tr>
              <td>InterMineR</td>
              <td>(<xref rid="bib12" ref-type="bibr">Kyritsis et al., 2019</xref>)</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://www.bioconductor.org/packages/release/bioc/html/InterMineR.html" id="intref0130">https://www.bioconductor.org/packages/release/bioc/html/InterMineR.html</ext-link>
              </td>
            </tr>
            <tr>
              <td>simpleaffy</td>
              <td>(<xref rid="bib16" ref-type="bibr">Miller, 2018</xref>)</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://web.archive.org/web/20201024030658/http://www.bioconductor.org/packages/release/bioc/html/simpleaffy.html" id="intref0135">https://web.archive.org/web/20201024030658/http://www.bioconductor.org/packages/release/bioc/html/simpleaffy.html</ext-link>
              </td>
            </tr>
            <tr>
              <td>affyQCReport</td>
              <td>(<xref rid="bib18" ref-type="bibr">Parman et al., 2021</xref>)</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/release/bioc/html/affyQCReport.html" id="intref0140">https://bioconductor.org/packages/release/bioc/html/affyQCReport.html</ext-link>
              </td>
            </tr>
            <tr>
              <td>affyPLM</td>
              <td>(<xref rid="bib2" ref-type="bibr">Bolstad et al., 2005</xref>; <xref rid="bib3" ref-type="bibr">Brettschneider et al., 2008</xref>)</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/release/bioc/html/affyPLM.html" id="intref0145">https://bioconductor.org/packages/release/bioc/html/affyPLM.html</ext-link>
              </td>
            </tr>
            <tr>
              <td>oligo</td>
              <td>(<xref rid="bib4" ref-type="bibr">Carvalho and Irizarry, 2010</xref>)</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://www.bioconductor.org/packages/release/bioc/html/oligo.html" id="intref0150">https://www.bioconductor.org/packages/release/bioc/html/oligo.html</ext-link>
              </td>
            </tr>
            <tr>
              <td>Phangorn</td>
              <td>(<xref rid="bib21" ref-type="bibr">Schliep et al., 2017</xref>)</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/phangorn/index.html" id="intref0155">https://cran.r-project.org/web/packages/phangorn/index.html</ext-link>
              </td>
            </tr>
            <tr>
              <td>Newick Utilities</td>
              <td>(<xref rid="bib9" ref-type="bibr">Junier and Zdobnov, 2010</xref>)</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://github.com/tjunier/newick_utils" id="intref0160">https://github.com/tjunier/newick_utils</ext-link>
              </td>
            </tr>
            <tr>
              <td>Dendroscope</td>
              <td>(<xref rid="bib8" ref-type="bibr">Huson and Scornavacca, 2012</xref>)</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://uni-tuebingen.de/fakultaeten/mathematisch-naturwissenschaftliche-fakultaet/fachbereiche/informatik/lehrstuehle/algorithms-in-bioinformatics/software/dendroscope/" id="intref0165">https://uni-tuebingen.de/fakultaeten/mathematisch-naturwissenschaftliche-fakultaet/fachbereiche/informatik/lehrstuehle/algorithms-in-bioinformatics/software/dendroscope/</ext-link>
              </td>
            </tr>
            <tr>
              <td>Thalemine</td>
              <td>(<xref rid="bib26" ref-type="bibr">Krishnakumar et al., 2015</xref>)</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://bar.utoronto.ca/thalemine/begin.do" id="intref0170">https://bar.utoronto.ca/thalemine/begin.do</ext-link>
              </td>
            </tr>
            <tr>
              <td>String</td>
              <td>(<xref rid="bib23" ref-type="bibr">Szklarczyk et al., 2021</xref>)</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://string-db.org/" id="intref0175">https://string-db.org/</ext-link>
              </td>
            </tr>
            <tr>
              <td>WebGestalt</td>
              <td>(<xref rid="bib14" ref-type="bibr">Liao et al., 2019</xref>)</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="http://www.webgestalt.org/" id="intref0180">http://www.webgestalt.org/</ext-link>
              </td>
            </tr>
            <tr>
              <td colspan="3">
                <hr/>
              </td>
            </tr>
            <tr>
              <td colspan="3">
                <bold>Other</bold>
              </td>
            </tr>
            <tr>
              <td colspan="3">
                <hr/>
              </td>
            </tr>
            <tr>
              <td>Intel(R) Core(TM) i7-8700K CPU @ 3.7 GHz (6 cores × 2 threads)</td>
              <td>Intel Corporation</td>
              <td>SR3QR</td>
            </tr>
            <tr>
              <td>4 TB WD Purple Surveillance Hard Drive</td>
              <td>Western Digital</td>
              <td>WD40PURZ</td>
            </tr>
            <tr>
              <td>2 × VENGEANCE® LPX 32 GB (2 × 16 GB) DDR4 DRAM 2400MHz C14 Memory Kits</td>
              <td>Corsair</td>
              <td>CMK32GX4M2A2400C14</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </p>
  </sec>
  <sec id="sec2">
    <title>Step-by-step method details</title>
    <sec id="sec2.1">
      <title>Sample search and collection</title>
      <p id="p1070">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx2.gif"/>
            <bold>Timing: 2 days</bold>
          </p>
        </disp-quote>
      </p>
      <p id="p1075">The main aim of this protocol is to perform a condition-independent coexpression analysis for the species of interest. As such, the microarray samples need to be of various distinct healthy tissues and originate from the same Affymetrix microarray chip.<list list-type="simple" id="olist0140"><list-item id="o0275"><label>1.</label><p id="p1080">Select an Affymetrix microarray chip for the species of interest. To identify the most popular Affymetrix chip for the species of interest (in our case, <italic>Arabidopsis thaliana</italic> model plant organism), we performed a search in GEO (<xref rid="bib1" ref-type="bibr">Barrett et al., 2013</xref>):<list list-type="simple" id="olist0145"><list-item id="o0280"><label>a.</label><p id="p1085">Visit GEO website: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/" id="intref0055">https://www.ncbi.nlm.nih.gov/geo/</ext-link></p></list-item><list-item id="o0285"><label>b.</label><p id="p1090">Under Browse Content, click on Platforms</p></list-item><list-item id="o0290"><label>c.</label><p id="p1095">In the search field insert: Arabidopsis thaliana Affymetrix</p></list-item><list-item id="o0295"><label>d.</label><p id="p1100">Click on “Samples” twice to sort by samples in descending order</p></list-item></list></p></list-item></list></p>
      <p id="p1105">This identified [ATH1-121501] Affymetrix Arabidopsis ATH1 Genome Array as the Affymetrix chip with the most available samples.<disp-quote><p><bold><italic>Note:</italic></bold> Try selecting an Affymetrix microarray chip that not only has a large number of open-access samples in public repositories but also includes a significant proportion of the genes of the selected organism. For example, ATH1-121501 Genome Array chip studies ∼24,000 genes, while AG Affymetrix Arabidopsis Genome Array studies only ∼8000 genes.</p></disp-quote><list list-type="simple" id="olist0150"><list-item id="o0300"><label>2.</label><p id="p1110">Search public repositories for ‘<italic>Arabidopsis thaliana</italic>’ keyword and the platform code of the microarray chip. Each repository uses a different platform code for each chip. Furthermore, alternative platform codes of the same chip and repository must also be examined.<list list-type="simple" id="olist0155"><list-item id="o0305"><label>a.</label><p id="p1115">Search ArrayExpress (<xref rid="bib11" ref-type="bibr">Kolesnikov et al., 2015</xref>) for ‘<italic>Arabidopsis thaliana</italic>’ and ‘A-AFFY-2’ (the platform code of ATH1-121501 in ArrayExpress) keywords.</p></list-item><list-item id="o0310"><label>b.</label><p id="p1120">Search Gene Expression Omnibus (GEO) for ‘<italic>Arabidopsis thaliana</italic>’ and ‘GPL198’ (the platform code of ATH1-121501 in GEO) keywords.</p></list-item><list-item id="o0315"><label>c.</label><p id="p1125">Download all experiments from Nottingham Arabidopsis Stock Centre (NASC) (<xref rid="bib5" ref-type="bibr">Craigon et al., 2004</xref>) repository using the following link: <ext-link ext-link-type="uri" xlink:href="https://uniofnottm-my.sharepoint.com/:f:/g/personal/sean_may_nottingham_ac_uk/Ep5b_GCihv1Nu0EYxWpkZggBK-6kAgZjMfk-9JQWJPyXUg?e=nXhIrh" id="intref0060">https://uniofnottm-my.sharepoint.com/:f:/g/personal/sean_may_nottingham_ac_uk/Ep5b_GCihv1Nu0EYxWpkZggBK-6kAgZjMfk-9JQWJPyXUg?e=nXhIrh</ext-link></p></list-item></list></p></list-item></list><disp-quote><p><inline-graphic xlink:href="fx3.gif"/><bold>CRITICAL:</bold> Arrange the series in different directories. Each series directory should contain the raw data (CEL files) of the samples of the series. &lt;Series Main Directory&gt; is the path of the directory that contains the directories of all series.</p></disp-quote><disp-quote><p><inline-graphic xlink:href="fx4.gif"/><bold>Pause point:</bold> Depending on the total number, study download might take a considerable amount of time.</p></disp-quote><list list-type="simple" id="olist0160"><list-item id="o0320"><label>3.</label><p id="p1130">Data Integrity Check.<list list-type="simple" id="olist0165"><list-item id="o0325"><label>a.</label><p id="p1135">Unzip any zipped and/or gzipped CEL files, delete folders of studies which do not contain any CEL files and convert binary CEL files to text files using the following command in Ubuntu bash:<boxed-text id="dtbox67"><p id="p1140">php Parsers/Uncompress_and_Convert.php &lt;Series Main Directory&gt;</p></boxed-text></p></list-item><list-item id="o0330"><label>b.</label><p id="p1150">Check if platform is “ATH1-121501” in each CEL file and delete those CEL files which are of different platforms, using:<boxed-text id="dtbox69"><p id="p1155">php Parsers/Find_Non_ATH1.php &lt;Series Main Directory&gt;</p></boxed-text></p></list-item><list-item id="o0335"><label>c.</label><p id="p1165">Check and auto-delete duplicate CEL files, using:<boxed-text id="dtbox71"><p id="p1170">php Parsers/Find_CEL_duplicates.php &lt;Series Main Directory&gt;</p></boxed-text></p><p id="p1175">Checkpoint: When our analysis was performed (13<sup>th</sup> June 2018), 19887 unique CEL files belonging to 1391 studies, were stored.</p></list-item></list></p></list-item></list></p>
    </sec>
    <sec id="sec2.2">
      <title>Sample normalization</title>
      <p id="p1185">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx2.gif"/>
            <bold>Timing: 1d to 2 months (Varies depending on the sample number)</bold>
          </p>
        </disp-quote>
      </p>
      <p id="p1190">The downloaded samples are normalized with Single Channel Array Normalization (SCAN). As the default Affymetrix CDF is outdated, the latest version of Brainarray (<xref rid="bib6" ref-type="bibr">Dai et al., 2005</xref>) CDF is used. This guarantees that each probe set corresponds to a single gene and <italic>vice versa</italic>.<list list-type="simple" id="olist0170"><list-item id="o0340"><label>4.</label><p id="p1195">Download the latest version of Brainarray CDF.<list list-type="simple" id="olist0175"><list-item id="o0345"><label>a.</label><p id="p1200">Visit Brainarray Custom CDF download page: <ext-link ext-link-type="uri" xlink:href="http://brainarray.mbni.med.umich.edu/Brainarray/Database/CustomCDF/CDF_download.asp" id="intref0065">http://brainarray.mbni.med.umich.edu/Brainarray/Database/CustomCDF/CDF_download.asp</ext-link></p></list-item><list-item id="o0350"><label>b.</label><p id="p1205">Visit the latest ENSG-based CDF page and copy the URL of the appropriate CDF package</p><p id="p2645">(“P” file from the “R Source Package” column, which contains the probe sequence and probe set definition data to be used by SCAN algorithm) in <italic>Arabidopsis thaliana</italic> ATH1121501 row.</p></list-item><list-item id="o0355"><label>c.</label><p id="p1210">Download the CDF in RStudio, using:</p></list-item></list></p></list-item></list><boxed-text id="dtbox73"><p id="p1215">install.packages("&lt;copied url&gt;", repos=NULL, type="source")</p></boxed-text><list list-type="simple" id="olist0180"><list-item id="o0360"><label>5.</label><p id="p1220">Execute SCAN on the samples with the newly downloaded CDF in RStudio, using:<boxed-text id="dtbox74"><p id="p1225">library(SCAN.UPC)</p><p id="p1230">#Custom CDF from Brainarray</p><p id="p1235">library(ath1121501atensgprobe)</p><p id="p1240">#Get each series directory</p><p id="p1245">dirseries&lt;-list.dirs("&lt;Series Main Directory&gt;", full.names = TRUE)</p><p id="p1250">#Run SCAN on each series directory</p><p id="p1255">for(dirhave in dirseries [2:length(dirseries)]){</p><p id="p1260"> #Set working directory</p><p id="p1265"> setwd(dirhave)</p><p id="p1270"> #Run SCAN</p><p id="p1275"> normalised=SCAN("∗.CEL", probeSummaryPackage = ath1121501atensgprobe,</p><p id="p1280">outFilePath="SCAN_matrix.txt")</p><p id="p1285"> #Show finished series</p><p id="p1290"> print(dirhave)</p><p id="p1295">}</p></boxed-text><disp-quote><p><bold><italic>Note:</italic></bold> In our computer setup, SCAN needs about 2–3 min to run for each sample of Affymetrix ATH1-121501 chip. As such, SCAN total execution time depends on the total number of samples. A matrix containing all ∼20,000 genes of the CDF and their expression values in each sample of a series is produced as SCAN_matrix.txt inside each series directory.</p></disp-quote><disp-quote><p><inline-graphic xlink:href="fx4.gif"/><bold>Pause point:</bold> Depending on the total number of samples, SCAN might be running for days, weeks or more than a month. The users should leave the computer running during this time, thus, the use of Uninterruptible Power Supply (UPS) is highly advisable.</p></disp-quote><list list-type="simple" id="olist0185"><list-item id="o0365"><label>a.</label><p id="p1300">Navigate to ACT directory in Ubuntu terminal:<boxed-text id="dtbox75"><p id="p1305">cd ACT</p><p id="p1310">pwd</p></boxed-text></p><p id="p1315">Record the path of the ACT directory on your system. Replace it for &lt;ACT path&gt; in the</p><p id="p1320">following MySQL queries.</p></list-item><list-item id="o0370"><label>b.</label><p id="p1335">Parse all SCAN_matrix.txt files to a single txt file (expression.txt) in a 4-column format, using:<boxed-text id="dtbox77"><p id="p1340">php Parsers/SCAN_Compile.php &lt;Series Main Directory&gt; &gt;</p><p id="p1345">data/expression.txt</p></boxed-text></p><p id="p1350">Checkpoint: expression.txt is a tab-delimited file of <italic>n</italic>∙<italic>m</italic> lines and 4 columns, where <italic>n</italic> is the number of genes and <italic>m</italic> in the number of downloaded samples.</p></list-item><list-item id="o0375"><label>c.</label><p id="p1365">Produce the .txt files for the tables of the database using:<boxed-text id="dtbox79"><p id="p1370">chmod 755 db_files.sh</p><p id="p1375">./db_files.sh</p></boxed-text></p></list-item><list-item id="o0380"><label>d.</label><p id="p1390">Insert the produced .txt files into local MySQL database in MySQL terminal using, the following commands in this order:<boxed-text id="dtbox81"><p id="p1395">LOAD DATA LOCAL INFILE '&lt;ACT path&gt;/data/sample.txt' INTO TABLE</p><p id="p1400">Sample;</p><p id="p1405">LOAD DATA LOCAL INFILE '&lt;ACT path&gt;/data/samples.txt' INTO TABLE</p><p id="p1410">Samples;</p><p id="p1415">LOAD DATA LOCAL INFILE '&lt;ACT path&gt;/data/ENSG.txt' INTO TABLE</p><p id="p1420">ENSG;</p><p id="p1425">LOAD DATA LOCAL INFILE '&lt;ACT path&gt;/data/probeset.txt' INTO</p><p id="p1430">TABLE ProbeSet;</p><p id="p1435">LOAD DATA LOCAL INFILE '&lt;ACT path&gt;/data/probesets.txt' INTO</p><p id="p1440">TABLE ProbeSets;</p><p id="p1445">LOAD DATA LOCAL INFILE '&lt;ACT path&gt;/data/selected_genes.txt'</p><p id="p1450">INTO TABLE Selected_Genes;</p><p id="p1455">LOAD DATA LOCAL INFILE '&lt;ACT path&gt;/data/expression.txt' INTO</p><p id="p1460">TABLE Expression;</p></boxed-text></p><p id="p1465">Checkpoint: selected_genes.txt is a single column file of <italic>n</italic> lines, where <italic>n</italic> is the number of genes which are described by the BrainArray CDF.</p></list-item></list></p></list-item></list></p>
    </sec>
    <sec id="sec2.3">
      <title>Sample quality control</title>
      <p id="p1540">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx2.gif"/>
            <bold>Timing: 1–2 weeks</bold>
          </p>
        </disp-quote>
      </p>
      <p id="p1545">A series of quality controls with different metrics needs to be performed to guarantee high-quality samples. In addition, samples which come from whole plant experiments or are from infected or mutated samples need to be deleted from their directory. However, in most of the cases there is no way to parse programmatically the metadata for each sample, as their format may vary significantly, which can lead to loss of important sample details. Thus, extensive manual curation is required.<list list-type="simple" id="olist0190"><list-item id="o0385"><label>6.</label><p id="p1550">Acquire quality control metrics for each series in RStudio, using:<boxed-text id="dtbox83"><p id="p1555">library(oligo)</p><p id="p1560">dirseries&lt;-list.dirs("&lt;Series Main Directory&gt;", full.names = TRUE)</p><p id="p1565">for(dirhave in dirseries[2:length(dirseries)]){</p><p id="p1570"> setwd(dirhave)</p><p id="p1575"> celFiles &lt;- list.celfiles(dirhave, full.names=TRUE)</p><p id="p1580"> rawData &lt;- read.celfiles(celFiles)</p><p id="p1585"> fit1 &lt;- fitProbeLevelModel(rawData)</p><p id="p1590"> boxplot(fit1, main="NUSE", ylim = c(0.95, 1.22),outline = FALSE,</p><p id="p1595">col="lightblue", las=3, whisklty=0, staplelty=0, cex.axis=0.5)</p><p id="p1600"> #export boxplot</p><p id="p1605"> dev.copy(pdf,'oligo_NUSE.pdf')</p><p id="p1610"> dev.off()</p></boxed-text><list list-type="simple" id="olist0195"><list-item id="o0390"><label>a.</label><p id="p1645">In each series directory, PDF files containing the RLE and NUSE boxplot (<xref rid="bib2" ref-type="bibr">Bolstad et al., 2005</xref>) for each sample of the study, are created.</p></list-item><list-item id="o0395"><label>b.</label><p id="p1650">Samples whose RLE boxplot has an interquartile range (IQR) &gt;0.4 or median &gt;|0.2| (deviates from 0), are considered low-quality.</p></list-item><list-item id="o0400"><label>c.</label><p id="p1655">Samples whose NUSE boxplot has a median &gt;1.1 (deviates from 1), are considered low-quality.</p></list-item></list></p></list-item></list><list list-type="simple" id="olist0200"><list-item id="o0405"><label>7.</label><p id="p1660">A php script was created to automatically delete samples based on the aforementioned out-of-range values. Perform automatic quality control and low-quality sample deletion in Ubuntu terminal, using:</p></list-item></list></p>
      <p id="p1665">php Parsers/oligo_QC_R.php &lt;Series Main Directory&gt;<disp-quote><p><inline-graphic xlink:href="fx3.gif"/><bold>CRITICAL:</bold> Manual quality control is still possible, by examining the RLE (<xref rid="fig2" ref-type="fig">Figure 2</xref>) and NUSE (<xref rid="fig3" ref-type="fig">Figure 3</xref>) pdf files.</p></disp-quote><list list-type="simple" id="olist0205"><list-item id="o0410"><label>8.</label><p id="p1670">Download the metadata for each series (encountered as SDRF files in ArrayExpress or Series Matrix files in GEO).<list list-type="simple" id="olist0210"><list-item id="o0415"><label>a.</label><p id="p1675">Manually examine the metadata looking for certain keywords and fields. Delete the CEL files of samples:<list list-type="simple" id="olist0215"><list-item id="o0420"><label>i.</label><p id="p1680">of species other than Arabidopsis thaliana</p></list-item><list-item id="o0425"><label>ii.</label><p id="p1685">that are from ‘whole plant’, ‘whole organism’, etc</p></list-item><list-item id="o0430"><label>iii.</label><p id="p1690">of cell cultures (<xref rid="tbl1" ref-type="table">Table 1</xref>)</p></list-item><list-item id="o0435"><label>iv.</label><p id="p1695">that are mutated (<xref rid="tbl2" ref-type="table">Table 2</xref>) or infected (<xref rid="tbl3" ref-type="table">Table 3</xref>)</p></list-item></list></p></list-item></list></p></list-item></list><disp-quote><p><bold><italic>Note 1:</italic></bold> Metadata files are available in .txt (tab delimited) format. There are certain fields such as “Tissue”, “Organism Part” or “Disease State” which are used to determine if a sample should be kept or deleted.</p></disp-quote><disp-quote><p><bold><italic>Note 2:</italic></bold> Since the aim of this protocol is to study the condition independent coexpression landscape of a species, the same procedure can be used for other organisms, keeping only healthy samples of distinct tissues.</p></disp-quote><disp-quote><p><inline-graphic xlink:href="fx4.gif"/><bold>Pause point:</bold> The users can pause and continue the metadata examination step at any point.</p></disp-quote><list list-type="simple" id="olist0220"><list-item id="o0440"><label>9.</label><p id="p1700">After quality control is complete, only healthy single-tissue samples remain.</p></list-item></list></p>
      <p id="p1705">Checkpoint: A large amount of samples might be deleted during the quality control process. In our case, only 6933 samples out of the 19887 remained.<list list-type="simple" id="olist0225"><list-item id="o0445"><label>10.</label><p id="p1710">Produce sample names using:</p></list-item></list><boxed-text id="dtbox84"><p id="p1715">php Parsers/Get_Sample_Names.php &lt;Series Main Directory&gt; &gt;</p><p id="p1720">data/Sample_Names.txt</p></boxed-text><list list-type="simple" id="olist0230"><list-item id="o0450"><label>11.</label><p id="p1725">Produce selected sample index list using:<boxed-text id="dtbox85"><p id="p1730">php Parsers/Create_Selected_Samples.php data/Sample_Names.txt&gt;</p><p id="p1735">data/Selected_Samples.txt</p></boxed-text><list list-type="simple" id="olist0235"><list-item id="o0455"><label>a.</label><p id="p1740">Insert Selected_Samples.txt into Selected_Samples table in MySQL terminal, using:<boxed-text id="dtbox86"><p id="p1745">LOAD DATA LOCAL INFILE '&lt;ACT path&gt;/data/Selected_Samples.txt' INTO</p><p id="p1750">TABLE Selected_Samples;</p></boxed-text></p></list-item></list></p></list-item></list></p>
      <p id="p1765">
        <fig id="fig2">
          <label>Figure 2</label>
          <caption>
            <p>RLE plots of two ArrayExpress studies</p>
            <p>(A) All samples of E-ATMX-1 study pass the quality control.</p>
            <p>(B) AtD3.CEL sample of E-ATMX-19 study does not pass the quality control, as its IQR &gt; 0.4, thus it must be removed from the pool of samples.</p>
          </caption>
          <graphic xlink:href="gr2"/>
        </fig>
        <fig id="fig3">
          <label>Figure 3</label>
          <caption>
            <p>NUSE plots of two ArrayExpress studies</p>
            <p>(A) All samples of E-ATMX-7 study pass the quality control.</p>
            <p>(B) CHIP_313_B.CEL and CHIP_317_B.CEL samples E-ATMX-24 study do not pass the quality control, as their median &gt; 1.1, thus, they should be removed from the pool of samples.</p>
          </caption>
          <graphic xlink:href="gr3"/>
        </fig>
        <table-wrap position="float" id="tbl1">
          <label>Table 1</label>
          <caption>
            <p>Selected fields of the metadata of the samples of series E-ATMX-31</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <th>Source name</th>
                <th>Characteristics [organism]</th>
                <th>Characteristics [OrganismPart]</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Shoot 3</td>
                <td>Arabidopsis thaliana</td>
                <td>Shoot</td>
              </tr>
              <tr>
                <td>Shoot 2</td>
                <td>Arabidopsis thaliana</td>
                <td>Shoot</td>
              </tr>
              <tr>
                <td>Shoot 1</td>
                <td>Arabidopsis thaliana</td>
                <td>shoot</td>
              </tr>
              <tr>
                <td>Cell culture 3</td>
                <td>Arabidopsis thaliana</td>
                <td>cultured callus</td>
              </tr>
              <tr>
                <td>Root 3</td>
                <td>Arabidopsis thaliana</td>
                <td>root</td>
              </tr>
              <tr>
                <td>Cell culture 2</td>
                <td>Arabidopsis thaliana</td>
                <td>cultured callus</td>
              </tr>
              <tr>
                <td>Root 2</td>
                <td>Arabidopsis thaliana</td>
                <td>root</td>
              </tr>
              <tr>
                <td>Cell culture 1</td>
                <td>Arabidopsis thaliana</td>
                <td>cultured callus</td>
              </tr>
              <tr>
                <td>Root 1</td>
                <td>Arabidopsis thaliana</td>
                <td>root</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <fn>
              <p>“Cell culture 1”, “Cell culture 2” and “Cell culture 3” samples should be deleted, as they are from cell cultures, while the rest of the samples should be accepted as they are based on single tissues (“shoot” or “root”).</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <table-wrap position="float" id="tbl2">
          <label>Table 2</label>
          <caption>
            <p>Selected fields of the metadata of the samples of series E-ATMX-20</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <th>Source name</th>
                <th>Characteristics [organism]</th>
                <th>Characteristics [organism part]</th>
                <th>Characteristics [genotype]</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Zat10-OE-2</td>
                <td>Arabidopsis thaliana</td>
                <td>Leaf</td>
                <td>35S:ZAT10</td>
              </tr>
              <tr>
                <td>wildtype-2</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>wild type</td>
              </tr>
              <tr>
                <td>wildtype-1</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>wild type</td>
              </tr>
              <tr>
                <td>wildtype-3</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>wild type</td>
              </tr>
              <tr>
                <td>Zat10-OE-1</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>35S:ZAT10</td>
              </tr>
              <tr>
                <td>Zat10-OE-3</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>35S:ZAT10</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <fn>
              <p>“Zat10-OE-1”, “Zat10-OE-2” and “Zat10-OE-3” samples should be deleted, as they come from mutated plants, while “wildtype-1”, “wildtype-2” and “wildtype-3” samples should be accepted, as they are based on wild-type plants.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <table-wrap position="float" id="tbl3">
          <label>Table 3</label>
          <caption>
            <p>Selected fields of the metadata of the samples of series E-GEOD-50526</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <th>Source name</th>
                <th>Characteristics [organism]</th>
                <th>Characteristics [organism part]</th>
                <th>Assay name</th>
                <th>FactorValue [genotype]</th>
                <th>FactorValue [infect]</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220728" id="intref0210">GSM1220728</ext-link> 1</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220728" id="intref0215">GSM1220728</ext-link>
                </td>
                <td>dde2-2</td>
                <td>Alternaria brassicicola</td>
              </tr>
              <tr>
                <td><ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220719" id="intref0220">GSM1220719</ext-link> 1</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220719" id="intref0225">GSM1220719</ext-link>
                </td>
                <td>dde2-2</td>
                <td>Alternaria brassicicola</td>
              </tr>
              <tr>
                <td><ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220709" id="intref0230">GSM1220709</ext-link> 1</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220709" id="intref0235">GSM1220709</ext-link>
                </td>
                <td>dde2-2</td>
                <td>Alternaria brassicicola</td>
              </tr>
              <tr>
                <td><ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220724" id="intref0240">GSM1220724</ext-link> 1</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220724" id="intref0245">GSM1220724</ext-link>
                </td>
                <td>dde2-2</td>
                <td>Alternaria brassicicola</td>
              </tr>
              <tr>
                <td><ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220714" id="intref0250">GSM1220714</ext-link> 1</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220714" id="intref0255">GSM1220714</ext-link>
                </td>
                <td>dde2-2</td>
                <td>Alternaria brassicicola</td>
              </tr>
              <tr>
                <td><ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220704" id="intref0260">GSM1220704</ext-link> 1</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220704" id="intref0265">GSM1220704</ext-link>
                </td>
                <td>dde2-2</td>
                <td>Alternaria brassicicola</td>
              </tr>
              <tr>
                <td><ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220729" id="intref0270">GSM1220729</ext-link> 1</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220729" id="intref0275">GSM1220729</ext-link>
                </td>
                <td>ein2-1</td>
                <td>Alternaria brassicicola</td>
              </tr>
              <tr>
                <td><ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220720" id="intref0280">GSM1220720</ext-link> 1</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220720" id="intref0285">GSM1220720</ext-link>
                </td>
                <td>ein2-1</td>
                <td>Alternaria brassicicola</td>
              </tr>
              <tr>
                <td><ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220710" id="intref0290">GSM1220710</ext-link> 1</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220710" id="intref0295">GSM1220710</ext-link>
                </td>
                <td>ein2-1</td>
                <td>Alternaria brassicicola</td>
              </tr>
              <tr>
                <td><ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220725" id="intref0300">GSM1220725</ext-link> 1</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220725" id="intref0305">GSM1220725</ext-link>
                </td>
                <td>ein2-1</td>
                <td>Alternaria brassicicola</td>
              </tr>
              <tr>
                <td><ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220715" id="intref0310">GSM1220715</ext-link> 1</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220715" id="intref0315">GSM1220715</ext-link>
                </td>
                <td>ein2-1</td>
                <td>Alternaria brassicicola</td>
              </tr>
              <tr>
                <td><ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220705" id="intref0320">GSM1220705</ext-link> 1</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220705" id="intref0325">GSM1220705</ext-link>
                </td>
                <td>ein2-1</td>
                <td>Alternaria brassicicola</td>
              </tr>
              <tr>
                <td><ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220730" id="intref0330">GSM1220730</ext-link> 1</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220730" id="intref0335">GSM1220730</ext-link>
                </td>
                <td>sid2-2</td>
                <td>Alternaria brassicicola</td>
              </tr>
              <tr>
                <td><ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220721" id="intref0340">GSM1220721</ext-link> 1</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220721" id="intref0345">GSM1220721</ext-link>
                </td>
                <td>sid2-2</td>
                <td>Alternaria brassicicola</td>
              </tr>
              <tr>
                <td><ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220711" id="intref0350">GSM1220711</ext-link> 1</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220711" id="intref0355">GSM1220711</ext-link>
                </td>
                <td>sid2-2</td>
                <td>Alternaria brassicicola</td>
              </tr>
              <tr>
                <td><ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220726" id="intref0360">GSM1220726</ext-link> 1</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220726" id="intref0365">GSM1220726</ext-link>
                </td>
                <td>sid2-2</td>
                <td>Alternaria brassicicola</td>
              </tr>
              <tr>
                <td><ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220716" id="intref0370">GSM1220716</ext-link> 1</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220716" id="intref0375">GSM1220716</ext-link>
                </td>
                <td>sid2-2</td>
                <td>Alternaria brassicicola</td>
              </tr>
              <tr>
                <td><ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220706" id="intref0380">GSM1220706</ext-link> 1</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220706" id="intref0385">GSM1220706</ext-link>
                </td>
                <td>sid2-2</td>
                <td>Alternaria brassicicola</td>
              </tr>
              <tr>
                <td><ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220718" id="intref0390">GSM1220718</ext-link> 1</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220718" id="intref0395">GSM1220718</ext-link>
                </td>
                <td>wild type</td>
                <td>Alternaria brassicicola</td>
              </tr>
              <tr>
                <td><ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220708" id="intref0400">GSM1220708</ext-link> 1</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220708" id="intref0405">GSM1220708</ext-link>
                </td>
                <td>wild type</td>
                <td>Alternaria brassicicola</td>
              </tr>
              <tr>
                <td><ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220727" id="intref0410">GSM1220727</ext-link> 1</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220727" id="intref0415">GSM1220727</ext-link>
                </td>
                <td>wild type</td>
                <td>mock</td>
              </tr>
              <tr>
                <td><ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220717" id="intref0420">GSM1220717</ext-link> 1</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220717" id="intref0425">GSM1220717</ext-link>
                </td>
                <td>wild type</td>
                <td>mock</td>
              </tr>
              <tr>
                <td><ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220707" id="intref0430">GSM1220707</ext-link> 1</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220707" id="intref0435">GSM1220707</ext-link>
                </td>
                <td>wild type</td>
                <td>mock</td>
              </tr>
              <tr>
                <td><ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220723" id="intref0440">GSM1220723</ext-link> 1</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220723" id="intref0445">GSM1220723</ext-link>
                </td>
                <td>wild type</td>
                <td>Alternaria brassicicola</td>
              </tr>
              <tr>
                <td><ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220713" id="intref0450">GSM1220713</ext-link> 1</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220713" id="intref0455">GSM1220713</ext-link>
                </td>
                <td>wild type</td>
                <td>Alternaria brassicicola</td>
              </tr>
              <tr>
                <td><ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220703" id="intref0460">GSM1220703</ext-link> 1</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220703" id="intref0465">GSM1220703</ext-link>
                </td>
                <td>wild type</td>
                <td>Alternaria brassicicola</td>
              </tr>
              <tr>
                <td><ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220722" id="intref0470">GSM1220722</ext-link> 1</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220722" id="intref0475">GSM1220722</ext-link>
                </td>
                <td>wild type</td>
                <td>mock</td>
              </tr>
              <tr>
                <td><ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220712" id="intref0480">GSM1220712</ext-link> 1</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220712" id="intref0485">GSM1220712</ext-link>
                </td>
                <td>wild type</td>
                <td>mock</td>
              </tr>
              <tr>
                <td><ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220702" id="intref0490">GSM1220702</ext-link> 1</td>
                <td>Arabidopsis thaliana</td>
                <td>leaf</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220702" id="intref0495">GSM1220702</ext-link>
                </td>
                <td>wild type</td>
                <td>mock</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <fn>
              <p>All samples except for “<ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220702" id="intref0500">GSM1220702</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220707" id="intref0505">GSM1220707</ext-link>”, ”<ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220712" id="intref0510">GSM1220712</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220717" id="intref0515">GSM1220717</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220722" id="intref0520">GSM1220722</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1220727" id="intref0525">GSM1220727</ext-link>” should be deleted, as they come from infected plants.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
      </p>
    </sec>
    <sec id="sec2.4">
      <title>Identification of most representative samples</title>
      <p id="p1770">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx2.gif"/>
            <bold>Timing: 1 day</bold>
          </p>
        </disp-quote>
      </p>
      <p id="p1775">Selection of the most representative samples constitutes the best way to study condition-independent gene coexpression. Pearson Correlation Coefficients (PCCs, <italic>r</italic>-values) (<xref rid="bib19" ref-type="bibr">Pearson, 1895</xref>) between all sample pairs are computed, using their gene expression values. Using PCC-based pairwise distances, hierarchical clustering is performed with UPGMA (<xref rid="bib22" ref-type="bibr">Sokal and Michener, 1958</xref>) and a sample correlation tree is produced which is then automatically trimmed to contain the most representative leaf-samples.<list list-type="simple" id="olist0240"><list-item id="o0460"><label>12.</label><p id="p1780">PCCs between all pairs of selected samples are calculated with the following formula:</p></list-item></list><disp-formula id="fd1"><label>(Equation 1)</label><mml:math id="M1" altimg="si1.gif"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="badbreak">=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo linebreak="badbreak">−</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo linebreak="badbreak">−</mml:mo><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo linebreak="badbreak">−</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>∙</mml:mo><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo linebreak="badbreak">−</mml:mo><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mfrac></mml:mrow></mml:math></disp-formula></p>
      <p id="p1785"><inline-formula><mml:math id="M2" altimg="si2.gif"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>: the expression value of gene <inline-formula><mml:math id="M3" altimg="si3.gif"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> in sample <inline-formula><mml:math id="M4" altimg="si4.gif"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula></p>
      <p id="p1785agjl"><inline-formula><mml:math id="M5" altimg="si5.gif"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>: the expression value of gene <inline-formula><mml:math id="M6" altimg="si3.gif"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> in sample <inline-formula><mml:math id="M7" altimg="si6.gif"><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:math></inline-formula></p>
      <p id="p1785adhg"><inline-formula><mml:math id="M8" altimg="si7.gif"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>: the median expression of all genes in sample <inline-formula><mml:math id="M9" altimg="si4.gif"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula></p>
      <p id="p1785as"><inline-formula><mml:math id="M10" altimg="si8.gif"><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>: the median expression of all genes in sample <inline-formula><mml:math id="M11" altimg="si6.gif"><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:math></inline-formula><list list-type="simple" id="olist0245"><list-item id="o0465"><label>13.</label><p id="p1790">Calculate PCCs between sample pairs:<list list-type="simple" id="olist0250"><list-item id="o0470"><label>a.</label><p id="p1795">Produce the Sample expression file with the current Selected Samples and Selected Genes in Ubuntu terminal, using:<boxed-text id="dtbox88"><p id="p1800">php Parsers/Create_Expression_R.php Samples &gt;</p><p id="p1805">data/sample_expression.txt</p></boxed-text></p><p id="p1810">Checkpoint: sample_expression.txt is a tab-delimited file of <italic>n</italic>+1 lines and <italic>m</italic>+1 columns, where <italic>n</italic> is the number of genes and <italic>m</italic> in the number of samples that have remained after quality control.</p></list-item><list-item id="o0475"><label>b.</label><p id="p1825">Calculate sample pairwise <italic>r</italic>-values and convert them to a distance value with <italic>d = 1 – r</italic> formula (<xref rid="bib10" ref-type="bibr">Kassambara, 2017</xref>) in RStudio, using:<boxed-text id="dtbox90"><p id="p1830">expr_sample &lt;- (read.table("&lt;ACT</p><p id="p1835">path&gt;/data/sample_expression.txt", sep = "\t", header = TRUE,</p><p id="p1840">check.names=FALSE))</p><p id="p1845">fastcor_sample &lt;- 1 - cor(expr_sample)</p></boxed-text></p></list-item></list></p></list-item></list><list list-type="simple" id="olist0255"><list-item id="o0480"><label>14.</label><p id="p1870">Create the sample correlation tree with UPGMA hierarchical clustering algorithm, using the following commands in RStudio:</p></list-item></list><boxed-text id="dtbox92"><p id="p1875">library("phangorn")</p><p id="p1880">upgma_tree &lt;- upgma(fastcor_sample)</p><p id="p1885">write.tree(upgma_tree, "&lt;ACT path&gt;/data/samples_upgma.new")</p></boxed-text><list list-type="simple" id="olist0260"><list-item id="o0485"><label>15.</label><p id="p1890">Sort the produced sample correlation tree using Newick Utilities (<xref rid="bib9" ref-type="bibr">Junier and Zdobnov, 2010</xref>) in Ubuntu terminal:</p></list-item></list><boxed-text id="dtbox93"><p id="p1895">nw_order data/samples_upgma.new &gt; data/samples_upgma_sorted.new</p></boxed-text><list list-type="simple" id="olist0265"><list-item id="o0490"><label>16.</label><p id="p1900">Prune the tree to a desired number of representative leaves (in our case the &lt;leaf number to remain&gt; is 3500 samples), using an in-house iterative phylogenetic algorithm pruning adjacent leaves:</p></list-item></list><boxed-text id="dtbox94"><p id="p1905">php TreePrune/upgma_prune.php data/samples_upgma_sorted.new &lt;leaf number to</p><p id="p1910">remain&gt; &gt; data/Representative_samples.new</p></boxed-text></p>
      <p id="p1915">Those samples constitute the representative samples for the coexpression analysis.</p>
      <p id="p1920">Checkpoint: Representative_samples.new is a Newick formatted file that contains as many leaves as the number of remaining samples (in our case 3500).<list list-type="simple" id="olist0270"><list-item id="o0495"><label>17.</label><p id="p1925">Obtain the leaf-sample names using:</p></list-item></list><boxed-text id="dtbox95"><p id="p1930">php TreePrune/Tree_Names.php data/Representative_samples.new &gt;</p><p id="p1935">data/Representative_Sample_Names.txt</p></boxed-text></p>
      <p id="p1940">and produce Selected Samples indexes using:<boxed-text id="dtbox96"><p id="p1945">php Parsers/Create_Selected_Samples_from_Leaf_names.php</p><p id="p1950">data/Representative_Sample_Names.txt &gt;</p><p id="p1955">data/Representative_Selected_Samples.txt</p></boxed-text><list list-type="simple" id="olist0275"><list-item id="o0500"><label>18.</label><p id="p1960">Empty Selected_Samples table in MySQL terminal, using:</p></list-item></list><boxed-text id="dtbox97"><p id="p1965">truncate table Selected_Samples;</p></boxed-text></p>
      <p id="p1970">then insert Representative_Selected_Samples.txt into Selected_Samples table of local MySQL database using:<boxed-text id="dtbox98"><p id="p1975">LOAD DATA LOCAL INFILE '&lt;ACT</p><p id="p1980">path&gt;/data/Representative_Selected_Samples.txt' INTO TABLE</p><p id="p1985">Selected_Samples;</p></boxed-text><disp-quote><p><inline-graphic xlink:href="fx4.gif"/><bold>Pause point:</bold> The users can pause before performing the final step of the protocol.</p></disp-quote></p>
    </sec>
    <sec id="sec2.5">
      <title>Gene coexpression tree creation</title>
      <p id="p1990">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx2.gif"/>
            <bold>Timing: 2 days</bold>
          </p>
        </disp-quote>
      </p>
      <p id="p1995">By calculating the pairwise Pearson Correlation coefficients between all gene pairs from the representative samples, we can create a gene coexpression distance matrix which will be used as input for the construction of the gene coexpression tree.<list list-type="simple" id="olist0280"><list-item id="o0505"><label>19.</label><p id="p2000">PCC-based distances between all pairs of selected genes are calculated with the previously mentioned formula (<xref rid="fd1" ref-type="disp-formula">Equation 1</xref>). However, in this case:</p><p id="p2005"><inline-formula><mml:math id="M12" altimg="si2.gif"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>: the expression value of gene <inline-formula><mml:math id="M13" altimg="si4.gif"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula> in sample <inline-formula><mml:math id="M14" altimg="si3.gif"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula></p><p id="p2010"><inline-formula><mml:math id="M15" altimg="si5.gif"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>: the expression value of gene <inline-formula><mml:math id="M16" altimg="si6.gif"><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:math></inline-formula> in sample <inline-formula><mml:math id="M17" altimg="si3.gif"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula></p><p id="p2015"><inline-formula><mml:math id="M18" altimg="si7.gif"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>: the median expression of gene <inline-formula><mml:math id="M19" altimg="si4.gif"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula> in all samples</p><p id="p2650"><inline-formula><mml:math id="M20" altimg="si9.gif"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi><mml:mspace width="0.25em"/></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>: the median expression of gene <inline-formula><mml:math id="M21" altimg="si6.gif"><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:math></inline-formula> in all samples</p></list-item></list></p>
      <p id="p2020">
        <list list-type="simple" id="olist0285">
          <list-item id="o0510">
            <label>20.</label>
            <p id="p2025">Calculate PCCs between gene pairs:<list list-type="simple" id="olist0290"><list-item id="o0515"><label>a.</label><p id="p2030">Produce the Gene expression file with the current Selected Samples and Selected Genes in Ubuntu terminal, using:<boxed-text id="dtbox99"><p id="p2035">php Parsers/Create_Expression_R.php Genes &gt; data/gene_expression.txt</p></boxed-text></p><p id="p2040">Checkpoint: gene_expression.txt is a tab-delimited file of <italic>m</italic>+1 lines and <italic>n</italic>+1 columns, where <italic>n</italic> is the number of genes and <italic>m</italic> in the number of representative samples.</p></list-item><list-item id="o0520"><label>b.</label><p id="p2050">Calculate gene pair <italic>r</italic>-values and convert them to a distance value in RStudio, using:<boxed-text id="dtbox101"><p id="p2055">expr_gene &lt;- (read.table("&lt;ACT path&gt;/data/gene_expression.txt",</p><p id="p2060">sep = "\t", header = TRUE, check.names=FALSE))</p><p id="p2065">fastcor_gene &lt;- 1 - cor(expr_gene)</p></boxed-text></p></list-item></list></p>
          </list-item>
        </list>
        <list list-type="simple" id="olist0295">
          <list-item id="o0525">
            <label>21.</label>
            <p id="p2085">Create the gene coexpression tree with UPGMA hierarchical clustering algorithm, using the following commands in the same session of RStudio:</p>
          </list-item>
        </list>
        <boxed-text id="dtbox103">
          <p id="p2090">
library("phangorn")
</p>
          <p id="p2095">
upgma_tree &lt;- upgma(fastcor_gene)
</p>
          <p id="p2100">
write.tree(upgma_tree, "&lt;ACT path&gt;/data/genes_upgma.new")
</p>
        </boxed-text>
        <list list-type="simple" id="olist0300">
          <list-item id="o0530">
            <label>22.</label>
            <p id="p2105">Sort the tree using Newick Utilities in Ubuntu terminal:</p>
          </list-item>
        </list>
        <boxed-text id="dtbox104">
          <p id="p2110">
nw_order data/genes_upgma.new &gt; data/genes_upgma_sorted.new
</p>
        </boxed-text>
      </p>
      <p id="p2115">Checkpoint: genes_upgma_sorted.new is a Newick-formatted file that contains as many leaves as the number of genes.<list list-type="simple" id="olist0305"><list-item id="o0535"><label>23.</label><p id="p2120">Visualize the tree in Dendroscope:<list list-type="simple" id="olist0310"><list-item id="o0540"><label>a.</label><p id="p2125">Open &lt;ACT path&gt;/data/genes_upgma_sorted.new in Dendroscope</p></list-item><list-item id="o0545"><label>b.</label><p id="p2130">Select Layout &gt; Draw tree or network as rectangular phylogram</p></list-item><list-item id="o0550"><label>c.</label><p id="p2135">Untick View &gt; Sparse Labels</p></list-item><list-item id="o0555"><label>d.</label><p id="p2140">Press Ctrl+F or click on the Binoculars icon in the Dendroscope toolbar to search for an AGI code of a gene of interest</p></list-item><list-item id="o0560"><label>e.</label><p id="p2145">Paste the AGI code on the search field and press Enter. The leaf that corresponds to the gene of interest will be highlighted in yellow</p></list-item><list-item id="o0565"><label>f.</label><p id="p2150">Using the mouse wheel, zoom to a subtree node containing the highlighted gene of interest</p></list-item><list-item id="o0570"><label>g.</label><p id="p2155">Left-click the last common ancestral node</p></list-item><list-item id="o0575"><label>h.</label><p id="p2160">Select Select &gt; Advanced Selection &gt; Select Subnetwork</p></list-item><list-item id="o0580"><label>i.</label><p id="p2165">Select Select &gt; Invert Selection</p></list-item><list-item id="o0585"><label>j.</label><p id="p2170">Select Edit &gt; Delete Taxa</p></list-item><list-item id="o0590"><label>k.</label><p id="p2175">Export the subtree as Newick by clicking File &gt; Export &gt; Newick and saving it as a .new file</p></list-item><list-item id="o0595"><label>l.</label><p id="p2180">The gene list can be extracted from the subtree file using:</p></list-item></list></p></list-item></list><boxed-text id="dtbox105"><p id="p2185">php &lt;ACT&gt;TreePrune/Tree_Names.php &lt;subtree newick file&gt; &gt;</p><p id="p2190">subtree_gene_list.txt</p></boxed-text></p>
      <p id="p2195">Checkpoint: subtree_gene_list.txt is a single column file of <italic>s</italic> lines, where <italic>s</italic> is the number of leaves of the subtree Newick-formatted file exported by Dendroscope.</p>
    </sec>
  </sec>
  <sec id="sec3">
    <title>Expected outcomes</title>
    <p id="p2200">The outcome of the protocol is a gene coexpression phylogenetic tree (<xref rid="fig4" ref-type="fig">Figure 4</xref>A) as a Newick-formatted file. In this example, the output tree contains 20,430 <italic>Arabidopsis thaliana</italic> genes which are represented as leaves. Coexpressed genes that may constitute functional partners and, thus, share similar biological functions and metabolic pathways, are grouped together in the same subclade. The tree itself can be viewed by various phylogenetic software supporting Newick-formatted trees.<fig id="fig4"><label>Figure 4</label><caption><p><italic>Arabidopsis thaliana</italic> gene coexpression trees as viewed by Dendroscope</p><p>(A and B) Node labels are the AGI codes of the <italic>Arabidopsis thaliana</italic> genes. (A) Coexpression tree containing all <italic>Arabidopsis thaliana</italic> genes. The leaves highlighted in red denote the region where CTL2 (<ext-link ext-link-type="uri" xlink:href="tair:AT3G16920" id="PC_linkqdGY0S2faG">AT3G16920</ext-link>) coexpression subtree is located (B) Gene coexpression subtree containing CTL2 and its coexpressed genes.</p></caption><graphic xlink:href="gr4"/></fig></p>
    <p id="p2205">The list of the genes of a subtree can be used as input in downstream analyses, such as functional network analysis or enrichment analysis. By examining the enriched gene terms of that subtree, new biological functions for those gene sets may be discovered. In addition, it is possible to attribute biological roles to neighboring genes of unknown function.</p>
    <p id="p2210">Functional partners of a gene of interest may be found in its neighboring leaves. In the example coexpression subtree (<xref rid="fig4" ref-type="fig">Figure 4</xref>B), <italic>CTL2</italic> (shown by its AGI code: <ext-link ext-link-type="uri" xlink:href="tair:AT3G16920" id="PC_linkpFLpnbExXC">AT3G16920</ext-link>), is grouped with genes which are associated with plant-type secondary wall biogenesis.</p>
  </sec>
  <sec id="sec4">
    <title>Quantification and statistical analysis</title>
    <p id="p2215">Enrichment analysis can discover the predominant biological processes of a given coexpressed gene list:<list list-type="simple" id="olist0315"><list-item id="o0600"><label>1.</label><p id="p2220">String (<xref rid="bib23" ref-type="bibr">Szklarczyk et al., 2021</xref>) creates a protein-protein interaction (PPI) network using a gene list as input:<list list-type="simple" id="olist0320"><list-item id="o0605"><label>a.</label><p id="p2225">Visit the String website (<ext-link ext-link-type="uri" xlink:href="https://string-db.org/" id="intref0070">https://string-db.org/</ext-link>) and click on “Search”</p></list-item><list-item id="o0610"><label>b.</label><p id="p2230">Click on “Multiple Proteins”</p></list-item><list-item id="o0615"><label>c.</label><p id="p2235">Paste the contents of subtree_gene_list.txt file that was created previously to “List Of Names” field and select the Organism (in this case <italic>Arabidopsis thaliana</italic>)</p></list-item><list-item id="o0620"><label>d.</label><p id="p2240">Click on “Search”</p></list-item><list-item id="o0625"><label>e.</label><p id="p2245">Click on “Continue”</p></list-item><list-item id="o0630"><label>f.</label><p id="p2250">The resulting PPI network of the input genes is displayed</p></list-item><list-item id="o0635"><label>g.</label><p id="p2255">In “Analysis” tab, “Network Stats” show the density of the network and consequently indicate the degree of functional interaction between the input genes. “Functional enrichments in your network” show the predominant biological terms which are associated with the coexpressed genes.</p></list-item><list-item id="o0640"><label>h.</label><p id="p2260">In “Settings” tab, network parameters, such as interaction sources and interaction thresholds, can be adjusted.</p></list-item></list></p></list-item><list-item id="o0645"><label>2.</label><p id="p2265">WebGestalt (<xref rid="bib14" ref-type="bibr">Liao et al., 2019</xref>) performs enrichment analyses for a gene list:<list list-type="simple" id="olist0325"><list-item id="o0650"><label>a.</label><p id="p2270">Visit the WebGestalt website (<ext-link ext-link-type="uri" xlink:href="http://www.webgestalt.org/" id="intref0075">http://www.webgestalt.org/</ext-link>)</p></list-item><list-item id="o0655"><label>b.</label><p id="p2275">In Basic Parameters:<list list-type="simple" id="olist0330"><list-item id="o0660"><label>i.</label><p id="p2280">Select “Organism of Interest” (in this case <italic>Arabidopsis thaliana</italic>)</p></list-item><list-item id="o0665"><label>ii.</label><p id="p2285">Select “Over-representation analysis (ORA)” as “Method of Interest”</p></list-item></list></p></list-item><list-item id="o0670"><label>c.</label><p id="p2290">Select all available or a certain combination of “Functional Databases” by clicking on the plus mark symbol on the left of the field.</p></list-item><list-item id="o0675"><label>d.</label><p id="p2295">In Gene List:<list list-type="simple" id="olist0335"><list-item id="o0680"><label>i.</label><p id="p2300">Select “Gene Symbol” as GeneID type</p></list-item><list-item id="o0685"><label>ii.</label><p id="p2305">Paste the contents of the subtree_gene_list.txt file that was created previously.</p></list-item></list></p></list-item><list-item id="o0690"><label>e.</label><p id="p2310">In Reference Gene List:<list list-type="simple" id="olist0340"><list-item id="o0695"><label>i.</label><p id="p2315">Select “Gene Symbol“ as GeneID type</p></list-item><list-item id="o0700"><label>ii.</label><p id="p2320">Select “Upload Gene List” and use ACT/data/selected_genes.txt file as input</p></list-item></list></p></list-item><list-item id="o0705"><label>f.</label><p id="p2325">Click on “Submit”<list list-type="simple" id="olist0345"><list-item id="o0710"><label>i.</label><p id="p2330">Click on “Table” tab for table view. The enriched biological terms of the coexpressed genes to the gene interest included in the subtree, are shown.</p></list-item></list></p></list-item></list></p></list-item></list></p>
  </sec>
  <sec id="sec5">
    <title>Limitations</title>
    <p id="p2335">The main limitation of this protocol originates from the transcriptomic technology of microarrays which is not able to study the expression of genes for which no probe is available. Furthermore, cross-hybridization may make false estimations of the gene expression, distorting correlation between members of the same family of genes and other genes. Thus, RNA-seq, having greatly advanced in the latest years, has replaced microarrays as transcriptomic technology of choice, to a large extent. RNA-seq has higher sensitivity and there is a growing amount of data available in public repositories. Nevertheless, it is shown that microarray and RNA-seq-based coexpression analyses produce comparable gene coexpression networks (<xref rid="bib15" ref-type="bibr">Malatras et al., 2020</xref>; <xref rid="bib17" ref-type="bibr">Obayashi et al., 2018</xref>). Considering the fact that there is no definitive pipeline to perform coexpression analysis from raw RNA-seq data, microarray data are still relevant, as their normalization algorithms have been tested and perfected throughout the technology’s lifetime.</p>
    <p id="p2340">A limitation of gene coexpression tree depiction, used in this protocol, is the fact that it cannot portray anti-coexpressed genes. As gene pairwise <italic>r</italic>-values are transformed to non-negative distance values, anti-correlated genes are not inferred. Finally, this depiction assumes that one gene may only participate in a single group of functional partners. This limitation contradicts the already known fact that genes may interact with different gene subgroups which are related to different functions.</p>
    <p id="p2345">As far as the execution of this protocol is concerned, advanced programming and database management knowledge is required.</p>
  </sec>
  <sec id="sec6">
    <title>Troubleshooting</title>
    <sec id="sec6.1">
      <title>Problem 1</title>
      <p id="p2350">RStudio crashes/displays errors during the creation of the coexpression tree of genes (step 21).</p>
    </sec>
    <sec id="sec6.2">
      <title>Potential solution</title>
      <p id="p2355">First, make sure that the matrix is formatted correctly for Phangorn and that there are no missing values in the matrix.</p>
      <p id="p2360">When trying to calculate the correlations or produce a tree using a large number of genes (&gt;20,000), R requires a lot of RAM (possibly more than the recommended 64 GB). We recommend closing all other applications that might use memory resources. If the problem persists, the only solution would be to increase the available RAM of the machine.</p>
    </sec>
    <sec id="sec6.3">
      <title>Problem 2</title>
      <p id="p2365">Error during the installation of Bioconductor packages.</p>
    </sec>
    <sec id="sec6.4">
      <title>Potential solution</title>
      <p id="p2370">This protocol assumes that the latest available R version is used. However, at some point in time, certain packages may stop being supported. In such case, we recommend installing a (older) version of R that supports the installation of those packages.</p>
    </sec>
    <sec id="sec6.5">
      <title>Problem 3</title>
      <p id="p2375">Oligo package does not support the creation of additional quality control metrics (apart from RLE and NUSE boxplots) for downloaded samples (step 6).</p>
    </sec>
    <sec id="sec6.6">
      <title>Potential solution</title>
      <p id="p2380">We propose installing the following packages to produce NUSE and RLE boxplots and Quality Control reports (saved as AffyQCReport.pdf). However, those are only available for non-exon arrays microarray platforms and for older versions of R (&lt;4.0.3).</p>
      <p id="p2385">simpleaffy (<xref rid="bib16" ref-type="bibr">Miller, 2018</xref>):<boxed-text id="dtbox106"><p id="p2390">if (!requireNamespace("BiocManager", quietly = TRUE))</p><p id="p2395"> install.packages("BiocManager")</p><p id="p2400">BiocManager::install("simpleaffy")</p></boxed-text></p>
      <p id="p2405">affyPLM (<xref rid="bib2" ref-type="bibr">Bolstad et al., 2005</xref>; <xref rid="bib3" ref-type="bibr">Brettschneider et al., 2008</xref>):<boxed-text id="dtbox107"><p id="p2410">if (!requireNamespace("BiocManager", quietly = TRUE))</p><p id="p2415"> install.packages("BiocManager")</p><p id="p2420">BiocManager::install("affyPLM")</p></boxed-text></p>
      <p id="p2425">affyQCReport (<xref rid="bib18" ref-type="bibr">Parman et al., 2021</xref>):<boxed-text id="dtbox108"><p id="p2430">if (!requireNamespace("BiocManager", quietly = TRUE))</p><p id="p2435"> install.packages("BiocManager")</p><p id="p2440">BiocManager::install("affyQCReport")</p></boxed-text></p>
      <p id="p2445">Quality control is performed using the following commands:<boxed-text id="dtbox109"><p id="p2450">library(affyQCReport)</p><p id="p2455">library(simpleaffy)</p><p id="p2460">library(affyPLM)</p><p id="p2465">#Get each series directory</p><p id="p2470">dirseries&lt;-list.dirs("&lt;Series Main Directory&gt;", full.names = TRUE)</p><p id="p2475">for(dirhave in dirseries[2:length(dirseries)]){</p><p id="p2480"> setwd(dirhave)</p><p id="p2485"> #read all CEL files from current working directory</p><p id="p2490"> readdata &lt;- ReadAffy(compress = FALSE)</p><p id="p2495"> #first Quality Assessment</p><p id="p2500"> Saqc &lt;- QCReport(readdata)</p><p id="p2505"> dataPLM &lt;- fitPLM(readdata,output.param=list(varcov="none"))</p><p id="p2510"> par(mar = c(9, 4, 4, 2) + 0.1)</p><p id="p2515"> boxplot(dataPLM, main="NUSE", ylim = c(0.95, 1.22),</p><p id="p2520"> outline = FALSE, col="lightblue", las=3,</p><p id="p2525"> whisklty=0, staplelty=0, cex.axis=0.5)</p><p id="p2530"> #export boxplot</p><p id="p2535"> dev.copy(pdf,'NUSE.pdf')</p><p id="p2540"> dev.off()</p><p id="p2545"> Mbox(dataPLM, main="RLE", ylim = c(-0.4, 0.4),</p><p id="p2550"> outline = FALSE, col="mistyrose", las=3,</p><p id="p2555"> whisklty=0, staplelty=0, cex.axis=0.5)</p><p id="p2560"> #export Mbox</p><p id="p2565"> dev.copy(pdf,'RLE.pdf')</p><p id="p2570"> dev.off()</p><p id="p2575"> print(dirhave)</p><p id="p2580">}</p></boxed-text></p>
    </sec>
    <sec id="sec6.7">
      <title>Problem 4</title>
      <p id="p2585">Newick Utilities cannot be installed/run on my system.</p>
    </sec>
    <sec id="sec6.8">
      <title>Potential solution</title>
      <p id="p2590">In this protocol, we suggest downloading an already compiled version of Newick Utilities, which is, however, available only through the Wayback Machine. If the link becomes dead, or any other problem occurs, we recommend visiting the official GitHub page of the software (<ext-link ext-link-type="uri" xlink:href="https://github.com/tjunier/newick_utils" id="intref0080">https://github.com/tjunier/newick_utils</ext-link>). Alternatively, other software, such as Dendroscope, can be used for tree sorting.</p>
    </sec>
    <sec id="sec6.9">
      <title>Problem 5</title>
      <p id="p2595">The coexpression tree cannot load in Dendroscope (step 23).</p>
    </sec>
    <sec id="sec6.10">
      <title>Potential solution</title>
      <p id="p2600">Phylogenetic trees with more than 30,000 leaves, require larger amounts of RAM to open in Dendroscope. We suggest increasing the available RAM of Dendroscope or using another tree visualization software.</p>
    </sec>
    <sec id="sec6.11">
      <title>Problem 6</title>
      <p id="p2605">There is an issue with one or more PHP scripts that are included in the ACT GitHub folder.</p>
    </sec>
    <sec id="sec6.12">
      <title>Potential solution</title>
      <p id="p2610">The user can report the issue through GitHub.</p>
    </sec>
  </sec>
  <sec id="sec7">
    <title>Resource availability</title>
    <sec id="sec7.1">
      <title>Lead contact</title>
      <p id="p2615">Further information and requests for resources should be directed to and will be fulfilled by the lead contact, Ioannis Michalopoulos (<ext-link ext-link-type="uri" xlink:href="mailto:imichalop@bioacademy.gr" id="intref0085">imichalop@bioacademy.gr</ext-link>).</p>
    </sec>
    <sec id="sec7.2">
      <title>Materials availability</title>
      <p id="p2620">This study did not generate new unique reagents.</p>
    </sec>
  </sec>
</body>
<back>
  <ref-list id="cebib0010">
    <title>References</title>
    <ref id="bib1">
      <element-citation publication-type="journal" id="sref1">
        <person-group person-group-type="author">
          <name>
            <surname>Barrett</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Wilhite</surname>
            <given-names>S.E.</given-names>
          </name>
          <name>
            <surname>Ledoux</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Evangelista</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>I.F.</given-names>
          </name>
          <name>
            <surname>Tomashevsky</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Marshall</surname>
            <given-names>K.A.</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>K.H.</given-names>
          </name>
          <name>
            <surname>Sherman</surname>
            <given-names>P.M.</given-names>
          </name>
          <name>
            <surname>Holko</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>NCBI GEO: archive for functional genomics data sets--update</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>41</volume>
        <year>2013</year>
        <fpage>D991</fpage>
        <lpage>D995</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks1193</pub-id>
        <pub-id pub-id-type="pmid">23193258</pub-id>
      </element-citation>
    </ref>
    <ref id="bib2">
      <element-citation publication-type="book" id="sref2">
        <person-group person-group-type="author">
          <name>
            <surname>Bolstad</surname>
            <given-names>B.M.</given-names>
          </name>
          <name>
            <surname>Collin</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Brettschneider</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Simpson</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Cope</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>R.A.</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>T.P.</given-names>
          </name>
        </person-group>
        <part-title>Quality assessment of Affymetrix GeneChip data</part-title>
        <person-group person-group-type="editor">
          <name>
            <surname>Gentleman</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>V.J.</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>R.A.</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <source>Bioinformatics and Computational Biology Solutions Using R and Bioconductor</source>
        <year>2005</year>
        <publisher-name>Springer</publisher-name>
        <fpage>33</fpage>
        <lpage>47</lpage>
      </element-citation>
    </ref>
    <ref id="bib3">
      <element-citation publication-type="journal" id="sref3">
        <person-group person-group-type="author">
          <name>
            <surname>Brettschneider</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Collin</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Bolstad</surname>
            <given-names>B.M.</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>T.P.</given-names>
          </name>
        </person-group>
        <article-title>Quality assessment for short oligonucleotide microarray data</article-title>
        <source>Technometrics</source>
        <volume>50</volume>
        <year>2008</year>
        <fpage>241</fpage>
        <lpage>264</lpage>
        <pub-id pub-id-type="doi">10.1198/004017008000000334</pub-id>
      </element-citation>
    </ref>
    <ref id="bib4">
      <element-citation publication-type="journal" id="sref4">
        <person-group person-group-type="author">
          <name>
            <surname>Carvalho</surname>
            <given-names>B.S.</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>R.A.</given-names>
          </name>
        </person-group>
        <article-title>A framework for oligonucleotide microarray preprocessing</article-title>
        <source>Bioinformatics</source>
        <volume>26</volume>
        <year>2010</year>
        <fpage>2363</fpage>
        <lpage>2367</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq431</pub-id>
        <pub-id pub-id-type="pmid">20688976</pub-id>
      </element-citation>
    </ref>
    <ref id="bib5">
      <element-citation publication-type="journal" id="sref5">
        <person-group person-group-type="author">
          <name>
            <surname>Craigon</surname>
            <given-names>D.J.</given-names>
          </name>
          <name>
            <surname>James</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Okyere</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Jotham</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>May</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>NASCArrays: a repository for microarray data generated by NASC's transcriptomics service</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>32</volume>
        <year>2004</year>
        <fpage>D575</fpage>
        <lpage>D577</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkh133</pub-id>
        <pub-id pub-id-type="pmid">14681484</pub-id>
      </element-citation>
    </ref>
    <ref id="bib6">
      <element-citation publication-type="journal" id="sref6">
        <person-group person-group-type="author">
          <name>
            <surname>Dai</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Boyd</surname>
            <given-names>A.D.</given-names>
          </name>
          <name>
            <surname>Kostov</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Athey</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>E.G.</given-names>
          </name>
          <name>
            <surname>Bunney</surname>
            <given-names>W.E.</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>R.M.</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>T.P.</given-names>
          </name>
          <name>
            <surname>Akil</surname>
            <given-names>H.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evolving gene/transcript definitions significantly alter the interpretation of GeneChip data</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>33</volume>
        <year>2005</year>
        <fpage>e175</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gni179</pub-id>
        <pub-id pub-id-type="pmid">16284200</pub-id>
      </element-citation>
    </ref>
    <ref id="bib7">
      <element-citation publication-type="other" id="sref7">
        <person-group person-group-type="author">
          <collab>Thermo Fisher Scientific</collab>
        </person-group>
        <article-title>Array power tools</article-title>
        <ext-link ext-link-type="uri" xlink:href="https://www.thermofisher.com/gr/en/home/life-science/microarray-analysis/microarray-analysis-partners-programs/affymetrix-developers-network/affymetrix-power-tools.html" id="intref0185">https://www.thermofisher.com/gr/en/home/life-science/microarray-analysis/microarray-analysis-partners-programs/affymetrix-developers-network/affymetrix-power-tools.html</ext-link>
        <year>2020</year>
      </element-citation>
    </ref>
    <ref id="bib8">
      <element-citation publication-type="journal" id="sref8">
        <person-group person-group-type="author">
          <name>
            <surname>Huson</surname>
            <given-names>D.H.</given-names>
          </name>
          <name>
            <surname>Scornavacca</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>Dendroscope 3: an interactive tool for rooted phylogenetic trees and networks</article-title>
        <source>Syst. Biol.</source>
        <volume>61</volume>
        <year>2012</year>
        <fpage>1061</fpage>
        <lpage>1067</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/sys062</pub-id>
        <pub-id pub-id-type="pmid">22780991</pub-id>
      </element-citation>
    </ref>
    <ref id="bib9">
      <element-citation publication-type="journal" id="sref9">
        <person-group person-group-type="author">
          <name>
            <surname>Junier</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Zdobnov</surname>
            <given-names>E.M.</given-names>
          </name>
        </person-group>
        <article-title>The Newick utilities: high-throughput phylogenetic tree processing in the UNIX shell</article-title>
        <source>Bioinformatics</source>
        <volume>26</volume>
        <year>2010</year>
        <fpage>1669</fpage>
        <lpage>1670</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq243</pub-id>
        <pub-id pub-id-type="pmid">20472542</pub-id>
      </element-citation>
    </ref>
    <ref id="bib10">
      <element-citation publication-type="book" id="sref10">
        <person-group person-group-type="author">
          <name>
            <surname>Kassambara</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <part-title>Practical Guide to Cluster Analysis in R: Unsupervised Machine Learning</part-title>
        <year>2017</year>
        <publisher-name>STHDA</publisher-name>
      </element-citation>
    </ref>
    <ref id="bib11">
      <element-citation publication-type="journal" id="sref11">
        <person-group person-group-type="author">
          <name>
            <surname>Kolesnikov</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Hastings</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Keays</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Melnichuk</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>Y.A.</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Dylag</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Kurbatova</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Brandizi</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Burdett</surname>
            <given-names>T.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ArrayExpress update--simplifying data submissions</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>43</volume>
        <year>2015</year>
        <fpage>D1113</fpage>
        <lpage>D1116</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gku1057</pub-id>
        <pub-id pub-id-type="pmid">25361974</pub-id>
      </element-citation>
    </ref>
    <ref id="bib26">
      <element-citation publication-type="journal" id="opty8oN8d3QQk">
        <person-group person-group-type="author">
          <name>
            <surname>Krishnakumar</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Hanlon</surname>
            <given-names>M.R.</given-names>
          </name>
          <name>
            <surname>Contrino</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Ferlanti</surname>
            <given-names>E.S.</given-names>
          </name>
          <name>
            <surname>Karamycheva</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Rosen</surname>
            <given-names>B.D.</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>C.Y.</given-names>
          </name>
          <name>
            <surname>Moreira</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Mock</surname>
            <given-names>S.A.</given-names>
          </name>
        </person-group>
        <article-title>Araport: the Arabidopsis information portal</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>43</volume>
        <year>2015</year>
        <fpage>D1003</fpage>
        <lpage>D1009</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gku1200</pub-id>
        <pub-id pub-id-type="pmid">25414324</pub-id>
      </element-citation>
    </ref>
    <ref id="bib12">
      <element-citation publication-type="journal" id="sref12">
        <person-group person-group-type="author">
          <name>
            <surname>Kyritsis</surname>
            <given-names>K.A.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Sullivan</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Lyne</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Micklem</surname>
            <given-names>G.</given-names>
          </name>
        </person-group>
        <article-title>InterMineR: an R package for InterMine databases</article-title>
        <source>Bioinformatics</source>
        <volume>35</volume>
        <year>2019</year>
        <fpage>3206</fpage>
        <lpage>3207</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz039</pub-id>
        <pub-id pub-id-type="pmid">30668641</pub-id>
      </element-citation>
    </ref>
    <ref id="bib13">
      <element-citation publication-type="other" id="sref13">
        <person-group person-group-type="author">
          <name>
            <surname>Langfelder</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Horvath</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>WGCNA package FAQ</article-title>
        <ext-link ext-link-type="uri" xlink:href="https://horvath.genetics.ucla.edu/html/CoexpressionNetwork/Rpackages/WGCNA/faq.html" id="intref0190">https://horvath.genetics.ucla.edu/html/CoexpressionNetwork/Rpackages/WGCNA/faq.html</ext-link>
        <year>2017</year>
      </element-citation>
    </ref>
    <ref id="bib14">
      <element-citation publication-type="journal" id="sref14">
        <person-group person-group-type="author">
          <name>
            <surname>Liao</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Jaehnig</surname>
            <given-names>E.J.</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>B.</given-names>
          </name>
        </person-group>
        <article-title>WebGestalt 2019: gene set analysis toolkit with revamped UIs and APIs</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>47</volume>
        <year>2019</year>
        <fpage>W199</fpage>
        <lpage>W205</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkz401</pub-id>
        <pub-id pub-id-type="pmid">31114916</pub-id>
      </element-citation>
    </ref>
    <ref id="bib15">
      <element-citation publication-type="journal" id="sref15">
        <person-group person-group-type="author">
          <name>
            <surname>Malatras</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Michalopoulos</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Duguez</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Butler-Browne</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Spuler</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Duddy</surname>
            <given-names>W.J.</given-names>
          </name>
        </person-group>
        <article-title>MyoMiner: explore gene co-expression in normal and pathological muscle</article-title>
        <source>BMC Med. Genomics</source>
        <volume>13</volume>
        <year>2020</year>
        <fpage>67</fpage>
        <pub-id pub-id-type="doi">10.1186/s12920-020-0712-3</pub-id>
        <pub-id pub-id-type="pmid">32393257</pub-id>
      </element-citation>
    </ref>
    <ref id="bib16">
      <element-citation publication-type="other" id="sref16">
        <person-group person-group-type="author">
          <name>
            <surname>Miller</surname>
            <given-names>C.J.</given-names>
          </name>
        </person-group>
        <article-title>Simpleaffy: very simple high level analysis of affymetrix data</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org" id="intref0195">http://www.bioconductor.org</ext-link>
        <year>2018</year>
        <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.picr.man.ac.uk/simpleaffy/" id="intref0200">http://bioinformatics.picr.man.ac.uk/simpleaffy/</ext-link>
      </element-citation>
    </ref>
    <ref id="bib17">
      <element-citation publication-type="journal" id="sref17">
        <person-group person-group-type="author">
          <name>
            <surname>Obayashi</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Aoki</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Tadaka</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Kagaya</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Kinoshita</surname>
            <given-names>K.</given-names>
          </name>
        </person-group>
        <article-title>ATTED-II in 2018: a plant coexpression database based on investigation of the statistical property of the mutual rank index</article-title>
        <source>Plant Cell Physiol</source>
        <volume>59</volume>
        <year>2018</year>
        <fpage>e3</fpage>
        <pub-id pub-id-type="doi">10.1093/pcp/pcx191</pub-id>
        <pub-id pub-id-type="pmid">29216398</pub-id>
      </element-citation>
    </ref>
    <ref id="bib27">
      <element-citation publication-type="book" id="optQFPGKPIGTM">
        <person-group person-group-type="author">
          <name>
            <surname>Oracle</surname>
          </name>
        </person-group>
        <source>MySQL Workbench Reference Manual</source>
        <year>2021</year>
        <ext-link ext-link-type="uri" xlink:href="https://dev.mysql.com/doc/workbench/en/" id="intref0010a">https://dev.mysql.com/doc/workbench/en/</ext-link>
      </element-citation>
    </ref>
    <ref id="bib18">
      <element-citation publication-type="other" id="sref18">
        <person-group person-group-type="author">
          <name>
            <surname>Parman</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Halling</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>affyQCReport: QC report generation for affyBatch objects. R package version 1.68.0</article-title>
        <ext-link ext-link-type="uri" xlink:href="https://www.bioconductor.org/packages/3.12/bioc/html/affyQCReport.html" id="intref0205">https://www.bioconductor.org/packages/3.12/bioc/html/affyQCReport.html</ext-link>
        <year>2021</year>
      </element-citation>
    </ref>
    <ref id="bib19">
      <element-citation publication-type="journal" id="sref19">
        <person-group person-group-type="author">
          <name>
            <surname>Pearson</surname>
            <given-names>K.</given-names>
          </name>
        </person-group>
        <article-title>VII. Note on regression and inheritance in the case of two parents</article-title>
        <source>Proc. R. Soc. Lond.</source>
        <volume>58</volume>
        <year>1895</year>
        <fpage>240</fpage>
        <lpage>242</lpage>
        <pub-id pub-id-type="doi">10.1098/rspl.1895.0041</pub-id>
      </element-citation>
    </ref>
    <ref id="bib20">
      <element-citation publication-type="journal" id="sref20">
        <person-group person-group-type="author">
          <name>
            <surname>Piccolo</surname>
            <given-names>S.R.</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>J.D.</given-names>
          </name>
          <name>
            <surname>Lenburg</surname>
            <given-names>M.E.</given-names>
          </name>
          <name>
            <surname>Bild</surname>
            <given-names>A.H.</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>W.E.</given-names>
          </name>
        </person-group>
        <article-title>A single-sample microarray normalization method to facilitate personalized-medicine workflows</article-title>
        <source>Genomics</source>
        <volume>100</volume>
        <year>2012</year>
        <fpage>337</fpage>
        <lpage>344</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ygeno.2012.08.003</pub-id>
        <pub-id pub-id-type="pmid">22959562</pub-id>
      </element-citation>
    </ref>
    <ref id="bib21">
      <element-citation publication-type="journal" id="sref21">
        <person-group person-group-type="author">
          <name>
            <surname>Schliep</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Potts</surname>
            <given-names>A.J.</given-names>
          </name>
          <name>
            <surname>Morrison</surname>
            <given-names>D.A.</given-names>
          </name>
          <name>
            <surname>Grimm</surname>
            <given-names>G.W.</given-names>
          </name>
        </person-group>
        <article-title>Intertwining phylogenetic trees and networks</article-title>
        <source>Methods Ecol. Evol.</source>
        <volume>8</volume>
        <year>2017</year>
        <fpage>1212</fpage>
        <lpage>1220</lpage>
        <pub-id pub-id-type="doi">10.1111/2041-210x.12760</pub-id>
      </element-citation>
    </ref>
    <ref id="bib22">
      <element-citation publication-type="journal" id="sref22">
        <person-group person-group-type="author">
          <name>
            <surname>Sokal</surname>
            <given-names>R.R.</given-names>
          </name>
          <name>
            <surname>Michener</surname>
            <given-names>C.D.</given-names>
          </name>
        </person-group>
        <article-title>A statistical method for evaluating systematic relationships</article-title>
        <source>Univ. Kansas Sci. Bull.</source>
        <volume>38</volume>
        <year>1958</year>
        <fpage>1409</fpage>
        <lpage>1438</lpage>
      </element-citation>
    </ref>
    <ref id="bib23">
      <element-citation publication-type="journal" id="sref23">
        <person-group person-group-type="author">
          <name>
            <surname>Szklarczyk</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Gable</surname>
            <given-names>A.L.</given-names>
          </name>
          <name>
            <surname>Nastou</surname>
            <given-names>K.C.</given-names>
          </name>
          <name>
            <surname>Lyon</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Kirsch</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Pyysalo</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Doncheva</surname>
            <given-names>N.T.</given-names>
          </name>
          <name>
            <surname>Legeay</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The STRING database in 2021: customizable protein-protein networks, and functional characterization of user-uploaded gene/measurement sets</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>49</volume>
        <year>2021</year>
        <fpage>D605</fpage>
        <lpage>D612</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkaa1074</pub-id>
        <pub-id pub-id-type="pmid">33237311</pub-id>
      </element-citation>
    </ref>
    <ref id="bib24">
      <element-citation publication-type="journal" id="sref24">
        <person-group person-group-type="author">
          <name>
            <surname>Yim</surname>
            <given-names>W.C.</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Jang</surname>
            <given-names>C.S.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>B.M.</given-names>
          </name>
        </person-group>
        <article-title>PLANEX: the plant co-expression database</article-title>
        <source>BMC Plant Biol.</source>
        <volume>13</volume>
        <year>2013</year>
        <fpage>83</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2229-13-83</pub-id>
        <pub-id pub-id-type="pmid">23688397</pub-id>
      </element-citation>
    </ref>
    <ref id="bib25">
      <element-citation publication-type="journal" id="sref25">
        <person-group person-group-type="author">
          <name>
            <surname>Zogopoulos</surname>
            <given-names>V.L.</given-names>
          </name>
          <name>
            <surname>Saxami</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Malatras</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Angelopoulou</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Jen</surname>
            <given-names>C.H.</given-names>
          </name>
          <name>
            <surname>Duddy</surname>
            <given-names>W.J.</given-names>
          </name>
          <name>
            <surname>Daras</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Hatzopoulos</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Westhead</surname>
            <given-names>D.R.</given-names>
          </name>
          <name>
            <surname>Michalopoulos</surname>
            <given-names>I.</given-names>
          </name>
        </person-group>
        <article-title>Arabidopsis coexpression tool: a tool for gene coexpression analysis in Arabidopsis thaliana</article-title>
        <source>iScience</source>
        <volume>24</volume>
        <year>2021</year>
        <fpage>102848</fpage>
        <pub-id pub-id-type="doi">10.1016/j.isci.2021.102848</pub-id>
        <pub-id pub-id-type="pmid">34381973</pub-id>
      </element-citation>
    </ref>
  </ref-list>
  <sec sec-type="data-availability" id="da0010">
    <title>Data and code availability</title>
    <p id="p0030">The microarray samples analyzed during the current study are available at: <ext-link ext-link-type="uri" xlink:href="https://data.mendeley.com/datasets/hgvk669v89/" id="intref0010">https://data.mendeley.com/datasets/hgvk669v89/</ext-link></p>
    <p id="p0035">Custom scripts and data used are available in: <ext-link ext-link-type="uri" xlink:href="https://github.com/imichalop/ACT" id="intref0015">https://github.com/imichalop/ACT</ext-link></p>
    <p id="p0040">Any additional information required to reanalyze the data reported in this paper is available from the lead contact upon request.</p>
  </sec>
  <ack id="ack0010">
    <title>Acknowledgments</title>
    <p id="p2630">We acknowledge support of this work by the project ‘‘ELIXIR-GR: Managing and Analyzing Life Sciences Data’’ (MIS: 5002780), which is implemented under the Action ‘‘Reinforcement of the Research and Innovation Infrastructure,’’ funded by the Operational Program ‘‘Competitiveness, Entrepreneurship, and Innovation’’ (NSRF 2014–2020) and cofinanced by Greece and the European Union (<funding-source id="gs1"><institution-wrap><institution-id institution-id-type="doi">10.13039/501100008530</institution-id><institution>European Regional Development Fund</institution></institution-wrap></funding-source>).</p>
    <sec id="sec9">
      <title>Author contributions</title>
      <p id="p2635">I.M. conceived the project, planned, and conducted the research. A.M. searched and downloaded microarray raw data and developed the methods for performing data quality control. A.M. also created the tree pruning algorithms. V.L.Z. performed the sample quality control. V.L.Z. and I.M. created the algorithms for pairwise sample/gene correlations and coexpression sample/gene tree creation. V.L.Z. designed and populated the MySQL database. All authors contributed to the writing of the manuscript. All authors have read and approved the manuscript for publication.</p>
    </sec>
    <sec sec-type="COI-statement" id="sec10">
      <title>Declaration of interests</title>
      <p id="p2640">The authors declare no competing interests.</p>
    </sec>
  </ack>
</back>
