<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3740625</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btt350</article-id>
    <article-id pub-id-type="publisher-id">btt350</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group>
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Data-based filtering for replicated high-throughput transcriptome sequencing experiments</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Rau</surname>
          <given-names>Andrea</given-names>
        </name>
        <xref ref-type="aff" rid="btt350-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btt350-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="btt350-COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gallopin</surname>
          <given-names>Mélina</given-names>
        </name>
        <xref ref-type="aff" rid="btt350-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btt350-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Celeux</surname>
          <given-names>Gilles</given-names>
        </name>
        <xref ref-type="aff" rid="btt350-AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jaffrézic</surname>
          <given-names>Florence</given-names>
        </name>
        <xref ref-type="aff" rid="btt350-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btt350-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="btt350-AFF1"><sup>1</sup>INRA, UMR1313 Génétique animale et biologie intégrative, 78352 Jouy-en-Josas, France, <sup>2</sup>AgroParisTech, UMR1313 Génétique animale et biologie intégrative, 75231 Paris 05, France and <sup>3</sup>Inria Saclay - Île-de-France, 91405 Orsay, France</aff>
    <author-notes>
      <corresp id="btt350-COR1">*To whom correspondence should be addressed.</corresp>
      <fn>
        <p>Associate Editor: Inanc Birol</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>1</day>
      <month>9</month>
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>7</month>
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>2</day>
      <month>7</month>
      <year>2013</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>29</volume>
    <issue>17</issue>
    <fpage>2146</fpage>
    <lpage>2152</lpage>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>11</month>
        <year>2012</year>
      </date>
      <date date-type="rev-recd">
        <day>24</day>
        <month>5</month>
        <year>2013</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>6</month>
        <year>2013</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2013. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2013</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">http://creativecommons.org/licenses/by-nc/3.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> RNA sequencing is now widely performed to study differential expression among experimental conditions. As tests are performed on a large number of genes, stringent false-discovery rate control is required at the expense of detection power. Ad hoc filtering techniques are regularly used to moderate this correction by removing genes with low signal, with little attention paid to their impact on downstream analyses.</p>
      <p><bold>Results:</bold> We propose a data-driven method based on the Jaccard similarity index to calculate a filtering threshold for replicated RNA sequencing data. In comparisons with alternative data filters regularly used in practice, we demonstrate the effectiveness of our proposed method to correctly filter lowly expressed genes, leading to increased detection power for moderately to highly expressed genes. Interestingly, this data-driven threshold varies among experiments, highlighting the interest of the method proposed here.</p>
      <p><bold>Availability:</bold> The proposed filtering method is implemented in the <monospace>R</monospace> package <monospace>HTSFilter</monospace> available on Bioconductor.</p>
      <p>
        <bold>Contact:</bold>
        <email>andrea.rau@jouy.inra.fr</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt350/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 INTRODUCTION</title>
    <p>During the past 5 years, next-generation high-throughput sequencing (HTS) technology has become an essential tool for genomic and transcriptomic studies. In particular, the use of HTS technology to directly sequence the transcriptome, known as RNA sequencing (RNA-seq), has revolutionized the study of gene expression by opening the door to a wide range of novel applications. Unlike microarray data, which are continuous, RNA-seq data represent highly heterogeneous counts for genomic regions of interest (typically genes) and often exhibit zero-inflation and a large amount of overdispersion among biological replicates; as such, a great deal of methodological research (e.g. <xref ref-type="bibr" rid="btt350-B1">Anders and Huber, 2010</xref>; <xref ref-type="bibr" rid="btt350-B9">Dillies <italic>et al.</italic>, 2012</xref>; <xref ref-type="bibr" rid="btt350-B22">Robinson <italic>et al.</italic>, 2010</xref>) has recently focused on appropriate normalization and analysis techniques that are adapted to the characteristics of RNA-seq data; see <xref ref-type="bibr" rid="btt350-B17">Oshlack <italic>et al.</italic> (2010)</xref> for a review of RNA-seq technology and analysis procedures.</p>
    <p>As with data arising from previous technologies, such as microarrays or serial analysis of gene expression, HTS data are often used to conduct differential analyses. In recent years, several approaches for gene-by-gene tests using gene-level HTS data have been proposed, with the most popular making use of Poisson (<xref ref-type="bibr" rid="btt350-B27">Wang <italic>et al.</italic>, 2010</xref>), overdispersed Poisson (<xref ref-type="bibr" rid="btt350-B2">Auer and Doerge, 2011</xref>) or negative binomial distributions (<xref ref-type="bibr" rid="btt350-B1">Anders and Huber, 2010</xref>; <xref ref-type="bibr" rid="btt350-B22">Robinson <italic>et al.</italic>, 2010</xref>). Because a large number of hypothesis tests are performed for gene-by-gene differential analyses, the obtained <italic>P</italic>-values must be adjusted to address the fact that many truly null hypotheses will produce small <italic>P</italic>-values simply by chance; to address this multiple testing problem, several well-established procedures have been proposed to adjust <italic>P</italic>-values to control various measures of experiment-wide false positives, such as the false-discovery rate. Although such procedures may be used to control the number of false positives that are detected, they are often at the expense of the power of an experiment to detect truly differentially expressed (DE) genes, particularly as the number of genes in a typical HTS dataset may be in the thousands or tens of thousands. To reduce this impact, several authors in the microarray literature have suggested the use of data filters to identify and remove genes that appear to generate an uninformative signal (<xref ref-type="bibr" rid="btt350-B6">Bourgon <italic>et al.</italic>, 2010</xref>) and have no or little chance of showing significant evidence of differential expression; only hypotheses corresponding to genes that pass the filter are subsequently tested, which in turn tempers the correction needed to adjust for multiple testing.</p>
    <p>In recent work, <xref ref-type="bibr" rid="btt350-B6">Bourgon <italic>et al.</italic> (2010)</xref> advocate for the use of <italic>independent data filtering</italic>, in which the filter and subsequent test statistic pairs are marginally independent under the null hypothesis, and the dependence structure among tests remains largely unchanged pre- and post-filter, ensuring that post-filter <italic>P</italic>-values are true <italic>P</italic>-values. For such an independent filter to be effective, it must be positively correlated with the test statistic under the alternative hypothesis; indeed, it is this correlation that leads to an increase in detection power after filtering. In addition, Bourgon <italic>et al.</italic> demonstrate that non-independent filters for which dependence exists between the filter and test statistic (e.g. making use of condition labels to filter genes with average expression in at least one condition less than a given threshold), can in some cases lead to a loss of control of experiment-wide error rates.</p>
    <p>Several <italic>ad hoc</italic> data filters for RNA-seq data have been used in recent years, including filtering genes with a total read count smaller than a given threshold (<xref ref-type="bibr" rid="btt350-B26">Sultan <italic>et al.</italic>, 2008</xref>) and filtering genes with at least one zero count in each experimental condition (<xref ref-type="bibr" rid="btt350-B5">Bottomly <italic>et al.</italic>, 2011</xref>); however, selecting an arbitrary threshold value to filter genes in this way does not account for the overall sequencing depth or variability of a given experiment. One exception to these <italic>ad hoc</italic> filters is the work of <xref ref-type="bibr" rid="btt350-B20">Ramsköld <italic>et al.</italic> (2009)</xref>, in which a comparison between expression levels of exonic and intergenic regions was used to find a threshold for detectable expression above background in various human and mouse tissues, where expression was estimated as Reads Per Kilobase per Million mapped reads (RPKM) (<xref ref-type="bibr" rid="btt350-B16">Mortazavi <italic>et al.</italic>, 2008</xref>). The threshold of 0.3 RPKM identified in this work has in turn been applied to several other studies (e.g. <xref ref-type="bibr" rid="btt350-B7">Cánovas <italic>et al.</italic>, 2010</xref>; <xref ref-type="bibr" rid="btt350-B15">Łabaj <italic>et al.</italic>, 2011</xref>; <xref ref-type="bibr" rid="btt350-B24">Sam <italic>et al.</italic>, 2011</xref>). However, to our knowledge, although filters for read counts are routinely used in practice, little attention has been paid to the choice of the type of filter or threshold used or its impact on the downstream analysis.</p>
    <p>In this article, we propose a novel data-based procedure to choose an appropriate filtering threshold based on the calculation of a similarity index among biological replicates for read counts arising from replicated high-throughput transcriptome sequencing data. This technique provides an intuitive data-driven way to filter RNA-seq data and to effectively remove genes with low constant expression levels. Our proposed filtering threshold may be useful in a variety of applications for RNA-seq data, including differential expression analyses, clustering and co-expression analyses, and network inference.</p>
  </sec>
  <sec>
    <title>2 METHODS</title>
    <sec id="SEC2.1">
      <title>2.1 Types of filters used for RNA-seq data</title>
      <p>Data filters are routinely used in practice for differential analyses of RNA-seq data. Most such filters are applied to data that have been normalized in some way, rather than directly to the raw counts, to account for systematic inter-sample biases typical of RNA-seq data, e.g. differences in library size (<xref ref-type="bibr" rid="btt350-B1">Anders and Huber, 2010</xref>; <xref ref-type="bibr" rid="btt350-B23">Robinson and Oshlack, 2010</xref>) or GC content (<xref ref-type="bibr" rid="btt350-B12">Hansen <italic>et al.</italic>, 2012</xref>; <xref ref-type="bibr" rid="btt350-B21">Risso <italic>et al.</italic>, 2011</xref>). In particular, the Trimmed M-Means library size normalization (<xref ref-type="bibr" rid="btt350-B23">Robinson and Oshlack, 2010</xref>) and the normalization included in the <monospace>DESeq</monospace> Bioconductor package (<xref ref-type="bibr" rid="btt350-B1">Anders and Huber, 2010</xref>) have been found to be robust methods to correct for library size biases, even in the presence of widely different library compositions (<xref ref-type="bibr" rid="btt350-B9">Dillies <italic>et al.</italic>, 2012</xref>).</p>
      <p>We consider two broad categories of filters for RNA-seq data based on the filtering criterion used: mean-based filters and maximum-based filters. We note that although variance-based filters are routinely used for microarray data (<xref ref-type="bibr" rid="btt350-B6">Bourgon <italic>et al.</italic>, 2010</xref>), they have not been applied to RNA-seq data; this is likely due to the small number of replicates available in most RNA-seq datasets (and thus, the difficulty in obtaining accurate estimates of per-gene variances) and the fact that the variance is assumed to be a function of the mean under a negative binomial model.</p>
      <sec id="SEC2.1.1">
        <title>2.1.1 Mean-based filters</title>
        <p>In mean-based filters, genes with mean normalized counts across all samples less than or equal to a pre-specified cutoff are filtered from the analysis. Some authors (<xref ref-type="bibr" rid="btt350-B26">Sultan <italic>et al.</italic>, 2008</xref>) have also proposed filtering genes with a total read count less than or equal to a given threshold <italic>s</italic>; we note that this is equivalent to mean-based filters for threshold <italic>s</italic> divided by the number of samples.</p>
        <p>In addition to normalized counts, we also consider mean-based filters for the RPKM (<xref ref-type="bibr" rid="btt350-B16">Mortazavi <italic>et al.</italic>, 2008</xref>) measure, which was initially proposed to simultaneously normalize RNA-seq data for biases due to library size and gene length. However, we note that it has been shown that counts, rather than RPKM values, are preferable for the differential analysis of RNA-seq data (<xref ref-type="bibr" rid="btt350-B18">Oshlack and Wakefield, 2009</xref>). For this reason, after filtering genes with a RPKM mean filter, raw counts are used for the subsequent differential analysis. A comparison of differential analysis methods developed for counts and RPKM values is beyond the scope of this work.</p>
      </sec>
      <sec id="SEC2.1.2">
        <title>2.1.2 Maximum-based filters</title>
        <p>In maximum-based filters, genes with maximum normalized counts across all samples less than or equal to a pre-specified threshold are filtered from the analysis. As aforementioned, in addition to normalized counts, we also consider maximum-based filters for RPKM values, which we refer to as a RPKM maximum filter.</p>
        <p>A generalization of the maximum-based filter has also been proposed in the <monospace>edgeR</monospace> analysis pipeline (<xref ref-type="bibr" rid="btt350-B22">Robinson <italic>et al.</italic>, 2010</xref>) based on counts per million (CPM), calculated as the raw counts divided by the library sizes and multiplied by one million. Genes with a CPM value less than a given cutoff (e.g. 1 or 100) in more samples (ignoring condition labels) than the size of the smallest group are subsequently filtered from the analysis. To distinguish this approach from the other maximum-based filters, we refer to this strategy as a CPM filter.</p>
        <p>We note that maximum-based filters are not independent filters as described by <xref ref-type="bibr" rid="btt350-B6">Bourgon <italic>et al.</italic> (2010)</xref>; in particular, for extremely large filtering thresholds, maximum-based filters do not guarantee control of the Type I error rate if <italic>P</italic>-values are computed using the pre-filter null distribution. For the threshold values typically used in practice (e.g. based on a quantile, or the data-based threshold proposed later in the text), this is usually not a concern (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt350/-/DC1">Supplementary Fig. S28</ext-link>). Although it may be difficult to verify that conditional and unconditional <italic>P</italic>-value distributions coincide for real data, it may be useful to examine histograms of each (e.g. as shown in <xref ref-type="fig" rid="btt350-F3">Fig. 3</xref>).</p>
      </sec>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 A data-based threshold for maximum-based filters</title>
      <p>For each of the filter types previously defined, a biologically pertinent cutoff (or alternatively, number of genes to be filtered) must be chosen; in practice, arbitrary thresholds are routinely used with little or no discussion of their impact on the downstream analysis. To address this issue, we propose a data-based choice for the threshold to be used in maximum-based filters. The main idea underlying this choice is to identify the threshold that maximizes the filtering similarity among replicates, i.e. one where most genes tend to either have normalized counts less than or equal to the cutoff in all samples (i.e. filtered genes) or greater than the cutoff in all samples (i.e. non-filtered genes).</p>
      <p>To define this filtering similarity, we begin with some notation. Let <italic>y<sub>gj</sub></italic> represent the observed normalized read count (e.g. after scaling raw counts by library size) for gene <italic>g</italic> in sample <italic>j</italic>, and let <inline-formula><inline-graphic xlink:href="btt350i1.jpg"/></inline-formula> represent the experimental condition of sample <italic>j</italic>, with <inline-formula><inline-graphic xlink:href="btt350i2.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="btt350i3.jpg"/></inline-formula>. Typically, in the context of differential analyses, the number of conditions is equal to 2. We denote the full vector of read counts in a given sample as <inline-formula><inline-graphic xlink:href="btt350i4.jpg"/></inline-formula>. We now wish to define a <italic>similarity index</italic> between a pair of replicates within the same condition <inline-formula><inline-graphic xlink:href="btt350i5.jpg"/></inline-formula> after binarizing the data for a fixed cutoff <italic>s</italic> (1 if <inline-formula><inline-graphic xlink:href="btt350i6.jpg"/></inline-formula> and 0 otherwise). We note that a variety of similarity indices have been proposed since the early 1900s; however, in a comparison among a set of similarity indices (see the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt350/-/DC1">Supplementary Materials</ext-link>), we found the Jaccard index (<xref ref-type="bibr" rid="btt350-B13">Jaccard, 1901</xref>) to be simple, natural and easy to interpret for the analysis of HTS data. This index is defined as follows:
<disp-formula id="btt350-M1"><label>(1)</label><graphic xlink:href="btt350m1"/></disp-formula>
where <italic>a</italic>, <italic>b</italic> and <italic>c</italic> are defined in <xref ref-type="table" rid="btt350-T1">Table 1</xref>. We note that <inline-formula><inline-graphic xlink:href="btt350i13.jpg"/></inline-formula> takes on values from 0 (dissimilar) to 1 (similar). Because multiple replicates and/or conditions are typically available in HTS experiments, we extend the definition of the pairwise Jaccard index in <xref ref-type="disp-formula" rid="btt350-M1">Equation (1)</xref> to a global Jaccard index by averaging the indices calculated over all pairs in each condition:
<disp-formula id="btt350-M2"><label>(2)</label><graphic xlink:href="btt350m2"/></disp-formula>
<table-wrap id="btt350-T1" position="float"><label>Table 1.</label><caption><p>Definition of the constants used to calculate the Jaccard similarity index for a pair of samples <italic>j</italic> and <inline-formula><inline-graphic xlink:href="btt350i7.jpg"/></inline-formula> and a given threshold <italic>s</italic></p></caption><table frame="hsides" rules="groups"><thead align="right"><tr><th rowspan="1" colspan="1"/><th colspan="2" align="center" rowspan="1">Sample <italic>j</italic><hr/></th></tr><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">Normalized counts <inline-formula><inline-graphic xlink:href="btt350i8.jpg"/></inline-formula></th><th rowspan="1" colspan="1">Normalized counts <inline-formula><inline-graphic xlink:href="btt350i9.jpg"/></inline-formula></th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Sample <italic>j</italic>′</td></tr><tr><td rowspan="1" colspan="1">    Normalized counts <inline-formula><inline-graphic xlink:href="btt350i10.jpg"/></inline-formula></td><td rowspan="1" colspan="1"><italic>a</italic></td><td rowspan="1" colspan="1"><italic>b</italic></td></tr><tr><td rowspan="1" colspan="1">    Normalized counts <inline-formula><inline-graphic xlink:href="btt350i11.jpg"/></inline-formula></td><td rowspan="1" colspan="1"><italic>c</italic></td><td rowspan="1" colspan="1"><italic>d</italic></td></tr></tbody></table><table-wrap-foot><fn id="btt350-TF1"><p><italic>Note</italic>: The constant <italic>a</italic> represents the number of genes with normalized counts greater than <italic>s</italic> in both samples <italic>j</italic> and <inline-formula><inline-graphic xlink:href="btt350i12.jpg"/></inline-formula> and so on.</p></fn></table-wrap-foot></table-wrap></p>
      <p>Using the global Jaccard index defined in <xref ref-type="disp-formula" rid="btt350-M2">Equation (2)</xref> as a measure of similarity, we now wish to identify the cutoff <inline-formula><inline-graphic xlink:href="btt350i14.jpg"/></inline-formula> for normalized counts that corresponds to the greatest similarity possible among replicates, i.e. the value of <italic>s</italic> corresponding to the maximum value of the global Jaccard index:
<disp-formula id="btt350-M3"><label>(3)</label><graphic xlink:href="btt350m3"/></disp-formula>
</p>
      <p>In practice, for the calculation of the data-based global filtering threshold in <xref ref-type="disp-formula" rid="btt350-M3">Equation (3)</xref>, we calculate the value of the global Jaccard index in <xref ref-type="disp-formula" rid="btt350-M2">Equation (2)</xref> for a fixed set of threshold values and fit a loess curve (<xref ref-type="bibr" rid="btt350-B8">Cleveland, 1979</xref>) through the set of points; the value of <inline-formula><inline-graphic xlink:href="btt350i15.jpg"/></inline-formula> is subsequently set to be the maximum of these fitted values.</p>
      <p>Once the data-driven filter threshold for normalized counts <inline-formula><inline-graphic xlink:href="btt350i16.jpg"/></inline-formula> has been identified, the subsequent steps to be taken may change for different applications. To perform an analysis of differential expression between two experimental conditions, we propose using this threshold <inline-formula><inline-graphic xlink:href="btt350i17.jpg"/></inline-formula> in a maximum-based filter, as defined in Section 2.1.2; in the following, we refer to this technique as the <italic>Jaccard filter</italic>.</p>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 The Bioconductor package <monospace>HTSFilter</monospace></title>
      <p>The proposed filtering method is implemented in the <monospace>HTSFilter</monospace> package, currently available as part of the Bioconductor project (<xref ref-type="bibr" rid="btt350-B11">Gentleman <italic>et al.</italic>, 2004</xref>) within the statistical environment <monospace>R</monospace> (<xref ref-type="bibr" rid="btt350-B19">R Development Core Team, 2009</xref>). The <monospace>HTSFilter</monospace> package is compatible with a variety of data classes and analysis pipelines, including <monospace>matrix</monospace> and <monospace>data.frame</monospace> objects, the S4 class <monospace>CountDataSet</monospace> in the <monospace>DESeq</monospace> pipeline (<xref ref-type="bibr" rid="btt350-B1">Anders and Huber, 2010</xref>) and the S3 class <monospace>DGEList</monospace> in the <monospace>edgeR</monospace> pipeline (<xref ref-type="bibr" rid="btt350-B22">Robinson <italic>et al.</italic>, 2010</xref>). A package vignette describes the use of the <monospace>HTSFilter</monospace> package within each of these pipelines.</p>
    </sec>
  </sec>
  <sec>
    <title>3 RESULTS</title>
    <p>In the following, we apply the normalization approach proposed by <xref ref-type="bibr" rid="btt350-B1">Anders and Huber (2010)</xref> for mean- and maximum-based filters, although other types of normalization may be appropriate for some data. For gene-by-gene comparisons between two conditions, we illustrate the use of the proposed filter in conjunction with the model proposed in the <monospace>DESeq</monospace> Bioconductor package (version 1.8.3), which has been developed to model count data with a small number of replicates in the presence of overdispersion (<xref ref-type="bibr" rid="btt350-B1">Anders and Huber, 2010</xref>); <italic>P</italic>-values are adjusted for multiple testing using the Benjamini–Hochberg procedure (<xref ref-type="bibr" rid="btt350-B3">Benjamini and Hochberg, 1995</xref>) to control the false-discovery rate. We note that the filtering method proposed here may also be used in conjunction with other popular methods, e.g. <monospace>edgeR</monospace> (<xref ref-type="bibr" rid="btt350-B22">Robinson <italic>et al.</italic>, 2010</xref>). See the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt350/-/DC1">Supplementary Materials</ext-link> for additional discussion of the normalization and statistical testing methods used in this work.</p>
    <p>In practice, there may be some question about the appropriate point in the analysis pipeline to apply data filters: Should normalized data first be filtered, then normalization factors re-estimated and the model fit (i.e. mean and dispersion parameters estimated)? Should normalization factors and model parameters be estimated based on the full data, and the data filtered only at the end of the analysis pipeline? The difference between the two options is non-trivial, particularly as the differential analysis approaches implemented in the <monospace>DESeq</monospace> and <monospace>edgeR</monospace> packages both borrow information across genes (whether all or only those passing the filter) to obtain per-gene parameter estimates. In this work, we present results based on the application of filters applied as late in the pipeline as possible, i.e. after library size and dispersion parameter estimation; a more detailed discussion of this issue is included in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt350/-/DC1">Supplementary Materials</ext-link>.</p>
    <sec id="SEC3.1">
      <title>3.1 Description of data</title>
      <p>We applied our proposed Jaccard index filter, in addition to the alternative filter types described earlier in the text, on the following data:
<list list-type="bullet"><list-item><p><bold>Sex-specific expression of liver cells in human.</bold><xref ref-type="bibr" rid="btt350-B26">Sultan <italic>et al.</italic> (2008)</xref> obtained high-throughput transcriptome sequencing data from a human embryonic kidney and a B cell line, with two biological replicates each. The raw read counts and phenotype tables were obtained from the ReCount online resource (<xref ref-type="bibr" rid="btt350-B10">Frazee <italic>et al.</italic>, 2011</xref>).</p></list-item><list-item><p><bold>Differential striatal expression between inbred mouse strains</bold>. <xref ref-type="bibr" rid="btt350-B5">Bottomly <italic>et al.</italic> (2011)</xref> performed RNA-seq experiments for 10 biological replicates of the C57BL/6J inbred mouse strain and 11 for the DBA/2J strain, and the results were compared with those arising from two different microarray platforms. The raw read counts and phenotype tables were obtained from the ReCount online resource (<xref ref-type="bibr" rid="btt350-B10">Frazee <italic>et al.</italic>, 2011</xref>).</p></list-item><list-item><p><bold>MiTF repression in a human melanoma cell line</bold>. <xref ref-type="bibr" rid="btt350-B25">Strub <italic>et al.</italic> (2011)</xref> obtained HTS data to compare gene expression in a melanoma cell line expressing the Microphtalmia Transcription Factor to one in which small interfering RNAs were used to repress Microphtalmia Transcription Factor, with three biological replicates in each group. The raw read counts and phenotype tables are available in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt350/-/DC1">Supplementary Materials</ext-link> of <xref ref-type="bibr" rid="btt350-B9">Dillies <italic>et al.</italic> (2012)</xref>.</p></list-item><list-item><p><bold>Simulated data</bold>. To investigate the effect of the various filtering methods on downstream results, we developed a simulation framework as described in Section 3.3.</p></list-item></list>
</p>
      <p>For the three real datasets (described in further detail in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt350/-/DC1">Supplementary Table S1</ext-link>), gene annotations for <italic>Mus musculus</italic> (NCBIM37) and <italic>Homo sapiens</italic> (GRCh37.p7) were obtained from Ensembl version 67 (<xref ref-type="bibr" rid="btt350-B4">Birney <italic>et al.</italic>, 2004</xref>) using the Biomart tool (<xref ref-type="bibr" rid="btt350-B14">Kasprzyk <italic>et al.</italic>, 2004</xref>), and the length of each gene in base pairs was calculated. In the Bottomly, Sultan and Strub data, ∼4, 2 and 5% of the genes, respectively, had been retired from Ensembl; for these genes, RPKM-based filters were not used. Readers wishing to examine the complete analyses in detail may find a Sweave document containing commented <monospace>R</monospace> code for the analyses of each of the datasets in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt350/-/DC1">Supplementary Materials</ext-link>.</p>
    </sec>
    <sec id="SEC3.2">
      <title>3.2 Comparison of filters on real data</title>
      <p>For the three real datasets, differential analyses were performed using a negative binomial model (<xref ref-type="bibr" rid="btt350-B1">Anders and Huber, 2010</xref>) for unfiltered data and after filtering the data using the techniques described earlier in the text. For the Jaccard index filter, the global Jaccard index in <xref ref-type="disp-formula" rid="btt350-M2">Equation (2)</xref> was calculated for a range of threshold values <italic>s</italic>, yielding a largely unimodal distribution of values for all datasets considered (<xref ref-type="fig" rid="btt350-F1">Fig. 1</xref> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt350/-/DC1">Supplementary Figs S11</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt350/-/DC1">S18</ext-link>). We also note that the data-driven threshold values <inline-formula><inline-graphic xlink:href="btt350i19.jpg"/></inline-formula> identified for the Bottomly, Sultan and Strub data were not equal; in the case of the Bottomly data, the threshold for normalized counts was found to be 14.7, whereas this threshold was found to be 11.5 for the Sultan data and 103.5 for the Strub data. These differences in filtering threshold among experiments are due to both sequencing depth and variability within the data; in particular, experiments with greater sequencing depth will tend to have higher filtering thresholds, and those with greater variability will tend to have lower filtering thresholds. Among the data considered in our study, the Strub data have the highest sequencing depth (<inline-formula><inline-graphic xlink:href="btt350i20.jpg"/></inline-formula>) coupled with low intra-condition variability (minimum correlation among replicates equal to 0.98), and they also have the highest threshold considered here. On the other hand, the Sultan data have a much lower sequencing depth (<inline-formula><inline-graphic xlink:href="btt350i21.jpg"/></inline-formula>) and thus have a much lower threshold.
<fig id="btt350-F1" position="float"><label>Fig. 1.</label><caption><p>Global Jaccard index for the Bottomly data calculated for a variety of threshold values for normalized counts, with a loess curve (solid line) superposed and data-driven threshold value (dotted line) equal to <inline-formula><inline-graphic xlink:href="btt350i18.jpg"/></inline-formula></p></caption><graphic xlink:href="btt350f1p"/></fig></p>
      <p>For each dataset, the Jaccard filter was applied with the corresponding data-based threshold calculated earlier in the text. For the alternative mean- and maximum-based filters for normalized counts and RPKM values, cutoffs were chosen based on the 15% quantile of the respective criterion. For the CPM filter, as suggested in the <monospace>edgeR</monospace> pipeline <xref ref-type="bibr" rid="btt350-B22">Robinson <italic>et al.</italic> (2010)</xref>, genes with a CPM value &lt;1 in more samples than the size of the smallest group are subsequently filtered from the analysis.</p>
      <p>Among the filters considered, it may immediately be seen in <xref ref-type="fig" rid="btt350-F2">Figure 2</xref> that in the Strub data, with the exception of the CPM and Jaccard filters, most of the filters considered here appear to be ineffective as they are largely unable to filter genes with low levels of expression and small log-fold changes; a similar phenomenon may be observed in the Bottomly and Sultan data (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt350/-/DC1">Supplementary Figs S7</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt350/-/DC1">S14</ext-link>). Although these techniques are thus unlikely to (incorrectly) filter truly DE genes, the number of statistical tests is not markedly reduced, and as such the power to detect differential expression will remain largely unchanged as compared with the unfiltered data. With the exception of the RPKM-based filters, all are able, to some extent, to identify and remove genes contributing to a peak of raw <italic>P</italic>-values close to one (<xref ref-type="fig" rid="btt350-F3">Fig. 3</xref> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt350/-/DC1">Supplementary Figs S13</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt350/-/DC1">S20</ext-link>), a phenomenon due to the discretization of <italic>P</italic>-values for small counts; indeed, histograms of raw <italic>P</italic>-values following the application of most filters appear to be roughly uniformly distributed under the null hypothesis. In addition, we note that the proposed Jaccard filter is able to more effectively remove genes with moderate log base means and small log fold changes (see <xref ref-type="fig" rid="btt350-F2">Fig. 2</xref>). Similar conclusions may be drawn from the volcano plots shown in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt350/-/DC1">Supplementary Figures S8</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt350/-/DC1">S15</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt350/-/DC1">S22</ext-link>.
<fig id="btt350-F2" position="float"><label>Fig. 2.</label><caption><p>Log mean expression versus log fold change values for the Strub data. For each filter, genes identified as non-DE are drawn in black, those identified as DE are drawn in color (online) or grey (print), and those filtered from the differential analysis are omitted from the plot. From left to right, the filters are as follows: none, CPM, maximum, mean, RPKM maximum, RPKM mean and maximum using the global Jaccard index threshold</p></caption><graphic xlink:href="btt350f2p"/></fig>
<fig id="btt350-F3" position="float"><label>Fig. 3.</label><caption><p>Histograms of raw <italic>P</italic>-values from a differential analysis of the Bottomly data for a variety of filter types. Histograms in the background represent the raw <italic>P</italic>-values from a differential analysis of the Bottomly data using unfiltered data; histograms in the foreground represent the raw <italic>P</italic>-values from a differential analysis of the data filtered with various filter types. Figure made using the <monospace>ggplot2</monospace> package (<xref ref-type="bibr" rid="btt350-B28">Wickham, 2009</xref>)</p></caption><graphic xlink:href="btt350f3p"/></fig></p>
      <p>It is also of interest to consider the effect of each filter on the number of DE genes identified at various levels of expression; in <xref ref-type="fig" rid="btt350-F4">Figure 4</xref> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt350/-/DC1">Supplementary Figures S5</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt350/-/DC1">S12</ext-link>, we note that in all datasets, the Jaccard filter leads to more discoveries at all but weak levels of expression (i.e. mean expression &lt;10), with this difference being particularly marked for moderate levels of expression (i.e. mean expression greater than 50). We note that a large number of the missed discoveries for the Jaccard filter at low levels of expression correspond to genes with zero read counts in one condition and a small number of read counts in the other; for example, in the Sultan data, 50.3% of the 449 discoveries among genes with mean normalized read counts &lt;10 had zero read counts in one of the two conditions. Among the other filter types, the CPM filter appears to come closest to the Jaccard filter, with the remaining filters performing similarly.
<fig id="btt350-F4" position="float"><label>Fig. 4.</label><caption><p>Number of DE genes detected in the Sultan data, categorized by normalized base mean for each filter type (from left to right in each bin: none, CPM, maximum, mean, maximum RPKM, mean RPKM, and Jaccard). Figure made using the <monospace>ggplot2</monospace> package (<xref ref-type="bibr" rid="btt350-B28">Wickham, 2009</xref>)</p></caption><graphic xlink:href="btt350f4p"/></fig></p>
      <p>In considering the overlap of genes filtered using each method (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt350/-/DC1">Supplementary Figs S9</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt350/-/DC1">S16</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt350/-/DC1">S23</ext-link>), it is clear that a large number of genes may be filtered, regardless of the technique used. However, the Jaccard index is better able to filter a large number of weakly expressed genes in all three of the datasets considered here, leading to a more moderate correction for multiple testing; the direct consequence of this is a larger number of discoveries at moderate-to-high levels of expression. To determine whether this advantage is due to the filtering type (i.e. maximum) or the threshold used for each (i.e. using the 15% quantile or the data-based threshold identified by the global Jaccard index), we consider a set of simulation studies in the next section.</p>
    </sec>
    <sec id="SEC3.3">
      <title>3.3 Simulated data</title>
      <p>Data were simulated using a negative binomial model, with parameters chosen based on the Bottomly, Sultan and Strub datasets. Briefly, for each dataset, genes with zero counts in one of the two groups and mean &lt;5 were removed (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt350/-/DC1">Supplementary Table S1</ext-link>). Differential analyses were performed on unfiltered data using the <monospace>DESeq</monospace> Bioconductor package (<xref ref-type="bibr" rid="btt350-B1">Anders and Huber, 2010</xref>) as described in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt350/-/DC1">Supplementary Materials</ext-link>. After adjusting raw <italic>P</italic>-values for multiple testing using the Benjamini–Hochberg procedure (<xref ref-type="bibr" rid="btt350-B3">Benjamini and Hochberg, 1995</xref>), we identified 570, 2515 and 2485 DE genes, respectively, at the 5% significance level in the Bottomly, Sultan and Strub data. In addition, the parametric gamma regressions fitted to the per-gene dispersion estimates α and gene expression means μ (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt350/-/DC1">Supplementary Fig. S25</ext-link>) were identified for each dataset:
<disp-formula id="btt350-M4"><label>(4)</label><graphic xlink:href="btt350m4"/></disp-formula>
<disp-formula id="btt350-M5"><label>(5)</label><graphic xlink:href="btt350m5"/></disp-formula>
<disp-formula id="btt350-M6"><label>(6)</label><graphic xlink:href="btt350m6"/></disp-formula>
</p>
      <p>Subsequently, simulation parameters for each dataset were fixed as follows. For genes identified as being DE, means for each condition were set to be the empirically calculated means from each condition from the normalized data; for genes not identified as being DE, means for each condition were both set to be the global mean (across both conditions) from the normalized data. This allows genes to be simulated as DE across the full range of mean expression values (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt350/-/DC1">Supplementary Fig. S27</ext-link>). Per-gene dispersion parameters were set to be the fitted values from the regression equations defined in <xref ref-type="disp-formula" rid="btt350-M4 btt350-M5 btt350-M6">Equations (4)–(6)</xref> as a function of the overall mean for each gene; for the simulations based on the Bottomly and Sultan data, dispersion parameters for genes with overall mean expression &lt;20 were fixed to be equal to <inline-formula><inline-graphic xlink:href="btt350i22.jpg"/></inline-formula> to simulate negligible overdispersion, as shot noise appears to dominate biological noise at low expression levels in these data (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt350/-/DC1">Supplementary Fig. S26</ext-link>). Once these parameters were fixed for each gene, a negative binomial model was used to simulate 300 individual datasets each for the parameters based on the Bottomly, Sultan and Strub data, with 21 samples (10 in one condition and 11 in the other), 4 samples (2 in each condition) and 6 samples (3 in each condition), respectively. Real lengths corresponding to the genes in each dataset were used for the calculation of RPKM values.</p>
    </sec>
    <sec id="SEC3.4">
      <title>3.4 Comparison of filters on simulated data</title>
      <p>To assess performance on simulated data, we focus on the sensitivity of detecting DE genes after each data filter, defined as the proportion of truly DE genes detected among all truly DE genes. In addition, we construct Receiver Operating Characteristic (ROC) curves of each filter, based on the <italic>filtering sensitivity</italic>, defined as the proportion of correctly unfiltered genes (i.e. DE and unfiltered) among all truly DE genes, and the <italic>filtering specificity</italic>, defined as the proportion of correctly filtered genes (i.e. non-DE and filtered) among all non-DE genes.</p>
      <p>In <xref ref-type="fig" rid="btt350-F5">Figure 5</xref>, we note that the sensitivity to detect DE genes greatly varies among the filtering types for simulations based on the Strub data, as well as among different thresholds within each filtering type; in addition, the RPKM maximum and RPKM mean filters actually lead to lower detection power than unfiltered data. Similar results may be seen for the simulations based on the Bottomly and Sultan data in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt350/-/DC1">Supplementary Figure S30</ext-link>. For the simulation setting shown in <xref ref-type="fig" rid="btt350-F5">Figure 5</xref>, larger thresholds appear to yield the highest detection sensitivity (i.e. maximum or mean-based filters for normalized counts using the 30% quantile as a threshold). However, this trend is reversed for the other simulation settings, where smaller cutoffs (i.e. cutoffs of 5 or 15% for the maximum or mean-based filters) lead to higher detection sensitivity. This highlights the difficulty in pre-selecting a fixed threshold for a given filtering method, as well as the advantage of our proposed Jaccard filter. Indeed, the Jaccard filter appears to lead to high detection sensitivity for all simulations with the exception of those based on the Bottomly data; for these data, because many weakly expressed genes were simulated to be DE (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt350/-/DC1">Supplementary Fig. S27</ext-link>), unfiltered data had the highest sensitivity.
<fig id="btt350-F5" position="float"><label>Fig. 5.</label><caption><p>Sensitivity (over simulated 300 datasets) to detect DE genes for a variety of filter types and cutoffs, with simulation parameters based on the Strub data. None, no filter; CPM, genes with a CPM less than one in more than half the samples are filtered; Max, maximum-based filter, using the threshold based on the Jaccard index (J), quantiles (5, 15 and 30%), or values (5, 10, 25); Mean, mean-based filter, using the threshold based on quantiles (5, 15 and 30%), or values (5, 10, 25); RPKM.max, maximum RPKM filter, using the threshold based on quantiles (5 and 15%) or the value 0.3; RPKM.mean, maximum RPKM filter, using the threshold based on quantiles (5 and 15%) or the value 0.3</p></caption><graphic xlink:href="btt350f5p"/></fig></p>
      <p>To assess the role of the choice of threshold for each filter type, we constructed ROC curves of the filtering sensitivity and specificity over varying cutoffs in <xref ref-type="fig" rid="btt350-F6">Figure 6</xref> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt350/-/DC1">Supplementary Figure S29</ext-link>. We note that the mean and maximum RPKM-based filters tend to have lower filtering sensitivity than the others, and the maximum filters (for both normalized counts and CPM values) tend to be similar; however, for all simulation settings, the maximum filter for normalized counts has a slight advantage over that for CPM values. In other words, regardless of the threshold used for filtering, maximum-based filters appear to more effectively filter non-DE genes than the remaining methods. Finally, we note also that the data-based threshold using the global Jaccard index appears to find a good compromise between filtering sensitivity and filtering specificity.
<fig id="btt350-F6" position="float"><label>Fig. 6.</label><caption><p>ROC curves (averaged over 300 datasets) for the filtering performance on simulated data based on the Sultan data for the CPM, maximum, mean, maximum RPKM and mean RPKM filters over a range of cutoffs. The yellow cross labeled with a ‘J’ corresponds to the filtering sensitivity and specificity for the data-based threshold chosen via the global Jaccard index</p></caption><graphic xlink:href="btt350f6p"/></fig></p>
    </sec>
  </sec>
  <sec>
    <title>4 CONCLUSIONS AND DISCUSSION</title>
    <p>Data filtering has proven to be of great practical importance for the differential analysis of high-throughput microarray and RNA-seq data by identifying and removing genes with uninformative signal before testing. In recent years, many <italic>ad hoc</italic> procedures have been used to filter RNA-seq data, such as filtering genes with a total or mean normalized read count less than a specified threshold. However, despite its impact on the downstream analyses, no clear recommendations have yet been provided concerning the choice of filtering technique.</p>
    <p>Among the filter types considered here, we have found that filters using the maximum normalized count appear to be best able to correctly filter genes with low levels of expression and little evidence of differential expression. In addition, we have proposed a method to calculate a data-driven and non-pre-fixed filtering threshold value for normalized counts from replicated RNA-seq data, based on the global Jaccard similarity index. In particular, our proposed filtering technique was found to remove from the analysis a large number of genes with little or no chance of showing evidence of differential expression, and therefore to increase detection power at moderate-to-high levels of expression through a moderation of the correction for multiple testing. As such, we recommend that genes with a normalized count value less than this data-driven threshold in all samples be filtered from subsequent differential analyses. We emphasize that the data-driven threshold value may vary greatly among RNA-seq experiments owing to differences in sequencing depth and intra-condition variability (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt350/-/DC1">Supplementary Fig. S31</ext-link> for the data-based thresholds calculated on three additional RNA-seq datasets); as such, the threshold value must be recalculated for each dataset of interest.</p>
    <p>The impact of the proposed filtering method has been investigated here in the context of differential analyses. We anticipate that it will also be useful in a variety of other applications, e.g. detecting genes that are specifically expressed in one condition or ubiquitously expressed across several conditions, which is often a crucial biological question. In addition, we anticipate that such filtering will be useful, for example, in co-expression or network reconstruction analyses to remove genes with low constant levels of expression. Finally, we note that although this filter was presented here for the analysis of RNA-seq data, it can readily be applied to other types of replicated HTS data, such as CHIP-seq data.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_29_17_2146__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btt350_Full_SuppMat.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>The authors thank the three anyonymous reviewers for their valuable comments and suggestions that helped to considerably improve the quality of the manuscript.</p>
    <p><italic>Funding</italic>: This work was supported by the <funding-source>French National Research Agency</funding-source> (Agence nationale de la recherche) [<award-id>ANR-09-GENM-006</award-id>, Biocart project].</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="btt350-B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Differential expression analysis for sequence count data</article-title>
        <source>Genome Biol.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>1</fpage>
        <lpage>28</lpage>
      </element-citation>
    </ref>
    <ref id="btt350-B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Auer</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Doerge</surname>
            <given-names>RW</given-names>
          </name>
        </person-group>
        <article-title>A two-stage Poisson model for testing RNA-seq data</article-title>
        <source>Stat. Appl. Genet. Mol. Biol.</source>
        <year>2011</year>
        <volume>10</volume>
        <fpage>1</fpage>
        <lpage>26</lpage>
      </element-citation>
    </ref>
    <ref id="btt350-B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
        <source>J. R. Stat. Soc. Ser. B</source>
        <year>1995</year>
        <volume>57</volume>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
    <ref id="btt350-B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Birney</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An overview of ensembl</article-title>
        <source>Genome Res.</source>
        <year>2004</year>
        <volume>14</volume>
        <fpage>925</fpage>
        <lpage>928</lpage>
        <pub-id pub-id-type="pmid">15078858</pub-id>
      </element-citation>
    </ref>
    <ref id="btt350-B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bottomly</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evaluating gene expression in C57BL/GJ and DBA/2J mouse striatum using RNA-seq and microarrays</article-title>
        <source>PLoS One</source>
        <year>2011</year>
        <volume>6</volume>
        <fpage>e17820</fpage>
        <pub-id pub-id-type="pmid">21455293</pub-id>
      </element-citation>
    </ref>
    <ref id="btt350-B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bourgon</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Independent filtering increases detection power for high-throughput experiments</article-title>
        <source>PNAS</source>
        <year>2010</year>
        <volume>107</volume>
        <fpage>9546</fpage>
        <lpage>9551</lpage>
        <pub-id pub-id-type="pmid">20460310</pub-id>
      </element-citation>
    </ref>
    <ref id="btt350-B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cánovas</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SNP discovery in the bovine milk transcriptome using RNA-seq technology</article-title>
        <source>Mamm. Genome</source>
        <year>2010</year>
        <volume>21</volume>
        <fpage>592</fpage>
        <lpage>598</lpage>
        <pub-id pub-id-type="pmid">21057797</pub-id>
      </element-citation>
    </ref>
    <ref id="btt350-B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cleveland</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>Robust locally weighted regression and smoothing scatterplots</article-title>
        <source>J. Am. Stat. Assoc.</source>
        <year>1979</year>
        <volume>74</volume>
        <fpage>829</fpage>
        <lpage>836</lpage>
      </element-citation>
    </ref>
    <ref id="btt350-B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dillies</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A comprehensive evaluation of normalization methods for Illumina high-throughput RNA sequencing data analysis</article-title>
        <source>Brief. Bioinformatics</source>
        <year>2012</year>
        <comment>[Epub ahead of print, September 17, 2012]</comment>
      </element-citation>
    </ref>
    <ref id="btt350-B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frazee</surname>
            <given-names>AC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ReCount: a multi-experiment resource of analysis-ready RNA-seq gene count datasets</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>449</fpage>
        <pub-id pub-id-type="pmid">22087737</pub-id>
      </element-citation>
    </ref>
    <ref id="btt350-B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gentleman</surname>
            <given-names>RC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bioconductor: open software development for comptuational biology and bioinformatics</article-title>
        <source>Genome Biol.</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>2004</fpage>
      </element-citation>
    </ref>
    <ref id="btt350-B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hansen</surname>
            <given-names>KD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Removing technical variability in RNA-seq data using conditional quantile normalization</article-title>
        <source>Biostatistics</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>204</fpage>
        <lpage>216</lpage>
        <pub-id pub-id-type="pmid">22285995</pub-id>
      </element-citation>
    </ref>
    <ref id="btt350-B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jaccard</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Étude comparative de la distribution florale dans une portion des Alpes et des Jura</article-title>
        <source>Bull. Soc. Vaudoise Sci. Nat.</source>
        <year>1901</year>
        <volume>37</volume>
        <fpage>547</fpage>
        <lpage>549</lpage>
      </element-citation>
    </ref>
    <ref id="btt350-B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kasprzyk</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>EnsMart: a generic system for fast and flexible access to biological data</article-title>
        <source>Genome Res.</source>
        <year>2004</year>
        <volume>14</volume>
        <fpage>160</fpage>
        <lpage>169</lpage>
        <pub-id pub-id-type="pmid">14707178</pub-id>
      </element-citation>
    </ref>
    <ref id="btt350-B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Łabaj</surname>
            <given-names>PP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-seq precision in quantitative expression profiling</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>i383</fpage>
        <lpage>i381</lpage>
        <pub-id pub-id-type="pmid">21685096</pub-id>
      </element-citation>
    </ref>
    <ref id="btt350-B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mortazavi</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq</article-title>
        <source>Nat. Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>621</fpage>
        <lpage>628</lpage>
        <pub-id pub-id-type="pmid">18516045</pub-id>
      </element-citation>
    </ref>
    <ref id="btt350-B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oshlack</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>From RNA-seq reads to differential expression results</article-title>
        <source>Genome Biol.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>220</fpage>
        <pub-id pub-id-type="pmid">21176179</pub-id>
      </element-citation>
    </ref>
    <ref id="btt350-B18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oshlack</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wakefield</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Transcript length bias in RNA-seq data confounds systems biology</article-title>
        <source>Biol. Direct</source>
        <year>2009</year>
        <volume>4</volume>
        <fpage>14</fpage>
        <pub-id pub-id-type="pmid">19371405</pub-id>
      </element-citation>
    </ref>
    <ref id="btt350-B19">
      <element-citation publication-type="book">
        <collab>R Development Core Team</collab>
        <source>R: a Language and Environment for Statistical Computing</source>
        <year>2009</year>
        <publisher-loc>Vienna, Austria</publisher-loc>
        <publisher-name>R Foundation for Statistical Computing</publisher-name>
        <comment><ext-link ext-link-type="uri" xlink:href="http://www.R-project.org">http://www.R-project.org</ext-link> (16 July 2013, date last accessed)</comment>
      </element-citation>
    </ref>
    <ref id="btt350-B20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ramsköld</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An abundance of ubiquitously expressed genes revealed by tissue transcriptome sequence data</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2009</year>
        <volume>5</volume>
        <fpage>e1000598</fpage>
        <pub-id pub-id-type="pmid">20011106</pub-id>
      </element-citation>
    </ref>
    <ref id="btt350-B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Risso</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GC-content normalization for RNA-seq data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>480</fpage>
        <pub-id pub-id-type="pmid">22177264</pub-id>
      </element-citation>
    </ref>
    <ref id="btt350-B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>edgeR: a bioconductor package for differential expression analysis of digital gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>139</fpage>
        <lpage>140</lpage>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="btt350-B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Oshlack</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A scaling normalization method for differential expression analysis of RNA-seq data</article-title>
        <source>Genome Biol.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R25</fpage>
        <pub-id pub-id-type="pmid">20196867</pub-id>
      </element-citation>
    </ref>
    <ref id="btt350-B24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sam</surname>
            <given-names>LT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A comparison of single molecule and amplification based sequencing of cancer transcriptomes</article-title>
        <source>PLoS One</source>
        <year>2011</year>
        <volume>6</volume>
        <fpage>e17305</fpage>
        <pub-id pub-id-type="pmid">21390249</pub-id>
      </element-citation>
    </ref>
    <ref id="btt350-B25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Strub</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Essential role of microphthalmia transcription factor for DNA eplication, mitosis and genomic stability in melanoma</article-title>
        <source>Oncogene</source>
        <year>2011</year>
        <volume>30</volume>
        <fpage>2319</fpage>
        <lpage>2332</lpage>
        <pub-id pub-id-type="pmid">21258399</pub-id>
      </element-citation>
    </ref>
    <ref id="btt350-B26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sultan</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A global view of gene activity and alternative splicing by deep sequencing of the human transcriptome</article-title>
        <source>Science</source>
        <year>2008</year>
        <volume>15</volume>
        <fpage>956</fpage>
        <lpage>960</lpage>
        <pub-id pub-id-type="pmid">18599741</pub-id>
      </element-citation>
    </ref>
    <ref id="btt350-B27">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DEGseq: an R package for idenetifying differentially expressed genes from RNA-seq data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>136</fpage>
        <lpage>138</lpage>
        <pub-id pub-id-type="pmid">19855105</pub-id>
      </element-citation>
    </ref>
    <ref id="btt350-B28">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Wickham</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <source>ggplot2: Elegant Graphics for Data Analysis</source>
        <year>2009</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
  </ref-list>
</back>
