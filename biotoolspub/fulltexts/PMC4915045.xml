<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4915045</article-id>
    <article-id pub-id-type="publisher-id">997</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-016-0997-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Mash: fast genome and metagenome distance estimation using MinHash</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ondov</surname>
          <given-names>Brian D.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Treangen</surname>
          <given-names>Todd J.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Melsted</surname>
          <given-names>Páll</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mallonee</surname>
          <given-names>Adam B.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bergman</surname>
          <given-names>Nicholas H.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Koren</surname>
          <given-names>Sergey</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Phillippy</surname>
          <given-names>Adam M.</given-names>
        </name>
        <address>
          <email>adam.phillippy@nih.gov</email>
        </address>
        <xref ref-type="aff" rid="Aff3"/>
      </contrib>
      <aff id="Aff1"><label/>National Biodefense Analysis and Countermeasures Center, Frederick, MD USA </aff>
      <aff id="Aff2"><label/>Faculty of Industrial Engineering, Mechanical Engineering and Computer Science, University of Iceland, Reykjavik, Iceland </aff>
      <aff id="Aff3"><label/>Genome Informatics Section, Computational and Statistical Genomics Branch, National Human Genome Research Institute, National Institutes of Health, Bethesda, MD USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>6</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>6</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2016</year>
    </pub-date>
    <volume>17</volume>
    <elocation-id>132</elocation-id>
    <history>
      <date date-type="received">
        <day>31</day>
        <month>12</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>3</day>
        <month>6</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2016</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p>Mash extends the MinHash dimensionality-reduction technique to include a pairwise mutation distance and <italic>P</italic> value significance test, enabling the efficient clustering and search of massive sequence collections. Mash reduces large sequences and sequence sets to small, representative sketches, from which global mutation distances can be rapidly estimated. We demonstrate several use cases, including the clustering of all 54,118 NCBI RefSeq genomes in 33 CPU h; real-time database search using assembled or unassembled Illumina, Pacific Biosciences, and Oxford Nanopore data; and the scalable clustering of hundreds of metagenomic samples by composition. Mash is freely released under a BSD license (<ext-link ext-link-type="uri" xlink:href="https://github.com/marbl/mash">https://github.com/marbl/mash</ext-link>).</p>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s13059-016-0997-x) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Comparative genomics</kwd>
      <kwd>Genomic distance</kwd>
      <kwd>Alignment</kwd>
      <kwd>Sequencing</kwd>
      <kwd>Nanopore</kwd>
      <kwd>Metagenomics</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/http://dx.doi.org/10.13039/100000051</institution-id>
            <institution>National Human Genome Research Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>Intramural Research Program</award-id>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/http://dx.doi.org/10.13039/100008287</institution-id>
            <institution>Science and Technology Directorate</institution>
          </institution-wrap>
        </funding-source>
        <award-id>HSHQDC-07-C-00020</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2016</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>When BLAST was first published in 1990 [<xref ref-type="bibr" rid="CR1">1</xref>], there were less than 50 million bases of nucleotide sequence in the public archives [<xref ref-type="bibr" rid="CR2">2</xref>]; now a single sequencing instrument can produce over 1 trillion bases per run [<xref ref-type="bibr" rid="CR3">3</xref>]. New methods are needed that can manage and help organize this scale of data. To address this, we consider the general problem of computing an approximate distance between two sequences and describe Mash, a general-purpose toolkit that utilizes the MinHash technique [<xref ref-type="bibr" rid="CR4">4</xref>] to reduce large sequences (or sequence sets) to compressed sketch representations. Using only the sketches, which can be thousands of times smaller, the similarity of the original sequences can be rapidly estimated with bounded error. Importantly, the error of this computation depends only on the size of the sketch and is independent of the genome size. Thus, sketches comprising just a few hundred values can be used to approximate the similarity of arbitrarily large datasets. This has important applications for large-scale genomic data management and emerging long-read, single-molecule sequencing technologies. Potential applications include any problem where an approximate, global distance is acceptable, e.g. to triage and cluster sequence data, assign species labels, build large guide trees, identify mis-tracked samples, and search genomic databases.</p>
    <p>The MinHash technique is a form of locality-sensitive hashing [<xref ref-type="bibr" rid="CR5">5</xref>] that has been widely used for the detection of near-duplicate Web pages and images [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>], but has seen limited use in genomics despite initial applications over ten years ago [<xref ref-type="bibr" rid="CR8">8</xref>]. More recently, MinHash has been applied to the relevant problems of genome assembly [<xref ref-type="bibr" rid="CR9">9</xref>], 16S rDNA gene clustering [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>], and metagenomic sequence clustering [<xref ref-type="bibr" rid="CR12">12</xref>]. Because of the extremely low memory and CPU requirements of this probabilistic approach, MinHash is well suited for data-intensive problems in genomics. To facilitate this, we have developed Mash for the flexible construction, manipulation, and comparison of MinHash sketches from genomic data. We build upon past applications of MinHash by deriving a new significance test to differentiate chance matches when searching a database, and derive a new distance metric, the Mash distance, which estimates the mutation rate between two sequences directly from their MinHash sketches. Similar “alignment-free” methods have a long history in bioinformatics [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]. However, prior methods based on word counts have relied on short words of only a few nucleotides, which lack the power to differentiate between closely related sequences and produce distance measures that can be difficult to interpret [<xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR18">18</xref>]. Alternatively, methods based on string matching can produce very accurate estimates of mutation distance, but must process the entire sequence with each comparison, which is not feasible for all-pairs comparisons [<xref ref-type="bibr" rid="CR19">19</xref>–<xref ref-type="bibr" rid="CR22">22</xref>]. In contrast, the Mash distance can be quickly computed from the size-reduced sketches alone, yet produces a result that strongly correlates with alignment-based measures such as the Average Nucleotide Identity (ANI) [<xref ref-type="bibr" rid="CR23">23</xref>]. Thus, Mash combines the high specificity of matching-based approaches with the dimensionality reduction of statistical approaches, enabling accurate all-pairs comparisons between many large genomes and metagenomes.</p>
    <p>Mash provides two basic functions for sequence comparisons: <italic>sketch</italic> and <italic>dist</italic>. The <italic>sketch</italic> function converts a sequence or collection of sequences into a MinHash sketch (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). The <italic>dist</italic> function compares two sketches and returns an estimate of the Jaccard index (i.e. the fraction of shared k-mers), a <italic>P</italic> value, and the Mash distance, which estimates the rate of sequence mutation under a simple evolutionary model [<xref ref-type="bibr" rid="CR22">22</xref>] (see “<xref rid="Sec7" ref-type="sec">Methods</xref>”). Since Mash relies only on comparing length <italic>k</italic> substrings, or k-mers, the inputs can be whole genomes, metagenomes, nucleotide sequences, amino acid sequences, or raw sequencing reads. Each input is simply treated as a collection of k-mers taken from some known alphabet, allowing many applications. Here we examine three specific use cases: (1) sketching and clustering the entire NCBI RefSeq genome database; (2) searching assembled and unassembled genomes against the sketched RefSeq database in real time; and (3) computing a distance between metagenomic samples using both assembled and unassembled read sets. Additional applications can be envisioned and are covered in the “Discussion”.<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of the MinHash bottom sketch strategy for estimating the Jaccard index. First, the sequences of two datasets are decomposed into their constituent k-mers (<italic>top</italic>, <italic>blue and red</italic>) and each k-mer is passed through a hash function <italic>h</italic> to obtain a 32- or 64-bit hash, depending on the input k-mer size. The resulting hash sets, <italic>A</italic> and <italic>B</italic>, contain |<italic>A</italic>| and |<italic>B</italic>| distinct hashes each (<italic>small circles</italic>). The Jaccard index is simply the fraction of shared hashes (<italic>purple</italic>) out of all distinct hashes in <italic>A</italic> and <italic>B</italic>. This can be approximated by considering a much smaller random sample from the union of <italic>A</italic> and <italic>B</italic>. MinHash sketches <italic>S</italic>(<italic>A</italic>) and <italic>S</italic>(<italic>B</italic>) of size <italic>s</italic> = 5 are shown for <italic>A</italic> and <italic>B</italic>, comprising the five smallest hash values for each (<italic>filled circles</italic>). Merging <italic>S</italic>(<italic>A</italic>) and <italic>S</italic>(<italic>B</italic>) to recover the five smallest hash values overall for <italic>A</italic>∪<italic>B</italic> (<italic>crossed circles</italic>) yields <italic>S</italic>(<italic>A</italic>∪<italic>B</italic>). Because <italic>S</italic>(<italic>A</italic>∪<italic>B</italic>) is a random sample of <italic>A</italic>∪<italic>B</italic>, the fraction of elements in <italic>S</italic>(<italic>A</italic>∪<italic>B</italic>) that are shared by both <italic>S</italic>(<italic>A</italic>) and <italic>S</italic>(<italic>B</italic>) is an unbiased estimate of <italic>J</italic>(<italic>A</italic>,<italic>B</italic>)</p></caption><graphic xlink:href="13059_2016_997_Fig1_HTML" id="MO1"/></fig></p>
  </sec>
  <sec id="Sec2" sec-type="discussion">
    <title>Results and discussion</title>
    <sec id="Sec3">
      <title>Clustering all genomes in NCBI RefSeq</title>
      <p>Mash enables scalable whole-genome clustering, which is an important application for the future of genomic data management, but currently infeasible with alignment-based approaches. As genome databases increase in size and whole-genome sequencing becomes routine, it will become impractical to manually assign taxonomic labels for all genomes. Thus, generalized and automated methods will be useful for constructing groups of related genomes, e.g. for the automated detection of outbreak clusters [<xref ref-type="bibr" rid="CR24">24</xref>]. To illustrate the utility of Mash, we sketched and clustered all of NCBI RefSeq Release 70 [<xref ref-type="bibr" rid="CR25">25</xref>], totaling 54,118 organisms and 618 Gbp of genomic sequence. The resulting sketches total only 93 MB (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Note 1), yielding a compression factor of more than 7000-fold versus the uncompressed FASTA (674 GB). Further compression of the sketches is possible using standard compression tools. Sketching all genomes and computing all ~1.5 billion pairwise distances required just 26.1 and 6.9 CPU h, respectively. This process is easily parallelized, which can reduce the wall clock time to minutes with sufficient compute resources. Once constructed, additional genomes can be added incrementally to the full RefSeq database in just 0.9 CPU s per 5 MB genome (or 4 CPU min for a 3 GB genome). Thus, we have demonstrated that it is possible to perform unsupervised clustering of all known genomes and to efficiently update this clustering as new genomes are added.</p>
      <p>Importantly, the resulting Mash distances correlate well with ANI (a common measure of genome similarity), with <italic>D</italic> ≈ 1 − <italic>ANI</italic> over multiple sketch and k-mer sizes (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Due to the high cost of computing ANI via whole-genome alignment, a subset of 500 Escherichia genomes was selected for comparison (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Note 1). For ANI in the range of 90–100 %, the correlation with Mash distance is very strong across multiple sketch sizes and choices of <italic>k</italic>. For the default sketch size of <italic>s</italic> = 1000 and <italic>k</italic> = 21, Mash approximates 1–ANI with a root-mean-square error of 0.00274 on this dataset. This correlation begins to degrade for more divergent genomes because the variance of the Mash estimate grows with distance. Increasing sketch size improves the accuracy of Mash estimates, especially for divergent genomes (Table <xref rid="Tab1" ref-type="table">1</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S1 and S2). This results in a negligible increase in runtime for sketching, but the size of the resulting sketches and time required for distance comparisons increases linearly (Table <xref rid="Tab2" ref-type="table">2</xref>). The choice of <italic>k</italic> is a tradeoff between sensitivity and specificity. Smaller values of <italic>k</italic> are more sensitive for divergent genomes, but lose specificity for large genomes due to chance k-mer collisions (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3). Such chance collisions will skew the Mash distance, but given a known genome size, undesirable k-mer collisions can be avoided by choosing a suitably large value of <italic>k</italic> (see “<xref rid="Sec7" ref-type="sec">Methods</xref>”). However, too large of a k-mer will reduce sensitivity and so choosing the smallest <italic>k</italic> that avoids chance collisions is recommended.<fig id="Fig2"><label>Fig. 2</label><caption><p><italic>Scatterplots</italic> illustrating the relationship between ANI and Mash distance for a collection of Escherichia genomes. Each <italic>plot column</italic> shows a different sketch size <italic>s</italic> and each plot row a different k-mer size <italic>k. Gray lines</italic> show the model relationship <italic>D</italic> = 1–ANI and <italic>numbers</italic> in the <italic>bottom right</italic> of each plot give the root-mean-square error versus this perfect model. <italic>Blue lines</italic> show linear regression models. Increasing the sketch size improves the accuracy of the Mash distance, especially for more divergent sequences. However, there is a limit on how well the Mash distance can approximate ANI, especially for more divergent genomes (e.g. ANI considers only the core genome)</p></caption><graphic xlink:href="13059_2016_997_Fig2_HTML" id="MO2"/></fig><table-wrap id="Tab1"><label>Table 1</label><caption><p>Example Mash error bounds for a k-mer size of 21 and increasing sketch sizes</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th colspan="8">Mash distance</th></tr><tr><th>Sketch size</th><th>0.05</th><th>0.10</th><th>0.15</th><th>0.20</th><th>0.25</th><th>0.30</th><th>0.35</th><th>0.40</th></tr></thead><tbody><tr><td>100</td><td char="." align="char">0.0271</td><td char="." align="char">0.0868</td><td>–</td><td>–</td><td>–</td><td>–</td><td>–</td><td>–</td></tr><tr><td>500</td><td char="." align="char">0.0098</td><td char="." align="char">0.0245</td><td>0.0473</td><td>–</td><td>–</td><td>–</td><td>–</td><td>–</td></tr><tr><td>1000</td><td char="." align="char">0.0068</td><td char="." align="char">0.0158</td><td>0.0323</td><td>0.0630</td><td>–</td><td>–</td><td>–</td><td>–</td></tr><tr><td>5000</td><td char="." align="char">0.0029</td><td char="." align="char">0.0065</td><td>0.0124</td><td>0.0235</td><td>0.0460</td><td>–</td><td>–</td><td>–</td></tr><tr><td>10,000</td><td char="." align="char">0.0020</td><td char="." align="char">0.0046</td><td>0.0086</td><td>0.0159</td><td>0.0300</td><td>0.0726</td><td>–</td><td>–</td></tr><tr><td>50,000</td><td char="." align="char">0.0009</td><td char="." align="char">0.0020</td><td>0.0037</td><td>0.0065</td><td>0.0116</td><td>0.0219</td><td>0.0396</td><td>0.0822</td></tr><tr><td>100,000</td><td char="." align="char">0.0006</td><td char="." align="char">0.0014</td><td>0.0026</td><td>0.0046</td><td>0.0081</td><td>0.0143</td><td>0.0250</td><td>0.0492</td></tr><tr><td>500,000</td><td char="." align="char">0.0003</td><td char="." align="char">0.0006</td><td>0.0011</td><td>0.0020</td><td>0.0035</td><td>0.0060</td><td>0.0105</td><td>0.0187</td></tr><tr><td>1,000,000</td><td char="." align="char">0.0002</td><td char="." align="char">0.0004</td><td>0.0008</td><td>0.0014</td><td>0.0024</td><td>0.0042</td><td>0.0072</td><td>0.0128</td></tr></tbody></table><table-wrap-foot><p>For a given sketch size and Mash distance, the Mash estimation error will be less than the given value with 0.99 probability, as calculated by the binomial inverse cumulative distribution function. Missing values indicate that the estimate is unbounded, i.e. there is a chance that no matching k-mers will be found and the Mash distance will be undefined. Plots of the upper and lower error bounds for <italic>k</italic> = 16 and <italic>k</italic> = 21 are given in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2</p></table-wrap-foot></table-wrap><table-wrap id="Tab2"><label>Table 2</label><caption><p>Mash runtime and output size for all-pairs RefSeq computation using various sketch and k-mer sizes</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th colspan="4">k = 16</th><th colspan="4">k = 21</th></tr><tr><th>Sketch size</th><th>Sketch (CPU h)</th><th>Dist (CPU h)</th><th>Size (Mb)</th><th>gzip (Mb)</th><th>Sketch (CPU h)</th><th>Dist (CPU h)</th><th>Size (Mb)</th><th>gzip (Mb)</th></tr></thead><tbody><tr><td>500</td><td>26.4</td><td>8.4</td><td>120.1</td><td>89.7</td><td>31.3</td><td>9.0</td><td>229.8</td><td>201.8</td></tr><tr><td>1000</td><td>27.7</td><td>15.9</td><td>224.9</td><td>179.7</td><td>31.3</td><td>17.4</td><td>439.2</td><td>399.6</td></tr><tr><td>5000</td><td>26.4</td><td>74.5</td><td>1022.5</td><td>873.8</td><td>31.6</td><td>83.6</td><td>2034.5</td><td>1924.6</td></tr><tr><td>10,000</td><td>26.8</td><td>146.9</td><td>1961.8</td><td>1691.1</td><td>31.7</td><td>164.0</td><td>3913.0</td><td>3696.2</td></tr></tbody></table><table-wrap-foot><p><italic>Sketch:</italic> CPU h required for the Mash <italic>sketch</italic> operation for all 54,118 RefSeq genomes. <italic>Dist:</italic> CPU h required for the Mash <italic>dist</italic> table operation for all pairs of sketches. <italic>Size:</italic> combined size of the resulting sketches in megabytes. <italic>gzip:</italic> combined size of the resulting sketches after gzip compression</p></table-wrap-foot></table-wrap></p>
      <p>Approximate species clusters can be generated from the all-pairs distance matrix by graph clustering methods or simple thresholding of the Mash distance to create connected components. To illustrate, we linked all RefSeq genomes with a pairwise Mash distance ≤0.05, which equates to an ANI of ≥95 %. This threshold roughly corresponds to a 70 % DNA-DNA reassociation value—a historical, albeit debatable, definition of bacterial species [<xref ref-type="bibr" rid="CR23">23</xref>]. Figure <xref rid="Fig3" ref-type="fig">3</xref> shows the resulting graph of significant (<italic>P</italic> ≤10<sup>–10</sup>) pairwise distances with <italic>D</italic> ≤0.05 for all microbial genomes. Simply considering the connected components of the resulting graph yields a partitioning that largely agrees with the current NCBI bacterial species taxonomy. Eukaryotic and plasmid components are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S4 and S5, but would require alternate parameters for species-specific clustering due to their varying characteristics.<fig id="Fig3"><label>Fig. 3</label><caption><p>Comparison and de novo clustering of all RefSeq genomes using Mash. Each <italic>graph node</italic> represents a genome. Two genomes are connected by an edge if their Mash distance <italic>D</italic> ≤0.05 and <italic>P</italic> value ≤10<sup>–10</sup>. <italic>Graph layout</italic> was performed using Cytoscape [<xref ref-type="bibr" rid="CR61">61</xref>] organic layout algorithm [<xref ref-type="bibr" rid="CR62">62</xref>]. Individual nodes are colored by species and the <italic>top two rows</italic> of clusters have been annotated with the majority species label they contain. Only components containing microbial genomes are shown here (including viruses). Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S4 and S5 show eukaryotes, orphan plasmids, and organelles</p></caption><graphic xlink:href="13059_2016_997_Fig3_HTML" id="MO3"/></fig></p>
      <p>Beyond simple clustering, the Mash distance is an approximation of the mutation rate that can also be used to rapidly approximate phylogenies using hierarchical clustering. For example, all pairwise Mash distances for 17 RefSeq primate genomes were computed in just 2.5 CPU h (11 min wall clock on 17 cores) with default parameters (<italic>s</italic> = 1000 and <italic>k</italic> = 21) and used to build a neighbor-joining tree [<xref ref-type="bibr" rid="CR26">26</xref>]. Figure <xref rid="Fig4" ref-type="fig">4</xref> compares this tree to an alignment-based phylogenetic tree model downloaded from the UCSC genome browser [<xref ref-type="bibr" rid="CR27">27</xref>]. The Mash and UCSC primate trees are topologically consistent for everything except the Homo/Pan split, for which the Mash topology is more similar to past phylogenetic studies [<xref ref-type="bibr" rid="CR28">28</xref>] and mitochondrial trees [<xref ref-type="bibr" rid="CR14">14</xref>]. On average, the Mash branch lengths are slightly longer, with a Branch Score Distance [<xref ref-type="bibr" rid="CR29">29</xref>] of 0.10 between the two trees, but additional distance corrections are possible for k-mer based models [<xref ref-type="bibr" rid="CR22">22</xref>]. However, due to limitations of both the k-mer approach and simple distance model, we emphasize that Mash is not explicitly designed for phylogeny reconstruction, especially for genomes with high divergence or large size differences. For example, clustering the treeshrew, mouse, rat, guinea pig, and rabbit genomes alongside the primate genomes causes the tarsier to become misplaced (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6). Increasing the sketch size from 1000 to 5000 corrects this placement, but Mash has limited accuracy at these distances and should only be used in cases where such approximations are sufficient.<fig id="Fig4"><label>Fig. 4</label><caption><p>Primate trees from the UCSC genome browser and Mash. <bold>a</bold> A primate phylogenetic tree model from the UCSC genome browser, with branch lengths derived from fourfold degenerate sites extracted from reference gene multiple alignments. <bold>b</bold> A comparable Mash-based tree generated from whole genomes using a sketch size of <italic>s</italic> = 1000 and k-mer size of <italic>k</italic> = 21. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6 includes this Mash tree with five additional mammals of increasing divergence</p></caption><graphic xlink:href="13059_2016_997_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Real-time genome identification from assemblies or reads</title>
      <p>With a pre-computed sketch database, Mash is able to rapidly identify isolated genomes from both assemblies and raw sequencing reads. To illustrate, we computed Mash distances for multiple <italic>Escherichia coli</italic> datasets compared against the RefSeq sketch database (Table <xref rid="Tab3" ref-type="table">3</xref>). This test included the K12 MG1655 reference genome as well as assembled and unassembled sequencing runs from the ABI 3730, Roche 454, Ion PGM, Illumina MiSeq, PacBio RSII, and Oxford Nanopore MinION instruments. For assembled genomes, the correct strain was identified as the best hit in a few seconds. For each unassembled genome, a single sketch was constructed from the collection of k-mers in the reads and compared to the sketch database. In these cases, the best hit was to the correct species, including for <italic>E. coli</italic> 1D MinION reads [<xref ref-type="bibr" rid="CR30">30</xref>], which had an average sequencing error rate of ~40 %. However, the best-hit strain was often incorrect due to noise in the raw reads. To account for this uncertainly, we applied lowest common ancestor (LCA) classification (see “<xref rid="Sec7" ref-type="sec">Methods</xref>”), which was correct in all cases, albeit with reduced resolution. To further mitigate the problem of erroneous k-mers, Mash can filter low-abundance k-mers from raw sequencing data to improve accuracy. Increasing the sketch size can also improve sensitivity, as would error correction using dedicated methods [<xref ref-type="bibr" rid="CR31">31</xref>]. However, there are tradeoffs to consider when filtering or correcting low-coverage datasets (e.g. less than 5X coverage [<xref ref-type="bibr" rid="CR22">22</xref>]).<table-wrap id="Tab3"><label>Table 3</label><caption><p>Sequencing runs and assemblies searched against the Mash RefSeq database</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Organism</th><th>Tech</th><th>Type</th><th>NCBI accession</th><th>Size (Mbp)</th><th>Time (CPU s)</th><th>LCA</th><th>Best hit</th></tr></thead><tbody><tr><td><italic>E. coli</italic><break/>K12 MG1655</td><td>MiSeq</td><td>Assembly</td><td>(SPAdes)</td><td>4.6</td><td char="." align="char">2.45</td><td>Entero.</td><td><italic>E. coli</italic><break/>K12 MG1655</td></tr><tr><td><italic>E. coli</italic><break/>K12 MG1655</td><td>PacBio</td><td>Assembly</td><td>GCA_000801205</td><td>4.6</td><td char="." align="char">2.66</td><td>Entero.</td><td><italic>E. coli</italic><break/>K12 MG1655</td></tr><tr><td><italic>E. coli</italic><break/>DH1</td><td>ABI 3730</td><td>Reads</td><td>(Trace Archive)</td><td>60</td><td char="." align="char">17.08</td><td>Entero.</td><td><italic>E. coli</italic><break/>DH1</td></tr><tr><td><italic>E. coli</italic><break/>K12 MG1655</td><td>454</td><td>Reads</td><td>SRR797242</td><td>233</td><td char="." align="char">57.12</td><td>Entero.</td><td><italic>E. coli</italic><break/>K12 MG1655</td></tr><tr><td><italic>E. coli</italic><break/>K12 MG1655</td><td>Ion PGM</td><td>Reads</td><td>SRR515925</td><td>407</td><td char="." align="char">72.01</td><td><italic>E. coli</italic></td><td><italic>E. coli</italic><break/>K12 1655</td></tr><tr><td><italic>E. coli</italic><break/>K12 MG1655</td><td>MiSeq</td><td>Reads</td><td>SRR1770413</td><td>387</td><td char="." align="char">72.01</td><td>Entero.</td><td><italic>E. coli</italic><break/>KLY</td></tr><tr><td><italic>E. coli</italic><break/>K12 MT203</td><td>HiSeq</td><td>Reads</td><td>SRR490124</td><td>2155</td><td char="." align="char">369.86</td><td><italic>E. coli</italic></td><td><italic>E. coli</italic><break/>GCF_000833635</td></tr><tr><td><italic>E. coli</italic><break/>K12 MG1655</td><td>PacBio</td><td>Reads</td><td>SRR1284073</td><td>397</td><td char="." align="char">77.96</td><td><italic>E. coli</italic></td><td><italic>E. coli</italic> XH140A GCF_000226585</td></tr><tr><td><italic>E. coli</italic><break/>K12 MG1655</td><td>MinION</td><td>1D</td><td>ERR764952..55</td><td>248</td><td char="." align="char">55.52</td><td>Entero.</td><td><italic>E. coli</italic><break/>O113 H21</td></tr><tr><td><italic>E. coli</italic><break/>K12 MG1655</td><td>MinION</td><td>2D</td><td>ERR764952..55</td><td>134</td><td char="." align="char">27.82</td><td><italic>E. coli</italic></td><td><italic>E. coli</italic> GCF_000953515</td></tr><tr><td><italic>B. anthracis</italic> Ames</td><td>MinION</td><td>1D + 2D</td><td>SRR2671867</td><td>210</td><td char="." align="char">44.66</td><td><italic>B. anthracis</italic></td><td><italic>B. anthracis</italic><break/>str. Carbosap</td></tr><tr><td><italic>B. cereus</italic> ATCC 10987</td><td>MinION</td><td>1D + 2D</td><td>SRR2671868</td><td>266</td><td char="." align="char">76.85</td><td><italic>B. cereus</italic> ATCC 10987</td><td><italic>B. cereus</italic><break/>ATCC 10987</td></tr><tr><td><italic>Zaire ebolavirus</italic></td><td>MinION</td><td>1D + 2D</td><td>ERR1050070</td><td>8.7</td><td char="." align="char">2.06</td><td><italic>Zaire ebolavirus</italic></td><td><italic>Zaire ebolavirus</italic> Mayinga</td></tr></tbody></table><table-wrap-foot><p>In all cases, Mash search required 21 MB of RAM for genome assemblies and 209 MB of RAM for sequencing runs (due to the additional Bloom filter overhead). <italic>Organism:</italic> source strain. <italic>Tech:</italic> Sequencing technology ABI 3730, 454 GS FLX, Illumina MiSeq, Illumina HiSeq, Ion PGM, PacBio RSII, Oxford Nanopore MinION. <italic>Type:</italic> Assembly, reads, 1D and 2D nanopore reads. <italic>NCBI accession:</italic> NCBI accession of the dataset or reads. The SPAdes [<xref ref-type="bibr" rid="CR63">63</xref>] assembly was derived from the MiSeq reads. <italic>Size:</italic> total dataset size in Mbp. <italic>LCA:</italic> lowest common ancestor classification based on the NCBI taxonomy and the resulting hits within a significance tolerance of the best. In several cases, the LCA is at the family level (Enterobacteriaceae) due to significant Mash hits to both <italic>E. coli</italic> and <italic>S. sonnei</italic> species. This is a known species naming conflict within the NCBI taxonomy, with some genomes sharing ANI &gt;98 % between these species. <italic>Best hit:</italic> reports the smallest significant distance reported</p></table-wrap-foot></table-wrap></p>
      <p>To test Mash’s discriminatory power, we searched Oxford Nanopore MinION reads collected from <italic>Bacillus anthracis</italic> and <italic>Bacillus cereus</italic> against the full RefSeq sketch database. In both cases Mash was able to correctly differentiate these closely related species (ANI ≈ 95 %) using 43,806 and 91,379 sequences collected from single MinION R7.3 runs of <italic>B. anthracis</italic> Ames and <italic>B. cereus</italic> ATCC 10987, respectively (combined 1D and 2D reads). In the case of the higher quality <italic>B. cereus</italic> reads, processed with a more recent ONT workflow (1.10.1 vs. 1.6.3), the correct strain was identified as the best hit. These two searches both required just 1 min of CPU and 209 MB of RAM. Such low-overhead searches could be used for quickly triaging unknown samples or to rapidly select a reference genome for performing further, more detailed comparative analyses. For example, Mash uses an online algorithm for sketch construction and can therefore compare a sequencing run against a sketch database in real time. When tested on the Ebola virus MinION dataset, the <italic>Zaire ebolavirus</italic> reference genome was matched with a Mash <italic>P</italic> value of 10<sup>–10</sup> after processing the first 227,445 bases of sequencing data, which were collected by the MinION after just 770 s of sequencing. However, analyzing such streaming data presents a multiple testing problem and determining appropriate stopping conditions is left for future work (e.g. by monitoring the stability of a sketch as additional data are processed).</p>
    </sec>
    <sec id="Sec5">
      <title>Clustering massive metagenomic datasets</title>
      <p>Mash can also replicate the function of k-mer based metagenomic comparison tools, but in a fraction of the time previously required. The metagenomic comparison tool DSM, for example, computes an exact Jaccard index using all k-mers that occur more than twice per sample [<xref ref-type="bibr" rid="CR32">32</xref>]. By definition, Mash rapidly approximates this result by filtering unique k-mers and estimating the Jaccard index via MinHash. COMMET also uses k-mers to approximate similarity, but attempts to identify a set of similar reads between two samples using Bloom filters [<xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR34">34</xref>]. The similarity of two samples is then defined as the fraction of similar reads that the two datasets share, which is essentially a read-level Jaccard index. Thus, both DSM and COMMET report Jaccard-like similarity measures, which drop rapidly with increasing divergence, whereas the Mash distance is linear in terms of the mutation rate, but becomes less accurate with increasing divergence. Figure <xref rid="Fig5" ref-type="fig">5a</xref> replicates the analysis in Maillet et al. [<xref ref-type="bibr" rid="CR33">33</xref>] using both Mash and COMMET to cluster Global Ocean Survey (GOS) data [<xref ref-type="bibr" rid="CR35">35</xref>]. On this dataset, Mash is over tenfold faster than COMMET and correctly identifies clusters from the original GOS study. This illustrates the incremental scalability of Mash where the primary overhead is sketching, which occurs only once per each sample. After sketching, computing pairwise distances is near instantaneous. Thus, Mash avoids the quadratic barrier usually associated with all-pairs comparisons and scales well to many samples. For example, COMMET would require 1 h to add a new GOS sample to this analysis, compared to less than 1 min for Mash.<fig id="Fig5"><label>Fig. 5</label><caption><p>Metagenomic clustering of ocean and human metagenomes using Mash. <bold>a</bold> Comparison of Global Ocean Survey (GOS) clustering using Mash (<italic>top left</italic>) and COMMET (<italic>top right</italic>) using raw Sanger sequencing data. <italic>Heat maps</italic> illustrate the pairwise similarity between samples, scaled between 0 (<italic>white</italic>) and 100 (<italic>red</italic>) for comparison to COMMET. Sample groups are identified and colored using the same key as in Rusch et al. [<xref ref-type="bibr" rid="CR35">35</xref>]. The Mash clustering identifies two large clusters of temperate and tropical water samples as well as subgroupings consistent with the original GOS study. <bold>b</bold> Human metagenomic samples combined from the HMP and MetaHIT projects clustered by Mash from 888 sequencing runs (<italic>bottom left</italic>) and 879 assemblies (<italic>bottom right</italic>). For both sequencing reads and assemblies, Mash successfully clusters samples by body site and appropriately clusters MetaHIT and HMP stool samples together, even though these samples are from different projects with different protocols</p></caption><graphic xlink:href="13059_2016_997_Fig5_HTML" id="MO5"/></fig></p>
      <p>For a large-scale test, samples from the Human Microbiome Project [<xref ref-type="bibr" rid="CR36">36</xref>] (HMP) and Metagenomics of the Human Intestinal Tract [<xref ref-type="bibr" rid="CR37">37</xref>] (MetaHIT) were combined to create a ~10 TB 888-sample dataset. Importantly, the size of a Mash sketch is independent of the input size, requiring only 70 MB to store the combined sketches (<italic>s</italic> = 10,000, <italic>k</italic> = 21) for these datasets. Both assembled and unassembled samples were analyzed, requiring 4.4 CPU h to process all assemblies and 279.6 CPU h to process all read sets. We estimated that COMMET would require at least 140,000 CPU h to process all read sets (500 times slower than Mash), so it was not run on the full dataset. The Mash assembly-based and read-based clusters are remarkably similar, with all samples clearly grouped by body site (Fig. <xref rid="Fig5" ref-type="fig">5b</xref>). Additionally, Mash identified outlier samples that were independently excluded by the HMP’s quality control process. When included in the clustering, these samples were the only ones that failed to cluster by body site (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S7). However, because the Mash distance is based on simple k-mer sets, it may be more prone to batch effects from sequencing or sample preparation methods. For example, Mash does not cluster MetaHIT samples by health status, as previously reported [<xref ref-type="bibr" rid="CR37">37</xref>], and MetaHIT samples appear to preferentially cluster with one another.</p>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Conclusions</title>
    <p>Mash enables the comparison and clustering of whole genomes and metagenomes on a massive scale. Potential applications include the rapid triage and clustering of sequence data, for example, to quickly select the most appropriate reference genome for read mapping or to identify mis-tracked or low quality samples that fail to cluster as expected. Strong correlation between the Mash distance and sequence mutation rate enables approximate phylogeny construction, which could be used to rapidly determine outbreak clusters for thousands of genomes in real time. Additionally, because the Mash distance is based upon simple set intersections, it can be computed using homomorphic encryption schemes [<xref ref-type="bibr" rid="CR38">38</xref>], enabling privacy-preserving genomic tests [<xref ref-type="bibr" rid="CR39">39</xref>].</p>
    <p>Future applications of Mash could include read mapping and metagenomic sequence classification via windowed sketches or a containment score to test for the presence of one sequence within another [<xref ref-type="bibr" rid="CR4">4</xref>]. However, both of these approaches would require additional sketch overhead to achieve acceptable sensitivity. Improvements in database construction are also expected. For example, rather than storing a single sketch per sequence (or window), similar sketches could be merged to further reduce space and improve search times. Obvious strategies include choosing a representative sketch per cluster or hierarchically merging sketches via a Bloom tree [<xref ref-type="bibr" rid="CR40">40</xref>]. Finally, both the <italic>sketch</italic> and <italic>dist</italic> functions are designed as online algorithms, enabling, for example, <italic>dist</italic> to continually update a sketch from a streaming input. The program could then be modified to terminate when enough data have been collected to make a species identification at a predefined significance threshold. This functionality is designed to support the analysis of real-time data streams, as is expected from nanopore-based sequencing sensors [<xref ref-type="bibr" rid="CR24">24</xref>].</p>
  </sec>
  <sec id="Sec7">
    <title>Methods</title>
    <sec id="Sec8">
      <title>Mash sketch</title>
      <p>To construct a MinHash sketch, Mash first determines the set of constituent k-mers by sliding a window of length <italic>k</italic> across the sequence. Mash supports arbitrary alphabets (e.g. nucleotide or amino acid) and both assembled and unassembled sequences. Without loss of generality, here we will assume a nucleotide alphabet Σ = {A,C,G,T}. Depending on the alphabet size and choice of <italic>k</italic>, each k-mer is hashed to either a 32-bit or 64-bit value via a hash function, <italic>h</italic>. For nucleotide sequence, Mash uses canonical k-mers by default to allow strand-neutral comparisons. In this case, only the lexicographically smaller of the forward and reverse complement representations of a k-mer is hashed. For a given sketch size <italic>s</italic>, Mash returns the <italic>s</italic> smallest hashes output by <italic>h</italic> over all k-mers in the sequence (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Typically referred to as a “bottom-k sketch” for a sketch of size <italic>k</italic>, we refer to these simply as “bottom sketches” to avoid confusion with the k-mer size <italic>k</italic>. For a sketch size <italic>s</italic> and genome size <italic>n</italic>, a bottom sketch can be efficiently computed in <italic>O</italic>(<italic>n</italic> log <italic>s</italic>) time by maintaining a sorted list of size <italic>s</italic> and updating the current sketch only when a new hash is smaller than the current sketch maximum. Further, the probability that the <italic>i</italic>-th hash of the genome will enter the sketch is <italic>s</italic>/<italic>i</italic>, so the expected runtime of the algorithm is <italic>O</italic>(<italic>n</italic> + <italic>s</italic> log <italic>s</italic> log <italic>n</italic>) [<xref ref-type="bibr" rid="CR4">4</xref>], which becomes nearly linear when <italic>n</italic> &gt; &gt; <italic>s</italic>.</p>
      <p>As demonstrated by Fig. <xref rid="Fig3" ref-type="fig">3</xref>, a sketch comprising 400 32-bit hash values is sufficient to roughly group microbial genomes by species. With these parameters, the resulting sketch size equals 1.6 kB for each genome. For large genomes, this represents an enormous lossy compression (e.g. compared to the 750 MB needed to store a 3 Gbp genome using 2-bit encoding). However, the probability of a given k-mer <italic>K</italic> appearing in a random genome <italic>X</italic> of size <italic>n</italic> is:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ P\left(K\in X\right)=1-{\left(1-{\left|\Sigma \right|}^{-k}\right)}^n $$\end{document}</tex-math><mml:math id="M2"><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>K</mml:mi><mml:mo>∈</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mfenced close="|" open="|"><mml:mi mathvariant="normal">Σ</mml:mi></mml:mfenced><mml:mrow><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mi>n</mml:mi></mml:msup></mml:math><graphic xlink:href="13059_2016_997_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Thus, for <italic>k</italic> = 16 the probability of observing a given k-mer in a 3 Gbp genome is 0.50 and 25 % of k-mers are expected to be shared between two random 3 Gbp genomes by chance alone. This will skew any k-mer based distance and make distantly related genomes appear more similar than reality. To avoid this phenomenon, it is sufficient to choose a value of <italic>k</italic> that minimizes the probability of observing a random k-mer. Given a known genome size <italic>n</italic> and the desired probability <italic>q</italic> of observing a random k-mer (e.g. 0.01), this can be computed as [<xref ref-type="bibr" rid="CR41">41</xref>]:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ k\mathit{\hbox{'}}=\left\lceil { \log}_{\left|\Sigma \right|}\left(n\left(1-q\right)/q\right)\right\rceil $$\end{document}</tex-math><mml:math id="M4"><mml:mi>k</mml:mi><mml:mo mathvariant="italic">'</mml:mo><mml:mo>=</mml:mo><mml:mfenced close="⌉" open="⌈"><mml:mrow><mml:msub><mml:mo>log</mml:mo><mml:mfenced close="|" open="|"><mml:mi mathvariant="normal">Σ</mml:mi></mml:mfenced></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>n</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:mfenced><mml:mo stretchy="true">/</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2016_997_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>which yields <italic>k</italic> = 14 and <italic>k</italic> = 19 for 5 Mbp and 3 Gbp genomes (<italic>q</italic> = 0.01), respectively. We have found the parameters <italic>k</italic> = 21 and <italic>s</italic> = 1000 give accurate estimates in most cases (including metagenomes), so this is set as the default and still requires just 8 kB per sketch. However, for constructing the RefSeq database, <italic>k</italic> = 16 was chosen so that each hash could fit in 32 bits, minimizing the database size at the expense of reduced specificity for larger genomes. The small <italic>k</italic> also improves sensitivity, which helps when comparing noisy data like single-molecule sequencing (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S2 and S3).</p>
      <p>Lastly, for sketching raw sequencing reads, Mash provides both a two-stage MinHash and Bloom filter strategy to remove erroneous k-mers. These approaches assume that redundancy in the data (e.g. depth of coverage &gt;5) will result in true k-mers appearing multiple times in the input, while false k-mers will appear only a few times. Given a coverage threshold <italic>c</italic>, Mash can optionally ignore such low-abundance k-mers with counts less than <italic>c</italic>. By default, the coverage threshold is set to one and all k-mers are considered for the sketch. Increasing this threshold enables the two-stage MinHash filter strategy, which is based on tracking both the k-mer hashes in the current sketch and a secondary set of candidate hashes. At any time, the current sketch contains the <italic>s</italic> smallest hashes of all k-mers that have been observed at least <italic>c</italic> times and the candidate set contains hashes that are smaller than the largest value in the sketch (sketch max), but have been observed less than <italic>c</italic> times. When processing new k-mers, those with a hash greater than the sketch max are immediately discarded, as usual. However, if a new hash is smaller than the current sketch max, it is checked against the candidate set. If absent, it is added to this set. If present with a count less than <italic>c</italic> – 1, its counter is incremented. If present with a count of <italic>c</italic> – 1 or greater, it is removed from the candidate set and added to the sketch. At this point, the sketch max has changed and the candidate set can be pruned to contain only values less than the new sketch maximum. The result of this online method is equivalent to running the MinHash algorithm on only those k-mers that occur <italic>c</italic> or more times in the input. However, in the worst case, if all k-mers in the input occur less than the coverage threshold <italic>c</italic>, no hashes would escape the candidate set and memory use would increase with each new k-mer processed.</p>
      <p>Alternatively, a Bloom filter can be used to probabilistically exclude single-copy k-mers using a fixed amount of memory. In this approach, a Bloom filter is maintained instead of a candidate list and new hashes are inserted into the sketch only if they are less than sketch max and found in the Bloom filter. If a new hash would have otherwise been inserted in the sketch but was not found in the Bloom filter, it is inserted into the Bloom filter so that subsequent appearances of the hash will pass. This effectively excludes many single-copy k-mers from the sketch, but does not guarantee that all will be filtered. With this approach, filtering k-mers with a copy number greater than one would also be possible using a counting Bloom filter, but this has not been implemented since the exact method typically outperforms the Bloom method in practice, both in terms of accuracy and memory usage.</p>
    </sec>
    <sec id="Sec9">
      <title>Mash distance</title>
      <p>A MinHash sketch of size <italic>s</italic> = 1 is equivalent to the subsequent “minimizer” concept of Roberts et al. [<xref ref-type="bibr" rid="CR42">42</xref>], which has been used in genome assembly [<xref ref-type="bibr" rid="CR43">43</xref>], k-mer counting [<xref ref-type="bibr" rid="CR44">44</xref>], and metagenomics [<xref ref-type="bibr" rid="CR45">45</xref>]. Importantly, the more general MinHash concept permits an approximation of the Jaccard index <inline-formula id="IEq1"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ J\left(A,B\right)=\frac{\left|A\cap B\right|}{\left|A\cup B\right|} $$\end{document}</tex-math><mml:math id="M6"><mml:mi>J</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mi>A</mml:mi><mml:mi>B</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mfenced close="|" open="|"><mml:mrow><mml:mi>A</mml:mi><mml:mo>∩</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mfenced><mml:mfenced close="|" open="|"><mml:mrow><mml:mi>A</mml:mi><mml:mo>∪</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mfenced></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2016_997_Article_IEq1.gif"/></alternatives></inline-formula> between two k-mer sets <italic>A</italic> and <italic>B</italic>. Mash follows Broder’s original formulation and merge-sorts two bottom sketches <italic>S</italic>(<italic>A</italic>) and <italic>S</italic>(<italic>B</italic>) to estimate the Jaccard index [<xref ref-type="bibr" rid="CR4">4</xref>]. The merge is terminated after <italic>s</italic> unique hashes have been processed (or both sketches exhausted), and the Jaccard estimate is computed as <inline-formula id="IEq2"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ j=\frac{x}{s^{\prime }} $$\end{document}</tex-math><mml:math id="M8"><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>x</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2016_997_Article_IEq2.gif"/></alternatives></inline-formula> for <italic>x</italic> shared hashes found after processing <italic>s</italic>’ hashes. Because the sketches are stored in sorted order, this requires only <italic>O</italic>(<italic>s</italic>) time and effectively computes:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ J\left(A,B\right)=\frac{\left|A\cap B\right|}{\left|A\cup B\right|}\approx \frac{\left|S\left(A\cup B\right)\cap S(A)\cap S(B)\right|}{\left|S\left(A\cup B\right)\right|} $$\end{document}</tex-math><mml:math id="M10"><mml:mi>J</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mi>A</mml:mi><mml:mi>B</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mfenced close="|" open="|"><mml:mrow><mml:mi>A</mml:mi><mml:mo>∩</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mfenced><mml:mfenced close="|" open="|"><mml:mrow><mml:mi>A</mml:mi><mml:mo>∪</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mfenced></mml:mfrac><mml:mo>≈</mml:mo><mml:mfrac><mml:mfenced close="|" open="|"><mml:mrow><mml:mi>S</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>A</mml:mi><mml:mo>∪</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mfenced><mml:mo>∩</mml:mo><mml:mi>S</mml:mi><mml:mfenced close=")" open="("><mml:mi>A</mml:mi></mml:mfenced><mml:mo>∩</mml:mo><mml:mi>S</mml:mi><mml:mfenced close=")" open="("><mml:mi>B</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mfenced close="|" open="|"><mml:mrow><mml:mi>S</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>A</mml:mi><mml:mo>∪</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mfrac></mml:math><graphic xlink:href="13059_2016_997_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>which is an unbiased estimate of the true Jaccard index, as illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. Conveniently, the error bound of the Jaccard estimate <inline-formula id="IEq3"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \varepsilon =O\left(\frac{1}{\sqrt{s}}\right) $$\end{document}</tex-math><mml:math id="M12"><mml:mi>ε</mml:mi><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mfenced close=")" open="("><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mi>s</mml:mi></mml:msqrt></mml:mfrac></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2016_997_Article_IEq3.gif"/></alternatives></inline-formula> relies only on the sketch size and is independent of genome size [<xref ref-type="bibr" rid="CR46">46</xref>]. Specific confidence bounds are given below and in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1. Note, however, that the relative error can grow quite large for very small Jaccard values (i.e. divergent genomes). In these cases, a larger sketch size or smaller <italic>k</italic> is needed to compensate. For flexibility, Mash can also compare sketches of different size, but such comparisons are constrained by the smaller of the two sketches <italic>s</italic> &lt; <italic>u</italic> and only the <italic>s</italic> smallest values are considered.</p>
      <p>The Jaccard index is a useful measure of global sequence similarity because it correlates with ANI, a common measure of global sequence similarity. However, like the MUM index [<xref ref-type="bibr" rid="CR19">19</xref>], <italic>J</italic> is sensitive to genome size and simultaneously captures both point mutations and gene content differences. For distance-based applications, the Jaccard index can be converted to the Jaccard distance <italic>J</italic><sub><italic>δ</italic></sub>(<italic>A</italic>, <italic>B</italic>) = 1 − <italic>J</italic>(<italic>A</italic>, <italic>B</italic>), which is related to the <italic>q</italic>-gram distance but without occurrence counts [<xref ref-type="bibr" rid="CR47">47</xref>]. This can be a useful metric for clustering, but is non-linear in terms of the sequence mutation rate. In contrast, the Mash distance <italic>D</italic> seeks to directly estimate a mutation rate under a simple Poisson process of random site mutation. As noted by Fan et al. [<xref ref-type="bibr" rid="CR22">22</xref>], given the probability <italic>d</italic> of a single substitution, the expected number of mutations in a k-mer is <italic>λ</italic> = <italic>kd</italic>. Thus, under a Poisson model (assuming unique k-mers and random, independent mutation), the probability that no mutation will occur in a given k-mer is <italic>e</italic><sup><italic>−kd</italic></sup>, with an expected value equal to the fraction of conserved k-mers <italic>w</italic> to the total number of k-mers <italic>t</italic> in the genome, <inline-formula id="IEq4"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \frac{w}{t} $$\end{document}</tex-math><mml:math id="M14"><mml:mfrac><mml:mi>w</mml:mi><mml:mi>t</mml:mi></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2016_997_Article_IEq4.gif"/></alternatives></inline-formula> . Solving <inline-formula id="IEq5"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {e}^{-kd}=\frac{w}{t} $$\end{document}</tex-math><mml:math id="M16"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>k</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mi>w</mml:mi><mml:mi>t</mml:mi></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2016_997_Article_IEq5.gif"/></alternatives></inline-formula> gives <inline-formula id="IEq6"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ d = -\frac{1}{k} \ln \frac{w}{t} $$\end{document}</tex-math><mml:math id="M18"><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>k</mml:mi></mml:mfrac><mml:mo>ln</mml:mo><mml:mfrac><mml:mi>w</mml:mi><mml:mi>t</mml:mi></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2016_997_Article_IEq6.gif"/></alternatives></inline-formula>. To account for two genomes of different sizes, Fan et al. [<xref ref-type="bibr" rid="CR22">22</xref>] set <italic>t</italic> to the smaller of the two genome’s k-mer counts, thereby measuring containment of the k-mer set. In contrast, Mash sets <italic>t</italic> to the average genome size <italic>n</italic>, thereby penalizing for genome size differences and measuring resemblance (e.g. to avoid a distance of zero between a phage and a genome containing that phage). Finally, because the Jaccard estimate <italic>j</italic> can be framed in terms of the average genome size <inline-formula id="IEq7"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ j=\frac{w}{2n-w} $$\end{document}</tex-math><mml:math id="M20" display="block"><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>w</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2016_997_Article_IEq7.gif"/></alternatives></inline-formula>, the fraction of shared k-mers can be framed in terms of the Jaccard index <inline-formula id="IEq8"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \frac{w}{n}=\frac{2j}{1+j} $$\end{document}</tex-math><mml:math id="M22"><mml:mfrac><mml:mi>w</mml:mi><mml:mi>n</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2016_997_Article_IEq8.gif"/></alternatives></inline-formula>, yielding the Mash distance:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ D = -\frac{1}{k} \ln \frac{2j}{1+j} $$\end{document}</tex-math><mml:math id="M24"><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>k</mml:mi></mml:mfrac><mml:mo>ln</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="13059_2016_997_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Equation <xref rid="Equ4" ref-type="">4</xref> carries many assumptions and does not attempt to model more complex evolutionary processes, but closely approximates the divergence of real genomes (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). With appropriate choices of <italic>s</italic> and <italic>k</italic>, it can be used as a replacement for costly ANI computations. Table <xref rid="Tab1" ref-type="table">1</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2 give error bounds on the Mash distance for various sketch sizes and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3 illustrates the relationship between the Jaccard index, Mash distance, k-mer size, and genome size.</p>
    </sec>
    <sec id="Sec10">
      <title>Mash <italic>P</italic> value</title>
      <p>In the case of distantly related genomes it can be difficult to judge the significance of a given Jaccard index or Mash distance. As illustrated by Eq. <xref rid="Equ1" ref-type="">1</xref>, for small <italic>k</italic> and large <italic>n</italic> there can be a high probability of a random k-mer appearing by chance. How many k-mers then are expected to match between the sketches of two unrelated genomes? This depends on the sketch size and the probability of a random k-mer appearing in the genome, where the expected Jaccard index <italic>r</italic> between two random genomes <italic>X</italic> and <italic>Y</italic> is given by:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ r=\frac{P\left(K\in X\right)P\left(K\in Y\right)}{P\left(K\in X\right)+P\left(K\in Y\right)-P\left(K\in X\right)P\left(K\in Y\right)} $$\end{document}</tex-math><mml:math id="M26"><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>K</mml:mi><mml:mo>∈</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>K</mml:mi><mml:mo>∈</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>K</mml:mi><mml:mo>∈</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>K</mml:mi><mml:mo>∈</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>K</mml:mi><mml:mo>∈</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>K</mml:mi><mml:mo>∈</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="13059_2016_997_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>From Eq. <xref rid="Equ1" ref-type="">1</xref>, the probability of a random k-mer depends both on the size of <italic>k</italic>, which is known, and total number of k-mers in the genome, which can be estimated from the sketch [<xref ref-type="bibr" rid="CR48">48</xref>]. For the sketch size <italic>s</italic>, maximum hash value in the sketch <italic>v</italic>, and hash bits <italic>b</italic>, the number of distinct k-mers in the genome is estimated as <italic>n</italic> = 2<sup><italic>b</italic></sup><italic>s</italic>/<italic>v</italic>. For the population size <italic>m</italic> of all distinct k-mers in <italic>X</italic> and <italic>Y</italic> and the number of shared k-mers <italic>w</italic>, where:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ m=\left|X\cup Y\right|=\left|X\right|+\left|Y\right|-w $$\end{document}</tex-math><mml:math id="M28"><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="|" open="|"><mml:mrow><mml:mi>X</mml:mi><mml:mo>∪</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="|" open="|"><mml:mi>X</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close="|" open="|"><mml:mi>Y</mml:mi></mml:mfenced><mml:mo>−</mml:mo><mml:mi>w</mml:mi></mml:math><graphic xlink:href="13059_2016_997_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>the probability <italic>p</italic> of observing <italic>x</italic> or more matches between the sketches of these two genomes can be computed using the hypergeometric cumulative distribution function. For the sketch size <italic>s</italic>, shared size <italic>w</italic>, and population size <italic>m</italic>:<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ p\left(x;s;w;m\right)=1-{\displaystyle \sum_{i=0}^{x-1}}\frac{\left(\begin{array}{c}\hfill w\hfill \\ {}\hfill i\hfill \end{array}\right)\left(\begin{array}{c}\hfill m-w\hfill \\ {}\hfill s-i\hfill \end{array}\right)}{\left(\begin{array}{c}\hfill m\hfill \\ {}\hfill s\hfill \end{array}\right)} $$\end{document}</tex-math><mml:math id="M30"><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=";;;"><mml:mi>x</mml:mi><mml:mi>s</mml:mi><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover></mml:mstyle><mml:mfrac><mml:mrow><mml:mfenced close=")" open="("><mml:mtable columnalign="center"><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mi>w</mml:mi></mml:mtd></mml:mtr><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mi>i</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:mfenced close=")" open="("><mml:mtable columnalign="center"><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mi>w</mml:mi></mml:mtd></mml:mtr><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow><mml:mfenced close=")" open="("><mml:mtable columnalign="center"><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mi>m</mml:mi></mml:mtd></mml:mtr><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mi>s</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mfrac></mml:math><graphic xlink:href="13059_2016_997_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>However, because <italic>m</italic> is typically very large and the sketch size is relatively much smaller, it is more practical to approximate the hypergeometric distribution with the binomial distribution where the expected value of <inline-formula id="IEq9"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ r=\frac{w}{m} $$\end{document}</tex-math><mml:math id="M32"><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mspace width="0.12em"/><mml:mfrac><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2016_997_Article_IEq9.gif"/></alternatives></inline-formula> can be computed using Eq. <xref rid="Equ5" ref-type="">5</xref>:<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ p\left(x;s;r\right)=1-{\displaystyle \sum_{i=0}^{x-1}}\left(\begin{array}{c}\hfill s\hfill \\ {}\hfill i\hfill \end{array}\right){r}^i{\left(1-r\right)}^{s-i} $$\end{document}</tex-math><mml:math id="M34"><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=";;"><mml:mi>x</mml:mi><mml:mi>s</mml:mi><mml:mi>r</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover></mml:mstyle><mml:mfenced close=")" open="("><mml:mtable columnalign="center"><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mi>s</mml:mi></mml:mtd></mml:mtr><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mi>i</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:msup><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfenced><mml:mrow><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msup></mml:math><graphic xlink:href="13059_2016_997_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Mash uses Eq. <xref rid="Equ8" ref-type="">8</xref> to compute the <italic>P</italic> value of observing a given Mash distance (or less) under the null hypothesis that both genomes are random collections of k-mers. This equation does not account for compositional characteristics like GC bias, but it is useful in practice for ruling out clearly insignificant results (especially for small values of <italic>k</italic> and <italic>j</italic>). Interestingly, past work suggests that a random model of k-mer occurrence is not entirely unreasonable [<xref ref-type="bibr" rid="CR41">41</xref>]. Note, this <italic>P</italic> value only describes the significance of a single comparison and multiple testing must be considered when searching against a large database.</p>
    </sec>
    <sec id="Sec11">
      <title>RefSeq clustering</title>
      <p>By default, Mash uses 32-bit hashes for k-mers where |Σ|<sup><italic>k</italic></sup> ≤ 2<sup>32</sup> and 64-bit hashes for |Σ|<sup><italic>k</italic></sup> ≤ 2<sup>64</sup>. Thus, to minimize the resulting size of the all-RefSeq sketches, <italic>k</italic> = 16 was chosen along with a sketch size <italic>s</italic> = 400. While not ideal for large genomes (due to the small <italic>k</italic>) or highly divergent genomes (due to the small sketch), these parameters are well suited for determining species-level relationships between the microbial genomes that currently constitute the majority of RefSeq. For similar genomes (e.g. ANI &gt;95 %), sketches of a few hundred hashes are sufficient for basic clustering. As ANI drops further, the Jaccard index rapidly becomes very small and larger sketches are required for accurate estimates. Confidence bounds for the Jaccard estimate can be computed using the inverse cumulative distribution function for the hypergeometric or binomial distributions (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1). For example, with a sketch size of 400, two genomes with a true Jaccard index of 0.1 (<italic>x</italic> = 40) are very likely to have a Jaccard estimate between 0.075 and 0.125 (<italic>P</italic> &gt;0.9, binomial density for 30 ≤ <italic>x</italic> ≤ 50). For <italic>k</italic> = 16, this corresponds to a Mash distance between 0.12 and 0.09.</p>
      <p>RefSeq Complete release 70 was downloaded from NCBI FTP (<ext-link ext-link-type="uri" xlink:href="ftp://ftp.ncbi.nlm.nih.gov">ftp://ftp.ncbi.nlm.nih.gov</ext-link>). Using FASTA and Genbank records, replicons and contigs were grouped by organism using a combination of two-letter accession prefix, taxonomy ID, BioProject, BioSample, assembly ID, plasmid ID, and organism name fields to ensure distinct genomes were not combined. In rare cases this strategy resulted in over-separation due to database mislabeling. Plasmids and organelles were grouped with their corresponding nuclear genomes when available; otherwise they were kept as separate entries. Sequences assigned to each resulting “organism” group were combined into multi-FASTA files and chunked for easy parallelization. Each chunk was sketched with:</p>
      <p>mash sketch -s 400 -k 16 -f -o chunk *.fasta</p>
      <p>This required 26.1 CPU h on a heterogeneous cluster of AMD processors. (Note: option -f is not required in Mash v1.1.) The resulting, chunked sketch files were combined with the Mash <italic>paste</italic> function to create a single “refseq.msh” file containing all sketches. Each chunked sketch file was then compared against the combined sketch file, again in parallel, using:</p>
      <p>mash dist -t refseq.msh chunk.msh</p>
      <p>This required 6.9 CPU h to create pairwise distance tables for all chunks. The resulting chunk tables were concatenated and formatted to create a PHYLIP formatted distance table.</p>
      <p>For the ANI comparison, a subset of 500 Escherichia genomes was selected to present a range of distances yet bound the runtime of the comparatively expensive ANI computation. ANI was computed using the MUMmer v3.23 “dnadiff” program and extracting the 1-to-1 “AvgIdentity” field from the resulting report files [<xref ref-type="bibr" rid="CR49">49</xref>]. The corresponding Mash distances were taken from the all-vs-all distance table as described above.</p>
      <p>For the primate phylogeny, the FASTA files were sketched separately, in parallel, taking an average time of 8.9 min each and a maximum time of 11 min (Intel Xeon E5-4620 2.2 GHz processor and solid-state drive). The sketches were combined with Mash <italic>paste</italic> and the combined sketch given to <italic>dist</italic>. These operations took insignificant amounts of time, and table output from <italic>dist</italic> was given to PHYLIP v3.695 [<xref ref-type="bibr" rid="CR50">50</xref>] <italic>neighbor</italic> to produce the phylogeny. Accessions for all genomes used are given in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1. The UCSC tree was downloaded from [<xref ref-type="bibr" rid="CR51">51</xref>].</p>
    </sec>
    <sec id="Sec12">
      <title>RefSeq search</title>
      <p>Each dataset listed in Table <xref rid="Tab3" ref-type="table">3</xref> was compared against the full RefSeq Mash database using the following command for assemblies:</p>
      <p>mash dist refseq.msh seq.fasta</p>
      <p>and the following command for raw reads:</p>
      <p>mash dist -u refseq.msh seq.fasta</p>
      <p>which enabled the Bloom filter to remove erroneous, single-copy k-mers. (Note: option -u was replaced by -b in Mash v1.1.) Hits were sorted by distance and all hits within one order of magnitude of the most significant hit (<italic>P</italic> ≤10<sup>–10</sup>) were used to compute the lowest common ancestor using an NCBI taxonomy tree. The RefSeq genome with the smallest significant distance, with ties broken by <italic>P</italic> value, was also reported.</p>
    </sec>
    <sec id="Sec13">
      <title>Metagenomic clustering</title>
      <p>The Global Ocean Survey (GOS) dataset [<xref ref-type="bibr" rid="CR35">35</xref>] was downloaded from the iMicrobe FTP site (<ext-link ext-link-type="uri" xlink:href="ftp://ftp.imicrobe.us/projects/26">ftp://ftp.imicrobe.us/projects/26</ext-link>). The full dataset was split into 44 samples corresponding to Table <xref rid="Tab1" ref-type="table">1</xref> in Rusch et al. [<xref ref-type="bibr" rid="CR35">35</xref>]. This is the dataset used for benchmarking in the Compareads paper [<xref ref-type="bibr" rid="CR33">33</xref>] and that analysis was replicated using both Mash and COMMET [<xref ref-type="bibr" rid="CR34">34</xref>], the successor to Compareads. COMMET v24/07/2014 was run with default parameters (t = 2, m = all, k = 33) as:</p>
      <p>python Commet.py read_sets.txt</p>
      <p>where “read_sets.txt” points to the gzipped FASTQ files. This required 34 CPU h (2069 CPU min) and 4 GB of RAM. As suggested by COMMET’s author, samples were also truncated to contain the same number of reads to improve runtime (50,980 reads per sample, Nicolas Maillet, personal communication). On this reduced dataset COMMET required 10 CPU h (598 CPU min). The heatmaps were generated in R using the quartile coloring of COMMET [<xref ref-type="bibr" rid="CR34">34</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Note 2). Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S8 shows the original heatmap generated by COMMET on this dataset. Mash was run as:</p>
      <p>mash sketch -u -g 3500 -k 21 -s 10000 -o gos *.fa</p>
      <p>This required 0.6 CPU h (37 CPU min) and 19.6 GB of RAM with Bloom filtering or 8 MB without. (Note: options -u and -g were replaced by -b in Mash v1.1.) The resulting combined sketch file totaled just 3.4 MB in size, compared to the 20 GB FASTA input. Mash distances were computed for all pairs of samples as:</p>
      <p>mash dist -t gos.msh gos.msh</p>
      <p>which required less than 1 CPU s to complete.</p>
      <p>All available HMP and MetaHIT samples were downloaded: HMP reads [<xref ref-type="bibr" rid="CR52">52</xref>], HMP assemblies [<xref ref-type="bibr" rid="CR53">53</xref>], MetaHIT reads (ENA accession ERA000116), and MetaHIT assemblies [<xref ref-type="bibr" rid="CR54">54</xref>]. This totaled 764 sequencing runs (9.3 TB) and 755 assemblies (60 GB) for HMP and 124 sequencing runs (1.1 TB) and 124 assemblies (10 GB) for MetaHIT. Mash was run in parallel with the same parameters used for the GOS datasets and the resulting sketches merged with Mash <italic>paste</italic>. Sketching the 764 HMP sequencing runs required 259.5 CPU h (average 0.34, max 2.01) and the 755 assemblies required 3.7 CPU h (average 0.005). Sketching the 124 MetaHIT sequencing runs required 20 CPU h (average 0.16, max 0.62), and the 124 assemblies required 0.64 CPU h (average 0.005). COMMET was tested on three read sets (SAMN00038294, SAMN00146305, and SAMN00037421), which were smaller than the average HMP sample size and required an average of 655 CPU s per pairwise comparison. Thus, it was estimated to compare all 888<sup>2</sup> pairs of HMP and MetaHIT samples would require at least 143,471 CPU h. Mash distances were computed for all pairs of samples as before for GOS. This required 3.3 CPU min for both sequencing runs and assemblies. HMP samples that did not pass HMP QC requirements [<xref ref-type="bibr" rid="CR36">36</xref>] were removed from Fig. <xref rid="Fig5" ref-type="fig">5b</xref>, but Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S7 shows all HMP assemblies clustered, with several samples that did not pass HMP quality controls included. These samples are the only ones that fail to group by body site. Thus, Mash can also act as an alternate QC method to identify mis-tracked or low-quality samples.</p>
    </sec>
    <sec id="Sec14">
      <title>Mash engineering</title>
      <p>Mash builds upon the following open-source software packages: kseq [<xref ref-type="bibr" rid="CR55">55</xref>] for FASTA parsing, Cap’n Proto for serialized output [<xref ref-type="bibr" rid="CR56">56</xref>], MurmurHash3 for k-mer hashing [<xref ref-type="bibr" rid="CR57">57</xref>], GNU Scientific Library [<xref ref-type="bibr" rid="CR58">58</xref>] (GSL) for <italic>P</italic> value computation, and the Open Bloom Filter Library [<xref ref-type="bibr" rid="CR59">59</xref>]. All Mash code is licensed with a 3-clause BSD license. If needed, Mash can also be built using the Boost library [<xref ref-type="bibr" rid="CR60">60</xref>] to avoid the GSL (GPLv3) license requirements. Due to Cap’n Proto requirements, a C++11 compatible compiler is required to build from source, but precompiled binaries are distributed for convenience.</p>
    </sec>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec15">
        <title>Additional file</title>
        <p>
          <media position="anchor" xlink:href="13059_2016_997_MOESM1_ESM.pdf" id="MOESM1">
            <label>Additional file 1: Figure S1.</label>
            <caption>
              <p>Absolute and relative error bounds for Mash Jaccard estimates given various sketch sizes. <bold>Figure S2.</bold> Error bounds for Mash distance estimate using <italic>k</italic> = 16 and k = 21 and various sketch sizes. <bold>Figure S3.</bold> Effect of k-mer and genome size on the Mash distance. <bold>Figure S4.</bold> Eukaryotic components of the RefSeq clustering, colored by taxonomic order. <bold>Figure S5.</bold> Plasmid and organelle components of the RefSeq clustering, colored by taxonomic species. <bold>Figure S6.</bold> Mash tree from Fig. <xref rid="Fig4" ref-type="fig">4</xref> supplemented with five additional mammals. <bold>Figure S7.</bold> Mash clustering of all HMP and MetaHit sample assemblies. <bold>Figure S8.</bold> Raw COMMET output for the GOS dataset. Supplementary Note 1. Supporting data. Supplementary Note 2. Metagenomic heatmap R code. (PDF 8062 kb)</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank Konstantin Berlin, Ben Langmead, Michael Schatz, and Nicolas Maillet for their helpful suggestions; Brian Walenz and Torsten Seemann for reviewing the draft; Jiarong Guo, Sherine Awad, C. Titus Brown, and an anonymous referee for their constructive reviews; and Philip Ashton, Aleksey Jironkin, and Nicholas Loman for providing early feedback on the software.</p>
    <sec id="FPar1">
      <title>Funding</title>
      <p>This research was supported in part by the Intramural Research Program of the National Human Genome Research Institute, National Institutes of Health, and under Contract No. HSHQDC-07-C-00020 awarded by the Department of Homeland Security (DHS) Science and Technology Directorate (S&amp;T) for the management and operation of the National Biodefense Analysis and Countermeasures Center (NBACC), a Federally Funded Research and Development Center. The views and conclusions contained in this document are those of the authors and should not be interpreted as necessarily representing the official policies, either expressed or implied, of the DHS or S&amp;T. In no event shall the DHS, NBACC, S&amp;T, or Battelle National Biodefense Institute (BNBI) have any responsibility or liability for any use, misuse, inability to use, or reliance upon the information contained herein. DHS does not endorse any products or commercial services mentioned in this publication.</p>
    </sec>
    <sec id="FPar2">
      <title>Availability of data and materials</title>
      <p>Additional file <xref rid="MOESM1" ref-type="media">1</xref> is available with the online version of this paper. This file includes all supplementary figures, tables, and notes referenced in the manuscript. The Oxford Nanopore MinION runs for <italic>B. anthracis</italic> and <italic>B. cereus</italic> are available from the NCBI SRA repository under accessions SRR2671867 and SRR2671868, respectively. All experiments described here were run using Mash v1.0. Mash source code and precompiled binary releases are freely available from <ext-link ext-link-type="uri" xlink:href="https://github.com/marbl/mash">https://github.com/marbl/mash</ext-link> under a three-clause BSD license. Mash documentation and additional supporting data are available from <ext-link ext-link-type="uri" xlink:href="http://mash.readthedocs.org">http://mash.readthedocs.org</ext-link>. Mash is written in C++ and has been tested on Linux and Mac OS X.</p>
    </sec>
    <sec id="FPar3">
      <title>Authors’ contributions</title>
      <p>AMP conceived the project, designed the methods, and wrote the paper with input from BDO, TJT, SK, and PM. BDO wrote the software and assisted with analyses. TJT led the RefSeq and tree analyses. SK led the search and metagenomic analyses. ABM and NHB performed sequencing experiments. All authors read and approved the final manuscript.</p>
    </sec>
    <sec id="FPar4">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="FPar5">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="FPar6">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Gish</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Basic local alignment search tool</article-title>
        <source>J Mol Biol</source>
        <year>1990</year>
        <volume>215</volume>
        <fpage>403</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1016/S0022-2836(05)80360-2</pub-id>
        <?supplied-pmid 2231712?>
        <pub-id pub-id-type="pmid">2231712</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">GenBank and WGS Statistics. <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/genbank/statistics">http://www.ncbi.nlm.nih.gov/genbank/statistics</ext-link>. Accessed 31 May 2016.</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stephens</surname>
            <given-names>ZD</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>SY</given-names>
          </name>
          <name>
            <surname>Faghri</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>RH</given-names>
          </name>
          <name>
            <surname>Zhai</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Efron</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Big data: astronomical or genomical?</article-title>
        <source>PLoS Biol</source>
        <year>2015</year>
        <volume>13</volume>
        <fpage>e1002195</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pbio.1002195</pub-id>
        <?supplied-pmid 26151137?>
        <pub-id pub-id-type="pmid">26151137</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Broder AZ. On the resemblance and containment of documents. Compression and Complexity of Sequences 1997 - Proceedings 1998:21–29.</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Indyk P, Motwani R. Approximate nearest neighbors: towards removing the curse of dimensionality. In: Proceedings of the Thirtieth Annual ACM Symposium on Theory of Computing. Dallas, TX: ACM; 1998.</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Broder</surname>
            <given-names>AZ</given-names>
          </name>
        </person-group>
        <article-title>Identifying and filtering near-duplicate documents</article-title>
        <source>COM ’00 Proceedings of the 11th Annual Symposium on Combinatorial Pattern Matching</source>
        <year>2000</year>
        <publisher-loc>London</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <fpage>1</fpage>
        <lpage>10</lpage>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Chum O, Philbin J, Zisserman A. Near Duplicate Image Detection: min-Hash and tf-idf Weighting. In: Proceedings of the British Machine Vision Conference 2008. Durham, UK: British Machine Vision Association and Society for Pattern Recognition; 2008.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Narayanan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Karp</surname>
            <given-names>RM</given-names>
          </name>
        </person-group>
        <article-title>Gapped local similarity search with provable guarantees</article-title>
        <source>Algorithms in Bioinformatics, Proceedings</source>
        <year>2004</year>
        <volume>3240</volume>
        <fpage>74</fpage>
        <lpage>86</lpage>
        <pub-id pub-id-type="doi">10.1007/978-3-540-30219-3_7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berlin</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chin</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>Drake</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Landolin</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Assembling large genomes with single-molecule sequencing and locality-sensitive hashing</article-title>
        <source>Nat Biotechnol</source>
        <year>2015</year>
        <volume>33</volume>
        <fpage>623</fpage>
        <lpage>30</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3238</pub-id>
        <?supplied-pmid 26006009?>
        <pub-id pub-id-type="pmid">26006009</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zola</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Aluru</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Parallel metagenomic sequence clustering via sketching and maximal quasi-clique enumeration on map-reduce clouds</article-title>
        <source>Parallel &amp; Distributed Processing Symposium (IPDPS), 2011 IEEE International. IEEE</source>
        <year>2011</year>
        <fpage>1223</fpage>
        <lpage>1233</lpage>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Drew</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hahsler</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Strand: fast sequence comparison using mapreduce and locality sensitive hashing</article-title>
        <source>Proceedings of the 5th ACM Conference on Bioinformatics, Computational Biology, and Health Informatics</source>
        <year>2014</year>
        <publisher-loc>Newport Beach, CA</publisher-loc>
        <publisher-name>ACM</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Rasheed</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Rangwala</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A Map-Reduce Framework for Clustering Metagenomes</article-title>
        <source>2013 IEEE International Symposium on Parallel &amp; Distributed Processing, Workshops and Phd Forum: IEEE</source>
        <year>2013</year>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vinga</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Almeida</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Alignment-free sequence comparison-a review</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>513</fpage>
        <lpage>23</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btg005</pub-id>
        <?supplied-pmid 12611807?>
        <pub-id pub-id-type="pmid">12611807</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haubold</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Alignment-free phylogenetics and population genetics</article-title>
        <source>Brief Bioinform</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>407</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbt083</pub-id>
        <?supplied-pmid 24291823?>
        <pub-id pub-id-type="pmid">24291823</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blaisdell</surname>
            <given-names>BE</given-names>
          </name>
        </person-group>
        <article-title>A measure of the similarity of sets of sequences not requiring sequence alignment</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>1986</year>
        <volume>83</volume>
        <fpage>5155</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.83.14.5155</pub-id>
        <?supplied-pmid 3460087?>
        <pub-id pub-id-type="pmid">3460087</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Torney</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Burks</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Davison</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sirotkin</surname>
            <given-names>KM</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Bell</surname>
            <given-names>GI</given-names>
          </name>
          <name>
            <surname>Marr</surname>
            <given-names>TG</given-names>
          </name>
        </person-group>
        <article-title>Computation of d2: a measure of sequence dissimilarity</article-title>
        <source>Computers and DNA: the proceedings of the Interface between Computation Science and Nucleic Acid Sequencing Workshop, held December 12 to 16, 1988 in Santa Fe, New Mexico</source>
        <year>1990</year>
        <publisher-loc>Redwood City</publisher-loc>
        <publisher-name>Addison-Wesley Pub. Co</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lippert</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Waterman</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>Distributional regimes for the number of k-word matches between two random sequences</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2002</year>
        <volume>99</volume>
        <fpage>13980</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.202468099</pub-id>
        <?supplied-pmid 12374863?>
        <pub-id pub-id-type="pmid">12374863</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Performance comparison between k-tuple distance and four model-based distances in phylogenetic tree reconstruction</article-title>
        <source>Nucleic Acids Res</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>e33</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkn075</pub-id>
        <?supplied-pmid 18296485?>
        <pub-id pub-id-type="pmid">18296485</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deloger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>El Karoui</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Petit</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>A genomic distance based on MUM indicates discontinuity between most bacterial species and genera</article-title>
        <source>J Bacteriol</source>
        <year>2009</year>
        <volume>191</volume>
        <fpage>91</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1128/JB.01202-08</pub-id>
        <?supplied-pmid 18978054?>
        <pub-id pub-id-type="pmid">18978054</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yi</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Co-phylog: an assembly-free phylogenomic approach for closely related organisms</article-title>
        <source>Nucleic Acids Res</source>
        <year>2013</year>
        <volume>41</volume>
        <fpage>e75</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt003</pub-id>
        <?supplied-pmid 23335788?>
        <pub-id pub-id-type="pmid">23335788</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haubold</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Klotzl</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Pfaffelhuber</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>andi: fast and accurate estimation of evolutionary distances between closely related genomes</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>1169</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu815</pub-id>
        <?supplied-pmid 25504847?>
        <pub-id pub-id-type="pmid">25504847</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fan</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ives</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Surget-Groba</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Cannon</surname>
            <given-names>CH</given-names>
          </name>
        </person-group>
        <article-title>An assembly and alignment-free method of phylogeny reconstruction from next-generation sequencing data</article-title>
        <source>BMC Genomics</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>522</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-015-1647-5</pub-id>
        <?supplied-pmid 26169061?>
        <pub-id pub-id-type="pmid">26169061</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Konstantinidis</surname>
            <given-names>KT</given-names>
          </name>
          <name>
            <surname>Tiedje</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Genomic insights that advance the species definition for prokaryotes</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2005</year>
        <volume>102</volume>
        <fpage>2567</fpage>
        <lpage>72</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0409727102</pub-id>
        <?supplied-pmid 15701695?>
        <pub-id pub-id-type="pmid">15701695</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schatz</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>The rise of a digital immune system</article-title>
        <source>Gigascience</source>
        <year>2012</year>
        <volume>1</volume>
        <fpage>4</fpage>
        <pub-id pub-id-type="doi">10.1186/2047-217X-1-4</pub-id>
        <?supplied-pmid 23587178?>
        <pub-id pub-id-type="pmid">23587178</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pruitt</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Tatusova</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Maglott</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>NCBI Reference Sequences (RefSeq): current status, new features and genome annotation policy</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>D130</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr1079</pub-id>
        <?supplied-pmid 22121212?>
        <pub-id pub-id-type="pmid">22121212</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saitou</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Nei</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The neighbor-joining method: a new method for reconstructing phylogenetic trees</article-title>
        <source>Mol Biol Evol</source>
        <year>1987</year>
        <volume>4</volume>
        <fpage>406</fpage>
        <lpage>25</lpage>
        <?supplied-pmid 3447015?>
        <pub-id pub-id-type="pmid">3447015</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Rosenbloom</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hardison</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Hou</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Raney</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>28-way vertebrate alignment and conservation track in the UCSC Genome Browser</article-title>
        <source>Genome Res</source>
        <year>2007</year>
        <volume>17</volume>
        <fpage>1797</fpage>
        <lpage>808</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.6761107</pub-id>
        <?supplied-pmid 17984227?>
        <pub-id pub-id-type="pmid">17984227</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Perelman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>WE</given-names>
          </name>
          <name>
            <surname>Roos</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Seuanez</surname>
            <given-names>HN</given-names>
          </name>
          <name>
            <surname>Horvath</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Moreira</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A molecular phylogeny of living primates</article-title>
        <source>PLoS Genet</source>
        <year>2011</year>
        <volume>7</volume>
        <fpage>e1001342</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1001342</pub-id>
        <?supplied-pmid 21436896?>
        <pub-id pub-id-type="pmid">21436896</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuhner</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Felsenstein</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A simulation comparison of phylogeny algorithms under equal and unequal evolutionary rates</article-title>
        <source>Mol Biol Evol</source>
        <year>1994</year>
        <volume>11</volume>
        <fpage>459</fpage>
        <lpage>68</lpage>
        <?supplied-pmid 8015439?>
        <pub-id pub-id-type="pmid">8015439</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loman</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Quick</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Simpson</surname>
            <given-names>JT</given-names>
          </name>
        </person-group>
        <article-title>A complete bacterial genome assembled de novo using only nanopore sequencing data</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>733</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3444</pub-id>
        <?supplied-pmid 26076426?>
        <pub-id pub-id-type="pmid">26076426</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Song</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Florea</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Lighter: fast and memory-efficient sequencing error correction without counting</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>509</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0509-9</pub-id>
        <?supplied-pmid 25398208?>
        <pub-id pub-id-type="pmid">25398208</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Seth</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Valimaki</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Kaski</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Honkela</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Exploration and retrieval of whole-metagenome sequencing samples</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>2471</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu340</pub-id>
        <?supplied-pmid 24845653?>
        <pub-id pub-id-type="pmid">24845653</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maillet</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Lemaitre</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chikhi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lavenier</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Peterlongo</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Compareads: comparing huge metagenomic experiments</article-title>
        <source>BMC Bioinformatics</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>Suppl 19</issue>
        <fpage>S10</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-13-S19-S10</pub-id>
        <?supplied-pmid 23282463?>
        <pub-id pub-id-type="pmid">23282463</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Maillet</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Collet</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Vannier</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Lavenier</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Peterlongo</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>COMMET: comparing and combining multiple metagenomic datasets</article-title>
        <source>2014 IEEE International Conference on Bioinformatics and Biomedicine (BIBM): IEEE</source>
        <year>2014</year>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rusch</surname>
            <given-names>DB</given-names>
          </name>
          <name>
            <surname>Halpern</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Sutton</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Heidelberg</surname>
            <given-names>KB</given-names>
          </name>
          <name>
            <surname>Williamson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yooseph</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Sorcerer II Global Ocean Sampling expedition: northwest Atlantic through eastern tropical Pacific</article-title>
        <source>PLoS Biol</source>
        <year>2007</year>
        <volume>5</volume>
        <fpage>e77</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pbio.0050077</pub-id>
        <?supplied-pmid 17355176?>
        <pub-id pub-id-type="pmid">17355176</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Human Microbiome Project C</collab>
        </person-group>
        <article-title>Structure, function and diversity of the healthy human microbiome</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>486</volume>
        <fpage>207</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11234</pub-id>
        <pub-id pub-id-type="pmid">22699609</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Raes</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Arumugam</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Burgdorf</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Manichanh</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A human gut microbial gene catalogue established by metagenomic sequencing</article-title>
        <source>Nature</source>
        <year>2010</year>
        <volume>464</volume>
        <fpage>59</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1038/nature08821</pub-id>
        <?supplied-pmid 20203603?>
        <pub-id pub-id-type="pmid">20203603</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Freedman</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Nissim</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Pinkas</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Efficient private matching and set intersection</article-title>
        <source>Advances in Cryptology - Eurocrypt 2004, Proceedings</source>
        <year>2004</year>
        <volume>3027</volume>
        <fpage>1</fpage>
        <lpage>19</lpage>
        <pub-id pub-id-type="doi">10.1007/978-3-540-24676-3_1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>De Cristofaro</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Faber</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gasti</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Tsudik</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Genodroid: are privacy-preserving genomic tests ready for prime time?</article-title>
        <source>Proceedings of the 2012 ACM workshop on Privacy in the electronic society</source>
        <year>2012</year>
        <publisher-loc>Raleigh, NC</publisher-loc>
        <publisher-name>ACM</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Solomon</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kingsford</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Large-scale search of transcriptomic read sets with sequence bloom trees</article-title>
        <source>bioRxiv</source>
        <year>2015</year>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fofanov</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Katili</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Belosludtsev</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Powdrill</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>How independent are the appearances of n-mers in different genomes?</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>2421</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bth266</pub-id>
        <?supplied-pmid 15087315?>
        <pub-id pub-id-type="pmid">15087315</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roberts</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Hunt</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Mount</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Yorke</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Reducing storage requirements for biological sequence comparison</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>3363</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bth408</pub-id>
        <?supplied-pmid 15256412?>
        <pub-id pub-id-type="pmid">15256412</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roberts</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hunt</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Yorke</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Bolanos</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Delcher</surname>
            <given-names>AL</given-names>
          </name>
        </person-group>
        <article-title>A preprocessor for shotgun assembly of large genomes</article-title>
        <source>J Comput Biol</source>
        <year>2004</year>
        <volume>11</volume>
        <fpage>734</fpage>
        <lpage>52</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2004.11.734</pub-id>
        <?supplied-pmid 15579242?>
        <pub-id pub-id-type="pmid">15579242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deorowicz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kokot</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Grabowski</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Debudaj-Grabysz</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>KMC 2: fast and resource-frugal k-mer counting</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>1569</fpage>
        <lpage>76</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv022</pub-id>
        <?supplied-pmid 25609798?>
        <pub-id pub-id-type="pmid">25609798</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wood</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Kraken: ultrafast metagenomic sequence classification using exact alignments</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>R46</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2014-15-3-r46</pub-id>
        <?supplied-pmid 24580807?>
        <pub-id pub-id-type="pmid">24580807</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patrascu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Thorup</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The power of simple tabulation hashing</article-title>
        <source>J ACM</source>
        <year>2012</year>
        <volume>59</volume>
        <fpage>14</fpage>
        <pub-id pub-id-type="doi">10.1145/2220357.2220361</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ukkonen</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Approximate string-matching with Q-grams and maximal matches</article-title>
        <source>Theor Comput Sci</source>
        <year>1992</year>
        <volume>92</volume>
        <fpage>191</fpage>
        <lpage>211</lpage>
        <pub-id pub-id-type="doi">10.1016/0304-3975(92)90143-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <mixed-citation publication-type="other">Bar-Yossef Z, Jayram TS, Kumar R, Sivakumar D, Trevisan L. Counting distinct elements in a data stream. In: Proceedings of the 6th International Workshop on Randomization and Approximation Techniques. Springer-Verlag; 2002. p. 1–10.</mixed-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Schatz</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Genome assembly forensics: finding the elusive mis-assembly</article-title>
        <source>Genome Biol</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>R55</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2008-9-3-r55</pub-id>
        <?supplied-pmid 18341692?>
        <pub-id pub-id-type="pmid">18341692</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Felsenstein</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>PHYLIP - Phylogeny Inference Package (Version 3.2)</article-title>
        <source>Cladistics</source>
        <year>1989</year>
        <volume>5</volume>
        <fpage>164</fpage>
        <lpage>6</lpage>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <mixed-citation publication-type="other">UCSC multiz20way. <ext-link ext-link-type="uri" xlink:href="http://hgdownload.cse.ucsc.edu/goldenPath/hg38/multiz20way/">http://hgdownload.cse.ucsc.edu/goldenPath/hg38/multiz20way/</ext-link>. Accessed 31 May 2016.</mixed-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <mixed-citation publication-type="other">HMP Illumina WGS Reads. <ext-link ext-link-type="uri" xlink:href="http://hmpdacc.org/HMIWGS/all/">http://hmpdacc.org/HMIWGS/all/</ext-link>. Accessed 31 May 2016.</mixed-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <mixed-citation publication-type="other">HMP Illumina WGS Assemblies. <ext-link ext-link-type="uri" xlink:href="http://hmpdacc.org/HMASM/all/">http://hmpdacc.org/HMASM/all/</ext-link>. Accessed 31 May 2016.</mixed-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <mixed-citation publication-type="other">MetaHIT assemblies. <ext-link ext-link-type="uri" xlink:href="http://www.bork.embl.de/~arumugam/Qin_et_al_2010/">http://www.bork.embl.de/~arumugam/Qin_et_al_2010/</ext-link>. Accessed 31 May 2016.</mixed-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1754</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp324</pub-id>
        <?supplied-pmid 19451168?>
        <pub-id pub-id-type="pmid">19451168</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <mixed-citation publication-type="other">Cap’n Proto. <ext-link ext-link-type="uri" xlink:href="https://capnproto.org/">https://capnproto.org</ext-link>. Accessed 31 May 2016.</mixed-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <mixed-citation publication-type="other">MurmurHash3. <ext-link ext-link-type="uri" xlink:href="https://code.google.com/p/smhasher">https://code.google.com/p/smhasher</ext-link>. Accessed 31 May 2016.</mixed-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Gough</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <source>GNU scientific library reference manual</source>
        <year>2009</year>
        <publisher-loc>Godalming</publisher-loc>
        <publisher-name>Network Theory Ltd.</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <mixed-citation publication-type="other">Open Bloom Filter Library. <ext-link ext-link-type="uri" xlink:href="https://code.google.com/p/bloom">https://code.google.com/p/bloom</ext-link>. Accessed 31 May 2016.</mixed-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Siek</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>L-Q</given-names>
          </name>
          <name>
            <surname>Lumsdaine</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <source>The Boost Graph Library: User Guide and Reference Manual</source>
        <year>2001</year>
        <publisher-loc>New York, NY</publisher-loc>
        <publisher-name>Pearson Education</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shannon</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Markiel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ozier</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Baliga</surname>
            <given-names>NS</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Ramage</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cytoscape: a software environment for integrated models of biomolecular interaction networks</article-title>
        <source>Genome Res</source>
        <year>2003</year>
        <volume>13</volume>
        <fpage>2498</fpage>
        <lpage>504</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.1239303</pub-id>
        <?supplied-pmid 14597658?>
        <pub-id pub-id-type="pmid">14597658</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kamada</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kawai</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>An algorithm for drawing general undirected graphs</article-title>
        <source>Inform Process Lett</source>
        <year>1989</year>
        <volume>31</volume>
        <fpage>7</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1016/0020-0190(89)90102-6</pub-id>
      </element-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bankevich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nurk</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Antipov</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gurevich</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Dvorkin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kulikov</surname>
            <given-names>AS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SPAdes: a new genome assembly algorithm and its applications to single-cell sequencing</article-title>
        <source>J Comput Biol</source>
        <year>2012</year>
        <volume>19</volume>
        <fpage>455</fpage>
        <lpage>77</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2012.0021</pub-id>
        <?supplied-pmid 22506599?>
        <pub-id pub-id-type="pmid">22506599</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
