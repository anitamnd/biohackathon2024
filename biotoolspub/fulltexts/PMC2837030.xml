<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2837030</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-11-89</article-id>
    <article-id pub-id-type="pmid">20158924</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-11-89</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Detection of distant evolutionary relationships between protein families using theory of sequence profile-profile comparison</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="A1">
        <name>
          <surname>Margelevičius</surname>
          <given-names>Mindaugas</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>minmar@ibt.lt</email>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="A2">
        <name>
          <surname>Venclovas</surname>
          <given-names>Česlovas</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>venclovas@ibt.lt</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Institute of Biotechnology, Graičiūno 8, LT-02241 Vilnius, Lithuania</aff>
    <pub-date pub-type="collection">
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>2</month>
      <year>2010</year>
    </pub-date>
    <volume>11</volume>
    <fpage>89</fpage>
    <lpage>89</lpage>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>8</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>2</month>
        <year>2010</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright ©2010 Margelevičius and Venclovas; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2010</copyright-year>
      <copyright-holder>Margelevičius and Venclovas; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1471-2105/11/89"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Detection of common evolutionary origin (homology) is a primary means of inferring protein structure and function. At present, comparison of protein families represented as sequence profiles is arguably the most effective homology detection strategy. However, finding the best way to represent evolutionary information of a protein sequence family in the profile, to compare profiles and to estimate the biological significance of such comparisons, remains an active area of research.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>Here, we present a new homology detection method based on sequence profile-profile comparison. The method has a number of new features including position-dependent gap penalties and a global score system. Position-dependent gap penalties provide a more biologically relevant way to represent and align protein families as sequence profiles. The global score system enables an analytical solution of the statistical parameters needed to estimate the statistical significance of profile-profile similarities. The new method, together with other state-of-the-art profile-based methods (HHsearch, COMPASS and PSI-BLAST), is benchmarked in all-against-all comparison of a challenging set of SCOP domains that share at most 20% sequence identity. For benchmarking, we use a reference ("gold standard") free model-based evaluation framework. Evaluation results show that at the level of protein domains our method compares favorably to all other tested methods. We also provide examples of the new method outperforming structure-based similarity detection and alignment. The implementation of the new method both as a standalone software package and as a web server is available at <ext-link ext-link-type="uri" xlink:href="http://www.ibt.lt/bioinformatics/coma">http://www.ibt.lt/bioinformatics/coma</ext-link>.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>Due to a number of developments, the new profile-profile comparison method shows an improved ability to match distantly related protein domains. Therefore, the method should be useful for annotation and homology modeling of uncharacterized proteins.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Common evolutionary origin or homology is one of the key concepts in biology. Homologous proteins usually share similar three-dimensional shape and often perform identical or similar molecular functions. Therefore, detection of homology is now routinely used to make inferences regarding structure, function or evolution for the protein of interest. Protein sequence comparison is the primary means for establishing homology. For closely related proteins, sequence similarity can be detected even by an untrained eye, however, the similarity becomes weak and difficult to distinguish from random as the evolutionary distance increases. In many cases not until three-dimensional structures become available the homology between proteins can be established.</p>
    <p>Comparison of multiple sequence alignments instead of individual sequences can often facilitate inference of remote homology relationships. This should not be surprising, because in contrast to a single sequence, a set of aligned related sequences can tell much more about the conservation (functional or structural importance) of individual positions or regions within the polypeptide chain. For homology detection, multiple sequence alignments are generally converted into either of the two numerical forms: position-specific sequence profiles or Hidden Markov Models (HMMs) [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B7">7</xref>]. The main difference between the traditional sequence profile and HMM is that the latter incorporates position-specific insertion and deletion probabilities.</p>
    <p>At present, profile-profile or HMM-HMM comparison represents arguably the most sensitive remote homology detection strategy. Although over the years profile-profile (HMM-HMM) comparison methods have improved significantly, they still lag behind methods based on protein structure comparison. On the other hand, there are a number of areas for potential improvement of such methods, including the way profiles (HMMs) are constructed, profile (HMM) similarity is scored and statistical significance of that score is estimated. For example, fixed gap opening and extension penalties, traditionally used in profile comparisons, is a poor representation of protein evolution. Thus, introduction of position-dependent variable gap penalties might be expected to lead to considerable improvement of profile-based methods. Further development of statistical framework is another promising area of improvement for both profile and HMM-based methods.</p>
    <p>Here, we present COMA (<bold>C</bold>omparison <bold>O</bold>f <bold>M</bold>ultiple <bold>A</bold>lignments), a new profile-profile search and comparison method that has a number of novel features. However, the two features that distinguish COMA from other profile-profile comparison methods most, are position-dependent gap penalties and a global score system, which enables analytical solution of the statistical parameters used in estimation of the significance of a match. We show that at the protein domain level COMA performs better than several other state-of-the art homology detection methods.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <p>Methods that aim to detect relationship between protein families by comparing corresponding sequence profiles include three main components: 1) profile construction algorithm, 2) logic for profile comparison and 3) estimation of statistical significance of the profile-profile alignment score. In this section we describe underlying theoretical considerations and their implementation in COMA.</p>
    <sec>
      <title>Profile construction</title>
      <p>Multiple sequence alignments are converted into profiles similarly as in PSI-BLAST [<xref ref-type="bibr" rid="B8">8</xref>], but with new additions and modifications as described below.</p>
      <sec>
        <title>Filtering of high and low complexity regions</title>
        <p>Sometimes multiple sequence alignments have stretches of positions (columns) with highly divergent residue distribution, which means that the expected occurrence for nearly all residue types is about the same. These stretches, defined here as high complexity regions, often indicate either misaligned or structurally unrelated sequence regions and may negatively affect subsequent comparison of profiles. Comparison problems may also be caused by multiple alignment regions of low compositional complexity. These may include groups of columns with short periodic repeats or very similar residue distributions and often correspond to unstructured regions of aligned sequences. To deal with both extremes of compositional complexity, the SEG algorithm [<xref ref-type="bibr" rid="B9">9</xref>] has been modified and adopted to work with multiple alignments and profile positional vectors. By default, COMA uses the modified SEG for filtering high complexity regions prior to the construction of a sequence profile. Optionally, low complexity regions can be filtered as well.</p>
      </sec>
      <sec>
        <title>Sequence weighting</title>
        <p>As in PSI-BLAST, sequence weights are computed from the reduced multiple alignment that is compiled for every position of the input multiple alignment. However, in contrast to PSI-BLAST, sequences from the multiple alignment are included into the reduced multiple alignment only if the residues contributing to the corresponding position are not at the sequence termini. This is important, because in some cases, the reduced multiple alignment may consist of only a single column, leading to the assignment of incorrect sequence weights and subsequently to a dramatic deterioration of the overall performance in profile comparisons. In COMA, more stringent requirements for reduced multiple alignments help to avoid such situations. After reduced multiple alignments are compiled, sequence weights are calculated by the modified Henikoff &amp; Henikoff sequence weighting algorithm [<xref ref-type="bibr" rid="B10">10</xref>].</p>
      </sec>
      <sec>
        <title>Initial scores and probabilities</title>
        <p>Profile scores are calculated using an initial score table such as that from BLOSUM [<xref ref-type="bibr" rid="B11">11</xref>] or PAM [<xref ref-type="bibr" rid="B12">12</xref>] series. Here, we use a newly derived initial score table, constructed from multiple alignments obtained for ASTRAL [<xref ref-type="bibr" rid="B13">13</xref>] sequences. The table is derived using a method similar to that of Henikoff &amp; Henikoff [<xref ref-type="bibr" rid="B11">11</xref>] and can be easily recalculated for a different set of multiple sequence alignments. Residue substitution frequencies and background probabilities derived from the initial score table are used to compute target probabilities (estimated frequencies of each residue at a given profile position) using the Tatusov pseudo count method [<xref ref-type="bibr" rid="B14">14</xref>].</p>
      </sec>
      <sec>
        <title>Composition-based statistics</title>
        <p>The alignment score obtained using explicitly defined score table is related to its statistical significance [<xref ref-type="bibr" rid="B15">15</xref>]. Thus, each score table used for generating alignments can be characterized by the statistical parameters of the score distribution [<xref ref-type="bibr" rid="B16">16</xref>]. In COMA, the computed statistical parameter values for the initial score table are used for composition-based statistics [<xref ref-type="bibr" rid="B17">17</xref>]. Once a profile is constructed, it is compositionally adjusted to have statistical parameter values equal to those of the initial score table. Such a compositional adjustment is needed to normalize profile scores so that alignment scores would follow the reference distribution.</p>
      </sec>
      <sec>
        <title>Deletions and insertions</title>
        <p>Comparison of profiles in many cases is bound to produce gapped alignments. Therefore, an accurate estimation of insertion and deletion probabilities at every profile position is a significant factor that affects alignment quality. Currently, profile-based methods such as PSI-BLAST [<xref ref-type="bibr" rid="B8">8</xref>] and COMPASS [<xref ref-type="bibr" rid="B5">5</xref>] use constant gap penalties, but that is a poor approximation of evolution of protein families. In COMA, insertion and deletion probabilities are allowed to vary along the length of the sequence profile. Deletion is defined as gap(s) in a sequence aligned against the residue(s) in another sequence, while insertion corresponds to residue(s) aligned against the gap(s). The probability of a deletion at the position <italic>i </italic>of the multiple alignment is expressed as 1-Σ<sub><italic>a</italic></sub><italic>f</italic><sub><italic>a</italic></sub>, where <italic>f</italic><sub><italic>a </italic></sub>is the weighted observed frequency, calculated for the residue <italic>a </italic>at the position <italic>i</italic>. An exhaustive analysis of 4611 profiles showed that deletion probabilities can be accurately approximated linearly. Thus the generalized probability of a deletion at the profile position <italic>i </italic>is described by the linear function whose slope and intercept are determined from the probability values at the boundary positions of the deletion. The probability of an insertion at the profile position <italic>i </italic>is defined as the weighted observed frequency for the gap (<italic>f</italic><sub>-</sub>) at the profile position <italic>i</italic>. Since the insertion always corresponds to a residue, which occupies a profile position, no generalization of probabilities of insertions is needed.</p>
      </sec>
    </sec>
    <sec>
      <title>Profile-profile comparison</title>
      <p>In COMA, a pair of profiles is aligned using a modified Smith-Waterman dynamic programming algorithm [<xref ref-type="bibr" rid="B18">18</xref>], the score system and the position-dependent variable gap cost scheme.</p>
      <sec>
        <title>Score system</title>
        <p>The score <italic>s</italic><sub><italic>ia </italic></sub>of the residue <italic>a </italic>at the profile position <italic>i </italic>is defined as <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i1.gif"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i2.gif"/></inline-formula> is the target probability of the residue <italic>a </italic>at the profile position <italic>i, p</italic><sub><italic>a </italic></sub>is the background probability of the residue <italic>a, λ</italic><sub><italic>p </italic></sub>is the reference statistical parameter of ungapped alignments of protein sequences such that the target probabilities <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i2.gif"/></inline-formula> sum to 1 [<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B16">16</xref>].</p>
        <p>Similar log-odds principle is used to construct a score system for a pair of profiles. An individual profile is the score table constructed for a single sequence using the processed information from the multiple alignment. The information from the multiple alignment is in part expressed with the weighted observed frequencies <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i3.gif"/></inline-formula> for the residue of type <italic>a </italic>at profile positions <italic>i</italic>. Weighted observed frequencies are important measures of positional conservation and are also used to derive the target probabilities <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i2.gif"/></inline-formula>. Thus, we use both profile quantities (<inline-formula><inline-graphic xlink:href="1471-2105-11-89-i3.gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i2.gif"/></inline-formula>) to define the target probabilities when comparing a pair of profiles. Let <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i2.gif"/></inline-formula> denote the target probability of the residue <italic>a </italic>at the profile position <italic>i </italic>of the first profile, and <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i4.gif"/></inline-formula> the corresponding target probability at the profile position <italic>j </italic>of the second profile. Let <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i3.gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i5.gif"/></inline-formula> be the observed frequencies of the residue <italic>a </italic>at the profile positions <italic>i </italic>and <italic>j </italic>of the first and second profile, respectively. We say that two positions <italic>i </italic>and <italic>j </italic>of two distinct profiles are more similar if the probability odds ratio <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i6.gif"/></inline-formula> is greater. The score <italic>s</italic><sub><italic>ij </italic></sub>of matching the position <italic>i </italic>of the first profile with the position <italic>j </italic>of the second profile is calculated as follows:<disp-formula id="bmcM1"><label>(1)</label><graphic xlink:href="1471-2105-11-89-i7.gif"/></disp-formula></p>
        <p>where <italic>N </italic>is the normalizing term such that the background probabilities for a pair of profiles sum to 1:<disp-formula id="bmcM2"><label>(2)</label><graphic xlink:href="1471-2105-11-89-i8.gif"/></disp-formula></p>
        <p><italic>λ </italic>in Equation 1 is a statistical parameter of profile-to-profile ungapped alignments such that the target probabilities of a pair of profiles (numerator of the odds in Equation 1) sum to 1:<disp-formula id="bmcM3"><label>(3)</label><graphic xlink:href="1471-2105-11-89-i9.gif"/></disp-formula></p>
        <p>where <italic>p</italic>(<italic>s</italic><sub><italic>ij</italic></sub>) is the background probability for a pair of profiles or, in other words, probability of the score <italic>s</italic><sub><italic>ij</italic></sub>, <italic>s</italic><sub><italic>k </italic></sub>are the discrete values of <italic>s</italic><sub><italic>ij </italic></sub>and<disp-formula id="bmcM4"><label>(4)</label><graphic xlink:href="1471-2105-11-89-i10.gif"/></disp-formula></p>
        <p>Having all terms defined, we can express the score <italic>s</italic><sub><italic>ij </italic></sub>from Equation 1 as follows:<disp-formula id="bmcM5"><label>(5)</label><graphic xlink:href="1471-2105-11-89-i11.gif"/></disp-formula></p>
        <p>Note that the statistical parameter <italic>λ </italic>is solved from the Equation 3 using the background probabilities in Equation 4 so that the target probabilities for a pair of profiles in Equation 1 sum to 1. To solve Equation 3, scores <italic>s</italic><sub><italic>ij </italic></sub>are multiplied by 2<sup><italic>c </italic></sup>(to rescue a precision of <italic>c </italic>bits) and rounded to the nearest integer value.</p>
      </sec>
      <sec>
        <title>Correction of scores</title>
        <p>Multiple sequence alignments, from which profiles are constructed, may carry very different amounts of evolutionary information. For example, the information extracted in one case from three and in other case from three hundred aligned diverse sequences cannot be considered to have the same value. Thus before the final alignment of a pair of profiles, assuming that probabilities do not change, scores <italic>s</italic><sub><italic>ij </italic></sub>are corrected as follows:<disp-formula id="bmcM6"><label>(6)</label><graphic xlink:href="1471-2105-11-89-i12.gif"/></disp-formula></p>
        <p>where <italic>t</italic><sup>(<italic>i</italic>) </sup>and <italic>t'</italic><sup>(<italic>j</italic>) </sup>are the effective number of sequences comprising a reduced multiple alignment at the profile position <italic>i </italic>of the first profile and position <italic>j </italic>of the second profile, respectively. Since the limit of the sum <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i14.gif"/></inline-formula> is 2, the corresponding constant is introduced in the numerator of Equation 6 to keep both the corrected and original scores in a similar range. The parameter <italic>λ </italic>in Equation 6 is now solved from Equation 3 so that the corrected target probabilities of a pair of profiles sum to 1. Using the correction scheme (Equation 6), the profile scores obtained from a "thin" alignment are down-weighted in comparison to the scores from a "thick" alignment. In the general case the scores of the "thin" profile are averaged over the observed weighted frequencies of the "thick" profile using higher weights, while the scores of the "thick" profile are averaged over the corresponding frequencies of the "thin" profile using lower weights. If one of the two profiles, say the first, is constructed from a single sequence, <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i15.gif"/></inline-formula> and then the log-odds of the first profile are averaged over the observed weighted frequencies of the second profile. Several other score correction schemes have been tested, but the one in Equation 6 worked best. In the extreme case, when both profiles are constructed from a single sequence, no correction is applied.</p>
        <p>In addition to "thickness", the information content of the profile position <italic>i </italic>is characterized by the expression of relative entropy <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i16.gif"/></inline-formula>. Small values of <italic>r</italic><sup>(<italic>i</italic>) </sup>indicate uninformative and variable positions. Therefore, scores of the positions, having <italic>r</italic><sup>(<italic>i</italic>) </sup>lower than the specified threshold, are scaled down by the adjustable factor (0.5 by default). The threshold is inversely proportional to -log <italic>E</italic>, where <italic>E </italic>is the pre-calculated <italic>E</italic>-value per hit. For compositionally similar profiles this threshold will be low. Scaling down of the scores for positions of low entropy is performed independently of the effective number of sequences ("thickness") comprising corresponding positions.</p>
      </sec>
      <sec>
        <title>Gap cost computation</title>
        <p>Position-dependent gap costs for a pair of profiles are defined by the insertion/deletion probabilities for every position of individual profiles and by the limits within which position-specific gap costs are allowed to vary. The high scoring positions of the score system are mostly conserved, and the probability for a gap to occur there is low. In contrast, the positions of low scores often match variable regions (e.g. loops in protein structure) where the probability of a gap becomes higher. Thus, gap cost limits should be more stringent for high scoring positions than for low scoring ones. Following this logic, gap cost limits for the first and the second profile are calculated using respectively the row and column maximum scores of the score system. For each position of the score system, the number <italic>w </italic>of maximum scores is recorded and their autocorrelation is calculated. Since the autocorrelation is a sum of the products, the characteristic value of maximum scores for the corresponding position is calculated as the square root of the autocorrelation value divided by the number of summed products. This ensures that the characteristic value is within the similar range as the maximum scores. The final gap cost limit for the corresponding position is computed as the square root of the autocorrelation function of the characteristic values divided by the number of summed products. The goal of this procedure is to make the gap cost limit for the corresponding position dependent on the adjacent characteristic values. The formal description of this logic follows below.</p>
        <p>Let <italic>s</italic><sub><italic>ij </italic></sub>denote the score for the positions <italic>i </italic>and <italic>j </italic>of the score system. Let <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i17.gif"/></inline-formula> be the sorted periodic sequence of the <italic>w </italic>maximum scores at the position <italic>i </italic>of the score system such that <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i18.gif"/></inline-formula>, <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i19.gif"/></inline-formula>, <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i20.gif"/></inline-formula>, .... Similarly, let <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i21.gif"/></inline-formula> be the sorted sequence of the <italic>w </italic>maximum scores at the position <italic>j </italic>such that <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i22.gif"/></inline-formula>, <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i23.gif"/></inline-formula>, <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i24.gif"/></inline-formula>, .... Let further {<italic>a</italic><sub><italic>i</italic></sub>}<sub><italic>i </italic></sub>be the periodic sequence such that <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i25.gif"/></inline-formula> where <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i26.gif"/></inline-formula> is the autocorrelation function, and let <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i27.gif"/></inline-formula> be the periodic sequence defined so that <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i28.gif"/></inline-formula> for all <italic>i </italic>(window size <italic>ω </italic>&gt; 0). Similarly, let <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i29.gif"/></inline-formula> be the sequence such that <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i30.gif"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i31.gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i32.gif"/></inline-formula> be the periodic sequence defined for all <italic>j</italic>: <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i33.gif"/></inline-formula>. Then the gap cost limit <italic>A</italic><sup>(<italic>i</italic>) </sup>for the first profile computed at the position <italic>i </italic>of the score system is defined as follows:<disp-formula id="bmcM8"><label>(8)</label><graphic xlink:href="1471-2105-11-89-i34.gif"/></disp-formula></p>
        <p>where <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i35.gif"/></inline-formula> is the autocorrelation function of <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i36.gif"/></inline-formula> in a window of size <italic>k </italic>(by default, <italic>w </italic>= <italic>ω </italic>= 4); <italic>ω </italic>(<italic>ω </italic>+1)/2 is the number of the summed products. If the condition in Equation 8 is not satisfied, <italic>A</italic><sup>(<italic>i</italic>) </sup>is assigned to 0.</p>
        <p>Similarly, we define the gap cost limit <italic>B</italic><sup>(<italic>j</italic>) </sup>for the second profile at the position <italic>j</italic>:<disp-formula id="bmcM9"><label>(9)</label><graphic xlink:href="1471-2105-11-89-i37.gif"/></disp-formula></p>
        <p>where <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i38.gif"/></inline-formula> is the autocorrelation function of <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i39.gif"/></inline-formula> in a window of size <italic>k</italic>. If the condition in Equation 9 is not satisfied, <italic>B</italic><sup>(<italic>j</italic>) </sup>is assigned to 0.</p>
        <p>Sometimes low positive scores in the score system imply relatively low gap cost limits leading to high-scoring local alignments, which may be poor because of the positive expected score per aligned pair of positions [<xref ref-type="bibr" rid="B19">19</xref>]. In COMA, to address this problem, the term <italic>z </italic>is added to the multipliers within the autocorrelation functions in Equations 8 and 9 so that the gap cost limits are widened:<disp-formula id="bmcM10"><label>(10)</label><graphic xlink:href="1471-2105-11-89-i40.gif"/></disp-formula></p>
        <p>The parameter <italic>z </italic>in Equation 10 is introduced twice in a two-step iterative protocol. In the first step, the term <italic>z</italic>, inversely proportional to √<italic>H</italic>, is added to each of the autocorrelated values. <italic>H </italic>is a statistical parameter of entropy (see statistical significance below) and its low values indicate low scores. By default, <italic>H </italic>is derived analytically for a pair of profiles (optionally, <italic>H </italic>may be computed for every individual position of the score system, thus increasing specificity at the expense of sensitivity). In the second step, an initial alignment and its <italic>E</italic>-value are computed. Based on this initial alignment, <italic>z </italic>is reevaluated as <italic>-y</italic>/(log <italic>E </italic>+ <italic>x</italic>), where <italic>x </italic>and <italic>y </italic>are adjustable parameters and <italic>E </italic>is the initial estimated <italic>E</italic>-value per hit. This reevaluation implies narrowing of gap cost limits in case of small initial <italic>E</italic>-values that indicate possibly related profile pairs.</p>
        <p>A gap cost at a certain position of the score system is two-sided. It depends on both the deletion probability in the first profile and the insertion probability in the second (the deletion probability expresses probability for a gap to occur in the same profile, while the insertion probability - in the second). The final gap cost <italic>G</italic><sup>(<italic>i</italic>) </sup>for the first profile at the position <italic>i </italic>of the score system is defined as a fraction of the size of the gap cost limit <italic>A</italic><sup>(<italic>i</italic>) </sup>at the position by the superposition of the deletion and insertion probabilities:<disp-formula id="bmcM11"><label>(11)</label><graphic xlink:href="1471-2105-11-89-i41.gif"/></disp-formula></p>
        <p>where <italic>D</italic><sup>(<italic>i</italic>) </sup>is the deletion probability of the first profile at the position <italic>i, I</italic><sup>(<italic>j</italic>) </sup>is the insertion probability of the second profile at the position <italic>j</italic>. Since the gap cost limits <italic>A</italic><sup>(<italic>i</italic>) </sup>by definition mean the costs of the deletions for the first profile, a weight of the deletion probability <italic>D</italic><sup>(<italic>i</italic>) </sup>of that profile in the expression for <italic>G</italic><sup>(<italic>i</italic>) </sup>is reduced by the constant <italic>c </italic>(by default <italic>c </italic>= 0.6). The gap cost for the second profile <italic>C</italic><sup>(<italic>j</italic>) </sup>is computed in a similar way:<disp-formula id="bmcM12"><label>(12)</label><graphic xlink:href="1471-2105-11-89-i42.gif"/></disp-formula></p>
        <p>where <italic>P</italic><sup>(<italic>j</italic>) </sup>is the deletion probability of the second profile at the position <italic>j, J</italic><sup>(<italic>i</italic>) </sup>is the insertion probability of the first profile at the position <italic>i</italic>.</p>
        <p>If multiple sequence alignment is "thin", the effect of deletion and insertion probabilities may be disproportionally large. For example, consider a position of multiple sequence alignment consisting of just two aligned sequences where the second sequence contains a gap. The insertion probability for that position would be 50%. To avoid such situations, the insertion/deletion probabilities are adjusted by a factor of 1/(1 + exp(-<italic>t u </italic>+ <italic>v</italic>)), where <italic>t </italic>is the effective number of sequences in multiple sequence alignment at a given position, and <italic>u </italic>and <italic>v </italic>are the adjustable parameters. When the alignment is "thick" (the effective number of sequences is large), the factor approaches 1 and the adjustment essentially has no effect.</p>
        <p>All the heuristic parameters (<italic>x</italic>, <italic>y</italic>, <italic>u</italic>, <italic>v</italic>, <italic>c,...</italic>) were optimized on the most structurally diverse and most difficult subset (200-300 profiles) of the dataset.</p>
      </sec>
    </sec>
    <sec>
      <title>Statistical significance</title>
      <p>An accurate estimation of statistical significance of the alignment score is important as it tells whether aligned sequence profiles (representing protein families) are likely to be related or not.</p>
      <p>We use analytical estimation of statistical significance. The analytical approach was initially proposed [<xref ref-type="bibr" rid="B16">16</xref>] for any score table used for ungapped sequence alignments and meeting two necessary conditions: the mean of scores must be negative and at least one positive score must exist in the table. It was shown [<xref ref-type="bibr" rid="B20">20</xref>] that the distribution of the optimal alignment scores using a score table that meets these two conditions can be well approximated by the extreme value distribution (EVD). Furthermore, it was shown [<xref ref-type="bibr" rid="B19">19</xref>] that the limit of average score per aligned pair of positions exists for gapped alignments. This means that the theory can be extended for gapped alignments and this has been demonstrated in practice [<xref ref-type="bibr" rid="B8">8</xref>].</p>
      <sec>
        <title>Statistical parameters</title>
        <p>If the distribution of the optimal alignment scores is approximated by EVD, the expected value <italic>E </italic>(the expected number of alignment scores greater than or equal to <italic>s </italic>per database search) can be expressed as follows:<disp-formula id="bmcM13"><label>(13)</label><graphic xlink:href="1471-2105-11-89-i43.gif"/></disp-formula></p>
        <p>where <italic>m </italic>is a length of the query profile, <italic>n </italic>is a length of the database. This expression of <italic>E</italic>-value and the corresponding <italic>P</italic>-value (<italic>P </italic>= 1-exp(-<italic>E</italic>)) are the ones used in COMA to estimate statistical significance. Since the score system used in COMA is amenable to the Karlin-Altschul statistics, the statistical parameters are derived as follows: the scale parameter of the distribution <italic>λ</italic>, is solved from Equation 3, where the scores <italic>s</italic><sub><italic>k </italic></sub>are calculated from Equation 6, <italic>K </italic>is found by the formula given in [<xref ref-type="bibr" rid="B16">16</xref>]. Using the definitions of the target and background probabilities in Equation 1, the parameter of relative entropy <italic>H </italic>required to compute <italic>K </italic>is expressed as follows:<disp-formula id="bmcM14"><label>(14)</label><graphic xlink:href="1471-2105-11-89-i44.gif"/></disp-formula></p>
        <p>It follows from Equation 1 that the target probabilities are equal to <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i45.gif"/></inline-formula> where <inline-formula><inline-graphic xlink:href="1471-2105-11-89-i46.gif"/></inline-formula>, and the log-odds in Equation 14 are equal to <italic>λ s</italic><sub><italic>ij</italic></sub>. Using the notations found in Equations 3 and 4, <italic>H </italic>is expressed as:<disp-formula id="bmcM15"><label>(15)</label><graphic xlink:href="1471-2105-11-89-i47.gif"/></disp-formula></p>
        <p>It is important to note that the search space <italic>m n </italic>used in Equation 13 is valid asymptotically. Thus, the edge effect (dependence of the expected alignment length on the alignment score) is corrected by computing additional statistical parameters <italic>α </italic>and <italic>β </italic>[<xref ref-type="bibr" rid="B21">21</xref>].</p>
      </sec>
      <sec>
        <title>Composition-based statistics and the global score system</title>
        <p>In COMA, statistical parameters are computed for each pair of profiles to be aligned. The exact values of solved statistical parameters (<italic>λ, H, K</italic>) may differ from pair to pair of profiles leading to adverse effects such as different statistical significance values for identical scores. To deal with this problem we apply composition based statistics using a newly introduced global score system. The idea of the composition-based statistics [<xref ref-type="bibr" rid="B17">17</xref>] is to transform a score table (the score system in the case of profiles) so that its statistical parameter <italic>λ</italic><sub><italic>u</italic></sub><sup>*</sup> becomes equal to the reference value of <italic>λ</italic><sub><italic>u</italic></sub>, where <italic>λ</italic><sub><italic>u </italic></sub>is the statistical parameter of the distribution of ungapped alignment scores. For sequences the reference parameter corresponds to the known parameter of the residue substitution score table used, e.g. one of the BLOSUM [<xref ref-type="bibr" rid="B11">11</xref>] or PAM [<xref ref-type="bibr" rid="B12">12</xref>] families. For profiles, there is no explicitly defined alphabet of finite size such as that for sequences (twenty different residues).</p>
        <p>Here, to make such an alphabet for profiles, we compile all unique profile vectors from the profile database used for profile comparisons and construct a global score system of profile vectors (Figure <xref ref-type="fig" rid="F1">1</xref>). Each cell (<italic>i</italic>, <italic>j</italic>) of the global score system contains the similarity score <italic>s</italic><sub><italic>ij </italic></sub>of two profile vectors. Solving Equation 3 for the parameter <italic>λ </italic>gives us the value of the required reference parameter <italic>λ</italic><sub><italic>u</italic></sub>. After the score system is constructed for a pair of profiles, its scores are transformed so that the parameter <italic>λ</italic><sub><italic>u</italic></sub><sup>*</sup> of the score system becomes equal to the reference parameter <italic>λ</italic><sub><italic>u</italic></sub>. Making use of the global score system involved a non-trivial algorithmic approach (to make it feasible, we introduced a two-level hash system with the binary search structures), but it significantly improved the performance of COMA.</p>
        <fig id="F1" position="float">
          <label>Figure 1</label>
          <caption>
            <p><bold>The global score system of profile vectors</bold>. Each cell within the global score system corresponds to the score <italic>s</italic><sub><italic>ij </italic></sub>calculated using information from two profile vectors found at the row and column positions <italic>i </italic>an <italic>j</italic>, respectively.</p>
          </caption>
          <graphic xlink:href="1471-2105-11-89-1"/>
        </fig>
      </sec>
      <sec>
        <title>Statistical significance of gapped alignments</title>
        <p>The analytical theory of statistical significance estimation has been developed only for ungapped alignments [<xref ref-type="bibr" rid="B16">16</xref>]. Since there is no universal theory for gapped alignments, the statistical parameters of the score distribution of gapped alignments have to be estimated empirically. Although in theory [<xref ref-type="bibr" rid="B22">22</xref>] it is possible to derive analytical expressions of the statistical parameters of gapped alignments, in practice this does not seem to be feasible and, to our knowledge, so far has not been implemented. The gap cost scheme in COMA is complex, and the analytical approach in this case would not be feasible as well.</p>
        <p>On the other hand, it has been shown empirically that the scores of gapped alignments are also distributed according to EVD [<xref ref-type="bibr" rid="B8">8</xref>]. For profile-profile comparisons, the score distribution might be slightly diverged from EVD [<xref ref-type="bibr" rid="B23">23</xref>] due to specifics of the profile scoring and gap introduction methods. However, for significance estimation the most important is the tail of the distribution, which can be accurately represented by EVD.</p>
        <p>To derive the reference statistical parameters <italic>λ</italic><sub><italic>g </italic></sub>and <italic>K</italic><sub><italic>g </italic></sub>for gapped alignments, we compiled a set of unrelated COMA hits. This set comprises 160 513 hits that fulfil all of the following conditions: (a) profiles are from different SCOP [<xref ref-type="bibr" rid="B24">24</xref>] superfamilies, (b) COMA alignment score is ≥ 60, and (c) TM-score [<xref ref-type="bibr" rid="B25">25</xref>] according to the DALI [<xref ref-type="bibr" rid="B26">26</xref>] alignment evaluated in the local mode is ≤ 0.17 (see "Results" for detailed description of alignment evaluation).</p>
        <p>Having compiled the set of unrelated hits, we then derive the scale and localization reference statistical parameters of the extreme value distribution, <italic>λ </italic>and <italic>μ</italic>, respectively, as follows. We progressively increase the lower bound of the alignment score threshold for alignments to be considered, each time re-estimating the statistical parameters for the resulting set. In this way we obtain a series of values for both <italic>λ </italic>and <italic>μ </italic>that in general show a significant variation (Figure <xref ref-type="fig" rid="F2">2</xref>). However, with the increase of alignment scores, the statistical parameter values become fairly stable (for scores over 75), allowing to select them as the reference values for gapped alignments (<italic>λ </italic>serves as <italic>λ</italic><sub><italic>g</italic></sub>, while <italic>μ </italic>is used to calculate <italic>K</italic><sub><italic>g</italic></sub>). In other words, the empirically derived reference values of <italic>λ </italic>and <italic>μ </italic>are expected to accurately describe the statistics of score distribution in the region of higher scores (corresponding to the tail of EVD).</p>
        <fig id="F2" position="float">
          <label>Figure 2</label>
          <caption>
            <p><bold>Estimation of statistical parameters for score distribution of gapped alignments</bold>. (A) Obtained alignment score distribution of unrelated hits; COMA scores are fitted to the extreme value distribution considering only the hits with the score of at least 63 (the dashed line). (B) Estimation of the scale statistical parameter <italic>λ </italic>and (C) the localization statistical parameter <italic>μ </italic>. Standard errors of the estimates are shown with error bars. The dashed line denotes the level at which the fluctuation of the statistical parameters becomes small.</p>
          </caption>
          <graphic xlink:href="1471-2105-11-89-2"/>
        </fig>
        <p>As a result of the composition-based statistics, the parameter <italic>λ </italic><sub><italic>u</italic></sub><sup>*</sup> solved and scaled for a pair of profiles is equal to the reference parameter <italic>λ</italic><sub><italic>u </italic></sub>of the global score system: <italic>λ </italic><sub><italic>u</italic></sub><sup>*</sup> ≡ <italic>λ</italic><sub><italic>u</italic></sub>. Only in rare cases, e.g. because of low absolute values of scores (thus indicating weak signal of similarity if any), <italic>λ</italic><sub><italic>u</italic></sub><sup>*</sup> and <italic>λ</italic><sub><italic>u </italic></sub>might be slightly different. We then assume that the statistical parameter <italic>λ</italic><sub><italic>u</italic></sub><sup>*</sup> of the score system for the pair of the profiles to be aligned with gaps differs from the reference parameter <italic>λ</italic><sub><italic>g</italic></sub><sup>*</sup> exactly in the same ratio as <italic>λ</italic><sub><italic>u</italic></sub><sup>*</sup> differs from <italic>λ</italic><sub><italic>u</italic></sub>. The same principle is applied for estimation of the statistical parameter <italic>K</italic><sub><italic>g</italic></sub><sup>*</sup> of the score system for the pair of profiles to be aligned with gaps. However, in contrast to <italic>λ</italic>, the values of <italic>K</italic><sub><italic>u </italic></sub>and <italic>K</italic><sub><italic>u </italic></sub>are of ten different. Thus, <italic>K</italic><italic><sub>g</sub></italic><sup>*</sup> is calculated by adjusting the empirically estimated <italic>K</italic><sub><italic>g </italic></sub>by the factor <italic>K</italic><sub><italic>u</italic></sub><sup>*</sup>/<italic>K</italic><sub><italic>u</italic></sub>. The final expressions of <italic>λ</italic><sub><italic>g</italic></sub><sup>*</sup> and <italic>K</italic><sub><italic>g</italic></sub><sup>*</sup> are as follows:<disp-formula id="bmcM16"><label>(16)</label><graphic xlink:href="1471-2105-11-89-i48.gif"/></disp-formula></p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Results</title>
    <p>To evaluate COMA, we compared its ability to detect remote relationships and produce accurate alignments with that of other state-of-the-art profile-based methods. We chose COMPASS [<xref ref-type="bibr" rid="B5">5</xref>] (version 2.42), another profile-profile comparison method, HHsearch [<xref ref-type="bibr" rid="B6">6</xref>] (1.5), a method based on HMM-HMM comparison, and PSI-BLAST [<xref ref-type="bibr" rid="B8">8</xref>] (2.2.15), a widely used profile-sequence method.</p>
    <sec>
      <title>Test set</title>
      <p>The assessment of distant relationships and corresponding alignments can be best done having three-dimensional (3D) structures of the test set proteins in hand. Here, we used SCOP [<xref ref-type="bibr" rid="B24">24</xref>] (1.71) protein structures and corresponding ASTRAL [<xref ref-type="bibr" rid="B13">13</xref>] sequences. Having focused on distant homology we only considered sequences 20% or less identical to each other. We also excluded sequences of small and membrane protein classes ('g' and 'f' respectively). As a result, we ended up with a large statistical sample consisting of 4611 sequences representing a wide variety of protein structures and a challenging set for similarity detection. For each sequence from this set, multiple alignments were built by running up to 6 iterations of PSI-BLAST against the NCBI non-redundant (nr) sequence database filtered to the maximum identity of 70%. To prevent unrelated sequences from entering the alignments, we ran PSI-BLAST using a stringent (10<sup>5</sup>) sequence inclusion threshold and with low complexity filter turned on. The resulting alignments were used in all-to-all comparison for all methods except for COMPASS. Before running COMPASS, alignment columns corresponding to gaps in the first (query) sequence were removed, substantially improving its performance.</p>
    </sec>
    <sec>
      <title>Evaluation framework</title>
      <p>Traditionally, homology detection methods have been evaluated against a reference protein classification scheme and reference alignments serving as "gold standard". However, the more remote relationships are considered, the less straightforward becomes the use of "gold standard" classification schemes and alignments. For example, the original hierarchical SCOP classification scheme implies that protein domains assigned to different folds are unrelated and therefore should be considered as a false positive match in the benchmark. Yet, by now, it is commonly accepted that there are many evolutionary related proteins classified as having different folds. Perhaps most obvious examples include Rossmann-like domains, immunoglobulin-like β-sandwiches and β-propellers. Evolutionary relationships can be found even at the highest hierarchy level, between domains belonging to different SCOP classes (e.g. [<xref ref-type="bibr" rid="B27">27</xref>]).</p>
      <p>Reference alignments usually have to be derived separately, using some structure comparison method, e.g. DALI [<xref ref-type="bibr" rid="B26">26</xref>]. However, different structure comparison methods tend to produce structure-based alignments that differ in coverage and/or accuracy. This problem is essentially non-existent for closely related proteins, but becomes very important in the cases of remote homology, the area specifically targeted by profile-profile comparison methods.</p>
      <p>Therefore, to bypass additional problems with reference classification and reference alignments we chose to use exclusively the reference-free evaluation framework based on structural models. In this framework, no other information except for the pairwise sequence alignment produced by the assessed method and 3D structures of aligned protein domains is needed. Alignment is used to generate a 3D model of the query sequence based on the structure of the match. The questions of whether the match is correct (are aligned protein structures similar?) and whether the alignment is accurate are automatically answered by evaluating the obtained model against the real structure. Such model evaluation framework has been very effective in Critical Assessment of Techniques for Protein Structure Prediction (CASP) experiments lasting over a decade [<xref ref-type="bibr" rid="B28">28</xref>]. For assessment of homology detection methods the reference-free evaluation initially was introduced as a way to take care of exceptions within the "gold standard" SCOP classification [<xref ref-type="bibr" rid="B6">6</xref>] and, more recently, validated as an entirely self-sufficient evaluation framework [<xref ref-type="bibr" rid="B29">29</xref>].</p>
      <p>Here, pairwise alignments obtained by every tested method are converted into corresponding 3D models using a standard MODELLER [<xref ref-type="bibr" rid="B30">30</xref>] (version 9.2) run. To evaluate the quality of the models we use the template modeling score (TM-score) [<xref ref-type="bibr" rid="B25">25</xref>], which is similar to GDT_TS [<xref ref-type="bibr" rid="B31">31</xref>] and MaxSub [<xref ref-type="bibr" rid="B32">32</xref>] measures, but is designed to be less dependent on the protein size. TM-score generates a single value in the [0; 1] range indicating how close is the model to the reference structure [<xref ref-type="bibr" rid="B25">25</xref>] (TM-score ≤ 0.17 implies a random match; TM-score ≥ 0.4 indicates a statistically significant similarity; for identical structures TM-score = 1). Accordingly, in our evaluation scheme the aligned pair of proteins is accepted as a true positive match, if the TM-score is ≥ 0.4 and a false positive match, if the TM-score ≤ 0.17. Alignments producing intermediate TM-score values (0.17 &lt; TM-score &lt; 0.4) are considered to represent "unknown" relationships.</p>
    </sec>
    <sec>
      <title>Evaluation of methods in all-to-all comparison</title>
      <p>To measure the performance of all the evaluated methods, we performed all-to-all comparison for the test set (4611 multiple alignments). Although in our evaluation framework the alignment, produced by a method being tested, by itself defines both the quality of the match and the alignment accuracy, two different evaluation modes, global and local, are possible. In a global mode, the alignment is evaluated with respect to the entire protein domain. This is equivalent to asking how useful the alignment is for generating a structural model of that domain. In a local mode, the alignment is evaluated within its boundaries. This mode measures how well a particular method can detect and align possibly short, but structurally similar fragments, without the requirement that these fragments come from overall similar domains. A caveat of this mode is that very short alignments would often score very high, independently whether the aligned fragments are related or not. Therefore, in the local evaluation mode we only consider fragments that include at least 15 aligned residues, the length that approximates the transition from individual secondary structure elements into supersecondary structure motifs.</p>
      <p>All-to-all comparison generates two matches between proteins A and B (AB and BA), scores of which in general may slightly differ. To reduce the redundancy, for each evaluated method we only consider one of the two matches producing a better statistical significance value. In both evaluation modes for every aligned pair AB we consider two models, A' and B' (A' is a model of A built using the structure of B as the template, and B' is a model of B built using the structure of A). Although the same AB alignment is used to generate both A' and B', their corresponding TM-scores in general differ, because they correspond to different structure pairs AA' and BB'. Of the two TM-scores for the AB pair we take the better one.</p>
      <p>Figure <xref ref-type="fig" rid="F3">3</xref> shows the results of both global (Figure <xref ref-type="fig" rid="F3">3A</xref>) and local (Figure <xref ref-type="fig" rid="F3">3B</xref>) evaluation modes as Receiver Operating Characteristic (ROC) charts. In a ROC chart the number of true positives (TP) is plotted against the number of false positives (FP) after matches are sorted according to their statistical significance (e.g. by ascending E-values) for each method. The higher is the curve (or the larger is the relative area under the curve), the better is the performance of the method.</p>
      <fig id="F3" position="float">
        <label>Figure 3</label>
        <caption>
          <p><bold>Performance of the evaluated methods according to the ROC curves</bold>. A match is defined as a true positive if a corresponding structural model gets TM-score ≥ 0.4, and a false positive if TM-score ≤ 0.17. HHsearch was tested both with and without (w/o ss) consideration of secondary structure information. Numbers in parenthesis indicate relative area under the corresponding ROC curve. (A) Global mode analysis, in which alignments are evaluated in respect to the entire structural domains. Empty squares mark approximate transition points, where false positives start accumulating more rapidly. Corresponding <italic>E</italic>-values for COMA, COMPASS, PSI-BLAST and HHsearch w/o ss are 0.01, 0.03, 0.0007 and 3e-6 respectively. HHsearch probability is 97.6% (B) Local mode analysis; evaluation is done within the boundaries of aligned segments; <italic>E</italic>-values at transition points for COMA, COMPASS, PSI-BLAST and HHsearch w/o ss are 8e-6, 1e-4, 1e-5, and 0.65 respectively. HHsearch probability is 65.3%. Correlation between the estimated and observed statistical significance values for each method from the purely statistical perspective without differentiating global and local modes is shown in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>, Figure S3.</p>
        </caption>
        <graphic xlink:href="1471-2105-11-89-3"/>
      </fig>
      <p>In the global evaluation mode, COMA is clearly better than the other methods included in the comparison. Within the high specificity range (low error rate) COMPASS is second, but in the lower specificity region (~26% error) is overtaken by the HHsearch version that uses secondary structure information. For the user of a particular homology detection method, the most important is the left-most region of the curve, because it corresponds to the statistically most significant matches. The significantly better performance by COMA in this region becomes even more apparent when the same data is plotted in a log-scale (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>, Figure S1A). To make sure that this result is not specific to the exact cutoff (TM-score ≥ 0.4) that we used as a criterion of true positive we have also tried alternative definitions (TM-score ≥ 0.35 and TM-score ≥ 0.45). In both cases we obtained qualitatively similar results with COMA being a top performer (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>, Figure S2A, C). In addition, we sought an independent means to confirm that the TM-score criterion is indeed sufficient to make a case for meaningful similarity of an aligned pair. For this, we analyzed the non-redundant set of true positives (according to the TM-score criterion) produced by all the evaluated methods. All pairs from the same SCOP superfamily as well as those coming from different superfamilies, folds or even classes, but producing DALI Z-score ≥ 2, were considered related. It turned out that in the global evaluation mode TM-score results are nearly perfectly reproduced by the combined SCOP/DALI classification scheme (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>, Table S1). In contrast, if only SCOP hierarchy is used for classification, the discrepancy is much larger.</p>
      <p>The local evaluation mode measures the quality of the structural match predicted by the sequence alignment with respect to the aligned region only. The results of the local evaluation mode (Figure <xref ref-type="fig" rid="F3">3B</xref>; Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>, Figure S2B, D) of HHsearch are strikingly different from those obtained in the global mode. Both versions of HHsearch, in particular the one using secondary structure information, outperform other methods by a large margin, except for the region of very high specificity, where COMA detects the largest number of true positives (Figure <xref ref-type="fig" rid="F3">3B</xref>; Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>, Figures S1B, S2B, D). At the same time COMA, COMPASS and PSI-BLAST all show relative performance qualitatively similar to that of the global mode. Why then the HHsearch behavior is so much different in the local evaluation mode?</p>
      <p>The apparent reason for that becomes clear if we analyze the binned distribution of the length of alignments that score as true positives in the local evaluation mode for all the methods (Figure <xref ref-type="fig" rid="F4">4</xref>). Both versions of HHsearch strongly favor relatively short alignments (up to 40 aligned positions). In contrast, COMA and COMPASS, are both aimed at aligning longer segments. COMPASS specifically avoids short alignments (length &lt;40). On the other hand, while COMA produces a significant number of short accurate alignments, its strength lies in generating long ones (over 180 aligned positions).</p>
      <fig id="F4" position="float">
        <label>Figure 4</label>
        <caption>
          <p><bold>Distribution of true positives according to the alignment length</bold>. The figure shows distribution of true positives according to the length of corresponding alignments from the 30000 most significant hits found by each method. Only alignments including at least 15 aligned residues have been considered. Alignments over 180 in length are pooled together in the last bin.</p>
        </caption>
        <graphic xlink:href="1471-2105-11-89-4"/>
      </fig>
      <p>Thus the combined analysis of the performance by compared methods reveals the opposite preferences towards the alignment length by HHsearch on one side and COMA and COMPASS on the other side. It is interesting to note that for all of the compared methods the number of true positives is higher in local as opposed to the global mode analysis (Figure <xref ref-type="fig" rid="F3">3</xref>; Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>, Table S1 and Figure S4). The SCOP/DALI criterion recaptures most of the true positives as defined by TM-score in the local evaluation mode, yet the disagreement is larger than in the global mode (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>, Table S1). This should not be surprising, because both SCOP and DALI are aiming at the global similarity between protein domains. Taken together the data indicates that 1) it is relatively easier to accurately align similar fragments than entire domains and that 2) a number of detected similar fragments are imbedded within domains that are not globally similar.</p>
    </sec>
    <sec>
      <title>Structure-based vs. profile-profile alignments</title>
      <p>It is a common knowledge that structure-based alignments are in general more accurate than those based on sequence (profile, HMM) comparison. Thus, we asked whether and, if so, to what extent alignments produced by individual methods in all-to-all comparison can be improved by using structure comparison? To answer this question, we realigned equal number of the top matching domain pairs for each method with DALI [<xref ref-type="bibr" rid="B26">26</xref>] and computed TM-scores for these alignments. Distribution of the original TM-scores and those based on DALI alignments are shown in Figure <xref ref-type="fig" rid="F5">5</xref>. One can see that the TM-score distribution derived using DALI structural alignments is strongly shifted towards higher TM-score values in both evaluation modes. In other words, DALI was able to improve significantly both the coverage and accuracy of alignments. Interestingly, after the realignment with DALI, the TM-score distribution is similar for all evaluated methods, except for PSI-BLAST, which remains significantly worse. These results indicate that the quality of homology detection for all of the evaluated methods (except for PSI-BLAST) is comparable. The observed differences in performance mostly come from differences in the alignment coverage and/or accuracy.</p>
      <fig id="F5" position="float">
        <label>Figure 5</label>
        <caption>
          <p><bold>Distribution of TM-scores for original and structure-based alignments</bold>. TM-score histograms obtained for original alignments in global (A) and local (B) evaluation modes without division into TP/FP. The data is shown for the 14516 most significant hits for each method (the number corresponds to COMA's hits up to <italic>E</italic>value = 0.01). Histograms in (C) and (D) show TM-score distributions for the same hits as in (A) and (B) respectively, but with TM-scores derived using DALI structural alignments.</p>
        </caption>
        <graphic xlink:href="1471-2105-11-89-5"/>
      </fig>
      <p>Although structure-based methods such as DALI, often serving as providers of "gold standard" references, overall outperform profile (HMM)-based methods, they are not perfect either. Yet, in the reference-dependent evaluation, any disagreement with the "gold standard" is treated as an error. In contrast, using the reference-free setting, we can directly find cases when structure-based methods perform worse than the evaluated methods. Figure <xref ref-type="fig" rid="F6">6</xref> provides a couple of such examples.</p>
      <fig id="F6" position="float">
        <label>Figure 6</label>
        <caption>
          <p><bold>Examples of COMA performing better than DALI, a structure-based method</bold>. (A) COMA and DALI, each aligns d1ks9a2 with d1uwva2, but with different domains, catalytic and central, respectively. Coloring of d1ks9a2 and the catalytic domain of d1uwva2 corresponds to the progression of polypeptide chain from N-(blue) to C-terminus (red). (B) Homologous pair of EF-hand proteins, human psoriasin (d1psra_) and pike parvalbumin (d2pvba_).</p>
        </caption>
        <graphic xlink:href="1471-2105-11-89-6"/>
      </fig>
      <p>In the first example (Figure <xref ref-type="fig" rid="F6">6A</xref>), we consider two SCOP structures belonging to different folds that nevertheless have been identified by COMA as related at the domain level. It aligned ketopantoate reductase (d1ks9a2), a representative of Rossmann-fold (SCOP fold: c.2), and the methyltransferase (d1uwva2; c.66) RumA with statistically significant scores (<italic>E</italic>-value = 2.6e-3 and TM-score = 0.4262). DALI superimposed the corresponding structures producing Z-score of just 2, which is at the borderline of significance (structural matches with DALI <italic>Z</italic>-score lower than 2 are considered spurious [<xref ref-type="bibr" rid="B26">26</xref>]). Upon closer inspection, it turned out that COMA and DALI aligned the Rossmann-fold domain with different domains of RumA. COMA matched it with the catalytic domain representing a typical Rossmann-like SAM-dependent methyltranserase fold [<xref ref-type="bibr" rid="B33">33</xref>,<xref ref-type="bibr" rid="B34">34</xref>], reproducing previously established relationship. In contrast, DALI superimposed it with the iron-sulfur cluster-containing central domain, which has a different topology altogether [<xref ref-type="bibr" rid="B34">34</xref>]. Interestingly, when the isolated catalytic domain of RumA is compared to d1ks9a2, the resulting DALI alignment is assigned a much higher <italic>Z</italic>-score of 4.9. The corresponding TM-score = 0.4887 indicates that DALI has been able to improve over COMA's alignment, thus corroborating the relationship detected by COMA. However, note that this DALI result was obtained only due to a manual intervention. Were the original DALI results and the SCOP classification to serve as a reference, the distant relationship detected by COMA should have been considered either as false positive or at least dismissed as "unknown".</p>
      <p>The second example (Figure <xref ref-type="fig" rid="F6">6B</xref>) involves human psoriasin (d1psra_) and pike parvalbumin (d2pvba_), a pair of clearly homologous proteins belonging to the same SCOP superfamily (EF-hand; a.39.1). While COMA correctly assigns a significant E-value (2.2e-4) to their alignment, DALI considers this to be a spurious match (Z-score = 1.9). Interestingly, both methods produce similar alignments, but the alignment by COMA (TM-score = 0.4725) is an improvement over DALI's (TM-score = 0.4234).</p>
      <p>These two examples vividly illustrate the problems associated with the use of structure-based classification and/or alignments as "gold standard". With further improvement of homology detection methods the use of "gold standards" is going to be even more problematic.</p>
    </sec>
  </sec>
  <sec>
    <title>Discussion and Conclusions</title>
    <p>In general, there are two major features that distinguish COMA from other sequence profile-profile comparison methods. The first one is position-dependent gap penalties. Although position-dependent gap penalties are commonly used in HMMs, to our knowledge, this study is the first one to implement them for comparison of sequence profiles. The second novel feature is the concept of the global score system. It enabled us to extend the analytical theory of statistical significance estimation developed for sequence comparisons into the comparisons of sequence profiles.</p>
    <p>So far, a theory that could be as robust as that developed earlier for sequence comparisons [<xref ref-type="bibr" rid="B16">16</xref>] has been missing for profile-profile comparisons [<xref ref-type="bibr" rid="B35">35</xref>]. An earlier implementation of the analytical approach for sequence profile-profile comparisons [<xref ref-type="bibr" rid="B5">5</xref>] employs a number of simplifications in computing statistical parameters, thereby affecting their precision. One of the fundamental prerequisites for application of the Karlin-Altschul statistics [<xref ref-type="bibr" rid="B16">16</xref>] is the existence of the discrete score table. Here, to satisfy this requirement for profile comparisons we introduce a global score system that includes all the profile vectors from a profile database. Although the construction of the global score system has presented a serious challenge at the implementation level it has been successfully resolved. Thus, the introduced global score system provides a foundation for the accurate analytical estimation of statistical significance of ungapped profile alignments and for composition-based statistics. Gapped alignments, however, follow a different score distribution and, therefore, their statistical significance has to be estimated empirically. In the case of gapped alignments, we only focus on the tail of the score distribution, which is the most important region for significance estimation. In COMA, we fit it to EVD, but fitting to a slightly different distribution [<xref ref-type="bibr" rid="B23">23</xref>] is also possible.</p>
    <p>Although in COMA the statistical significance of gapped alignments is estimated empirically, the resulting gapped alignments depend, albeit indirectly, on the Karlin-Altschul statistics. The dependence comes from the compositional adjustment of scores and, by definition, gap penalties, derived using the analytically solved statistical parameter values. Since the precision of these values strongly impacts the actual alignment of a profile pair, we believe that this significantly contributes to COMA's performance.</p>
    <p>Along with algorithmic improvements, an important factor in the development of sequence profile-based distant homology detection methods is an effective evaluation framework. Historically, profile-based methods have been benchmarked against external "gold standard" protein classification schemes and reference structure-based alignments. However, profile-based methods have already advanced to a point, where very remote relationships can be detected. Often these distant relationships challenge the traditional hierarchical classification schemes such as SCOP and/or structure-based alignments (Figure <xref ref-type="fig" rid="F6">6</xref>). This is in line with the emerging view of "continuous" protein fold space and also with the observation that there is no single structure-based method that would always produce an optimal alignment (e.g. reviewed in [<xref ref-type="bibr" rid="B36">36</xref>]). In this study we used an evaluation method that does not depend on any reference classification or reference alignments and only requires the knowledge of protein 3D structures. In this evaluation scheme we ask a single question: how useful is the alignment between a query and a matching protein in reproducing the structure of the query. The closer are the protein structures and the more accurate is the alignment, the better score is assigned for the aligned pair.</p>
    <p>Here, this general evaluation scheme has been applied in two different modes, global and local, each targeting different abilities of the evaluated methods. In a global evaluation mode an alignment is evaluated in respect to the entire protein domain. Therefore, in this mode not only more accurate but also more complete alignments are favored. Yet, a simple overprediction is not rewarded either, because if aligned regions are not structurally similar, their contribution to the total score is negligible. In contrast, the local evaluation mode is not concerned with the alignment coverage. It only measures how effective is the method in detecting and accurately aligning structurally similar protein segments, which can be very short.</p>
    <p>It is obvious that there is an unavoidable trade-off in performance, evaluated using these two different modes. A method, optimized to produce very short accurate alignments that include only the structurally most similar segments (e.g. individual secondary structure elements) will fare well in the local evaluation mode, but would be very poor if evaluated at the domain level (global mode). In contrast, a method that tries to extend alignment into less structurally similar regions, may perform very well in the global mode, but will inevitably look worse if evaluated in the local mode. Certainly, for different tasks, different modes may be desired. For example, the accurate detection of short, structurally similar fragments is of great value in protein structure prediction by fragment assembly, regardless whether these fragments are homologous or simply reflect similar conformational preferences. However, if the method is to be used primarily for homology modeling or structural/functional annotation of protein domains, the good performance in the global mode is more appropriate.</p>
    <p>COMA performs best at the protein domain rather than at the fragment level. This may be linked to position-dependent gap penalty scheme that allows the extension of alignment into structurally similar regions through sizeable variable regions (e.g. long loops). The shape of the ROC curve in the global evaluation mode shows that COMA is also good in distinguishing related from unrelated matches, an important property from the user's perspective. This property may be attributed to the new procedures of compositional adjustment of scores and statistical significance estimation. In conclusion, we hope that our new profile-profile comparison tool will be useful in studies of protein structure, function and evolution.</p>
    <p>The COMA software package and a web server are freely available for academic use at <ext-link ext-link-type="uri" xlink:href="http://www.ibt.lt/bioinformatics/coma/">http://www.ibt.lt/bioinformatics/coma/</ext-link>. The standalone package also includes programs for constructing the global score system and computing/scaling its statistical parameters for any profile database of interest.</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>MM and ČV conceived of the study and designed research. MM carried out the research. MM and ČV analyzed data and wrote the manuscript. All authors read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p><bold>Supplementary table and figures</bold>. Supplementary table provides the analysis of alignments defined as "true positives" by the TM-score criterion using two independent schemes ("SCOP" and "SCOP/DALI"). Supplementary figures provide supporting data for the results of methods evaluation. Figures S1 and S2 display ROC curves using correspondingly an alternative (log-scale) representation and alternative definitions for "true positives". Figure S3 provides a plot, showing how good is the agreement between the expected and observed P-values. Figure S4 represents evaluation results as Venn diagrams.</p>
      </caption>
      <media xlink:href="1471-2105-11-89-S1.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>This work was in part supported by Lithuanian State Science and Studies Foundation and Howard Hughes Medical Institute.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Edgar</surname>
          <given-names>RC</given-names>
        </name>
        <name>
          <surname>Sjolander</surname>
          <given-names>K</given-names>
        </name>
        <article-title>COACH: profile-profile alignment of protein families using hidden Markov models</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <issue>8</issue>
        <fpage>1309</fpage>
        <lpage>1318</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bth091</pub-id>
        <pub-id pub-id-type="pmid">14962937</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Yona</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Levitt</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Within the twilight zone: a sensitive profile-profile comparison tool based on information theory</article-title>
        <source>J Mol Biol</source>
        <year>2002</year>
        <volume>315</volume>
        <issue>5</issue>
        <fpage>1257</fpage>
        <lpage>1275</lpage>
        <pub-id pub-id-type="doi">10.1006/jmbi.2001.5293</pub-id>
        <pub-id pub-id-type="pmid">11827492</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Pietrokovski</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Searching databases of conserved sequence regions by aligning protein multiple-alignments</article-title>
        <source>Nucleic Acids Res</source>
        <year>1996</year>
        <volume>24</volume>
        <issue>19</issue>
        <fpage>3836</fpage>
        <lpage>3845</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/24.19.3836</pub-id>
        <pub-id pub-id-type="pmid">8871566</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rychlewski</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Jaroszewski</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Godzik</surname>
          <given-names>A</given-names>
        </name>
        <article-title>Comparison of sequence profiles. Strategies for structural predictions using sequence information</article-title>
        <source>Protein Sci</source>
        <year>2000</year>
        <volume>9</volume>
        <issue>2</issue>
        <fpage>232</fpage>
        <lpage>241</lpage>
        <pub-id pub-id-type="pmid">10716175</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Sadreyev</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Grishin</surname>
          <given-names>N</given-names>
        </name>
        <article-title>COMPASS: a tool for comparison of multiple protein alignments with assessment of statistical significance</article-title>
        <source>J Mol Biol</source>
        <year>2003</year>
        <volume>326</volume>
        <issue>1</issue>
        <fpage>317</fpage>
        <lpage>336</lpage>
        <pub-id pub-id-type="doi">10.1016/S0022-2836(02)01371-2</pub-id>
        <pub-id pub-id-type="pmid">12547212</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Söding</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Protein homology detection by HMM-HMM comparison</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <issue>7</issue>
        <fpage>951</fpage>
        <lpage>960</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti125</pub-id>
        <pub-id pub-id-type="pmid">15531603</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wang</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Sadreyev</surname>
          <given-names>RI</given-names>
        </name>
        <name>
          <surname>Grishin</surname>
          <given-names>NV</given-names>
        </name>
        <article-title>PROCAIN: protein profile comparison with assisting information</article-title>
        <source>Nucleic Acids Res</source>
        <year>2009</year>
        <volume>37</volume>
        <issue>11</issue>
        <fpage>3522</fpage>
        <lpage>3530</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkp212</pub-id>
        <pub-id pub-id-type="pmid">19357092</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Altschul</surname>
          <given-names>SF</given-names>
        </name>
        <name>
          <surname>Madden</surname>
          <given-names>TL</given-names>
        </name>
        <name>
          <surname>Schaffer</surname>
          <given-names>AA</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Miller</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Lipman</surname>
          <given-names>DJ</given-names>
        </name>
        <article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>
        <source>Nucleic Acids Res</source>
        <year>1997</year>
        <volume>25</volume>
        <issue>17</issue>
        <fpage>3389</fpage>
        <lpage>3402</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/25.17.3389</pub-id>
        <pub-id pub-id-type="pmid">9254694</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wootton</surname>
          <given-names>JC</given-names>
        </name>
        <name>
          <surname>Federhen</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Analysis of compositionally biased regions in sequence databases</article-title>
        <source>Methods Enzymol</source>
        <year>1996</year>
        <volume>266</volume>
        <fpage>554</fpage>
        <lpage>571</lpage>
        <comment>full_text</comment>
        <pub-id pub-id-type="pmid">8743706</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Henikoff</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Henikoff</surname>
          <given-names>JG</given-names>
        </name>
        <article-title>Position-based sequence weights</article-title>
        <source>J Mol Biol</source>
        <year>1994</year>
        <volume>243</volume>
        <issue>4</issue>
        <fpage>574</fpage>
        <lpage>578</lpage>
        <pub-id pub-id-type="doi">10.1016/0022-2836(94)90032-9</pub-id>
        <pub-id pub-id-type="pmid">7966282</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Henikoff</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Henikoff</surname>
          <given-names>JG</given-names>
        </name>
        <article-title>Amino acid substitution matrices from protein blocks</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>1992</year>
        <volume>89</volume>
        <issue>22</issue>
        <fpage>10915</fpage>
        <lpage>10919</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.89.22.10915</pub-id>
        <pub-id pub-id-type="pmid">1438297</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="book">
        <name>
          <surname>Dayhoff</surname>
          <given-names>MO</given-names>
        </name>
        <name>
          <surname>Schwartz</surname>
          <given-names>RM</given-names>
        </name>
        <name>
          <surname>Orcutt</surname>
          <given-names>BC</given-names>
        </name>
        <person-group person-group-type="editor">Dayhoff MO</person-group>
        <article-title>A model of evolutionary change in proteins</article-title>
        <source>Atlas of Protein Sequence and Structure</source>
        <year>1978</year>
        <volume>5</volume>
        <issue>Suppl 3</issue>
        <publisher-name>Washington, D. C.: National Biomedical Research Foundation</publisher-name>
        <fpage>345</fpage>
        <lpage>352</lpage>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="other">
        <name>
          <surname>Chandonia</surname>
          <given-names>JM</given-names>
        </name>
        <name>
          <surname>Hon</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Walker</surname>
          <given-names>NS</given-names>
        </name>
        <name>
          <surname>Lo Conte</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Koehl</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Levitt</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Brenner</surname>
          <given-names>SE</given-names>
        </name>
        <article-title>The ASTRAL Compendium in 2004</article-title>
        <source>Nucleic Acids Res</source>
        <year>2004</year>
        <issue>32 Database</issue>
        <fpage>D189</fpage>
        <lpage>192</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkh034</pub-id>
        <pub-id pub-id-type="pmid">14681391</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Tatusov</surname>
          <given-names>RL</given-names>
        </name>
        <name>
          <surname>Altschul</surname>
          <given-names>SF</given-names>
        </name>
        <name>
          <surname>Koonin</surname>
          <given-names>EV</given-names>
        </name>
        <article-title>Detection of conserved segments in proteins: iterative scanning of sequence databases with alignment blocks</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>1994</year>
        <volume>91</volume>
        <issue>25</issue>
        <fpage>12091</fpage>
        <lpage>12095</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.91.25.12091</pub-id>
        <pub-id pub-id-type="pmid">7991589</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Karlin</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Dembo</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Kawabata</surname>
          <given-names>T</given-names>
        </name>
        <article-title>Statistical composition of high-scoring segments from molecular sequences</article-title>
        <source>Ann Statist</source>
        <year>1990</year>
        <volume>18</volume>
        <issue>2</issue>
        <fpage>571</fpage>
        <lpage>581</lpage>
        <pub-id pub-id-type="doi">10.1214/aos/1176347616</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Karlin</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Altschul</surname>
          <given-names>SF</given-names>
        </name>
        <article-title>Methods for assessing the statistical significance of molecular sequence features by using general scoring schemes</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>1990</year>
        <volume>87</volume>
        <issue>6</issue>
        <fpage>2264</fpage>
        <lpage>2268</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.87.6.2264</pub-id>
        <pub-id pub-id-type="pmid">2315319</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Schaffer</surname>
          <given-names>AA</given-names>
        </name>
        <name>
          <surname>Aravind</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Madden</surname>
          <given-names>TL</given-names>
        </name>
        <name>
          <surname>Shavirin</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Spouge</surname>
          <given-names>JL</given-names>
        </name>
        <name>
          <surname>Wolf</surname>
          <given-names>YI</given-names>
        </name>
        <name>
          <surname>Koonin</surname>
          <given-names>EV</given-names>
        </name>
        <name>
          <surname>Altschul</surname>
          <given-names>SF</given-names>
        </name>
        <article-title>Improving the accuracy of PSI-BLAST protein database searches with composition-based statistics and other refinements</article-title>
        <source>Nucleic Acids Res</source>
        <year>2001</year>
        <volume>29</volume>
        <issue>14</issue>
        <fpage>2994</fpage>
        <lpage>3005</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/29.14.2994</pub-id>
        <pub-id pub-id-type="pmid">11452024</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Smith</surname>
          <given-names>TF</given-names>
        </name>
        <name>
          <surname>Waterman</surname>
          <given-names>MS</given-names>
        </name>
        <article-title>Identification of common molecular subsequences</article-title>
        <source>J Mol Biol</source>
        <year>1981</year>
        <volume>147</volume>
        <issue>1</issue>
        <fpage>195</fpage>
        <lpage>197</lpage>
        <pub-id pub-id-type="doi">10.1016/0022-2836(81)90087-5</pub-id>
        <pub-id pub-id-type="pmid">7265238</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Arratia</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Waterman</surname>
          <given-names>MS</given-names>
        </name>
        <article-title>A phase transition for the score in matching random sequences allowing deletions</article-title>
        <source>Ann Appl Probab</source>
        <year>1994</year>
        <volume>4</volume>
        <issue>1</issue>
        <fpage>200</fpage>
        <lpage>225</lpage>
        <pub-id pub-id-type="doi">10.1214/aoap/1177005208</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Dembo</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Karlin</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Zeitouni</surname>
          <given-names>O</given-names>
        </name>
        <article-title>Limit distribution of maximal non-aligned two-sequence segmental score</article-title>
        <source>Ann Probab</source>
        <year>1994</year>
        <volume>22</volume>
        <issue>4</issue>
        <fpage>2022</fpage>
        <lpage>2039</lpage>
        <pub-id pub-id-type="doi">10.1214/aop/1176988493</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Altschul</surname>
          <given-names>SF</given-names>
        </name>
        <name>
          <surname>Bundschuh</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Olsen</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Hwa</surname>
          <given-names>T</given-names>
        </name>
        <article-title>The estimation of statistical parameters for local alignment score distributions</article-title>
        <source>Nucleic Acids Res</source>
        <year>2001</year>
        <volume>29</volume>
        <issue>2</issue>
        <fpage>351</fpage>
        <lpage>361</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/29.2.351</pub-id>
        <pub-id pub-id-type="pmid">11139604</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="book">
        <name>
          <surname>Bundschuh</surname>
          <given-names>R</given-names>
        </name>
        <person-group person-group-type="editor">Shamir R, Miyano S, Istrail S, Pevzner P, Waterman MS</person-group>
        <article-title>An analytic approach to significance assessment in local sequence alignment with gaps</article-title>
        <source>Proceedings of the fourth annual international conference on computational molecular biology (RECOMB 2000)</source>
        <year>2000</year>
        <publisher-name>New York: ACM press</publisher-name>
        <fpage>86</fpage>
        <lpage>95</lpage>
        <comment>full_text</comment>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Sadreyev</surname>
          <given-names>RI</given-names>
        </name>
        <name>
          <surname>Grishin</surname>
          <given-names>NV</given-names>
        </name>
        <article-title>Accurate statistical model of comparison between multiple sequence alignments</article-title>
        <source>Nucleic Acids Res</source>
        <year>2008</year>
        <volume>36</volume>
        <issue>7</issue>
        <fpage>2240</fpage>
        <lpage>2248</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkn065</pub-id>
        <pub-id pub-id-type="pmid">18285364</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Murzin</surname>
          <given-names>AG</given-names>
        </name>
        <name>
          <surname>Brenner</surname>
          <given-names>SE</given-names>
        </name>
        <name>
          <surname>Hubbard</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Chothia</surname>
          <given-names>C</given-names>
        </name>
        <article-title>SCOP: a structural classification of proteins database for the investigation of sequences and structures</article-title>
        <source>J Mol Biol</source>
        <year>1995</year>
        <volume>247</volume>
        <issue>4</issue>
        <fpage>536</fpage>
        <lpage>540</lpage>
        <pub-id pub-id-type="pmid">7723011</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Zhang</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Skolnick</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Scoring function for automated assessment of protein structure template quality</article-title>
        <source>Proteins</source>
        <year>2004</year>
        <volume>57</volume>
        <issue>4</issue>
        <fpage>702</fpage>
        <lpage>710</lpage>
        <pub-id pub-id-type="doi">10.1002/prot.20264</pub-id>
        <pub-id pub-id-type="pmid">15476259</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Holm</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Sander</surname>
          <given-names>C</given-names>
        </name>
        <article-title>Protein structure comparison by alignment of distance matrices</article-title>
        <source>J Mol Biol</source>
        <year>1993</year>
        <volume>233</volume>
        <issue>1</issue>
        <fpage>123</fpage>
        <lpage>138</lpage>
        <pub-id pub-id-type="doi">10.1006/jmbi.1993.1489</pub-id>
        <pub-id pub-id-type="pmid">8377180</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Cheng</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Kim</surname>
          <given-names>BH</given-names>
        </name>
        <name>
          <surname>Grishin</surname>
          <given-names>NV</given-names>
        </name>
        <article-title>Discrimination between distant homologs and structural analogs: lessons from manually constructed, reliable data sets</article-title>
        <source>J Mol Biol</source>
        <year>2008</year>
        <volume>377</volume>
        <issue>4</issue>
        <fpage>1265</fpage>
        <lpage>1278</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jmb.2007.12.076</pub-id>
        <pub-id pub-id-type="pmid">18313074</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kryshtafovych</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Venclovas</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Fidelis</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Moult</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Progress over the first decade of CASP experiments</article-title>
        <source>Proteins</source>
        <year>2005</year>
        <volume>61</volume>
        <issue>Suppl 7</issue>
        <fpage>225</fpage>
        <lpage>236</lpage>
        <pub-id pub-id-type="doi">10.1002/prot.20740</pub-id>
        <pub-id pub-id-type="pmid">16187365</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Qi</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Sadreyev</surname>
          <given-names>RI</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Kim</surname>
          <given-names>BH</given-names>
        </name>
        <name>
          <surname>Grishin</surname>
          <given-names>NV</given-names>
        </name>
        <article-title>A comprehensive system for evaluation of remote sequence similarity detection</article-title>
        <source>BMC Bioinformatics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>314</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-8-314</pub-id>
        <pub-id pub-id-type="pmid">17725841</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Šali</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Blundell</surname>
          <given-names>TL</given-names>
        </name>
        <article-title>Comparative protein modelling by satisfaction of spatial restraints</article-title>
        <source>J Mol Biol</source>
        <year>1993</year>
        <volume>234</volume>
        <issue>3</issue>
        <fpage>779</fpage>
        <lpage>815</lpage>
        <pub-id pub-id-type="doi">10.1006/jmbi.1993.1626</pub-id>
        <pub-id pub-id-type="pmid">8254673</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="other">
        <name>
          <surname>Zemla</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Venclovas</surname>
        </name>
        <name>
          <surname>Moult</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Fidelis</surname>
          <given-names>K</given-names>
        </name>
        <article-title>Processing and evaluation of predictions in CASP4</article-title>
        <source>Proteins</source>
        <year>2001</year>
        <issue>Suppl 5</issue>
        <fpage>13</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1002/prot.10052</pub-id>
        <pub-id pub-id-type="pmid">11835478</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Siew</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Elofsson</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Rychlewski</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Fischer</surname>
          <given-names>D</given-names>
        </name>
        <article-title>MaxSub: an automated measure for the assessment of protein structure prediction quality</article-title>
        <source>Bioinformatics</source>
        <year>2000</year>
        <volume>16</volume>
        <issue>9</issue>
        <fpage>776</fpage>
        <lpage>785</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/16.9.776</pub-id>
        <pub-id pub-id-type="pmid">11108700</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kozbial</surname>
          <given-names>PZ</given-names>
        </name>
        <name>
          <surname>Mushegian</surname>
          <given-names>AR</given-names>
        </name>
        <article-title>Natural history of S-adenosylmethionine-binding proteins</article-title>
        <source>BMC Struct Biol</source>
        <year>2005</year>
        <volume>5</volume>
        <fpage>19</fpage>
        <pub-id pub-id-type="doi">10.1186/1472-6807-5-19</pub-id>
        <pub-id pub-id-type="pmid">16225687</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lee</surname>
          <given-names>TT</given-names>
        </name>
        <name>
          <surname>Agarwalla</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Stroud</surname>
          <given-names>RM</given-names>
        </name>
        <article-title>Crystal structure of RumA, an iron-sulfur cluster containing E. coli ribosomal RNA 5-methyluridine methyltransferase</article-title>
        <source>Structure</source>
        <year>2004</year>
        <volume>12</volume>
        <issue>3</issue>
        <fpage>397</fpage>
        <lpage>407</lpage>
        <pub-id pub-id-type="doi">10.1016/j.str.2004.02.009</pub-id>
        <pub-id pub-id-type="pmid">15016356</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Mitrophanov</surname>
          <given-names>AY</given-names>
        </name>
        <name>
          <surname>Borodovsky</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Statistical significance in biological sequence analysis</article-title>
        <source>Brief Bioinform</source>
        <year>2006</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>2</fpage>
        <lpage>24</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbk001</pub-id>
        <pub-id pub-id-type="pmid">16761361</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B36">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kolodny</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Petrey</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Honig</surname>
          <given-names>B</given-names>
        </name>
        <article-title>Protein structure comparison: implications for the nature of 'fold space', and structure and function prediction</article-title>
        <source>Curr Opin Struct Biol</source>
        <year>2006</year>
        <volume>16</volume>
        <issue>3</issue>
        <fpage>393</fpage>
        <lpage>398</lpage>
        <pub-id pub-id-type="doi">10.1016/j.sbi.2006.04.007</pub-id>
        <pub-id pub-id-type="pmid">16678402</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
