<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//ACS//DTD ACS Journal DTD v1.02 20061031//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName ACSJournal-v102.dtd?>
<?SourceDTD.Version 1.02?>
<?ConverterInfo.XSLTName acs2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Proteome Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">J Proteome Res</journal-id>
    <journal-id journal-id-type="publisher-id">pr</journal-id>
    <journal-id journal-id-type="coden">jprobs</journal-id>
    <journal-title-group>
      <journal-title>Journal of Proteome Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1535-3893</issn>
    <issn pub-type="epub">1535-3907</issn>
    <publisher>
      <publisher-name>American Chemical Society</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9903320</article-id>
    <article-id pub-id-type="pmid">36173614</article-id>
    <article-id pub-id-type="doi">10.1021/acs.jproteome.2c00457</article-id>
    <article-categories>
      <subj-group>
        <subject>Technical Note</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>compareMS2 2.0:
An Improved Software for Comparing
Tandem Mass Spectrometry Datasets</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="ath1">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-1220-9173</contrib-id>
        <name>
          <surname>Marissen</surname>
          <given-names>Rob</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">†</xref>
      </contrib>
      <contrib contrib-type="author" id="ath2">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-9011-5642</contrib-id>
        <name>
          <surname>Varunjikar</surname>
          <given-names>Madhushri S.</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">‡</xref>
      </contrib>
      <contrib contrib-type="author" id="ath3">
        <name>
          <surname>Laros</surname>
          <given-names>Jeroen F. J.</given-names>
        </name>
        <xref rid="aff3" ref-type="aff">§</xref>
        <xref rid="aff4" ref-type="aff">∥</xref>
      </contrib>
      <contrib contrib-type="author" id="ath4">
        <name>
          <surname>Rasinger</surname>
          <given-names>Josef D.</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">‡</xref>
      </contrib>
      <contrib contrib-type="author" id="ath5">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-6120-7695</contrib-id>
        <name>
          <surname>Neely</surname>
          <given-names>Benjamin A.</given-names>
        </name>
        <xref rid="aff5" ref-type="aff">⊥</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="ath6">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-5865-8994</contrib-id>
        <name>
          <surname>Palmblad</surname>
          <given-names>Magnus</given-names>
        </name>
        <xref rid="cor1" ref-type="other">*</xref>
        <xref rid="aff1" ref-type="aff">†</xref>
      </contrib>
      <aff id="aff1"><label>†</label>Center
for Proteomics and Metabolomics, <institution>Leiden
University Medical Center</institution>, Postbus 9600, 2300 RC Leiden, <country>The Netherlands</country></aff>
      <aff id="aff2"><label>‡</label><institution>Institute
of Marine Research</institution>, P.O. Box 1870
Nordnes, 5817 Bergen, <country>Norway</country></aff>
      <aff id="aff3"><label>§</label><institution>National
Institute for Public Health and the Environment</institution>, 3720 BA Bilthoven, <country>The Netherlands</country></aff>
      <aff id="aff4"><label>∥</label>Department
of Human Genetics, <institution>Leiden University Medical
Center</institution>, Postbus 9600, 2300
RC Leiden, <country>The Netherlands</country></aff>
      <aff id="aff5"><label>⊥</label><institution>National
Institute of Standards and Technology</institution>, Charleston, South Carolina 29412, <country>United States</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>*</label>Email: <email>n.m.palmblad@lumc.nl</email>. Phone: <phone>+31 71 5266969</phone>.</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>09</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <day>03</day>
      <month>02</month>
      <year>2023</year>
    </pub-date>
    <volume>22</volume>
    <issue>2</issue>
    <issue-title>Software Tools and Resources 2023</issue-title>
    <fpage>514</fpage>
    <lpage>519</lpage>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>07</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2022 The Authors. Published by American Chemical Society</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>The Authors</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>Permits the broadest form of re-use including for commercial purposes, provided that author attribution and integrity are maintained (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>).</license-p>
      </license>
    </permissions>
    <abstract>
      <p content-type="toc-graphic">
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_0005" id="ab-tgr1"/>
      </p>
      <p>It has long been
known that biological species can be identified
from mass spectrometry data alone. Ten years ago, we described a method
and software tool, compareMS2, for calculating a distance between
sets of tandem mass spectra, as routinely collected in proteomics.
This method has seen use in species identification and mixture characterization
in food and feed products, as well as other applications. Here, we
present the first major update of this software, including a new metric,
a graphical user interface and additional functionality. The data
have been deposited to ProteomeXchange with dataset identifier PXD034932.</p>
    </abstract>
    <kwd-group>
      <kwd>compareMS2</kwd>
      <kwd>distance metric</kwd>
      <kwd>molecular
phylogenetics</kwd>
      <kwd>tandem mass spectrometry</kwd>
      <kwd>quality
control</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>document-id-old-9</meta-name>
        <meta-value>pr2c00457</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>document-id-new-14</meta-name>
        <meta-value>pr2c00457</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>ccc-price</meta-name>
        <meta-value/>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <title>Introduction</title>
    <p>A
decade ago, Palmblad and Deelder<sup><xref ref-type="bibr" rid="ref1">1</xref></sup> first
described a method for molecular phylogenetics based on direct comparison
of tandem mass spectra. The method has since seen a range of applications,
including food<sup><xref ref-type="bibr" rid="ref2">2</xref>,<xref ref-type="bibr" rid="ref3">3</xref></sup> and feed<sup><xref ref-type="bibr" rid="ref4">4</xref>−<xref ref-type="bibr" rid="ref7">7</xref></sup> species identification, quality
control,<sup><xref ref-type="bibr" rid="ref8">8</xref></sup> and experimental design.<sup><xref ref-type="bibr" rid="ref9">9</xref></sup> Similar works include the DISMS2 library by Rieder
and colleagues<sup><xref ref-type="bibr" rid="ref10">10</xref></sup> and MS1-only methods for
“sequence-free” phylogenetics reviewed by Downard.<sup><xref ref-type="bibr" rid="ref11">11</xref></sup> Neely and Palmblad<sup><xref ref-type="bibr" rid="ref12">12</xref></sup> recently placed these methods in a larger historical context, going
all the way back to the seminal comparison of separated tryptic peptides
across species by Zuckerkandl, Jones, and Pauling in 1960.<sup><xref ref-type="bibr" rid="ref13">13</xref></sup> Here, we describe a new and significantly updated
version of the original compareMS2 software, with several improvements,
including a graphical user interface (GUI) controlling all steps of
the analysis and dynamic phylogenetic tree display, a fully symmetric
distance metric, and many additional filters and output options, which
we describe in this technical note.</p>
  </sec>
  <sec id="sec2">
    <title>Methods</title>
    <sec id="sec2.1">
      <title>Symmetric Distance
Measure</title>
      <p>The original compareMS2
compared two sets of tandem mass spectra, e.g., those resulting from
liquid chromatography–tandem mass spectrometry, by scanning
one set and for each spectrum finding the best match in the other
set (within precursor <italic>m</italic>/<italic>z</italic> and retention
time tolerances). The results depended on which set was scanned, and
the distance metric was only approximately symmetric. compareMS2 2.0
has a perfectly symmetric measure of the distance between sets of
tandem mass spectra regardless of order of input. In this section,
we describe this modified measure and some of its properties.</p>
    </sec>
    <sec id="sec2.2">
      <title>Comparing
Pairs of Spectra</title>
      <p>The comparison between sets
of tandem mass spectra starts with the comparison of pairs of spectra.
There are many measures of spectral similarity. compareMS2 supports
the cosine score (dot product) and spectral angle. By default, compareMS2
uses the cosine score, i.e., the cosine of the angle between the vector
representations of the spectra, after normalizing both spectra to
unit length:<disp-formula id="eq1"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m001" position="anchor"/><label>1</label></disp-formula>where θ
is the angle between the vector
representations of the two spectra. <xref rid="eq1" ref-type="disp-formula">Equation <xref rid="eq1" ref-type="disp-formula">1</xref></xref> is symmetric in <italic>a</italic> and <italic>b</italic>.</p>
      <p>Optionally, compareMS2 can first scale spectra
to reduce the influence of very intense peaks, e.g., by taking the
square or cube root of all intensities. All peaks below a user-defined
or automatically detected relative or absolute background can also
be excluded from the similarity calculation.</p>
    </sec>
    <sec id="sec2.3">
      <title>Comparing Sets of Spectra</title>
      <p>compareMS2 2.0 defines the
similarity between two sets of tandem mass spectra, <inline-formula id="d33e284"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m002.gif"/></inline-formula> and <inline-formula id="d33e287"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m003.gif"/></inline-formula> as follows.
If for a spectrum <italic>a</italic>∈<inline-formula id="d33e293"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m004.gif"/></inline-formula> we find a
spectrum <italic>b</italic>∈<inline-formula id="d33e300"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m005.gif"/></inline-formula> with <italic>s</italic>(<italic>a</italic>,<italic>b</italic>) greater than or
equal to a minimum similarity
threshold <italic>s</italic><sub>min</sub>, we say that <italic>a</italic> has a similar spectrum in <inline-formula id="d33e321"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m006.gif"/></inline-formula>. We then define
a subset <inline-formula id="d33e324"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m007.gif"/></inline-formula>⊂<inline-formula id="d33e327"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m008.gif"/></inline-formula>, given <inline-formula id="d33e330"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m009.gif"/></inline-formula>, of all spectra
in <inline-formula id="d33e333"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m010.gif"/></inline-formula> with at least
one similar spectrum in <inline-formula id="d33e337"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m011.gif"/></inline-formula> as<disp-formula id="eq2"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m012" position="anchor"/><label>2</label></disp-formula>and a corresponding subset <inline-formula id="d33e346"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m013.gif"/></inline-formula>⊂<inline-formula id="d33e349"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m014.gif"/></inline-formula> as<disp-formula id="eq3"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m015" position="anchor"/><label>3</label></disp-formula></p>
      <p>We then define a global similarity
between sets <inline-formula id="d33e359"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m016.gif"/></inline-formula> ≠
Ø and <inline-formula id="d33e362"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m017.gif"/></inline-formula> ≠
Ø, <italic>S</italic>(<inline-formula id="d33e368"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m018.gif"/></inline-formula>,<inline-formula id="d33e371"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m019.gif"/></inline-formula>), as the average
of the fraction of spectra
in <inline-formula id="d33e375"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m020.gif"/></inline-formula> with at least
one similar spectrum in <inline-formula id="d33e378"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m021.gif"/></inline-formula> and the fraction
of spectra in <inline-formula id="d33e381"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m022.gif"/></inline-formula> with
at least one similar spectrum in <inline-formula id="d33e384"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m023.gif"/></inline-formula>:<disp-formula id="eq4"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m024" position="anchor"/><label>4</label></disp-formula>where |<inline-formula id="d33e394"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m025.gif"/></inline-formula>| denotes
the cardinality, the number of
elements, in a set <inline-formula id="d33e397"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m026.gif"/></inline-formula>. Though
in some use cases it may be meaningful
to define the similarity between two empty sets, i.e., LC-MS/MS datasets
without tandem mass spectra, or the similarity between an empty and
a non-empty set, we have chosen to leave these undefined and have
the compareMS2 output reflect this. We believe this makes sense as
a dataset without tandem mass spectra usually suggests something went
wrong during measurement. Values can always be imputed after the compareMS2
runs, and rows with undefined values in the distance matrix can be
excluded in subsequent analyses in most phylogenetic software.</p>
      <p>From the symmetry of <xref rid="eq4" ref-type="disp-formula">eq <xref rid="eq4" ref-type="disp-formula">4</xref></xref>, we see that <italic>S</italic>(<inline-formula id="d33e409"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m027.gif"/></inline-formula>,<inline-formula id="d33e412"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m028.gif"/></inline-formula>) = <italic>S</italic>(<inline-formula id="d33e419"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m029.gif"/></inline-formula>,<inline-formula id="d33e422"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m030.gif"/></inline-formula>). We also
note that both terms in <xref rid="eq4" ref-type="disp-formula">eq <xref rid="eq4" ref-type="disp-formula">4</xref></xref> are non-negative, therefore <italic>S</italic>(<inline-formula id="d33e432"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m031.gif"/></inline-formula>,<inline-formula id="d33e435"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m032.gif"/></inline-formula>) ≥
0. The maximum value of <italic>S</italic>(<inline-formula id="d33e442"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m033.gif"/></inline-formula>,<inline-formula id="d33e445"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m034.gif"/></inline-formula>) is 1 when
all spectra in <inline-formula id="d33e448"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m035.gif"/></inline-formula> have
a similar spectrum in <inline-formula id="d33e451"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m036.gif"/></inline-formula> and vice versa.
The minimum value is 0
when <inline-formula id="d33e454"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m037.gif"/></inline-formula> and <inline-formula id="d33e458"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m038.gif"/></inline-formula> have no similar
spectra. The smallest positive
value of <italic>S</italic>(<inline-formula id="d33e464"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m039.gif"/></inline-formula>,<inline-formula id="d33e467"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m040.gif"/></inline-formula>) occurs when
there is exactly one pair
of similar spectra in <inline-formula id="d33e470"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m041.gif"/></inline-formula> and <inline-formula id="d33e473"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m042.gif"/></inline-formula>:<disp-formula id="eq5"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m043" position="anchor"/><label>5</label></disp-formula></p>
      <p>Finally, we arrive at the global distance measure, <italic>D</italic>(<inline-formula id="d33e487"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m044.gif"/></inline-formula>,<inline-formula id="d33e490"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m045.gif"/></inline-formula>), which we
define as the inverse of <italic>S</italic>(<inline-formula id="d33e496"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m046.gif"/></inline-formula>,<inline-formula id="d33e500"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m047.gif"/></inline-formula>) minus one
when <italic>S</italic>(<inline-formula id="d33e506"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m048.gif"/></inline-formula>,<inline-formula id="d33e509"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m049.gif"/></inline-formula>) is positive,
and as the inverse of half
of the smallest positive value of <italic>S</italic>(<inline-formula id="d33e515"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m050.gif"/></inline-formula>,<inline-formula id="d33e519"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m051.gif"/></inline-formula>) minus one
when <italic>S</italic>(<inline-formula id="d33e525"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m052.gif"/></inline-formula>,<inline-formula id="d33e528"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m053.gif"/></inline-formula>) is zero:<disp-formula id="eq6"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m054" position="anchor"/><label>6</label></disp-formula>Since <italic>S</italic>(<inline-formula id="d33e541"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m055.gif"/></inline-formula>,<inline-formula id="d33e544"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m056.gif"/></inline-formula>) is symmetric, <italic>D</italic>(<inline-formula id="d33e550"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m057.gif"/></inline-formula>,<inline-formula id="d33e553"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m058.gif"/></inline-formula>) is also symmetric.
Note that <italic>D</italic>(<inline-formula id="d33e560"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m059.gif"/></inline-formula>,<inline-formula id="d33e563"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m060.gif"/></inline-formula>) → <italic>∞</italic> as
|<inline-formula id="d33e569"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m061.gif"/></inline-formula>| → <italic>∞</italic>∧|<inline-formula id="d33e576"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m062.gif"/></inline-formula>| → <italic>∞</italic>,and
there are no similar spectra in <inline-formula id="d33e582"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m063.gif"/></inline-formula> and <inline-formula id="d33e585"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m064.gif"/></inline-formula>. In the special
case of <inline-formula id="d33e588"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m065.gif"/></inline-formula> and <inline-formula id="d33e591"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m066.gif"/></inline-formula> both containing
a single spectrum, <italic>D</italic>(<inline-formula id="d33e598"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m067.gif"/></inline-formula>,<inline-formula id="d33e601"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m068.gif"/></inline-formula>) is 0 if the
spectra are similar and 1
otherwise. The definition of the distance between sets with <italic>S</italic>(<inline-formula id="d33e607"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m069.gif"/></inline-formula>,<inline-formula id="d33e610"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m070.gif"/></inline-formula>) = 0 correspond
to <inline-formula id="d33e614"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m071.gif"/></inline-formula> and <inline-formula id="d33e617"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m072.gif"/></inline-formula> having a hypothetical
half matching spectrum.
In most real-world use cases, both <inline-formula id="d33e620"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m073.gif"/></inline-formula> and <inline-formula id="d33e623"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m074.gif"/></inline-formula> would contain
thousands of spectra.</p>
      <p>Two co-directional spectra—spectra
whose vector representations
differ only by a factor—are considered identical by <italic>s</italic>. Therefore, datasets containing perfectly co-directional
spectra would have a global similarity <italic>S</italic> = 1 and
distance <italic>D</italic> = 0. Strictly speaking, <italic>D</italic> is not a metric in the mathematical sense, as the identity of indiscernibles
(<italic>D</italic>(<inline-formula id="d33e644"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m075.gif"/></inline-formula>,<inline-formula id="d33e647"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m076.gif"/></inline-formula>) = 0 ⇔ <inline-formula id="d33e650"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m077.gif"/></inline-formula> = <inline-formula id="d33e653"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m078.gif"/></inline-formula>) no longer
holds after normalizing the
spectra. This is by design, as the absolute intensities in a tandem
mass spectrum depend not only on the peptide sequence and abundance,
but also at which point or points during the chromatographic peak
the peptide was selected for MS/MS, which is generally not reproducible.</p>
      <p>As comparing all tandem mass spectra is computationally expensive,
especially for large datasets. compareMS2 allows approximation of <italic>D</italic>(<inline-formula id="d33e661"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m079.gif"/></inline-formula>,<inline-formula id="d33e664"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m080.gif"/></inline-formula>) by only comparing
a spectrum <italic>a</italic>∈<inline-formula id="d33e670"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m081.gif"/></inline-formula> with those
spectra <italic>b</italic>∈<inline-formula id="d33e677"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m082.gif"/></inline-formula> that fall
within user-defined windows of
retention time or scan number, and precursor <italic>m</italic>/<italic>z</italic>.</p>
    </sec>
    <sec id="sec2.4">
      <title>compareMS2 Pipeline</title>
      <p>compareMS2 takes
as minimum input
a directory of MGF files to be compared. We choose MGF as the default
input format, as it is convenient for storing MS2-only data and the
MGF files can easily be filtered, split or combined, which may be
useful in some applications of compareMS2, such as when fractionating
samples or removing nonpeptide spectra. Most vendor software as well
as msconvert<sup><xref ref-type="bibr" rid="ref14">14</xref></sup> can convert raw data or
mzML files to MGF. To provide faster feedback to the user, compareMS2
2.0 interleaves distance matrix calculations, updates and displays
a phylogenetic tree as each row of the distance matrix is completed
(<xref rid="fig1" ref-type="fig">Figure <xref rid="fig1" ref-type="fig">1</xref></xref>). With the
default symmetric metric, this matrix is triangular, hence the tree
is updated rapidly in the beginning, after the first comparison, and
then again after the next two comparisons etc. Version 2.0 also provides
additional functionality, such as recording a quality control metric
for each dataset (by default the number of tandem mass spectra in
the dataset) and a filter to compare only the top-<italic>N</italic> most intense tandem mass spectra from each dataset. The datasets
can be compared in alphabetical, size or random order. By default,
compareMS2 outputs a MEGA (.meg) file, but Newick and NEXUS formats
are also supported.</p>
      <fig id="fig1" position="float">
        <label>Figure 1</label>
        <caption>
          <p>CompareMS2 2.0 workflow, orchestrated by the graphical
user interface.
After parsing and checking the input parameters, ensuring all files
are present and in the correct format, compareMS2 performs (<italic>N</italic><sup>2</sup> – <italic>N</italic>)/2 pairwise comparisons
of <italic>N</italic> datasets using the symmetric distance measure
described below, or <italic>N</italic><sup>2</sup> – <italic>N</italic> comparisons if the original measure is used. After each
row is completed, compareMS2 updates the (strictly triangular) distance
matrix and generates a new tree. This allows the user to monitor progress
and terminate and restart the run if necessary. If the original measure
is used, compareMS2 by default creates both the strictly upper and
lower triangular distance matrices (these can be averaged in phylogenetics
software such as MEGA).</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_0001" id="gr1" position="float"/>
      </fig>
    </sec>
    <sec id="sec2.5">
      <title>compareMS2 GUI</title>
      <p>Technically, compareMS2 2.0 combines
two software tools, which can also be run individually on the command
line. The first component compares two datasets, e.g., from LC-MS/MS.
The second component takes several such comparisons, combines samples
from the same biological species, and computes a distance matrix.
The graphical user interface (<xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref>) was designed to be simple to use, hiding most of
the internal complexity of compareMS2, including the interleaved execution
order of the two components (<xref rid="fig1" ref-type="fig">Figure <xref rid="fig1" ref-type="fig">1</xref></xref>).</p>
      <fig id="fig2" position="float">
        <label>Figure 2</label>
        <caption>
          <p>compareMS2 2.0 GUI, showing the output panel from the
beginning
of an analysis of 24 datasets, each containing 1000 tandem mass spectra,
from six primate species for a total of (24<sup>2</sup> – 24)/2
= 276 comparisons. With default parameters, these comparisons take
3 min on a PC with an Intel Xeon W-2135 CPU running at 3.70 GHz. The
node text color in the tree represents data quality, the default metric
being the number of tandem mass spectra per species.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_0002" id="gr2" position="float"/>
      </fig>
    </sec>
    <sec id="sec2.6">
      <title>Source Code and Availability</title>
      <p>The compareMS2 source
code can freely be downloaded from <uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/524D/compareMS2">https://github.com/524D/compareMS2</uri>. On Windows, the software can be installed using a simple installer.
compareMS has been tested on Windows 10, Ubuntu 20.04 Linux and MacOS
12. The GUI is based on Electron (<uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.electronjs.org/">https://www.electronjs.org/</uri>) and is written in Javascript, HTML, and CSS. It uses the phylotree.js
library<sup><xref ref-type="bibr" rid="ref15">15</xref></sup> to render the graphical tree
representation. Conversion of the distance matrix into Newick format
uses the UPGMA method is and is also implemented in JavaScript. The
distance computation and distance matrix creation are performed by
two command-line programs written in C. These can be used to run compareMS
without the GUI. Source code and prebuild executables of the command-line
tools can be found in the external_binaries directory of the compareMS2
repository.</p>
    </sec>
    <sec id="sec2.7">
      <title>Experimental Features</title>
      <p>As compareMS2
provides a basic
framework for comparing tandem mass spectra across datasets, we have
begun to add experimental features to help visualize such comparisons.
The first of these experimental outputs is a two-dimensional histogram
of precursor <italic>m</italic>/<italic>z</italic> difference and
spectral similarity for all comparisons of spectra between two datasets.
These features will only be available on the command-line, and require
additional software such as R to generate figures, but allow for example
correlating spectral similarity with precursor mass difference. Scripting
examples in R are available on <uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://osf.io/jey28/">https://osf.io/jey28/</uri>.</p>
    </sec>
    <sec id="sec2.8">
      <title>Testing</title>
      <p>To demonstrate the features and performance
of compareMS2 2.0, we used previously published amaZon ion trap (Bruker
Daltonics) and Orbitrap Fusion Lumos (Thermo Fisher Scientific) data
from primate sera and an <italic>E. coli</italic> lysate.<sup><xref ref-type="bibr" rid="ref1">1</xref>,<xref ref-type="bibr" rid="ref12">12</xref></sup> In addition, we used new data acquired on the same Orbitrap instrument
and as described in<sup><xref ref-type="bibr" rid="ref12">12</xref></sup> from California sea
lion (<italic>Zalophus californianus</italic>), dog
(<italic>Canis lupus familiaris</italic>), rock hyrax
(<italic>Procavia capensis</italic>), and white-tailed
deer (<italic>Odocoileus virginianus</italic>) sera.
The mass spectrometry proteomics data have been deposited to the ProteomeXchange
Consortium via the PRIDE<sup><xref ref-type="bibr" rid="ref16">16</xref></sup> partner repository
with the dataset identifier PXD034932 and 10.6019/PXD034932. Phylogenetic
trees were generated by compareMS2 and MEGA11<sup><xref ref-type="bibr" rid="ref17">17</xref></sup> using default parameters for both (for compareMS2 maximum precursor
mass difference 2.05, score cutoff 0.8, minimum basepeak intensity
10000, minimum total ion current 0, maximum retention time difference
60, start retention time 0, end retention time 100000, maximum scan
number difference 10000, start scan 1, end scan 1000000, scaling 0.5,
noise 10, version of set distance metric 2, version of QC metric 0,
compare only the N most intense spectra set to “All”,
output format “MEGA”,and compare order “Smallest-largest
first”, and for MEGA11 “Lower Left Matrix” and
“Pairwise Distance” input data for UPGMA Phylogeny Analysis).</p>
    </sec>
  </sec>
  <sec id="sec3">
    <title>Results and Discussion</title>
    <p>The compareMS2 2.0 GUI (<xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref>) displays a phylogenetic
tree with a quality metric
mapped to a continuous or divergent color gradient, the tree being
continuously updated to provide real-time feedback to the user. This
allows executions to be paused or terminated at any stage, which may
be useful for large jobs. For example, comparing 100 LC-MS/MS datasets
require 4950 pairwise comparisons, taking several hours. But already
after six pairwise comparisons of four datasets, trees can be quite
informative and reveal if there is an issue with the input files or
parameters.</p>
    <p>Using the five new serum datasets, each containing
between 42,629
and 47,626 tandem mass spectra, we could reconstruct the correct phylogenetic
tree in compareMS2 and MEGA11 (<xref rid="fig3" ref-type="fig">Figure <xref rid="fig3" ref-type="fig">3</xref></xref>). The 10 pairwise comparisons in compareMS2 took 40
min with default parameters on a PC with an Intel Xeon W-2135 CPU
running at 3.70 GHz. The analyses can be accelerated by comparing
spectra within a more narrow <italic>m</italic>/<italic>z</italic> window than the default value of 2.05. Each comparison is independent,
so in principle the problem is embarrassingly parallel.</p>
    <fig id="fig3" position="float">
      <label>Figure 3</label>
      <caption>
        <p>Phylogenetic
analysis in MEGA11 based on Orbitrap Fusion Lumos
LC-MS/MS datasets of sera from (top to bottom) two California sea
lions (<italic>Zalophus californianus</italic>), dog
(<italic>Canis lupus familiaris</italic>), white-tailed
deer (<italic>Odocoileus virginianus</italic>), and
rock hyrax (<italic>Procavia capensis</italic>). The
evolutionary history was inferred using the UPGMA method.<sup><xref ref-type="bibr" rid="ref18">18</xref></sup> The optimal tree is shown and drawn to scale,
with branch lengths in the same units as those generated by compareMS2
and used to infer the phylogenetic tree. Taxon images are from PhyloPic.</p>
      </caption>
      <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_0003" id="gr3" position="float"/>
    </fig>
    <p>To test one of the experimental features, we compared
the similarity
between tandem mass spectra as a function of precursor <italic>m</italic>/<italic>z</italic> difference for comparisons between two closely
related species - human and chimpanzee - as well as two species with
few shared tryptic peptides—human and <italic>E. coli</italic> (<xref rid="fig4" ref-type="fig">Figure <xref rid="fig4" ref-type="fig">4</xref></xref>). These
comparisons reveal information on spectral similarity, but also on
mass measurement precision, charge states and isotope errors <italic>before</italic> and independent of any database search, where such
parameters typically have to be provided. In these datasets, charge
states up to [M + 6H]<sup>6+</sup> and isotope errors up to at least
3 Da are observed. The analysis can also be used to estimate suitable
parameters for compareMS2, e.g., <italic>m</italic>/<italic>z</italic> windows and spectral similarity thresholds. We also observe some
unexpected side bands most noticeable at 1/2 and 1/3 Da, but not near
zero, in the Orbitrap data. These bands are also seen in comparisons
of spectra within individual datasets.</p>
    <fig id="fig4" position="float">
      <label>Figure 4</label>
      <caption>
        <p>Similarity of tandem
mass spectra as a function of precursor <italic>m</italic>/<italic>z</italic> difference in Orbitrap Fusion Lumos
(A,B) and amaZon ion trap data (C,D), comparing similar (human and
chimpanzee sera) and dissimilar (human serum and <italic>E. coli</italic>) samples. Panels A and B compare two LC-MS/MS runs, and panels C
and D compare four runs per species (16 comparisons). Similar spectra
have precursor <italic>m</italic>/<italic>z</italic> differences near
zero or a near a rational number corresponding to the isotope error
at a specific charge state (shown more clearly in panel E, generated
from 8 Orbitrap human serum datasets).</p>
      </caption>
      <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_0004" id="gr4" position="float"/>
    </fig>
    <p>When combined with posterior error probability estimators such
as PeptideProphet<sup><xref ref-type="bibr" rid="ref19">19</xref></sup> or Percolator,<sup><xref ref-type="bibr" rid="ref20">20</xref></sup> spectral similarity measures can in principle
be converted into probabilities for any pair of spectra being derived
from the same or closely related analytes. When searching spectral
libraries, the probability that a query spectrum matches the library
spectrum is multiplied with the original probability that library
spectrum was correctly identified to estimate the probability the
query spectrum is correctly matched to a peptide or other analyte.
The compareMS2 software uses the spectral similarity in <xref rid="eq1" ref-type="disp-formula">eq <xref rid="eq1" ref-type="disp-formula">1</xref></xref> to calculate the overlap between
sets of tandem mass spectra without regard to their identification
to a specific analyte.</p>
    <p>Naïvely, one may attempt to use
something like the Jaccard
similarity, <italic>J</italic>, defined as the cardinality of the
intersection divided by the cardinality of the union<disp-formula id="eq7"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m083" position="anchor"/><label>7</label></disp-formula>However, no two spectra
are exactly the same.
If the criterion for considering two spectra identical (as in derived
from the same peptide) for the purpose of calculating |<inline-formula id="d33e922"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m084.gif"/></inline-formula>∩<inline-formula id="d33e925"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m085.gif"/></inline-formula>| and |<inline-formula id="d33e928"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m086.gif"/></inline-formula>∪<inline-formula id="d33e932"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m087.gif"/></inline-formula>| is too strict,
then one will underestimate
|<inline-formula id="d33e935"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m088.gif"/></inline-formula>∩<inline-formula id="d33e938"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m089.gif"/></inline-formula>| and overestimate
|<inline-formula id="d33e941"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m090.gif"/></inline-formula>∪<inline-formula id="d33e944"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m091.gif"/></inline-formula>|. If the criterion
is too lax, then one
overestimates |<inline-formula id="d33e947"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m092.gif"/></inline-formula>∩<inline-formula id="d33e951"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m093.gif"/></inline-formula>| and underestimates
|<inline-formula id="d33e954"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m094.gif"/></inline-formula>∪<inline-formula id="d33e957"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m095.gif"/></inline-formula>|. In either
case, the errors would multiply,
making the Jaccard similarity very sensitive to the precise definition
of when two spectra are considered identical. Even more problematic
is the intransitive nature of this identity, which is exacerbated
by chimeric spectra—spectra that are superpositions of two
or more peptide tandem mass spectra. Briefly, a pure spectrum from
peptide <italic>P</italic> can be considered identical to a chimeric
spectrum with a small contribution from a second, cofragmenting peptide <italic>Q</italic>, which in turn is identical to a chimeric spectrum with
slightly larger contribution from peptide <italic>Q</italic>, and
so on, eventually ending up with the pure spectrum of peptide <italic>Q</italic>, which can be very different from the original spectrum
from peptide <italic>P</italic>, just like messages in a game of telephone.
This is why exercises clustering large numbers of tandem mass spectra
based on spectral similarity tend to produce large globs of spectra
rather than a distinct cluster for each peptide.</p>
  </sec>
  <sec id="sec4">
    <title>Conclusions</title>
    <p>compareMS2
compares sets of tandem mass spectra to each other rather
than to predicted spectra of specific peptides as when identifying
proteins from tandem mass spectra. We have used examples from molecular
phylogenetics, but many other uses have been demonstrated, including
food and feed identification, mixture analysis and experimental design.
compareMS2 may also be used data quality control - comparing large
numbers of datasets prior to database search and protein quantitation
to detect outliers and possible batch effects. The visualization of
spectral similarity as a function of precursor mass difference gives
another window into the data, and can suggest parameters for database
searches a priori. We make compareMS2 freely available as open source
and provide an automatic installer for Microsoft Windows in hope that
it may be as useful to others as it has been for us.</p>
  </sec>
</body>
<back>
  <notes notes-type="COI-statement" id="NOTES-d14e1467-autogenerated">
    <p>The authors declare
no
competing financial interest.</p>
  </notes>
  <ack>
    <title>Acknowledgments</title>
    <p>Tandem mass spectrometry data used for clustering
of California sea lion, chimpanzee, dog, human, rock hyrax, and white-tailed
deer serum were graciously provided with permission from an ongoing
collaboration with Dr. Michael G. Janech (College of Charleston) as
part of the CoMPARe Program (Comparative Mammalian Proteome Aggregator
Resource). Specifically, the California sea lion sera were provided
by The Marine Mammal Center (Sausalito, CA), the chimpanzee, rock
hyrax, and white-tailed deer sera were provided by The Chattanooga
Zoo, and the dog serum from Gus (Ohlandt Veterinary Clinic, Charleston,
SC). In addition to institutional and NMFS permits and approval, data
collection was performed under NIST ACUC MML-AR20-0001. The identification
of certain commercial equipment, instruments, software, or materials
does not imply recommendation or endorsement by the National Institute
of Standards and Technology, nor does it imply that the products identified
are necessarily the best available for the purpose. The authors also
thank all users of previous versions compareMS2 for providing valuable
feedback on the software and its installation on different systems.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="ref1">
      <mixed-citation publication-type="journal" id="cit1"><name><surname>Palmblad</surname><given-names>M.</given-names></name>; <name><surname>Deelder</surname><given-names>A. M.</given-names></name><article-title>Molecular phylogenetics
by direct comparison of tandem
mass spectra</article-title>. <source>Rapid Commun. Mass Spectrom.</source><year>2012</year>, <volume>26</volume>, <fpage>728</fpage>–<lpage>732</lpage>. <pub-id pub-id-type="doi">10.1002/rcm.6162</pub-id>.<pub-id pub-id-type="pmid">22368051</pub-id></mixed-citation>
    </ref>
    <ref id="ref2">
      <mixed-citation publication-type="journal" id="cit2"><name><surname>Wulff</surname><given-names>T.</given-names></name>; <name><surname>Nielsen</surname><given-names>M. E.</given-names></name>; <name><surname>Deelder</surname><given-names>A. M.</given-names></name>; <name><surname>Jessen</surname><given-names>F.</given-names></name>; <name><surname>Palmblad</surname><given-names>M.</given-names></name><article-title>Authentication
of fish products by large-scale comparison of tandem mass spectra</article-title>. <source>J. Proteome Res.</source><year>2013</year>, <volume>12</volume>, <fpage>5253</fpage>–<lpage>5259</lpage>. <pub-id pub-id-type="doi">10.1021/pr4006525</pub-id>.<pub-id pub-id-type="pmid">24032411</pub-id></mixed-citation>
    </ref>
    <ref id="ref3">
      <mixed-citation publication-type="journal" id="cit3"><name><surname>Ohana</surname><given-names>D.</given-names></name>; <name><surname>Dalebout</surname><given-names>H.</given-names></name>; <name><surname>Marissen</surname><given-names>R.</given-names></name>; <name><surname>Wulff</surname><given-names>T.</given-names></name>; <name><surname>Bergquist</surname><given-names>J.</given-names></name>; <name><surname>Deelder</surname><given-names>A.</given-names></name>; <name><surname>Palmblad</surname><given-names>M.</given-names></name><article-title>Identification of meat products by
shotgun spectral matching</article-title>. <source>Food chemistry</source><year>2016</year>, <volume>203</volume>, <fpage>28</fpage>–<lpage>34</lpage>. <pub-id pub-id-type="doi">10.1016/j.foodchem.2016.01.138</pub-id>.<pub-id pub-id-type="pmid">26948585</pub-id></mixed-citation>
    </ref>
    <ref id="ref4">
      <mixed-citation publication-type="journal" id="cit4"><name><surname>Rasinger</surname><given-names>J.</given-names></name>; <name><surname>Marbaix</surname><given-names>H.</given-names></name>; <name><surname>Dieu</surname><given-names>M.</given-names></name>; <name><surname>Fumière</surname><given-names>O.</given-names></name>; <name><surname>Mauro</surname><given-names>S.</given-names></name>; <name><surname>Palmblad</surname><given-names>M.</given-names></name>; <name><surname>Raes</surname><given-names>M.</given-names></name>; <name><surname>Berntssen</surname><given-names>M.</given-names></name><article-title>Species and
tissues specific differentiation of processed animal proteins in aquafeeds
using proteomics tools</article-title>. <source>Journal of proteomics</source><year>2016</year>, <volume>147</volume>, <fpage>125</fpage>–<lpage>131</lpage>. <pub-id pub-id-type="doi">10.1016/j.jprot.2016.05.036</pub-id>.<pub-id pub-id-type="pmid">27268957</pub-id></mixed-citation>
    </ref>
    <ref id="ref5">
      <mixed-citation publication-type="journal" id="cit5"><name><surname>Belghit</surname><given-names>I.</given-names></name>; <name><surname>Lock</surname><given-names>E.-J.</given-names></name>; <name><surname>Fumière</surname><given-names>O.</given-names></name>; <name><surname>Lecrenier</surname><given-names>M.-C.</given-names></name>; <name><surname>Renard</surname><given-names>P.</given-names></name>; <name><surname>Dieu</surname><given-names>M.</given-names></name>; <name><surname>Berntssen</surname><given-names>M. H. G.</given-names></name>; <name><surname>Palmblad</surname><given-names>M.</given-names></name>; <name><surname>Rasinger</surname><given-names>J. D.</given-names></name><article-title>Species-Specific Discrimination of
Insect Meals for Aquafeeds by Direct Comparison of Tandem Mass Spectra</article-title>. <source>Animals: an open access journal from MDPI</source><year>2019</year>, <volume>9</volume>, <fpage>222</fpage><pub-id pub-id-type="doi">10.3390/ani9050222</pub-id>.<pub-id pub-id-type="pmid">31067722</pub-id></mixed-citation>
    </ref>
    <ref id="ref6">
      <mixed-citation publication-type="journal" id="cit6"><name><surname>Belghit</surname><given-names>I.</given-names></name>; et al. <article-title>Future feed control – Tracing banned bovine material in insect
meal</article-title>. <source>Food Control</source><year>2021</year>, <volume>128</volume>, <fpage>108183</fpage><pub-id pub-id-type="doi">10.1016/j.foodcont.2021.108183</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref7">
      <mixed-citation publication-type="journal" id="cit7"><name><surname>Varunjikar</surname><given-names>M. S.</given-names></name>; <name><surname>Belghit</surname><given-names>I.</given-names></name>; <name><surname>Gjerde</surname><given-names>J.</given-names></name>; <name><surname>Palmblad</surname><given-names>M.</given-names></name>; <name><surname>Oveland</surname><given-names>E.</given-names></name>; <name><surname>Rasinger</surname><given-names>J. D.</given-names></name><article-title>Shotgun proteomics
approaches for authentication, biological
analyses, and allergen detection in feed and food-grade insect species</article-title>. <source>Food Control</source><year>2022</year>, <volume>137</volume>, <fpage>108888</fpage><pub-id pub-id-type="doi">10.1016/j.foodcont.2022.108888</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref8">
      <mixed-citation publication-type="journal" id="cit8"><name><surname>van
der Plas-Duivesteijn</surname><given-names>S. J.</given-names></name>; <name><surname>Mohammed</surname><given-names>Y.</given-names></name>; <name><surname>Dalebout</surname><given-names>H.</given-names></name>; <name><surname>Meijer</surname><given-names>A.</given-names></name>; <name><surname>Botermans</surname><given-names>A.</given-names></name>; <name><surname>Hoogendijk</surname><given-names>J. L.</given-names></name>; <name><surname>Henneman</surname><given-names>A. A.</given-names></name>; <name><surname>Deelder</surname><given-names>A. M.</given-names></name>; <name><surname>Spaink</surname><given-names>H. P.</given-names></name>; <name><surname>Palmblad</surname><given-names>M.</given-names></name><article-title>Identifying
proteins in zebrafish embryos using spectral libraries generated from
dissected adult organs and tissues</article-title>. <source>J. Proteome
Res.</source><year>2014</year>, <volume>13</volume>, <fpage>1537</fpage>–<lpage>1544</lpage>. <pub-id pub-id-type="doi">10.1021/pr4010585</pub-id>.<pub-id pub-id-type="pmid">24460240</pub-id></mixed-citation>
    </ref>
    <ref id="ref9">
      <mixed-citation publication-type="journal" id="cit9"><name><surname>van
der Plas-Duivesteijn</surname><given-names>S. J.</given-names></name>; <name><surname>Wulff</surname><given-names>T.</given-names></name>; <name><surname>Klychnikov</surname><given-names>O.</given-names></name>; <name><surname>Ohana</surname><given-names>D.</given-names></name>; <name><surname>Dalebout</surname><given-names>H.</given-names></name>; <name><surname>van Veelen</surname><given-names>P. A.</given-names></name>; <name><surname>de Keijzer</surname><given-names>J.</given-names></name>; <name><surname>Nessen</surname><given-names>M. A.</given-names></name>; <name><surname>van der Burgt</surname><given-names>Y. E. M.</given-names></name>; <name><surname>Deelder</surname><given-names>A. M.</given-names></name>; <name><surname>Palmblad</surname><given-names>M.</given-names></name><article-title>Differentiating samples and experimental
protocols by direct comparison of tandem mass spectra</article-title>. <source>Rapid communications in mass spectrometry: RCM</source><year>2016</year>, <volume>30</volume>, <fpage>731</fpage>–<lpage>738</lpage>. <pub-id pub-id-type="doi">10.1002/rcm.7494</pub-id>.<pub-id pub-id-type="pmid">26864526</pub-id></mixed-citation>
    </ref>
    <ref id="ref10">
      <mixed-citation publication-type="journal" id="cit10"><name><surname>Rieder</surname><given-names>V.</given-names></name>; <name><surname>Blank-Landeshammer</surname><given-names>B.</given-names></name>; <name><surname>Stuhr</surname><given-names>M.</given-names></name>; <name><surname>Schell</surname><given-names>T.</given-names></name>; <name><surname>Biß</surname><given-names>K.</given-names></name>; <name><surname>Kollipara</surname><given-names>L.</given-names></name>; <name><surname>Meyer</surname><given-names>A.</given-names></name>; <name><surname>Pfenninger</surname><given-names>M.</given-names></name>; <name><surname>Westphal</surname><given-names>H.</given-names></name>; <name><surname>Sickmann</surname><given-names>A.</given-names></name>; <name><surname>Rahnenführer</surname><given-names>J.</given-names></name><article-title>DISMS2: A
flexible algorithm for direct proteome- wide distance calculation
of LC-MS/MS runs</article-title>. <source>BMC bioinformatics</source><year>2017</year>, <volume>18</volume>, <fpage>148</fpage><pub-id pub-id-type="doi">10.1186/s12859-017-1514-2</pub-id>.<pub-id pub-id-type="pmid">28253837</pub-id></mixed-citation>
    </ref>
    <ref id="ref11">
      <mixed-citation publication-type="journal" id="cit11"><name><surname>Downard</surname><given-names>K. M.</given-names></name><article-title>Sequence-Free
Phylogenetics with Mass Spectrometry</article-title>. <source>Mass Spectrom.
Rev.</source><year>2020</year>, <volume>41</volume>, <fpage>3</fpage>–<lpage>14</lpage>. <pub-id pub-id-type="doi">10.1002/mas.21658</pub-id>.<pub-id pub-id-type="pmid">33169385</pub-id></mixed-citation>
    </ref>
    <ref id="ref12">
      <mixed-citation publication-type="journal" id="cit12"><name><surname>Neely</surname><given-names>B. A.</given-names></name>; <name><surname>Palmblad</surname><given-names>M.</given-names></name><article-title>Rewinding the Molecular
Clock: Looking at Pioneering
Molecular Phylogenetics Experiments in the Light of Proteomics</article-title>. <source>J. Proteome Res.</source><year>2021</year>, <volume>20</volume>, <fpage>4640</fpage>–<lpage>4645</lpage>. <pub-id pub-id-type="doi">10.1021/acs.jproteome.1c00528</pub-id>.<pub-id pub-id-type="pmid">34523928</pub-id></mixed-citation>
    </ref>
    <ref id="ref13">
      <mixed-citation publication-type="journal" id="cit13"><name><surname>Zuckerkandl</surname><given-names>E.</given-names></name>; <name><surname>Jones</surname><given-names>R.</given-names></name>; <name><surname>Pauling</surname><given-names>L.</given-names></name><article-title>A Comparison of Animal
Hemoglobins
by Tryptic Peptide Pattern Analysis</article-title>. <source>Proc. Natl.
Acad. Sci. U.S.A.</source><year>1960</year>, <volume>46</volume>, <fpage>1349</fpage>–<lpage>1360</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.46.10.1349</pub-id>.<pub-id pub-id-type="pmid">16590757</pub-id></mixed-citation>
    </ref>
    <ref id="ref14">
      <mixed-citation publication-type="journal" id="cit14"><name><surname>Chambers</surname><given-names>M. C.</given-names></name>; et al. <article-title>A cross-platform toolkit for mass spectrometry and proteomics</article-title>. <source>Nature biotechnology</source><year>2012</year>, <volume>30</volume>, <fpage>918</fpage>–<lpage>920</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.2377</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref15">
      <mixed-citation publication-type="journal" id="cit15"><name><surname>Shank</surname><given-names>S. D.</given-names></name>; <name><surname>Weaver</surname><given-names>S.</given-names></name>; <name><surname>Kosakovsky Pond</surname><given-names>S. L.</given-names></name><article-title>phylotree.js - a JavaScript library
for application development and interactive data visualization in
phylogenetics</article-title>. <source>BMC bioinformatics</source><year>2018</year>, <volume>19</volume>, <fpage>276</fpage><pub-id pub-id-type="doi">10.1186/s12859-018-2283-2</pub-id>.<pub-id pub-id-type="pmid">30045713</pub-id></mixed-citation>
    </ref>
    <ref id="ref16">
      <mixed-citation publication-type="journal" id="cit16"><name><surname>Perez-Riverol</surname><given-names>Y.</given-names></name>; <name><surname>Bai</surname><given-names>J.</given-names></name>; <name><surname>Bandla</surname><given-names>C.</given-names></name>; <name><surname>García-Seisdedos</surname><given-names>D.</given-names></name>; <name><surname>Hewapathirana</surname><given-names>S.</given-names></name>; <name><surname>Kamatchinathan</surname><given-names>S.</given-names></name>; <name><surname>Kundu</surname><given-names>D.</given-names></name>; <name><surname>Prakash</surname><given-names>A.</given-names></name>; <name><surname>Frericks-Zipper</surname><given-names>A.</given-names></name>; <name><surname>Eisenacher</surname><given-names>M.</given-names></name>; <name><surname>Walzer</surname><given-names>M.</given-names></name>; <name><surname>Wang</surname><given-names>S.</given-names></name>; <name><surname>Brazma</surname><given-names>A.</given-names></name>; <name><surname>Vizcaíno</surname><given-names>J.</given-names></name><article-title>The PRIDE database resources in 2022: a hub for mass
spectrometry-based proteomics evidences</article-title>. <source>Nucleic
Acids Res.</source><year>2022</year>, <volume>50</volume>, <fpage>D543</fpage>–<lpage>D552</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkab1038</pub-id>.<pub-id pub-id-type="pmid">34723319</pub-id></mixed-citation>
    </ref>
    <ref id="ref17">
      <mixed-citation publication-type="journal" id="cit17"><name><surname>Tamura</surname><given-names>K.</given-names></name>; <name><surname>Stecher</surname><given-names>G.</given-names></name>; <name><surname>Kumar</surname><given-names>S.</given-names></name><article-title>MEGA11: Molecular Evolutionary Genetics
Analysis Version 11</article-title>. <source>Mol. Biol. Evol.</source><year>2021</year>, <volume>38</volume>, <fpage>3022</fpage>–<lpage>3027</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msab120</pub-id>.<pub-id pub-id-type="pmid">33892491</pub-id></mixed-citation>
    </ref>
    <ref id="ref18">
      <mixed-citation publication-type="book" id="cit18"><person-group person-group-type="allauthors"><name><surname>Sneath</surname><given-names>P.</given-names></name>; <name><surname>Sokal</surname><given-names>R.</given-names></name></person-group><source>Numerical Taxonomy: The Principles
and Practice of Numerical Classification</source>; <publisher-name>Freeman</publisher-name>: <publisher-loc>San Francisco</publisher-loc>, <year>1973</year>.</mixed-citation>
    </ref>
    <ref id="ref19">
      <mixed-citation publication-type="journal" id="cit19"><name><surname>Keller</surname><given-names>A.</given-names></name>; <name><surname>Nesvizhskii</surname><given-names>A. I.</given-names></name>; <name><surname>Kolker</surname><given-names>E.</given-names></name>; <name><surname>Aebersold</surname><given-names>R.</given-names></name><article-title>Empirical
Statistical Model To Estimate the Accuracy of Peptide Identifications
Made by MS/MS and Database Search</article-title>. <source>Anal. Chem.</source><year>2002</year>, <volume>74</volume>, <fpage>5383</fpage>–<lpage>5392</lpage>. <pub-id pub-id-type="doi">10.1021/ac025747h</pub-id>.<pub-id pub-id-type="pmid">12403597</pub-id></mixed-citation>
    </ref>
    <ref id="ref20">
      <mixed-citation publication-type="journal" id="cit20"><name><surname>Käll</surname><given-names>L.</given-names></name>; <name><surname>Canterbury</surname><given-names>J. D.</given-names></name>; <name><surname>Weston</surname><given-names>J.</given-names></name>; <name><surname>Noble</surname><given-names>W. S.</given-names></name>; <name><surname>MacCoss</surname><given-names>M. J.</given-names></name><article-title>Semi-supervised
learning for peptide identification from shotgun proteomics datasets</article-title>. <source>Nat. Methods</source><year>2007</year>, <volume>4</volume>, <fpage>923</fpage>–<lpage>925</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth1113</pub-id>.<pub-id pub-id-type="pmid">17952086</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//ACS//DTD ACS Journal DTD v1.02 20061031//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName ACSJournal-v102.dtd?>
<?SourceDTD.Version 1.02?>
<?ConverterInfo.XSLTName acs2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Proteome Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">J Proteome Res</journal-id>
    <journal-id journal-id-type="publisher-id">pr</journal-id>
    <journal-id journal-id-type="coden">jprobs</journal-id>
    <journal-title-group>
      <journal-title>Journal of Proteome Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1535-3893</issn>
    <issn pub-type="epub">1535-3907</issn>
    <publisher>
      <publisher-name>American Chemical Society</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9903320</article-id>
    <article-id pub-id-type="pmid">36173614</article-id>
    <article-id pub-id-type="doi">10.1021/acs.jproteome.2c00457</article-id>
    <article-categories>
      <subj-group>
        <subject>Technical Note</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>compareMS2 2.0:
An Improved Software for Comparing
Tandem Mass Spectrometry Datasets</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="ath1">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-1220-9173</contrib-id>
        <name>
          <surname>Marissen</surname>
          <given-names>Rob</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">†</xref>
      </contrib>
      <contrib contrib-type="author" id="ath2">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-9011-5642</contrib-id>
        <name>
          <surname>Varunjikar</surname>
          <given-names>Madhushri S.</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">‡</xref>
      </contrib>
      <contrib contrib-type="author" id="ath3">
        <name>
          <surname>Laros</surname>
          <given-names>Jeroen F. J.</given-names>
        </name>
        <xref rid="aff3" ref-type="aff">§</xref>
        <xref rid="aff4" ref-type="aff">∥</xref>
      </contrib>
      <contrib contrib-type="author" id="ath4">
        <name>
          <surname>Rasinger</surname>
          <given-names>Josef D.</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">‡</xref>
      </contrib>
      <contrib contrib-type="author" id="ath5">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-6120-7695</contrib-id>
        <name>
          <surname>Neely</surname>
          <given-names>Benjamin A.</given-names>
        </name>
        <xref rid="aff5" ref-type="aff">⊥</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="ath6">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-5865-8994</contrib-id>
        <name>
          <surname>Palmblad</surname>
          <given-names>Magnus</given-names>
        </name>
        <xref rid="cor1" ref-type="other">*</xref>
        <xref rid="aff1" ref-type="aff">†</xref>
      </contrib>
      <aff id="aff1"><label>†</label>Center
for Proteomics and Metabolomics, <institution>Leiden
University Medical Center</institution>, Postbus 9600, 2300 RC Leiden, <country>The Netherlands</country></aff>
      <aff id="aff2"><label>‡</label><institution>Institute
of Marine Research</institution>, P.O. Box 1870
Nordnes, 5817 Bergen, <country>Norway</country></aff>
      <aff id="aff3"><label>§</label><institution>National
Institute for Public Health and the Environment</institution>, 3720 BA Bilthoven, <country>The Netherlands</country></aff>
      <aff id="aff4"><label>∥</label>Department
of Human Genetics, <institution>Leiden University Medical
Center</institution>, Postbus 9600, 2300
RC Leiden, <country>The Netherlands</country></aff>
      <aff id="aff5"><label>⊥</label><institution>National
Institute of Standards and Technology</institution>, Charleston, South Carolina 29412, <country>United States</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>*</label>Email: <email>n.m.palmblad@lumc.nl</email>. Phone: <phone>+31 71 5266969</phone>.</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>09</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <day>03</day>
      <month>02</month>
      <year>2023</year>
    </pub-date>
    <volume>22</volume>
    <issue>2</issue>
    <issue-title>Software Tools and Resources 2023</issue-title>
    <fpage>514</fpage>
    <lpage>519</lpage>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>07</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2022 The Authors. Published by American Chemical Society</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>The Authors</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>Permits the broadest form of re-use including for commercial purposes, provided that author attribution and integrity are maintained (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>).</license-p>
      </license>
    </permissions>
    <abstract>
      <p content-type="toc-graphic">
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_0005" id="ab-tgr1"/>
      </p>
      <p>It has long been
known that biological species can be identified
from mass spectrometry data alone. Ten years ago, we described a method
and software tool, compareMS2, for calculating a distance between
sets of tandem mass spectra, as routinely collected in proteomics.
This method has seen use in species identification and mixture characterization
in food and feed products, as well as other applications. Here, we
present the first major update of this software, including a new metric,
a graphical user interface and additional functionality. The data
have been deposited to ProteomeXchange with dataset identifier PXD034932.</p>
    </abstract>
    <kwd-group>
      <kwd>compareMS2</kwd>
      <kwd>distance metric</kwd>
      <kwd>molecular
phylogenetics</kwd>
      <kwd>tandem mass spectrometry</kwd>
      <kwd>quality
control</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>document-id-old-9</meta-name>
        <meta-value>pr2c00457</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>document-id-new-14</meta-name>
        <meta-value>pr2c00457</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>ccc-price</meta-name>
        <meta-value/>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <title>Introduction</title>
    <p>A
decade ago, Palmblad and Deelder<sup><xref ref-type="bibr" rid="ref1">1</xref></sup> first
described a method for molecular phylogenetics based on direct comparison
of tandem mass spectra. The method has since seen a range of applications,
including food<sup><xref ref-type="bibr" rid="ref2">2</xref>,<xref ref-type="bibr" rid="ref3">3</xref></sup> and feed<sup><xref ref-type="bibr" rid="ref4">4</xref>−<xref ref-type="bibr" rid="ref7">7</xref></sup> species identification, quality
control,<sup><xref ref-type="bibr" rid="ref8">8</xref></sup> and experimental design.<sup><xref ref-type="bibr" rid="ref9">9</xref></sup> Similar works include the DISMS2 library by Rieder
and colleagues<sup><xref ref-type="bibr" rid="ref10">10</xref></sup> and MS1-only methods for
“sequence-free” phylogenetics reviewed by Downard.<sup><xref ref-type="bibr" rid="ref11">11</xref></sup> Neely and Palmblad<sup><xref ref-type="bibr" rid="ref12">12</xref></sup> recently placed these methods in a larger historical context, going
all the way back to the seminal comparison of separated tryptic peptides
across species by Zuckerkandl, Jones, and Pauling in 1960.<sup><xref ref-type="bibr" rid="ref13">13</xref></sup> Here, we describe a new and significantly updated
version of the original compareMS2 software, with several improvements,
including a graphical user interface (GUI) controlling all steps of
the analysis and dynamic phylogenetic tree display, a fully symmetric
distance metric, and many additional filters and output options, which
we describe in this technical note.</p>
  </sec>
  <sec id="sec2">
    <title>Methods</title>
    <sec id="sec2.1">
      <title>Symmetric Distance
Measure</title>
      <p>The original compareMS2
compared two sets of tandem mass spectra, e.g., those resulting from
liquid chromatography–tandem mass spectrometry, by scanning
one set and for each spectrum finding the best match in the other
set (within precursor <italic>m</italic>/<italic>z</italic> and retention
time tolerances). The results depended on which set was scanned, and
the distance metric was only approximately symmetric. compareMS2 2.0
has a perfectly symmetric measure of the distance between sets of
tandem mass spectra regardless of order of input. In this section,
we describe this modified measure and some of its properties.</p>
    </sec>
    <sec id="sec2.2">
      <title>Comparing
Pairs of Spectra</title>
      <p>The comparison between sets
of tandem mass spectra starts with the comparison of pairs of spectra.
There are many measures of spectral similarity. compareMS2 supports
the cosine score (dot product) and spectral angle. By default, compareMS2
uses the cosine score, i.e., the cosine of the angle between the vector
representations of the spectra, after normalizing both spectra to
unit length:<disp-formula id="eq1"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m001" position="anchor"/><label>1</label></disp-formula>where θ
is the angle between the vector
representations of the two spectra. <xref rid="eq1" ref-type="disp-formula">Equation <xref rid="eq1" ref-type="disp-formula">1</xref></xref> is symmetric in <italic>a</italic> and <italic>b</italic>.</p>
      <p>Optionally, compareMS2 can first scale spectra
to reduce the influence of very intense peaks, e.g., by taking the
square or cube root of all intensities. All peaks below a user-defined
or automatically detected relative or absolute background can also
be excluded from the similarity calculation.</p>
    </sec>
    <sec id="sec2.3">
      <title>Comparing Sets of Spectra</title>
      <p>compareMS2 2.0 defines the
similarity between two sets of tandem mass spectra, <inline-formula id="d33e284"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m002.gif"/></inline-formula> and <inline-formula id="d33e287"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m003.gif"/></inline-formula> as follows.
If for a spectrum <italic>a</italic>∈<inline-formula id="d33e293"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m004.gif"/></inline-formula> we find a
spectrum <italic>b</italic>∈<inline-formula id="d33e300"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m005.gif"/></inline-formula> with <italic>s</italic>(<italic>a</italic>,<italic>b</italic>) greater than or
equal to a minimum similarity
threshold <italic>s</italic><sub>min</sub>, we say that <italic>a</italic> has a similar spectrum in <inline-formula id="d33e321"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m006.gif"/></inline-formula>. We then define
a subset <inline-formula id="d33e324"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m007.gif"/></inline-formula>⊂<inline-formula id="d33e327"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m008.gif"/></inline-formula>, given <inline-formula id="d33e330"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m009.gif"/></inline-formula>, of all spectra
in <inline-formula id="d33e333"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m010.gif"/></inline-formula> with at least
one similar spectrum in <inline-formula id="d33e337"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m011.gif"/></inline-formula> as<disp-formula id="eq2"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m012" position="anchor"/><label>2</label></disp-formula>and a corresponding subset <inline-formula id="d33e346"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m013.gif"/></inline-formula>⊂<inline-formula id="d33e349"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m014.gif"/></inline-formula> as<disp-formula id="eq3"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m015" position="anchor"/><label>3</label></disp-formula></p>
      <p>We then define a global similarity
between sets <inline-formula id="d33e359"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m016.gif"/></inline-formula> ≠
Ø and <inline-formula id="d33e362"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m017.gif"/></inline-formula> ≠
Ø, <italic>S</italic>(<inline-formula id="d33e368"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m018.gif"/></inline-formula>,<inline-formula id="d33e371"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m019.gif"/></inline-formula>), as the average
of the fraction of spectra
in <inline-formula id="d33e375"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m020.gif"/></inline-formula> with at least
one similar spectrum in <inline-formula id="d33e378"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m021.gif"/></inline-formula> and the fraction
of spectra in <inline-formula id="d33e381"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m022.gif"/></inline-formula> with
at least one similar spectrum in <inline-formula id="d33e384"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m023.gif"/></inline-formula>:<disp-formula id="eq4"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m024" position="anchor"/><label>4</label></disp-formula>where |<inline-formula id="d33e394"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m025.gif"/></inline-formula>| denotes
the cardinality, the number of
elements, in a set <inline-formula id="d33e397"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m026.gif"/></inline-formula>. Though
in some use cases it may be meaningful
to define the similarity between two empty sets, i.e., LC-MS/MS datasets
without tandem mass spectra, or the similarity between an empty and
a non-empty set, we have chosen to leave these undefined and have
the compareMS2 output reflect this. We believe this makes sense as
a dataset without tandem mass spectra usually suggests something went
wrong during measurement. Values can always be imputed after the compareMS2
runs, and rows with undefined values in the distance matrix can be
excluded in subsequent analyses in most phylogenetic software.</p>
      <p>From the symmetry of <xref rid="eq4" ref-type="disp-formula">eq <xref rid="eq4" ref-type="disp-formula">4</xref></xref>, we see that <italic>S</italic>(<inline-formula id="d33e409"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m027.gif"/></inline-formula>,<inline-formula id="d33e412"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m028.gif"/></inline-formula>) = <italic>S</italic>(<inline-formula id="d33e419"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m029.gif"/></inline-formula>,<inline-formula id="d33e422"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m030.gif"/></inline-formula>). We also
note that both terms in <xref rid="eq4" ref-type="disp-formula">eq <xref rid="eq4" ref-type="disp-formula">4</xref></xref> are non-negative, therefore <italic>S</italic>(<inline-formula id="d33e432"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m031.gif"/></inline-formula>,<inline-formula id="d33e435"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m032.gif"/></inline-formula>) ≥
0. The maximum value of <italic>S</italic>(<inline-formula id="d33e442"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m033.gif"/></inline-formula>,<inline-formula id="d33e445"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m034.gif"/></inline-formula>) is 1 when
all spectra in <inline-formula id="d33e448"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m035.gif"/></inline-formula> have
a similar spectrum in <inline-formula id="d33e451"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m036.gif"/></inline-formula> and vice versa.
The minimum value is 0
when <inline-formula id="d33e454"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m037.gif"/></inline-formula> and <inline-formula id="d33e458"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m038.gif"/></inline-formula> have no similar
spectra. The smallest positive
value of <italic>S</italic>(<inline-formula id="d33e464"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m039.gif"/></inline-formula>,<inline-formula id="d33e467"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m040.gif"/></inline-formula>) occurs when
there is exactly one pair
of similar spectra in <inline-formula id="d33e470"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m041.gif"/></inline-formula> and <inline-formula id="d33e473"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m042.gif"/></inline-formula>:<disp-formula id="eq5"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m043" position="anchor"/><label>5</label></disp-formula></p>
      <p>Finally, we arrive at the global distance measure, <italic>D</italic>(<inline-formula id="d33e487"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m044.gif"/></inline-formula>,<inline-formula id="d33e490"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m045.gif"/></inline-formula>), which we
define as the inverse of <italic>S</italic>(<inline-formula id="d33e496"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m046.gif"/></inline-formula>,<inline-formula id="d33e500"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m047.gif"/></inline-formula>) minus one
when <italic>S</italic>(<inline-formula id="d33e506"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m048.gif"/></inline-formula>,<inline-formula id="d33e509"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m049.gif"/></inline-formula>) is positive,
and as the inverse of half
of the smallest positive value of <italic>S</italic>(<inline-formula id="d33e515"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m050.gif"/></inline-formula>,<inline-formula id="d33e519"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m051.gif"/></inline-formula>) minus one
when <italic>S</italic>(<inline-formula id="d33e525"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m052.gif"/></inline-formula>,<inline-formula id="d33e528"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m053.gif"/></inline-formula>) is zero:<disp-formula id="eq6"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m054" position="anchor"/><label>6</label></disp-formula>Since <italic>S</italic>(<inline-formula id="d33e541"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m055.gif"/></inline-formula>,<inline-formula id="d33e544"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m056.gif"/></inline-formula>) is symmetric, <italic>D</italic>(<inline-formula id="d33e550"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m057.gif"/></inline-formula>,<inline-formula id="d33e553"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m058.gif"/></inline-formula>) is also symmetric.
Note that <italic>D</italic>(<inline-formula id="d33e560"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m059.gif"/></inline-formula>,<inline-formula id="d33e563"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m060.gif"/></inline-formula>) → <italic>∞</italic> as
|<inline-formula id="d33e569"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m061.gif"/></inline-formula>| → <italic>∞</italic>∧|<inline-formula id="d33e576"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m062.gif"/></inline-formula>| → <italic>∞</italic>,and
there are no similar spectra in <inline-formula id="d33e582"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m063.gif"/></inline-formula> and <inline-formula id="d33e585"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m064.gif"/></inline-formula>. In the special
case of <inline-formula id="d33e588"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m065.gif"/></inline-formula> and <inline-formula id="d33e591"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m066.gif"/></inline-formula> both containing
a single spectrum, <italic>D</italic>(<inline-formula id="d33e598"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m067.gif"/></inline-formula>,<inline-formula id="d33e601"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m068.gif"/></inline-formula>) is 0 if the
spectra are similar and 1
otherwise. The definition of the distance between sets with <italic>S</italic>(<inline-formula id="d33e607"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m069.gif"/></inline-formula>,<inline-formula id="d33e610"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m070.gif"/></inline-formula>) = 0 correspond
to <inline-formula id="d33e614"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m071.gif"/></inline-formula> and <inline-formula id="d33e617"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m072.gif"/></inline-formula> having a hypothetical
half matching spectrum.
In most real-world use cases, both <inline-formula id="d33e620"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m073.gif"/></inline-formula> and <inline-formula id="d33e623"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m074.gif"/></inline-formula> would contain
thousands of spectra.</p>
      <p>Two co-directional spectra—spectra
whose vector representations
differ only by a factor—are considered identical by <italic>s</italic>. Therefore, datasets containing perfectly co-directional
spectra would have a global similarity <italic>S</italic> = 1 and
distance <italic>D</italic> = 0. Strictly speaking, <italic>D</italic> is not a metric in the mathematical sense, as the identity of indiscernibles
(<italic>D</italic>(<inline-formula id="d33e644"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m075.gif"/></inline-formula>,<inline-formula id="d33e647"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m076.gif"/></inline-formula>) = 0 ⇔ <inline-formula id="d33e650"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m077.gif"/></inline-formula> = <inline-formula id="d33e653"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m078.gif"/></inline-formula>) no longer
holds after normalizing the
spectra. This is by design, as the absolute intensities in a tandem
mass spectrum depend not only on the peptide sequence and abundance,
but also at which point or points during the chromatographic peak
the peptide was selected for MS/MS, which is generally not reproducible.</p>
      <p>As comparing all tandem mass spectra is computationally expensive,
especially for large datasets. compareMS2 allows approximation of <italic>D</italic>(<inline-formula id="d33e661"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m079.gif"/></inline-formula>,<inline-formula id="d33e664"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m080.gif"/></inline-formula>) by only comparing
a spectrum <italic>a</italic>∈<inline-formula id="d33e670"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m081.gif"/></inline-formula> with those
spectra <italic>b</italic>∈<inline-formula id="d33e677"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m082.gif"/></inline-formula> that fall
within user-defined windows of
retention time or scan number, and precursor <italic>m</italic>/<italic>z</italic>.</p>
    </sec>
    <sec id="sec2.4">
      <title>compareMS2 Pipeline</title>
      <p>compareMS2 takes
as minimum input
a directory of MGF files to be compared. We choose MGF as the default
input format, as it is convenient for storing MS2-only data and the
MGF files can easily be filtered, split or combined, which may be
useful in some applications of compareMS2, such as when fractionating
samples or removing nonpeptide spectra. Most vendor software as well
as msconvert<sup><xref ref-type="bibr" rid="ref14">14</xref></sup> can convert raw data or
mzML files to MGF. To provide faster feedback to the user, compareMS2
2.0 interleaves distance matrix calculations, updates and displays
a phylogenetic tree as each row of the distance matrix is completed
(<xref rid="fig1" ref-type="fig">Figure <xref rid="fig1" ref-type="fig">1</xref></xref>). With the
default symmetric metric, this matrix is triangular, hence the tree
is updated rapidly in the beginning, after the first comparison, and
then again after the next two comparisons etc. Version 2.0 also provides
additional functionality, such as recording a quality control metric
for each dataset (by default the number of tandem mass spectra in
the dataset) and a filter to compare only the top-<italic>N</italic> most intense tandem mass spectra from each dataset. The datasets
can be compared in alphabetical, size or random order. By default,
compareMS2 outputs a MEGA (.meg) file, but Newick and NEXUS formats
are also supported.</p>
      <fig id="fig1" position="float">
        <label>Figure 1</label>
        <caption>
          <p>CompareMS2 2.0 workflow, orchestrated by the graphical
user interface.
After parsing and checking the input parameters, ensuring all files
are present and in the correct format, compareMS2 performs (<italic>N</italic><sup>2</sup> – <italic>N</italic>)/2 pairwise comparisons
of <italic>N</italic> datasets using the symmetric distance measure
described below, or <italic>N</italic><sup>2</sup> – <italic>N</italic> comparisons if the original measure is used. After each
row is completed, compareMS2 updates the (strictly triangular) distance
matrix and generates a new tree. This allows the user to monitor progress
and terminate and restart the run if necessary. If the original measure
is used, compareMS2 by default creates both the strictly upper and
lower triangular distance matrices (these can be averaged in phylogenetics
software such as MEGA).</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_0001" id="gr1" position="float"/>
      </fig>
    </sec>
    <sec id="sec2.5">
      <title>compareMS2 GUI</title>
      <p>Technically, compareMS2 2.0 combines
two software tools, which can also be run individually on the command
line. The first component compares two datasets, e.g., from LC-MS/MS.
The second component takes several such comparisons, combines samples
from the same biological species, and computes a distance matrix.
The graphical user interface (<xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref>) was designed to be simple to use, hiding most of
the internal complexity of compareMS2, including the interleaved execution
order of the two components (<xref rid="fig1" ref-type="fig">Figure <xref rid="fig1" ref-type="fig">1</xref></xref>).</p>
      <fig id="fig2" position="float">
        <label>Figure 2</label>
        <caption>
          <p>compareMS2 2.0 GUI, showing the output panel from the
beginning
of an analysis of 24 datasets, each containing 1000 tandem mass spectra,
from six primate species for a total of (24<sup>2</sup> – 24)/2
= 276 comparisons. With default parameters, these comparisons take
3 min on a PC with an Intel Xeon W-2135 CPU running at 3.70 GHz. The
node text color in the tree represents data quality, the default metric
being the number of tandem mass spectra per species.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_0002" id="gr2" position="float"/>
      </fig>
    </sec>
    <sec id="sec2.6">
      <title>Source Code and Availability</title>
      <p>The compareMS2 source
code can freely be downloaded from <uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/524D/compareMS2">https://github.com/524D/compareMS2</uri>. On Windows, the software can be installed using a simple installer.
compareMS has been tested on Windows 10, Ubuntu 20.04 Linux and MacOS
12. The GUI is based on Electron (<uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.electronjs.org/">https://www.electronjs.org/</uri>) and is written in Javascript, HTML, and CSS. It uses the phylotree.js
library<sup><xref ref-type="bibr" rid="ref15">15</xref></sup> to render the graphical tree
representation. Conversion of the distance matrix into Newick format
uses the UPGMA method is and is also implemented in JavaScript. The
distance computation and distance matrix creation are performed by
two command-line programs written in C. These can be used to run compareMS
without the GUI. Source code and prebuild executables of the command-line
tools can be found in the external_binaries directory of the compareMS2
repository.</p>
    </sec>
    <sec id="sec2.7">
      <title>Experimental Features</title>
      <p>As compareMS2
provides a basic
framework for comparing tandem mass spectra across datasets, we have
begun to add experimental features to help visualize such comparisons.
The first of these experimental outputs is a two-dimensional histogram
of precursor <italic>m</italic>/<italic>z</italic> difference and
spectral similarity for all comparisons of spectra between two datasets.
These features will only be available on the command-line, and require
additional software such as R to generate figures, but allow for example
correlating spectral similarity with precursor mass difference. Scripting
examples in R are available on <uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://osf.io/jey28/">https://osf.io/jey28/</uri>.</p>
    </sec>
    <sec id="sec2.8">
      <title>Testing</title>
      <p>To demonstrate the features and performance
of compareMS2 2.0, we used previously published amaZon ion trap (Bruker
Daltonics) and Orbitrap Fusion Lumos (Thermo Fisher Scientific) data
from primate sera and an <italic>E. coli</italic> lysate.<sup><xref ref-type="bibr" rid="ref1">1</xref>,<xref ref-type="bibr" rid="ref12">12</xref></sup> In addition, we used new data acquired on the same Orbitrap instrument
and as described in<sup><xref ref-type="bibr" rid="ref12">12</xref></sup> from California sea
lion (<italic>Zalophus californianus</italic>), dog
(<italic>Canis lupus familiaris</italic>), rock hyrax
(<italic>Procavia capensis</italic>), and white-tailed
deer (<italic>Odocoileus virginianus</italic>) sera.
The mass spectrometry proteomics data have been deposited to the ProteomeXchange
Consortium via the PRIDE<sup><xref ref-type="bibr" rid="ref16">16</xref></sup> partner repository
with the dataset identifier PXD034932 and 10.6019/PXD034932. Phylogenetic
trees were generated by compareMS2 and MEGA11<sup><xref ref-type="bibr" rid="ref17">17</xref></sup> using default parameters for both (for compareMS2 maximum precursor
mass difference 2.05, score cutoff 0.8, minimum basepeak intensity
10000, minimum total ion current 0, maximum retention time difference
60, start retention time 0, end retention time 100000, maximum scan
number difference 10000, start scan 1, end scan 1000000, scaling 0.5,
noise 10, version of set distance metric 2, version of QC metric 0,
compare only the N most intense spectra set to “All”,
output format “MEGA”,and compare order “Smallest-largest
first”, and for MEGA11 “Lower Left Matrix” and
“Pairwise Distance” input data for UPGMA Phylogeny Analysis).</p>
    </sec>
  </sec>
  <sec id="sec3">
    <title>Results and Discussion</title>
    <p>The compareMS2 2.0 GUI (<xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref>) displays a phylogenetic
tree with a quality metric
mapped to a continuous or divergent color gradient, the tree being
continuously updated to provide real-time feedback to the user. This
allows executions to be paused or terminated at any stage, which may
be useful for large jobs. For example, comparing 100 LC-MS/MS datasets
require 4950 pairwise comparisons, taking several hours. But already
after six pairwise comparisons of four datasets, trees can be quite
informative and reveal if there is an issue with the input files or
parameters.</p>
    <p>Using the five new serum datasets, each containing
between 42,629
and 47,626 tandem mass spectra, we could reconstruct the correct phylogenetic
tree in compareMS2 and MEGA11 (<xref rid="fig3" ref-type="fig">Figure <xref rid="fig3" ref-type="fig">3</xref></xref>). The 10 pairwise comparisons in compareMS2 took 40
min with default parameters on a PC with an Intel Xeon W-2135 CPU
running at 3.70 GHz. The analyses can be accelerated by comparing
spectra within a more narrow <italic>m</italic>/<italic>z</italic> window than the default value of 2.05. Each comparison is independent,
so in principle the problem is embarrassingly parallel.</p>
    <fig id="fig3" position="float">
      <label>Figure 3</label>
      <caption>
        <p>Phylogenetic
analysis in MEGA11 based on Orbitrap Fusion Lumos
LC-MS/MS datasets of sera from (top to bottom) two California sea
lions (<italic>Zalophus californianus</italic>), dog
(<italic>Canis lupus familiaris</italic>), white-tailed
deer (<italic>Odocoileus virginianus</italic>), and
rock hyrax (<italic>Procavia capensis</italic>). The
evolutionary history was inferred using the UPGMA method.<sup><xref ref-type="bibr" rid="ref18">18</xref></sup> The optimal tree is shown and drawn to scale,
with branch lengths in the same units as those generated by compareMS2
and used to infer the phylogenetic tree. Taxon images are from PhyloPic.</p>
      </caption>
      <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_0003" id="gr3" position="float"/>
    </fig>
    <p>To test one of the experimental features, we compared
the similarity
between tandem mass spectra as a function of precursor <italic>m</italic>/<italic>z</italic> difference for comparisons between two closely
related species - human and chimpanzee - as well as two species with
few shared tryptic peptides—human and <italic>E. coli</italic> (<xref rid="fig4" ref-type="fig">Figure <xref rid="fig4" ref-type="fig">4</xref></xref>). These
comparisons reveal information on spectral similarity, but also on
mass measurement precision, charge states and isotope errors <italic>before</italic> and independent of any database search, where such
parameters typically have to be provided. In these datasets, charge
states up to [M + 6H]<sup>6+</sup> and isotope errors up to at least
3 Da are observed. The analysis can also be used to estimate suitable
parameters for compareMS2, e.g., <italic>m</italic>/<italic>z</italic> windows and spectral similarity thresholds. We also observe some
unexpected side bands most noticeable at 1/2 and 1/3 Da, but not near
zero, in the Orbitrap data. These bands are also seen in comparisons
of spectra within individual datasets.</p>
    <fig id="fig4" position="float">
      <label>Figure 4</label>
      <caption>
        <p>Similarity of tandem
mass spectra as a function of precursor <italic>m</italic>/<italic>z</italic> difference in Orbitrap Fusion Lumos
(A,B) and amaZon ion trap data (C,D), comparing similar (human and
chimpanzee sera) and dissimilar (human serum and <italic>E. coli</italic>) samples. Panels A and B compare two LC-MS/MS runs, and panels C
and D compare four runs per species (16 comparisons). Similar spectra
have precursor <italic>m</italic>/<italic>z</italic> differences near
zero or a near a rational number corresponding to the isotope error
at a specific charge state (shown more clearly in panel E, generated
from 8 Orbitrap human serum datasets).</p>
      </caption>
      <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_0004" id="gr4" position="float"/>
    </fig>
    <p>When combined with posterior error probability estimators such
as PeptideProphet<sup><xref ref-type="bibr" rid="ref19">19</xref></sup> or Percolator,<sup><xref ref-type="bibr" rid="ref20">20</xref></sup> spectral similarity measures can in principle
be converted into probabilities for any pair of spectra being derived
from the same or closely related analytes. When searching spectral
libraries, the probability that a query spectrum matches the library
spectrum is multiplied with the original probability that library
spectrum was correctly identified to estimate the probability the
query spectrum is correctly matched to a peptide or other analyte.
The compareMS2 software uses the spectral similarity in <xref rid="eq1" ref-type="disp-formula">eq <xref rid="eq1" ref-type="disp-formula">1</xref></xref> to calculate the overlap between
sets of tandem mass spectra without regard to their identification
to a specific analyte.</p>
    <p>Naïvely, one may attempt to use
something like the Jaccard
similarity, <italic>J</italic>, defined as the cardinality of the
intersection divided by the cardinality of the union<disp-formula id="eq7"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m083" position="anchor"/><label>7</label></disp-formula>However, no two spectra
are exactly the same.
If the criterion for considering two spectra identical (as in derived
from the same peptide) for the purpose of calculating |<inline-formula id="d33e922"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m084.gif"/></inline-formula>∩<inline-formula id="d33e925"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m085.gif"/></inline-formula>| and |<inline-formula id="d33e928"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m086.gif"/></inline-formula>∪<inline-formula id="d33e932"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m087.gif"/></inline-formula>| is too strict,
then one will underestimate
|<inline-formula id="d33e935"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m088.gif"/></inline-formula>∩<inline-formula id="d33e938"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m089.gif"/></inline-formula>| and overestimate
|<inline-formula id="d33e941"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m090.gif"/></inline-formula>∪<inline-formula id="d33e944"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m091.gif"/></inline-formula>|. If the criterion
is too lax, then one
overestimates |<inline-formula id="d33e947"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m092.gif"/></inline-formula>∩<inline-formula id="d33e951"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m093.gif"/></inline-formula>| and underestimates
|<inline-formula id="d33e954"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m094.gif"/></inline-formula>∪<inline-formula id="d33e957"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pr2c00457_m095.gif"/></inline-formula>|. In either
case, the errors would multiply,
making the Jaccard similarity very sensitive to the precise definition
of when two spectra are considered identical. Even more problematic
is the intransitive nature of this identity, which is exacerbated
by chimeric spectra—spectra that are superpositions of two
or more peptide tandem mass spectra. Briefly, a pure spectrum from
peptide <italic>P</italic> can be considered identical to a chimeric
spectrum with a small contribution from a second, cofragmenting peptide <italic>Q</italic>, which in turn is identical to a chimeric spectrum with
slightly larger contribution from peptide <italic>Q</italic>, and
so on, eventually ending up with the pure spectrum of peptide <italic>Q</italic>, which can be very different from the original spectrum
from peptide <italic>P</italic>, just like messages in a game of telephone.
This is why exercises clustering large numbers of tandem mass spectra
based on spectral similarity tend to produce large globs of spectra
rather than a distinct cluster for each peptide.</p>
  </sec>
  <sec id="sec4">
    <title>Conclusions</title>
    <p>compareMS2
compares sets of tandem mass spectra to each other rather
than to predicted spectra of specific peptides as when identifying
proteins from tandem mass spectra. We have used examples from molecular
phylogenetics, but many other uses have been demonstrated, including
food and feed identification, mixture analysis and experimental design.
compareMS2 may also be used data quality control - comparing large
numbers of datasets prior to database search and protein quantitation
to detect outliers and possible batch effects. The visualization of
spectral similarity as a function of precursor mass difference gives
another window into the data, and can suggest parameters for database
searches a priori. We make compareMS2 freely available as open source
and provide an automatic installer for Microsoft Windows in hope that
it may be as useful to others as it has been for us.</p>
  </sec>
</body>
<back>
  <notes notes-type="COI-statement" id="NOTES-d14e1467-autogenerated">
    <p>The authors declare
no
competing financial interest.</p>
  </notes>
  <ack>
    <title>Acknowledgments</title>
    <p>Tandem mass spectrometry data used for clustering
of California sea lion, chimpanzee, dog, human, rock hyrax, and white-tailed
deer serum were graciously provided with permission from an ongoing
collaboration with Dr. Michael G. Janech (College of Charleston) as
part of the CoMPARe Program (Comparative Mammalian Proteome Aggregator
Resource). Specifically, the California sea lion sera were provided
by The Marine Mammal Center (Sausalito, CA), the chimpanzee, rock
hyrax, and white-tailed deer sera were provided by The Chattanooga
Zoo, and the dog serum from Gus (Ohlandt Veterinary Clinic, Charleston,
SC). In addition to institutional and NMFS permits and approval, data
collection was performed under NIST ACUC MML-AR20-0001. The identification
of certain commercial equipment, instruments, software, or materials
does not imply recommendation or endorsement by the National Institute
of Standards and Technology, nor does it imply that the products identified
are necessarily the best available for the purpose. The authors also
thank all users of previous versions compareMS2 for providing valuable
feedback on the software and its installation on different systems.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="ref1">
      <mixed-citation publication-type="journal" id="cit1"><name><surname>Palmblad</surname><given-names>M.</given-names></name>; <name><surname>Deelder</surname><given-names>A. M.</given-names></name><article-title>Molecular phylogenetics
by direct comparison of tandem
mass spectra</article-title>. <source>Rapid Commun. Mass Spectrom.</source><year>2012</year>, <volume>26</volume>, <fpage>728</fpage>–<lpage>732</lpage>. <pub-id pub-id-type="doi">10.1002/rcm.6162</pub-id>.<pub-id pub-id-type="pmid">22368051</pub-id></mixed-citation>
    </ref>
    <ref id="ref2">
      <mixed-citation publication-type="journal" id="cit2"><name><surname>Wulff</surname><given-names>T.</given-names></name>; <name><surname>Nielsen</surname><given-names>M. E.</given-names></name>; <name><surname>Deelder</surname><given-names>A. M.</given-names></name>; <name><surname>Jessen</surname><given-names>F.</given-names></name>; <name><surname>Palmblad</surname><given-names>M.</given-names></name><article-title>Authentication
of fish products by large-scale comparison of tandem mass spectra</article-title>. <source>J. Proteome Res.</source><year>2013</year>, <volume>12</volume>, <fpage>5253</fpage>–<lpage>5259</lpage>. <pub-id pub-id-type="doi">10.1021/pr4006525</pub-id>.<pub-id pub-id-type="pmid">24032411</pub-id></mixed-citation>
    </ref>
    <ref id="ref3">
      <mixed-citation publication-type="journal" id="cit3"><name><surname>Ohana</surname><given-names>D.</given-names></name>; <name><surname>Dalebout</surname><given-names>H.</given-names></name>; <name><surname>Marissen</surname><given-names>R.</given-names></name>; <name><surname>Wulff</surname><given-names>T.</given-names></name>; <name><surname>Bergquist</surname><given-names>J.</given-names></name>; <name><surname>Deelder</surname><given-names>A.</given-names></name>; <name><surname>Palmblad</surname><given-names>M.</given-names></name><article-title>Identification of meat products by
shotgun spectral matching</article-title>. <source>Food chemistry</source><year>2016</year>, <volume>203</volume>, <fpage>28</fpage>–<lpage>34</lpage>. <pub-id pub-id-type="doi">10.1016/j.foodchem.2016.01.138</pub-id>.<pub-id pub-id-type="pmid">26948585</pub-id></mixed-citation>
    </ref>
    <ref id="ref4">
      <mixed-citation publication-type="journal" id="cit4"><name><surname>Rasinger</surname><given-names>J.</given-names></name>; <name><surname>Marbaix</surname><given-names>H.</given-names></name>; <name><surname>Dieu</surname><given-names>M.</given-names></name>; <name><surname>Fumière</surname><given-names>O.</given-names></name>; <name><surname>Mauro</surname><given-names>S.</given-names></name>; <name><surname>Palmblad</surname><given-names>M.</given-names></name>; <name><surname>Raes</surname><given-names>M.</given-names></name>; <name><surname>Berntssen</surname><given-names>M.</given-names></name><article-title>Species and
tissues specific differentiation of processed animal proteins in aquafeeds
using proteomics tools</article-title>. <source>Journal of proteomics</source><year>2016</year>, <volume>147</volume>, <fpage>125</fpage>–<lpage>131</lpage>. <pub-id pub-id-type="doi">10.1016/j.jprot.2016.05.036</pub-id>.<pub-id pub-id-type="pmid">27268957</pub-id></mixed-citation>
    </ref>
    <ref id="ref5">
      <mixed-citation publication-type="journal" id="cit5"><name><surname>Belghit</surname><given-names>I.</given-names></name>; <name><surname>Lock</surname><given-names>E.-J.</given-names></name>; <name><surname>Fumière</surname><given-names>O.</given-names></name>; <name><surname>Lecrenier</surname><given-names>M.-C.</given-names></name>; <name><surname>Renard</surname><given-names>P.</given-names></name>; <name><surname>Dieu</surname><given-names>M.</given-names></name>; <name><surname>Berntssen</surname><given-names>M. H. G.</given-names></name>; <name><surname>Palmblad</surname><given-names>M.</given-names></name>; <name><surname>Rasinger</surname><given-names>J. D.</given-names></name><article-title>Species-Specific Discrimination of
Insect Meals for Aquafeeds by Direct Comparison of Tandem Mass Spectra</article-title>. <source>Animals: an open access journal from MDPI</source><year>2019</year>, <volume>9</volume>, <fpage>222</fpage><pub-id pub-id-type="doi">10.3390/ani9050222</pub-id>.<pub-id pub-id-type="pmid">31067722</pub-id></mixed-citation>
    </ref>
    <ref id="ref6">
      <mixed-citation publication-type="journal" id="cit6"><name><surname>Belghit</surname><given-names>I.</given-names></name>; et al. <article-title>Future feed control – Tracing banned bovine material in insect
meal</article-title>. <source>Food Control</source><year>2021</year>, <volume>128</volume>, <fpage>108183</fpage><pub-id pub-id-type="doi">10.1016/j.foodcont.2021.108183</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref7">
      <mixed-citation publication-type="journal" id="cit7"><name><surname>Varunjikar</surname><given-names>M. S.</given-names></name>; <name><surname>Belghit</surname><given-names>I.</given-names></name>; <name><surname>Gjerde</surname><given-names>J.</given-names></name>; <name><surname>Palmblad</surname><given-names>M.</given-names></name>; <name><surname>Oveland</surname><given-names>E.</given-names></name>; <name><surname>Rasinger</surname><given-names>J. D.</given-names></name><article-title>Shotgun proteomics
approaches for authentication, biological
analyses, and allergen detection in feed and food-grade insect species</article-title>. <source>Food Control</source><year>2022</year>, <volume>137</volume>, <fpage>108888</fpage><pub-id pub-id-type="doi">10.1016/j.foodcont.2022.108888</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref8">
      <mixed-citation publication-type="journal" id="cit8"><name><surname>van
der Plas-Duivesteijn</surname><given-names>S. J.</given-names></name>; <name><surname>Mohammed</surname><given-names>Y.</given-names></name>; <name><surname>Dalebout</surname><given-names>H.</given-names></name>; <name><surname>Meijer</surname><given-names>A.</given-names></name>; <name><surname>Botermans</surname><given-names>A.</given-names></name>; <name><surname>Hoogendijk</surname><given-names>J. L.</given-names></name>; <name><surname>Henneman</surname><given-names>A. A.</given-names></name>; <name><surname>Deelder</surname><given-names>A. M.</given-names></name>; <name><surname>Spaink</surname><given-names>H. P.</given-names></name>; <name><surname>Palmblad</surname><given-names>M.</given-names></name><article-title>Identifying
proteins in zebrafish embryos using spectral libraries generated from
dissected adult organs and tissues</article-title>. <source>J. Proteome
Res.</source><year>2014</year>, <volume>13</volume>, <fpage>1537</fpage>–<lpage>1544</lpage>. <pub-id pub-id-type="doi">10.1021/pr4010585</pub-id>.<pub-id pub-id-type="pmid">24460240</pub-id></mixed-citation>
    </ref>
    <ref id="ref9">
      <mixed-citation publication-type="journal" id="cit9"><name><surname>van
der Plas-Duivesteijn</surname><given-names>S. J.</given-names></name>; <name><surname>Wulff</surname><given-names>T.</given-names></name>; <name><surname>Klychnikov</surname><given-names>O.</given-names></name>; <name><surname>Ohana</surname><given-names>D.</given-names></name>; <name><surname>Dalebout</surname><given-names>H.</given-names></name>; <name><surname>van Veelen</surname><given-names>P. A.</given-names></name>; <name><surname>de Keijzer</surname><given-names>J.</given-names></name>; <name><surname>Nessen</surname><given-names>M. A.</given-names></name>; <name><surname>van der Burgt</surname><given-names>Y. E. M.</given-names></name>; <name><surname>Deelder</surname><given-names>A. M.</given-names></name>; <name><surname>Palmblad</surname><given-names>M.</given-names></name><article-title>Differentiating samples and experimental
protocols by direct comparison of tandem mass spectra</article-title>. <source>Rapid communications in mass spectrometry: RCM</source><year>2016</year>, <volume>30</volume>, <fpage>731</fpage>–<lpage>738</lpage>. <pub-id pub-id-type="doi">10.1002/rcm.7494</pub-id>.<pub-id pub-id-type="pmid">26864526</pub-id></mixed-citation>
    </ref>
    <ref id="ref10">
      <mixed-citation publication-type="journal" id="cit10"><name><surname>Rieder</surname><given-names>V.</given-names></name>; <name><surname>Blank-Landeshammer</surname><given-names>B.</given-names></name>; <name><surname>Stuhr</surname><given-names>M.</given-names></name>; <name><surname>Schell</surname><given-names>T.</given-names></name>; <name><surname>Biß</surname><given-names>K.</given-names></name>; <name><surname>Kollipara</surname><given-names>L.</given-names></name>; <name><surname>Meyer</surname><given-names>A.</given-names></name>; <name><surname>Pfenninger</surname><given-names>M.</given-names></name>; <name><surname>Westphal</surname><given-names>H.</given-names></name>; <name><surname>Sickmann</surname><given-names>A.</given-names></name>; <name><surname>Rahnenführer</surname><given-names>J.</given-names></name><article-title>DISMS2: A
flexible algorithm for direct proteome- wide distance calculation
of LC-MS/MS runs</article-title>. <source>BMC bioinformatics</source><year>2017</year>, <volume>18</volume>, <fpage>148</fpage><pub-id pub-id-type="doi">10.1186/s12859-017-1514-2</pub-id>.<pub-id pub-id-type="pmid">28253837</pub-id></mixed-citation>
    </ref>
    <ref id="ref11">
      <mixed-citation publication-type="journal" id="cit11"><name><surname>Downard</surname><given-names>K. M.</given-names></name><article-title>Sequence-Free
Phylogenetics with Mass Spectrometry</article-title>. <source>Mass Spectrom.
Rev.</source><year>2020</year>, <volume>41</volume>, <fpage>3</fpage>–<lpage>14</lpage>. <pub-id pub-id-type="doi">10.1002/mas.21658</pub-id>.<pub-id pub-id-type="pmid">33169385</pub-id></mixed-citation>
    </ref>
    <ref id="ref12">
      <mixed-citation publication-type="journal" id="cit12"><name><surname>Neely</surname><given-names>B. A.</given-names></name>; <name><surname>Palmblad</surname><given-names>M.</given-names></name><article-title>Rewinding the Molecular
Clock: Looking at Pioneering
Molecular Phylogenetics Experiments in the Light of Proteomics</article-title>. <source>J. Proteome Res.</source><year>2021</year>, <volume>20</volume>, <fpage>4640</fpage>–<lpage>4645</lpage>. <pub-id pub-id-type="doi">10.1021/acs.jproteome.1c00528</pub-id>.<pub-id pub-id-type="pmid">34523928</pub-id></mixed-citation>
    </ref>
    <ref id="ref13">
      <mixed-citation publication-type="journal" id="cit13"><name><surname>Zuckerkandl</surname><given-names>E.</given-names></name>; <name><surname>Jones</surname><given-names>R.</given-names></name>; <name><surname>Pauling</surname><given-names>L.</given-names></name><article-title>A Comparison of Animal
Hemoglobins
by Tryptic Peptide Pattern Analysis</article-title>. <source>Proc. Natl.
Acad. Sci. U.S.A.</source><year>1960</year>, <volume>46</volume>, <fpage>1349</fpage>–<lpage>1360</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.46.10.1349</pub-id>.<pub-id pub-id-type="pmid">16590757</pub-id></mixed-citation>
    </ref>
    <ref id="ref14">
      <mixed-citation publication-type="journal" id="cit14"><name><surname>Chambers</surname><given-names>M. C.</given-names></name>; et al. <article-title>A cross-platform toolkit for mass spectrometry and proteomics</article-title>. <source>Nature biotechnology</source><year>2012</year>, <volume>30</volume>, <fpage>918</fpage>–<lpage>920</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.2377</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref15">
      <mixed-citation publication-type="journal" id="cit15"><name><surname>Shank</surname><given-names>S. D.</given-names></name>; <name><surname>Weaver</surname><given-names>S.</given-names></name>; <name><surname>Kosakovsky Pond</surname><given-names>S. L.</given-names></name><article-title>phylotree.js - a JavaScript library
for application development and interactive data visualization in
phylogenetics</article-title>. <source>BMC bioinformatics</source><year>2018</year>, <volume>19</volume>, <fpage>276</fpage><pub-id pub-id-type="doi">10.1186/s12859-018-2283-2</pub-id>.<pub-id pub-id-type="pmid">30045713</pub-id></mixed-citation>
    </ref>
    <ref id="ref16">
      <mixed-citation publication-type="journal" id="cit16"><name><surname>Perez-Riverol</surname><given-names>Y.</given-names></name>; <name><surname>Bai</surname><given-names>J.</given-names></name>; <name><surname>Bandla</surname><given-names>C.</given-names></name>; <name><surname>García-Seisdedos</surname><given-names>D.</given-names></name>; <name><surname>Hewapathirana</surname><given-names>S.</given-names></name>; <name><surname>Kamatchinathan</surname><given-names>S.</given-names></name>; <name><surname>Kundu</surname><given-names>D.</given-names></name>; <name><surname>Prakash</surname><given-names>A.</given-names></name>; <name><surname>Frericks-Zipper</surname><given-names>A.</given-names></name>; <name><surname>Eisenacher</surname><given-names>M.</given-names></name>; <name><surname>Walzer</surname><given-names>M.</given-names></name>; <name><surname>Wang</surname><given-names>S.</given-names></name>; <name><surname>Brazma</surname><given-names>A.</given-names></name>; <name><surname>Vizcaíno</surname><given-names>J.</given-names></name><article-title>The PRIDE database resources in 2022: a hub for mass
spectrometry-based proteomics evidences</article-title>. <source>Nucleic
Acids Res.</source><year>2022</year>, <volume>50</volume>, <fpage>D543</fpage>–<lpage>D552</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkab1038</pub-id>.<pub-id pub-id-type="pmid">34723319</pub-id></mixed-citation>
    </ref>
    <ref id="ref17">
      <mixed-citation publication-type="journal" id="cit17"><name><surname>Tamura</surname><given-names>K.</given-names></name>; <name><surname>Stecher</surname><given-names>G.</given-names></name>; <name><surname>Kumar</surname><given-names>S.</given-names></name><article-title>MEGA11: Molecular Evolutionary Genetics
Analysis Version 11</article-title>. <source>Mol. Biol. Evol.</source><year>2021</year>, <volume>38</volume>, <fpage>3022</fpage>–<lpage>3027</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msab120</pub-id>.<pub-id pub-id-type="pmid">33892491</pub-id></mixed-citation>
    </ref>
    <ref id="ref18">
      <mixed-citation publication-type="book" id="cit18"><person-group person-group-type="allauthors"><name><surname>Sneath</surname><given-names>P.</given-names></name>; <name><surname>Sokal</surname><given-names>R.</given-names></name></person-group><source>Numerical Taxonomy: The Principles
and Practice of Numerical Classification</source>; <publisher-name>Freeman</publisher-name>: <publisher-loc>San Francisco</publisher-loc>, <year>1973</year>.</mixed-citation>
    </ref>
    <ref id="ref19">
      <mixed-citation publication-type="journal" id="cit19"><name><surname>Keller</surname><given-names>A.</given-names></name>; <name><surname>Nesvizhskii</surname><given-names>A. I.</given-names></name>; <name><surname>Kolker</surname><given-names>E.</given-names></name>; <name><surname>Aebersold</surname><given-names>R.</given-names></name><article-title>Empirical
Statistical Model To Estimate the Accuracy of Peptide Identifications
Made by MS/MS and Database Search</article-title>. <source>Anal. Chem.</source><year>2002</year>, <volume>74</volume>, <fpage>5383</fpage>–<lpage>5392</lpage>. <pub-id pub-id-type="doi">10.1021/ac025747h</pub-id>.<pub-id pub-id-type="pmid">12403597</pub-id></mixed-citation>
    </ref>
    <ref id="ref20">
      <mixed-citation publication-type="journal" id="cit20"><name><surname>Käll</surname><given-names>L.</given-names></name>; <name><surname>Canterbury</surname><given-names>J. D.</given-names></name>; <name><surname>Weston</surname><given-names>J.</given-names></name>; <name><surname>Noble</surname><given-names>W. S.</given-names></name>; <name><surname>MacCoss</surname><given-names>M. J.</given-names></name><article-title>Semi-supervised
learning for peptide identification from shotgun proteomics datasets</article-title>. <source>Nat. Methods</source><year>2007</year>, <volume>4</volume>, <fpage>923</fpage>–<lpage>925</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth1113</pub-id>.<pub-id pub-id-type="pmid">17952086</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
