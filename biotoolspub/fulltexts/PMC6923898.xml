<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6923898</article-id>
    <article-id pub-id-type="publisher-id">3251</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-019-3251-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>BISR-RNAseq: an efficient and scalable RNAseq analysis workflow with interactive report generation</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Gadepalli</surname>
          <given-names>Venkat Sundar</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ozer</surname>
          <given-names>Hatice Gulcin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yilmaz</surname>
          <given-names>Ayse Selen</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pietrzak</surname>
          <given-names>Maciej</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Webb</surname>
          <given-names>Amy</given-names>
        </name>
        <address>
          <email>amy.hite@osumc.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2285 7943</institution-id><institution-id institution-id-type="GRID">grid.261331.4</institution-id><institution>Biomedical Informatics, </institution><institution>The Ohio State University, </institution></institution-wrap>Columbus, OH USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2285 7943</institution-id><institution-id institution-id-type="GRID">grid.261331.4</institution-id><institution>The James Comprehensive Cancer Center, </institution><institution>The Ohio State University, </institution></institution-wrap>Columbus, OH USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2285 7943</institution-id><institution-id institution-id-type="GRID">grid.261331.4</institution-id><institution>Bioinformatics Shared Resource Group, </institution><institution>The Ohio State University, </institution></institution-wrap>Columbus, OH USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <issue>Suppl 24</issue>
    <issue-sponsor>Publication of this supplement has not been supported by sponsorship. Information about the source of funding for publication charges can be found in the individual articles. The articles have undergone the journal's standard peer review process for supplements. Supplement editors were not involved in the review process of any of the manuscripts that they co-authored. The Supplement Editors declare that they have no other competing interests.</issue-sponsor>
    <elocation-id>670</elocation-id>
    <permissions>
      <copyright-statement>© The Author(s). 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">RNA sequencing has become an increasingly affordable way to profile gene expression patterns. Here we introduce a workflow implementing several open-source softwares that can be run on a high performance computing environment.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Developed as a tool by the Bioinformatics Shared Resource Group (BISR) at the Ohio State University, we have applied the pipeline to a few publicly available RNAseq datasets downloaded from GEO in order to demonstrate the feasibility of this workflow. Source code is available here: workflow: <ext-link ext-link-type="uri" xlink:href="https://code.bmi.osumc.edu/gadepalli.3/BISR-RNAseq-ICIBM2019">https://code.bmi.osumc.edu/gadepalli.3/BISR-RNAseq-ICIBM2019</ext-link> and shiny: <ext-link ext-link-type="uri" xlink:href="https://code.bmi.osumc.edu/gadepalli.3/BISR_RNASeq_ICIBM19">https://code.bmi.osumc.edu/gadepalli.3/BISR_RNASeq_ICIBM19</ext-link>. Example dataset is demonstrated here: <ext-link ext-link-type="uri" xlink:href="https://dataportal.bmi.osumc.edu/RNA_Seq/">https://dataportal.bmi.osumc.edu/RNA_Seq/</ext-link>.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">The workflow allows for the analysis (alignment, QC, gene-wise counts generation) of raw RNAseq data and seamless integration of quality analysis and differential expression results into a configurable R shiny web application.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>RNAseq</kwd>
      <kwd>Transcriptome</kwd>
      <kwd>Workflow</kwd>
      <kwd>Visualization</kwd>
    </kwd-group>
    <conference xlink:href="http://icibm2019.org/">
      <conf-name>The International Conference on Intelligent Biology and Medicine (ICIBM) 2019</conf-name>
      <conf-acronym>ICIBM 2019</conf-acronym>
      <conf-loc>Columbia, OH, USA</conf-loc>
      <conf-date>09-11 June 2019</conf-date>
    </conference>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par14">A whole transcriptome sequence provides an estimate of the quantity of all transcripts present in a group of cells. High throughput sequencing technologies have been developed to deep sequence the transcriptome. Sequencing generates several million short reads that are typically 50–400 bases in length. These reads can be mapped to a known reference genome or assembled de-novo. Either method will provide a snapshot of the transcript present in the sample and an estimate of abundance. Statistical methods have been developed to normalize and compare transcript estimates to identify differential transcripts. At each step of the bioinformatics analysis pipeline, there are many options for specific programs to use, reference genome for alignment, and gene annotation set of expression quantification. One of the challenges for the analysis of transcriptome data is to have a reproducible set of steps for consistent analysis. The aim of this study was to generate a standardized workflow available to the public that would make RNAseq analysis easier to implement, especially for non-expert users.</p>
    <p id="Par15">The growth of genomics data has been exponential over past 5 years. The workflow established by various researchers to store, analyze and deliver the results have been scaling in order to meet the requirements of large scale data. Open source software and technology have been widely adapted to address the requirements in genomics data analysis. Interpreting, understanding and communicating the results in genomics is commonly done using respective plots and tables from the data analysis outputs. There are many open source software such as R [<xref ref-type="bibr" rid="CR1">1</xref>], Bioconductor [<xref ref-type="bibr" rid="CR2">2</xref>], Shiny [<xref ref-type="bibr" rid="CR3">3</xref>] that have facilitated researchers to explore insights in genomics data. However, leveraging these open source technologies in a scalable way is still a challenge for analysts or users who are not familiar with these open source technologies. As the Bioinformatics Shared Resource (BISR) group at OSU, we developed this workflow to provide consistent analysis and reports to our collaborators. Other groups have developed workflows and pipelines to streamline RNAseq analysis [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. Unlike other applications, our approach is easily scalable as it can run multiple samples in parallel in a pbs scripting environment. It allows us to retain version control with a config file and pbs script detailing particular options and versions used in the workflow. This allows an expert user to switch version s or programs of the workflow including alignment program or reference genome. The shiny application offers interactive visualizations and has an R backend that takes advantage of R packages typically used in RNAseq analysis. Through an interaction with OSC, we have a storage environment for shiny reports providing protected, private access for end users.</p>
    <p id="Par16">Using Shiny and other libraries, we designed a scalable workflow for creating interactive RNAseq reports which can be easily launched and customized by users who are not expert users of shiny or R. Our workflow is one of the first to pipe into a customizable R shiny application for visualization and reports generation.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par17">Example datasets can be downloaded from GEO repositories in fastq format using ‘fastq-dump’ from NCBI.</p>
    <p id="Par18">If reference files are not available, gather required files: download reference genome and index for hisat2 use, download bed files from RSeQC for gene definitions and ribosomal gene locations, download gene annotation file appropriate for genome. Install all used programs and have locations included in your PATH.</p>
    <p id="Par19">Clone RNAseq_pipeline from github (<ext-link ext-link-type="uri" xlink:href="https://github.com/MPiet11/BISR-RNAseq">https://github.com/MPiet11/BISR-RNAseq</ext-link>)</p>
    <p id="Par20">Generate a sample file containing 3 columns—name of forward read fastq, name of reverse read fastq, and name of sample. Sample name should not contain any dashes. For single end datasets, leave NA as a placeholder for the reverse read. Scripts assume fastq files will be in a folder within the working directory named “fastq.” Fastq can be gzipped or as is. If gzipped, name of fastq in sample file should reflect this.</p>
    <p id="Par21">Edit config file with full path and names of required parameters (sample file, pbs script, reference genome, gene annotation, ribosomal bed, and gene definition bed).</p>
    <p id="Par22">Execution of the config file will pass the entered parameters to a shell script which will submit a job for each sample to run the provided pbs script. Modify pbs header for resources provided by your specific pbs computing environment.</p>
    <p id="Par23">Provided pbs script will execute the following pipeline:
<list list-type="order"><list-item><p id="Par24">Raw read QC with fastqc for forward and reverse read fastq. Results from different samples can be gathered with multiQC</p></list-item><list-item><p id="Par25">Raw read alignment with HISAT2</p></list-item><list-item><p id="Par26">Convert sam to bam, sort, and index with samtools</p></list-item><list-item><p id="Par27">Generate post alignment QC metrics with RSeQC (detected junctions, read distribution, experiment type, and ribosomal contamination) and picard (insert size and duplication rate)</p></list-item><list-item><p id="Par28">Count reads per gene with featureCounts</p></list-item></list></p>
    <p id="Par29">After all samples have finished, provided script ‘rnaseq_final_reports.sh’ can be submitted to gather QC and counts. This script requires datamash for table reformatting. Script will also gather unnecessary files into a trash folder. Finally the script runs 2 provided R scripts—1. ‘read_data_for_rshiny.R’ will read all QC/counts tables into an rds object. 2. ‘create_rshiny_input.R’ will run differential expression (set up in DGE_RNAseq_limma.R) calculating a pair-wise comparison of groups using limma and package all results into an rds object for shiny. Differential expression requires a file with gene_ID, gene names, and biotype and a file with sample names and groups for comparison. Place these files in a folder named ‘raw_data’.</p>
    <p id="Par30">Detailed installation instructions are provided in the README file on the project gitlab <ext-link ext-link-type="uri" xlink:href="https://code.bmi.osumc.edu/gadepalli.3/BISR_RNASeq_ICIBM19">https://code.bmi.osumc.edu/gadepalli.3/BISR_RNASeq_ICIBM19</ext-link>. Overall the steps are as follows
<list list-type="order"><list-item><p id="Par31">To run the shiny app clone the git repository to local computer or a server that runs shiny.</p></list-item><list-item><p id="Par32">The input files for R shiny report should be transferred into the ‘data’ folder under the shiny app folder. The app currently is setup with packrat package manager, but the choice is left to the user to discard it and install packages as required.</p></list-item><list-item><p id="Par33">It is important to make sure that the R libraries are loaded as required. For this purpose, the user can run the load_project_packages.R in R IDE or using a command line ‘Rscript load_project_packages.R’. This script loads the library if it is already present or it will install the missing libraries.</p></list-item><list-item><p id="Par34">Finally, the user would need to make sure that names of the input files match to those listed under read_data.R. If there is a naming difference, these should be fixed in order for the shiny app to read the data.</p></list-item><list-item><p id="Par35">To launch the app the user can run ‘shiny::runApp(‘app. R’)’.</p></list-item></list></p>
    <p id="Par36">To launch the shiny app over a webserver it is required to install and setup R shiny server. The installation and setup instructions are detailed in the Rstudio help pages <ext-link ext-link-type="uri" xlink:href="https://www.rstudio.com/products/shiny/shiny-server/">https://www.rstudio.com/products/shiny/shiny-server/</ext-link>. The setup of the app to run with user data follows the above same steps.</p>
  </sec>
  <sec id="Sec3">
    <title>Results</title>
    <p id="Par37">A conceptual outline of this workflow is presented in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. A set of fastq formatted sequencing files are fed into the parallel alignment and gene counts generation is shown in the workflow. For a given dataset, we make a tab-delimited three column sample manifest listing the forward read, the reverse read, and a name that will be used to identify the sample through analysis. If a sample is run on multiple lanes, we recommend leaving them separate so that QC can be assessed on individual lanes. Counts from different lanes can be summed at the end. For the purposes of this article, raw data was downloaded from NCBI’s Gene Expression Omnibus (GSE48403 [<xref ref-type="bibr" rid="CR8">8</xref>]). Scripts are setup to be run in a high performance computing (HPC) environment that utilizes portable batch system (PBS) for job scheduling and could be easily modified for other schedulers such as slurm.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Schematic workflow of RNAseq pipeline. A list of fastq files and locations of necessary reference files are fed into config file which spawns a workflow run job for each sample. Results are gathered into an R data object and differential expression is calculated through provided R code. Visualization is provided through R shiny app</p></caption><graphic xlink:href="12859_2019_3251_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par38">Run time variables and paths are set in the config file. This includes reference genome, gene annotation gtf, bed files needed for RSeQC [<xref ref-type="bibr" rid="CR9">9</xref>], name of pbs script, etc. The pbs script runs a pipeline with default setup preferred by our group. Advanced users can modify this pbs script with additional program options or switch out the programs used for particular steps (for instance run STAR [<xref ref-type="bibr" rid="CR10">10</xref>] instead of HISAT2 [<xref ref-type="bibr" rid="CR11">11</xref>]). We assume all required programs have been installed and accessible on the cluster environment. Locations for python applications like RSeQC [<xref ref-type="bibr" rid="CR9">9</xref>] will need to be added to the PYTHONPATH. The workflow also assumes that you have generated reference genome indexes appropriate for your alignment program and that you have a gene definition file in gtf format in the same coordinates as your genome.</p>
    <p id="Par39">A sample file is a tab-delimited 3 column file generated by the user listing the forward and reverse fastq files and a name for the sample. Executing the config file launches a workflow job for each sample listed in the sample file and runs through the set of steps laid out in the pbs script.</p>
    <p id="Par40">The first step in the analysis of RNAseq raw data is to assess the QC of the raw sequence. We accomplish this by generating a view of the data in FastQC and summarizing those views with mutliQC [<xref ref-type="bibr" rid="CR12">12</xref>]. multiQC generates an html document summarizing all FastQC results across multiple samples. Important checks include sequence quality along the length of the read and adapter content. Any adapter content can be trimmed with Cutadapt [<xref ref-type="bibr" rid="CR13">13</xref>] or Trimmomatic [<xref ref-type="bibr" rid="CR14">14</xref>] but the workflow here assumes adapters are not present.</p>
    <p id="Par41">Raw fastq files are aligned using HISAT2 [<xref ref-type="bibr" rid="CR9">9</xref>] with default options to the reference genome specified in the config file. For alignment we used Ensembl’s GRCh38 [<xref ref-type="bibr" rid="CR15">15</xref>] reference genome indexed using hisat2-build. HISAT2 generates summary statistics on overall mapping rate and uniqueness of mapping.</p>
    <p id="Par42">Alignment QC is generated using RSeQC [<xref ref-type="bibr" rid="CR7">7</xref>] and picard [<xref ref-type="bibr" rid="CR16">16</xref>] to assess: duplication rate, insert size for paired end reads, ribosomal contamination, proportion of known/novel junctions detected, read distribution across genomic features, library preparation approach based on paired read alignment. Gene definition and ribosomal gene location in bed format were downloaded from the RSeQC website. The main aim of the alignment QC is to check whether the alignment is consistent across samples and that it confirms what is known about the library preparation.</p>
    <p id="Par43">We use featureCounts [<xref ref-type="bibr" rid="CR17">17</xref>] from the subread package to count reads on genes. In-house we prefer using the primary option for multimapped reads. Gene annotation definition file in gtf format is specified in the config file. For this example, we used Ensembl gene annotation release 92 [<xref ref-type="bibr" rid="CR18">18</xref>].</p>
    <p id="Par44">R scripts are provided to gather QC metrics into an rdata object, run simple pairwise differential expression, and format the data for display by the R shiny app. Expert users with a more complicated experimental design could write their own code for differential expression.</p>
    <p id="Par45">Wrapping sequencing data analysis into an interactive framework enhances the exploration of large scale genomics data effortlessly. Shiny is a web application framework [<xref ref-type="bibr" rid="CR3">3</xref>] that facilitates R users to build interactive visualizations on the data analysis outputs However, to implement it at analysis core facility would need to build a production level software. The setup presented here allows seamless integration with experimental designs that can be easily customizable without the expertise in web programming. To achieve this task, we have designed and developed interactive reports in shiny that offer generality and extensibility. The overall design is detailed in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. Figure <xref rid="Fig2" ref-type="fig">2</xref>a, outlines the different inputs for BISR shiny app. A configuration file, wrangled data object, and project relevant accessory files. The configuration file in JSON format stores the information on what user interface (UI) components should the shiny app render. The goal of the configuration file is to allow non-shiny and R users ability to customize their UI and launch their data analysis findings. A complete configuration file is provided the source code under the ‘data’ folder. This allows a non-shiny user to customize or change UI components. The wrangled data in RDS format stores the information about the specific data values and parameters for respective plots and tables to be displayed on the UI. Finally, the project detail files comprise of any html or Rmarkdown files that provide relevant information for respective RNA sequencing project. These project detail files are optional, but to run the app it is required to provide the JSON configuration file and as well as the data. RDS object.
<fig id="Fig2"><label>Fig. 2</label><caption><p>The overall design of the BISR RNASeq shiny app. <bold>a</bold> Data gathering: The 3 inputs files that BISR shiny app takes as inputs (1) config.json file, that defines the shiny UI (2) a .Rds object generated by custom R script run on RNAseq pipeline output (3) files relevant to the project that are generated as Rmarkdown or html files. These three items are sent into the app which is made up of the following components <bold>b</bold> A screen shot of BISR RNAseq report</p></caption><graphic xlink:href="12859_2019_3251_Fig2_HTML" id="MO2"/></fig></p>
    <p id="Par46">The Fig. <xref rid="Fig2" ref-type="fig">2</xref>b, show an overview of the components of the BISR shiny app. These components comprises of specific codes that offers extensibility and scalability. In order create a self-contained app we used packrat [<xref ref-type="bibr" rid="CR19">19</xref>], an R-library manager that offers seamless deployment of apps across different operating systems. The interactive shiny report that BISR delivers comprises of sequence quality analysis plots, differential gene analysis plots and their respective tables. To reduce the repeatability of code and enhance the reproducibility we developed shiny modules for respective plots. These small composable shiny modules are extensible across different apps. CRAN and Bioconductor libraries were employed to achieve this task.</p>
    <p id="Par47">Figure <xref rid="Fig2" ref-type="fig">2</xref>b displays the output in the RNAseq report. The left hand panel shows the different subsections provided in a report as part of the configuration JSON file —Project description, QC metrics, read count table, and differential expression results. An example figure is provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref> and the complete JSON file is included in the source code under the ‘data’ folder. Differential expression results are presented as a volcano plot, MA plot, and heatmap. Each plot is customizable based on FDR, fold change, and base line expression levels. The customized results can be exported for publication or further analysis.</p>
  </sec>
  <sec id="Sec4">
    <title>Discussion</title>
    <p id="Par48">This workflow was created to address issues encountered when processing a large number of RNAseq datasets. First, we wanted a workflow that would run sequence of commands in a consistent manner. Second, we wanted to keep a record of runtime details including: genome version, gene annotation set, program version, program options, etc. Third, we wanted a smooth transition from generating RNAseq results from the workflow to visualization through a shiny app.</p>
    <p id="Par49">This workflow encourages consistency between RNAseq analysis datasets. The workflow is intended to be downloaded as a self-contained directory where the user can add their own fastq files and sample file. The first step is to run the config file to generate QC, alignment, and counts. As technologies and software improves, programs called in the bulk of the workflow could be switched out with minimal effort as long as users are conscious about with the program needs and what is generated as an output. The second step is to gather QC and counts, compute differential expression, and package the results for our R shiny app. The third step is to launch the shiny app and view the results. The shiny app provides a user-friendly visualization for the data, understandable for even non-bioinformatics users. If raw data comes in batches, it is easy to reuse a set config file and pbs script.</p>
    <p id="Par50">Most of the workflow parameters are set in the config file or the pbs script. Retaining these files will allow a user to keep a record of run-time details such as program versions and genome versions. With these details and the raw fastq, the analysis could be recreated at any point in the future.</p>
    <p id="Par51">This application provides a smooth transition from QC and counts generation to visualization. The provided R scripts pull results from individual samples into summary tables and calculate differential expression. All results are stored in an. Rds object with additional details needed for R shiny visualization including parameters that are needed for respective plots. A large benefit to the R shiny application environment is automatic plotting of interactive graphs. Graphs for QC are plotted with options to scale based on library size or unscaled. Publication ready plots can be exported as .png and the filtered and unfiltered tables can be downloaded in CSV format. Differential expression results are visualized as volcano plots, MA plots, and heatmaps and all plots can be filtered for FDR, fold change, and expression levels.</p>
    <p id="Par52">The goal of this project is to provide a scalable and configurable RNAseq pipeline that can run the analysis and as well as integrate the results in a seamless way. Bioinformaticians who are not familiar with shiny can easily customize the UI end of the shiny so that creating project specific interactive report is effortless. As noted in the Fig. <xref rid="Fig2" ref-type="fig">2</xref>b, the sidebar contents (controllers and input boxes) and the body contents (plots and tables) for the Volcano plot are determined by the config. JSON. The Fig. <xref rid="Fig2" ref-type="fig">2</xref>b, displays a Volcano plot and has certain controllers to interact with the data displayed on the plot. While the JSON file offers customization to at menu, submenu and box levels. When the name, tabname (id), data frame name, display and UI and Server module are changed the UI renders accordingly.</p>
  </sec>
  <sec id="Sec5">
    <title>Conclusions</title>
    <p id="Par53">Presented is a consistent workflow to analyze RNAseq data and generate interactive reports and customizable visualization suitable for publication. The application is simple to use and set up to parallelize analysis in a supercomputer environment. This workflow empowers researchers without bioinformatics or programming experience to run quick analysis on their data by working with human readable configuration files. The user-interface on the shiny end is configurable with a simple JSON file thus facilitating generation of interactive visualization report across different RNAseq projects. The resulting R shiny report and figures are suitable for non-bioinformatics use and for guiding future biological research. Work-in-progress to create an R package and an active development process to implement feasible feature requests from users on github.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec6">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2019_3251_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1.</bold> Example of JSON file customization translated into R shiny display.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>BISR</term>
        <def>
          <p id="Par4">Bioinformatics shared resource</p>
        </def>
      </def-item>
      <def-item>
        <term>GEO</term>
        <def>
          <p id="Par5">Gene expression omnibus</p>
        </def>
      </def-item>
      <def-item>
        <term>HPC</term>
        <def>
          <p id="Par6">High peformance computing</p>
        </def>
      </def-item>
      <def-item>
        <term>IDE</term>
        <def>
          <p id="Par7">Integrated development environment</p>
        </def>
      </def-item>
      <def-item>
        <term>NCBI</term>
        <def>
          <p id="Par8">National Center for Biotechnology Information</p>
        </def>
      </def-item>
      <def-item>
        <term>OSU</term>
        <def>
          <p id="Par9">Ohio State University</p>
        </def>
      </def-item>
      <def-item>
        <term>PBS</term>
        <def>
          <p id="Par10">Portable batch system</p>
        </def>
      </def-item>
      <def-item>
        <term>QC</term>
        <def>
          <p id="Par11">Quality control</p>
        </def>
      </def-item>
      <def-item>
        <term>RNA</term>
        <def>
          <p id="Par12">Ribonucleic acid</p>
        </def>
      </def-item>
      <def-item>
        <term>UI</term>
        <def>
          <p id="Par13">User interface</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12859-019-3251-1.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>Cluster computing environment support to run BISR RNA sequencing pipeline was provided by Ohio Supercomputer Center (OSC). HPC resources were supported by department of Biomedical Informatics. Biomedical Informatics (BMI) data portal server to launch interactive BISR-RNASeq report was supported by BMI and shiny server installation and setup was done by Rohit Vanam, BMI informatics team.</p>
    <sec id="FPar1">
      <title>About this supplement</title>
      <p id="Par54">This article has been published as part of <italic>BMC Bioinformatics Volume 20 Supplement 24, 2019: The International Conference on Intelligent Biology and Medicine (ICIBM) 2019</italic>. The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-20-supplement-24">https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-20-supplement-24</ext-link>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>AW and VSG wrote the initial draft of the paper and contributed figures. AW, HGO, and ASY built, tested, and ran the workflow. VSG wrote the shiny app. MP contributed key ideas and feedback. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported in part by the National Cancer Institute grants CA016058. Publication costs are funded by the Department of Biomedical Informatics at The Ohio State University.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Project name: BISR-RNAseq</p>
    <p>Project home page: workflow: <ext-link ext-link-type="uri" xlink:href="https://github.com/MPiet11/BISR-RNAseq">https://github.com/MPiet11/BISR-RNAseq</ext-link> and shiny: <ext-link ext-link-type="uri" xlink:href="https://code.bmi.osumc.edu/gadepalli.3/BISR_RNASeq_ICIBM19">https://code.bmi.osumc.edu/gadepalli.3/BISR_RNASeq_ICIBM19</ext-link></p>
    <p>Operating system(s): RNAseq pipeline workflow: Linux. Shiny workflow: Windows, Linux/shiny server</p>
    <p>Programming language: BASH, R, python</p>
    <p>Other requirements: RNAseq pipeline workflow: Installed analysis programs (fastqc, hisat2, samtools, rseqc, picard, featureCounts), reference genome and gene annotation gtf. For shiny, Rstudio IDE (suggested). All the packages required to launch interactive report are listed under ‘load_project_packages.R’.</p>
    <p>License: Open Source (MIT)</p>
    <p>Any restrictions to use by non-academics: none</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p id="Par55">Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p id="Par56">Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par57">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <collab>R Core Team</collab>
        </person-group>
        <source>R: the R project for statistical computing</source>
        <year>2018</year>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Morgan</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <source>BiocVersion: set the appropriate version of bioconductor packages</source>
        <year>2018</year>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Chang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Allaire</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>McPherson</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>Web application framework for R [R package shiny version 1.2.0]</source>
        <year>2018</year>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cornwell</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vangala</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Taing</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Herbert</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Köster</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>VIPER: visualization pipeline for RNA-seq, a Snakemake workflow for efficient and complete RNA-seq analysis</article-title>
        <source>BMC Bioinformatics</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>135</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-018-2139-9</pub-id>
        <?supplied-pmid 29649993?>
        <pub-id pub-id-type="pmid">29649993</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wagle</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Nikolić</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Frommolt</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>QuickNGS elevates next-generation sequencing data analysis to a new level of automation</article-title>
        <source>BMC Genomics</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>487</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-015-1695-x</pub-id>
        <?supplied-pmid 26126663?>
        <pub-id pub-id-type="pmid">26126663</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Xi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Quan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Xi</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>von Schack</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>QuickRNASeq lifts large-scale RNA-seq data analyses to the next level of automation and interactive visualization</article-title>
        <source>BMC Genomics</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>39</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-015-2356-9</pub-id>
        <?supplied-pmid 26747388?>
        <pub-id pub-id-type="pmid">26747388</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kalari</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Nair</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Bhavsar</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>O’Brien</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Davila</surname>
            <given-names>JI</given-names>
          </name>
          <name>
            <surname>Bockol</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MAP-RSeq: Mayo analysis pipeline for RNA sequencing</article-title>
        <source>BMC Bioinformatics</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>224</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-15-224</pub-id>
        <?supplied-pmid 24972667?>
        <pub-id pub-id-type="pmid">24972667</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rajan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sudbery</surname>
            <given-names>IM</given-names>
          </name>
          <name>
            <surname>Villasevil</surname>
            <given-names>MEM</given-names>
          </name>
          <name>
            <surname>Mui</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Fleming</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Next-generation sequencing of advanced prostate cancer treated with androgen-deprivation therapy</article-title>
        <source>Eur Urol</source>
        <year>2014</year>
        <volume>66</volume>
        <fpage>32</fpage>
        <lpage>39</lpage>
        <pub-id pub-id-type="doi">10.1016/j.eururo.2013.08.011</pub-id>
        <?supplied-pmid 24054872?>
        <pub-id pub-id-type="pmid">24054872</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>RSeQC: quality control of RNA-seq experiments</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>2184</fpage>
        <lpage>2185</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts356</pub-id>
        <?supplied-pmid 22743226?>
        <pub-id pub-id-type="pmid">22743226</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dobin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Schlesinger</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Drenkow</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zaleski</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jha</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>STAR: ultrafast universal RNA-seq aligner</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>15</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts635</pub-id>
        <?supplied-pmid 23104886?>
        <pub-id pub-id-type="pmid">23104886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>HISAT: a fast spliced aligner with low memory requirements</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>357</fpage>
        <lpage>360</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3317</pub-id>
        <?supplied-pmid 25751142?>
        <pub-id pub-id-type="pmid">25751142</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ewels</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Magnusson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lundin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Käller</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>MultiQC: summarize analysis results for multiple tools and samples in a single report</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>3047</fpage>
        <lpage>3048</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw354</pub-id>
        <?supplied-pmid 5039924?>
        <pub-id pub-id-type="pmid">27312411</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martin</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Cutadapt removes adapter sequences from high-throughput sequencing reads</article-title>
        <source>EMBnet J</source>
        <year>2011</year>
        <volume>17</volume>
        <fpage>10</fpage>
        <pub-id pub-id-type="doi">10.14806/ej.17.1.200</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bolger</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Lohse</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Usadel</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Trimmomatic: a flexible trimmer for Illumina sequence data</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>2114</fpage>
        <lpage>2120</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu170</pub-id>
        <?supplied-pmid 4103590?>
        <pub-id pub-id-type="pmid">24695404</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Consortium GR. Genome reference consortium human build 38 patch release 12 (GRCh38.p12). NCBI <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/assembly/GCF_000001405.38?report=full">https://www.ncbi.nlm.nih.gov/assembly/GCF_000001405.38?report=full</ext-link>. Accessed Mar 2016.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">BROAD Institute. Picard tools - by Broad Institute. <ext-link ext-link-type="uri" xlink:href="http://broadinstitute.github.io/picard/">http://broadinstitute.github.io/picard/</ext-link>. Accessed 24 Feb 2019.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>featureCounts: an efficient general purpose program for assigning sequence reads to genomic features</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>923</fpage>
        <lpage>930</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt656</pub-id>
        <?supplied-pmid 24227677?>
        <pub-id pub-id-type="pmid">24227677</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zerbino</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Achuthan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Akanni</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Amode</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Barrell</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bhai</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ensembl 2018</article-title>
        <source>Nucleic Acids Res</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>D754</fpage>
        <lpage>D761</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx1098</pub-id>
        <?supplied-pmid 29155950?>
        <pub-id pub-id-type="pmid">29155950</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Ushey</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>McPherson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Atkins</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Allaire</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <source>packrat: a dependency management system for projects and their R package dependencies</source>
        <year>2018</year>
      </element-citation>
    </ref>
  </ref-list>
</back>
