<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6929499</article-id>
    <article-id pub-id-type="publisher-id">3313</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-019-3313-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>perfectphyloR: An R package for reconstructing perfect phylogenies</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Karunarathna</surname>
          <given-names>Charith B.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Graham</surname>
          <given-names>Jinko</given-names>
        </name>
        <address>
          <email>jgraham@sfu.ca</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1">Department of Statistics and Actuarial Science, 8888 University Drive, Burnaby, V5A 1S6 Canada </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>23</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>729</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>8</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>12</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Karunarathna and Graham. 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">A perfect phylogeny is a rooted binary tree that recursively partitions sequences. The nested partitions of a perfect phylogeny provide insight into the pattern of ancestry of genetic sequence data. For example, sequences may cluster together in a partition indicating that they arise from a common ancestral haplotype.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We present an R package perfectphyloR to reconstruct the local perfect phylogenies underlying a sample of binary sequences. The package enables users to associate the reconstructed partitions with a user-defined partition. We describe and demonstrate the major functionality of the package.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">The perfectphyloR package should be of use to researchers seeking insight into the ancestral structure of their sequence data. The reconstructed partitions have many applications, including the mapping of trait-influencing variants.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Perfect phylogeny</kwd>
      <kwd>Ancestry</kwd>
      <kwd>Sequence</kwd>
      <kwd>Trait-influencing variants</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>A perfect phylogeny is a rooted binary tree that represents a recursive partitioning of a set of objects such as deoxyribonucleic acid (DNA) sequences [<xref ref-type="bibr" rid="CR1">1</xref>]. Though the perfect phylogenies are not ancestral trees, the structure of their nested partitions provides insight into the pattern of ancestry of DNA sequences. For example, the perfect phylogeny near a trait-influencing variant can provide useful information about trait association [<xref ref-type="bibr" rid="CR2">2</xref>]. For instance, in a case-control study, case alleles may tend to cluster in a partition if the corresponding variant influences disease susceptibility. If a cluster has proportionally more case sequences than other clusters in the partition, there will be an association between the disease and cluster membership [<xref ref-type="bibr" rid="CR3">3</xref>]. Thus, an R package to reconstruct perfect phylogenies from sequence data can be of use to researchers mapping the genetic location of trait-influencing variants.</p>
    <p>We present an R package perfectphyloR to reconstruct perfect phylogenies underlying a sample of DNA sequences. The package uses a classic algorithm [<xref ref-type="bibr" rid="CR1">1</xref>] together with heuristics [<xref ref-type="bibr" rid="CR2">2</xref>] to partition sequences. Related software includes PerfectPhy [<xref ref-type="bibr" rid="CR4">4</xref>] and BLOck aSSOCiation (BLOSSOC) [<xref ref-type="bibr" rid="CR2">2</xref>].</p>
    <p>PerfectPhy is a C++ program that implements efficient algorithms [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>] for reconstructing perfect phylogenies from multi-allelic DNA markers. The software comes with a collection of tools for importing/exporting files, handling missing data, filtering markers and drawing trees. PerfectPhy takes a given set of sequences and determines if it can be represented by a perfect phylogeny; if so, the partition is returned. The filtering tool can be applied in advance to select a maximal subset of markers compatible with a perfect phylogeny.</p>
    <p>BLOSSOC is a C++ program for genetic fine-mapping that returns association statistics computed on perfect phylogenies. The statistics are calculated for moving windows of DNA markers across a genomic region of interest. The statistics are returned but not the partitions used to construct them. Unfortunately, BLOSSOC is no longer actively maintained (T. Mailund, personal communication) and is challenging to install on up-to-date operating systems.</p>
    <p>Our package perfectphyloR, like BLOSSOC, is intended for use with moving windows of markers along the genome. The window sizes should be large enough to allow relatively fine partitioning of the sample of input sequences. However, requiring all the DNA markers in the window to be compatible with a perfect phylogeny tends to be too restrictive and leads to crude partitions. To avoid this limitation, we have incorporated the heuristics implemented in the partitioning algorithm of BLOSSOC. Since perfectphyloR returns the sequence partitions, users can then leverage any of the statistical and phylogenetic tools available in R to understand them. In addition, as an R package, the software is easier to install and to maintain as operating systems change.</p>
    <p>Throughout, we assume the infinite-sites model and account for diallelic DNA markers only. Since our package reconstructs partitions regardless of whether the variants are common or rare, we refer to markers as single-nucleotide variants (SNVs) instead of single-nucleotide polymorphisms. By SNV, we mean any strictly diallelic marker. Our package is primarily directed to applications at the population level, rather than the interspecies level. Briefly, a neighborhood of SNVs is determined about a focal SNV, as described below. Then, the perfect phylogeny is built by recursive partitioning on SNVs in this neighborhood.</p>
    <p>We first discuss the implementation of the reconstruction of the partitions underlying a sample of DNA sequences. We then illustrate the major functionality of the package with worked examples.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p>In this section, we describe the reconstruction process, which consists of three steps:
<list list-type="order"><list-item><p>Create a hapMat data object.</p></list-item><list-item><p>Reconstruct the perfect phylogeny at a focal SNV.</p></list-item><list-item><p>Reconstruct perfect phylogenies across a genomic region.</p></list-item></list></p>
    <p>We first create an object of (S3) class hapMat containing SNV sequences to be partitioned with the function createHapMat(). To construct a hapMat data object, users are required to specify:
<list list-type="bullet"><list-item><p>hapmat, a matrix of 0’s and 1’s, with rows representing sequences and columns representing SNVs,</p></list-item><list-item><p>snvNames, a vector of names of SNVs labelling the columns of hapmat,</p></list-item><list-item><p>hapNames, a vector of names labelling the sequences in the rows of hapmat,</p></list-item><list-item><p>posns, a numeric vector specifying the physical locations along the chromosome (in base pairs) of SNVs in the columns of hapmat.</p></list-item></list></p>
    <p>In principle, and as noted by a reviewer, the hapMat structure could be extended to accommodate multi-allelic variants, although we do not pursue this here.</p>
    <p>With the main function reconstructPP(), the user can reconstruct the perfect phylogeny at a chosen focal SNV. The result is a phylo object to which the user may apply all the tools from the ape package [<xref ref-type="bibr" rid="CR7">7</xref>] for summarizing the reconstructed partition of sequences.</p>
    <p>The function reconstructPP() consists of three major steps:
<list list-type="order"><list-item><p>Determine a neighborhood of SNVs around a given focal SNV.</p></list-item><list-item><p>Order the SNVs in the neighborhood.</p></list-item><list-item><p>Recursively partition sequences based on SNVs in the neighborhood.</p></list-item></list></p>
    <p>For a given focal SNV, the algorithm finds a neighborhood of SNVs. Starting from the focal SNV, the neighborhood of SNVs that are compatible with the focal SNV is expanded as much as possible on either side of the focal SNV until an incompatible SNV is found. The compatibility of a pair of SNVs is determined by the Four-Gamete Test [<xref ref-type="bibr" rid="CR8">8</xref>]. For example, under the infinite-sites mutation model and no recombination, if the patterns at two SNVs are 00, 01, 10 and 11, then a mutation must have occurred twice at the same SNV and the two SNVs are said to be incompatible. If the neighborhood of compatible SNVs is smaller than a user-defined minimum size, we include incompatible SNVs in order of their physical proximity to the focal SNV, until the minimum size is reached.</p>
    <p>Once the neighborhood of SNVs is determined, we order the compatible SNVs in the neighborhood from the most ancient to the most recent based on the minor allele frequency. We use the minor allele frequency of an SNV as a proxy for its age. Our rationale is that, under the infinite-sites mutation model, the age of SNVs can be inferred from the derived allele frequency. Then, we order incompatible SNVs according to their physical proximity to the focal SNV.</p>
    <p>The algorithm partitions sequences based on the most ancient compatible SNV in the neighborhood, and then recursively moves towards the most recent compatible SNV. When there are no further compatible SNVs in the neighborhood, the algorithm partitions sequences based on the incompatible SNVs, in order of their physical proximity to the focal SNV. Starting with the most ancient compatible SNV in the neighborhood, the algorithm partitions the sequences based on their carrier status for its derived allele. Then the algorithm jumps to the next-oldest compatible SNV in the neighborhood based on allele frequency and continues partitioning. After considering the compatible SNVs, the algorithm moves to any incompatible SNVs in the neighborhood in order of their physical proximity to the focal SNV. This process is repeated until each cluster contains only one sequence or there are no more SNVs to consider in the neighborhood. Thus, the method requires phased data. If a user has unphased data, phasing can be done in advance with software such as fastPHASE [<xref ref-type="bibr" rid="CR9">9</xref>], BEAGLE [<xref ref-type="bibr" rid="CR10">10</xref>], IMPUTE2 [<xref ref-type="bibr" rid="CR11">11</xref>], or MACH [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>].</p>
  </sec>
  <sec id="Sec3">
    <title>Examples</title>
    <p>This section gives worked examples illustrating how to reconstruct the partitions underlying a sample of DNA sequences. In addition, we show how to investigate the association between the reconstructed partitions and a user-specified partition. The association statistics we consider include the Rand index [<xref ref-type="bibr" rid="CR14">14</xref>], the distance correlation (dCor) statistic [<xref ref-type="bibr" rid="CR15">15</xref>], the Heller-Heller-Gorfin (HHG) statistic [<xref ref-type="bibr" rid="CR16">16</xref>], the Mantel statistic [<xref ref-type="bibr" rid="CR17">17</xref>], and the R-Vector (RV) coefficient [<xref ref-type="bibr" rid="CR18">18</xref>]. The Rand index quantifies the association between two partitions directly. The dCor statistic, HHG statistic, Mantel statistic, and RV coefficient quantify the association between two distance matrices derived from partitions.</p>
    <p>We first illustrate how to create a hapMat data object of SNV sequences. We then reconstruct a perfect phylogeny at a focal SNV. Next, we reconstruct perfect phylogenies across a genomic region. Finally, we show how to visualize and test associations between these reconstructed partitions and
<list list-type="bullet"><list-item><p>a comparator partition or dendrogram,</p></list-item><list-item><p>a comparator distance matrix, and</p></list-item><list-item><p>a phenotypic distance matrix.</p></list-item></list></p>
    <p>To illustrate, we consider a toy example with 4 sequences comprised of 4 SNVs at positions 1, 2, 3, and 4 kilo-base pairs (kbp). The required hapMat object is created by executing the following command:</p>
    <p>
      <graphic position="anchor" xlink:href="12859_2019_3313_Figa_HTML" id="MO5"/>
    </p>
    <p>The structure of the resulting object of class hapMat is as follows.</p>
    <p>
      <graphic position="anchor" xlink:href="12859_2019_3313_Figb_HTML" id="MO12"/>
    </p>
    <p>If a user has a variant call format (vcf) file that consists of SNV data with a single alternative allele and no missing values in the genotype field, the hapMat data object can be created by supplying the file path to the vcf file as follows:</p>
    <p>
      <graphic position="anchor" xlink:href="12859_2019_3313_Figc_HTML" id="MO13"/>
    </p>
    <p>Once the hapMat object is created, the user can reconstruct a perfect phylogeny at a focal SNV with reconstructPP(), by specifying the following four arguments:
<list list-type="order"><list-item><p>hapMat: A data structure of class hapMat, created by createHapMat().</p></list-item><list-item><p>focalSNV: The column number of the focal SNV at which to reconstruct the perfect phylogeny.</p></list-item><list-item><p>minWindow: Minimum number of SNVs around the focal SNV in the neighborhood of SNVs used to reconstruct the perfect phylogeny (default is the maximum of one and 2% of the total number of the SNVs).</p></list-item><list-item><p>sep: Character string separator to separate sequence names for sequences that can not be distingiushed in the neighborhood around the focal point. For example, if sequences “h1" and “h3" can not be distinguished and sep = ~-~, then they will be grouped together with the label “h1-h3". The default value is ~-~.</p></list-item></list></p>
    <p>For example, consider the dataset ex_hapMatSmall_data comprised of 10 sequences and 20 SNVs. This dataset is a subset of the larger example dataset, ex_hapMat_data, that comes with the package. The larger dataset has 200 sequences and 2747 SNVs, and was used in a previously published association association analysis [<xref ref-type="bibr" rid="CR19">19</xref>]. We can reconstruct a perfect phylogeny at the first SNV of ex_hapMatSmall_data by executing the following commands:</p>
    <p>
      <graphic position="anchor" xlink:href="12859_2019_3313_Figd_HTML" id="MO16"/>
    </p>
    <p>Figure <xref rid="Fig1" ref-type="fig">1</xref> shows the reconstructed dendrogram, rdend, at the first SNV of ex_hapMatSmall_data. The structure of rdend is as follows:
<fig id="Fig1"><label>Fig. 1</label><caption><p>The reconstructed partition at the first SNV of ex_hapMatSmall_data</p></caption><graphic xlink:href="12859_2019_3313_Fig1_HTML" id="MO1"/></fig></p>
    <p>
      <graphic position="anchor" xlink:href="12859_2019_3313_Fige_HTML" id="MO6"/>
    </p>
    <p>The user can extract the positions of the lower and upper limits of the neighborhood of SNVs used to reconstruct rdend as follows:</p>
    <p>
      <graphic position="anchor" xlink:href="12859_2019_3313_Figf_HTML" id="MO7"/>
    </p>
    <p>To see the sequences in the neighborhood of SNVs used for the reconstruction, the user can execute the following command:</p>
    <p>
      <graphic position="anchor" xlink:href="12859_2019_3313_Figg_HTML" id="MO8"/>
    </p>
    <p>As can be seen in the above output, there are two groups of sequences that have the same ancestral and derived alleles at each SNV position: sequences 354, 1009 and 2818, and sequences 1904, 454, 2931, 2994 and 370. These two groups of sequences therefore cannot be distinguished in the reconstructed partition. In Fig. <xref rid="Fig1" ref-type="fig">1</xref>, we can verify that two tips of the partition are comprised of these two groups of sequences.</p>
    <p>With reconstructPPregion(), the user can reconstruct perfect phylogenies at each possible focal SNV in a hapMat data object. In the following example, we consider the 10 sequences with 20 SNVs in ex_hapMatSmall_data. We reconstruct perfect phylogenies across the 20 SNVs.</p>
    <p>
      <graphic position="anchor" xlink:href="12859_2019_3313_Figh_HTML" id="MO9"/>
    </p>
    <p>rdends is an ape multiphylo object. The reconstructed partition at the first focal SNV in ex_hapMatSmall_data is the first phylo object in rdends:</p>
    <p>
      <graphic position="anchor" xlink:href="12859_2019_3313_Figi_HTML" id="MO10"/>
    </p>
    <p>If a user wants to reconstruct perfect phylogenies within a user-provided subregion of a hapMat object, they may specify the lower and upper values of the subregion in base pairs as follows:</p>
    <p>
      <graphic position="anchor" xlink:href="12859_2019_3313_Figj_HTML" id="MO11"/>
    </p>
    <p>The function testDendAssoRI() uses the Rand Index to investigate the association between a comparator dendrogram or partition and multiple reconstructed dendrograms or partitions across a genomic region. Detailed descriptions of the function arguments and output of testDendAssoRI() are provided in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>, along with a worked example.</p>
    <p>Figure <xref rid="Fig2" ref-type="fig">2</xref> shows the association profile between a comparator true dendrogram, tdend, at position 975 kbp, and a list of reconstructed dendrograms across the genomic region of ex_hapMat_data. In the two panels of the figure, the Rand indices are based on six and 24 clusters. Since we use simulated data, we know the true dendrogram at position 975 kbp. In Fig. <xref rid="Fig2" ref-type="fig">2</xref>, using the Rand index, we investigate how the true dendrogram at position 975 kbp associates with the reconstructed dendrograms across the genomic region. As can be seen, the highest point for six clusters lies at position 975 kbp, and for 24 clusters is very close to position 975 kbp. According to the omnibus <italic>p</italic>-value, returned by testDendAssoRI(), the association across the genomic region is significant (<italic>P</italic>≈0.001) for both six and 24 clusters.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Rand indices associating a comparator true dendrogram at position 975 kbp and reconstructed dendrograms across the genomic region. <bold>a</bold> Based on the six clusters. <bold>b</bold> Based on 24 clusters. Red vertical dashed lines represent the position of the comparator dendrogram at 975 kbp</p></caption><graphic xlink:href="12859_2019_3313_Fig2_HTML" id="MO2"/></fig></p>
    <p>The function testAssoDist() investigates the association between a comparator distance matrix and multiple reconstructed dendrograms across a genomic region. The association statistics available in the function are the dCor statistic, HHG statistic, Mantel statistic, and RV coefficient. The function has the following five key arguments:
<list list-type="order"><list-item><p>rdend: An ape multiphylo object of reconstructed dendrograms at each focal SNV.</p></list-item><list-item><p>cdmat: A comparator matrix of pairwise distances (e.g. pairwise distances between sequences of a comparator dendrogram).</p></list-item><list-item><p>method: A character string specifying one of ~dCor~, ~HHG~, ~Mantel~ or ~RV~ for the dCor, HHG, Mantel or RV statistics, respectively.</p></list-item><list-item><p>hapMat: An object of class hapMat containing SNV sequences.</p></list-item><list-item><p>nperm: Number of permutations for the omnibus test of any association across the genomic region. The default is nperm = 0; i.e., association will not be tested.</p></list-item></list></p>
    <p>To illustrate, we plot the dCor statistics summarizing the association between a comparator distance matrix, cdmat, and the reconstructed dendrograms across the genomic region of the example dataset ex_hapMat_data.</p>
    <p>First, we compute the pairwise distances between sequences based on the comparator true dendrogram at SNV position 975 kbp. These pairwise distances are computed with the function rdistMatrix(), available in the package. The rdistMatrix() function uses the rankings of the nested partitions in the dendrogram to calculate rank-based distances between the sequences. However, users can provide any distance measures of interest for cdmat. We then plot the dCor statistic summarizing the association between the rank-based distance matrix for the reconstructed dendrograms at each SNV position and the comparator distance matrix at SNV position 975 kbp (Fig. <xref rid="Fig3" ref-type="fig">3</xref>).
<fig id="Fig3"><label>Fig. 3</label><caption><p>Associations between a comparator distance matrix from the true dendrogram at position 975 kbp and the reconstructed dendrograms across the genomic region. Red vertical dashed line represents the position of the comparator dendrogram at 975 kbp</p></caption><graphic xlink:href="12859_2019_3313_Fig3_HTML" id="MO3"/></fig></p>
    <p>
      <graphic position="anchor" xlink:href="12859_2019_3313_Figk_HTML" id="MO14"/>
    </p>
    <p>In Fig. <xref rid="Fig3" ref-type="fig">3</xref>, we can clearly see the strongest association around the SNV position 975 kbp, and the association across the genomic region is significant (<italic>P</italic>≈0.001), as expected. The association signal is much clearer than for the Rand index plotted in Fig. <xref rid="Fig2" ref-type="fig">2</xref> because dCor uses the full information from the pairwise distance matrices whereas the Rand index is based on a discrete number of clusters.</p>
    <p>To illustrate another application of the function testAssoDist(), we perform the RV test of association between a phenotypic distance matrix as the cdmat argument and the reconstructed dendrograms across the genomic region of ex_hapMat_data. The phenotype data and distances are described in [<xref ref-type="bibr" rid="CR19">19</xref>] and are contained in the data object phenoDist. Binary phenotype status was assigned based on causal SNVs from a causal subregion defined from 950 - 1050 kbp within the 2-Mbp genomic region.</p>
    <p>
      <graphic position="anchor" xlink:href="12859_2019_3313_Figl_HTML" id="MO15"/>
    </p>
    <p>Figure <xref rid="Fig4" ref-type="fig">4</xref> shows the resulting association profile between the phenotypic distances and the reconstructed dendrograms across the genomic region in ex_hapMat_data. The vertical lines indicate the causal subregion of 950 - 1050 kbp. The strongest association is close to the causal subregion. However, in this example, the association across the genomic region is not significant (<italic>P</italic>≈0.1).
<fig id="Fig4"><label>Fig. 4</label><caption><p>Associations between the phenotypic distance matrix and the reconstructed dendrograms across the genomic region. Black vertical lines indicate the limits of the genomic region containing trait-influencing SNVs</p></caption><graphic xlink:href="12859_2019_3313_Fig4_HTML" id="MO4"/></fig></p>
  </sec>
  <sec id="Sec4">
    <title>Timing</title>
    <p>Table <xref rid="Tab1" ref-type="table">1</xref> shows the computation times of the package’s major functions. These computation times are for the 200 sequences comprised of 2747 SNVs in the example data ex_hapMat_data that is included in the package. Table <xref rid="Tab2" ref-type="table">2</xref> compares computation times of the function reconstructPPregion() for different numbers of sequences and numbers of SNVs. These times scale approximately linearly in the number of SNVs and quadratically in the number of sequences. Computation times are measured on an Intel E5-2683 v4 at 2.1 GHz with 20 GB of RAM.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Computation times of the major functions of the package perfectphyloR for 200 sequences comprised of 2747 SNVs</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Function</th><th align="left" colspan="2">Computation Time (minutes)</th></tr><tr><th align="left"/><th align="left">No permutation</th><th align="left">1000 permutations</th></tr></thead><tbody><tr><td align="left">reconstructPP()</td><td align="left">Few seconds</td><td align="left">NA</td></tr><tr><td align="left">reconstructPPregion()</td><td align="left">12.00</td><td align="left">NA</td></tr><tr><td align="left">testDendAssoRI()</td><td align="left">1.12</td><td align="left">70.00</td></tr><tr><td align="left">testAssoDist()</td><td align="left">0.28</td><td align="left">193.71</td></tr></tbody></table></table-wrap>
<table-wrap id="Tab2"><label>Table 2</label><caption><p>reconstructPPregion() timing results (in minutes) for different number of sequences and SNVs</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left" colspan="4">Number of sequences</th></tr></thead><tbody><tr><td align="left">Number of SNVs</td><td align="left">200</td><td align="left">300</td><td align="left">400</td><td align="left">500</td></tr><tr><td align="left">3000</td><td align="left">17.66</td><td align="left">21.47</td><td align="left">26.07</td><td align="left">26.38</td></tr><tr><td align="left">4000</td><td align="left">23.38</td><td align="left">28.26</td><td align="left">33.41</td><td align="left">33.80</td></tr><tr><td align="left">5000</td><td align="left">29.99</td><td align="left">34.82</td><td align="left">41.40</td><td align="left">41.87</td></tr><tr><td align="left">6000</td><td align="left">36.58</td><td align="left">43.41</td><td align="left">49.86</td><td align="left">50.67</td></tr><tr><td align="left">7000</td><td align="left">43.17</td><td align="left">51.68</td><td align="left">58.72</td><td align="left">59.42</td></tr><tr><td align="left">8000</td><td align="left">49.25</td><td align="left">59.11</td><td align="left">67.89</td><td align="left">68.65</td></tr><tr><td align="left">9000</td><td align="left">55.63</td><td align="left">66.75</td><td align="left">77.00</td><td align="left">77.92</td></tr><tr><td align="left">10000</td><td align="left">61.56</td><td align="left">75.53</td><td align="left">86.11</td><td align="left">86.99</td></tr></tbody></table></table-wrap></p>
  </sec>
  <sec id="Sec5" sec-type="discussion">
    <title>Discussion</title>
    <p>We note that the computation time of reconstructP-Pregion() can vary a lot based on the size of the hapMat object (Table <xref rid="Tab2" ref-type="table">2</xref>). Starting from the first SNV of the hapMat object, this function continues the reconstruction process until the last SNV. At each focal SNV, the function starts from ground level to construct a surrounding window of SNVs and rebuilds the partition, without utilizing the information from previously constructed partitions at nearby SNVs. As a result, many of the same computations may be done several times for similar focal SNVs. As noted by a reviewer, there may be ways to make reconstructPPregion() faster. For example, clustering similar successive SNVs before starting the reconstruction could lead to computational efficiencies and would be an avenue for future work.</p>
    <p>Although we know of no software that is directly comparable to perfectphyloR, the PerfectPhy suite of tools is also set up to return sequence partitions. We therefore explored the use of PerfectPhy in a moving-window approach similar to that of perfectphyloR. Briefly, for each placement of the moving window, the following two steps were repeated: (i) filter out incompatible SNVs in the window and (ii) reconstruct the perfect phylogeny using the remaining compatible SNVs. We applied this approach to the 200 sequences in the example dataset, ex_hapMat_data, using the default minimum-window size of 55 for 2747 SNVs. For the first few window placements, we compared the computational time of steps (i) and (ii) in the PerfectPhy-based approach to that of reconstructPP() in perfectphyloR. For the PerfectPhy approach, the filtering step is the bottleneck, with computation times in excess of 600 minutes. By contrast, reconstructPP() took no more than 0.18 seconds.</p>
  </sec>
  <sec id="Sec6" sec-type="conclusion">
    <title>Conclusion</title>
    <p>The R package perfectphyloR provides functions to reconstruct a perfect phylogeny at a user-given focal SNV and perfect phylogenies across a genomic region of interest. The package also computes, tests and displays association measures based on the reconstructed partitions in a genomic region. The reconstructed partitions are useful to researchers seeking insight into the ancestral structure of DNA sequences. For example, associating the reconstructed partitions with a trait can help to localise trait-influencing variants in association studies. perfectphyloR can be freely downloaded from the Comprehensive R Archive Network (CRAN) or from <ext-link ext-link-type="uri" xlink:href="https://github.com/cbhagya/perfectphyloR/">https://github.com/cbhagya/perfectphyloR/</ext-link>.</p>
  </sec>
  <sec id="Sec7">
    <title>Availability and requirements</title>
    <p><bold>Project name</bold>: perfectphyloR <bold>Project home page</bold>: https://CRAN.R-project.org/package =perfectphyloR <bold>Operating system(s)</bold>: Windows, Linux, OS X <bold>Programming language</bold>: R <bold>Other requirements</bold>: R 3.4.0 or newer <bold>License</bold>: GPL-2, GPL-3 <bold>Any restrictions to use by non-academics</bold>: none</p>
    <p>The package perfectphyloR can be installed from CRAN using install.packages(~perfectphyloR~). The local zip file can be installed using R Studio by selecting the install package(s) from local zip files.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec8">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2019_3313_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold> testDendAssoRI(): Arguments and example call</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>DNA</term>
        <def>
          <p>deoxyribonucleic acid</p>
        </def>
      </def-item>
      <def-item>
        <term>BLOSSOC</term>
        <def>
          <p>BLOck aSSOCiation</p>
        </def>
      </def-item>
      <def-item>
        <term>SNV</term>
        <def>
          <p>Single Nucleotide Variant</p>
        </def>
      </def-item>
      <def-item>
        <term>dCor</term>
        <def>
          <p>Distance Correlation</p>
        </def>
      </def-item>
      <def-item>
        <term>RI</term>
        <def>
          <p>Rand Index</p>
        </def>
      </def-item>
      <def-item>
        <term>HHG</term>
        <def>
          <p>Heller-Heller-Gorfin</p>
        </def>
      </def-item>
      <def-item>
        <term>RV</term>
        <def>
          <p>R-Vector, a vector version of standard <italic>r</italic> correlation</p>
        </def>
      </def-item>
      <def-item>
        <term>GHz</term>
        <def>
          <p>Giga Hertz</p>
        </def>
      </def-item>
      <def-item>
        <term>GB</term>
        <def>
          <p>Gigabyte</p>
        </def>
      </def-item>
      <def-item>
        <term>RAM</term>
        <def>
          <p>Random Access Memory</p>
        </def>
      </def-item>
      <def-item>
        <term>CRAN</term>
        <def>
          <p>Comprehensive R Archive Network</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12859-019-3313-4.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank the anonymous reviewers for constructive comments that improved and clarified the manuscript. We also thank Christina Nieuwoudt and Kelly Burkett for helpful discussions and comments, and the Department of Statistics and Actuarial Science at Simon Fraser University for its generous support.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>CBK and JG conceived of and prototyped the software. CBK created the R package; developed, tested and documented its functions; and analyzed the data. CBK and JG drafted and revised the manuscript. Both authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This research was funded in part by a Discovery Grant from the Natural Sciences and Engineering Research Council of Canada.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>All the data supporting the results reported in the manuscript are included in the R package perfectphyloR, available on the Comprehensive R Archive Network, or can be found via <ext-link ext-link-type="uri" xlink:href="https://github.com/cbhagya/perfectphyloR/tree/master/data">https://github.com/cbhagya/perfectphyloR/tree/master/data</ext-link></p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p>Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p>Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gusfield</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Efficient algorithms for inferring evolutionary trees</article-title>
        <source>Networks</source>
        <year>1991</year>
        <volume>21</volume>
        <issue>1</issue>
        <fpage>19</fpage>
        <lpage>28</lpage>
        <pub-id pub-id-type="doi">10.1002/net.3230210104</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mailund</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Besenbacher</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schierup</surname>
            <given-names>MH</given-names>
          </name>
        </person-group>
        <article-title>Whole genome association mapping by incompatibilities and local perfect phylogenies</article-title>
        <source>BMC Bioinformatics</source>
        <year>2006</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>454</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-7-454</pub-id>
        <pub-id pub-id-type="pmid">17042942</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bardel</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Danjean</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Hugot</surname>
            <given-names>J-P</given-names>
          </name>
          <name>
            <surname>Darlu</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Génin</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>On the use of haplotype phylogeny to detect disease susceptibility loci</article-title>
        <source>BMC Genet</source>
        <year>2005</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>24</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2156-6-24</pub-id>
        <pub-id pub-id-type="pmid">15904492</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <mixed-citation publication-type="other">Coulombe M, Stevens K, Gusfield D. Construction, enumeration, and optimization of perfect phylogenies on multi-state data. In: 2015 IEEE 5th International Conference on Computational Advances in Bio and Medical Sciences (ICCABS). IEEE: 2015. 10.1109/iccabs.2015.7344709.</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <mixed-citation publication-type="other">Agarwala R, Fernández-Baca D. A polynomial-time algorithm for the perfect phylogeny problem when the number of character states is fixed. In: Proceedings of 1993 IEEE 34th Annual Foundations of Computer Science. IEEE: 1993. 10.1109/sfcs.1993.366873.</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Kannan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>A fast algorithm for the computation and enumeration of perfect phylogenies when the number of character states is fixed</article-title>
        <source>Proceedings of the sixth annual ACM-SIAM symposium on Discrete algorithms. SODA ’95</source>
        <year>1995</year>
        <publisher-loc>Philadelphia</publisher-loc>
        <publisher-name>Society for Industrial and Applied Mathematics</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paradis</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Claude</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Strimmer</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>APE: Analyses of Phylogenetics and Evolution in R language</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <issue>2</issue>
        <fpage>289</fpage>
        <lpage>90</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btg412</pub-id>
        <pub-id pub-id-type="pmid">14734327</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hudson</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Kaplan</surname>
            <given-names>NL</given-names>
          </name>
        </person-group>
        <article-title>Statistical properties of the number of recombination events in the history of a sample of DNA sequences</article-title>
        <source>Genetics</source>
        <year>1985</year>
        <volume>111</volume>
        <fpage>147</fpage>
        <lpage>64</lpage>
        <?supplied-pmid 4029609?>
        <pub-id pub-id-type="pmid">4029609</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scheet</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A fast and flexible statistical model for large-scale population genotype data: applications to inferring missing genotypes and haplotypic phase</article-title>
        <source>Am J Hum Genet</source>
        <year>2006</year>
        <volume>78</volume>
        <issue>4</issue>
        <fpage>629</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1086/502802</pub-id>
        <pub-id pub-id-type="pmid">16532393</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Browning</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Browning</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>A fast, powerful method for detecting identity by descent</article-title>
        <source>The American Journal of Human Genetics</source>
        <year>2011</year>
        <volume>88</volume>
        <issue>2</issue>
        <fpage>173</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2011.01.010</pub-id>
        <pub-id pub-id-type="pmid">21310274</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Howie</surname>
            <given-names>BN</given-names>
          </name>
          <name>
            <surname>Donnelly</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Marchini</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A flexible and accurate genotype imputation method for the next generation of genome-wide association studies</article-title>
        <source>PLoS Genet</source>
        <year>2009</year>
        <volume>5</volume>
        <issue>6</issue>
        <fpage>1000529</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1000529</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Willer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sanna</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Genotype imputation</article-title>
        <source>Ann Rev Genomics Hum Genet</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>387</fpage>
        <lpage>406</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev.genom.9.081307.164242</pub-id>
        <pub-id pub-id-type="pmid">19715440</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Willer</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Ding</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Scheet</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>GR</given-names>
          </name>
        </person-group>
        <article-title>Mach: using sequence and genotype data to estimate haplotypes and unobserved genotypes</article-title>
        <source>Genet Epidemiol</source>
        <year>2010</year>
        <volume>34</volume>
        <issue>8</issue>
        <fpage>816</fpage>
        <lpage>34</lpage>
        <pub-id pub-id-type="doi">10.1002/gepi.20533</pub-id>
        <pub-id pub-id-type="pmid">21058334</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rand</surname>
            <given-names>WM</given-names>
          </name>
        </person-group>
        <article-title>Objective criteria for the evaluation of clustering methods</article-title>
        <source>J Am Stat Assoc</source>
        <year>1971</year>
        <volume>66</volume>
        <issue>336</issue>
        <fpage>846</fpage>
        <lpage>50</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1971.10482356</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Székely</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Rizzo</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Bakirov</surname>
            <given-names>NK</given-names>
          </name>
        </person-group>
        <article-title>Measuring and testing dependence by correlation of distances</article-title>
        <source>Ann Stat</source>
        <year>2007</year>
        <volume>35</volume>
        <issue>6</issue>
        <fpage>2769</fpage>
        <lpage>94</lpage>
        <pub-id pub-id-type="doi">10.1214/009053607000000505</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heller</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Heller</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Gorfine</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A consistent multivariate test of association based on ranks of distances</article-title>
        <source>Biometrika</source>
        <year>2012</year>
        <volume>100</volume>
        <issue>2</issue>
        <fpage>503</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1093/biomet/ass070</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mantel</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>The detection of disease clustering and a generalized regression approach</article-title>
        <source>Cancer Res</source>
        <year>1967</year>
        <volume>27</volume>
        <issue>2 Part 1</issue>
        <fpage>209</fpage>
        <lpage>20</lpage>
        <?supplied-pmid 6018555?>
        <pub-id pub-id-type="pmid">6018555</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Escoufier</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Le traitement des variables vectorielles</article-title>
        <source>Biometrics</source>
        <year>1973</year>
        <volume>29</volume>
        <fpage>751</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.2307/2529140</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karunarathna</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Graham</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Using gene genealogies to localize rare variants associated with complex traits in diploid populations</article-title>
        <source>Hum Hered</source>
        <year>2018</year>
        <volume>83</volume>
        <issue>1</issue>
        <fpage>30</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1159/000486854</pub-id>
        <pub-id pub-id-type="pmid">29763929</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
