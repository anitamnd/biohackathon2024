<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1460-2059</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2712344</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btp348</article-id>
    <article-id pub-id-type="publisher-id">btp348</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group>
          <subject>Phylogenetics</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>trimAl: a tool for automated alignment trimming in large-scale phylogenetic analyses</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Capella-Gutiérrez</surname>
          <given-names>Salvador</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Silla-Martínez</surname>
          <given-names>José M.</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gabaldón</surname>
          <given-names>Toni</given-names>
        </name>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1">Comparative Genomics group, Bioinformatics and Genomics Programme, Centre for Genomic Regulation (CRG), Dr. Aiguader, 88 08003 Barcelona, Spain</aff>
    <author-notes>
      <corresp id="COR1">* To whom correspondence should be addressed.</corresp>
      <fn>
        <p>Associate Editor: Martin Bishop</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>1</day>
      <month>8</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>6</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>6</month>
      <year>2009</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>25</volume>
    <issue>15</issue>
    <fpage>1972</fpage>
    <lpage>1973</lpage>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>5</month>
        <year>2008</year>
      </date>
      <date date-type="rev-recd">
        <day>20</day>
        <month>5</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>1</day>
        <month>6</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2009 The Author(s)</copyright-statement>
      <copyright-year>2009</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> Multiple sequence alignments are central to many areas of bioinformatics. It has been shown that the removal of poorly aligned regions from an alignment increases the quality of subsequent analyses. Such an alignment trimming phase is complicated in large-scale phylogenetic analyses that deal with thousands of alignments. Here, we present trimAl, a tool for automated alignment trimming, which is especially suited for large-scale phylogenetic analyses. trimAl can consider several parameters, alone or in multiple combinations, for selecting the most reliable positions in the alignment. These include the proportion of sequences with a gap, the level of amino acid similarity and, if several alignments for the same set of sequences are provided, the level of consistency across different alignments. Moreover, trimAl can automatically select the parameters to be used in each specific alignment so that the signal-to-noise ratio is optimized.</p>
      <p><bold>Availability:</bold> trimAl has been written in C++, it is portable to all platforms. trimAl is freely available for download (<ext-link ext-link-type="uri" xlink:href="http://trimal.cgenomics.org">http://trimal.cgenomics.org</ext-link>) and can be used online through the Phylemon web server (<ext-link ext-link-type="uri" xlink:href="http://phylemon2.bioinfo.cipf.es/">http://phylemon2.bioinfo.cipf.es/</ext-link>). Supplementary Material is available at <ext-link ext-link-type="uri" xlink:href="http://trimal.cgenomics.org/publications">http://trimal.cgenomics.org/publications</ext-link>.</p>
      <p>
        <bold>Contact:</bold>
        <email>tgabaldon@crg.es</email>
      </p>
    </abstract>
  </article-meta>
</front>
<body>
  <p>Multiple sequence alignments (MSA) are central to many areas of bioinformatics, including phylogenetics, homology modeling, database searches and motif finding. Recently, such MSA-based techniques have been incorporated in high-throughput pipelines such as genome annotation and phylogenomics analyses. In all these applications, the reliability and accuracy of the analyses depend critically on the quality of the underlying alignments. A plethora of computer programs and algorithms for MSA are currently available (Notredame, <xref ref-type="bibr" rid="B4">2007</xref>), which implement different heuristics to find mathematically optimal solutions to the MSA problem. Accuracies of 80–90% have been reported for the best algorithms, but even the best scoring alignment algorithms may fail with certain protein families or at specific regions in the alignment. The situation worsens in large-scale analyses, where faster but less reliable algorithms and large numbers of automatically selected sequences are used. It is therefore generally assumed that trimming the alignment, so that poorly aligned regions are eliminated, increases the accuracy of the resulting MSA-based applications (Talavera and Castresana, <xref ref-type="bibr" rid="B7">2007</xref>). Some programs such as G-blocks (Castresana, <xref ref-type="bibr" rid="B1">2000</xref>) have been developed to assist in the MSA trimming phase by selecting blocks of conserved regions. They have become very popular and are extensively used, with good performance, in small-to-medium scale datasets, where several parameters can be tested manually (Talavera and Castresana, <xref ref-type="bibr" rid="B7">2007</xref>). However, their use over larger datasets is hampered by the need for defining, prior to the analysis, the set of parameters that will be used for all sequence families. Here, we present trimAl, a tool for automated alignment trimming. Its speed and the possibility for automatically adjusting the parameters to improve the phylogenetic signal-to-noise ratio, makes trimAl especially suited for large-scale phylogenomic analyses, involving thousands of large alignments.</p>
  <p>trimAl has been developed in a GNU/Linux environment using C++ programming language and has been tested on various UNIX, Mac and Windows platforms. Moreover, we have developed a web server to run trimAl online (<ext-link ext-link-type="uri" xlink:href="http://phylemon2.bioinfo.cipf.es/">http://phylemon2.bioinfo.cipf.es/</ext-link>), which has been included in the Phylemon suite for phylogenetic and phylogenomic tools (Tarraga <italic>et al.</italic>, <xref ref-type="bibr" rid="B8">2007</xref>). The documentation, source files and additional information for trimAl are available through a wiki page (<ext-link ext-link-type="uri" xlink:href="http://trimal.cgenomics.org">http://trimal.cgenomics.org</ext-link>).</p>
  <p>trimAl reads and renders protein or nucleotide alignments in several standard formats. trimAl starts by reading all columns in an alignment and computes a score (<italic>S</italic><sub><italic>x</italic></sub>) for each of them. This score can be a gap score (<italic>S</italic><sub><italic>g</italic></sub>), a similarity score (<italic>S</italic><sub><italic>s</italic></sub>) or a consistency score (<italic>S</italic><sub><italic>c</italic></sub>). The score for each column can be computed based only on the information from that column or, if a window size of <italic>w</italic> is specified, it corresponds to the average value of <italic>w</italic> columns around the position considered.</p>
  <p>The gap score (<italic>S</italic><sub><italic>g</italic></sub>) for a column is the fraction of sequences without a gap in that position. The residue similarity score (<italic>S</italic><sub><italic>s</italic></sub>) consists of mean distance (MD) scores as described in Thompson <italic>et al.</italic> (<xref ref-type="bibr" rid="B9">2001</xref>) and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp348/DC1">Supplementary Material</ext-link>. This score uses the MD between pairs of residues, as defined by a given scoring matrix. Finally, the consistency score (<italic>S</italic><sub><italic>c</italic></sub>) can only be computed when more than one alignment for the same set of sequences is provided. Details on how these scores are computed are provided in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp348/DC1">Supplementary Material</ext-link>. In brief, <italic>S</italic><sub><italic>c</italic></sub> measures the level of consistency of all the residue pairs found in a column as compared with the other alignments. The alignment with the highest consistency is chosen and then trimmed to remove the columns that are less conserved, according to <italic>S</italic><sub><italic>c</italic></sub> or other thresholds set by the user.</p>
  <p>Once all column scores have been computed trimAl can proceed in two ways. If both a score and a minimum conservation threshold are provided, trimAl renders a trimmed alignment in which only the columns with scores above the <italic>score threshold</italic> are included, as far as the number of selected columns is above a <italic>conservation threshold</italic> defined by the user. If this number is below the <italic>conservation threshold</italic>, trimAl will add more columns to the trimmed alignment in a decreasing order of scores until the <italic>conservation threshold</italic> is reached. The <italic>conservation threshold</italic> corresponds to the minimum percentage of columns, from the original alignment, which the user wants to include in the trimmed alignment.</p>
  <p>Alternatively, if the automatic selection of parameters options is selected, trimAl will compute specific score thresholds depending on the inherent characteristics of each alignment. So far, trimAl incorporates three modes for the automated selection of parameters, <italic>gappyout</italic>, <italic>strict</italic> and <italic>strictplus</italic>, which are based on the different use of gap and similarity scores. Moreover, the option <italic>automated1</italic> implements a heuristic to decide the most appropriate mode depending on the alignment characteristics. The heuristics to define such parameters have been designed based on the results of a benchmark. Details on the heuristics and the benchmark can be found in the online documentation of the program. In brief, the automatic selection of parameters approximate optimal cutoffs by plotting, internally, the cumulative graphs of gap and similarity scores of the columns in the alignment (see online documentation).</p>
  <p>We expanded, using ROSE simulations (Stoye <italic>et al.</italic>, <xref ref-type="bibr" rid="B6">1998</xref>) a benchmark set that has been used previously to test the improvement in phylogenetic performance after an alignment trimming phase (Talavera and Castresana, <xref ref-type="bibr" rid="B7">2007</xref>). This dataset simulates several evolutionary scenarios varying in the number and length of the sequences, the topology of the underlying tree and the level of sequence divergence considered. We compared the results obtained from MUSCLE alignments before and after trimming with trimAl using automated selection of parameters. The accuracy of the resulting trees was measured by comparing them with the original trees used to generate the sequence sets, and measuring the Robinson Foulds distance (Robinson and Foulds, <xref ref-type="bibr" rid="B5">1981</xref>). We observed an overall improvement of the phylogenetic accuracy after trimming. Using <italic>-automated1</italic> option of trimAl, the trimmed alignment always produced Maximum Likelihood trees that were of equal (36%) or significantly better (64%) quality as compared with the tree derived from the complete alignment. For Neighbor Joining reconstruction the <italic>-strictplus</italic> option of trimAl worked best, improving the phylogenetic accuracy in 89% of the scenarios. In most scenarios (90%), trimAl outperformed Gblocks v0.91b with default parameters. Most importantly, the use of Gblocks default parameters diminished the accuracy of the subsequent tree reconstruction in half of the scenarios considered. In contrast, the use of trimAl automated methods rarely (1.5%) undermined the topological accuracy of the resulting phylogenetic tree (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp348/DC1">Supplementary Material</ext-link> for more details).</p>
  <p>To test the applicability of trimAl on real datasets as well as its suitability for large-scale phylogenetic datasets, we ran trimAl on the complete set of MUSCLE alignments generated for the Human Phylome project (Huerta-Cepas <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2007</xref>). This includes a total of 31 182 alignments, containing, on average, 67 sequences of 1472 positions of length. Trimming these alignments using the <italic>-gappyout</italic> and <italic>automated1</italic> options used 5 min 45 s and 125 min, 2 s, respectively, on a computer with an Intel QuadCore XEON E5410 processors and 8 GB of RAM.</p>
  <p>trimAl has been used previously in a pipeline to reconstruct complete collections of gene trees. In this case, the parameter sets used were a minimum conservation threshold of 60% and a gap threshold of 90% (-cons 60 -gt 0.9). Complete and trimmed alignments used to generate the phylomes included in PhylomeDB (Huerta-Cepas <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2008</xref>) can be viewed through this database.</p>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We acknowledge Juan M. Garcia-Gomez and members of the Gabaldón group for fruitful discussions and suggestions. The authors also thank Jordi Burguet-Castell, Pablo Escobar and Joaquín Tàrraga for their technical assistance and José Castresana for providing the data necessary for the benchmark.</p>
    <p><italic>Funding</italic>: FIS (06-213 to T.G.) and MEC (GEN2006-27784-E/PAT to T.G.).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Castresana</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Selection of conserved blocks from multiple alignments for their use in phylogenetic analysis</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>2000</year>
        <volume>17</volume>
        <fpage>540</fpage>
        <lpage>552</lpage>
        <pub-id pub-id-type="pmid">10742046</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huerta-Cepas</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The human phylome</article-title>
        <source>Genome Biol.</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>R109</fpage>
        <pub-id pub-id-type="pmid">17567924</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huerta-Cepas</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PhylomeDB: a database for genome-wide collections of gene phylogenies</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>D491</fpage>
        <lpage>D496</lpage>
        <pub-id pub-id-type="pmid">17962297</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Notredame</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Recent evolutions of multiple sequence alignment algorithms</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2007</year>
        <volume>3</volume>
        <fpage>e123</fpage>
        <pub-id pub-id-type="pmid">17784778</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Foulds</surname>
            <given-names>LR</given-names>
          </name>
        </person-group>
        <article-title>Comparison of phylogenetic trees</article-title>
        <source>Math. Biosci.</source>
        <year>1981</year>
        <volume>53</volume>
        <fpage>131</fpage>
        <lpage>147</lpage>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stoye</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rose: generating sequence families</article-title>
        <source>Bioinformatics</source>
        <year>1998</year>
        <volume>14</volume>
        <fpage>157</fpage>
        <lpage>163</lpage>
        <pub-id pub-id-type="pmid">9545448</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Talavera</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Castresana</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Improvement of phylogenies after removing divergent and ambiguously aligned blocks from protein sequence alignments</article-title>
        <source>Syst. Biol.</source>
        <year>2007</year>
        <volume>56</volume>
        <fpage>564</fpage>
        <lpage>577</lpage>
        <pub-id pub-id-type="pmid">17654362</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tarraga</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phylemon: a suite of web tools for molecular evolution, phylogenetics and phylogenomics</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2007</year>
        <volume>35</volume>
        <fpage>W38</fpage>
        <lpage>W42</lpage>
        <pub-id pub-id-type="pmid">17452346</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thompson</surname>
            <given-names>JD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Towards a reliable objective function for multiple sequence alignments</article-title>
        <source>J. Mol. Biol.</source>
        <year>2001</year>
        <volume>314</volume>
        <fpage>937</fpage>
        <lpage>951</lpage>
        <pub-id pub-id-type="pmid">11734009</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1460-2059</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2712344</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btp348</article-id>
    <article-id pub-id-type="publisher-id">btp348</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group>
          <subject>Phylogenetics</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>trimAl: a tool for automated alignment trimming in large-scale phylogenetic analyses</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Capella-Gutiérrez</surname>
          <given-names>Salvador</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Silla-Martínez</surname>
          <given-names>José M.</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gabaldón</surname>
          <given-names>Toni</given-names>
        </name>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1">Comparative Genomics group, Bioinformatics and Genomics Programme, Centre for Genomic Regulation (CRG), Dr. Aiguader, 88 08003 Barcelona, Spain</aff>
    <author-notes>
      <corresp id="COR1">* To whom correspondence should be addressed.</corresp>
      <fn>
        <p>Associate Editor: Martin Bishop</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>1</day>
      <month>8</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>6</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>6</month>
      <year>2009</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>25</volume>
    <issue>15</issue>
    <fpage>1972</fpage>
    <lpage>1973</lpage>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>5</month>
        <year>2008</year>
      </date>
      <date date-type="rev-recd">
        <day>20</day>
        <month>5</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>1</day>
        <month>6</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2009 The Author(s)</copyright-statement>
      <copyright-year>2009</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> Multiple sequence alignments are central to many areas of bioinformatics. It has been shown that the removal of poorly aligned regions from an alignment increases the quality of subsequent analyses. Such an alignment trimming phase is complicated in large-scale phylogenetic analyses that deal with thousands of alignments. Here, we present trimAl, a tool for automated alignment trimming, which is especially suited for large-scale phylogenetic analyses. trimAl can consider several parameters, alone or in multiple combinations, for selecting the most reliable positions in the alignment. These include the proportion of sequences with a gap, the level of amino acid similarity and, if several alignments for the same set of sequences are provided, the level of consistency across different alignments. Moreover, trimAl can automatically select the parameters to be used in each specific alignment so that the signal-to-noise ratio is optimized.</p>
      <p><bold>Availability:</bold> trimAl has been written in C++, it is portable to all platforms. trimAl is freely available for download (<ext-link ext-link-type="uri" xlink:href="http://trimal.cgenomics.org">http://trimal.cgenomics.org</ext-link>) and can be used online through the Phylemon web server (<ext-link ext-link-type="uri" xlink:href="http://phylemon2.bioinfo.cipf.es/">http://phylemon2.bioinfo.cipf.es/</ext-link>). Supplementary Material is available at <ext-link ext-link-type="uri" xlink:href="http://trimal.cgenomics.org/publications">http://trimal.cgenomics.org/publications</ext-link>.</p>
      <p>
        <bold>Contact:</bold>
        <email>tgabaldon@crg.es</email>
      </p>
    </abstract>
  </article-meta>
</front>
<body>
  <p>Multiple sequence alignments (MSA) are central to many areas of bioinformatics, including phylogenetics, homology modeling, database searches and motif finding. Recently, such MSA-based techniques have been incorporated in high-throughput pipelines such as genome annotation and phylogenomics analyses. In all these applications, the reliability and accuracy of the analyses depend critically on the quality of the underlying alignments. A plethora of computer programs and algorithms for MSA are currently available (Notredame, <xref ref-type="bibr" rid="B4">2007</xref>), which implement different heuristics to find mathematically optimal solutions to the MSA problem. Accuracies of 80–90% have been reported for the best algorithms, but even the best scoring alignment algorithms may fail with certain protein families or at specific regions in the alignment. The situation worsens in large-scale analyses, where faster but less reliable algorithms and large numbers of automatically selected sequences are used. It is therefore generally assumed that trimming the alignment, so that poorly aligned regions are eliminated, increases the accuracy of the resulting MSA-based applications (Talavera and Castresana, <xref ref-type="bibr" rid="B7">2007</xref>). Some programs such as G-blocks (Castresana, <xref ref-type="bibr" rid="B1">2000</xref>) have been developed to assist in the MSA trimming phase by selecting blocks of conserved regions. They have become very popular and are extensively used, with good performance, in small-to-medium scale datasets, where several parameters can be tested manually (Talavera and Castresana, <xref ref-type="bibr" rid="B7">2007</xref>). However, their use over larger datasets is hampered by the need for defining, prior to the analysis, the set of parameters that will be used for all sequence families. Here, we present trimAl, a tool for automated alignment trimming. Its speed and the possibility for automatically adjusting the parameters to improve the phylogenetic signal-to-noise ratio, makes trimAl especially suited for large-scale phylogenomic analyses, involving thousands of large alignments.</p>
  <p>trimAl has been developed in a GNU/Linux environment using C++ programming language and has been tested on various UNIX, Mac and Windows platforms. Moreover, we have developed a web server to run trimAl online (<ext-link ext-link-type="uri" xlink:href="http://phylemon2.bioinfo.cipf.es/">http://phylemon2.bioinfo.cipf.es/</ext-link>), which has been included in the Phylemon suite for phylogenetic and phylogenomic tools (Tarraga <italic>et al.</italic>, <xref ref-type="bibr" rid="B8">2007</xref>). The documentation, source files and additional information for trimAl are available through a wiki page (<ext-link ext-link-type="uri" xlink:href="http://trimal.cgenomics.org">http://trimal.cgenomics.org</ext-link>).</p>
  <p>trimAl reads and renders protein or nucleotide alignments in several standard formats. trimAl starts by reading all columns in an alignment and computes a score (<italic>S</italic><sub><italic>x</italic></sub>) for each of them. This score can be a gap score (<italic>S</italic><sub><italic>g</italic></sub>), a similarity score (<italic>S</italic><sub><italic>s</italic></sub>) or a consistency score (<italic>S</italic><sub><italic>c</italic></sub>). The score for each column can be computed based only on the information from that column or, if a window size of <italic>w</italic> is specified, it corresponds to the average value of <italic>w</italic> columns around the position considered.</p>
  <p>The gap score (<italic>S</italic><sub><italic>g</italic></sub>) for a column is the fraction of sequences without a gap in that position. The residue similarity score (<italic>S</italic><sub><italic>s</italic></sub>) consists of mean distance (MD) scores as described in Thompson <italic>et al.</italic> (<xref ref-type="bibr" rid="B9">2001</xref>) and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp348/DC1">Supplementary Material</ext-link>. This score uses the MD between pairs of residues, as defined by a given scoring matrix. Finally, the consistency score (<italic>S</italic><sub><italic>c</italic></sub>) can only be computed when more than one alignment for the same set of sequences is provided. Details on how these scores are computed are provided in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp348/DC1">Supplementary Material</ext-link>. In brief, <italic>S</italic><sub><italic>c</italic></sub> measures the level of consistency of all the residue pairs found in a column as compared with the other alignments. The alignment with the highest consistency is chosen and then trimmed to remove the columns that are less conserved, according to <italic>S</italic><sub><italic>c</italic></sub> or other thresholds set by the user.</p>
  <p>Once all column scores have been computed trimAl can proceed in two ways. If both a score and a minimum conservation threshold are provided, trimAl renders a trimmed alignment in which only the columns with scores above the <italic>score threshold</italic> are included, as far as the number of selected columns is above a <italic>conservation threshold</italic> defined by the user. If this number is below the <italic>conservation threshold</italic>, trimAl will add more columns to the trimmed alignment in a decreasing order of scores until the <italic>conservation threshold</italic> is reached. The <italic>conservation threshold</italic> corresponds to the minimum percentage of columns, from the original alignment, which the user wants to include in the trimmed alignment.</p>
  <p>Alternatively, if the automatic selection of parameters options is selected, trimAl will compute specific score thresholds depending on the inherent characteristics of each alignment. So far, trimAl incorporates three modes for the automated selection of parameters, <italic>gappyout</italic>, <italic>strict</italic> and <italic>strictplus</italic>, which are based on the different use of gap and similarity scores. Moreover, the option <italic>automated1</italic> implements a heuristic to decide the most appropriate mode depending on the alignment characteristics. The heuristics to define such parameters have been designed based on the results of a benchmark. Details on the heuristics and the benchmark can be found in the online documentation of the program. In brief, the automatic selection of parameters approximate optimal cutoffs by plotting, internally, the cumulative graphs of gap and similarity scores of the columns in the alignment (see online documentation).</p>
  <p>We expanded, using ROSE simulations (Stoye <italic>et al.</italic>, <xref ref-type="bibr" rid="B6">1998</xref>) a benchmark set that has been used previously to test the improvement in phylogenetic performance after an alignment trimming phase (Talavera and Castresana, <xref ref-type="bibr" rid="B7">2007</xref>). This dataset simulates several evolutionary scenarios varying in the number and length of the sequences, the topology of the underlying tree and the level of sequence divergence considered. We compared the results obtained from MUSCLE alignments before and after trimming with trimAl using automated selection of parameters. The accuracy of the resulting trees was measured by comparing them with the original trees used to generate the sequence sets, and measuring the Robinson Foulds distance (Robinson and Foulds, <xref ref-type="bibr" rid="B5">1981</xref>). We observed an overall improvement of the phylogenetic accuracy after trimming. Using <italic>-automated1</italic> option of trimAl, the trimmed alignment always produced Maximum Likelihood trees that were of equal (36%) or significantly better (64%) quality as compared with the tree derived from the complete alignment. For Neighbor Joining reconstruction the <italic>-strictplus</italic> option of trimAl worked best, improving the phylogenetic accuracy in 89% of the scenarios. In most scenarios (90%), trimAl outperformed Gblocks v0.91b with default parameters. Most importantly, the use of Gblocks default parameters diminished the accuracy of the subsequent tree reconstruction in half of the scenarios considered. In contrast, the use of trimAl automated methods rarely (1.5%) undermined the topological accuracy of the resulting phylogenetic tree (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp348/DC1">Supplementary Material</ext-link> for more details).</p>
  <p>To test the applicability of trimAl on real datasets as well as its suitability for large-scale phylogenetic datasets, we ran trimAl on the complete set of MUSCLE alignments generated for the Human Phylome project (Huerta-Cepas <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2007</xref>). This includes a total of 31 182 alignments, containing, on average, 67 sequences of 1472 positions of length. Trimming these alignments using the <italic>-gappyout</italic> and <italic>automated1</italic> options used 5 min 45 s and 125 min, 2 s, respectively, on a computer with an Intel QuadCore XEON E5410 processors and 8 GB of RAM.</p>
  <p>trimAl has been used previously in a pipeline to reconstruct complete collections of gene trees. In this case, the parameter sets used were a minimum conservation threshold of 60% and a gap threshold of 90% (-cons 60 -gt 0.9). Complete and trimmed alignments used to generate the phylomes included in PhylomeDB (Huerta-Cepas <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2008</xref>) can be viewed through this database.</p>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We acknowledge Juan M. Garcia-Gomez and members of the Gabaldón group for fruitful discussions and suggestions. The authors also thank Jordi Burguet-Castell, Pablo Escobar and Joaquín Tàrraga for their technical assistance and José Castresana for providing the data necessary for the benchmark.</p>
    <p><italic>Funding</italic>: FIS (06-213 to T.G.) and MEC (GEN2006-27784-E/PAT to T.G.).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Castresana</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Selection of conserved blocks from multiple alignments for their use in phylogenetic analysis</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>2000</year>
        <volume>17</volume>
        <fpage>540</fpage>
        <lpage>552</lpage>
        <pub-id pub-id-type="pmid">10742046</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huerta-Cepas</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The human phylome</article-title>
        <source>Genome Biol.</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>R109</fpage>
        <pub-id pub-id-type="pmid">17567924</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huerta-Cepas</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PhylomeDB: a database for genome-wide collections of gene phylogenies</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>D491</fpage>
        <lpage>D496</lpage>
        <pub-id pub-id-type="pmid">17962297</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Notredame</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Recent evolutions of multiple sequence alignment algorithms</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2007</year>
        <volume>3</volume>
        <fpage>e123</fpage>
        <pub-id pub-id-type="pmid">17784778</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Foulds</surname>
            <given-names>LR</given-names>
          </name>
        </person-group>
        <article-title>Comparison of phylogenetic trees</article-title>
        <source>Math. Biosci.</source>
        <year>1981</year>
        <volume>53</volume>
        <fpage>131</fpage>
        <lpage>147</lpage>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stoye</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rose: generating sequence families</article-title>
        <source>Bioinformatics</source>
        <year>1998</year>
        <volume>14</volume>
        <fpage>157</fpage>
        <lpage>163</lpage>
        <pub-id pub-id-type="pmid">9545448</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Talavera</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Castresana</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Improvement of phylogenies after removing divergent and ambiguously aligned blocks from protein sequence alignments</article-title>
        <source>Syst. Biol.</source>
        <year>2007</year>
        <volume>56</volume>
        <fpage>564</fpage>
        <lpage>577</lpage>
        <pub-id pub-id-type="pmid">17654362</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tarraga</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phylemon: a suite of web tools for molecular evolution, phylogenetics and phylogenomics</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2007</year>
        <volume>35</volume>
        <fpage>W38</fpage>
        <lpage>W42</lpage>
        <pub-id pub-id-type="pmid">17452346</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thompson</surname>
            <given-names>JD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Towards a reliable objective function for multiple sequence alignments</article-title>
        <source>J. Mol. Biol.</source>
        <year>2001</year>
        <volume>314</volume>
        <fpage>937</fpage>
        <lpage>951</lpage>
        <pub-id pub-id-type="pmid">11734009</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1460-2059</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2712344</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btp348</article-id>
    <article-id pub-id-type="publisher-id">btp348</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group>
          <subject>Phylogenetics</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>trimAl: a tool for automated alignment trimming in large-scale phylogenetic analyses</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Capella-Gutiérrez</surname>
          <given-names>Salvador</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Silla-Martínez</surname>
          <given-names>José M.</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gabaldón</surname>
          <given-names>Toni</given-names>
        </name>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1">Comparative Genomics group, Bioinformatics and Genomics Programme, Centre for Genomic Regulation (CRG), Dr. Aiguader, 88 08003 Barcelona, Spain</aff>
    <author-notes>
      <corresp id="COR1">* To whom correspondence should be addressed.</corresp>
      <fn>
        <p>Associate Editor: Martin Bishop</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>1</day>
      <month>8</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>6</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>6</month>
      <year>2009</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>25</volume>
    <issue>15</issue>
    <fpage>1972</fpage>
    <lpage>1973</lpage>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>5</month>
        <year>2008</year>
      </date>
      <date date-type="rev-recd">
        <day>20</day>
        <month>5</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>1</day>
        <month>6</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2009 The Author(s)</copyright-statement>
      <copyright-year>2009</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> Multiple sequence alignments are central to many areas of bioinformatics. It has been shown that the removal of poorly aligned regions from an alignment increases the quality of subsequent analyses. Such an alignment trimming phase is complicated in large-scale phylogenetic analyses that deal with thousands of alignments. Here, we present trimAl, a tool for automated alignment trimming, which is especially suited for large-scale phylogenetic analyses. trimAl can consider several parameters, alone or in multiple combinations, for selecting the most reliable positions in the alignment. These include the proportion of sequences with a gap, the level of amino acid similarity and, if several alignments for the same set of sequences are provided, the level of consistency across different alignments. Moreover, trimAl can automatically select the parameters to be used in each specific alignment so that the signal-to-noise ratio is optimized.</p>
      <p><bold>Availability:</bold> trimAl has been written in C++, it is portable to all platforms. trimAl is freely available for download (<ext-link ext-link-type="uri" xlink:href="http://trimal.cgenomics.org">http://trimal.cgenomics.org</ext-link>) and can be used online through the Phylemon web server (<ext-link ext-link-type="uri" xlink:href="http://phylemon2.bioinfo.cipf.es/">http://phylemon2.bioinfo.cipf.es/</ext-link>). Supplementary Material is available at <ext-link ext-link-type="uri" xlink:href="http://trimal.cgenomics.org/publications">http://trimal.cgenomics.org/publications</ext-link>.</p>
      <p>
        <bold>Contact:</bold>
        <email>tgabaldon@crg.es</email>
      </p>
    </abstract>
  </article-meta>
</front>
<body>
  <p>Multiple sequence alignments (MSA) are central to many areas of bioinformatics, including phylogenetics, homology modeling, database searches and motif finding. Recently, such MSA-based techniques have been incorporated in high-throughput pipelines such as genome annotation and phylogenomics analyses. In all these applications, the reliability and accuracy of the analyses depend critically on the quality of the underlying alignments. A plethora of computer programs and algorithms for MSA are currently available (Notredame, <xref ref-type="bibr" rid="B4">2007</xref>), which implement different heuristics to find mathematically optimal solutions to the MSA problem. Accuracies of 80–90% have been reported for the best algorithms, but even the best scoring alignment algorithms may fail with certain protein families or at specific regions in the alignment. The situation worsens in large-scale analyses, where faster but less reliable algorithms and large numbers of automatically selected sequences are used. It is therefore generally assumed that trimming the alignment, so that poorly aligned regions are eliminated, increases the accuracy of the resulting MSA-based applications (Talavera and Castresana, <xref ref-type="bibr" rid="B7">2007</xref>). Some programs such as G-blocks (Castresana, <xref ref-type="bibr" rid="B1">2000</xref>) have been developed to assist in the MSA trimming phase by selecting blocks of conserved regions. They have become very popular and are extensively used, with good performance, in small-to-medium scale datasets, where several parameters can be tested manually (Talavera and Castresana, <xref ref-type="bibr" rid="B7">2007</xref>). However, their use over larger datasets is hampered by the need for defining, prior to the analysis, the set of parameters that will be used for all sequence families. Here, we present trimAl, a tool for automated alignment trimming. Its speed and the possibility for automatically adjusting the parameters to improve the phylogenetic signal-to-noise ratio, makes trimAl especially suited for large-scale phylogenomic analyses, involving thousands of large alignments.</p>
  <p>trimAl has been developed in a GNU/Linux environment using C++ programming language and has been tested on various UNIX, Mac and Windows platforms. Moreover, we have developed a web server to run trimAl online (<ext-link ext-link-type="uri" xlink:href="http://phylemon2.bioinfo.cipf.es/">http://phylemon2.bioinfo.cipf.es/</ext-link>), which has been included in the Phylemon suite for phylogenetic and phylogenomic tools (Tarraga <italic>et al.</italic>, <xref ref-type="bibr" rid="B8">2007</xref>). The documentation, source files and additional information for trimAl are available through a wiki page (<ext-link ext-link-type="uri" xlink:href="http://trimal.cgenomics.org">http://trimal.cgenomics.org</ext-link>).</p>
  <p>trimAl reads and renders protein or nucleotide alignments in several standard formats. trimAl starts by reading all columns in an alignment and computes a score (<italic>S</italic><sub><italic>x</italic></sub>) for each of them. This score can be a gap score (<italic>S</italic><sub><italic>g</italic></sub>), a similarity score (<italic>S</italic><sub><italic>s</italic></sub>) or a consistency score (<italic>S</italic><sub><italic>c</italic></sub>). The score for each column can be computed based only on the information from that column or, if a window size of <italic>w</italic> is specified, it corresponds to the average value of <italic>w</italic> columns around the position considered.</p>
  <p>The gap score (<italic>S</italic><sub><italic>g</italic></sub>) for a column is the fraction of sequences without a gap in that position. The residue similarity score (<italic>S</italic><sub><italic>s</italic></sub>) consists of mean distance (MD) scores as described in Thompson <italic>et al.</italic> (<xref ref-type="bibr" rid="B9">2001</xref>) and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp348/DC1">Supplementary Material</ext-link>. This score uses the MD between pairs of residues, as defined by a given scoring matrix. Finally, the consistency score (<italic>S</italic><sub><italic>c</italic></sub>) can only be computed when more than one alignment for the same set of sequences is provided. Details on how these scores are computed are provided in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp348/DC1">Supplementary Material</ext-link>. In brief, <italic>S</italic><sub><italic>c</italic></sub> measures the level of consistency of all the residue pairs found in a column as compared with the other alignments. The alignment with the highest consistency is chosen and then trimmed to remove the columns that are less conserved, according to <italic>S</italic><sub><italic>c</italic></sub> or other thresholds set by the user.</p>
  <p>Once all column scores have been computed trimAl can proceed in two ways. If both a score and a minimum conservation threshold are provided, trimAl renders a trimmed alignment in which only the columns with scores above the <italic>score threshold</italic> are included, as far as the number of selected columns is above a <italic>conservation threshold</italic> defined by the user. If this number is below the <italic>conservation threshold</italic>, trimAl will add more columns to the trimmed alignment in a decreasing order of scores until the <italic>conservation threshold</italic> is reached. The <italic>conservation threshold</italic> corresponds to the minimum percentage of columns, from the original alignment, which the user wants to include in the trimmed alignment.</p>
  <p>Alternatively, if the automatic selection of parameters options is selected, trimAl will compute specific score thresholds depending on the inherent characteristics of each alignment. So far, trimAl incorporates three modes for the automated selection of parameters, <italic>gappyout</italic>, <italic>strict</italic> and <italic>strictplus</italic>, which are based on the different use of gap and similarity scores. Moreover, the option <italic>automated1</italic> implements a heuristic to decide the most appropriate mode depending on the alignment characteristics. The heuristics to define such parameters have been designed based on the results of a benchmark. Details on the heuristics and the benchmark can be found in the online documentation of the program. In brief, the automatic selection of parameters approximate optimal cutoffs by plotting, internally, the cumulative graphs of gap and similarity scores of the columns in the alignment (see online documentation).</p>
  <p>We expanded, using ROSE simulations (Stoye <italic>et al.</italic>, <xref ref-type="bibr" rid="B6">1998</xref>) a benchmark set that has been used previously to test the improvement in phylogenetic performance after an alignment trimming phase (Talavera and Castresana, <xref ref-type="bibr" rid="B7">2007</xref>). This dataset simulates several evolutionary scenarios varying in the number and length of the sequences, the topology of the underlying tree and the level of sequence divergence considered. We compared the results obtained from MUSCLE alignments before and after trimming with trimAl using automated selection of parameters. The accuracy of the resulting trees was measured by comparing them with the original trees used to generate the sequence sets, and measuring the Robinson Foulds distance (Robinson and Foulds, <xref ref-type="bibr" rid="B5">1981</xref>). We observed an overall improvement of the phylogenetic accuracy after trimming. Using <italic>-automated1</italic> option of trimAl, the trimmed alignment always produced Maximum Likelihood trees that were of equal (36%) or significantly better (64%) quality as compared with the tree derived from the complete alignment. For Neighbor Joining reconstruction the <italic>-strictplus</italic> option of trimAl worked best, improving the phylogenetic accuracy in 89% of the scenarios. In most scenarios (90%), trimAl outperformed Gblocks v0.91b with default parameters. Most importantly, the use of Gblocks default parameters diminished the accuracy of the subsequent tree reconstruction in half of the scenarios considered. In contrast, the use of trimAl automated methods rarely (1.5%) undermined the topological accuracy of the resulting phylogenetic tree (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp348/DC1">Supplementary Material</ext-link> for more details).</p>
  <p>To test the applicability of trimAl on real datasets as well as its suitability for large-scale phylogenetic datasets, we ran trimAl on the complete set of MUSCLE alignments generated for the Human Phylome project (Huerta-Cepas <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2007</xref>). This includes a total of 31 182 alignments, containing, on average, 67 sequences of 1472 positions of length. Trimming these alignments using the <italic>-gappyout</italic> and <italic>automated1</italic> options used 5 min 45 s and 125 min, 2 s, respectively, on a computer with an Intel QuadCore XEON E5410 processors and 8 GB of RAM.</p>
  <p>trimAl has been used previously in a pipeline to reconstruct complete collections of gene trees. In this case, the parameter sets used were a minimum conservation threshold of 60% and a gap threshold of 90% (-cons 60 -gt 0.9). Complete and trimmed alignments used to generate the phylomes included in PhylomeDB (Huerta-Cepas <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2008</xref>) can be viewed through this database.</p>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We acknowledge Juan M. Garcia-Gomez and members of the Gabaldón group for fruitful discussions and suggestions. The authors also thank Jordi Burguet-Castell, Pablo Escobar and Joaquín Tàrraga for their technical assistance and José Castresana for providing the data necessary for the benchmark.</p>
    <p><italic>Funding</italic>: FIS (06-213 to T.G.) and MEC (GEN2006-27784-E/PAT to T.G.).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Castresana</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Selection of conserved blocks from multiple alignments for their use in phylogenetic analysis</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>2000</year>
        <volume>17</volume>
        <fpage>540</fpage>
        <lpage>552</lpage>
        <pub-id pub-id-type="pmid">10742046</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huerta-Cepas</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The human phylome</article-title>
        <source>Genome Biol.</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>R109</fpage>
        <pub-id pub-id-type="pmid">17567924</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huerta-Cepas</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PhylomeDB: a database for genome-wide collections of gene phylogenies</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>D491</fpage>
        <lpage>D496</lpage>
        <pub-id pub-id-type="pmid">17962297</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Notredame</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Recent evolutions of multiple sequence alignment algorithms</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2007</year>
        <volume>3</volume>
        <fpage>e123</fpage>
        <pub-id pub-id-type="pmid">17784778</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Foulds</surname>
            <given-names>LR</given-names>
          </name>
        </person-group>
        <article-title>Comparison of phylogenetic trees</article-title>
        <source>Math. Biosci.</source>
        <year>1981</year>
        <volume>53</volume>
        <fpage>131</fpage>
        <lpage>147</lpage>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stoye</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rose: generating sequence families</article-title>
        <source>Bioinformatics</source>
        <year>1998</year>
        <volume>14</volume>
        <fpage>157</fpage>
        <lpage>163</lpage>
        <pub-id pub-id-type="pmid">9545448</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Talavera</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Castresana</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Improvement of phylogenies after removing divergent and ambiguously aligned blocks from protein sequence alignments</article-title>
        <source>Syst. Biol.</source>
        <year>2007</year>
        <volume>56</volume>
        <fpage>564</fpage>
        <lpage>577</lpage>
        <pub-id pub-id-type="pmid">17654362</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tarraga</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phylemon: a suite of web tools for molecular evolution, phylogenetics and phylogenomics</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2007</year>
        <volume>35</volume>
        <fpage>W38</fpage>
        <lpage>W42</lpage>
        <pub-id pub-id-type="pmid">17452346</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thompson</surname>
            <given-names>JD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Towards a reliable objective function for multiple sequence alignments</article-title>
        <source>J. Mol. Biol.</source>
        <year>2001</year>
        <volume>314</volume>
        <fpage>937</fpage>
        <lpage>951</lpage>
        <pub-id pub-id-type="pmid">11734009</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
