<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Algorithms Mol Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Algorithms Mol Biol</journal-id>
    <journal-title-group>
      <journal-title>Algorithms for Molecular Biology : AMB</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1748-7188</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10399073</article-id>
    <article-id pub-id-type="pmid">37537624</article-id>
    <article-id pub-id-type="publisher-id">232</article-id>
    <article-id pub-id-type="doi">10.1186/s13015-023-00232-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>phyBWT2: phylogeny reconstruction via eBWT positional clustering</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Guerrini</surname>
          <given-names>Veronica</given-names>
        </name>
        <address>
          <email>veronica.guerrini@unipi.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Conte</surname>
          <given-names>Alessio</given-names>
        </name>
        <address>
          <email>alessio.conte@unipi.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Grossi</surname>
          <given-names>Roberto</given-names>
        </name>
        <address>
          <email>roberto.grossi@unipi.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liti</surname>
          <given-names>Gianni</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Rosone</surname>
          <given-names>Giovanna</given-names>
        </name>
        <address>
          <email>giovanna.rosone@unipi.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tattini</surname>
          <given-names>Lorenzo</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/03ad39j10</institution-id><institution-id institution-id-type="GRID">grid.5395.a</institution-id><institution-id institution-id-type="ISNI">0000 0004 1757 3729</institution-id><institution>Dipartimento di Informatica, </institution><institution>University of Pisa, </institution></institution-wrap>Pisa, Italy </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.4444.0</institution-id><institution-id institution-id-type="ISNI">0000 0001 2112 9282</institution-id><institution>CNRS UMR 7284, INSERM U1081 Université Côte d’Azu, </institution></institution-wrap>Nice, France </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>3</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>3</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>18</volume>
    <elocation-id>11</elocation-id>
    <history>
      <date date-type="received">
        <day>31</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>6</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Molecular phylogenetics studies the evolutionary relationships among the individuals of a population through their biological sequences. It may provide insights about the origin and the evolution of viral diseases, or highlight complex evolutionary trajectories. A key task is inferring phylogenetic trees from any type of sequencing data, including raw short reads. Yet, several tools require pre-processed input data e.g. from complex computational pipelines based on <italic>de novo</italic> assembly or from mappings against a reference genome. As sequencing technologies keep becoming cheaper, this puts increasing pressure on designing methods that perform analysis directly on their outputs. From this viewpoint, there is a growing interest in alignment-, assembly-, and reference-free methods that could work on several data including raw reads data.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We present phyBWT2, a newly improved version of phyBWT (Guerrini et al. in 22nd International Workshop on Algorithms in Bioinformatics (WABI) 242:23–12319, 2022). Both of them directly reconstruct phylogenetic trees bypassing both the alignment against a reference genome and de novo assembly. They exploit the combinatorial properties of the extended Burrows-Wheeler Transform (eBWT) and the corresponding eBWT positional clustering framework to detect relevant blocks of the longest shared substrings of varying length (unlike the <italic>k</italic>-mer-based approaches that need to fix the length <italic>k</italic> a priori). As a result, they provide novel alignment-, assembly-, and reference-free methods that build partition trees without relying on the pairwise comparison of sequences, thus avoiding to use a distance matrix to infer phylogeny. In addition, phyBWT2 outperforms phyBWT in terms of running time, as the former reconstructs phylogenetic trees step-by-step by considering multiple partitions, instead of just one partition at a time, as previously done by the latter.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Based on the results of the experiments on sequencing data, we conclude that our method can produce trees of quality comparable to the benchmark phylogeny by handling datasets of different types (short reads, contigs, or entire genomes). Overall, the experiments confirm the effectiveness of phyBWT2 that improves the performance of its previous version phyBWT, while preserving the accuracy of the results.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13015-023-00232-4.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Phylogeny</kwd>
      <kwd>Partition tree</kwd>
      <kwd>BWT</kwd>
      <kwd>Positional cluster</kwd>
      <kwd>Alignment-free</kwd>
      <kwd>Reference-free</kwd>
      <kwd>Assembly-free</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000780</institution-id>
            <institution>European Commission</institution>
          </institution-wrap>
        </funding-source>
        <award-id>ECS00000017</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003407</institution-id>
            <institution>Ministero dell’Istruzione, dell’Università e della Ricerca</institution>
          </institution-wrap>
        </funding-source>
        <award-id>20174LF3T8</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par14">Phylogenetics concerns the study of the evolutionary history and the relationships among individuals or groups of individuals, e.g., species or several populations of one species. These relationships are inferred from heritable traits or, for instance, DNA sequences. Phylogenies, in the form of rooted or unrooted trees, can be used for several purposes: to reconstruct the ancestry of the species (or other taxa) on the tree of life, to understand the epidemiological dynamics of pathogens, and to identify and study complex evolutionary events such as hybridisation [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>], introgression [<xref ref-type="bibr" rid="CR3">3</xref>], and horizontal gene transfer [<xref ref-type="bibr" rid="CR4">4</xref>]. Thus, they are successfully employed in almost every branch of biology, including e.g. population genomics and metagenomics, ecology, and biogeography [<xref ref-type="bibr" rid="CR5">5</xref>]. Phylogeny has also important applications in the medical field, including for instance epidemiology, drug discovery and drug design. Concerning public health, pathogen outbreaks can be studied by molecular phylogenetic analysis. Indeed, the analysis of the epidemiological link between genetic sequences of a pathogen can be useful for understanding the possible sources of transmission.</p>
    <p id="Par15">A vast array of techniques for inferring phylogeny has been developed over the years [<xref ref-type="bibr" rid="CR6">6</xref>]. Sequence-based methods analyze the DNA or RNA sequences of the taxa, and are based on their similarity or dissimilarity detection. Most of them rely on a distance matrix by computing the pairwise evolutionary distances between every pair of input sequences. Standard algorithms, such as the neighbour-joining algorithm [<xref ref-type="bibr" rid="CR7">7</xref>], are then applied to the distance matrix to perform the tree reconstruction.</p>
    <p id="Par16">A key aspect is how to compute these evolutionary distances. Sequence alignment is often employed in distance computation, performed on either entire sequences or parts of them, with the optional usage of a reference genome. However, with the advent of high-throughput sequencing technologies and the completion of various genome projects, the amount of whole-genome sequencing data available has increased and a new era for phylogeny started. Owing to the rising cost of the alignment task, alignment-free approaches for quantifying the similarity/dissimilarity between sequences have been introduced. An advantage of these approaches is that they are robust for recombination and shuffling events [<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR10">10</xref>]. As the majority of alignment-free approaches for phylogenetic reconstruction performs a preliminary extraction of the <italic>k</italic>-mers (i.e. substrings of length <italic>k</italic>) from the input sequences, they can analyze directly the reads obtained from the sequencing platforms, thus avoiding the assembly of these reads and the extraction of the <italic>k</italic>-mers from the assembly.</p>
    <p id="Par17"><italic>Our contribution</italic> In this paper we present phyBWT2, a new version of our tool called phyBWT and previously introduced in [<xref ref-type="bibr" rid="CR11">11</xref>] to reconstruct a phylogenetic tree for a set of taxa. The worst-case running time of phyBWT2 is <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(N \ell )$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq1.gif"/></alternatives></inline-formula> for <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell$$\end{document}</tex-math><mml:math id="M4"><mml:mi>ℓ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq2.gif"/></alternatives></inline-formula> taxa of total length <italic>N</italic>, using <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(N + \ell ^2)$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq3.gif"/></alternatives></inline-formula> space. Like its predecessor, phyBWT2 combines many features in a single new method to reconstruct a phylogenetic tree starting from any type of data, e.g. assembled sequences as well as raw reads. Firstly, phyBWT2 is alignment-, assembly-, and reference-free, and thus it can work directly on raw sequencing reads. Secondly, it does not need a distance matrix as it does not rely on the pairwise comparison of sequences. Moreover, it exploits the combinatorial properties of the <italic>positional clustering</italic> framework recently introduced in [<xref ref-type="bibr" rid="CR12">12</xref>], overcoming the limitations of employing <italic>k</italic>-mers with fixed size <italic>k</italic> a priori.</p>
    <p id="Par18">The contribution of our approach is twofold, theoretical as well as practical. To the best of our knowledge, both phyBWT and phyBWT2 are the first to apply the properties of the Extended Burrows-Wheeler Transform (eBWT), employed in the positional clustering, to the idea of decomposition for phylogenetic inference. Not only they are oblivious to extra information, such as reference sequences or read mappings, but they also avoid the workload of assembling or aligning input sequences. Finally, they infer the tree structure by comparing all the sequences simultaneously and efficiently, instead of performing their pairwise comparisons: they do not reconstruct the tree in top-down or bottom-up directions, rather they refine the current structure simultaneously in both directions (so bottom up and top down are special cases of this more general reconstruction).</p>
    <p id="Par19">Despite these common ideas behind them, phyBWT2 improves over phyBWT in several aspects. To see why, let us briefly recall how phyBWT works. It builds the phylogenetic tree through a series of partitions performed on groups of nodes. Each partition isolates groups of taxa from the others, and phyBWT always proceeds in two opposite directions while reconstructing the tree: it goes towards the leaves by dividing each part, and towards the root by grouping the parts. Each part actually generates a node of the phylogeny tree.</p>
    <p id="Par20">In phyBWT2, the tree reconstruction strategy is different, as phyBWT2 does not consider a single partition at time, but it simultaneously handles several compatible cuts that correspond to an unrefined tree. The general idea is that an unrefined partition tree can be refined by taking one of its nodes and restricting phyBWT2 ’s attention to just the groups of taxa corresponding to its children. This restriction allows phyBWT2 to look into them to estimate phylogenetic signals.</p>
    <p id="Par21">In Sect. "<xref rid="Sec9" ref-type="sec">Experimental evaluation</xref>", we show that phyBWT2 produces phylogenic trees of quality comparable to the standard benchmarks by handling datasets of different types (short reads, contigs, or entire genomes). Furthermore, we experimentally provide evidence that phyBWT2 is more efficient than phyBWT in terms of the number of iterations performed to reconstruct a phylogenetic tree. Remarkably, phyBWT2 can keep the required data structures in external memory, thus alleviating the main memory usage. For these reasons, phyBWT2 can be considered as a replacement of our original tool phyBWT.</p>
    <p id="Par22"><italic>State of the art</italic> The Burrows-Wheeler Transform (BWT) [<xref ref-type="bibr" rid="CR13">13</xref>] of a string (and the eBWT of a set of strings [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR15">15</xref>]) is a suitable permutation of the symbols of the string(s), whose output shows a local similarity, i.e. symbols preceding similar contexts tend to occur in clusters. Both transformations have been intensively studied with important and successful applications in several areas. For instance, the eBWT has been used for defining alignment-free methods based on a pairwise distance matrix [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR16">16</xref>–<xref ref-type="bibr" rid="CR18">18</xref>] in order to build up a phylogenetic tree for mitochondrial DNA genomes. The positional clustering detects “interesting” blocks in the output of the eBWT  [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR15">15</xref>], so that the requirement on the fixed size <italic>k</italic> in <italic>k</italic>-mers is relaxed and becomes of variable-order, not fixed a priori, in an adaptive way according to the contexts. This framework has already been used in other bioinformatics tasks, such as for detecting SNPs and INDELs in short-read datasets [<xref ref-type="bibr" rid="CR19">19</xref>] and for lossy compression of FASTQ datasets [<xref ref-type="bibr" rid="CR20">20</xref>].</p>
    <p id="Par23">Both phyBWT2 and phyBWT exploit the underlying properties of the eBWT: (i) the clustering effect, i.e. the fact that the eBWT tends to group together equal symbols in the transformed string that occur in similar contexts in the input string collection; (ii) the fact that if a substring <italic>x</italic> occurs in one or more strings, then the suffixes of the input dataset starting with <italic>x</italic>-occurrence are close in the sorted list of suffixes. In other words, the greater the number of these substrings shared by two taxa is, the more they are similar.</p>
    <p id="Par24">Although phyBWT2 and phyBWT do not use a distance matrix, they have some resemblance with split decomposition methods when reconstructing the tree from the information gathered through the eBWT. We recall that split decomposition relies on a solid mathematical ground [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>], and has been successfully applied to phylogeny [<xref ref-type="bibr" rid="CR23">23</xref>]. The idea is to score the possible splits (i.e. bipartitions) of the taxa, and assign an isolation index to each split based on the distances in the given matrix. Compatible splits are those with an empty intersection on one of the parts in the splits, and the isolation index is treated as a priority weight in making a (greedy) choice among the splits. Compatible splits induce a tree and vice versa. However, a residual error is generated on real-world data, and a notion of weak split compatibility is preferred to create a weighted phylogeny network instead of a phylogeny tree: the shortest weighted part between any two nodes in this network gives the isolation index in the corresponding split. For <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell$$\end{document}</tex-math><mml:math id="M8"><mml:mi>ℓ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq4.gif"/></alternatives></inline-formula> taxa, only <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\ell ^2)$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq5.gif"/></alternatives></inline-formula> splits are needed for split decomposition instead of <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2^\ell$$\end{document}</tex-math><mml:math id="M12"><mml:msup><mml:mn>2</mml:mn><mml:mi>ℓ</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq6.gif"/></alternatives></inline-formula> ones [<xref ref-type="bibr" rid="CR21">21</xref>].</p>
    <p id="Par25">As the original algorithm in the seminal papers on split decomposition [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR23">23</xref>] requires <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\ell ^6)$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ℓ</mml:mi><mml:mn>6</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq7.gif"/></alternatives></inline-formula> comparisons, further papers have addressed efficiency and extended these ideas. The recent alignment-free method SANS [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR25">25</xref>] uses the notions of the split decomposition theory to greedily build a list of weakly compatible splits from which to infer phylogenies. In the list, each split has its own weight computed by counting <italic>k</italic>-mers that are stored in a colored de Bruijn graph [<xref ref-type="bibr" rid="CR24">24</xref>] (this has been improved later by hashing [<xref ref-type="bibr" rid="CR25">25</xref>], leaving the colored de Bruijn graph as input option). The calculated list of splits ordered by weight is then filtered according to two strategies that are described and implemented in the software tool SplitsTree [<xref ref-type="bibr" rid="CR26">26</xref>]. In our experimental study, we compare the trees obtained by SANS and phyBWT2. It should be noted that SANS is also able to reconstruct phylogenetic networks whereas phyBWT2 reconstructs phylogenetic trees only.</p>
    <p id="Par26">As previously mentioned, a plethora of methods have been designed for phylogeny reconstruction (e.g. DBLP reports over 500 papers having “phylogeny” in the title). We refer the reader to [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR28">28</xref>] for a complete and detailed review of various methods for phylogeny estimation. We briefly mention here that among the alignment-based approaches are character-based methods [<xref ref-type="bibr" rid="CR5">5</xref>], that generally produce alignments of the input sequences and compare all sequences simultaneously considering one character per time (e.g. using maximum parsimony or maximum likelihood).</p>
    <p id="Par27">A preliminary version of this paper appeared in [<xref ref-type="bibr" rid="CR11">11</xref>] with limited experiments performed using our prototype tool phyBWT  .<xref ref-type="fn" rid="Fn1">1</xref> The new version phyBWT2 replaces phyBWT.</p>
  </sec>
  <sec id="Sec2">
    <title>Preliminaries</title>
    <p id="Par29">In this section, we define the general terminology we will use throughout this paper.</p>
    <p id="Par30">Let <italic>s</italic> be a string (also called sequence) of length <italic>n</italic> on the alphabet <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Sigma$$\end{document}</tex-math><mml:math id="M16"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq8.gif"/></alternatives></inline-formula>. We denote the <italic>i</italic>-th symbol of <italic>s</italic> by <italic>s</italic>[<italic>i</italic>]. A <italic>substring</italic> of any <italic>s</italic> is denoted as <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s[i,j] = s[i] \cdots s[j]$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>⋯</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq9.gif"/></alternatives></inline-formula>, with <italic>s</italic>[1, <italic>j</italic>] being called a <italic>prefix</italic> and <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s[i,n+1]$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq10.gif"/></alternatives></inline-formula> a <italic>suffix</italic> of <italic>s</italic>. A <italic>k</italic><italic>-mer</italic> is a string of length <italic>k</italic>.</p>
    <p id="Par31">Let <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S} =\{s_1,s_2,\ldots ,s_{\ell }\}$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mi mathvariant="script">S</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>ℓ</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq11.gif"/></alternatives></inline-formula> be a collection of <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell$$\end{document}</tex-math><mml:math id="M24"><mml:mi>ℓ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq12.gif"/></alternatives></inline-formula> strings. We assume that each string <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_i \in \mathcal {S}$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq13.gif"/></alternatives></inline-formula> has length <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_i$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq14.gif"/></alternatives></inline-formula> and is followed by a special end-marker symbol <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_i[n_i+1] = \$_i$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="normal">$</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq15.gif"/></alternatives></inline-formula>, which is lexicographically smaller than any other symbol in <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M32"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq16.gif"/></alternatives></inline-formula>, and does not appear in <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M34"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq17.gif"/></alternatives></inline-formula> elsewhere.<xref ref-type="fn" rid="Fn2">2</xref></p>
    <sec id="Sec3">
      <title>Basic data structures</title>
      <p id="Par33">The <italic>Burrows-Wheeler Transform</italic> (BWT) [<xref ref-type="bibr" rid="CR13">13</xref>] is a well-known widely used reversible string transformation that can be extended to a collection of strings. Such an extension, introduced in [<xref ref-type="bibr" rid="CR14">14</xref>], is a reversible transformation whose output string (denoted by <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq18.gif"/></alternatives></inline-formula>) is a permutation of the symbols of all strings in <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M38"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq19.gif"/></alternatives></inline-formula>. In [<xref ref-type="bibr" rid="CR15">15</xref>], the authors introduced a variant of this transformation for string collection in which a distinct end-marker is appended to each string, making the collection ordered. Such transformations are known as eBWT or multi-string BWT.
</p>
      <p id="Par34">The length of <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq20.gif"/></alternatives></inline-formula> is denoted by <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=\sum _{i=1}^{\ell }(n_i+1)$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>ℓ</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq21.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} (\mathcal {S})[i]=x$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq22.gif"/></alternatives></inline-formula>, with <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\!\le \!i\!\le \!N$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="-0.166667em"/><mml:mo>≤</mml:mo><mml:mspace width="-0.166667em"/><mml:mi>i</mml:mi><mml:mspace width="-0.166667em"/><mml:mo>≤</mml:mo><mml:mspace width="-0.166667em"/><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq23.gif"/></alternatives></inline-formula>, if <italic>x</italic> circularly precedes the <italic>i</italic>-th suffix <inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_j[k,n_j+1]$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq24.gif"/></alternatives></inline-formula> (for some <inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\le j\le \ell$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq25.gif"/></alternatives></inline-formula> and <inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\le k\le n_j\!+\!1$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mspace width="-0.166667em"/><mml:mo>+</mml:mo><mml:mspace width="-0.166667em"/><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq26.gif"/></alternatives></inline-formula>), according to the lexicographic sorting of the suffixes of all strings in <inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M54"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq27.gif"/></alternatives></inline-formula>.</p>
      <p id="Par35">Usually the output string <inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq28.gif"/></alternatives></inline-formula> is enhanced with the <italic>document array</italic> (DA) and <italic>longest common prefix</italic> (LCP) array of <inline-formula id="IEq29"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M58"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq29.gif"/></alternatives></inline-formula>.</p>
      <p id="Par36">The <italic>document array</italic> of <inline-formula id="IEq30"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M60"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq30.gif"/></alternatives></inline-formula> (denoted by <inline-formula id="IEq31"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {da} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mi mathvariant="sans-serif">da</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq31.gif"/></alternatives></inline-formula>) is the array of length <italic>N</italic> such that <inline-formula id="IEq32"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {da} (\mathcal {S})[i]=j$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mi mathvariant="sans-serif">da</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq32.gif"/></alternatives></inline-formula>, with <inline-formula id="IEq33"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\le j\le \ell$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq33.gif"/></alternatives></inline-formula> and <inline-formula id="IEq34"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 \le i \le N$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq34.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq35"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} (\mathcal {S})[i]$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq35.gif"/></alternatives></inline-formula> is a symbol of the string <inline-formula id="IEq36"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_j$$\end{document}</tex-math><mml:math id="M72"><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq36.gif"/></alternatives></inline-formula>.</p>
      <p id="Par37">The <italic>longest common prefix</italic> (LCP) array [<xref ref-type="bibr" rid="CR29">29</xref>] of <inline-formula id="IEq37"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M74"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq37.gif"/></alternatives></inline-formula> is the array <inline-formula id="IEq38"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq38.gif"/></alternatives></inline-formula> of length <inline-formula id="IEq39"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N+1$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq39.gif"/></alternatives></inline-formula>, such that <inline-formula id="IEq40"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} (\mathcal {S})[i]$$\end{document}</tex-math><mml:math id="M80"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq40.gif"/></alternatives></inline-formula>, with <inline-formula id="IEq41"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2 \le i \le N$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:mn>2</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq41.gif"/></alternatives></inline-formula>, is the length of the longest common prefix between the suffixes associated with the positions <italic>i</italic> and <inline-formula id="IEq42"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i-1$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq42.gif"/></alternatives></inline-formula> in <inline-formula id="IEq43"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M86"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq43.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq44"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} (\mathcal {S})[1] = \textsf {lcp} (\mathcal {S})[N+1]= 0$$\end{document}</tex-math><mml:math id="M88"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq44.gif"/></alternatives></inline-formula> by default. The set <inline-formula id="IEq45"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M90"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq45.gif"/></alternatives></inline-formula> can be omitted when it is clear from the context.</p>
      <p id="Par38">The following is an important property of the eBWT, and thus of the related data structures DA and LCP, that will be used in our method:</p>
      <sec id="FPar1">
        <title>Remark 1</title>
        <p id="Par39">The eBWT, DA and LCP data structures for a subset of <inline-formula id="IEq46"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M92"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq46.gif"/></alternatives></inline-formula> can be obtained by linearly scanning those built for <inline-formula id="IEq47"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M94"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq47.gif"/></alternatives></inline-formula>.</p>
        <p id="Par40">In [<xref ref-type="bibr" rid="CR15">15</xref>], the authors prove that given a collection <inline-formula id="IEq48"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S} =\{S_1,S_2,\ldots ,S_{\ell }\}$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:mi mathvariant="script">S</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>ℓ</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq48.gif"/></alternatives></inline-formula> of strings and <inline-formula id="IEq49"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq49.gif"/></alternatives></inline-formula>, one can obtain the eBWT of a subset <inline-formula id="IEq50"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {R}$$\end{document}</tex-math><mml:math id="M100"><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq50.gif"/></alternatives></inline-formula> of <inline-formula id="IEq51"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M102"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq51.gif"/></alternatives></inline-formula> by removing all the characters not in <inline-formula id="IEq52"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {R}$$\end{document}</tex-math><mml:math id="M104"><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq52.gif"/></alternatives></inline-formula>, without constructing the eBWT from scratch, as the relative order of suffixes holds. One can obtain the DA for <inline-formula id="IEq53"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {R}$$\end{document}</tex-math><mml:math id="M106"><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq53.gif"/></alternatives></inline-formula> analogously by scanning <inline-formula id="IEq54"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {da} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:mi mathvariant="sans-serif">da</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq54.gif"/></alternatives></inline-formula> and removing entries not in <inline-formula id="IEq55"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {R}$$\end{document}</tex-math><mml:math id="M110"><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq55.gif"/></alternatives></inline-formula>.</p>
        <p id="Par41">Similarly, one can obtain the LCP of a subset of <inline-formula id="IEq56"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M112"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq56.gif"/></alternatives></inline-formula> by using the properties of the LCP array: for any pair of indices <inline-formula id="IEq57"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i&lt;j$$\end{document}</tex-math><mml:math id="M114"><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq57.gif"/></alternatives></inline-formula>, the longest common prefix between the suffix associated with position <italic>i</italic> and the suffix associated with position <italic>j</italic> is given by <inline-formula id="IEq58"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\min \{\textsf {lcp} [i+1],\ldots ,\textsf {lcp} [j]\}$$\end{document}</tex-math><mml:math id="M116"><mml:mrow><mml:mo movablelimits="true">min</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq58.gif"/></alternatives></inline-formula>.</p>
        <p>Let <inline-formula id="IEq59"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {R}\subset \mathcal {S}$$\end{document}</tex-math><mml:math id="M118"><mml:mrow><mml:mi mathvariant="script">R</mml:mi><mml:mo>⊂</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq59.gif"/></alternatives></inline-formula>. We denote by <inline-formula id="IEq60"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} (\mathcal {S})|_{\mathcal {R}}$$\end{document}</tex-math><mml:math id="M120"><mml:msub><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="script">R</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq60.gif"/></alternatives></inline-formula> (resp. <inline-formula id="IEq61"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {da} (\mathcal {S})|_{\mathcal {R}}$$\end{document}</tex-math><mml:math id="M122"><mml:msub><mml:mrow><mml:mi mathvariant="sans-serif">da</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="script">R</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq61.gif"/></alternatives></inline-formula>, <inline-formula id="IEq62"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} (\mathcal {S})|_{\mathcal {R}}$$\end{document}</tex-math><mml:math id="M124"><mml:msub><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="script">R</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq62.gif"/></alternatives></inline-formula>) the restriction of the data structure <inline-formula id="IEq63"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq63.gif"/></alternatives></inline-formula> (resp. <inline-formula id="IEq64"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {da} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M128"><mml:mrow><mml:mi mathvariant="sans-serif">da</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq64.gif"/></alternatives></inline-formula>, <inline-formula id="IEq65"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq65.gif"/></alternatives></inline-formula>) to the set of strings <inline-formula id="IEq66"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {R}$$\end{document}</tex-math><mml:math id="M132"><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq66.gif"/></alternatives></inline-formula>.</p>
      </sec>
    </sec>
    <sec id="Sec4">
      <title>LCP-interval and k-mer vs positional cluster</title>
      <p id="Par43">We denote by LCP-intervals  of LCP-value <italic>k</italic> maximal intervals [<italic>i</italic>, <italic>j</italic>] that satisfy <inline-formula id="IEq67"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} (\mathcal {S})[r] \ge k$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>≥</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq67.gif"/></alternatives></inline-formula> for <inline-formula id="IEq68"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i &lt; r \le j$$\end{document}</tex-math><mml:math id="M136"><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>r</mml:mi><mml:mo>≤</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq68.gif"/></alternatives></inline-formula> (slightly different definition from [<xref ref-type="bibr" rid="CR30">30</xref>]). The suffixes associated with LCP-intervals of LCP-value <italic>k</italic> have a common <italic>k</italic>-mer as prefix.</p>
      <p id="Par44">In any string collection, thus, LCP-intervals of LCP-value <italic>k</italic> are in a one-to-one correspondence with the set of all <italic>k</italic>-mers.</p>
      <p id="Par45">Note that the common prefix <italic>w</italic> in a LCP-interval is of length at least <italic>k</italic>, but it could be longer. So, to overcome the limitation of strategies based on LCP-intervals that require to fix the length <italic>k</italic>, the authors of [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR19">19</xref>] introduced a new framework called “positional clustering”. In this framework the intervals do not depend on a value <italic>k</italic> fixed a-priori, but they are enclosed between two “local minima” in the LCP-array (thus, their boundaries are data-driven).</p>
      <p id="Par46">Crucially, the length <italic>k</italic> of the common prefix <italic>w</italic> of the suffixes inside such intervals is not the same, but it differs interval by interval. Hence, there is no one-to-one correspondence between such intervals and the set of <italic>k</italic>-mers.</p>
      <p id="Par47">However, as to exclude intervals corresponding to some short random contexts <italic>w</italic>, one needs to set a minimum length for <italic>w</italic>, which we denote by <inline-formula id="IEq69"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m$$\end{document}</tex-math><mml:math id="M138"><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq69.gif"/></alternatives></inline-formula>.</p>
      <p id="Par48">According to [<xref ref-type="bibr" rid="CR19">19</xref>], an <italic>eBWT positional cluster</italic> eBWTclust[<italic>i</italic>, <italic>j</italic>] is a maximal substring <inline-formula id="IEq70"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} [i,j]$$\end{document}</tex-math><mml:math id="M140"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq70.gif"/></alternatives></inline-formula> where <inline-formula id="IEq71"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} [r] \ge k_m$$\end{document}</tex-math><mml:math id="M142"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>≥</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq71.gif"/></alternatives></inline-formula>, for all <inline-formula id="IEq72"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i&lt; r \le j$$\end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>r</mml:mi><mml:mo>≤</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq72.gif"/></alternatives></inline-formula>, and none of the indices <italic>r</italic>, <inline-formula id="IEq73"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i &lt; r \le j$$\end{document}</tex-math><mml:math id="M146"><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>r</mml:mi><mml:mo>≤</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq73.gif"/></alternatives></inline-formula>, is a <italic>local minimum</italic> of the LCP array.</p>
      <p id="Par49">By definition, we have that:</p>
      <sec id="FPar2">
        <title>Remark 2</title>
        <p id="Par50">Any two different eBWT positional clusters, eBWTclust[<italic>i</italic>, <italic>j</italic>] and eBWTclust <inline-formula id="IEq74"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[i',j']$$\end{document}</tex-math><mml:math id="M148"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq74.gif"/></alternatives></inline-formula>, such that <inline-formula id="IEq75"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i\ne i'$$\end{document}</tex-math><mml:math id="M150"><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq75.gif"/></alternatives></inline-formula> are disjoint, i.e. it holds that either <inline-formula id="IEq76"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j&lt;i'$$\end{document}</tex-math><mml:math id="M152"><mml:mrow><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq76.gif"/></alternatives></inline-formula> or <inline-formula id="IEq77"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j'&lt;i$$\end{document}</tex-math><mml:math id="M154"><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>&lt;</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq77.gif"/></alternatives></inline-formula>.</p>
        <p>Here, we define a local minimum of the LCP array (of length <italic>N</italic>) any index <italic>i</italic>, <inline-formula id="IEq78"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1&lt;i&lt;N$$\end{document}</tex-math><mml:math id="M156"><mml:mrow><mml:mn>1</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq78.gif"/></alternatives></inline-formula> such that <inline-formula id="IEq79"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} [i-1]&gt;\textsf {lcp} [i]$$\end{document}</tex-math><mml:math id="M158"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>&gt;</mml:mo><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq79.gif"/></alternatives></inline-formula> and <inline-formula id="IEq80"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} [i]&lt;\textsf {lcp} [i+j]$$\end{document}</tex-math><mml:math id="M160"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>&lt;</mml:mo><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq80.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq81"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j&gt;1$$\end{document}</tex-math><mml:math id="M162"><mml:mrow><mml:mi>j</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq81.gif"/></alternatives></inline-formula> is the number of adjacent occurrences of the value <inline-formula id="IEq82"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} [i]$$\end{document}</tex-math><mml:math id="M164"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq82.gif"/></alternatives></inline-formula> from position <italic>i</italic>. For instance, let <inline-formula id="IEq83"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} =[2,1,3,3,5,4,2,2,7]$$\end{document}</tex-math><mml:math id="M166"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>7</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq83.gif"/></alternatives></inline-formula>. The local minima are indices 2 and 7, corresponding to LCP values of 1 and 2, respectively.</p>
        <p>Note that the above definition differs from that in [<xref ref-type="bibr" rid="CR19">19</xref>], where local minima in the LCP array (of length <italic>N</italic>) are detected searching for indices <italic>r</italic> such that <inline-formula id="IEq84"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} [r-1] &gt; \textsf {lcp} [r]\le\textsf {lcp} [r+1]$$\end{document}</tex-math><mml:math id="M168"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>&gt;</mml:mo><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>≤</mml:mo><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq84.gif"/></alternatives></inline-formula>, for all <inline-formula id="IEq85"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 &lt; r \le N$$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:mn>1</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>r</mml:mi><mml:mo>≤</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq85.gif"/></alternatives></inline-formula>. According to such definition, local minima can be detected in any non-increasing sequence where some values are repeated. For instance, for the first occurrence of 4 in the sequence 5, 4, 4, 2 yields the definition of local minimum. Therefore, the slightly different notion of local minima we use is to maximize the length of the non-increasing sequence described in the following Remark <xref ref-type="sec" rid="FPar3">3</xref>.</p>
      </sec>
      <sec id="FPar3">
        <title>Remark 3</title>
        <p id="Par53">([<xref ref-type="bibr" rid="CR12">12</xref>, Thm 3.3]) In any eBWT positional cluster, the LCP-value form a sequence of non-decreasing values followed by a (possibly empty) sequence of non-increasing values.</p>
        <p>From the above remark follows that the length <italic>l</italic> of the longest common prefix shared by the suffixes associated with a eBWT positional cluster <inline-formula id="IEq86"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} [i,j]$$\end{document}</tex-math><mml:math id="M172"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq86.gif"/></alternatives></inline-formula> is given by the minimum value in <inline-formula id="IEq87"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} [i+1,j]$$\end{document}</tex-math><mml:math id="M174"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq87.gif"/></alternatives></inline-formula>, which could be simply obtained by taking the minimum between the values <inline-formula id="IEq88"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} [i+1]$$\end{document}</tex-math><mml:math id="M176"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq88.gif"/></alternatives></inline-formula> and <inline-formula id="IEq89"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} [j]$$\end{document}</tex-math><mml:math id="M178"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq89.gif"/></alternatives></inline-formula>.</p>
        <p>In general, if we set the minimum length <inline-formula id="IEq90"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m$$\end{document}</tex-math><mml:math id="M180"><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq90.gif"/></alternatives></inline-formula> equal to <italic>k</italic>, the set of eBWT positional clusters forms a refinement of the set of <inline-formula id="IEq91"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} [i,j]$$\end{document}</tex-math><mml:math id="M182"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq91.gif"/></alternatives></inline-formula> with [<italic>i</italic>, <italic>j</italic>] LCP-interval of LCP-value <italic>k</italic>.</p>
        <p>In fact, any <inline-formula id="IEq92"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} [i,j]$$\end{document}</tex-math><mml:math id="M184"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq92.gif"/></alternatives></inline-formula>, where [<italic>i</italic>, <italic>j</italic>] is a LCP-interval, can be subdivided in correspondence of the local minima of <inline-formula id="IEq93"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} [i,j]$$\end{document}</tex-math><mml:math id="M186"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq93.gif"/></alternatives></inline-formula>, thus giving rise to a sequence of consecutive eBWT positional clusters (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Clearly, such subdivision depends only on the trend of the LCP values inside the LCP-interval [<italic>i</italic>, <italic>j</italic>]. Hence, more than one positional cluster can be related to the same LCP-interval, and equivalently, to the same <italic>k</italic>-mer.<fig id="Fig1"><label>Fig. 1</label><caption><p>Extended Burrows-Wheeler Transform (EBWT), LCP array, and the auxiliary data structures DA and CDA for the set <inline-formula id="IEq94"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S} =$$\end{document}</tex-math><mml:math id="M188"><mml:mrow><mml:mi mathvariant="script">S</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq94.gif"/></alternatives></inline-formula> {GGCGTACCA, ACGAGTACGACT, GGGGCGTATT}</p></caption><graphic xlink:href="13015_2023_232_Fig1_HTML" id="MO1"/></fig></p>
      </sec>
      <sec id="FPar4">
        <title>Example 4</title>
        <p id="Par57">(<italic>running example</italic>) In Fig. <xref rid="Fig1" ref-type="fig">1</xref>, we represent the data structures used in our tool (cda, ebwt, lcp), the auxiliary array da and the sorted list of suffixes, for the sake of clarity. The LCP-intervals of LCP-value <inline-formula id="IEq96"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=1$$\end{document}</tex-math><mml:math id="M190"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq96.gif"/></alternatives></inline-formula> correspond to the following intervals: [4, 10, 11, 17, 18, 28, 29, 34]. Whereas the horizontal lines delimit e<sc>BWTclust</sc> for <inline-formula id="IEq97"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ k_m = 1$$\end{document}</tex-math><mml:math id="M192"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq97.gif"/></alternatives></inline-formula>. Note that when <inline-formula id="IEq98"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m = k$$\end{document}</tex-math><mml:math id="M194"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq98.gif"/></alternatives></inline-formula>, the e<sc>BWTclust</sc> can refine the LCP-intervals. For example the LCP-interval [18, 28] includes five positional clusters: <inline-formula id="IEq99"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{e}{BWTclust}[18,19]$$\end{document}</tex-math><mml:math id="M196"><mml:mrow><mml:mtext>e</mml:mtext><mml:mrow><mml:mi mathvariant="italic">BWTclust</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>18</mml:mn><mml:mo>,</mml:mo><mml:mn>19</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq99.gif"/></alternatives></inline-formula>, <inline-formula id="IEq100"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{e}{BWTclust}[20,21]$$\end{document}</tex-math><mml:math id="M198"><mml:mrow><mml:mtext>e</mml:mtext><mml:mrow><mml:mi mathvariant="italic">BWTclust</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mn>21</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq100.gif"/></alternatives></inline-formula>, <inline-formula id="IEq101"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{e}{BWTclust}[22,23]$$\end{document}</tex-math><mml:math id="M200"><mml:mrow><mml:mtext>e</mml:mtext><mml:mrow><mml:mi mathvariant="italic">BWTclust</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>22</mml:mn><mml:mo>,</mml:mo><mml:mn>23</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq101.gif"/></alternatives></inline-formula>, <inline-formula id="IEq102"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{e}{BWTclust}[24,25]$$\end{document}</tex-math><mml:math id="M202"><mml:mrow><mml:mtext>e</mml:mtext><mml:mrow><mml:mi mathvariant="italic">BWTclust</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>24</mml:mn><mml:mo>,</mml:mo><mml:mn>25</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq102.gif"/></alternatives></inline-formula>, <inline-formula id="IEq103"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{e}{BWTclust}[26,28]$$\end{document}</tex-math><mml:math id="M204"><mml:mrow><mml:mtext>e</mml:mtext><mml:mrow><mml:mi mathvariant="italic">BWTclust</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>26</mml:mn><mml:mo>,</mml:mo><mml:mn>28</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq103.gif"/></alternatives></inline-formula>.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec5">
    <title>Methods</title>
    <p id="Par58">In this section, we describe the proposed method for building a phylogenetic tree where each leaf is a set of strings (sequencing reads, contigs, genome).</p>
    <p id="Par59">The idea behind our method is to reconstruct the tree through a series of refinement steps performed on groups of taxa.</p>
    <p id="Par60">The inner <sc>refinement</sc> algorithm groups together nodes whose associated strings share long common substrings of varying length which are <italic>not</italic> present in other nodes, and we interpret the presence of such substrings as a common feature of the group that differentiates it from the others. As mentioned in the introduction, the method is not restricted to work in a top-down or bottom-up fashion, but can act on several levels at once, according to which ones appear to be most prominent.</p>
    <p id="Par61">The final algorithm, described in Sect. "<xref rid="Sec6" ref-type="sec">Tree reconstruction</xref>", suitably applies <sc>refinement</sc> to portions of the data, and iteratively converges to the reconstructed tree. Here <sc>refinement</sc> is a black box to group taxa, and is described in Sect. "<xref rid="Sec7" ref-type="sec">The refinement procedure</xref>".</p>
    <p id="Par62">Given <inline-formula id="IEq104"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell$$\end{document}</tex-math><mml:math id="M206"><mml:mi>ℓ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq104.gif"/></alternatives></inline-formula> taxa, our method produces an unrooted tree without fixing an outgroup.</p>
    <p id="Par63">For ease of explanation, we describe the method considering the tree as rooted. Indeed, we start from a tree that has <inline-formula id="IEq105"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell +1$$\end{document}</tex-math><mml:math id="M208"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq105.gif"/></alternatives></inline-formula> nodes: one root node, with <inline-formula id="IEq106"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell$$\end{document}</tex-math><mml:math id="M210"><mml:mi>ℓ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq106.gif"/></alternatives></inline-formula> children (one per taxon). Alternatively, we can imagine it as a star tree.</p>
    <p id="Par64">Before describing the reconstruction procedure, we introduce some notation and definitions.</p>
    <p id="Par65">Formally, we denote the set of leaves as <inline-formula id="IEq107"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S} =\{S_1,S_2,\ldots ,S_{\ell }\}$$\end{document}</tex-math><mml:math id="M212"><mml:mrow><mml:mi mathvariant="script">S</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>ℓ</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq107.gif"/></alternatives></inline-formula> where each <inline-formula id="IEq108"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_i$$\end{document}</tex-math><mml:math id="M214"><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq108.gif"/></alternatives></inline-formula> corresponds to a taxon.</p>
    <p id="Par66">The tree <italic>T</italic> is defined as a <italic>partition tree</italic> of the set <inline-formula id="IEq109"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M216"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq109.gif"/></alternatives></inline-formula>:<list list-type="bullet"><list-item><p id="Par67">Each node of <italic>T</italic> corresponds to a nonempty set of taxa <inline-formula id="IEq110"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S' \subseteq \mathcal {S}$$\end{document}</tex-math><mml:math id="M218"><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⊆</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq110.gif"/></alternatives></inline-formula></p></list-item><list-item><p id="Par68">The root of <italic>T</italic> corresponds to <inline-formula id="IEq111"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M220"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq111.gif"/></alternatives></inline-formula></p></list-item><list-item><p id="Par69">Each leaf of <italic>T</italic> corresponds to a distinct taxon <inline-formula id="IEq112"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_i\in \mathcal {S}$$\end{document}</tex-math><mml:math id="M222"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq112.gif"/></alternatives></inline-formula></p></list-item><list-item><p id="Par70">For each node corresponding to <inline-formula id="IEq113"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S'$$\end{document}</tex-math><mml:math id="M224"><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq113.gif"/></alternatives></inline-formula>, its children form a partition of <inline-formula id="IEq114"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S'$$\end{document}</tex-math><mml:math id="M226"><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq114.gif"/></alternatives></inline-formula></p></list-item></list>It is convenient to define the operation of <italic>adding a node</italic> to <italic>T</italic> by a set: a set <inline-formula id="IEq115"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S'\subseteq \mathcal {S}$$\end{document}</tex-math><mml:math id="M228"><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⊆</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq115.gif"/></alternatives></inline-formula> can be added to <italic>T</italic> only if is <italic>compatible</italic>, i.e., if every other node of <italic>T</italic> corresponds to a set <inline-formula id="IEq116"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S''$$\end{document}</tex-math><mml:math id="M230"><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mo>′</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq116.gif"/></alternatives></inline-formula> that satisfies one of these conditions: <inline-formula id="IEq117"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S'' \subset S'$$\end{document}</tex-math><mml:math id="M232"><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mo>′</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>⊂</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq117.gif"/></alternatives></inline-formula>, <inline-formula id="IEq118"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S'' \supset S'$$\end{document}</tex-math><mml:math id="M234"><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mo>′</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>⊃</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq118.gif"/></alternatives></inline-formula>, or <inline-formula id="IEq119"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S'' \cap S' = \emptyset$$\end{document}</tex-math><mml:math id="M236"><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mo>′</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>∩</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mi mathvariant="normal">∅</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq119.gif"/></alternatives></inline-formula> (i.e. no partial overlap between <inline-formula id="IEq120"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S''$$\end{document}</tex-math><mml:math id="M238"><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mo>′</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq120.gif"/></alternatives></inline-formula> and <inline-formula id="IEq121"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S'$$\end{document}</tex-math><mml:math id="M240"><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq121.gif"/></alternatives></inline-formula>). If this is the case, there is only one way to add <inline-formula id="IEq122"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S'$$\end{document}</tex-math><mml:math id="M242"><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq122.gif"/></alternatives></inline-formula> to <italic>T</italic>, namely, <inline-formula id="IEq123"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S'$$\end{document}</tex-math><mml:math id="M244"><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq123.gif"/></alternatives></inline-formula> becomes a child of the smallest set <inline-formula id="IEq124"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P \supset S'$$\end{document}</tex-math><mml:math id="M246"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⊃</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq124.gif"/></alternatives></inline-formula> of <italic>T</italic> (by cardinality), and all the other children of <italic>P</italic> that are contained in <inline-formula id="IEq125"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S'$$\end{document}</tex-math><mml:math id="M248"><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq125.gif"/></alternatives></inline-formula> become the children of <inline-formula id="IEq126"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S'$$\end{document}</tex-math><mml:math id="M250"><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq126.gif"/></alternatives></inline-formula>. It is easy to see that the resulting <italic>T</italic> is still a partition tree.</p>
    <p id="Par71">In our framework, each <inline-formula id="IEq127"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_i$$\end{document}</tex-math><mml:math id="M252"><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq127.gif"/></alternatives></inline-formula> is a collection of strings, as for each taxon we can have multiple strings (like reads, contigs, a genome, and so on) possibly augmented by their reverse-complement, however in the structure of <italic>T</italic> it is just represented as an identifier.</p>
    <p id="Par72">Let <inline-formula id="IEq128"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S} =\{S_1,S_2,\ldots ,S_{\ell }\}$$\end{document}</tex-math><mml:math id="M254"><mml:mrow><mml:mi mathvariant="script">S</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>ℓ</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq128.gif"/></alternatives></inline-formula> and each set <inline-formula id="IEq129"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_i \in \mathcal {S}$$\end{document}</tex-math><mml:math id="M256"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq129.gif"/></alternatives></inline-formula> contain <inline-formula id="IEq130"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_i$$\end{document}</tex-math><mml:math id="M258"><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq130.gif"/></alternatives></inline-formula> strings, i.e. <inline-formula id="IEq131"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_i=\{s_{i,1},\ldots ,s_{i,m_i}\}$$\end{document}</tex-math><mml:math id="M260"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq131.gif"/></alternatives></inline-formula>. Note that the definitions of eBWT, LCP and DA given in Sect. "<xref rid="Sec2" ref-type="sec">Preliminaries</xref>" apply also to this case:<list list-type="bullet"><list-item><p id="Par73"><inline-formula id="IEq132"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} (\mathcal {S})=\textsf {ebwt} (\{S_1,S_2,\ldots ,S_{\ell }\})=\textsf {ebwt} (\{s_{1,1},\ldots ,s_{1,m_1},\ldots ,s_{\ell ,1},\ldots ,s_{\ell ,m_\ell }\})$$\end{document}</tex-math><mml:math id="M262"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>ℓ</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>ℓ</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq132.gif"/></alternatives></inline-formula>,</p></list-item><list-item><p id="Par74"><inline-formula id="IEq133"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} (\mathcal {S})=\textsf {lcp} (\{S_1,S_2,\ldots ,S_{\ell }\})=\textsf {lcp} (\{s_{1,1},\ldots ,$$\end{document}</tex-math><mml:math id="M264"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>ℓ</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">{</mml:mo></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq133.gif"/></alternatives></inline-formula><inline-formula id="IEq134"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_{\ell ,m_\ell }\})$$\end{document}</tex-math><mml:math id="M266"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>ℓ</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">}</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq134.gif"/></alternatives></inline-formula>,</p></list-item><list-item><p id="Par75"><inline-formula id="IEq135"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {da} (\mathcal {S})=\textsf {da} (\{S_1,S_2,\ldots ,S_{\ell }\})=\textsf {da} (\{s_{1,1},\ldots ,s_{\ell ,m_\ell }\})$$\end{document}</tex-math><mml:math id="M268"><mml:mrow><mml:mi mathvariant="sans-serif">da</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="sans-serif">da</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>ℓ</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="sans-serif">da</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>ℓ</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq135.gif"/></alternatives></inline-formula>.</p></list-item></list>For our purposes, we extend the notion of DA to <italic>Color Document Array</italic> (CDA), where <inline-formula id="IEq136"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {cda} (\mathcal {S})[j]=r$$\end{document}</tex-math><mml:math id="M270"><mml:mrow><mml:mi mathvariant="sans-serif">cda</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq136.gif"/></alternatives></inline-formula> if <inline-formula id="IEq137"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {da} (\mathcal {S})[j]=u$$\end{document}</tex-math><mml:math id="M272"><mml:mrow><mml:mi mathvariant="sans-serif">da</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq137.gif"/></alternatives></inline-formula> and <inline-formula id="IEq138"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_u$$\end{document}</tex-math><mml:math id="M274"><mml:msub><mml:mi>s</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq138.gif"/></alternatives></inline-formula> belongs to the set <inline-formula id="IEq139"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_r$$\end{document}</tex-math><mml:math id="M276"><mml:msub><mml:mi>S</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq139.gif"/></alternatives></inline-formula>. In other words, we assign the same color to the strings belonging to the same set <inline-formula id="IEq140"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_r$$\end{document}</tex-math><mml:math id="M278"><mml:msub><mml:mi>S</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq140.gif"/></alternatives></inline-formula>, so we have a distinct color <italic>r</italic> for each set <inline-formula id="IEq141"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_r \in \mathcal {S}$$\end{document}</tex-math><mml:math id="M280"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq141.gif"/></alternatives></inline-formula>.</p>
    <sec id="FPar5">
      <title>Example 5</title>
      <p id="Par76">(running example) In Fig. <xref rid="Fig1" ref-type="fig">1</xref>, cda coincides with da assuming that each taxon is a single string.</p>
    </sec>
    <sec id="Sec6">
      <title>Tree reconstruction</title>
      <p id="Par78">In this subsection we show how our method reconstructs a phylogenetic tree for <inline-formula id="IEq142"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M282"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq142.gif"/></alternatives></inline-formula> by suitably applying <sc>refinement</sc>. We consider <sc>refinement</sc> as a blackbox with the following properties: given a list of sets <inline-formula id="IEq143"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C = C_1,\ldots , C_h$$\end{document}</tex-math><mml:math id="M284"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq143.gif"/></alternatives></inline-formula>, such that any <inline-formula id="IEq144"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_k$$\end{document}</tex-math><mml:math id="M286"><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq144.gif"/></alternatives></inline-formula> is a subset of <inline-formula id="IEq145"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M288"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq145.gif"/></alternatives></inline-formula> and disjoint from all other <inline-formula id="IEq146"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{k'}$$\end{document}</tex-math><mml:math id="M290"><mml:msub><mml:mi>C</mml:mi><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq146.gif"/></alternatives></inline-formula>, for <inline-formula id="IEq147"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 \le k &lt; k' \le h$$\end{document}</tex-math><mml:math id="M292"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>&lt;</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>≤</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq147.gif"/></alternatives></inline-formula>, <sc>refinement</sc> returns a list of sets <inline-formula id="IEq148"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L = L_1,\ldots , L_{|L|}$$\end{document}</tex-math><mml:math id="M294"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq148.gif"/></alternatives></inline-formula> of <italic>compatible subsets</italic> of <inline-formula id="IEq149"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bigcup _k C_k$$\end{document}</tex-math><mml:math id="M296"><mml:mrow><mml:msub><mml:mo>⋃</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq149.gif"/></alternatives></inline-formula>: i.e., each <inline-formula id="IEq150"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_i$$\end{document}</tex-math><mml:math id="M298"><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq150.gif"/></alternatives></inline-formula> is the union of some <inline-formula id="IEq151"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_k$$\end{document}</tex-math><mml:math id="M300"><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq151.gif"/></alternatives></inline-formula>’s, and each <inline-formula id="IEq152"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_i$$\end{document}</tex-math><mml:math id="M302"><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq152.gif"/></alternatives></inline-formula> is either a subset of, a superset of, or disjoint from any other <inline-formula id="IEq153"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_j$$\end{document}</tex-math><mml:math id="M304"><mml:msub><mml:mi>L</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq153.gif"/></alternatives></inline-formula>, for <inline-formula id="IEq154"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 \le i &lt; j \le |L|$$\end{document}</tex-math><mml:math id="M306"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq154.gif"/></alternatives></inline-formula>.</p>
      <p id="Par79">The key idea is that once an intermediate partition tree is obtained, we may take one of its nodes and restrict our attention to just the groups of taxa corresponding to its children (<inline-formula id="IEq155"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_1,\ldots ,C_h$$\end{document}</tex-math><mml:math id="M308"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq155.gif"/></alternatives></inline-formula>) and repeat <sc>refinement</sc>: this allows us to look at the subtree with a greater detail, by restricting the input data structures and changing the ebwt, thus bringing new tree refinements to light. This is repeated until all internal nodes in the partition tree have only two children, or no more refinements can be identified by <sc>refinement</sc>.</p>
      <p id="Par80">Our algorithm is described in Algorithm 1, and one possible iteration is depicted in Fig. <xref rid="Fig2" ref-type="fig">2</xref>.<fig id="Fig2"><label>Fig. 2</label><caption><p>A possible iteration of Algorithm 1 where final nodes are in bold</p></caption><graphic xlink:href="13015_2023_232_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par81">At the beginning we initialize the unrefined partition tree <italic>T</italic> (Line 1) as a rooted star with root <inline-formula id="IEq156"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M310"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq156.gif"/></alternatives></inline-formula> (non-final), and leaves labelled by <inline-formula id="IEq157"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_1,\ldots ,S_\ell$$\end{document}</tex-math><mml:math id="M312"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>ℓ</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq157.gif"/></alternatives></inline-formula> marked as final. As the names suggests, <italic>final</italic> indicates that no more refinement is needed at that node.</p>
      <p id="Par82">The algorithm iteratively processes a non-final node <italic>X</italic> of <italic>T</italic> (Line 3), meaning that its children <inline-formula id="IEq158"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_1,\ldots ,C_h$$\end{document}</tex-math><mml:math id="M314"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq158.gif"/></alternatives></inline-formula> (which correspond to disjoint sets) are fed to <sc>refinement</sc> to create new nodes that further partition the children. All nodes produced with two children are marked final; also, if <sc>refinement</sc> fails to create new nodes, then <italic>X</italic> is marked final.</p>
      <p id="Par83">Line 6 calls the <sc>refinement</sc> function to create a list <italic>L</italic> of compatible subsets of <inline-formula id="IEq159"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X = \bigcup _k C_k$$\end{document}</tex-math><mml:math id="M316"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mo>⋃</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq159.gif"/></alternatives></inline-formula>, and then the <sc>draw_and_mark</sc> function is called to add the corresponding new nodes to <italic>T</italic> (Line 7).
</p>
      <p id="Par84">By the aforementioned assumptions on the sets in <italic>L</italic>, they are always compatible with <italic>T</italic>: each <inline-formula id="IEq160"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_i$$\end{document}</tex-math><mml:math id="M318"><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq160.gif"/></alternatives></inline-formula> is a subset of <italic>X</italic> (and all its ancestors in <italic>T</italic>), it is a superset of some <inline-formula id="IEq161"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_i$$\end{document}</tex-math><mml:math id="M320"><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq161.gif"/></alternatives></inline-formula> (and all their descendants in <italic>T</italic>), and it is disjoint from all other nodes in <italic>T</italic>. Thus, <sc>draw_and_mark</sc> only needs to consider two cases:<list list-type="bullet"><list-item><p id="Par85">Case (<italic>i</italic>) <italic>T</italic> is not changed (i.e. the list <italic>L</italic> is empty): node <italic>X</italic> is marked as final (Line 10).</p></list-item><list-item><p id="Par86">Case (<italic>ii</italic>) <italic>L</italic> is not empty: a new internal node is created for each <inline-formula id="IEq162"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_i\in L$$\end{document}</tex-math><mml:math id="M322"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq162.gif"/></alternatives></inline-formula>, by adding the set <inline-formula id="IEq163"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_i$$\end{document}</tex-math><mml:math id="M324"><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq163.gif"/></alternatives></inline-formula> to the partition tree <italic>T</italic> as described before. A node is marked final if it has only two children; otherwise, it needs to be further refined and is added to the queue (this also applies to the node <italic>X</italic>).</p></list-item></list>Figure <xref rid="Fig2" ref-type="fig">2</xref> depicts the procedure of adding nodes to <italic>T</italic>, while a possible execution of the algorithm is shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>.<graphic position="anchor" xlink:href="13015_2023_232_Figa_HTML" id="MO16"/><fig id="Fig3"><label>Fig. 3</label><caption><p>A possible execution of Algorithm 1 on a set of taxa <inline-formula id="IEq95"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S} = \{1,2,3,4,5,6\}$$\end{document}</tex-math><mml:math id="M326"><mml:mrow><mml:mi mathvariant="script">S</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq95.gif"/></alternatives></inline-formula>. Each panel in the top shows an execution of the <sc>refinement</sc> procedure, with input on top and the list of subsets generated in the bottom. Below, the corresponding refinement of the partition tree, where dashed nodes are non-final. Note how nodes are marked final when they are leaves, or they have 2 children, or <sc>refinement</sc> fails to further cluster their children (see 4, 5, 6 in execution <italic>III</italic>)</p></caption><graphic xlink:href="13015_2023_232_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec7">
      <title>The <sc>refinement</sc> procedure</title>
      <p id="Par87">In this subsection, we describe the approach we use as inner <sc>refinement</sc> function that starting from a set of sibling nodes <inline-formula id="IEq164"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_1,\ldots ,C_h$$\end{document}</tex-math><mml:math id="M328"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq164.gif"/></alternatives></inline-formula> returns a list <italic>L</italic> of compatible subsets. This is a direct evolution of the <inline-formula id="IEq0165"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsc{partition}$$\end{document}</tex-math><mml:math id="M330"><mml:mstyle mathsize="0.6em"><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">O</mml:mi><mml:mi mathvariant="normal">N</mml:mi></mml:mstyle></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq0165.gif"/></alternatives></inline-formula> procedure of phyBWT, that allows to process multiple levels at once.</p>
      <p id="Par88">According to Subsect. "<xref rid="Sec6" ref-type="sec">Tree reconstruction</xref>", the sibling nodes <inline-formula id="IEq165"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_1,\ldots ,C_h$$\end{document}</tex-math><mml:math id="M332"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq165.gif"/></alternatives></inline-formula> of <italic>T</italic> to be refined correspond to some (not necessarily all) taxa: each <inline-formula id="IEq166"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_k$$\end{document}</tex-math><mml:math id="M334"><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq166.gif"/></alternatives></inline-formula> can be either a leaf of <italic>T</italic> (thus corresponding to only one taxon) or an internal node of <italic>T</italic> corresponding to a subset <inline-formula id="IEq167"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S'\subset \mathcal {S}$$\end{document}</tex-math><mml:math id="M336"><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⊂</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq167.gif"/></alternatives></inline-formula>.</p>
      <p id="Par89">We can consider each <inline-formula id="IEq168"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_k$$\end{document}</tex-math><mml:math id="M338"><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq168.gif"/></alternatives></inline-formula> as the set of colors (i.e. the set of taxa) to which it corresponds. Let <inline-formula id="IEq169"><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}=\{C_1,\ldots ,C_h\}$$\end{document}</tex-math><mml:math id="M340"><mml:mrow><mml:mi mathvariant="script">Q</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq169.gif"/></alternatives></inline-formula>. We define a function <inline-formula id="IEq170"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\chi _{\mathcal {Q}}$$\end{document}</tex-math><mml:math id="M342"><mml:msub><mml:mi>χ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq170.gif"/></alternatives></inline-formula> that associates a color <italic>r</italic> (i.e. any taxon in <inline-formula id="IEq171"><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M344"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq171.gif"/></alternatives></inline-formula>) to the element of <inline-formula id="IEq172"><alternatives><tex-math id="M345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}$$\end{document}</tex-math><mml:math id="M346"><mml:mi mathvariant="script">Q</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq172.gif"/></alternatives></inline-formula> to which it belongs (if one exists).</p>
      <sec id="FPar6">
        <title>Definition 6</title>
        <p id="Par90">Given <inline-formula id="IEq173"><alternatives><tex-math id="M347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}=\{C_1,\ldots ,C_h\}$$\end{document}</tex-math><mml:math id="M348"><mml:mrow><mml:mi mathvariant="script">Q</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq173.gif"/></alternatives></inline-formula>, we define <inline-formula id="IEq174"><alternatives><tex-math id="M349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\chi _{\mathcal {Q}}$$\end{document}</tex-math><mml:math id="M350"><mml:msub><mml:mi>χ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq174.gif"/></alternatives></inline-formula> from <inline-formula id="IEq175"><alternatives><tex-math id="M351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{1,\ldots ,\ell \}$$\end{document}</tex-math><mml:math id="M352"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq175.gif"/></alternatives></inline-formula> to <inline-formula id="IEq176"><alternatives><tex-math id="M353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{C_1,\ldots ,C_h\}\cup \{\emptyset \}$$\end{document}</tex-math><mml:math id="M354"><mml:mrow><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>∪</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi mathvariant="normal">∅</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq176.gif"/></alternatives></inline-formula>, such that<disp-formula id="Equ1"><alternatives><tex-math id="M355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \chi _{\mathcal {Q}}(r)= \left\{ \begin{array}{ll} C_k &amp;{} \text {if there exists}\, k\,\text { s.t.}\, r\,\text { belongs to}\, C_k\\ \emptyset &amp;{} \text {otherwise.} \\ \end{array} \right. \end{aligned}$$\end{document}</tex-math><mml:math id="M356" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>if there exists</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>k</mml:mi><mml:mspace width="0.166667em"/><mml:mspace width="0.333333em"/><mml:mtext>s.t.</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>r</mml:mi><mml:mspace width="0.166667em"/><mml:mspace width="0.333333em"/><mml:mtext>belongs to</mml:mtext><mml:mspace width="0.166667em"/><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi mathvariant="normal">∅</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>otherwise.</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13015_2023_232_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Let [<italic>i</italic>, <italic>j</italic>] be a positional cluster. Recall that we denote by eBWTclust[<italic>i</italic>, <italic>j</italic>] the concatenation of the symbols in the eBWT associated with the range [<italic>i</italic>, <italic>j</italic>] (i.e. <inline-formula id="IEq177"><alternatives><tex-math id="M357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} ({\mathcal {S}})[i,j]$$\end{document}</tex-math><mml:math id="M358"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq177.gif"/></alternatives></inline-formula>). Then, for each eBWTclust[<italic>i</italic>, <italic>j</italic>], the corresponding interval in the CDA, <inline-formula id="IEq178"><alternatives><tex-math id="M359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {cda} {(\mathcal {S})}[i,j]$$\end{document}</tex-math><mml:math id="M360"><mml:mrow><mml:mi mathvariant="sans-serif">cda</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq178.gif"/></alternatives></inline-formula>, stores the colors (i.e. indices of the taxa) to which the symbols in eBWTclust[<italic>i</italic>, <italic>j</italic>]  belong.</p>
      </sec>
      <sec id="FPar7">
        <title>Definition 7</title>
        <p id="Par92">An eBWTclust[<italic>i</italic>, <italic>j</italic>] is <inline-formula id="IEq179"><alternatives><tex-math id="M361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M362"><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq179.gif"/></alternatives></inline-formula><italic>-colored</italic> if <inline-formula id="IEq180"><alternatives><tex-math id="M363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M364"><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq180.gif"/></alternatives></inline-formula> is the set of elements of <inline-formula id="IEq181"><alternatives><tex-math id="M365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}$$\end{document}</tex-math><mml:math id="M366"><mml:mi mathvariant="script">Q</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq181.gif"/></alternatives></inline-formula> appearing in <inline-formula id="IEq182"><alternatives><tex-math id="M367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {cda} {(\mathcal {S})}[i,j]$$\end{document}</tex-math><mml:math id="M368"><mml:mrow><mml:mi mathvariant="sans-serif">cda</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq182.gif"/></alternatives></inline-formula>, i.e. <inline-formula id="IEq183"><alternatives><tex-math id="M369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _{\mathcal {Q}}=\{{\chi _{\mathcal {Q}}(r)}\text {: } r\in \textsf {cda} {(\mathcal {S})}[i,j]\}$$\end{document}</tex-math><mml:math id="M370"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mtext>:</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="sans-serif">cda</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq183.gif"/></alternatives></inline-formula>.</p>
        <p>Note that if eBWTclust and CDA are restricted to the strings in <inline-formula id="IEq184"><alternatives><tex-math id="M371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}$$\end{document}</tex-math><mml:math id="M372"><mml:mi mathvariant="script">Q</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq184.gif"/></alternatives></inline-formula> (see Remark <xref ref-type="sec" rid="FPar1">1</xref>), then <inline-formula id="IEq185"><alternatives><tex-math id="M373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M374"><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq185.gif"/></alternatives></inline-formula> contains only non-empty sets.</p>
      </sec>
      <sec id="FPar8">
        <title>Example 8</title>
        <p id="Par94">Let <inline-formula id="IEq186"><alternatives><tex-math id="M375">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}=\{\{1,3,4\},\{2\},\{5\}, \{6\}\}$$\end{document}</tex-math><mml:math id="M376"><mml:mrow><mml:mi mathvariant="script">Q</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>6</mml:mn><mml:mo stretchy="false">}</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq186.gif"/></alternatives></inline-formula> and e<sc>BWTclust</sc>
<inline-formula id="IEq187"><alternatives><tex-math id="M377">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[i,j]=ACAAGT$$\end{document}</tex-math><mml:math id="M378"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>C</mml:mi><mml:mi>A</mml:mi><mml:mi>A</mml:mi><mml:mi>G</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq187.gif"/></alternatives></inline-formula> with <inline-formula id="IEq188"><alternatives><tex-math id="M379">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {cda} [i,j]=[1\ 2\ 1\ 1\ 3\ 3]$$\end{document}</tex-math><mml:math id="M380"><mml:mrow><mml:mi mathvariant="sans-serif">cda</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mspace width="4pt"/><mml:mn>2</mml:mn><mml:mspace width="4pt"/><mml:mn>1</mml:mn><mml:mspace width="4pt"/><mml:mn>1</mml:mn><mml:mspace width="4pt"/><mml:mn>3</mml:mn><mml:mspace width="4pt"/><mml:mn>3</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq188.gif"/></alternatives></inline-formula>. Then, e<sc>BWTclust</sc>[<italic>i</italic>, <italic>j</italic>] is <inline-formula id="IEq189"><alternatives><tex-math id="M381">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M382"><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq189.gif"/></alternatives></inline-formula>-colored and <inline-formula id="IEq190"><alternatives><tex-math id="M383">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathcal {Q}=\{\{1,3,4\},\{2\}\}$$\end{document}</tex-math><mml:math id="M384"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq190.gif"/></alternatives></inline-formula>.</p>
        <p>The main idea is to detect and analyze only eBWT positional clusters associated with left-maximal contexts shared by a sufficiently large number of taxa (but not by all of them).</p>
      </sec>
      <sec id="FPar9">
        <title>Definition 9</title>
        <p id="Par96">A <inline-formula id="IEq191"><alternatives><tex-math id="M385">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M386"><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq191.gif"/></alternatives></inline-formula>-colored eBWTclust[<italic>i</italic>, <italic>j</italic>] is <italic>relevant</italic>, if the following properties hold: <list list-type="simple"><list-item><label>i)</label><p id="Par97"><inline-formula id="IEq192"><alternatives><tex-math id="M387">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} [i,j]$$\end{document}</tex-math><mml:math id="M388"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq192.gif"/></alternatives></inline-formula> is not a concatenation of a same symbol (i.e. it is not a run),</p></list-item><list-item><label>ii)</label><p id="Par98"><inline-formula id="IEq193"><alternatives><tex-math id="M389">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1&lt;\textsf {card} (\gamma _\mathcal {Q})&lt;h$$\end{document}</tex-math><mml:math id="M390"><mml:mrow><mml:mn>1</mml:mn><mml:mo>&lt;</mml:mo><mml:mi mathvariant="sans-serif">card</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq193.gif"/></alternatives></inline-formula>,</p></list-item><list-item><label>iii)</label><p id="Par99"><inline-formula id="IEq194"><alternatives><tex-math id="M391">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {card} (\textsf {cda} [i,j]\cap C_k)\ge \tau \cdot {\textsf {card} (C_k)}$$\end{document}</tex-math><mml:math id="M392"><mml:mrow><mml:mi mathvariant="sans-serif">card</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="sans-serif">cda</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>∩</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≥</mml:mo><mml:mi>τ</mml:mi><mml:mo>·</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">card</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq194.gif"/></alternatives></inline-formula>, for all <inline-formula id="IEq195"><alternatives><tex-math id="M393">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_k\in \gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M394"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq195.gif"/></alternatives></inline-formula> and some <inline-formula id="IEq196"><alternatives><tex-math id="M395">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0&lt;\tau \le 1$$\end{document}</tex-math><mml:math id="M396"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>τ</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq196.gif"/></alternatives></inline-formula>.</p></list-item></list></p>
        <p>In <italic>ii</italic>), we cut off the eBWT positional clusters associated with left-maximal contexts shared by only one element of <inline-formula id="IEq197"><alternatives><tex-math id="M397">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}$$\end{document}</tex-math><mml:math id="M398"><mml:mi mathvariant="script">Q</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq197.gif"/></alternatives></inline-formula> or by all of them. Indeed, such contexts provide no significant information about how to group together elements of <inline-formula id="IEq198"><alternatives><tex-math id="M399">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}$$\end{document}</tex-math><mml:math id="M400"><mml:mi mathvariant="script">Q</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq198.gif"/></alternatives></inline-formula>.
</p>
        <p>In <italic>iii</italic>), we require that any element <inline-formula id="IEq199"><alternatives><tex-math id="M401">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_k$$\end{document}</tex-math><mml:math id="M402"><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq199.gif"/></alternatives></inline-formula> in <inline-formula id="IEq200"><alternatives><tex-math id="M403">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M404"><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq200.gif"/></alternatives></inline-formula> is sufficiently supported, i.e. the number of colors of <inline-formula id="IEq201"><alternatives><tex-math id="M405">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_k$$\end{document}</tex-math><mml:math id="M406"><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq201.gif"/></alternatives></inline-formula> appearing in <inline-formula id="IEq202"><alternatives><tex-math id="M407">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {cda} [i,j]$$\end{document}</tex-math><mml:math id="M408"><mml:mrow><mml:mi mathvariant="sans-serif">cda</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq202.gif"/></alternatives></inline-formula> is “large enough”. Formally, we define a <italic>support threshold</italic>
<inline-formula id="IEq203"><alternatives><tex-math id="M409">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M410"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq203.gif"/></alternatives></inline-formula> (<inline-formula id="IEq204"><alternatives><tex-math id="M411">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0&lt;\tau \le 1$$\end{document}</tex-math><mml:math id="M412"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>τ</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq204.gif"/></alternatives></inline-formula>) that determines the minimum required portion for each <inline-formula id="IEq205"><alternatives><tex-math id="M413">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_k\in \gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M414"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq205.gif"/></alternatives></inline-formula> to be in <inline-formula id="IEq206"><alternatives><tex-math id="M415">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {cda} [i,j]$$\end{document}</tex-math><mml:math id="M416"><mml:mrow><mml:mi mathvariant="sans-serif">cda</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq206.gif"/></alternatives></inline-formula>. Intuitively, the support threshold guarantees that all the elements of <inline-formula id="IEq207"><alternatives><tex-math id="M417">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}$$\end{document}</tex-math><mml:math id="M418"><mml:mi mathvariant="script">Q</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq207.gif"/></alternatives></inline-formula> appearing in any eBWTclust[<italic>i</italic>, <italic>j</italic>] are sufficiently represented. In fact, when <inline-formula id="IEq208"><alternatives><tex-math id="M419">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M420"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq208.gif"/></alternatives></inline-formula> approaches the value of 1, all the elements of the subset <inline-formula id="IEq209"><alternatives><tex-math id="M421">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_k$$\end{document}</tex-math><mml:math id="M422"><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq209.gif"/></alternatives></inline-formula> are required to be in the cluster. In other words, we aim at measuring how similar the shared history of the phylogeny is in terms of common substrings. On the other hand, when <inline-formula id="IEq210"><alternatives><tex-math id="M423">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M424"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq210.gif"/></alternatives></inline-formula> approaches the value of 0, at least one of the elements of the subset <inline-formula id="IEq211"><alternatives><tex-math id="M425">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_k$$\end{document}</tex-math><mml:math id="M426"><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq211.gif"/></alternatives></inline-formula> is required to be in the cluster considered. Thus, we are observing how similar all the evolution events are. That provides two different viewpoints of their phylogenetic relationships.</p>
      </sec>
      <sec id="FPar10">
        <title>Example 10</title>
        <p id="Par102">(Continued from Example <xref ref-type="sec" rid="FPar8">8</xref>) Let <inline-formula id="IEq212"><alternatives><tex-math id="M427">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}=\{\{1,3,4\},\{2\},\{5\}, \{6\}\}$$\end{document}</tex-math><mml:math id="M428"><mml:mrow><mml:mi mathvariant="script">Q</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>6</mml:mn><mml:mo stretchy="false">}</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq212.gif"/></alternatives></inline-formula> and <inline-formula id="IEq213"><alternatives><tex-math id="M429">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau =0.5$$\end{document}</tex-math><mml:math id="M430"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq213.gif"/></alternatives></inline-formula>. The e<sc>BWTclust</sc>
<inline-formula id="IEq214"><alternatives><tex-math id="M431">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[i,j]=ACAAGT$$\end{document}</tex-math><mml:math id="M432"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>C</mml:mi><mml:mi>A</mml:mi><mml:mi>A</mml:mi><mml:mi>G</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq214.gif"/></alternatives></inline-formula> with <inline-formula id="IEq215"><alternatives><tex-math id="M433">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {cda} [i,j]=[1\ 2\ 1\ 1\ 3\ 3]$$\end{document}</tex-math><mml:math id="M434"><mml:mrow><mml:mi mathvariant="sans-serif">cda</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mspace width="4pt"/><mml:mn>2</mml:mn><mml:mspace width="4pt"/><mml:mn>1</mml:mn><mml:mspace width="4pt"/><mml:mn>1</mml:mn><mml:mspace width="4pt"/><mml:mn>3</mml:mn><mml:mspace width="4pt"/><mml:mn>3</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq215.gif"/></alternatives></inline-formula> is a relevant cluster, since for any element of <inline-formula id="IEq216"><alternatives><tex-math id="M435">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M436"><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq216.gif"/></alternatives></inline-formula>, its portion in <inline-formula id="IEq217"><alternatives><tex-math id="M437">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {cda} [i,j]$$\end{document}</tex-math><mml:math id="M438"><mml:mrow><mml:mi mathvariant="sans-serif">cda</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq217.gif"/></alternatives></inline-formula> is above <inline-formula id="IEq218"><alternatives><tex-math id="M439">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau $$\end{document}</tex-math><mml:math id="M440"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq218.gif"/></alternatives></inline-formula>.</p>
      </sec>
      <sec id="FPar11">
        <title>Example 11</title>
        <p id="Par103">(running example) We highlight in bold, in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, the relevant e<sc>BWTclust</sc>, that are e<sc>BWTclust</sc>[11, 14] and e<sc>BWTclust</sc>[22, 23]. Every other e<sc>BWTclust</sc> is either a run of a same symbol or the associated <inline-formula id="IEq219"><alternatives><tex-math id="M441">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {cda} $$\end{document}</tex-math><mml:math id="M442"><mml:mi mathvariant="sans-serif">cda</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq219.gif"/></alternatives></inline-formula> contains only one color or all of them.</p>
        <p>Now, we use the notion of relevant eBWTclust to obtain a list of compatible subsets of <inline-formula id="IEq220"><alternatives><tex-math id="M443">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}=\{C_1,\ldots ,C_h\}$$\end{document}</tex-math><mml:math id="M444"><mml:mrow><mml:mi mathvariant="script">Q</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq220.gif"/></alternatives></inline-formula>, having size at most <inline-formula id="IEq221"><alternatives><tex-math id="M445">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h-1$$\end{document}</tex-math><mml:math id="M446"><mml:mrow><mml:mi>h</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq221.gif"/></alternatives></inline-formula>.</p>
        <p>The whole strategy is summarized in the following three steps: <list list-type="order"><list-item><p id="Par106">Scan input data structures computed on <inline-formula id="IEq222"><alternatives><tex-math id="M447">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {\mathcal {S}}$$\end{document}</tex-math><mml:math id="M448"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq222.gif"/></alternatives></inline-formula>, and detect only the relevant eBWTclust of the restricted <inline-formula id="IEq223"><alternatives><tex-math id="M449">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {eBWT} (\mathcal {\mathcal {S}})|_{Q}$$\end{document}</tex-math><mml:math id="M450"><mml:msub><mml:mrow><mml:mtext>eBWT</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq223.gif"/></alternatives></inline-formula> (denoted by e<sc>BWTclust</sc>
<inline-formula id="IEq224"><alternatives><tex-math id="M451">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{\mathcal {Q}}[i,j]$$\end{document}</tex-math><mml:math id="M452"><mml:mrow><mml:msub><mml:mrow/><mml:mi mathvariant="script">Q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq224.gif"/></alternatives></inline-formula>, for some <inline-formula id="IEq225"><alternatives><tex-math id="M453">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i&lt;j$$\end{document}</tex-math><mml:math id="M454"><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq225.gif"/></alternatives></inline-formula>).</p></list-item><list-item><p id="Par107">For each eBWTclust <inline-formula id="IEq226"><alternatives><tex-math id="M455">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{\mathcal {Q}}[i,j]$$\end{document}</tex-math><mml:math id="M456"><mml:mrow><mml:msub><mml:mrow/><mml:mi mathvariant="script">Q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq226.gif"/></alternatives></inline-formula>, incrementally assign a score to the subset of <inline-formula id="IEq227"><alternatives><tex-math id="M457">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}$$\end{document}</tex-math><mml:math id="M458"><mml:mi mathvariant="script">Q</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq227.gif"/></alternatives></inline-formula> corresponding to <inline-formula id="IEq228"><alternatives><tex-math id="M459">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M460"><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq228.gif"/></alternatives></inline-formula>. Intuitively, we use the score to determine the order in which the subsets of <inline-formula id="IEq229"><alternatives><tex-math id="M461">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}$$\end{document}</tex-math><mml:math id="M462"><mml:mi mathvariant="script">Q</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq229.gif"/></alternatives></inline-formula> must be processed to output the list <italic>L</italic>.</p></list-item><list-item><p id="Par108">Output <italic>L</italic> by selecting <italic>compatible</italic> subsets of <inline-formula id="IEq230"><alternatives><tex-math id="M463">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}$$\end{document}</tex-math><mml:math id="M464"><mml:mi mathvariant="script">Q</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq230.gif"/></alternatives></inline-formula> that record the highest scores.</p></list-item></list>By Remark <xref ref-type="sec" rid="FPar1">1</xref>, any relevant eBWTclust <inline-formula id="IEq231"><alternatives><tex-math id="M465">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{\mathcal {Q}}$$\end{document}</tex-math><mml:math id="M466"><mml:msub><mml:mrow/><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq231.gif"/></alternatives></inline-formula> detected at the first step can be inferred by a linear scan of the input data structures <inline-formula id="IEq232"><alternatives><tex-math id="M467">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} (\mathcal {S}),\textsf {lcp} (\mathcal {S}),\textsf {cda} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M468"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="sans-serif">cda</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq232.gif"/></alternatives></inline-formula>.</p>
        <p>In general, any <inline-formula id="IEq233"><alternatives><tex-math id="M469">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M470"><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq233.gif"/></alternatives></inline-formula>-colored eBWTclust <inline-formula id="IEq234"><alternatives><tex-math id="M471">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{\mathcal {Q}}[i,j]$$\end{document}</tex-math><mml:math id="M472"><mml:mrow><mml:msub><mml:mrow/><mml:mi mathvariant="script">Q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq234.gif"/></alternatives></inline-formula> may not be relevant, and thus, it does not provide a score to its corresponding subset <inline-formula id="IEq235"><alternatives><tex-math id="M473">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M474"><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq235.gif"/></alternatives></inline-formula>. In our framework, each relevant eBWTclust <inline-formula id="IEq236"><alternatives><tex-math id="M475">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{\mathcal {Q}}[i,j]$$\end{document}</tex-math><mml:math id="M476"><mml:mrow><mml:msub><mml:mrow/><mml:mi mathvariant="script">Q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq236.gif"/></alternatives></inline-formula> contributes to the score of the subset <inline-formula id="IEq237"><alternatives><tex-math id="M477">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M478"><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq237.gif"/></alternatives></inline-formula> by one.</p>
        <p>Steps 1 and 2 are in fact performed simultaneously, and only subsets of <inline-formula id="IEq238"><alternatives><tex-math id="M479">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}$$\end{document}</tex-math><mml:math id="M480"><mml:mi mathvariant="script">Q</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq238.gif"/></alternatives></inline-formula> that provide at least one score are accounted for (without considering all the <inline-formula id="IEq239"><alternatives><tex-math id="M481">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2^h$$\end{document}</tex-math><mml:math id="M482"><mml:msup><mml:mn>2</mml:mn><mml:mi>h</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq239.gif"/></alternatives></inline-formula> possibilities).</p>
        <p>To build up the list <italic>L</italic> we greedily select the subsets of <inline-formula id="IEq240"><alternatives><tex-math id="M483">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}$$\end{document}</tex-math><mml:math id="M484"><mml:mi mathvariant="script">Q</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq240.gif"/></alternatives></inline-formula> having a high score and that are compatible with each other. In particular, we first order the subsets obtained by the positional clustering by their score, and then, by scanning the sorted scores we consider subsets one-by-one. For each <inline-formula id="IEq241"><alternatives><tex-math id="M485">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M486"><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq241.gif"/></alternatives></inline-formula> we compute the subset <inline-formula id="IEq242"><alternatives><tex-math id="M487">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U = \bigcup \gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M488"><mml:mrow><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:mo>⋃</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq242.gif"/></alternatives></inline-formula>, and add it to <italic>L</italic> if it is compatible with what added so far (i.e., a subset of, superset of or disjoint from all elements in <italic>L</italic>).</p>
      </sec>
      <sec id="FPar12">
        <title>Example 12</title>
        <p id="Par112">(Continued from Example <xref ref-type="sec" rid="FPar10">10</xref>) Suppose <inline-formula id="IEq243"><alternatives><tex-math id="M489">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathcal {Q}=\{\{1,3,4\},\{2\}\}$$\end{document}</tex-math><mml:math id="M490"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq243.gif"/></alternatives></inline-formula> is found to be compatible with what we have added to <italic>L</italic> so far. Then we add the set <inline-formula id="IEq244"><alternatives><tex-math id="M491">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U = \{1,3,4\}\cup \{2\} = \{1,2,3,4\}$$\end{document}</tex-math><mml:math id="M492"><mml:mrow><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">}</mml:mo><mml:mo>∪</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">}</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq244.gif"/></alternatives></inline-formula> to <italic>L</italic>.</p>
        <p>We stop adding subsets to <italic>L</italic> in some cases: </p>
        <p><italic>i</italic>) the maximum possible number of elements is reached (that is <inline-formula id="IEq245"><alternatives><tex-math id="M493">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h-2$$\end{document}</tex-math><mml:math id="M494"><mml:mrow><mml:mi>h</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq245.gif"/></alternatives></inline-formula>), </p>
        <p><italic>ii</italic>) the score decreases too much with respect to the highest score (e.g. two order of magnitude lower than the highest score) meaning that the subset associated is not trustworthy, </p>
        <p><italic>iii</italic>) the number of consecutive unsuccessful attempts to add elements to <italic>L</italic> exceeds a threshold value <italic>f</italic> (we set this as <inline-formula id="IEq246"><alternatives><tex-math id="M495">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\min \{2h,100\}$$\end{document}</tex-math><mml:math id="M496"><mml:mrow><mml:mo movablelimits="true">min</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>2</mml:mn><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mn>100</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq246.gif"/></alternatives></inline-formula>, so that it scales with the size of the instance, with the limit of 100 to prevent excessive degeneration of quality).</p>
      </sec>
    </sec>
    <sec id="Sec8">
      <title>Complexity</title>
      <p id="Par114">We observe here how the pre-processing step of our method, which consists in building the eBWT, LCP and DA data structures, can be computed in time and space linear in the number <italic>N</italic> of all symbols of the strings in <inline-formula id="IEq247"><alternatives><tex-math id="M497">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M498"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq247.gif"/></alternatives></inline-formula>.</p>
      <p id="Par115">The <sc>refinement</sc> procedure described in Subsect. "<xref rid="Sec7" ref-type="sec">The refinement procedure</xref>" can be computed in <italic>O</italic>(<italic>N</italic>) time and space: Indeed, given <inline-formula id="IEq248"><alternatives><tex-math id="M499">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}=\{C_1,...,C_h\}$$\end{document}</tex-math><mml:math id="M500"><mml:mrow><mml:mi mathvariant="script">Q</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq248.gif"/></alternatives></inline-formula> and <inline-formula id="IEq249"><alternatives><tex-math id="M501">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X=\bigcup \{C_1,...,C_h\}$$\end{document}</tex-math><mml:math id="M502"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mo>⋃</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq249.gif"/></alternatives></inline-formula>, the eBWT (resp. LCP and CDA) for <inline-formula id="IEq250"><alternatives><tex-math id="M503">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X\subseteq \mathcal {S}$$\end{document}</tex-math><mml:math id="M504"><mml:mrow><mml:mi>X</mml:mi><mml:mo>⊆</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq250.gif"/></alternatives></inline-formula> can be deduced in linear time in the length <italic>N</italic> of <inline-formula id="IEq251"><alternatives><tex-math id="M505">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M506"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq251.gif"/></alternatives></inline-formula> (resp. <inline-formula id="IEq252"><alternatives><tex-math id="M507">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M508"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq252.gif"/></alternatives></inline-formula> and <inline-formula id="IEq253"><alternatives><tex-math id="M509">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {cda} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M510"><mml:mrow><mml:mi mathvariant="sans-serif">cda</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq253.gif"/></alternatives></inline-formula>), including at the same time the detection of all positional clusters [<xref ref-type="bibr" rid="CR12">12</xref>]. Given an element of a eBWTclust[<italic>i</italic>, <italic>j</italic>] and <inline-formula id="IEq254"><alternatives><tex-math id="M511">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M512"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq254.gif"/></alternatives></inline-formula>, we can determine in <italic>O</italic>(1) time its color using the CDA; as we can pre-compute the size of all <inline-formula id="IEq255"><alternatives><tex-math id="M513">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_i$$\end{document}</tex-math><mml:math id="M514"><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq255.gif"/></alternatives></inline-formula>, this lets us easily determine the <inline-formula id="IEq256"><alternatives><tex-math id="M515">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M516"><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq256.gif"/></alternatives></inline-formula>-coloring of the cluster and whether it is relevant or not (Definitions <xref ref-type="sec" rid="FPar7">7</xref> and <xref ref-type="sec" rid="FPar9">9</xref>) in time proportional to the cluster’s length. Overall, detecting positional clusters and assigning scores to subsets of <inline-formula id="IEq257"><alternatives><tex-math id="M517">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}$$\end{document}</tex-math><mml:math id="M518"><mml:mi mathvariant="script">Q</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq257.gif"/></alternatives></inline-formula> has a total cost of <italic>O</italic>(<italic>N</italic>) time.</p>
      <p id="Par116">While potentially there could be up to <inline-formula id="IEq258"><alternatives><tex-math id="M519">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2^h \le 2^\ell$$\end{document}</tex-math><mml:math id="M520"><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mi>h</mml:mi></mml:msup><mml:mo>≤</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>ℓ</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq258.gif"/></alternatives></inline-formula> possible subsets of <inline-formula id="IEq259"><alternatives><tex-math id="M521">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}$$\end{document}</tex-math><mml:math id="M522"><mml:mi mathvariant="script">Q</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq259.gif"/></alternatives></inline-formula>, we observe that each positional cluster can in fact define <italic>at most</italic> one of them, of size not greater than the length of the cluster. It follows that the list of subsets of <inline-formula id="IEq260"><alternatives><tex-math id="M523">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}$$\end{document}</tex-math><mml:math id="M524"><mml:mi mathvariant="script">Q</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq260.gif"/></alternatives></inline-formula>, from which we select the elements of <italic>L</italic>, has <inline-formula id="IEq261"><alternatives><tex-math id="M525">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;N$$\end{document}</tex-math><mml:math id="M526"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq261.gif"/></alternatives></inline-formula> elements, and the sum of their sizes is too at most <italic>N</italic>.</p>
      <p id="Par117">Next, the algorithm sorts by score the subsets of <inline-formula id="IEq262"><alternatives><tex-math id="M527">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}$$\end{document}</tex-math><mml:math id="M528"><mml:mi mathvariant="script">Q</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq262.gif"/></alternatives></inline-formula> found by the positional clustering, which using a bucket sort takes <italic>O</italic>(<italic>N</italic>) time. Finally, we need to scan the sorted subsets as to obtain the output list <italic>L</italic> of compatible subsets, and insert new nodes in the partition tree <italic>T</italic> (<sc>draw_and_mark</sc> procedure).</p>
      <p id="Par118">To check whether a subset <inline-formula id="IEq263"><alternatives><tex-math id="M529">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q'\subseteq \mathcal {Q}$$\end{document}</tex-math><mml:math id="M530"><mml:mrow><mml:msup><mml:mi>Q</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⊆</mml:mo><mml:mi mathvariant="script">Q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq263.gif"/></alternatives></inline-formula> is compatible with the ones inserted in <italic>T</italic> so far, we proceed as follows: taken any element <inline-formula id="IEq264"><alternatives><tex-math id="M531">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y\in Q'$$\end{document}</tex-math><mml:math id="M532"><mml:mrow><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq264.gif"/></alternatives></inline-formula>, take the leaf-to-root path from <italic>y</italic> to the root,<xref ref-type="fn" rid="Fn3">3</xref> and consider for each node the cardinality of its set. If <inline-formula id="IEq265"><alternatives><tex-math id="M533">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q'$$\end{document}</tex-math><mml:math id="M534"><mml:msup><mml:mi>Q</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq265.gif"/></alternatives></inline-formula> is compatible, it must be inserted at one specific point in this path, i.e., where the cardinality of the lower node is <inline-formula id="IEq266"><alternatives><tex-math id="M535">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt; |Q'|$$\end{document}</tex-math><mml:math id="M536"><mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>Q</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq266.gif"/></alternatives></inline-formula> and that of the upper node is <inline-formula id="IEq267"><alternatives><tex-math id="M537">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt;|Q'|$$\end{document}</tex-math><mml:math id="M538"><mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>Q</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq267.gif"/></alternatives></inline-formula> (the path has length <inline-formula id="IEq268"><alternatives><tex-math id="M539">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le \ell$$\end{document}</tex-math><mml:math id="M540"><mml:mrow><mml:mo>≤</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq268.gif"/></alternatives></inline-formula> and we only need to scan it once to find the spot, so this can be obtained in <inline-formula id="IEq269"><alternatives><tex-math id="M541">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\ell )$$\end{document}</tex-math><mml:math id="M542"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq269.gif"/></alternatives></inline-formula> time). At this point, we identified the potential parent <italic>P</italic> of <inline-formula id="IEq270"><alternatives><tex-math id="M543">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q'$$\end{document}</tex-math><mml:math id="M544"><mml:msup><mml:mi>Q</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq270.gif"/></alternatives></inline-formula>, and we only need to verify that indeed <inline-formula id="IEq271"><alternatives><tex-math id="M545">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q'\subset P$$\end{document}</tex-math><mml:math id="M546"><mml:mrow><mml:msup><mml:mi>Q</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⊂</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq271.gif"/></alternatives></inline-formula> (<italic>O</italic>(|<italic>P</italic>|) time), and that, for each child <inline-formula id="IEq272"><alternatives><tex-math id="M547">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_i$$\end{document}</tex-math><mml:math id="M548"><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq272.gif"/></alternatives></inline-formula> of <italic>P</italic>, either <inline-formula id="IEq273"><alternatives><tex-math id="M549">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_i\subset Q'$$\end{document}</tex-math><mml:math id="M550"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⊂</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq273.gif"/></alternatives></inline-formula> or <inline-formula id="IEq274"><alternatives><tex-math id="M551">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|P\cap Q'| = 0$$\end{document}</tex-math><mml:math id="M552"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>P</mml:mi><mml:mo>∩</mml:mo></mml:mrow><mml:msup><mml:mi>Q</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq274.gif"/></alternatives></inline-formula>; this latter step also takes <inline-formula id="IEq275"><alternatives><tex-math id="M553">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\sum |Q'|) = O(|P|)$$\end{document}</tex-math><mml:math id="M554"><mml:mrow><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>∑</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>Q</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq275.gif"/></alternatives></inline-formula> time, with <inline-formula id="IEq276"><alternatives><tex-math id="M555">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|P|\le \ell$$\end{document}</tex-math><mml:math id="M556"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>≤</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq276.gif"/></alternatives></inline-formula> since <inline-formula id="IEq277"><alternatives><tex-math id="M557">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\subseteq \mathcal {S}$$\end{document}</tex-math><mml:math id="M558"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⊆</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq277.gif"/></alternatives></inline-formula>. This means we can identify whether <inline-formula id="IEq278"><alternatives><tex-math id="M559">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q'$$\end{document}</tex-math><mml:math id="M560"><mml:msup><mml:mi>Q</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq278.gif"/></alternatives></inline-formula> is compatible, and in case already identify the nodes that should become children of <inline-formula id="IEq279"><alternatives><tex-math id="M561">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q'$$\end{document}</tex-math><mml:math id="M562"><mml:msup><mml:mi>Q</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq279.gif"/></alternatives></inline-formula>, in <inline-formula id="IEq280"><alternatives><tex-math id="M563">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\ell )$$\end{document}</tex-math><mml:math id="M564"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq280.gif"/></alternatives></inline-formula> time.</p>
      <p id="Par120">Since the maximum number of subsets we analyze from the sorted list is limited by <inline-formula id="IEq281"><alternatives><tex-math id="M565">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f\cdot s$$\end{document}</tex-math><mml:math id="M566"><mml:mrow><mml:mi>f</mml:mi><mml:mo>·</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq281.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq282"><alternatives><tex-math id="M567">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s\le h$$\end{document}</tex-math><mml:math id="M568"><mml:mrow><mml:mi>s</mml:mi><mml:mo>≤</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq282.gif"/></alternatives></inline-formula> is the number of successful insertions in <italic>L</italic>, and <italic>f</italic> the limit of consecutive failures allowed, the total cost of this step is <inline-formula id="IEq283"><alternatives><tex-math id="M569">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(fs\ell )$$\end{document}</tex-math><mml:math id="M570"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mi>s</mml:mi><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq283.gif"/></alternatives></inline-formula>, meaning that the total cost of each execution of <sc>refinement</sc> is <inline-formula id="IEq284"><alternatives><tex-math id="M571">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(N+fs\ell )$$\end{document}</tex-math><mml:math id="M572"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mi>s</mml:mi><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq284.gif"/></alternatives></inline-formula>.</p>
      <p id="Par121">The number of executions of <sc>refinement</sc> is bounded by the final number of nodes in <italic>T</italic>, that is <inline-formula id="IEq285"><alternatives><tex-math id="M573">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\ell )$$\end{document}</tex-math><mml:math id="M574"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq285.gif"/></alternatives></inline-formula>. Furthermore, the total cost of the <inline-formula id="IEq286"><alternatives><tex-math id="M575">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(fs\ell )$$\end{document}</tex-math><mml:math id="M576"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mi>s</mml:mi><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq286.gif"/></alternatives></inline-formula> factors can be amortized to <inline-formula id="IEq287"><alternatives><tex-math id="M577">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(f\ell ^2)$$\end{document}</tex-math><mml:math id="M578"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:msup><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq287.gif"/></alternatives></inline-formula> in that only up to <inline-formula id="IEq288"><alternatives><tex-math id="M579">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell$$\end{document}</tex-math><mml:math id="M580"><mml:mi>ℓ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq288.gif"/></alternatives></inline-formula> successful insertions can be performed in total on <italic>T</italic>. It follows that the total cost is bounded by <inline-formula id="IEq289"><alternatives><tex-math id="M581">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(N\ell + f\ell ^2)$$\end{document}</tex-math><mml:math id="M582"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mi>ℓ</mml:mi><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:msup><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq289.gif"/></alternatives></inline-formula>. Finally, as <italic>f</italic> is a constant (no greater than 100) and <inline-formula id="IEq290"><alternatives><tex-math id="M583">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell \le N$$\end{document}</tex-math><mml:math id="M584"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>≤</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq290.gif"/></alternatives></inline-formula> since each taxon has a positive length, we have <inline-formula id="IEq291"><alternatives><tex-math id="M585">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(N\ell + f\ell ^2) = O(N\ell )$$\end{document}</tex-math><mml:math id="M586"><mml:mrow><mml:mi>O</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mi>ℓ</mml:mi><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:msup><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq291.gif"/></alternatives></inline-formula>.</p>
      <p id="Par122">As for the space requirement, it is that of <sc>refinement</sc> plus the maximum size of the Queue and the tree <italic>T</italic>: <sc>refinement</sc> requires <italic>O</italic>(<italic>N</italic>) space for the ebwt structures; the Queue only holds up to <inline-formula id="IEq292"><alternatives><tex-math id="M587">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell$$\end{document}</tex-math><mml:math id="M588"><mml:mi>ℓ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq292.gif"/></alternatives></inline-formula> pointers to the tree <italic>T</italic>, and the latter tree has <inline-formula id="IEq293"><alternatives><tex-math id="M589">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\ell )$$\end{document}</tex-math><mml:math id="M590"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq293.gif"/></alternatives></inline-formula> nodes each of size <inline-formula id="IEq294"><alternatives><tex-math id="M591">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\ell )$$\end{document}</tex-math><mml:math id="M592"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq294.gif"/></alternatives></inline-formula>. The following holds:</p>
      <sec id="FPar13">
        <title>Lemma 13</title>
        <p id="Par123">Given a set <inline-formula id="IEq295"><alternatives><tex-math id="M593">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M594"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq295.gif"/></alternatives></inline-formula> of <inline-formula id="IEq296"><alternatives><tex-math id="M595">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell$$\end{document}</tex-math><mml:math id="M596"><mml:mi>ℓ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq296.gif"/></alternatives></inline-formula> taxa, whose total length is <italic>N</italic>, phyBWT2 reconstructs a phylogenetic tree for <inline-formula id="IEq297"><alternatives><tex-math id="M597">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M598"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq297.gif"/></alternatives></inline-formula> in <inline-formula id="IEq298"><alternatives><tex-math id="M599">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(N\ell )$$\end{document}</tex-math><mml:math id="M600"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq298.gif"/></alternatives></inline-formula> time and <inline-formula id="IEq299"><alternatives><tex-math id="M601">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(N + \ell ^2)$$\end{document}</tex-math><mml:math id="M602"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq299.gif"/></alternatives></inline-formula> space.</p>
        <p>We observe that <italic>N</italic> is the dominant factor in this complexity, as the length of the strings representing a taxon is -in known applications- many orders of magnitude greater than the number <inline-formula id="IEq300"><alternatives><tex-math id="M603">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell$$\end{document}</tex-math><mml:math id="M604"><mml:mi>ℓ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq300.gif"/></alternatives></inline-formula> of taxa.</p>
        <p>Furthermore, <inline-formula id="IEq301"><alternatives><tex-math id="M605">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(N\ell )$$\end{document}</tex-math><mml:math id="M606"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq301.gif"/></alternatives></inline-formula> time corresponds to the worst case in which the <sc>refinement</sc> procedure only generates one new node each time. As <sc>refinement</sc> is able to create nodes on various levels at once, this is not the expected behaviour: as showcased in Sect. "<xref rid="Sec9" ref-type="sec">Experimental evaluation</xref>" the number of calls of the <sc>refinement</sc> procedure is far less than <inline-formula id="IEq302"><alternatives><tex-math id="M607">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell$$\end{document}</tex-math><mml:math id="M608"><mml:mi>ℓ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq302.gif"/></alternatives></inline-formula> in practice.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Experimental evaluation</title>
    <p id="Par126">In this section we test the performance of phyBWT2 for reconstructing phylogenetic trees from short-reads and de novo assembled sequences. Indeed, as for the previous version phyBWT, its usage is not limited to a particular type of input since both types of data are accepted as input. However, the diversity between the two type of input data requires a tuning of the parameters (<inline-formula id="IEq303"><alternatives><tex-math id="M609">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{min}$$\end{document}</tex-math><mml:math id="M610"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="italic">min</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq303.gif"/></alternatives></inline-formula> and <inline-formula id="IEq304"><alternatives><tex-math id="M611">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M612"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq304.gif"/></alternatives></inline-formula>).</p>
    <p id="Par127">For comparison, we selected the recently introduced tool SANS [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR25">25</xref>] since it shares several features with phyBWT2: both are whole-genome based, alignment- and reference-free approaches for phylogenetic reconstruction that do not use or produce pairwise comparisons of the sequences or their characteristics. We used the latest version<xref ref-type="fn" rid="Fn4">4</xref> of SANS [<xref ref-type="bibr" rid="CR25">25</xref>], a stand-alone re-implementation of the theoretical approach presented in [<xref ref-type="bibr" rid="CR24">24</xref>] that improves both running time and memory usage.</p>
    <p id="Par129">Differently from phyBWT2, SANS is based on the construction of a list of splits obtained by computing all the <italic>k</italic>-mers of the dataset, which are either directly extracted or stored in a colored de Bruijn graph. Thus, it requires to fix a-priori the value <italic>k</italic>. Then, the list of splits is post-processed according to filtering strategies (options proposed in SplitsTree [<xref ref-type="bibr" rid="CR26">26</xref>]) that allow to limit the output splits in order to show phylogenetic networks or to calculate a subset of them representing a tree. For the sake of comparison, we applied to SANS the last filtering approach for drawing trees.</p>
    <p id="Par130">In our experiments, in order to improve the sensitivity of our tool (note that SANS performs implicitly this step by adding the reverse-complement of the k-mers), we added the reverse-complement of the strings to each set of taxa.</p>
    <p id="Par131"><italic>Implementation</italic> Our tool has been implemented in C++. All tests were done on a DELL PowerEdge R750 machine, used in non exclusive mode. Our platform is a 24-core machine with 2 Intel(R) Xeon(R) Gold 5318Y 24C/48T CPUs at 2.10 GHz, with 629 GB. The system is Ubuntu 22.04.1 LTS.</p>
    <p id="Par132"><italic>Input and Output</italic> phyBWT2 takes as input ebwt (<inline-formula id="IEq305"><alternatives><tex-math id="M613">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M614"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq305.gif"/></alternatives></inline-formula>), lcp (<inline-formula id="IEq306"><alternatives><tex-math id="M615">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M616"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq306.gif"/></alternatives></inline-formula>) and cda (<inline-formula id="IEq307"><alternatives><tex-math id="M617">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M618"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq307.gif"/></alternatives></inline-formula>), the parameter <inline-formula id="IEq308"><alternatives><tex-math id="M619">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m$$\end{document}</tex-math><mml:math id="M620"><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq308.gif"/></alternatives></inline-formula> that is used to remove the noise during the construction of the positional clusters and the support threshold value <inline-formula id="IEq309"><alternatives><tex-math id="M621">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M622"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq309.gif"/></alternatives></inline-formula> in (0, 1] used for each positional cluster coloring. Such data structures can be computed via the bash script that we provide in the phyBWT2 repository. In the current implementation, the data structures are given in uncompressed form, but phyBWT2 can be adapted to directly take as input compressed data structures [<xref ref-type="bibr" rid="CR31">31</xref>].</p>
    <p id="Par133">Our tool outputs an unrooted tree in newick format. The trees<xref ref-type="fn" rid="Fn5">5</xref> reported in this paper are drawn by using the Interactive Tree Of Life (iTOL) tool [<xref ref-type="bibr" rid="CR32">32</xref>].</p>
    <p id="Par135"><italic>Datasets</italic> To show the effectiveness of our method, we have chosen six datasets with a diverse number of taxa, composition and different length of the strings (Table <xref rid="Tab1" ref-type="table">1</xref>). More in details, we used six different types of datasets: i) Illumina sequencing data (short reads) for seven <italic>S. cerevisiae</italic> and five <italic>S. paradoxus</italic> strains from the study in [<xref ref-type="bibr" rid="CR33">33</xref>]; ii) assemblies from 12 species of the genus <italic>Drosophila</italic> from the FlyBase database (largely accepted phylogeny shown in [<xref ref-type="bibr" rid="CR34">34</xref>]) (also analyzed in [<xref ref-type="bibr" rid="CR24">24</xref>]); iii) Illumina sequencing data (short reads) for 42 <italic>S. cerevisiae</italic> strains selected from the studies in [<xref ref-type="bibr" rid="CR35">35</xref>, <xref ref-type="bibr" rid="CR36">36</xref>] and from the public repository under accession code PRJEB50706. iv) 43 HIV-1 complete genomes used in the literature [<xref ref-type="bibr" rid="CR37">37</xref>]; v) 20 sequences from Ebolavirus genus selected in [<xref ref-type="bibr" rid="CR38">38</xref>, <xref ref-type="bibr" rid="CR39">39</xref>]. vi) 27 genomes from <italic>E. coli</italic> and <italic>Shigella</italic> from the studies in [<xref ref-type="bibr" rid="CR40">40</xref>, <xref ref-type="bibr" rid="CR41">41</xref>].</p>
    <p id="Par136"><italic>Resource usage</italic> The new version phyBWT2 improves the performance of the former version phyBWT by reducing the internal memory usage and the running time on large datasets. Indeed, phyBWT2 does not load in main memory the data structures: it performs the clustering detection by reading portions of the input data structures computed for the whole dataset and by (possibly) reducing them to a subset of strings at the same time.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Datasets</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Datasets</th><th align="left">Composition</th><th align="left">Number<break/>of taxa</th><th align="left">Number<break/>of sequences</th><th align="left">Number<break/>of bp</th></tr></thead><tbody><tr><td align="left">12 yeasts</td><td align="left">Illumina paired-end reads</td><td char="." align="char">12</td><td align="left">60,000,000</td><td char="." align="char">9,060,000,000</td></tr><tr><td align="left">Drosophila</td><td align="left">assemblies</td><td char="." align="char">12</td><td align="left">121,491</td><td char="." align="char">4,323,268,803</td></tr><tr><td align="left">42 yeasts</td><td align="left">Illumina paired-end reads</td><td char="." align="char">42</td><td align="left">119,641,704</td><td char="." align="char">15,664,843,102</td></tr><tr><td align="left">HIV-1</td><td align="left">genomes</td><td char="." align="char">43</td><td align="left">43</td><td char="." align="char">388,535</td></tr><tr><td align="left">Ebolavirus</td><td align="left">genomes</td><td char="." align="char">20</td><td align="left">20</td><td char="." align="char">378,002</td></tr><tr><td align="left"><italic>E. coli</italic>—Shigella</td><td align="left">genomes</td><td char="." align="char">27</td><td align="left">27</td><td char="." align="char">132,466,506</td></tr></tbody></table></table-wrap><table-wrap id="Tab2"><label>Table 2</label><caption><p>Running times and RAM both phyBWT2 and SANS</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="4">Datasets</th><th align="left" colspan="4">PhyBWT2</th><th align="left" colspan="3">SANS</th></tr><tr><th align="left" colspan="2">Preprocessing</th><th align="left" colspan="2">Phylogeny</th><th align="left" rowspan="2">RAM</th><th align="left" rowspan="2">Wall clock</th><th align="left" rowspan="2"/></tr><tr><th align="left" rowspan="2">RAM (Kb)</th><th align="left" rowspan="2">Wall clock (hh:mm:ss)</th><th align="left" rowspan="2">RAM (Kb)</th><th align="left" rowspan="2">Wall clock (hh:mm:ss)</th></tr><tr><th align="left">(Kb)</th><th align="left">(hh:mm:ss)</th><th align="left"/></tr></thead><tbody><tr><td align="left">12 yeasts</td><td align="left">27,559,652</td><td align="left">3:19:03</td><td align="left">6752</td><td align="left">3:12</td><td align="left">2,779,692</td><td align="left">35:58</td><td align="left"/></tr><tr><td align="left">Drosophila</td><td align="left">92,536,548</td><td align="left">26:11</td><td align="left">9516</td><td align="left">8:50</td><td align="left">30,107,232</td><td align="left">21:04</td><td align="left"/></tr><tr><td align="left">42 yeasts</td><td align="left">47,696,220</td><td align="left">(BCR+bwt2lcp) 08:06:08</td><td align="left" rowspan="2">1,874,388</td><td align="left" rowspan="2">01:26:17</td><td align="left">14,128,724</td><td align="left">32:48:43</td><td align="left">(k=32)</td></tr><tr><td align="left"/><td align="left">4,461,196</td><td align="left">(only BCR) 16:27:45</td><td align="left">12,368,416</td><td align="left">45:52:01</td><td align="left">(k=25)</td></tr><tr><td align="left">HIV-1</td><td align="left">18,996</td><td align="left"><inline-formula id="IEq310"><alternatives><tex-math id="M623">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt; 1$$\end{document}</tex-math><mml:math id="M624"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq310.gif"/></alternatives></inline-formula>s</td><td align="left">8452</td><td align="left"><inline-formula id="IEq311"><alternatives><tex-math id="M625">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt; 1$$\end{document}</tex-math><mml:math id="M626"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq311.gif"/></alternatives></inline-formula>s</td><td align="left">9,020</td><td align="left"><inline-formula id="IEq312"><alternatives><tex-math id="M627">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt; 1$$\end{document}</tex-math><mml:math id="M628"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq312.gif"/></alternatives></inline-formula>s</td><td align="left"/></tr><tr><td align="left">Ebolavirus</td><td align="left">18,256</td><td align="left"><inline-formula id="IEq313"><alternatives><tex-math id="M629">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt; 1$$\end{document}</tex-math><mml:math id="M630"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq313.gif"/></alternatives></inline-formula>s</td><td align="left">8460</td><td align="left"><inline-formula id="IEq314"><alternatives><tex-math id="M631">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt; 1$$\end{document}</tex-math><mml:math id="M632"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq314.gif"/></alternatives></inline-formula>s</td><td align="left">9,112</td><td align="left"><inline-formula id="IEq315"><alternatives><tex-math id="M633">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt; 1$$\end{document}</tex-math><mml:math id="M634"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq315.gif"/></alternatives></inline-formula>s</td><td align="left"/></tr><tr><td align="left"><italic>E. coli</italic>—Shigella</td><td align="left">5,484,644</td><td align="left">1:21</td><td align="left">12,648</td><td align="left">1:38</td><td align="left">303,868</td><td align="left">3:06</td><td align="left"/></tr></tbody></table><table-wrap-foot><p>We also show the the resources needed to build the data structures during the preprocessing using the tool BCR [<xref ref-type="bibr" rid="CR15">15</xref>] and bwt2lcp [<xref ref-type="bibr" rid="CR46">46</xref>] for short reads and gsufsort [<xref ref-type="bibr" rid="CR45">45</xref>] for long sequences. All tools were run using one core only. The wall clock time and RAM usage are taken from the output of the /usr/bin/time command.</p></table-wrap-foot></table-wrap></p>
    <p id="Par137">In Table <xref rid="Tab2" ref-type="table">2</xref> we report the running times of both phyBWT2 and SANS on the tested datasets. We separate the running time required to build the data structures from the running time of phyBWT2 for several reasons.</p>
    <p id="Par138">First, the input data structures eBWT, LCP and CDA are well-known structures in string algorithms and in bioinformatics, and efficiently building these data structures is a well-studied problem ( [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR42">42</xref>–<xref ref-type="bibr" rid="CR49">49</xref>]). Thus, analyzing the best way to compute them efficiently does not fall within the goal of this paper.</p>
    <p id="Par139">Second, the data structures do not depend on the <inline-formula id="IEq316"><alternatives><tex-math id="M635">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m$$\end{document}</tex-math><mml:math id="M636"><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq316.gif"/></alternatives></inline-formula>-value used to remove the noise during the construction of the positional clusters. Therefore, they need to be built only once for each input dataset. One can try different parameters or techniques for inferring confidence values on phylogenetic trees (based on reconstructing many trees) without having to rebuild the data structures.</p>
    <p id="Par140">The last feature does not hold for <italic>k</italic>-mers-based methods, such as SANS, whose data structures must be recomputed when varying the input parameter <italic>k</italic>.</p>
    <p id="Par141">Nevertheless, we experimentally observed that the pre-processing step (see Table <xref rid="Tab2" ref-type="table">2</xref>) is computationally more expensive than the phylogeny construction.</p>
    <sec id="Sec10">
      <title>Experiments on 12 yeasts</title>
      <p id="Par142">This dataset comprises 12 Illumina 151-bp paired-end sequencing experiments obtained from the study in [<xref ref-type="bibr" rid="CR33">33</xref>], and deposited in the public repository SRA (Short Reads Archive) under accession code PRJNA340312. We selected seven sequencing data from the <italic>S. cerevisiae</italic> strains and five from the <italic>S. paradoxus</italic> strains. We performed adaptor-removing and quality-based trimming using trimmomatic [<xref ref-type="bibr" rid="CR50">50</xref>], as described in [<xref ref-type="bibr" rid="CR33">33</xref>]. Then, for each sequencing experiment, we extracted 5 million of 151-bp paired-end reads as to form a dataset with <inline-formula id="IEq317"><alternatives><tex-math id="M637">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$60\times$$\end{document}</tex-math><mml:math id="M638"><mml:mrow><mml:mn>60</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq317.gif"/></alternatives></inline-formula> coverage on average per strain and a total FASTA file size of 26 GB.</p>
      <p id="Par143"><italic>Validation and results</italic> As benchmark tree we used the one reported in Fig. <xref rid="Fig4" ref-type="fig">4</xref> obtained from the original study [<xref ref-type="bibr" rid="CR33">33</xref>]. Remarkably, the benchmark was built using nuclear one-to-one orthologs, i.e. the sequences of nuclear genes which are shared among (<italic>i</italic>) the seven <italic>S. cerevisiae</italic>, (<italic>ii</italic>) the five <italic>S. paradoxus</italic> strains sequenced in the study, and (<italic>iii</italic>) six outgroups from the <italic>Saccharomyces</italic> genus.<fig id="Fig4"><label>Fig. 4</label><caption><p>Benchmark phylogeny for the yeasts dataset. Figure redrawn from [<xref ref-type="bibr" rid="CR33">33</xref>]</p></caption><graphic xlink:href="13015_2023_232_Fig4_HTML" id="MO4"/></fig><fig id="Fig5"><label>Fig. 5</label><caption><p>Yeasts phylogeny by phyBWT and phyBWT2 (<bold>a</bold>) and by SANS (<bold>b</bold>)</p></caption><graphic xlink:href="13015_2023_232_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par144">The tree depicted in Fig. <xref rid="Fig5" ref-type="fig">5</xref>a has been obtained by the first version phyBWT, for any <inline-formula id="IEq318"><alternatives><tex-math id="M639">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m\ge 14$$\end{document}</tex-math><mml:math id="M640"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mn>14</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq318.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq319"><alternatives><tex-math id="M641">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau =0.6$$\end{document}</tex-math><mml:math id="M642"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq319.gif"/></alternatives></inline-formula> and <italic>t</italic> being the number of taxa. By running phyBWT2 on the same input we obtain the same reconstructed phylogeny with similar parameters, i.e. for any <inline-formula id="IEq320"><alternatives><tex-math id="M643">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m&gt;15$$\end{document}</tex-math><mml:math id="M644"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>15</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq320.gif"/></alternatives></inline-formula> and <inline-formula id="IEq321"><alternatives><tex-math id="M645">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau =0.6$$\end{document}</tex-math><mml:math id="M646"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq321.gif"/></alternatives></inline-formula> (parameter <italic>t</italic> being removed in phyBWT2). For running SANS, analogously to [<xref ref-type="bibr" rid="CR11">11</xref>], we use default parameters that corresponds to setting the <italic>k</italic>-mer length to 32 (-DmaxN=32), and in addition, we set the option -f strict in order to output a tree in the Newick format (see Fig. <xref rid="Fig5" ref-type="fig">5</xref>b).</p>
      <p id="Par145">Both phyBWT2 and SANS separate the <italic>S. cerevisiae</italic> and the <italic>S. paradoxus</italic> strains, which show an average whole-genome sequence divergence of <inline-formula id="IEq322"><alternatives><tex-math id="M647">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim$$\end{document}</tex-math><mml:math id="M648"><mml:mo>∼</mml:mo></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq322.gif"/></alternatives></inline-formula> 10%. As expected, by taking into account the relatively high divergence among <italic>S. paradoxus</italic> strains (0.5% - 4.5%), also the same <italic>S. paradoxus</italic> partition is obtained. On the other hand, a few differences are shown in the <italic>S. cerevisiae</italic> partition which groups strains with a sequence divergence <inline-formula id="IEq323"><alternatives><tex-math id="M649">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim$$\end{document}</tex-math><mml:math id="M650"><mml:mo>∼</mml:mo></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq323.gif"/></alternatives></inline-formula> 0.5%. Compared to SANS, phyBWT2 produces a tree which is closer to the benchmark although the differences with the benchmark shown by both SANS and our method can be explained considering the relatively low divergence among <italic>S. cereviasiae</italic> strains as well as the partially admixed genomes of some of the trains (e.g. S288C and DBVPG6044) [<xref ref-type="bibr" rid="CR51">51</xref>].</p>
      <p id="Par146">For a fair comparison, we also run SANS with different values of the input parameter <italic>k</italic> (i.e. by varying <italic>k</italic> in the range [15, 50]). The unrooted phylogenetic tree obtained for <italic>k</italic> in [15, 27] is topologically equivalent to the one obtained from our approach depicted in Fig. <xref rid="Fig5" ref-type="fig">5</xref>a, but the UWOPS034614 strain is clustered with the <italic>S. paradoxus</italic> clade rather than <italic>S. cerevisiae</italic> clade. Instead, for <inline-formula id="IEq324"><alternatives><tex-math id="M651">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k&gt;40$$\end{document}</tex-math><mml:math id="M652"><mml:mrow><mml:mi>k</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>40</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq324.gif"/></alternatives></inline-formula>, either the strain UWOPS919171 is misplaced or the stains Y12 and YPS128 are not grouped together, differently from the benchmark tree.</p>
      <p id="Par147"><italic>Time and memory</italic> Given the necessary data structures for this dataset, the former version phyBWT runs in approximately 12 min with a memory peak of 81 GB by loading the whole data structures in the main memory. The new version phyBWT2 uses only 6.5 MB of internal memory and fulfills the task in 3:12 min reducing the number of performed iterations from 6 to 1 (using the same parameter setting <inline-formula id="IEq325"><alternatives><tex-math id="M653">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m=22$$\end{document}</tex-math><mml:math id="M654"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>22</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq325.gif"/></alternatives></inline-formula> and <inline-formula id="IEq326"><alternatives><tex-math id="M655">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau =0.6$$\end{document}</tex-math><mml:math id="M656"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq326.gif"/></alternatives></inline-formula> for both versions). On the same datasets, using default parameters, SANS runs in 30:29 min by using 3.7 GB of internal memory. However, a direct time and memory comparison between phyBWT2 and SANS is not completely fair, as they take different inputs: if we do not assume availability of the data structures, computing them for this dataset takes over 3 hours, so SANS would be faster (see Table <xref rid="Tab2" ref-type="table">2</xref> for details).</p>
    </sec>
    <sec id="Sec11">
      <title>Experiments on <italic>Drosophila</italic></title>
      <p id="Par148">Drosophila data are downloaded from the FlyBase database.<xref ref-type="fn" rid="Fn6">6</xref> This dataset includes assemblies from 12 species of the genus <italic>Drosophila</italic>: <italic>D. melanogaster</italic> (mel), <italic>D. ananassae</italic> (ana), <italic>D. erecta</italic> (ere), <italic>D. grimshawi</italic> (gri), <italic>D. mojavensis</italic> (moj), <italic>D. persimilis</italic> (per), <italic>D. pseudoobscura</italic> (pse), <italic>D. sechellia</italic> (sec), <italic>D. simulans</italic> (sim), <italic>D. virilis</italic> (vir), <italic>D. willistoni</italic> (wil), and <italic>D. yakuba</italic> (yak). Nine of these species fall within the Sophophora subgenus, which includes members of the melanogaster, obscura and willistoni groups.</p>
      <p id="Par150">The number of strings for each species varies: it ranges from 1, 870 for <italic>D. melanogaster</italic> to 17, 440 for <italic>D. grimshawi</italic>. The obtained dataset is a medium-sized input with a total number of symbols of more than 2, 161 Mbp. More details are reported in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
      <p id="Par151"><italic>Validation and results</italic> As benchmark tree we used the accepted phylogeny [<xref ref-type="bibr" rid="CR34">34</xref>] which we report in Fig. <xref rid="Fig6" ref-type="fig">6</xref>b. For this dataset, phyBWT2 produces the same tree as the one obtained in [<xref ref-type="bibr" rid="CR11">11</xref>] by using phyBWT for any <inline-formula id="IEq327"><alternatives><tex-math id="M657">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m$$\end{document}</tex-math><mml:math id="M658"><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq327.gif"/></alternatives></inline-formula> in [23, 45] and <inline-formula id="IEq328"><alternatives><tex-math id="M659">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau =0.5$$\end{document}</tex-math><mml:math id="M660"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq328.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a). The same parameter settings used for phyBWT also hold for phyBWT2. The <italic>Sophophora</italic> subgenus as well as the <italic>Drosophila</italic> subgenus are correctly detected, and inside the <italic>Sophophora</italic> subgenus, the <italic>melanogaster</italic> subgroup is correctly isolated. The only difference with respect to the benchmark tree by [<xref ref-type="bibr" rid="CR34">34</xref>] is the taxon <italic>D. ananassae</italic> that represents the <italic>ananassae</italic> subgroup. Such subgroup is part of the <italic>melanogaster</italic> group together with <italic>D. melanogaster</italic>, <italic>D. sechellia</italic>, <italic>D. simulans</italic>, <italic>D. erecta</italic> and <italic>D. yakuba</italic>. However, our method places <italic>D. ananassae</italic> closer to the <italic>obscura</italic> group rather than the <italic>melanogaster</italic> subgroup. SANS was run with default values as described in [<xref ref-type="bibr" rid="CR24">24</xref>], and the reconstructed tree obtained by option -f strict is topologically equivalent to the benchmark reference tree.<fig id="Fig6"><label>Fig. 6</label><caption><p>Drosophila phylogeny: <bold>a</bold> by our method; <bold>b</bold> benchmark redrawn from [<xref ref-type="bibr" rid="CR34">34</xref>]</p></caption><graphic xlink:href="13015_2023_232_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par152"><italic>Time and memory</italic> phyBWT2 improves upon phyBWT by reducing the memory usage from 24 GB to 9 MB, and by reducing the number of iterations from 4 to 2 for <inline-formula id="IEq329"><alternatives><tex-math id="M661">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m=23$$\end{document}</tex-math><mml:math id="M662"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>23</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq329.gif"/></alternatives></inline-formula> and <inline-formula id="IEq330"><alternatives><tex-math id="M663">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau =0.5$$\end{document}</tex-math><mml:math id="M664"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq330.gif"/></alternatives></inline-formula>. Nevertheless, the running time of phyBWT2 is around 9 min, more than phyBWT which ends in less than 2 min; this is mainly due to the fact that input data structures are kept on the disk. By using default parameters, SANS uses an amount of internal memory similar to phyBWT (28.7 GB) and ends in around 21 min.</p>
    </sec>
    <sec id="Sec12">
      <title>Experiments on 42 yeasts</title>
      <p id="Par153">In order to test the accuracy of phyBWT2 in discerning closely related populations (with sequence divergence varying between 0.5% and 1%), we selected 42 representative <italic>S. cerevisiae</italic> strains and produced their phylogenetic tree.</p>
      <p id="Par154">This dataset comprises 42 Illumina paired-end sequencing experiments obtained from the study in [<xref ref-type="bibr" rid="CR52">52</xref>]. More details about the public repositories to download them are provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>. For each sequencing experiment, we extracted paired-end reads yielding an average coverage of <inline-formula id="IEq331"><alternatives><tex-math id="M665">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$30\times$$\end{document}</tex-math><mml:math id="M666"><mml:mrow><mml:mn>30</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq331.gif"/></alternatives></inline-formula> per strain and a total FASTA file size of 38 GB.</p>
      <p id="Par155"><italic>Validation and results</italic> As a benchmark we used IQ-TREE [<xref ref-type="bibr" rid="CR53">53</xref>] with model selection [<xref ref-type="bibr" rid="CR54">54</xref>] and ultrafast bootstrapping [<xref ref-type="bibr" rid="CR55">55</xref>] (Fig. <xref rid="Fig7" ref-type="fig">7</xref>) and compared its results with those obtained from phyBWT2 and SANS. As shown in Fig. <xref rid="Fig8" ref-type="fig">8</xref>, phyBWT2 captured several features of the phylogeny produced with IQ-TREE.<fig id="Fig7"><label>Fig. 7</label><caption><p>Bootstrapping phylogenetic tree on the 42 yeasts sequences</p></caption><graphic xlink:href="13015_2023_232_Fig7_HTML" id="MO7"/></fig><fig id="Fig8"><label>Fig. 8</label><caption><p>The phylogenetic tree on the 42 yeasts sequences by phyBWT</p></caption><graphic xlink:href="13015_2023_232_Fig8_HTML" id="MO8"/></fig></p>
      <p id="Par156">Overall, the structure of the tree generated by phyBWT2 for sufficiently large <inline-formula id="IEq332"><alternatives><tex-math id="M667">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m$$\end{document}</tex-math><mml:math id="M668"><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq332.gif"/></alternatives></inline-formula> and <inline-formula id="IEq333"><alternatives><tex-math id="M669">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M670"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq333.gif"/></alternatives></inline-formula> (<inline-formula id="IEq334"><alternatives><tex-math id="M671">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m=25$$\end{document}</tex-math><mml:math id="M672"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq334.gif"/></alternatives></inline-formula> and <inline-formula id="IEq335"><alternatives><tex-math id="M673">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau =0.6$$\end{document}</tex-math><mml:math id="M674"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq335.gif"/></alternatives></inline-formula>) is very similar to the structure of the benchmark tree. All the main non-admixed clades [<xref ref-type="bibr" rid="CR51">51</xref>], namely the “Wine/European” strains (AIF, BPK, ALS_1a, ADI, CKB, AFI, CAS_1a) and the Asian ones (BAQ_1a, BAH, BAL_1a, AMH_1a, BAP_1a), are correctly identified by phyBWT2. Remarkably, also the other two main classes of strains, namely the “ale beer” strains (AAC, ATV) and the “African palm wine” clade (BAD, BAF), are correctly clustered close to the Wine/European and the Asian clades respectively.</p>
      <p id="Par157">Finally, all the other strains related to the Wine/European clade are correctly clustered. Moreover, comparing the results of phyBWT2 with the literature [<xref ref-type="bibr" rid="CR52">52</xref>] we observe that only phyBWT2 is able to correctly detect the outgroup strain (AMH_1a).</p>
      <p id="Par158">On the contrary, the tree generated by SANS with default parameters (Fig. <xref rid="Fig9" ref-type="fig">9</xref>) fails to grasp both the general structure of the benchmark tree and the fine structure of the different clades. Remarkably, we observe strains related to the Wine/European group, such as the cider strain AMP_1a, clustered very close to Asian strains and also the other way round, e.g. the Asian strain CDG_1a that is clustered close to Wine/European strains.<fig id="Fig9"><label>Fig. 9</label><caption><p>The phylogenetic tree on the 42 yeasts sequences by SANS with default parameters</p></caption><graphic xlink:href="13015_2023_232_Fig9_HTML" id="MO9"/></fig></p>
      <p id="Par159">We also ran SANS using a smaller value for the <italic>k</italic>-mer length (option -k 25). As reported in Fig. <xref rid="Fig10" ref-type="fig">10</xref> the general structure of the tree improved with respect to the default parameter, since the clustering of the non-admixed strains (both the Wine/European and the Asian) is correctly determined. Also the fine structure improved with the African palm wine strains (BAD and BAF) correctly clustered with the Asian clade. On the other hand, the ale beer strains (AAC and ATV) are still incorrectly placed. The same holds for the outgroup (AMH_1a) that is not identified.<fig id="Fig10"><label>Fig. 10</label><caption><p>The phylogenetic tree on the 42 yeasts sequences by SANS with option -k=25</p></caption><graphic xlink:href="13015_2023_232_Fig10_HTML" id="MO10"/></fig></p>
      <p id="Par160"><italic>Time and memory</italic> Given the necessary data structures for this dataset, phyBWT2 reconstructs the proposed phylogeny in approximately 1 h and half with a memory peak of 1.8 GB by using <inline-formula id="IEq336"><alternatives><tex-math id="M675">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m=25$$\end{document}</tex-math><mml:math id="M676"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq336.gif"/></alternatives></inline-formula> and <inline-formula id="IEq337"><alternatives><tex-math id="M677">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau =0.6$$\end{document}</tex-math><mml:math id="M678"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq337.gif"/></alternatives></inline-formula>. phyBWT2 largely improves upon phyBWT not only but showing a better phylogeny reconstruction (by using similar parameter settings), but also in its performance. The former version runs in 5 h by using a large amount of memory (more than 175 GB) and performs 33 iterations against the only 5 carried out by phyBWT2. On the same dataset, SANS needs 13.5 GB of internal memory and more than 32 h to reconstruct the phylogenetic tree for <inline-formula id="IEq338"><alternatives><tex-math id="M679">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=32$$\end{document}</tex-math><mml:math id="M680"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>32</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq338.gif"/></alternatives></inline-formula>, and even more time (around more than 45 h) for <inline-formula id="IEq339"><alternatives><tex-math id="M681">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=25$$\end{document}</tex-math><mml:math id="M682"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq339.gif"/></alternatives></inline-formula>. Although a direct time and memory comparison between phyBWT2 and SANS is not fair, since phyBWT2 requires data structures whose computation does not depends on the choice of <italic>k</italic>, in this case even including the computation of the data structures phyBWT2 is more efficient than SANS: for this dataset, we can compute the eBWT and CDA array using the semi-external memory approach proposed by BCR [<xref ref-type="bibr" rid="CR15">15</xref>] taking about 7 h and 4.3 GB of internal memory, and deduce the LCP array from the eBWT using the tool bwt2lcp [<xref ref-type="bibr" rid="CR46">46</xref>] taking around 1 h and 20 min and 45 GB of memory (see Table <xref rid="Tab2" ref-type="table">2</xref>).</p>
    </sec>
    <sec id="Sec13">
      <title>Experiments on HIV</title>
      <p id="Par161">Clade classification is an important task also in the field of virology, as each clade (also termed subtype) corresponds to a cluster of genetic similarity. Thus, we studied the phylogeny of the Human immunodeficiency virus (HIV).</p>
      <p id="Par162">There are two main types of HIV, and among them, HIV-1 is the most virulent and predominant. This dataset is obtained by selecting 43 HIV-1 complete genomes used in the literature [<xref ref-type="bibr" rid="CR37">37</xref>]. In particular, it comprises thirty-five sequences from the major group (Group M) divide into subtypes A, B, C, D, F, G, H, J, K, seven sequences from the minor Groups N and O, and one CPZ sequence as an outgroup. Accession number, subtype, length (bp), and area of the HIV-1 sequences are reported in Table S1. These reference sequences have been carefully selected in [<xref ref-type="bibr" rid="CR56">56</xref>] according to several criteria, and can be downloaded from the Los Alamos National Laboratory HIV Sequence Database.<xref ref-type="fn" rid="Fn7">7</xref></p>
      <p id="Par164"><italic>Validation and results</italic> For this experiment, we use as benchmark the phylogeny depicted in [<xref ref-type="bibr" rid="CR37">37</xref>, Fig. 2], which is the Neighbor-Joining phylogenetic tree on the 43 reference sequences where the CPZ sequence (CIV strain AF447763) is used as an outgroup. We run phyBWT2 and SANS on this dataset by using different parameter settings. We compared the reconstructed phylogenetic trees by using the functions ClusteringInfoDistance() and SharedPhylogeneticInfo() provided in the R package TreeDist [<xref ref-type="bibr" rid="CR57">57</xref>], which implements a suite of metrics to quantify the topological distance between pairs of unweighted phylogenetic trees.</p>
      <p id="Par165">Figures <xref rid="Fig11" ref-type="fig">11</xref> and <xref rid="Fig12" ref-type="fig">12</xref> depict the trees that obtained the best scores according to the above measures based on the amount of phylogenetic or clustering information that two trees hold in 
common. More in details, we set <inline-formula id="IEq340"><alternatives><tex-math id="M683">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m=16$$\end{document}</tex-math><mml:math id="M684"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq340.gif"/></alternatives></inline-formula> and <inline-formula id="IEq341"><alternatives><tex-math id="M685">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau =0.6$$\end{document}</tex-math><mml:math id="M686"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq341.gif"/></alternatives></inline-formula> in phyBWT2 and <inline-formula id="IEq342"><alternatives><tex-math id="M687">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=16$$\end{document}</tex-math><mml:math id="M688"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq342.gif"/></alternatives></inline-formula> in SANS. For both tools, subtypes are distinctly grouped together in different branches. The phylogeny produced by phyBWT2 is consistent with the one in [<xref ref-type="bibr" rid="CR37">37</xref>]. The relationships among the subtypes are well demonstrated, for instance subtypes B and D (resp. C and H) are closer to each other than to the others, and subtype F (resp. A) contains two distinguishable sub-subtypes F1 and F2 (resp. A1 and A2) that are close related to subtypes K and J (resp. G).<fig id="Fig11"><label>Fig. 11</label><caption><p>The phylogenetic tree on the 42 HiV-1 sequences by phyBWT2. Re-root the tree in CIV strain AF447763, as it is set outgroup in the reference tree in [<xref ref-type="bibr" rid="CR37">37</xref>]</p></caption><graphic xlink:href="13015_2023_232_Fig11_HTML" id="MO11"/></fig></p>
      <p id="Par166"><italic>Time and memory</italic> Given the necessary data structures for this dataset, both phyBWT and phyBWT2 reconstruct the proposed phylogeny very quickly (less than 1 second). However, phyBWT2 improves on phyBWT by showing a phylogeny reconstruction closer to the benchmark philogeny (by using similar parameter settings), and by reducing the number of iterations from 8 to 3.<fig id="Fig12"><label>Fig. 12</label><caption><p>The phylogenetic tree on the 42 HIV-1 sequences by SANS. Re-root the tree in CIV strain AF447763, as it is set outgroup in the reference tree in [<xref ref-type="bibr" rid="CR37">37</xref>]</p></caption><graphic xlink:href="13015_2023_232_Fig12_HTML" id="MO12"/></fig></p>
    </sec>
    <sec id="Sec14">
      <title>Experiments on Ebolavirus</title>
      <p id="Par167">For this experiment, we used the 20 published sequences from [<xref ref-type="bibr" rid="CR38">38</xref>] selected in [<xref ref-type="bibr" rid="CR39">39</xref>].</p>
      <p id="Par168">The Ebolavirus genus includes five viral species: Ebola virus (<italic>Zaire ebolavirus</italic>, EBOV), <italic>Sudan virus</italic> (SUDV), <italic>Tai Forest virus</italic> (TAFV), <italic>Bundibugyo virus</italic> (BDBV), and <italic>Reston virus</italic> (RESTV). Ebola viruses are single-stranded RNA whose genomes consist of about 19 kilobases. Details for each sequence in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
      <p id="Par169"><italic>Validation and results</italic> For this experiment, we use as benchmark the phylogeny trees depicted in [<xref ref-type="bibr" rid="CR39">39</xref>, Fig. <xref rid="Fig4" ref-type="fig">4</xref>].</p>
      <p id="Par170">Figures <xref rid="Fig13" ref-type="fig">13</xref> and <xref rid="Fig14" ref-type="fig">14</xref> depict the trees that obtained the best scores according to the measures based on the shared amount of phylogenetic or clustering information provided in the R package TreeDist [<xref ref-type="bibr" rid="CR57">57</xref>] and described for the HIV-1 dataset. More in details, we set 
<inline-formula id="IEq343"><alternatives><tex-math id="M689">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m=16$$\end{document}</tex-math><mml:math id="M690"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq343.gif"/></alternatives></inline-formula> and <inline-formula id="IEq344"><alternatives><tex-math id="M691">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau =0.6$$\end{document}</tex-math><mml:math id="M692"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq344.gif"/></alternatives></inline-formula> in phyBWT2 and <inline-formula id="IEq345"><alternatives><tex-math id="M693">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=21$$\end{document}</tex-math><mml:math id="M694"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>21</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq345.gif"/></alternatives></inline-formula> in SANS.<fig id="Fig13"><label>Fig. 13</label><caption><p>The phylogenetic tree on Ebolavirus dataset by phyBWT2</p></caption><graphic xlink:href="13015_2023_232_Fig13_HTML" id="MO13"/></fig><fig id="Fig14"><label>Fig. 14</label><caption><p>The phylogenetic tree on Ebolavirus dataset by SANS</p></caption><graphic xlink:href="13015_2023_232_Fig14_HTML" id="MO14"/></fig></p>
      <p id="Par171">Both phyBWT2 and SANS exactly separated the five species. According to the four trees in [<xref ref-type="bibr" rid="CR39">39</xref>, Fig. <xref rid="Fig4" ref-type="fig">4</xref>], the EBOV sequences are clustered into a monophyletic clade, and BDBV and TAFV viruses are positioned close and then clustered with the EBOV branch. These trees also show the phylogenetic uncertainty in the placement of the SUDV clade (red).</p>
      <p id="Par172">Our method (Fig. <xref rid="Fig13" ref-type="fig">13</xref>) places the SUDV clade as sister to the EBOV, TAFV and BDBV clade, in according with [<xref ref-type="bibr" rid="CR39">39</xref>, Fig. 4E], whereas SANS (Fig. <xref rid="Fig14" ref-type="fig">14</xref>) places it as sister to RESTV clade in according with [<xref ref-type="bibr" rid="CR39">39</xref>, Fig. 4A]. Differently from the study in [<xref ref-type="bibr" rid="CR39">39</xref>, Fig. 4], the phylogeny reconstructed by SANS keeps the EBOV branch and the TAFV-BDBV clade separated (Fig. <xref rid="Fig14" ref-type="fig">14</xref>).</p>
      <p id="Par173"><italic>Time and memory</italic> Also in this second dataset of viral genomes, both phyBWT and phyBWT2 reconstruct the proposed phylogeny very quickly (less than 1 second). The phylogeny reconstructed by phyBWT is similar to the one produced by phyBWT2, but the number of iterations performed by phyBWT2 is much smaller (from 13 to 2).</p>
    </sec>
    <sec id="Sec15">
      <title>Experiments on <italic>E. coli</italic>—Shigella</title>
      <p id="Par174">For this experiment, we used a real-world dataset collected in the study [<xref ref-type="bibr" rid="CR41">41</xref>] to assess the accuracy of the alignment-free methods in phylogenetic reconstruction of sequences that underwent horizontal gene trasfer events and genome rearrangements. It comprises 27 genomes of <italic>E. coli</italic> and <italic>Shigella</italic> whose reference supertree [<xref ref-type="bibr" rid="CR40">40</xref>] was generated based on thousands of single-copy protein trees. Details for each sequence in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
      <p id="Par175"><italic>Validation and results</italic> As benchmark we use the phylogeny tree depicted in [<xref ref-type="bibr" rid="CR41">41</xref>, Additional file 2: Figure S8] where <italic>E. coli</italic> reference groups and <italic>Shigella</italic> (S) are indicated. Indeed, the 27 taxa are attributed to six distinct groups (the <italic>E. coli</italic> reference, or ECOR, strains) [<xref ref-type="bibr" rid="CR40">40</xref>].</p>
      <p id="Par176">Figures <xref rid="Fig15" ref-type="fig">15</xref>a and b depict the trees we selected among them obtaining the higher scores according to the clustering information measure described above and computed by using the R package TreeDist [<xref ref-type="bibr" rid="CR57">57</xref>]. More in details, we choose <inline-formula id="IEq346"><alternatives><tex-math id="M695">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=16$$\end{document}</tex-math><mml:math id="M696"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq346.gif"/></alternatives></inline-formula> for SANS, and <inline-formula id="IEq347"><alternatives><tex-math id="M697">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m=16$$\end{document}</tex-math><mml:math id="M698"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq347.gif"/></alternatives></inline-formula> and <inline-formula id="IEq348"><alternatives><tex-math id="M699">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau =0.5$$\end{document}</tex-math><mml:math id="M700"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq348.gif"/></alternatives></inline-formula> for phyBWT2 (parameter setting similar to other datasets).<fig id="Fig15"><label>Fig. 15</label><caption><p>The phylogenetic tree on the 27 <italic>E. coli—Shigella</italic> genomes by phyBWT (<bold>a</bold>) and by SANS (<bold>b</bold>)</p></caption><graphic xlink:href="13015_2023_232_Fig15_HTML" id="MO17"/></fig></p>
      <p id="Par177">We observe that phyBWT2 clusters in clades each ECOR group (i.e. groups A, B1, B2, D, E and S), apart from <italic>S. dysenteriae</italic> that is placed externally to Group S, more precisely as sister to Group E.</p>
      <p id="Par178">However, we note that also in the reference tree <italic>S. dysenteriae</italic> is placed externally, as sister to the pathogenic <italic>E. coli O157:H7</italic> isolates (Group E). Also the tree reconstructed by SANS shows such a relationship between <italic>S. dysenteriae</italic> and Group E.</p>
      <p id="Par179">Differently from the reference tree, both phyBWT2 and SANS placed groups A and B1 as sister groups.</p>
      <p id="Par180"><italic>Time and memory</italic> The time usage of phyBWT 2 and SANS for this dataset is comparable (including the time for the preprocessing step completed by the internal memory approach gsufsort [<xref ref-type="bibr" rid="CR45">45</xref>]), which is also comparable to the time spent by the older version phyBWT. By keeping the data structures on disk, phyBWT2 improves the memory usage of phyBWT. Finally, also for this datasets the number of iterations performed by phyBWT2 improves on those performed by the previous version.</p>
    </sec>
  </sec>
  <sec id="Sec16">
    <title>Conclusions and further work</title>
    <p id="Par181">In this paper, we proposed phyBWT2 an alignment-, assembly- and reference-free method to build the phylogeny inference of a set of taxa. The phyBWT2 method is a new version of phyBWT  [<xref ref-type="bibr" rid="CR11">11</xref>] that includes improvements on the phylogenetic reconstruction strategy, as well as on the performance in both running time and memory usage. In fact, phyBWT2 is shown to reduce the number of iterations performed, and by keeping the data structures on disk it extremely reduces the main memory usage. To this extent, the implementation of phyBWT2 reads portions of <inline-formula id="IEq349"><alternatives><tex-math id="M701">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M702"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq349.gif"/></alternatives></inline-formula>, as well as of <inline-formula id="IEq350"><alternatives><tex-math id="M703">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M704"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq350.gif"/></alternatives></inline-formula> and <inline-formula id="IEq351"><alternatives><tex-math id="M705">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {cda} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M706"><mml:mrow><mml:mi mathvariant="sans-serif">cda</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq351.gif"/></alternatives></inline-formula>, and without the need of loading them in main memory, it performs the cluster detection by reducing on-the-fly the input data structures to any <inline-formula id="IEq352"><alternatives><tex-math id="M707">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {R}\subset \mathcal {S}$$\end{document}</tex-math><mml:math id="M708"><mml:mrow><mml:mi mathvariant="script">R</mml:mi><mml:mo>⊂</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq352.gif"/></alternatives></inline-formula> (i.e. by deducing <inline-formula id="IEq353"><alternatives><tex-math id="M709">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} (\mathcal {R})$$\end{document}</tex-math><mml:math id="M710"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq353.gif"/></alternatives></inline-formula>, <inline-formula id="IEq354"><alternatives><tex-math id="M711">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} (\mathcal {R})$$\end{document}</tex-math><mml:math id="M712"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq354.gif"/></alternatives></inline-formula> and <inline-formula id="IEq355"><alternatives><tex-math id="M713">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {cda} (\mathcal {R})$$\end{document}</tex-math><mml:math id="M714"><mml:mrow><mml:mi mathvariant="sans-serif">cda</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq355.gif"/></alternatives></inline-formula>) from <inline-formula id="IEq356"><alternatives><tex-math id="M715">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M716"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq356.gif"/></alternatives></inline-formula>, <inline-formula id="IEq357"><alternatives><tex-math id="M717">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M718"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq357.gif"/></alternatives></inline-formula> and <inline-formula id="IEq358"><alternatives><tex-math id="M719">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {cda} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M720"><mml:mrow><mml:mi mathvariant="sans-serif">cda</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq358.gif"/></alternatives></inline-formula>.</p>
    <p id="Par182">To the best of our knowledge, phyBWT and phyBWT2 are the first methods that apply the properties of the Extended Burrows-Wheeler Transform (eBWT) to the idea of phylogenetic reconstruction. Both approaches are based on the eBWT positional cluster framework introduced in [<xref ref-type="bibr" rid="CR19">19</xref>], which allowed us to consider longest shared substrings of varying length, unlike <italic>k</italic>-mer-based approaches such as SANS.</p>
    <p id="Par183">Differently from phyBWT, phyBWT2 combines the inner algorithm based on the eBWT positional clustering to a refinement procedure that reconstructs a phylogeny step-by-step by considering multiple partitions at each step, instead of just one partition as done by phyBWT.</p>
    <p id="Par184">We tested our method on several sequencing datasets, with short reads and de novo assembled sequences. The experimental results show that our algorithm produces trees comparable to the benchmark phylogeny and to the recently introduced tool SANS.</p>
    <p id="Par185">Our current implementation requires a preprocessing phase in order to compute the input data structures (<inline-formula id="IEq359"><alternatives><tex-math id="M721">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt}$$\end{document}</tex-math><mml:math id="M722"><mml:mi mathvariant="sans-serif">ebwt</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq359.gif"/></alternatives></inline-formula>, <inline-formula id="IEq360"><alternatives><tex-math id="M723">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp}$$\end{document}</tex-math><mml:math id="M724"><mml:mi mathvariant="sans-serif">lcp</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq360.gif"/></alternatives></inline-formula> and <inline-formula id="IEq361"><alternatives><tex-math id="M725">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {cda}$$\end{document}</tex-math><mml:math id="M726"><mml:mi mathvariant="sans-serif">cda</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq361.gif"/></alternatives></inline-formula>), which are at the heart of several other text and string algorithms. Thus, evaluating the best tool or the combination of tools for the pre-processing phase is out of the scope of this work. More efficient tools for computing them can appear in the literature improving both the time and the memory requirements.</p>
    <p id="Par186">Moreover, the input data structures we used are independent of the parameter settings, so they can be computed only once and re-used for different runs of phyBWT2. Indeed, by using different types of data (e.g. genomes rather than short reads) phyBWT2 parameters may need to be fine-tuned, and there is no need of rebuilding from scratch the input data structures when changing phyBWT2 parameters. The same remarkable feature does not hold for <italic>k</italic>-mer-based approach, such as for instance SANS.</p>
    <p id="Par187">Phylogenetic analysis is a common practice in HIV studies [<xref ref-type="bibr" rid="CR56">56</xref>, <xref ref-type="bibr" rid="CR58">58</xref>]. Experimentally we show phyBWT2 is able to distinctly group together the HIV-1 subtypes and to grasp the relationships among the subtypes. Virus subtypes can be clinically significant owing to their associations with variation in pathogenesis.</p>
    <p id="Par188">While the worst-case complexity of the method is competitive with existing methods, there are interesting directions for further optimization, such as using Colored Range Queries [<xref ref-type="bibr" rid="CR59">59</xref>] to speed up identification of colors in the various clusters, or exploiting the bounded length of the reads to overcome the computational bottleneck of computing the eBWT and related data structures. A further improvement could include internally to phyBWT2 the bootstrapping of the reconstructed tree, for instance by ranging the value <inline-formula id="IEq362"><alternatives><tex-math id="M727">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m$$\end{document}</tex-math><mml:math id="M728"><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq362.gif"/></alternatives></inline-formula> to vary eBWT positional clusters.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec27">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13015_2023_232_MOESM1_ESM.xlsx">
            <caption>
              <p><bold>Additional file 1: </bold>Dataset information. Descriptions and information to download the datasets used and analysed in the current study.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>BWT</term>
        <def>
          <p id="Par5">Burrows-Wheeler transform</p>
        </def>
      </def-item>
      <def-item>
        <term>eBWT</term>
        <def>
          <p id="Par6">Extended Burrows-Wheeler transform</p>
        </def>
      </def-item>
      <def-item>
        <term>DA</term>
        <def>
          <p id="Par7">Document array</p>
        </def>
      </def-item>
      <def-item>
        <term>LCP</term>
        <def>
          <p id="Par8">Longest common prefix</p>
        </def>
      </def-item>
      <def-item>
        <term>SA</term>
        <def>
          <p id="Par9">Suffix array</p>
        </def>
      </def-item>
      <def-item>
        <term>CDA</term>
        <def>
          <p id="Par10">Color document array</p>
        </def>
      </def-item>
      <def-item>
        <term>SRA</term>
        <def>
          <p id="Par11">Short reads archive</p>
        </def>
      </def-item>
      <def-item>
        <term>HIV</term>
        <def>
          <p id="Par12">Human immunodeficiency virus</p>
        </def>
      </def-item>
      <def-item>
        <term>iTOL</term>
        <def>
          <p id="Par13">Interactive tree of life</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn id="Fn1">
      <label>1</label>
      <p id="Par28"><ext-link ext-link-type="uri" xlink:href="https://github.com/veronicaguerrini/phyBWT">https://github.com/veronicaguerrini/phyBWT</ext-link>.</p>
    </fn>
    <fn id="Fn2">
      <label>2</label>
      <p id="Par32">Note that, in the implementations, one can use a single symbol as end-marker for all strings, but end-markers from different strings are then sorted on the basis of their index and the relative order of the strings in the collection they belong to.</p>
    </fn>
    <fn id="Fn3">
      <label>3</label>
      <p id="Par119">In practice, we can stop at <italic>X</italic> instead of the root to consider fewer nodes, but the worst-case complexity is the same.</p>
    </fn>
    <fn id="Fn4">
      <label>4</label>
      <p id="Par128"><ext-link ext-link-type="uri" xlink:href="https://gitlab.ub.uni-bielefeld.de/gi/sans">https://gitlab.ub.uni-bielefeld.de/gi/sans</ext-link>, downloaded in January 2023.</p>
    </fn>
    <fn id="Fn5">
      <label>5</label>
      <p id="Par134">Except the trees in Figs. <xref rid="Fig4" ref-type="fig">4</xref>, <xref rid="Fig5" ref-type="fig">5</xref>, and <xref rid="Fig6" ref-type="fig">6</xref> already in the conference paper [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
    </fn>
    <fn id="Fn6">
      <label>6</label>
      <p id="Par149">
        <ext-link ext-link-type="uri" xlink:href="http://flybase.org/">http://flybase.org/</ext-link>
      </p>
    </fn>
    <fn id="Fn7">
      <label>7</label>
      <p id="Par163">
        <ext-link ext-link-type="uri" xlink:href="http://www.hiv.lanl.gov/">http://www.hiv.lanl.gov/</ext-link>
      </p>
    </fn>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Matteo De Chiara for discussions.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>VG, AC, RG and GR designed the method. VG implemented the tool. VG, AC, RG and GR contributed to interpreting the results. LT and GL provided the yeast datasets and contributed to interpreting the related results. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>VG is totally, RG and GR are partially, funded by PNRR—M4C2—Investimento 1.5, Ecosistema dell’Innovazione ECS00000017—“THE—Tuscany Health Ecosystem”—Spoke 6 “Precision medicine &amp; personalized healthcare”, CUP I53C22000780001, funded by the European Commission under the NextGeneration EU programme.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The tool phyBWT2 is freely available for academic use at <ext-link ext-link-type="uri" xlink:href="https://github.com/veronicaguerrini/phyBWT2">https://github.com/veronicaguerrini/phyBWT2</ext-link>. Information to download the datasets used and analysed in the current study is available as Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>The source code is freely available for academic use at: <ext-link ext-link-type="uri" xlink:href="https://github.com/veronicaguerrini/phyBWT2">https://github.com/veronicaguerrini/phyBWT2</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar14">
      <title>Ethics approval and consent to participate</title>
      <p id="Par195">Not applicable.</p>
    </notes>
    <notes id="FPar16">
      <title>Consent for publication</title>
      <p id="Par197">Not applicable</p>
    </notes>
    <notes id="FPar15" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par196">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gallone</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Steensels</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mertens</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dzialo</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Gordon</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Wauters</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Theßeling</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Bellinazzo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Saels</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Herrera-Malaver</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Prahl</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hutzler</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Meußdoerffer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Malcorps</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Souffriau</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Daenen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Baele</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Maere</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Verstrepen</surname>
            <given-names>KJ</given-names>
          </name>
        </person-group>
        <article-title>Interspecific hybridization facilitates niche adaptation in beer yeast</article-title>
        <source>Nat Ecol Evol</source>
        <year>2019</year>
        <volume>3</volume>
        <issue>11</issue>
        <fpage>1562</fpage>
        <lpage>1575</lpage>
        <pub-id pub-id-type="doi">10.1038/s41559-019-0997-9</pub-id>
        <?supplied-pmid 31636425?>
        <pub-id pub-id-type="pmid">31636425</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tattini</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Tellini</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Mozzachiodi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>D’Angiolo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Loeillet</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nicolas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Liti</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Accurate tracking of the mutational landscape of diploid hybrid genomes</article-title>
        <source>Mol Biol Evol</source>
        <year>2019</year>
        <pub-id pub-id-type="doi">10.1093/molbev/msz177</pub-id>
        <?supplied-pmid 31397846?>
        <pub-id pub-id-type="pmid">31397846</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>D’Angiolo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>De Chiara</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yue</surname>
            <given-names>J-X</given-names>
          </name>
          <name>
            <surname>Irizar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stenberg</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Persson</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Llored</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Barré</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Schacherer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Marangoni</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gilson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Warringer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Liti</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>A yeast living ancestor reveals the origin of genomic introgressions</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>587</volume>
        <issue>7834</issue>
        <fpage>420</fpage>
        <lpage>425</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-2889-1</pub-id>
        <?supplied-pmid 33177709?>
        <pub-id pub-id-type="pmid">33177709</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Soucy</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gogarten</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Horizontal gene transfer: building the web of life</article-title>
        <source>Nat Rev Genet</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>8</issue>
        <fpage>472</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3962</pub-id>
        <?supplied-pmid 26184597?>
        <pub-id pub-id-type="pmid">26184597</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Rannala</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Molecular phylogenetics: principles and practice</article-title>
        <source>Nat Rev Genet</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>303</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3186</pub-id>
        <?supplied-pmid 22456349?>
        <pub-id pub-id-type="pmid">22456349</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <source>Computational phylogenetics: an introduction to designing methods for phylogeny estimation</source>
        <year>2017</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Cambridge University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saitou</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Nei</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The neighbor-joining method: a new method for reconstructing phylogenetic trees</article-title>
        <source>Molecular biology and evolution</source>
        <year>1987</year>
        <volume>4</volume>
        <issue>4</issue>
        <fpage>406</fpage>
        <lpage>425</lpage>
        <?supplied-pmid 3447015?>
        <pub-id pub-id-type="pmid">3447015</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vinga</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Almeida</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Alignment-free sequence comparison—a review</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <issue>4</issue>
        <fpage>513</fpage>
        <lpage>523</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btg005</pub-id>
        <?supplied-pmid 12611807?>
        <pub-id pub-id-type="pmid">12611807</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Vinga</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <source>Alignment-free methods in computational biology</source>
        <year>2014</year>
        <publisher-loc>Oxford</publisher-loc>
        <publisher-name>Oxford University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zielezinski</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vinga</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Almeida</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Karlowski</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Alignment-free sequence comparison: benefits, applications, and tools</article-title>
        <source>Genome Biol</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>186</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1319-7</pub-id>
        <?supplied-pmid 28974235?>
        <pub-id pub-id-type="pmid">28974235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Guerrini V, Conte A, Grossi R, Liti G, Rosone G, Tattini L. phyBWT: Alignment-Free Phylogeny via eBWT Positional Clustering. In: Boucher C, Rahmann S, editors. 22nd International Workshop on Algorithms in Bioinformatics (WABI 2022). LIPIcs, vol. 242. Dagstuhl: Schloss Dagstuhl—Leibniz-Zentrum für Informatik; 2022. p. 23–12319. 10.4230/LIPIcs.WABI.2022.23.</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prezza</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pisanti</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Sciortino</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rosone</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>SNPs detection by eBWT positional clustering</article-title>
        <source>Algorithm Mol Biol</source>
        <year>2019</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>3</fpage>
        <pub-id pub-id-type="doi">10.1186/s13015-019-0137-8</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Burrows M, Wheeler DJ. A block sorting data compression algorithm. DIGITAL System Research Center: Technical report; 1994.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mantaci</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Restivo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rosone</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sciortino</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>An extension of the Burrows-Wheeler transform</article-title>
        <source>Theor Comput Sci</source>
        <year>2007</year>
        <volume>387</volume>
        <issue>3</issue>
        <fpage>298</fpage>
        <lpage>312</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tcs.2007.07.014</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bauer</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Cox</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Rosone</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Lightweight algorithms for constructing and inverting the BWT of string collections</article-title>
        <source>Theor Comput Sci</source>
        <year>2013</year>
        <volume>483</volume>
        <fpage>134</fpage>
        <lpage>148</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tcs.2012.02.002</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mantaci</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Restivo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rosone</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sciortino</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A new combinatorial approach to sequence comparison</article-title>
        <source>Theor Comput Syst</source>
        <year>2008</year>
        <volume>42</volume>
        <issue>3</issue>
        <fpage>411</fpage>
        <lpage>429</lpage>
        <pub-id pub-id-type="doi">10.1007/s00224-007-9078-6</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>The Burrows-Wheeler similarity distribution between biological sequences based on Burrows-Wheeler transform</article-title>
        <source>J Theor Biol</source>
        <year>2010</year>
        <volume>262</volume>
        <issue>4</issue>
        <fpage>742</fpage>
        <lpage>749</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jtbi.2009.10.033</pub-id>
        <?supplied-pmid 19903487?>
        <pub-id pub-id-type="pmid">19903487</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guerrini</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Louza</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Rosone</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Metagenomic analysis through the extended Burrows-Wheeler transform</article-title>
        <source>BMC Bioinform</source>
        <year>2020</year>
        <pub-id pub-id-type="doi">10.1186/s12859-020-03628-w</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prezza</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pisanti</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Sciortino</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rosone</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Variable-order reference-free variant discovery with the Burrows-Wheeler transform</article-title>
        <source>BMC Bioinform</source>
        <year>2020</year>
        <pub-id pub-id-type="doi">10.1186/s12859-020-03586-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Guerrini V, Louza F, Rosone G. Lossy compressor preserving variant calling through extended BWT. In: BIOSTEC/BIOINFORMATICS, INSTICC, SciTePress, 2022. p. 38–48. 10.5220/0010834100003123.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bandelt</surname>
            <given-names>H-J</given-names>
          </name>
          <name>
            <surname>Dress</surname>
            <given-names>AWM</given-names>
          </name>
        </person-group>
        <article-title>A canonical decomposition theory for metrics on a finite set</article-title>
        <source>Adv Math</source>
        <year>1992</year>
        <volume>92</volume>
        <issue>1</issue>
        <fpage>47</fpage>
        <lpage>105</lpage>
        <pub-id pub-id-type="doi">10.1016/0001-8708(92)90061-O</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Bandelt H-J, Huber KT, Koolen JH, Moulton V, Spillner A. Basic Phylogenetic Combinatorics. Cambridge: Cambridge University Press, 2012. 10.1017/CBO9781139019767.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bandelt</surname>
            <given-names>H-J</given-names>
          </name>
          <name>
            <surname>Dress</surname>
            <given-names>AWM</given-names>
          </name>
        </person-group>
        <article-title>Split decomposition: a new and useful approach to phylogenetic analysis of distance data</article-title>
        <source>Mol Phylogenet Evol</source>
        <year>1992</year>
        <volume>1</volume>
        <issue>3</issue>
        <fpage>242</fpage>
        <lpage>252</lpage>
        <pub-id pub-id-type="doi">10.1016/1055-7903(92)90021-8</pub-id>
        <?supplied-pmid 1342941?>
        <pub-id pub-id-type="pmid">1342941</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Wittler R. Alignment- and reference-free phylogenomics with colored de bruijn graphs. In: 19th International Workshop on Algorithms in Bioinformatics (WABI 2019), vol. 143, Dagstuhl: Schloss Dagstuhl–Leibniz-Zentrum fuer Informatik; 2019. p. 2–1214. 10.4230/LIPIcs.WABI.2019.2.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rempel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wittler</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>SANS serif: alignment-free, whole-genome-based phylogenetic reconstruction</article-title>
        <source>Bioinformatics</source>
        <year>2021</year>
        <volume>37</volume>
        <issue>24</issue>
        <fpage>4868</fpage>
        <lpage>4870</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btab444</pub-id>
        <?supplied-pmid 34132752?>
        <pub-id pub-id-type="pmid">34132752</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huson</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Bryant</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Application of phylogenetic networks in evolutionary studies</article-title>
        <source>Mol Biol Evol</source>
        <year>2005</year>
        <volume>23</volume>
        <issue>2</issue>
        <fpage>254</fpage>
        <lpage>267</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msj030</pub-id>
        <?supplied-pmid 16221896?>
        <pub-id pub-id-type="pmid">16221896</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Jansson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sung</surname>
            <given-names>W-K</given-names>
          </name>
        </person-group>
        <source>Algorithms for combining rooted triplets into a galled phylogenetic network</source>
        <year>2016</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <fpage>48</fpage>
        <lpage>52</lpage>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Jansson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sung</surname>
            <given-names>W-K</given-names>
          </name>
        </person-group>
        <source>Maximum agreement supertree</source>
        <year>2016</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <fpage>1224</fpage>
        <lpage>1227</lpage>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Manber U, Myers G. Suffix arrays: a new method for on-line string searches. In: ACM-SIAM SODA, 1990:319–27.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abouelhoda</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Kurtz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ohlebusch</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Replacing suffix trees with enhanced suffix arrays</article-title>
        <source>J Dis Algorithm</source>
        <year>2004</year>
        <volume>2</volume>
        <issue>1</issue>
        <fpage>53</fpage>
        <lpage>86</lpage>
        <pub-id pub-id-type="doi">10.1016/S1570-8667(03)00065-0</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Navarro</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Indexing highly repetitive string collections, part II: compressed indexes</article-title>
        <source>ACM Comput Surv</source>
        <year>2022</year>
        <volume>54</volume>
        <issue>2</issue>
        <fpage>26</fpage>
        <lpage>12632</lpage>
        <pub-id pub-id-type="doi">10.1145/3432999</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Letunic</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Interactive tree of life (iTOL) v5: an online tool for phylogenetic tree display and annotation</article-title>
        <source>Nucleic Acids Res</source>
        <year>2021</year>
        <volume>49</volume>
        <issue>W1</issue>
        <fpage>293</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkab301</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yue</surname>
            <given-names>J-X</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Aigrain</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hallin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Persson</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Oliver</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bergström</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Coupland</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Warringer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lagomarsino</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Fischer</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Liti</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Contrasting evolutionary genome dynamics between domesticated and wild yeasts</article-title>
        <source>Nat Genet</source>
        <year>2017</year>
        <volume>49</volume>
        <issue>6</issue>
        <fpage>913</fpage>
        <lpage>924</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.3847</pub-id>
        <?supplied-pmid 28416820?>
        <pub-id pub-id-type="pmid">28416820</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crosby</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Goodman</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Strelets</surname>
            <given-names>VB</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gelbart</surname>
            <given-names>WM</given-names>
          </name>
          <name>
            <surname>Consortium</surname>
            <given-names>TF</given-names>
          </name>
        </person-group>
        <article-title>FlyBase: genomes by the dozen</article-title>
        <source>Nucleic Acids Res</source>
        <year>2006</year>
        <volume>35</volume>
        <issue>suppl.1</issue>
        <fpage>486</fpage>
        <lpage>491</lpage>
        <pub-id pub-id-type="pmid">17169988</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Istace</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Friedrich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>d’Agata</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Faye</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Payen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Beluche</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Caradec</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Davidas</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cruaud</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Liti</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lemainque</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Engelen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wincker</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Schacherer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Aury</surname>
            <given-names>J-M</given-names>
          </name>
        </person-group>
        <article-title>De novo assembly and population genomic survey of natural yeast isolates with the Oxford Nanopore MinION sequencer</article-title>
        <source>GigaScience</source>
        <year>2017</year>
        <pub-id pub-id-type="doi">10.1093/gigascience/giw018</pub-id>
        <?supplied-pmid 28369459?>
        <pub-id pub-id-type="pmid">28369459</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yue</surname>
            <given-names>J-X</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Aigrain</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hallin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Persson</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Oliver</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bergström</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Coupland</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Warringer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lagomarsino</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Fischer</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Liti</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Contrasting evolutionary genome dynamics between domesticated and wild yeasts</article-title>
        <source>Nat Genet</source>
        <year>2017</year>
        <volume>49</volume>
        <issue>6</issue>
        <fpage>913</fpage>
        <lpage>924</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.3847</pub-id>
        <?supplied-pmid 28416820?>
        <pub-id pub-id-type="pmid">28416820</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>X-F</given-names>
          </name>
          <name>
            <surname>Hoang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Goebel</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Nucleotide composition string selection in HIV-1 subtyping using whole genomes</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <issue>14</issue>
        <fpage>1744</fpage>
        <lpage>1752</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm248</pub-id>
        <?supplied-pmid 17495995?>
        <pub-id pub-id-type="pmid">17495995</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gire</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Goba</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Andersen</surname>
            <given-names>KG</given-names>
          </name>
          <name>
            <surname>Sealfon</surname>
            <given-names>RSG</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Kanneh</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Jalloh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Momoh</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fullah</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dudas</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Wohl</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Moses</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Yozwiak</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Winnicki</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Matranga</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Malboeuf</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Qu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gladden</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Schaffner</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>P-P</given-names>
          </name>
          <name>
            <surname>Nekoui</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Colubri</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Coomber</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Fonnie</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Moigboi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gbakie</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kamara</surname>
            <given-names>FK</given-names>
          </name>
          <name>
            <surname>Tucker</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Konuwa</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Saffa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sellu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jalloh</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Kovoma</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Koninga</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mustapha</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Kargbo</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Foday</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yillah</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kanneh</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Robert</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Massally</surname>
            <given-names>JLB</given-names>
          </name>
          <name>
            <surname>Chapman</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Bochicchio</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Nusbaum</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Birren</surname>
            <given-names>BW</given-names>
          </name>
          <name>
            <surname>Grant</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Scheiffelin</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Happi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gevao</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Gnirke</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rambaut</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Garry</surname>
            <given-names>RF</given-names>
          </name>
          <name>
            <surname>Khan</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Sabeti</surname>
            <given-names>PC</given-names>
          </name>
        </person-group>
        <article-title>Genomic surveillance elucidates Ebola virus origin and transmission during the 2014 outbreak</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>345</volume>
        <issue>6202</issue>
        <fpage>1369</fpage>
        <lpage>1372</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1259657</pub-id>
        <?supplied-pmid 25214632?>
        <pub-id pub-id-type="pmid">25214632</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kendall</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Colijn</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Mapping phylogenetic trees to reveal distinct patterns of evolution</article-title>
        <source>Mol Biol Evol</source>
        <year>2016</year>
        <volume>33</volume>
        <issue>10</issue>
        <fpage>2735</fpage>
        <lpage>2743</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msw124</pub-id>
        <?supplied-pmid 27343287?>
        <pub-id pub-id-type="pmid">27343287</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Skippington</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Ragan</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>Within-species lateral genetic transfer and the evolution of transcriptional regulation in <italic>Escherichia coli</italic> and shigella</article-title>
        <source>BMC Genomics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>532</fpage>
        <lpage>532</lpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-12-532</pub-id>
        <?supplied-pmid 22035052?>
        <pub-id pub-id-type="pmid">22035052</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zielezinski</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Girgis</surname>
            <given-names>HZ</given-names>
          </name>
          <name>
            <surname>Bernard</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Leimeister</surname>
            <given-names>C-A</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dencker</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Lau</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Röhling</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Choi</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Waterman</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Comin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>S-H</given-names>
          </name>
          <name>
            <surname>Vinga</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Almeida</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>CX</given-names>
          </name>
          <name>
            <surname>James</surname>
            <given-names>BT</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Morgenstern</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Karlowski</surname>
            <given-names>WM</given-names>
          </name>
        </person-group>
        <article-title>Benchmarking of alignment-free sequence comparison methods</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>144</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1755-7</pub-id>
        <?supplied-pmid 31345254?>
        <pub-id pub-id-type="pmid">31345254</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cox</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Garofalo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Rosone</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sciortino</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Lightweight LCP construction for very large collections of strings</article-title>
        <source>J Dis Algorithm</source>
        <year>2016</year>
        <volume>37</volume>
        <fpage>17</fpage>
        <lpage>33</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jda.2016.03.003</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Egidi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Louza</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Manzini</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Telles</surname>
            <given-names>GP</given-names>
          </name>
        </person-group>
        <article-title>External memory BWT and LCP computation for sequence collections with applications</article-title>
        <source>Algorithm Mol Biol</source>
        <year>2019</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>6</fpage>
        <lpage>1615</lpage>
        <pub-id pub-id-type="doi">10.1186/s13015-019-0140-0</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bonizzoni</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Della Vedova</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Pirola</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Previtali</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rizzi</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Multithread multistring Burrows-Wheeler transform and longest common prefix array</article-title>
        <source>J Comput Biol</source>
        <year>2019</year>
        <volume>26</volume>
        <issue>9</issue>
        <fpage>948</fpage>
        <lpage>961</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2018.0230</pub-id>
        <?supplied-pmid 31140836?>
        <pub-id pub-id-type="pmid">31140836</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Louza</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Telles</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Gog</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Prezza</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Rosone</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>gsufsort: constructing suffix arrays, LCP arrays and BWTS for string collections</article-title>
        <source>Algorithm Mol Biol</source>
        <year>2020</year>
        <pub-id pub-id-type="doi">10.1186/s13015-020-00177-y</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prezza</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Rosone</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Space-efficient construction of compressed suffix trees</article-title>
        <source>Theor Comput Sci</source>
        <year>2021</year>
        <volume>852</volume>
        <fpage>138</fpage>
        <lpage>156</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tcs.2020.11.024</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Boucher</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cenzato</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lipták</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Rossi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sciortino</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Lecroq</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Touzet</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Computing the original EBWT faster, simpler, and with less memory</article-title>
        <source>SPIRE</source>
        <year>2021</year>
        <publisher-loc>Berlin</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <fpage>129</fpage>
        <lpage>142</lpage>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <mixed-citation publication-type="other">Díaz-Domínguez D, Navarro G. Efficient construction of the BWT for repetitive text using string compression. In: CPM 2022. LIPIcs, vol. 223, 2022. p. 29–12918.</mixed-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boucher</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gagie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kuhnle</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Manzini</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Mun</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Prefix-free parsing for building big BWTS</article-title>
        <source>Algorithm Mol Biol</source>
        <year>2019</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>13</fpage>
        <lpage>11315</lpage>
        <pub-id pub-id-type="doi">10.1186/s13015-019-0148-5</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bolger</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Lohse</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Usadel</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Trimmomatic: a flexible trimmer for illumina sequence data</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>15</issue>
        <fpage>2114</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu170</pub-id>
        <?supplied-pmid 24695404?>
        <pub-id pub-id-type="pmid">24695404</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peter</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>De Chiara</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Friedrich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yue</surname>
            <given-names>J-X</given-names>
          </name>
          <name>
            <surname>Pflieger</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bergström</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sigwalt</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Barre</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Freel</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Llored</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cruaud</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Labadie</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Aury</surname>
            <given-names>J-M</given-names>
          </name>
          <name>
            <surname>Istace</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lebrigand</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Barbry</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Engelen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lemainque</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wincker</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Schacherer</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Genome evolution across 1011 <italic>Saccharomyces cerevisiae</italic> isolates</article-title>
        <source>Nature</source>
        <year>2018</year>
        <pub-id pub-id-type="doi">10.1038/s41586-018-0030-5</pub-id>
        <?supplied-pmid 30397346?>
        <pub-id pub-id-type="pmid">30397346</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Donnell</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yue</surname>
            <given-names>J-X</given-names>
          </name>
          <name>
            <surname>Abou Saada</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Agier</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Caradec</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cokelaer</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>De Chiara</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Delmas</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dutreux</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Fournier</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Friedrich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kornobis</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Miao</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Tattini</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Schacherer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Liti</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Fisher</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>142 telomere-to-telomere assemblies reveal the genome structural landscape in <italic>Saccharomyces cerevisiae</italic></article-title>
        <source>bioRxiv</source>
        <year>2022</year>
        <pub-id pub-id-type="doi">10.1101/2022.10.04.510633</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Minh</surname>
            <given-names>BQ</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Chernomor</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Schrempf</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Woodhams</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>von Haeseler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lanfear</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>IQ-TREE 2: New models and efficient methods for phylogenetic inference in the genomic era</article-title>
        <source>Mol Biol Evol</source>
        <year>2020</year>
        <volume>37</volume>
        <issue>5</issue>
        <fpage>1530</fpage>
        <lpage>1534</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msaa015</pub-id>
        <?supplied-pmid 32011700?>
        <pub-id pub-id-type="pmid">32011700</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoang</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Chernomor</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>von Haeseler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Minh</surname>
            <given-names>BQ</given-names>
          </name>
          <name>
            <surname>Vinh</surname>
            <given-names>LS</given-names>
          </name>
        </person-group>
        <article-title>UFBoot 2: Improving the ultrafast bootstrap approximation</article-title>
        <source>Mol Biol Evol</source>
        <year>2018</year>
        <volume>35</volume>
        <issue>2</issue>
        <fpage>518</fpage>
        <lpage>522</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msx281</pub-id>
        <?supplied-pmid 29077904?>
        <pub-id pub-id-type="pmid">29077904</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kalyaanamoorthy</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Minh</surname>
            <given-names>BQ</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>TKF</given-names>
          </name>
          <name>
            <surname>von Haeseler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jermiin</surname>
            <given-names>LS</given-names>
          </name>
        </person-group>
        <article-title>Modelfinder: fast model selection for accurate phylogenetic estimates</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>6</issue>
        <fpage>587</fpage>
        <lpage>589</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4285</pub-id>
        <?supplied-pmid 28481363?>
        <pub-id pub-id-type="pmid">28481363</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <mixed-citation publication-type="other">Leitner T, Korber B, Daniels M, Calef C, Foley B. HIV-1 Subtype and circulating recombinant form (CRF) reference sequences. Theoretical Biology and Biophysics Group, Los Alamos National Laboratory 2005. <ext-link ext-link-type="uri" xlink:href="https://www.hiv.lanl.gov/content/sequence/HIV/REVIEWS/LEITNER2005/leitner.html">https://www.hiv.lanl.gov/content/sequence/HIV/REVIEWS/LEITNER2005/leitner.html</ext-link>. Accessed 30 Mar 2023.</mixed-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>MR</given-names>
          </name>
        </person-group>
        <article-title>Information theoretic generalized Robinson-Foulds metrics for comparing phylogenetic trees</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>20</issue>
        <fpage>5007</fpage>
        <lpage>5013</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa614</pub-id>
        <?supplied-pmid 32619004?>
        <pub-id pub-id-type="pmid">32619004</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Castro-Nallar</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Pérez-Losada</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Burton</surname>
            <given-names>GF</given-names>
          </name>
          <name>
            <surname>Crandall</surname>
            <given-names>KA</given-names>
          </name>
        </person-group>
        <article-title>The evolution of HIV: inferences using phylogenetics</article-title>
        <source>Mol Phylogenet Evol</source>
        <year>2012</year>
        <volume>62</volume>
        <issue>2</issue>
        <fpage>777</fpage>
        <lpage>792</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ympev.2011.11.019</pub-id>
        <?supplied-pmid 22138161?>
        <pub-id pub-id-type="pmid">22138161</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gagie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kärkkäinen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Navarro</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Puglisi</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>Colored range queries and document retrieval</article-title>
        <source>Theor Comput Sci</source>
        <year>2013</year>
        <volume>483</volume>
        <fpage>36</fpage>
        <lpage>50</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tcs.2012.08.004</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Algorithms Mol Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Algorithms Mol Biol</journal-id>
    <journal-title-group>
      <journal-title>Algorithms for Molecular Biology : AMB</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1748-7188</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10399073</article-id>
    <article-id pub-id-type="pmid">37537624</article-id>
    <article-id pub-id-type="publisher-id">232</article-id>
    <article-id pub-id-type="doi">10.1186/s13015-023-00232-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>phyBWT2: phylogeny reconstruction via eBWT positional clustering</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Guerrini</surname>
          <given-names>Veronica</given-names>
        </name>
        <address>
          <email>veronica.guerrini@unipi.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Conte</surname>
          <given-names>Alessio</given-names>
        </name>
        <address>
          <email>alessio.conte@unipi.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Grossi</surname>
          <given-names>Roberto</given-names>
        </name>
        <address>
          <email>roberto.grossi@unipi.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liti</surname>
          <given-names>Gianni</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Rosone</surname>
          <given-names>Giovanna</given-names>
        </name>
        <address>
          <email>giovanna.rosone@unipi.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tattini</surname>
          <given-names>Lorenzo</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/03ad39j10</institution-id><institution-id institution-id-type="GRID">grid.5395.a</institution-id><institution-id institution-id-type="ISNI">0000 0004 1757 3729</institution-id><institution>Dipartimento di Informatica, </institution><institution>University of Pisa, </institution></institution-wrap>Pisa, Italy </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.4444.0</institution-id><institution-id institution-id-type="ISNI">0000 0001 2112 9282</institution-id><institution>CNRS UMR 7284, INSERM U1081 Université Côte d’Azu, </institution></institution-wrap>Nice, France </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>3</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>3</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>18</volume>
    <elocation-id>11</elocation-id>
    <history>
      <date date-type="received">
        <day>31</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>6</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Molecular phylogenetics studies the evolutionary relationships among the individuals of a population through their biological sequences. It may provide insights about the origin and the evolution of viral diseases, or highlight complex evolutionary trajectories. A key task is inferring phylogenetic trees from any type of sequencing data, including raw short reads. Yet, several tools require pre-processed input data e.g. from complex computational pipelines based on <italic>de novo</italic> assembly or from mappings against a reference genome. As sequencing technologies keep becoming cheaper, this puts increasing pressure on designing methods that perform analysis directly on their outputs. From this viewpoint, there is a growing interest in alignment-, assembly-, and reference-free methods that could work on several data including raw reads data.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We present phyBWT2, a newly improved version of phyBWT (Guerrini et al. in 22nd International Workshop on Algorithms in Bioinformatics (WABI) 242:23–12319, 2022). Both of them directly reconstruct phylogenetic trees bypassing both the alignment against a reference genome and de novo assembly. They exploit the combinatorial properties of the extended Burrows-Wheeler Transform (eBWT) and the corresponding eBWT positional clustering framework to detect relevant blocks of the longest shared substrings of varying length (unlike the <italic>k</italic>-mer-based approaches that need to fix the length <italic>k</italic> a priori). As a result, they provide novel alignment-, assembly-, and reference-free methods that build partition trees without relying on the pairwise comparison of sequences, thus avoiding to use a distance matrix to infer phylogeny. In addition, phyBWT2 outperforms phyBWT in terms of running time, as the former reconstructs phylogenetic trees step-by-step by considering multiple partitions, instead of just one partition at a time, as previously done by the latter.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Based on the results of the experiments on sequencing data, we conclude that our method can produce trees of quality comparable to the benchmark phylogeny by handling datasets of different types (short reads, contigs, or entire genomes). Overall, the experiments confirm the effectiveness of phyBWT2 that improves the performance of its previous version phyBWT, while preserving the accuracy of the results.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13015-023-00232-4.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Phylogeny</kwd>
      <kwd>Partition tree</kwd>
      <kwd>BWT</kwd>
      <kwd>Positional cluster</kwd>
      <kwd>Alignment-free</kwd>
      <kwd>Reference-free</kwd>
      <kwd>Assembly-free</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000780</institution-id>
            <institution>European Commission</institution>
          </institution-wrap>
        </funding-source>
        <award-id>ECS00000017</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003407</institution-id>
            <institution>Ministero dell’Istruzione, dell’Università e della Ricerca</institution>
          </institution-wrap>
        </funding-source>
        <award-id>20174LF3T8</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par14">Phylogenetics concerns the study of the evolutionary history and the relationships among individuals or groups of individuals, e.g., species or several populations of one species. These relationships are inferred from heritable traits or, for instance, DNA sequences. Phylogenies, in the form of rooted or unrooted trees, can be used for several purposes: to reconstruct the ancestry of the species (or other taxa) on the tree of life, to understand the epidemiological dynamics of pathogens, and to identify and study complex evolutionary events such as hybridisation [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>], introgression [<xref ref-type="bibr" rid="CR3">3</xref>], and horizontal gene transfer [<xref ref-type="bibr" rid="CR4">4</xref>]. Thus, they are successfully employed in almost every branch of biology, including e.g. population genomics and metagenomics, ecology, and biogeography [<xref ref-type="bibr" rid="CR5">5</xref>]. Phylogeny has also important applications in the medical field, including for instance epidemiology, drug discovery and drug design. Concerning public health, pathogen outbreaks can be studied by molecular phylogenetic analysis. Indeed, the analysis of the epidemiological link between genetic sequences of a pathogen can be useful for understanding the possible sources of transmission.</p>
    <p id="Par15">A vast array of techniques for inferring phylogeny has been developed over the years [<xref ref-type="bibr" rid="CR6">6</xref>]. Sequence-based methods analyze the DNA or RNA sequences of the taxa, and are based on their similarity or dissimilarity detection. Most of them rely on a distance matrix by computing the pairwise evolutionary distances between every pair of input sequences. Standard algorithms, such as the neighbour-joining algorithm [<xref ref-type="bibr" rid="CR7">7</xref>], are then applied to the distance matrix to perform the tree reconstruction.</p>
    <p id="Par16">A key aspect is how to compute these evolutionary distances. Sequence alignment is often employed in distance computation, performed on either entire sequences or parts of them, with the optional usage of a reference genome. However, with the advent of high-throughput sequencing technologies and the completion of various genome projects, the amount of whole-genome sequencing data available has increased and a new era for phylogeny started. Owing to the rising cost of the alignment task, alignment-free approaches for quantifying the similarity/dissimilarity between sequences have been introduced. An advantage of these approaches is that they are robust for recombination and shuffling events [<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR10">10</xref>]. As the majority of alignment-free approaches for phylogenetic reconstruction performs a preliminary extraction of the <italic>k</italic>-mers (i.e. substrings of length <italic>k</italic>) from the input sequences, they can analyze directly the reads obtained from the sequencing platforms, thus avoiding the assembly of these reads and the extraction of the <italic>k</italic>-mers from the assembly.</p>
    <p id="Par17"><italic>Our contribution</italic> In this paper we present phyBWT2, a new version of our tool called phyBWT and previously introduced in [<xref ref-type="bibr" rid="CR11">11</xref>] to reconstruct a phylogenetic tree for a set of taxa. The worst-case running time of phyBWT2 is <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(N \ell )$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq1.gif"/></alternatives></inline-formula> for <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell$$\end{document}</tex-math><mml:math id="M4"><mml:mi>ℓ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq2.gif"/></alternatives></inline-formula> taxa of total length <italic>N</italic>, using <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(N + \ell ^2)$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq3.gif"/></alternatives></inline-formula> space. Like its predecessor, phyBWT2 combines many features in a single new method to reconstruct a phylogenetic tree starting from any type of data, e.g. assembled sequences as well as raw reads. Firstly, phyBWT2 is alignment-, assembly-, and reference-free, and thus it can work directly on raw sequencing reads. Secondly, it does not need a distance matrix as it does not rely on the pairwise comparison of sequences. Moreover, it exploits the combinatorial properties of the <italic>positional clustering</italic> framework recently introduced in [<xref ref-type="bibr" rid="CR12">12</xref>], overcoming the limitations of employing <italic>k</italic>-mers with fixed size <italic>k</italic> a priori.</p>
    <p id="Par18">The contribution of our approach is twofold, theoretical as well as practical. To the best of our knowledge, both phyBWT and phyBWT2 are the first to apply the properties of the Extended Burrows-Wheeler Transform (eBWT), employed in the positional clustering, to the idea of decomposition for phylogenetic inference. Not only they are oblivious to extra information, such as reference sequences or read mappings, but they also avoid the workload of assembling or aligning input sequences. Finally, they infer the tree structure by comparing all the sequences simultaneously and efficiently, instead of performing their pairwise comparisons: they do not reconstruct the tree in top-down or bottom-up directions, rather they refine the current structure simultaneously in both directions (so bottom up and top down are special cases of this more general reconstruction).</p>
    <p id="Par19">Despite these common ideas behind them, phyBWT2 improves over phyBWT in several aspects. To see why, let us briefly recall how phyBWT works. It builds the phylogenetic tree through a series of partitions performed on groups of nodes. Each partition isolates groups of taxa from the others, and phyBWT always proceeds in two opposite directions while reconstructing the tree: it goes towards the leaves by dividing each part, and towards the root by grouping the parts. Each part actually generates a node of the phylogeny tree.</p>
    <p id="Par20">In phyBWT2, the tree reconstruction strategy is different, as phyBWT2 does not consider a single partition at time, but it simultaneously handles several compatible cuts that correspond to an unrefined tree. The general idea is that an unrefined partition tree can be refined by taking one of its nodes and restricting phyBWT2 ’s attention to just the groups of taxa corresponding to its children. This restriction allows phyBWT2 to look into them to estimate phylogenetic signals.</p>
    <p id="Par21">In Sect. "<xref rid="Sec9" ref-type="sec">Experimental evaluation</xref>", we show that phyBWT2 produces phylogenic trees of quality comparable to the standard benchmarks by handling datasets of different types (short reads, contigs, or entire genomes). Furthermore, we experimentally provide evidence that phyBWT2 is more efficient than phyBWT in terms of the number of iterations performed to reconstruct a phylogenetic tree. Remarkably, phyBWT2 can keep the required data structures in external memory, thus alleviating the main memory usage. For these reasons, phyBWT2 can be considered as a replacement of our original tool phyBWT.</p>
    <p id="Par22"><italic>State of the art</italic> The Burrows-Wheeler Transform (BWT) [<xref ref-type="bibr" rid="CR13">13</xref>] of a string (and the eBWT of a set of strings [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR15">15</xref>]) is a suitable permutation of the symbols of the string(s), whose output shows a local similarity, i.e. symbols preceding similar contexts tend to occur in clusters. Both transformations have been intensively studied with important and successful applications in several areas. For instance, the eBWT has been used for defining alignment-free methods based on a pairwise distance matrix [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR16">16</xref>–<xref ref-type="bibr" rid="CR18">18</xref>] in order to build up a phylogenetic tree for mitochondrial DNA genomes. The positional clustering detects “interesting” blocks in the output of the eBWT  [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR15">15</xref>], so that the requirement on the fixed size <italic>k</italic> in <italic>k</italic>-mers is relaxed and becomes of variable-order, not fixed a priori, in an adaptive way according to the contexts. This framework has already been used in other bioinformatics tasks, such as for detecting SNPs and INDELs in short-read datasets [<xref ref-type="bibr" rid="CR19">19</xref>] and for lossy compression of FASTQ datasets [<xref ref-type="bibr" rid="CR20">20</xref>].</p>
    <p id="Par23">Both phyBWT2 and phyBWT exploit the underlying properties of the eBWT: (i) the clustering effect, i.e. the fact that the eBWT tends to group together equal symbols in the transformed string that occur in similar contexts in the input string collection; (ii) the fact that if a substring <italic>x</italic> occurs in one or more strings, then the suffixes of the input dataset starting with <italic>x</italic>-occurrence are close in the sorted list of suffixes. In other words, the greater the number of these substrings shared by two taxa is, the more they are similar.</p>
    <p id="Par24">Although phyBWT2 and phyBWT do not use a distance matrix, they have some resemblance with split decomposition methods when reconstructing the tree from the information gathered through the eBWT. We recall that split decomposition relies on a solid mathematical ground [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>], and has been successfully applied to phylogeny [<xref ref-type="bibr" rid="CR23">23</xref>]. The idea is to score the possible splits (i.e. bipartitions) of the taxa, and assign an isolation index to each split based on the distances in the given matrix. Compatible splits are those with an empty intersection on one of the parts in the splits, and the isolation index is treated as a priority weight in making a (greedy) choice among the splits. Compatible splits induce a tree and vice versa. However, a residual error is generated on real-world data, and a notion of weak split compatibility is preferred to create a weighted phylogeny network instead of a phylogeny tree: the shortest weighted part between any two nodes in this network gives the isolation index in the corresponding split. For <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell$$\end{document}</tex-math><mml:math id="M8"><mml:mi>ℓ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq4.gif"/></alternatives></inline-formula> taxa, only <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\ell ^2)$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq5.gif"/></alternatives></inline-formula> splits are needed for split decomposition instead of <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2^\ell$$\end{document}</tex-math><mml:math id="M12"><mml:msup><mml:mn>2</mml:mn><mml:mi>ℓ</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq6.gif"/></alternatives></inline-formula> ones [<xref ref-type="bibr" rid="CR21">21</xref>].</p>
    <p id="Par25">As the original algorithm in the seminal papers on split decomposition [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR23">23</xref>] requires <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\ell ^6)$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ℓ</mml:mi><mml:mn>6</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq7.gif"/></alternatives></inline-formula> comparisons, further papers have addressed efficiency and extended these ideas. The recent alignment-free method SANS [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR25">25</xref>] uses the notions of the split decomposition theory to greedily build a list of weakly compatible splits from which to infer phylogenies. In the list, each split has its own weight computed by counting <italic>k</italic>-mers that are stored in a colored de Bruijn graph [<xref ref-type="bibr" rid="CR24">24</xref>] (this has been improved later by hashing [<xref ref-type="bibr" rid="CR25">25</xref>], leaving the colored de Bruijn graph as input option). The calculated list of splits ordered by weight is then filtered according to two strategies that are described and implemented in the software tool SplitsTree [<xref ref-type="bibr" rid="CR26">26</xref>]. In our experimental study, we compare the trees obtained by SANS and phyBWT2. It should be noted that SANS is also able to reconstruct phylogenetic networks whereas phyBWT2 reconstructs phylogenetic trees only.</p>
    <p id="Par26">As previously mentioned, a plethora of methods have been designed for phylogeny reconstruction (e.g. DBLP reports over 500 papers having “phylogeny” in the title). We refer the reader to [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR28">28</xref>] for a complete and detailed review of various methods for phylogeny estimation. We briefly mention here that among the alignment-based approaches are character-based methods [<xref ref-type="bibr" rid="CR5">5</xref>], that generally produce alignments of the input sequences and compare all sequences simultaneously considering one character per time (e.g. using maximum parsimony or maximum likelihood).</p>
    <p id="Par27">A preliminary version of this paper appeared in [<xref ref-type="bibr" rid="CR11">11</xref>] with limited experiments performed using our prototype tool phyBWT  .<xref ref-type="fn" rid="Fn1">1</xref> The new version phyBWT2 replaces phyBWT.</p>
  </sec>
  <sec id="Sec2">
    <title>Preliminaries</title>
    <p id="Par29">In this section, we define the general terminology we will use throughout this paper.</p>
    <p id="Par30">Let <italic>s</italic> be a string (also called sequence) of length <italic>n</italic> on the alphabet <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Sigma$$\end{document}</tex-math><mml:math id="M16"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq8.gif"/></alternatives></inline-formula>. We denote the <italic>i</italic>-th symbol of <italic>s</italic> by <italic>s</italic>[<italic>i</italic>]. A <italic>substring</italic> of any <italic>s</italic> is denoted as <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s[i,j] = s[i] \cdots s[j]$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>⋯</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq9.gif"/></alternatives></inline-formula>, with <italic>s</italic>[1, <italic>j</italic>] being called a <italic>prefix</italic> and <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s[i,n+1]$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq10.gif"/></alternatives></inline-formula> a <italic>suffix</italic> of <italic>s</italic>. A <italic>k</italic><italic>-mer</italic> is a string of length <italic>k</italic>.</p>
    <p id="Par31">Let <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S} =\{s_1,s_2,\ldots ,s_{\ell }\}$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mi mathvariant="script">S</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>ℓ</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq11.gif"/></alternatives></inline-formula> be a collection of <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell$$\end{document}</tex-math><mml:math id="M24"><mml:mi>ℓ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq12.gif"/></alternatives></inline-formula> strings. We assume that each string <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_i \in \mathcal {S}$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq13.gif"/></alternatives></inline-formula> has length <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_i$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq14.gif"/></alternatives></inline-formula> and is followed by a special end-marker symbol <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_i[n_i+1] = \$_i$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="normal">$</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq15.gif"/></alternatives></inline-formula>, which is lexicographically smaller than any other symbol in <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M32"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq16.gif"/></alternatives></inline-formula>, and does not appear in <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M34"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq17.gif"/></alternatives></inline-formula> elsewhere.<xref ref-type="fn" rid="Fn2">2</xref></p>
    <sec id="Sec3">
      <title>Basic data structures</title>
      <p id="Par33">The <italic>Burrows-Wheeler Transform</italic> (BWT) [<xref ref-type="bibr" rid="CR13">13</xref>] is a well-known widely used reversible string transformation that can be extended to a collection of strings. Such an extension, introduced in [<xref ref-type="bibr" rid="CR14">14</xref>], is a reversible transformation whose output string (denoted by <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq18.gif"/></alternatives></inline-formula>) is a permutation of the symbols of all strings in <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M38"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq19.gif"/></alternatives></inline-formula>. In [<xref ref-type="bibr" rid="CR15">15</xref>], the authors introduced a variant of this transformation for string collection in which a distinct end-marker is appended to each string, making the collection ordered. Such transformations are known as eBWT or multi-string BWT.
</p>
      <p id="Par34">The length of <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq20.gif"/></alternatives></inline-formula> is denoted by <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=\sum _{i=1}^{\ell }(n_i+1)$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>ℓ</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq21.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} (\mathcal {S})[i]=x$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq22.gif"/></alternatives></inline-formula>, with <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\!\le \!i\!\le \!N$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="-0.166667em"/><mml:mo>≤</mml:mo><mml:mspace width="-0.166667em"/><mml:mi>i</mml:mi><mml:mspace width="-0.166667em"/><mml:mo>≤</mml:mo><mml:mspace width="-0.166667em"/><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq23.gif"/></alternatives></inline-formula>, if <italic>x</italic> circularly precedes the <italic>i</italic>-th suffix <inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_j[k,n_j+1]$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq24.gif"/></alternatives></inline-formula> (for some <inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\le j\le \ell$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq25.gif"/></alternatives></inline-formula> and <inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\le k\le n_j\!+\!1$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mspace width="-0.166667em"/><mml:mo>+</mml:mo><mml:mspace width="-0.166667em"/><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq26.gif"/></alternatives></inline-formula>), according to the lexicographic sorting of the suffixes of all strings in <inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M54"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq27.gif"/></alternatives></inline-formula>.</p>
      <p id="Par35">Usually the output string <inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq28.gif"/></alternatives></inline-formula> is enhanced with the <italic>document array</italic> (DA) and <italic>longest common prefix</italic> (LCP) array of <inline-formula id="IEq29"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M58"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq29.gif"/></alternatives></inline-formula>.</p>
      <p id="Par36">The <italic>document array</italic> of <inline-formula id="IEq30"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M60"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq30.gif"/></alternatives></inline-formula> (denoted by <inline-formula id="IEq31"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {da} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mi mathvariant="sans-serif">da</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq31.gif"/></alternatives></inline-formula>) is the array of length <italic>N</italic> such that <inline-formula id="IEq32"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {da} (\mathcal {S})[i]=j$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mi mathvariant="sans-serif">da</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq32.gif"/></alternatives></inline-formula>, with <inline-formula id="IEq33"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\le j\le \ell$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq33.gif"/></alternatives></inline-formula> and <inline-formula id="IEq34"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 \le i \le N$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq34.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq35"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} (\mathcal {S})[i]$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq35.gif"/></alternatives></inline-formula> is a symbol of the string <inline-formula id="IEq36"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_j$$\end{document}</tex-math><mml:math id="M72"><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq36.gif"/></alternatives></inline-formula>.</p>
      <p id="Par37">The <italic>longest common prefix</italic> (LCP) array [<xref ref-type="bibr" rid="CR29">29</xref>] of <inline-formula id="IEq37"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M74"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq37.gif"/></alternatives></inline-formula> is the array <inline-formula id="IEq38"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq38.gif"/></alternatives></inline-formula> of length <inline-formula id="IEq39"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N+1$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq39.gif"/></alternatives></inline-formula>, such that <inline-formula id="IEq40"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} (\mathcal {S})[i]$$\end{document}</tex-math><mml:math id="M80"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq40.gif"/></alternatives></inline-formula>, with <inline-formula id="IEq41"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2 \le i \le N$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:mn>2</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq41.gif"/></alternatives></inline-formula>, is the length of the longest common prefix between the suffixes associated with the positions <italic>i</italic> and <inline-formula id="IEq42"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i-1$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq42.gif"/></alternatives></inline-formula> in <inline-formula id="IEq43"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M86"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq43.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq44"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} (\mathcal {S})[1] = \textsf {lcp} (\mathcal {S})[N+1]= 0$$\end{document}</tex-math><mml:math id="M88"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq44.gif"/></alternatives></inline-formula> by default. The set <inline-formula id="IEq45"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M90"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq45.gif"/></alternatives></inline-formula> can be omitted when it is clear from the context.</p>
      <p id="Par38">The following is an important property of the eBWT, and thus of the related data structures DA and LCP, that will be used in our method:</p>
      <sec id="FPar1">
        <title>Remark 1</title>
        <p id="Par39">The eBWT, DA and LCP data structures for a subset of <inline-formula id="IEq46"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M92"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq46.gif"/></alternatives></inline-formula> can be obtained by linearly scanning those built for <inline-formula id="IEq47"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M94"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq47.gif"/></alternatives></inline-formula>.</p>
        <p id="Par40">In [<xref ref-type="bibr" rid="CR15">15</xref>], the authors prove that given a collection <inline-formula id="IEq48"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S} =\{S_1,S_2,\ldots ,S_{\ell }\}$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:mi mathvariant="script">S</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>ℓ</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq48.gif"/></alternatives></inline-formula> of strings and <inline-formula id="IEq49"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq49.gif"/></alternatives></inline-formula>, one can obtain the eBWT of a subset <inline-formula id="IEq50"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {R}$$\end{document}</tex-math><mml:math id="M100"><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq50.gif"/></alternatives></inline-formula> of <inline-formula id="IEq51"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M102"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq51.gif"/></alternatives></inline-formula> by removing all the characters not in <inline-formula id="IEq52"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {R}$$\end{document}</tex-math><mml:math id="M104"><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq52.gif"/></alternatives></inline-formula>, without constructing the eBWT from scratch, as the relative order of suffixes holds. One can obtain the DA for <inline-formula id="IEq53"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {R}$$\end{document}</tex-math><mml:math id="M106"><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq53.gif"/></alternatives></inline-formula> analogously by scanning <inline-formula id="IEq54"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {da} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:mi mathvariant="sans-serif">da</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq54.gif"/></alternatives></inline-formula> and removing entries not in <inline-formula id="IEq55"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {R}$$\end{document}</tex-math><mml:math id="M110"><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq55.gif"/></alternatives></inline-formula>.</p>
        <p id="Par41">Similarly, one can obtain the LCP of a subset of <inline-formula id="IEq56"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M112"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq56.gif"/></alternatives></inline-formula> by using the properties of the LCP array: for any pair of indices <inline-formula id="IEq57"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i&lt;j$$\end{document}</tex-math><mml:math id="M114"><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq57.gif"/></alternatives></inline-formula>, the longest common prefix between the suffix associated with position <italic>i</italic> and the suffix associated with position <italic>j</italic> is given by <inline-formula id="IEq58"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\min \{\textsf {lcp} [i+1],\ldots ,\textsf {lcp} [j]\}$$\end{document}</tex-math><mml:math id="M116"><mml:mrow><mml:mo movablelimits="true">min</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq58.gif"/></alternatives></inline-formula>.</p>
        <p>Let <inline-formula id="IEq59"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {R}\subset \mathcal {S}$$\end{document}</tex-math><mml:math id="M118"><mml:mrow><mml:mi mathvariant="script">R</mml:mi><mml:mo>⊂</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq59.gif"/></alternatives></inline-formula>. We denote by <inline-formula id="IEq60"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} (\mathcal {S})|_{\mathcal {R}}$$\end{document}</tex-math><mml:math id="M120"><mml:msub><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="script">R</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq60.gif"/></alternatives></inline-formula> (resp. <inline-formula id="IEq61"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {da} (\mathcal {S})|_{\mathcal {R}}$$\end{document}</tex-math><mml:math id="M122"><mml:msub><mml:mrow><mml:mi mathvariant="sans-serif">da</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="script">R</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq61.gif"/></alternatives></inline-formula>, <inline-formula id="IEq62"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} (\mathcal {S})|_{\mathcal {R}}$$\end{document}</tex-math><mml:math id="M124"><mml:msub><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="script">R</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq62.gif"/></alternatives></inline-formula>) the restriction of the data structure <inline-formula id="IEq63"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq63.gif"/></alternatives></inline-formula> (resp. <inline-formula id="IEq64"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {da} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M128"><mml:mrow><mml:mi mathvariant="sans-serif">da</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq64.gif"/></alternatives></inline-formula>, <inline-formula id="IEq65"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq65.gif"/></alternatives></inline-formula>) to the set of strings <inline-formula id="IEq66"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {R}$$\end{document}</tex-math><mml:math id="M132"><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq66.gif"/></alternatives></inline-formula>.</p>
      </sec>
    </sec>
    <sec id="Sec4">
      <title>LCP-interval and k-mer vs positional cluster</title>
      <p id="Par43">We denote by LCP-intervals  of LCP-value <italic>k</italic> maximal intervals [<italic>i</italic>, <italic>j</italic>] that satisfy <inline-formula id="IEq67"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} (\mathcal {S})[r] \ge k$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>≥</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq67.gif"/></alternatives></inline-formula> for <inline-formula id="IEq68"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i &lt; r \le j$$\end{document}</tex-math><mml:math id="M136"><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>r</mml:mi><mml:mo>≤</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq68.gif"/></alternatives></inline-formula> (slightly different definition from [<xref ref-type="bibr" rid="CR30">30</xref>]). The suffixes associated with LCP-intervals of LCP-value <italic>k</italic> have a common <italic>k</italic>-mer as prefix.</p>
      <p id="Par44">In any string collection, thus, LCP-intervals of LCP-value <italic>k</italic> are in a one-to-one correspondence with the set of all <italic>k</italic>-mers.</p>
      <p id="Par45">Note that the common prefix <italic>w</italic> in a LCP-interval is of length at least <italic>k</italic>, but it could be longer. So, to overcome the limitation of strategies based on LCP-intervals that require to fix the length <italic>k</italic>, the authors of [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR19">19</xref>] introduced a new framework called “positional clustering”. In this framework the intervals do not depend on a value <italic>k</italic> fixed a-priori, but they are enclosed between two “local minima” in the LCP-array (thus, their boundaries are data-driven).</p>
      <p id="Par46">Crucially, the length <italic>k</italic> of the common prefix <italic>w</italic> of the suffixes inside such intervals is not the same, but it differs interval by interval. Hence, there is no one-to-one correspondence between such intervals and the set of <italic>k</italic>-mers.</p>
      <p id="Par47">However, as to exclude intervals corresponding to some short random contexts <italic>w</italic>, one needs to set a minimum length for <italic>w</italic>, which we denote by <inline-formula id="IEq69"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m$$\end{document}</tex-math><mml:math id="M138"><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq69.gif"/></alternatives></inline-formula>.</p>
      <p id="Par48">According to [<xref ref-type="bibr" rid="CR19">19</xref>], an <italic>eBWT positional cluster</italic> eBWTclust[<italic>i</italic>, <italic>j</italic>] is a maximal substring <inline-formula id="IEq70"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} [i,j]$$\end{document}</tex-math><mml:math id="M140"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq70.gif"/></alternatives></inline-formula> where <inline-formula id="IEq71"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} [r] \ge k_m$$\end{document}</tex-math><mml:math id="M142"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>≥</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq71.gif"/></alternatives></inline-formula>, for all <inline-formula id="IEq72"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i&lt; r \le j$$\end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>r</mml:mi><mml:mo>≤</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq72.gif"/></alternatives></inline-formula>, and none of the indices <italic>r</italic>, <inline-formula id="IEq73"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i &lt; r \le j$$\end{document}</tex-math><mml:math id="M146"><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>r</mml:mi><mml:mo>≤</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq73.gif"/></alternatives></inline-formula>, is a <italic>local minimum</italic> of the LCP array.</p>
      <p id="Par49">By definition, we have that:</p>
      <sec id="FPar2">
        <title>Remark 2</title>
        <p id="Par50">Any two different eBWT positional clusters, eBWTclust[<italic>i</italic>, <italic>j</italic>] and eBWTclust <inline-formula id="IEq74"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[i',j']$$\end{document}</tex-math><mml:math id="M148"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq74.gif"/></alternatives></inline-formula>, such that <inline-formula id="IEq75"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i\ne i'$$\end{document}</tex-math><mml:math id="M150"><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq75.gif"/></alternatives></inline-formula> are disjoint, i.e. it holds that either <inline-formula id="IEq76"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j&lt;i'$$\end{document}</tex-math><mml:math id="M152"><mml:mrow><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq76.gif"/></alternatives></inline-formula> or <inline-formula id="IEq77"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j'&lt;i$$\end{document}</tex-math><mml:math id="M154"><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>&lt;</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq77.gif"/></alternatives></inline-formula>.</p>
        <p>Here, we define a local minimum of the LCP array (of length <italic>N</italic>) any index <italic>i</italic>, <inline-formula id="IEq78"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1&lt;i&lt;N$$\end{document}</tex-math><mml:math id="M156"><mml:mrow><mml:mn>1</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq78.gif"/></alternatives></inline-formula> such that <inline-formula id="IEq79"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} [i-1]&gt;\textsf {lcp} [i]$$\end{document}</tex-math><mml:math id="M158"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>&gt;</mml:mo><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq79.gif"/></alternatives></inline-formula> and <inline-formula id="IEq80"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} [i]&lt;\textsf {lcp} [i+j]$$\end{document}</tex-math><mml:math id="M160"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>&lt;</mml:mo><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq80.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq81"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j&gt;1$$\end{document}</tex-math><mml:math id="M162"><mml:mrow><mml:mi>j</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq81.gif"/></alternatives></inline-formula> is the number of adjacent occurrences of the value <inline-formula id="IEq82"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} [i]$$\end{document}</tex-math><mml:math id="M164"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq82.gif"/></alternatives></inline-formula> from position <italic>i</italic>. For instance, let <inline-formula id="IEq83"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} =[2,1,3,3,5,4,2,2,7]$$\end{document}</tex-math><mml:math id="M166"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>7</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq83.gif"/></alternatives></inline-formula>. The local minima are indices 2 and 7, corresponding to LCP values of 1 and 2, respectively.</p>
        <p>Note that the above definition differs from that in [<xref ref-type="bibr" rid="CR19">19</xref>], where local minima in the LCP array (of length <italic>N</italic>) are detected searching for indices <italic>r</italic> such that <inline-formula id="IEq84"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} [r-1] &gt; \textsf {lcp} [r]\le\textsf {lcp} [r+1]$$\end{document}</tex-math><mml:math id="M168"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>&gt;</mml:mo><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>≤</mml:mo><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq84.gif"/></alternatives></inline-formula>, for all <inline-formula id="IEq85"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 &lt; r \le N$$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:mn>1</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>r</mml:mi><mml:mo>≤</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq85.gif"/></alternatives></inline-formula>. According to such definition, local minima can be detected in any non-increasing sequence where some values are repeated. For instance, for the first occurrence of 4 in the sequence 5, 4, 4, 2 yields the definition of local minimum. Therefore, the slightly different notion of local minima we use is to maximize the length of the non-increasing sequence described in the following Remark <xref ref-type="sec" rid="FPar3">3</xref>.</p>
      </sec>
      <sec id="FPar3">
        <title>Remark 3</title>
        <p id="Par53">([<xref ref-type="bibr" rid="CR12">12</xref>, Thm 3.3]) In any eBWT positional cluster, the LCP-value form a sequence of non-decreasing values followed by a (possibly empty) sequence of non-increasing values.</p>
        <p>From the above remark follows that the length <italic>l</italic> of the longest common prefix shared by the suffixes associated with a eBWT positional cluster <inline-formula id="IEq86"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} [i,j]$$\end{document}</tex-math><mml:math id="M172"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq86.gif"/></alternatives></inline-formula> is given by the minimum value in <inline-formula id="IEq87"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} [i+1,j]$$\end{document}</tex-math><mml:math id="M174"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq87.gif"/></alternatives></inline-formula>, which could be simply obtained by taking the minimum between the values <inline-formula id="IEq88"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} [i+1]$$\end{document}</tex-math><mml:math id="M176"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq88.gif"/></alternatives></inline-formula> and <inline-formula id="IEq89"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} [j]$$\end{document}</tex-math><mml:math id="M178"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq89.gif"/></alternatives></inline-formula>.</p>
        <p>In general, if we set the minimum length <inline-formula id="IEq90"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m$$\end{document}</tex-math><mml:math id="M180"><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq90.gif"/></alternatives></inline-formula> equal to <italic>k</italic>, the set of eBWT positional clusters forms a refinement of the set of <inline-formula id="IEq91"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} [i,j]$$\end{document}</tex-math><mml:math id="M182"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq91.gif"/></alternatives></inline-formula> with [<italic>i</italic>, <italic>j</italic>] LCP-interval of LCP-value <italic>k</italic>.</p>
        <p>In fact, any <inline-formula id="IEq92"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} [i,j]$$\end{document}</tex-math><mml:math id="M184"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq92.gif"/></alternatives></inline-formula>, where [<italic>i</italic>, <italic>j</italic>] is a LCP-interval, can be subdivided in correspondence of the local minima of <inline-formula id="IEq93"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} [i,j]$$\end{document}</tex-math><mml:math id="M186"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq93.gif"/></alternatives></inline-formula>, thus giving rise to a sequence of consecutive eBWT positional clusters (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Clearly, such subdivision depends only on the trend of the LCP values inside the LCP-interval [<italic>i</italic>, <italic>j</italic>]. Hence, more than one positional cluster can be related to the same LCP-interval, and equivalently, to the same <italic>k</italic>-mer.<fig id="Fig1"><label>Fig. 1</label><caption><p>Extended Burrows-Wheeler Transform (EBWT), LCP array, and the auxiliary data structures DA and CDA for the set <inline-formula id="IEq94"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S} =$$\end{document}</tex-math><mml:math id="M188"><mml:mrow><mml:mi mathvariant="script">S</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq94.gif"/></alternatives></inline-formula> {GGCGTACCA, ACGAGTACGACT, GGGGCGTATT}</p></caption><graphic xlink:href="13015_2023_232_Fig1_HTML" id="MO1"/></fig></p>
      </sec>
      <sec id="FPar4">
        <title>Example 4</title>
        <p id="Par57">(<italic>running example</italic>) In Fig. <xref rid="Fig1" ref-type="fig">1</xref>, we represent the data structures used in our tool (cda, ebwt, lcp), the auxiliary array da and the sorted list of suffixes, for the sake of clarity. The LCP-intervals of LCP-value <inline-formula id="IEq96"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=1$$\end{document}</tex-math><mml:math id="M190"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq96.gif"/></alternatives></inline-formula> correspond to the following intervals: [4, 10, 11, 17, 18, 28, 29, 34]. Whereas the horizontal lines delimit e<sc>BWTclust</sc> for <inline-formula id="IEq97"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ k_m = 1$$\end{document}</tex-math><mml:math id="M192"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq97.gif"/></alternatives></inline-formula>. Note that when <inline-formula id="IEq98"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m = k$$\end{document}</tex-math><mml:math id="M194"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq98.gif"/></alternatives></inline-formula>, the e<sc>BWTclust</sc> can refine the LCP-intervals. For example the LCP-interval [18, 28] includes five positional clusters: <inline-formula id="IEq99"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{e}{BWTclust}[18,19]$$\end{document}</tex-math><mml:math id="M196"><mml:mrow><mml:mtext>e</mml:mtext><mml:mrow><mml:mi mathvariant="italic">BWTclust</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>18</mml:mn><mml:mo>,</mml:mo><mml:mn>19</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq99.gif"/></alternatives></inline-formula>, <inline-formula id="IEq100"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{e}{BWTclust}[20,21]$$\end{document}</tex-math><mml:math id="M198"><mml:mrow><mml:mtext>e</mml:mtext><mml:mrow><mml:mi mathvariant="italic">BWTclust</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mn>21</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq100.gif"/></alternatives></inline-formula>, <inline-formula id="IEq101"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{e}{BWTclust}[22,23]$$\end{document}</tex-math><mml:math id="M200"><mml:mrow><mml:mtext>e</mml:mtext><mml:mrow><mml:mi mathvariant="italic">BWTclust</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>22</mml:mn><mml:mo>,</mml:mo><mml:mn>23</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq101.gif"/></alternatives></inline-formula>, <inline-formula id="IEq102"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{e}{BWTclust}[24,25]$$\end{document}</tex-math><mml:math id="M202"><mml:mrow><mml:mtext>e</mml:mtext><mml:mrow><mml:mi mathvariant="italic">BWTclust</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>24</mml:mn><mml:mo>,</mml:mo><mml:mn>25</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq102.gif"/></alternatives></inline-formula>, <inline-formula id="IEq103"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{e}{BWTclust}[26,28]$$\end{document}</tex-math><mml:math id="M204"><mml:mrow><mml:mtext>e</mml:mtext><mml:mrow><mml:mi mathvariant="italic">BWTclust</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>26</mml:mn><mml:mo>,</mml:mo><mml:mn>28</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq103.gif"/></alternatives></inline-formula>.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec5">
    <title>Methods</title>
    <p id="Par58">In this section, we describe the proposed method for building a phylogenetic tree where each leaf is a set of strings (sequencing reads, contigs, genome).</p>
    <p id="Par59">The idea behind our method is to reconstruct the tree through a series of refinement steps performed on groups of taxa.</p>
    <p id="Par60">The inner <sc>refinement</sc> algorithm groups together nodes whose associated strings share long common substrings of varying length which are <italic>not</italic> present in other nodes, and we interpret the presence of such substrings as a common feature of the group that differentiates it from the others. As mentioned in the introduction, the method is not restricted to work in a top-down or bottom-up fashion, but can act on several levels at once, according to which ones appear to be most prominent.</p>
    <p id="Par61">The final algorithm, described in Sect. "<xref rid="Sec6" ref-type="sec">Tree reconstruction</xref>", suitably applies <sc>refinement</sc> to portions of the data, and iteratively converges to the reconstructed tree. Here <sc>refinement</sc> is a black box to group taxa, and is described in Sect. "<xref rid="Sec7" ref-type="sec">The refinement procedure</xref>".</p>
    <p id="Par62">Given <inline-formula id="IEq104"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell$$\end{document}</tex-math><mml:math id="M206"><mml:mi>ℓ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq104.gif"/></alternatives></inline-formula> taxa, our method produces an unrooted tree without fixing an outgroup.</p>
    <p id="Par63">For ease of explanation, we describe the method considering the tree as rooted. Indeed, we start from a tree that has <inline-formula id="IEq105"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell +1$$\end{document}</tex-math><mml:math id="M208"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq105.gif"/></alternatives></inline-formula> nodes: one root node, with <inline-formula id="IEq106"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell$$\end{document}</tex-math><mml:math id="M210"><mml:mi>ℓ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq106.gif"/></alternatives></inline-formula> children (one per taxon). Alternatively, we can imagine it as a star tree.</p>
    <p id="Par64">Before describing the reconstruction procedure, we introduce some notation and definitions.</p>
    <p id="Par65">Formally, we denote the set of leaves as <inline-formula id="IEq107"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S} =\{S_1,S_2,\ldots ,S_{\ell }\}$$\end{document}</tex-math><mml:math id="M212"><mml:mrow><mml:mi mathvariant="script">S</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>ℓ</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq107.gif"/></alternatives></inline-formula> where each <inline-formula id="IEq108"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_i$$\end{document}</tex-math><mml:math id="M214"><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq108.gif"/></alternatives></inline-formula> corresponds to a taxon.</p>
    <p id="Par66">The tree <italic>T</italic> is defined as a <italic>partition tree</italic> of the set <inline-formula id="IEq109"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M216"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq109.gif"/></alternatives></inline-formula>:<list list-type="bullet"><list-item><p id="Par67">Each node of <italic>T</italic> corresponds to a nonempty set of taxa <inline-formula id="IEq110"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S' \subseteq \mathcal {S}$$\end{document}</tex-math><mml:math id="M218"><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⊆</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq110.gif"/></alternatives></inline-formula></p></list-item><list-item><p id="Par68">The root of <italic>T</italic> corresponds to <inline-formula id="IEq111"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M220"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq111.gif"/></alternatives></inline-formula></p></list-item><list-item><p id="Par69">Each leaf of <italic>T</italic> corresponds to a distinct taxon <inline-formula id="IEq112"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_i\in \mathcal {S}$$\end{document}</tex-math><mml:math id="M222"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq112.gif"/></alternatives></inline-formula></p></list-item><list-item><p id="Par70">For each node corresponding to <inline-formula id="IEq113"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S'$$\end{document}</tex-math><mml:math id="M224"><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq113.gif"/></alternatives></inline-formula>, its children form a partition of <inline-formula id="IEq114"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S'$$\end{document}</tex-math><mml:math id="M226"><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq114.gif"/></alternatives></inline-formula></p></list-item></list>It is convenient to define the operation of <italic>adding a node</italic> to <italic>T</italic> by a set: a set <inline-formula id="IEq115"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S'\subseteq \mathcal {S}$$\end{document}</tex-math><mml:math id="M228"><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⊆</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq115.gif"/></alternatives></inline-formula> can be added to <italic>T</italic> only if is <italic>compatible</italic>, i.e., if every other node of <italic>T</italic> corresponds to a set <inline-formula id="IEq116"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S''$$\end{document}</tex-math><mml:math id="M230"><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mo>′</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq116.gif"/></alternatives></inline-formula> that satisfies one of these conditions: <inline-formula id="IEq117"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S'' \subset S'$$\end{document}</tex-math><mml:math id="M232"><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mo>′</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>⊂</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq117.gif"/></alternatives></inline-formula>, <inline-formula id="IEq118"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S'' \supset S'$$\end{document}</tex-math><mml:math id="M234"><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mo>′</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>⊃</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq118.gif"/></alternatives></inline-formula>, or <inline-formula id="IEq119"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S'' \cap S' = \emptyset$$\end{document}</tex-math><mml:math id="M236"><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mo>′</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>∩</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mi mathvariant="normal">∅</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq119.gif"/></alternatives></inline-formula> (i.e. no partial overlap between <inline-formula id="IEq120"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S''$$\end{document}</tex-math><mml:math id="M238"><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mo>′</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq120.gif"/></alternatives></inline-formula> and <inline-formula id="IEq121"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S'$$\end{document}</tex-math><mml:math id="M240"><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq121.gif"/></alternatives></inline-formula>). If this is the case, there is only one way to add <inline-formula id="IEq122"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S'$$\end{document}</tex-math><mml:math id="M242"><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq122.gif"/></alternatives></inline-formula> to <italic>T</italic>, namely, <inline-formula id="IEq123"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S'$$\end{document}</tex-math><mml:math id="M244"><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq123.gif"/></alternatives></inline-formula> becomes a child of the smallest set <inline-formula id="IEq124"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P \supset S'$$\end{document}</tex-math><mml:math id="M246"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⊃</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq124.gif"/></alternatives></inline-formula> of <italic>T</italic> (by cardinality), and all the other children of <italic>P</italic> that are contained in <inline-formula id="IEq125"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S'$$\end{document}</tex-math><mml:math id="M248"><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq125.gif"/></alternatives></inline-formula> become the children of <inline-formula id="IEq126"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S'$$\end{document}</tex-math><mml:math id="M250"><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq126.gif"/></alternatives></inline-formula>. It is easy to see that the resulting <italic>T</italic> is still a partition tree.</p>
    <p id="Par71">In our framework, each <inline-formula id="IEq127"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_i$$\end{document}</tex-math><mml:math id="M252"><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq127.gif"/></alternatives></inline-formula> is a collection of strings, as for each taxon we can have multiple strings (like reads, contigs, a genome, and so on) possibly augmented by their reverse-complement, however in the structure of <italic>T</italic> it is just represented as an identifier.</p>
    <p id="Par72">Let <inline-formula id="IEq128"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S} =\{S_1,S_2,\ldots ,S_{\ell }\}$$\end{document}</tex-math><mml:math id="M254"><mml:mrow><mml:mi mathvariant="script">S</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>ℓ</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq128.gif"/></alternatives></inline-formula> and each set <inline-formula id="IEq129"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_i \in \mathcal {S}$$\end{document}</tex-math><mml:math id="M256"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq129.gif"/></alternatives></inline-formula> contain <inline-formula id="IEq130"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_i$$\end{document}</tex-math><mml:math id="M258"><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq130.gif"/></alternatives></inline-formula> strings, i.e. <inline-formula id="IEq131"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_i=\{s_{i,1},\ldots ,s_{i,m_i}\}$$\end{document}</tex-math><mml:math id="M260"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq131.gif"/></alternatives></inline-formula>. Note that the definitions of eBWT, LCP and DA given in Sect. "<xref rid="Sec2" ref-type="sec">Preliminaries</xref>" apply also to this case:<list list-type="bullet"><list-item><p id="Par73"><inline-formula id="IEq132"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} (\mathcal {S})=\textsf {ebwt} (\{S_1,S_2,\ldots ,S_{\ell }\})=\textsf {ebwt} (\{s_{1,1},\ldots ,s_{1,m_1},\ldots ,s_{\ell ,1},\ldots ,s_{\ell ,m_\ell }\})$$\end{document}</tex-math><mml:math id="M262"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>ℓ</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>ℓ</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq132.gif"/></alternatives></inline-formula>,</p></list-item><list-item><p id="Par74"><inline-formula id="IEq133"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} (\mathcal {S})=\textsf {lcp} (\{S_1,S_2,\ldots ,S_{\ell }\})=\textsf {lcp} (\{s_{1,1},\ldots ,$$\end{document}</tex-math><mml:math id="M264"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>ℓ</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">{</mml:mo></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq133.gif"/></alternatives></inline-formula><inline-formula id="IEq134"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_{\ell ,m_\ell }\})$$\end{document}</tex-math><mml:math id="M266"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>ℓ</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">}</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq134.gif"/></alternatives></inline-formula>,</p></list-item><list-item><p id="Par75"><inline-formula id="IEq135"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {da} (\mathcal {S})=\textsf {da} (\{S_1,S_2,\ldots ,S_{\ell }\})=\textsf {da} (\{s_{1,1},\ldots ,s_{\ell ,m_\ell }\})$$\end{document}</tex-math><mml:math id="M268"><mml:mrow><mml:mi mathvariant="sans-serif">da</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="sans-serif">da</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>ℓ</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="sans-serif">da</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>ℓ</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq135.gif"/></alternatives></inline-formula>.</p></list-item></list>For our purposes, we extend the notion of DA to <italic>Color Document Array</italic> (CDA), where <inline-formula id="IEq136"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {cda} (\mathcal {S})[j]=r$$\end{document}</tex-math><mml:math id="M270"><mml:mrow><mml:mi mathvariant="sans-serif">cda</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq136.gif"/></alternatives></inline-formula> if <inline-formula id="IEq137"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {da} (\mathcal {S})[j]=u$$\end{document}</tex-math><mml:math id="M272"><mml:mrow><mml:mi mathvariant="sans-serif">da</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq137.gif"/></alternatives></inline-formula> and <inline-formula id="IEq138"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_u$$\end{document}</tex-math><mml:math id="M274"><mml:msub><mml:mi>s</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq138.gif"/></alternatives></inline-formula> belongs to the set <inline-formula id="IEq139"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_r$$\end{document}</tex-math><mml:math id="M276"><mml:msub><mml:mi>S</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq139.gif"/></alternatives></inline-formula>. In other words, we assign the same color to the strings belonging to the same set <inline-formula id="IEq140"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_r$$\end{document}</tex-math><mml:math id="M278"><mml:msub><mml:mi>S</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq140.gif"/></alternatives></inline-formula>, so we have a distinct color <italic>r</italic> for each set <inline-formula id="IEq141"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_r \in \mathcal {S}$$\end{document}</tex-math><mml:math id="M280"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq141.gif"/></alternatives></inline-formula>.</p>
    <sec id="FPar5">
      <title>Example 5</title>
      <p id="Par76">(running example) In Fig. <xref rid="Fig1" ref-type="fig">1</xref>, cda coincides with da assuming that each taxon is a single string.</p>
    </sec>
    <sec id="Sec6">
      <title>Tree reconstruction</title>
      <p id="Par78">In this subsection we show how our method reconstructs a phylogenetic tree for <inline-formula id="IEq142"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M282"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq142.gif"/></alternatives></inline-formula> by suitably applying <sc>refinement</sc>. We consider <sc>refinement</sc> as a blackbox with the following properties: given a list of sets <inline-formula id="IEq143"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C = C_1,\ldots , C_h$$\end{document}</tex-math><mml:math id="M284"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq143.gif"/></alternatives></inline-formula>, such that any <inline-formula id="IEq144"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_k$$\end{document}</tex-math><mml:math id="M286"><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq144.gif"/></alternatives></inline-formula> is a subset of <inline-formula id="IEq145"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M288"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq145.gif"/></alternatives></inline-formula> and disjoint from all other <inline-formula id="IEq146"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{k'}$$\end{document}</tex-math><mml:math id="M290"><mml:msub><mml:mi>C</mml:mi><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq146.gif"/></alternatives></inline-formula>, for <inline-formula id="IEq147"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 \le k &lt; k' \le h$$\end{document}</tex-math><mml:math id="M292"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>&lt;</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>≤</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq147.gif"/></alternatives></inline-formula>, <sc>refinement</sc> returns a list of sets <inline-formula id="IEq148"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L = L_1,\ldots , L_{|L|}$$\end{document}</tex-math><mml:math id="M294"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq148.gif"/></alternatives></inline-formula> of <italic>compatible subsets</italic> of <inline-formula id="IEq149"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bigcup _k C_k$$\end{document}</tex-math><mml:math id="M296"><mml:mrow><mml:msub><mml:mo>⋃</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq149.gif"/></alternatives></inline-formula>: i.e., each <inline-formula id="IEq150"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_i$$\end{document}</tex-math><mml:math id="M298"><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq150.gif"/></alternatives></inline-formula> is the union of some <inline-formula id="IEq151"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_k$$\end{document}</tex-math><mml:math id="M300"><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq151.gif"/></alternatives></inline-formula>’s, and each <inline-formula id="IEq152"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_i$$\end{document}</tex-math><mml:math id="M302"><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq152.gif"/></alternatives></inline-formula> is either a subset of, a superset of, or disjoint from any other <inline-formula id="IEq153"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_j$$\end{document}</tex-math><mml:math id="M304"><mml:msub><mml:mi>L</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq153.gif"/></alternatives></inline-formula>, for <inline-formula id="IEq154"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 \le i &lt; j \le |L|$$\end{document}</tex-math><mml:math id="M306"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq154.gif"/></alternatives></inline-formula>.</p>
      <p id="Par79">The key idea is that once an intermediate partition tree is obtained, we may take one of its nodes and restrict our attention to just the groups of taxa corresponding to its children (<inline-formula id="IEq155"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_1,\ldots ,C_h$$\end{document}</tex-math><mml:math id="M308"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq155.gif"/></alternatives></inline-formula>) and repeat <sc>refinement</sc>: this allows us to look at the subtree with a greater detail, by restricting the input data structures and changing the ebwt, thus bringing new tree refinements to light. This is repeated until all internal nodes in the partition tree have only two children, or no more refinements can be identified by <sc>refinement</sc>.</p>
      <p id="Par80">Our algorithm is described in Algorithm 1, and one possible iteration is depicted in Fig. <xref rid="Fig2" ref-type="fig">2</xref>.<fig id="Fig2"><label>Fig. 2</label><caption><p>A possible iteration of Algorithm 1 where final nodes are in bold</p></caption><graphic xlink:href="13015_2023_232_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par81">At the beginning we initialize the unrefined partition tree <italic>T</italic> (Line 1) as a rooted star with root <inline-formula id="IEq156"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M310"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq156.gif"/></alternatives></inline-formula> (non-final), and leaves labelled by <inline-formula id="IEq157"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_1,\ldots ,S_\ell$$\end{document}</tex-math><mml:math id="M312"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>ℓ</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq157.gif"/></alternatives></inline-formula> marked as final. As the names suggests, <italic>final</italic> indicates that no more refinement is needed at that node.</p>
      <p id="Par82">The algorithm iteratively processes a non-final node <italic>X</italic> of <italic>T</italic> (Line 3), meaning that its children <inline-formula id="IEq158"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_1,\ldots ,C_h$$\end{document}</tex-math><mml:math id="M314"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq158.gif"/></alternatives></inline-formula> (which correspond to disjoint sets) are fed to <sc>refinement</sc> to create new nodes that further partition the children. All nodes produced with two children are marked final; also, if <sc>refinement</sc> fails to create new nodes, then <italic>X</italic> is marked final.</p>
      <p id="Par83">Line 6 calls the <sc>refinement</sc> function to create a list <italic>L</italic> of compatible subsets of <inline-formula id="IEq159"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X = \bigcup _k C_k$$\end{document}</tex-math><mml:math id="M316"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mo>⋃</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq159.gif"/></alternatives></inline-formula>, and then the <sc>draw_and_mark</sc> function is called to add the corresponding new nodes to <italic>T</italic> (Line 7).
</p>
      <p id="Par84">By the aforementioned assumptions on the sets in <italic>L</italic>, they are always compatible with <italic>T</italic>: each <inline-formula id="IEq160"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_i$$\end{document}</tex-math><mml:math id="M318"><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq160.gif"/></alternatives></inline-formula> is a subset of <italic>X</italic> (and all its ancestors in <italic>T</italic>), it is a superset of some <inline-formula id="IEq161"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_i$$\end{document}</tex-math><mml:math id="M320"><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq161.gif"/></alternatives></inline-formula> (and all their descendants in <italic>T</italic>), and it is disjoint from all other nodes in <italic>T</italic>. Thus, <sc>draw_and_mark</sc> only needs to consider two cases:<list list-type="bullet"><list-item><p id="Par85">Case (<italic>i</italic>) <italic>T</italic> is not changed (i.e. the list <italic>L</italic> is empty): node <italic>X</italic> is marked as final (Line 10).</p></list-item><list-item><p id="Par86">Case (<italic>ii</italic>) <italic>L</italic> is not empty: a new internal node is created for each <inline-formula id="IEq162"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_i\in L$$\end{document}</tex-math><mml:math id="M322"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq162.gif"/></alternatives></inline-formula>, by adding the set <inline-formula id="IEq163"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_i$$\end{document}</tex-math><mml:math id="M324"><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq163.gif"/></alternatives></inline-formula> to the partition tree <italic>T</italic> as described before. A node is marked final if it has only two children; otherwise, it needs to be further refined and is added to the queue (this also applies to the node <italic>X</italic>).</p></list-item></list>Figure <xref rid="Fig2" ref-type="fig">2</xref> depicts the procedure of adding nodes to <italic>T</italic>, while a possible execution of the algorithm is shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>.<graphic position="anchor" xlink:href="13015_2023_232_Figa_HTML" id="MO16"/><fig id="Fig3"><label>Fig. 3</label><caption><p>A possible execution of Algorithm 1 on a set of taxa <inline-formula id="IEq95"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S} = \{1,2,3,4,5,6\}$$\end{document}</tex-math><mml:math id="M326"><mml:mrow><mml:mi mathvariant="script">S</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq95.gif"/></alternatives></inline-formula>. Each panel in the top shows an execution of the <sc>refinement</sc> procedure, with input on top and the list of subsets generated in the bottom. Below, the corresponding refinement of the partition tree, where dashed nodes are non-final. Note how nodes are marked final when they are leaves, or they have 2 children, or <sc>refinement</sc> fails to further cluster their children (see 4, 5, 6 in execution <italic>III</italic>)</p></caption><graphic xlink:href="13015_2023_232_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec7">
      <title>The <sc>refinement</sc> procedure</title>
      <p id="Par87">In this subsection, we describe the approach we use as inner <sc>refinement</sc> function that starting from a set of sibling nodes <inline-formula id="IEq164"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_1,\ldots ,C_h$$\end{document}</tex-math><mml:math id="M328"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq164.gif"/></alternatives></inline-formula> returns a list <italic>L</italic> of compatible subsets. This is a direct evolution of the <inline-formula id="IEq0165"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsc{partition}$$\end{document}</tex-math><mml:math id="M330"><mml:mstyle mathsize="0.6em"><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">O</mml:mi><mml:mi mathvariant="normal">N</mml:mi></mml:mstyle></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq0165.gif"/></alternatives></inline-formula> procedure of phyBWT, that allows to process multiple levels at once.</p>
      <p id="Par88">According to Subsect. "<xref rid="Sec6" ref-type="sec">Tree reconstruction</xref>", the sibling nodes <inline-formula id="IEq165"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_1,\ldots ,C_h$$\end{document}</tex-math><mml:math id="M332"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq165.gif"/></alternatives></inline-formula> of <italic>T</italic> to be refined correspond to some (not necessarily all) taxa: each <inline-formula id="IEq166"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_k$$\end{document}</tex-math><mml:math id="M334"><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq166.gif"/></alternatives></inline-formula> can be either a leaf of <italic>T</italic> (thus corresponding to only one taxon) or an internal node of <italic>T</italic> corresponding to a subset <inline-formula id="IEq167"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S'\subset \mathcal {S}$$\end{document}</tex-math><mml:math id="M336"><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⊂</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq167.gif"/></alternatives></inline-formula>.</p>
      <p id="Par89">We can consider each <inline-formula id="IEq168"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_k$$\end{document}</tex-math><mml:math id="M338"><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq168.gif"/></alternatives></inline-formula> as the set of colors (i.e. the set of taxa) to which it corresponds. Let <inline-formula id="IEq169"><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}=\{C_1,\ldots ,C_h\}$$\end{document}</tex-math><mml:math id="M340"><mml:mrow><mml:mi mathvariant="script">Q</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq169.gif"/></alternatives></inline-formula>. We define a function <inline-formula id="IEq170"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\chi _{\mathcal {Q}}$$\end{document}</tex-math><mml:math id="M342"><mml:msub><mml:mi>χ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq170.gif"/></alternatives></inline-formula> that associates a color <italic>r</italic> (i.e. any taxon in <inline-formula id="IEq171"><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M344"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq171.gif"/></alternatives></inline-formula>) to the element of <inline-formula id="IEq172"><alternatives><tex-math id="M345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}$$\end{document}</tex-math><mml:math id="M346"><mml:mi mathvariant="script">Q</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq172.gif"/></alternatives></inline-formula> to which it belongs (if one exists).</p>
      <sec id="FPar6">
        <title>Definition 6</title>
        <p id="Par90">Given <inline-formula id="IEq173"><alternatives><tex-math id="M347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}=\{C_1,\ldots ,C_h\}$$\end{document}</tex-math><mml:math id="M348"><mml:mrow><mml:mi mathvariant="script">Q</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq173.gif"/></alternatives></inline-formula>, we define <inline-formula id="IEq174"><alternatives><tex-math id="M349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\chi _{\mathcal {Q}}$$\end{document}</tex-math><mml:math id="M350"><mml:msub><mml:mi>χ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq174.gif"/></alternatives></inline-formula> from <inline-formula id="IEq175"><alternatives><tex-math id="M351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{1,\ldots ,\ell \}$$\end{document}</tex-math><mml:math id="M352"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq175.gif"/></alternatives></inline-formula> to <inline-formula id="IEq176"><alternatives><tex-math id="M353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{C_1,\ldots ,C_h\}\cup \{\emptyset \}$$\end{document}</tex-math><mml:math id="M354"><mml:mrow><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>∪</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi mathvariant="normal">∅</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq176.gif"/></alternatives></inline-formula>, such that<disp-formula id="Equ1"><alternatives><tex-math id="M355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \chi _{\mathcal {Q}}(r)= \left\{ \begin{array}{ll} C_k &amp;{} \text {if there exists}\, k\,\text { s.t.}\, r\,\text { belongs to}\, C_k\\ \emptyset &amp;{} \text {otherwise.} \\ \end{array} \right. \end{aligned}$$\end{document}</tex-math><mml:math id="M356" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>if there exists</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>k</mml:mi><mml:mspace width="0.166667em"/><mml:mspace width="0.333333em"/><mml:mtext>s.t.</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>r</mml:mi><mml:mspace width="0.166667em"/><mml:mspace width="0.333333em"/><mml:mtext>belongs to</mml:mtext><mml:mspace width="0.166667em"/><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi mathvariant="normal">∅</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>otherwise.</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13015_2023_232_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Let [<italic>i</italic>, <italic>j</italic>] be a positional cluster. Recall that we denote by eBWTclust[<italic>i</italic>, <italic>j</italic>] the concatenation of the symbols in the eBWT associated with the range [<italic>i</italic>, <italic>j</italic>] (i.e. <inline-formula id="IEq177"><alternatives><tex-math id="M357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} ({\mathcal {S}})[i,j]$$\end{document}</tex-math><mml:math id="M358"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq177.gif"/></alternatives></inline-formula>). Then, for each eBWTclust[<italic>i</italic>, <italic>j</italic>], the corresponding interval in the CDA, <inline-formula id="IEq178"><alternatives><tex-math id="M359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {cda} {(\mathcal {S})}[i,j]$$\end{document}</tex-math><mml:math id="M360"><mml:mrow><mml:mi mathvariant="sans-serif">cda</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq178.gif"/></alternatives></inline-formula>, stores the colors (i.e. indices of the taxa) to which the symbols in eBWTclust[<italic>i</italic>, <italic>j</italic>]  belong.</p>
      </sec>
      <sec id="FPar7">
        <title>Definition 7</title>
        <p id="Par92">An eBWTclust[<italic>i</italic>, <italic>j</italic>] is <inline-formula id="IEq179"><alternatives><tex-math id="M361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M362"><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq179.gif"/></alternatives></inline-formula><italic>-colored</italic> if <inline-formula id="IEq180"><alternatives><tex-math id="M363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M364"><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq180.gif"/></alternatives></inline-formula> is the set of elements of <inline-formula id="IEq181"><alternatives><tex-math id="M365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}$$\end{document}</tex-math><mml:math id="M366"><mml:mi mathvariant="script">Q</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq181.gif"/></alternatives></inline-formula> appearing in <inline-formula id="IEq182"><alternatives><tex-math id="M367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {cda} {(\mathcal {S})}[i,j]$$\end{document}</tex-math><mml:math id="M368"><mml:mrow><mml:mi mathvariant="sans-serif">cda</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq182.gif"/></alternatives></inline-formula>, i.e. <inline-formula id="IEq183"><alternatives><tex-math id="M369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _{\mathcal {Q}}=\{{\chi _{\mathcal {Q}}(r)}\text {: } r\in \textsf {cda} {(\mathcal {S})}[i,j]\}$$\end{document}</tex-math><mml:math id="M370"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mtext>:</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="sans-serif">cda</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq183.gif"/></alternatives></inline-formula>.</p>
        <p>Note that if eBWTclust and CDA are restricted to the strings in <inline-formula id="IEq184"><alternatives><tex-math id="M371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}$$\end{document}</tex-math><mml:math id="M372"><mml:mi mathvariant="script">Q</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq184.gif"/></alternatives></inline-formula> (see Remark <xref ref-type="sec" rid="FPar1">1</xref>), then <inline-formula id="IEq185"><alternatives><tex-math id="M373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M374"><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq185.gif"/></alternatives></inline-formula> contains only non-empty sets.</p>
      </sec>
      <sec id="FPar8">
        <title>Example 8</title>
        <p id="Par94">Let <inline-formula id="IEq186"><alternatives><tex-math id="M375">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}=\{\{1,3,4\},\{2\},\{5\}, \{6\}\}$$\end{document}</tex-math><mml:math id="M376"><mml:mrow><mml:mi mathvariant="script">Q</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>6</mml:mn><mml:mo stretchy="false">}</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq186.gif"/></alternatives></inline-formula> and e<sc>BWTclust</sc>
<inline-formula id="IEq187"><alternatives><tex-math id="M377">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[i,j]=ACAAGT$$\end{document}</tex-math><mml:math id="M378"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>C</mml:mi><mml:mi>A</mml:mi><mml:mi>A</mml:mi><mml:mi>G</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq187.gif"/></alternatives></inline-formula> with <inline-formula id="IEq188"><alternatives><tex-math id="M379">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {cda} [i,j]=[1\ 2\ 1\ 1\ 3\ 3]$$\end{document}</tex-math><mml:math id="M380"><mml:mrow><mml:mi mathvariant="sans-serif">cda</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mspace width="4pt"/><mml:mn>2</mml:mn><mml:mspace width="4pt"/><mml:mn>1</mml:mn><mml:mspace width="4pt"/><mml:mn>1</mml:mn><mml:mspace width="4pt"/><mml:mn>3</mml:mn><mml:mspace width="4pt"/><mml:mn>3</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq188.gif"/></alternatives></inline-formula>. Then, e<sc>BWTclust</sc>[<italic>i</italic>, <italic>j</italic>] is <inline-formula id="IEq189"><alternatives><tex-math id="M381">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M382"><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq189.gif"/></alternatives></inline-formula>-colored and <inline-formula id="IEq190"><alternatives><tex-math id="M383">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathcal {Q}=\{\{1,3,4\},\{2\}\}$$\end{document}</tex-math><mml:math id="M384"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq190.gif"/></alternatives></inline-formula>.</p>
        <p>The main idea is to detect and analyze only eBWT positional clusters associated with left-maximal contexts shared by a sufficiently large number of taxa (but not by all of them).</p>
      </sec>
      <sec id="FPar9">
        <title>Definition 9</title>
        <p id="Par96">A <inline-formula id="IEq191"><alternatives><tex-math id="M385">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M386"><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq191.gif"/></alternatives></inline-formula>-colored eBWTclust[<italic>i</italic>, <italic>j</italic>] is <italic>relevant</italic>, if the following properties hold: <list list-type="simple"><list-item><label>i)</label><p id="Par97"><inline-formula id="IEq192"><alternatives><tex-math id="M387">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} [i,j]$$\end{document}</tex-math><mml:math id="M388"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq192.gif"/></alternatives></inline-formula> is not a concatenation of a same symbol (i.e. it is not a run),</p></list-item><list-item><label>ii)</label><p id="Par98"><inline-formula id="IEq193"><alternatives><tex-math id="M389">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1&lt;\textsf {card} (\gamma _\mathcal {Q})&lt;h$$\end{document}</tex-math><mml:math id="M390"><mml:mrow><mml:mn>1</mml:mn><mml:mo>&lt;</mml:mo><mml:mi mathvariant="sans-serif">card</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq193.gif"/></alternatives></inline-formula>,</p></list-item><list-item><label>iii)</label><p id="Par99"><inline-formula id="IEq194"><alternatives><tex-math id="M391">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {card} (\textsf {cda} [i,j]\cap C_k)\ge \tau \cdot {\textsf {card} (C_k)}$$\end{document}</tex-math><mml:math id="M392"><mml:mrow><mml:mi mathvariant="sans-serif">card</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="sans-serif">cda</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>∩</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≥</mml:mo><mml:mi>τ</mml:mi><mml:mo>·</mml:mo><mml:mrow><mml:mi mathvariant="sans-serif">card</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq194.gif"/></alternatives></inline-formula>, for all <inline-formula id="IEq195"><alternatives><tex-math id="M393">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_k\in \gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M394"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq195.gif"/></alternatives></inline-formula> and some <inline-formula id="IEq196"><alternatives><tex-math id="M395">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0&lt;\tau \le 1$$\end{document}</tex-math><mml:math id="M396"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>τ</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq196.gif"/></alternatives></inline-formula>.</p></list-item></list></p>
        <p>In <italic>ii</italic>), we cut off the eBWT positional clusters associated with left-maximal contexts shared by only one element of <inline-formula id="IEq197"><alternatives><tex-math id="M397">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}$$\end{document}</tex-math><mml:math id="M398"><mml:mi mathvariant="script">Q</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq197.gif"/></alternatives></inline-formula> or by all of them. Indeed, such contexts provide no significant information about how to group together elements of <inline-formula id="IEq198"><alternatives><tex-math id="M399">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}$$\end{document}</tex-math><mml:math id="M400"><mml:mi mathvariant="script">Q</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq198.gif"/></alternatives></inline-formula>.
</p>
        <p>In <italic>iii</italic>), we require that any element <inline-formula id="IEq199"><alternatives><tex-math id="M401">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_k$$\end{document}</tex-math><mml:math id="M402"><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq199.gif"/></alternatives></inline-formula> in <inline-formula id="IEq200"><alternatives><tex-math id="M403">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M404"><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq200.gif"/></alternatives></inline-formula> is sufficiently supported, i.e. the number of colors of <inline-formula id="IEq201"><alternatives><tex-math id="M405">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_k$$\end{document}</tex-math><mml:math id="M406"><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq201.gif"/></alternatives></inline-formula> appearing in <inline-formula id="IEq202"><alternatives><tex-math id="M407">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {cda} [i,j]$$\end{document}</tex-math><mml:math id="M408"><mml:mrow><mml:mi mathvariant="sans-serif">cda</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq202.gif"/></alternatives></inline-formula> is “large enough”. Formally, we define a <italic>support threshold</italic>
<inline-formula id="IEq203"><alternatives><tex-math id="M409">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M410"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq203.gif"/></alternatives></inline-formula> (<inline-formula id="IEq204"><alternatives><tex-math id="M411">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0&lt;\tau \le 1$$\end{document}</tex-math><mml:math id="M412"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>τ</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq204.gif"/></alternatives></inline-formula>) that determines the minimum required portion for each <inline-formula id="IEq205"><alternatives><tex-math id="M413">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_k\in \gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M414"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq205.gif"/></alternatives></inline-formula> to be in <inline-formula id="IEq206"><alternatives><tex-math id="M415">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {cda} [i,j]$$\end{document}</tex-math><mml:math id="M416"><mml:mrow><mml:mi mathvariant="sans-serif">cda</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq206.gif"/></alternatives></inline-formula>. Intuitively, the support threshold guarantees that all the elements of <inline-formula id="IEq207"><alternatives><tex-math id="M417">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}$$\end{document}</tex-math><mml:math id="M418"><mml:mi mathvariant="script">Q</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq207.gif"/></alternatives></inline-formula> appearing in any eBWTclust[<italic>i</italic>, <italic>j</italic>] are sufficiently represented. In fact, when <inline-formula id="IEq208"><alternatives><tex-math id="M419">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M420"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq208.gif"/></alternatives></inline-formula> approaches the value of 1, all the elements of the subset <inline-formula id="IEq209"><alternatives><tex-math id="M421">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_k$$\end{document}</tex-math><mml:math id="M422"><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq209.gif"/></alternatives></inline-formula> are required to be in the cluster. In other words, we aim at measuring how similar the shared history of the phylogeny is in terms of common substrings. On the other hand, when <inline-formula id="IEq210"><alternatives><tex-math id="M423">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M424"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq210.gif"/></alternatives></inline-formula> approaches the value of 0, at least one of the elements of the subset <inline-formula id="IEq211"><alternatives><tex-math id="M425">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_k$$\end{document}</tex-math><mml:math id="M426"><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq211.gif"/></alternatives></inline-formula> is required to be in the cluster considered. Thus, we are observing how similar all the evolution events are. That provides two different viewpoints of their phylogenetic relationships.</p>
      </sec>
      <sec id="FPar10">
        <title>Example 10</title>
        <p id="Par102">(Continued from Example <xref ref-type="sec" rid="FPar8">8</xref>) Let <inline-formula id="IEq212"><alternatives><tex-math id="M427">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}=\{\{1,3,4\},\{2\},\{5\}, \{6\}\}$$\end{document}</tex-math><mml:math id="M428"><mml:mrow><mml:mi mathvariant="script">Q</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>6</mml:mn><mml:mo stretchy="false">}</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq212.gif"/></alternatives></inline-formula> and <inline-formula id="IEq213"><alternatives><tex-math id="M429">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau =0.5$$\end{document}</tex-math><mml:math id="M430"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq213.gif"/></alternatives></inline-formula>. The e<sc>BWTclust</sc>
<inline-formula id="IEq214"><alternatives><tex-math id="M431">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[i,j]=ACAAGT$$\end{document}</tex-math><mml:math id="M432"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>C</mml:mi><mml:mi>A</mml:mi><mml:mi>A</mml:mi><mml:mi>G</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq214.gif"/></alternatives></inline-formula> with <inline-formula id="IEq215"><alternatives><tex-math id="M433">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {cda} [i,j]=[1\ 2\ 1\ 1\ 3\ 3]$$\end{document}</tex-math><mml:math id="M434"><mml:mrow><mml:mi mathvariant="sans-serif">cda</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mspace width="4pt"/><mml:mn>2</mml:mn><mml:mspace width="4pt"/><mml:mn>1</mml:mn><mml:mspace width="4pt"/><mml:mn>1</mml:mn><mml:mspace width="4pt"/><mml:mn>3</mml:mn><mml:mspace width="4pt"/><mml:mn>3</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq215.gif"/></alternatives></inline-formula> is a relevant cluster, since for any element of <inline-formula id="IEq216"><alternatives><tex-math id="M435">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M436"><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq216.gif"/></alternatives></inline-formula>, its portion in <inline-formula id="IEq217"><alternatives><tex-math id="M437">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {cda} [i,j]$$\end{document}</tex-math><mml:math id="M438"><mml:mrow><mml:mi mathvariant="sans-serif">cda</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq217.gif"/></alternatives></inline-formula> is above <inline-formula id="IEq218"><alternatives><tex-math id="M439">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau $$\end{document}</tex-math><mml:math id="M440"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq218.gif"/></alternatives></inline-formula>.</p>
      </sec>
      <sec id="FPar11">
        <title>Example 11</title>
        <p id="Par103">(running example) We highlight in bold, in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, the relevant e<sc>BWTclust</sc>, that are e<sc>BWTclust</sc>[11, 14] and e<sc>BWTclust</sc>[22, 23]. Every other e<sc>BWTclust</sc> is either a run of a same symbol or the associated <inline-formula id="IEq219"><alternatives><tex-math id="M441">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {cda} $$\end{document}</tex-math><mml:math id="M442"><mml:mi mathvariant="sans-serif">cda</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq219.gif"/></alternatives></inline-formula> contains only one color or all of them.</p>
        <p>Now, we use the notion of relevant eBWTclust to obtain a list of compatible subsets of <inline-formula id="IEq220"><alternatives><tex-math id="M443">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}=\{C_1,\ldots ,C_h\}$$\end{document}</tex-math><mml:math id="M444"><mml:mrow><mml:mi mathvariant="script">Q</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq220.gif"/></alternatives></inline-formula>, having size at most <inline-formula id="IEq221"><alternatives><tex-math id="M445">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h-1$$\end{document}</tex-math><mml:math id="M446"><mml:mrow><mml:mi>h</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq221.gif"/></alternatives></inline-formula>.</p>
        <p>The whole strategy is summarized in the following three steps: <list list-type="order"><list-item><p id="Par106">Scan input data structures computed on <inline-formula id="IEq222"><alternatives><tex-math id="M447">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {\mathcal {S}}$$\end{document}</tex-math><mml:math id="M448"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq222.gif"/></alternatives></inline-formula>, and detect only the relevant eBWTclust of the restricted <inline-formula id="IEq223"><alternatives><tex-math id="M449">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {eBWT} (\mathcal {\mathcal {S}})|_{Q}$$\end{document}</tex-math><mml:math id="M450"><mml:msub><mml:mrow><mml:mtext>eBWT</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq223.gif"/></alternatives></inline-formula> (denoted by e<sc>BWTclust</sc>
<inline-formula id="IEq224"><alternatives><tex-math id="M451">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{\mathcal {Q}}[i,j]$$\end{document}</tex-math><mml:math id="M452"><mml:mrow><mml:msub><mml:mrow/><mml:mi mathvariant="script">Q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq224.gif"/></alternatives></inline-formula>, for some <inline-formula id="IEq225"><alternatives><tex-math id="M453">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i&lt;j$$\end{document}</tex-math><mml:math id="M454"><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq225.gif"/></alternatives></inline-formula>).</p></list-item><list-item><p id="Par107">For each eBWTclust <inline-formula id="IEq226"><alternatives><tex-math id="M455">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{\mathcal {Q}}[i,j]$$\end{document}</tex-math><mml:math id="M456"><mml:mrow><mml:msub><mml:mrow/><mml:mi mathvariant="script">Q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq226.gif"/></alternatives></inline-formula>, incrementally assign a score to the subset of <inline-formula id="IEq227"><alternatives><tex-math id="M457">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}$$\end{document}</tex-math><mml:math id="M458"><mml:mi mathvariant="script">Q</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq227.gif"/></alternatives></inline-formula> corresponding to <inline-formula id="IEq228"><alternatives><tex-math id="M459">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M460"><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq228.gif"/></alternatives></inline-formula>. Intuitively, we use the score to determine the order in which the subsets of <inline-formula id="IEq229"><alternatives><tex-math id="M461">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}$$\end{document}</tex-math><mml:math id="M462"><mml:mi mathvariant="script">Q</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq229.gif"/></alternatives></inline-formula> must be processed to output the list <italic>L</italic>.</p></list-item><list-item><p id="Par108">Output <italic>L</italic> by selecting <italic>compatible</italic> subsets of <inline-formula id="IEq230"><alternatives><tex-math id="M463">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}$$\end{document}</tex-math><mml:math id="M464"><mml:mi mathvariant="script">Q</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq230.gif"/></alternatives></inline-formula> that record the highest scores.</p></list-item></list>By Remark <xref ref-type="sec" rid="FPar1">1</xref>, any relevant eBWTclust <inline-formula id="IEq231"><alternatives><tex-math id="M465">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{\mathcal {Q}}$$\end{document}</tex-math><mml:math id="M466"><mml:msub><mml:mrow/><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq231.gif"/></alternatives></inline-formula> detected at the first step can be inferred by a linear scan of the input data structures <inline-formula id="IEq232"><alternatives><tex-math id="M467">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} (\mathcal {S}),\textsf {lcp} (\mathcal {S}),\textsf {cda} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M468"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="sans-serif">cda</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq232.gif"/></alternatives></inline-formula>.</p>
        <p>In general, any <inline-formula id="IEq233"><alternatives><tex-math id="M469">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M470"><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq233.gif"/></alternatives></inline-formula>-colored eBWTclust <inline-formula id="IEq234"><alternatives><tex-math id="M471">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{\mathcal {Q}}[i,j]$$\end{document}</tex-math><mml:math id="M472"><mml:mrow><mml:msub><mml:mrow/><mml:mi mathvariant="script">Q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq234.gif"/></alternatives></inline-formula> may not be relevant, and thus, it does not provide a score to its corresponding subset <inline-formula id="IEq235"><alternatives><tex-math id="M473">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M474"><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq235.gif"/></alternatives></inline-formula>. In our framework, each relevant eBWTclust <inline-formula id="IEq236"><alternatives><tex-math id="M475">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{\mathcal {Q}}[i,j]$$\end{document}</tex-math><mml:math id="M476"><mml:mrow><mml:msub><mml:mrow/><mml:mi mathvariant="script">Q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq236.gif"/></alternatives></inline-formula> contributes to the score of the subset <inline-formula id="IEq237"><alternatives><tex-math id="M477">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M478"><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq237.gif"/></alternatives></inline-formula> by one.</p>
        <p>Steps 1 and 2 are in fact performed simultaneously, and only subsets of <inline-formula id="IEq238"><alternatives><tex-math id="M479">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}$$\end{document}</tex-math><mml:math id="M480"><mml:mi mathvariant="script">Q</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq238.gif"/></alternatives></inline-formula> that provide at least one score are accounted for (without considering all the <inline-formula id="IEq239"><alternatives><tex-math id="M481">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2^h$$\end{document}</tex-math><mml:math id="M482"><mml:msup><mml:mn>2</mml:mn><mml:mi>h</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq239.gif"/></alternatives></inline-formula> possibilities).</p>
        <p>To build up the list <italic>L</italic> we greedily select the subsets of <inline-formula id="IEq240"><alternatives><tex-math id="M483">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}$$\end{document}</tex-math><mml:math id="M484"><mml:mi mathvariant="script">Q</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq240.gif"/></alternatives></inline-formula> having a high score and that are compatible with each other. In particular, we first order the subsets obtained by the positional clustering by their score, and then, by scanning the sorted scores we consider subsets one-by-one. For each <inline-formula id="IEq241"><alternatives><tex-math id="M485">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M486"><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq241.gif"/></alternatives></inline-formula> we compute the subset <inline-formula id="IEq242"><alternatives><tex-math id="M487">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U = \bigcup \gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M488"><mml:mrow><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:mo>⋃</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq242.gif"/></alternatives></inline-formula>, and add it to <italic>L</italic> if it is compatible with what added so far (i.e., a subset of, superset of or disjoint from all elements in <italic>L</italic>).</p>
      </sec>
      <sec id="FPar12">
        <title>Example 12</title>
        <p id="Par112">(Continued from Example <xref ref-type="sec" rid="FPar10">10</xref>) Suppose <inline-formula id="IEq243"><alternatives><tex-math id="M489">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathcal {Q}=\{\{1,3,4\},\{2\}\}$$\end{document}</tex-math><mml:math id="M490"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq243.gif"/></alternatives></inline-formula> is found to be compatible with what we have added to <italic>L</italic> so far. Then we add the set <inline-formula id="IEq244"><alternatives><tex-math id="M491">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U = \{1,3,4\}\cup \{2\} = \{1,2,3,4\}$$\end{document}</tex-math><mml:math id="M492"><mml:mrow><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">}</mml:mo><mml:mo>∪</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">}</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq244.gif"/></alternatives></inline-formula> to <italic>L</italic>.</p>
        <p>We stop adding subsets to <italic>L</italic> in some cases: </p>
        <p><italic>i</italic>) the maximum possible number of elements is reached (that is <inline-formula id="IEq245"><alternatives><tex-math id="M493">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h-2$$\end{document}</tex-math><mml:math id="M494"><mml:mrow><mml:mi>h</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq245.gif"/></alternatives></inline-formula>), </p>
        <p><italic>ii</italic>) the score decreases too much with respect to the highest score (e.g. two order of magnitude lower than the highest score) meaning that the subset associated is not trustworthy, </p>
        <p><italic>iii</italic>) the number of consecutive unsuccessful attempts to add elements to <italic>L</italic> exceeds a threshold value <italic>f</italic> (we set this as <inline-formula id="IEq246"><alternatives><tex-math id="M495">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\min \{2h,100\}$$\end{document}</tex-math><mml:math id="M496"><mml:mrow><mml:mo movablelimits="true">min</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>2</mml:mn><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mn>100</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq246.gif"/></alternatives></inline-formula>, so that it scales with the size of the instance, with the limit of 100 to prevent excessive degeneration of quality).</p>
      </sec>
    </sec>
    <sec id="Sec8">
      <title>Complexity</title>
      <p id="Par114">We observe here how the pre-processing step of our method, which consists in building the eBWT, LCP and DA data structures, can be computed in time and space linear in the number <italic>N</italic> of all symbols of the strings in <inline-formula id="IEq247"><alternatives><tex-math id="M497">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M498"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq247.gif"/></alternatives></inline-formula>.</p>
      <p id="Par115">The <sc>refinement</sc> procedure described in Subsect. "<xref rid="Sec7" ref-type="sec">The refinement procedure</xref>" can be computed in <italic>O</italic>(<italic>N</italic>) time and space: Indeed, given <inline-formula id="IEq248"><alternatives><tex-math id="M499">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}=\{C_1,...,C_h\}$$\end{document}</tex-math><mml:math id="M500"><mml:mrow><mml:mi mathvariant="script">Q</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq248.gif"/></alternatives></inline-formula> and <inline-formula id="IEq249"><alternatives><tex-math id="M501">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X=\bigcup \{C_1,...,C_h\}$$\end{document}</tex-math><mml:math id="M502"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mo>⋃</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq249.gif"/></alternatives></inline-formula>, the eBWT (resp. LCP and CDA) for <inline-formula id="IEq250"><alternatives><tex-math id="M503">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X\subseteq \mathcal {S}$$\end{document}</tex-math><mml:math id="M504"><mml:mrow><mml:mi>X</mml:mi><mml:mo>⊆</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq250.gif"/></alternatives></inline-formula> can be deduced in linear time in the length <italic>N</italic> of <inline-formula id="IEq251"><alternatives><tex-math id="M505">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M506"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq251.gif"/></alternatives></inline-formula> (resp. <inline-formula id="IEq252"><alternatives><tex-math id="M507">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M508"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq252.gif"/></alternatives></inline-formula> and <inline-formula id="IEq253"><alternatives><tex-math id="M509">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {cda} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M510"><mml:mrow><mml:mi mathvariant="sans-serif">cda</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq253.gif"/></alternatives></inline-formula>), including at the same time the detection of all positional clusters [<xref ref-type="bibr" rid="CR12">12</xref>]. Given an element of a eBWTclust[<italic>i</italic>, <italic>j</italic>] and <inline-formula id="IEq254"><alternatives><tex-math id="M511">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M512"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq254.gif"/></alternatives></inline-formula>, we can determine in <italic>O</italic>(1) time its color using the CDA; as we can pre-compute the size of all <inline-formula id="IEq255"><alternatives><tex-math id="M513">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_i$$\end{document}</tex-math><mml:math id="M514"><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq255.gif"/></alternatives></inline-formula>, this lets us easily determine the <inline-formula id="IEq256"><alternatives><tex-math id="M515">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _\mathcal {Q}$$\end{document}</tex-math><mml:math id="M516"><mml:msub><mml:mi>γ</mml:mi><mml:mi mathvariant="script">Q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq256.gif"/></alternatives></inline-formula>-coloring of the cluster and whether it is relevant or not (Definitions <xref ref-type="sec" rid="FPar7">7</xref> and <xref ref-type="sec" rid="FPar9">9</xref>) in time proportional to the cluster’s length. Overall, detecting positional clusters and assigning scores to subsets of <inline-formula id="IEq257"><alternatives><tex-math id="M517">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}$$\end{document}</tex-math><mml:math id="M518"><mml:mi mathvariant="script">Q</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq257.gif"/></alternatives></inline-formula> has a total cost of <italic>O</italic>(<italic>N</italic>) time.</p>
      <p id="Par116">While potentially there could be up to <inline-formula id="IEq258"><alternatives><tex-math id="M519">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2^h \le 2^\ell$$\end{document}</tex-math><mml:math id="M520"><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mi>h</mml:mi></mml:msup><mml:mo>≤</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>ℓ</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq258.gif"/></alternatives></inline-formula> possible subsets of <inline-formula id="IEq259"><alternatives><tex-math id="M521">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}$$\end{document}</tex-math><mml:math id="M522"><mml:mi mathvariant="script">Q</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq259.gif"/></alternatives></inline-formula>, we observe that each positional cluster can in fact define <italic>at most</italic> one of them, of size not greater than the length of the cluster. It follows that the list of subsets of <inline-formula id="IEq260"><alternatives><tex-math id="M523">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}$$\end{document}</tex-math><mml:math id="M524"><mml:mi mathvariant="script">Q</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq260.gif"/></alternatives></inline-formula>, from which we select the elements of <italic>L</italic>, has <inline-formula id="IEq261"><alternatives><tex-math id="M525">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;N$$\end{document}</tex-math><mml:math id="M526"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq261.gif"/></alternatives></inline-formula> elements, and the sum of their sizes is too at most <italic>N</italic>.</p>
      <p id="Par117">Next, the algorithm sorts by score the subsets of <inline-formula id="IEq262"><alternatives><tex-math id="M527">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {Q}$$\end{document}</tex-math><mml:math id="M528"><mml:mi mathvariant="script">Q</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq262.gif"/></alternatives></inline-formula> found by the positional clustering, which using a bucket sort takes <italic>O</italic>(<italic>N</italic>) time. Finally, we need to scan the sorted subsets as to obtain the output list <italic>L</italic> of compatible subsets, and insert new nodes in the partition tree <italic>T</italic> (<sc>draw_and_mark</sc> procedure).</p>
      <p id="Par118">To check whether a subset <inline-formula id="IEq263"><alternatives><tex-math id="M529">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q'\subseteq \mathcal {Q}$$\end{document}</tex-math><mml:math id="M530"><mml:mrow><mml:msup><mml:mi>Q</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⊆</mml:mo><mml:mi mathvariant="script">Q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq263.gif"/></alternatives></inline-formula> is compatible with the ones inserted in <italic>T</italic> so far, we proceed as follows: taken any element <inline-formula id="IEq264"><alternatives><tex-math id="M531">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y\in Q'$$\end{document}</tex-math><mml:math id="M532"><mml:mrow><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq264.gif"/></alternatives></inline-formula>, take the leaf-to-root path from <italic>y</italic> to the root,<xref ref-type="fn" rid="Fn3">3</xref> and consider for each node the cardinality of its set. If <inline-formula id="IEq265"><alternatives><tex-math id="M533">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q'$$\end{document}</tex-math><mml:math id="M534"><mml:msup><mml:mi>Q</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq265.gif"/></alternatives></inline-formula> is compatible, it must be inserted at one specific point in this path, i.e., where the cardinality of the lower node is <inline-formula id="IEq266"><alternatives><tex-math id="M535">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt; |Q'|$$\end{document}</tex-math><mml:math id="M536"><mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>Q</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq266.gif"/></alternatives></inline-formula> and that of the upper node is <inline-formula id="IEq267"><alternatives><tex-math id="M537">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt;|Q'|$$\end{document}</tex-math><mml:math id="M538"><mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>Q</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq267.gif"/></alternatives></inline-formula> (the path has length <inline-formula id="IEq268"><alternatives><tex-math id="M539">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le \ell$$\end{document}</tex-math><mml:math id="M540"><mml:mrow><mml:mo>≤</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq268.gif"/></alternatives></inline-formula> and we only need to scan it once to find the spot, so this can be obtained in <inline-formula id="IEq269"><alternatives><tex-math id="M541">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\ell )$$\end{document}</tex-math><mml:math id="M542"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq269.gif"/></alternatives></inline-formula> time). At this point, we identified the potential parent <italic>P</italic> of <inline-formula id="IEq270"><alternatives><tex-math id="M543">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q'$$\end{document}</tex-math><mml:math id="M544"><mml:msup><mml:mi>Q</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq270.gif"/></alternatives></inline-formula>, and we only need to verify that indeed <inline-formula id="IEq271"><alternatives><tex-math id="M545">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q'\subset P$$\end{document}</tex-math><mml:math id="M546"><mml:mrow><mml:msup><mml:mi>Q</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⊂</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq271.gif"/></alternatives></inline-formula> (<italic>O</italic>(|<italic>P</italic>|) time), and that, for each child <inline-formula id="IEq272"><alternatives><tex-math id="M547">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_i$$\end{document}</tex-math><mml:math id="M548"><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq272.gif"/></alternatives></inline-formula> of <italic>P</italic>, either <inline-formula id="IEq273"><alternatives><tex-math id="M549">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_i\subset Q'$$\end{document}</tex-math><mml:math id="M550"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⊂</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq273.gif"/></alternatives></inline-formula> or <inline-formula id="IEq274"><alternatives><tex-math id="M551">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|P\cap Q'| = 0$$\end{document}</tex-math><mml:math id="M552"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>P</mml:mi><mml:mo>∩</mml:mo></mml:mrow><mml:msup><mml:mi>Q</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq274.gif"/></alternatives></inline-formula>; this latter step also takes <inline-formula id="IEq275"><alternatives><tex-math id="M553">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\sum |Q'|) = O(|P|)$$\end{document}</tex-math><mml:math id="M554"><mml:mrow><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>∑</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>Q</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq275.gif"/></alternatives></inline-formula> time, with <inline-formula id="IEq276"><alternatives><tex-math id="M555">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|P|\le \ell$$\end{document}</tex-math><mml:math id="M556"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>≤</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq276.gif"/></alternatives></inline-formula> since <inline-formula id="IEq277"><alternatives><tex-math id="M557">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\subseteq \mathcal {S}$$\end{document}</tex-math><mml:math id="M558"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⊆</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq277.gif"/></alternatives></inline-formula>. This means we can identify whether <inline-formula id="IEq278"><alternatives><tex-math id="M559">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q'$$\end{document}</tex-math><mml:math id="M560"><mml:msup><mml:mi>Q</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq278.gif"/></alternatives></inline-formula> is compatible, and in case already identify the nodes that should become children of <inline-formula id="IEq279"><alternatives><tex-math id="M561">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q'$$\end{document}</tex-math><mml:math id="M562"><mml:msup><mml:mi>Q</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq279.gif"/></alternatives></inline-formula>, in <inline-formula id="IEq280"><alternatives><tex-math id="M563">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\ell )$$\end{document}</tex-math><mml:math id="M564"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq280.gif"/></alternatives></inline-formula> time.</p>
      <p id="Par120">Since the maximum number of subsets we analyze from the sorted list is limited by <inline-formula id="IEq281"><alternatives><tex-math id="M565">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f\cdot s$$\end{document}</tex-math><mml:math id="M566"><mml:mrow><mml:mi>f</mml:mi><mml:mo>·</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq281.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq282"><alternatives><tex-math id="M567">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s\le h$$\end{document}</tex-math><mml:math id="M568"><mml:mrow><mml:mi>s</mml:mi><mml:mo>≤</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq282.gif"/></alternatives></inline-formula> is the number of successful insertions in <italic>L</italic>, and <italic>f</italic> the limit of consecutive failures allowed, the total cost of this step is <inline-formula id="IEq283"><alternatives><tex-math id="M569">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(fs\ell )$$\end{document}</tex-math><mml:math id="M570"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mi>s</mml:mi><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq283.gif"/></alternatives></inline-formula>, meaning that the total cost of each execution of <sc>refinement</sc> is <inline-formula id="IEq284"><alternatives><tex-math id="M571">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(N+fs\ell )$$\end{document}</tex-math><mml:math id="M572"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mi>s</mml:mi><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq284.gif"/></alternatives></inline-formula>.</p>
      <p id="Par121">The number of executions of <sc>refinement</sc> is bounded by the final number of nodes in <italic>T</italic>, that is <inline-formula id="IEq285"><alternatives><tex-math id="M573">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\ell )$$\end{document}</tex-math><mml:math id="M574"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq285.gif"/></alternatives></inline-formula>. Furthermore, the total cost of the <inline-formula id="IEq286"><alternatives><tex-math id="M575">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(fs\ell )$$\end{document}</tex-math><mml:math id="M576"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mi>s</mml:mi><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq286.gif"/></alternatives></inline-formula> factors can be amortized to <inline-formula id="IEq287"><alternatives><tex-math id="M577">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(f\ell ^2)$$\end{document}</tex-math><mml:math id="M578"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:msup><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq287.gif"/></alternatives></inline-formula> in that only up to <inline-formula id="IEq288"><alternatives><tex-math id="M579">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell$$\end{document}</tex-math><mml:math id="M580"><mml:mi>ℓ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq288.gif"/></alternatives></inline-formula> successful insertions can be performed in total on <italic>T</italic>. It follows that the total cost is bounded by <inline-formula id="IEq289"><alternatives><tex-math id="M581">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(N\ell + f\ell ^2)$$\end{document}</tex-math><mml:math id="M582"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mi>ℓ</mml:mi><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:msup><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq289.gif"/></alternatives></inline-formula>. Finally, as <italic>f</italic> is a constant (no greater than 100) and <inline-formula id="IEq290"><alternatives><tex-math id="M583">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell \le N$$\end{document}</tex-math><mml:math id="M584"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>≤</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq290.gif"/></alternatives></inline-formula> since each taxon has a positive length, we have <inline-formula id="IEq291"><alternatives><tex-math id="M585">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(N\ell + f\ell ^2) = O(N\ell )$$\end{document}</tex-math><mml:math id="M586"><mml:mrow><mml:mi>O</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mi>ℓ</mml:mi><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:msup><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq291.gif"/></alternatives></inline-formula>.</p>
      <p id="Par122">As for the space requirement, it is that of <sc>refinement</sc> plus the maximum size of the Queue and the tree <italic>T</italic>: <sc>refinement</sc> requires <italic>O</italic>(<italic>N</italic>) space for the ebwt structures; the Queue only holds up to <inline-formula id="IEq292"><alternatives><tex-math id="M587">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell$$\end{document}</tex-math><mml:math id="M588"><mml:mi>ℓ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq292.gif"/></alternatives></inline-formula> pointers to the tree <italic>T</italic>, and the latter tree has <inline-formula id="IEq293"><alternatives><tex-math id="M589">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\ell )$$\end{document}</tex-math><mml:math id="M590"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq293.gif"/></alternatives></inline-formula> nodes each of size <inline-formula id="IEq294"><alternatives><tex-math id="M591">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\ell )$$\end{document}</tex-math><mml:math id="M592"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq294.gif"/></alternatives></inline-formula>. The following holds:</p>
      <sec id="FPar13">
        <title>Lemma 13</title>
        <p id="Par123">Given a set <inline-formula id="IEq295"><alternatives><tex-math id="M593">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M594"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq295.gif"/></alternatives></inline-formula> of <inline-formula id="IEq296"><alternatives><tex-math id="M595">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell$$\end{document}</tex-math><mml:math id="M596"><mml:mi>ℓ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq296.gif"/></alternatives></inline-formula> taxa, whose total length is <italic>N</italic>, phyBWT2 reconstructs a phylogenetic tree for <inline-formula id="IEq297"><alternatives><tex-math id="M597">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M598"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq297.gif"/></alternatives></inline-formula> in <inline-formula id="IEq298"><alternatives><tex-math id="M599">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(N\ell )$$\end{document}</tex-math><mml:math id="M600"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq298.gif"/></alternatives></inline-formula> time and <inline-formula id="IEq299"><alternatives><tex-math id="M601">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(N + \ell ^2)$$\end{document}</tex-math><mml:math id="M602"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq299.gif"/></alternatives></inline-formula> space.</p>
        <p>We observe that <italic>N</italic> is the dominant factor in this complexity, as the length of the strings representing a taxon is -in known applications- many orders of magnitude greater than the number <inline-formula id="IEq300"><alternatives><tex-math id="M603">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell$$\end{document}</tex-math><mml:math id="M604"><mml:mi>ℓ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq300.gif"/></alternatives></inline-formula> of taxa.</p>
        <p>Furthermore, <inline-formula id="IEq301"><alternatives><tex-math id="M605">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(N\ell )$$\end{document}</tex-math><mml:math id="M606"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq301.gif"/></alternatives></inline-formula> time corresponds to the worst case in which the <sc>refinement</sc> procedure only generates one new node each time. As <sc>refinement</sc> is able to create nodes on various levels at once, this is not the expected behaviour: as showcased in Sect. "<xref rid="Sec9" ref-type="sec">Experimental evaluation</xref>" the number of calls of the <sc>refinement</sc> procedure is far less than <inline-formula id="IEq302"><alternatives><tex-math id="M607">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell$$\end{document}</tex-math><mml:math id="M608"><mml:mi>ℓ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq302.gif"/></alternatives></inline-formula> in practice.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Experimental evaluation</title>
    <p id="Par126">In this section we test the performance of phyBWT2 for reconstructing phylogenetic trees from short-reads and de novo assembled sequences. Indeed, as for the previous version phyBWT, its usage is not limited to a particular type of input since both types of data are accepted as input. However, the diversity between the two type of input data requires a tuning of the parameters (<inline-formula id="IEq303"><alternatives><tex-math id="M609">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{min}$$\end{document}</tex-math><mml:math id="M610"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="italic">min</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq303.gif"/></alternatives></inline-formula> and <inline-formula id="IEq304"><alternatives><tex-math id="M611">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M612"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq304.gif"/></alternatives></inline-formula>).</p>
    <p id="Par127">For comparison, we selected the recently introduced tool SANS [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR25">25</xref>] since it shares several features with phyBWT2: both are whole-genome based, alignment- and reference-free approaches for phylogenetic reconstruction that do not use or produce pairwise comparisons of the sequences or their characteristics. We used the latest version<xref ref-type="fn" rid="Fn4">4</xref> of SANS [<xref ref-type="bibr" rid="CR25">25</xref>], a stand-alone re-implementation of the theoretical approach presented in [<xref ref-type="bibr" rid="CR24">24</xref>] that improves both running time and memory usage.</p>
    <p id="Par129">Differently from phyBWT2, SANS is based on the construction of a list of splits obtained by computing all the <italic>k</italic>-mers of the dataset, which are either directly extracted or stored in a colored de Bruijn graph. Thus, it requires to fix a-priori the value <italic>k</italic>. Then, the list of splits is post-processed according to filtering strategies (options proposed in SplitsTree [<xref ref-type="bibr" rid="CR26">26</xref>]) that allow to limit the output splits in order to show phylogenetic networks or to calculate a subset of them representing a tree. For the sake of comparison, we applied to SANS the last filtering approach for drawing trees.</p>
    <p id="Par130">In our experiments, in order to improve the sensitivity of our tool (note that SANS performs implicitly this step by adding the reverse-complement of the k-mers), we added the reverse-complement of the strings to each set of taxa.</p>
    <p id="Par131"><italic>Implementation</italic> Our tool has been implemented in C++. All tests were done on a DELL PowerEdge R750 machine, used in non exclusive mode. Our platform is a 24-core machine with 2 Intel(R) Xeon(R) Gold 5318Y 24C/48T CPUs at 2.10 GHz, with 629 GB. The system is Ubuntu 22.04.1 LTS.</p>
    <p id="Par132"><italic>Input and Output</italic> phyBWT2 takes as input ebwt (<inline-formula id="IEq305"><alternatives><tex-math id="M613">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M614"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq305.gif"/></alternatives></inline-formula>), lcp (<inline-formula id="IEq306"><alternatives><tex-math id="M615">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M616"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq306.gif"/></alternatives></inline-formula>) and cda (<inline-formula id="IEq307"><alternatives><tex-math id="M617">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {S}$$\end{document}</tex-math><mml:math id="M618"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq307.gif"/></alternatives></inline-formula>), the parameter <inline-formula id="IEq308"><alternatives><tex-math id="M619">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m$$\end{document}</tex-math><mml:math id="M620"><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq308.gif"/></alternatives></inline-formula> that is used to remove the noise during the construction of the positional clusters and the support threshold value <inline-formula id="IEq309"><alternatives><tex-math id="M621">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M622"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq309.gif"/></alternatives></inline-formula> in (0, 1] used for each positional cluster coloring. Such data structures can be computed via the bash script that we provide in the phyBWT2 repository. In the current implementation, the data structures are given in uncompressed form, but phyBWT2 can be adapted to directly take as input compressed data structures [<xref ref-type="bibr" rid="CR31">31</xref>].</p>
    <p id="Par133">Our tool outputs an unrooted tree in newick format. The trees<xref ref-type="fn" rid="Fn5">5</xref> reported in this paper are drawn by using the Interactive Tree Of Life (iTOL) tool [<xref ref-type="bibr" rid="CR32">32</xref>].</p>
    <p id="Par135"><italic>Datasets</italic> To show the effectiveness of our method, we have chosen six datasets with a diverse number of taxa, composition and different length of the strings (Table <xref rid="Tab1" ref-type="table">1</xref>). More in details, we used six different types of datasets: i) Illumina sequencing data (short reads) for seven <italic>S. cerevisiae</italic> and five <italic>S. paradoxus</italic> strains from the study in [<xref ref-type="bibr" rid="CR33">33</xref>]; ii) assemblies from 12 species of the genus <italic>Drosophila</italic> from the FlyBase database (largely accepted phylogeny shown in [<xref ref-type="bibr" rid="CR34">34</xref>]) (also analyzed in [<xref ref-type="bibr" rid="CR24">24</xref>]); iii) Illumina sequencing data (short reads) for 42 <italic>S. cerevisiae</italic> strains selected from the studies in [<xref ref-type="bibr" rid="CR35">35</xref>, <xref ref-type="bibr" rid="CR36">36</xref>] and from the public repository under accession code PRJEB50706. iv) 43 HIV-1 complete genomes used in the literature [<xref ref-type="bibr" rid="CR37">37</xref>]; v) 20 sequences from Ebolavirus genus selected in [<xref ref-type="bibr" rid="CR38">38</xref>, <xref ref-type="bibr" rid="CR39">39</xref>]. vi) 27 genomes from <italic>E. coli</italic> and <italic>Shigella</italic> from the studies in [<xref ref-type="bibr" rid="CR40">40</xref>, <xref ref-type="bibr" rid="CR41">41</xref>].</p>
    <p id="Par136"><italic>Resource usage</italic> The new version phyBWT2 improves the performance of the former version phyBWT by reducing the internal memory usage and the running time on large datasets. Indeed, phyBWT2 does not load in main memory the data structures: it performs the clustering detection by reading portions of the input data structures computed for the whole dataset and by (possibly) reducing them to a subset of strings at the same time.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Datasets</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Datasets</th><th align="left">Composition</th><th align="left">Number<break/>of taxa</th><th align="left">Number<break/>of sequences</th><th align="left">Number<break/>of bp</th></tr></thead><tbody><tr><td align="left">12 yeasts</td><td align="left">Illumina paired-end reads</td><td char="." align="char">12</td><td align="left">60,000,000</td><td char="." align="char">9,060,000,000</td></tr><tr><td align="left">Drosophila</td><td align="left">assemblies</td><td char="." align="char">12</td><td align="left">121,491</td><td char="." align="char">4,323,268,803</td></tr><tr><td align="left">42 yeasts</td><td align="left">Illumina paired-end reads</td><td char="." align="char">42</td><td align="left">119,641,704</td><td char="." align="char">15,664,843,102</td></tr><tr><td align="left">HIV-1</td><td align="left">genomes</td><td char="." align="char">43</td><td align="left">43</td><td char="." align="char">388,535</td></tr><tr><td align="left">Ebolavirus</td><td align="left">genomes</td><td char="." align="char">20</td><td align="left">20</td><td char="." align="char">378,002</td></tr><tr><td align="left"><italic>E. coli</italic>—Shigella</td><td align="left">genomes</td><td char="." align="char">27</td><td align="left">27</td><td char="." align="char">132,466,506</td></tr></tbody></table></table-wrap><table-wrap id="Tab2"><label>Table 2</label><caption><p>Running times and RAM both phyBWT2 and SANS</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="4">Datasets</th><th align="left" colspan="4">PhyBWT2</th><th align="left" colspan="3">SANS</th></tr><tr><th align="left" colspan="2">Preprocessing</th><th align="left" colspan="2">Phylogeny</th><th align="left" rowspan="2">RAM</th><th align="left" rowspan="2">Wall clock</th><th align="left" rowspan="2"/></tr><tr><th align="left" rowspan="2">RAM (Kb)</th><th align="left" rowspan="2">Wall clock (hh:mm:ss)</th><th align="left" rowspan="2">RAM (Kb)</th><th align="left" rowspan="2">Wall clock (hh:mm:ss)</th></tr><tr><th align="left">(Kb)</th><th align="left">(hh:mm:ss)</th><th align="left"/></tr></thead><tbody><tr><td align="left">12 yeasts</td><td align="left">27,559,652</td><td align="left">3:19:03</td><td align="left">6752</td><td align="left">3:12</td><td align="left">2,779,692</td><td align="left">35:58</td><td align="left"/></tr><tr><td align="left">Drosophila</td><td align="left">92,536,548</td><td align="left">26:11</td><td align="left">9516</td><td align="left">8:50</td><td align="left">30,107,232</td><td align="left">21:04</td><td align="left"/></tr><tr><td align="left">42 yeasts</td><td align="left">47,696,220</td><td align="left">(BCR+bwt2lcp) 08:06:08</td><td align="left" rowspan="2">1,874,388</td><td align="left" rowspan="2">01:26:17</td><td align="left">14,128,724</td><td align="left">32:48:43</td><td align="left">(k=32)</td></tr><tr><td align="left"/><td align="left">4,461,196</td><td align="left">(only BCR) 16:27:45</td><td align="left">12,368,416</td><td align="left">45:52:01</td><td align="left">(k=25)</td></tr><tr><td align="left">HIV-1</td><td align="left">18,996</td><td align="left"><inline-formula id="IEq310"><alternatives><tex-math id="M623">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt; 1$$\end{document}</tex-math><mml:math id="M624"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq310.gif"/></alternatives></inline-formula>s</td><td align="left">8452</td><td align="left"><inline-formula id="IEq311"><alternatives><tex-math id="M625">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt; 1$$\end{document}</tex-math><mml:math id="M626"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq311.gif"/></alternatives></inline-formula>s</td><td align="left">9,020</td><td align="left"><inline-formula id="IEq312"><alternatives><tex-math id="M627">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt; 1$$\end{document}</tex-math><mml:math id="M628"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq312.gif"/></alternatives></inline-formula>s</td><td align="left"/></tr><tr><td align="left">Ebolavirus</td><td align="left">18,256</td><td align="left"><inline-formula id="IEq313"><alternatives><tex-math id="M629">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt; 1$$\end{document}</tex-math><mml:math id="M630"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq313.gif"/></alternatives></inline-formula>s</td><td align="left">8460</td><td align="left"><inline-formula id="IEq314"><alternatives><tex-math id="M631">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt; 1$$\end{document}</tex-math><mml:math id="M632"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq314.gif"/></alternatives></inline-formula>s</td><td align="left">9,112</td><td align="left"><inline-formula id="IEq315"><alternatives><tex-math id="M633">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt; 1$$\end{document}</tex-math><mml:math id="M634"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq315.gif"/></alternatives></inline-formula>s</td><td align="left"/></tr><tr><td align="left"><italic>E. coli</italic>—Shigella</td><td align="left">5,484,644</td><td align="left">1:21</td><td align="left">12,648</td><td align="left">1:38</td><td align="left">303,868</td><td align="left">3:06</td><td align="left"/></tr></tbody></table><table-wrap-foot><p>We also show the the resources needed to build the data structures during the preprocessing using the tool BCR [<xref ref-type="bibr" rid="CR15">15</xref>] and bwt2lcp [<xref ref-type="bibr" rid="CR46">46</xref>] for short reads and gsufsort [<xref ref-type="bibr" rid="CR45">45</xref>] for long sequences. All tools were run using one core only. The wall clock time and RAM usage are taken from the output of the /usr/bin/time command.</p></table-wrap-foot></table-wrap></p>
    <p id="Par137">In Table <xref rid="Tab2" ref-type="table">2</xref> we report the running times of both phyBWT2 and SANS on the tested datasets. We separate the running time required to build the data structures from the running time of phyBWT2 for several reasons.</p>
    <p id="Par138">First, the input data structures eBWT, LCP and CDA are well-known structures in string algorithms and in bioinformatics, and efficiently building these data structures is a well-studied problem ( [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR42">42</xref>–<xref ref-type="bibr" rid="CR49">49</xref>]). Thus, analyzing the best way to compute them efficiently does not fall within the goal of this paper.</p>
    <p id="Par139">Second, the data structures do not depend on the <inline-formula id="IEq316"><alternatives><tex-math id="M635">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m$$\end{document}</tex-math><mml:math id="M636"><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq316.gif"/></alternatives></inline-formula>-value used to remove the noise during the construction of the positional clusters. Therefore, they need to be built only once for each input dataset. One can try different parameters or techniques for inferring confidence values on phylogenetic trees (based on reconstructing many trees) without having to rebuild the data structures.</p>
    <p id="Par140">The last feature does not hold for <italic>k</italic>-mers-based methods, such as SANS, whose data structures must be recomputed when varying the input parameter <italic>k</italic>.</p>
    <p id="Par141">Nevertheless, we experimentally observed that the pre-processing step (see Table <xref rid="Tab2" ref-type="table">2</xref>) is computationally more expensive than the phylogeny construction.</p>
    <sec id="Sec10">
      <title>Experiments on 12 yeasts</title>
      <p id="Par142">This dataset comprises 12 Illumina 151-bp paired-end sequencing experiments obtained from the study in [<xref ref-type="bibr" rid="CR33">33</xref>], and deposited in the public repository SRA (Short Reads Archive) under accession code PRJNA340312. We selected seven sequencing data from the <italic>S. cerevisiae</italic> strains and five from the <italic>S. paradoxus</italic> strains. We performed adaptor-removing and quality-based trimming using trimmomatic [<xref ref-type="bibr" rid="CR50">50</xref>], as described in [<xref ref-type="bibr" rid="CR33">33</xref>]. Then, for each sequencing experiment, we extracted 5 million of 151-bp paired-end reads as to form a dataset with <inline-formula id="IEq317"><alternatives><tex-math id="M637">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$60\times$$\end{document}</tex-math><mml:math id="M638"><mml:mrow><mml:mn>60</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq317.gif"/></alternatives></inline-formula> coverage on average per strain and a total FASTA file size of 26 GB.</p>
      <p id="Par143"><italic>Validation and results</italic> As benchmark tree we used the one reported in Fig. <xref rid="Fig4" ref-type="fig">4</xref> obtained from the original study [<xref ref-type="bibr" rid="CR33">33</xref>]. Remarkably, the benchmark was built using nuclear one-to-one orthologs, i.e. the sequences of nuclear genes which are shared among (<italic>i</italic>) the seven <italic>S. cerevisiae</italic>, (<italic>ii</italic>) the five <italic>S. paradoxus</italic> strains sequenced in the study, and (<italic>iii</italic>) six outgroups from the <italic>Saccharomyces</italic> genus.<fig id="Fig4"><label>Fig. 4</label><caption><p>Benchmark phylogeny for the yeasts dataset. Figure redrawn from [<xref ref-type="bibr" rid="CR33">33</xref>]</p></caption><graphic xlink:href="13015_2023_232_Fig4_HTML" id="MO4"/></fig><fig id="Fig5"><label>Fig. 5</label><caption><p>Yeasts phylogeny by phyBWT and phyBWT2 (<bold>a</bold>) and by SANS (<bold>b</bold>)</p></caption><graphic xlink:href="13015_2023_232_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par144">The tree depicted in Fig. <xref rid="Fig5" ref-type="fig">5</xref>a has been obtained by the first version phyBWT, for any <inline-formula id="IEq318"><alternatives><tex-math id="M639">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m\ge 14$$\end{document}</tex-math><mml:math id="M640"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mn>14</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq318.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq319"><alternatives><tex-math id="M641">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau =0.6$$\end{document}</tex-math><mml:math id="M642"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq319.gif"/></alternatives></inline-formula> and <italic>t</italic> being the number of taxa. By running phyBWT2 on the same input we obtain the same reconstructed phylogeny with similar parameters, i.e. for any <inline-formula id="IEq320"><alternatives><tex-math id="M643">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m&gt;15$$\end{document}</tex-math><mml:math id="M644"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>15</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq320.gif"/></alternatives></inline-formula> and <inline-formula id="IEq321"><alternatives><tex-math id="M645">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau =0.6$$\end{document}</tex-math><mml:math id="M646"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq321.gif"/></alternatives></inline-formula> (parameter <italic>t</italic> being removed in phyBWT2). For running SANS, analogously to [<xref ref-type="bibr" rid="CR11">11</xref>], we use default parameters that corresponds to setting the <italic>k</italic>-mer length to 32 (-DmaxN=32), and in addition, we set the option -f strict in order to output a tree in the Newick format (see Fig. <xref rid="Fig5" ref-type="fig">5</xref>b).</p>
      <p id="Par145">Both phyBWT2 and SANS separate the <italic>S. cerevisiae</italic> and the <italic>S. paradoxus</italic> strains, which show an average whole-genome sequence divergence of <inline-formula id="IEq322"><alternatives><tex-math id="M647">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim$$\end{document}</tex-math><mml:math id="M648"><mml:mo>∼</mml:mo></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq322.gif"/></alternatives></inline-formula> 10%. As expected, by taking into account the relatively high divergence among <italic>S. paradoxus</italic> strains (0.5% - 4.5%), also the same <italic>S. paradoxus</italic> partition is obtained. On the other hand, a few differences are shown in the <italic>S. cerevisiae</italic> partition which groups strains with a sequence divergence <inline-formula id="IEq323"><alternatives><tex-math id="M649">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim$$\end{document}</tex-math><mml:math id="M650"><mml:mo>∼</mml:mo></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq323.gif"/></alternatives></inline-formula> 0.5%. Compared to SANS, phyBWT2 produces a tree which is closer to the benchmark although the differences with the benchmark shown by both SANS and our method can be explained considering the relatively low divergence among <italic>S. cereviasiae</italic> strains as well as the partially admixed genomes of some of the trains (e.g. S288C and DBVPG6044) [<xref ref-type="bibr" rid="CR51">51</xref>].</p>
      <p id="Par146">For a fair comparison, we also run SANS with different values of the input parameter <italic>k</italic> (i.e. by varying <italic>k</italic> in the range [15, 50]). The unrooted phylogenetic tree obtained for <italic>k</italic> in [15, 27] is topologically equivalent to the one obtained from our approach depicted in Fig. <xref rid="Fig5" ref-type="fig">5</xref>a, but the UWOPS034614 strain is clustered with the <italic>S. paradoxus</italic> clade rather than <italic>S. cerevisiae</italic> clade. Instead, for <inline-formula id="IEq324"><alternatives><tex-math id="M651">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k&gt;40$$\end{document}</tex-math><mml:math id="M652"><mml:mrow><mml:mi>k</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>40</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq324.gif"/></alternatives></inline-formula>, either the strain UWOPS919171 is misplaced or the stains Y12 and YPS128 are not grouped together, differently from the benchmark tree.</p>
      <p id="Par147"><italic>Time and memory</italic> Given the necessary data structures for this dataset, the former version phyBWT runs in approximately 12 min with a memory peak of 81 GB by loading the whole data structures in the main memory. The new version phyBWT2 uses only 6.5 MB of internal memory and fulfills the task in 3:12 min reducing the number of performed iterations from 6 to 1 (using the same parameter setting <inline-formula id="IEq325"><alternatives><tex-math id="M653">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m=22$$\end{document}</tex-math><mml:math id="M654"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>22</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq325.gif"/></alternatives></inline-formula> and <inline-formula id="IEq326"><alternatives><tex-math id="M655">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau =0.6$$\end{document}</tex-math><mml:math id="M656"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq326.gif"/></alternatives></inline-formula> for both versions). On the same datasets, using default parameters, SANS runs in 30:29 min by using 3.7 GB of internal memory. However, a direct time and memory comparison between phyBWT2 and SANS is not completely fair, as they take different inputs: if we do not assume availability of the data structures, computing them for this dataset takes over 3 hours, so SANS would be faster (see Table <xref rid="Tab2" ref-type="table">2</xref> for details).</p>
    </sec>
    <sec id="Sec11">
      <title>Experiments on <italic>Drosophila</italic></title>
      <p id="Par148">Drosophila data are downloaded from the FlyBase database.<xref ref-type="fn" rid="Fn6">6</xref> This dataset includes assemblies from 12 species of the genus <italic>Drosophila</italic>: <italic>D. melanogaster</italic> (mel), <italic>D. ananassae</italic> (ana), <italic>D. erecta</italic> (ere), <italic>D. grimshawi</italic> (gri), <italic>D. mojavensis</italic> (moj), <italic>D. persimilis</italic> (per), <italic>D. pseudoobscura</italic> (pse), <italic>D. sechellia</italic> (sec), <italic>D. simulans</italic> (sim), <italic>D. virilis</italic> (vir), <italic>D. willistoni</italic> (wil), and <italic>D. yakuba</italic> (yak). Nine of these species fall within the Sophophora subgenus, which includes members of the melanogaster, obscura and willistoni groups.</p>
      <p id="Par150">The number of strings for each species varies: it ranges from 1, 870 for <italic>D. melanogaster</italic> to 17, 440 for <italic>D. grimshawi</italic>. The obtained dataset is a medium-sized input with a total number of symbols of more than 2, 161 Mbp. More details are reported in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
      <p id="Par151"><italic>Validation and results</italic> As benchmark tree we used the accepted phylogeny [<xref ref-type="bibr" rid="CR34">34</xref>] which we report in Fig. <xref rid="Fig6" ref-type="fig">6</xref>b. For this dataset, phyBWT2 produces the same tree as the one obtained in [<xref ref-type="bibr" rid="CR11">11</xref>] by using phyBWT for any <inline-formula id="IEq327"><alternatives><tex-math id="M657">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m$$\end{document}</tex-math><mml:math id="M658"><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq327.gif"/></alternatives></inline-formula> in [23, 45] and <inline-formula id="IEq328"><alternatives><tex-math id="M659">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau =0.5$$\end{document}</tex-math><mml:math id="M660"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq328.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a). The same parameter settings used for phyBWT also hold for phyBWT2. The <italic>Sophophora</italic> subgenus as well as the <italic>Drosophila</italic> subgenus are correctly detected, and inside the <italic>Sophophora</italic> subgenus, the <italic>melanogaster</italic> subgroup is correctly isolated. The only difference with respect to the benchmark tree by [<xref ref-type="bibr" rid="CR34">34</xref>] is the taxon <italic>D. ananassae</italic> that represents the <italic>ananassae</italic> subgroup. Such subgroup is part of the <italic>melanogaster</italic> group together with <italic>D. melanogaster</italic>, <italic>D. sechellia</italic>, <italic>D. simulans</italic>, <italic>D. erecta</italic> and <italic>D. yakuba</italic>. However, our method places <italic>D. ananassae</italic> closer to the <italic>obscura</italic> group rather than the <italic>melanogaster</italic> subgroup. SANS was run with default values as described in [<xref ref-type="bibr" rid="CR24">24</xref>], and the reconstructed tree obtained by option -f strict is topologically equivalent to the benchmark reference tree.<fig id="Fig6"><label>Fig. 6</label><caption><p>Drosophila phylogeny: <bold>a</bold> by our method; <bold>b</bold> benchmark redrawn from [<xref ref-type="bibr" rid="CR34">34</xref>]</p></caption><graphic xlink:href="13015_2023_232_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par152"><italic>Time and memory</italic> phyBWT2 improves upon phyBWT by reducing the memory usage from 24 GB to 9 MB, and by reducing the number of iterations from 4 to 2 for <inline-formula id="IEq329"><alternatives><tex-math id="M661">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m=23$$\end{document}</tex-math><mml:math id="M662"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>23</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq329.gif"/></alternatives></inline-formula> and <inline-formula id="IEq330"><alternatives><tex-math id="M663">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau =0.5$$\end{document}</tex-math><mml:math id="M664"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq330.gif"/></alternatives></inline-formula>. Nevertheless, the running time of phyBWT2 is around 9 min, more than phyBWT which ends in less than 2 min; this is mainly due to the fact that input data structures are kept on the disk. By using default parameters, SANS uses an amount of internal memory similar to phyBWT (28.7 GB) and ends in around 21 min.</p>
    </sec>
    <sec id="Sec12">
      <title>Experiments on 42 yeasts</title>
      <p id="Par153">In order to test the accuracy of phyBWT2 in discerning closely related populations (with sequence divergence varying between 0.5% and 1%), we selected 42 representative <italic>S. cerevisiae</italic> strains and produced their phylogenetic tree.</p>
      <p id="Par154">This dataset comprises 42 Illumina paired-end sequencing experiments obtained from the study in [<xref ref-type="bibr" rid="CR52">52</xref>]. More details about the public repositories to download them are provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>. For each sequencing experiment, we extracted paired-end reads yielding an average coverage of <inline-formula id="IEq331"><alternatives><tex-math id="M665">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$30\times$$\end{document}</tex-math><mml:math id="M666"><mml:mrow><mml:mn>30</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq331.gif"/></alternatives></inline-formula> per strain and a total FASTA file size of 38 GB.</p>
      <p id="Par155"><italic>Validation and results</italic> As a benchmark we used IQ-TREE [<xref ref-type="bibr" rid="CR53">53</xref>] with model selection [<xref ref-type="bibr" rid="CR54">54</xref>] and ultrafast bootstrapping [<xref ref-type="bibr" rid="CR55">55</xref>] (Fig. <xref rid="Fig7" ref-type="fig">7</xref>) and compared its results with those obtained from phyBWT2 and SANS. As shown in Fig. <xref rid="Fig8" ref-type="fig">8</xref>, phyBWT2 captured several features of the phylogeny produced with IQ-TREE.<fig id="Fig7"><label>Fig. 7</label><caption><p>Bootstrapping phylogenetic tree on the 42 yeasts sequences</p></caption><graphic xlink:href="13015_2023_232_Fig7_HTML" id="MO7"/></fig><fig id="Fig8"><label>Fig. 8</label><caption><p>The phylogenetic tree on the 42 yeasts sequences by phyBWT</p></caption><graphic xlink:href="13015_2023_232_Fig8_HTML" id="MO8"/></fig></p>
      <p id="Par156">Overall, the structure of the tree generated by phyBWT2 for sufficiently large <inline-formula id="IEq332"><alternatives><tex-math id="M667">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m$$\end{document}</tex-math><mml:math id="M668"><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq332.gif"/></alternatives></inline-formula> and <inline-formula id="IEq333"><alternatives><tex-math id="M669">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M670"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq333.gif"/></alternatives></inline-formula> (<inline-formula id="IEq334"><alternatives><tex-math id="M671">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m=25$$\end{document}</tex-math><mml:math id="M672"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq334.gif"/></alternatives></inline-formula> and <inline-formula id="IEq335"><alternatives><tex-math id="M673">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau =0.6$$\end{document}</tex-math><mml:math id="M674"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq335.gif"/></alternatives></inline-formula>) is very similar to the structure of the benchmark tree. All the main non-admixed clades [<xref ref-type="bibr" rid="CR51">51</xref>], namely the “Wine/European” strains (AIF, BPK, ALS_1a, ADI, CKB, AFI, CAS_1a) and the Asian ones (BAQ_1a, BAH, BAL_1a, AMH_1a, BAP_1a), are correctly identified by phyBWT2. Remarkably, also the other two main classes of strains, namely the “ale beer” strains (AAC, ATV) and the “African palm wine” clade (BAD, BAF), are correctly clustered close to the Wine/European and the Asian clades respectively.</p>
      <p id="Par157">Finally, all the other strains related to the Wine/European clade are correctly clustered. Moreover, comparing the results of phyBWT2 with the literature [<xref ref-type="bibr" rid="CR52">52</xref>] we observe that only phyBWT2 is able to correctly detect the outgroup strain (AMH_1a).</p>
      <p id="Par158">On the contrary, the tree generated by SANS with default parameters (Fig. <xref rid="Fig9" ref-type="fig">9</xref>) fails to grasp both the general structure of the benchmark tree and the fine structure of the different clades. Remarkably, we observe strains related to the Wine/European group, such as the cider strain AMP_1a, clustered very close to Asian strains and also the other way round, e.g. the Asian strain CDG_1a that is clustered close to Wine/European strains.<fig id="Fig9"><label>Fig. 9</label><caption><p>The phylogenetic tree on the 42 yeasts sequences by SANS with default parameters</p></caption><graphic xlink:href="13015_2023_232_Fig9_HTML" id="MO9"/></fig></p>
      <p id="Par159">We also ran SANS using a smaller value for the <italic>k</italic>-mer length (option -k 25). As reported in Fig. <xref rid="Fig10" ref-type="fig">10</xref> the general structure of the tree improved with respect to the default parameter, since the clustering of the non-admixed strains (both the Wine/European and the Asian) is correctly determined. Also the fine structure improved with the African palm wine strains (BAD and BAF) correctly clustered with the Asian clade. On the other hand, the ale beer strains (AAC and ATV) are still incorrectly placed. The same holds for the outgroup (AMH_1a) that is not identified.<fig id="Fig10"><label>Fig. 10</label><caption><p>The phylogenetic tree on the 42 yeasts sequences by SANS with option -k=25</p></caption><graphic xlink:href="13015_2023_232_Fig10_HTML" id="MO10"/></fig></p>
      <p id="Par160"><italic>Time and memory</italic> Given the necessary data structures for this dataset, phyBWT2 reconstructs the proposed phylogeny in approximately 1 h and half with a memory peak of 1.8 GB by using <inline-formula id="IEq336"><alternatives><tex-math id="M675">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m=25$$\end{document}</tex-math><mml:math id="M676"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq336.gif"/></alternatives></inline-formula> and <inline-formula id="IEq337"><alternatives><tex-math id="M677">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau =0.6$$\end{document}</tex-math><mml:math id="M678"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq337.gif"/></alternatives></inline-formula>. phyBWT2 largely improves upon phyBWT not only but showing a better phylogeny reconstruction (by using similar parameter settings), but also in its performance. The former version runs in 5 h by using a large amount of memory (more than 175 GB) and performs 33 iterations against the only 5 carried out by phyBWT2. On the same dataset, SANS needs 13.5 GB of internal memory and more than 32 h to reconstruct the phylogenetic tree for <inline-formula id="IEq338"><alternatives><tex-math id="M679">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=32$$\end{document}</tex-math><mml:math id="M680"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>32</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq338.gif"/></alternatives></inline-formula>, and even more time (around more than 45 h) for <inline-formula id="IEq339"><alternatives><tex-math id="M681">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=25$$\end{document}</tex-math><mml:math id="M682"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq339.gif"/></alternatives></inline-formula>. Although a direct time and memory comparison between phyBWT2 and SANS is not fair, since phyBWT2 requires data structures whose computation does not depends on the choice of <italic>k</italic>, in this case even including the computation of the data structures phyBWT2 is more efficient than SANS: for this dataset, we can compute the eBWT and CDA array using the semi-external memory approach proposed by BCR [<xref ref-type="bibr" rid="CR15">15</xref>] taking about 7 h and 4.3 GB of internal memory, and deduce the LCP array from the eBWT using the tool bwt2lcp [<xref ref-type="bibr" rid="CR46">46</xref>] taking around 1 h and 20 min and 45 GB of memory (see Table <xref rid="Tab2" ref-type="table">2</xref>).</p>
    </sec>
    <sec id="Sec13">
      <title>Experiments on HIV</title>
      <p id="Par161">Clade classification is an important task also in the field of virology, as each clade (also termed subtype) corresponds to a cluster of genetic similarity. Thus, we studied the phylogeny of the Human immunodeficiency virus (HIV).</p>
      <p id="Par162">There are two main types of HIV, and among them, HIV-1 is the most virulent and predominant. This dataset is obtained by selecting 43 HIV-1 complete genomes used in the literature [<xref ref-type="bibr" rid="CR37">37</xref>]. In particular, it comprises thirty-five sequences from the major group (Group M) divide into subtypes A, B, C, D, F, G, H, J, K, seven sequences from the minor Groups N and O, and one CPZ sequence as an outgroup. Accession number, subtype, length (bp), and area of the HIV-1 sequences are reported in Table S1. These reference sequences have been carefully selected in [<xref ref-type="bibr" rid="CR56">56</xref>] according to several criteria, and can be downloaded from the Los Alamos National Laboratory HIV Sequence Database.<xref ref-type="fn" rid="Fn7">7</xref></p>
      <p id="Par164"><italic>Validation and results</italic> For this experiment, we use as benchmark the phylogeny depicted in [<xref ref-type="bibr" rid="CR37">37</xref>, Fig. 2], which is the Neighbor-Joining phylogenetic tree on the 43 reference sequences where the CPZ sequence (CIV strain AF447763) is used as an outgroup. We run phyBWT2 and SANS on this dataset by using different parameter settings. We compared the reconstructed phylogenetic trees by using the functions ClusteringInfoDistance() and SharedPhylogeneticInfo() provided in the R package TreeDist [<xref ref-type="bibr" rid="CR57">57</xref>], which implements a suite of metrics to quantify the topological distance between pairs of unweighted phylogenetic trees.</p>
      <p id="Par165">Figures <xref rid="Fig11" ref-type="fig">11</xref> and <xref rid="Fig12" ref-type="fig">12</xref> depict the trees that obtained the best scores according to the above measures based on the amount of phylogenetic or clustering information that two trees hold in 
common. More in details, we set <inline-formula id="IEq340"><alternatives><tex-math id="M683">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m=16$$\end{document}</tex-math><mml:math id="M684"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq340.gif"/></alternatives></inline-formula> and <inline-formula id="IEq341"><alternatives><tex-math id="M685">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau =0.6$$\end{document}</tex-math><mml:math id="M686"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq341.gif"/></alternatives></inline-formula> in phyBWT2 and <inline-formula id="IEq342"><alternatives><tex-math id="M687">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=16$$\end{document}</tex-math><mml:math id="M688"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq342.gif"/></alternatives></inline-formula> in SANS. For both tools, subtypes are distinctly grouped together in different branches. The phylogeny produced by phyBWT2 is consistent with the one in [<xref ref-type="bibr" rid="CR37">37</xref>]. The relationships among the subtypes are well demonstrated, for instance subtypes B and D (resp. C and H) are closer to each other than to the others, and subtype F (resp. A) contains two distinguishable sub-subtypes F1 and F2 (resp. A1 and A2) that are close related to subtypes K and J (resp. G).<fig id="Fig11"><label>Fig. 11</label><caption><p>The phylogenetic tree on the 42 HiV-1 sequences by phyBWT2. Re-root the tree in CIV strain AF447763, as it is set outgroup in the reference tree in [<xref ref-type="bibr" rid="CR37">37</xref>]</p></caption><graphic xlink:href="13015_2023_232_Fig11_HTML" id="MO11"/></fig></p>
      <p id="Par166"><italic>Time and memory</italic> Given the necessary data structures for this dataset, both phyBWT and phyBWT2 reconstruct the proposed phylogeny very quickly (less than 1 second). However, phyBWT2 improves on phyBWT by showing a phylogeny reconstruction closer to the benchmark philogeny (by using similar parameter settings), and by reducing the number of iterations from 8 to 3.<fig id="Fig12"><label>Fig. 12</label><caption><p>The phylogenetic tree on the 42 HIV-1 sequences by SANS. Re-root the tree in CIV strain AF447763, as it is set outgroup in the reference tree in [<xref ref-type="bibr" rid="CR37">37</xref>]</p></caption><graphic xlink:href="13015_2023_232_Fig12_HTML" id="MO12"/></fig></p>
    </sec>
    <sec id="Sec14">
      <title>Experiments on Ebolavirus</title>
      <p id="Par167">For this experiment, we used the 20 published sequences from [<xref ref-type="bibr" rid="CR38">38</xref>] selected in [<xref ref-type="bibr" rid="CR39">39</xref>].</p>
      <p id="Par168">The Ebolavirus genus includes five viral species: Ebola virus (<italic>Zaire ebolavirus</italic>, EBOV), <italic>Sudan virus</italic> (SUDV), <italic>Tai Forest virus</italic> (TAFV), <italic>Bundibugyo virus</italic> (BDBV), and <italic>Reston virus</italic> (RESTV). Ebola viruses are single-stranded RNA whose genomes consist of about 19 kilobases. Details for each sequence in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
      <p id="Par169"><italic>Validation and results</italic> For this experiment, we use as benchmark the phylogeny trees depicted in [<xref ref-type="bibr" rid="CR39">39</xref>, Fig. <xref rid="Fig4" ref-type="fig">4</xref>].</p>
      <p id="Par170">Figures <xref rid="Fig13" ref-type="fig">13</xref> and <xref rid="Fig14" ref-type="fig">14</xref> depict the trees that obtained the best scores according to the measures based on the shared amount of phylogenetic or clustering information provided in the R package TreeDist [<xref ref-type="bibr" rid="CR57">57</xref>] and described for the HIV-1 dataset. More in details, we set 
<inline-formula id="IEq343"><alternatives><tex-math id="M689">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m=16$$\end{document}</tex-math><mml:math id="M690"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq343.gif"/></alternatives></inline-formula> and <inline-formula id="IEq344"><alternatives><tex-math id="M691">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau =0.6$$\end{document}</tex-math><mml:math id="M692"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq344.gif"/></alternatives></inline-formula> in phyBWT2 and <inline-formula id="IEq345"><alternatives><tex-math id="M693">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=21$$\end{document}</tex-math><mml:math id="M694"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>21</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq345.gif"/></alternatives></inline-formula> in SANS.<fig id="Fig13"><label>Fig. 13</label><caption><p>The phylogenetic tree on Ebolavirus dataset by phyBWT2</p></caption><graphic xlink:href="13015_2023_232_Fig13_HTML" id="MO13"/></fig><fig id="Fig14"><label>Fig. 14</label><caption><p>The phylogenetic tree on Ebolavirus dataset by SANS</p></caption><graphic xlink:href="13015_2023_232_Fig14_HTML" id="MO14"/></fig></p>
      <p id="Par171">Both phyBWT2 and SANS exactly separated the five species. According to the four trees in [<xref ref-type="bibr" rid="CR39">39</xref>, Fig. <xref rid="Fig4" ref-type="fig">4</xref>], the EBOV sequences are clustered into a monophyletic clade, and BDBV and TAFV viruses are positioned close and then clustered with the EBOV branch. These trees also show the phylogenetic uncertainty in the placement of the SUDV clade (red).</p>
      <p id="Par172">Our method (Fig. <xref rid="Fig13" ref-type="fig">13</xref>) places the SUDV clade as sister to the EBOV, TAFV and BDBV clade, in according with [<xref ref-type="bibr" rid="CR39">39</xref>, Fig. 4E], whereas SANS (Fig. <xref rid="Fig14" ref-type="fig">14</xref>) places it as sister to RESTV clade in according with [<xref ref-type="bibr" rid="CR39">39</xref>, Fig. 4A]. Differently from the study in [<xref ref-type="bibr" rid="CR39">39</xref>, Fig. 4], the phylogeny reconstructed by SANS keeps the EBOV branch and the TAFV-BDBV clade separated (Fig. <xref rid="Fig14" ref-type="fig">14</xref>).</p>
      <p id="Par173"><italic>Time and memory</italic> Also in this second dataset of viral genomes, both phyBWT and phyBWT2 reconstruct the proposed phylogeny very quickly (less than 1 second). The phylogeny reconstructed by phyBWT is similar to the one produced by phyBWT2, but the number of iterations performed by phyBWT2 is much smaller (from 13 to 2).</p>
    </sec>
    <sec id="Sec15">
      <title>Experiments on <italic>E. coli</italic>—Shigella</title>
      <p id="Par174">For this experiment, we used a real-world dataset collected in the study [<xref ref-type="bibr" rid="CR41">41</xref>] to assess the accuracy of the alignment-free methods in phylogenetic reconstruction of sequences that underwent horizontal gene trasfer events and genome rearrangements. It comprises 27 genomes of <italic>E. coli</italic> and <italic>Shigella</italic> whose reference supertree [<xref ref-type="bibr" rid="CR40">40</xref>] was generated based on thousands of single-copy protein trees. Details for each sequence in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
      <p id="Par175"><italic>Validation and results</italic> As benchmark we use the phylogeny tree depicted in [<xref ref-type="bibr" rid="CR41">41</xref>, Additional file 2: Figure S8] where <italic>E. coli</italic> reference groups and <italic>Shigella</italic> (S) are indicated. Indeed, the 27 taxa are attributed to six distinct groups (the <italic>E. coli</italic> reference, or ECOR, strains) [<xref ref-type="bibr" rid="CR40">40</xref>].</p>
      <p id="Par176">Figures <xref rid="Fig15" ref-type="fig">15</xref>a and b depict the trees we selected among them obtaining the higher scores according to the clustering information measure described above and computed by using the R package TreeDist [<xref ref-type="bibr" rid="CR57">57</xref>]. More in details, we choose <inline-formula id="IEq346"><alternatives><tex-math id="M695">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=16$$\end{document}</tex-math><mml:math id="M696"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq346.gif"/></alternatives></inline-formula> for SANS, and <inline-formula id="IEq347"><alternatives><tex-math id="M697">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m=16$$\end{document}</tex-math><mml:math id="M698"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq347.gif"/></alternatives></inline-formula> and <inline-formula id="IEq348"><alternatives><tex-math id="M699">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau =0.5$$\end{document}</tex-math><mml:math id="M700"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq348.gif"/></alternatives></inline-formula> for phyBWT2 (parameter setting similar to other datasets).<fig id="Fig15"><label>Fig. 15</label><caption><p>The phylogenetic tree on the 27 <italic>E. coli—Shigella</italic> genomes by phyBWT (<bold>a</bold>) and by SANS (<bold>b</bold>)</p></caption><graphic xlink:href="13015_2023_232_Fig15_HTML" id="MO17"/></fig></p>
      <p id="Par177">We observe that phyBWT2 clusters in clades each ECOR group (i.e. groups A, B1, B2, D, E and S), apart from <italic>S. dysenteriae</italic> that is placed externally to Group S, more precisely as sister to Group E.</p>
      <p id="Par178">However, we note that also in the reference tree <italic>S. dysenteriae</italic> is placed externally, as sister to the pathogenic <italic>E. coli O157:H7</italic> isolates (Group E). Also the tree reconstructed by SANS shows such a relationship between <italic>S. dysenteriae</italic> and Group E.</p>
      <p id="Par179">Differently from the reference tree, both phyBWT2 and SANS placed groups A and B1 as sister groups.</p>
      <p id="Par180"><italic>Time and memory</italic> The time usage of phyBWT 2 and SANS for this dataset is comparable (including the time for the preprocessing step completed by the internal memory approach gsufsort [<xref ref-type="bibr" rid="CR45">45</xref>]), which is also comparable to the time spent by the older version phyBWT. By keeping the data structures on disk, phyBWT2 improves the memory usage of phyBWT. Finally, also for this datasets the number of iterations performed by phyBWT2 improves on those performed by the previous version.</p>
    </sec>
  </sec>
  <sec id="Sec16">
    <title>Conclusions and further work</title>
    <p id="Par181">In this paper, we proposed phyBWT2 an alignment-, assembly- and reference-free method to build the phylogeny inference of a set of taxa. The phyBWT2 method is a new version of phyBWT  [<xref ref-type="bibr" rid="CR11">11</xref>] that includes improvements on the phylogenetic reconstruction strategy, as well as on the performance in both running time and memory usage. In fact, phyBWT2 is shown to reduce the number of iterations performed, and by keeping the data structures on disk it extremely reduces the main memory usage. To this extent, the implementation of phyBWT2 reads portions of <inline-formula id="IEq349"><alternatives><tex-math id="M701">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M702"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq349.gif"/></alternatives></inline-formula>, as well as of <inline-formula id="IEq350"><alternatives><tex-math id="M703">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M704"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq350.gif"/></alternatives></inline-formula> and <inline-formula id="IEq351"><alternatives><tex-math id="M705">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {cda} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M706"><mml:mrow><mml:mi mathvariant="sans-serif">cda</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq351.gif"/></alternatives></inline-formula>, and without the need of loading them in main memory, it performs the cluster detection by reducing on-the-fly the input data structures to any <inline-formula id="IEq352"><alternatives><tex-math id="M707">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {R}\subset \mathcal {S}$$\end{document}</tex-math><mml:math id="M708"><mml:mrow><mml:mi mathvariant="script">R</mml:mi><mml:mo>⊂</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq352.gif"/></alternatives></inline-formula> (i.e. by deducing <inline-formula id="IEq353"><alternatives><tex-math id="M709">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} (\mathcal {R})$$\end{document}</tex-math><mml:math id="M710"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq353.gif"/></alternatives></inline-formula>, <inline-formula id="IEq354"><alternatives><tex-math id="M711">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} (\mathcal {R})$$\end{document}</tex-math><mml:math id="M712"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq354.gif"/></alternatives></inline-formula> and <inline-formula id="IEq355"><alternatives><tex-math id="M713">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {cda} (\mathcal {R})$$\end{document}</tex-math><mml:math id="M714"><mml:mrow><mml:mi mathvariant="sans-serif">cda</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq355.gif"/></alternatives></inline-formula>) from <inline-formula id="IEq356"><alternatives><tex-math id="M715">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M716"><mml:mrow><mml:mi mathvariant="sans-serif">lcp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq356.gif"/></alternatives></inline-formula>, <inline-formula id="IEq357"><alternatives><tex-math id="M717">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M718"><mml:mrow><mml:mi mathvariant="sans-serif">ebwt</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq357.gif"/></alternatives></inline-formula> and <inline-formula id="IEq358"><alternatives><tex-math id="M719">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {cda} (\mathcal {S})$$\end{document}</tex-math><mml:math id="M720"><mml:mrow><mml:mi mathvariant="sans-serif">cda</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq358.gif"/></alternatives></inline-formula>.</p>
    <p id="Par182">To the best of our knowledge, phyBWT and phyBWT2 are the first methods that apply the properties of the Extended Burrows-Wheeler Transform (eBWT) to the idea of phylogenetic reconstruction. Both approaches are based on the eBWT positional cluster framework introduced in [<xref ref-type="bibr" rid="CR19">19</xref>], which allowed us to consider longest shared substrings of varying length, unlike <italic>k</italic>-mer-based approaches such as SANS.</p>
    <p id="Par183">Differently from phyBWT, phyBWT2 combines the inner algorithm based on the eBWT positional clustering to a refinement procedure that reconstructs a phylogeny step-by-step by considering multiple partitions at each step, instead of just one partition as done by phyBWT.</p>
    <p id="Par184">We tested our method on several sequencing datasets, with short reads and de novo assembled sequences. The experimental results show that our algorithm produces trees comparable to the benchmark phylogeny and to the recently introduced tool SANS.</p>
    <p id="Par185">Our current implementation requires a preprocessing phase in order to compute the input data structures (<inline-formula id="IEq359"><alternatives><tex-math id="M721">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {ebwt}$$\end{document}</tex-math><mml:math id="M722"><mml:mi mathvariant="sans-serif">ebwt</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq359.gif"/></alternatives></inline-formula>, <inline-formula id="IEq360"><alternatives><tex-math id="M723">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {lcp}$$\end{document}</tex-math><mml:math id="M724"><mml:mi mathvariant="sans-serif">lcp</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq360.gif"/></alternatives></inline-formula> and <inline-formula id="IEq361"><alternatives><tex-math id="M725">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {cda}$$\end{document}</tex-math><mml:math id="M726"><mml:mi mathvariant="sans-serif">cda</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq361.gif"/></alternatives></inline-formula>), which are at the heart of several other text and string algorithms. Thus, evaluating the best tool or the combination of tools for the pre-processing phase is out of the scope of this work. More efficient tools for computing them can appear in the literature improving both the time and the memory requirements.</p>
    <p id="Par186">Moreover, the input data structures we used are independent of the parameter settings, so they can be computed only once and re-used for different runs of phyBWT2. Indeed, by using different types of data (e.g. genomes rather than short reads) phyBWT2 parameters may need to be fine-tuned, and there is no need of rebuilding from scratch the input data structures when changing phyBWT2 parameters. The same remarkable feature does not hold for <italic>k</italic>-mer-based approach, such as for instance SANS.</p>
    <p id="Par187">Phylogenetic analysis is a common practice in HIV studies [<xref ref-type="bibr" rid="CR56">56</xref>, <xref ref-type="bibr" rid="CR58">58</xref>]. Experimentally we show phyBWT2 is able to distinctly group together the HIV-1 subtypes and to grasp the relationships among the subtypes. Virus subtypes can be clinically significant owing to their associations with variation in pathogenesis.</p>
    <p id="Par188">While the worst-case complexity of the method is competitive with existing methods, there are interesting directions for further optimization, such as using Colored Range Queries [<xref ref-type="bibr" rid="CR59">59</xref>] to speed up identification of colors in the various clusters, or exploiting the bounded length of the reads to overcome the computational bottleneck of computing the eBWT and related data structures. A further improvement could include internally to phyBWT2 the bootstrapping of the reconstructed tree, for instance by ranging the value <inline-formula id="IEq362"><alternatives><tex-math id="M727">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_m$$\end{document}</tex-math><mml:math id="M728"><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_232_Article_IEq362.gif"/></alternatives></inline-formula> to vary eBWT positional clusters.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec27">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13015_2023_232_MOESM1_ESM.xlsx">
            <caption>
              <p><bold>Additional file 1: </bold>Dataset information. Descriptions and information to download the datasets used and analysed in the current study.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>BWT</term>
        <def>
          <p id="Par5">Burrows-Wheeler transform</p>
        </def>
      </def-item>
      <def-item>
        <term>eBWT</term>
        <def>
          <p id="Par6">Extended Burrows-Wheeler transform</p>
        </def>
      </def-item>
      <def-item>
        <term>DA</term>
        <def>
          <p id="Par7">Document array</p>
        </def>
      </def-item>
      <def-item>
        <term>LCP</term>
        <def>
          <p id="Par8">Longest common prefix</p>
        </def>
      </def-item>
      <def-item>
        <term>SA</term>
        <def>
          <p id="Par9">Suffix array</p>
        </def>
      </def-item>
      <def-item>
        <term>CDA</term>
        <def>
          <p id="Par10">Color document array</p>
        </def>
      </def-item>
      <def-item>
        <term>SRA</term>
        <def>
          <p id="Par11">Short reads archive</p>
        </def>
      </def-item>
      <def-item>
        <term>HIV</term>
        <def>
          <p id="Par12">Human immunodeficiency virus</p>
        </def>
      </def-item>
      <def-item>
        <term>iTOL</term>
        <def>
          <p id="Par13">Interactive tree of life</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn id="Fn1">
      <label>1</label>
      <p id="Par28"><ext-link ext-link-type="uri" xlink:href="https://github.com/veronicaguerrini/phyBWT">https://github.com/veronicaguerrini/phyBWT</ext-link>.</p>
    </fn>
    <fn id="Fn2">
      <label>2</label>
      <p id="Par32">Note that, in the implementations, one can use a single symbol as end-marker for all strings, but end-markers from different strings are then sorted on the basis of their index and the relative order of the strings in the collection they belong to.</p>
    </fn>
    <fn id="Fn3">
      <label>3</label>
      <p id="Par119">In practice, we can stop at <italic>X</italic> instead of the root to consider fewer nodes, but the worst-case complexity is the same.</p>
    </fn>
    <fn id="Fn4">
      <label>4</label>
      <p id="Par128"><ext-link ext-link-type="uri" xlink:href="https://gitlab.ub.uni-bielefeld.de/gi/sans">https://gitlab.ub.uni-bielefeld.de/gi/sans</ext-link>, downloaded in January 2023.</p>
    </fn>
    <fn id="Fn5">
      <label>5</label>
      <p id="Par134">Except the trees in Figs. <xref rid="Fig4" ref-type="fig">4</xref>, <xref rid="Fig5" ref-type="fig">5</xref>, and <xref rid="Fig6" ref-type="fig">6</xref> already in the conference paper [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
    </fn>
    <fn id="Fn6">
      <label>6</label>
      <p id="Par149">
        <ext-link ext-link-type="uri" xlink:href="http://flybase.org/">http://flybase.org/</ext-link>
      </p>
    </fn>
    <fn id="Fn7">
      <label>7</label>
      <p id="Par163">
        <ext-link ext-link-type="uri" xlink:href="http://www.hiv.lanl.gov/">http://www.hiv.lanl.gov/</ext-link>
      </p>
    </fn>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Matteo De Chiara for discussions.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>VG, AC, RG and GR designed the method. VG implemented the tool. VG, AC, RG and GR contributed to interpreting the results. LT and GL provided the yeast datasets and contributed to interpreting the related results. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>VG is totally, RG and GR are partially, funded by PNRR—M4C2—Investimento 1.5, Ecosistema dell’Innovazione ECS00000017—“THE—Tuscany Health Ecosystem”—Spoke 6 “Precision medicine &amp; personalized healthcare”, CUP I53C22000780001, funded by the European Commission under the NextGeneration EU programme.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The tool phyBWT2 is freely available for academic use at <ext-link ext-link-type="uri" xlink:href="https://github.com/veronicaguerrini/phyBWT2">https://github.com/veronicaguerrini/phyBWT2</ext-link>. Information to download the datasets used and analysed in the current study is available as Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>The source code is freely available for academic use at: <ext-link ext-link-type="uri" xlink:href="https://github.com/veronicaguerrini/phyBWT2">https://github.com/veronicaguerrini/phyBWT2</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar14">
      <title>Ethics approval and consent to participate</title>
      <p id="Par195">Not applicable.</p>
    </notes>
    <notes id="FPar16">
      <title>Consent for publication</title>
      <p id="Par197">Not applicable</p>
    </notes>
    <notes id="FPar15" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par196">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gallone</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Steensels</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mertens</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dzialo</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Gordon</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Wauters</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Theßeling</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Bellinazzo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Saels</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Herrera-Malaver</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Prahl</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hutzler</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Meußdoerffer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Malcorps</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Souffriau</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Daenen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Baele</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Maere</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Verstrepen</surname>
            <given-names>KJ</given-names>
          </name>
        </person-group>
        <article-title>Interspecific hybridization facilitates niche adaptation in beer yeast</article-title>
        <source>Nat Ecol Evol</source>
        <year>2019</year>
        <volume>3</volume>
        <issue>11</issue>
        <fpage>1562</fpage>
        <lpage>1575</lpage>
        <pub-id pub-id-type="doi">10.1038/s41559-019-0997-9</pub-id>
        <?supplied-pmid 31636425?>
        <pub-id pub-id-type="pmid">31636425</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tattini</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Tellini</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Mozzachiodi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>D’Angiolo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Loeillet</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nicolas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Liti</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Accurate tracking of the mutational landscape of diploid hybrid genomes</article-title>
        <source>Mol Biol Evol</source>
        <year>2019</year>
        <pub-id pub-id-type="doi">10.1093/molbev/msz177</pub-id>
        <?supplied-pmid 31397846?>
        <pub-id pub-id-type="pmid">31397846</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>D’Angiolo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>De Chiara</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yue</surname>
            <given-names>J-X</given-names>
          </name>
          <name>
            <surname>Irizar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stenberg</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Persson</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Llored</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Barré</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Schacherer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Marangoni</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gilson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Warringer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Liti</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>A yeast living ancestor reveals the origin of genomic introgressions</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>587</volume>
        <issue>7834</issue>
        <fpage>420</fpage>
        <lpage>425</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-2889-1</pub-id>
        <?supplied-pmid 33177709?>
        <pub-id pub-id-type="pmid">33177709</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Soucy</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gogarten</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Horizontal gene transfer: building the web of life</article-title>
        <source>Nat Rev Genet</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>8</issue>
        <fpage>472</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3962</pub-id>
        <?supplied-pmid 26184597?>
        <pub-id pub-id-type="pmid">26184597</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Rannala</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Molecular phylogenetics: principles and practice</article-title>
        <source>Nat Rev Genet</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>303</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3186</pub-id>
        <?supplied-pmid 22456349?>
        <pub-id pub-id-type="pmid">22456349</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <source>Computational phylogenetics: an introduction to designing methods for phylogeny estimation</source>
        <year>2017</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Cambridge University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saitou</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Nei</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The neighbor-joining method: a new method for reconstructing phylogenetic trees</article-title>
        <source>Molecular biology and evolution</source>
        <year>1987</year>
        <volume>4</volume>
        <issue>4</issue>
        <fpage>406</fpage>
        <lpage>425</lpage>
        <?supplied-pmid 3447015?>
        <pub-id pub-id-type="pmid">3447015</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vinga</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Almeida</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Alignment-free sequence comparison—a review</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <issue>4</issue>
        <fpage>513</fpage>
        <lpage>523</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btg005</pub-id>
        <?supplied-pmid 12611807?>
        <pub-id pub-id-type="pmid">12611807</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Vinga</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <source>Alignment-free methods in computational biology</source>
        <year>2014</year>
        <publisher-loc>Oxford</publisher-loc>
        <publisher-name>Oxford University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zielezinski</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vinga</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Almeida</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Karlowski</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Alignment-free sequence comparison: benefits, applications, and tools</article-title>
        <source>Genome Biol</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>186</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1319-7</pub-id>
        <?supplied-pmid 28974235?>
        <pub-id pub-id-type="pmid">28974235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Guerrini V, Conte A, Grossi R, Liti G, Rosone G, Tattini L. phyBWT: Alignment-Free Phylogeny via eBWT Positional Clustering. In: Boucher C, Rahmann S, editors. 22nd International Workshop on Algorithms in Bioinformatics (WABI 2022). LIPIcs, vol. 242. Dagstuhl: Schloss Dagstuhl—Leibniz-Zentrum für Informatik; 2022. p. 23–12319. 10.4230/LIPIcs.WABI.2022.23.</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prezza</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pisanti</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Sciortino</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rosone</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>SNPs detection by eBWT positional clustering</article-title>
        <source>Algorithm Mol Biol</source>
        <year>2019</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>3</fpage>
        <pub-id pub-id-type="doi">10.1186/s13015-019-0137-8</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Burrows M, Wheeler DJ. A block sorting data compression algorithm. DIGITAL System Research Center: Technical report; 1994.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mantaci</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Restivo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rosone</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sciortino</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>An extension of the Burrows-Wheeler transform</article-title>
        <source>Theor Comput Sci</source>
        <year>2007</year>
        <volume>387</volume>
        <issue>3</issue>
        <fpage>298</fpage>
        <lpage>312</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tcs.2007.07.014</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bauer</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Cox</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Rosone</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Lightweight algorithms for constructing and inverting the BWT of string collections</article-title>
        <source>Theor Comput Sci</source>
        <year>2013</year>
        <volume>483</volume>
        <fpage>134</fpage>
        <lpage>148</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tcs.2012.02.002</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mantaci</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Restivo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rosone</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sciortino</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A new combinatorial approach to sequence comparison</article-title>
        <source>Theor Comput Syst</source>
        <year>2008</year>
        <volume>42</volume>
        <issue>3</issue>
        <fpage>411</fpage>
        <lpage>429</lpage>
        <pub-id pub-id-type="doi">10.1007/s00224-007-9078-6</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>The Burrows-Wheeler similarity distribution between biological sequences based on Burrows-Wheeler transform</article-title>
        <source>J Theor Biol</source>
        <year>2010</year>
        <volume>262</volume>
        <issue>4</issue>
        <fpage>742</fpage>
        <lpage>749</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jtbi.2009.10.033</pub-id>
        <?supplied-pmid 19903487?>
        <pub-id pub-id-type="pmid">19903487</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guerrini</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Louza</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Rosone</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Metagenomic analysis through the extended Burrows-Wheeler transform</article-title>
        <source>BMC Bioinform</source>
        <year>2020</year>
        <pub-id pub-id-type="doi">10.1186/s12859-020-03628-w</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prezza</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pisanti</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Sciortino</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rosone</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Variable-order reference-free variant discovery with the Burrows-Wheeler transform</article-title>
        <source>BMC Bioinform</source>
        <year>2020</year>
        <pub-id pub-id-type="doi">10.1186/s12859-020-03586-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Guerrini V, Louza F, Rosone G. Lossy compressor preserving variant calling through extended BWT. In: BIOSTEC/BIOINFORMATICS, INSTICC, SciTePress, 2022. p. 38–48. 10.5220/0010834100003123.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bandelt</surname>
            <given-names>H-J</given-names>
          </name>
          <name>
            <surname>Dress</surname>
            <given-names>AWM</given-names>
          </name>
        </person-group>
        <article-title>A canonical decomposition theory for metrics on a finite set</article-title>
        <source>Adv Math</source>
        <year>1992</year>
        <volume>92</volume>
        <issue>1</issue>
        <fpage>47</fpage>
        <lpage>105</lpage>
        <pub-id pub-id-type="doi">10.1016/0001-8708(92)90061-O</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Bandelt H-J, Huber KT, Koolen JH, Moulton V, Spillner A. Basic Phylogenetic Combinatorics. Cambridge: Cambridge University Press, 2012. 10.1017/CBO9781139019767.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bandelt</surname>
            <given-names>H-J</given-names>
          </name>
          <name>
            <surname>Dress</surname>
            <given-names>AWM</given-names>
          </name>
        </person-group>
        <article-title>Split decomposition: a new and useful approach to phylogenetic analysis of distance data</article-title>
        <source>Mol Phylogenet Evol</source>
        <year>1992</year>
        <volume>1</volume>
        <issue>3</issue>
        <fpage>242</fpage>
        <lpage>252</lpage>
        <pub-id pub-id-type="doi">10.1016/1055-7903(92)90021-8</pub-id>
        <?supplied-pmid 1342941?>
        <pub-id pub-id-type="pmid">1342941</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Wittler R. Alignment- and reference-free phylogenomics with colored de bruijn graphs. In: 19th International Workshop on Algorithms in Bioinformatics (WABI 2019), vol. 143, Dagstuhl: Schloss Dagstuhl–Leibniz-Zentrum fuer Informatik; 2019. p. 2–1214. 10.4230/LIPIcs.WABI.2019.2.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rempel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wittler</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>SANS serif: alignment-free, whole-genome-based phylogenetic reconstruction</article-title>
        <source>Bioinformatics</source>
        <year>2021</year>
        <volume>37</volume>
        <issue>24</issue>
        <fpage>4868</fpage>
        <lpage>4870</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btab444</pub-id>
        <?supplied-pmid 34132752?>
        <pub-id pub-id-type="pmid">34132752</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huson</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Bryant</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Application of phylogenetic networks in evolutionary studies</article-title>
        <source>Mol Biol Evol</source>
        <year>2005</year>
        <volume>23</volume>
        <issue>2</issue>
        <fpage>254</fpage>
        <lpage>267</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msj030</pub-id>
        <?supplied-pmid 16221896?>
        <pub-id pub-id-type="pmid">16221896</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Jansson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sung</surname>
            <given-names>W-K</given-names>
          </name>
        </person-group>
        <source>Algorithms for combining rooted triplets into a galled phylogenetic network</source>
        <year>2016</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <fpage>48</fpage>
        <lpage>52</lpage>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Jansson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sung</surname>
            <given-names>W-K</given-names>
          </name>
        </person-group>
        <source>Maximum agreement supertree</source>
        <year>2016</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <fpage>1224</fpage>
        <lpage>1227</lpage>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Manber U, Myers G. Suffix arrays: a new method for on-line string searches. In: ACM-SIAM SODA, 1990:319–27.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abouelhoda</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Kurtz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ohlebusch</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Replacing suffix trees with enhanced suffix arrays</article-title>
        <source>J Dis Algorithm</source>
        <year>2004</year>
        <volume>2</volume>
        <issue>1</issue>
        <fpage>53</fpage>
        <lpage>86</lpage>
        <pub-id pub-id-type="doi">10.1016/S1570-8667(03)00065-0</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Navarro</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Indexing highly repetitive string collections, part II: compressed indexes</article-title>
        <source>ACM Comput Surv</source>
        <year>2022</year>
        <volume>54</volume>
        <issue>2</issue>
        <fpage>26</fpage>
        <lpage>12632</lpage>
        <pub-id pub-id-type="doi">10.1145/3432999</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Letunic</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Interactive tree of life (iTOL) v5: an online tool for phylogenetic tree display and annotation</article-title>
        <source>Nucleic Acids Res</source>
        <year>2021</year>
        <volume>49</volume>
        <issue>W1</issue>
        <fpage>293</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkab301</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yue</surname>
            <given-names>J-X</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Aigrain</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hallin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Persson</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Oliver</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bergström</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Coupland</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Warringer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lagomarsino</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Fischer</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Liti</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Contrasting evolutionary genome dynamics between domesticated and wild yeasts</article-title>
        <source>Nat Genet</source>
        <year>2017</year>
        <volume>49</volume>
        <issue>6</issue>
        <fpage>913</fpage>
        <lpage>924</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.3847</pub-id>
        <?supplied-pmid 28416820?>
        <pub-id pub-id-type="pmid">28416820</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crosby</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Goodman</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Strelets</surname>
            <given-names>VB</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gelbart</surname>
            <given-names>WM</given-names>
          </name>
          <name>
            <surname>Consortium</surname>
            <given-names>TF</given-names>
          </name>
        </person-group>
        <article-title>FlyBase: genomes by the dozen</article-title>
        <source>Nucleic Acids Res</source>
        <year>2006</year>
        <volume>35</volume>
        <issue>suppl.1</issue>
        <fpage>486</fpage>
        <lpage>491</lpage>
        <pub-id pub-id-type="pmid">17169988</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Istace</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Friedrich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>d’Agata</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Faye</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Payen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Beluche</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Caradec</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Davidas</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cruaud</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Liti</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lemainque</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Engelen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wincker</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Schacherer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Aury</surname>
            <given-names>J-M</given-names>
          </name>
        </person-group>
        <article-title>De novo assembly and population genomic survey of natural yeast isolates with the Oxford Nanopore MinION sequencer</article-title>
        <source>GigaScience</source>
        <year>2017</year>
        <pub-id pub-id-type="doi">10.1093/gigascience/giw018</pub-id>
        <?supplied-pmid 28369459?>
        <pub-id pub-id-type="pmid">28369459</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yue</surname>
            <given-names>J-X</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Aigrain</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hallin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Persson</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Oliver</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bergström</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Coupland</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Warringer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lagomarsino</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Fischer</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Liti</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Contrasting evolutionary genome dynamics between domesticated and wild yeasts</article-title>
        <source>Nat Genet</source>
        <year>2017</year>
        <volume>49</volume>
        <issue>6</issue>
        <fpage>913</fpage>
        <lpage>924</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.3847</pub-id>
        <?supplied-pmid 28416820?>
        <pub-id pub-id-type="pmid">28416820</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>X-F</given-names>
          </name>
          <name>
            <surname>Hoang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Goebel</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Nucleotide composition string selection in HIV-1 subtyping using whole genomes</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <issue>14</issue>
        <fpage>1744</fpage>
        <lpage>1752</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm248</pub-id>
        <?supplied-pmid 17495995?>
        <pub-id pub-id-type="pmid">17495995</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gire</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Goba</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Andersen</surname>
            <given-names>KG</given-names>
          </name>
          <name>
            <surname>Sealfon</surname>
            <given-names>RSG</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Kanneh</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Jalloh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Momoh</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fullah</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dudas</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Wohl</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Moses</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Yozwiak</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Winnicki</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Matranga</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Malboeuf</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Qu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gladden</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Schaffner</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>P-P</given-names>
          </name>
          <name>
            <surname>Nekoui</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Colubri</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Coomber</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Fonnie</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Moigboi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gbakie</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kamara</surname>
            <given-names>FK</given-names>
          </name>
          <name>
            <surname>Tucker</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Konuwa</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Saffa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sellu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jalloh</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Kovoma</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Koninga</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mustapha</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Kargbo</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Foday</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yillah</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kanneh</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Robert</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Massally</surname>
            <given-names>JLB</given-names>
          </name>
          <name>
            <surname>Chapman</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Bochicchio</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Nusbaum</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Birren</surname>
            <given-names>BW</given-names>
          </name>
          <name>
            <surname>Grant</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Scheiffelin</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Happi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gevao</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Gnirke</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rambaut</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Garry</surname>
            <given-names>RF</given-names>
          </name>
          <name>
            <surname>Khan</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Sabeti</surname>
            <given-names>PC</given-names>
          </name>
        </person-group>
        <article-title>Genomic surveillance elucidates Ebola virus origin and transmission during the 2014 outbreak</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>345</volume>
        <issue>6202</issue>
        <fpage>1369</fpage>
        <lpage>1372</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1259657</pub-id>
        <?supplied-pmid 25214632?>
        <pub-id pub-id-type="pmid">25214632</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kendall</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Colijn</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Mapping phylogenetic trees to reveal distinct patterns of evolution</article-title>
        <source>Mol Biol Evol</source>
        <year>2016</year>
        <volume>33</volume>
        <issue>10</issue>
        <fpage>2735</fpage>
        <lpage>2743</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msw124</pub-id>
        <?supplied-pmid 27343287?>
        <pub-id pub-id-type="pmid">27343287</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Skippington</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Ragan</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>Within-species lateral genetic transfer and the evolution of transcriptional regulation in <italic>Escherichia coli</italic> and shigella</article-title>
        <source>BMC Genomics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>532</fpage>
        <lpage>532</lpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-12-532</pub-id>
        <?supplied-pmid 22035052?>
        <pub-id pub-id-type="pmid">22035052</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zielezinski</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Girgis</surname>
            <given-names>HZ</given-names>
          </name>
          <name>
            <surname>Bernard</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Leimeister</surname>
            <given-names>C-A</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dencker</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Lau</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Röhling</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Choi</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Waterman</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Comin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>S-H</given-names>
          </name>
          <name>
            <surname>Vinga</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Almeida</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>CX</given-names>
          </name>
          <name>
            <surname>James</surname>
            <given-names>BT</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Morgenstern</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Karlowski</surname>
            <given-names>WM</given-names>
          </name>
        </person-group>
        <article-title>Benchmarking of alignment-free sequence comparison methods</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>144</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1755-7</pub-id>
        <?supplied-pmid 31345254?>
        <pub-id pub-id-type="pmid">31345254</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cox</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Garofalo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Rosone</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sciortino</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Lightweight LCP construction for very large collections of strings</article-title>
        <source>J Dis Algorithm</source>
        <year>2016</year>
        <volume>37</volume>
        <fpage>17</fpage>
        <lpage>33</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jda.2016.03.003</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Egidi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Louza</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Manzini</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Telles</surname>
            <given-names>GP</given-names>
          </name>
        </person-group>
        <article-title>External memory BWT and LCP computation for sequence collections with applications</article-title>
        <source>Algorithm Mol Biol</source>
        <year>2019</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>6</fpage>
        <lpage>1615</lpage>
        <pub-id pub-id-type="doi">10.1186/s13015-019-0140-0</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bonizzoni</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Della Vedova</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Pirola</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Previtali</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rizzi</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Multithread multistring Burrows-Wheeler transform and longest common prefix array</article-title>
        <source>J Comput Biol</source>
        <year>2019</year>
        <volume>26</volume>
        <issue>9</issue>
        <fpage>948</fpage>
        <lpage>961</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2018.0230</pub-id>
        <?supplied-pmid 31140836?>
        <pub-id pub-id-type="pmid">31140836</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Louza</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Telles</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Gog</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Prezza</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Rosone</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>gsufsort: constructing suffix arrays, LCP arrays and BWTS for string collections</article-title>
        <source>Algorithm Mol Biol</source>
        <year>2020</year>
        <pub-id pub-id-type="doi">10.1186/s13015-020-00177-y</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prezza</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Rosone</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Space-efficient construction of compressed suffix trees</article-title>
        <source>Theor Comput Sci</source>
        <year>2021</year>
        <volume>852</volume>
        <fpage>138</fpage>
        <lpage>156</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tcs.2020.11.024</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Boucher</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cenzato</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lipták</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Rossi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sciortino</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Lecroq</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Touzet</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Computing the original EBWT faster, simpler, and with less memory</article-title>
        <source>SPIRE</source>
        <year>2021</year>
        <publisher-loc>Berlin</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <fpage>129</fpage>
        <lpage>142</lpage>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <mixed-citation publication-type="other">Díaz-Domínguez D, Navarro G. Efficient construction of the BWT for repetitive text using string compression. In: CPM 2022. LIPIcs, vol. 223, 2022. p. 29–12918.</mixed-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boucher</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gagie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kuhnle</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Manzini</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Mun</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Prefix-free parsing for building big BWTS</article-title>
        <source>Algorithm Mol Biol</source>
        <year>2019</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>13</fpage>
        <lpage>11315</lpage>
        <pub-id pub-id-type="doi">10.1186/s13015-019-0148-5</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bolger</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Lohse</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Usadel</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Trimmomatic: a flexible trimmer for illumina sequence data</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>15</issue>
        <fpage>2114</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu170</pub-id>
        <?supplied-pmid 24695404?>
        <pub-id pub-id-type="pmid">24695404</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peter</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>De Chiara</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Friedrich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yue</surname>
            <given-names>J-X</given-names>
          </name>
          <name>
            <surname>Pflieger</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bergström</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sigwalt</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Barre</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Freel</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Llored</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cruaud</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Labadie</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Aury</surname>
            <given-names>J-M</given-names>
          </name>
          <name>
            <surname>Istace</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lebrigand</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Barbry</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Engelen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lemainque</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wincker</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Schacherer</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Genome evolution across 1011 <italic>Saccharomyces cerevisiae</italic> isolates</article-title>
        <source>Nature</source>
        <year>2018</year>
        <pub-id pub-id-type="doi">10.1038/s41586-018-0030-5</pub-id>
        <?supplied-pmid 30397346?>
        <pub-id pub-id-type="pmid">30397346</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Donnell</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yue</surname>
            <given-names>J-X</given-names>
          </name>
          <name>
            <surname>Abou Saada</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Agier</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Caradec</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cokelaer</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>De Chiara</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Delmas</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dutreux</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Fournier</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Friedrich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kornobis</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Miao</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Tattini</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Schacherer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Liti</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Fisher</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>142 telomere-to-telomere assemblies reveal the genome structural landscape in <italic>Saccharomyces cerevisiae</italic></article-title>
        <source>bioRxiv</source>
        <year>2022</year>
        <pub-id pub-id-type="doi">10.1101/2022.10.04.510633</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Minh</surname>
            <given-names>BQ</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Chernomor</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Schrempf</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Woodhams</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>von Haeseler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lanfear</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>IQ-TREE 2: New models and efficient methods for phylogenetic inference in the genomic era</article-title>
        <source>Mol Biol Evol</source>
        <year>2020</year>
        <volume>37</volume>
        <issue>5</issue>
        <fpage>1530</fpage>
        <lpage>1534</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msaa015</pub-id>
        <?supplied-pmid 32011700?>
        <pub-id pub-id-type="pmid">32011700</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoang</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Chernomor</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>von Haeseler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Minh</surname>
            <given-names>BQ</given-names>
          </name>
          <name>
            <surname>Vinh</surname>
            <given-names>LS</given-names>
          </name>
        </person-group>
        <article-title>UFBoot 2: Improving the ultrafast bootstrap approximation</article-title>
        <source>Mol Biol Evol</source>
        <year>2018</year>
        <volume>35</volume>
        <issue>2</issue>
        <fpage>518</fpage>
        <lpage>522</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msx281</pub-id>
        <?supplied-pmid 29077904?>
        <pub-id pub-id-type="pmid">29077904</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kalyaanamoorthy</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Minh</surname>
            <given-names>BQ</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>TKF</given-names>
          </name>
          <name>
            <surname>von Haeseler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jermiin</surname>
            <given-names>LS</given-names>
          </name>
        </person-group>
        <article-title>Modelfinder: fast model selection for accurate phylogenetic estimates</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>6</issue>
        <fpage>587</fpage>
        <lpage>589</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4285</pub-id>
        <?supplied-pmid 28481363?>
        <pub-id pub-id-type="pmid">28481363</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <mixed-citation publication-type="other">Leitner T, Korber B, Daniels M, Calef C, Foley B. HIV-1 Subtype and circulating recombinant form (CRF) reference sequences. Theoretical Biology and Biophysics Group, Los Alamos National Laboratory 2005. <ext-link ext-link-type="uri" xlink:href="https://www.hiv.lanl.gov/content/sequence/HIV/REVIEWS/LEITNER2005/leitner.html">https://www.hiv.lanl.gov/content/sequence/HIV/REVIEWS/LEITNER2005/leitner.html</ext-link>. Accessed 30 Mar 2023.</mixed-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>MR</given-names>
          </name>
        </person-group>
        <article-title>Information theoretic generalized Robinson-Foulds metrics for comparing phylogenetic trees</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>20</issue>
        <fpage>5007</fpage>
        <lpage>5013</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa614</pub-id>
        <?supplied-pmid 32619004?>
        <pub-id pub-id-type="pmid">32619004</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Castro-Nallar</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Pérez-Losada</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Burton</surname>
            <given-names>GF</given-names>
          </name>
          <name>
            <surname>Crandall</surname>
            <given-names>KA</given-names>
          </name>
        </person-group>
        <article-title>The evolution of HIV: inferences using phylogenetics</article-title>
        <source>Mol Phylogenet Evol</source>
        <year>2012</year>
        <volume>62</volume>
        <issue>2</issue>
        <fpage>777</fpage>
        <lpage>792</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ympev.2011.11.019</pub-id>
        <?supplied-pmid 22138161?>
        <pub-id pub-id-type="pmid">22138161</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gagie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kärkkäinen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Navarro</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Puglisi</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>Colored range queries and document retrieval</article-title>
        <source>Theor Comput Sci</source>
        <year>2013</year>
        <volume>483</volume>
        <fpage>36</fpage>
        <lpage>50</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tcs.2012.08.004</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
