<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">11008887</article-id>
    <article-id pub-id-type="pmid">38557416</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011988</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-23-01927</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methods</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Computational Techniques</subject>
          <subj-group>
            <subject>Split-Decomposition Method</subject>
            <subj-group>
              <subject>Multiple Alignment Calculation</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Alignment</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>RNA</subject>
              <subj-group>
                <subject>Non-coding RNA</subject>
                <subj-group>
                  <subject>Ribosomal RNA</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Ribosomes</subject>
            <subj-group>
              <subject>Ribosomal RNA</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Cell biology</subject>
          <subj-group>
            <subject>Cellular structures and organelles</subject>
            <subj-group>
              <subject>Ribosomes</subject>
              <subj-group>
                <subject>Ribosomal RNA</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Bioenergetics</subject>
            <subj-group>
              <subject>Energy-Producing Organelles</subject>
              <subj-group>
                <subject>Mitochondria</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Structures and Organelles</subject>
            <subj-group>
              <subject>Energy-Producing Organelles</subject>
              <subj-group>
                <subject>Mitochondria</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Viruses</subject>
            <subj-group>
              <subject>RNA viruses</subject>
              <subj-group>
                <subject>Coronaviruses</subject>
                <subj-group>
                  <subject>SARS coronavirus</subject>
                  <subj-group>
                    <subject>SARS CoV 2</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Medical microbiology</subject>
            <subj-group>
              <subject>Microbial pathogens</subject>
              <subj-group>
                <subject>Viral pathogens</subject>
                <subj-group>
                  <subject>Coronaviruses</subject>
                  <subj-group>
                    <subject>SARS coronavirus</subject>
                    <subj-group>
                      <subject>SARS CoV 2</subject>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and health sciences</subject>
        <subj-group>
          <subject>Pathology and laboratory medicine</subject>
          <subj-group>
            <subject>Pathogens</subject>
            <subj-group>
              <subject>Microbial pathogens</subject>
              <subj-group>
                <subject>Viral pathogens</subject>
                <subj-group>
                  <subject>Coronaviruses</subject>
                  <subj-group>
                    <subject>SARS coronavirus</subject>
                    <subj-group>
                      <subject>SARS CoV 2</subject>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Viruses</subject>
            <subj-group>
              <subject>Viral pathogens</subject>
              <subj-group>
                <subject>Coronaviruses</subject>
                <subj-group>
                  <subject>SARS coronavirus</subject>
                  <subj-group>
                    <subject>SARS CoV 2</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Human Genomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Eukaryota</subject>
            <subj-group>
              <subject>Plants</subject>
              <subj-group>
                <subject>Trees</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>TPMA: A two pointers meta-alignment tool to ensemble different multiple nucleic acid sequence alignments</article-title>
      <alt-title alt-title-type="running-head">A meta-alignment tool to ensemble different multiple nucleic acid sequence alignments</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhai</surname>
          <given-names>Yixiao</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chao</surname>
          <given-names>Jiannan</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Yizheng</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0009-0002-1788-3084</contrib-id>
        <name>
          <surname>Zhang</surname>
          <given-names>Pinglu</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Tang</surname>
          <given-names>Furong</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-6406-1142</contrib-id>
        <name>
          <surname>Zou</surname>
          <given-names>Quan</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Institute of Fundamental and Frontier Sciences, University of Electronic Science and Technology of China, Chengdu, China</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Quzhou People’s Hospital, Quzhou Affiliated Hospital of Wenzhou Medical University, Quzhou, China</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Yangtze Delta Region Institute (Quzhou), University of Electronic Science and Technology of China, Quzhou, China</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Department of Basic Medical Sciences, School of Medicine, Tsinghua University, Beijing, China</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Gao</surname>
          <given-names>Xin</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>KAUST, SAUDI ARABIA</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors declare that they have no competing interests.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>Furong.TANG@hotmail.com</email> (FT); <email>zouquan@nclab.net</email> (QZ)</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <volume>20</volume>
    <issue>4</issue>
    <elocation-id>e1011988</elocation-id>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>3</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2024 Zhai et al</copyright-statement>
      <copyright-year>2024</copyright-year>
      <copyright-holder>Zhai et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1011988.pdf"/>
    <abstract>
      <p>Accurate multiple sequence alignment (MSA) is imperative for the comprehensive analysis of biological sequences. However, a notable challenge arises as no single MSA tool consistently outperforms its counterparts across diverse datasets. Users often have to try multiple MSA tools to achieve optimal alignment results, which can be time-consuming and memory-intensive. While the overall accuracy of certain MSA results may be lower, there could be local regions with the highest alignment scores, prompting researchers to seek a tool capable of merging these locally optimal results from multiple initial alignments into a globally optimal alignment. In this study, we introduce Two Pointers Meta-Alignment (TPMA), a novel tool designed for the integration of nucleic acid sequence alignments. TPMA employs two pointers to partition the initial alignments into blocks containing identical sequence fragments. It selects blocks with the high sum of pairs (SP) scores to concatenate them into an alignment with an overall SP score superior to that of the initial alignments. Through tests on simulated and real datasets, the experimental results consistently demonstrate that TPMA outperforms M-Coffee in terms of aSP, Q, and total column (TC) scores across most datasets. Even in cases where TPMA’s scores are comparable to M-Coffee, TPMA exhibits significantly lower running time and memory consumption. Furthermore, we comprehensively assessed all the MSA tools used in the experiments, considering accuracy, time, and memory consumption. We propose accurate and fast combination strategies for small and large datasets, which streamline the user tool selection process and facilitate large-scale dataset integration. The dataset and source code of TPMA are available on GitHub (<ext-link xlink:href="https://github.com/malabz/TPMA" ext-link-type="uri">https://github.com/malabz/TPMA</ext-link>).</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Accurate multiple sequence alignment (MSA) is vital for comprehensive biological sequence analysis. However, as no single MSA tool consistently outperforms others across diverse datasets, researchers must invest significant time exploring multiple tools to identify the most suitable one for their specific dataset. To address this, researchers seek tools that can merge locally optimal results from diverse initial alignments into a globally optimal alignment. Our novel approach, Two Pointers Meta-Alignment (TPMA), employs a two-pointer to partition initial alignments into blocks, selecting those with the higher sum of pairs (SP) scores for integration into a globally optimal alignment. TPMA consistently outperforms M-Coffee, demonstrating superior aSP, Q, and total column (TC) scores, coupled with faster running times and lower memory consumption. We present comprehensive assessments of various MSA tools, proposing efficient combination strategies for diverse datasets. Our tool, TPMA, and associated resources are publicly available on GitHub (<ext-link xlink:href="https://github.com/malabz/TPMA" ext-link-type="uri">https://github.com/malabz/TPMA</ext-link>), offering a valuable contribution to the field of evolutionary biology and streamlining the selection process for users dealing with large-scale datasets.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>No. 62131004</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-6406-1142</contrib-id>
          <name>
            <surname>Zou</surname>
            <given-names>Quan</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>No. 62271353</award-id>
        <principal-award-recipient>
          <name>
            <surname>Tang</surname>
            <given-names>Furong</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution>National Key R&amp;D Program of China</institution>
        </funding-source>
        <award-id>2022ZD0117700</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-6406-1142</contrib-id>
          <name>
            <surname>Zou</surname>
            <given-names>Quan</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution>Zhejiang Provincial Natural Science Foundation of China</institution>
        </funding-source>
        <award-id>LD24F020004</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-6406-1142</contrib-id>
          <name>
            <surname>Zou</surname>
            <given-names>Quan</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award005">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100018542</institution-id>
            <institution>Natural Science Foundation of Sichuan Province</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2022NSFSC0926</award-id>
        <principal-award-recipient>
          <name>
            <surname>Tang</surname>
            <given-names>Furong</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award006">
        <funding-source>
          <institution>Municipal Government of Quzhou</institution>
        </funding-source>
        <award-id>No. 2023D036</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-6406-1142</contrib-id>
          <name>
            <surname>Zou</surname>
            <given-names>Quan</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award007">
        <funding-source>
          <institution>Fellowship of China Postdoctoral Science Foundation</institution>
        </funding-source>
        <award-id>2023M731984,GZB20230365</award-id>
        <principal-award-recipient>
          <name>
            <surname>Tang</surname>
            <given-names>Furong</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>The work was supported by the National Natural Science Foundation of China (No. 62131004 to Q.Z.; No. 62271353 to F.T.), the National Key R&amp;D Program of China (No.2022ZD0117700 to Q.Z.), Zhejiang Provincial Natural Science Foundation of China (No. LD24F020004 to Q.Z.), the Natural Science Foundation of Sichuan Province (2022NSFSC0926 to F.T.), the Municipal Government of Quzhou (No. 2023D036 to Q.Z.) and the Fellowship of China Postdoctoral Science Foundation (2023M731984, GZB20230365 to F.T.). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="6"/>
      <table-count count="0"/>
      <page-count count="22"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2024-04-11</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The six real datasets consist of five DNA datasets and one RNA dataset. (1) The human mitochondrial (mt) genomes dataset comprised 672 human mitochondrial genomes, ranging from a maximum length of 16579 bp to a minimum of 16556 bp. We created sub-datasets by randomly selecting 30 sequences without replacement, and this procedure was repeated four times (Supplemental Table S2). (2) The hyper-variable segment II (HVS-II) dataset consisted of 100 sequences extracted from the HVS-II control region of the central European human mitochondrial genomes, retrieved from the GenBank database (accession numbers: KF601094-KF601193). The dataset was subsequently partitioned into ten sub-datasets. (3) The 16S ribosomal RNA (rRNA) dataset encompassed 108,413 DNA sequences encoding RNA found in bacteria and archaea, with an approximate length of 1.5 kb. We created eight sub-datasets for this dataset, each containing 100 sequences sampled randomly without replacement. (4) The 23S rRNA dataset encompassed 641 sequences of Mycobacterium 23S rRNA, sourced from the SILVA rRNA database (<ext-link xlink:href="http://www.arb-silva.de/" ext-link-type="uri">http://www.arb-silva.de/</ext-link>) for bacteria, archaea, and eukaryotes. Spanning lengths from 1909 to 3485 bp, these sequences were partitioned into ten groups (Supplemental Table S5). (5) The respiratory syndrome coronavirus 2 (SARS‑CoV‑2) is an RNA virus that causes the COVID-19 pandemic. Two datasets were derived from the GISAID website (<ext-link xlink:href="https://www.gisaid.org" ext-link-type="uri">https://www.gisaid.org</ext-link>, updated November 11, 2021.) The SARS‑CoV‑2_20200301 datasets contain 156 sequences (29409 to 29927 bp) collected on March 1, 2020, and were divided into four sub-datasets. (6) The SARS‑CoV‑2_20200417 datasets feature 1020 sequences (29409 to 29927 bp) collected on April 17, 2020. From this, we randomly selected 100 sequences without replacement to create a sub-dataset, and this process was repeated four times. Two of the four simulated datasets were generated using hierarchical tree simulation to obtain 16S-like and 23S-like rRNA datasets. This simulation was carried out using INDELible v1.03, and the substitution models were based on estimates obtained from 3000 16S rRNA and 641 Mycobacterium 23S rRNA alignments (as previously mentioned), utilizing IQ-TREE v2.2.0-beta. One hundred 16S rRNA sequences and Mycobacterium 23S rRNA sequences, randomly chosen from the datasets as mentioned above, were aligned to construct the simulation trees. Subsequently, the process of generating the simulation 16S-like and 23S-like datasets was rooted in these two simulation trees. Each tree's branch length was assigned a random value from 0 to 1 (NON-ULTRAMETRIC). The simulated sequence lengths were set at 1.5 kb for 16S-like rRNA and 4 kb for 23S-like rRNA. The indel model parameter used was LAV 5 50, with insertion and deletion rates of 0.01 and 0.1, respectively. To simulate datasets with varying mean similarities, the tree length (sum of branch lengths) was adjusted to achieve mean similarities of 99%, 98%, 97%, 96%, 95%, 94%, 93%, 92%, 91%, 90%, 85%, 80%, 75%, and 70%. The mean similarity represents the average of similarities between any two sequences within the dataset (<ext-link xlink:href="https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py" ext-link-type="uri">https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py</ext-link>), determined by the percentage of matched characters in their pairwise alignments conducted using MAFFT. Detailed information regarding these two sets of 14 sub-datasets can be found in Table S8. Every sub-dataset included three replicates, each containing 100 simulated sequences. The mean length is the average of the average sequence lengths from the three replicates. The remaining two datasets are simulated CIPRES-128 and CIPRES-256 rRNA datasets evolved from the same root rRNA sequence on the trees featuring 128 and 256 taxa, respectively (Supplemental Table S9). These datasets were downloaded from trials 1 to 10 on the CIPRES SIMULATION DATA website (<ext-link xlink:href="https://kim.bio.upenn.edu/software/csd.shtml" ext-link-type="uri">https://kim.bio.upenn.edu/software/csd.shtml</ext-link>). The simulation parameters were adjusted to ensure that the simulated sequences mirror authentic small subunit rRNA (ssu rRNA) sequences regarding sequence identity, indel count, the ratio between substitutions and indels, and other relevant characteristics. The datasets were formatted in NEXUS format. The Nexus to Fasta Sequence Convert tool (<ext-link xlink:href="http://www.bugaco.com" ext-link-type="uri">http://www.bugaco.com</ext-link>) was utilized for conversion into FASTA format to obtain the reference sequences. Subsequently, gaps were removed from the reference to derive the unaligned test datasets. Sequence similarity is computed for every dataset as the ratio of matching base pairs in all pairwise alignments (generated using MAFFT) within a sub-dataset. The script for this computation is available on <ext-link xlink:href="https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py" ext-link-type="uri">https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py</ext-link>. Lastly, employ Python's Matplotlib library to generate a histogram depicting the distribution of sequence similarity.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The six real datasets consist of five DNA datasets and one RNA dataset. (1) The human mitochondrial (mt) genomes dataset comprised 672 human mitochondrial genomes, ranging from a maximum length of 16579 bp to a minimum of 16556 bp. We created sub-datasets by randomly selecting 30 sequences without replacement, and this procedure was repeated four times (Supplemental Table S2). (2) The hyper-variable segment II (HVS-II) dataset consisted of 100 sequences extracted from the HVS-II control region of the central European human mitochondrial genomes, retrieved from the GenBank database (accession numbers: KF601094-KF601193). The dataset was subsequently partitioned into ten sub-datasets. (3) The 16S ribosomal RNA (rRNA) dataset encompassed 108,413 DNA sequences encoding RNA found in bacteria and archaea, with an approximate length of 1.5 kb. We created eight sub-datasets for this dataset, each containing 100 sequences sampled randomly without replacement. (4) The 23S rRNA dataset encompassed 641 sequences of Mycobacterium 23S rRNA, sourced from the SILVA rRNA database (<ext-link xlink:href="http://www.arb-silva.de/" ext-link-type="uri">http://www.arb-silva.de/</ext-link>) for bacteria, archaea, and eukaryotes. Spanning lengths from 1909 to 3485 bp, these sequences were partitioned into ten groups (Supplemental Table S5). (5) The respiratory syndrome coronavirus 2 (SARS‑CoV‑2) is an RNA virus that causes the COVID-19 pandemic. Two datasets were derived from the GISAID website (<ext-link xlink:href="https://www.gisaid.org" ext-link-type="uri">https://www.gisaid.org</ext-link>, updated November 11, 2021.) The SARS‑CoV‑2_20200301 datasets contain 156 sequences (29409 to 29927 bp) collected on March 1, 2020, and were divided into four sub-datasets. (6) The SARS‑CoV‑2_20200417 datasets feature 1020 sequences (29409 to 29927 bp) collected on April 17, 2020. From this, we randomly selected 100 sequences without replacement to create a sub-dataset, and this process was repeated four times. Two of the four simulated datasets were generated using hierarchical tree simulation to obtain 16S-like and 23S-like rRNA datasets. This simulation was carried out using INDELible v1.03, and the substitution models were based on estimates obtained from 3000 16S rRNA and 641 Mycobacterium 23S rRNA alignments (as previously mentioned), utilizing IQ-TREE v2.2.0-beta. One hundred 16S rRNA sequences and Mycobacterium 23S rRNA sequences, randomly chosen from the datasets as mentioned above, were aligned to construct the simulation trees. Subsequently, the process of generating the simulation 16S-like and 23S-like datasets was rooted in these two simulation trees. Each tree's branch length was assigned a random value from 0 to 1 (NON-ULTRAMETRIC). The simulated sequence lengths were set at 1.5 kb for 16S-like rRNA and 4 kb for 23S-like rRNA. The indel model parameter used was LAV 5 50, with insertion and deletion rates of 0.01 and 0.1, respectively. To simulate datasets with varying mean similarities, the tree length (sum of branch lengths) was adjusted to achieve mean similarities of 99%, 98%, 97%, 96%, 95%, 94%, 93%, 92%, 91%, 90%, 85%, 80%, 75%, and 70%. The mean similarity represents the average of similarities between any two sequences within the dataset (<ext-link xlink:href="https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py" ext-link-type="uri">https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py</ext-link>), determined by the percentage of matched characters in their pairwise alignments conducted using MAFFT. Detailed information regarding these two sets of 14 sub-datasets can be found in Table S8. Every sub-dataset included three replicates, each containing 100 simulated sequences. The mean length is the average of the average sequence lengths from the three replicates. The remaining two datasets are simulated CIPRES-128 and CIPRES-256 rRNA datasets evolved from the same root rRNA sequence on the trees featuring 128 and 256 taxa, respectively (Supplemental Table S9). These datasets were downloaded from trials 1 to 10 on the CIPRES SIMULATION DATA website (<ext-link xlink:href="https://kim.bio.upenn.edu/software/csd.shtml" ext-link-type="uri">https://kim.bio.upenn.edu/software/csd.shtml</ext-link>). The simulation parameters were adjusted to ensure that the simulated sequences mirror authentic small subunit rRNA (ssu rRNA) sequences regarding sequence identity, indel count, the ratio between substitutions and indels, and other relevant characteristics. The datasets were formatted in NEXUS format. The Nexus to Fasta Sequence Convert tool (<ext-link xlink:href="http://www.bugaco.com" ext-link-type="uri">http://www.bugaco.com</ext-link>) was utilized for conversion into FASTA format to obtain the reference sequences. Subsequently, gaps were removed from the reference to derive the unaligned test datasets. Sequence similarity is computed for every dataset as the ratio of matching base pairs in all pairwise alignments (generated using MAFFT) within a sub-dataset. The script for this computation is available on <ext-link xlink:href="https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py" ext-link-type="uri">https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py</ext-link>. Lastly, employ Python's Matplotlib library to generate a histogram depicting the distribution of sequence similarity.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Multiple sequence alignment (MSA) is a common technique for analyzing biological sequences, encompassing structure and function estimation, evolutionary relationship determination, gene identification, and more [<xref rid="pcbi.1011988.ref001" ref-type="bibr">1</xref>]. Hence, the precision of MSA directly shapes the outcomes of analyses in bioinformatics, holding paramount importance in discerning biological significance. However, due to its time-consuming nature, many MSA tools, like MAFFT [<xref rid="pcbi.1011988.ref002" ref-type="bibr">2</xref>] and MUSCLE3 [<xref rid="pcbi.1011988.ref003" ref-type="bibr">3</xref>], resort to heuristic methods to address computational complexities. Despite their extensive usage, tools employing heuristic methods exhibit two common limitations. Firstly, the persistence of an incorrectly inserted gap, adhering to the "once a gap, always a gap" rule, can influence subsequent alignments. The other issue is the presence of a local optimal trap. According to the greedy principle, the optimal solution for each subproblem may not necessarily be equivalent to the optimal solution for the global problem. To overcome the drawbacks above, researchers typically employ iterative optimization and meta-alignment methods to further enhance alignment accuracy.</p>
    <p>Iterative optimization involves refining the existing alignment by realigning potential low-quality regions, employing two partition methods: vertical and horizontal realigners. Refin-Align [<xref rid="pcbi.1011988.ref004" ref-type="bibr">4</xref>], a vertical realigner, partitions the initial alignment into blocks based on columns with identical bases. It then eliminates gaps within each block and realigns the sequences using Promalign. If the new alignment exhibits higher accuracy, it replaces the initial alignment. On the other hand, the horizontal realigners, including REFINER [<xref rid="pcbi.1011988.ref005" ref-type="bibr">5</xref>], RF [<xref rid="pcbi.1011988.ref006" ref-type="bibr">6</xref>], and ReformAlign [<xref rid="pcbi.1011988.ref007" ref-type="bibr">7</xref>], adopt distinct strategies. Similar to REFINER, RF randomly selects a sequence in each iteration and realigns it with the profile of the remaining sequences; if the accuracy of the new alignment improves, it serves as the input for the next iteration round until the objective function score converges or reaches the cycle limit. ReformAlign differs from the others by independently realigning all sequences within a single iterative round. This realignment is performed using a summarization profile constructed from the initial alignment. When new gaps are inserted into the profile, ReformAlign automatically switches to a profile fine-tuning mode to account for the new insertion(s), and once the profile is successfully updated, the realignment is restarted using the new profile until the new alignment is obtained after all sequences have been realigned. However, among the methods mentioned above, currently only ReformAlign is available.</p>
    <p>Meta-alignment, a process aimed at synthesizing multiple initial alignments, is employed to derive a high-accuracy alignment. The ComAlign algorithm [<xref rid="pcbi.1011988.ref008" ref-type="bibr">8</xref>] identifies qualitatively conservative blocks within the initial alignments and amalgamates them through dynamic programming to produce a novel alignment, often exhibiting improvements. MergeAlign [<xref rid="pcbi.1011988.ref009" ref-type="bibr">9</xref>] generates a weighted directed acyclic graph (DAG), wherein each node represents the site combinations of each column in the initial alignments. Each edge signifies a transition between two adjacent columns, and the weight of each edge corresponds to the number of initial alignments containing that particular transition (between two adjacent columns). Finally, the nodes (columns) in the maximum weight path form the merged alignment. AQUA [<xref rid="pcbi.1011988.ref010" ref-type="bibr">10</xref>], an automated quality improvement program for Multiple Sequence Alignment (MSA), initiates its process by generating two initial alignments through MUSCLE3 and MAFFT. These alignments are subsequently independently optimized using RASCAL [<xref rid="pcbi.1011988.ref011" ref-type="bibr">11</xref>], resulting in two refined alignments. In its culmination, the meta-alignment process yields the alignment with the highest accuracy among the four, determined by the NorMD score. The most widely utilized meta-alignment method is M-Coffee [<xref rid="pcbi.1011988.ref012" ref-type="bibr">12</xref>], which constructs a consistency library of each pair of residues with residue pairs from all other alignments to increase the weight of the aligned pairs accepted by most MSA tools. However, it is noteworthy that this inclusive approach implies that incorrectly aligned pairs prevalent across multiple alignments will also be weighted. Consequently, the accuracy of the M-Coffee meta-alignment can either be improved or diminished, depending on the accuracy of each individual MSA tool.</p>
    <p>In this study, we have developed TPMA, a meta-alignment tool for integrating nucleic acid sequence alignments, which employs a two-pointers approach to partition the initial alignments into blocks with identical sequence fragments and concatenate blocks with higher SP scores to form the final alignment. We tested TPMA, M-Coffee, and ReformAlign on four simulated and six real datasets. The results consistently show that TPMA outperforms M-Coffee in terms of aSP, Q, and TC scores across most datasets. Notably, in cases where TPMA scores closely align with M-Coffee, TPMA exhibits significantly lower time and memory consumption. In datasets with varying similarity spans, ReformAlign optimization led to approximately 50% of alignments experiencing decreased TC scores in simulated datasets. Thus, TPMA exhibits superior performance compared to both M-Coffee and ReformAlign. To save time for users while selecting MSA tools, we screened all MSA tools used in our experiments based on accuracy, time, and memory consumption. Therefore, we propose accurate and fast combination strategies to integrate small and large datasets, ensuring efficient integration while upholding alignment accuracy.</p>
  </sec>
  <sec sec-type="results" id="sec002">
    <title>Results</title>
    <sec id="sec003">
      <title>TPMA outperforms M-Coffee in alignment quality, running time, and memory consumption</title>
      <p>In this experiment, we employed two simulated datasets, 16S-like and 23S-like rRNA, along with four real datasets: 16S rRNA, human mitochondrial (mt) genomes, SARS-CoV-2_20200301, and SARS-CoV-2_20200417 datasets. Furthermore, nine MSA tools, namely ClustalW2, Dialign-TX, Kalign3, MAFFT, MUSCLE3, MUSCLE5, PCMA, POA, and T-Coffee, were employed to generate initial alignments. Detailed information regarding the versions and operating parameters of these MSA tools can be found in <xref rid="pcbi.1011988.s013" ref-type="supplementary-material">S10 Table</xref>.</p>
      <p>M-Coffee takes the original, unaligned sequences dataset as input and utilizes the "-method" parameter to specify the MSA tools for obtaining the initial alignments. To ensure compatibility with M-Coffee, we crafted a shell script specifically for calling MUSCLE5, while the remaining MSA tools have already been integrated into M-Coffee by default. The shell script for invoking MUSCLE5 and its usage instructions can be found at <ext-link xlink:href="https://github.com/malabz/TPMA/tree/main/tools" ext-link-type="uri">https://github.com/malabz/TPMA/tree/main/tools</ext-link>. The input for TPMA comprises multiple initial alignments generated by different MSA tools, with each aligner’s running parameters precisely identical to those utilized in the M-Coffee, guaranteeing an impartial experimental setup. Two simulated datasets with references were evaluated by aSP, Q, and TC scores, while the alignment quality of the four real datasets was assessed based on the aSP score. The running time of TPMA refers to the duration taken to merge multiple initial alignments, while memory consumption indicates the peak amount of memory utilized during this merging process. Regarding M-Coffee, the running time and memory consumption encompass the time and maximum memory used from initial library construction to combination completion. Specifically, the reported running time and memory consumption by TPMA are related to the merging process. In the case of M-Coffee, its memory usage during merging corresponds to the peak memory usage of its final output. To measure the timing of the M-Coffee merging process, we introduced a timestamp mechanism. This entailed placing a timestamp at the start of merging, following the if function in line 5093 of the t_coffee.c file in its source code. Another timestamp was logged upon program completion, enabling us to accurately compute the duration of the M-Coffee merging process. The time and memory consumed by the MSA tools generating the initial alignments were excluded for the purpose of comparing TPMA and M-Coffee.</p>
      <p><xref rid="pcbi.1011988.g001" ref-type="fig">Fig 1A and 1D</xref> demonstrate that the TPMA results consistently outperform the other nine initial alignments and the combined results of M-Coffee in terms of aSP, Q, and TC (except for the 99% similarity dataset) scores across the 16S-like and 23S-like rRNA datasets. This advantage becomes more pronounced as the dataset similarity decreases. For the 16S-like rRNA datasets with a 99% similarity, TPMA achieves an average TC score of 0.9967, while ClustalW2 and PCMA achieve an average TC score of 0.9970, and M-Coffee’s average TC score is 0.9957. Similarly, for the 23S-like rRNA datasets with a 99% similarity, TPMA attains an average TC score of 0.9963, while T-Coffee and M-Coffee achieve average TC scores of 0.9969 and 0.9960, respectively. Consequently, TPMA’s results closely approach the highest TC score and surpass those of M-Coffee. Furthermore, TPMA demonstrates shorter running time and lower memory consumption than M-Coffee on both sets of datasets (<xref rid="pcbi.1011988.g001" ref-type="fig">Fig 1B and 1E</xref>). In the 16S rRNA datasets with an average similarity of 75%, TPMA shows a superior aSP score compared to M-Coffee (<xref rid="pcbi.1011988.g002" ref-type="fig">Fig 2A</xref>). However, for the other three real datasets with high average similarities, TPMA and M-Coffee demonstrate close scores (<xref rid="pcbi.1011988.g002" ref-type="fig">Fig 2D</xref>, <xref rid="pcbi.1011988.g002" ref-type="fig">2G</xref>, and <xref rid="pcbi.1011988.g002" ref-type="fig">2J</xref>). Furthermore, TPMA exhibits a significantly shorter running time and consumes considerably less memory than M-Coffee (<xref rid="pcbi.1011988.g002" ref-type="fig">Fig 2B</xref>, <xref rid="pcbi.1011988.g002" ref-type="fig">2E</xref>, <xref rid="pcbi.1011988.g002" ref-type="fig">2H</xref>, and <xref rid="pcbi.1011988.g002" ref-type="fig">2K</xref>).</p>
      <fig position="float" id="pcbi.1011988.g001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011988.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Comparative analysis of TPMA, M-Coffee, and ReformAlign on 16S-like and 23S-like rRNA datasets.</title>
          <p>Each dataset consists of 14 sub-datasets, each exhibiting varying levels of sequence similarity ranging from 99% to 70%. Within each similarity sub-dataset, three replicates are included. For each replicate, nine initial alignments are acquired and subsequently merged using TPMA and M-Coffee. <bold>A, D</bold> The aSP, Q, and TC scores of TPMA, M-Coffee, and nine MSA tools across 16S-like and 23S-like rRNA datasets. For each gird, the average of three repetitions in one sub-dataset was calculated and subjected to min-max normalization using the alignment scores from all tools. <bold>B</bold>, <bold>E</bold> The changes in running time and memory usage of TPMA and M-Coffee across different levels of similarity for the 16S-like and 23S-like rRNA datasets. Each point represents the average time and memory consumption resulting from the combination of TPMA and M-Coffee across the three replicates. This computation excludes the time and memory required for obtaining the initial alignments. <bold>C, F</bold> Compare improvements in aSP, Q, and TC scores of TPMA, M-Coffee, and ReformAlign for initial alignments on 16S-like and 23S-like rRNA datasets. Each dataset consists of 14 sub-datasets, with three replicates per sub-dataset. A total of 378 (14×3×9) initial alignments were generated using 9 MSA tools. ReformAlign optimized these 378 initial alignments, calculating the differences between the scores of the optimized and unoptimized initial alignments for aSP, Q, and TC scores. Additionally, the disparities between the scores of the merged alignments (through TPMA and M-Coffee) and the unmerged initial alignments were also computed for aSP, Q, and TC scores. A total of 378 differences were obtained for TPMA and M-Coffee, obtained from 14×3 replicates, with each replicate generating 9 differences. The proportions of "improved," "constant," and "reduced" are summarized in donut charts.</p>
        </caption>
        <graphic xlink:href="pcbi.1011988.g001" position="float"/>
      </fig>
      <fig position="float" id="pcbi.1011988.g002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011988.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Comparative analysis of TPMA, M-Coffee, and ReformAlign across the four real datasets.</title>
          <p>The 16S rRNA datasets include 8 subsets, each comprising 100 sequences, and nine MSA tools were utilized to generate the initial alignments for these datasets. Additionally, the mt genomes, SARS-CoV-2_20200301, and SARS-CoV-2_20200417 datasets consist of 4 subsets containing 30, 39, and 100 sequences, respectively. <bold>A, D, G, J</bold> The aSP score of TPMA, M-Coffee, and various MSA tools on the 16S rRNA, mt genomes, SARS-CoV-2_20200301, and SARS-CoV-2_20200417 datasets. It’s worth noting that some MSA tools failed to align on these datasets; only the tools depicted in the figure completed the alignment. The resulting initial alignment was then utilized for the merging process using TPMA and M-Coffee. <bold>B, E, H, K</bold> The running time and memory usage of TPMA and M-Coffee for the 16S rRNA, mt genomes, SARS-CoV-2_20200301, and SARS-CoV-2_20200417 datasets. Notably, the values exclude the time and memory needed to obtain the initial alignments. <bold>C, F, I, L</bold> The enhancements in the aSP score of initial alignments on the 16S rRNA (<bold>C</bold>), mt genomes (<bold>F</bold>), SARS-CoV-2_20200301 (<bold>I</bold>), and SARS-CoV-2_20200417 (<bold>L</bold>) datasets among TPMA, M-Coffee, and ReformAlign. Specifically, the 16S rRNA datasets comprise 72 (8×9) initial alignments, while the mt genomes datasets entail 28 (4×7) initial alignments. Furthermore, both the SARS-CoV-2_20200301 and SARS-CoV-2_20200417 datasets each encompass 20 (4×5) initial alignments. The proportions of "improved", "constant", and "reduced" are calculated based on the number of initial alignments for each dataset. It’s worth noting that for the two SARS-CoV-2 datasets, ReformAlign’s results were not displayed due to exceeding the device’s memory limit.</p>
        </caption>
        <graphic xlink:href="pcbi.1011988.g002" position="float"/>
      </fig>
      <p>Afterward, we assessed the performance of TPMA, M-Coffee, and ReformAlign in enhancing alignment quality. First, we optimized each initial alignment utilizing ReformAlign’s fundamental parameters (detailed in <xref rid="pcbi.1011988.s013" ref-type="supplementary-material">S10 Table</xref>), calculated the difference in aSP, Q, and TC scores between the optimized and initial alignments, and then computed the discrepancy between the combined results and each participating initial alignment for TPMA and M-Coffee.</p>
      <p>On both 16S-like and 23S-like rRNA datasets (<xref rid="pcbi.1011988.g001" ref-type="fig">Fig 1C and 1F</xref>), TPMA improves or maintains the aSP score in all datasets, and it enhances Q and TC scores in the majority of datasets when compared to M-Coffee and ReformAlign. Similarly, compared to M-Coffee and ReformAlign, TPMA improves more alignments’ aSP score across all four real datasets, which were randomly sampled to obtain multiple replicas for comparison (<xref rid="pcbi.1011988.g002" ref-type="fig">Fig 2C</xref>, <xref rid="pcbi.1011988.g002" ref-type="fig">2F</xref>, <xref rid="pcbi.1011988.g002" ref-type="fig">2I</xref>, and <xref rid="pcbi.1011988.g002" ref-type="fig">2L</xref>). It is noteworthy that ReformAlign faced limitations in optimizing the two SARS-CoV-2 datasets due to memory limitations exceeding the device’s upper threshold.</p>
      <p>Thus, TPMA consistently imparts heightened alignment quality compared to most initial alignments, a trend especially pronounced in datasets exhibiting lower similarity. While, in certain instances, TPMA’s score might marginally fall below that of the initial alignment, it consistently approaches the highest score and surpasses the outcome achieved by M-Coffee. In contrast, the accuracy of M-Coffee generated alignments is susceptible to the accuracy of the initial alignment, potentially between the best and worst initial alignments, showing a limited ability to improve the quality of initial alignments. TPMA exhibits a shorter running time and less memory consumption than M-Coffee. Furthermore, as sequence length and quantity increase, ReformAlign’s memory demands become excessively high, constraining its scalability.</p>
    </sec>
    <sec id="sec004">
      <title>Accurate strategy: achieving comparable results with 4 MSA tools as with All 9</title>
      <p>Initially, we arranged the 9 MSA tools based on the accuracy of their alignment results, revealing that the top 5 aligners derived from the aSP, Q, and TC scores were identical, comprising ClustalW2, MAFFT, MUSCLE3, PCMA, and T-Coffee, albeit in varying specific orders (<xref rid="pcbi.1011988.g003" ref-type="fig">Fig 3A</xref>). By utilizing MSA tools’ aSP score ranking, we added and merged the initial alignments one by one from the top-ranked MSA tools, then computed the average accuracy across all sub-datasets, illustrated as the yellow square curve (<xref rid="pcbi.1011988.g003" ref-type="fig">Fig 3B</xref>). "Top 2" signifies the result obtained by combining the alignments derived from the top two aligners, T-Coffee and MUSCLE3, by TPMA. "Top 3" represents the combined result of the top three T-Coffee, MUSCLE3, and MAFFT; the subsequent combinations are deduced accordingly. We replicate the identical procedure using the rankings derived from Q and TC scores, resulting in the outcomes represented by the blue circular curve and the red triangular curve, respectively. Notably, as more initial alignments were added, the aSP, Q, and TC scores initially increased but eventually reached a plateau or slightly decreased. This observation suggests that the inclusion of Dialign-TX, Kalign3, MUSCLE5, and POA in these combinations did not enhance the final alignment’s quality. Upon reanalysis of the aSP, Q, and TC scores across various sequence similarities (<xref rid="pcbi.1011988.s001" ref-type="supplementary-material">S1</xref>–<xref rid="pcbi.1011988.s003" ref-type="supplementary-material">S3</xref> Figs), similar pronounced trends were observed in low-similarity sub-datasets, highlighting TPMA’s enhanced efficacy in integrating such datasets.</p>
      <fig position="float" id="pcbi.1011988.g003">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011988.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>The results of screening the accurate strategy on the 23S-like rRNA datasets.</title>
          <p><bold>A</bold> MSA tool rankings are determined based on aSP, Q, and TC scores. Each point corresponds to the average value of three replicates within that sub-dataset. "Mean" denotes the ranking derived from the average values spanning all sub-datasets with varying degrees of similarity. <bold>B</bold> Sequential integration of initial alignments from MSA tools following ranking by aSP, Q, and TC scores. The ranking is derived from the "Mean" results of <bold>A</bold>. Referring to the aSP score rankings (the orange line), the "Top 2" position indicates the integration of T-Coffee and MUSCLE3, while the "Top 3" placement corresponds to the fusion of T-Coffee, MUSCLE3, and MAFFT, and so forth. Analyzing the Q score rankings (the blue line), the "Top 2" position signifies the combination of T-Coffee and MUSCLE3, while the "Top 3" is the fusion of T-Coffee, MUSCLE3, and ClustalW2, and so forth. Similarly, based on the TC score ranking (the red line), the "Top 2" position indicates the combination of ClustalW2 and PCMA, while the "Top 3" placement represents the integration of ClustalW2, PCMA, and T-Coffee, and so forth. The outcomes represent the average values of the aSP, Q, and TC scores of combined alignments across all sub-datasets of different similarities. <bold>C</bold> Ablation experiment on the "Top 5" MSA tools. The disparities between the aSP, Q, and TC scores of the combined alignment obtained from the remaining four initial alignments (excluding the indicated MSA tool) and from all five initial alignments were computed. If the score from combining the remaining four initial alignments is higher, it’s classified as ’improved’; if it remains the same, it’s labeled ’constant’; if it decreases, it’s categorized as ’reduced’. Each histogram displays the proportions of "improved," "constant," and "reduced" cases, calculated from a total of 42 datasets (14*3) across all sub-datasets. <bold>D</bold> Ablation experiment on the "Top 4" MSA tools (similar to C). <bold>E</bold> The running time and memory consumption of 11 MSA tools on 42 23S-like rRNA datasets are presented. Logging was conducted using Python’s psutil library.</p>
        </caption>
        <graphic xlink:href="pcbi.1011988.g003" position="float"/>
      </fig>
      <p>The trend from "Top 4" to "Top 5" remains constant, leading us to deduce the presence of redundant MSA tools within the "Top 5" combination. Consequently, we performed ablation experiments on the selected top 5 MSA tools, revealing that the final alignment remained unchanged when either ClustalW2 or PCMA was excluded (<xref rid="pcbi.1011988.g003" ref-type="fig">Fig 3C</xref>). Considering their running time and memory utilization on 23S-like rRNA datasets (<xref rid="pcbi.1011988.g003" ref-type="fig">Fig 3E</xref>), ClustalW2 demonstrates reduced memory consumption and faster processing time than PCMA. Consequently, we refined the accurate combination strategy to encompass four aligners: ClustalW2, MAFFT, MUSCLE3, and T-Coffee. Further, ablation experiments on these four MSA tools demonstrated that each aligner significantly contributed to the final alignment quality, affirming their indispensability within the accurate strategy (<xref rid="pcbi.1011988.g003" ref-type="fig">Fig 3D</xref>).</p>
      <p>We conducted tests on seven datasets to further validate the broad applicability of the accurate strategy when utilizing TPMA. TPMA combines nine initial alignments, "Top 5" initial alignments, and the four initial alignments from the accurate strategy to generate TPMA_C9, TPMA_C5, and TPMA_C4, respectively. In contrast, M-Coffee integrates the nine initial alignments and the four initial alignments of the accurate strategy, yielding M-Coffee_C9 and M-Coffee_C4, respectively. TPMA’s combined outcomes on 16S-like and 23S-like rRNA datasets consistently outperform M-Coffee in terms of aSP, Q, and TC scores. Meanwhile, TPMA_C9, TPMA_C5, and TPMA_C4 show highly similar results (<xref rid="pcbi.1011988.g004" ref-type="fig">Fig 4A and 4B</xref>). These three TPMA outcomes also demonstrate comparable performance across simulated CIPRES-128, CIPRES-256, and 16S rRNA datasets, where the sequences exhibit average similarity rates of 80% for the first two and 75% for the latter, all-surpassing M-Coffee (<xref rid="pcbi.1011988.g004" ref-type="fig">Fig 4C–4E</xref>). The "NULL" signifies that no results were acquired from TPMA-C9 and M-Coffee_C9 due to the infinite alignment time of Dialign-TX (<xref rid="pcbi.1011988.g004" ref-type="fig">Fig 4D</xref>). The HVS-II and 23S rRNA datasets exhibited an average similarity above 93%. Results from three TPMA and two M-Coffee alignments closely align on these datasets, with TPMA slightly surpassing M-Coffee’s outcomes (<xref rid="pcbi.1011988.g004" ref-type="fig">Fig 4F and 4G</xref>). Therefore, the outputs from the comprehensive test datasets validate that integrating the four alignments acquired through the accurate strategy can yield results of comparable quality to combining all nine alignments while saving time and memory.</p>
      <fig position="float" id="pcbi.1011988.g004">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011988.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Validation of the accurate strategy on additional datasets.</title>
          <p>TPMA_C9 and M-Coffee_C9 represent the combined alignments of 9 initial alignments from ClustalW2, Dialign-TX, Kalign3, MAFFT, MUSCLE3, MUSCLE5, PCMA, POA, and T-Coffee. TPMA_C5 combines initial alignments from 5 MSA tools: ClustalW2, MAFFT, MUSCLE3, PCMA, and T-Coffee. TPMA_C4 and M-Coffee_C4 are the combined alignments of merging the initial alignments from the accurate strategy (ClustalW2, MAFFT, MUSCLE3, and T-Coffee). <bold>A, B</bold> We present the trends in aSP, Q, and TC scores of TPMA_C9, TPMA_C5, TPMA_C4, M-Coffee_C9, and M-Coffee_C4 on the 16S-like and 23S-like rRNA sub-datasets. The results represent the average value across the three replicates from each sub-dataset. <bold>C, D,</bold> Comparing aSP, Q, and TC scores (10 replicates) for TPMA_C9, TPMA_C5, TPMA_C4, M-Coffee_C9, and M-Coffee_C4 on simulated CIPRES-128 and CIPRES-256 rRNA datasets, alongside a sequence similarity distribution histogram. The sequence similarity of each replicate was similar within the dataset, and only one of the replicates’ sequence similarity distribution histograms was plotted. The "NULL" indicates that TPMA-C9 and M-Coffee_C9 produced no results due to the infinite alignment time of Dialign-TX. <bold>E-G,</bold> The aSP scores of TPMA_C9, TPMA_C5, TPMA_C4, M-Coffee_C9, and M-Coffee_C4 on the 16S rRNA, HVS-II, and 23S rRNA datasets with the corresponding sequence similarity distribution histograms (only one representative histogram was displayed). The 16S rRNA datasets have 8 replicates, while the HVS-II and 23S rRNA datasets contain 10 replicates.</p>
        </caption>
        <graphic xlink:href="pcbi.1011988.g004" position="float"/>
      </fig>
    </sec>
    <sec id="sec005">
      <title>Fast strategy: enhancing alignment accuracy with time efficiency for large-scale datasets</title>
      <p>During the above experiment, we observed that early-developed MSA software, such as T-Coffee and Dialign-TX, faced difficulties in aligning datasets with longer or larger sequences, leading to considerable time and memory expenses, potentially limiting options for certain users, particularly considering the inclusion of T-Coffee in the accurate strategy. To address this, we identify newly developed MSA software that exhibits swift alignment speed and lower memory consumption, and by integrating these tools with TPMA, we formulated a fast combination strategy, explicitly catered for datasets with larger scales, aiming to save time while preserving alignment accuracy as closely as possible to the accurate strategy results. We evaluated the performance of the fast strategy which selected the four most rapid MSA tools (<xref rid="pcbi.1011988.g003" ref-type="fig">Fig 3E</xref>), namely HAlign3, Kalign3, MAFFT, and WMSA2, by conducting experiments on eight datasets. The experimental approach involved running the four MSA tools to acquire initial alignments, followed by merging these alignments using TPMA to generate "TPMA_F4". We compared the accuracy of TPMA_F4 with that of "TPMA_C4" from the 4.2 experiment and recorded the memory consumption and running time required for obtaining all initial alignments. The memory consumption represents the maximum usage of TPMA_F4 and TPMA_C4 when running individual MSA tools, while the running time refers to the cumulative time taken by TPMA_F4 and TPMA_C4 when running each MSA tool. The time and memory consumption associated with combining initial alignments in TPMA_F4 and TPMA_C4 were disregarded.</p>
      <p>In the 16S-like and 23S-like rRNA datasets, the aSP and TC score curves of TPMA_C4 and TPMA_F4 almost overlap, while, as the sequence similarity falls below 80%, the Q score of TPMA_F4 slightly lags behind that of TPMA_C4. Notably, TPMA_F4 demands significantly less time for initial alignments than TPMA_C4, and when the sequence similarity reaches 85% or higher, TPMA_F4 exhibits lower memory consumption than TPMA_C4 (<xref rid="pcbi.1011988.g005" ref-type="fig">Fig 5A and 5B</xref>). On the simulated CIPRES-128 and CIPRES-256 rRNA datasets (sequence similarity: 80%), the aSP score distributions are similar between the two methods, while the Q score and TC score distributions of TPMA_F4 are slightly lower than those of TPMA_C4 (<xref rid="pcbi.1011988.g005" ref-type="fig">Fig 5C and 5D</xref>). For the 16S rRNA datasets (sequence similarity: 75%), TPMA_F4 achieves a slightly lower aSP score than TPMA_C4 (<xref rid="pcbi.1011988.g005" ref-type="fig">Fig 5E</xref>). However, in the case of the HVS-II datasets (sequence similarity: 98.6%), 23S rRNA datasets (sequence similarity: 92.7%), and mt genomes datasets (sequence similarity: 99.7%), the TPMA_C4 and TPMA_F4 results demonstrate similar aSP score distributions (<xref rid="pcbi.1011988.g005" ref-type="fig">Fig 5F–5H</xref>). While the disparity in peak memory consumption between the two methods is minimal in the above datasets, TPMA_F4 requires significantly less time for initial alignments than TPMA_C4. Especially on the mt-genomes datasets, TPMA_C4’s completion time for all initial alignments extends up to 4 days, accompanied by memory usage exceeding 100GB, whereas TPMA_F4 accomplishes the task within a mere 1 minute, utilizing 290MB of memory. The experimental results affirm that, when sequence similarity exceeds 80%, the fast strategy can attain alignment quality comparable to the accurate strategy, significantly reducing the time required for initial alignments, particularly on extensive datasets.</p>
      <fig position="float" id="pcbi.1011988.g005">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011988.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Comparative analysis of accurate and fast strategies.</title>
          <p>TPMA_C4 is derived from the merged alignment by combining the initial alignments obtained through accurate strategy (ClustalW2, MAFFT, MUSCLE3, and T-Coffee), while TPMA_F4 results from that of the fast strategy (HAlign3, Kalign3, MAFFT, and WMSA2). The time indicated the aggregate of the running time for the four MSA tools within the combined strategy. Meanwhile, the memory reflects the highest memory consumption observed during the aligning process of the four MSA tools in the combined strategy. <bold>A-D</bold> aSP, Q, and TC scores of TPMA_C4 and TPMA_F4 on the 16S-like, 23S-like, simulated CIPRES-128 and CIPRES-256 rRNA datasets, along with the overall time and memory peak consumption during acquiring all initial alignments. Each point in <bold>A</bold> and <bold>B</bold> represents the average value from three replicates within the sub-dataset of 16S-like and 23S-like rRNA datasets. Meanwhile, both CIPRES rRNA datasets consist of 10 replicates. <bold>E-H</bold> aSP score of TPMA_C4 and TPMA_F4 on the 16S rRNA, HVS-II, 23S rRNA, and mt genomes datasets with the time and memory of that required to obtain all initial alignments. The 16S rRNA, HVS-II, 23S rRNA, and mt genome datasets comprised 8, 10, 10, and 4 replicates, respectively.</p>
        </caption>
        <graphic xlink:href="pcbi.1011988.g005" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec006">
    <title>Discussion</title>
    <p>We developed Two Pointers Meta-Alignment (TPMA) to enhance the quality of nucleic acid sequence alignments by combining blocks with high SP scores from multiple initial alignments. The assessment of TPMA across six real and four simulated datasets revealed that it improves the aSP, Q, and TC scores of initial alignments across most datasets, particularly in datasets with low sequence similarity, all while reducing memory and time consumption. While TPMA’s result exhibited a relatively lower score in partial high sequence similarity datasets, it closely approached the highest score of initial alignments and outperformed the result from M-Coffee. Furthermore, in contrast to M-Coffee and ReformAlign, TPMA demonstrates a more significant capability for enhancing the quality of initial alignments. Subsequently, we evaluated the MSA tools utilized in the experiment and presented users with accurate and fast strategies. Validation of the test datasets affirmed that these two strategies could uphold alignment accuracy while conserving time and facilitating the integration of large-scale datasets. In our experimental tests, we focused solely on comparing the running time and memory consumption of TPMA and M-Coffee, without including ReformAlign in the comparison. This decision stems from the fact that TPMA and M-Coffee employ similar optimization strategies, namely merging multiple initial alignments, while ReformAlign conducts re-alignment against a single initial alignment. As a result, a direct comparison with TPMA and M-Coffee in terms of time and memory consumption is not feasible.</p>
    <p>During a validation experiment to assess TPMA’s efficacy, we employed 9 MSA tools for the integration. Recognizing the impracticality for users to execute numerous MSA tools individually before integration, we streamlined the process by offering users an accurate strategy, ensuring equivalent or similar alignment quality with the fewest tools. This enhancement in user convenience saves valuable time typically spent on tool selection. Additionally, 23S-like rRNA was chosen as the experimental dataset for screening MSA tools of accurate strategy for several reasons: firstly, the simulated datasets provide reference alignments, and we can comprehensively assess MSA tools based on aSP, Q, and TC scores. Among these metrics, aSP quantifies the quality of sequence alignment by computing the average similarity score across all sequence pairs. Q and TC provide a comprehensive assessment of alignment accuracy and completeness relative to a reference alignment. MSA tools that incorporate multiple indicators in their selection process tend to be more reliable. Secondly, compared with the simulated CIPRES datasets, its multiple sub-datasets with varying similarities allow for the identification of MSA tools less influenced by different similarities, ensuring broad applicability of the screening results. And finally, compared to the 16S-like rRNA datasets, 23S-like rRNA possesses longer sequence lengths and more noticeable disparities in running time and memory consumption among MSA tools, simplifying the decision-making process.</p>
    <p>As sequencing technology has advanced, there has been a substantial increase in the length and quantity of sequences for a single alignment process. The mt genome, approximately 16 kb in length, and the SARS-CoV-2 genome, spanning around 29 kb, highlight this trend, with over 16 million SARS-CoV-2 genomes sequenced from 193 countries and regions as of July 2023. However, early-developed MSA tools face challenges when dealing with large-scale alignment tasks. For instance, T-Coffee and Dialign-TX experience infinite running times when aligning the SARS-CoV-2_20200301 sub-dataset containing 39 sequences. Although T-Coffee, included in the accurate strategy, delivers high-quality alignment outcomes, its performance is constrained when aligning extensive sequences, limiting the broad applicability of the accurate strategy. Hence, we opted for the newly developed tools HAlign3, Kalign3, MAFFT, and WMSA2 to create a fast strategy to produce initial alignments for large-scale datasets as quickly as possible. The experimental results demonstrate that the four MSA tools chosen via the fast strategy outperform those selected through the accurate strategy in terms of speed and suitability for large-scale data. Particularly when dealing with low sequence similarity, HAlign3 may exhibit high memory usage, but this limitation can be mitigated by reducing the number of parallel threads. Moreover, the decision to opt for four MSA tools in the fast strategy, rather than a smaller selection, stems from the advantage it offers in facilitating effective comparisons on large-scale datasets compared to the accurate strategy. A smaller tool selection could compromise the ability to make meaningful comparisons. Despite not being part of the accurate strategy, Kalign3’s rapid aligning and minimal memory usage on large-scale datasets align with the objectives of the fast strategy tailored for such datasets.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec007">
    <title>Materials and methods</title>
    <sec id="sec008">
      <title>The workflow of TPMA</title>
      <p>TPMA requires two inputs: firstly, a set containing <italic toggle="yes">A</italic><sub>1</sub>, <italic toggle="yes">A</italic><sub>2</sub>,…,<italic toggle="yes">A</italic><sub><italic toggle="yes">n</italic></sub> (the initial alignments of the original sequence dataset <italic toggle="yes">R</italic> by <italic toggle="yes">n</italic> MSA tools) and secondly, the original unaligned sequence dataset <italic toggle="yes">R</italic>. The default output sequence order of MUSCLE3, MUSCLE5, and PCMA is based on the clustering of their guide tree, which often differs from the sequence order of the original dataset. Furthermore, when the original sequences contain characters other than the 26 uppercase and lowercase English letters, MAFFT and MUSCLE3 will align the sequences after deleting these characters. Therefore, TPMA mandates a meticulous examination of the initial alignments (<xref rid="pcbi.1011988.g006" ref-type="fig">Fig 6A</xref>).</p>
      <fig position="float" id="pcbi.1011988.g006">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011988.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>Operational mechanism and illustrative cases of TPMA.</title>
          <p><bold>A</bold> Flowchart of TPMA. Unaligned sequences (<italic toggle="yes">R</italic>) are aligned using <italic toggle="yes">n</italic> MSA tools to generate <italic toggle="yes">n</italic> initial alignments, and these initial alignments along with the <italic toggle="yes">R</italic> are fed into TPMA. TPMA checks the <italic toggle="yes">n</italic> initial alignments by sorting sequences, calculating SP scores, and verifying for consistency, resulting in <italic toggle="yes">m</italic> valid initial alignments. The <italic toggle="yes">m</italic> valid initial alignments are combined in descending order of SP scores. A total of <italic toggle="yes">m-1</italic> combining steps are conducted to obtain the final alignment, denoted as <italic toggle="yes">A</italic><sub><italic toggle="yes">final</italic></sub>. <bold>B</bold> Example of a detailed merging process for two initial alignments. (i) Recode <inline-formula id="pcbi.1011988.e001"><alternatives><graphic xlink:href="pcbi.1011988.e001" id="pcbi.1011988.e001g" position="anchor"/><mml:math id="M1" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1011988.e002"><alternatives><graphic xlink:href="pcbi.1011988.e002" id="pcbi.1011988.e002g" position="anchor"/><mml:math id="M2" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> as binary strings consisting exclusively of 0s and 1s. (ii) <inline-formula id="pcbi.1011988.e003"><alternatives><graphic xlink:href="pcbi.1011988.e003" id="pcbi.1011988.e003g" position="anchor"/><mml:math id="M3" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1011988.e004"><alternatives><graphic xlink:href="pcbi.1011988.e004" id="pcbi.1011988.e004g" position="anchor"/><mml:math id="M4" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> are divided into blocks according to the bold column <italic toggle="yes">C</italic><sub><italic toggle="yes">i</italic></sub> (<italic toggle="yes">C</italic><sub>1</sub>, <italic toggle="yes">C</italic><sub>4</sub>, <italic toggle="yes">C</italic><sub>10</sub>, <italic toggle="yes">C</italic><sub>11</sub>, <italic toggle="yes">C</italic><sub>13</sub> and <italic toggle="yes">C</italic><sub>16</sub> for <inline-formula id="pcbi.1011988.e005"><alternatives><graphic xlink:href="pcbi.1011988.e005" id="pcbi.1011988.e005g" position="anchor"/><mml:math id="M5" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>; <italic toggle="yes">C</italic><sub>1</sub>, <italic toggle="yes">C</italic><sub>4</sub>, <italic toggle="yes">C</italic><sub>10</sub>, <italic toggle="yes">C</italic><sub>11</sub>, <italic toggle="yes">C</italic><sub>12</sub> and <italic toggle="yes">C</italic><sub>15</sub> for <inline-formula id="pcbi.1011988.e006"><alternatives><graphic xlink:href="pcbi.1011988.e006" id="pcbi.1011988.e006g" position="anchor"/><mml:math id="M6" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>), which yields six pairs of blocks. Each of these block pairs consists of identical sequence fragments. (iii) Compute the SP scores for these blocks, and then merge the blocks with higher SP values into <italic toggle="yes">A</italic><sub><italic toggle="yes">tmp</italic>1</sub>. <italic toggle="yes">A</italic><sub><italic toggle="yes">tmp</italic>1</sub> encompasses sequences of length 15, structured as follows: block <italic toggle="yes">C</italic><sub>1</sub> with identical scores, blocks <italic toggle="yes">C</italic><sub>2</sub>−<italic toggle="yes">C</italic><sub>4</sub> from <inline-formula id="pcbi.1011988.e007"><alternatives><graphic xlink:href="pcbi.1011988.e007" id="pcbi.1011988.e007g" position="anchor"/><mml:math id="M7" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, blocks <italic toggle="yes">C</italic><sub>5</sub>−<italic toggle="yes">C</italic><sub>10</sub> from <inline-formula id="pcbi.1011988.e008"><alternatives><graphic xlink:href="pcbi.1011988.e008" id="pcbi.1011988.e008g" position="anchor"/><mml:math id="M8" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, block <italic toggle="yes">C</italic><sub>11</sub> with the same score, block <italic toggle="yes">C</italic><sub>12</sub> from <inline-formula id="pcbi.1011988.e009"><alternatives><graphic xlink:href="pcbi.1011988.e009" id="pcbi.1011988.e009g" position="anchor"/><mml:math id="M9" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, and finally, blocks <italic toggle="yes">C</italic><sub>13</sub>−<italic toggle="yes">C</italic><sub>15</sub> from <inline-formula id="pcbi.1011988.e010"><alternatives><graphic xlink:href="pcbi.1011988.e010" id="pcbi.1011988.e010g" position="anchor"/><mml:math id="M10" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>.</p>
        </caption>
        <graphic xlink:href="pcbi.1011988.g006" position="float"/>
      </fig>
      <p>Firstly, TPMA reorders the sequences in each initial alignment <italic toggle="yes">A</italic><sub><italic toggle="yes">i</italic></sub> to match the order of the original dataset <italic toggle="yes">R</italic> and computes the sum of pairs (SP) score for each reordered alignment <inline-formula id="pcbi.1011988.e011"><alternatives><graphic xlink:href="pcbi.1011988.e011.jpg" id="pcbi.1011988.e011g" position="anchor"/><mml:math id="M11" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. Subsequently, the characters except for the 26 uppercase and lowercase English letters are removed from the sequences in <inline-formula id="pcbi.1011988.e012"><alternatives><graphic xlink:href="pcbi.1011988.e012.jpg" id="pcbi.1011988.e012g" position="anchor"/><mml:math id="M12" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <italic toggle="yes">R</italic>, and then the consistency of each <inline-formula id="pcbi.1011988.e013"><alternatives><graphic xlink:href="pcbi.1011988.e013.jpg" id="pcbi.1011988.e013g" position="anchor"/><mml:math id="M13" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> with <italic toggle="yes">R</italic> is checked. The alignments that differ from <italic toggle="yes">R</italic> will be deleted. In the end, we acquire a subset of validated initial alignments, denoted as <inline-formula id="pcbi.1011988.e014"><alternatives><graphic xlink:href="pcbi.1011988.e014.jpg" id="pcbi.1011988.e014g" position="anchor"/><mml:math id="M14" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, where <italic toggle="yes">m</italic>≤<italic toggle="yes">n</italic>.</p>
      <p>Subsequently, we merged all validated initial alignments in descending order according to the SP score. We first combine the two alignments <inline-formula id="pcbi.1011988.e015"><alternatives><graphic xlink:href="pcbi.1011988.e015.jpg" id="pcbi.1011988.e015g" position="anchor"/><mml:math id="M15" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1011988.e016"><alternatives><graphic xlink:href="pcbi.1011988.e016.jpg" id="pcbi.1011988.e016g" position="anchor"/><mml:math id="M16" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> with the highest SP scores to get <italic toggle="yes">A</italic><sub><italic toggle="yes">tmp</italic>1</sub>, then merge <italic toggle="yes">A</italic><sub><italic toggle="yes">tmp</italic>1</sub> and <inline-formula id="pcbi.1011988.e017"><alternatives><graphic xlink:href="pcbi.1011988.e017.jpg" id="pcbi.1011988.e017g" position="anchor"/><mml:math id="M17" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> with the third highest SP score to obtain <italic toggle="yes">A</italic><sub><italic toggle="yes">tmp</italic>2</sub>, and continue this process a total of <italic toggle="yes">m</italic>−1 times to generate the final alignment <italic toggle="yes">A</italic><sub><italic toggle="yes">final</italic></sub>. <italic toggle="yes">A</italic><sub><italic toggle="yes">final</italic></sub> combines blocks with higher SP scores from the initial alignments, resulting in a refined alignment (<xref rid="pcbi.1011988.g006" ref-type="fig">Fig 6A</xref>.)</p>
    </sec>
    <sec id="sec009">
      <title>The combination of two initial alignments</title>
      <p>Our research focuses on partitioning two initial alignments into block pairs with the same sequence fragments, as depicted in <xref rid="pcbi.1011988.g006" ref-type="fig">Fig 6B</xref>, including the following three steps:</p>
    </sec>
    <sec id="sec010">
      <title>Recode the initial alignments</title>
      <p>After checking the initial alignments, the sequences in all the remaining alignments are in the same order but probably inserted with gaps in different positions. TPMA first recodes the remaining alignments by mapping gaps to 0 and all the other characters to 1. This recoding ensures that the base composition of each sequence becomes irrelevant, facilitating the identification of gap insertion positions. As shown in <xref rid="pcbi.1011988.g006" ref-type="fig">Fig 6B</xref><sub>i</sub>, TPMA recodes <inline-formula id="pcbi.1011988.e018"><alternatives><graphic xlink:href="pcbi.1011988.e018.jpg" id="pcbi.1011988.e018g" position="anchor"/><mml:math id="M18" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1011988.e019"><alternatives><graphic xlink:href="pcbi.1011988.e019.jpg" id="pcbi.1011988.e019g" position="anchor"/><mml:math id="M19" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> to obtain binary strings consisting of only 0s and 1s.</p>
    </sec>
    <sec id="sec011">
      <title>Find the cutting sites</title>
      <p>Two pointers, <italic toggle="yes">P</italic><sub>1</sub> and <italic toggle="yes">P</italic><sub>2</sub>, independently traverse their respective recoded alignments and simultaneously record their corresponding "pace," denoted by <italic toggle="yes">pace</italic><sub>1</sub> and <italic toggle="yes">pace</italic><sub>2</sub>. The “pace” is an array that records the cumulative count of "1"s scanned in each sequence up to the current column. (<xref rid="pcbi.1011988.g006" ref-type="fig">Fig 6B</xref><sub>ii</sub>). <italic toggle="yes">position</italic><sub>1</sub> and <italic toggle="yes">position</italic><sub>2</sub> respectively, keep track of the current column in the alignments where pointers <italic toggle="yes">P</italic><sub>1</sub> and <italic toggle="yes">P</italic><sub>2</sub> are located. Initializing the arrays <italic toggle="yes">pace</italic><sub>1</sub> and <italic toggle="yes">pace</italic><sub>2</sub>, both with length is the number of sequences, to zero, and setting <italic toggle="yes">position</italic><sub>1</sub> and <italic toggle="yes">position</italic><sub>2</sub> to 0 indicates that the two pointers are at column 0 and in their initial state.</p>
      <p>Move a pointer arbitrarily. If <italic toggle="yes">P</italic><sub>1</sub> scans first, when the pace of <italic toggle="yes">P</italic><sub>1</sub> is greater (any number in <italic toggle="yes">pace</italic><sub>1</sub> is greater than the corresponding number in <italic toggle="yes">pace</italic><sub>2</sub> in the same index) than that of <italic toggle="yes">P</italic><sub>2</sub>, <italic toggle="yes">P</italic><sub>1</sub> stops scanning and <italic toggle="yes">P</italic><sub>2</sub> starts to scan. Similarly, if the pace of <italic toggle="yes">P</italic><sub>2</sub> becomes greater than that of <italic toggle="yes">P</italic><sub>1</sub>, <italic toggle="yes">P</italic><sub>2</sub> stops scanning, and <italic toggle="yes">P</italic><sub>1</sub> continues to scan. Repeat this process alternately until both pointers (<italic toggle="yes">P</italic><sub>1</sub> and <italic toggle="yes">P</italic><sub>2</sub>) have scanned all the columns in their respective alignments. When the pace is the same, the current columns (<italic toggle="yes">position</italic><sub>1</sub> and <italic toggle="yes">position</italic><sub>2</sub>) of <italic toggle="yes">P</italic><sub>1</sub> and <italic toggle="yes">P</italic><sub>2</sub> represent the cutting sites corresponding to the two alignments (the columns with the bold number in <xref rid="pcbi.1011988.g006" ref-type="fig">Fig 6B</xref><sub>ii</sub>). Assuming the sequence lengths of recoded <italic toggle="yes">Seq</italic><sub>1</sub> and <italic toggle="yes">Seq</italic><sub>2</sub> are n and m respectively, where <italic toggle="yes">n</italic> is less than <italic toggle="yes">m</italic>, the time complexity of completing the finding cutting point algorithm is <italic toggle="yes">O</italic>(<italic toggle="yes">max</italic>(<italic toggle="yes">n</italic>, <italic toggle="yes">m</italic>)), specifically <italic toggle="yes">O</italic>(<italic toggle="yes">n</italic>). The pseudocode for finding cutting sites is shown in Algorithm 1.</p>
      <p specific-use="line"><bold>Algorithm 1</bold> Find the cutting sites</p>
      <p specific-use="line"><bold>Input:</bold> two recoded alignments <italic toggle="yes">Seq</italic><sub>1</sub> and <italic toggle="yes">Seq</italic><sub>2</sub>, both are DNA or RNA sequences with the same sequence order.</p>
      <p specific-use="line"><bold>Output:</bold> two lists of cutting sites <italic toggle="yes">L</italic><sub>1</sub> and <italic toggle="yes">L</italic><sub>2</sub></p>
      <p specific-use="line"><bold>Function</bold> CUTTING_SITES (<italic toggle="yes">Seq</italic><sub>1</sub>, <italic toggle="yes">Seq</italic><sub>2</sub>)</p>
      <p specific-use="line"> Let <italic toggle="yes">L</italic><sub>1</sub> and <italic toggle="yes">L</italic><sub>2</sub> be the new lists</p>
      <p specific-use="line">Let <italic toggle="yes">P</italic><sub>1</sub> and <italic toggle="yes">P</italic><sub>2</sub> be the two pointers of <italic toggle="yes">Seq</italic><sub>1</sub> and <italic toggle="yes">Seq</italic><sub>2</sub>, respectively</p>
      <p specific-use="line">Let <italic toggle="yes">pace</italic><sub>1</sub> and <italic toggle="yes">pace</italic><sub>2</sub> be the recording of the “pace” of <italic toggle="yes">P</italic><sub>1</sub> and <italic toggle="yes">P</italic><sub>2</sub>,</p>
      <p specific-use="line">Let <italic toggle="yes">position</italic><sub>1</sub> and <italic toggle="yes">position</italic><sub>2</sub> be the recording of the current positions of <italic toggle="yes">P</italic><sub>1</sub> and <italic toggle="yes">P</italic><sub>2</sub>, respectively</p>
      <p specific-use="line">Let <italic toggle="yes">col</italic><sub>1</sub> be the columns count of <italic toggle="yes">Seq</italic><sub>1</sub>, <italic toggle="yes">col</italic><sub>2</sub> be the columns count of <italic toggle="yes">Seq</italic><sub>2</sub></p>
      <p specific-use="line"> <bold>do{</bold></p>
      <p specific-use="line">  <bold>for (<italic toggle="yes">position</italic><sub>1</sub>! = <italic toggle="yes">col</italic><sub>1</sub> and</bold>
<italic toggle="yes">pace</italic><sub>2</sub>&lt;<italic toggle="yes">pace</italic><sub>1</sub>
<bold>= = FALSE)</bold></p>
      <p specific-use="line">  <bold>if (++</bold><italic toggle="yes">pace</italic><sub>1</sub> = = <italic toggle="yes">pace</italic><sub>2</sub><bold>)</bold></p>
      <p specific-use="line">    <italic toggle="yes">L</italic><sub>1</sub>.puch_back(<italic toggle="yes">position</italic><sub>1</sub>)</p>
      <p specific-use="line">    <italic toggle="yes">L</italic><sub>2</sub>.puch_back(<italic toggle="yes">position</italic><sub>2</sub>)</p>
      <p specific-use="line">   <bold>end if</bold></p>
      <p specific-use="line">   <bold>end for</bold></p>
      <p specific-use="line">  <bold>for (<italic toggle="yes">position</italic><sub>2</sub>! = <italic toggle="yes">col</italic><sub>2</sub> and</bold>
<italic toggle="yes">pace</italic><sub>1</sub>&lt;<italic toggle="yes">pace</italic><sub>2</sub>
<bold>= = FALSE)</bold></p>
      <p specific-use="line">  <bold>if (++</bold>
<italic toggle="yes">pace</italic><sub>2</sub> = = <italic toggle="yes">pace</italic><sub>1</sub><bold>)</bold></p>
      <p specific-use="line">    <italic toggle="yes">L</italic><sub>1</sub>.puch_back(<italic toggle="yes">position</italic><sub>1</sub>)</p>
      <p specific-use="line">    <italic toggle="yes">L</italic><sub>2</sub>.puch_back(<italic toggle="yes">position</italic><sub>2</sub>)</p>
      <p specific-use="line">   <bold>end if</bold></p>
      <p specific-use="line">   <bold>end for</bold></p>
      <p specific-use="line">  <bold>}while (<italic toggle="yes">position</italic><sub>1</sub>! = <italic toggle="yes">col</italic><sub>1</sub></bold> or <bold><italic toggle="yes">position</italic><sub>2</sub>! = <italic toggle="yes">col</italic><sub>2</sub>)</bold></p>
      <p specific-use="line">  <bold>return <italic toggle="yes">L</italic><sub>1</sub></bold> and <italic toggle="yes">L</italic><sub>2</sub></p>
      <p specific-use="line">
        <bold>end Function</bold>
      </p>
    </sec>
    <sec id="sec012">
      <title>Choose superior blocks based on the SP score</title>
      <p>According to all the identified cutting sites, the two initial alignments are partitioned into an equal number of blocks, and the blocks containing identical sequence fragments are referred to as one block pair. After calculating the SP score of each block pair, the block with the higher SP score is merged into the combined alignment (<xref rid="pcbi.1011988.g006" ref-type="fig">Fig 6B</xref><sub>iii</sub>). The SP score is calculated as shown in <xref rid="pcbi.1011988.e020" ref-type="disp-formula">Eq 1</xref>.</p>
      <disp-formula id="pcbi.1011988.e020">
        <alternatives>
          <graphic xlink:href="pcbi.1011988.e020.jpg" id="pcbi.1011988.e020g" position="anchor"/>
          <mml:math id="M20" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mi>S</mml:mi>
              <mml:mi>P</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mo stretchy="false">∑</mml:mo>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>L</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mrow>
                  <mml:mi>f</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </alternatives>
        <label>(1)</label>
      </disp-formula>
      <p>The SP score is obtained by summing the scores of the <italic toggle="yes">L</italic> columns, where <italic toggle="yes">f</italic>(<italic toggle="yes">k</italic>) represents the score of the <italic toggle="yes">k</italic>-th column, and <italic toggle="yes">L</italic> denotes the total number of columns in the block. The calculation method for <italic toggle="yes">f</italic>(<italic toggle="yes">k</italic>) is shown in <xref rid="pcbi.1011988.e021" ref-type="disp-formula">Eq 2</xref>.</p>
      <disp-formula id="pcbi.1011988.e021">
        <alternatives>
          <graphic xlink:href="pcbi.1011988.e021.jpg" id="pcbi.1011988.e021g" position="anchor"/>
          <mml:math id="M21" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mi>f</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mrow>
                <mml:mi>k</mml:mi>
              </mml:mrow>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mo stretchy="false">∑</mml:mo>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mo stretchy="false">∑</mml:mo>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo>≠</mml:mo>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mrow>
                      <mml:mi>s</mml:mi>
                      <mml:mi>c</mml:mi>
                      <mml:mi>o</mml:mi>
                      <mml:mi>r</mml:mi>
                      <mml:mi>e</mml:mi>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mrow>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </alternatives>
        <label>(2)</label>
      </disp-formula>
      <p>Here, <italic toggle="yes">N</italic> is the number of sequences in the block, and <italic toggle="yes">score</italic>(<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>) represents the score of aligned pair in the <italic toggle="yes">i</italic>-th row and <italic toggle="yes">j</italic>-th row. If the aligned pair is matched (both characters are letters and they are the same), a score of 1 is assigned. For mismatched pairs (both characters are letters but different), a score of -1 is given. When one character is a letter and the other is a gap, a score of -2 is provided. Otherwise, a score of 0 is assigned.</p>
    </sec>
    <sec id="sec013">
      <title>Datasets</title>
      <p>The experiments utilized ten nucleotide datasets, comprising six real datasets and four simulated datasets (<xref rid="pcbi.1011988.s004" ref-type="supplementary-material">S1 Table</xref>). Challenges arose for certain Multiple Sequence Alignment (MSA) tools, such as Dialign-TX [<xref rid="pcbi.1011988.ref013" ref-type="bibr">13</xref>] and T-Coffee [<xref rid="pcbi.1011988.ref014" ref-type="bibr">14</xref>], in aligning datasets with extended sequence lengths or numerous sequences. We conducted multiple random samplings or partitioned the real dataset to reduce its size, generating multiple sub-datasets as test datasets. This approach helped eliminate the randomness and variability of the experimental results.</p>
      <p>The six real datasets consist of five DNA datasets and one RNA dataset. (1) The human mitochondrial (mt) genomes dataset comprised 672 human mitochondrial genomes, ranging from a maximum length of 16579 bp to a minimum of 16556 bp [<xref rid="pcbi.1011988.ref015" ref-type="bibr">15</xref>]. We created sub-datasets by randomly selecting 30 sequences without replacement, and this procedure was repeated four times (<xref rid="pcbi.1011988.s005" ref-type="supplementary-material">S2 Table</xref>). (2) The hyper-variable segment II (HVS-II) dataset consisted of 100 sequences extracted from the HVS-II control region of the central European human mitochondrial genomes [<xref rid="pcbi.1011988.ref016" ref-type="bibr">16</xref>], retrieved from the GenBank database (accession numbers: KF601094-KF601193). The dataset was subsequently partitioned into ten sub-datasets (<xref rid="pcbi.1011988.s006" ref-type="supplementary-material">S3 Table</xref>). (3) The 16S ribosomal RNA (rRNA) dataset encompassed 108,413 DNA sequences encoding RNA found in bacteria and archaea, with an approximate length of 1.5 kb [<xref rid="pcbi.1011988.ref017" ref-type="bibr">17</xref>]. We created eight sub-datasets for this dataset, each containing 100 sequences sampled randomly without replacement (<xref rid="pcbi.1011988.s007" ref-type="supplementary-material">S4 Table</xref>). (4) The 23S rRNA dataset encompassed 641 sequences of Mycobacterium 23S rRNA, sourced from the SILVA rRNA database (<ext-link xlink:href="http://www.arb-silva.de/" ext-link-type="uri">http://www.arb-silva.de/</ext-link>) for bacteria, archaea, and eukaryotes. Spanning lengths from 1909 to 3485 bp, these sequences were partitioned into ten groups (<xref rid="pcbi.1011988.s008" ref-type="supplementary-material">S5 Table</xref>). (5) The respiratory syndrome coronavirus 2 (SARS-CoV-2) is an RNA virus that causes the COVID-19 pandemic. Two datasets [<xref rid="pcbi.1011988.ref018" ref-type="bibr">18</xref>] were derived from the GISAID website (<ext-link xlink:href="https://www.gisaid.org/" ext-link-type="uri">https://www.gisaid.org</ext-link>, updated November 11, 2021.) The SARS-CoV-2_20200301 datasets contain 156 sequences (29409 to 29927 bp) collected on March 1, 2020, and were divided into four sub-datasets (<xref rid="pcbi.1011988.s009" ref-type="supplementary-material">S6 Table</xref>). (6) The SARS-CoV-2_20200417 datasets feature 1020 sequences (29409 to 29927 bp) collected on April 17, 2020. From this, we randomly selected 100 sequences without replacement to create a sub-dataset, and this process was repeated four times (<xref rid="pcbi.1011988.s010" ref-type="supplementary-material">S7 Table</xref>).</p>
      <p>Two of the four simulated datasets were generated using hierarchical tree simulation to obtain 16S-like and 23S-like rRNA datasets. This simulation was carried out using INDELible v1.03 [<xref rid="pcbi.1011988.ref019" ref-type="bibr">19</xref>], and the substitution models were based on estimates obtained from 3000 16S rRNA and 641 Mycobacterium 23S rRNA alignments (as previously mentioned), utilizing IQ-TREE v2.2.0-beta [<xref rid="pcbi.1011988.ref020" ref-type="bibr">20</xref>]. One hundred 16S rRNA sequences and Mycobacterium 23S rRNA sequences, randomly chosen from the datasets as mentioned above, were aligned to construct the simulation trees. Subsequently, the process of generating the simulation 16S-like and 23S-like datasets was rooted in these two simulation trees. Each tree’s branch length was assigned a random value from 0 to 1 (NON-ULTRAMETRIC). The simulated sequence lengths were set at 1.5 kb for 16S-like rRNA and 4 kb for 23S-like rRNA. The indel model parameter used was LAV 5 50, with insertion and deletion rates of 0.01 and 0.1, respectively. To simulate datasets with varying mean similarities, the tree length (sum of branch lengths) was adjusted to achieve mean similarities of 99%, 98%, 97%, 96%, 95%, 94%, 93%, 92%, 91%, 90%, 85%, 80%, 75%, and 70%. The mean similarity represents the average of similarities between any two sequences within the dataset (<ext-link xlink:href="https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py" ext-link-type="uri">https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py</ext-link>), determined by the percentage of matched characters in their pairwise alignments conducted using MAFFT. Detailed information regarding these two sets of 14 sub-datasets can be found in <xref rid="pcbi.1011988.s011" ref-type="supplementary-material">S8 Table</xref>. Every sub-dataset included three replicates, each containing 100 simulated sequences. The mean length is the average of the average sequence lengths from the three replicates.</p>
      <p>The remaining two datasets are simulated CIPRES-128 and CIPRES-256 rRNA datasets evolved from the same root rRNA sequence on the trees featuring 128 and 256 taxa, respectively (<xref rid="pcbi.1011988.s012" ref-type="supplementary-material">S9 Table</xref>). These datasets were downloaded from trials 1 to 10 on the CIPRES SIMULATION DATA website (<ext-link xlink:href="https://kim.bio.upenn.edu/software/csd.shtml" ext-link-type="uri">https://kim.bio.upenn.edu/software/csd.shtml</ext-link>). The simulation parameters were adjusted to ensure that the simulated sequences mirror authentic small subunit rRNA (ssu rRNA) sequences regarding sequence identity, indel count, the ratio between substitutions and indels, and other relevant characteristics. The datasets were formatted in NEXUS format. The Nexus to Fasta Sequence Convert tool (<ext-link xlink:href="http://www.bugaco.com/" ext-link-type="uri">http://www.bugaco.com</ext-link>) was utilized for conversion into FASTA format to obtain the reference sequences. Subsequently, gaps were removed from the reference to derive the unaligned test datasets.</p>
      <p>Sequence similarity is computed for every dataset as the ratio of matching base pairs in all pairwise alignments (generated using MAFFT) within a sub-dataset. The script for this computation is available on <ext-link xlink:href="https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py" ext-link-type="uri">https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py</ext-link>. Lastly, employ Python’s Matplotlib library to generate a histogram depicting the distribution of sequence similarity.</p>
    </sec>
    <sec id="sec014">
      <title>Software versions and operating parameters involved in this study</title>
      <p>Furthermore, the experiment involved initial alignments obtained from eleven MSA tools: ClustalW2 [<xref rid="pcbi.1011988.ref021" ref-type="bibr">21</xref>], Dialign-TX, HAlign3 [<xref rid="pcbi.1011988.ref022" ref-type="bibr">22</xref>], Kalign3 [<xref rid="pcbi.1011988.ref023" ref-type="bibr">23</xref>], MAFFT, MUSCLE3, MUSCLE5 [<xref rid="pcbi.1011988.ref024" ref-type="bibr">24</xref>], PCMA [<xref rid="pcbi.1011988.ref025" ref-type="bibr">25</xref>], POA[<xref rid="pcbi.1011988.ref026" ref-type="bibr">26</xref>], T-Coffee, and WMSA2[<xref rid="pcbi.1011988.ref027" ref-type="bibr">27</xref>]. The identical software versions and running commands were used for obtaining initial alignments by TPMA and M-Coffee, with detailed information provided in <xref rid="pcbi.1011988.s013" ref-type="supplementary-material">S10 Table</xref>. In addition, the running commands of TPMA and M-Coffee merging the initial alignment from different MSA tools are shown in <xref rid="pcbi.1011988.s014" ref-type="supplementary-material">S11 Table</xref>.</p>
    </sec>
    <sec id="sec015">
      <title>Evaluation and experimental environment</title>
      <p>When evaluating alignment quality for the six real datasets, we employed the average sum of pairs (SP) score, denoted as aSP score, which represents the SP score divided by the number of sequence pairs, for accuracy assessment. The penalty parameters remained consistent with those detailed in the Methods 4.2.3 section. Regarding the four simulated datasets, in addition to the aSP score, we incorporated the Q score (the number of correctly aligned base pairs divided by the aligned pairs in the reference) and the TC score (the number of correctly aligned columns divided by aligned columns in the reference), both computed using the qscore program (<ext-link xlink:href="http://www.drive5.com/bench/" ext-link-type="uri">http://www.drive5.com/bench/</ext-link>), to gauge the deviation between alignment outcomes and reference alignments. All experiments were conducted on a server running the Ubuntu Linux operating system, equipped with an Intel(R) Xeon(R) Platinum 8168 CPU operating at a clock speed of 2.7 GHz and 1TB RAM.</p>
    </sec>
  </sec>
  <sec id="sec016" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1011988.s001" position="float" content-type="local-data">
      <label>S1 Fig</label>
      <caption>
        <title>The aSP score of the combination by sequential merging of initial alignments from MSA tools based on ranking by aSP, Q, and TC scores.</title>
        <p>The 14 subplots illustrate the results of 23S-like rRNA sub- datasets with different similarities: 99%, 98%, 97%, 96%, 95%, 94%, 93%, 92%, 91%, 90%, 85%, 80%, 75%, 70%. The points on each subplot represent the averages of three replicates. The aSP score-based ranking (the orange line) reveals that the Top 2 combination consists of T-Coffee and MUSCLE3, followed by the Top 3 combination of T-Coffee, MUSCLE3, and MAFFT, and so forth for subsequent combinations. Regarding Q scores ranking (the blue line), the Top 2 combination features T-Coffee and MUSCLE3, followed by the Top 3 combination of T-Coffee, MUSCLE3, and ClustalW2, and so on. When ranked by TC scores (the red line), the Top 2 combination consists of ClustalW2 and PCMA, with the Top 3 being ClustalW2, PCMA, and T-Coffee, and so forth.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s001.eps"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s002" position="float" content-type="local-data">
      <label>S2 Fig</label>
      <caption>
        <title>The Q score of the combination by sequential merging of initial alignments from MSA tools based on ranking by aSP, Q, and TC scores.</title>
        <p>The plots depict the Q scores obtained by merging different initial alignment combinations across 14 23S-like rRNA sub-datasets. Each point displays the average of three replicates within the sub-dataset. The merged process is the same as described in. <xref rid="pcbi.1011988.s001" ref-type="supplementary-material">S1 Fig</xref> legend.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s002.eps"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s003" position="float" content-type="local-data">
      <label>S3 Fig</label>
      <caption>
        <title>The TC score of the combination by sequential merging of initial alignments from MSA tools based on ranking by average SP, Q, and TC scores.</title>
        <p>The TC scores from combining various initial alignment combinations across the 23S-like rRNA sub-datasets are shown in the 14 subplots. These sub-datasets exhibit different similarities: 99%, 98%, 97%, 96%, 95%, 94%, 93%, 92%, 91%, 90%, 85%, 80%, 75%, 70%. All points on each subplot are the averages of three replicates. The merging process follows the same steps as described in <xref rid="pcbi.1011988.s001" ref-type="supplementary-material">S1 Fig</xref> legend.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s003.eps"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s004" position="float" content-type="local-data">
      <label>S1 Table</label>
      <caption>
        <title>The summary of datasets.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s004.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s005" position="float" content-type="local-data">
      <label>S2 Table</label>
      <caption>
        <title>The detailed information of human mitochondrial genomes sub-datasets.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s005.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s006" position="float" content-type="local-data">
      <label>S3 Table</label>
      <caption>
        <title>The detailed information of human mitochondrial HVS-II sub-datasets.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s006.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s007" position="float" content-type="local-data">
      <label>S4 Table</label>
      <caption>
        <title>The detailed information of 16S rRNA sub-datasets.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s007.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s008" position="float" content-type="local-data">
      <label>S5 Table</label>
      <caption>
        <title>The detailed information of 23S rRNA sub-datasets.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s008.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s009" position="float" content-type="local-data">
      <label>S6 Table</label>
      <caption>
        <title>The detailed information of SARS-CoV-2_20200301 sub-datasets.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s009.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s010" position="float" content-type="local-data">
      <label>S7 Table</label>
      <caption>
        <title>The detailed information of SARS-CoV-2_20200417 sub-datasets.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s010.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s011" position="float" content-type="local-data">
      <label>S8 Table</label>
      <caption>
        <title>The detailed information of 16S-like and 23S-like rRNA of 14 sub-datasets.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s011.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s012" position="float" content-type="local-data">
      <label>S9 Table</label>
      <caption>
        <title>The detailed information of simulated CIPRES-128 and CIPRES-256 rRNA sub-datasets.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s012.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s013" position="float" content-type="local-data">
      <label>S10 Table</label>
      <caption>
        <title>Version information and operating parameters of the involved tools.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s013.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s014" position="float" content-type="local-data">
      <label>S11 Table</label>
      <caption>
        <title>The running command of TPMA and M-Coffee.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s014.xlsx"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We are incredibly grateful to Dr. Cedric Notredame for his advice on using the M-Coffee package with MUSCLE5. Our appreciation extends to Franck A.P. Kouassi for his assistance in debugging the ReformAlign, Biffon Manyura Momanyi for engaging in valuable discussions, and Juntao Chen for his support in debugging WMSA2. Special acknowledgment is given to our other esteemed group members: Yanming Wei and Qinzhong Tian, whose critical insights greatly contributed to the preparation.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1011988.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Chao</surname><given-names>J</given-names></name>, <name><surname>Tang</surname><given-names>F</given-names></name>, <name><surname>Xu</surname><given-names>L</given-names></name>. <article-title>Developments in algorithms for sequence alignment: a review.</article-title><source>Biomolecules</source>. <year>2022</year>;<volume>12</volume>(<issue>4</issue>):<fpage>546</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3390/biom12040546</pub-id><?supplied-pmid 35454135?><pub-id pub-id-type="pmid">35454135</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Katoh</surname><given-names>K</given-names></name>, <name><surname>Standley</surname><given-names>DM</given-names></name>. <article-title>MAFFT multiple sequence alignment software version 7: improvements in performance and usability</article-title>. <source>Mol Biol Evol</source>. <year>2013</year>;<volume>30</volume>(<issue>4</issue>):<fpage>772</fpage>–<lpage>80</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/mst010</pub-id><?supplied-pmid 23329690?><pub-id pub-id-type="pmid">23329690</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Edgar</surname><given-names>RC</given-names></name>. <article-title>MUSCLE: multiple sequence alignment with high accuracy and high throughput</article-title>. <source>Nucleic Acids Res</source>. <year>2004</year>;<volume>32</volume>(<issue>5</issue>):<fpage>1792</fpage>–<lpage>7</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkh340</pub-id><?supplied-pmid 15034147?><pub-id pub-id-type="pmid">15034147</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Mokaddem</surname><given-names>A</given-names></name>, <name><surname>Hadj</surname><given-names>AB</given-names></name>, <name><surname>Elloumi</surname><given-names>M</given-names></name>. <article-title>Refin-Align: New Refinement Algorithm for Multiple Sequence Alignment.</article-title><source>Informatica</source>. <year>2019</year>;<volume>43</volume>(<issue>4</issue>).</mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Chakrabarti</surname><given-names>S</given-names></name>, <name><surname>Lanczycki</surname><given-names>CJ</given-names></name>, <name><surname>Panchenko</surname><given-names>AR</given-names></name>, <name><surname>Przytycka</surname><given-names>TM</given-names></name>, <name><surname>Thiessen</surname><given-names>PA</given-names></name>, <name><surname>Bryant</surname><given-names>SH</given-names></name>. <article-title>Refining multiple sequence alignments with conserved core regions</article-title>. <source>Nucleic Acids Res</source>. <year>2006</year>;<volume>34</volume>(<issue>9</issue>):<fpage>2598</fpage>–<lpage>606</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkl274</pub-id><?supplied-pmid 16707662?><pub-id pub-id-type="pmid">16707662</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Wallace</surname><given-names>IM</given-names></name>, <name><surname>Higgins</surname><given-names>DG</given-names></name>. <article-title>Evaluation of iterative alignment algorithms for multiple alignment</article-title>. <source>Bioinformatics</source>. <year>2005</year>;<volume>21</volume>(<issue>8</issue>):<fpage>1408</fpage>–<lpage>14</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/bti159</pub-id><?supplied-pmid 15564300?><pub-id pub-id-type="pmid">15564300</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Lyras</surname><given-names>DP</given-names></name>, <name><surname>Metzler</surname><given-names>D</given-names></name>. <article-title>ReformAlign: improved multiple sequence alignments using a profile-based meta-alignment approach.</article-title><source>BMC Bioinform</source>. <year>2014</year>;<volume>15</volume>:<fpage>1</fpage>–<lpage>18</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1471-2105-15-265</pub-id><?supplied-pmid 25099134?><pub-id pub-id-type="pmid">25099134</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Bucka-Lassen</surname><given-names>K</given-names></name>, <name><surname>Caprani</surname><given-names>O</given-names></name>, <name><surname>Hein</surname><given-names>J</given-names></name>. <article-title>Combining many multiple alignments in one improved alignment</article-title>. <source>Bioinformatics (Oxford, England).</source><year>1999</year>;<volume>15</volume>(<issue>2</issue>):<fpage>122</fpage>–<lpage>30</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/15.2.122</pub-id><?supplied-pmid 10089197?><pub-id pub-id-type="pmid">10089197</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Collingridge</surname><given-names>PW</given-names></name>, <name><surname>Kelly</surname><given-names>S</given-names></name>. <article-title>MergeAlign: improving multiple sequence alignment performance by dynamic reconstruction of consensus multiple sequence alignments.</article-title><source>BMC Bioinform</source>. <year>2012</year>;<volume>13</volume>:<fpage>1</fpage>–<lpage>10</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1471-2105-13-117</pub-id><?supplied-pmid 22646090?><pub-id pub-id-type="pmid">22646090</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Muller</surname><given-names>J</given-names></name>, <name><surname>Creevey</surname><given-names>CJ</given-names></name>, <name><surname>Thompson</surname><given-names>JD</given-names></name>, <name><surname>Arendt</surname><given-names>D</given-names></name>, <name><surname>Bork</surname><given-names>P</given-names></name>. <article-title>AQUA: automated quality improvement for multiple sequence alignments</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>2</issue>):<fpage>263</fpage>–<lpage>5</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btp651</pub-id><?supplied-pmid 19926669?><pub-id pub-id-type="pmid">19926669</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Thompson</surname><given-names>JD</given-names></name>, <name><surname>Thierry</surname><given-names>J-C</given-names></name>, <name><surname>Poch</surname><given-names>O</given-names></name>. <article-title>RASCAL: rapid scanning and correction of multiple sequence alignments</article-title>. <source>Bioinformatics</source>. <year>2003</year>;<volume>19</volume>(<issue>9</issue>):<fpage>1155</fpage>–<lpage>61</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btg133</pub-id><?supplied-pmid 12801878?><pub-id pub-id-type="pmid">12801878</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Wallace</surname><given-names>IM</given-names></name>, <name><surname>O’sullivan</surname><given-names>O</given-names></name>, <name><surname>Higgins</surname><given-names>DG</given-names></name>, <name><surname>Notredame</surname><given-names>C</given-names></name>. <article-title>M-Coffee: combining multiple sequence alignment methods with T-Coffee</article-title>. <source>Nucleic Acids Res</source>. <year>2006</year>;<volume>34</volume>(<issue>6</issue>):<fpage>1692</fpage>–<lpage>9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkl091</pub-id><?supplied-pmid 16556910?><pub-id pub-id-type="pmid">16556910</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Subramanian</surname><given-names>AR</given-names></name>, <name><surname>Kaufmann</surname><given-names>M</given-names></name>, <name><surname>Morgenstern</surname><given-names>B</given-names></name>. <article-title>DIALIGN-TX: greedy and progressive approaches for segment-based multiple sequence alignment</article-title>. <source>Algorithms Mol Biol</source>. <year>2008</year>;<volume>3</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>11</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1748-7188-3-6</pub-id><?supplied-pmid 18505568?><pub-id pub-id-type="pmid">18218120</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Notredame</surname><given-names>C</given-names></name>, <name><surname>Higgins</surname><given-names>DG</given-names></name>, <name><surname>Heringa</surname><given-names>J</given-names></name>. <article-title>T-Coffee: A novel method for fast and accurate multiple sequence alignment</article-title>. <source>J Mol Biol</source>. <year>2000</year>;<volume>302</volume>(<issue>1</issue>):<fpage>205</fpage>–<lpage>17</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1006/jmbi.2000.4042</pub-id><?supplied-pmid 10964570?><pub-id pub-id-type="pmid">10964570</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Tanaka</surname><given-names>M</given-names></name>, <name><surname>Cabrera</surname><given-names>VM</given-names></name>, <name><surname>González</surname><given-names>AM</given-names></name>, <name><surname>Larruga</surname><given-names>JM</given-names></name>, <name><surname>Takeyasu</surname><given-names>T</given-names></name>, <name><surname>Fuku</surname><given-names>N</given-names></name>, <etal>et al</etal>. <article-title>Mitochondrial genome variation in eastern Asia and the peopling of Japan</article-title>. <source>Genome Res</source>. <year>2004</year>;<volume>14</volume>(<issue>10a</issue>):<fpage>1832</fpage>–<lpage>50</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1101/gr.2286304</pub-id><?supplied-pmid 15466285?><pub-id pub-id-type="pmid">15466285</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Brandt</surname><given-names>G</given-names></name>, <name><surname>Haak</surname><given-names>W</given-names></name>, <name><surname>Adler</surname><given-names>CJ</given-names></name>, <name><surname>Roth</surname><given-names>C</given-names></name>, <name><surname>Szécsényi-Nagy</surname><given-names>A</given-names></name>, <name><surname>Karimnia</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Ancient DNA reveals key stages in the formation of central European mitochondrial genetic diversity</article-title>. <source>Science</source>. <year>2013</year>;<volume>342</volume>(<issue>6155</issue>):<fpage>257</fpage>–<lpage>61</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.1241844</pub-id><?supplied-pmid 24115443?><pub-id pub-id-type="pmid">24115443</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>DeSantis</surname><given-names>TZ</given-names></name>, <name><surname>Hugenholtz</surname><given-names>P</given-names></name>, <name><surname>Keller</surname><given-names>K</given-names></name>, <name><surname>Brodie</surname><given-names>EL</given-names></name>, <name><surname>Larsen</surname><given-names>N</given-names></name>, <name><surname>Piceno</surname><given-names>YM</given-names></name>, <etal>et al</etal>. <article-title>NAST: a multiple sequence alignment server for comparative analysis of 16S rRNA genes</article-title>. <source>Nucleic Acids Res</source>. <year>2006</year>;<volume>34</volume>(<issue>suppl_2</issue>):<fpage>W394</fpage>–<lpage>W9</lpage>.<pub-id pub-id-type="pmid">16845035</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Wei</surname><given-names>Y</given-names></name>, <name><surname>Zou</surname><given-names>Q</given-names></name>, <name><surname>Tang</surname><given-names>F</given-names></name>, <name><surname>Yu</surname><given-names>L</given-names></name>. <article-title>WMSA: a novel method for multiple sequence alignment of DNA sequences</article-title>. <source>Bioinformatics</source>. <year>2022</year>;<volume>38</volume>(<issue>22</issue>):<fpage>5019</fpage>–<lpage>25</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btac658</pub-id><?supplied-pmid 36179076?><pub-id pub-id-type="pmid">36179076</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Fletcher</surname><given-names>W</given-names></name>, <name><surname>Yang</surname><given-names>Z</given-names></name>. <article-title>INDELible: a flexible simulator of biological sequence evolution</article-title>. <source>Mol Biol Evol</source>. <year>2009</year>;<volume>26</volume>(<issue>8</issue>):<fpage>1879</fpage>–<lpage>88</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msp098</pub-id><?supplied-pmid 19423664?><pub-id pub-id-type="pmid">19423664</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Minh</surname><given-names>BQ</given-names></name>, <name><surname>Schmidt</surname><given-names>HA</given-names></name>, <name><surname>Chernomor</surname><given-names>O</given-names></name>, <name><surname>Schrempf</surname><given-names>D</given-names></name>, <name><surname>Woodhams</surname><given-names>MD</given-names></name>, <name><surname>Von Haeseler</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>IQ-TREE 2: new models and efficient methods for phylogenetic inference in the genomic era</article-title>. <source>Mol Biol Evol</source>. <year>2020</year>;<volume>37</volume>(<issue>5</issue>):<fpage>1530</fpage>–<lpage>4</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msaa015</pub-id><?supplied-pmid 32011700?><pub-id pub-id-type="pmid">32011700</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Larkin</surname><given-names>MA</given-names></name>, <name><surname>Blackshields</surname><given-names>G</given-names></name>, <name><surname>Brown</surname><given-names>NP</given-names></name>, <name><surname>Chenna</surname><given-names>R</given-names></name>, <name><surname>McGettigan</surname><given-names>PA</given-names></name>, <name><surname>McWilliam</surname><given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Clustal W and Clustal X version 2.0</article-title>. <source>Bioinformatics</source>. <year>2007</year>;<volume>23</volume>(<issue>21</issue>):<fpage>2947</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btm404</pub-id><?supplied-pmid 17846036?><pub-id pub-id-type="pmid">17846036</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Tang</surname><given-names>F</given-names></name>, <name><surname>Chao</surname><given-names>J</given-names></name>, <name><surname>Wei</surname><given-names>Y</given-names></name>, <name><surname>Yang</surname><given-names>F</given-names></name>, <name><surname>Zhai</surname><given-names>Y</given-names></name>, <name><surname>Xu</surname><given-names>L</given-names></name>, <etal>et al</etal>. <article-title>HAlign 3: fast multiple alignment of ultra-large numbers of similar DNA/RNA sequences</article-title>. <source>Mol Biol Evol</source>. <year>2022</year>;<volume>39</volume>(<issue>8</issue>):<fpage>msac166</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msac166</pub-id><?supplied-pmid 35915051?><pub-id pub-id-type="pmid">35915051</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Lassmann</surname><given-names>T</given-names></name>. <article-title>Kalign 3: multiple sequence alignment of large datasets.</article-title><source>Bioinformatics</source>. <year>2019</year>;<volume>36</volume>(<issue>6</issue>):<fpage>1928</fpage>–<lpage>9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btz795</pub-id><?supplied-pmid 31665271?><pub-id pub-id-type="pmid">31665271</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Edgar</surname><given-names>RC</given-names></name>. <article-title>Muscle5: High-accuracy alignment ensembles enable unbiased assessments of sequence homology and phylogeny.</article-title><source>Nat Commun</source>. <year>2022</year>;<volume>13</volume>(<issue>1</issue>):<fpage>6968</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-022-34630-w</pub-id><?supplied-pmid 36379955?><pub-id pub-id-type="pmid">36379955</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Pei</surname><given-names>J</given-names></name>, <name><surname>Sadreyev</surname><given-names>R</given-names></name>, <name><surname>Grishin</surname><given-names>NV</given-names></name>. <article-title>PCMA: fast and accurate multiple sequence alignment based on profile consistency</article-title>. <source>Bioinformatics</source>. <year>2003</year>;<volume>19</volume>(<issue>3</issue>):<fpage>427</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btg008</pub-id><?supplied-pmid 12584134?><pub-id pub-id-type="pmid">12584134</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Lee</surname><given-names>C</given-names></name>, <name><surname>Grasso</surname><given-names>C</given-names></name>, <name><surname>Sharlow</surname><given-names>MF</given-names></name>. <article-title>Multiple sequence alignment using partial order graphs</article-title>. <source>Bioinformatics</source>. <year>2002</year>;<volume>18</volume>(<issue>3</issue>):<fpage>452</fpage>–<lpage>64</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/18.3.452</pub-id><?supplied-pmid 11934745?><pub-id pub-id-type="pmid">11934745</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>J</given-names></name>, <name><surname>Chao</surname><given-names>J</given-names></name>, <name><surname>Liu</surname><given-names>H</given-names></name>, <name><surname>Yang</surname><given-names>F</given-names></name>, <name><surname>Zou</surname><given-names>Q</given-names></name>, <name><surname>Tang</surname><given-names>F</given-names></name>. <article-title>WMSA 2: a multiple DNA/RNA sequence alignment tool implemented with accurate progressive mode and a fast win-win mode combining the center star and progressive strategies.</article-title><source>Brief Bioinformatics</source>. <year>2023</year>:<fpage>bbad190</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bib/bbad190</pub-id><?supplied-pmid 37200156?><pub-id pub-id-type="pmid">37200156</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">11008887</article-id>
    <article-id pub-id-type="pmid">38557416</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011988</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-23-01927</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methods</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Computational Techniques</subject>
          <subj-group>
            <subject>Split-Decomposition Method</subject>
            <subj-group>
              <subject>Multiple Alignment Calculation</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Alignment</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>RNA</subject>
              <subj-group>
                <subject>Non-coding RNA</subject>
                <subj-group>
                  <subject>Ribosomal RNA</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Ribosomes</subject>
            <subj-group>
              <subject>Ribosomal RNA</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Cell biology</subject>
          <subj-group>
            <subject>Cellular structures and organelles</subject>
            <subj-group>
              <subject>Ribosomes</subject>
              <subj-group>
                <subject>Ribosomal RNA</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Bioenergetics</subject>
            <subj-group>
              <subject>Energy-Producing Organelles</subject>
              <subj-group>
                <subject>Mitochondria</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Structures and Organelles</subject>
            <subj-group>
              <subject>Energy-Producing Organelles</subject>
              <subj-group>
                <subject>Mitochondria</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Viruses</subject>
            <subj-group>
              <subject>RNA viruses</subject>
              <subj-group>
                <subject>Coronaviruses</subject>
                <subj-group>
                  <subject>SARS coronavirus</subject>
                  <subj-group>
                    <subject>SARS CoV 2</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Medical microbiology</subject>
            <subj-group>
              <subject>Microbial pathogens</subject>
              <subj-group>
                <subject>Viral pathogens</subject>
                <subj-group>
                  <subject>Coronaviruses</subject>
                  <subj-group>
                    <subject>SARS coronavirus</subject>
                    <subj-group>
                      <subject>SARS CoV 2</subject>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and health sciences</subject>
        <subj-group>
          <subject>Pathology and laboratory medicine</subject>
          <subj-group>
            <subject>Pathogens</subject>
            <subj-group>
              <subject>Microbial pathogens</subject>
              <subj-group>
                <subject>Viral pathogens</subject>
                <subj-group>
                  <subject>Coronaviruses</subject>
                  <subj-group>
                    <subject>SARS coronavirus</subject>
                    <subj-group>
                      <subject>SARS CoV 2</subject>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Viruses</subject>
            <subj-group>
              <subject>Viral pathogens</subject>
              <subj-group>
                <subject>Coronaviruses</subject>
                <subj-group>
                  <subject>SARS coronavirus</subject>
                  <subj-group>
                    <subject>SARS CoV 2</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Human Genomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Eukaryota</subject>
            <subj-group>
              <subject>Plants</subject>
              <subj-group>
                <subject>Trees</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>TPMA: A two pointers meta-alignment tool to ensemble different multiple nucleic acid sequence alignments</article-title>
      <alt-title alt-title-type="running-head">A meta-alignment tool to ensemble different multiple nucleic acid sequence alignments</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhai</surname>
          <given-names>Yixiao</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chao</surname>
          <given-names>Jiannan</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Yizheng</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0009-0002-1788-3084</contrib-id>
        <name>
          <surname>Zhang</surname>
          <given-names>Pinglu</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Tang</surname>
          <given-names>Furong</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-6406-1142</contrib-id>
        <name>
          <surname>Zou</surname>
          <given-names>Quan</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Institute of Fundamental and Frontier Sciences, University of Electronic Science and Technology of China, Chengdu, China</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Quzhou People’s Hospital, Quzhou Affiliated Hospital of Wenzhou Medical University, Quzhou, China</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Yangtze Delta Region Institute (Quzhou), University of Electronic Science and Technology of China, Quzhou, China</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Department of Basic Medical Sciences, School of Medicine, Tsinghua University, Beijing, China</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Gao</surname>
          <given-names>Xin</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>KAUST, SAUDI ARABIA</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors declare that they have no competing interests.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>Furong.TANG@hotmail.com</email> (FT); <email>zouquan@nclab.net</email> (QZ)</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <volume>20</volume>
    <issue>4</issue>
    <elocation-id>e1011988</elocation-id>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>3</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2024 Zhai et al</copyright-statement>
      <copyright-year>2024</copyright-year>
      <copyright-holder>Zhai et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1011988.pdf"/>
    <abstract>
      <p>Accurate multiple sequence alignment (MSA) is imperative for the comprehensive analysis of biological sequences. However, a notable challenge arises as no single MSA tool consistently outperforms its counterparts across diverse datasets. Users often have to try multiple MSA tools to achieve optimal alignment results, which can be time-consuming and memory-intensive. While the overall accuracy of certain MSA results may be lower, there could be local regions with the highest alignment scores, prompting researchers to seek a tool capable of merging these locally optimal results from multiple initial alignments into a globally optimal alignment. In this study, we introduce Two Pointers Meta-Alignment (TPMA), a novel tool designed for the integration of nucleic acid sequence alignments. TPMA employs two pointers to partition the initial alignments into blocks containing identical sequence fragments. It selects blocks with the high sum of pairs (SP) scores to concatenate them into an alignment with an overall SP score superior to that of the initial alignments. Through tests on simulated and real datasets, the experimental results consistently demonstrate that TPMA outperforms M-Coffee in terms of aSP, Q, and total column (TC) scores across most datasets. Even in cases where TPMA’s scores are comparable to M-Coffee, TPMA exhibits significantly lower running time and memory consumption. Furthermore, we comprehensively assessed all the MSA tools used in the experiments, considering accuracy, time, and memory consumption. We propose accurate and fast combination strategies for small and large datasets, which streamline the user tool selection process and facilitate large-scale dataset integration. The dataset and source code of TPMA are available on GitHub (<ext-link xlink:href="https://github.com/malabz/TPMA" ext-link-type="uri">https://github.com/malabz/TPMA</ext-link>).</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Accurate multiple sequence alignment (MSA) is vital for comprehensive biological sequence analysis. However, as no single MSA tool consistently outperforms others across diverse datasets, researchers must invest significant time exploring multiple tools to identify the most suitable one for their specific dataset. To address this, researchers seek tools that can merge locally optimal results from diverse initial alignments into a globally optimal alignment. Our novel approach, Two Pointers Meta-Alignment (TPMA), employs a two-pointer to partition initial alignments into blocks, selecting those with the higher sum of pairs (SP) scores for integration into a globally optimal alignment. TPMA consistently outperforms M-Coffee, demonstrating superior aSP, Q, and total column (TC) scores, coupled with faster running times and lower memory consumption. We present comprehensive assessments of various MSA tools, proposing efficient combination strategies for diverse datasets. Our tool, TPMA, and associated resources are publicly available on GitHub (<ext-link xlink:href="https://github.com/malabz/TPMA" ext-link-type="uri">https://github.com/malabz/TPMA</ext-link>), offering a valuable contribution to the field of evolutionary biology and streamlining the selection process for users dealing with large-scale datasets.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>No. 62131004</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-6406-1142</contrib-id>
          <name>
            <surname>Zou</surname>
            <given-names>Quan</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>No. 62271353</award-id>
        <principal-award-recipient>
          <name>
            <surname>Tang</surname>
            <given-names>Furong</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution>National Key R&amp;D Program of China</institution>
        </funding-source>
        <award-id>2022ZD0117700</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-6406-1142</contrib-id>
          <name>
            <surname>Zou</surname>
            <given-names>Quan</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution>Zhejiang Provincial Natural Science Foundation of China</institution>
        </funding-source>
        <award-id>LD24F020004</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-6406-1142</contrib-id>
          <name>
            <surname>Zou</surname>
            <given-names>Quan</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award005">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100018542</institution-id>
            <institution>Natural Science Foundation of Sichuan Province</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2022NSFSC0926</award-id>
        <principal-award-recipient>
          <name>
            <surname>Tang</surname>
            <given-names>Furong</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award006">
        <funding-source>
          <institution>Municipal Government of Quzhou</institution>
        </funding-source>
        <award-id>No. 2023D036</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-6406-1142</contrib-id>
          <name>
            <surname>Zou</surname>
            <given-names>Quan</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award007">
        <funding-source>
          <institution>Fellowship of China Postdoctoral Science Foundation</institution>
        </funding-source>
        <award-id>2023M731984,GZB20230365</award-id>
        <principal-award-recipient>
          <name>
            <surname>Tang</surname>
            <given-names>Furong</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>The work was supported by the National Natural Science Foundation of China (No. 62131004 to Q.Z.; No. 62271353 to F.T.), the National Key R&amp;D Program of China (No.2022ZD0117700 to Q.Z.), Zhejiang Provincial Natural Science Foundation of China (No. LD24F020004 to Q.Z.), the Natural Science Foundation of Sichuan Province (2022NSFSC0926 to F.T.), the Municipal Government of Quzhou (No. 2023D036 to Q.Z.) and the Fellowship of China Postdoctoral Science Foundation (2023M731984, GZB20230365 to F.T.). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="6"/>
      <table-count count="0"/>
      <page-count count="22"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2024-04-11</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The six real datasets consist of five DNA datasets and one RNA dataset. (1) The human mitochondrial (mt) genomes dataset comprised 672 human mitochondrial genomes, ranging from a maximum length of 16579 bp to a minimum of 16556 bp. We created sub-datasets by randomly selecting 30 sequences without replacement, and this procedure was repeated four times (Supplemental Table S2). (2) The hyper-variable segment II (HVS-II) dataset consisted of 100 sequences extracted from the HVS-II control region of the central European human mitochondrial genomes, retrieved from the GenBank database (accession numbers: KF601094-KF601193). The dataset was subsequently partitioned into ten sub-datasets. (3) The 16S ribosomal RNA (rRNA) dataset encompassed 108,413 DNA sequences encoding RNA found in bacteria and archaea, with an approximate length of 1.5 kb. We created eight sub-datasets for this dataset, each containing 100 sequences sampled randomly without replacement. (4) The 23S rRNA dataset encompassed 641 sequences of Mycobacterium 23S rRNA, sourced from the SILVA rRNA database (<ext-link xlink:href="http://www.arb-silva.de/" ext-link-type="uri">http://www.arb-silva.de/</ext-link>) for bacteria, archaea, and eukaryotes. Spanning lengths from 1909 to 3485 bp, these sequences were partitioned into ten groups (Supplemental Table S5). (5) The respiratory syndrome coronavirus 2 (SARS‑CoV‑2) is an RNA virus that causes the COVID-19 pandemic. Two datasets were derived from the GISAID website (<ext-link xlink:href="https://www.gisaid.org" ext-link-type="uri">https://www.gisaid.org</ext-link>, updated November 11, 2021.) The SARS‑CoV‑2_20200301 datasets contain 156 sequences (29409 to 29927 bp) collected on March 1, 2020, and were divided into four sub-datasets. (6) The SARS‑CoV‑2_20200417 datasets feature 1020 sequences (29409 to 29927 bp) collected on April 17, 2020. From this, we randomly selected 100 sequences without replacement to create a sub-dataset, and this process was repeated four times. Two of the four simulated datasets were generated using hierarchical tree simulation to obtain 16S-like and 23S-like rRNA datasets. This simulation was carried out using INDELible v1.03, and the substitution models were based on estimates obtained from 3000 16S rRNA and 641 Mycobacterium 23S rRNA alignments (as previously mentioned), utilizing IQ-TREE v2.2.0-beta. One hundred 16S rRNA sequences and Mycobacterium 23S rRNA sequences, randomly chosen from the datasets as mentioned above, were aligned to construct the simulation trees. Subsequently, the process of generating the simulation 16S-like and 23S-like datasets was rooted in these two simulation trees. Each tree's branch length was assigned a random value from 0 to 1 (NON-ULTRAMETRIC). The simulated sequence lengths were set at 1.5 kb for 16S-like rRNA and 4 kb for 23S-like rRNA. The indel model parameter used was LAV 5 50, with insertion and deletion rates of 0.01 and 0.1, respectively. To simulate datasets with varying mean similarities, the tree length (sum of branch lengths) was adjusted to achieve mean similarities of 99%, 98%, 97%, 96%, 95%, 94%, 93%, 92%, 91%, 90%, 85%, 80%, 75%, and 70%. The mean similarity represents the average of similarities between any two sequences within the dataset (<ext-link xlink:href="https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py" ext-link-type="uri">https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py</ext-link>), determined by the percentage of matched characters in their pairwise alignments conducted using MAFFT. Detailed information regarding these two sets of 14 sub-datasets can be found in Table S8. Every sub-dataset included three replicates, each containing 100 simulated sequences. The mean length is the average of the average sequence lengths from the three replicates. The remaining two datasets are simulated CIPRES-128 and CIPRES-256 rRNA datasets evolved from the same root rRNA sequence on the trees featuring 128 and 256 taxa, respectively (Supplemental Table S9). These datasets were downloaded from trials 1 to 10 on the CIPRES SIMULATION DATA website (<ext-link xlink:href="https://kim.bio.upenn.edu/software/csd.shtml" ext-link-type="uri">https://kim.bio.upenn.edu/software/csd.shtml</ext-link>). The simulation parameters were adjusted to ensure that the simulated sequences mirror authentic small subunit rRNA (ssu rRNA) sequences regarding sequence identity, indel count, the ratio between substitutions and indels, and other relevant characteristics. The datasets were formatted in NEXUS format. The Nexus to Fasta Sequence Convert tool (<ext-link xlink:href="http://www.bugaco.com" ext-link-type="uri">http://www.bugaco.com</ext-link>) was utilized for conversion into FASTA format to obtain the reference sequences. Subsequently, gaps were removed from the reference to derive the unaligned test datasets. Sequence similarity is computed for every dataset as the ratio of matching base pairs in all pairwise alignments (generated using MAFFT) within a sub-dataset. The script for this computation is available on <ext-link xlink:href="https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py" ext-link-type="uri">https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py</ext-link>. Lastly, employ Python's Matplotlib library to generate a histogram depicting the distribution of sequence similarity.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The six real datasets consist of five DNA datasets and one RNA dataset. (1) The human mitochondrial (mt) genomes dataset comprised 672 human mitochondrial genomes, ranging from a maximum length of 16579 bp to a minimum of 16556 bp. We created sub-datasets by randomly selecting 30 sequences without replacement, and this procedure was repeated four times (Supplemental Table S2). (2) The hyper-variable segment II (HVS-II) dataset consisted of 100 sequences extracted from the HVS-II control region of the central European human mitochondrial genomes, retrieved from the GenBank database (accession numbers: KF601094-KF601193). The dataset was subsequently partitioned into ten sub-datasets. (3) The 16S ribosomal RNA (rRNA) dataset encompassed 108,413 DNA sequences encoding RNA found in bacteria and archaea, with an approximate length of 1.5 kb. We created eight sub-datasets for this dataset, each containing 100 sequences sampled randomly without replacement. (4) The 23S rRNA dataset encompassed 641 sequences of Mycobacterium 23S rRNA, sourced from the SILVA rRNA database (<ext-link xlink:href="http://www.arb-silva.de/" ext-link-type="uri">http://www.arb-silva.de/</ext-link>) for bacteria, archaea, and eukaryotes. Spanning lengths from 1909 to 3485 bp, these sequences were partitioned into ten groups (Supplemental Table S5). (5) The respiratory syndrome coronavirus 2 (SARS‑CoV‑2) is an RNA virus that causes the COVID-19 pandemic. Two datasets were derived from the GISAID website (<ext-link xlink:href="https://www.gisaid.org" ext-link-type="uri">https://www.gisaid.org</ext-link>, updated November 11, 2021.) The SARS‑CoV‑2_20200301 datasets contain 156 sequences (29409 to 29927 bp) collected on March 1, 2020, and were divided into four sub-datasets. (6) The SARS‑CoV‑2_20200417 datasets feature 1020 sequences (29409 to 29927 bp) collected on April 17, 2020. From this, we randomly selected 100 sequences without replacement to create a sub-dataset, and this process was repeated four times. Two of the four simulated datasets were generated using hierarchical tree simulation to obtain 16S-like and 23S-like rRNA datasets. This simulation was carried out using INDELible v1.03, and the substitution models were based on estimates obtained from 3000 16S rRNA and 641 Mycobacterium 23S rRNA alignments (as previously mentioned), utilizing IQ-TREE v2.2.0-beta. One hundred 16S rRNA sequences and Mycobacterium 23S rRNA sequences, randomly chosen from the datasets as mentioned above, were aligned to construct the simulation trees. Subsequently, the process of generating the simulation 16S-like and 23S-like datasets was rooted in these two simulation trees. Each tree's branch length was assigned a random value from 0 to 1 (NON-ULTRAMETRIC). The simulated sequence lengths were set at 1.5 kb for 16S-like rRNA and 4 kb for 23S-like rRNA. The indel model parameter used was LAV 5 50, with insertion and deletion rates of 0.01 and 0.1, respectively. To simulate datasets with varying mean similarities, the tree length (sum of branch lengths) was adjusted to achieve mean similarities of 99%, 98%, 97%, 96%, 95%, 94%, 93%, 92%, 91%, 90%, 85%, 80%, 75%, and 70%. The mean similarity represents the average of similarities between any two sequences within the dataset (<ext-link xlink:href="https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py" ext-link-type="uri">https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py</ext-link>), determined by the percentage of matched characters in their pairwise alignments conducted using MAFFT. Detailed information regarding these two sets of 14 sub-datasets can be found in Table S8. Every sub-dataset included three replicates, each containing 100 simulated sequences. The mean length is the average of the average sequence lengths from the three replicates. The remaining two datasets are simulated CIPRES-128 and CIPRES-256 rRNA datasets evolved from the same root rRNA sequence on the trees featuring 128 and 256 taxa, respectively (Supplemental Table S9). These datasets were downloaded from trials 1 to 10 on the CIPRES SIMULATION DATA website (<ext-link xlink:href="https://kim.bio.upenn.edu/software/csd.shtml" ext-link-type="uri">https://kim.bio.upenn.edu/software/csd.shtml</ext-link>). The simulation parameters were adjusted to ensure that the simulated sequences mirror authentic small subunit rRNA (ssu rRNA) sequences regarding sequence identity, indel count, the ratio between substitutions and indels, and other relevant characteristics. The datasets were formatted in NEXUS format. The Nexus to Fasta Sequence Convert tool (<ext-link xlink:href="http://www.bugaco.com" ext-link-type="uri">http://www.bugaco.com</ext-link>) was utilized for conversion into FASTA format to obtain the reference sequences. Subsequently, gaps were removed from the reference to derive the unaligned test datasets. Sequence similarity is computed for every dataset as the ratio of matching base pairs in all pairwise alignments (generated using MAFFT) within a sub-dataset. The script for this computation is available on <ext-link xlink:href="https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py" ext-link-type="uri">https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py</ext-link>. Lastly, employ Python's Matplotlib library to generate a histogram depicting the distribution of sequence similarity.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Multiple sequence alignment (MSA) is a common technique for analyzing biological sequences, encompassing structure and function estimation, evolutionary relationship determination, gene identification, and more [<xref rid="pcbi.1011988.ref001" ref-type="bibr">1</xref>]. Hence, the precision of MSA directly shapes the outcomes of analyses in bioinformatics, holding paramount importance in discerning biological significance. However, due to its time-consuming nature, many MSA tools, like MAFFT [<xref rid="pcbi.1011988.ref002" ref-type="bibr">2</xref>] and MUSCLE3 [<xref rid="pcbi.1011988.ref003" ref-type="bibr">3</xref>], resort to heuristic methods to address computational complexities. Despite their extensive usage, tools employing heuristic methods exhibit two common limitations. Firstly, the persistence of an incorrectly inserted gap, adhering to the "once a gap, always a gap" rule, can influence subsequent alignments. The other issue is the presence of a local optimal trap. According to the greedy principle, the optimal solution for each subproblem may not necessarily be equivalent to the optimal solution for the global problem. To overcome the drawbacks above, researchers typically employ iterative optimization and meta-alignment methods to further enhance alignment accuracy.</p>
    <p>Iterative optimization involves refining the existing alignment by realigning potential low-quality regions, employing two partition methods: vertical and horizontal realigners. Refin-Align [<xref rid="pcbi.1011988.ref004" ref-type="bibr">4</xref>], a vertical realigner, partitions the initial alignment into blocks based on columns with identical bases. It then eliminates gaps within each block and realigns the sequences using Promalign. If the new alignment exhibits higher accuracy, it replaces the initial alignment. On the other hand, the horizontal realigners, including REFINER [<xref rid="pcbi.1011988.ref005" ref-type="bibr">5</xref>], RF [<xref rid="pcbi.1011988.ref006" ref-type="bibr">6</xref>], and ReformAlign [<xref rid="pcbi.1011988.ref007" ref-type="bibr">7</xref>], adopt distinct strategies. Similar to REFINER, RF randomly selects a sequence in each iteration and realigns it with the profile of the remaining sequences; if the accuracy of the new alignment improves, it serves as the input for the next iteration round until the objective function score converges or reaches the cycle limit. ReformAlign differs from the others by independently realigning all sequences within a single iterative round. This realignment is performed using a summarization profile constructed from the initial alignment. When new gaps are inserted into the profile, ReformAlign automatically switches to a profile fine-tuning mode to account for the new insertion(s), and once the profile is successfully updated, the realignment is restarted using the new profile until the new alignment is obtained after all sequences have been realigned. However, among the methods mentioned above, currently only ReformAlign is available.</p>
    <p>Meta-alignment, a process aimed at synthesizing multiple initial alignments, is employed to derive a high-accuracy alignment. The ComAlign algorithm [<xref rid="pcbi.1011988.ref008" ref-type="bibr">8</xref>] identifies qualitatively conservative blocks within the initial alignments and amalgamates them through dynamic programming to produce a novel alignment, often exhibiting improvements. MergeAlign [<xref rid="pcbi.1011988.ref009" ref-type="bibr">9</xref>] generates a weighted directed acyclic graph (DAG), wherein each node represents the site combinations of each column in the initial alignments. Each edge signifies a transition between two adjacent columns, and the weight of each edge corresponds to the number of initial alignments containing that particular transition (between two adjacent columns). Finally, the nodes (columns) in the maximum weight path form the merged alignment. AQUA [<xref rid="pcbi.1011988.ref010" ref-type="bibr">10</xref>], an automated quality improvement program for Multiple Sequence Alignment (MSA), initiates its process by generating two initial alignments through MUSCLE3 and MAFFT. These alignments are subsequently independently optimized using RASCAL [<xref rid="pcbi.1011988.ref011" ref-type="bibr">11</xref>], resulting in two refined alignments. In its culmination, the meta-alignment process yields the alignment with the highest accuracy among the four, determined by the NorMD score. The most widely utilized meta-alignment method is M-Coffee [<xref rid="pcbi.1011988.ref012" ref-type="bibr">12</xref>], which constructs a consistency library of each pair of residues with residue pairs from all other alignments to increase the weight of the aligned pairs accepted by most MSA tools. However, it is noteworthy that this inclusive approach implies that incorrectly aligned pairs prevalent across multiple alignments will also be weighted. Consequently, the accuracy of the M-Coffee meta-alignment can either be improved or diminished, depending on the accuracy of each individual MSA tool.</p>
    <p>In this study, we have developed TPMA, a meta-alignment tool for integrating nucleic acid sequence alignments, which employs a two-pointers approach to partition the initial alignments into blocks with identical sequence fragments and concatenate blocks with higher SP scores to form the final alignment. We tested TPMA, M-Coffee, and ReformAlign on four simulated and six real datasets. The results consistently show that TPMA outperforms M-Coffee in terms of aSP, Q, and TC scores across most datasets. Notably, in cases where TPMA scores closely align with M-Coffee, TPMA exhibits significantly lower time and memory consumption. In datasets with varying similarity spans, ReformAlign optimization led to approximately 50% of alignments experiencing decreased TC scores in simulated datasets. Thus, TPMA exhibits superior performance compared to both M-Coffee and ReformAlign. To save time for users while selecting MSA tools, we screened all MSA tools used in our experiments based on accuracy, time, and memory consumption. Therefore, we propose accurate and fast combination strategies to integrate small and large datasets, ensuring efficient integration while upholding alignment accuracy.</p>
  </sec>
  <sec sec-type="results" id="sec002">
    <title>Results</title>
    <sec id="sec003">
      <title>TPMA outperforms M-Coffee in alignment quality, running time, and memory consumption</title>
      <p>In this experiment, we employed two simulated datasets, 16S-like and 23S-like rRNA, along with four real datasets: 16S rRNA, human mitochondrial (mt) genomes, SARS-CoV-2_20200301, and SARS-CoV-2_20200417 datasets. Furthermore, nine MSA tools, namely ClustalW2, Dialign-TX, Kalign3, MAFFT, MUSCLE3, MUSCLE5, PCMA, POA, and T-Coffee, were employed to generate initial alignments. Detailed information regarding the versions and operating parameters of these MSA tools can be found in <xref rid="pcbi.1011988.s013" ref-type="supplementary-material">S10 Table</xref>.</p>
      <p>M-Coffee takes the original, unaligned sequences dataset as input and utilizes the "-method" parameter to specify the MSA tools for obtaining the initial alignments. To ensure compatibility with M-Coffee, we crafted a shell script specifically for calling MUSCLE5, while the remaining MSA tools have already been integrated into M-Coffee by default. The shell script for invoking MUSCLE5 and its usage instructions can be found at <ext-link xlink:href="https://github.com/malabz/TPMA/tree/main/tools" ext-link-type="uri">https://github.com/malabz/TPMA/tree/main/tools</ext-link>. The input for TPMA comprises multiple initial alignments generated by different MSA tools, with each aligner’s running parameters precisely identical to those utilized in the M-Coffee, guaranteeing an impartial experimental setup. Two simulated datasets with references were evaluated by aSP, Q, and TC scores, while the alignment quality of the four real datasets was assessed based on the aSP score. The running time of TPMA refers to the duration taken to merge multiple initial alignments, while memory consumption indicates the peak amount of memory utilized during this merging process. Regarding M-Coffee, the running time and memory consumption encompass the time and maximum memory used from initial library construction to combination completion. Specifically, the reported running time and memory consumption by TPMA are related to the merging process. In the case of M-Coffee, its memory usage during merging corresponds to the peak memory usage of its final output. To measure the timing of the M-Coffee merging process, we introduced a timestamp mechanism. This entailed placing a timestamp at the start of merging, following the if function in line 5093 of the t_coffee.c file in its source code. Another timestamp was logged upon program completion, enabling us to accurately compute the duration of the M-Coffee merging process. The time and memory consumed by the MSA tools generating the initial alignments were excluded for the purpose of comparing TPMA and M-Coffee.</p>
      <p><xref rid="pcbi.1011988.g001" ref-type="fig">Fig 1A and 1D</xref> demonstrate that the TPMA results consistently outperform the other nine initial alignments and the combined results of M-Coffee in terms of aSP, Q, and TC (except for the 99% similarity dataset) scores across the 16S-like and 23S-like rRNA datasets. This advantage becomes more pronounced as the dataset similarity decreases. For the 16S-like rRNA datasets with a 99% similarity, TPMA achieves an average TC score of 0.9967, while ClustalW2 and PCMA achieve an average TC score of 0.9970, and M-Coffee’s average TC score is 0.9957. Similarly, for the 23S-like rRNA datasets with a 99% similarity, TPMA attains an average TC score of 0.9963, while T-Coffee and M-Coffee achieve average TC scores of 0.9969 and 0.9960, respectively. Consequently, TPMA’s results closely approach the highest TC score and surpass those of M-Coffee. Furthermore, TPMA demonstrates shorter running time and lower memory consumption than M-Coffee on both sets of datasets (<xref rid="pcbi.1011988.g001" ref-type="fig">Fig 1B and 1E</xref>). In the 16S rRNA datasets with an average similarity of 75%, TPMA shows a superior aSP score compared to M-Coffee (<xref rid="pcbi.1011988.g002" ref-type="fig">Fig 2A</xref>). However, for the other three real datasets with high average similarities, TPMA and M-Coffee demonstrate close scores (<xref rid="pcbi.1011988.g002" ref-type="fig">Fig 2D</xref>, <xref rid="pcbi.1011988.g002" ref-type="fig">2G</xref>, and <xref rid="pcbi.1011988.g002" ref-type="fig">2J</xref>). Furthermore, TPMA exhibits a significantly shorter running time and consumes considerably less memory than M-Coffee (<xref rid="pcbi.1011988.g002" ref-type="fig">Fig 2B</xref>, <xref rid="pcbi.1011988.g002" ref-type="fig">2E</xref>, <xref rid="pcbi.1011988.g002" ref-type="fig">2H</xref>, and <xref rid="pcbi.1011988.g002" ref-type="fig">2K</xref>).</p>
      <fig position="float" id="pcbi.1011988.g001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011988.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Comparative analysis of TPMA, M-Coffee, and ReformAlign on 16S-like and 23S-like rRNA datasets.</title>
          <p>Each dataset consists of 14 sub-datasets, each exhibiting varying levels of sequence similarity ranging from 99% to 70%. Within each similarity sub-dataset, three replicates are included. For each replicate, nine initial alignments are acquired and subsequently merged using TPMA and M-Coffee. <bold>A, D</bold> The aSP, Q, and TC scores of TPMA, M-Coffee, and nine MSA tools across 16S-like and 23S-like rRNA datasets. For each gird, the average of three repetitions in one sub-dataset was calculated and subjected to min-max normalization using the alignment scores from all tools. <bold>B</bold>, <bold>E</bold> The changes in running time and memory usage of TPMA and M-Coffee across different levels of similarity for the 16S-like and 23S-like rRNA datasets. Each point represents the average time and memory consumption resulting from the combination of TPMA and M-Coffee across the three replicates. This computation excludes the time and memory required for obtaining the initial alignments. <bold>C, F</bold> Compare improvements in aSP, Q, and TC scores of TPMA, M-Coffee, and ReformAlign for initial alignments on 16S-like and 23S-like rRNA datasets. Each dataset consists of 14 sub-datasets, with three replicates per sub-dataset. A total of 378 (14×3×9) initial alignments were generated using 9 MSA tools. ReformAlign optimized these 378 initial alignments, calculating the differences between the scores of the optimized and unoptimized initial alignments for aSP, Q, and TC scores. Additionally, the disparities between the scores of the merged alignments (through TPMA and M-Coffee) and the unmerged initial alignments were also computed for aSP, Q, and TC scores. A total of 378 differences were obtained for TPMA and M-Coffee, obtained from 14×3 replicates, with each replicate generating 9 differences. The proportions of "improved," "constant," and "reduced" are summarized in donut charts.</p>
        </caption>
        <graphic xlink:href="pcbi.1011988.g001" position="float"/>
      </fig>
      <fig position="float" id="pcbi.1011988.g002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011988.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Comparative analysis of TPMA, M-Coffee, and ReformAlign across the four real datasets.</title>
          <p>The 16S rRNA datasets include 8 subsets, each comprising 100 sequences, and nine MSA tools were utilized to generate the initial alignments for these datasets. Additionally, the mt genomes, SARS-CoV-2_20200301, and SARS-CoV-2_20200417 datasets consist of 4 subsets containing 30, 39, and 100 sequences, respectively. <bold>A, D, G, J</bold> The aSP score of TPMA, M-Coffee, and various MSA tools on the 16S rRNA, mt genomes, SARS-CoV-2_20200301, and SARS-CoV-2_20200417 datasets. It’s worth noting that some MSA tools failed to align on these datasets; only the tools depicted in the figure completed the alignment. The resulting initial alignment was then utilized for the merging process using TPMA and M-Coffee. <bold>B, E, H, K</bold> The running time and memory usage of TPMA and M-Coffee for the 16S rRNA, mt genomes, SARS-CoV-2_20200301, and SARS-CoV-2_20200417 datasets. Notably, the values exclude the time and memory needed to obtain the initial alignments. <bold>C, F, I, L</bold> The enhancements in the aSP score of initial alignments on the 16S rRNA (<bold>C</bold>), mt genomes (<bold>F</bold>), SARS-CoV-2_20200301 (<bold>I</bold>), and SARS-CoV-2_20200417 (<bold>L</bold>) datasets among TPMA, M-Coffee, and ReformAlign. Specifically, the 16S rRNA datasets comprise 72 (8×9) initial alignments, while the mt genomes datasets entail 28 (4×7) initial alignments. Furthermore, both the SARS-CoV-2_20200301 and SARS-CoV-2_20200417 datasets each encompass 20 (4×5) initial alignments. The proportions of "improved", "constant", and "reduced" are calculated based on the number of initial alignments for each dataset. It’s worth noting that for the two SARS-CoV-2 datasets, ReformAlign’s results were not displayed due to exceeding the device’s memory limit.</p>
        </caption>
        <graphic xlink:href="pcbi.1011988.g002" position="float"/>
      </fig>
      <p>Afterward, we assessed the performance of TPMA, M-Coffee, and ReformAlign in enhancing alignment quality. First, we optimized each initial alignment utilizing ReformAlign’s fundamental parameters (detailed in <xref rid="pcbi.1011988.s013" ref-type="supplementary-material">S10 Table</xref>), calculated the difference in aSP, Q, and TC scores between the optimized and initial alignments, and then computed the discrepancy between the combined results and each participating initial alignment for TPMA and M-Coffee.</p>
      <p>On both 16S-like and 23S-like rRNA datasets (<xref rid="pcbi.1011988.g001" ref-type="fig">Fig 1C and 1F</xref>), TPMA improves or maintains the aSP score in all datasets, and it enhances Q and TC scores in the majority of datasets when compared to M-Coffee and ReformAlign. Similarly, compared to M-Coffee and ReformAlign, TPMA improves more alignments’ aSP score across all four real datasets, which were randomly sampled to obtain multiple replicas for comparison (<xref rid="pcbi.1011988.g002" ref-type="fig">Fig 2C</xref>, <xref rid="pcbi.1011988.g002" ref-type="fig">2F</xref>, <xref rid="pcbi.1011988.g002" ref-type="fig">2I</xref>, and <xref rid="pcbi.1011988.g002" ref-type="fig">2L</xref>). It is noteworthy that ReformAlign faced limitations in optimizing the two SARS-CoV-2 datasets due to memory limitations exceeding the device’s upper threshold.</p>
      <p>Thus, TPMA consistently imparts heightened alignment quality compared to most initial alignments, a trend especially pronounced in datasets exhibiting lower similarity. While, in certain instances, TPMA’s score might marginally fall below that of the initial alignment, it consistently approaches the highest score and surpasses the outcome achieved by M-Coffee. In contrast, the accuracy of M-Coffee generated alignments is susceptible to the accuracy of the initial alignment, potentially between the best and worst initial alignments, showing a limited ability to improve the quality of initial alignments. TPMA exhibits a shorter running time and less memory consumption than M-Coffee. Furthermore, as sequence length and quantity increase, ReformAlign’s memory demands become excessively high, constraining its scalability.</p>
    </sec>
    <sec id="sec004">
      <title>Accurate strategy: achieving comparable results with 4 MSA tools as with All 9</title>
      <p>Initially, we arranged the 9 MSA tools based on the accuracy of their alignment results, revealing that the top 5 aligners derived from the aSP, Q, and TC scores were identical, comprising ClustalW2, MAFFT, MUSCLE3, PCMA, and T-Coffee, albeit in varying specific orders (<xref rid="pcbi.1011988.g003" ref-type="fig">Fig 3A</xref>). By utilizing MSA tools’ aSP score ranking, we added and merged the initial alignments one by one from the top-ranked MSA tools, then computed the average accuracy across all sub-datasets, illustrated as the yellow square curve (<xref rid="pcbi.1011988.g003" ref-type="fig">Fig 3B</xref>). "Top 2" signifies the result obtained by combining the alignments derived from the top two aligners, T-Coffee and MUSCLE3, by TPMA. "Top 3" represents the combined result of the top three T-Coffee, MUSCLE3, and MAFFT; the subsequent combinations are deduced accordingly. We replicate the identical procedure using the rankings derived from Q and TC scores, resulting in the outcomes represented by the blue circular curve and the red triangular curve, respectively. Notably, as more initial alignments were added, the aSP, Q, and TC scores initially increased but eventually reached a plateau or slightly decreased. This observation suggests that the inclusion of Dialign-TX, Kalign3, MUSCLE5, and POA in these combinations did not enhance the final alignment’s quality. Upon reanalysis of the aSP, Q, and TC scores across various sequence similarities (<xref rid="pcbi.1011988.s001" ref-type="supplementary-material">S1</xref>–<xref rid="pcbi.1011988.s003" ref-type="supplementary-material">S3</xref> Figs), similar pronounced trends were observed in low-similarity sub-datasets, highlighting TPMA’s enhanced efficacy in integrating such datasets.</p>
      <fig position="float" id="pcbi.1011988.g003">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011988.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>The results of screening the accurate strategy on the 23S-like rRNA datasets.</title>
          <p><bold>A</bold> MSA tool rankings are determined based on aSP, Q, and TC scores. Each point corresponds to the average value of three replicates within that sub-dataset. "Mean" denotes the ranking derived from the average values spanning all sub-datasets with varying degrees of similarity. <bold>B</bold> Sequential integration of initial alignments from MSA tools following ranking by aSP, Q, and TC scores. The ranking is derived from the "Mean" results of <bold>A</bold>. Referring to the aSP score rankings (the orange line), the "Top 2" position indicates the integration of T-Coffee and MUSCLE3, while the "Top 3" placement corresponds to the fusion of T-Coffee, MUSCLE3, and MAFFT, and so forth. Analyzing the Q score rankings (the blue line), the "Top 2" position signifies the combination of T-Coffee and MUSCLE3, while the "Top 3" is the fusion of T-Coffee, MUSCLE3, and ClustalW2, and so forth. Similarly, based on the TC score ranking (the red line), the "Top 2" position indicates the combination of ClustalW2 and PCMA, while the "Top 3" placement represents the integration of ClustalW2, PCMA, and T-Coffee, and so forth. The outcomes represent the average values of the aSP, Q, and TC scores of combined alignments across all sub-datasets of different similarities. <bold>C</bold> Ablation experiment on the "Top 5" MSA tools. The disparities between the aSP, Q, and TC scores of the combined alignment obtained from the remaining four initial alignments (excluding the indicated MSA tool) and from all five initial alignments were computed. If the score from combining the remaining four initial alignments is higher, it’s classified as ’improved’; if it remains the same, it’s labeled ’constant’; if it decreases, it’s categorized as ’reduced’. Each histogram displays the proportions of "improved," "constant," and "reduced" cases, calculated from a total of 42 datasets (14*3) across all sub-datasets. <bold>D</bold> Ablation experiment on the "Top 4" MSA tools (similar to C). <bold>E</bold> The running time and memory consumption of 11 MSA tools on 42 23S-like rRNA datasets are presented. Logging was conducted using Python’s psutil library.</p>
        </caption>
        <graphic xlink:href="pcbi.1011988.g003" position="float"/>
      </fig>
      <p>The trend from "Top 4" to "Top 5" remains constant, leading us to deduce the presence of redundant MSA tools within the "Top 5" combination. Consequently, we performed ablation experiments on the selected top 5 MSA tools, revealing that the final alignment remained unchanged when either ClustalW2 or PCMA was excluded (<xref rid="pcbi.1011988.g003" ref-type="fig">Fig 3C</xref>). Considering their running time and memory utilization on 23S-like rRNA datasets (<xref rid="pcbi.1011988.g003" ref-type="fig">Fig 3E</xref>), ClustalW2 demonstrates reduced memory consumption and faster processing time than PCMA. Consequently, we refined the accurate combination strategy to encompass four aligners: ClustalW2, MAFFT, MUSCLE3, and T-Coffee. Further, ablation experiments on these four MSA tools demonstrated that each aligner significantly contributed to the final alignment quality, affirming their indispensability within the accurate strategy (<xref rid="pcbi.1011988.g003" ref-type="fig">Fig 3D</xref>).</p>
      <p>We conducted tests on seven datasets to further validate the broad applicability of the accurate strategy when utilizing TPMA. TPMA combines nine initial alignments, "Top 5" initial alignments, and the four initial alignments from the accurate strategy to generate TPMA_C9, TPMA_C5, and TPMA_C4, respectively. In contrast, M-Coffee integrates the nine initial alignments and the four initial alignments of the accurate strategy, yielding M-Coffee_C9 and M-Coffee_C4, respectively. TPMA’s combined outcomes on 16S-like and 23S-like rRNA datasets consistently outperform M-Coffee in terms of aSP, Q, and TC scores. Meanwhile, TPMA_C9, TPMA_C5, and TPMA_C4 show highly similar results (<xref rid="pcbi.1011988.g004" ref-type="fig">Fig 4A and 4B</xref>). These three TPMA outcomes also demonstrate comparable performance across simulated CIPRES-128, CIPRES-256, and 16S rRNA datasets, where the sequences exhibit average similarity rates of 80% for the first two and 75% for the latter, all-surpassing M-Coffee (<xref rid="pcbi.1011988.g004" ref-type="fig">Fig 4C–4E</xref>). The "NULL" signifies that no results were acquired from TPMA-C9 and M-Coffee_C9 due to the infinite alignment time of Dialign-TX (<xref rid="pcbi.1011988.g004" ref-type="fig">Fig 4D</xref>). The HVS-II and 23S rRNA datasets exhibited an average similarity above 93%. Results from three TPMA and two M-Coffee alignments closely align on these datasets, with TPMA slightly surpassing M-Coffee’s outcomes (<xref rid="pcbi.1011988.g004" ref-type="fig">Fig 4F and 4G</xref>). Therefore, the outputs from the comprehensive test datasets validate that integrating the four alignments acquired through the accurate strategy can yield results of comparable quality to combining all nine alignments while saving time and memory.</p>
      <fig position="float" id="pcbi.1011988.g004">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011988.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Validation of the accurate strategy on additional datasets.</title>
          <p>TPMA_C9 and M-Coffee_C9 represent the combined alignments of 9 initial alignments from ClustalW2, Dialign-TX, Kalign3, MAFFT, MUSCLE3, MUSCLE5, PCMA, POA, and T-Coffee. TPMA_C5 combines initial alignments from 5 MSA tools: ClustalW2, MAFFT, MUSCLE3, PCMA, and T-Coffee. TPMA_C4 and M-Coffee_C4 are the combined alignments of merging the initial alignments from the accurate strategy (ClustalW2, MAFFT, MUSCLE3, and T-Coffee). <bold>A, B</bold> We present the trends in aSP, Q, and TC scores of TPMA_C9, TPMA_C5, TPMA_C4, M-Coffee_C9, and M-Coffee_C4 on the 16S-like and 23S-like rRNA sub-datasets. The results represent the average value across the three replicates from each sub-dataset. <bold>C, D,</bold> Comparing aSP, Q, and TC scores (10 replicates) for TPMA_C9, TPMA_C5, TPMA_C4, M-Coffee_C9, and M-Coffee_C4 on simulated CIPRES-128 and CIPRES-256 rRNA datasets, alongside a sequence similarity distribution histogram. The sequence similarity of each replicate was similar within the dataset, and only one of the replicates’ sequence similarity distribution histograms was plotted. The "NULL" indicates that TPMA-C9 and M-Coffee_C9 produced no results due to the infinite alignment time of Dialign-TX. <bold>E-G,</bold> The aSP scores of TPMA_C9, TPMA_C5, TPMA_C4, M-Coffee_C9, and M-Coffee_C4 on the 16S rRNA, HVS-II, and 23S rRNA datasets with the corresponding sequence similarity distribution histograms (only one representative histogram was displayed). The 16S rRNA datasets have 8 replicates, while the HVS-II and 23S rRNA datasets contain 10 replicates.</p>
        </caption>
        <graphic xlink:href="pcbi.1011988.g004" position="float"/>
      </fig>
    </sec>
    <sec id="sec005">
      <title>Fast strategy: enhancing alignment accuracy with time efficiency for large-scale datasets</title>
      <p>During the above experiment, we observed that early-developed MSA software, such as T-Coffee and Dialign-TX, faced difficulties in aligning datasets with longer or larger sequences, leading to considerable time and memory expenses, potentially limiting options for certain users, particularly considering the inclusion of T-Coffee in the accurate strategy. To address this, we identify newly developed MSA software that exhibits swift alignment speed and lower memory consumption, and by integrating these tools with TPMA, we formulated a fast combination strategy, explicitly catered for datasets with larger scales, aiming to save time while preserving alignment accuracy as closely as possible to the accurate strategy results. We evaluated the performance of the fast strategy which selected the four most rapid MSA tools (<xref rid="pcbi.1011988.g003" ref-type="fig">Fig 3E</xref>), namely HAlign3, Kalign3, MAFFT, and WMSA2, by conducting experiments on eight datasets. The experimental approach involved running the four MSA tools to acquire initial alignments, followed by merging these alignments using TPMA to generate "TPMA_F4". We compared the accuracy of TPMA_F4 with that of "TPMA_C4" from the 4.2 experiment and recorded the memory consumption and running time required for obtaining all initial alignments. The memory consumption represents the maximum usage of TPMA_F4 and TPMA_C4 when running individual MSA tools, while the running time refers to the cumulative time taken by TPMA_F4 and TPMA_C4 when running each MSA tool. The time and memory consumption associated with combining initial alignments in TPMA_F4 and TPMA_C4 were disregarded.</p>
      <p>In the 16S-like and 23S-like rRNA datasets, the aSP and TC score curves of TPMA_C4 and TPMA_F4 almost overlap, while, as the sequence similarity falls below 80%, the Q score of TPMA_F4 slightly lags behind that of TPMA_C4. Notably, TPMA_F4 demands significantly less time for initial alignments than TPMA_C4, and when the sequence similarity reaches 85% or higher, TPMA_F4 exhibits lower memory consumption than TPMA_C4 (<xref rid="pcbi.1011988.g005" ref-type="fig">Fig 5A and 5B</xref>). On the simulated CIPRES-128 and CIPRES-256 rRNA datasets (sequence similarity: 80%), the aSP score distributions are similar between the two methods, while the Q score and TC score distributions of TPMA_F4 are slightly lower than those of TPMA_C4 (<xref rid="pcbi.1011988.g005" ref-type="fig">Fig 5C and 5D</xref>). For the 16S rRNA datasets (sequence similarity: 75%), TPMA_F4 achieves a slightly lower aSP score than TPMA_C4 (<xref rid="pcbi.1011988.g005" ref-type="fig">Fig 5E</xref>). However, in the case of the HVS-II datasets (sequence similarity: 98.6%), 23S rRNA datasets (sequence similarity: 92.7%), and mt genomes datasets (sequence similarity: 99.7%), the TPMA_C4 and TPMA_F4 results demonstrate similar aSP score distributions (<xref rid="pcbi.1011988.g005" ref-type="fig">Fig 5F–5H</xref>). While the disparity in peak memory consumption between the two methods is minimal in the above datasets, TPMA_F4 requires significantly less time for initial alignments than TPMA_C4. Especially on the mt-genomes datasets, TPMA_C4’s completion time for all initial alignments extends up to 4 days, accompanied by memory usage exceeding 100GB, whereas TPMA_F4 accomplishes the task within a mere 1 minute, utilizing 290MB of memory. The experimental results affirm that, when sequence similarity exceeds 80%, the fast strategy can attain alignment quality comparable to the accurate strategy, significantly reducing the time required for initial alignments, particularly on extensive datasets.</p>
      <fig position="float" id="pcbi.1011988.g005">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011988.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Comparative analysis of accurate and fast strategies.</title>
          <p>TPMA_C4 is derived from the merged alignment by combining the initial alignments obtained through accurate strategy (ClustalW2, MAFFT, MUSCLE3, and T-Coffee), while TPMA_F4 results from that of the fast strategy (HAlign3, Kalign3, MAFFT, and WMSA2). The time indicated the aggregate of the running time for the four MSA tools within the combined strategy. Meanwhile, the memory reflects the highest memory consumption observed during the aligning process of the four MSA tools in the combined strategy. <bold>A-D</bold> aSP, Q, and TC scores of TPMA_C4 and TPMA_F4 on the 16S-like, 23S-like, simulated CIPRES-128 and CIPRES-256 rRNA datasets, along with the overall time and memory peak consumption during acquiring all initial alignments. Each point in <bold>A</bold> and <bold>B</bold> represents the average value from three replicates within the sub-dataset of 16S-like and 23S-like rRNA datasets. Meanwhile, both CIPRES rRNA datasets consist of 10 replicates. <bold>E-H</bold> aSP score of TPMA_C4 and TPMA_F4 on the 16S rRNA, HVS-II, 23S rRNA, and mt genomes datasets with the time and memory of that required to obtain all initial alignments. The 16S rRNA, HVS-II, 23S rRNA, and mt genome datasets comprised 8, 10, 10, and 4 replicates, respectively.</p>
        </caption>
        <graphic xlink:href="pcbi.1011988.g005" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec006">
    <title>Discussion</title>
    <p>We developed Two Pointers Meta-Alignment (TPMA) to enhance the quality of nucleic acid sequence alignments by combining blocks with high SP scores from multiple initial alignments. The assessment of TPMA across six real and four simulated datasets revealed that it improves the aSP, Q, and TC scores of initial alignments across most datasets, particularly in datasets with low sequence similarity, all while reducing memory and time consumption. While TPMA’s result exhibited a relatively lower score in partial high sequence similarity datasets, it closely approached the highest score of initial alignments and outperformed the result from M-Coffee. Furthermore, in contrast to M-Coffee and ReformAlign, TPMA demonstrates a more significant capability for enhancing the quality of initial alignments. Subsequently, we evaluated the MSA tools utilized in the experiment and presented users with accurate and fast strategies. Validation of the test datasets affirmed that these two strategies could uphold alignment accuracy while conserving time and facilitating the integration of large-scale datasets. In our experimental tests, we focused solely on comparing the running time and memory consumption of TPMA and M-Coffee, without including ReformAlign in the comparison. This decision stems from the fact that TPMA and M-Coffee employ similar optimization strategies, namely merging multiple initial alignments, while ReformAlign conducts re-alignment against a single initial alignment. As a result, a direct comparison with TPMA and M-Coffee in terms of time and memory consumption is not feasible.</p>
    <p>During a validation experiment to assess TPMA’s efficacy, we employed 9 MSA tools for the integration. Recognizing the impracticality for users to execute numerous MSA tools individually before integration, we streamlined the process by offering users an accurate strategy, ensuring equivalent or similar alignment quality with the fewest tools. This enhancement in user convenience saves valuable time typically spent on tool selection. Additionally, 23S-like rRNA was chosen as the experimental dataset for screening MSA tools of accurate strategy for several reasons: firstly, the simulated datasets provide reference alignments, and we can comprehensively assess MSA tools based on aSP, Q, and TC scores. Among these metrics, aSP quantifies the quality of sequence alignment by computing the average similarity score across all sequence pairs. Q and TC provide a comprehensive assessment of alignment accuracy and completeness relative to a reference alignment. MSA tools that incorporate multiple indicators in their selection process tend to be more reliable. Secondly, compared with the simulated CIPRES datasets, its multiple sub-datasets with varying similarities allow for the identification of MSA tools less influenced by different similarities, ensuring broad applicability of the screening results. And finally, compared to the 16S-like rRNA datasets, 23S-like rRNA possesses longer sequence lengths and more noticeable disparities in running time and memory consumption among MSA tools, simplifying the decision-making process.</p>
    <p>As sequencing technology has advanced, there has been a substantial increase in the length and quantity of sequences for a single alignment process. The mt genome, approximately 16 kb in length, and the SARS-CoV-2 genome, spanning around 29 kb, highlight this trend, with over 16 million SARS-CoV-2 genomes sequenced from 193 countries and regions as of July 2023. However, early-developed MSA tools face challenges when dealing with large-scale alignment tasks. For instance, T-Coffee and Dialign-TX experience infinite running times when aligning the SARS-CoV-2_20200301 sub-dataset containing 39 sequences. Although T-Coffee, included in the accurate strategy, delivers high-quality alignment outcomes, its performance is constrained when aligning extensive sequences, limiting the broad applicability of the accurate strategy. Hence, we opted for the newly developed tools HAlign3, Kalign3, MAFFT, and WMSA2 to create a fast strategy to produce initial alignments for large-scale datasets as quickly as possible. The experimental results demonstrate that the four MSA tools chosen via the fast strategy outperform those selected through the accurate strategy in terms of speed and suitability for large-scale data. Particularly when dealing with low sequence similarity, HAlign3 may exhibit high memory usage, but this limitation can be mitigated by reducing the number of parallel threads. Moreover, the decision to opt for four MSA tools in the fast strategy, rather than a smaller selection, stems from the advantage it offers in facilitating effective comparisons on large-scale datasets compared to the accurate strategy. A smaller tool selection could compromise the ability to make meaningful comparisons. Despite not being part of the accurate strategy, Kalign3’s rapid aligning and minimal memory usage on large-scale datasets align with the objectives of the fast strategy tailored for such datasets.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec007">
    <title>Materials and methods</title>
    <sec id="sec008">
      <title>The workflow of TPMA</title>
      <p>TPMA requires two inputs: firstly, a set containing <italic toggle="yes">A</italic><sub>1</sub>, <italic toggle="yes">A</italic><sub>2</sub>,…,<italic toggle="yes">A</italic><sub><italic toggle="yes">n</italic></sub> (the initial alignments of the original sequence dataset <italic toggle="yes">R</italic> by <italic toggle="yes">n</italic> MSA tools) and secondly, the original unaligned sequence dataset <italic toggle="yes">R</italic>. The default output sequence order of MUSCLE3, MUSCLE5, and PCMA is based on the clustering of their guide tree, which often differs from the sequence order of the original dataset. Furthermore, when the original sequences contain characters other than the 26 uppercase and lowercase English letters, MAFFT and MUSCLE3 will align the sequences after deleting these characters. Therefore, TPMA mandates a meticulous examination of the initial alignments (<xref rid="pcbi.1011988.g006" ref-type="fig">Fig 6A</xref>).</p>
      <fig position="float" id="pcbi.1011988.g006">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011988.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>Operational mechanism and illustrative cases of TPMA.</title>
          <p><bold>A</bold> Flowchart of TPMA. Unaligned sequences (<italic toggle="yes">R</italic>) are aligned using <italic toggle="yes">n</italic> MSA tools to generate <italic toggle="yes">n</italic> initial alignments, and these initial alignments along with the <italic toggle="yes">R</italic> are fed into TPMA. TPMA checks the <italic toggle="yes">n</italic> initial alignments by sorting sequences, calculating SP scores, and verifying for consistency, resulting in <italic toggle="yes">m</italic> valid initial alignments. The <italic toggle="yes">m</italic> valid initial alignments are combined in descending order of SP scores. A total of <italic toggle="yes">m-1</italic> combining steps are conducted to obtain the final alignment, denoted as <italic toggle="yes">A</italic><sub><italic toggle="yes">final</italic></sub>. <bold>B</bold> Example of a detailed merging process for two initial alignments. (i) Recode <inline-formula id="pcbi.1011988.e001"><alternatives><graphic xlink:href="pcbi.1011988.e001" id="pcbi.1011988.e001g" position="anchor"/><mml:math id="M1" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1011988.e002"><alternatives><graphic xlink:href="pcbi.1011988.e002" id="pcbi.1011988.e002g" position="anchor"/><mml:math id="M2" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> as binary strings consisting exclusively of 0s and 1s. (ii) <inline-formula id="pcbi.1011988.e003"><alternatives><graphic xlink:href="pcbi.1011988.e003" id="pcbi.1011988.e003g" position="anchor"/><mml:math id="M3" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1011988.e004"><alternatives><graphic xlink:href="pcbi.1011988.e004" id="pcbi.1011988.e004g" position="anchor"/><mml:math id="M4" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> are divided into blocks according to the bold column <italic toggle="yes">C</italic><sub><italic toggle="yes">i</italic></sub> (<italic toggle="yes">C</italic><sub>1</sub>, <italic toggle="yes">C</italic><sub>4</sub>, <italic toggle="yes">C</italic><sub>10</sub>, <italic toggle="yes">C</italic><sub>11</sub>, <italic toggle="yes">C</italic><sub>13</sub> and <italic toggle="yes">C</italic><sub>16</sub> for <inline-formula id="pcbi.1011988.e005"><alternatives><graphic xlink:href="pcbi.1011988.e005" id="pcbi.1011988.e005g" position="anchor"/><mml:math id="M5" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>; <italic toggle="yes">C</italic><sub>1</sub>, <italic toggle="yes">C</italic><sub>4</sub>, <italic toggle="yes">C</italic><sub>10</sub>, <italic toggle="yes">C</italic><sub>11</sub>, <italic toggle="yes">C</italic><sub>12</sub> and <italic toggle="yes">C</italic><sub>15</sub> for <inline-formula id="pcbi.1011988.e006"><alternatives><graphic xlink:href="pcbi.1011988.e006" id="pcbi.1011988.e006g" position="anchor"/><mml:math id="M6" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>), which yields six pairs of blocks. Each of these block pairs consists of identical sequence fragments. (iii) Compute the SP scores for these blocks, and then merge the blocks with higher SP values into <italic toggle="yes">A</italic><sub><italic toggle="yes">tmp</italic>1</sub>. <italic toggle="yes">A</italic><sub><italic toggle="yes">tmp</italic>1</sub> encompasses sequences of length 15, structured as follows: block <italic toggle="yes">C</italic><sub>1</sub> with identical scores, blocks <italic toggle="yes">C</italic><sub>2</sub>−<italic toggle="yes">C</italic><sub>4</sub> from <inline-formula id="pcbi.1011988.e007"><alternatives><graphic xlink:href="pcbi.1011988.e007" id="pcbi.1011988.e007g" position="anchor"/><mml:math id="M7" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, blocks <italic toggle="yes">C</italic><sub>5</sub>−<italic toggle="yes">C</italic><sub>10</sub> from <inline-formula id="pcbi.1011988.e008"><alternatives><graphic xlink:href="pcbi.1011988.e008" id="pcbi.1011988.e008g" position="anchor"/><mml:math id="M8" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, block <italic toggle="yes">C</italic><sub>11</sub> with the same score, block <italic toggle="yes">C</italic><sub>12</sub> from <inline-formula id="pcbi.1011988.e009"><alternatives><graphic xlink:href="pcbi.1011988.e009" id="pcbi.1011988.e009g" position="anchor"/><mml:math id="M9" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, and finally, blocks <italic toggle="yes">C</italic><sub>13</sub>−<italic toggle="yes">C</italic><sub>15</sub> from <inline-formula id="pcbi.1011988.e010"><alternatives><graphic xlink:href="pcbi.1011988.e010" id="pcbi.1011988.e010g" position="anchor"/><mml:math id="M10" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>.</p>
        </caption>
        <graphic xlink:href="pcbi.1011988.g006" position="float"/>
      </fig>
      <p>Firstly, TPMA reorders the sequences in each initial alignment <italic toggle="yes">A</italic><sub><italic toggle="yes">i</italic></sub> to match the order of the original dataset <italic toggle="yes">R</italic> and computes the sum of pairs (SP) score for each reordered alignment <inline-formula id="pcbi.1011988.e011"><alternatives><graphic xlink:href="pcbi.1011988.e011.jpg" id="pcbi.1011988.e011g" position="anchor"/><mml:math id="M11" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. Subsequently, the characters except for the 26 uppercase and lowercase English letters are removed from the sequences in <inline-formula id="pcbi.1011988.e012"><alternatives><graphic xlink:href="pcbi.1011988.e012.jpg" id="pcbi.1011988.e012g" position="anchor"/><mml:math id="M12" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <italic toggle="yes">R</italic>, and then the consistency of each <inline-formula id="pcbi.1011988.e013"><alternatives><graphic xlink:href="pcbi.1011988.e013.jpg" id="pcbi.1011988.e013g" position="anchor"/><mml:math id="M13" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> with <italic toggle="yes">R</italic> is checked. The alignments that differ from <italic toggle="yes">R</italic> will be deleted. In the end, we acquire a subset of validated initial alignments, denoted as <inline-formula id="pcbi.1011988.e014"><alternatives><graphic xlink:href="pcbi.1011988.e014.jpg" id="pcbi.1011988.e014g" position="anchor"/><mml:math id="M14" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, where <italic toggle="yes">m</italic>≤<italic toggle="yes">n</italic>.</p>
      <p>Subsequently, we merged all validated initial alignments in descending order according to the SP score. We first combine the two alignments <inline-formula id="pcbi.1011988.e015"><alternatives><graphic xlink:href="pcbi.1011988.e015.jpg" id="pcbi.1011988.e015g" position="anchor"/><mml:math id="M15" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1011988.e016"><alternatives><graphic xlink:href="pcbi.1011988.e016.jpg" id="pcbi.1011988.e016g" position="anchor"/><mml:math id="M16" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> with the highest SP scores to get <italic toggle="yes">A</italic><sub><italic toggle="yes">tmp</italic>1</sub>, then merge <italic toggle="yes">A</italic><sub><italic toggle="yes">tmp</italic>1</sub> and <inline-formula id="pcbi.1011988.e017"><alternatives><graphic xlink:href="pcbi.1011988.e017.jpg" id="pcbi.1011988.e017g" position="anchor"/><mml:math id="M17" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> with the third highest SP score to obtain <italic toggle="yes">A</italic><sub><italic toggle="yes">tmp</italic>2</sub>, and continue this process a total of <italic toggle="yes">m</italic>−1 times to generate the final alignment <italic toggle="yes">A</italic><sub><italic toggle="yes">final</italic></sub>. <italic toggle="yes">A</italic><sub><italic toggle="yes">final</italic></sub> combines blocks with higher SP scores from the initial alignments, resulting in a refined alignment (<xref rid="pcbi.1011988.g006" ref-type="fig">Fig 6A</xref>.)</p>
    </sec>
    <sec id="sec009">
      <title>The combination of two initial alignments</title>
      <p>Our research focuses on partitioning two initial alignments into block pairs with the same sequence fragments, as depicted in <xref rid="pcbi.1011988.g006" ref-type="fig">Fig 6B</xref>, including the following three steps:</p>
    </sec>
    <sec id="sec010">
      <title>Recode the initial alignments</title>
      <p>After checking the initial alignments, the sequences in all the remaining alignments are in the same order but probably inserted with gaps in different positions. TPMA first recodes the remaining alignments by mapping gaps to 0 and all the other characters to 1. This recoding ensures that the base composition of each sequence becomes irrelevant, facilitating the identification of gap insertion positions. As shown in <xref rid="pcbi.1011988.g006" ref-type="fig">Fig 6B</xref><sub>i</sub>, TPMA recodes <inline-formula id="pcbi.1011988.e018"><alternatives><graphic xlink:href="pcbi.1011988.e018.jpg" id="pcbi.1011988.e018g" position="anchor"/><mml:math id="M18" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1011988.e019"><alternatives><graphic xlink:href="pcbi.1011988.e019.jpg" id="pcbi.1011988.e019g" position="anchor"/><mml:math id="M19" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> to obtain binary strings consisting of only 0s and 1s.</p>
    </sec>
    <sec id="sec011">
      <title>Find the cutting sites</title>
      <p>Two pointers, <italic toggle="yes">P</italic><sub>1</sub> and <italic toggle="yes">P</italic><sub>2</sub>, independently traverse their respective recoded alignments and simultaneously record their corresponding "pace," denoted by <italic toggle="yes">pace</italic><sub>1</sub> and <italic toggle="yes">pace</italic><sub>2</sub>. The “pace” is an array that records the cumulative count of "1"s scanned in each sequence up to the current column. (<xref rid="pcbi.1011988.g006" ref-type="fig">Fig 6B</xref><sub>ii</sub>). <italic toggle="yes">position</italic><sub>1</sub> and <italic toggle="yes">position</italic><sub>2</sub> respectively, keep track of the current column in the alignments where pointers <italic toggle="yes">P</italic><sub>1</sub> and <italic toggle="yes">P</italic><sub>2</sub> are located. Initializing the arrays <italic toggle="yes">pace</italic><sub>1</sub> and <italic toggle="yes">pace</italic><sub>2</sub>, both with length is the number of sequences, to zero, and setting <italic toggle="yes">position</italic><sub>1</sub> and <italic toggle="yes">position</italic><sub>2</sub> to 0 indicates that the two pointers are at column 0 and in their initial state.</p>
      <p>Move a pointer arbitrarily. If <italic toggle="yes">P</italic><sub>1</sub> scans first, when the pace of <italic toggle="yes">P</italic><sub>1</sub> is greater (any number in <italic toggle="yes">pace</italic><sub>1</sub> is greater than the corresponding number in <italic toggle="yes">pace</italic><sub>2</sub> in the same index) than that of <italic toggle="yes">P</italic><sub>2</sub>, <italic toggle="yes">P</italic><sub>1</sub> stops scanning and <italic toggle="yes">P</italic><sub>2</sub> starts to scan. Similarly, if the pace of <italic toggle="yes">P</italic><sub>2</sub> becomes greater than that of <italic toggle="yes">P</italic><sub>1</sub>, <italic toggle="yes">P</italic><sub>2</sub> stops scanning, and <italic toggle="yes">P</italic><sub>1</sub> continues to scan. Repeat this process alternately until both pointers (<italic toggle="yes">P</italic><sub>1</sub> and <italic toggle="yes">P</italic><sub>2</sub>) have scanned all the columns in their respective alignments. When the pace is the same, the current columns (<italic toggle="yes">position</italic><sub>1</sub> and <italic toggle="yes">position</italic><sub>2</sub>) of <italic toggle="yes">P</italic><sub>1</sub> and <italic toggle="yes">P</italic><sub>2</sub> represent the cutting sites corresponding to the two alignments (the columns with the bold number in <xref rid="pcbi.1011988.g006" ref-type="fig">Fig 6B</xref><sub>ii</sub>). Assuming the sequence lengths of recoded <italic toggle="yes">Seq</italic><sub>1</sub> and <italic toggle="yes">Seq</italic><sub>2</sub> are n and m respectively, where <italic toggle="yes">n</italic> is less than <italic toggle="yes">m</italic>, the time complexity of completing the finding cutting point algorithm is <italic toggle="yes">O</italic>(<italic toggle="yes">max</italic>(<italic toggle="yes">n</italic>, <italic toggle="yes">m</italic>)), specifically <italic toggle="yes">O</italic>(<italic toggle="yes">n</italic>). The pseudocode for finding cutting sites is shown in Algorithm 1.</p>
      <p specific-use="line"><bold>Algorithm 1</bold> Find the cutting sites</p>
      <p specific-use="line"><bold>Input:</bold> two recoded alignments <italic toggle="yes">Seq</italic><sub>1</sub> and <italic toggle="yes">Seq</italic><sub>2</sub>, both are DNA or RNA sequences with the same sequence order.</p>
      <p specific-use="line"><bold>Output:</bold> two lists of cutting sites <italic toggle="yes">L</italic><sub>1</sub> and <italic toggle="yes">L</italic><sub>2</sub></p>
      <p specific-use="line"><bold>Function</bold> CUTTING_SITES (<italic toggle="yes">Seq</italic><sub>1</sub>, <italic toggle="yes">Seq</italic><sub>2</sub>)</p>
      <p specific-use="line"> Let <italic toggle="yes">L</italic><sub>1</sub> and <italic toggle="yes">L</italic><sub>2</sub> be the new lists</p>
      <p specific-use="line">Let <italic toggle="yes">P</italic><sub>1</sub> and <italic toggle="yes">P</italic><sub>2</sub> be the two pointers of <italic toggle="yes">Seq</italic><sub>1</sub> and <italic toggle="yes">Seq</italic><sub>2</sub>, respectively</p>
      <p specific-use="line">Let <italic toggle="yes">pace</italic><sub>1</sub> and <italic toggle="yes">pace</italic><sub>2</sub> be the recording of the “pace” of <italic toggle="yes">P</italic><sub>1</sub> and <italic toggle="yes">P</italic><sub>2</sub>,</p>
      <p specific-use="line">Let <italic toggle="yes">position</italic><sub>1</sub> and <italic toggle="yes">position</italic><sub>2</sub> be the recording of the current positions of <italic toggle="yes">P</italic><sub>1</sub> and <italic toggle="yes">P</italic><sub>2</sub>, respectively</p>
      <p specific-use="line">Let <italic toggle="yes">col</italic><sub>1</sub> be the columns count of <italic toggle="yes">Seq</italic><sub>1</sub>, <italic toggle="yes">col</italic><sub>2</sub> be the columns count of <italic toggle="yes">Seq</italic><sub>2</sub></p>
      <p specific-use="line"> <bold>do{</bold></p>
      <p specific-use="line">  <bold>for (<italic toggle="yes">position</italic><sub>1</sub>! = <italic toggle="yes">col</italic><sub>1</sub> and</bold>
<italic toggle="yes">pace</italic><sub>2</sub>&lt;<italic toggle="yes">pace</italic><sub>1</sub>
<bold>= = FALSE)</bold></p>
      <p specific-use="line">  <bold>if (++</bold><italic toggle="yes">pace</italic><sub>1</sub> = = <italic toggle="yes">pace</italic><sub>2</sub><bold>)</bold></p>
      <p specific-use="line">    <italic toggle="yes">L</italic><sub>1</sub>.puch_back(<italic toggle="yes">position</italic><sub>1</sub>)</p>
      <p specific-use="line">    <italic toggle="yes">L</italic><sub>2</sub>.puch_back(<italic toggle="yes">position</italic><sub>2</sub>)</p>
      <p specific-use="line">   <bold>end if</bold></p>
      <p specific-use="line">   <bold>end for</bold></p>
      <p specific-use="line">  <bold>for (<italic toggle="yes">position</italic><sub>2</sub>! = <italic toggle="yes">col</italic><sub>2</sub> and</bold>
<italic toggle="yes">pace</italic><sub>1</sub>&lt;<italic toggle="yes">pace</italic><sub>2</sub>
<bold>= = FALSE)</bold></p>
      <p specific-use="line">  <bold>if (++</bold>
<italic toggle="yes">pace</italic><sub>2</sub> = = <italic toggle="yes">pace</italic><sub>1</sub><bold>)</bold></p>
      <p specific-use="line">    <italic toggle="yes">L</italic><sub>1</sub>.puch_back(<italic toggle="yes">position</italic><sub>1</sub>)</p>
      <p specific-use="line">    <italic toggle="yes">L</italic><sub>2</sub>.puch_back(<italic toggle="yes">position</italic><sub>2</sub>)</p>
      <p specific-use="line">   <bold>end if</bold></p>
      <p specific-use="line">   <bold>end for</bold></p>
      <p specific-use="line">  <bold>}while (<italic toggle="yes">position</italic><sub>1</sub>! = <italic toggle="yes">col</italic><sub>1</sub></bold> or <bold><italic toggle="yes">position</italic><sub>2</sub>! = <italic toggle="yes">col</italic><sub>2</sub>)</bold></p>
      <p specific-use="line">  <bold>return <italic toggle="yes">L</italic><sub>1</sub></bold> and <italic toggle="yes">L</italic><sub>2</sub></p>
      <p specific-use="line">
        <bold>end Function</bold>
      </p>
    </sec>
    <sec id="sec012">
      <title>Choose superior blocks based on the SP score</title>
      <p>According to all the identified cutting sites, the two initial alignments are partitioned into an equal number of blocks, and the blocks containing identical sequence fragments are referred to as one block pair. After calculating the SP score of each block pair, the block with the higher SP score is merged into the combined alignment (<xref rid="pcbi.1011988.g006" ref-type="fig">Fig 6B</xref><sub>iii</sub>). The SP score is calculated as shown in <xref rid="pcbi.1011988.e020" ref-type="disp-formula">Eq 1</xref>.</p>
      <disp-formula id="pcbi.1011988.e020">
        <alternatives>
          <graphic xlink:href="pcbi.1011988.e020.jpg" id="pcbi.1011988.e020g" position="anchor"/>
          <mml:math id="M20" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mi>S</mml:mi>
              <mml:mi>P</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mo stretchy="false">∑</mml:mo>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>L</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mrow>
                  <mml:mi>f</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </alternatives>
        <label>(1)</label>
      </disp-formula>
      <p>The SP score is obtained by summing the scores of the <italic toggle="yes">L</italic> columns, where <italic toggle="yes">f</italic>(<italic toggle="yes">k</italic>) represents the score of the <italic toggle="yes">k</italic>-th column, and <italic toggle="yes">L</italic> denotes the total number of columns in the block. The calculation method for <italic toggle="yes">f</italic>(<italic toggle="yes">k</italic>) is shown in <xref rid="pcbi.1011988.e021" ref-type="disp-formula">Eq 2</xref>.</p>
      <disp-formula id="pcbi.1011988.e021">
        <alternatives>
          <graphic xlink:href="pcbi.1011988.e021.jpg" id="pcbi.1011988.e021g" position="anchor"/>
          <mml:math id="M21" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mi>f</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mrow>
                <mml:mi>k</mml:mi>
              </mml:mrow>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mo stretchy="false">∑</mml:mo>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mo stretchy="false">∑</mml:mo>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo>≠</mml:mo>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mrow>
                      <mml:mi>s</mml:mi>
                      <mml:mi>c</mml:mi>
                      <mml:mi>o</mml:mi>
                      <mml:mi>r</mml:mi>
                      <mml:mi>e</mml:mi>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mrow>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </alternatives>
        <label>(2)</label>
      </disp-formula>
      <p>Here, <italic toggle="yes">N</italic> is the number of sequences in the block, and <italic toggle="yes">score</italic>(<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>) represents the score of aligned pair in the <italic toggle="yes">i</italic>-th row and <italic toggle="yes">j</italic>-th row. If the aligned pair is matched (both characters are letters and they are the same), a score of 1 is assigned. For mismatched pairs (both characters are letters but different), a score of -1 is given. When one character is a letter and the other is a gap, a score of -2 is provided. Otherwise, a score of 0 is assigned.</p>
    </sec>
    <sec id="sec013">
      <title>Datasets</title>
      <p>The experiments utilized ten nucleotide datasets, comprising six real datasets and four simulated datasets (<xref rid="pcbi.1011988.s004" ref-type="supplementary-material">S1 Table</xref>). Challenges arose for certain Multiple Sequence Alignment (MSA) tools, such as Dialign-TX [<xref rid="pcbi.1011988.ref013" ref-type="bibr">13</xref>] and T-Coffee [<xref rid="pcbi.1011988.ref014" ref-type="bibr">14</xref>], in aligning datasets with extended sequence lengths or numerous sequences. We conducted multiple random samplings or partitioned the real dataset to reduce its size, generating multiple sub-datasets as test datasets. This approach helped eliminate the randomness and variability of the experimental results.</p>
      <p>The six real datasets consist of five DNA datasets and one RNA dataset. (1) The human mitochondrial (mt) genomes dataset comprised 672 human mitochondrial genomes, ranging from a maximum length of 16579 bp to a minimum of 16556 bp [<xref rid="pcbi.1011988.ref015" ref-type="bibr">15</xref>]. We created sub-datasets by randomly selecting 30 sequences without replacement, and this procedure was repeated four times (<xref rid="pcbi.1011988.s005" ref-type="supplementary-material">S2 Table</xref>). (2) The hyper-variable segment II (HVS-II) dataset consisted of 100 sequences extracted from the HVS-II control region of the central European human mitochondrial genomes [<xref rid="pcbi.1011988.ref016" ref-type="bibr">16</xref>], retrieved from the GenBank database (accession numbers: KF601094-KF601193). The dataset was subsequently partitioned into ten sub-datasets (<xref rid="pcbi.1011988.s006" ref-type="supplementary-material">S3 Table</xref>). (3) The 16S ribosomal RNA (rRNA) dataset encompassed 108,413 DNA sequences encoding RNA found in bacteria and archaea, with an approximate length of 1.5 kb [<xref rid="pcbi.1011988.ref017" ref-type="bibr">17</xref>]. We created eight sub-datasets for this dataset, each containing 100 sequences sampled randomly without replacement (<xref rid="pcbi.1011988.s007" ref-type="supplementary-material">S4 Table</xref>). (4) The 23S rRNA dataset encompassed 641 sequences of Mycobacterium 23S rRNA, sourced from the SILVA rRNA database (<ext-link xlink:href="http://www.arb-silva.de/" ext-link-type="uri">http://www.arb-silva.de/</ext-link>) for bacteria, archaea, and eukaryotes. Spanning lengths from 1909 to 3485 bp, these sequences were partitioned into ten groups (<xref rid="pcbi.1011988.s008" ref-type="supplementary-material">S5 Table</xref>). (5) The respiratory syndrome coronavirus 2 (SARS-CoV-2) is an RNA virus that causes the COVID-19 pandemic. Two datasets [<xref rid="pcbi.1011988.ref018" ref-type="bibr">18</xref>] were derived from the GISAID website (<ext-link xlink:href="https://www.gisaid.org/" ext-link-type="uri">https://www.gisaid.org</ext-link>, updated November 11, 2021.) The SARS-CoV-2_20200301 datasets contain 156 sequences (29409 to 29927 bp) collected on March 1, 2020, and were divided into four sub-datasets (<xref rid="pcbi.1011988.s009" ref-type="supplementary-material">S6 Table</xref>). (6) The SARS-CoV-2_20200417 datasets feature 1020 sequences (29409 to 29927 bp) collected on April 17, 2020. From this, we randomly selected 100 sequences without replacement to create a sub-dataset, and this process was repeated four times (<xref rid="pcbi.1011988.s010" ref-type="supplementary-material">S7 Table</xref>).</p>
      <p>Two of the four simulated datasets were generated using hierarchical tree simulation to obtain 16S-like and 23S-like rRNA datasets. This simulation was carried out using INDELible v1.03 [<xref rid="pcbi.1011988.ref019" ref-type="bibr">19</xref>], and the substitution models were based on estimates obtained from 3000 16S rRNA and 641 Mycobacterium 23S rRNA alignments (as previously mentioned), utilizing IQ-TREE v2.2.0-beta [<xref rid="pcbi.1011988.ref020" ref-type="bibr">20</xref>]. One hundred 16S rRNA sequences and Mycobacterium 23S rRNA sequences, randomly chosen from the datasets as mentioned above, were aligned to construct the simulation trees. Subsequently, the process of generating the simulation 16S-like and 23S-like datasets was rooted in these two simulation trees. Each tree’s branch length was assigned a random value from 0 to 1 (NON-ULTRAMETRIC). The simulated sequence lengths were set at 1.5 kb for 16S-like rRNA and 4 kb for 23S-like rRNA. The indel model parameter used was LAV 5 50, with insertion and deletion rates of 0.01 and 0.1, respectively. To simulate datasets with varying mean similarities, the tree length (sum of branch lengths) was adjusted to achieve mean similarities of 99%, 98%, 97%, 96%, 95%, 94%, 93%, 92%, 91%, 90%, 85%, 80%, 75%, and 70%. The mean similarity represents the average of similarities between any two sequences within the dataset (<ext-link xlink:href="https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py" ext-link-type="uri">https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py</ext-link>), determined by the percentage of matched characters in their pairwise alignments conducted using MAFFT. Detailed information regarding these two sets of 14 sub-datasets can be found in <xref rid="pcbi.1011988.s011" ref-type="supplementary-material">S8 Table</xref>. Every sub-dataset included three replicates, each containing 100 simulated sequences. The mean length is the average of the average sequence lengths from the three replicates.</p>
      <p>The remaining two datasets are simulated CIPRES-128 and CIPRES-256 rRNA datasets evolved from the same root rRNA sequence on the trees featuring 128 and 256 taxa, respectively (<xref rid="pcbi.1011988.s012" ref-type="supplementary-material">S9 Table</xref>). These datasets were downloaded from trials 1 to 10 on the CIPRES SIMULATION DATA website (<ext-link xlink:href="https://kim.bio.upenn.edu/software/csd.shtml" ext-link-type="uri">https://kim.bio.upenn.edu/software/csd.shtml</ext-link>). The simulation parameters were adjusted to ensure that the simulated sequences mirror authentic small subunit rRNA (ssu rRNA) sequences regarding sequence identity, indel count, the ratio between substitutions and indels, and other relevant characteristics. The datasets were formatted in NEXUS format. The Nexus to Fasta Sequence Convert tool (<ext-link xlink:href="http://www.bugaco.com/" ext-link-type="uri">http://www.bugaco.com</ext-link>) was utilized for conversion into FASTA format to obtain the reference sequences. Subsequently, gaps were removed from the reference to derive the unaligned test datasets.</p>
      <p>Sequence similarity is computed for every dataset as the ratio of matching base pairs in all pairwise alignments (generated using MAFFT) within a sub-dataset. The script for this computation is available on <ext-link xlink:href="https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py" ext-link-type="uri">https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py</ext-link>. Lastly, employ Python’s Matplotlib library to generate a histogram depicting the distribution of sequence similarity.</p>
    </sec>
    <sec id="sec014">
      <title>Software versions and operating parameters involved in this study</title>
      <p>Furthermore, the experiment involved initial alignments obtained from eleven MSA tools: ClustalW2 [<xref rid="pcbi.1011988.ref021" ref-type="bibr">21</xref>], Dialign-TX, HAlign3 [<xref rid="pcbi.1011988.ref022" ref-type="bibr">22</xref>], Kalign3 [<xref rid="pcbi.1011988.ref023" ref-type="bibr">23</xref>], MAFFT, MUSCLE3, MUSCLE5 [<xref rid="pcbi.1011988.ref024" ref-type="bibr">24</xref>], PCMA [<xref rid="pcbi.1011988.ref025" ref-type="bibr">25</xref>], POA[<xref rid="pcbi.1011988.ref026" ref-type="bibr">26</xref>], T-Coffee, and WMSA2[<xref rid="pcbi.1011988.ref027" ref-type="bibr">27</xref>]. The identical software versions and running commands were used for obtaining initial alignments by TPMA and M-Coffee, with detailed information provided in <xref rid="pcbi.1011988.s013" ref-type="supplementary-material">S10 Table</xref>. In addition, the running commands of TPMA and M-Coffee merging the initial alignment from different MSA tools are shown in <xref rid="pcbi.1011988.s014" ref-type="supplementary-material">S11 Table</xref>.</p>
    </sec>
    <sec id="sec015">
      <title>Evaluation and experimental environment</title>
      <p>When evaluating alignment quality for the six real datasets, we employed the average sum of pairs (SP) score, denoted as aSP score, which represents the SP score divided by the number of sequence pairs, for accuracy assessment. The penalty parameters remained consistent with those detailed in the Methods 4.2.3 section. Regarding the four simulated datasets, in addition to the aSP score, we incorporated the Q score (the number of correctly aligned base pairs divided by the aligned pairs in the reference) and the TC score (the number of correctly aligned columns divided by aligned columns in the reference), both computed using the qscore program (<ext-link xlink:href="http://www.drive5.com/bench/" ext-link-type="uri">http://www.drive5.com/bench/</ext-link>), to gauge the deviation between alignment outcomes and reference alignments. All experiments were conducted on a server running the Ubuntu Linux operating system, equipped with an Intel(R) Xeon(R) Platinum 8168 CPU operating at a clock speed of 2.7 GHz and 1TB RAM.</p>
    </sec>
  </sec>
  <sec id="sec016" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1011988.s001" position="float" content-type="local-data">
      <label>S1 Fig</label>
      <caption>
        <title>The aSP score of the combination by sequential merging of initial alignments from MSA tools based on ranking by aSP, Q, and TC scores.</title>
        <p>The 14 subplots illustrate the results of 23S-like rRNA sub- datasets with different similarities: 99%, 98%, 97%, 96%, 95%, 94%, 93%, 92%, 91%, 90%, 85%, 80%, 75%, 70%. The points on each subplot represent the averages of three replicates. The aSP score-based ranking (the orange line) reveals that the Top 2 combination consists of T-Coffee and MUSCLE3, followed by the Top 3 combination of T-Coffee, MUSCLE3, and MAFFT, and so forth for subsequent combinations. Regarding Q scores ranking (the blue line), the Top 2 combination features T-Coffee and MUSCLE3, followed by the Top 3 combination of T-Coffee, MUSCLE3, and ClustalW2, and so on. When ranked by TC scores (the red line), the Top 2 combination consists of ClustalW2 and PCMA, with the Top 3 being ClustalW2, PCMA, and T-Coffee, and so forth.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s001.eps"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s002" position="float" content-type="local-data">
      <label>S2 Fig</label>
      <caption>
        <title>The Q score of the combination by sequential merging of initial alignments from MSA tools based on ranking by aSP, Q, and TC scores.</title>
        <p>The plots depict the Q scores obtained by merging different initial alignment combinations across 14 23S-like rRNA sub-datasets. Each point displays the average of three replicates within the sub-dataset. The merged process is the same as described in. <xref rid="pcbi.1011988.s001" ref-type="supplementary-material">S1 Fig</xref> legend.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s002.eps"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s003" position="float" content-type="local-data">
      <label>S3 Fig</label>
      <caption>
        <title>The TC score of the combination by sequential merging of initial alignments from MSA tools based on ranking by average SP, Q, and TC scores.</title>
        <p>The TC scores from combining various initial alignment combinations across the 23S-like rRNA sub-datasets are shown in the 14 subplots. These sub-datasets exhibit different similarities: 99%, 98%, 97%, 96%, 95%, 94%, 93%, 92%, 91%, 90%, 85%, 80%, 75%, 70%. All points on each subplot are the averages of three replicates. The merging process follows the same steps as described in <xref rid="pcbi.1011988.s001" ref-type="supplementary-material">S1 Fig</xref> legend.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s003.eps"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s004" position="float" content-type="local-data">
      <label>S1 Table</label>
      <caption>
        <title>The summary of datasets.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s004.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s005" position="float" content-type="local-data">
      <label>S2 Table</label>
      <caption>
        <title>The detailed information of human mitochondrial genomes sub-datasets.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s005.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s006" position="float" content-type="local-data">
      <label>S3 Table</label>
      <caption>
        <title>The detailed information of human mitochondrial HVS-II sub-datasets.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s006.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s007" position="float" content-type="local-data">
      <label>S4 Table</label>
      <caption>
        <title>The detailed information of 16S rRNA sub-datasets.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s007.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s008" position="float" content-type="local-data">
      <label>S5 Table</label>
      <caption>
        <title>The detailed information of 23S rRNA sub-datasets.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s008.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s009" position="float" content-type="local-data">
      <label>S6 Table</label>
      <caption>
        <title>The detailed information of SARS-CoV-2_20200301 sub-datasets.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s009.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s010" position="float" content-type="local-data">
      <label>S7 Table</label>
      <caption>
        <title>The detailed information of SARS-CoV-2_20200417 sub-datasets.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s010.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s011" position="float" content-type="local-data">
      <label>S8 Table</label>
      <caption>
        <title>The detailed information of 16S-like and 23S-like rRNA of 14 sub-datasets.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s011.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s012" position="float" content-type="local-data">
      <label>S9 Table</label>
      <caption>
        <title>The detailed information of simulated CIPRES-128 and CIPRES-256 rRNA sub-datasets.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s012.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s013" position="float" content-type="local-data">
      <label>S10 Table</label>
      <caption>
        <title>Version information and operating parameters of the involved tools.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s013.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s014" position="float" content-type="local-data">
      <label>S11 Table</label>
      <caption>
        <title>The running command of TPMA and M-Coffee.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s014.xlsx"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We are incredibly grateful to Dr. Cedric Notredame for his advice on using the M-Coffee package with MUSCLE5. Our appreciation extends to Franck A.P. Kouassi for his assistance in debugging the ReformAlign, Biffon Manyura Momanyi for engaging in valuable discussions, and Juntao Chen for his support in debugging WMSA2. Special acknowledgment is given to our other esteemed group members: Yanming Wei and Qinzhong Tian, whose critical insights greatly contributed to the preparation.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1011988.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Chao</surname><given-names>J</given-names></name>, <name><surname>Tang</surname><given-names>F</given-names></name>, <name><surname>Xu</surname><given-names>L</given-names></name>. <article-title>Developments in algorithms for sequence alignment: a review.</article-title><source>Biomolecules</source>. <year>2022</year>;<volume>12</volume>(<issue>4</issue>):<fpage>546</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3390/biom12040546</pub-id><?supplied-pmid 35454135?><pub-id pub-id-type="pmid">35454135</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Katoh</surname><given-names>K</given-names></name>, <name><surname>Standley</surname><given-names>DM</given-names></name>. <article-title>MAFFT multiple sequence alignment software version 7: improvements in performance and usability</article-title>. <source>Mol Biol Evol</source>. <year>2013</year>;<volume>30</volume>(<issue>4</issue>):<fpage>772</fpage>–<lpage>80</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/mst010</pub-id><?supplied-pmid 23329690?><pub-id pub-id-type="pmid">23329690</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Edgar</surname><given-names>RC</given-names></name>. <article-title>MUSCLE: multiple sequence alignment with high accuracy and high throughput</article-title>. <source>Nucleic Acids Res</source>. <year>2004</year>;<volume>32</volume>(<issue>5</issue>):<fpage>1792</fpage>–<lpage>7</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkh340</pub-id><?supplied-pmid 15034147?><pub-id pub-id-type="pmid">15034147</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Mokaddem</surname><given-names>A</given-names></name>, <name><surname>Hadj</surname><given-names>AB</given-names></name>, <name><surname>Elloumi</surname><given-names>M</given-names></name>. <article-title>Refin-Align: New Refinement Algorithm for Multiple Sequence Alignment.</article-title><source>Informatica</source>. <year>2019</year>;<volume>43</volume>(<issue>4</issue>).</mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Chakrabarti</surname><given-names>S</given-names></name>, <name><surname>Lanczycki</surname><given-names>CJ</given-names></name>, <name><surname>Panchenko</surname><given-names>AR</given-names></name>, <name><surname>Przytycka</surname><given-names>TM</given-names></name>, <name><surname>Thiessen</surname><given-names>PA</given-names></name>, <name><surname>Bryant</surname><given-names>SH</given-names></name>. <article-title>Refining multiple sequence alignments with conserved core regions</article-title>. <source>Nucleic Acids Res</source>. <year>2006</year>;<volume>34</volume>(<issue>9</issue>):<fpage>2598</fpage>–<lpage>606</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkl274</pub-id><?supplied-pmid 16707662?><pub-id pub-id-type="pmid">16707662</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Wallace</surname><given-names>IM</given-names></name>, <name><surname>Higgins</surname><given-names>DG</given-names></name>. <article-title>Evaluation of iterative alignment algorithms for multiple alignment</article-title>. <source>Bioinformatics</source>. <year>2005</year>;<volume>21</volume>(<issue>8</issue>):<fpage>1408</fpage>–<lpage>14</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/bti159</pub-id><?supplied-pmid 15564300?><pub-id pub-id-type="pmid">15564300</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Lyras</surname><given-names>DP</given-names></name>, <name><surname>Metzler</surname><given-names>D</given-names></name>. <article-title>ReformAlign: improved multiple sequence alignments using a profile-based meta-alignment approach.</article-title><source>BMC Bioinform</source>. <year>2014</year>;<volume>15</volume>:<fpage>1</fpage>–<lpage>18</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1471-2105-15-265</pub-id><?supplied-pmid 25099134?><pub-id pub-id-type="pmid">25099134</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Bucka-Lassen</surname><given-names>K</given-names></name>, <name><surname>Caprani</surname><given-names>O</given-names></name>, <name><surname>Hein</surname><given-names>J</given-names></name>. <article-title>Combining many multiple alignments in one improved alignment</article-title>. <source>Bioinformatics (Oxford, England).</source><year>1999</year>;<volume>15</volume>(<issue>2</issue>):<fpage>122</fpage>–<lpage>30</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/15.2.122</pub-id><?supplied-pmid 10089197?><pub-id pub-id-type="pmid">10089197</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Collingridge</surname><given-names>PW</given-names></name>, <name><surname>Kelly</surname><given-names>S</given-names></name>. <article-title>MergeAlign: improving multiple sequence alignment performance by dynamic reconstruction of consensus multiple sequence alignments.</article-title><source>BMC Bioinform</source>. <year>2012</year>;<volume>13</volume>:<fpage>1</fpage>–<lpage>10</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1471-2105-13-117</pub-id><?supplied-pmid 22646090?><pub-id pub-id-type="pmid">22646090</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Muller</surname><given-names>J</given-names></name>, <name><surname>Creevey</surname><given-names>CJ</given-names></name>, <name><surname>Thompson</surname><given-names>JD</given-names></name>, <name><surname>Arendt</surname><given-names>D</given-names></name>, <name><surname>Bork</surname><given-names>P</given-names></name>. <article-title>AQUA: automated quality improvement for multiple sequence alignments</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>2</issue>):<fpage>263</fpage>–<lpage>5</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btp651</pub-id><?supplied-pmid 19926669?><pub-id pub-id-type="pmid">19926669</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Thompson</surname><given-names>JD</given-names></name>, <name><surname>Thierry</surname><given-names>J-C</given-names></name>, <name><surname>Poch</surname><given-names>O</given-names></name>. <article-title>RASCAL: rapid scanning and correction of multiple sequence alignments</article-title>. <source>Bioinformatics</source>. <year>2003</year>;<volume>19</volume>(<issue>9</issue>):<fpage>1155</fpage>–<lpage>61</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btg133</pub-id><?supplied-pmid 12801878?><pub-id pub-id-type="pmid">12801878</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Wallace</surname><given-names>IM</given-names></name>, <name><surname>O’sullivan</surname><given-names>O</given-names></name>, <name><surname>Higgins</surname><given-names>DG</given-names></name>, <name><surname>Notredame</surname><given-names>C</given-names></name>. <article-title>M-Coffee: combining multiple sequence alignment methods with T-Coffee</article-title>. <source>Nucleic Acids Res</source>. <year>2006</year>;<volume>34</volume>(<issue>6</issue>):<fpage>1692</fpage>–<lpage>9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkl091</pub-id><?supplied-pmid 16556910?><pub-id pub-id-type="pmid">16556910</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Subramanian</surname><given-names>AR</given-names></name>, <name><surname>Kaufmann</surname><given-names>M</given-names></name>, <name><surname>Morgenstern</surname><given-names>B</given-names></name>. <article-title>DIALIGN-TX: greedy and progressive approaches for segment-based multiple sequence alignment</article-title>. <source>Algorithms Mol Biol</source>. <year>2008</year>;<volume>3</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>11</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1748-7188-3-6</pub-id><?supplied-pmid 18505568?><pub-id pub-id-type="pmid">18218120</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Notredame</surname><given-names>C</given-names></name>, <name><surname>Higgins</surname><given-names>DG</given-names></name>, <name><surname>Heringa</surname><given-names>J</given-names></name>. <article-title>T-Coffee: A novel method for fast and accurate multiple sequence alignment</article-title>. <source>J Mol Biol</source>. <year>2000</year>;<volume>302</volume>(<issue>1</issue>):<fpage>205</fpage>–<lpage>17</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1006/jmbi.2000.4042</pub-id><?supplied-pmid 10964570?><pub-id pub-id-type="pmid">10964570</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Tanaka</surname><given-names>M</given-names></name>, <name><surname>Cabrera</surname><given-names>VM</given-names></name>, <name><surname>González</surname><given-names>AM</given-names></name>, <name><surname>Larruga</surname><given-names>JM</given-names></name>, <name><surname>Takeyasu</surname><given-names>T</given-names></name>, <name><surname>Fuku</surname><given-names>N</given-names></name>, <etal>et al</etal>. <article-title>Mitochondrial genome variation in eastern Asia and the peopling of Japan</article-title>. <source>Genome Res</source>. <year>2004</year>;<volume>14</volume>(<issue>10a</issue>):<fpage>1832</fpage>–<lpage>50</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1101/gr.2286304</pub-id><?supplied-pmid 15466285?><pub-id pub-id-type="pmid">15466285</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Brandt</surname><given-names>G</given-names></name>, <name><surname>Haak</surname><given-names>W</given-names></name>, <name><surname>Adler</surname><given-names>CJ</given-names></name>, <name><surname>Roth</surname><given-names>C</given-names></name>, <name><surname>Szécsényi-Nagy</surname><given-names>A</given-names></name>, <name><surname>Karimnia</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Ancient DNA reveals key stages in the formation of central European mitochondrial genetic diversity</article-title>. <source>Science</source>. <year>2013</year>;<volume>342</volume>(<issue>6155</issue>):<fpage>257</fpage>–<lpage>61</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.1241844</pub-id><?supplied-pmid 24115443?><pub-id pub-id-type="pmid">24115443</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>DeSantis</surname><given-names>TZ</given-names></name>, <name><surname>Hugenholtz</surname><given-names>P</given-names></name>, <name><surname>Keller</surname><given-names>K</given-names></name>, <name><surname>Brodie</surname><given-names>EL</given-names></name>, <name><surname>Larsen</surname><given-names>N</given-names></name>, <name><surname>Piceno</surname><given-names>YM</given-names></name>, <etal>et al</etal>. <article-title>NAST: a multiple sequence alignment server for comparative analysis of 16S rRNA genes</article-title>. <source>Nucleic Acids Res</source>. <year>2006</year>;<volume>34</volume>(<issue>suppl_2</issue>):<fpage>W394</fpage>–<lpage>W9</lpage>.<pub-id pub-id-type="pmid">16845035</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Wei</surname><given-names>Y</given-names></name>, <name><surname>Zou</surname><given-names>Q</given-names></name>, <name><surname>Tang</surname><given-names>F</given-names></name>, <name><surname>Yu</surname><given-names>L</given-names></name>. <article-title>WMSA: a novel method for multiple sequence alignment of DNA sequences</article-title>. <source>Bioinformatics</source>. <year>2022</year>;<volume>38</volume>(<issue>22</issue>):<fpage>5019</fpage>–<lpage>25</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btac658</pub-id><?supplied-pmid 36179076?><pub-id pub-id-type="pmid">36179076</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Fletcher</surname><given-names>W</given-names></name>, <name><surname>Yang</surname><given-names>Z</given-names></name>. <article-title>INDELible: a flexible simulator of biological sequence evolution</article-title>. <source>Mol Biol Evol</source>. <year>2009</year>;<volume>26</volume>(<issue>8</issue>):<fpage>1879</fpage>–<lpage>88</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msp098</pub-id><?supplied-pmid 19423664?><pub-id pub-id-type="pmid">19423664</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Minh</surname><given-names>BQ</given-names></name>, <name><surname>Schmidt</surname><given-names>HA</given-names></name>, <name><surname>Chernomor</surname><given-names>O</given-names></name>, <name><surname>Schrempf</surname><given-names>D</given-names></name>, <name><surname>Woodhams</surname><given-names>MD</given-names></name>, <name><surname>Von Haeseler</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>IQ-TREE 2: new models and efficient methods for phylogenetic inference in the genomic era</article-title>. <source>Mol Biol Evol</source>. <year>2020</year>;<volume>37</volume>(<issue>5</issue>):<fpage>1530</fpage>–<lpage>4</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msaa015</pub-id><?supplied-pmid 32011700?><pub-id pub-id-type="pmid">32011700</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Larkin</surname><given-names>MA</given-names></name>, <name><surname>Blackshields</surname><given-names>G</given-names></name>, <name><surname>Brown</surname><given-names>NP</given-names></name>, <name><surname>Chenna</surname><given-names>R</given-names></name>, <name><surname>McGettigan</surname><given-names>PA</given-names></name>, <name><surname>McWilliam</surname><given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Clustal W and Clustal X version 2.0</article-title>. <source>Bioinformatics</source>. <year>2007</year>;<volume>23</volume>(<issue>21</issue>):<fpage>2947</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btm404</pub-id><?supplied-pmid 17846036?><pub-id pub-id-type="pmid">17846036</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Tang</surname><given-names>F</given-names></name>, <name><surname>Chao</surname><given-names>J</given-names></name>, <name><surname>Wei</surname><given-names>Y</given-names></name>, <name><surname>Yang</surname><given-names>F</given-names></name>, <name><surname>Zhai</surname><given-names>Y</given-names></name>, <name><surname>Xu</surname><given-names>L</given-names></name>, <etal>et al</etal>. <article-title>HAlign 3: fast multiple alignment of ultra-large numbers of similar DNA/RNA sequences</article-title>. <source>Mol Biol Evol</source>. <year>2022</year>;<volume>39</volume>(<issue>8</issue>):<fpage>msac166</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msac166</pub-id><?supplied-pmid 35915051?><pub-id pub-id-type="pmid">35915051</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Lassmann</surname><given-names>T</given-names></name>. <article-title>Kalign 3: multiple sequence alignment of large datasets.</article-title><source>Bioinformatics</source>. <year>2019</year>;<volume>36</volume>(<issue>6</issue>):<fpage>1928</fpage>–<lpage>9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btz795</pub-id><?supplied-pmid 31665271?><pub-id pub-id-type="pmid">31665271</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Edgar</surname><given-names>RC</given-names></name>. <article-title>Muscle5: High-accuracy alignment ensembles enable unbiased assessments of sequence homology and phylogeny.</article-title><source>Nat Commun</source>. <year>2022</year>;<volume>13</volume>(<issue>1</issue>):<fpage>6968</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-022-34630-w</pub-id><?supplied-pmid 36379955?><pub-id pub-id-type="pmid">36379955</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Pei</surname><given-names>J</given-names></name>, <name><surname>Sadreyev</surname><given-names>R</given-names></name>, <name><surname>Grishin</surname><given-names>NV</given-names></name>. <article-title>PCMA: fast and accurate multiple sequence alignment based on profile consistency</article-title>. <source>Bioinformatics</source>. <year>2003</year>;<volume>19</volume>(<issue>3</issue>):<fpage>427</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btg008</pub-id><?supplied-pmid 12584134?><pub-id pub-id-type="pmid">12584134</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Lee</surname><given-names>C</given-names></name>, <name><surname>Grasso</surname><given-names>C</given-names></name>, <name><surname>Sharlow</surname><given-names>MF</given-names></name>. <article-title>Multiple sequence alignment using partial order graphs</article-title>. <source>Bioinformatics</source>. <year>2002</year>;<volume>18</volume>(<issue>3</issue>):<fpage>452</fpage>–<lpage>64</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/18.3.452</pub-id><?supplied-pmid 11934745?><pub-id pub-id-type="pmid">11934745</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>J</given-names></name>, <name><surname>Chao</surname><given-names>J</given-names></name>, <name><surname>Liu</surname><given-names>H</given-names></name>, <name><surname>Yang</surname><given-names>F</given-names></name>, <name><surname>Zou</surname><given-names>Q</given-names></name>, <name><surname>Tang</surname><given-names>F</given-names></name>. <article-title>WMSA 2: a multiple DNA/RNA sequence alignment tool implemented with accurate progressive mode and a fast win-win mode combining the center star and progressive strategies.</article-title><source>Brief Bioinformatics</source>. <year>2023</year>:<fpage>bbad190</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bib/bbad190</pub-id><?supplied-pmid 37200156?><pub-id pub-id-type="pmid">37200156</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">11008887</article-id>
    <article-id pub-id-type="pmid">38557416</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011988</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-23-01927</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methods</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Computational Techniques</subject>
          <subj-group>
            <subject>Split-Decomposition Method</subject>
            <subj-group>
              <subject>Multiple Alignment Calculation</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Alignment</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>RNA</subject>
              <subj-group>
                <subject>Non-coding RNA</subject>
                <subj-group>
                  <subject>Ribosomal RNA</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Ribosomes</subject>
            <subj-group>
              <subject>Ribosomal RNA</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Cell biology</subject>
          <subj-group>
            <subject>Cellular structures and organelles</subject>
            <subj-group>
              <subject>Ribosomes</subject>
              <subj-group>
                <subject>Ribosomal RNA</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Bioenergetics</subject>
            <subj-group>
              <subject>Energy-Producing Organelles</subject>
              <subj-group>
                <subject>Mitochondria</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Structures and Organelles</subject>
            <subj-group>
              <subject>Energy-Producing Organelles</subject>
              <subj-group>
                <subject>Mitochondria</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Viruses</subject>
            <subj-group>
              <subject>RNA viruses</subject>
              <subj-group>
                <subject>Coronaviruses</subject>
                <subj-group>
                  <subject>SARS coronavirus</subject>
                  <subj-group>
                    <subject>SARS CoV 2</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Medical microbiology</subject>
            <subj-group>
              <subject>Microbial pathogens</subject>
              <subj-group>
                <subject>Viral pathogens</subject>
                <subj-group>
                  <subject>Coronaviruses</subject>
                  <subj-group>
                    <subject>SARS coronavirus</subject>
                    <subj-group>
                      <subject>SARS CoV 2</subject>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and health sciences</subject>
        <subj-group>
          <subject>Pathology and laboratory medicine</subject>
          <subj-group>
            <subject>Pathogens</subject>
            <subj-group>
              <subject>Microbial pathogens</subject>
              <subj-group>
                <subject>Viral pathogens</subject>
                <subj-group>
                  <subject>Coronaviruses</subject>
                  <subj-group>
                    <subject>SARS coronavirus</subject>
                    <subj-group>
                      <subject>SARS CoV 2</subject>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Viruses</subject>
            <subj-group>
              <subject>Viral pathogens</subject>
              <subj-group>
                <subject>Coronaviruses</subject>
                <subj-group>
                  <subject>SARS coronavirus</subject>
                  <subj-group>
                    <subject>SARS CoV 2</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Human Genomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Eukaryota</subject>
            <subj-group>
              <subject>Plants</subject>
              <subj-group>
                <subject>Trees</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>TPMA: A two pointers meta-alignment tool to ensemble different multiple nucleic acid sequence alignments</article-title>
      <alt-title alt-title-type="running-head">A meta-alignment tool to ensemble different multiple nucleic acid sequence alignments</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhai</surname>
          <given-names>Yixiao</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chao</surname>
          <given-names>Jiannan</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Yizheng</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0009-0002-1788-3084</contrib-id>
        <name>
          <surname>Zhang</surname>
          <given-names>Pinglu</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Tang</surname>
          <given-names>Furong</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-6406-1142</contrib-id>
        <name>
          <surname>Zou</surname>
          <given-names>Quan</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Institute of Fundamental and Frontier Sciences, University of Electronic Science and Technology of China, Chengdu, China</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Quzhou People’s Hospital, Quzhou Affiliated Hospital of Wenzhou Medical University, Quzhou, China</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Yangtze Delta Region Institute (Quzhou), University of Electronic Science and Technology of China, Quzhou, China</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Department of Basic Medical Sciences, School of Medicine, Tsinghua University, Beijing, China</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Gao</surname>
          <given-names>Xin</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>KAUST, SAUDI ARABIA</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors declare that they have no competing interests.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>Furong.TANG@hotmail.com</email> (FT); <email>zouquan@nclab.net</email> (QZ)</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <volume>20</volume>
    <issue>4</issue>
    <elocation-id>e1011988</elocation-id>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>3</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2024 Zhai et al</copyright-statement>
      <copyright-year>2024</copyright-year>
      <copyright-holder>Zhai et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1011988.pdf"/>
    <abstract>
      <p>Accurate multiple sequence alignment (MSA) is imperative for the comprehensive analysis of biological sequences. However, a notable challenge arises as no single MSA tool consistently outperforms its counterparts across diverse datasets. Users often have to try multiple MSA tools to achieve optimal alignment results, which can be time-consuming and memory-intensive. While the overall accuracy of certain MSA results may be lower, there could be local regions with the highest alignment scores, prompting researchers to seek a tool capable of merging these locally optimal results from multiple initial alignments into a globally optimal alignment. In this study, we introduce Two Pointers Meta-Alignment (TPMA), a novel tool designed for the integration of nucleic acid sequence alignments. TPMA employs two pointers to partition the initial alignments into blocks containing identical sequence fragments. It selects blocks with the high sum of pairs (SP) scores to concatenate them into an alignment with an overall SP score superior to that of the initial alignments. Through tests on simulated and real datasets, the experimental results consistently demonstrate that TPMA outperforms M-Coffee in terms of aSP, Q, and total column (TC) scores across most datasets. Even in cases where TPMA’s scores are comparable to M-Coffee, TPMA exhibits significantly lower running time and memory consumption. Furthermore, we comprehensively assessed all the MSA tools used in the experiments, considering accuracy, time, and memory consumption. We propose accurate and fast combination strategies for small and large datasets, which streamline the user tool selection process and facilitate large-scale dataset integration. The dataset and source code of TPMA are available on GitHub (<ext-link xlink:href="https://github.com/malabz/TPMA" ext-link-type="uri">https://github.com/malabz/TPMA</ext-link>).</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Accurate multiple sequence alignment (MSA) is vital for comprehensive biological sequence analysis. However, as no single MSA tool consistently outperforms others across diverse datasets, researchers must invest significant time exploring multiple tools to identify the most suitable one for their specific dataset. To address this, researchers seek tools that can merge locally optimal results from diverse initial alignments into a globally optimal alignment. Our novel approach, Two Pointers Meta-Alignment (TPMA), employs a two-pointer to partition initial alignments into blocks, selecting those with the higher sum of pairs (SP) scores for integration into a globally optimal alignment. TPMA consistently outperforms M-Coffee, demonstrating superior aSP, Q, and total column (TC) scores, coupled with faster running times and lower memory consumption. We present comprehensive assessments of various MSA tools, proposing efficient combination strategies for diverse datasets. Our tool, TPMA, and associated resources are publicly available on GitHub (<ext-link xlink:href="https://github.com/malabz/TPMA" ext-link-type="uri">https://github.com/malabz/TPMA</ext-link>), offering a valuable contribution to the field of evolutionary biology and streamlining the selection process for users dealing with large-scale datasets.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>No. 62131004</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-6406-1142</contrib-id>
          <name>
            <surname>Zou</surname>
            <given-names>Quan</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>No. 62271353</award-id>
        <principal-award-recipient>
          <name>
            <surname>Tang</surname>
            <given-names>Furong</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution>National Key R&amp;D Program of China</institution>
        </funding-source>
        <award-id>2022ZD0117700</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-6406-1142</contrib-id>
          <name>
            <surname>Zou</surname>
            <given-names>Quan</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution>Zhejiang Provincial Natural Science Foundation of China</institution>
        </funding-source>
        <award-id>LD24F020004</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-6406-1142</contrib-id>
          <name>
            <surname>Zou</surname>
            <given-names>Quan</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award005">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100018542</institution-id>
            <institution>Natural Science Foundation of Sichuan Province</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2022NSFSC0926</award-id>
        <principal-award-recipient>
          <name>
            <surname>Tang</surname>
            <given-names>Furong</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award006">
        <funding-source>
          <institution>Municipal Government of Quzhou</institution>
        </funding-source>
        <award-id>No. 2023D036</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-6406-1142</contrib-id>
          <name>
            <surname>Zou</surname>
            <given-names>Quan</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award007">
        <funding-source>
          <institution>Fellowship of China Postdoctoral Science Foundation</institution>
        </funding-source>
        <award-id>2023M731984,GZB20230365</award-id>
        <principal-award-recipient>
          <name>
            <surname>Tang</surname>
            <given-names>Furong</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>The work was supported by the National Natural Science Foundation of China (No. 62131004 to Q.Z.; No. 62271353 to F.T.), the National Key R&amp;D Program of China (No.2022ZD0117700 to Q.Z.), Zhejiang Provincial Natural Science Foundation of China (No. LD24F020004 to Q.Z.), the Natural Science Foundation of Sichuan Province (2022NSFSC0926 to F.T.), the Municipal Government of Quzhou (No. 2023D036 to Q.Z.) and the Fellowship of China Postdoctoral Science Foundation (2023M731984, GZB20230365 to F.T.). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="6"/>
      <table-count count="0"/>
      <page-count count="22"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2024-04-11</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The six real datasets consist of five DNA datasets and one RNA dataset. (1) The human mitochondrial (mt) genomes dataset comprised 672 human mitochondrial genomes, ranging from a maximum length of 16579 bp to a minimum of 16556 bp. We created sub-datasets by randomly selecting 30 sequences without replacement, and this procedure was repeated four times (Supplemental Table S2). (2) The hyper-variable segment II (HVS-II) dataset consisted of 100 sequences extracted from the HVS-II control region of the central European human mitochondrial genomes, retrieved from the GenBank database (accession numbers: KF601094-KF601193). The dataset was subsequently partitioned into ten sub-datasets. (3) The 16S ribosomal RNA (rRNA) dataset encompassed 108,413 DNA sequences encoding RNA found in bacteria and archaea, with an approximate length of 1.5 kb. We created eight sub-datasets for this dataset, each containing 100 sequences sampled randomly without replacement. (4) The 23S rRNA dataset encompassed 641 sequences of Mycobacterium 23S rRNA, sourced from the SILVA rRNA database (<ext-link xlink:href="http://www.arb-silva.de/" ext-link-type="uri">http://www.arb-silva.de/</ext-link>) for bacteria, archaea, and eukaryotes. Spanning lengths from 1909 to 3485 bp, these sequences were partitioned into ten groups (Supplemental Table S5). (5) The respiratory syndrome coronavirus 2 (SARS‑CoV‑2) is an RNA virus that causes the COVID-19 pandemic. Two datasets were derived from the GISAID website (<ext-link xlink:href="https://www.gisaid.org" ext-link-type="uri">https://www.gisaid.org</ext-link>, updated November 11, 2021.) The SARS‑CoV‑2_20200301 datasets contain 156 sequences (29409 to 29927 bp) collected on March 1, 2020, and were divided into four sub-datasets. (6) The SARS‑CoV‑2_20200417 datasets feature 1020 sequences (29409 to 29927 bp) collected on April 17, 2020. From this, we randomly selected 100 sequences without replacement to create a sub-dataset, and this process was repeated four times. Two of the four simulated datasets were generated using hierarchical tree simulation to obtain 16S-like and 23S-like rRNA datasets. This simulation was carried out using INDELible v1.03, and the substitution models were based on estimates obtained from 3000 16S rRNA and 641 Mycobacterium 23S rRNA alignments (as previously mentioned), utilizing IQ-TREE v2.2.0-beta. One hundred 16S rRNA sequences and Mycobacterium 23S rRNA sequences, randomly chosen from the datasets as mentioned above, were aligned to construct the simulation trees. Subsequently, the process of generating the simulation 16S-like and 23S-like datasets was rooted in these two simulation trees. Each tree's branch length was assigned a random value from 0 to 1 (NON-ULTRAMETRIC). The simulated sequence lengths were set at 1.5 kb for 16S-like rRNA and 4 kb for 23S-like rRNA. The indel model parameter used was LAV 5 50, with insertion and deletion rates of 0.01 and 0.1, respectively. To simulate datasets with varying mean similarities, the tree length (sum of branch lengths) was adjusted to achieve mean similarities of 99%, 98%, 97%, 96%, 95%, 94%, 93%, 92%, 91%, 90%, 85%, 80%, 75%, and 70%. The mean similarity represents the average of similarities between any two sequences within the dataset (<ext-link xlink:href="https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py" ext-link-type="uri">https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py</ext-link>), determined by the percentage of matched characters in their pairwise alignments conducted using MAFFT. Detailed information regarding these two sets of 14 sub-datasets can be found in Table S8. Every sub-dataset included three replicates, each containing 100 simulated sequences. The mean length is the average of the average sequence lengths from the three replicates. The remaining two datasets are simulated CIPRES-128 and CIPRES-256 rRNA datasets evolved from the same root rRNA sequence on the trees featuring 128 and 256 taxa, respectively (Supplemental Table S9). These datasets were downloaded from trials 1 to 10 on the CIPRES SIMULATION DATA website (<ext-link xlink:href="https://kim.bio.upenn.edu/software/csd.shtml" ext-link-type="uri">https://kim.bio.upenn.edu/software/csd.shtml</ext-link>). The simulation parameters were adjusted to ensure that the simulated sequences mirror authentic small subunit rRNA (ssu rRNA) sequences regarding sequence identity, indel count, the ratio between substitutions and indels, and other relevant characteristics. The datasets were formatted in NEXUS format. The Nexus to Fasta Sequence Convert tool (<ext-link xlink:href="http://www.bugaco.com" ext-link-type="uri">http://www.bugaco.com</ext-link>) was utilized for conversion into FASTA format to obtain the reference sequences. Subsequently, gaps were removed from the reference to derive the unaligned test datasets. Sequence similarity is computed for every dataset as the ratio of matching base pairs in all pairwise alignments (generated using MAFFT) within a sub-dataset. The script for this computation is available on <ext-link xlink:href="https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py" ext-link-type="uri">https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py</ext-link>. Lastly, employ Python's Matplotlib library to generate a histogram depicting the distribution of sequence similarity.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The six real datasets consist of five DNA datasets and one RNA dataset. (1) The human mitochondrial (mt) genomes dataset comprised 672 human mitochondrial genomes, ranging from a maximum length of 16579 bp to a minimum of 16556 bp. We created sub-datasets by randomly selecting 30 sequences without replacement, and this procedure was repeated four times (Supplemental Table S2). (2) The hyper-variable segment II (HVS-II) dataset consisted of 100 sequences extracted from the HVS-II control region of the central European human mitochondrial genomes, retrieved from the GenBank database (accession numbers: KF601094-KF601193). The dataset was subsequently partitioned into ten sub-datasets. (3) The 16S ribosomal RNA (rRNA) dataset encompassed 108,413 DNA sequences encoding RNA found in bacteria and archaea, with an approximate length of 1.5 kb. We created eight sub-datasets for this dataset, each containing 100 sequences sampled randomly without replacement. (4) The 23S rRNA dataset encompassed 641 sequences of Mycobacterium 23S rRNA, sourced from the SILVA rRNA database (<ext-link xlink:href="http://www.arb-silva.de/" ext-link-type="uri">http://www.arb-silva.de/</ext-link>) for bacteria, archaea, and eukaryotes. Spanning lengths from 1909 to 3485 bp, these sequences were partitioned into ten groups (Supplemental Table S5). (5) The respiratory syndrome coronavirus 2 (SARS‑CoV‑2) is an RNA virus that causes the COVID-19 pandemic. Two datasets were derived from the GISAID website (<ext-link xlink:href="https://www.gisaid.org" ext-link-type="uri">https://www.gisaid.org</ext-link>, updated November 11, 2021.) The SARS‑CoV‑2_20200301 datasets contain 156 sequences (29409 to 29927 bp) collected on March 1, 2020, and were divided into four sub-datasets. (6) The SARS‑CoV‑2_20200417 datasets feature 1020 sequences (29409 to 29927 bp) collected on April 17, 2020. From this, we randomly selected 100 sequences without replacement to create a sub-dataset, and this process was repeated four times. Two of the four simulated datasets were generated using hierarchical tree simulation to obtain 16S-like and 23S-like rRNA datasets. This simulation was carried out using INDELible v1.03, and the substitution models were based on estimates obtained from 3000 16S rRNA and 641 Mycobacterium 23S rRNA alignments (as previously mentioned), utilizing IQ-TREE v2.2.0-beta. One hundred 16S rRNA sequences and Mycobacterium 23S rRNA sequences, randomly chosen from the datasets as mentioned above, were aligned to construct the simulation trees. Subsequently, the process of generating the simulation 16S-like and 23S-like datasets was rooted in these two simulation trees. Each tree's branch length was assigned a random value from 0 to 1 (NON-ULTRAMETRIC). The simulated sequence lengths were set at 1.5 kb for 16S-like rRNA and 4 kb for 23S-like rRNA. The indel model parameter used was LAV 5 50, with insertion and deletion rates of 0.01 and 0.1, respectively. To simulate datasets with varying mean similarities, the tree length (sum of branch lengths) was adjusted to achieve mean similarities of 99%, 98%, 97%, 96%, 95%, 94%, 93%, 92%, 91%, 90%, 85%, 80%, 75%, and 70%. The mean similarity represents the average of similarities between any two sequences within the dataset (<ext-link xlink:href="https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py" ext-link-type="uri">https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py</ext-link>), determined by the percentage of matched characters in their pairwise alignments conducted using MAFFT. Detailed information regarding these two sets of 14 sub-datasets can be found in Table S8. Every sub-dataset included three replicates, each containing 100 simulated sequences. The mean length is the average of the average sequence lengths from the three replicates. The remaining two datasets are simulated CIPRES-128 and CIPRES-256 rRNA datasets evolved from the same root rRNA sequence on the trees featuring 128 and 256 taxa, respectively (Supplemental Table S9). These datasets were downloaded from trials 1 to 10 on the CIPRES SIMULATION DATA website (<ext-link xlink:href="https://kim.bio.upenn.edu/software/csd.shtml" ext-link-type="uri">https://kim.bio.upenn.edu/software/csd.shtml</ext-link>). The simulation parameters were adjusted to ensure that the simulated sequences mirror authentic small subunit rRNA (ssu rRNA) sequences regarding sequence identity, indel count, the ratio between substitutions and indels, and other relevant characteristics. The datasets were formatted in NEXUS format. The Nexus to Fasta Sequence Convert tool (<ext-link xlink:href="http://www.bugaco.com" ext-link-type="uri">http://www.bugaco.com</ext-link>) was utilized for conversion into FASTA format to obtain the reference sequences. Subsequently, gaps were removed from the reference to derive the unaligned test datasets. Sequence similarity is computed for every dataset as the ratio of matching base pairs in all pairwise alignments (generated using MAFFT) within a sub-dataset. The script for this computation is available on <ext-link xlink:href="https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py" ext-link-type="uri">https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py</ext-link>. Lastly, employ Python's Matplotlib library to generate a histogram depicting the distribution of sequence similarity.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Multiple sequence alignment (MSA) is a common technique for analyzing biological sequences, encompassing structure and function estimation, evolutionary relationship determination, gene identification, and more [<xref rid="pcbi.1011988.ref001" ref-type="bibr">1</xref>]. Hence, the precision of MSA directly shapes the outcomes of analyses in bioinformatics, holding paramount importance in discerning biological significance. However, due to its time-consuming nature, many MSA tools, like MAFFT [<xref rid="pcbi.1011988.ref002" ref-type="bibr">2</xref>] and MUSCLE3 [<xref rid="pcbi.1011988.ref003" ref-type="bibr">3</xref>], resort to heuristic methods to address computational complexities. Despite their extensive usage, tools employing heuristic methods exhibit two common limitations. Firstly, the persistence of an incorrectly inserted gap, adhering to the "once a gap, always a gap" rule, can influence subsequent alignments. The other issue is the presence of a local optimal trap. According to the greedy principle, the optimal solution for each subproblem may not necessarily be equivalent to the optimal solution for the global problem. To overcome the drawbacks above, researchers typically employ iterative optimization and meta-alignment methods to further enhance alignment accuracy.</p>
    <p>Iterative optimization involves refining the existing alignment by realigning potential low-quality regions, employing two partition methods: vertical and horizontal realigners. Refin-Align [<xref rid="pcbi.1011988.ref004" ref-type="bibr">4</xref>], a vertical realigner, partitions the initial alignment into blocks based on columns with identical bases. It then eliminates gaps within each block and realigns the sequences using Promalign. If the new alignment exhibits higher accuracy, it replaces the initial alignment. On the other hand, the horizontal realigners, including REFINER [<xref rid="pcbi.1011988.ref005" ref-type="bibr">5</xref>], RF [<xref rid="pcbi.1011988.ref006" ref-type="bibr">6</xref>], and ReformAlign [<xref rid="pcbi.1011988.ref007" ref-type="bibr">7</xref>], adopt distinct strategies. Similar to REFINER, RF randomly selects a sequence in each iteration and realigns it with the profile of the remaining sequences; if the accuracy of the new alignment improves, it serves as the input for the next iteration round until the objective function score converges or reaches the cycle limit. ReformAlign differs from the others by independently realigning all sequences within a single iterative round. This realignment is performed using a summarization profile constructed from the initial alignment. When new gaps are inserted into the profile, ReformAlign automatically switches to a profile fine-tuning mode to account for the new insertion(s), and once the profile is successfully updated, the realignment is restarted using the new profile until the new alignment is obtained after all sequences have been realigned. However, among the methods mentioned above, currently only ReformAlign is available.</p>
    <p>Meta-alignment, a process aimed at synthesizing multiple initial alignments, is employed to derive a high-accuracy alignment. The ComAlign algorithm [<xref rid="pcbi.1011988.ref008" ref-type="bibr">8</xref>] identifies qualitatively conservative blocks within the initial alignments and amalgamates them through dynamic programming to produce a novel alignment, often exhibiting improvements. MergeAlign [<xref rid="pcbi.1011988.ref009" ref-type="bibr">9</xref>] generates a weighted directed acyclic graph (DAG), wherein each node represents the site combinations of each column in the initial alignments. Each edge signifies a transition between two adjacent columns, and the weight of each edge corresponds to the number of initial alignments containing that particular transition (between two adjacent columns). Finally, the nodes (columns) in the maximum weight path form the merged alignment. AQUA [<xref rid="pcbi.1011988.ref010" ref-type="bibr">10</xref>], an automated quality improvement program for Multiple Sequence Alignment (MSA), initiates its process by generating two initial alignments through MUSCLE3 and MAFFT. These alignments are subsequently independently optimized using RASCAL [<xref rid="pcbi.1011988.ref011" ref-type="bibr">11</xref>], resulting in two refined alignments. In its culmination, the meta-alignment process yields the alignment with the highest accuracy among the four, determined by the NorMD score. The most widely utilized meta-alignment method is M-Coffee [<xref rid="pcbi.1011988.ref012" ref-type="bibr">12</xref>], which constructs a consistency library of each pair of residues with residue pairs from all other alignments to increase the weight of the aligned pairs accepted by most MSA tools. However, it is noteworthy that this inclusive approach implies that incorrectly aligned pairs prevalent across multiple alignments will also be weighted. Consequently, the accuracy of the M-Coffee meta-alignment can either be improved or diminished, depending on the accuracy of each individual MSA tool.</p>
    <p>In this study, we have developed TPMA, a meta-alignment tool for integrating nucleic acid sequence alignments, which employs a two-pointers approach to partition the initial alignments into blocks with identical sequence fragments and concatenate blocks with higher SP scores to form the final alignment. We tested TPMA, M-Coffee, and ReformAlign on four simulated and six real datasets. The results consistently show that TPMA outperforms M-Coffee in terms of aSP, Q, and TC scores across most datasets. Notably, in cases where TPMA scores closely align with M-Coffee, TPMA exhibits significantly lower time and memory consumption. In datasets with varying similarity spans, ReformAlign optimization led to approximately 50% of alignments experiencing decreased TC scores in simulated datasets. Thus, TPMA exhibits superior performance compared to both M-Coffee and ReformAlign. To save time for users while selecting MSA tools, we screened all MSA tools used in our experiments based on accuracy, time, and memory consumption. Therefore, we propose accurate and fast combination strategies to integrate small and large datasets, ensuring efficient integration while upholding alignment accuracy.</p>
  </sec>
  <sec sec-type="results" id="sec002">
    <title>Results</title>
    <sec id="sec003">
      <title>TPMA outperforms M-Coffee in alignment quality, running time, and memory consumption</title>
      <p>In this experiment, we employed two simulated datasets, 16S-like and 23S-like rRNA, along with four real datasets: 16S rRNA, human mitochondrial (mt) genomes, SARS-CoV-2_20200301, and SARS-CoV-2_20200417 datasets. Furthermore, nine MSA tools, namely ClustalW2, Dialign-TX, Kalign3, MAFFT, MUSCLE3, MUSCLE5, PCMA, POA, and T-Coffee, were employed to generate initial alignments. Detailed information regarding the versions and operating parameters of these MSA tools can be found in <xref rid="pcbi.1011988.s013" ref-type="supplementary-material">S10 Table</xref>.</p>
      <p>M-Coffee takes the original, unaligned sequences dataset as input and utilizes the "-method" parameter to specify the MSA tools for obtaining the initial alignments. To ensure compatibility with M-Coffee, we crafted a shell script specifically for calling MUSCLE5, while the remaining MSA tools have already been integrated into M-Coffee by default. The shell script for invoking MUSCLE5 and its usage instructions can be found at <ext-link xlink:href="https://github.com/malabz/TPMA/tree/main/tools" ext-link-type="uri">https://github.com/malabz/TPMA/tree/main/tools</ext-link>. The input for TPMA comprises multiple initial alignments generated by different MSA tools, with each aligner’s running parameters precisely identical to those utilized in the M-Coffee, guaranteeing an impartial experimental setup. Two simulated datasets with references were evaluated by aSP, Q, and TC scores, while the alignment quality of the four real datasets was assessed based on the aSP score. The running time of TPMA refers to the duration taken to merge multiple initial alignments, while memory consumption indicates the peak amount of memory utilized during this merging process. Regarding M-Coffee, the running time and memory consumption encompass the time and maximum memory used from initial library construction to combination completion. Specifically, the reported running time and memory consumption by TPMA are related to the merging process. In the case of M-Coffee, its memory usage during merging corresponds to the peak memory usage of its final output. To measure the timing of the M-Coffee merging process, we introduced a timestamp mechanism. This entailed placing a timestamp at the start of merging, following the if function in line 5093 of the t_coffee.c file in its source code. Another timestamp was logged upon program completion, enabling us to accurately compute the duration of the M-Coffee merging process. The time and memory consumed by the MSA tools generating the initial alignments were excluded for the purpose of comparing TPMA and M-Coffee.</p>
      <p><xref rid="pcbi.1011988.g001" ref-type="fig">Fig 1A and 1D</xref> demonstrate that the TPMA results consistently outperform the other nine initial alignments and the combined results of M-Coffee in terms of aSP, Q, and TC (except for the 99% similarity dataset) scores across the 16S-like and 23S-like rRNA datasets. This advantage becomes more pronounced as the dataset similarity decreases. For the 16S-like rRNA datasets with a 99% similarity, TPMA achieves an average TC score of 0.9967, while ClustalW2 and PCMA achieve an average TC score of 0.9970, and M-Coffee’s average TC score is 0.9957. Similarly, for the 23S-like rRNA datasets with a 99% similarity, TPMA attains an average TC score of 0.9963, while T-Coffee and M-Coffee achieve average TC scores of 0.9969 and 0.9960, respectively. Consequently, TPMA’s results closely approach the highest TC score and surpass those of M-Coffee. Furthermore, TPMA demonstrates shorter running time and lower memory consumption than M-Coffee on both sets of datasets (<xref rid="pcbi.1011988.g001" ref-type="fig">Fig 1B and 1E</xref>). In the 16S rRNA datasets with an average similarity of 75%, TPMA shows a superior aSP score compared to M-Coffee (<xref rid="pcbi.1011988.g002" ref-type="fig">Fig 2A</xref>). However, for the other three real datasets with high average similarities, TPMA and M-Coffee demonstrate close scores (<xref rid="pcbi.1011988.g002" ref-type="fig">Fig 2D</xref>, <xref rid="pcbi.1011988.g002" ref-type="fig">2G</xref>, and <xref rid="pcbi.1011988.g002" ref-type="fig">2J</xref>). Furthermore, TPMA exhibits a significantly shorter running time and consumes considerably less memory than M-Coffee (<xref rid="pcbi.1011988.g002" ref-type="fig">Fig 2B</xref>, <xref rid="pcbi.1011988.g002" ref-type="fig">2E</xref>, <xref rid="pcbi.1011988.g002" ref-type="fig">2H</xref>, and <xref rid="pcbi.1011988.g002" ref-type="fig">2K</xref>).</p>
      <fig position="float" id="pcbi.1011988.g001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011988.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Comparative analysis of TPMA, M-Coffee, and ReformAlign on 16S-like and 23S-like rRNA datasets.</title>
          <p>Each dataset consists of 14 sub-datasets, each exhibiting varying levels of sequence similarity ranging from 99% to 70%. Within each similarity sub-dataset, three replicates are included. For each replicate, nine initial alignments are acquired and subsequently merged using TPMA and M-Coffee. <bold>A, D</bold> The aSP, Q, and TC scores of TPMA, M-Coffee, and nine MSA tools across 16S-like and 23S-like rRNA datasets. For each gird, the average of three repetitions in one sub-dataset was calculated and subjected to min-max normalization using the alignment scores from all tools. <bold>B</bold>, <bold>E</bold> The changes in running time and memory usage of TPMA and M-Coffee across different levels of similarity for the 16S-like and 23S-like rRNA datasets. Each point represents the average time and memory consumption resulting from the combination of TPMA and M-Coffee across the three replicates. This computation excludes the time and memory required for obtaining the initial alignments. <bold>C, F</bold> Compare improvements in aSP, Q, and TC scores of TPMA, M-Coffee, and ReformAlign for initial alignments on 16S-like and 23S-like rRNA datasets. Each dataset consists of 14 sub-datasets, with three replicates per sub-dataset. A total of 378 (14×3×9) initial alignments were generated using 9 MSA tools. ReformAlign optimized these 378 initial alignments, calculating the differences between the scores of the optimized and unoptimized initial alignments for aSP, Q, and TC scores. Additionally, the disparities between the scores of the merged alignments (through TPMA and M-Coffee) and the unmerged initial alignments were also computed for aSP, Q, and TC scores. A total of 378 differences were obtained for TPMA and M-Coffee, obtained from 14×3 replicates, with each replicate generating 9 differences. The proportions of "improved," "constant," and "reduced" are summarized in donut charts.</p>
        </caption>
        <graphic xlink:href="pcbi.1011988.g001" position="float"/>
      </fig>
      <fig position="float" id="pcbi.1011988.g002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011988.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Comparative analysis of TPMA, M-Coffee, and ReformAlign across the four real datasets.</title>
          <p>The 16S rRNA datasets include 8 subsets, each comprising 100 sequences, and nine MSA tools were utilized to generate the initial alignments for these datasets. Additionally, the mt genomes, SARS-CoV-2_20200301, and SARS-CoV-2_20200417 datasets consist of 4 subsets containing 30, 39, and 100 sequences, respectively. <bold>A, D, G, J</bold> The aSP score of TPMA, M-Coffee, and various MSA tools on the 16S rRNA, mt genomes, SARS-CoV-2_20200301, and SARS-CoV-2_20200417 datasets. It’s worth noting that some MSA tools failed to align on these datasets; only the tools depicted in the figure completed the alignment. The resulting initial alignment was then utilized for the merging process using TPMA and M-Coffee. <bold>B, E, H, K</bold> The running time and memory usage of TPMA and M-Coffee for the 16S rRNA, mt genomes, SARS-CoV-2_20200301, and SARS-CoV-2_20200417 datasets. Notably, the values exclude the time and memory needed to obtain the initial alignments. <bold>C, F, I, L</bold> The enhancements in the aSP score of initial alignments on the 16S rRNA (<bold>C</bold>), mt genomes (<bold>F</bold>), SARS-CoV-2_20200301 (<bold>I</bold>), and SARS-CoV-2_20200417 (<bold>L</bold>) datasets among TPMA, M-Coffee, and ReformAlign. Specifically, the 16S rRNA datasets comprise 72 (8×9) initial alignments, while the mt genomes datasets entail 28 (4×7) initial alignments. Furthermore, both the SARS-CoV-2_20200301 and SARS-CoV-2_20200417 datasets each encompass 20 (4×5) initial alignments. The proportions of "improved", "constant", and "reduced" are calculated based on the number of initial alignments for each dataset. It’s worth noting that for the two SARS-CoV-2 datasets, ReformAlign’s results were not displayed due to exceeding the device’s memory limit.</p>
        </caption>
        <graphic xlink:href="pcbi.1011988.g002" position="float"/>
      </fig>
      <p>Afterward, we assessed the performance of TPMA, M-Coffee, and ReformAlign in enhancing alignment quality. First, we optimized each initial alignment utilizing ReformAlign’s fundamental parameters (detailed in <xref rid="pcbi.1011988.s013" ref-type="supplementary-material">S10 Table</xref>), calculated the difference in aSP, Q, and TC scores between the optimized and initial alignments, and then computed the discrepancy between the combined results and each participating initial alignment for TPMA and M-Coffee.</p>
      <p>On both 16S-like and 23S-like rRNA datasets (<xref rid="pcbi.1011988.g001" ref-type="fig">Fig 1C and 1F</xref>), TPMA improves or maintains the aSP score in all datasets, and it enhances Q and TC scores in the majority of datasets when compared to M-Coffee and ReformAlign. Similarly, compared to M-Coffee and ReformAlign, TPMA improves more alignments’ aSP score across all four real datasets, which were randomly sampled to obtain multiple replicas for comparison (<xref rid="pcbi.1011988.g002" ref-type="fig">Fig 2C</xref>, <xref rid="pcbi.1011988.g002" ref-type="fig">2F</xref>, <xref rid="pcbi.1011988.g002" ref-type="fig">2I</xref>, and <xref rid="pcbi.1011988.g002" ref-type="fig">2L</xref>). It is noteworthy that ReformAlign faced limitations in optimizing the two SARS-CoV-2 datasets due to memory limitations exceeding the device’s upper threshold.</p>
      <p>Thus, TPMA consistently imparts heightened alignment quality compared to most initial alignments, a trend especially pronounced in datasets exhibiting lower similarity. While, in certain instances, TPMA’s score might marginally fall below that of the initial alignment, it consistently approaches the highest score and surpasses the outcome achieved by M-Coffee. In contrast, the accuracy of M-Coffee generated alignments is susceptible to the accuracy of the initial alignment, potentially between the best and worst initial alignments, showing a limited ability to improve the quality of initial alignments. TPMA exhibits a shorter running time and less memory consumption than M-Coffee. Furthermore, as sequence length and quantity increase, ReformAlign’s memory demands become excessively high, constraining its scalability.</p>
    </sec>
    <sec id="sec004">
      <title>Accurate strategy: achieving comparable results with 4 MSA tools as with All 9</title>
      <p>Initially, we arranged the 9 MSA tools based on the accuracy of their alignment results, revealing that the top 5 aligners derived from the aSP, Q, and TC scores were identical, comprising ClustalW2, MAFFT, MUSCLE3, PCMA, and T-Coffee, albeit in varying specific orders (<xref rid="pcbi.1011988.g003" ref-type="fig">Fig 3A</xref>). By utilizing MSA tools’ aSP score ranking, we added and merged the initial alignments one by one from the top-ranked MSA tools, then computed the average accuracy across all sub-datasets, illustrated as the yellow square curve (<xref rid="pcbi.1011988.g003" ref-type="fig">Fig 3B</xref>). "Top 2" signifies the result obtained by combining the alignments derived from the top two aligners, T-Coffee and MUSCLE3, by TPMA. "Top 3" represents the combined result of the top three T-Coffee, MUSCLE3, and MAFFT; the subsequent combinations are deduced accordingly. We replicate the identical procedure using the rankings derived from Q and TC scores, resulting in the outcomes represented by the blue circular curve and the red triangular curve, respectively. Notably, as more initial alignments were added, the aSP, Q, and TC scores initially increased but eventually reached a plateau or slightly decreased. This observation suggests that the inclusion of Dialign-TX, Kalign3, MUSCLE5, and POA in these combinations did not enhance the final alignment’s quality. Upon reanalysis of the aSP, Q, and TC scores across various sequence similarities (<xref rid="pcbi.1011988.s001" ref-type="supplementary-material">S1</xref>–<xref rid="pcbi.1011988.s003" ref-type="supplementary-material">S3</xref> Figs), similar pronounced trends were observed in low-similarity sub-datasets, highlighting TPMA’s enhanced efficacy in integrating such datasets.</p>
      <fig position="float" id="pcbi.1011988.g003">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011988.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>The results of screening the accurate strategy on the 23S-like rRNA datasets.</title>
          <p><bold>A</bold> MSA tool rankings are determined based on aSP, Q, and TC scores. Each point corresponds to the average value of three replicates within that sub-dataset. "Mean" denotes the ranking derived from the average values spanning all sub-datasets with varying degrees of similarity. <bold>B</bold> Sequential integration of initial alignments from MSA tools following ranking by aSP, Q, and TC scores. The ranking is derived from the "Mean" results of <bold>A</bold>. Referring to the aSP score rankings (the orange line), the "Top 2" position indicates the integration of T-Coffee and MUSCLE3, while the "Top 3" placement corresponds to the fusion of T-Coffee, MUSCLE3, and MAFFT, and so forth. Analyzing the Q score rankings (the blue line), the "Top 2" position signifies the combination of T-Coffee and MUSCLE3, while the "Top 3" is the fusion of T-Coffee, MUSCLE3, and ClustalW2, and so forth. Similarly, based on the TC score ranking (the red line), the "Top 2" position indicates the combination of ClustalW2 and PCMA, while the "Top 3" placement represents the integration of ClustalW2, PCMA, and T-Coffee, and so forth. The outcomes represent the average values of the aSP, Q, and TC scores of combined alignments across all sub-datasets of different similarities. <bold>C</bold> Ablation experiment on the "Top 5" MSA tools. The disparities between the aSP, Q, and TC scores of the combined alignment obtained from the remaining four initial alignments (excluding the indicated MSA tool) and from all five initial alignments were computed. If the score from combining the remaining four initial alignments is higher, it’s classified as ’improved’; if it remains the same, it’s labeled ’constant’; if it decreases, it’s categorized as ’reduced’. Each histogram displays the proportions of "improved," "constant," and "reduced" cases, calculated from a total of 42 datasets (14*3) across all sub-datasets. <bold>D</bold> Ablation experiment on the "Top 4" MSA tools (similar to C). <bold>E</bold> The running time and memory consumption of 11 MSA tools on 42 23S-like rRNA datasets are presented. Logging was conducted using Python’s psutil library.</p>
        </caption>
        <graphic xlink:href="pcbi.1011988.g003" position="float"/>
      </fig>
      <p>The trend from "Top 4" to "Top 5" remains constant, leading us to deduce the presence of redundant MSA tools within the "Top 5" combination. Consequently, we performed ablation experiments on the selected top 5 MSA tools, revealing that the final alignment remained unchanged when either ClustalW2 or PCMA was excluded (<xref rid="pcbi.1011988.g003" ref-type="fig">Fig 3C</xref>). Considering their running time and memory utilization on 23S-like rRNA datasets (<xref rid="pcbi.1011988.g003" ref-type="fig">Fig 3E</xref>), ClustalW2 demonstrates reduced memory consumption and faster processing time than PCMA. Consequently, we refined the accurate combination strategy to encompass four aligners: ClustalW2, MAFFT, MUSCLE3, and T-Coffee. Further, ablation experiments on these four MSA tools demonstrated that each aligner significantly contributed to the final alignment quality, affirming their indispensability within the accurate strategy (<xref rid="pcbi.1011988.g003" ref-type="fig">Fig 3D</xref>).</p>
      <p>We conducted tests on seven datasets to further validate the broad applicability of the accurate strategy when utilizing TPMA. TPMA combines nine initial alignments, "Top 5" initial alignments, and the four initial alignments from the accurate strategy to generate TPMA_C9, TPMA_C5, and TPMA_C4, respectively. In contrast, M-Coffee integrates the nine initial alignments and the four initial alignments of the accurate strategy, yielding M-Coffee_C9 and M-Coffee_C4, respectively. TPMA’s combined outcomes on 16S-like and 23S-like rRNA datasets consistently outperform M-Coffee in terms of aSP, Q, and TC scores. Meanwhile, TPMA_C9, TPMA_C5, and TPMA_C4 show highly similar results (<xref rid="pcbi.1011988.g004" ref-type="fig">Fig 4A and 4B</xref>). These three TPMA outcomes also demonstrate comparable performance across simulated CIPRES-128, CIPRES-256, and 16S rRNA datasets, where the sequences exhibit average similarity rates of 80% for the first two and 75% for the latter, all-surpassing M-Coffee (<xref rid="pcbi.1011988.g004" ref-type="fig">Fig 4C–4E</xref>). The "NULL" signifies that no results were acquired from TPMA-C9 and M-Coffee_C9 due to the infinite alignment time of Dialign-TX (<xref rid="pcbi.1011988.g004" ref-type="fig">Fig 4D</xref>). The HVS-II and 23S rRNA datasets exhibited an average similarity above 93%. Results from three TPMA and two M-Coffee alignments closely align on these datasets, with TPMA slightly surpassing M-Coffee’s outcomes (<xref rid="pcbi.1011988.g004" ref-type="fig">Fig 4F and 4G</xref>). Therefore, the outputs from the comprehensive test datasets validate that integrating the four alignments acquired through the accurate strategy can yield results of comparable quality to combining all nine alignments while saving time and memory.</p>
      <fig position="float" id="pcbi.1011988.g004">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011988.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Validation of the accurate strategy on additional datasets.</title>
          <p>TPMA_C9 and M-Coffee_C9 represent the combined alignments of 9 initial alignments from ClustalW2, Dialign-TX, Kalign3, MAFFT, MUSCLE3, MUSCLE5, PCMA, POA, and T-Coffee. TPMA_C5 combines initial alignments from 5 MSA tools: ClustalW2, MAFFT, MUSCLE3, PCMA, and T-Coffee. TPMA_C4 and M-Coffee_C4 are the combined alignments of merging the initial alignments from the accurate strategy (ClustalW2, MAFFT, MUSCLE3, and T-Coffee). <bold>A, B</bold> We present the trends in aSP, Q, and TC scores of TPMA_C9, TPMA_C5, TPMA_C4, M-Coffee_C9, and M-Coffee_C4 on the 16S-like and 23S-like rRNA sub-datasets. The results represent the average value across the three replicates from each sub-dataset. <bold>C, D,</bold> Comparing aSP, Q, and TC scores (10 replicates) for TPMA_C9, TPMA_C5, TPMA_C4, M-Coffee_C9, and M-Coffee_C4 on simulated CIPRES-128 and CIPRES-256 rRNA datasets, alongside a sequence similarity distribution histogram. The sequence similarity of each replicate was similar within the dataset, and only one of the replicates’ sequence similarity distribution histograms was plotted. The "NULL" indicates that TPMA-C9 and M-Coffee_C9 produced no results due to the infinite alignment time of Dialign-TX. <bold>E-G,</bold> The aSP scores of TPMA_C9, TPMA_C5, TPMA_C4, M-Coffee_C9, and M-Coffee_C4 on the 16S rRNA, HVS-II, and 23S rRNA datasets with the corresponding sequence similarity distribution histograms (only one representative histogram was displayed). The 16S rRNA datasets have 8 replicates, while the HVS-II and 23S rRNA datasets contain 10 replicates.</p>
        </caption>
        <graphic xlink:href="pcbi.1011988.g004" position="float"/>
      </fig>
    </sec>
    <sec id="sec005">
      <title>Fast strategy: enhancing alignment accuracy with time efficiency for large-scale datasets</title>
      <p>During the above experiment, we observed that early-developed MSA software, such as T-Coffee and Dialign-TX, faced difficulties in aligning datasets with longer or larger sequences, leading to considerable time and memory expenses, potentially limiting options for certain users, particularly considering the inclusion of T-Coffee in the accurate strategy. To address this, we identify newly developed MSA software that exhibits swift alignment speed and lower memory consumption, and by integrating these tools with TPMA, we formulated a fast combination strategy, explicitly catered for datasets with larger scales, aiming to save time while preserving alignment accuracy as closely as possible to the accurate strategy results. We evaluated the performance of the fast strategy which selected the four most rapid MSA tools (<xref rid="pcbi.1011988.g003" ref-type="fig">Fig 3E</xref>), namely HAlign3, Kalign3, MAFFT, and WMSA2, by conducting experiments on eight datasets. The experimental approach involved running the four MSA tools to acquire initial alignments, followed by merging these alignments using TPMA to generate "TPMA_F4". We compared the accuracy of TPMA_F4 with that of "TPMA_C4" from the 4.2 experiment and recorded the memory consumption and running time required for obtaining all initial alignments. The memory consumption represents the maximum usage of TPMA_F4 and TPMA_C4 when running individual MSA tools, while the running time refers to the cumulative time taken by TPMA_F4 and TPMA_C4 when running each MSA tool. The time and memory consumption associated with combining initial alignments in TPMA_F4 and TPMA_C4 were disregarded.</p>
      <p>In the 16S-like and 23S-like rRNA datasets, the aSP and TC score curves of TPMA_C4 and TPMA_F4 almost overlap, while, as the sequence similarity falls below 80%, the Q score of TPMA_F4 slightly lags behind that of TPMA_C4. Notably, TPMA_F4 demands significantly less time for initial alignments than TPMA_C4, and when the sequence similarity reaches 85% or higher, TPMA_F4 exhibits lower memory consumption than TPMA_C4 (<xref rid="pcbi.1011988.g005" ref-type="fig">Fig 5A and 5B</xref>). On the simulated CIPRES-128 and CIPRES-256 rRNA datasets (sequence similarity: 80%), the aSP score distributions are similar between the two methods, while the Q score and TC score distributions of TPMA_F4 are slightly lower than those of TPMA_C4 (<xref rid="pcbi.1011988.g005" ref-type="fig">Fig 5C and 5D</xref>). For the 16S rRNA datasets (sequence similarity: 75%), TPMA_F4 achieves a slightly lower aSP score than TPMA_C4 (<xref rid="pcbi.1011988.g005" ref-type="fig">Fig 5E</xref>). However, in the case of the HVS-II datasets (sequence similarity: 98.6%), 23S rRNA datasets (sequence similarity: 92.7%), and mt genomes datasets (sequence similarity: 99.7%), the TPMA_C4 and TPMA_F4 results demonstrate similar aSP score distributions (<xref rid="pcbi.1011988.g005" ref-type="fig">Fig 5F–5H</xref>). While the disparity in peak memory consumption between the two methods is minimal in the above datasets, TPMA_F4 requires significantly less time for initial alignments than TPMA_C4. Especially on the mt-genomes datasets, TPMA_C4’s completion time for all initial alignments extends up to 4 days, accompanied by memory usage exceeding 100GB, whereas TPMA_F4 accomplishes the task within a mere 1 minute, utilizing 290MB of memory. The experimental results affirm that, when sequence similarity exceeds 80%, the fast strategy can attain alignment quality comparable to the accurate strategy, significantly reducing the time required for initial alignments, particularly on extensive datasets.</p>
      <fig position="float" id="pcbi.1011988.g005">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011988.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Comparative analysis of accurate and fast strategies.</title>
          <p>TPMA_C4 is derived from the merged alignment by combining the initial alignments obtained through accurate strategy (ClustalW2, MAFFT, MUSCLE3, and T-Coffee), while TPMA_F4 results from that of the fast strategy (HAlign3, Kalign3, MAFFT, and WMSA2). The time indicated the aggregate of the running time for the four MSA tools within the combined strategy. Meanwhile, the memory reflects the highest memory consumption observed during the aligning process of the four MSA tools in the combined strategy. <bold>A-D</bold> aSP, Q, and TC scores of TPMA_C4 and TPMA_F4 on the 16S-like, 23S-like, simulated CIPRES-128 and CIPRES-256 rRNA datasets, along with the overall time and memory peak consumption during acquiring all initial alignments. Each point in <bold>A</bold> and <bold>B</bold> represents the average value from three replicates within the sub-dataset of 16S-like and 23S-like rRNA datasets. Meanwhile, both CIPRES rRNA datasets consist of 10 replicates. <bold>E-H</bold> aSP score of TPMA_C4 and TPMA_F4 on the 16S rRNA, HVS-II, 23S rRNA, and mt genomes datasets with the time and memory of that required to obtain all initial alignments. The 16S rRNA, HVS-II, 23S rRNA, and mt genome datasets comprised 8, 10, 10, and 4 replicates, respectively.</p>
        </caption>
        <graphic xlink:href="pcbi.1011988.g005" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec006">
    <title>Discussion</title>
    <p>We developed Two Pointers Meta-Alignment (TPMA) to enhance the quality of nucleic acid sequence alignments by combining blocks with high SP scores from multiple initial alignments. The assessment of TPMA across six real and four simulated datasets revealed that it improves the aSP, Q, and TC scores of initial alignments across most datasets, particularly in datasets with low sequence similarity, all while reducing memory and time consumption. While TPMA’s result exhibited a relatively lower score in partial high sequence similarity datasets, it closely approached the highest score of initial alignments and outperformed the result from M-Coffee. Furthermore, in contrast to M-Coffee and ReformAlign, TPMA demonstrates a more significant capability for enhancing the quality of initial alignments. Subsequently, we evaluated the MSA tools utilized in the experiment and presented users with accurate and fast strategies. Validation of the test datasets affirmed that these two strategies could uphold alignment accuracy while conserving time and facilitating the integration of large-scale datasets. In our experimental tests, we focused solely on comparing the running time and memory consumption of TPMA and M-Coffee, without including ReformAlign in the comparison. This decision stems from the fact that TPMA and M-Coffee employ similar optimization strategies, namely merging multiple initial alignments, while ReformAlign conducts re-alignment against a single initial alignment. As a result, a direct comparison with TPMA and M-Coffee in terms of time and memory consumption is not feasible.</p>
    <p>During a validation experiment to assess TPMA’s efficacy, we employed 9 MSA tools for the integration. Recognizing the impracticality for users to execute numerous MSA tools individually before integration, we streamlined the process by offering users an accurate strategy, ensuring equivalent or similar alignment quality with the fewest tools. This enhancement in user convenience saves valuable time typically spent on tool selection. Additionally, 23S-like rRNA was chosen as the experimental dataset for screening MSA tools of accurate strategy for several reasons: firstly, the simulated datasets provide reference alignments, and we can comprehensively assess MSA tools based on aSP, Q, and TC scores. Among these metrics, aSP quantifies the quality of sequence alignment by computing the average similarity score across all sequence pairs. Q and TC provide a comprehensive assessment of alignment accuracy and completeness relative to a reference alignment. MSA tools that incorporate multiple indicators in their selection process tend to be more reliable. Secondly, compared with the simulated CIPRES datasets, its multiple sub-datasets with varying similarities allow for the identification of MSA tools less influenced by different similarities, ensuring broad applicability of the screening results. And finally, compared to the 16S-like rRNA datasets, 23S-like rRNA possesses longer sequence lengths and more noticeable disparities in running time and memory consumption among MSA tools, simplifying the decision-making process.</p>
    <p>As sequencing technology has advanced, there has been a substantial increase in the length and quantity of sequences for a single alignment process. The mt genome, approximately 16 kb in length, and the SARS-CoV-2 genome, spanning around 29 kb, highlight this trend, with over 16 million SARS-CoV-2 genomes sequenced from 193 countries and regions as of July 2023. However, early-developed MSA tools face challenges when dealing with large-scale alignment tasks. For instance, T-Coffee and Dialign-TX experience infinite running times when aligning the SARS-CoV-2_20200301 sub-dataset containing 39 sequences. Although T-Coffee, included in the accurate strategy, delivers high-quality alignment outcomes, its performance is constrained when aligning extensive sequences, limiting the broad applicability of the accurate strategy. Hence, we opted for the newly developed tools HAlign3, Kalign3, MAFFT, and WMSA2 to create a fast strategy to produce initial alignments for large-scale datasets as quickly as possible. The experimental results demonstrate that the four MSA tools chosen via the fast strategy outperform those selected through the accurate strategy in terms of speed and suitability for large-scale data. Particularly when dealing with low sequence similarity, HAlign3 may exhibit high memory usage, but this limitation can be mitigated by reducing the number of parallel threads. Moreover, the decision to opt for four MSA tools in the fast strategy, rather than a smaller selection, stems from the advantage it offers in facilitating effective comparisons on large-scale datasets compared to the accurate strategy. A smaller tool selection could compromise the ability to make meaningful comparisons. Despite not being part of the accurate strategy, Kalign3’s rapid aligning and minimal memory usage on large-scale datasets align with the objectives of the fast strategy tailored for such datasets.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec007">
    <title>Materials and methods</title>
    <sec id="sec008">
      <title>The workflow of TPMA</title>
      <p>TPMA requires two inputs: firstly, a set containing <italic toggle="yes">A</italic><sub>1</sub>, <italic toggle="yes">A</italic><sub>2</sub>,…,<italic toggle="yes">A</italic><sub><italic toggle="yes">n</italic></sub> (the initial alignments of the original sequence dataset <italic toggle="yes">R</italic> by <italic toggle="yes">n</italic> MSA tools) and secondly, the original unaligned sequence dataset <italic toggle="yes">R</italic>. The default output sequence order of MUSCLE3, MUSCLE5, and PCMA is based on the clustering of their guide tree, which often differs from the sequence order of the original dataset. Furthermore, when the original sequences contain characters other than the 26 uppercase and lowercase English letters, MAFFT and MUSCLE3 will align the sequences after deleting these characters. Therefore, TPMA mandates a meticulous examination of the initial alignments (<xref rid="pcbi.1011988.g006" ref-type="fig">Fig 6A</xref>).</p>
      <fig position="float" id="pcbi.1011988.g006">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011988.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>Operational mechanism and illustrative cases of TPMA.</title>
          <p><bold>A</bold> Flowchart of TPMA. Unaligned sequences (<italic toggle="yes">R</italic>) are aligned using <italic toggle="yes">n</italic> MSA tools to generate <italic toggle="yes">n</italic> initial alignments, and these initial alignments along with the <italic toggle="yes">R</italic> are fed into TPMA. TPMA checks the <italic toggle="yes">n</italic> initial alignments by sorting sequences, calculating SP scores, and verifying for consistency, resulting in <italic toggle="yes">m</italic> valid initial alignments. The <italic toggle="yes">m</italic> valid initial alignments are combined in descending order of SP scores. A total of <italic toggle="yes">m-1</italic> combining steps are conducted to obtain the final alignment, denoted as <italic toggle="yes">A</italic><sub><italic toggle="yes">final</italic></sub>. <bold>B</bold> Example of a detailed merging process for two initial alignments. (i) Recode <inline-formula id="pcbi.1011988.e001"><alternatives><graphic xlink:href="pcbi.1011988.e001" id="pcbi.1011988.e001g" position="anchor"/><mml:math id="M1" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1011988.e002"><alternatives><graphic xlink:href="pcbi.1011988.e002" id="pcbi.1011988.e002g" position="anchor"/><mml:math id="M2" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> as binary strings consisting exclusively of 0s and 1s. (ii) <inline-formula id="pcbi.1011988.e003"><alternatives><graphic xlink:href="pcbi.1011988.e003" id="pcbi.1011988.e003g" position="anchor"/><mml:math id="M3" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1011988.e004"><alternatives><graphic xlink:href="pcbi.1011988.e004" id="pcbi.1011988.e004g" position="anchor"/><mml:math id="M4" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> are divided into blocks according to the bold column <italic toggle="yes">C</italic><sub><italic toggle="yes">i</italic></sub> (<italic toggle="yes">C</italic><sub>1</sub>, <italic toggle="yes">C</italic><sub>4</sub>, <italic toggle="yes">C</italic><sub>10</sub>, <italic toggle="yes">C</italic><sub>11</sub>, <italic toggle="yes">C</italic><sub>13</sub> and <italic toggle="yes">C</italic><sub>16</sub> for <inline-formula id="pcbi.1011988.e005"><alternatives><graphic xlink:href="pcbi.1011988.e005" id="pcbi.1011988.e005g" position="anchor"/><mml:math id="M5" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>; <italic toggle="yes">C</italic><sub>1</sub>, <italic toggle="yes">C</italic><sub>4</sub>, <italic toggle="yes">C</italic><sub>10</sub>, <italic toggle="yes">C</italic><sub>11</sub>, <italic toggle="yes">C</italic><sub>12</sub> and <italic toggle="yes">C</italic><sub>15</sub> for <inline-formula id="pcbi.1011988.e006"><alternatives><graphic xlink:href="pcbi.1011988.e006" id="pcbi.1011988.e006g" position="anchor"/><mml:math id="M6" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>), which yields six pairs of blocks. Each of these block pairs consists of identical sequence fragments. (iii) Compute the SP scores for these blocks, and then merge the blocks with higher SP values into <italic toggle="yes">A</italic><sub><italic toggle="yes">tmp</italic>1</sub>. <italic toggle="yes">A</italic><sub><italic toggle="yes">tmp</italic>1</sub> encompasses sequences of length 15, structured as follows: block <italic toggle="yes">C</italic><sub>1</sub> with identical scores, blocks <italic toggle="yes">C</italic><sub>2</sub>−<italic toggle="yes">C</italic><sub>4</sub> from <inline-formula id="pcbi.1011988.e007"><alternatives><graphic xlink:href="pcbi.1011988.e007" id="pcbi.1011988.e007g" position="anchor"/><mml:math id="M7" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, blocks <italic toggle="yes">C</italic><sub>5</sub>−<italic toggle="yes">C</italic><sub>10</sub> from <inline-formula id="pcbi.1011988.e008"><alternatives><graphic xlink:href="pcbi.1011988.e008" id="pcbi.1011988.e008g" position="anchor"/><mml:math id="M8" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, block <italic toggle="yes">C</italic><sub>11</sub> with the same score, block <italic toggle="yes">C</italic><sub>12</sub> from <inline-formula id="pcbi.1011988.e009"><alternatives><graphic xlink:href="pcbi.1011988.e009" id="pcbi.1011988.e009g" position="anchor"/><mml:math id="M9" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, and finally, blocks <italic toggle="yes">C</italic><sub>13</sub>−<italic toggle="yes">C</italic><sub>15</sub> from <inline-formula id="pcbi.1011988.e010"><alternatives><graphic xlink:href="pcbi.1011988.e010" id="pcbi.1011988.e010g" position="anchor"/><mml:math id="M10" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>.</p>
        </caption>
        <graphic xlink:href="pcbi.1011988.g006" position="float"/>
      </fig>
      <p>Firstly, TPMA reorders the sequences in each initial alignment <italic toggle="yes">A</italic><sub><italic toggle="yes">i</italic></sub> to match the order of the original dataset <italic toggle="yes">R</italic> and computes the sum of pairs (SP) score for each reordered alignment <inline-formula id="pcbi.1011988.e011"><alternatives><graphic xlink:href="pcbi.1011988.e011.jpg" id="pcbi.1011988.e011g" position="anchor"/><mml:math id="M11" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. Subsequently, the characters except for the 26 uppercase and lowercase English letters are removed from the sequences in <inline-formula id="pcbi.1011988.e012"><alternatives><graphic xlink:href="pcbi.1011988.e012.jpg" id="pcbi.1011988.e012g" position="anchor"/><mml:math id="M12" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <italic toggle="yes">R</italic>, and then the consistency of each <inline-formula id="pcbi.1011988.e013"><alternatives><graphic xlink:href="pcbi.1011988.e013.jpg" id="pcbi.1011988.e013g" position="anchor"/><mml:math id="M13" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> with <italic toggle="yes">R</italic> is checked. The alignments that differ from <italic toggle="yes">R</italic> will be deleted. In the end, we acquire a subset of validated initial alignments, denoted as <inline-formula id="pcbi.1011988.e014"><alternatives><graphic xlink:href="pcbi.1011988.e014.jpg" id="pcbi.1011988.e014g" position="anchor"/><mml:math id="M14" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, where <italic toggle="yes">m</italic>≤<italic toggle="yes">n</italic>.</p>
      <p>Subsequently, we merged all validated initial alignments in descending order according to the SP score. We first combine the two alignments <inline-formula id="pcbi.1011988.e015"><alternatives><graphic xlink:href="pcbi.1011988.e015.jpg" id="pcbi.1011988.e015g" position="anchor"/><mml:math id="M15" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1011988.e016"><alternatives><graphic xlink:href="pcbi.1011988.e016.jpg" id="pcbi.1011988.e016g" position="anchor"/><mml:math id="M16" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> with the highest SP scores to get <italic toggle="yes">A</italic><sub><italic toggle="yes">tmp</italic>1</sub>, then merge <italic toggle="yes">A</italic><sub><italic toggle="yes">tmp</italic>1</sub> and <inline-formula id="pcbi.1011988.e017"><alternatives><graphic xlink:href="pcbi.1011988.e017.jpg" id="pcbi.1011988.e017g" position="anchor"/><mml:math id="M17" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> with the third highest SP score to obtain <italic toggle="yes">A</italic><sub><italic toggle="yes">tmp</italic>2</sub>, and continue this process a total of <italic toggle="yes">m</italic>−1 times to generate the final alignment <italic toggle="yes">A</italic><sub><italic toggle="yes">final</italic></sub>. <italic toggle="yes">A</italic><sub><italic toggle="yes">final</italic></sub> combines blocks with higher SP scores from the initial alignments, resulting in a refined alignment (<xref rid="pcbi.1011988.g006" ref-type="fig">Fig 6A</xref>.)</p>
    </sec>
    <sec id="sec009">
      <title>The combination of two initial alignments</title>
      <p>Our research focuses on partitioning two initial alignments into block pairs with the same sequence fragments, as depicted in <xref rid="pcbi.1011988.g006" ref-type="fig">Fig 6B</xref>, including the following three steps:</p>
    </sec>
    <sec id="sec010">
      <title>Recode the initial alignments</title>
      <p>After checking the initial alignments, the sequences in all the remaining alignments are in the same order but probably inserted with gaps in different positions. TPMA first recodes the remaining alignments by mapping gaps to 0 and all the other characters to 1. This recoding ensures that the base composition of each sequence becomes irrelevant, facilitating the identification of gap insertion positions. As shown in <xref rid="pcbi.1011988.g006" ref-type="fig">Fig 6B</xref><sub>i</sub>, TPMA recodes <inline-formula id="pcbi.1011988.e018"><alternatives><graphic xlink:href="pcbi.1011988.e018.jpg" id="pcbi.1011988.e018g" position="anchor"/><mml:math id="M18" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1011988.e019"><alternatives><graphic xlink:href="pcbi.1011988.e019.jpg" id="pcbi.1011988.e019g" position="anchor"/><mml:math id="M19" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> to obtain binary strings consisting of only 0s and 1s.</p>
    </sec>
    <sec id="sec011">
      <title>Find the cutting sites</title>
      <p>Two pointers, <italic toggle="yes">P</italic><sub>1</sub> and <italic toggle="yes">P</italic><sub>2</sub>, independently traverse their respective recoded alignments and simultaneously record their corresponding "pace," denoted by <italic toggle="yes">pace</italic><sub>1</sub> and <italic toggle="yes">pace</italic><sub>2</sub>. The “pace” is an array that records the cumulative count of "1"s scanned in each sequence up to the current column. (<xref rid="pcbi.1011988.g006" ref-type="fig">Fig 6B</xref><sub>ii</sub>). <italic toggle="yes">position</italic><sub>1</sub> and <italic toggle="yes">position</italic><sub>2</sub> respectively, keep track of the current column in the alignments where pointers <italic toggle="yes">P</italic><sub>1</sub> and <italic toggle="yes">P</italic><sub>2</sub> are located. Initializing the arrays <italic toggle="yes">pace</italic><sub>1</sub> and <italic toggle="yes">pace</italic><sub>2</sub>, both with length is the number of sequences, to zero, and setting <italic toggle="yes">position</italic><sub>1</sub> and <italic toggle="yes">position</italic><sub>2</sub> to 0 indicates that the two pointers are at column 0 and in their initial state.</p>
      <p>Move a pointer arbitrarily. If <italic toggle="yes">P</italic><sub>1</sub> scans first, when the pace of <italic toggle="yes">P</italic><sub>1</sub> is greater (any number in <italic toggle="yes">pace</italic><sub>1</sub> is greater than the corresponding number in <italic toggle="yes">pace</italic><sub>2</sub> in the same index) than that of <italic toggle="yes">P</italic><sub>2</sub>, <italic toggle="yes">P</italic><sub>1</sub> stops scanning and <italic toggle="yes">P</italic><sub>2</sub> starts to scan. Similarly, if the pace of <italic toggle="yes">P</italic><sub>2</sub> becomes greater than that of <italic toggle="yes">P</italic><sub>1</sub>, <italic toggle="yes">P</italic><sub>2</sub> stops scanning, and <italic toggle="yes">P</italic><sub>1</sub> continues to scan. Repeat this process alternately until both pointers (<italic toggle="yes">P</italic><sub>1</sub> and <italic toggle="yes">P</italic><sub>2</sub>) have scanned all the columns in their respective alignments. When the pace is the same, the current columns (<italic toggle="yes">position</italic><sub>1</sub> and <italic toggle="yes">position</italic><sub>2</sub>) of <italic toggle="yes">P</italic><sub>1</sub> and <italic toggle="yes">P</italic><sub>2</sub> represent the cutting sites corresponding to the two alignments (the columns with the bold number in <xref rid="pcbi.1011988.g006" ref-type="fig">Fig 6B</xref><sub>ii</sub>). Assuming the sequence lengths of recoded <italic toggle="yes">Seq</italic><sub>1</sub> and <italic toggle="yes">Seq</italic><sub>2</sub> are n and m respectively, where <italic toggle="yes">n</italic> is less than <italic toggle="yes">m</italic>, the time complexity of completing the finding cutting point algorithm is <italic toggle="yes">O</italic>(<italic toggle="yes">max</italic>(<italic toggle="yes">n</italic>, <italic toggle="yes">m</italic>)), specifically <italic toggle="yes">O</italic>(<italic toggle="yes">n</italic>). The pseudocode for finding cutting sites is shown in Algorithm 1.</p>
      <p specific-use="line"><bold>Algorithm 1</bold> Find the cutting sites</p>
      <p specific-use="line"><bold>Input:</bold> two recoded alignments <italic toggle="yes">Seq</italic><sub>1</sub> and <italic toggle="yes">Seq</italic><sub>2</sub>, both are DNA or RNA sequences with the same sequence order.</p>
      <p specific-use="line"><bold>Output:</bold> two lists of cutting sites <italic toggle="yes">L</italic><sub>1</sub> and <italic toggle="yes">L</italic><sub>2</sub></p>
      <p specific-use="line"><bold>Function</bold> CUTTING_SITES (<italic toggle="yes">Seq</italic><sub>1</sub>, <italic toggle="yes">Seq</italic><sub>2</sub>)</p>
      <p specific-use="line"> Let <italic toggle="yes">L</italic><sub>1</sub> and <italic toggle="yes">L</italic><sub>2</sub> be the new lists</p>
      <p specific-use="line">Let <italic toggle="yes">P</italic><sub>1</sub> and <italic toggle="yes">P</italic><sub>2</sub> be the two pointers of <italic toggle="yes">Seq</italic><sub>1</sub> and <italic toggle="yes">Seq</italic><sub>2</sub>, respectively</p>
      <p specific-use="line">Let <italic toggle="yes">pace</italic><sub>1</sub> and <italic toggle="yes">pace</italic><sub>2</sub> be the recording of the “pace” of <italic toggle="yes">P</italic><sub>1</sub> and <italic toggle="yes">P</italic><sub>2</sub>,</p>
      <p specific-use="line">Let <italic toggle="yes">position</italic><sub>1</sub> and <italic toggle="yes">position</italic><sub>2</sub> be the recording of the current positions of <italic toggle="yes">P</italic><sub>1</sub> and <italic toggle="yes">P</italic><sub>2</sub>, respectively</p>
      <p specific-use="line">Let <italic toggle="yes">col</italic><sub>1</sub> be the columns count of <italic toggle="yes">Seq</italic><sub>1</sub>, <italic toggle="yes">col</italic><sub>2</sub> be the columns count of <italic toggle="yes">Seq</italic><sub>2</sub></p>
      <p specific-use="line"> <bold>do{</bold></p>
      <p specific-use="line">  <bold>for (<italic toggle="yes">position</italic><sub>1</sub>! = <italic toggle="yes">col</italic><sub>1</sub> and</bold>
<italic toggle="yes">pace</italic><sub>2</sub>&lt;<italic toggle="yes">pace</italic><sub>1</sub>
<bold>= = FALSE)</bold></p>
      <p specific-use="line">  <bold>if (++</bold><italic toggle="yes">pace</italic><sub>1</sub> = = <italic toggle="yes">pace</italic><sub>2</sub><bold>)</bold></p>
      <p specific-use="line">    <italic toggle="yes">L</italic><sub>1</sub>.puch_back(<italic toggle="yes">position</italic><sub>1</sub>)</p>
      <p specific-use="line">    <italic toggle="yes">L</italic><sub>2</sub>.puch_back(<italic toggle="yes">position</italic><sub>2</sub>)</p>
      <p specific-use="line">   <bold>end if</bold></p>
      <p specific-use="line">   <bold>end for</bold></p>
      <p specific-use="line">  <bold>for (<italic toggle="yes">position</italic><sub>2</sub>! = <italic toggle="yes">col</italic><sub>2</sub> and</bold>
<italic toggle="yes">pace</italic><sub>1</sub>&lt;<italic toggle="yes">pace</italic><sub>2</sub>
<bold>= = FALSE)</bold></p>
      <p specific-use="line">  <bold>if (++</bold>
<italic toggle="yes">pace</italic><sub>2</sub> = = <italic toggle="yes">pace</italic><sub>1</sub><bold>)</bold></p>
      <p specific-use="line">    <italic toggle="yes">L</italic><sub>1</sub>.puch_back(<italic toggle="yes">position</italic><sub>1</sub>)</p>
      <p specific-use="line">    <italic toggle="yes">L</italic><sub>2</sub>.puch_back(<italic toggle="yes">position</italic><sub>2</sub>)</p>
      <p specific-use="line">   <bold>end if</bold></p>
      <p specific-use="line">   <bold>end for</bold></p>
      <p specific-use="line">  <bold>}while (<italic toggle="yes">position</italic><sub>1</sub>! = <italic toggle="yes">col</italic><sub>1</sub></bold> or <bold><italic toggle="yes">position</italic><sub>2</sub>! = <italic toggle="yes">col</italic><sub>2</sub>)</bold></p>
      <p specific-use="line">  <bold>return <italic toggle="yes">L</italic><sub>1</sub></bold> and <italic toggle="yes">L</italic><sub>2</sub></p>
      <p specific-use="line">
        <bold>end Function</bold>
      </p>
    </sec>
    <sec id="sec012">
      <title>Choose superior blocks based on the SP score</title>
      <p>According to all the identified cutting sites, the two initial alignments are partitioned into an equal number of blocks, and the blocks containing identical sequence fragments are referred to as one block pair. After calculating the SP score of each block pair, the block with the higher SP score is merged into the combined alignment (<xref rid="pcbi.1011988.g006" ref-type="fig">Fig 6B</xref><sub>iii</sub>). The SP score is calculated as shown in <xref rid="pcbi.1011988.e020" ref-type="disp-formula">Eq 1</xref>.</p>
      <disp-formula id="pcbi.1011988.e020">
        <alternatives>
          <graphic xlink:href="pcbi.1011988.e020.jpg" id="pcbi.1011988.e020g" position="anchor"/>
          <mml:math id="M20" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mi>S</mml:mi>
              <mml:mi>P</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mo stretchy="false">∑</mml:mo>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>L</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mrow>
                  <mml:mi>f</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </alternatives>
        <label>(1)</label>
      </disp-formula>
      <p>The SP score is obtained by summing the scores of the <italic toggle="yes">L</italic> columns, where <italic toggle="yes">f</italic>(<italic toggle="yes">k</italic>) represents the score of the <italic toggle="yes">k</italic>-th column, and <italic toggle="yes">L</italic> denotes the total number of columns in the block. The calculation method for <italic toggle="yes">f</italic>(<italic toggle="yes">k</italic>) is shown in <xref rid="pcbi.1011988.e021" ref-type="disp-formula">Eq 2</xref>.</p>
      <disp-formula id="pcbi.1011988.e021">
        <alternatives>
          <graphic xlink:href="pcbi.1011988.e021.jpg" id="pcbi.1011988.e021g" position="anchor"/>
          <mml:math id="M21" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mi>f</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mrow>
                <mml:mi>k</mml:mi>
              </mml:mrow>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mo stretchy="false">∑</mml:mo>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mo stretchy="false">∑</mml:mo>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo>≠</mml:mo>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mrow>
                      <mml:mi>s</mml:mi>
                      <mml:mi>c</mml:mi>
                      <mml:mi>o</mml:mi>
                      <mml:mi>r</mml:mi>
                      <mml:mi>e</mml:mi>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mrow>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </alternatives>
        <label>(2)</label>
      </disp-formula>
      <p>Here, <italic toggle="yes">N</italic> is the number of sequences in the block, and <italic toggle="yes">score</italic>(<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>) represents the score of aligned pair in the <italic toggle="yes">i</italic>-th row and <italic toggle="yes">j</italic>-th row. If the aligned pair is matched (both characters are letters and they are the same), a score of 1 is assigned. For mismatched pairs (both characters are letters but different), a score of -1 is given. When one character is a letter and the other is a gap, a score of -2 is provided. Otherwise, a score of 0 is assigned.</p>
    </sec>
    <sec id="sec013">
      <title>Datasets</title>
      <p>The experiments utilized ten nucleotide datasets, comprising six real datasets and four simulated datasets (<xref rid="pcbi.1011988.s004" ref-type="supplementary-material">S1 Table</xref>). Challenges arose for certain Multiple Sequence Alignment (MSA) tools, such as Dialign-TX [<xref rid="pcbi.1011988.ref013" ref-type="bibr">13</xref>] and T-Coffee [<xref rid="pcbi.1011988.ref014" ref-type="bibr">14</xref>], in aligning datasets with extended sequence lengths or numerous sequences. We conducted multiple random samplings or partitioned the real dataset to reduce its size, generating multiple sub-datasets as test datasets. This approach helped eliminate the randomness and variability of the experimental results.</p>
      <p>The six real datasets consist of five DNA datasets and one RNA dataset. (1) The human mitochondrial (mt) genomes dataset comprised 672 human mitochondrial genomes, ranging from a maximum length of 16579 bp to a minimum of 16556 bp [<xref rid="pcbi.1011988.ref015" ref-type="bibr">15</xref>]. We created sub-datasets by randomly selecting 30 sequences without replacement, and this procedure was repeated four times (<xref rid="pcbi.1011988.s005" ref-type="supplementary-material">S2 Table</xref>). (2) The hyper-variable segment II (HVS-II) dataset consisted of 100 sequences extracted from the HVS-II control region of the central European human mitochondrial genomes [<xref rid="pcbi.1011988.ref016" ref-type="bibr">16</xref>], retrieved from the GenBank database (accession numbers: KF601094-KF601193). The dataset was subsequently partitioned into ten sub-datasets (<xref rid="pcbi.1011988.s006" ref-type="supplementary-material">S3 Table</xref>). (3) The 16S ribosomal RNA (rRNA) dataset encompassed 108,413 DNA sequences encoding RNA found in bacteria and archaea, with an approximate length of 1.5 kb [<xref rid="pcbi.1011988.ref017" ref-type="bibr">17</xref>]. We created eight sub-datasets for this dataset, each containing 100 sequences sampled randomly without replacement (<xref rid="pcbi.1011988.s007" ref-type="supplementary-material">S4 Table</xref>). (4) The 23S rRNA dataset encompassed 641 sequences of Mycobacterium 23S rRNA, sourced from the SILVA rRNA database (<ext-link xlink:href="http://www.arb-silva.de/" ext-link-type="uri">http://www.arb-silva.de/</ext-link>) for bacteria, archaea, and eukaryotes. Spanning lengths from 1909 to 3485 bp, these sequences were partitioned into ten groups (<xref rid="pcbi.1011988.s008" ref-type="supplementary-material">S5 Table</xref>). (5) The respiratory syndrome coronavirus 2 (SARS-CoV-2) is an RNA virus that causes the COVID-19 pandemic. Two datasets [<xref rid="pcbi.1011988.ref018" ref-type="bibr">18</xref>] were derived from the GISAID website (<ext-link xlink:href="https://www.gisaid.org/" ext-link-type="uri">https://www.gisaid.org</ext-link>, updated November 11, 2021.) The SARS-CoV-2_20200301 datasets contain 156 sequences (29409 to 29927 bp) collected on March 1, 2020, and were divided into four sub-datasets (<xref rid="pcbi.1011988.s009" ref-type="supplementary-material">S6 Table</xref>). (6) The SARS-CoV-2_20200417 datasets feature 1020 sequences (29409 to 29927 bp) collected on April 17, 2020. From this, we randomly selected 100 sequences without replacement to create a sub-dataset, and this process was repeated four times (<xref rid="pcbi.1011988.s010" ref-type="supplementary-material">S7 Table</xref>).</p>
      <p>Two of the four simulated datasets were generated using hierarchical tree simulation to obtain 16S-like and 23S-like rRNA datasets. This simulation was carried out using INDELible v1.03 [<xref rid="pcbi.1011988.ref019" ref-type="bibr">19</xref>], and the substitution models were based on estimates obtained from 3000 16S rRNA and 641 Mycobacterium 23S rRNA alignments (as previously mentioned), utilizing IQ-TREE v2.2.0-beta [<xref rid="pcbi.1011988.ref020" ref-type="bibr">20</xref>]. One hundred 16S rRNA sequences and Mycobacterium 23S rRNA sequences, randomly chosen from the datasets as mentioned above, were aligned to construct the simulation trees. Subsequently, the process of generating the simulation 16S-like and 23S-like datasets was rooted in these two simulation trees. Each tree’s branch length was assigned a random value from 0 to 1 (NON-ULTRAMETRIC). The simulated sequence lengths were set at 1.5 kb for 16S-like rRNA and 4 kb for 23S-like rRNA. The indel model parameter used was LAV 5 50, with insertion and deletion rates of 0.01 and 0.1, respectively. To simulate datasets with varying mean similarities, the tree length (sum of branch lengths) was adjusted to achieve mean similarities of 99%, 98%, 97%, 96%, 95%, 94%, 93%, 92%, 91%, 90%, 85%, 80%, 75%, and 70%. The mean similarity represents the average of similarities between any two sequences within the dataset (<ext-link xlink:href="https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py" ext-link-type="uri">https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py</ext-link>), determined by the percentage of matched characters in their pairwise alignments conducted using MAFFT. Detailed information regarding these two sets of 14 sub-datasets can be found in <xref rid="pcbi.1011988.s011" ref-type="supplementary-material">S8 Table</xref>. Every sub-dataset included three replicates, each containing 100 simulated sequences. The mean length is the average of the average sequence lengths from the three replicates.</p>
      <p>The remaining two datasets are simulated CIPRES-128 and CIPRES-256 rRNA datasets evolved from the same root rRNA sequence on the trees featuring 128 and 256 taxa, respectively (<xref rid="pcbi.1011988.s012" ref-type="supplementary-material">S9 Table</xref>). These datasets were downloaded from trials 1 to 10 on the CIPRES SIMULATION DATA website (<ext-link xlink:href="https://kim.bio.upenn.edu/software/csd.shtml" ext-link-type="uri">https://kim.bio.upenn.edu/software/csd.shtml</ext-link>). The simulation parameters were adjusted to ensure that the simulated sequences mirror authentic small subunit rRNA (ssu rRNA) sequences regarding sequence identity, indel count, the ratio between substitutions and indels, and other relevant characteristics. The datasets were formatted in NEXUS format. The Nexus to Fasta Sequence Convert tool (<ext-link xlink:href="http://www.bugaco.com/" ext-link-type="uri">http://www.bugaco.com</ext-link>) was utilized for conversion into FASTA format to obtain the reference sequences. Subsequently, gaps were removed from the reference to derive the unaligned test datasets.</p>
      <p>Sequence similarity is computed for every dataset as the ratio of matching base pairs in all pairwise alignments (generated using MAFFT) within a sub-dataset. The script for this computation is available on <ext-link xlink:href="https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py" ext-link-type="uri">https://github.com/malabz/MSATOOLS/blob/main/length_similarity_distribution/length_similarity_distribution.py</ext-link>. Lastly, employ Python’s Matplotlib library to generate a histogram depicting the distribution of sequence similarity.</p>
    </sec>
    <sec id="sec014">
      <title>Software versions and operating parameters involved in this study</title>
      <p>Furthermore, the experiment involved initial alignments obtained from eleven MSA tools: ClustalW2 [<xref rid="pcbi.1011988.ref021" ref-type="bibr">21</xref>], Dialign-TX, HAlign3 [<xref rid="pcbi.1011988.ref022" ref-type="bibr">22</xref>], Kalign3 [<xref rid="pcbi.1011988.ref023" ref-type="bibr">23</xref>], MAFFT, MUSCLE3, MUSCLE5 [<xref rid="pcbi.1011988.ref024" ref-type="bibr">24</xref>], PCMA [<xref rid="pcbi.1011988.ref025" ref-type="bibr">25</xref>], POA[<xref rid="pcbi.1011988.ref026" ref-type="bibr">26</xref>], T-Coffee, and WMSA2[<xref rid="pcbi.1011988.ref027" ref-type="bibr">27</xref>]. The identical software versions and running commands were used for obtaining initial alignments by TPMA and M-Coffee, with detailed information provided in <xref rid="pcbi.1011988.s013" ref-type="supplementary-material">S10 Table</xref>. In addition, the running commands of TPMA and M-Coffee merging the initial alignment from different MSA tools are shown in <xref rid="pcbi.1011988.s014" ref-type="supplementary-material">S11 Table</xref>.</p>
    </sec>
    <sec id="sec015">
      <title>Evaluation and experimental environment</title>
      <p>When evaluating alignment quality for the six real datasets, we employed the average sum of pairs (SP) score, denoted as aSP score, which represents the SP score divided by the number of sequence pairs, for accuracy assessment. The penalty parameters remained consistent with those detailed in the Methods 4.2.3 section. Regarding the four simulated datasets, in addition to the aSP score, we incorporated the Q score (the number of correctly aligned base pairs divided by the aligned pairs in the reference) and the TC score (the number of correctly aligned columns divided by aligned columns in the reference), both computed using the qscore program (<ext-link xlink:href="http://www.drive5.com/bench/" ext-link-type="uri">http://www.drive5.com/bench/</ext-link>), to gauge the deviation between alignment outcomes and reference alignments. All experiments were conducted on a server running the Ubuntu Linux operating system, equipped with an Intel(R) Xeon(R) Platinum 8168 CPU operating at a clock speed of 2.7 GHz and 1TB RAM.</p>
    </sec>
  </sec>
  <sec id="sec016" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1011988.s001" position="float" content-type="local-data">
      <label>S1 Fig</label>
      <caption>
        <title>The aSP score of the combination by sequential merging of initial alignments from MSA tools based on ranking by aSP, Q, and TC scores.</title>
        <p>The 14 subplots illustrate the results of 23S-like rRNA sub- datasets with different similarities: 99%, 98%, 97%, 96%, 95%, 94%, 93%, 92%, 91%, 90%, 85%, 80%, 75%, 70%. The points on each subplot represent the averages of three replicates. The aSP score-based ranking (the orange line) reveals that the Top 2 combination consists of T-Coffee and MUSCLE3, followed by the Top 3 combination of T-Coffee, MUSCLE3, and MAFFT, and so forth for subsequent combinations. Regarding Q scores ranking (the blue line), the Top 2 combination features T-Coffee and MUSCLE3, followed by the Top 3 combination of T-Coffee, MUSCLE3, and ClustalW2, and so on. When ranked by TC scores (the red line), the Top 2 combination consists of ClustalW2 and PCMA, with the Top 3 being ClustalW2, PCMA, and T-Coffee, and so forth.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s001.eps"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s002" position="float" content-type="local-data">
      <label>S2 Fig</label>
      <caption>
        <title>The Q score of the combination by sequential merging of initial alignments from MSA tools based on ranking by aSP, Q, and TC scores.</title>
        <p>The plots depict the Q scores obtained by merging different initial alignment combinations across 14 23S-like rRNA sub-datasets. Each point displays the average of three replicates within the sub-dataset. The merged process is the same as described in. <xref rid="pcbi.1011988.s001" ref-type="supplementary-material">S1 Fig</xref> legend.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s002.eps"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s003" position="float" content-type="local-data">
      <label>S3 Fig</label>
      <caption>
        <title>The TC score of the combination by sequential merging of initial alignments from MSA tools based on ranking by average SP, Q, and TC scores.</title>
        <p>The TC scores from combining various initial alignment combinations across the 23S-like rRNA sub-datasets are shown in the 14 subplots. These sub-datasets exhibit different similarities: 99%, 98%, 97%, 96%, 95%, 94%, 93%, 92%, 91%, 90%, 85%, 80%, 75%, 70%. All points on each subplot are the averages of three replicates. The merging process follows the same steps as described in <xref rid="pcbi.1011988.s001" ref-type="supplementary-material">S1 Fig</xref> legend.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s003.eps"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s004" position="float" content-type="local-data">
      <label>S1 Table</label>
      <caption>
        <title>The summary of datasets.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s004.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s005" position="float" content-type="local-data">
      <label>S2 Table</label>
      <caption>
        <title>The detailed information of human mitochondrial genomes sub-datasets.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s005.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s006" position="float" content-type="local-data">
      <label>S3 Table</label>
      <caption>
        <title>The detailed information of human mitochondrial HVS-II sub-datasets.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s006.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s007" position="float" content-type="local-data">
      <label>S4 Table</label>
      <caption>
        <title>The detailed information of 16S rRNA sub-datasets.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s007.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s008" position="float" content-type="local-data">
      <label>S5 Table</label>
      <caption>
        <title>The detailed information of 23S rRNA sub-datasets.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s008.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s009" position="float" content-type="local-data">
      <label>S6 Table</label>
      <caption>
        <title>The detailed information of SARS-CoV-2_20200301 sub-datasets.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s009.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s010" position="float" content-type="local-data">
      <label>S7 Table</label>
      <caption>
        <title>The detailed information of SARS-CoV-2_20200417 sub-datasets.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s010.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s011" position="float" content-type="local-data">
      <label>S8 Table</label>
      <caption>
        <title>The detailed information of 16S-like and 23S-like rRNA of 14 sub-datasets.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s011.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s012" position="float" content-type="local-data">
      <label>S9 Table</label>
      <caption>
        <title>The detailed information of simulated CIPRES-128 and CIPRES-256 rRNA sub-datasets.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s012.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s013" position="float" content-type="local-data">
      <label>S10 Table</label>
      <caption>
        <title>Version information and operating parameters of the involved tools.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s013.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011988.s014" position="float" content-type="local-data">
      <label>S11 Table</label>
      <caption>
        <title>The running command of TPMA and M-Coffee.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011988.s014.xlsx"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We are incredibly grateful to Dr. Cedric Notredame for his advice on using the M-Coffee package with MUSCLE5. Our appreciation extends to Franck A.P. Kouassi for his assistance in debugging the ReformAlign, Biffon Manyura Momanyi for engaging in valuable discussions, and Juntao Chen for his support in debugging WMSA2. Special acknowledgment is given to our other esteemed group members: Yanming Wei and Qinzhong Tian, whose critical insights greatly contributed to the preparation.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1011988.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Chao</surname><given-names>J</given-names></name>, <name><surname>Tang</surname><given-names>F</given-names></name>, <name><surname>Xu</surname><given-names>L</given-names></name>. <article-title>Developments in algorithms for sequence alignment: a review.</article-title><source>Biomolecules</source>. <year>2022</year>;<volume>12</volume>(<issue>4</issue>):<fpage>546</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3390/biom12040546</pub-id><?supplied-pmid 35454135?><pub-id pub-id-type="pmid">35454135</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Katoh</surname><given-names>K</given-names></name>, <name><surname>Standley</surname><given-names>DM</given-names></name>. <article-title>MAFFT multiple sequence alignment software version 7: improvements in performance and usability</article-title>. <source>Mol Biol Evol</source>. <year>2013</year>;<volume>30</volume>(<issue>4</issue>):<fpage>772</fpage>–<lpage>80</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/mst010</pub-id><?supplied-pmid 23329690?><pub-id pub-id-type="pmid">23329690</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Edgar</surname><given-names>RC</given-names></name>. <article-title>MUSCLE: multiple sequence alignment with high accuracy and high throughput</article-title>. <source>Nucleic Acids Res</source>. <year>2004</year>;<volume>32</volume>(<issue>5</issue>):<fpage>1792</fpage>–<lpage>7</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkh340</pub-id><?supplied-pmid 15034147?><pub-id pub-id-type="pmid">15034147</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Mokaddem</surname><given-names>A</given-names></name>, <name><surname>Hadj</surname><given-names>AB</given-names></name>, <name><surname>Elloumi</surname><given-names>M</given-names></name>. <article-title>Refin-Align: New Refinement Algorithm for Multiple Sequence Alignment.</article-title><source>Informatica</source>. <year>2019</year>;<volume>43</volume>(<issue>4</issue>).</mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Chakrabarti</surname><given-names>S</given-names></name>, <name><surname>Lanczycki</surname><given-names>CJ</given-names></name>, <name><surname>Panchenko</surname><given-names>AR</given-names></name>, <name><surname>Przytycka</surname><given-names>TM</given-names></name>, <name><surname>Thiessen</surname><given-names>PA</given-names></name>, <name><surname>Bryant</surname><given-names>SH</given-names></name>. <article-title>Refining multiple sequence alignments with conserved core regions</article-title>. <source>Nucleic Acids Res</source>. <year>2006</year>;<volume>34</volume>(<issue>9</issue>):<fpage>2598</fpage>–<lpage>606</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkl274</pub-id><?supplied-pmid 16707662?><pub-id pub-id-type="pmid">16707662</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Wallace</surname><given-names>IM</given-names></name>, <name><surname>Higgins</surname><given-names>DG</given-names></name>. <article-title>Evaluation of iterative alignment algorithms for multiple alignment</article-title>. <source>Bioinformatics</source>. <year>2005</year>;<volume>21</volume>(<issue>8</issue>):<fpage>1408</fpage>–<lpage>14</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/bti159</pub-id><?supplied-pmid 15564300?><pub-id pub-id-type="pmid">15564300</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Lyras</surname><given-names>DP</given-names></name>, <name><surname>Metzler</surname><given-names>D</given-names></name>. <article-title>ReformAlign: improved multiple sequence alignments using a profile-based meta-alignment approach.</article-title><source>BMC Bioinform</source>. <year>2014</year>;<volume>15</volume>:<fpage>1</fpage>–<lpage>18</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1471-2105-15-265</pub-id><?supplied-pmid 25099134?><pub-id pub-id-type="pmid">25099134</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Bucka-Lassen</surname><given-names>K</given-names></name>, <name><surname>Caprani</surname><given-names>O</given-names></name>, <name><surname>Hein</surname><given-names>J</given-names></name>. <article-title>Combining many multiple alignments in one improved alignment</article-title>. <source>Bioinformatics (Oxford, England).</source><year>1999</year>;<volume>15</volume>(<issue>2</issue>):<fpage>122</fpage>–<lpage>30</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/15.2.122</pub-id><?supplied-pmid 10089197?><pub-id pub-id-type="pmid">10089197</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Collingridge</surname><given-names>PW</given-names></name>, <name><surname>Kelly</surname><given-names>S</given-names></name>. <article-title>MergeAlign: improving multiple sequence alignment performance by dynamic reconstruction of consensus multiple sequence alignments.</article-title><source>BMC Bioinform</source>. <year>2012</year>;<volume>13</volume>:<fpage>1</fpage>–<lpage>10</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1471-2105-13-117</pub-id><?supplied-pmid 22646090?><pub-id pub-id-type="pmid">22646090</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Muller</surname><given-names>J</given-names></name>, <name><surname>Creevey</surname><given-names>CJ</given-names></name>, <name><surname>Thompson</surname><given-names>JD</given-names></name>, <name><surname>Arendt</surname><given-names>D</given-names></name>, <name><surname>Bork</surname><given-names>P</given-names></name>. <article-title>AQUA: automated quality improvement for multiple sequence alignments</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>2</issue>):<fpage>263</fpage>–<lpage>5</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btp651</pub-id><?supplied-pmid 19926669?><pub-id pub-id-type="pmid">19926669</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Thompson</surname><given-names>JD</given-names></name>, <name><surname>Thierry</surname><given-names>J-C</given-names></name>, <name><surname>Poch</surname><given-names>O</given-names></name>. <article-title>RASCAL: rapid scanning and correction of multiple sequence alignments</article-title>. <source>Bioinformatics</source>. <year>2003</year>;<volume>19</volume>(<issue>9</issue>):<fpage>1155</fpage>–<lpage>61</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btg133</pub-id><?supplied-pmid 12801878?><pub-id pub-id-type="pmid">12801878</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Wallace</surname><given-names>IM</given-names></name>, <name><surname>O’sullivan</surname><given-names>O</given-names></name>, <name><surname>Higgins</surname><given-names>DG</given-names></name>, <name><surname>Notredame</surname><given-names>C</given-names></name>. <article-title>M-Coffee: combining multiple sequence alignment methods with T-Coffee</article-title>. <source>Nucleic Acids Res</source>. <year>2006</year>;<volume>34</volume>(<issue>6</issue>):<fpage>1692</fpage>–<lpage>9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkl091</pub-id><?supplied-pmid 16556910?><pub-id pub-id-type="pmid">16556910</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Subramanian</surname><given-names>AR</given-names></name>, <name><surname>Kaufmann</surname><given-names>M</given-names></name>, <name><surname>Morgenstern</surname><given-names>B</given-names></name>. <article-title>DIALIGN-TX: greedy and progressive approaches for segment-based multiple sequence alignment</article-title>. <source>Algorithms Mol Biol</source>. <year>2008</year>;<volume>3</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>11</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1748-7188-3-6</pub-id><?supplied-pmid 18505568?><pub-id pub-id-type="pmid">18218120</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Notredame</surname><given-names>C</given-names></name>, <name><surname>Higgins</surname><given-names>DG</given-names></name>, <name><surname>Heringa</surname><given-names>J</given-names></name>. <article-title>T-Coffee: A novel method for fast and accurate multiple sequence alignment</article-title>. <source>J Mol Biol</source>. <year>2000</year>;<volume>302</volume>(<issue>1</issue>):<fpage>205</fpage>–<lpage>17</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1006/jmbi.2000.4042</pub-id><?supplied-pmid 10964570?><pub-id pub-id-type="pmid">10964570</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Tanaka</surname><given-names>M</given-names></name>, <name><surname>Cabrera</surname><given-names>VM</given-names></name>, <name><surname>González</surname><given-names>AM</given-names></name>, <name><surname>Larruga</surname><given-names>JM</given-names></name>, <name><surname>Takeyasu</surname><given-names>T</given-names></name>, <name><surname>Fuku</surname><given-names>N</given-names></name>, <etal>et al</etal>. <article-title>Mitochondrial genome variation in eastern Asia and the peopling of Japan</article-title>. <source>Genome Res</source>. <year>2004</year>;<volume>14</volume>(<issue>10a</issue>):<fpage>1832</fpage>–<lpage>50</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1101/gr.2286304</pub-id><?supplied-pmid 15466285?><pub-id pub-id-type="pmid">15466285</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Brandt</surname><given-names>G</given-names></name>, <name><surname>Haak</surname><given-names>W</given-names></name>, <name><surname>Adler</surname><given-names>CJ</given-names></name>, <name><surname>Roth</surname><given-names>C</given-names></name>, <name><surname>Szécsényi-Nagy</surname><given-names>A</given-names></name>, <name><surname>Karimnia</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Ancient DNA reveals key stages in the formation of central European mitochondrial genetic diversity</article-title>. <source>Science</source>. <year>2013</year>;<volume>342</volume>(<issue>6155</issue>):<fpage>257</fpage>–<lpage>61</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.1241844</pub-id><?supplied-pmid 24115443?><pub-id pub-id-type="pmid">24115443</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>DeSantis</surname><given-names>TZ</given-names></name>, <name><surname>Hugenholtz</surname><given-names>P</given-names></name>, <name><surname>Keller</surname><given-names>K</given-names></name>, <name><surname>Brodie</surname><given-names>EL</given-names></name>, <name><surname>Larsen</surname><given-names>N</given-names></name>, <name><surname>Piceno</surname><given-names>YM</given-names></name>, <etal>et al</etal>. <article-title>NAST: a multiple sequence alignment server for comparative analysis of 16S rRNA genes</article-title>. <source>Nucleic Acids Res</source>. <year>2006</year>;<volume>34</volume>(<issue>suppl_2</issue>):<fpage>W394</fpage>–<lpage>W9</lpage>.<pub-id pub-id-type="pmid">16845035</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Wei</surname><given-names>Y</given-names></name>, <name><surname>Zou</surname><given-names>Q</given-names></name>, <name><surname>Tang</surname><given-names>F</given-names></name>, <name><surname>Yu</surname><given-names>L</given-names></name>. <article-title>WMSA: a novel method for multiple sequence alignment of DNA sequences</article-title>. <source>Bioinformatics</source>. <year>2022</year>;<volume>38</volume>(<issue>22</issue>):<fpage>5019</fpage>–<lpage>25</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btac658</pub-id><?supplied-pmid 36179076?><pub-id pub-id-type="pmid">36179076</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Fletcher</surname><given-names>W</given-names></name>, <name><surname>Yang</surname><given-names>Z</given-names></name>. <article-title>INDELible: a flexible simulator of biological sequence evolution</article-title>. <source>Mol Biol Evol</source>. <year>2009</year>;<volume>26</volume>(<issue>8</issue>):<fpage>1879</fpage>–<lpage>88</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msp098</pub-id><?supplied-pmid 19423664?><pub-id pub-id-type="pmid">19423664</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Minh</surname><given-names>BQ</given-names></name>, <name><surname>Schmidt</surname><given-names>HA</given-names></name>, <name><surname>Chernomor</surname><given-names>O</given-names></name>, <name><surname>Schrempf</surname><given-names>D</given-names></name>, <name><surname>Woodhams</surname><given-names>MD</given-names></name>, <name><surname>Von Haeseler</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>IQ-TREE 2: new models and efficient methods for phylogenetic inference in the genomic era</article-title>. <source>Mol Biol Evol</source>. <year>2020</year>;<volume>37</volume>(<issue>5</issue>):<fpage>1530</fpage>–<lpage>4</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msaa015</pub-id><?supplied-pmid 32011700?><pub-id pub-id-type="pmid">32011700</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Larkin</surname><given-names>MA</given-names></name>, <name><surname>Blackshields</surname><given-names>G</given-names></name>, <name><surname>Brown</surname><given-names>NP</given-names></name>, <name><surname>Chenna</surname><given-names>R</given-names></name>, <name><surname>McGettigan</surname><given-names>PA</given-names></name>, <name><surname>McWilliam</surname><given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Clustal W and Clustal X version 2.0</article-title>. <source>Bioinformatics</source>. <year>2007</year>;<volume>23</volume>(<issue>21</issue>):<fpage>2947</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btm404</pub-id><?supplied-pmid 17846036?><pub-id pub-id-type="pmid">17846036</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Tang</surname><given-names>F</given-names></name>, <name><surname>Chao</surname><given-names>J</given-names></name>, <name><surname>Wei</surname><given-names>Y</given-names></name>, <name><surname>Yang</surname><given-names>F</given-names></name>, <name><surname>Zhai</surname><given-names>Y</given-names></name>, <name><surname>Xu</surname><given-names>L</given-names></name>, <etal>et al</etal>. <article-title>HAlign 3: fast multiple alignment of ultra-large numbers of similar DNA/RNA sequences</article-title>. <source>Mol Biol Evol</source>. <year>2022</year>;<volume>39</volume>(<issue>8</issue>):<fpage>msac166</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msac166</pub-id><?supplied-pmid 35915051?><pub-id pub-id-type="pmid">35915051</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Lassmann</surname><given-names>T</given-names></name>. <article-title>Kalign 3: multiple sequence alignment of large datasets.</article-title><source>Bioinformatics</source>. <year>2019</year>;<volume>36</volume>(<issue>6</issue>):<fpage>1928</fpage>–<lpage>9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btz795</pub-id><?supplied-pmid 31665271?><pub-id pub-id-type="pmid">31665271</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Edgar</surname><given-names>RC</given-names></name>. <article-title>Muscle5: High-accuracy alignment ensembles enable unbiased assessments of sequence homology and phylogeny.</article-title><source>Nat Commun</source>. <year>2022</year>;<volume>13</volume>(<issue>1</issue>):<fpage>6968</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-022-34630-w</pub-id><?supplied-pmid 36379955?><pub-id pub-id-type="pmid">36379955</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Pei</surname><given-names>J</given-names></name>, <name><surname>Sadreyev</surname><given-names>R</given-names></name>, <name><surname>Grishin</surname><given-names>NV</given-names></name>. <article-title>PCMA: fast and accurate multiple sequence alignment based on profile consistency</article-title>. <source>Bioinformatics</source>. <year>2003</year>;<volume>19</volume>(<issue>3</issue>):<fpage>427</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btg008</pub-id><?supplied-pmid 12584134?><pub-id pub-id-type="pmid">12584134</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Lee</surname><given-names>C</given-names></name>, <name><surname>Grasso</surname><given-names>C</given-names></name>, <name><surname>Sharlow</surname><given-names>MF</given-names></name>. <article-title>Multiple sequence alignment using partial order graphs</article-title>. <source>Bioinformatics</source>. <year>2002</year>;<volume>18</volume>(<issue>3</issue>):<fpage>452</fpage>–<lpage>64</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/18.3.452</pub-id><?supplied-pmid 11934745?><pub-id pub-id-type="pmid">11934745</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011988.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>J</given-names></name>, <name><surname>Chao</surname><given-names>J</given-names></name>, <name><surname>Liu</surname><given-names>H</given-names></name>, <name><surname>Yang</surname><given-names>F</given-names></name>, <name><surname>Zou</surname><given-names>Q</given-names></name>, <name><surname>Tang</surname><given-names>F</given-names></name>. <article-title>WMSA 2: a multiple DNA/RNA sequence alignment tool implemented with accurate progressive mode and a fast win-win mode combining the center star and progressive strategies.</article-title><source>Brief Bioinformatics</source>. <year>2023</year>:<fpage>bbad190</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bib/bbad190</pub-id><?supplied-pmid 37200156?><pub-id pub-id-type="pmid">37200156</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
