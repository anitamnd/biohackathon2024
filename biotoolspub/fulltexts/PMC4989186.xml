<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NPG//DTD XML Article//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName NPG_XML_Article.dtd?>
<?SourceDTD.Version 2.7.10?>
<?ConverterInfo.XSLTName nature2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id>
    <journal-title-group>
      <journal-title>Scientific Reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-2322</issn>
    <publisher>
      <publisher-name>Nature Publishing Group</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4989186</article-id>
    <article-id pub-id-type="pii">srep31971</article-id>
    <article-id pub-id-type="doi">10.1038/srep31971</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Eliciting the Functional Taxonomy from protein annotations and taxa</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Falda</surname>
          <given-names>Marco</given-names>
        </name>
        <xref ref-type="aff" rid="a1">1</xref>
        <xref ref-type="author-notes" rid="n1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lavezzo</surname>
          <given-names>Enrico</given-names>
        </name>
        <xref ref-type="aff" rid="a1">1</xref>
        <xref ref-type="author-notes" rid="n1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fontana</surname>
          <given-names>Paolo</given-names>
        </name>
        <xref ref-type="aff" rid="a2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bianco</surname>
          <given-names>Luca</given-names>
        </name>
        <xref ref-type="aff" rid="a2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Berselli</surname>
          <given-names>Michele</given-names>
        </name>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Formentin</surname>
          <given-names>Elide</given-names>
        </name>
        <xref ref-type="aff" rid="a3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Toppo</surname>
          <given-names>Stefano</given-names>
        </name>
        <xref ref-type="corresp" rid="c1">a</xref>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <aff id="a1"><label>1</label><institution>Department of Molecular Medicine, University of Padova</institution>, Padova, 35131, <country>Italy</country></aff>
      <aff id="a2"><label>2</label><institution>Istituto Agrario San Michele all’Adige Research and Innovation Centre, Foundation Edmund Mach</institution>, Trento, 38010, <country>Italy</country></aff>
      <aff id="a3"><label>3</label><institution>Department of Biology, University of Padova</institution>, Padova, 35131, <country>Italy</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="c1">
        <label>a</label>
        <email>stefano.toppo@unipd.it</email>
      </corresp>
      <fn id="n1">
        <label>*</label>
        <p>These authors contributed equally to this work.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>08</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2016</year>
    </pub-date>
    <volume>6</volume>
    <elocation-id>31971</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>05</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>01</day>
        <month>08</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2016, The Author(s)</copyright-statement>
      <copyright-year>2016</copyright-year>
      <copyright-holder>The Author(s)</copyright-holder>
      <license xmlns:xlink="http://www.w3.org/1999/xlink" license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <!--author-paid-->
        <license-p>This work is licensed under a Creative Commons Attribution 4.0 International License. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in the credit line; if the material is not included under the Creative Commons license, users will need to obtain permission from the license holder to reproduce the material. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p>
      </license>
    </permissions>
    <abstract>
      <p>The advances of omics technologies have triggered the production of an enormous volume of data coming from thousands of species. Meanwhile, joint international efforts like the Gene Ontology (GO) consortium have worked to provide functional information for a vast amount of proteins. With these data available, we have developed FunTaxIS, a tool that is the first attempt to infer functional taxonomy (i.e. how functions are distributed over taxa) combining functional and taxonomic information. FunTaxIS is able to define a taxon specific functional space by exploiting annotation frequencies in order to establish if a function can or cannot be used to annotate a certain species. The tool generates constraints between GO terms and taxa and then propagates these relations over the taxonomic tree and the GO graph. Since these constraints nearly cover the whole taxonomy, it is possible to obtain the mapping of a function over the taxonomy. FunTaxIS can be used to make functional comparative analyses among taxa, to detect improper associations between taxa and functions, and to discover how functional knowledge is either distributed or missing. A benchmark test set based on six different model species has been devised to get useful insights on the generated taxonomic rules.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <p>Omics data have contributed to extend our knowledge in many fields of research and among these endeavours the characterization of protein molecular functions is one of the most challenging and prolific. Over time, experimental studies conducted on model organisms have been accumulated and progressively expanded to other species also by means of automatic functional transfer techniques through computational methods. The continuously growing taxonomic classification of living organisms on one hand, and the vast accumulation of protein functions on the other, have made necessary to deal with the increasing complexity of data. Therefore, the scientific community has tried to build up standards to be followed, not only in the classification of species, but also in the definitions of molecular functions. For the latter, a widely adopted resource for both accessing existing knowledge and contributing to its expansion is provided by the Gene Ontology Consortium (GOC), which is a comprehensive repository of functional information that relies on the use of a structured vocabulary, the Gene Ontology (GO)<xref ref-type="bibr" rid="b1">1</xref>. Currently, the GO Annotation database (GOA) contains over 280,000,000 annotations for almost 400,000 different species or inferior ranks<xref ref-type="bibr" rid="b2">2</xref>, and these numbers are increasing at a very high rate due to the recent development of “omics” technologies and in silico methods for protein function characterization<xref ref-type="bibr" rid="b3">3</xref><xref ref-type="bibr" rid="b4">4</xref><xref ref-type="bibr" rid="b5">5</xref><xref ref-type="bibr" rid="b6">6</xref>. These annotations are produced in two ways: manually, as a slow but accurate process carried out by trained curators and based on direct experimental results<xref ref-type="bibr" rid="b7">7</xref>, or automatically, as a faster approach that employs bioinformatics tools with minimal supervision<xref ref-type="bibr" rid="b8">8</xref>. Given the numbers involved, manual curation is not affordable for all gene products that continuously enter the public databases; as a consequence, the great majority of annotations originate from automatic pipelines (over 98%) and these annotations represent the only information available for many species. The quality of these automatically inferred annotations without any sort of supervision has been long debated but is increasing steadily and rivals the quality of the annotations checked by curators<xref ref-type="bibr" rid="b9">9</xref>.</p>
  <p>The functions coded by the GO vocabulary are intended to be species-independent, but many of them represent functions, processes, and components that are not present in all kind of organisms, thus providing an implicit partitioning of the GO graph according to taxonomic criteria<xref ref-type="bibr" rid="b10">10</xref><xref ref-type="bibr" rid="b11">11</xref>. An example of such interconnections between functions and taxa is shown in <xref ref-type="fig" rid="f1">Fig. 1</xref>: on the left there is a simplified view of the GO graph, which encodes functions with increasing levels of specificity from the root (“biological process” GO:0008150) to the leaves; on the right, the distribution of functions over the taxonomic tree is shown. In the example, the most specific term GO:0019878 (“lysine anabolism via aminoadipic acid”) refers to the peculiar biochemical pathway for the synthesis of the lysine that is used by fungi<xref ref-type="bibr" rid="b12">12</xref> but never found in plants or mammals. Its ancestor, GO:0009085 (“lysine anabolism”), is more generic and forbidden only in mammals, which are not able to synthesize lysine. Finally, the two terms GO:0009067 (“aspartate family amino acid anabolism”) and GO:0006553 (“lysine metabolism”) are the less specific and they represent functions that can be used for all the taxa in the tree.</p>
  <p>Even if the underlying principle of taxonomic partitioning of protein functions is accepted and easy to understand, its implementation is not trivial due to many factors, such as missing knowledge and errors in databases. The presence of inconsistencies between the taxon to which an annotated gene product belongs, and the implicit taxon specificity of the GO terms, was first raised in 2008 by Kusnierczyk<xref ref-type="bibr" rid="b10">10</xref> and we noticed it while using Argot, our in-house developed tool for automated protein function prediction<xref ref-type="bibr" rid="b15">15</xref>.</p>
  <p>The GOC started to deal with this problem back in 2010 and formalized an initial list of manually validated taxon-specific GO terms that is now freely available in the GO taxon constraints file. A tool was also created to detect and correct such inconsistencies<xref ref-type="bibr" rid="b16">16</xref>. Practically, GO taxon constraints are a list of statements that define the possibility to use or not a particular GO term to annotate a gene product of a given taxon. In particular, two types of relationships are used: “only_in_taxon” indicates that a GO term should be used to annotate only gene products originating from a given taxon or one of its descendants, while “never_in_taxon” forbids the use of a GO term for that taxon and its descendants. In addition, the concepts represented in the GO directed acyclic graph obey the “true path rule”: (i) a negative relationship extends to the child terms of the GO term to which it is referred, while (ii) a positive one is valid for all the parent GO terms.</p>
  <p>The manual definition of constraints for almost 40,000 GO terms is not an affordable task and there is a strong need for an automated procedure as the one we have implemented in FunTaxIS (Functional Taxonomy Information System).</p>
  <p>FunTaxIS is able to automatically generate GO taxon constraints, as illustrated in <xref ref-type="fig" rid="f2">Fig. 2</xref>: starting from the protein level, it exploits GO annotations present in GOA and the frequencies of association between GO terms and taxa. Such constraints constitute the functional taxonomy, a sort of catalogue that describes taxa on the basis of the functions that they can or cannot perform. Notably, the constraints refer to taxa and not to specific proteins belonging to them: this means that a negative constraint for a particular taxon implies that none of its proteins should be able to perform such function, while a positive one suggests that at least one of them is able to achieve it.</p>
  <p>FunTaxIS provides GO taxon constraints for most of the GO graph and is a freely accessible platform that can help:<list id="l1" list-type="bullet"><list-item><p>to detect, and then to correct, many improper associations between taxa and functions, especially among those automatically inferred (<italic>e.g.</italic> when using tools for function prediction);</p></list-item><list-item><p>to complement phylogenomic studies<xref ref-type="bibr" rid="b17">17</xref> or, more generally, to accomplish comparative analyses among taxa based on their functions;</p></list-item><list-item><p>to visualize how functions are distributed among taxa;</p></list-item><list-item><p>to compare taxa on the basis of their annotated functions;</p></list-item><list-item><p>to put in evidence taxa that are unexpectedly weakly annotated and deserve to be further investigated;</p></list-item><list-item><p>to reason over the evolutionary significance of gain and loss of functions.</p></list-item></list></p>
  <p>Its effectiveness has been compared to the GOC constraints on simulated case studies of functional inference by sequence similarity, where the ability of the method to detect wrong annotations has been assessed.</p>
  <p>A web application has been developed for accessing and visualizing the taxon constraints and is available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://www.medcomp.medicina.unipd.it/funtaxis/">http://www.medcomp.medicina.unipd.it/funtaxis/</ext-link>.</p>
  <sec disp-level="1">
    <title>Methods</title>
    <sec disp-level="2">
      <title>Selection of GO terms</title>
      <p>Only frequently occurring GO terms in GOA database have been considered. In particular, we did not include in the analyses the terms whose absolute frequency, cumulative over their descendants, was lower than 500. Though arbitrary, this cut-off has allowed us to generate a starting list of robust constraints that the propagation rules (explained in “Rules for propagating polarities in the taxonomic tree”) have then extended to the less frequent and previously not considered GO terms, thus partially recovering them.</p>
    </sec>
    <sec disp-level="2">
      <title>Selection of “general taxa”</title>
      <p>The taxonomy database considered in this study (downloaded from NCBI<xref ref-type="bibr" rid="b18">18</xref><xref ref-type="bibr" rid="b19">19</xref> on January 2, 2016) contains 1,117,863 nodes whose rank is equal or below the “species” level. We have reduced its complexity for the following reasons: (1) very few species are functionally characterized (only 1,401 different species or inferior ranks are associated with at least one experimental annotation, corresponding to 0.12% of total species), (2) closely related species generally possess very similar annotations; (3) specific GO terms, which are required to discriminate closely related species, are often present in GOA with a very low occurrence and cannot be used to generate reliable statistics.</p>
      <p>Practically, only nodes ranked as “class” or above “class” in the NCBI taxonomy have been evaluated, and we will refer to them as “general taxa”. Furthermore, we have exploited other taxonomies, such as ITIS (Integrated Taxonomic Information System, retrieved on January 15, 2016, from <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://www.itis.gov">http://www.itis.gov</ext-link>) and Wikispecies, to gather consensus rank information for nodes with missing information, collecting a total of 532 nodes. Once filled several “holes” in the ranks, we have mapped each taxon, whose rank is under “class”, to the most specific “general taxon”.</p>
    </sec>
    <sec disp-level="2">
      <title>Definition of robust general taxa</title>
      <p>We have defined as “robust general taxa” only the highly annotated taxa that are able to provide sufficient information to support statistical inferences.</p>
      <p>To quantify the degree of functional knowledge that exists for a certain general taxon, we have retrieved the proteins belonging to all taxonomic nodes subsumed by that general taxon, together with their GO terms. Then we have partitioned the taxonomic tree into seven big groups, according to the kingdom/superkingdom ranks (see <xref ref-type="table" rid="t1">Table 1</xref>); moreover, the Metazoa group has been further split into two additional groups, “Chordata” and “Metazoa excluding Chordata”, resulting in the scenario depicted in <xref ref-type="supplementary-material" rid="S1">Supplementary Fig. S1.1</xref>. Within each group, a model organism has been identified and the other members of the group have been compared against it. To accomplish the task, the number of unique GO terms have been considered. A candidate general taxon is labelled as “robust” if it has more than 75% of unique annotations with respect to the amount of unique annotations of its reference model organism.</p>
    </sec>
    <sec disp-level="2">
      <title>Probability of association between GO terms and taxa</title>
      <p>The robust general taxa, previously defined, have been tested against all GO terms in order to determine the relative probability of finding a certain GO term associated to a particular general taxon. Let <italic>g</italic> be a GO term belonging to the sub-ontology <italic>A</italic>, <italic>c</italic><sub><italic>t,g</italic></sub> the number of proteins of a given taxon <italic>t</italic> annotated with <italic>g</italic> or one of its children, <italic>c</italic><sub><italic>g</italic></sub> the number of proteins annotated with <italic>g</italic> or one of its children in the whole GOA, <sup><italic>A</italic></sup><italic>c</italic> the number of proteins in GOA annotated with at least a GO term whose sub-ontology is <italic>A</italic>, and <sup><italic>A</italic></sup><italic>c</italic><sub><italic>t</italic></sub> the number of proteins belonging to the general taxon <italic>t</italic> and annotated with at least a GO term whose sub-ontology is <italic>A</italic>. We can now define the relative probability as:</p>
      <p>
        <disp-formula id="eq1">
          <inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e320" xlink:href="srep31971-m1.jpg"/>
        </disp-formula>
      </p>
    </sec>
    <sec disp-level="2">
      <title>Definition of GO taxon constraints</title>
      <p>The relative probabilities are further transformed in the range −1 and +1, defining either negative or positive “polarities” respectively (<italic>i.e.</italic> “prohibition” or “possibility” of association, respectively; see <xref ref-type="supplementary-material" rid="S1">Supplementary Section S2</xref>), while GO terms without a clear polarity with respect to a taxon are defined as “neutral”. Starting from these polarities, taxonomic constraints have been created: (i) a GO term with a positive polarity has been referred to as “in taxon”, meaning that it can be used to annotate the taxon itself and all of its children; (ii) a negative polarity is instead a “never in taxon” constraint, as neither that taxon nor any of its children can be annotated with that GO term. Note that, when there are no proteins linking a GO term to a general taxon, a dual strategy to decide how to classify that context has been adopted: if the taxon is robust (highly studied), a closed world assumption is made and then a “never in” constraint is inferred, otherwise an open world assumption is made<sup>20</sup> and no constraints are applied (that is a “neutral” scenario). Exceptions are made when experimentally validated functions for a taxon are found: regardless of their relative probability, we let manually curated annotations prevail over inferences based on their frequency.</p>
    </sec>
    <sec disp-level="2">
      <title>Rules for propagating polarities in the taxonomic tree</title>
      <p>Polarities generated for robust general taxa are transferred to the other taxonomic nodes by applying a series of rules that are summarized in the following (see <xref ref-type="fig" rid="f3">Fig. 3</xref>).<list id="l2" list-type="bullet"><list-item><p>Rule I: polar children propagate to the neutral parent, unless there are conflicts among siblings (see Rule III).</p></list-item><list-item><p>Rule II: a polar parent propagates its polarity to all the neutral children, unless at least one of them has the opposite polarity (see Rule IV).</p></list-item><list-item><p>Rule III: if two siblings have an opposite polarity, or one of them is ambiguous, their parent becomes ambiguous as well as their neutral siblings.</p></list-item><list-item><p>Rule IV: if a polar parent has at least one child with the opposite polarity, all other neutral children become ambiguous.</p></list-item></list></p>
      <p>These rules have been challenged with alternative propagation criteria and, compared to GOC constraints, showed better performance (see <xref ref-type="supplementary-material" rid="S1">Supplementary Section S3</xref>).</p>
    </sec>
    <sec disp-level="2">
      <title>Rules for propagating polarities in the GO graph</title>
      <p>A further strategy to expand the coverage of the GO constraints is the implementation of the “true path” rule which governs the GO graph. This rule says that if A is a parent of B then any property of A is inherited by B and, vice versa, if B is a child of A then any property not in A is also not in B. In logical terms:</p>
      <p>
        <disp-formula id="eq2">
          <inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e364" xlink:href="srep31971-m2.jpg"/>
        </disp-formula>
      </p>
      <p>Two propagation rules follow:<list id="l3" list-type="order"><list-item><p>positive polarities, or “in taxon” constraints, propagate toward the root;</p></list-item><list-item><p>negative polarities, or “never in taxon” constraints, propagate toward the leaves.</p></list-item></list></p>
      <p>The true path rule has been applied to infer constraints for some of the GO terms that are not directly evaluated because too rare or even absent in the GOA; in particular, negative constraints can be propagated downwards to the leaves of the graph. This strategy has led to the inference of constraints for 13,781 GO terms that were not addressed in the first phase.</p>
    </sec>
    <sec disp-level="2">
      <title>Robustness analysis</title>
      <p>The robustness of the method has been assessed by perturbing original annotations both in frequency and in absolute quantity and by comparing the results with the subset of manual constraints provided by GOC (<xref ref-type="supplementary-material" rid="S1">Supplementary Section S3</xref>). Furthermore, in order to assess the statistical significance of the generated taxonomic constraints (<italic>i.e</italic> assignment of a p-value to these constraints) we have implemented a bootstrap approach (<xref ref-type="supplementary-material" rid="S1">Supplementary Section S2</xref>).</p>
    </sec>
    <sec disp-level="2">
      <title>Benchmarking on case studies of proteome annotation</title>
      <p>The potential benefit of the application of taxon constraints has been evaluated on simulated cases based on different model organisms, namely <italic>S. cerevisiae</italic>, <italic>E. coli</italic>, <italic>A. thaliana</italic>, <italic>D. rerio</italic>, <italic>D. melanogaster</italic>, and <italic>H. sapiens</italic>. Briefly, we have assessed how functions can be inherited by a sequence similarity driven approach based on BLAST<xref ref-type="bibr" rid="b21">21</xref> searches <italic>vs.</italic> UniProt: for each query protein, the GO terms related to the first 100 BLAST hits have been retrieved from GOA, with e-values used as scores. To enrich the retrieval of GO terms from distant species, which may be functionally distinct from the model organisms and may carry incompatible GO annotations, we have removed from UniProt all the proteins of the corresponding taxonomic class (Saccharomycetes, Gammaproteobacteria, eudicotyledons, Actinopteri, Insecta, and Mammalia, respectively). Finally, the GO terms obtained with this method for the six proteomes have been filtered using taxon constraints: those provided by GOC, those generated by FunTaxIS, and their union have been applied independently, either with the open and the closed world hypotheses. In the first strategy, neutral cases are considered as “positive”, whereas in the second case they are rejected. The taxon compatibility of the results has been evaluated with a GO-centric approach: for each organism, the set of non redundant GO terms has been extracted from BLAST results (keeping the maximum score among all of the occurrences of each term) and has been compared with the set of non redundant GO terms associated to its proteins in GOA database, considered as the gold standard. Before the assessment, all the retrieved GO terms and those originally annotated on the benchmark proteins (true terms) have been propagated to the root of the ontologies.</p>
    </sec>
  </sec>
  <sec disp-level="1">
    <title>Results</title>
    <p>FunTaxIS is a tool for the large scale generation of taxon constraints intended to define the range of functions that can be employed to annotate the gene products of a particular species. These constraints, coded as “in taxon” or “never in taxon”, are produced starting from the frequency of association between GO terms and taxa in the GOA database. The taxonomic constraints can be easily accessed and visualized at the following url: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://www.medcomp.medicina.unipd.it/funtaxis/">http://www.medcomp.medicina.unipd.it/funtaxis/</ext-link>.</p>
    <sec disp-level="2">
      <title>Taxonomic tree reduction</title>
      <p>To simplify the taxonomic tree, all the species, genera, families, and orders have been collapsed into higher taxonomic levels, that we call “general taxa”, starting from the “class” rank: each taxon under the “class” rank has been associated with its nearest parent whose rank is equal or higher than “class”.</p>
      <p>Since we observed that the large majority of these general taxa were poorly characterized from a functional point of view, we decided to partition the taxonomic tree and found, within each sub-part, some well-studied nodes that could serve as reference for poorly studied branches. The partitioning follows the kingdom/superkingdom taxonomic classification, with the exception of Metazoa that has been further divided into “Chordata” and “Metazoa excluding Chordata”: within each group, the general taxon with the highest number of unique GO terms has been selected as reference taxon. The other members of the groups have been compared with the corresponding reference taxa and those possessing an adequate number of unique annotations have been selected as “robust general taxa”. This final list is the starting point for the generation of the taxon constraints (<xref ref-type="supplementary-material" rid="S1">Supplementary Section S1</xref>).</p>
    </sec>
    <sec disp-level="2">
      <title>GO terms evaluated</title>
      <p>To quantify the impact of FunTaxIS on the whole GO, we computed the coverage of the GO terms addressed by at least one taxon constraint. For this purpose, the propagation rules described in the “Methods” section have been applied; for comparison, the coverage obtained by GOC constraints was also computed. The results, reported in <xref ref-type="table" rid="t2">Table 2</xref>, show that FunTaxIS is able to infer taxon constraints on a wider subset of functions. Interestingly, the relative gain is bigger for the Molecular Function ontology, where only 74 terms are addressed by constraints provided by GOC.</p>
    </sec>
    <sec disp-level="2">
      <title>Generation of all taxonomic constraints and comparison with the existing constraints from the GO Consortium</title>
      <p>Since a taxonomic constraint can be either positive or negative, namely a GO term can be annotated “in” a particular taxon and “never in” a different taxon, the maximum number of taxonomic constraints that can be generated is the number of considered taxa multiplied by the total number of GO terms. However, constraints can be aggregated in two different ways: (1) by assigning them to shallow taxa (<italic>e.g.</italic> a “never in” applied to Fungi is also valid for all its children taxa) and (2) by collapsing GO terms that have parent-child relationships (<italic>e.g.</italic> for the “true path rule” of the GO graph, a “never in” for a certain GO term must be applied to all its children, while an “in” is also valid for all its parents).</p>
      <p>For an exhaustive assessment of FunTaxIS, we evaluated and compared the expanded version of constraints coming from GOC with those produced by FunTaxIS. In particular, the propagation rules described in “Methods” have been applied to extend constraints in the GO graph and to the taxonomic tree (but limited to the 532 general taxa of the reduced taxonomic tree), respectively.</p>
      <p>Following these principles, a total of 11,396,196 constraints have been obtained. The two sets of constraints produced by GOC and FunTaxIS are largely in agreement (only the 0.1% of them is discordant): in particular, 18.84% of total constraints are predicted by both FunTaxIS and GOC, 5.09% is only present in GOC, while the remaining 75.97% is a completely new set provided exclusively by FunTaxIS.</p>
      <p>FunTaxIS constraints were also compared against the data provided by Peng and co-authors<xref ref-type="bibr" rid="b22">22</xref> regarding human and yeast species, and the results show a very good agreement by the two methods. Details about these benchmarking analyses are reported in <xref ref-type="supplementary-material" rid="S1">Supplementary Section S4</xref>.</p>
    </sec>
    <sec disp-level="2">
      <title>Graphical representation of functions</title>
      <p>Once the taxonomic constraints have been generated, they can be projected either on the taxonomy, given a GO term, or on the GO graph, given a taxon. These orthogonal visualizations are both available in the FunTaxIS web server, in the “GO constraints” and “FunTasMaps” sections respectively, and are the essence of the functional taxonomy: the former allows the user to visually inspect the distribution of a certain function among taxa, the latter is the representation of the functional potentiality of a species and enables functional comparisons between different taxa. In the following, we will show a driven example for each of the approaches.</p>
    </sec>
    <sec disp-level="2">
      <title>GO-centric visualization</title>
      <p>In the “GO constraints” section of the web server, the user is required to input a GO term in order to generate the complete list of constraints for all the taxa. An auto-complete function helps the user when inserting the GO term, providing proper suggestions when either a term name or a term ID are entered, while the drop down menu allows to select the type of constraints that will be shown, between those generated by FunTaxIS, those provided by GOC, and a prioritized combination of the two (GOC prevails). After clicking the “submit” button the results page is shown, divided into two sections: a representation of the taxonomic tree is shown at the top of the page for a visual inspection of the generated constraints, where the polarity is color-coded (green stands for “in taxon” constraint, red for “never in taxon”, blue/cyan for “neutral”, and yellow for “dubious”). Below the picture, a table reports the complete list of all the taxon constraints generated for the GO term inserted by the user, together with additional data regarding the number of proteins involved in its calculation and the origin of the constraints that can be inherited by either GO or taxon propagation rules. The whole dataset can be downloaded in tabular format to ease the implementation in downstream analyses and an extended “Examples” section is available in the web server.</p>
      <p>A simple case can be explored by typing “GO:0007399” (“Nervous system development”). The GOC provides some constraints to limit the usage of this term, which are inherited from the parent term “multicellular organismal process” (GO:0032501). In particular, GOC reports that GO:0032501 should be used:<list id="l4" list-type="bullet"><list-item><p>“only in” taxon Eukaryota, meaning that this term and all of its children can be employed within this group but are banned for taxa outside Eukaryota;</p></list-item><list-item><p>“never in” taxa <italic>S. cerevisiae</italic> and <italic>S. pombe</italic>, meaning that this term and all of its children cannot be used to annotate proteins belonging to these two species.</p></list-item></list></p>
      <p>Such constraints can be displayed by selecting “GO consortium” in the “Constraints” drop down menu. Interestingly, all taxa within Eukaryota, with the exception of <italic>S. cerevisiae</italic> and <italic>S. pombe</italic>, do not possess any explicitly negative constraint for the GO term GO:0007399; hence, in principle, they could be annotated with this term. Such nodes are all drawn in blue and marked as “neutral”, since the positive constraint provided by GOC is referred to a parent GO term and does not propagate downward the ontology. The only explicit positive constraint, expressly marked as a green node, regards the taxon Metazoa and is inherited by GO:0010001 (glial cell differentiation). The latter is a child node of GO:0007399, thus can be propagated upward the ontology. Similarly, the user can obtain the constraints inferred by FunTaxIS by simply changing the appropriate parameter from the “Constraints” drop down menu. An insight of the proposed taxonomic tree is shown in <xref ref-type="fig" rid="f4">Fig. 4</xref> starting from the root of the tree and going towards the leaves, we can observe that Archaea and Bacteria are labelled with a negative constraint (red nodes), in accordance with GOC, while Eukaryota is dubious (yellow) because it has child nodes with either positive and negative polarities. This is exactly where FunTaxIS can help to improve the state of the art: within the subtree subsumed by Eukaryota, it is able to produce a more fine-grained set of constraints, which can increase their discriminatory power and expand their range of applications. For example, additional negative labels are placed on Viridiplantae, Basidiomycota, Pezizomycotina, and Amoebozoa, while the taxa with an explicit positive association (green) are Metazoa, Saccharomycotina and Parabasalia. All the remaining nodes are dubious, since FunTaxIS was not able to assign any constraint. Obviously, the system is not always correct, as wrong constraints can sometimes arise, especially for poorly studied taxa or in the presence of errors in GOA database. As an example, GO:0007399 is allowed for Saccharomycotina: this inconsistency is due to the presence, in GOA, of a manual annotation associated to <italic>C. albicans</italic> (Vanadate, VAN1, resistance protein: UniProt accession Q00314), a species belonging to the Saccharomycotina subphylum. There is also the wrong positive constraint of the protists Parabasalia which is due to spurious electronically inferred annotations that should be amended. The capability of easily presenting constraints over taxa is a unique feature of FunTaxIS web interface that can help users to discover potential evident issues in the annotations and to take the correct actions.</p>
    </sec>
    <sec disp-level="2">
      <title>Taxon-centric visualization and comparison between taxa</title>
      <p>We exploited the taxonomic constraints provided by FunTaxIS to build, for each most specific general taxon, a map of all its functions, accessible in the FunTasMaps section of the FunTaxIS web server. Such maps, that can be considered as functional fingerprints of taxa, are obtained by representing the GO graph in a circular space, where the colour code of nodes indicates functions that are present (green) or not present (red) in a given organism. To simplify the layout, functionally homogeneous GO terms with concordant taxonomic constraints can be collapsed into more generic functions: in this clustered view, nodes radii are proportional to the number of collapsed terms or supporting annotations.</p>
      <p>Interestingly, two species can be compared on the basis of their functions by overlapping their functional fingerprints, a feature attainable by inserting two organisms in the FunTasMaps form. In <xref ref-type="fig" rid="f5">Fig. 5</xref> the comparison between <italic>S. cerevisiae</italic> and <italic>A. thaliana</italic> is shown. The example is based on the clustered constraints derived from the Cellular Component sub-ontology and the most significant constraints are labelled. The fixed layout on which these constraints are placed helps to orientate the user and find the right correspondences on the map while comparing the differences between the two taxa. A list of the detailed differences is shown in the bottom box. Among the main differences that come to the surface there are plastid and thylakoid, typical of plants (<italic>A.thaliana</italic> in the example), and spore, mating projection etc. that are typical of fungi (<italic>S. cerevisiae</italic> in the example). Finally, these maps are even useful to unveil missing information and trace inconsistencies, as in the case of unexpected differences that could emerge between taxa because of lack of annotation in the database.</p>
    </sec>
    <sec disp-level="2">
      <title>Application of taxonomic constraints to case studies of sequence similarity-based functional transfer</title>
      <p>We carried out some case studies of functional annotation of different organisms to prove the effectiveness of taxonomic constraints: here we report the results for <italic>S. cerevisiae</italic> and <italic>A. thaliana</italic>, whereas other species are presented in <xref ref-type="supplementary-material" rid="S1">Supplementary Section S5</xref>. To simulate a difficult scenario, such as the case of non-model species with no clear homologs in UniProt, we removed from the database the proteins belonging to any species within the same taxonomic class; then, we considered the annotations of the first 100 hits retrieved by a BLAST search and their log-transformed e-values scores.</p>
      <p>The annotations produced with this method have been processed by applying taxonomic constraints derived from GOC and from FunTaxIS. Two different strategies have been adopted for those GO terms that are “neutral”, <italic>i.e.</italic> they do not possess a defined constraint for the analysed species: in the “closed world” hypothesis such terms have been discarded from the results, while in the “open world” they have been kept. The GO-centric results of the benchmark are shown in <xref ref-type="fig" rid="f6">Fig. 6</xref>: all non-redundant GO terms retrieved from BLAST hits are reported in the histograms (blue column), where bright and dark portions of bars represent true and false positives, respectively. The application of GOC (yellow) and FunTaxIS (bluish green) constraints results in a loss of GO terms, which prevalently affects those belonging to false positives. The higher coverage of FunTaxIS constraints has proven to outperform that provided by GOC and the benchmark highlights that FunTaxIS has been able to reduce a lot more “false positives”. The low coverage reached by GOC constraints is also the reason of the poor performance of “GOC constraints closed world”, since only GO terms with defined positive constraints survive this filtering step.</p>
      <p>To give an idea of the different impact of GOC and FunTaxIS constraints, we computed the word clouds starting from the GO descriptions of false positive terms that survive taxonomic filters in the open world hypothesis. In the cloud, turquoise and purple words come from wrong GO terms that remain in the dataset after GOC and FunTaxIS filtering, respectively. Since the size of words correlate with their frequency, terms like “antigen presentation”, “muscle”, and “synaptic” are those more often found among false positives in yeast, and clearly belong to GO terms not compatible with such organism. The constraints provided by FunTaxIS are able to detect a wider range of potential inconsistencies compared to GOC, leading to the elimination of a bigger number of not appropriate annotations. It is important to note that wrong annotations do not originate exclusively from weak BLAST hits, but even when considering the GO terms coming from very significant BLAST hits (e-value &lt; 1e-100, see <xref ref-type="supplementary-material" rid="S1">Supplementary Section S6</xref>).</p>
    </sec>
  </sec>
  <sec disp-level="1">
    <title>Discussion</title>
    <p>The functional characterization of genes and gene products has always played a central role in Biology, as it is the starting point for the elucidation of mechanisms and networks that govern the functioning of living organisms. The recent boost in omics sciences, particularly in the field of nucleic acids sequencing, has significantly increased the amount of data available for thousands of species, covering almost the whole taxonomy. Thanks to joint international efforts, the GO consortium has been able to create a rich vocabulary of functions, the Gene Ontology, consisting of terms that are organized in a graph structure and can be exploited to characterize protein sequences; such annotations are stored in the GOA database. Since each protein/gene stored in databanks usually contains information about the species of origin, we can obtain an implicit partitioning of the GO graph according to taxonomic criteria.</p>
    <p>FunTaxIS has been designed to infer specificities and commonalities of the functions among different taxa. The idea is not completely new, since the GO consortium itself has recently introduced the concept of taxon constraint<xref ref-type="bibr" rid="b16">16</xref>, but the development of a method able to infer taxonomic constraints on large scale has not been proposed until now. FunTaxIS draws its conclusions starting from available information about the frequency of association between functions and taxa that can be retrieved from UniProt and GOA databases. The rationale is quite straightforward: if a certain function is often associated to proteins of a particular taxon, we can be somewhat confident that they are compatible. On the contrary, there are two possible explanations for the lack of association between a function and a taxon: (1) the function is not present in that species, and consequently should never be used to annotate its proteins, or (2) the taxon is poorly studied, so the lack of association does not guarantee that an incompatibility exists.</p>
    <p>Based on these assumptions, FunTaxIS is able to infer the functional taxonomy, <italic>i.e.</italic> to determine which are the functions owned by a particular organism and those that are not or missing. The constraints are generated for nearly the whole taxonomy, exploiting information available for the most studied organisms to make inferences about the weakly characterized areas of the taxonomy.</p>
    <p>The potentiality of FunTaxIS lies in the flexibility of its querying system that, together with the functional fingerprints that are available for all taxa, can be a valid starting point for further investigations about functional profiles, either shared or specific among taxa, and a good system to ease the detection of potential annotation errors in the database. As an example, we report a finding that surprised us at a first glance: GO term “cellular response to abscisic acid stimulus” (GO ID: GO:0071215) has a positive constraint for both Viridiplantae and Mammalia. Abscisic acid (ABA) is a well known plant hormone involved in many plant developmental processes<xref ref-type="bibr" rid="b23">23</xref>, but we were not aware that ABA has been also recently characterized in mammalian cells, where it regulates glucose homeostasis<xref ref-type="bibr" rid="b24">24</xref>.</p>
    <p>Certainly, there are still issues that need to be addressed: positive constraints may originate from erroneous annotations in GOA, as in the case of Saccharomycotina for the term “Nervous system development”; or, on the contrary, some negative constraints may result from lack of annotations in certain taxa. But even in these cases, the output generated by FunTaxIS can be useful both for curators, in order to spot and then remove possible errors, and for biologists, that can be encouraged to investigate specific functions oddly absent in some taxa. In addition, the GOA is expected to grow significantly in the near future, both in terms of taxon coverage and annotation specificity; this <xref ref-type="supplementary-material" rid="S1">supplementary data</xref> should allow, on the one hand, to refine the simplified version of the taxonomic tree adopted in this study by including deeper nodes, and on the other hand to expand the set of GO terms covered by taxonomic constraints.</p>
    <p>Besides the usage discussed above, FunTaxIS can also be a valid support to address one of the issues concerning the annotation (assignment of GO terms) of the coding sequences from whole genome sequencing projects of non-model organisms. This part is usually carried out by tools for automatic protein function prediction that do not perform checks of annotation incompatibilities with the taxonomy of the target. As we directly observed, the major problems happen in the presence of difficult targets to predict, especially when there are no already characterized homologs and the sequence similarity approach is compromised. In such cases, it is easy for a predictive tool to take the wrong direction and deliver results that are not only wrong for the specific gene or protein, but are also completely incompatible for the species to which the gene/protein belongs. In this scenario, our automatic approach perfectly fits the need of detecting taxonomic inconsistencies, since it provides a high coverage of both the GO graph and the taxonomic tree, which is not affordable for manually curated constraints. We propose to integrate the constraints provided by FunTaxIS with those coming from the GO consortium, with the aim of improving both specificity and recall and obtaining a comprehensive system that could serve as guidance for the automatic function prediction. Negative constraints, in particular, are the key factors in this process, as they can be used to clean prediction results either by removing wrong annotations or by replacing them with more generic GO terms that are in the same path to the root but are not banned for the input species. The effectiveness of this approach has been already assessed in our automatic function prediction tool Argot2.5<xref ref-type="bibr" rid="b15">15</xref> that has improved its performance thanks to the implementation of taxon constraints. The platform has been conceived to be constantly updated and, as a future development, we plan to enhance its precision by allowing users’ interaction and integrating their corrections.</p>
  </sec>
  <sec disp-level="1">
    <title>Additional Information</title>
    <p><bold>How to cite this article</bold>: Falda, M. <italic>et al.</italic> Eliciting the Functional Taxonomy from protein annotations and taxa. <italic>Sci. Rep.</italic>
<bold>6</bold>, 31971; doi: 10.1038/srep31971 (2016).</p>
  </sec>
  <sec sec-type="supplementary-material" id="S1">
    <title>Supplementary Material</title>
    <supplementary-material id="d33e27" content-type="local-data">
      <caption>
        <title>Supplementary Information</title>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep31971-s1.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>This work was supported by University of Padova (grant number CPDA138081/13 to S.T.) and by University of Padova grant “assegno senior” and “bando giovani studiosi” (grant number GRIC13AAI9 to E.L.). Funding for open access charge: University of Padova grant 60A06-0303/15.</p>
  </ack>
  <ref-list>
    <ref id="b1">
      <mixed-citation publication-type="journal"><name><surname>Ashburner</surname><given-names>M.</given-names></name><italic>et al.</italic><article-title>Gene ontology: tool for the unification of biology. The Gene Ontology Consortium</article-title>. <source>Nature Genetics</source><volume>25</volume>, <fpage>25</fpage>–<lpage>29</lpage> (<year>2000</year>).<pub-id pub-id-type="pmid">10802651</pub-id></mixed-citation>
    </ref>
    <ref id="b2">
      <mixed-citation publication-type="journal"><name><surname>Huntley</surname><given-names>R. P.</given-names></name><italic>et al.</italic><article-title>The GOA database: gene ontology annotation updates for 2015</article-title>. <source>Nucleic Acids Research</source> 43(Database issue), <fpage>D1057</fpage>–<lpage>D1063</lpage> (<year>2014</year>).<pub-id pub-id-type="pmid">25378336</pub-id></mixed-citation>
    </ref>
    <ref id="b3">
      <mixed-citation publication-type="journal"><name><surname>Ward</surname><given-names>J. J.</given-names></name>, <name><surname>Sodhi</surname><given-names>J. S.</given-names></name>, <name><surname>McGuffin</surname><given-names>L. J.</given-names></name>, <name><surname>Buxton</surname><given-names>B. F.</given-names></name> &amp; <name><surname>Jones</surname><given-names>D. T.</given-names></name>
<article-title>Prediction and functional analysis of native disorder in proteins from the three kingdoms of life</article-title>. <source>Journal of Molecular Biology</source>
<volume>337</volume>, <fpage>635</fpage>–<lpage>645</lpage> (<year>2004</year>).<pub-id pub-id-type="pmid">15019783</pub-id></mixed-citation>
    </ref>
    <ref id="b4">
      <mixed-citation publication-type="journal"><name><surname>Friedberg</surname><given-names>I.</given-names></name><article-title>Automated protein function prediction–the genomic challenge</article-title>. <source>Briefings in Bioinformatics</source><volume>7</volume>, <fpage>225</fpage>–<lpage>242</lpage> (<year>2006</year>).<pub-id pub-id-type="pmid">16772267</pub-id></mixed-citation>
    </ref>
    <ref id="b5">
      <mixed-citation publication-type="journal"><name><surname>Stahl</surname><given-names>P. L.</given-names></name> &amp; <name><surname>Lundeberg</surname><given-names>J.</given-names></name>
<article-title>Toward the single-hour high-quality genome</article-title>. <source>Annual Review of Biochemistry</source>
<volume>81</volume>, <fpage>359</fpage>–<lpage>378</lpage> (<year>2012</year>).</mixed-citation>
    </ref>
    <ref id="b6">
      <mixed-citation publication-type="journal"><name><surname>Radivojac</surname><given-names>P.</given-names></name><italic>et al.</italic><article-title>A large-scale evaluation of computational protein function prediction</article-title>. <source>Nat Methods</source><volume>10</volume>, <fpage>221</fpage>–<lpage>227</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23353650</pub-id></mixed-citation>
    </ref>
    <ref id="b7">
      <mixed-citation publication-type="journal"><name><surname>Balakrishnan</surname><given-names>R.</given-names></name>, <name><surname>Harris</surname><given-names>M. A.</given-names></name>, <name><surname>Huntley</surname><given-names>R.</given-names></name>, <name><surname>Van Auken</surname><given-names>K.</given-names></name> &amp; <name><surname>Cherry</surname><given-names>J. M.</given-names></name>
<article-title>A guide to best practices for Gene Ontology (GO) manual annotation</article-title>. <source>Database: the journal of biological databases and curation</source>. (<year>2013</year>).</mixed-citation>
    </ref>
    <ref id="b8">
      <mixed-citation publication-type="journal"><name><surname>Burge</surname><given-names>S.</given-names></name><italic>et al.</italic><article-title>Manual GO annotation of predictive protein signatures: the InterPro approach to GO curation</article-title>. <source>Database : the journal of biological databases and curation</source>. (<year>2012</year>).</mixed-citation>
    </ref>
    <ref id="b9">
      <mixed-citation publication-type="journal"><name><surname>Skunca</surname><given-names>N.</given-names></name>, <name><surname>Altenhoff</surname><given-names>A.</given-names></name> &amp; <name><surname>Dessimoz</surname><given-names>C.</given-names></name>
<article-title>Quality of computationally inferred gene ontology annotations</article-title>. <source>PLoS Comput Biol</source>
<volume>8</volume>, <fpage>e1002533</fpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22693439</pub-id></mixed-citation>
    </ref>
    <ref id="b10">
      <mixed-citation publication-type="journal"><name><surname>Kusnierczyk</surname><given-names>W.</given-names></name><article-title>Taxonomy-based partitioning of the Gene Ontology</article-title>. <source>Journal of Biomedical Informatics</source><volume>41</volume>, <fpage>282</fpage>–<lpage>292</lpage> (<year>2008</year>).<pub-id pub-id-type="pmid">17921072</pub-id></mixed-citation>
    </ref>
    <ref id="b11">
      <mixed-citation publication-type="journal"><name><surname>Huntley</surname><given-names>R. P.</given-names></name>, <name><surname>Sawford</surname><given-names>T.</given-names></name>, <name><surname>Martin</surname><given-names>M. J.</given-names></name> &amp; <name><surname>O’Donovan</surname><given-names>C.</given-names></name>
<article-title>Understanding how and why the Gene Ontology and its annotations evolve: the GO within UniProt</article-title>. <source>Gigascience</source>
<volume>3</volume>, <fpage>4</fpage> (<year>2014</year>).<pub-id pub-id-type="pmid">24641996</pub-id></mixed-citation>
    </ref>
    <ref id="b12">
      <mixed-citation publication-type="journal"><name><surname>Ehmann</surname><given-names>D. E.</given-names></name>, <name><surname>Gehring</surname><given-names>A. M.</given-names></name> &amp; <name><surname>Walsh</surname><given-names>C. T.</given-names></name>
<article-title>Lysine biosynthesis in Saccharomyces cerevisiae: mechanism of alpha-aminoadipate reductase (Lys2) involves posttranslational phosphopantetheinylation by Lys5</article-title>. <source>Biochemistry</source>
<volume>38</volume>, <fpage>6171</fpage>–<lpage>6177</lpage> (<year>1999</year>).<pub-id pub-id-type="pmid">10320345</pub-id></mixed-citation>
    </ref>
    <ref id="b13">
      <mixed-citation publication-type="journal"><name><surname>Fontana</surname><given-names>P.</given-names></name>, <name><surname>Cestaro</surname><given-names>A.</given-names></name>, <name><surname>Velasco</surname><given-names>R.</given-names></name>, <name><surname>Formentin</surname><given-names>E.</given-names></name> &amp; <name><surname>Toppo</surname><given-names>S.</given-names></name>
<article-title>Rapid Annotation of Anonymous Sequences from Genome Projects Using Semantic Similarities and a Weighting Scheme in Gene Ontology</article-title>. <source>PLoS ONE</source>
<volume>4</volume>, <fpage>e4619</fpage> (<year>2009</year>).<pub-id pub-id-type="pmid">19247487</pub-id></mixed-citation>
    </ref>
    <ref id="b14">
      <mixed-citation publication-type="journal"><name><surname>Falda</surname><given-names>M.</given-names></name><italic>et al.</italic><article-title>Argot2: a large scale function prediction tool relying on semantic similarity of weighted Gene Ontology terms</article-title>. <source>Bmc Bioinformatics</source><volume>13</volume> Suppl 4, <fpage>S14</fpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22536960</pub-id></mixed-citation>
    </ref>
    <ref id="b15">
      <mixed-citation publication-type="journal"><name><surname>Lavezzo</surname><given-names>E.</given-names></name>, <name><surname>Falda</surname><given-names>M.</given-names></name>, <name><surname>Fontana</surname><given-names>P.</given-names></name>, <name><surname>Bianco</surname><given-names>L.</given-names></name> &amp; <name><surname>Toppo</surname><given-names>S.</given-names></name>
<article-title>Enhancing protein function prediction with taxonomic constraints - The Argot2.5 web server</article-title>. <source>Methods</source>
<volume>S1046–2023</volume><bold>(15)</bold>, <fpage>30065</fpage>–<lpage>30067</lpage> (<year>2015</year>).</mixed-citation>
    </ref>
    <ref id="b16">
      <mixed-citation publication-type="journal"><name><surname>Deegan</surname><given-names>J. I.</given-names></name>, <name><surname>Dimmer</surname><given-names>E. C.</given-names></name> &amp; <name><surname>Mungall</surname><given-names>C. J.</given-names></name>
<article-title>Formalization of taxon-based constraints to detect inconsistencies in annotation and ontology development</article-title>. <source>Bmc Bioinformatics</source>
<volume>11</volume>, <fpage>530</fpage> (<year>2010</year>).<pub-id pub-id-type="pmid">20973947</pub-id></mixed-citation>
    </ref>
    <ref id="b17">
      <mixed-citation publication-type="journal"><name><surname>Kim</surname><given-names>K. M.</given-names></name>, <name><surname>Nasir</surname><given-names>A.</given-names></name>, <name><surname>Hwang</surname><given-names>K.</given-names></name> &amp; <name><surname>Caetano-Anolles</surname><given-names>G.</given-names></name>
<article-title>A tree of cellular life inferred from a genomic census of molecular functions</article-title>. <source>Journal of Molecular Evolution</source>
<volume>79</volume>, <fpage>240</fpage>–<lpage>262</lpage> (<year>2014</year>).<pub-id pub-id-type="pmid">25128982</pub-id></mixed-citation>
    </ref>
    <ref id="b18">
      <mixed-citation publication-type="journal"><name><surname>Benson</surname><given-names>D. A.</given-names></name><italic>et al.</italic><article-title>GenBank</article-title>. <source>Nucleic Acids Research</source><volume>43</volume>, <fpage>D30</fpage>–<lpage>D35</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">25414350</pub-id></mixed-citation>
    </ref>
    <ref id="b19">
      <mixed-citation publication-type="journal"><name><surname>Sayers</surname><given-names>E. W.</given-names></name><italic>et al.</italic><article-title>Database resources of the National Center for Biotechnology Information</article-title>. <source>Nucleic Acids Res</source><volume>37</volume>, <fpage>D5</fpage>–<lpage>15</lpage> (<year>2009</year>).<pub-id pub-id-type="pmid">18940862</pub-id></mixed-citation>
    </ref>
    <ref id="b20">
      <mixed-citation publication-type="journal"><name><surname>Thomas</surname><given-names>P. D.</given-names></name><italic>et al.</italic><article-title>On the Use of Gene Ontology Annotations to Assess Functional Similarity among Orthologs and Paralogs: A Short Report</article-title>. <source>Plos Computational Biology</source><volume>8</volume>, <fpage>e1002386</fpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22359495</pub-id></mixed-citation>
    </ref>
    <ref id="b21">
      <mixed-citation publication-type="journal"><name><surname>Altschul</surname><given-names>S. F.</given-names></name><italic>et al.</italic><article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>. <source>Nucleic Acids Research</source><volume>25</volume>, <fpage>3389</fpage>–<lpage>3402</lpage> (<year>1997</year>).<pub-id pub-id-type="pmid">9254694</pub-id></mixed-citation>
    </ref>
    <ref id="b22">
      <mixed-citation publication-type="journal"><name><surname>Peng</surname><given-names>J.</given-names></name>, <name><surname>Chen</surname><given-names>J.</given-names></name> &amp; <name><surname>Wang</surname><given-names>Y.</given-names></name>
<article-title>Identifying cross-category relations in gene ontology and constructing genome-specific term association networks</article-title>. <source>Bmc Bioinformatics</source>
<volume>14</volume> Suppl 2, <fpage>S15</fpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23368677</pub-id></mixed-citation>
    </ref>
    <ref id="b23">
      <mixed-citation publication-type="journal"><name><surname>Gomez-Cadenas</surname><given-names>A.</given-names></name><italic>et al.</italic><article-title>Abscisic Acid: a versatile phytohormone in plant signaling and beyond</article-title>. <source>Curr Protein Pept Sci</source><volume>16</volume>, <fpage>413</fpage>–<lpage>434</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">25824385</pub-id></mixed-citation>
    </ref>
    <ref id="b24">
      <mixed-citation publication-type="journal"><name><surname>Sturla</surname><given-names>L.</given-names></name><italic>et al.</italic><article-title>LANCL2 is necessary for abscisic acid binding and signaling in human granulocytes and in rat insulinoma cells</article-title>. <source>Journal of Biological Chemistry</source><volume>284</volume>, <fpage>28045</fpage>–<lpage>28057</lpage> (<year>2009</year>).<pub-id pub-id-type="pmid">19667068</pub-id></mixed-citation>
    </ref>
  </ref-list>
  <fn-group>
    <fn>
      <p><bold>Author Contributions</bold> M.F., E.L. and S.T. conceived the study and wrote the manuscript. M.F. implemented the web server and the underlying constraints generation engine. M.B. carried out the statistical tests. E.F., S.T., M.B. and E.L. performed the biological assessment of the tool. L.B. and P.F. contributed to the critical review of the study. All authors read and approved the final version of the paper.</p>
    </fn>
  </fn-group>
</back>
<floats-group>
  <fig id="f1">
    <label>Figure 1</label>
    <caption>
      <title>Distribution of functions over taxa.</title>
      <p>On the left, the GO graph represents functions with different levels of specificity, ranging from the most specific up to the most generic definitions. On the right, the application of the constraints on taxa: the term GO:0019878 (allowed for Fungi but denied for Plants and Mammalia, that are grey shaded) is more specific than GO:0009085 (allowed for Fungi and Plants), that in turn is more specific than GO:0009067 and GO:0006553 (both GO terms are allowed for Fungi, Plants and Mammalia). The root of the graph (GO:0008150) gathers all the biological processes.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep31971-f1"/>
  </fig>
  <fig id="f2">
    <label>Figure 2</label>
    <caption>
      <title>Working concept of FunTaxIS.</title>
      <p>FunTaxIS can take advantage of the existing links that relate proteins with GO functional annotations and the taxonomy of origin (upper part of figure). Through statistical considerations that allows both to assess and expand the functional attributions to species, our tool is able to abstract functions that are allowed or forbidden in some taxa directly linking functions to taxonomy (lower part of figure).</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep31971-f2"/>
  </fig>
  <fig id="f3">
    <label>Figure 3</label>
    <caption>
      <title>Propagation rules in the taxonomic tree.</title>
      <p>Red and green nodes represent taxa with negative and positive constraints, respectively. Yellow nodes are dubious. See “Methods” for extended details on the applied rules.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep31971-f3"/>
  </fig>
  <fig id="f4">
    <label>Figure 4</label>
    <caption>
      <title>Simplified taxonomic tree produced by FunTaxIS for the GO term GO:0007399 (nervous system development).</title>
      <p>Nodes represent taxa, while the color code denotes the taxon constraints: red nodes are “never in” constraints, green nodes are “in”, yellow nodes are dubious (no decisions have been made).</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep31971-f4"/>
  </fig>
  <fig id="f5">
    <label>Figure 5</label>
    <caption>
      <title>FunTasMaps of clustered constraints from cellular components of <italic>A. thaliana</italic> and <italic>S. cerevisiae</italic>.</title>
      <p>In the upper and middle boxes, the <italic>A. thaliana</italic> and <italic>S. cerevisiae</italic> functional fingerprints are shown, with labels highlighting the more significant GO clusters. Green and red circles refer to positive (“in taxon”) and negative (“never in taxon”) GO constraints, respectively. The bottom box reports the comparison of the two maps and some of the most relevant differences found between the two taxa are labeled. Red and violet circles refer to GO terms that are only present in <italic>A. thaliana</italic> and <italic>S. cerevisiae</italic>, respectively. The radius of the circles depends on the number of collapsed GO nodes or supporting annotations.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep31971-f5"/>
  </fig>
  <fig id="f6">
    <label>Figure 6</label>
    <caption>
      <title>GO-centric evaluation of the impact of taxon constraints on <italic>A. thaliana</italic> and <italic>S. cerevisiae</italic> annotation by sequence-based functional transfer.</title>
      <p>(<bold>a</bold>) Non redundant GO terms retrieved by BLAST hits and grouped by the e-value of the alignment. The lower bright portion of columns represents true positives, that are the GO terms associated in GOA to at least one protein belonging to <italic>A. thaliana</italic> (left) or <italic>S. cerevisiae</italic> (right); the upper dark fraction represents false positives (GO terms never associated to <italic>A. thaliana</italic> or <italic>S. cerevisiae</italic> proteins). “Open” and “closed” world refer to the treatment of GO terms without any explicit constraint: such terms have been either discarded (closed) or retained (open); (<bold>b</bold>) Word clouds of the most frequent terms contained in GO definitions of false positive annotations (<italic>A. thaliana</italic> and <italic>S. cerevisiae</italic> respectively): turquoise and purple words come from GO terms with no defined constraints from GOC and FunTaxIS, respectively. The size of terms is proportional to their frequency (<italic>e.g</italic>. “muscle” is found in 74 different GO terms).</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep31971-f6"/>
  </fig>
  <table-wrap position="float" id="t1">
    <label>Table 1</label>
    <caption>
      <title>Groups resulting from the partitioning of the taxonomic tree.</title>
    </caption>
    <table frame="hsides" rules="groups" border="1">
      <colgroup>
        <col align="left"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
      </colgroup>
      <thead valign="bottom">
        <tr>
          <th colspan="2" align="center" valign="top" charoff="50">Groups</th>
          <th colspan="2" align="center" valign="top" charoff="50">General taxon of the model organism</th>
          <th colspan="2" align="center" valign="top" charoff="50">Model organism</th>
        </tr>
        <tr>
          <th align="left" valign="top" charoff="50">taxon ID</th>
          <th align="center" valign="top" charoff="50">Groupsubsumer</th>
          <th align="center" valign="top" charoff="50">taxon ID</th>
          <th align="center" valign="top" charoff="50">General taxon name</th>
          <th align="center" valign="top" charoff="50">taxonID</th>
          <th align="center" valign="top" charoff="50">Species name</th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td align="left" valign="top" charoff="50">554915</td>
          <td align="center" valign="top" charoff="50">Amoebozoa</td>
          <td align="center" valign="top" charoff="50">142796</td>
          <td align="center" valign="top" charoff="50">Mycetozoa</td>
          <td align="center" valign="top" charoff="50">44689</td>
          <td align="center" valign="top" charoff="50">
            <italic>Dictyostelium discoideum</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">2157</td>
          <td align="center" valign="top" charoff="50">Archaea</td>
          <td align="center" valign="top" charoff="50">183963</td>
          <td align="center" valign="top" charoff="50">Halobacteria</td>
          <td align="center" valign="top" charoff="50">2243</td>
          <td align="center" valign="top" charoff="50">
            <italic>Halobacterium sp.</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">2</td>
          <td align="center" valign="top" charoff="50">Bacteria</td>
          <td align="center" valign="top" charoff="50">1236</td>
          <td align="center" valign="top" charoff="50">Gammaproteobacteria</td>
          <td align="center" valign="top" charoff="50">562</td>
          <td align="center" valign="top" charoff="50">
            <italic>Escherichia coli</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">7711</td>
          <td align="center" valign="top" charoff="50">Chordata</td>
          <td align="center" valign="top" charoff="50">40674</td>
          <td align="center" valign="top" charoff="50">Mammalia</td>
          <td align="center" valign="top" charoff="50">9606</td>
          <td align="center" valign="top" charoff="50">
            <italic>Homo sapiens</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">4751</td>
          <td align="center" valign="top" charoff="50">Fungi</td>
          <td align="center" valign="top" charoff="50">4891</td>
          <td align="center" valign="top" charoff="50">Saccharomycetes</td>
          <td align="center" valign="top" charoff="50">4932</td>
          <td align="center" valign="top" charoff="50">
            <italic>Saccharomyces cerevisiae</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">33317</td>
          <td align="center" valign="top" charoff="50">Metazoa excluding Chordata</td>
          <td align="center" valign="top" charoff="50">50557</td>
          <td align="center" valign="top" charoff="50">Insecta</td>
          <td align="center" valign="top" charoff="50">7227</td>
          <td align="center" valign="top" charoff="50">
            <italic>Drosophila melanogaster</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">33090</td>
          <td align="center" valign="top" charoff="50">Viridiplantae</td>
          <td align="center" valign="top" charoff="50">71240</td>
          <td align="center" valign="top" charoff="50">Eudicotyledons</td>
          <td align="center" valign="top" charoff="50">33090</td>
          <td align="center" valign="top" charoff="50">
            <italic>Arabidopsis thaliana</italic>
          </td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn id="t1-fn1">
        <p>For each group, the general taxon of the model organism and the model organism itself are reported. For Archaea, the most annotated organism has been selected.</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
  <table-wrap position="float" id="t2">
    <label>Table 2</label>
    <caption>
      <title>Coverage of taxon constraints on the whole set of GO terms.</title>
    </caption>
    <table frame="hsides" rules="groups" border="1">
      <colgroup>
        <col align="left"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
      </colgroup>
      <thead valign="bottom">
        <tr>
          <th align="left" valign="top" charoff="50"> </th>
          <th align="center" valign="top" charoff="50">Biological Process</th>
          <th align="center" valign="top" charoff="50">Molecular Function</th>
          <th align="center" valign="top" charoff="50">Cellular Component</th>
          <th align="center" valign="top" charoff="50">Total</th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td align="left" valign="top" charoff="50">GO terms</td>
          <td align="center" valign="top" charoff="50">28,201</td>
          <td align="center" valign="top" charoff="50">9,983</td>
          <td align="center" valign="top" charoff="50">3,867</td>
          <td align="center" valign="top" charoff="50">42,051</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">GO terms with at least 1 taxon constraint from FunTaxIS (%)</td>
          <td align="center" valign="top" charoff="50">27,616 (97.93%)</td>
          <td align="center" valign="top" charoff="50">8,584 (85.99%)</td>
          <td align="center" valign="top" charoff="50">3,506 (90.66%)</td>
          <td align="center" valign="top" charoff="50">39,707 (94.43%)</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">GO terms with at least 1 taxon constraint from GOC (%)</td>
          <td align="center" valign="top" charoff="50">9,569 (33.93%)</td>
          <td align="center" valign="top" charoff="50">74 (0.74%)</td>
          <td align="center" valign="top" charoff="50">3,088 (79.86%)</td>
          <td align="center" valign="top" charoff="50">12,731 (30.28%)</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</floats-group>
