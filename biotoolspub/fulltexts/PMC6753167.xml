<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Neurosci</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Neurosci</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Neurosci.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Neuroscience</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1662-4548</issn>
    <issn pub-type="epub">1662-453X</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6753167</article-id>
    <article-id pub-id-type="doi">10.3389/fnins.2019.00975</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Neuroscience</subject>
        <subj-group>
          <subject>Methods</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>VETA: An Open-Source Matlab-Based Toolbox for the Collection and Analysis of Electromyography Combined With Transcranial Magnetic Stimulation</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Jackson</surname>
          <given-names>Nicko</given-names>
        </name>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/803343/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Greenhouse</surname>
          <given-names>Ian</given-names>
        </name>
        <xref ref-type="corresp" rid="c001">
          <sup>*</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/734291/overview"/>
      </contrib>
    </contrib-group>
    <aff><institution>Department of Human Physiology, University of Oregon</institution>, <addr-line>Eugene, OR</addr-line>, <country>United States</country></aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p>Edited by: Silvina Horovitz, National Institute of Neurological Disorders and Stroke (NINDS), United States</p>
      </fn>
      <fn fn-type="edited-by">
        <p>Reviewed by: Felipe Vial, National Institutes of Health (NIH), United States; Gerard Derosiere, Catholic University of Leuven, Belgium</p>
      </fn>
      <corresp id="c001">*Correspondence: Ian Greenhouse, <email>img@uoregon.edu</email></corresp>
      <fn fn-type="other" id="fn004">
        <p>This article was submitted to Brain Imaging Methods, a section of the journal Frontiers in Neuroscience</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>9</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>13</volume>
    <elocation-id>975</elocation-id>
    <history>
      <date date-type="received">
        <day>08</day>
        <month>5</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>8</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2019 Jackson and Greenhouse.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>Jackson and Greenhouse</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>The combination of electromyography (EMG) and transcranial magnetic stimulation (TMS) offers a powerful non-invasive approach for investigating corticospinal excitability in both humans and animals. Acquiring and analyzing the data produced with this combination of tools requires overcoming multiple technical hurdles. Due in part to these technical hurdles, the field lacks standard routines for EMG data collection and analysis. This poses a problem for study replication and direct comparisons. Although software toolboxes already exist that perform either online EMG data visualization or offline analysis, there currently are no openly available toolboxes that flexibly perform both and also interface directly with peripheral EMG and TMS equipment. Here, we introduce Visualize EMG TMS Analyze (VETA), a MATLAB-based toolbox that supports simultaneous EMG data collection and visualization as well as automated offline processing and is specially tailored for use with motor TMS. The VETA toolbox enables the simultaneous recording of EMG, timed administration of TMS, and presentation of behavioral stimuli from a single computer. These tools also provide a streamlined analysis pipeline with interactive data visualization. Finally, VETA offers a standard EMG data format to facilitate data sharing and open science.</p>
    </abstract>
    <kwd-group>
      <kwd>brain stimulation</kwd>
      <kwd>transcranial magnetic stimulation</kwd>
      <kwd>electromyography</kwd>
      <kwd>motor evoked potential</kwd>
      <kwd>short latency intracortical inhibition</kwd>
      <kwd>cortical silent period</kwd>
      <kwd>motor control</kwd>
      <kwd>code:matlab</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source id="cn001">National Center for Advancing Translational Sciences<named-content content-type="fundref-id">10.13039/100006108</named-content></funding-source>
      </award-group>
    </funding-group>
    <counts>
      <fig-count count="7"/>
      <table-count count="2"/>
      <equation-count count="0"/>
      <ref-count count="39"/>
      <page-count count="12"/>
      <word-count count="0"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="S1">
    <title>Introduction</title>
    <p>Ever since the groundbreaking studies conducted by Luigi Galvani in the late 18th century, the role of electricity in the control of muscles has been an important and fruitful topic of research. Electromyography (EMG) is a powerful method for recording muscle electrical activity that yields rich data and has a wide variety of applications. In combination with other techniques, EMG provides unique insights into the fundamental mechanisms that drive animal and human movement.</p>
    <p>Transcranial magnetic stimulation (TMS) is a form of non-invasive brain stimulation that when combined with EMG can measure corticospinal excitability with high temporal resolution. A single TMS pulse of sufficient intensity administered over a muscle representation in primary motor cortex can excite the corticospinal pathway and activate the targeted muscle to produce a motor evoked potential (MEP), which reflects the momentary state of excitability of the output pathway of the motor system. In addition to commonly evaluated features of EMG activity associated with voluntary muscle contraction, many other metrics can be quantified using the combination of EMG and TMS such as MEP onset latency, MEP peak-to-peak amplitude, and MEP duration (for review see <xref rid="B4" ref-type="bibr">Bestmann and Krakauer, 2015</xref>). These metrics are often used to characterize the dynamics of motor system excitability at rest and during the performance of behavioral tasks.</p>
    <p>Transcranial magnetic stimulation-derived metrics have a wide range of research and clinical applications in the fields of Physiology, Psychology, Psychiatry, Kinesiology, Biomechanics, Neuroscience, and Neurology. The number of research studies utilizing combined EMG and TMS methods has increased dramatically in recent years. According to PubMed, in the 20 years preceding the writing of this article there have been 4955 published studies that include both the terms “EMG” and “MEP” anywhere in their text. This includes a wide variety of research studies with neurological and neuropsychological applications ranging from the evaluation of basic mechanisms, e.g., assessing the speed of nerve conduction and excitability state of the motor system in Parkinson’s disease (<xref rid="B18" ref-type="bibr">Kandler et al., 1990</xref>; <xref rid="B32" ref-type="bibr">Vacherot et al., 2010</xref>), to the prediction of clinical outcomes. For example, TMS-elicited MEPs may help predict which patients are likely to recover after stroke (<xref rid="B31" ref-type="bibr">Smith and Stinear, 2016</xref>) or are likely to respond to non-motor repetitive TMS for the treatment of depression (<xref rid="B26" ref-type="bibr">Oliveira-Maia et al., 2017</xref>). TMS has also shown promise for the diagnosis of Alzheimer’s disease because these patients exhibit heightened sensitivity to motor TMS (<xref rid="B7" ref-type="bibr">Di Lazzaro et al., 2004</xref>). In non-clinical research, the combination of EMG and TMS has been applied to the assessment of biomechanical performance, e.g., the study of relationships between limb position and motor system excitability (<xref rid="B23" ref-type="bibr">Lin et al., 2015</xref>) and between cortical excitability and volitional control of gait (<xref rid="B16" ref-type="bibr">Ito et al., 2015</xref>). In the fields of Neuroscience and Psychology these methods have been applied to the investigation of a plethora of behavioral and psychophysical phenomena including changes in motor excitability during the preparation of movement (<xref rid="B9" ref-type="bibr">Duque et al., 2010</xref>; <xref rid="B13" ref-type="bibr">Greenhouse et al., 2015</xref>; <xref rid="B22" ref-type="bibr">Lebon et al., 2016</xref>; <xref rid="B21" ref-type="bibr">Labruna et al., 2019</xref>), reductions in motor excitability during behavioral stopping (<xref rid="B1" ref-type="bibr">Badry et al., 2009</xref>; <xref rid="B12" ref-type="bibr">Greenhouse et al., 2012</xref>; <xref rid="B36" ref-type="bibr">Wessel et al., 2013</xref>) and surprising events (<xref rid="B34" ref-type="bibr">Wessel and Aron, 2013</xref>, <xref rid="B35" ref-type="bibr">2017</xref>), intrinsic individual differences in motor performance (<xref rid="B11" ref-type="bibr">Greenhouse et al., 2017</xref>), and volitional control of brain states (<xref rid="B29" ref-type="bibr">Ruddy et al., 2018</xref>). There are important veterinary research applications as well (<xref rid="B25" ref-type="bibr">Nollet et al., 2004</xref>).</p>
    <p>While these wide-ranging research applications are not necessarily commonplace in the clinic, some clinical procedures for motor TMS are fairly common (<xref rid="B8" ref-type="bibr">Di Lazzaro et al., 1999</xref>; <xref rid="B14" ref-type="bibr">Hallett, 2007</xref>). These include the determination of individual sensitivity thresholds for administering repetitive TMS therapies for the treatment of migraine (<xref rid="B2" ref-type="bibr">Barker and Shields, 2017</xref>), major depression (<xref rid="B27" ref-type="bibr">O’Reardon et al., 2007</xref>), and other psychiatric disorders (<xref rid="B3" ref-type="bibr">Bersani et al., 2013</xref>), mapping the motor cortex to guide neurosurgery (<xref rid="B30" ref-type="bibr">Seynaeve et al., 2019</xref>), and evaluating the integrity of cortical and output pathways in motor disorders (<xref rid="B10" ref-type="bibr">Edwards et al., 2008</xref>). These procedures occur on a daily basis in clinics throughout the world.</p>
    <p>Given the diverse applications of these methods, there is an apparent need for standardized and automated data collection and analysis tools. While some studies have relied on the visual detection of TMS elicited muscle movements, the determination of an individual’s sensitivity to TMS using this method alone overestimates their true threshold, and this has important safety considerations for both research and clinical applications (<xref rid="B37" ref-type="bibr">Westin et al., 2014</xref>). Standardization and automatization of combined EMG and TMS procedures can help to alleviate risks associated with over-stimulation by more accurately and consistently determining individual thresholds. Unfortunately, automated simultaneous EMG measurement and TMS administration has traditionally required interfacing multiple computers and the adaptation of software developed for purposes other than MEP measurement.</p>
    <p>Open source toolboxes exist for separate online biosignal visualization (SigViewer, <xref rid="B6" ref-type="bibr">Brunner et al., 2013</xref>) and offline EMG analysis and visualization (<xref rid="B15" ref-type="bibr">Harquel et al., 2016</xref>; <xref rid="B24" ref-type="bibr">Mullins and Hanlon, 2016</xref>). However, the application of separate software for online and offline procedures introduces extra data conversion steps which can produce errors or artifacts related to incompatibilities across platforms. Combining both online and offline functions within a single toolbox provides a number of advantages by streamlining the data collection and analysis process. Moreover, while there is a general consensus on guidelines for the safe and ethical administration of TMS (<xref rid="B28" ref-type="bibr">Rossi et al., 2009</xref>), there is no existing common standard format for EMG data recordings. The lack of a universal standard data format adds an additional challenge for comparisons across studies and creates an artificial divide between users of different software packages. This problem is compounded by a lack of tools for converting between the many different formats of EMG data. A standardized, automated method for recording EMG and calculating common metrics can facilitate robust comparisons across research studies and improve the overall reliability and safety of experiments. Additionally, tools for converting a variety of EMG data types to a common format will support open science practices.</p>
    <p>Here, we describe the Visualize EMG TMS Analyze (<xref rid="B17" ref-type="bibr">Jackson and Greenhouse, 2019</xref>; VETA<sup><xref ref-type="fn" rid="footnote1">1</xref></sup>, <ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/RRID:_SCR_017201">RRID: SCR_017201</ext-link>, doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.2673030">10.5281/zenodo.2673030</ext-link>) Matlab toolbox for on-line EMG data visualization, automated analysis, and interactive off-line data review. The VETA toolbox was specifically designed to interface with EMG and TMS equipment to facilitate the measurement of MEP and EMG activity patterns commonly observed in laboratory research studies and in the clinic. The toolbox has been tested with Matlab versions 2017b through 2019a, and efforts will be made to support future Matlab versions. The code is written to be flexibly adaptable for new applications, includes tools for importing data from other software, and is freely available for download.</p>
  </sec>
  <sec id="S2">
    <title>Materials and Equipment</title>
    <p>The VETA toolbox is comprised of three separate tools (<xref ref-type="fig" rid="F1">Figure 1</xref>) designed to be executed in sequence:</p>
    <fig id="F1" position="float">
      <label>FIGURE 1</label>
      <caption>
        <p>Schematic of VETA workflow. Data can either be collected with recordEMG or generated by other data acquisition software such as EMGworks, BIOPAC AcqKnowledge, or Signal. The automated detection of events is performed with findEMG and associated metrics are calculated. Interactive review of data is performed with visualizeEMG, allowing the user to manually correct misidentified events.</p>
      </caption>
      <graphic xlink:href="fnins-13-00975-g001"/>
    </fig>
    <list list-type="simple" id="S2.I1">
      <list-item>
        <label>(1)</label>
        <p>recordEMG,</p>
      </list-item>
      <list-item>
        <label>(2)</label>
        <p>findEMG,</p>
      </list-item>
      <list-item>
        <label>(3)</label>
        <p>visualizeEMG.</p>
      </list-item>
    </list>
    <p>First, recordEMG simultaneously visualizes and collects EMG data. Then, findEMG identifies common EMG events in the data and calculates metrics. Finally, visualizeEMG provides a graphical user interface for the interactive review of the raw data with event markers displayed alongside the calculated metrics. The required software and hardware for each tool are listed in <xref rid="T1" ref-type="table">Table 1</xref>. The following sections further describe the capabilities of each function and how to execute them.</p>
    <table-wrap id="T1" position="float">
      <label>TABLE 1</label>
      <caption>
        <p>Necessary software and hardware.</p>
      </caption>
      <table frame="hsides" rules="groups" cellspacing="5" cellpadding="5">
        <thead>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">
              <bold>Tool</bold>
            </td>
            <td valign="top" align="left" rowspan="1" colspan="1">
              <bold>Matlab and toolboxes</bold>
            </td>
            <td valign="top" align="left" rowspan="1" colspan="1">
              <bold>Hardware</bold>
            </td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">recordEMG</td>
            <td valign="top" align="left" rowspan="1" colspan="1">Matlab 2017b or later<break/>Data Acquisition Toolbox<break/>Statistics and Machine Learning Toolbox<break/>Psychtoolbox</td>
            <td valign="top" align="left" rowspan="1" colspan="1">Compatible DAQ<break/>EMG recording equipment</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">findEMG</td>
            <td valign="top" align="left" rowspan="1" colspan="1">Matlab 2017b or later<break/>Signal Processing Toolbox</td>
            <td valign="top" align="left" rowspan="1" colspan="1">None required</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">visualizeEMG</td>
            <td valign="top" align="left" rowspan="1" colspan="1">Matlab 2017b or later</td>
            <td valign="top" align="left" rowspan="1" colspan="1">None required</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <sec id="S2.SS1">
      <title>recordEMG</title>
      <p>This function plots and records consecutive sweeps of EMG data (<xref ref-type="fig" rid="F2">Figure 2</xref>).</p>
      <fig id="F2" position="float">
        <label>FIGURE 2</label>
        <caption>
          <p>Schematic of the <bold>recordEMG</bold> function indicating the default parameters (red boxes), user input (dashed box), and output (blue box).</p>
        </caption>
        <graphic xlink:href="fnins-13-00975-g002"/>
      </fig>
      <sec id="S2.SS1.SSS1">
        <title>Syntax</title>
        <p>&gt;&gt;recordEMG.</p>
      </sec>
      <sec id="S2.SS1.SSS2">
        <title>Description</title>
        <p>Parameters (default values in parentheses) are specified below the header block and include the number of sweeps (4000), sampling rate (5000 Hz), sweep duration (2 s), <italic>Y</italic>-axis range for plotting (± 0.1 V), <italic>X</italic>-axis range for plotting (0–2 s), and reference lines for visualizing EMG event amplitudes (±0.025 V). All these values can be tailored to suit the needs of an individual experiment. The default reference line values were selected based upon a standard approach used to determine MEP resting motor threshold, i.e., the lowest intensity TMS stimulus to elicit MEPs of at least 50 μV on 50% of attempts.</p>
        <p>There are two options for saving data using the “save_per_sweep” parameter. Option 0 saves the data at the end of the complete acquisition session. With this option data are collected with minimal delay between sweeps. Alternatively, option 1 saves the data after each individual sweep. Saving the data after each sweep introduces an acquisition delay of a duration depending on the computer processor speed and RAM. The default “save_per_sweep” setting is 0 resulting in minimal delay between consecutive sweeps.</p>
        <p>The <bold>recordEMG</bold> function can also be used to calculate maximum voluntary contraction (MVC). Additional parameters are specified below the header block for the calculation of MVC. The default settings for measuring MVC include four sweeps at 4 s per sweep from a single channel. At the completion of recording, the maximum peak-to-peak EMG amplitude is calculated from the four consecutive sweeps. A calculated “MVC_percentage” (5%) relative to the maximum peak-to-peak EMG amplitude recorded across the four sweeps is outputted to the command line. This is particularly useful for setting up commonly used paired-pulse protocols, such as SICI (<xref rid="B20" ref-type="bibr">Kujirai et al., 1993</xref>; <xref rid="B39" ref-type="bibr">Ziemann et al., 1996</xref>) or cortical silent period (CSP; <xref rid="B33" ref-type="bibr">Werhahn et al., 1999</xref>; <xref rid="B38" ref-type="bibr">Wilson et al., 1993</xref>) protocols during which muscle contractions are often maintained at a set percentage of MVC.</p>
        <p>When <bold>recordEMG</bold> is called, the user is prompted to choose between practice (0) or run/save (1). When in practice mode, data are not saved. This mode is useful for visualizing data when storing the data is unnecessary, e.g., troubleshooting or evaluating EMG quality during initial setup for recording. In contrast, if run/save is selected, data are saved according to the method set by the “save_per_sweep” parameter described above.</p>
        <p>The user is then prompted to input whether MVC will be measured (1 for yes, or 0 for no). If MVC is measured, only one channel will be displayed, otherwise the user is prompted to enter the number of channels to record. Additional prompts request the user enter the subject ID, handedness, sex, date of birth, and resting motor threshold. These entries can be modified or commented out of the code according to the information the experimenter would like to store with the data. Altering these inputs or associated variables does not pose any loss of functionality to the EMG recording capabilities.</p>
        <p>A “diode” input parameter is also specified. Setting this value to 1 adds a supplemental recording channel to the data collection. This can be used to measure any additional input through a supported DAQ device that the experimenter would like to simultaneously acquire with the EMG. For example, a photodiode can be used to detect the timing of visual stimuli, which can be useful for calculating EMG activity changes relative to stimuli onsets. This is the last parameter inputted by the user.</p>
        <p>Before the initiation of data collection, a table (a built-in Matlab data type) with the variable name “trials” is created in the Matlab workspace and pre-allocated with the number of rows corresponding to the number of sweeps to be recorded. Next, the function <bold>EMGfigure</bold> is called. This function sets up a figure where the data will be presented for on-line visualization. Separate panels, distributed vertically on the screen, are pre-allocated for each channel of data to be visualized (<xref ref-type="fig" rid="F3">Figure 3</xref>).</p>
        <fig id="F3" position="float">
          <label>FIGURE 3</label>
          <caption>
            <p>An example <bold>recordEMG</bold> live trace showing 3.9 s of a 4-s sweep recording three EMG channels and a photodiode channel. Channel 1 shows a MEP (at 2 s) and an EMG burst in response to a visual stimulus. Channel 2 shows a partial EMG burst associated with an incorrectly activated response. Channel 3 shows a TMS artifact. Channel 4 shows a photodiode signal with the increase at 2.1 s associated with the onset of the visual stimulus to which the participant responded. Red horizontal lines indicate ±0.025 mV to serve as visual reference points for EMG and MEP amplitudes.</p>
          </caption>
          <graphic xlink:href="fnins-13-00975-g003"/>
        </fig>
        <p>Using the “daq.createSession” (Matlab Data Acquisition Toolbox) function, a data acquisition session object is created. The DAQ vendor, e.g., “ni” for National Instruments, must be specified, and appropriate drivers must be installed. Supported vendors can be found on the Mathworks website<sup><xref ref-type="fn" rid="footnote2">2</xref></sup>. The number of analog input channels that was inputted by the user is added to the session, and the sampling rate is set according to the specified parameter. EMG channels are added using the <bold>addchannels</bold> function. This function is written for a DAQ that can accommodate nine channels (eight EMG channels and a supplementary input channel). Additional channels can be added by modifying this function. Once the required number of recording channels are specified, an event listener is created using the Matlab built-in addlistener function. The listener retrieves and plots session object data to the figure using the callback function @<bold>plotData</bold>. The session begins operation with startBackground (Matlab data acquisition toolbox function) in order to allow the execution of additional code while the DAQ measurements are underway. The channel data are plotted in real-time during each sweep, and once a sweep is complete, the data are extracted from the plotted figure, using the <bold>pulldata</bold> function, and stored in the “trials” table according to each respective channel (column) and sweep number (row). Using this method, data are plotted with low latency, and then stored in the “trials” table in the workspace until they are later saved to the computer hard drive. The figure is cleared after each sweep for display of subsequently collected data. Each iteration passes sweep data to the “trials” table in a successive row, and this process repeats until all the sweeps are complete. This ordered procedure facilitates the timing of data visualization and data storage. Breaking the data into separate sweeps at the data collection stage aids in subsequent analysis.</p>
      </sec>
    </sec>
    <sec id="S2.SS2">
      <title>findEMG</title>
      <p>This function automatically detects EMG burst, TMS, MEP, and CSP events (<xref ref-type="fig" rid="F4">Figure 4</xref>).</p>
      <fig id="F4" position="float">
        <label>FIGURE 4</label>
        <caption>
          <p>Schematic of the <bold>findEMG</bold> function indicating the default parameters (red boxes), user input (dashed box), and output (blue box).</p>
        </caption>
        <graphic xlink:href="fnins-13-00975-g004"/>
      </fig>
      <sec id="S2.SS2.SSS1">
        <title>Syntax</title>
        <p>&gt;&gt;findEMG(‘‘filename’’).</p>
        <p>Specifying the filename as an input argument is optional.</p>
      </sec>
      <sec id="S2.SS2.SSS2">
        <title>Description</title>
        <p>Default analysis parameters are specified below the header block similar to the <bold>recordEMG</bold> function. These include sampling rate (5000 Hz), EMG burst threshold (0.3 V absolute threshold for detecting the presence of an EMG burst), EMG onset threshold (2 std of the mean EMG signal within a sweep is used to mark EMG onset/offset when an EMG burst is detected), TMS artifact threshold (0.04 V) for the detection of TMS pulse artifacts in EMG traces, the time duration following the TMS artifact in which to detect an MEP (0.1 s), the minimum time between the TMS artifact and MEP onset (0.018 s), the pre-MEP time window (0.1 s) used to calculate the root mean square of background EMG signal, and threshold of the root mean square of EMG activity (0.05 V) measured within this pre-MEP time window for automatically excluding measurements from subsequent analysis. Additional parameters are specified to facilitate the detection of EMG bursts when present within the same channels as MEPs. These include the time prior to the TMS artifact (0.005 s) and the estimated end of the MEP epoch in the EMG signal relative to the TMS artifact (0.1 s). All these parameters can be tailored to the needs of an experimental analysis.</p>
        <p>When calling <bold>findEMG</bold> the user either specifies an input filename or, if no input is provided, a dialogue box will open allowing the user to select an input file. The file must either have previously been saved as output from <bold>recordEMG</bold> or converted from another supported format. Functions for converting Acqknowledge<sup>®</sup> (BIOPAC Systems Inc., Goleta, CA, United States), EMGWorks<sup>®</sup> (Delsys Inc., Natick, MA, United States), and Signal<sup>®</sup> (CED Ltd., Cambridge, United KIngdom) data to the format needed to use <bold>findEMG</bold> are included with the toolbox. Additional conversion tools will be developed in the future, and this code will be made available through the GitHub repository.</p>
        <p>Once the file is loaded, the number of channels in the data is automatically extracted from the trials table. The user is then prompted whether they would like the code to detect EMG bursts (1 for yes or 0 for no). If EMG bursts will be detected, the user is prompted to enter the number of the channels in which EMG bursts should be detected (e.g., [2] for channel 2, or [1 3] for channels 1 and 3). Separate prompts ask the user whether MEPs should be detected (1 for yes or 0 for no) and whether CSPs should be detected (1 for yes or 0 for no). If either is true, the user is prompted to enter the number of the channel that includes a recording of the TMS artifact without any muscle activity, e.g., from an EMG electrode placed over a cervical vertebra of the neck. If MEPs will be measured, the user is asked to enter the channel(s) in which MEPs should be detected (e.g., [1] for channel 1 or [2 3] for channels 2 and 3). If this value is set to 0, the code will search for TMS artifacts in the MEP channel. We recommend recording the TMS artifact in a separate EMG channel for optimal performance. Similarly, if CSP will be measured, the user is prompted to enter the channel(s) numbers (e.g., [1] for channel 1 or [2 3] for channels 2 and 3). The entered MEP, CSP, and EMG burst channel(s) can overlap as all three metrics can be calculated within the same channel if desired.</p>
        <p>If the user would like to analyze multiple files without being prompted to specify the inputs at the command line for each file, it is possible to forgo the command line prompts by defining the metrics and associated channel parameters within the code and setting the “use_command_line” variable to 0. In this manner, filenames can quickly be passed to the <bold>findEMG</bold> code without further user input, which is convenient for batched file processing.</p>
        <p>The main operations of the <bold>findEMG</bold> function include a series of automated routines for the detection of events in the data. The code is designed to detect only a single EMG event or combination of events, i.e., MEP, CSP, and EMG burst, per channel. If TMS was used, only one TMS artifact is detected per sweep. First, the code evaluates whether a photodiode recording is present in the trials table. If so, the times of photodiode events are extracted using the <bold>findDiode</bold> helper function. This code can be modified to support the detection of events in other types of supplementary signals. Then, the <bold>findEvent</bold> helper function detects TMS artifacts, MEPs, EMG bursts, and CSPs in the appropriate channels specified by the user. In the case of TMS, TMS artifacts are located in the specified channel by searching for the artifact in the recorded EMG starting at the end of each sweep and scanning in reverse temporal order. This reverse approach ensures that MEP measurements are associated with the last TMS pulse in paired-pulse or multi-pulse TMS protocols as well as single-pulse protocols. Recording and detecting TMS artifacts in a separate channel facilitates the identification of MEPs regardless of the type of voluntary EMG activity that may be present. MEP and CSPs are detected in time windows relative to the TMS artifacts using data from the user-specified MEP and CSP channel(s). All calculated metrics are outputted to the trials table in columns named with the appropriate channel number and metric listed in the <bold>findEMG</bold> header.</p>
        <p>Motor evoked potential detection depends on two user-defined parameters: (1) the duration of the epoch (0.1 s) following the TMS artifact in which to search for a MEP and (2) the minimal time elapsed following the TMS artifact at which a MEP onset can be marked (0.018 s). For example, using the default parameters, MEP onsets are identified in the window between 18 and 100 ms following the TMS artifact. Matlab’s “findchangepts” function is applied within this time window to identify points which minimize the sum residual squared error about the local mean. The default maximum number of change points detected is 10, and only the first and last points are used to define the MEP onset and offset. Once a MEP is identified, metrics are automatically calculated including the MEP latency relative to the TMS artifact, maximum to minimum peak-to-peak amplitude, onset-to-offset duration, and area. The root mean square of the EMG signal in the pre-MEP time epoch is also calculated.</p>
        <p>Additional automated routines in the <bold>findEvent</bold> helper function calculate the onset and offset times of EMG bursts. If EMG bursts will be detected in the same channel as MEPs, the EMG signal values from the time immediately before (0.005 s) the TMS artifact through the subsequent MEP are assigned the mean of the signal for the entire sweep. In other words, any signal within this window are temporarily flattened to the mean. The values determining the beginning and end of this time window are specified in the parameters. This step makes it possible to ignore the TMS- and MEP-related changes in the EMG signal when searching for other patterns in the EMG activity. Once this step is complete, automated routines are performed to detect EMG bursts. These modified data are not stored and are only used for this procedure.</p>
        <p>To detect EMG bursts, the code first detects whether the maximum rectified signal exceeds a fixed voltage threshold set in the parameters. If the code determines that a burst is present in the sweep, the function then combs the data for the first time point at which the voltage exceeds the user-defined EMG threshold, set as the specified number of standard deviations of the signal for the entire sweep (<xref rid="B13" ref-type="bibr">Greenhouse et al., 2015</xref>). This point is marked as the EMG burst onset for that channel for that sweep. To identify the burst offset, the script executes a similar procedure, but combing from the end of the trace in reverse temporal order. Once the EMG burst onset and offset are determined, the code also calculates the area of the rectified signal within the EMG burst epoch.</p>
        <p>To detect CSPs, the code first determines whether MEPs were also detected. If so, the timepoint identified for MEP offset is also set as the CSP onset. The end point of the CSP, or CSP offset, is defined using a previously published method (<xref rid="B19" ref-type="bibr">King et al., 2006</xref>). In brief, Matlab’s findpeaks function is applied to the cumulative sum of the signal to identify the inflection point following CSP onset where the mean of the rectified signal starts to increase. The CSP offset is set to this time point. If the user wishes to calculate the CSP using the <xref rid="B19" ref-type="bibr">King et al. (2006)</xref> method without detecting MEPs, this can be done by choosing to only detect CSPs. However, the user should be aware that the calculated CSP onset time may differ depending on whether the MEP is detected or not detected in addition to the CSP.</p>
        <p>Finally, the <bold>findEMG</bold> function outputs a file that contains the updated trials dataset with any desired TMS, MEP, RMS, CSP, and EMG burst events within each sweep assigned to each appropriate channel. The “use_ui_save” variable enables saving using the Matlab save dialogue box or, if disabled, will automatically save the output using the input filename appended with “_processed.” The “trials” table does not export conveniently to a.csv file type because individual cells contain entire timeseries. However, the built-in “writetable.m” Matlab function can be used to export user-defined subsections of the “trials” table to a .csv, .dat, or .txt file.</p>
      </sec>
    </sec>
    <sec id="S2.SS3">
      <title>visualizeEMG</title>
      <p>This function displays a GUI for the visualization of EMG data for interactive review (<xref ref-type="fig" rid="F5">Figure 5</xref>).</p>
      <fig id="F5" position="float">
        <label>FIGURE 5</label>
        <caption>
          <p>Schematic of the <bold>visualizeEMG</bold> function indicating the default parameters (red box), user input (dashed box), and output (blue box).</p>
        </caption>
        <graphic xlink:href="fnins-13-00975-g005"/>
      </fig>
      <sec id="S2.SS3.SSS1">
        <title>Syntax</title>
        <p>&gt;&gt;visualizeEMG(‘‘filename’’).</p>
        <p>Specifying the filename as an input argument is optional.</p>
      </sec>
      <sec id="S2.SS3.SSS2">
        <title>Description</title>
        <p>The <bold>visualizeEMG</bold> user interface was developed using GUIDE (Matlab’s GUI development environment) and enables data visualization to facilitate the identification of MEPs, EMG events, CSPs, TMS artifacts, and stimulus events. This function is associated with the visualizeEMG.fig file which determines the elements and graphical layout of the GUI.</p>
        <p>When calling this function, the user is prompted to enter at the command line whether they would like to use default <italic>y</italic>-axis limits for the visualization of data (−5 to 5 volts) or to define their own preferred <italic>y</italic>-axis limits with the maximum and minimum values specified for each channel. The user then selects a file to load that has been preprocessed with <bold>findEMG</bold>. An example instance of the GUI is shown in <xref ref-type="fig" rid="F6">Figure 6</xref>. Advancing through sweeps in consecutive order is controlled through the toggle arrows at the bottom of the GUI. Alternatively, the user can jump to a specific sweep number by entering the number in the text box. Zooming and panning capabilities are toggled on and off using the menu buttons at the upper left of the GUI and behave in the default manner.</p>
        <fig id="F6" position="float">
          <label>FIGURE 6</label>
          <caption>
            <p>An example screenshot of the <bold>visualizeEMG</bold> GUI depicting three EMG channels and a photodiode channel. The sweep number is displayed at the top of the figure. Buttons on the left side allow the user to correct MEP indices and EMG bursts for each channel, as well as clear events that have been misidentified. The yellow shaded region indicates an MEP while the light magenta shaded region indicates an EMG burst. The red and cyan lines indicate TMS onset time and a photodiode event, respectively. If a sweep contains an EMG burst, EMG reaction time relative to the photodiode event, EMG burst duration, and EMG burst area are displayed in the right margin. If a sweep contains a MEP, preTMS root mean square, MEP onset latency relative to the TMS artifact, MEP amplitude, MEP area, and MEP duration are displayed. At the bottom of the figure, the user can jump to a specified sweep number, scroll between sweeps, accept or reject trials, and save the data. Data from channels 1 and 2 have been zoomed in to show trace detail using the zoom + tool in the upper left corner of the GUI.</p>
          </caption>
          <graphic xlink:href="fnins-13-00975-g006"/>
        </fig>
        <p>Vertical lines are used to mark discrete events. These include TMS artifacts in red and stimulus onsets in magenta. EMG bursts are represented with light blue shaded regions, MEPs are represented with yellow shaded regions, and CSPs are represented with light green shaded regions (not shown in the figure).</p>
        <p>Color-coded pushbuttons appear along the left side of the GUI, and their appearance depends on the number of channels recorded and types of events marked for display. A red “TMS” pushbutton appears in the channel specified as containing TMS artifacts, and a red line indicates where an artifact has been detected by the <bold>findEMG</bold> code. Clicking the TMS pushbutton will activate crosshairs. Using the mouse to position the crosshairs over a new location in the TMS artifact channel and clicking will reset the TMS artifact position in the data. Only the position along the <italic>x</italic>-axis is used to manually redefine the location of the markers. The position along the <italic>y</italic>-axis is ignored. The GUI and “trials” table immediately update to reflect any edits, and the “trials” table automatically keeps a running tally of the total number of edits made to each sweep.</p>
        <p>A similar editing procedure can be performed for MEP, EMG, and CSPs (<xref ref-type="fig" rid="F7">Figure 7</xref>). However, these events are represented by colored patches that encompass the time from the event onset to the event offset. The buttons for each event type match the colors of the event patches. “MEP” pushbuttons appear alongside MEP channels, “EMG” pushbuttons appear alongside EMG burst channels, and “CSP” pushbuttons appear alongside CSP channels. Clicking any one of these buttons will activate the mouse-guided crosshairs that can be positioned over the location in the appropriate channel where a correction to the marked event is desired. Two mouse clicks are needed to define MEP, EMG, or CSP epochs. The first click indicates the onset, and the second click indicates the offset. Only the position of the cursor along the <italic>x</italic>-axis is used to define the manually entered onsets and offsets. The display and “trials” table immediately update to reflect the corrected event markers, and these procedures can be repeated as many times as desired.</p>
        <fig id="F7" position="float">
          <label>FIGURE 7</label>
          <caption>
            <p>Events can be manually edited using the <bold>visualizeEMG</bold> buttons and mouse-guided cursor. In order to correct misidentified event onsets and/or offsets, the user presses the button on the left <bold>(A)</bold>. By positioning the crosshair and clicking, the user selects the correct location of the burst onset <bold>(B)</bold> and offset <bold>(C)</bold>. Lastly, the updated burst indices are recorded and the display is updated <bold>(D)</bold>. Note, only the <italic>x</italic>-coordinates are recorded when choosing new indices. A similar method is executed to change MEP and CSP event indices.</p>
          </caption>
          <graphic xlink:href="fnins-13-00975-g007"/>
        </fig>
        <p>Each event marker button is paired with a color-coded “clear” button. Clicking any of these buttons will clear the event type from the actively displayed sweep. It is not necessary to clear an event before editing.</p>
        <p>The user can also reject entire trials by unchecking the “accept” checkbox at the bottom of the GUI. This is useful for excluding a sweep when data in all channels should be ignored in subsequent analysis. A checked box indicates that the trial will be flagged as acceptable, while an unchecked box indicates that the trial is unacceptable for further analysis.</p>
        <p>Metrics derived from the markers within each sweep are displayed in the right margin adjacent to the data for each channel. These include the EMG burst onset time (EMG RT) relative to a stimulus such as a photodiode event or relative to the start of the sweep if no stimulus events are detected, the duration of the EMG burst, the area of the rectified EMG burst, root mean square of the EMG signal prior to TMS (RMS), MEP latency relative to the TMS artifact, MEP peak-to-peak amplitude, the area of the rectified MEP, the MEP duration, and the CSP duration. These values update for each respective channel and when any manual corrections are made to the data. The values are also stored in the trials table for subsequent analysis.</p>
        <p>The “save” button must be clicked before closing the GUI to save any changes made during the review process. Doing so will open Matlab’s save dialogue box. The default output file name is the input file name appended with “_visualized.” Data can be saved and reopened at any point in the workflow as many times as needed. Further analysis of the data can be conducted using built-in Matlab functions (see GitHub repository for examples).</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="materials|methods" id="S3">
    <title>Materials and Methods</title>
    <p>Abbreviated example datasets (30 sweeps each) are included with the toolbox. These data were collected using Matlab 2017b on a Windows 10 Operating System, Delsys Bagnoli<sup>TM</sup> 8-channel EMG System interfaced with a National Instruments PCI-6220 card, and a Magstim<sup>®</sup> 200-2 single pulse TMS stimulator. EMG signals were amplified 1000×, bandpass filtered online between 20 and 450 Hz, and sampled at 5000 Hz. Adapted versions of <bold>recordEMG</bold> were used to visualize and store the data during all measurements. Data were collected from four participants who provided informed consent and were screened for contraindications to TMS according to a protocol approved by the University of Oregon IRB.</p>
    <p>Data are included from four experiments: (1) a TMS short intracortical inhibition (SICI) protocol with conditioning pulses at 50, 65, 80, 95, and 110% active motor threshold and test pulses at 115% resting motor threshold, (2) a CSP protocol with tonic contraction maintained at 25% MVC and TMS administered at 115% resting motor threshold, (3) a unimanual Stop Signal Task with maintained tonic contraction of a task-irrelevant muscle (no TMS was administered during the acquisition of these data), and (4) a Delayed Response Task which included TMS pulses administered at 115% resting motor threshold delivered at one of two time points on a subset of trials: either an inter-trial baseline or during a preparatory delay period 100 ms prior to an imperative Go stimulus. These datasets were collected at different recording sessions using EMG from the first dorsal interosseous (FDI) muscles of the hands.</p>
    <p>To assess the robustness of our analysis tools, each example dataset was analyzed using the <bold>findEMG</bold> automated event detection with the appropriate channels indicated for EMG burst, TMS artifact, MEP, and CSP detection. For the SICI experiment, TMS artifacts were detected in channel 2, and MEPs were detected in channel 1. For the CSP experiment, TMS artifacts were detected in channel 3 and both MEPs and CSPs were detected in channel 1, with resting EMG in channel 2. For the stop signal task, only EMG burst events were detected in channel 1. For the delayed response task, EMG burst events were detected in channels 1 and 2, TMS artifacts were detected in channel 3, and MEPs were detected in channel 1. Otherwise, parameters were matched across datasets, and the default settings were used.</p>
    <p>Following the automated detection of events with <bold>findEMG</bold>, the <bold>visualizeEMG</bold> code was used to manually inspect the data and make corrections where desired. Corrections were made by a single rater for consistency across datasets. The EMG event numbers and statistics were calculated after running <bold>findEMG</bold> alone and again after visual inspection with <bold>visualizeEMG</bold>. We tested the hypothesis that the automated and manually corrected data came from different distributions (<italic>H</italic><sub>0</sub> ≠ <italic>H</italic><sub>1</sub>) using Bayesian paired-samples <italic>t</italic>-tests JASP (version 0.9.2). Annotated.jasp files of all data and analyses are available through the github repository.</p>
  </sec>
  <sec id="S4">
    <title>Results</title>
    <p>Values for reported metrics are presented in <xref rid="T2" ref-type="table">Table 2</xref>. Edits were made to all types of the example data suggesting that interactive visualization is useful for refining the automated event detection <bold>findEMG</bold> algorithms regardless of the type of data analyzed. Certain features of the data were more likely to be edited during visualization than others. Specifically, the overall number of detected events did not differ between the automated and interactive visualization of the data. In contrast, the EMG burst onset times identified using the automated detection algorithm tended to be later than those determined with interactive visual inspection of the data, an average difference of 12 ms. The automated and manually corrected data were unlikely to have arisen from different distributions for the left EMG burst onset times (BF<sub>10</sub> = 0.97) and right EMG burst onset times (BF<sub>10</sub> = 0.35) in the Delayed Response Task. Manual corrections to EMG burst onsets were made on a subset of trials. MEP amplitudes, durations, and latencies were identical between the automated and manual methods. In addition, the estimated CSP duration was longer following visualization than with the automated routines alone, a difference of 18 ms. This difference most likely does not reflect a difference in the underlying distributions of automated and manually corrected CSP durations (BF<sub>10</sub> = 0.56). The difference arose because the automated detection of the CSP offset failed on five sweeps and assigned a time point before the end of the CSP. This was more likely to occur when the amplitude of the EMG signal associated with the tonic contraction was smaller. Interestingly, MEP latencies and amplitudes did not differ between the automated and interactive procedures although MEP durations were 7 ms shorter following visualization of the data. This result indicates the algorithm occasionally overestimated MEP offset/underestimated CSP onset. However, this difference most likely did not reflect a difference in the automated and manually corrected distributions for MEP durations (BF<sub>10</sub> = 0.42). In summary, the Bayesian analyses showed the automated and manually corrected data for all detected events were unlikely to arise from different distributions.</p>
    <table-wrap id="T2" position="float">
      <label>TABLE 2</label>
      <caption>
        <p>Event descriptive statistics for automated and interactive event detection.</p>
      </caption>
      <table frame="hsides" rules="groups" cellspacing="5" cellpadding="5">
        <thead>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1"/>
            <td valign="top" align="center" rowspan="1" colspan="1">
              <bold>findEMG</bold>
            </td>
            <td valign="top" align="center" rowspan="1" colspan="1">
              <bold>visualizeEMG</bold>
            </td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td valign="top" align="left" colspan="3" rowspan="1">
              <bold>SICI</bold>
            </td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Number of edits</td>
            <td rowspan="1" colspan="1"/>
            <td valign="top" align="center" rowspan="1" colspan="1">7</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Accepted trials</td>
            <td valign="top" align="center" rowspan="1" colspan="1">30</td>
            <td valign="top" align="center" rowspan="1" colspan="1">30</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Number of MEPs</td>
            <td valign="top" align="center" rowspan="1" colspan="1">30</td>
            <td valign="top" align="center" rowspan="1" colspan="1">30</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">MEP latency (s)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">0.021 ± 0.001</td>
            <td valign="top" align="center" rowspan="1" colspan="1">0.021 ± 0.001</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">MEP amplitude (mV)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">0.172 ± 0.141</td>
            <td valign="top" align="center" rowspan="1" colspan="1">0.172 ± 0.141</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">MEP duration (s)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">0.025 ± 0.017</td>
            <td valign="top" align="center" rowspan="1" colspan="1">0.019 ± 0.007</td>
          </tr>
          <tr>
            <td valign="top" align="left" colspan="3" rowspan="1">
              <bold>Stop task</bold>
            </td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Number of edits</td>
            <td rowspan="1" colspan="1"/>
            <td valign="top" align="center" rowspan="1" colspan="1">14</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Accepted trials</td>
            <td valign="top" align="center" rowspan="1" colspan="1">30</td>
            <td valign="top" align="center" rowspan="1" colspan="1">30</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Number of EMG bursts</td>
            <td valign="top" align="center" rowspan="1" colspan="1">27</td>
            <td valign="top" align="center" rowspan="1" colspan="1">27</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">EMG burst onset time (s)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">0.279 ± 0.070</td>
            <td valign="top" align="center" rowspan="1" colspan="1">0.266 ± 0.071</td>
          </tr>
          <tr>
            <td valign="top" align="left" colspan="3" rowspan="1">
              <bold>Delayed response task</bold>
            </td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Number of edits</td>
            <td rowspan="1" colspan="1"/>
            <td valign="top" align="center" rowspan="1" colspan="1">11</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Accepted trials</td>
            <td valign="top" align="center" rowspan="1" colspan="1">30</td>
            <td valign="top" align="center" rowspan="1" colspan="1">30</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Number of MEPs</td>
            <td valign="top" align="center" rowspan="1" colspan="1">20</td>
            <td valign="top" align="center" rowspan="1" colspan="1">20</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Baseline MEP latency (s)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">0.024 ± 0.000</td>
            <td valign="top" align="center" rowspan="1" colspan="1">0.024 ± 0.000</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Baseline MEP amplitude (mV)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">0.621 ± 0.339</td>
            <td valign="top" align="center" rowspan="1" colspan="1">0.621 ± 0.339</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Baseline MEP duration (s)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">0.022 ± 0.008</td>
            <td valign="top" align="center" rowspan="1" colspan="1">0.022 ± 0.008</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Delay MEP latency (s)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">0.024 ± 0.001</td>
            <td valign="top" align="center" rowspan="1" colspan="1">0.024 ± 0.001</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Delay MEP amplitude (mV)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">0.462 ± 0.288</td>
            <td valign="top" align="center" rowspan="1" colspan="1">0.462 ± 0.288</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Delay MEP duration (s)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">0.020 ± 0.004</td>
            <td valign="top" align="center" rowspan="1" colspan="1">0.020 ± 0.004</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">L EMG burst onset time (s)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">0.259 ± 0.096</td>
            <td valign="top" align="center" rowspan="1" colspan="1">0.244 ± 0.095</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">R EMG burst onset time (s)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">0.201 ± 0.086</td>
            <td valign="top" align="center" rowspan="1" colspan="1">0.192 ± 0.086</td>
          </tr>
          <tr>
            <td valign="top" align="left" colspan="3" rowspan="1">
              <bold>Cortical silent period</bold>
            </td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Number of edits</td>
            <td rowspan="1" colspan="1"/>
            <td valign="top" align="center" rowspan="1" colspan="1">5</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Accepted trials</td>
            <td valign="top" align="center" rowspan="1" colspan="1">30</td>
            <td valign="top" align="center" rowspan="1" colspan="1">30</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Number of MEPs</td>
            <td valign="top" align="center" rowspan="1" colspan="1">13</td>
            <td valign="top" align="center" rowspan="1" colspan="1">13</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">MEP latency (s)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">0.023 ± 0.000</td>
            <td valign="top" align="center" rowspan="1" colspan="1">0.023 ± 0.000</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">MEP amplitude (mV)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">4.411 ± 1.888</td>
            <td valign="top" align="center" rowspan="1" colspan="1">4.411 ± 1.888</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">MEP duration (s)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">0.025 ± 0.021</td>
            <td valign="top" align="center" rowspan="1" colspan="1">0.018 ± 0.009</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Number of CSP</td>
            <td valign="top" align="center" rowspan="1" colspan="1">13</td>
            <td valign="top" align="center" rowspan="1" colspan="1">13</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">CSP duration (s)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">0.094 ± 0.053</td>
            <td valign="top" align="center" rowspan="1" colspan="1">0.112 ± 0.020</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <attrib>
          <italic>Event counts or means ± standard deviations are shown. EMG, electromyography; MEP, motor-evoked potential; CSP, cortical silent period.</italic>
        </attrib>
      </table-wrap-foot>
    </table-wrap>
  </sec>
  <sec id="S5">
    <title>Discussion</title>
    <p>The VETA Matlab toolbox is a versatile suite of tools for the recording and analysis of EMG data with an emphasis on MEP detection and measurement. The toolbox simplifies essential steps of the EMG data collection and analysis pipeline. Low-latency recording and on-line visualization of EMG data are supported with the <bold>recordEMG</bold> tool. Automated detection and calculation of common metrics are supported with the <bold>findEMG</bold> tool. The off-line visualization and editing of events are supported with the <bold>visualizeEMG</bold> tool. These tools capitalize on built-in features of Matlab and are designed to be accessible to beginner Matlab users.</p>
    <p>Example datasets accompany the toolbox and include SICI measurements acquired outside a behavioral task, CSP measurements also acquired outside a behavioral task, EMG measurements taken during the performance of a Stop Signal Task without TMS, and EMG measurements taken during the performance of a Delayed Response Task with MEPs elicited during specific task intervals. These datasets were used to evaluate the functionality of the automated detection and visualization tools and demonstrate their basic usage, recommended workflow, and successful application. Our findings from the processing of these data indicate that the event detection algorithms are robust across a variety of experiments including automated detection of EMG bursts occurring in close temporal proximity to MEP measurements within the same EMG recording channel. Although our Bayesian analyses indicated that the automated and manually corrected data show similar distributions, we strongly recommend users visualize and manually correct data as a best practice. Our findings further indicate that MEP duration, CSP duration, and EMG burst onset calculations benefit from interactive visualization and manual editing with the <bold>visualizeEMG</bold> tool.</p>
    <p>The automated routines included with the <bold>findEMG</bold> tool offer a wide range of potential research and clinical applications. In addition to measuring task-based motor responses and evoked potentials as described here, other capabilities include the characterization of involuntary muscle contraction in clinical populations such as Parkinson’s disease patients, the calculation of MVC for monitoring injury and recovery in trauma or stroke populations, and the detection of dysfunctional EMG activity in individuals suffering from neuropathies or motor neuron diseases, among others. Given the general applicability of these methods, we believe the VETA toolbox will appeal to a diverse group of users.</p>
    <p>Several features of VETA differentiate this toolbox from others. While the <bold>recordEMG</bold> tool stands alone, the underlying code is easily adapted for use in combination with Psychtoolbox (<xref rid="B5" ref-type="bibr">Brainard, 1997</xref>) to measure EMG and MEPs during the simultaneous presentation of behavioral stimuli and response collection. A major advantage of combining these tools is the capability to collect EMG data and control experimental stimuli from a single computer, alleviating challenges often met when interfacing multiple computers. The benefits of a single stimulus presentation and data recording platform may be particularly valuable when conducting experiments in challenging settings such as the clinic or operating room. Example code for the administration of a Delayed Response Task that includes stimulus presentation, EMG recording, and the delivery of timed TMS pulses is included with the toolbox. This code is commented to facilitate editing for other task paradigms and a version of this code was used to create the Delayed Response Task example dataset that accompanies the toolbox. Moreover, while the <bold>recordEMG</bold> tool was developed with EMG data collection in mind, the approach will work for any type of data that can be acquired using Matlab’s Data Acquisition Toolbox and is by no means restricted to EMG.</p>
    <p>Visualize EMG TMS Analyze capitalizes on the flexibility of Matlab’s table data type to offer a standard format for storing EMG data. The included example datasets illustrate the recommended use of the table for storing EMG data. Moreover, each file generated by <bold>recordEMG</bold> includes an additional “subject” variable for storing subject characteristics, and simply removing this variable anonymizes the data for sharing. This approach offers a straightforward solution to storing useful subject information alongside the data and supports quick data anonymization when desired.</p>
    <p>The VETA toolbox is limited in its current form. One limitation is that only certain DAQ vendors are supported through Matlab’s Data Acquisition Toolbox. While this prohibits the use of <bold>recordEMG</bold> with unsupported vendors, it is still possible to apply the <bold>findEMG</bold> and <bold>visualizeEMG</bold> tools for the analysis of data collected using other software. Data conversion tools accompany the toolbox and support conversion of common EMG data formats to the table Matlab data type used by the VETA toolbox. These currently include Acqknowledge<sup>®</sup> (BIOPAC Systems Inc., Goleta, CA, United States), EMGWorks<sup>®</sup> (Delsys Inc., Natick, MA, United States), and Signal<sup>®</sup> (CED Ltd., Cambridge, United Kingdom) formats, and additional formats will be supported in the future. Following conversion of these data formats to the VETA “trials” table, <bold>findEMG</bold> and <bold>visualizeEMG</bold> will work with no additional required changes to the data. Finally, although the toolbox was developed for EMG and TMS, the tools lend themselves to the analysis of other types of biosignal processing, and other types of data may be supported in the future.</p>
    <p>All code and example data are freely available through the GitHub repository (see text footnote 1) (<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/RRID:_SCR_017201">RRID: SCR_017201</ext-link>, doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.2673030">10.5281/zenodo.2673030</ext-link>).</p>
  </sec>
  <sec id="S6">
    <title>Conclusion</title>
    <p>The VETA toolbox simplifies the EMG data collection and analysis pipeline. Three main tools are included. The first performs online visualization and recording of EMG data. This tool integrates well with existing Matlab stimulus presentation toolboxes to facilitate the combination of EMG, TMS, and behavioral testing. The second tool automatically detects a variety of signal events including TMS artifacts, EMG bursts, MEPs, and CSPs, and calculates commonly reported metrics. The third tool is an interactive GUI for reviewing and editing data. Data are stored in a format to expedite further analysis and promote open science practices.</p>
  </sec>
  <sec sec-type="data-availability" id="S7">
    <title>Data Availability</title>
    <p>The datasets collected for this study can be found on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/greenhouselab/Veta/tree/master/data">https://github.com/greenhouselab/Veta/tree/master/data</ext-link>).</p>
  </sec>
  <sec id="S8">
    <title>Ethics Statement</title>
    <p>This study was carried out in accordance with the recommendations of the University of Oregon Institutional Review Board with written informed consent from all subjects. All subjects gave written informed consent in accordance with the Declaration of Helsinki. The protocol was approved by the University of Oregon Institutional Review Board.</p>
  </sec>
  <sec id="S9">
    <title>Author Contributions</title>
    <p>NJ and IG developed the tools, contributed code, analyzed the data, and drafted the manuscript.</p>
  </sec>
  <sec id="conf1">
    <title>Conflict of Interest Statement</title>
    <p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest. The reviewer JC declared a past co-authorship with one of the authors, IG, to the handling Editor at the time of review.</p>
  </sec>
</body>
<back>
  <fn-group>
    <fn fn-type="financial-disclosure">
      <p><bold>Funding.</bold> IG was supported by the NIH National Center for Advancing Translational Science TR002370-01.</p>
    </fn>
  </fn-group>
  <ack>
    <p>We thank Michael Claffey for sharing a precursor toolbox, and Florent Lebon and Jan Wessel for sharing sample data to build initial conversion tools. The manuscript has been released as a pre-print at <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/610386v1">https://www.biorxiv.org/content/10.1101/610386v1</ext-link>.</p>
  </ack>
  <fn-group>
    <fn id="footnote1">
      <label>1</label>
      <p>
        <ext-link ext-link-type="uri" xlink:href="https://github.com/greenhouselab/VETA">https://github.com/greenhouselab/VETA</ext-link>
      </p>
    </fn>
    <fn id="footnote2">
      <label>2</label>
      <p>
        <ext-link ext-link-type="uri" xlink:href="https://www.mathworks.com/hardware-support/data-acquistion-software.html">https://www.mathworks.com/hardware-support/data-acquistion-software.html</ext-link>
      </p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Badry</surname><given-names>R.</given-names></name><name><surname>Mima</surname><given-names>T.</given-names></name><name><surname>Aso</surname><given-names>T.</given-names></name><name><surname>Nakatsuka</surname><given-names>M.</given-names></name><name><surname>Abe</surname><given-names>M.</given-names></name><name><surname>Fathi</surname><given-names>D.</given-names></name><etal/></person-group> (<year>2009</year>). <article-title>Suppression of human cortico-motoneuronal excitability during the stop-signal task.</article-title>
<source><italic>Clin. Neurophysiol.</italic></source>
<volume>120</volume>
<fpage>1717</fpage>–<lpage>1723</lpage>. <pub-id pub-id-type="doi">10.1016/j.clinph.2009.06.027</pub-id>
<?supplied-pmid 19683959?><pub-id pub-id-type="pmid">19683959</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barker</surname><given-names>A. T.</given-names></name><name><surname>Shields</surname><given-names>K.</given-names></name></person-group> (<year>2017</year>). <article-title>Transcranial magnetic stimulation: basic principles and clinical applications in migraine.</article-title>
<source><italic>Headache</italic></source>
<volume>57</volume>
<fpage>517</fpage>–<lpage>524</lpage>. <pub-id pub-id-type="doi">10.1111/head.13002</pub-id>
<?supplied-pmid 28028801?><pub-id pub-id-type="pmid">28028801</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bersani</surname><given-names>F. S.</given-names></name><name><surname>Minichino</surname><given-names>A.</given-names></name><name><surname>Enticott</surname><given-names>P. G.</given-names></name><name><surname>Mazzarini</surname><given-names>L.</given-names></name><name><surname>Khan</surname><given-names>N.</given-names></name><name><surname>Antonacci</surname><given-names>G.</given-names></name><etal/></person-group> (<year>2013</year>). <article-title>Deep transcranial magnetic stimulation as a treatment for psychiatric disorders: a comprehensive review.</article-title>
<source><italic>Eur. Psychiatry</italic></source>
<volume>28</volume>
<fpage>30</fpage>–<lpage>39</lpage>. <pub-id pub-id-type="doi">10.1016/j.eurpsy.2012.02.006</pub-id>
<?supplied-pmid 22559998?><pub-id pub-id-type="pmid">22559998</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bestmann</surname><given-names>S.</given-names></name><name><surname>Krakauer</surname><given-names>J. W.</given-names></name></person-group> (<year>2015</year>). <article-title>The uses and interpretations of the motor-evoked potential for understanding behaviour.</article-title>
<source><italic>Exp. brain res.</italic></source>
<volume>233</volume>
<fpage>679</fpage>–<lpage>689</lpage>. <pub-id pub-id-type="doi">10.1007/s00221-014-4183-7</pub-id>
<?supplied-pmid 25563496?><pub-id pub-id-type="pmid">25563496</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brainard</surname><given-names>D. H.</given-names></name></person-group> (<year>1997</year>). <article-title>The psychophysics toolbox.</article-title>
<source><italic>Spat. Vis.</italic></source>
<volume>10</volume>
<fpage>433</fpage>–<lpage>436</lpage>. <pub-id pub-id-type="doi">10.1163/156856897x00357</pub-id><pub-id pub-id-type="pmid">9176952</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brunner</surname><given-names>C.</given-names></name><name><surname>Breitwieser</surname><given-names>C.</given-names></name><name><surname>Müller-Putz</surname><given-names>G. R.</given-names></name></person-group> (<year>2013</year>). <article-title>Sigviewer and signalserver - open source software projects for biosignal analysis.</article-title>
<source><italic>Biomed. Tech.</italic></source>
<volume>58</volume>(<issue>Suppl. 1</issue>). <pub-id pub-id-type="doi">10.1515/bmt-2013-4191</pub-id>
<?supplied-pmid 24042830?><pub-id pub-id-type="pmid">24042830</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Di Lazzaro</surname><given-names>V.</given-names></name><name><surname>Oliviero</surname><given-names>A.</given-names></name><name><surname>Pilato</surname><given-names>F.</given-names></name><name><surname>Saturno</surname><given-names>E.</given-names></name><name><surname>Dileone</surname><given-names>M.</given-names></name><name><surname>Marra</surname><given-names>C.</given-names></name><etal/></person-group> (<year>2004</year>). <article-title>Motor cortex hyperexcitability to transcranial magnetic stimulation in Alzheimer’s disease.</article-title>
<source><italic>J Neurol. Neurosurg. Psychiatr.</italic></source>
<volume>75</volume>
<fpage>555</fpage>–<lpage>559</lpage>. <pub-id pub-id-type="doi">10.1136/jnnp.2003.018127</pub-id>
<?supplied-pmid 15026495?><pub-id pub-id-type="pmid">15026495</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Di Lazzaro</surname><given-names>V.</given-names></name><name><surname>Oliviero</surname><given-names>A.</given-names></name><name><surname>Profice</surname><given-names>P.</given-names></name><name><surname>Ferrara</surname><given-names>L.</given-names></name><name><surname>Saturno</surname><given-names>E.</given-names></name><name><surname>Pilato</surname><given-names>F.</given-names></name><etal/></person-group> (<year>1999</year>). <article-title>The diagnostic value of motor evoked potentials.</article-title>
<source><italic>Clin. Neurophysiol.</italic></source>
<volume>110</volume>
<fpage>1297</fpage>–<lpage>1307</lpage>. <pub-id pub-id-type="doi">10.1016/S1388-2457(99)00060-67</pub-id><pub-id pub-id-type="pmid">10423196</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duque</surname><given-names>J.</given-names></name><name><surname>Lew</surname><given-names>D.</given-names></name><name><surname>Mazzocchio</surname><given-names>R.</given-names></name><name><surname>Olivier</surname><given-names>E.</given-names></name><name><surname>Ivry</surname><given-names>R. B.</given-names></name></person-group> (<year>2010</year>). <article-title>Evidence for two concurrent inhibitory mechanisms during response preparation.</article-title>
<source><italic>J. Neurosci.</italic></source>
<volume>30</volume>
<fpage>3793</fpage>–<lpage>3802</lpage>. <pub-id pub-id-type="doi">10.1523/JNEUROSCI.5722-09.2010</pub-id>
<?supplied-pmid 20220014?><pub-id pub-id-type="pmid">20220014</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Edwards</surname><given-names>M. J.</given-names></name><name><surname>Talelli</surname><given-names>P.</given-names></name><name><surname>Rothwell</surname><given-names>J. C.</given-names></name></person-group> (<year>2008</year>). <article-title>Clinical applications of transcranial magnetic stimulation in patients with movement disorders.</article-title>
<source><italic>Lancet Neurol.</italic></source>
<volume>7</volume>
<fpage>827</fpage>–<lpage>840</lpage>. <pub-id pub-id-type="doi">10.1016/S1474-4422(08)70190-X</pub-id><pub-id pub-id-type="pmid">18703005</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Greenhouse</surname><given-names>I.</given-names></name><name><surname>King</surname><given-names>M.</given-names></name><name><surname>Noah</surname><given-names>S.</given-names></name><name><surname>Maddock</surname><given-names>R. J.</given-names></name><name><surname>Ivry</surname><given-names>R. B.</given-names></name></person-group> (<year>2017</year>). <article-title>Individual differences in resting corticospinal excitability are correlated with reaction time and GABA content in motor cortex.</article-title>
<source><italic>J. Neurosci.</italic></source>
<volume>37</volume>
<fpage>2686</fpage>–<lpage>2696</lpage>. <pub-id pub-id-type="doi">10.1523/JNEUROSCI.3129-16.2017</pub-id>
<?supplied-pmid 28179557?><pub-id pub-id-type="pmid">28179557</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Greenhouse</surname><given-names>I.</given-names></name><name><surname>Oldenkamp</surname><given-names>C. L.</given-names></name><name><surname>Aron</surname><given-names>A. R.</given-names></name></person-group> (<year>2012</year>). <article-title>Stopping a response has global or nonglobal effects on the motor system depending on preparation.</article-title>
<source><italic>J. Neurophysiol.</italic></source>
<volume>107</volume>
<fpage>384</fpage>–<lpage>392</lpage>. <pub-id pub-id-type="doi">10.1152/jn.00704.2011</pub-id>
<?supplied-pmid 22013239?><pub-id pub-id-type="pmid">22013239</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Greenhouse</surname><given-names>I.</given-names></name><name><surname>Sias</surname><given-names>A.</given-names></name><name><surname>Labruna</surname><given-names>L.</given-names></name><name><surname>Ivry</surname><given-names>R. B.</given-names></name></person-group> (<year>2015</year>). <article-title>Nonspecific inhibition of the motor system during response preparation.</article-title>
<source><italic>J. Neurosci.</italic></source>
<volume>35</volume>
<fpage>10675</fpage>–<lpage>10684</lpage>. <pub-id pub-id-type="doi">10.1523/JNEUROSCI.1436-15.2015</pub-id>
<?supplied-pmid 26224853?><pub-id pub-id-type="pmid">26224853</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hallett</surname><given-names>M.</given-names></name></person-group> (<year>2007</year>). <article-title>Transcranial magnetic stimulation: a primer.</article-title>
<source><italic>Neuron</italic></source>
<volume>55</volume>
<fpage>187</fpage>–<lpage>199</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuron.2007.06.026</pub-id>
<?supplied-pmid 17640522?><pub-id pub-id-type="pmid">17640522</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harquel</surname><given-names>S.</given-names></name><name><surname>Beynel</surname><given-names>L.</given-names></name><name><surname>Guyader</surname><given-names>N.</given-names></name><name><surname>Marendaz</surname><given-names>C.</given-names></name><name><surname>David</surname><given-names>O.</given-names></name><name><surname>Chauvin</surname><given-names>A.</given-names></name></person-group> (<year>2016</year>). <article-title>CortExTool: a toolbox for processing motor cortical excitability measurements by transcranial magnetic stimulation.</article-title> Available at: <ext-link ext-link-type="uri" xlink:href="https://hal.archives-ouvertes.fr/hal-01390016">https://hal.archives-ouvertes.fr/hal-01390016</ext-link></mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ito</surname><given-names>T.</given-names></name><name><surname>Tsubahara</surname><given-names>A.</given-names></name><name><surname>Shinkoda</surname><given-names>K.</given-names></name><name><surname>Yoshimura</surname><given-names>Y.</given-names></name><name><surname>Kobara</surname><given-names>K.</given-names></name><name><surname>Osaka</surname><given-names>H.</given-names></name></person-group> (<year>2015</year>). <article-title>Excitability changes in intracortical neural circuits induced by differentially controlled walking patterns.</article-title>
<source><italic>PLoS One</italic></source>
<volume>10</volume>:<issue>e0117931</issue>. <pub-id pub-id-type="doi">10.1371/journal.pone.0117931</pub-id>
<?supplied-pmid 25688972?><pub-id pub-id-type="pmid">25688972</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jackson</surname><given-names>N.</given-names></name><name><surname>Greenhouse</surname><given-names>I.</given-names></name></person-group> (<year>2019</year>). <article-title>VETA: a Matlab toolbox for the collection and analysis of electromyography combined with transcranial magnetic stimulation.</article-title>
<source><italic>bioRxiv</italic></source></mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kandler</surname><given-names>R. H.</given-names></name><name><surname>Jarratt</surname><given-names>J. A.</given-names></name><name><surname>Sagar</surname><given-names>H. J.</given-names></name><name><surname>Gumpert</surname><given-names>E. J.</given-names></name><name><surname>Venables</surname><given-names>G. S.</given-names></name><name><surname>Davies-Jones</surname><given-names>G. A.</given-names></name><etal/></person-group> (<year>1990</year>). <article-title>Abnormalities of central motor conduction in Parkinson’s disease.</article-title>
<source><italic>J. Neurol. Sci.</italic></source>
<volume>100</volume>
<fpage>94</fpage>–<lpage>97</lpage>. <?supplied-pmid 2089146?><pub-id pub-id-type="pmid">2089146</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>King</surname><given-names>N. K. K.</given-names></name><name><surname>Kuppuswamy</surname><given-names>A.</given-names></name><name><surname>Strutton</surname><given-names>P. H.</given-names></name><name><surname>Davey</surname><given-names>N. J.</given-names></name></person-group> (<year>2006</year>). <article-title>Estimation of cortical silent period following transcranial magnetic stimulation using a computerised cumulative sum method.</article-title>
<source><italic>J. Neurosci. Methods</italic></source>
<volume>150</volume>
<fpage>96</fpage>–<lpage>104</lpage>. <pub-id pub-id-type="doi">10.1016/j.jneumeth.2005.06.007</pub-id>
<?supplied-pmid 16105686?><pub-id pub-id-type="pmid">16105686</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kujirai</surname><given-names>T.</given-names></name><name><surname>Caramia</surname><given-names>M. D.</given-names></name><name><surname>Rothwell</surname><given-names>J. C.</given-names></name><name><surname>Day</surname><given-names>B. L.</given-names></name><name><surname>Thompson</surname><given-names>P. D.</given-names></name><name><surname>Ferbert</surname><given-names>A.</given-names></name><etal/></person-group> (<year>1993</year>). <article-title>Corticocortical inhibition in human motor cortex.</article-title>
<source><italic>J. Physiol.</italic></source>
<volume>471</volume>
<fpage>501</fpage>–<lpage>519</lpage>. <pub-id pub-id-type="doi">10.1113/jphysiol.1993.sp019912</pub-id>
<?supplied-pmid 8120818?><pub-id pub-id-type="pmid">8120818</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Labruna</surname><given-names>L.</given-names></name><name><surname>Tischler</surname><given-names>C.</given-names></name><name><surname>Cazares</surname><given-names>C.</given-names></name><name><surname>Greenhouse</surname><given-names>I.</given-names></name><name><surname>Duque</surname><given-names>J.</given-names></name><name><surname>Lebon</surname><given-names>F.</given-names></name><etal/></person-group> (<year>2019</year>). <article-title>Planning face, hand, and leg movements: anatomical constraints on preparatory inhibition.</article-title>
<source><italic>J. Neurophysiol.</italic></source>
<volume>121</volume>
<fpage>1609</fpage>–<lpage>1620</lpage>. <pub-id pub-id-type="doi">10.1152/jn.00711.2018</pub-id>
<?supplied-pmid 30785815?><pub-id pub-id-type="pmid">30785815</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lebon</surname><given-names>F.</given-names></name><name><surname>Greenhouse</surname><given-names>I.</given-names></name><name><surname>Labruna</surname><given-names>L.</given-names></name><name><surname>Vanderschelden</surname><given-names>B.</given-names></name><name><surname>Papaxanthis</surname><given-names>C.</given-names></name><name><surname>Ivry</surname><given-names>R. B.</given-names></name></person-group> (<year>2016</year>). <article-title>Influence of delay period duration on inhibitory processes for response preparation.</article-title>
<source><italic>Cereb. Cortex</italic></source>
<volume>26</volume>
<fpage>2461</fpage>–<lpage>2470</lpage>. <pub-id pub-id-type="doi">10.1093/cercor/bhv069</pub-id>
<?supplied-pmid 25882038?><pub-id pub-id-type="pmid">25882038</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>Y.-L.</given-names></name><name><surname>Christie</surname><given-names>A.</given-names></name><name><surname>Karduna</surname><given-names>A.</given-names></name></person-group> (<year>2015</year>). <article-title>Excitability of the infraspinatus, but not the middle deltoid, is affected by shoulder elevation angle.</article-title>
<source><italic>Exp. Brain Res.</italic></source>
<volume>233</volume>
<fpage>1837</fpage>–<lpage>1843</lpage>. <pub-id pub-id-type="doi">10.1007/s00221-015-4255-3</pub-id>
<?supplied-pmid 25814379?><pub-id pub-id-type="pmid">25814379</pub-id></mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mullins</surname><given-names>C. R.</given-names></name><name><surname>Hanlon</surname><given-names>C. A.</given-names></name></person-group> (<year>2016</year>). <article-title>MAVIN: an open-source tool for interactive analysis and visualization of EMG data.</article-title>
<source><italic>Brain Stimul.</italic></source>
<volume>9</volume>
<fpage>305</fpage>–<lpage>306</lpage>. <pub-id pub-id-type="doi">10.1016/j.brs.2015.11.009</pub-id>
<?supplied-pmid 26970384?><pub-id pub-id-type="pmid">26970384</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nollet</surname><given-names>H.</given-names></name><name><surname>Deprez</surname><given-names>P.</given-names></name><name><surname>Van Ham</surname><given-names>L.</given-names></name><name><surname>Dewulf</surname><given-names>J.</given-names></name><name><surname>Decleir</surname><given-names>A.</given-names></name><name><surname>Vanderstraeten</surname><given-names>G.</given-names></name></person-group> (<year>2004</year>). <article-title>Transcranial magnetic stimulation: normal values of magnetic motor evoked potentials in 84 normal horses and influence of height, weight, age and sex.</article-title>
<source><italic>Equine Vet. J.</italic></source>
<volume>36</volume>
<fpage>51</fpage>–<lpage>57</lpage>. <pub-id pub-id-type="doi">10.2746/0425164044864660</pub-id>
<?supplied-pmid 14756372?><pub-id pub-id-type="pmid">14756372</pub-id></mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oliveira-Maia</surname><given-names>A. J.</given-names></name><name><surname>Press</surname><given-names>D.</given-names></name><name><surname>Pascual-Leone</surname><given-names>A.</given-names></name></person-group> (<year>2017</year>). <article-title>Modulation of motor cortex excitability predicts antidepressant response to prefrontal cortex repetitive transcranial magnetic stimulation.</article-title>
<source><italic>Brain Stimul.</italic></source>
<volume>10</volume>
<fpage>787</fpage>–<lpage>794</lpage>. <pub-id pub-id-type="doi">10.1016/j.brs.2017.03.013</pub-id>
<?supplied-pmid 28438543?><pub-id pub-id-type="pmid">28438543</pub-id></mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O’Reardon</surname><given-names>J. P.</given-names></name><name><surname>Solvason</surname><given-names>H. B.</given-names></name><name><surname>Janicak</surname><given-names>P. G.</given-names></name><name><surname>Sampson</surname><given-names>S.</given-names></name><name><surname>Isenberg</surname><given-names>K. E.</given-names></name><name><surname>Nahas</surname><given-names>Z.</given-names></name><etal/></person-group> (<year>2007</year>). <article-title>Efficacy and safety of transcranial magnetic stimulation in the acute treatment of major depression: a multisite randomized controlled trial.</article-title>
<source><italic>Biol. Psychiatry</italic></source>
<volume>62</volume>
<fpage>1208</fpage>–<lpage>1216</lpage>. <pub-id pub-id-type="doi">10.1016/j.biopsych.2007.01.018</pub-id>
<?supplied-pmid 17573044?><pub-id pub-id-type="pmid">17573044</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rossi</surname><given-names>S.</given-names></name><name><surname>Hallett</surname><given-names>M.</given-names></name><name><surname>Rossini</surname><given-names>P. M.</given-names></name><name><surname>Pascual-Leone</surname><given-names>A.</given-names></name></person-group><collab>Safety of Tms Consensus Group.</collab> (<year>2009</year>). <article-title>Safety, ethical considerations, and application guidelines for the use of transcranial magnetic stimulation in clinical practice and research.</article-title>
<source><italic>Clin. Neurophysiol.</italic></source>
<volume>120</volume>
<fpage>2008</fpage>–<lpage>2039</lpage>. <pub-id pub-id-type="doi">10.1016/j.clinph.2009.08.016</pub-id>
<?supplied-pmid 19833552?><pub-id pub-id-type="pmid">19833552</pub-id></mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ruddy</surname><given-names>K.</given-names></name><name><surname>Balsters</surname><given-names>J.</given-names></name><name><surname>Mantini</surname><given-names>D.</given-names></name><name><surname>Liu</surname><given-names>Q.</given-names></name><name><surname>Kassraian-Fard</surname><given-names>P.</given-names></name><name><surname>Enz</surname><given-names>N.</given-names></name><etal/></person-group> (<year>2018</year>). <article-title>Neural activity related to volitional regulation of cortical excitability.</article-title>
<source><italic>eLife</italic></source>
<volume>7</volume>:<issue>e40843</issue>. <pub-id pub-id-type="doi">10.7554/eLife.40843</pub-id>
<?supplied-pmid 30489255?><pub-id pub-id-type="pmid">30489255</pub-id></mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seynaeve</surname><given-names>L.</given-names></name><name><surname>Haeck</surname><given-names>T.</given-names></name><name><surname>Gramer</surname><given-names>M.</given-names></name><name><surname>Maes</surname><given-names>F.</given-names></name><name><surname>De Vleeschouwer</surname><given-names>S.</given-names></name><name><surname>Van Paesschen</surname><given-names>W.</given-names></name></person-group> (<year>2019</year>). <article-title>Optimized preoperative motor cortex mapping in brain tumors using advanced processing of transcranial magnetic stimulation data.</article-title>
<source><italic>Neuroimage Clin.</italic></source>
<volume>21</volume>:<issue>101657</issue>. <pub-id pub-id-type="doi">10.1016/j.nicl.2019.101657</pub-id>
<?supplied-pmid 30660662?><pub-id pub-id-type="pmid">30660662</pub-id></mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>M.-C.</given-names></name><name><surname>Stinear</surname><given-names>C. M.</given-names></name></person-group> (<year>2016</year>). <article-title>Transcranial magnetic stimulation (TMS) in stroke: ready for clinical practice?</article-title>
<source><italic>J. Clin. Neurosci.</italic></source>
<volume>31</volume>
<fpage>10</fpage>–<lpage>14</lpage>. <pub-id pub-id-type="doi">10.1016/j.jocn.2016.01.034</pub-id>
<?supplied-pmid 27394378?><pub-id pub-id-type="pmid">27394378</pub-id></mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vacherot</surname><given-names>F.</given-names></name><name><surname>Attarian</surname><given-names>S.</given-names></name><name><surname>Vaugoyeau</surname><given-names>M.</given-names></name><name><surname>Azulay</surname><given-names>J.-P.</given-names></name></person-group> (<year>2010</year>). <article-title>A motor cortex excitability and gait analysis on Parkinsonian patients.</article-title>
<source><italic>Mov. Disord.</italic></source>
<volume>25</volume>
<fpage>2747</fpage>–<lpage>2755</lpage>. <pub-id pub-id-type="doi">10.1002/mds.23378</pub-id>
<?supplied-pmid 20925071?><pub-id pub-id-type="pmid">20925071</pub-id></mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Werhahn</surname><given-names>K. J.</given-names></name><name><surname>Kunesch</surname><given-names>E.</given-names></name><name><surname>Noachtar</surname><given-names>S.</given-names></name><name><surname>Benecke</surname><given-names>R.</given-names></name><name><surname>Classen</surname><given-names>J.</given-names></name></person-group> (<year>1999</year>). <article-title>Differential effects on motorcortical inhibition induced by blockade of GABA uptake in humans.</article-title>
<source><italic>J. Physiol.</italic></source>
<volume>517</volume>(<issue>Pt 2</issue>), <fpage>591</fpage>–<lpage>597</lpage>. <pub-id pub-id-type="doi">10.1111/j.1469-7793.1999.0591t.x</pub-id>
<?supplied-pmid 10332104?><pub-id pub-id-type="pmid">10332104</pub-id></mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wessel</surname><given-names>J. R.</given-names></name><name><surname>Aron</surname><given-names>A. R.</given-names></name></person-group> (<year>2013</year>). <article-title>Unexpected events induce motor slowing via a brain mechanism for action-stopping with global suppressive effects.</article-title>
<source><italic>J. Neurosci.</italic></source>
<volume>33</volume>
<fpage>18481</fpage>–<lpage>18491</lpage>. <pub-id pub-id-type="doi">10.1523/JNEUROSCI.3456-13.2013</pub-id>
<?supplied-pmid 24259571?><pub-id pub-id-type="pmid">24259571</pub-id></mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wessel</surname><given-names>J. R.</given-names></name><name><surname>Aron</surname><given-names>A. R.</given-names></name></person-group> (<year>2017</year>). <article-title>On the globality of motor suppression: unexpected events and their influence on behavior and cognition.</article-title>
<source><italic>Neuron</italic></source>
<volume>93</volume>
<fpage>259</fpage>–<lpage>280</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuron.2016.12.013</pub-id>
<?supplied-pmid 28103476?><pub-id pub-id-type="pmid">28103476</pub-id></mixed-citation>
    </ref>
    <ref id="B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wessel</surname><given-names>J. R.</given-names></name><name><surname>Reynoso</surname><given-names>H. S.</given-names></name><name><surname>Aron</surname><given-names>A. R.</given-names></name></person-group> (<year>2013</year>). <article-title>Saccade suppression exerts global effects on the motor system.</article-title>
<source><italic>J. Neurophysiol.</italic></source>
<volume>110</volume>
<fpage>883</fpage>–<lpage>890</lpage>. <pub-id pub-id-type="doi">10.1152/jn.00229.2013</pub-id>
<?supplied-pmid 23699058?><pub-id pub-id-type="pmid">23699058</pub-id></mixed-citation>
    </ref>
    <ref id="B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Westin</surname><given-names>G. G.</given-names></name><name><surname>Bassi</surname><given-names>B. D.</given-names></name><name><surname>Lisanby</surname><given-names>S. H.</given-names></name><name><surname>Luber</surname><given-names>B.</given-names></name></person-group> (<year>2014</year>). <article-title>Determination of motor threshold using visual observation overestimates transcranial magnetic stimulation dosage: safety implications.</article-title>
<source><italic>Clin. Neurophysiol.</italic></source>
<volume>125</volume>
<fpage>142</fpage>–<lpage>147</lpage>. <pub-id pub-id-type="doi">10.1016/j.clinph.2013.06.187</pub-id>
<?supplied-pmid 23993680?><pub-id pub-id-type="pmid">23993680</pub-id></mixed-citation>
    </ref>
    <ref id="B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname><given-names>S. A.</given-names></name><name><surname>Lockwood</surname><given-names>R. J.</given-names></name><name><surname>Thickbroom</surname><given-names>G. W.</given-names></name><name><surname>Mastaglia</surname><given-names>F. L.</given-names></name></person-group> (<year>1993</year>). <article-title>The muscle silent period following transcranial magnetic cortical stimulation.</article-title>
<source><italic>J. Neurol. Sci.</italic></source>
<volume>114</volume>
<fpage>216</fpage>–<lpage>222</lpage>. <pub-id pub-id-type="doi">10.1016/0022-510X(93)90301-E</pub-id>
<?supplied-pmid 8445404?><pub-id pub-id-type="pmid">8445404</pub-id></mixed-citation>
    </ref>
    <ref id="B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ziemann</surname><given-names>U.</given-names></name><name><surname>Rothwell</surname><given-names>J. C.</given-names></name><name><surname>Ridding</surname><given-names>M. C.</given-names></name></person-group> (<year>1996</year>). <article-title>Interaction between intracortical inhibition and facilitation in human motor cortex.</article-title>
<source><italic>J. Physiol.</italic></source>
<volume>496</volume> (<issue>Pt 3</issue>), <fpage>873</fpage>–<lpage>881</lpage>. <pub-id pub-id-type="doi">10.1113/jphysiol.1996.sp021734</pub-id>
<?supplied-pmid 8930851?><pub-id pub-id-type="pmid">8930851</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
