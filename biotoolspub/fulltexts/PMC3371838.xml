<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3371838</article-id>
    <article-id pub-id-type="pmid">22689767</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bts206</article-id>
    <article-id pub-id-type="publisher-id">bts206</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Ismb 2012 Proceedings Papers Committee July 15 to July 19, 2012, Long Beach, Ca, Usa</subject>
      </subj-group>
      <subj-group>
        <subject>Original Papers</subject>
        <subj-group>
          <subject>Gene Regulation and Transcriptomics</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>NO<sc>r</sc>MAL: accurate nucleosome positioning using a modified Gaussian mixture model</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Polishko</surname>
          <given-names>Anton</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ponts</surname>
          <given-names>Nadia</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Le Roch</surname>
          <given-names>Karine G.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lonardi</surname>
          <given-names>Stefano</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup>Department of Computer Science and Engineering, <sup>2</sup>Department of Cell Biology and Neuroscience, University of California, Riverside, CA 92521, USA and <sup>3</sup>INRA, MycSA UR1264, 71 Avenue Edouard Bourlaux, F-33883 Villenave d'Ornon Cedex, France</aff>
    <author-notes>
      <corresp id="COR1">* To whom correspondence should be addressed.</corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>6</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>9</day>
      <month>6</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>9</day>
      <month>6</month>
      <year>2012</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>28</volume>
    <issue>12</issue>
    <fpage>i242</fpage>
    <lpage>i249</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2012. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2012</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">http://creativecommons.org/licenses/by-nc/3.0</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> Nucleosomes are the basic elements of chromatin structure. They control the packaging of DNA and play a critical role in gene regulation by allowing physical access to transcription factors. The advent of second-generation sequencing has enabled landmark genome-wide studies of nucleosome positions for several model organisms. Current methods to determine nucleosome positioning first compute an occupancy coverage profile by mapping nucleosome-enriched sequenced reads to a reference genome; then, nucleosomes are placed according to the peaks of the coverage profile. These methods are quite accurate on placing isolated nucleosomes, but they do not properly handle more complex configurations. Also, they can only provide the positions of nucleosomes and their occupancy level, whereas it is very beneficial to supply molecular biologists additional information about nucleosomes like the probability of placement, the size of DNA fragments enriched for nucleosomes and/or whether nucleosomes are well positioned or ‘fuzzy’ in the sequenced cell sample.</p>
      <p><bold>Results:</bold> We address these issues by providing a novel method based on a parametric probabilistic model. An expectation maximization algorithm is used to infer the parameters of the mixture of distributions. We compare the performance of our method on two real datasets against T<sc>emplate</sc> F<sc>iltering</sc>, which is considered the current state-of-the-art. On synthetic data, we show that our method can resolve more accurately complex configurations of nucleosomes, and it is more robust to user-defined parameters. On real data, we show that our method detects a significantly higher number of nucleosomes.</p>
      <p><bold>Availability:</bold> Visit <ext-link ext-link-type="uri" xlink:href="http://www.cs.ucr.edu/~polishka">http://www.cs.ucr.edu/~polishka</ext-link></p>
      <p><bold>Contact:</bold><email>stelo@cs.ucr.edu</email> or <email>polishka@cs.ucr.edu</email></p>
    </abstract>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>The study of the processes governing gene regulation is a central problem in molecular biology. One of the key factors influencing gene expression is the complex interaction between chromatin structure and transcription factors. The fundamental unit of chromatin is the <italic>nucleosome</italic>, composed of 146 ± 1 bp of DNA wrapped 1.65 turns around a protein complex of eight histones. To elucidate the role of the interactions between chromatin and transcription factors, it is crucial to determine the location of the nucleosomes along the genome. In general, the more condensed the chromatin, the harder it is for transcription factors and other DNA binding proteins to access DNA and carry out their tasks. The more accessible is the DNA, the more likely surrounding genes are actively transcribed. The presence (or the absence) of nucleosomes directly or indirectly affects a variety of other cellular and metabolic processes like recombination, replication, centromere formation and DNA repair.</p>
    <p>A handful of experimental techniques have been developed for genome-wide mapping of nucleosomes. For instance, one can enrich for genomic regions that are either bound to histones (typically via chromatin immuno-precipitation or ChIP) or for genomic regions that are free of nucleosomes (linkers). For instance, MAINEs (MNase-assisted Isolation Nucleosomal Elements) (<xref ref-type="bibr" rid="B16">Zaret, 2005</xref>) isolates the portions of the DNA that are attached to nucleosomes, because MNase preferentially digests linker regions. Then, microarrays (ChIP-chip) or sequencing (ChIP-seq/MNase-seq) are applied to the enriched DNA.</p>
    <p>In this article, we concentrate on the analysis of sequencing data, given the prevalence of MNase/ChiP-seq experiments in the recent literature. The computational analysis of the sequencing data usually consists of two main steps: (i) a nucleosome occupancy coverage is computed from the process of mapping nucleosome-enriched sequenced reads to a reference genome, followed by some normalization steps and (ii) nucleosomes are placed according to the peaks of the coverage profile.</p>
    <p>Approaches based on <italic>peak calling</italic> are computationally fast and quite accurate in resolving isolated (<italic>stable</italic> or <italic>arrayed</italic>) nucleosomes; however; they are not entirely reliable when more complex nucleosome configurations are present. Observe that while it is physically impossible for two nucleosomes to be ‘overlapping’ on the same location on a DNA strand, it is quite common that the population of cells from which the enriched DNA was obtained had nucleosomes slightly ‘off-sync’ at a given genomic coordinate (<italic>transient interaction</italic>). As a consequence, the resulting coverage profile will exhibit a ‘blurring’ of the peaks.</p>
    <p>Molecular biologists distinguish the case of ‘overlapping’ nucleosome from ‘fuzzy’ nucleosomes or ‘fuzzy’ regions (see <xref ref-type="fig" rid="F1">Fig. 1</xref>). For overlapping nucleosomes, the overlap is relatively small; in the ‘fuzzy’ case, several nucleosomes are mutually overlapping for a significant fraction of their size (see <xref ref-type="bibr" rid="B17">Zhang and Pugh, 2011</xref> for a review). By introducing a threshold parameter on the allowed overlap, one can define precisely the line between ‘fuzzy’ and ‘overlapping’.
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Nucleosomes are represented by ovals, mapped reads by arrows (which correspond to 5′→3′ prefixes of nucleosome-bound DNA). Coverage profiles are represented as time series for forward (top) and reverse (bottom) strands: the line style (solid, dotted and dashed) indicates peaks originating from distinct nucleosomes. (<bold>a</bold>) represents a stable nucleosome; (<bold>b</bold>) illustrates overlapping nucleosomes; and (<bold>c</bold>) represents ‘fuzzy’ nucleosomes</p></caption><graphic xlink:href="bts206f1"/></fig></p>
    <p>Another shortcoming of peak-calling approaches is that they can only report nucleosome positions and/or occupancy level. Molecular biologists, however, need additional information about nucleosomes. For instance, they are interested in the level of ‘fuzziness’ in certain genomic locations with respect to coding regions (i.e. well positioned for all the cells in the sample, or ‘blurred’), or how strong is the binding between nucleosomes and DNA. To address these shortcomings, we propose a method that determines the accurate position of the nucleosomes independently from the amount of overlaps in the nucleosomes. This method can also extract other important statistics about nucleosomes, e.g. the probability that a nucleosome is actually present, a measure of nucleosome ‘fuzziness’, and the size of DNA fragments enriched for nucleosomes.</p>
    <p>Here, we propose a parametric probabilistic model for nucleosome positioning, which we called NO<sc>r</sc>MAL, for NucleOsome Mapping ALgorithm. NO<sc>r</sc>MAL uses Expectation Maximization (EM) to infer its parameters. To demonstrate the performance of our method, we report experimental results on MAINE-seq data for <italic>Plasmodium falciparum</italic> (<xref ref-type="bibr" rid="B10">Ponts <italic>et al.</italic>, 2010</xref>) and <italic>Saccharomyces cerevisiae</italic> (<xref ref-type="bibr" rid="B15">Weiner <italic>et al.</italic>, 2010</xref>). We compare the performance of our method against the T<sc>emplate</sc> F<sc>iltering</sc> (TF) algorithm (<xref ref-type="bibr" rid="B15">Weiner <italic>et al.</italic>, 2010</xref>), which is considered the current state-of-the-art in terms of accuracy and ability to estimate sizes of the DNA fragments bound to nucleosomes. We also discuss a fundamental limitation of greedy peak-calling approaches in the case of overlapping nucleosomes and how our method addresses this issue.</p>
    <sec id="SEC1.1">
      <title>1.1 Previous work</title>
      <p>Several landmark studies have been published in the last few years on the chromatin structure of model organisms based on the analysis of genome-wide nucleosome maps (<xref ref-type="bibr" rid="B1">Albert <italic>et al.</italic>, 2007</xref>; <xref ref-type="bibr" rid="B3">Field <italic>et al.</italic>, 2008</xref>; <xref ref-type="bibr" rid="B7">Mavrich <italic>et al.</italic>, 2008a</xref>, <xref ref-type="bibr" rid="B8">b</xref>; <xref ref-type="bibr" rid="B10">Ponts <italic>et al.</italic>, 2010</xref>; <xref ref-type="bibr" rid="B13">Shivaswamy <italic>et al.</italic>, 2008</xref>; <xref ref-type="bibr" rid="B14">Valouev <italic>et al.</italic>, 2008</xref>; <xref ref-type="bibr" rid="B17">Zhang and Pugh, 2011</xref>). Existing methods in the literature are based on the analysis of the peaks in the nucleosome occupancy coverages estimated by mapping nucleosome-enriched reads to the reference genome. The coverage occupancy profile is an integer-valued function defined for all genomic locations: given a position <italic>i</italic> in a chromosome the function is equal to the number of sequenced reads that are mapped to location <italic>i</italic>. From a probabilistic point of view, the coverage profile represents a non-parametric distribution of the nucleosome positions. At the time of writing, the length of the reads obtained by second-generation sequencing (e.g. Illumina Genome Analyzer) are limited to about 100 bases and the sequencing occurs in the 5′→3′ direction. In the case of ChIP-seq/MAINE-seq, sequenced reads that can be uniquely mapped to the positive strand originate from the left boundary of nucleosome DNA fragments, while reads uniquely mapped to the negative strand originate from the right boundary (<xref ref-type="fig" rid="F1">Fig. 1</xref>). Recall that nucleosomes are composed of about 146 bp of DNA, so if reads are single end and shorter than 146 bp, we expect to observe a peak in the forward and a peak in the reverse coverage profiles at a distance consistent with the nucleosome size.</p>
      <p>The problem of associating a peak in the forward strand with the correct peak in the negative strand can be difficult in the case of a large number of complex nucleosome configurations. Some authors artificially extend the reads in the 5′→3′ direction or they shift the positions of the mapped read position of the forward and reverse toward the middle of potential nucleosomes. Then, they combine (e.g. sum) the forward and reverse modified coverages to build a score function. In both cases, they need to determine the amount of the extension or the size of the shift. In the former case, the extension should account for the expected length of the DNA fragments enriched for nucleosomes; in the latter, the shift should be about half of the DNA fragment size. The problem of this approach is that no extension or shift that will work equally well for all nucleosomes in the genome. While one should expect DNA fragments enriched for nucleosomes to be ~146 bp, the reality is that the digestion process can either leave nucleosome-free DNA in the sample, or ‘over-digest’ the ends of nucleosome-bound DNA. What complicates the matter further is that the rate of digestion is sequence dependent (<xref ref-type="bibr" rid="B2">Allan <italic>et al.</italic>, 2012</xref>; <xref ref-type="bibr" rid="B15">Weiner <italic>et al.</italic>, 2010</xref>), so nucleosomes in different genomic locations will end up with different DNA fragment size. For this reason, it is advantageous to ‘learn’ this information from the input data. TF (<xref ref-type="bibr" rid="B15">Weiner <italic>et al.</italic>, 2010</xref>) is the only method we know that can handle variable fragment sizes in a specified range, whereas other methods require users to decide this value in advance.</p>
      <p>As said, a variety of peak-calling algorithms have been also developed (<xref ref-type="bibr" rid="B1">Albert <italic>et al.</italic>, 2007</xref>; <xref ref-type="bibr" rid="B3">Field <italic>et al.</italic>, 2008</xref>, <xref ref-type="bibr" rid="B4">2009</xref>; <xref ref-type="bibr" rid="B5">Kaplan <italic>et al.</italic>, 2009</xref>; <xref ref-type="bibr" rid="B7">Mavrich <italic>et al.</italic>, 2008a</xref>, <xref ref-type="bibr" rid="B8">b</xref>; <xref ref-type="bibr" rid="B12">Sasaki <italic>et al.</italic>, 2009</xref>; <xref ref-type="bibr" rid="B14">Valouev <italic>et al.</italic>, 2008</xref>). Most of these methods have been proposed for the analysis of ChIP-chip or ChIP-seq data to determine the position and strength of the transcription factors binding to DNA. The problem of detecting transcription factor binding sites is similar to nucleosome positioning: in both cases we need to infer position of proteins binding to DNA from the coverage profiles. However, the size of the nucleosomes is significantly bigger than transcription factor binding sites, as a consequence the resulting configurations of nucleosomes can be more complex.</p>
      <p>To summarize our experience with existing methods on the genome-wide nucleosome study of human malaria parasite (<xref ref-type="bibr" rid="B10">Ponts <italic>et al.</italic>, 2010</xref>, <xref ref-type="bibr" rid="B11">2011</xref>), peak calling approaches suffer from a variety of problems. First, the coverage profile function has to be cleaned of high-frequency noise, typically via a kernel density estimation method (<xref ref-type="bibr" rid="B9">Parzen, 1962</xref>). The type of kernel and the amount of smoothing can drastically affect the results: too much can merge adjacent peaks, too little can leave too many noisy artifacts that can be interpreted as individual peaks. Second, peak finding algorithms have parameters (like the extension and the shift discussed above) that are difficult to optimize: a set of parameter can work for a region of a chromosome but not for another. Third, peak calling do not properly resolve overlapping nucleosomes. For instance, TF (<xref ref-type="bibr" rid="B15">Weiner <italic>et al.</italic>, 2010</xref>) uses a greedy strategy: nucleosomes are placed according to the ‘best’ matching peaks in the score function. Once these strong-positioned nucleosome are assigned, TF ignores any nucleosome that overlaps with previous ones. It is relatively easy to show that for overlapping nucleosomes the greedy strategy does not always return the best overall placement (see <xref ref-type="sec" rid="SEC3">Section 3</xref> for details).</p>
    </sec>
  </sec>
  <sec id="SEC2">
    <title>2 METHODS</title>
    <p>Next, we propose a parametric probabilistic model to find the most likely set of nucleosome that best ‘explain’ the mapped reads. We cast this problem in a <italic>modified Gaussian mixture model</italic> framework. The problem of positioning nucleosomes is then reduced to the problem of learning the parameters of the model and finding the distribution of mixture components, which is achieved via EM.</p>
    <sec id="SEC2.1">
      <title>2.1 A probabilistic model for nucleosomes</title>
      <p>We employ a probabilistic model for nucleosome positioning that is described by a set of hidden and observed variables. We use <italic>N</italic> to denote the number of DNA fragments obtained after MNase digestion. For any DNA fragment <italic>i</italic>∈[1, <italic>N</italic>], let <italic>x</italic><sub><italic>i</italic></sub> be the starting position of the 5′-end of fragment <italic>i</italic> (obtained by mapping a corresponding sequenced read), and let variable <italic>d</italic><sub><italic>i</italic></sub>∈{+1, −1} be the strand on which fragment <italic>i</italic> was mapped (+1 for the positive strand, and −1 for the negative strand). Also, let <italic>z</italic><sub><italic>i</italic></sub> be the length of fragment <italic>i</italic>. If we use variable <italic>m</italic><sub><italic>i</italic></sub> to denote the position of the center of the fragment <italic>i</italic>, then we have <italic>m</italic><sub><italic>i</italic></sub>=<italic>x</italic><sub><italic>i</italic></sub>+(<italic>d</italic><sub><italic>i</italic></sub><italic>z</italic><sub><italic>i</italic></sub>)/2.</p>
      <p>We denote with <italic>X</italic><sub><italic>i</italic></sub>, <italic>D</italic><sub><italic>i</italic></sub>, <italic>Z</italic><sub><italic>i</italic></sub> and <italic>M</italic><sub><italic>i</italic></sub> the random variables associated with variables <italic>x</italic><sub><italic>i</italic></sub>, <italic>d</italic><sub><italic>i</italic></sub>, <italic>z</italic><sub><italic>i</italic></sub> and <italic>m</italic><sub><italic>i</italic></sub>, respectively. Since the sequencing process is 5′→3′, the value of <italic>X</italic><sub><italic>i</italic></sub> is observable by means of mapping a read originating from fragment <italic>i</italic>. Similarly, the strand variable <italic>D</italic><sub><italic>i</italic></sub> is also observable. Variables <italic>Z</italic><sub><italic>i</italic></sub> and <italic>M</italic><sub><italic>i</italic></sub> can be observed directly only if sequencing produces paired-end reads, otherwise these variables are hidden. In order to consider the most general case, we only deal with the latter case (single-end reads).</p>
      <p>We assume for the time being that the number <italic>K</italic> of nucleosomes is given. We will discuss how to choose <italic>K</italic> in <xref ref-type="sec" rid="SEC2.3">Section 2.3</xref>. For each DNA fragment <italic>i</italic>, we use a hidden variable <italic>C</italic><sub><italic>i</italic></sub>∈[1, <italic>K</italic>] representing the nucleosome to which it belongs. Each nucleosome <italic>j</italic>∈[1, <italic>K</italic>] is described by a set of six variables (μ<sub><italic>j</italic></sub>, σ<sub><italic>j</italic></sub>, Δ<sub><italic>j</italic></sub>, δ<sub><italic>j</italic></sub><sup>+1</sup>, δ<sub><italic>j</italic></sub><sup>−1</sup>, π<sub><italic>j</italic></sub>), where μ<sub><italic>j</italic></sub> denotes the center position of the nucleosome <italic>j</italic>, σ<sub><italic>j</italic></sub> is the fuzziness associated with the position of nucleosome <italic>j</italic>, Δ<sub><italic>j</italic></sub> describes the length of DNA fragments associated with nucleosome <italic>j</italic>, δ<sub><italic>j</italic></sub><sup>+1</sup> and δ<sub><italic>j</italic></sub><sup>−1</sup> represents the variation on fragment sizes for positive and negative strands, respectively, and π<sub><italic>j</italic></sub> is the probability of nucleosome <italic>j</italic>. The degree of <italic>fuzziness</italic> captures the variation of the position of a particular nucleosome in the population of sampled cells. Well-positioned nucleosomes have very low degree of fuzziness. We introduce two variables δ<sub><italic>j</italic></sub><sup>+1</sup> and δ<sub><italic>j</italic></sub><sup>−1</sup> to model the variation of the fragment size because MNase does not only digest nucleosome-free DNA. Given enough time, it can also digest into the ends of the fragments bounds to nucleosomes, the rate of digestion being sequence dependent [see, e.g. (<xref ref-type="bibr" rid="B2">Allan <italic>et al.</italic>, 2012</xref>; <xref ref-type="bibr" rid="B15">Weiner <italic>et al.</italic>, 2010</xref>)]. Since the sequence composition of the 5′ end of a DNA fragment can be quite different from the 3′ end, we need to have two different variables. The value of <italic>C</italic><sub><italic>i</italic></sub> is drawn from (1, 2,…, <italic>K</italic>) with corresponding probabilities (π<sub>1</sub>, π<sub>2</sub>,…, π<sub><italic>K</italic></sub>). Parameter π<sub><italic>j</italic></sub> models the contribution of <italic>j</italic>-th nucleosome to the occupancy level, i.e. what portion of the mapped reads belong to nucleosome <italic>j</italic>.</p>
      <p>Our nucleosome model assumes that our random variables are distributed according to a normal distribution. For convenience of notation, we set Θ<sub><italic>j</italic></sub>=(μ<sub><italic>j</italic></sub>, σ<sub><italic>j</italic></sub>, Δ<sub><italic>j</italic></sub>, δ<sub><italic>j</italic></sub><sup>+1</sup>, δ<sub><italic>j</italic></sub><sup>−1</sup>, π<sub><italic>j</italic></sub>) for all <italic>j</italic>∈[1, <italic>K</italic>], and Θ=(Θ<sub>1</sub>,…, Θ<sub><italic>K</italic></sub>). First, we assume that variable <italic>M</italic><sub><italic>i</italic></sub> associated with the center of the fragment <italic>i</italic> for a particular nucleosome <italic>j</italic> is distributed as follows
<disp-formula id="M1"><label>(1)</label><graphic xlink:href="bts206m1"/></disp-formula>
where μ<sub><italic>j</italic></sub> represents the center of the nucleosome <italic>j</italic> and σ<sub><italic>j</italic></sub> is its fuzziness. Second, we assume that the length <italic>Z</italic><sub><italic>i</italic></sub> of fragment <italic>i</italic> for a particular nucleosome <italic>j</italic> is distributed as follows
<disp-formula id="M2"><label>(2)</label><graphic xlink:href="bts206m2"/></disp-formula>
where Δ<sub><italic>j</italic></sub> represents the expected size of the fragments for nucleosome <italic>j</italic>, and δ<sub><italic>j</italic></sub><sup>+1</sup> and δ<sub><italic>j</italic></sub><sup>−1</sup> represents the variation of fragment sizes for positive and negative strands, respectively.</p>
      <p>Combining Equations (<xref ref-type="disp-formula" rid="M1">1</xref>) and (<xref ref-type="disp-formula" rid="M2">2</xref>) and relation <italic>x</italic><sub><italic>i</italic></sub>=<italic>m</italic><sub><italic>i</italic></sub>−(<italic>d</italic><sub><italic>i</italic></sub><italic>z</italic><sub><italic>i</italic></sub>)/2, and then applying the rule of linear combination of independent Gaussians we obtain
<disp-formula id="M3"><label>(3)</label><graphic xlink:href="bts206m3"/></disp-formula></p>
      <p>Equation (<xref ref-type="disp-formula" rid="M3">3</xref>) allows one to compute the probability of a given data point <italic>x</italic><sub><italic>i</italic></sub> given the parameters of a nucleosome. Next, we describe the model for multiple nucleosomes.</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Mixture model</title>
      <p>Next, we introduce a generative mixture model to describe the likelihood of input data points <italic>X</italic>=(<italic>x</italic><sub>1</sub>,…, <italic>x</italic><sub><italic>N</italic></sub>). <xref ref-type="fig" rid="F2">Figure 2</xref> shows a graphical representation of the mixture model. In Equation (<xref ref-type="disp-formula" rid="M3">3</xref>), the only hidden random variable is <italic>C</italic> because we already excluded variables <italic>z</italic><sub><italic>i</italic></sub> from the computation. By grouping variables <italic>X</italic><sub><italic>i</italic></sub>, <italic>D</italic><sub><italic>i</italic></sub>, we can use an approach similar to a <italic>naive Bayes classifier</italic>. Variable <italic>C</italic> represents the nucleosome to which the points belong. Thus, we can describe the likelihood of point (<italic>x</italic><sub><italic>i</italic></sub>, <italic>d</italic><sub><italic>i</italic></sub>) given the parameters of our model as a mixture of distributions. Using the Bayesian rule we obtain
<disp-formula id="M4"><label>(4)</label><graphic xlink:href="bts206m4"/></disp-formula>
where <inline-formula><inline-graphic xlink:href="bts206i1.jpg"/></inline-formula> is the Gaussian density function.
<fig id="F2" position="float"><label>Fig. 2.</label><caption><p>The proposed graphical mixture model: shaded nodes correspond to observed variables, white nodes correspond to hidden variables</p></caption><graphic xlink:href="bts206f2"/></fig></p>
      <p>Using Equation (<xref ref-type="disp-formula" rid="M4">4</xref>), we can obtain the log likelihood of observed data points <italic>X</italic> given parameters Θ as
<disp-formula id="M5"><label>(5)</label><graphic xlink:href="bts206m5"/></disp-formula></p>
      <p>Given Equation (<xref ref-type="disp-formula" rid="M5">5</xref>) and the input data points <italic>X</italic>=(<italic>x</italic><sub>1</sub>,…, <italic>x</italic><sub><italic>N</italic></sub>), we can find an estimate the parameters of the model Θ via maximum likelihood
<disp-formula id="M6"><label>(6)</label><graphic xlink:href="bts206m6"/></disp-formula></p>
      <p>Recall that Θ=(Θ<sub>1</sub>,…, Θ<sub><italic>K</italic></sub>) is a vector whose components are the nucleosome parameters Θ<sub><italic>j</italic></sub>=(μ<sub><italic>j</italic></sub>, Δ<sub><italic>j</italic></sub>, σ<sub><italic>j</italic></sub>, δ<sub><italic>j</italic></sub><sup>(+1)</sup>, δ<sub><italic>j</italic></sub><sup>(−1)</sup>, π<sub><italic>j</italic></sub>) for all <italic>j</italic>∈[1, <italic>K</italic>]. The presence of parameters π<sub><italic>j</italic></sub> that correspond to hidden variables <italic>C</italic><sub><italic>i</italic></sub> prevents us from solving Equation (<xref ref-type="disp-formula" rid="M6">6</xref>) directly. We estimate <inline-formula><inline-graphic xlink:href="bts206i2.jpg"/></inline-formula> via EM. In our case, the E step requires computing the posterior probabilities <italic>P</italic>(<italic>C</italic><sub><italic>i</italic></sub>=<italic>j</italic>|<italic>X</italic><sub><italic>i</italic></sub>=<italic>x</italic><sub><italic>i</italic></sub>; Θ) of data points <italic>x</italic><sub><italic>i</italic></sub>, <italic>i</italic>∈[1, <italic>N</italic>] with respect to the distribution of <italic>C</italic><sub><italic>i</italic></sub> given the current estimate of parameters Θ<sup>(<italic>t</italic>)</sup>
<disp-formula id="M7"><label>(7)</label><graphic xlink:href="bts206m7"/></disp-formula>
During the E step, we supplement the missing data in Equation (<xref ref-type="disp-formula" rid="M6">6</xref>) with the expected values under the current parameter estimates Θ<sup>(<italic>t</italic>)</sup>. In the M step, we find new parameter estimation Θ<sup>(<italic>t</italic>+1)</sup> by maximizing Equation (<xref ref-type="disp-formula" rid="M7">7</xref>)
<disp-formula id="M8"><label>(8)</label><graphic xlink:href="bts206m8"/></disp-formula></p>
      <p>It is relatively straightforward to bound the variation parameters (σ, δ<sup>+1</sup>, δ<sup>−1</sup>) during the iterative EM process to converge to a solution with ‘reasonable’ parameters. We can also easily introduce prior distribution for some of the parameters. For instance, we can specify an expected distribution for DNA fragment sizes Δ<sub><italic>j</italic></sub>, which can be estimated via gel electrophoresis prior to sequencing.</p>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 Choosing the number of nucleosomes</title>
      <p>The method described above assumes that the number of clusters <italic>K</italic> is known. The problem of selecting the best value for <italic>K</italic> is as challenging as selecting the optimal number of clusters in <italic>k</italic>-means clustering. One can estimate the number of clusters by looking at the support area of the occupancy coverage, but this will be quite inaccurate because ‘fuzzy’ nucleosomes correspond to wider peaks, and the support area is bigger for them.</p>
      <p>Here, we propose a simple but effective heuristic to find <italic>K</italic>. We start by (1) placing the maximum possible number of non-overlapping nucleosomes uniformly distributed on the chromosome, that is <italic>K</italic>= (size of the chromosome)/(expected size of a nucleosome), where the expected size of nucleosomes is underestimated. Then, (2) we run our EM algorithm until convergence (‘soft learning’). We will then (3) check the distance between the clusters, and merge those that have too much overlap (above a user-specified threshold). In case of multiple overlaps for a nucleosome, we merge it with the closest one. We repeat (2) and (3) until no additional clusters are merged. After a few cycles, we will obtain a set of non-overlapping clusters that best explain the given data points. Overlapping nucleosomes are merged into new ones and then the position of new nucleosomes are learned from the data.</p>
      <p>This procedure will give us a good estimate on the number of clusters as well as a rough estimate of the nucleosome positions. To further improve accuracy for other model parameters, we perform one iteration of ‘hard learning’ by assigning each data point <italic>x</italic><sub><italic>i</italic></sub> its maximum probable cluster. Nucleosome clusters will partition the set of input points, which in turns will allow us to compute their parameters more accurately. The pseudo-code of the algorithm is shown on <xref ref-type="fig" rid="F3">Figure 3</xref>. The running time of NO<sc>r</sc>MAL is dominated by the running time of <italic>Learning</italic> step (Algorithm 1, line 6). Observe that the probability that a data point belongs to far-away nucleosomes is close to zero, so one can avoid unnecessary computations by computing updates only for clusters in close vicinity of each point.
<fig id="F3" position="float"><label>Fig. 3.</label><caption><p>A sketch of the proposed NO<sc>r</sc>MAL algorithm</p></caption><graphic xlink:href="bts206f3"/></fig></p>
      <p>The running time is dominated by the heuristic used to find the number of nucleosomes <italic>K</italic>. In order for the algorithm to scale to eukaryotic genomes, additional optimization steps will have to be implemented. For instance, during the early stage of soft learning (i.e. active cluster merging), the algorithm could be applied to small ‘chunks’ of chromosomes. Then, when the number of merges reduces substantially, the nucleosome maps for each chunk could be combined and algorithm would continue to the hard-learning step.</p>
    </sec>
    <sec id="SEC2.4">
      <title>2.4 Practical considerations</title>
      <p>Our method requires users to specify three parameters, namely the threshold for allowed overlap between adjacent nucleosomes, the prior Δ on nucleosome sizes and its weight λ.</p>
      <p>The threshold for allowed overlap can significantly affect the output: the more overlap is allowed, the more nucleosomes can be placed. In the current implementation, this parameter has to be specified by the user. The prior Δ on the nucleosome size and its weight λ control the propagation of ‘knowledge’ from data points on forward strand to data points on the reverse strand, and vice versa. Based on our experience, if the prior size Δ is within 30 bp of the ‘true’ fragment size, then the algorithm is consistent in its output.</p>
      <p>Our implementation has some additional internal parameters that we are not expecting users to change. While inferring the parameters of our mixture models, some clusters will tend to cover most of the data points using large variances: a common trick to avoid this from happening is to introduce hard limits on such parameters. Our implementation has range limits for the nucleosome sizes and variance to force the method to converge to ‘reasonable’ nucleosome sizes/variances in the early stage of the iterative process. These parameters have been chosen loose enough so by the end of the iterative process, the limits for nucleosome size and variance are rarely hit, and the output is not significantly affected. The hard-learning step completely ignores those upper limits.</p>
      <p>Additional details on parameter selection will be found in the on-line User Manual.</p>
    </sec>
  </sec>
  <sec id="SEC3">
    <title>3 EXPERIMENTAL RESULTS</title>
    <p>We carried out extensive benchmarking between our proposed method NO<sc>r</sc>MAL and TF (<xref ref-type="bibr" rid="B15">Weiner <italic>et al.</italic>, 2010</xref>). We selected TF because it is considered the current state-of-the-art. It is the only method that, in addition to inferring nucleosome positions, can extract nucleosome fragment sizes and binding scores. TF differs from the traditional peak-calling algorithms because it does not look for peaks in the coverage profiles, but it places nucleosomes at the peaks of a correlation score matrix. Due to its greedy strategy, TF has significant limitations when dealing with fuzzy/overlapping nucleosomes, as explained next.</p>
    <p>The setup for the comparison is as follows. The input parameters for NO<sc>r</sc>MAL are the prior size of the nucleosome fragments and the allowed amount of overlap between nucleosomes. For TF, we used default parameters unless specified otherwise. The default allowed range of nucleosome size for TF is [100,200], which centered around the expected nucleosomes size of ~146 bp.</p>
    <p><italic>Synthetic data</italic>: first, we want to illustrate the challenge for existing nucleosome positioning methods to deal with the placement of overlapping nucleosomes. The problem derives from the difficulty in distinguishing two overlapping nucleosomes from the ‘fuzzy’ case. To define precisely this problem, we need to introduce a threshold parameter: if the percentage of overlap between two nucleosomes exceeds the threshold, then they should be considered ‘fuzzy’, otherwise they should be treated as separate overlapping nucleosomes. It is relatively easy to show that the greedy strategy does not always give the optimal nucleosome placement in case of overlapping nucleosomes. To do so, we have created a small synthetic dataset that contains reads corresponding to two overlapping nucleosomes. Although we could have used our own parametric model to generate the synthetic data, to avoid the possibility of giving an advantage to our method, we generated the input data according to the template function described in (<xref ref-type="bibr" rid="B15">Weiner <italic>et al.</italic>, 2010</xref>). The parameters for nucleosome positions (μ<sub>1</sub> and μ<sub>2</sub>) and nucleosome sizes (Δ<sub>1</sub> and Δ<sub>2</sub>) that we used to generate the reads are reported in <xref ref-type="table" rid="T1">Table 1</xref>. <xref ref-type="fig" rid="F4">Figure 4</xref>A illustrates the coverage profile for mapped reads. Observe that there are two peaks on forward and reverse strands, which indicates the presence of two nucleosomes. The percentage of overlap is roughly 35%. In the first case, we allowed such amount of overlap in both TF and NO<sc>r</sc>MAL (<xref ref-type="fig" rid="F4">Fig. 4</xref>B for TF and <xref ref-type="fig" rid="F4">Fig. 4</xref>C for NO<sc>r</sc>MAL). Both methods correctly reported two overlapping nucleosomes. Observe the error bars attached to the boundaries of nucleosomes reported by NO<sc>r</sc>MAL, which indicate the positional variance (or ‘fuzziness’) of the corresponding boundary (each bar has length <inline-formula><inline-graphic xlink:href="bts206i3.jpg"/></inline-formula>). TF does not provide such information.
<fig id="F4" position="float"><label>Fig. 4.</label><caption><p>An example of two overlapping nucleosomes. <bold>(A)</bold> Coverage profile from synthetic data (forward strand on top, reverse strand on bottom), where nucleosomes overlap on ~35 of their length; nucleosomes detected using TF allowing maximum 35% overlap (<bold>B</bold>), NO<sc>r</sc>MAL allowing maximum 35% overlap (<bold>C</bold>), TF allowing only 30 overlap, [100,200] (<bold>D</bold>) and NO<sc>r</sc>MAL allowing only 30% overlap (<bold>E</bold>); nucleosome reported by TF with nucleosome size range [40,200] (<bold>F</bold>) and [100,300] (<bold>G</bold>)</p></caption><graphic xlink:href="bts206f4"/></fig>
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>The parameters used to generate the reads in <xref ref-type="fig" rid="F4">Figure 4</xref>, and the corresponding output results from TF and NO<sc>r</sc>MAL</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Parameter</th><th rowspan="1" colspan="1">True value</th><th rowspan="1" colspan="1">TF</th><th rowspan="1" colspan="1">NO<sc>r</sc>MAL</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">μ<sub>1</sub></td><td rowspan="1" colspan="1">210</td><td rowspan="1" colspan="1">208</td><td rowspan="1" colspan="1">206</td></tr><tr><td rowspan="1" colspan="1">Δ<sub>1</sub></td><td rowspan="1" colspan="1">130</td><td rowspan="1" colspan="1">125</td><td rowspan="1" colspan="1">134</td></tr><tr><td rowspan="1" colspan="1">μ<sub>2</sub></td><td rowspan="1" colspan="1">300</td><td rowspan="1" colspan="1">301</td><td rowspan="1" colspan="1">300</td></tr><tr><td rowspan="1" colspan="1">Δ<sub>2</sub></td><td rowspan="1" colspan="1">150</td><td rowspan="1" colspan="1">149</td><td rowspan="1" colspan="1">148</td></tr></tbody></table></table-wrap>
</p>
    <p>In the second case, when the parameters are set so nucleosomes are not allowed to overlap &gt;30%, only one nucleosome should be reported. <xref ref-type="fig" rid="F4">Figure 4</xref>D and E illustrates the output of TF and NO<sc>r</sc>MAL, respectively. Observe that now there is a fundamental difference: TFs greedy strategy reports the presence of the first nucleosome, but then it completely ignores the data corresponding to the second nucleosome. This is an entirely arbitrarily choice and the user will not be even aware of this. In contrast, NO<sc>r</sc>MAL reports one nucleosome positioned near the centroid of the data points and correctly indicates that the variance of the nucleosome boundaries in this case is very high, indicating that this nucleosome should be considered ‘fuzzy’.</p>
    <p>In addition, TFs positioning results are very sensitive to its main input parameter, namely the allowed range for nucleosome fragment sizes. With the default size range [100,200], TF reports one nucleosome (<xref ref-type="fig" rid="F4">Fig. 4</xref>D). When we extend the range to [40,200], TF detects one small nucleosome by incorrectly matching the two strongest (but closest) peaks (<xref ref-type="fig" rid="F4">Fig. 4</xref>F). If we change the range to [100,300], TF reports one large nucleosome, this time matching the outmost peaks (<xref ref-type="fig" rid="F4">Fig. 4</xref>G). Even if we allow a larger overlap, TF will still produce the nucleosome in <xref ref-type="fig" rid="F4">Figure 4</xref>G (data not shown). Since the allowed range for nucleosome size in TF is a hard boundary, the results are very dependent from the choice of this parameter. NO<sc>r</sc>MAL is more robust in that regard because the prior distribution for the fragment sizes in NO<sc>r</sc>MAL is ‘soft’ and it can adapt to the data.</p>
    <p><italic>Real data</italic>: the challenge for nucleosome position inference is that the true positions of the nucleosomes are unknown. The lack of a ‘ground-truth’ makes it very hard to benchmark the existing computational methods. To compare between methods, we can only use conservative indicators. We argue that a valuable indicator is the number of reported nucleosomes. Nonetheless, it is difficult to argue about performance in objective terms. That is why the first dataset we considered is from <italic>S. cerevisiae</italic> (<xref ref-type="bibr" rid="B15">Weiner <italic>et al.</italic>, 2010</xref>). This was the original dataset for which TF was designed. The results of TF on this dataset are assumed to be accurate.</p>
    <p>To compare NO<sc>r</sc>MAL and TF, we used the following setup. The main range parameter for TF was set to [80,200], which is slightly wider than the default parameters. We did not want to penalize TF, since NO<sc>r</sc>MAL does not have any hard limits for the nucleosome sizes. For NO<sc>r</sc>MAL, the main parameter is the prior expected value for the nucleosome sizes: we used 140 bp to hit the middle of the specified range of TF. The threshold value of allowed overlap for both methods was set at 35%. All other parameters were left to default values. The results of both methods are reported in <xref ref-type="table" rid="T2">Table 2</xref>. Observe that NO<sc>r</sc>MAL is slower, but it returns on average 2.6% more nucleosomes than TF.
<table-wrap id="T2" position="float"><label>Table 2.</label><caption><p>Experimental results on the <italic>S. cerevisiae</italic> dataset: number of nucleosome detected by TF and NO<sc>r</sc>MAL and corresponding execution time (bold numbers indicate the maximum)</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Chromosome</th><th rowspan="1" colspan="1">No of mapped reads</th><th rowspan="1" colspan="1">TF</th><th rowspan="1" colspan="1">Time (s)</th><th rowspan="1" colspan="1">NO<sc>r</sc>MAL</th><th rowspan="1" colspan="1">Time (s)</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">16 688</td><td rowspan="1" colspan="1">1 033</td><td rowspan="1" colspan="1">1.38</td><td rowspan="1" colspan="1"><bold>1 078</bold></td><td rowspan="1" colspan="1">6.86</td></tr><tr><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">78 543</td><td rowspan="1" colspan="1">4 284</td><td rowspan="1" colspan="1">7.37</td><td rowspan="1" colspan="1"><bold>4 394</bold></td><td rowspan="1" colspan="1">84.56</td></tr><tr><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">30 589</td><td rowspan="1" colspan="1">1 583</td><td rowspan="1" colspan="1">4.43</td><td rowspan="1" colspan="1"><bold>1 618</bold></td><td rowspan="1" colspan="1">8.49</td></tr><tr><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">138 801</td><td rowspan="1" colspan="1">7 975</td><td rowspan="1" colspan="1">16.36</td><td rowspan="1" colspan="1"><bold>8 014</bold></td><td rowspan="1" colspan="1">369.11</td></tr><tr><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">55 601</td><td rowspan="1" colspan="1">2 986</td><td rowspan="1" colspan="1">4.02</td><td rowspan="1" colspan="1"><bold>3 101</bold></td><td rowspan="1" colspan="1">38.80</td></tr><tr><td rowspan="1" colspan="1">6</td><td rowspan="1" colspan="1">26 141</td><td rowspan="1" colspan="1">1 403</td><td rowspan="1" colspan="1">1.63</td><td rowspan="1" colspan="1"><bold>1 453</bold></td><td rowspan="1" colspan="1">4.45</td></tr><tr><td rowspan="1" colspan="1">7</td><td rowspan="1" colspan="1">101 981</td><td rowspan="1" colspan="1">5 727</td><td rowspan="1" colspan="1">9.84</td><td rowspan="1" colspan="1"><bold>5 817</bold></td><td rowspan="1" colspan="1">126.34</td></tr></tbody></table></table-wrap>
</p>
    <p>If we compare the distribution of reported nucleosome sizes (<xref ref-type="fig" rid="F5">Fig. 5</xref>), both methods provide consistent results. To compare how reported nucleosomes are related to each other, we performed a matching procedure. We built a bipartite graph, where a node corresponds to a reported nucleosome (each part corresponds to one of the two methods). The bipartite graph is fully connected, and the weight on edge (<italic>u</italic>,<italic>v</italic>) is the squared distance between nucleosome <italic>u</italic> and <italic>v</italic>: when the distance between <italic>u</italic> and <italic>v</italic> exceeded 50 bp, we set the weight to ∞. Then we solved the weighted assignment problem between the two sets using the Hungarian method. The distribution of pairwise distances between matching nucleosomes is shown in <xref ref-type="fig" rid="F6">Figure 6</xref>. Observe that the distribution is a unimodal bell-shaped curve with mean and mode having near zero value. The number of matched (common) nucleosomes is 81.44% of the total: 8.29% and 10.27 are unique to NO<sc>r</sc>MAL and TF, respectively.
<fig id="F5" position="float"><label>Fig. 5.</label><caption><p>Size distribution of reported nucleosomes for <italic>S. cerevisiae</italic></p></caption><graphic xlink:href="bts206f5"/></fig>
<fig id="F6" position="float"><label>Fig. 6.</label><caption><p>Distribution of pairwise distances between corresponding nucleosomes reported by TF and NO<sc>r</sc>MAL for <italic>S. cerevisiae</italic></p></caption><graphic xlink:href="bts206f6"/></fig></p>
    <p>While the dataset for <italic>S. cerevisiae</italic> is considered to have relatively stable set of nucleosomes (<xref ref-type="bibr" rid="B15">Weiner <italic>et al.</italic>, 2010</xref>), the dataset for the human malaria parasite <italic>P. falciparum</italic> has very dynamic nucleosomes (<xref ref-type="bibr" rid="B10">Ponts <italic>et al.</italic>, 2010</xref>). The considered dataset consists of seven time-points (namely, 0, 6, 12, 18, 24, 30 and 36 h), each related to a different stage on the cell cycle (<xref ref-type="bibr" rid="B6">Roch <italic>et al.</italic>, 2003</xref>). The experiment assumes that cells are ‘synchronized’ at each time-point, but the synchronization is not perfect due to experimental limitations. As a consequence, we expect a large number to nucleosomes to exhibit a ‘fuzzy’ behavior.</p>
    <p>First, we performed nucleosome placement with the same setup as with the yeast dataset. The distribution of fragment sizes is quite different in this case (<xref ref-type="fig" rid="F8">Fig. 8</xref>). NO<sc>r</sc>MAL reports fragment sizes with a mean value of 105 bp and mode value of about 120 bp, whereas TF reports a distribution with mean and mode of about 84 bp. If we perform the matching of the reported nucleosomes, the distribution of distances is much wider than for yeast (<xref ref-type="fig" rid="F7">Fig. 7</xref>). Now only 50% of all detected nucleosomes are in common between two methods. A total of 32.38 and 17.62% are unique to NO<sc>r</sc>MAL and TF, respectively. As expected, the disagreement between NO<sc>r</sc>MAL and TF is much higher on this dataset, due to presence of a much higher fraction of overlapping/fuzzy nucleosomes.
<fig id="F7" position="float"><label>Fig. 7.</label><caption><p>Distribution of distances between corresponding nucleosomes reported by TF (range [80,200]) and NO<sc>r</sc>MAL for <italic>P. falciparum</italic> (chromosome 1) across all seven time-points</p></caption><graphic xlink:href="bts206f7"/></fig>
<fig id="F8" position="float"><label>Fig. 8.</label><caption><p>Size distribution of reported nucleosomes for <italic>P. falciparum</italic> (chromosome 1) across all seven time-points</p></caption><graphic xlink:href="bts206f8"/></fig></p>
    <p>Two examples of the disagreement between TF and NO<sc>r</sc>MAL are shown in <xref ref-type="fig" rid="F9">Figure 9</xref>. Forward and reverse coverage profiles with extension to 35 bp are shown on top. Nucleosomes are represented by ovals, where the height of each oval represents the confidence score. NO<sc>r</sc>MAL also reports the variance associated with the left and the right boundary, represented with error bars. In <xref ref-type="fig" rid="F9">Figure 9</xref> (top), we have labeled corresponding nucleosomes 1–6. Some observations are in order. First, nucleosome 3 is an incarnation of the synthetic example in <xref ref-type="fig" rid="F4">Figure 4</xref>D and E. The coverage profile around coordinate 800 shows two heavily overlapping nucleosomes that should be reported as one ‘fuzzy’ nucleosome. However, TF reports the position of the nucleosome using the stronger pair of forward/reverse peaks and completely ignores the other pair of peaks. As a consequence, the coordinate of the reported nucleosome is shifted compared to the centroid of the four peaks. NO<sc>r</sc>MAL instead correctly places one nucleosome at the centroid with a relatively high ‘fuzziness’ score. Nucleosome 3 is also quite fuzzy, and it is better placed by NO<sc>r</sc>MAL. Some disagreement exists on nucleosome 6 as well. The left boundary of that nucleosome detected by TF correspond to a very weak peak. This is due to the fact that TFs placement is based on the correlation score rather than the intensity of the peak. In fairness, both methods assign nucleosome 6 a very low confidence score. Finally, TF detects additional nucleosomes a and b, whereas NO<sc>r</sc>MAL reports additional nucleosome c. All these nucleosomes have low confidence scores. Our method did not report a and b because it explained the data using fuzzy nucleosome 2. NO<sc>r</sc>MAL should have merged nucleosome c to nucleosome 1, but because the overlap did not exceed the chosen threshold those two nucleosomes were not merged.
<fig id="F9" position="float"><label>Fig. 9.</label><caption><p>Two examples of nucleosome maps for chromosome 1 of <italic>P. falciparum</italic> (top: ‘0’ is location 148 500 bp, bottom: ‘0’ is location 111 500 bp): forward and reverse coverage profiles are shown on top; nucleosomes are represented by ovals where the height of each nucleosome represents the confidence score</p></caption><graphic xlink:href="bts206f9"/></fig></p>
    <p><xref ref-type="fig" rid="F9">Figure 9</xref> (bottom) illustrates a more complex example of the coverage profile: even for trained experts placing nucleosomes here would be very challenging. The output of NO<sc>r</sc>MAL and TF are quite consistent for nucleosomes associated to strong peaks. In the regions with high density of peaks, TF tends to place nucleosomes of small sizes (see also <xref ref-type="fig" rid="F10">Fig. 10</xref>) and pack them as tight as possible according to allowed overlapping threshold.
<fig id="F10" position="float"><label>Fig. 10.</label><caption><p>Size distribution of reported nucleosomes for <italic>P. falciparum</italic> (chromosome 1) across all seven time-points</p></caption><graphic xlink:href="bts206f10"/></fig></p>
    <p>In order to increase the agreement between TF and NO<sc>r</sc>MAL, we tried to extend the range of nucleosome sizes for TF to [20,250]. The new fragment size distributions are shown on <xref ref-type="fig" rid="F10">Figure 10</xref>. Observe that by comparing <xref ref-type="fig" rid="F8">Figures 8</xref> and <xref ref-type="fig" rid="F10">10</xref>, the size distribution for NO<sc>r</sc>MAL are the same (only truncated in <xref ref-type="fig" rid="F8">Fig. 8</xref>), while the distribution for TF has changed completely, again pointing out how this range parameter can drastically change the results. Using the extended range, TF was allowed to place smaller nucleosomes so the mode and the mean of the size distribution shifted to smaller values. According to the authors of TF, such small nucleosomes can be due to problems in the experimental procedure, namely overexposing the sample to the MNase digestion. However, the gel electrophoresis analysis shows that the expected size of sequenced fragments in our samples after digestion was about 130 bp in length (without adapters). We speculate that TFs approach might have a problem when the range of admissible nucleosome sizes is too wide, and the algorithm confuses boundaries of neighboring nucleosomes.</p>
    <p>The number of reported nucleosomes for all time-points is shown in <xref ref-type="table" rid="T3">Table 3</xref>. Observe that for time-points 0–24 h, the number of nucleosomes reported by NO<sc>r</sc>MAL is between TF with range [80,200] and [20,250]. However, recall that the extended range [20,250] is likely to be unreliable. For time-point 30 and 36 h, NO<sc>r</sc>MAL identifies a higher number of nucleosomes. The 30 and 36 h marks correspond to the schizont stage of the <italic>P. falciparum</italic> life cycle (<xref ref-type="bibr" rid="B6">Roch <italic>et al.</italic>, 2003</xref>). During this stage, the parasites divide, the chromatin compacts and a large number of nucleosomes are added.
<table-wrap id="T3" position="float"><label>Table 3.</label><caption><p>Number of nucleosomes reported for <italic>P. falciparum</italic> (chromosome 1) for different time-points (TF, parameter in square brackets is the range of admissible nucleosome sizes, bold numbers indicate the maximum)</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Time (h)</th><th rowspan="1" colspan="1">TF [80–200]</th><th rowspan="1" colspan="1">TF [20–250]</th><th rowspan="1" colspan="1">NO<sc>r</sc>MAL</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">1 720</td><td rowspan="1" colspan="1"><bold>2 031</bold></td><td rowspan="1" colspan="1">1 934</td></tr><tr><td rowspan="1" colspan="1">6</td><td rowspan="1" colspan="1">1 491</td><td rowspan="1" colspan="1"><bold>1 826</bold></td><td rowspan="1" colspan="1">1 720</td></tr><tr><td rowspan="1" colspan="1">12</td><td rowspan="1" colspan="1">1 461</td><td rowspan="1" colspan="1"><bold>2 158</bold></td><td rowspan="1" colspan="1">2 043</td></tr><tr><td rowspan="1" colspan="1">18</td><td rowspan="1" colspan="1">1 185</td><td rowspan="1" colspan="1"><bold>1 665</bold></td><td rowspan="1" colspan="1">1 537</td></tr><tr><td rowspan="1" colspan="1">24</td><td rowspan="1" colspan="1">1 440</td><td rowspan="1" colspan="1"><bold>1 910</bold></td><td rowspan="1" colspan="1">1 766</td></tr><tr><td rowspan="1" colspan="1">30</td><td rowspan="1" colspan="1">1 723</td><td rowspan="1" colspan="1">2 229</td><td rowspan="1" colspan="1"><bold>2 443</bold></td></tr><tr><td rowspan="1" colspan="1">36</td><td rowspan="1" colspan="1">1 701</td><td rowspan="1" colspan="1">2 514</td><td rowspan="1" colspan="1"><bold>2 788</bold></td></tr></tbody></table></table-wrap>
</p>
  </sec>
  <sec id="SEC4">
    <title>4 CONCLUSION</title>
    <p>We described a parametric probabilistic model for nucleosomes positioning framed in the context on a modified Gaussian mixture model. Our method directly addresses the challenges imposed by overlapping and fuzzy nucleosomes, their detection and the inference of their characteristics. We demonstrated with a synthetic example that the current state-of-the-art method does not properly handle complex overlapping configurations. We have also shown that NO<sc>r</sc>MAL is significantly more robust to user-defined parameters. On real data, our method detects a higher number of nucleosomes. Although our method is currently slower than TF, the processing time is still modest compared to other steps in the sequencing pipeline and we believe the efficiency of NO<sc>r</sc>MAL can be improved.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGMENTS</title>
    <p>We thank Prof. Christian Shelton (UC Riverside) for helpful discussions on the EM algorithm. We would also like to thank the three anonymous reviewers for their constructive suggestions.</p>
    <p><italic>Funding</italic>: <funding-source>National Science Foundation</funding-source> [grant <award-id>DBI-1062301</award-id>]; <funding-source>National Institutes of Health</funding-source> [grant <award-id>R01 AI85077-01A1</award-id>].</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Albert</surname>
            <given-names>I.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Translational and rotational settings of H2A.Z nucleosomes across the<italic>Saccharomyces cerevisiae</italic>genome</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>446</volume>
        <fpage>572</fpage>
        <lpage>576</lpage>
        <pub-id pub-id-type="pmid">17392789</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Allan</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Micrococcal nuclease does not substantially bias nucleosome mapping</article-title>
        <source>J. Mol. Biol.</source>
        <year>2012</year>
        <volume>417</volume>
        <fpage>152</fpage>
        <lpage>164</lpage>
        <pub-id pub-id-type="pmid">22310051</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Field</surname>
            <given-names>Y.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Distinct modes of regulation by chromatin encoded through nucleosome positioning signals</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2008</year>
        <volume>4</volume>
        <fpage>e1000216</fpage>
        <pub-id pub-id-type="pmid">18989395</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Field</surname>
            <given-names>Y.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene expression divergence in yeast is coupled to evolution of DNA-encoded nucleosome organization</article-title>
        <source>Nat. Genet.</source>
        <year>2009</year>
        <volume>41</volume>
        <fpage>438</fpage>
        <lpage>445</lpage>
        <pub-id pub-id-type="pmid">19252487</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kaplan</surname>
            <given-names>N.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The DNA-encoded nucleosome organization of a eukaryotic genome</article-title>
        <source>Nature</source>
        <year>2009</year>
        <volume>458</volume>
        <fpage>362</fpage>
        <lpage>366</lpage>
        <pub-id pub-id-type="pmid">19092803</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Le Roch</surname>
            <given-names>K.G.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Discovery of gene function by expression profiling of the malaria parasite life cycle</article-title>
        <source>Science</source>
        <year>2003</year>
        <volume>301</volume>
        <fpage>1503</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="pmid">12893887</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mavrich</surname>
            <given-names>T.N.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A barrier nucleosome model for statistical positioning of nucleosomes throughout the yeast genome</article-title>
        <source>Genome Res.</source>
        <year>2008a</year>
        <volume>18</volume>
        <fpage>1073</fpage>
        <lpage>1083</lpage>
        <pub-id pub-id-type="pmid">18550805</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mavrich</surname>
            <given-names>T.N.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nucleosome organization in the drosophila genome</article-title>
        <source>Nature</source>
        <year>2008b</year>
        <volume>453</volume>
        <fpage>358</fpage>
        <lpage>362</lpage>
        <pub-id pub-id-type="pmid">18408708</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parzen</surname>
            <given-names>E.</given-names>
          </name>
        </person-group>
        <article-title>On estimation of a probability density function and mode</article-title>
        <source>Ann. Math. Stat.</source>
        <year>1962</year>
        <volume>33</volume>
        <fpage>1065</fpage>
        <lpage>1076</lpage>
      </element-citation>
    </ref>
    <ref id="B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ponts</surname>
            <given-names>N.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nucleosome landscape and control of transcription in the human malaria parasite</article-title>
        <source>Genome Res.</source>
        <year>2010</year>
        <volume>20</volume>
        <fpage>228</fpage>
        <lpage>238</lpage>
        <pub-id pub-id-type="pmid">20054063</pub-id>
      </element-citation>
    </ref>
    <ref id="B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ponts</surname>
            <given-names>N.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nucleosome occupancy at transcription start sites in the human malaria parasite: A hard-wired evolution of virulence?</article-title>
        <source>Infect. Genet. Evol.</source>
        <year>2011</year>
        <volume>11</volume>
        <fpage>716</fpage>
        <lpage>724</lpage>
        <pub-id pub-id-type="pmid">20708104</pub-id>
      </element-citation>
    </ref>
    <ref id="B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sasaki</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Chromatin-associated periodicity in genetic variation downstream of transcriptional start sites</article-title>
        <source>Science</source>
        <year>2009</year>
        <volume>323</volume>
        <fpage>401</fpage>
        <lpage>404</lpage>
        <pub-id pub-id-type="pmid">19074313</pub-id>
      </element-citation>
    </ref>
    <ref id="B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shivaswamy</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dynamic remodeling of individual nucleosomes across a eukaryotic genome in response to transcriptional perturbation</article-title>
        <source>Plos Biol.</source>
        <year>2008</year>
        <volume>6</volume>
        <fpage>e65</fpage>
        <pub-id pub-id-type="pmid">18351804</pub-id>
      </element-citation>
    </ref>
    <ref id="B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Valouev</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A high-resolution, nucleosome position map of<italic>C. elegans</italic>reveals a lack of universal sequence-dictated positioning</article-title>
        <source>Genome Res.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>1051</fpage>
        <lpage>1063</lpage>
        <pub-id pub-id-type="pmid">18477713</pub-id>
      </element-citation>
    </ref>
    <ref id="B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weiner</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>High-resolution nucleosome mapping reveals transcription-dependent promoter packaging</article-title>
        <source>Genome Res.</source>
        <year>2010</year>
        <volume>20</volume>
        <fpage>90</fpage>
        <lpage>100</lpage>
        <pub-id pub-id-type="pmid">19846608</pub-id>
      </element-citation>
    </ref>
    <ref id="B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zaret</surname>
            <given-names>K.</given-names>
          </name>
        </person-group>
        <article-title>Micrococcal nuclease analysis of chromatin structure</article-title>
        <source>Current Protocols in Molecular Biology.</source>
        <year>2005</year>
        <volume>69</volume>
        <fpage>21.1.1</fpage>
        <lpage>21.1.17</lpage>
      </element-citation>
    </ref>
    <ref id="B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Pugh</surname>
            <given-names>B.F.</given-names>
          </name>
        </person-group>
        <article-title>High-Resolution Genome-wide Mapping of the Primary Structure of Chromatin</article-title>
        <source>Cell</source>
        <year>2011</year>
        <volume>144</volume>
        <fpage>175</fpage>
        <lpage>186</lpage>
        <pub-id pub-id-type="pmid">21241889</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
