<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NPG//DTD XML Article//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName NPG_XML_Article.dtd?>
<?SourceDTD.Version 2.7.10?>
<?ConverterInfo.XSLTName nature2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id>
    <journal-title-group>
      <journal-title>Scientific Reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-2322</issn>
    <publisher>
      <publisher-name>Nature Publishing Group</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5037421</article-id>
    <article-id pub-id-type="pii">srep33964</article-id>
    <article-id pub-id-type="doi">10.1038/srep33964</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>FAMSA: Fast and accurate multiple sequence alignment of huge protein families</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Deorowicz</surname>
          <given-names>Sebastian</given-names>
        </name>
        <xref ref-type="corresp" rid="c1">a</xref>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Debudaj-Grabysz</surname>
          <given-names>Agnieszka</given-names>
        </name>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gudyś</surname>
          <given-names>Adam</given-names>
        </name>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <aff id="a1"><label>1</label><institution>Institute of Informatics, Silesian University of Technology</institution>, Akademicka 16, 44-100 Gliwice, <country>Poland</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="c1">
        <label>a</label>
        <email>sebastian.deorowicz@polsl.pl</email>
      </corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>09</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2016</year>
    </pub-date>
    <volume>6</volume>
    <elocation-id>33964</elocation-id>
    <history>
      <date date-type="received">
        <day>05</day>
        <month>04</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>31</day>
        <month>08</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2016, The Author(s)</copyright-statement>
      <copyright-year>2016</copyright-year>
      <copyright-holder>The Author(s)</copyright-holder>
      <license xmlns:xlink="http://www.w3.org/1999/xlink" license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <!--author-paid-->
        <license-p>This work is licensed under a Creative Commons Attribution 4.0 International License. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in the credit line; if the material is not included under the Creative Commons license, users will need to obtain permission from the license holder to reproduce the material. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p>
      </license>
    </permissions>
    <abstract>
      <p>Rapid development of modern sequencing platforms has contributed to the unprecedented growth of protein families databases. The abundance of sets containing hundreds of thousands of sequences is a formidable challenge for multiple sequence alignment algorithms. The article introduces FAMSA, a new progressive algorithm designed for fast and accurate alignment of thousands of protein sequences. Its features include the utilization of the longest common subsequence measure for determining pairwise similarities, a novel method of evaluating gap costs, and a new iterative refinement scheme. What matters is that its implementation is highly optimized and parallelized to make the most of modern computer platforms. Thanks to the above, quality indicators, i.e. sum-of-pairs and total-column scores, show FAMSA to be superior to competing algorithms, such as Clustal Omega or MAFFT for datasets exceeding a few thousand sequences. Quality does not compromise on time or memory requirements, which are an order of magnitude lower than those in the existing solutions. For example, a family of 415519 sequences was analyzed in less than two hours and required no more than 8 GB of RAM. FAMSA is available for free at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://sun.aei.polsl.pl/REFRESH/famsa">http://sun.aei.polsl.pl/REFRESH/famsa</ext-link>.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <p>Multiple sequence alignment (MSA) is one of the most important analyzes in molecular biology. Most algorithms use progressive heuristics<xref ref-type="bibr" rid="b1">1</xref> to solve the MSA problem. The scheme consists of three stages: (I) calculation of a similarity matrix for investigated sequences, (II) a guide tree construction, (III) greedy alignment according to the order given by the tree. Pairwise similarities can be established in various ways. Some algorithms use accurate although time-consuming methods, such as calculating pairwise alignments of the highest probability<xref ref-type="bibr" rid="b2">2</xref> or maximum expected accuracy<xref ref-type="bibr" rid="b3">3</xref>. Others employ approximated, yet faster approaches, e.g. tuple matching<xref ref-type="bibr" rid="b4">4</xref><xref ref-type="bibr" rid="b5">5</xref>. As the sizes of the protein families to be analyzed continue to increase, the necessity to calculate all pairwise similarities has become a bottleneck for alignment algorithms. Therefore, several attempts have been made to accelerate this stage. Kalign<xref ref-type="bibr" rid="b6">6</xref> and Kalign2<xref ref-type="bibr" rid="b7">7</xref> employ Wu-Manber<xref ref-type="bibr" rid="b8">8</xref> and Muth-Manber<xref ref-type="bibr" rid="b9">9</xref> fast string matching algorithms, respectively, for similarity measurements. This allows thousands of sequences to be aligned in a reasonable timespan. The idea was further extended by the authors of the presented research in Kalign-LCS<xref ref-type="bibr" rid="b10">10</xref>, which introduced the longest common subsequence to Kalign2 for similarity measurement. This improved both the alignment quality and the execution time. Nevertheless, in view of the most recent developments in high throughput sequencing, biologists are required to align protein families containing tens of thousands of members. Progressive algorithms which calculate and store all pairwise similarities could not be applied to the problems of such a size due to excessive time and memory requirements.</p>
  <p>PartTree, a divisive sequence clustering algorithm for building a guide tree without calculating all pairwise similarities<xref ref-type="bibr" rid="b11">11</xref>, was one of the ideas to tackle the problem. With average time complexity of <italic>O</italic>(<italic>k</italic> log <italic>k</italic>) and space complexity of <italic>O</italic>(<italic>k</italic>) (<italic>k</italic> being the number of sequences in the input set), PartTree was successfully adopted by MAFFT 6 package<xref ref-type="bibr" rid="b12">12</xref>. As a result tens of thousands of sequences could be aligned on a typical desktop computer. A different approach is presented in Clustal Omega<xref ref-type="bibr" rid="b13">13</xref>. It uses mBed, an algorithm for embedding sequences into a lower-dimensional space<xref ref-type="bibr" rid="b14">14</xref>, which requires only <italic>O</italic>(<italic>k</italic> log <italic>k</italic>) exact similarity values to approximate other values. Embedding is combined with sequence clustering with the use of <italic>K</italic>-means algorithm, which prevents the storage of the whole similarity matrix, and keeps memory requirements under control. Both MAFFT and Clustal Omega use tuple matching for similarity calculation.</p>
  <p>A different approach to large-scale alignments was introduced in UPP<xref ref-type="bibr" rid="b15">15</xref>. The algorithm creates a set of profile models on the basis of a subset of sequences referred to as a backbone. The backbone is then used in the process of aligning the remaining elements of the input set.</p>
  <p>While MAFFT, Clustal Omega, and UPP are computationally applicable for families of even 100 000 proteins, we show that the quality of the results for such problems is often unsatisfactory. This article presents FAMSA, a progressive multiple alignment algorithm, particularly suitable for large sets of sequences. Pairwise similarities are established, by analogy to Kalign-LCS, on the basis of the longest common subsequences (LCS). Unlike MAFFT and Clustal Omega, FAMSA calculates all pairwise similarities. The process is highly efficient due to the multithreaded, bit-parallel LCS algorithm suited for AVX extensions<xref ref-type="bibr" rid="b16">16</xref> of modern processors. Employing a memory-saving, single-linkage algorithm<xref ref-type="bibr" rid="b17">17</xref> for guide tree construction, reduces first-stage memory requirements to <italic>O</italic>(<italic>k</italic>). A novel, in-place algorithm of profile alignment which prevents memory reallocations during the progressive stage is an important factor contributing to the computational scalability of FAMSA. As a result, FAMSA is the fastest and most memory-efficient alignment software when large protein families are taken into account. FAMSA’s superiority was observed for sets ranging from thousands to half a million of sequences.</p>
  <p>FAMSA is not only efficient, but also very accurate thanks to a number of algorithmic features. They include LCS for similarity measurement, MIQS substitution matrix<xref ref-type="bibr" rid="b18">18</xref>, and a correction of gap penalties inspired by MUSCLE<xref ref-type="bibr" rid="b4">4</xref>. The penalties are additionally adjusted to the set size, which is a novel technique in alignment software, particularly useful in large sets of sequences. Misalignments during the progressive stage are fixed with a refinement scheme similar to the one included in QuickProbs 2<xref ref-type="bibr" rid="b19">19</xref>. Consequently, when sets of a few thousand or more sequences are considered, FAMSA is significantly more accurate than any other algorithm. Interestingly enough, the difference increases along with the growing number of sequences. For instance, for sets exceeding 25 000 proteins, FAMSA aligned 25–45% more columns in a correct manner than UPP or the most accurate variants of MAFFT or Clustal Omega. When the largest benchmark family containing 415 519 sequences was investigated, the difference was even more remarkable—FAMSA successfully restored three times more columns than its competitors, at a fraction of the required time and memory.</p>
  <p>The scalability of FAMSA was assessed on extHomFam, a new benchmark generated by analogy to HomFam<xref ref-type="bibr" rid="b13">13</xref>, by enriching Homstrad<xref ref-type="bibr" rid="b20">20</xref> with families from Pfam database<xref ref-type="bibr" rid="b21">21</xref>. It contains 380 sets of sizes ranging from 218 to 415 519 sequences. The abundance of numerous protein families (<italic>k</italic> &gt; 10000) makes extHomFam particularly representative for large-scale alignment problems, which are of crucial importance in the context of recent advances in high throughput sequencing.</p>
  <sec disp-level="1">
    <title>Methods</title>
    <p>Like other progressive algorithms, FAMSA consists of four stages:<list id="l1" list-type="roman-upper"><list-item><p>Calculation of pairwise similarities,</p></list-item><list-item><p>Determination of a guide tree,</p></list-item><list-item><p>Progressive profile merging according to the guide tree order,</p></list-item><list-item><p>Optional iterative refinement of the final profile.</p></list-item></list></p>
    <p>Detailed descriptions of the algorithm stages together with analyzes of time and space complexities are provided in the following subsections.</p>
    <sec disp-level="2">
      <title>Calculation of pairwise similarities</title>
      <p>The length of a longest common subsequence (LCS) is used in order to determine the pairwise similarities of sequences in the input set. The choice was motivated by the promising results of LCS application in previous studies<xref ref-type="bibr" rid="b10">10</xref><xref ref-type="bibr" rid="b22">22</xref>. Given two sequences, <italic>A</italic> and <italic>B</italic>, the length of an LCS is the maximal number of perfectly matching columns. This can be considered as an estimation of true pairwise alignment. To compensate the effect of LCS length being larger for longer sequences, the value is normalized by the indel distance (the number of single-symbol insertions and deletions necessary to transform one sequence into another). This distance approximates the misalignment cost, i.e. the number of gaps in the alignment, in which only perfect matches are allowed:</p>
      <p>
        <disp-formula id="eq1">
          <inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e240" xlink:href="srep33964-m1.jpg"/>
        </disp-formula>
      </p>
      <p>The LCS length can be computed using a straightforward dynamic programming (DP) rule<xref ref-type="bibr" rid="b23">23</xref>. Owing to the internal properties of the DP matrix, the calculation can be made using the bit-parallel manner. In this approach, <italic>w</italic> cells are computed at a time (<italic>w</italic> is a computer word size equal to 64 in modern architectures)<xref ref-type="bibr" rid="b24">24</xref>. The indel distance for the sequences <italic>A</italic> and <italic>B</italic> can be directly derived from the LCS length according to the formula:</p>
      <p>
        <disp-formula id="eq2">
          <inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e262" xlink:href="srep33964-m2.jpg"/>
        </disp-formula>
      </p>
      <p>where |<italic>S</italic>| denotes the length of the <italic>S</italic> sequence. The time complexity of the pairwise similarity calculation is:</p>
      <p>
        <disp-formula id="eq3">
          <inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e273" xlink:href="srep33964-m3.jpg"/>
        </disp-formula>
      </p>
      <p>under a reasonable assumption that <italic>w</italic> is comparable to or smaller than the longer sequence length.</p>
      <p>As modern computers are equipped with multi-core processors, FAMSA distributes the calculation of LCS lengths for different pairs of sequences to several computing threads. Moreover, the presented software makes use of vector operations provided by technologies like SSE, AVX, AVX 2<xref ref-type="bibr" rid="b16">16</xref>, which are supported by contemporary processors. This allows multiple pairs of sequences to be processed simultaneously by the same thread. Assuming that there are <italic>t</italic> processing threads, <italic>a</italic> words in a single AVX vector (2 for AVX, 4 for AVX 2, and 8 for the announced AVX-512), and that <italic>n</italic> denotes a sequence length, the total time complexity of the first stage can be expressed as:</p>
      <p>
        <disp-formula id="eq4">
          <inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e294" xlink:href="srep33964-m4.jpg"/>
        </disp-formula>
      </p>
      <p>Massively parallel architectures have become widespread in computationally demanding tasks. As FAMSA was designed for analyzing large protein families, it allows massively parallel devices, such as graphics processors, to be employed for the calculation of pairwise similarities. The procedure is implemented in OpenCL<xref ref-type="bibr" rid="b25">25</xref>, therefore it is suitable for GPUs manufactured by all main vendors, including NVidia and AMD. The distribution of LCS computation over thousands of graphics processor threads further increases the throughput of the first FAMSA stage. Yet, as is shown in the experimental part of the article, even without OpenCL, FAMSA is able to process hundreds of thousands of proteins in a very short time.</p>
    </sec>
    <sec disp-level="2">
      <title>Determination of the guide tree</title>
      <p>A number of algorithms for guide tree construction have been developed, e.g. NJ<xref ref-type="bibr" rid="b26">26</xref>, UPGMA<xref ref-type="bibr" rid="b27">27</xref>, or single-linkage<xref ref-type="bibr" rid="b28">28</xref>. FAMSA uses single-linkage for the following reasons:<list id="l2" list-type="bullet"><list-item><p>it can be computed incrementally, i.e. without storing the complete similarity matrix,</p></list-item><list-item><p>it is very fast, i.e. it can be completed in <italic>O</italic>(<italic>k</italic><sup>2</sup>) time using the SLINK algorithm<xref ref-type="bibr" rid="b17">17</xref>,</p></list-item><list-item><p>the results were of superior quality in the previous studies<xref ref-type="bibr" rid="b22">22</xref><xref ref-type="bibr" rid="b29">29</xref>.</p></list-item></list></p>
      <p>To benefit from the incremental property of SLINK, the first two stages of FAMSA are performed simultaneously, which restricts the memory footprint. In particular, tree generation requires only <italic>O</italic>(<italic>k</italic>) space in contrast to <italic>O</italic>(<italic>k</italic><sup>2</sup>), required by other guide tree construction algorithms like UPGMA. This is of crucial importance when huge protein families are investigated.</p>
    </sec>
    <sec disp-level="2">
      <title>Progressive construction of the alignment</title>
      <p>The progressive construction stage requires <italic>O</italic>(<italic>k</italic>) profile alignments, each computed by means of dynamic programming. At least half of these alignments are degenerated cases in which one or both profiles consist of a single sequence. Dynamic programming implementation can be simplified in those cases, hence specialized variants of the general DP procedure were prepared. This resulted in remarkable computation time savings for huge datasets, in which most profile alignments are made against a single sequence due to the structure of a guide tree.</p>
      <p>Several improvements in the classical computation rule were made in FAMSA to upgrade the quality of alignment as well as the processing speed. They were possible owing to the internal profile representation composed of three arrays storing:<list id="l3" list-type="bullet"><list-item><p>occurrence counters of each alphabet symbol in consecutive columns (32<italic>n</italic><sup>*</sup> computer words, with <italic>n</italic><sup>*</sup> being the profile length),</p></list-item><list-item><p>costs of alignment of consecutive columns to each possible alphabet symbol (also 32<italic>n</italic><sup>*</sup> computer words),</p></list-item><list-item><p>sequences in the <italic>gapped representation</italic>.</p></list-item></list></p>
      <p>While two former components were previously employed by alignment algorithms, e.g. Kalign, the gapped representation is, to the best of our knowledge, a novel technique. In this representation, two equal-sized arrays are stored for each sequence: (<italic>i</italic>) sequence symbols, (<italic>ii</italic>) the number of gaps present before the corresponding sequence symbol. Moreover, to quickly localize a symbol in a column, as well as to insert or remove gaps, dynamic position statistics are stored in an additional array. The space for the gapped sequence is approximately 13 times the length of the sequence (see <xref ref-type="fig" rid="f1">Fig. 1</xref> for example). The proposed profile representation allows a dynamic programming matrix to be computed rapidly and is memory frugal. The DP computation step for a pair of profiles takes</p>
      <p>
        <disp-formula id="eq5">
          <inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e396" xlink:href="srep33964-m5.jpg"/>
        </disp-formula>
      </p>
      <p>time, where <italic>n</italic><sub>1</sub>, <italic>n</italic><sub>2</sub> are the input profile lengths.</p>
      <p>The presence of gapped representation is especially useful when families containing tens of thousands of proteins are investigated. Other aligners construct a new profile by copying the sequences symbol by symbol, with occasional gap insertions, which tends to be a bottleneck for large-scale analyzes. This is not the case in FAMSA, where entire sequences are moved from the input profiles to the new profile and gaps are rapidly inserted by updating gap counters in corresponding arrays. The construction time of a new profile is:</p>
      <p>
        <disp-formula id="eq6">
          <inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e413" xlink:href="srep33964-m6.jpg"/>
        </disp-formula>
      </p>
      <p>where <italic>k</italic><sub>1</sub> and <italic>k</italic><sub>2</sub> are the number of sequences in both profiles, <italic>k</italic><sub>o</sub> = <italic>k</italic><sub>1</sub> + <italic>k</italic><sub>2</sub>, and <italic>n</italic><sub>o</sub> is the resulting profile length. Thus, the overall time of all profile constructions is:</p>
      <p>
        <disp-formula id="eq7">
          <inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e449" xlink:href="srep33964-m7.jpg"/>
        </disp-formula>
      </p>
      <p>where <italic>n</italic><sub>f</sub> is the final profile length.</p>
      <p>By adding the time of DP matrix calculation, the total time of this stage is obtained:</p>
      <p>
        <disp-formula id="eq8">
          <inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e462" xlink:href="srep33964-m8.jpg"/>
        </disp-formula>
      </p>
      <p>As profile alignments in the bottom part of the guide tree are independent, they can be performed in parallel. Therefore, to improve the computation time, FAMSA distributes profile alignments over multiple threads. It would also be possible to parallelize the dynamic programming computation and construction of a single profile. This is expected to be particularly beneficial for families of a million and more proteins. Nevertheless, this was not done in the current FAMSA version due to implementation complications and unavailability of such large sets in existing databases.</p>
    </sec>
    <sec disp-level="2">
      <title>Determination of gap types and costs</title>
      <p>Among numerous amino acid substitution matrices for dynamic programming calculation, MIQS was selected due to superior results reported in the recent study<xref ref-type="bibr" rid="b18">18</xref>. The gap costs are determined according to the classic affine penalty function, with a distinction between terminal and non-terminal gap open and gap extension costs, by analogy to MUSCLE<xref ref-type="bibr" rid="b4">4</xref>. In particular, four types of gaps are used:<list id="l4" list-type="bullet"><list-item><p>terminal gap open (<italic>T</italic><sub>o</sub>)—opens a sequence at the left end or opens a contiguous series of gaps at the right end of a sequence,</p></list-item><list-item><p>terminal gap extension (<italic>T</italic><sub>e</sub>)—extends a series of gaps inserted at the beginning or end of a sequence,</p></list-item><list-item><p>gap open (<italic>G</italic><sub>o</sub>)—opens a contiguous series of gaps inserted within a sequence,</p></list-item><list-item><p>gap extension (<italic>G</italic><sub>e</sub>)—extends a contiguous series of gaps inserted within a sequence.</p></list-item></list></p>
      <p>While the determination of the number of gaps and their types is straightforward in a pairwise alignment, it becomes problematic in MSA. Due to the fact that before aligning two profiles their sequences may have already contained gaps, the insertion of a column of gaps (either a single one or as the first one in a contiguous series of columns with gaps) does not always mean that exclusively gap opens have been inserted. Inserting only gap opens would result in an overestimation of their number. That is why the types of gaps within a column should be corrected.</p>
      <p><xref ref-type="fig" rid="f2">Figure 2</xref> demonstrates an example of the alignment of two profiles, <italic>X</italic> and <italic>Y</italic>. A column of gaps is to be inserted into profile <italic>X</italic> (the left part of the figure). The proper types of gaps together with the corrected gaps in the neighboring column are shown in the right part of the figure. The following situations must be considered during correction of the gaps:<list id="l5" list-type="bullet"><list-item><p><italic>S</italic><sub>1</sub>: there is a terminal gap open at the right side of the inserted one; hence, the inserted gap should be a terminal gap open, and the following gap should be transformed into a terminal gap extension,</p></list-item><list-item><p><italic>S</italic><sub>2</sub>: there is a terminal gap extension at the left side of the inserted one; hence, the inserted gap should also be a terminal gap extension,</p></list-item><list-item><p><italic>S</italic><sub>3</sub>: the inserted gap will be placed into the gap series, so it should be a gap extension,</p></list-item><list-item><p><italic>S</italic><sub>4</sub>: there is a gap open at the right side of the inserted one; hence, the inserted gap should be a gap open, and to prevent the occurrence of two gap opens one after the other, the second gap should turn into a gap extension,</p></list-item><list-item><p><italic>S</italic><sub>5</sub>: the inserted gap is to be placed within the series of residues as the only gap, so it should be gap open,</p></list-item><list-item><p><italic>S</italic><sub>6</sub>: there is a terminal gap open at the left side of the inserted one; hence, the inserted gap should be a terminal gap extension.</p></list-item></list></p>
      <p>The optimization of gap parameters and recognition of their influence on alignment accuracy is still the subject of intensive studies<xref ref-type="bibr" rid="b30">30</xref>. Various techniques have been proposed, e.g. adding a bonus score to a gap cost to enforce the alignment of distantly related sequences<xref ref-type="bibr" rid="b7">7</xref>. In our research, all gap costs (i.e. gap opens and gap extensions, both terminal and non-terminal) are multiplied by a factor related to the number of sequences in the input collection. This prevents unnecessary widening of alignments of large collections. The scaling factor is calculated as:</p>
      <p>
        <disp-formula id="eq9">
          <inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e563" xlink:href="srep33964-m9.jpg"/>
        </disp-formula>
      </p>
      <p>where <italic>g</italic><sub>l</sub> and <italic>g</italic><sub>d</sub> are two constants set by default to 45 and 7 (values chosen experimentally).</p>
      <p>The application of gap corrections and scaling leads to another modification of the traditional approach. It is usually assumed that the insertion of a gap column in to the first profile cannot be immediately followed by the insertion of a gap column in to the second profile. If some assumptions about the gap costs and substitution matrix values are made, it can be proved to be reasonable, i.e. such a situation never leads to the optimal alignment. Nevertheless, this does not hold true if the gap correction is applied. Therefore, it is checked whether consecutive insertions of gap columns in to both profiles render a higher-scored alignment. (The profile alignment score is the summed alignment score of each sequence pair).</p>
    </sec>
    <sec disp-level="2">
      <title>Iterative refinement</title>
      <p>The idea of an iterative refinement is to correct misalignments made in the early phase of the profile alignment. Several algorithms were proposed for this task, like REFINER<xref ref-type="bibr" rid="b31">31</xref> or the methods implemented in MMSA<xref ref-type="bibr" rid="b22">22</xref>, MSAProbs<xref ref-type="bibr" rid="b32">32</xref>. This problem was investigated in our recent paper<xref ref-type="bibr" rid="b19">19</xref>. It was shown that the classical methods do not work for sufficiently large collections of sequences. A column-oriented refinement was also proposed to improve the quality of alignments for collections up to 1000 sequences. In this approach, the algorithm scans the profile to localize columns that contain at least one gap. Then, it randomly selects one of such columns and splits the profile into two subprofiles, depending on the gap presence in the selected column. Empty columns are removed afterwards, and subprofiles are realigned. Finally, if new alignment is scored higher than the original one, it is accepted as the current solution.</p>
      <p>To simplify the time complexity analysis of the refinement, the input and the output profiles are assumed to be of comparable lengths (which is usually the case). A single refinement iteration requires</p>
      <p>
        <disp-formula id="eq10">
          <inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e595" xlink:href="srep33964-m10.jpg"/>
        </disp-formula>
      </p>
      <p>time, with <italic>n</italic><sub>*</sub> being the length of the shorter of the two profiles obtained after splitting the original profile.</p>
      <p>Preliminary analyzes showed the refinement to be particularly beneficial for smaller sets of sequences. For this reason, and to improve the processing time of large protein families, the refinement is applied only for <italic>k</italic> ≤ 1000. The number of iterations was experimentally set to 100.</p>
    </sec>
  </sec>
  <sec disp-level="1">
    <title>Results</title>
    <sec disp-level="2">
      <title>Benchmark selection</title>
      <p>An assessment of MSA algorithms was performed using benchmark datasets. The presence of high-quality, manually curated reference alignments allowed supervised accuracy measures to be calculated. They were sum-of-pairs (SP) and total-column (TC) scores, defined as fractions of correctly aligned symbol pairs and columns, respectively. The scores were determined with a use of QSCORE software<xref ref-type="bibr" rid="b33">33</xref>.</p>
      <p>Our aim was to propose an efficient and robust algorithm for the alignment of thousands of proteins. The largest available benchmarks contain sets of at most hundreds of sequences, with an exception of HomFam introduced by Sievers <italic>et al</italic>.<xref ref-type="bibr" rid="b13">13</xref>. HomFam consists of 92 families constructed by extending Homstrad reference alignments (only those having 5 or more sequences were taken into account) with corresponding families from Pfam database. This protocol results in large benchmark sets: 18 of them consist of more than 10 000 members (the number of reference sequences ranges from a few to a few tens, though).</p>
      <p>Since 2011, when HomFam was introduced, Pfam and Homstrad databases have demonstrated significant growth. Hence, we present the new benchmark, extHomFam, to carry out more extensive experiments. It was constructed according to the HomFam generation protocol, with several modifications. 399 high-quality alignments containing at least 3 proteins were selected from Homstrad (ver. 1 Apr 2015). By decreasing the threshold from 5, the larger benchmark could be obtained than the original HomFam. If two-protein families were also taken into account, extHomFam would be increased to 1013 sets, at the cost of positively biasing the TC score (with two reference sequences it becomes equal to SP). Therefore, pairwise-only alignments were excluded. Next, selected Homstrad sets were enriched with the corresponding Pfam (ver. 28) families. After removing duplicated sequences, sets of less than 200 proteins were filtered out to provide the final benchmark of 380 families. For convenience extHomFam was divided at thresholds <italic>k</italic> = 4000, 10000, and 25000 to obtain subsets named <italic>small</italic>, <italic>medium</italic>, <italic>large</italic>, and <italic>extra-large</italic>. Note, that sets of ~1000 sequences are usually referred to in the literature as large—our naming convention is intended to show size diversity. <italic>ABC_tran</italic>, the most numerous set in extHomFam, contains 415 519 sequences, which is the largest benchmark protein family available.</p>
      <p>The scalability of algorithms was evaluated on the 53 largest extHomFam families, containing at least 30000 sequences each. These sets were recursively downsampled to the desired sizes, with a guarantee of preserving sequences from reference alignments. This scheme has a valuable property: smaller sets are contained in larger ones, which reduces results variability.</p>
      <p>To evaluate the performance of the presented algorithm on smaller alignment problems, classic benchmarks, i.e. BAliBASE<xref ref-type="bibr" rid="b34">34</xref>, PREFAB<xref ref-type="bibr" rid="b4">4</xref>, OXBench-X<xref ref-type="bibr" rid="b35">35</xref>, and SABmark<xref ref-type="bibr" rid="b36">36</xref>, were also considered in the experiments.</p>
    </sec>
    <sec disp-level="2">
      <title>Competitive algorithms and system setup</title>
      <p>From among numerous sequence alignment algorithms, only those able to handle families of thousands of sequences were investigated on HomFam and extHomFam. They were MUSCLE<xref ref-type="bibr" rid="b4">4</xref>, Kalign2<xref ref-type="bibr" rid="b7">7</xref>, Kalign-LCS<xref ref-type="bibr" rid="b10">10</xref>, UPP<xref ref-type="bibr" rid="b15">15</xref>, Clustal Omega<xref ref-type="bibr" rid="b13">13</xref> and MAFFT<xref ref-type="bibr" rid="b37">37</xref>. MAFFT was analyzed in default configuration in which it calculates <italic>O</italic>(<italic>k</italic><sup>2</sup>) pairwise similarities, as well as -parttree and -dpparttree modes, especially suited for large sets of sequences due to lower computational requirements. Clustal Omega was executed with default parameters and with two combined iterations (-iter2), which delivered superior results in the previous studies<xref ref-type="bibr" rid="b13">13</xref><xref ref-type="bibr" rid="b38">38</xref>. MUSCLE in default mode was unfeasible for immense protein families, hence -maxiters2 variant was also considered. Details on execution parameters and program versions are given in the <xref ref-type="supplementary-material" rid="S1">Supplementary material</xref>.</p>
      <p>The experiments on smaller benchmarks (BAliBASE, PREFAB, OXBench-X, SABmark) included also top consistency-based algorithms: MSAProbs<xref ref-type="bibr" rid="b32">32</xref>, QuickProbs<xref ref-type="bibr" rid="b19">19</xref><xref ref-type="bibr" rid="b39">39</xref>, and GLProbs<xref ref-type="bibr" rid="b40">40</xref>.</p>
      <p>A workstation equipped with two 12-core Intel Xeon E5-2670v3 processors (clocked at 2.3 GHz), Nvidia Quadro M6000 graphic card (3072 cores clocked at 1.0 GHz), and 128 GB RAM was used for the experiments. To investigate the behavior of the algorithms on modern workstations and servers containing from a few to several tens of cores, all methods were run with 8 computing threads, unless stated otherwise. FAMSA was run in the CPU mode, except for the experiment on the algorithm scalability w.r.t. the number of CPU cores, where the GPU variant was additionally investigated.</p>
    </sec>
    <sec disp-level="2">
      <title>HomFam and extHomFam benchmark evaluation</title>
      <p>Following Sievers <italic>et al</italic>.<xref ref-type="bibr" rid="b13">13</xref>, HomFam was divided into three parts depending on the family size. As is shown in <xref ref-type="table" rid="t1">Table 1</xref>, for <italic>k</italic> ≤ 3000, FAMSA was inferior only to both Clustal Omega configurations. For <italic>k</italic> &gt; 3000, the presented algorithm took the lead in both measures, revealing its potential for large protein families. More importantly still, FAMSA was from several to hundreds of times faster than its competitors. For instance, it processed the entire HomFam in less than 12 minutes while Clustal-default and MAFFT-default required, respectively, 8 h 40 m and 2 h 30 m. An even greater difference was observed for Clustal-iter2, which completed the analyzes in over 51 hours. Interestingly enough, MAFFT-parttree and -dpparttree were also inferior to FAMSA. This is especially noteworthy because they calculate only selected pairwise similarities (usually <italic>O</italic>(<italic>k</italic>log <italic>k</italic>)) instead of the full matrix (<italic>O</italic>(<italic>k</italic><sup>2</sup>)).</p>
      <p>The experiments on extHomFam confirmed superior accuracy and execution time of FAMSA to scale well with the number of sequences (<xref ref-type="fig" rid="f3">Fig. 3</xref>; more detailed results are given in <xref ref-type="supplementary-material" rid="S1">Supplementary material</xref>). FAMSA was inferior to Clustal-iter2 by a small margin, and only on the <italic>small</italic> subset. For k &gt; 4000, it became the best aligner and, depending on the subset and quality measure, was followed by Clustal, MAFFT, or UPP. As MUSCLE and MAFFT -parttree rendered inferior results, they were excluded from <xref ref-type="fig" rid="f3">Fig. 3</xref>. Kalign2, Kalign-LCS, and MUSCLE did not complete the analyzes on <italic>extra-large</italic> due to excessive memory or time requirements. Clustal Omega and MAFFT-default failed to process, respectively, one and four largest extHomFam families (the missing MAFFT results were taken from -dpparttree variant, though). Advances in SP and TC measures of FAMSA over the competing software on <italic>medium</italic>, <italic>large</italic>, and <italic>extra-large</italic> subsets were assessed statistically with the use of the Wilcoxon signed-rank test with the Bonferroni-Holm correction for multiple testing. The differences are significant at <italic>α</italic> = 0.005; <italic>p</italic>-values for all pairwise comparisons can be found in <xref ref-type="table" rid="t2">Table 2</xref>.</p>
      <p>As can be seen in <xref ref-type="fig" rid="f3">Fig. 3</xref>, the quality advance of the presented software over other algorithms increased for consecutive subsets. For instance, on <italic>extra-large</italic>, FAMSA aligned in a proper manner approximately 25% more columns than UPP—the second best algorithm. A more detailed analysis of FAMSA accuracy compared to the competitors is given in <xref ref-type="fig" rid="f4">Fig. 4</xref>. Four extHomFam categories were further divided into 11 subsets of approximately 35 families. Selected statistical indicators (median, mean, 12.5th and 87.5th percentile) of absolute differences in SP and TC measures between FAMSA and other algorithms were plotted for each interval at <italic>k</italic> axis. Clearly, the number of test cases for which the presented software was superior to that made by the competitors, as well as the absolute advance in terms of quality, increases with the growing set size. This observation is supported by the scalability analysis performed on the 53 largest families (<italic>k</italic> ≥ 30000), randomly resampled to obtain less numerous sets. <xref ref-type="fig" rid="f5">Figure 5</xref> shows that FAMSA outrun the competitors when the number of proteins exceeded 5000. Importantly, the performance was hardly affected when more sequences were added. This might be caused by the bias of the guide trees towards reference sequences. Indeed, the following section shows that the reference sequences were slightly closer to each other in the guide trees than suggested by the random model. Nevertheless, this held for all analyzed algorithms, therefore can be considered as a property of the benchmark.</p>
      <p>The abundance of extremely large protein families makes extHomFam the most demanding benchmark in terms of computational resources. Apart from FAMSA, only MAFFT-dpparttree and -parttree were able to process all of its sets. Other algorithms either crashed due to memory requirements or were terminated on purpose when the processing time of a family was longer than 24 hours. (An exception was made only for Clustal-iter2 due to its superior quality results.) While MAFFT-default, MAFFT-dpparttree, UPP, and Clustal-default required from 50 to 188 hours, FAMSA finished the computations in less than 7 hours, which corresponds to 7- to 26-fold advance. Clustal-iter2 was an extreme case; it needed almost 1000 hours, and showed its combined iterations to be inapplicable for very large protein families. A more detailed analysis of the computational scalability of the presented algorithm is provided in <xref ref-type="fig" rid="f5">Fig. 5</xref>. It confirms that FAMSA is faster than MAFFT-default, Clustal Omega, and UPP by 1–2 orders of magnitude. The efficiency of the presented algorithm is due to the fast bit-parallel similarity computation and the in-place profile joining. Yet, as FAMSA calculates more distances than Clustal Omega and MAFFT-dpparttree (<italic>O</italic>(<italic>k</italic><sup>2</sup>) instead of <italic>O</italic>(<italic>k</italic> log <italic>k</italic>)), it might be expected to exceed competitor execution times for a sufficiently large <italic>k</italic>. To verify this, the algorithms were compared on <italic>ABC_tran</italic>, the largest family in extHomFam with 415 519 proteins. FAMSA processed this set in less than 2 hours. Clustal Omega crashed due to excessive memory requirements after 55 hours of calculations suggesting that the algorithm is dominated by stages other than similarity computation. The situation was different for MAFFT-dpparttree. Its execution time scaled better with the number of sequences, though it was still inferior to FAMSA by a factor of 2.5. Importantly enough, FAMSA required below 8 GB of RAM, while MAFFT-dpparttree needed 47 GB. For comparison, MAFFT-default and Clustal Omega failed to run on a 128 GB machine (the former demanded 318 GB just for storing the similarity matrix). In conclusion, the calculation of all pairwise similarities performed by FAMSA did not prevent it from being the fastest and most memory efficient aligner in the comparison–even for immense protein families.</p>
      <p>As FAMSA was designed to use all the available computational power, it takes advantage of multi-core architectures of contemporary computers. The ten largest protein families from extHomFam (all which contain at least 100 000 sequences: <italic>ABC_tran</italic>, <italic>gtp</italic>, <italic>HATPase_c</italic>, <italic>helicase_NC</italic>, <italic>kinase</italic>, <italic>mdd</italic>, <italic>response_reg</italic>, <italic>rvp</italic>, <italic>sdr</italic>, <italic>TyrKc</italic>) were selected to investigate the scalability of the algorithm stages with respect to the number of computing threads. The experiments also considered the variant of FAMSA in which similarity calculation was adapted for massively parallel architectures with a use of OpenCL. For convenience, processing times of <italic>ABC_tran</italic> were marked separately. As can be seen in <xref ref-type="fig" rid="f6">Fig. 6</xref>, when FAMSA was run serially, more than 90% of the execution time was related to stages I and II (the algorithm performs them simultaneously). Nevertheless, as pairwise similarities can be calculated independently, these stages scale noticeably better with the number of threads than the progressive construction. In particular, when more than 12 cores were involved, stage III of the algorithm started to be the bottleneck. This was also the case for the GPU FAMSA variant.</p>
    </sec>
    <sec disp-level="2">
      <title>Impact of guide tree computation method</title>
      <p>A single linkage method for guide tree determination was used in FAMSA owing to low memory requirements of the SLINK algorithm and superior quality results reported in the previous studies. Nevertheless, as the tree structure was shown to be of crucial importance for the analysis of large protein families<xref ref-type="bibr" rid="b41">41</xref>, alternative methods were examined. The first one was UPGMA<xref ref-type="bibr" rid="b27">27</xref>, which can be computed in <italic>O</italic>(<italic>k</italic><sup>2</sup>) time and space. The memory consumption is actually close to 2<italic>k</italic><sup>2</sup> bytes. This is equivalent to about 345 GB for the largest family (<italic>ABC_tran</italic>) making UPGMA unfeasible for immense sets of sequences. The performance of trees produced by Clustal Omega was also investigated in the experiments (FAMSA provides the user with the possibility to import external trees in the Newick format). Finally, we examined chained guide trees<xref ref-type="bibr" rid="b41">41</xref><xref ref-type="bibr" rid="b42">42</xref><xref ref-type="bibr" rid="b43">43</xref>. This method was the fastest, as it did not require calculation of sequence similarities.</p>
      <p>The comparison of the results for extHomFam is given in <xref ref-type="table" rid="t3">Table 3</xref>. As UPGMA was non-computable for <italic>ABC_tran</italic>, the results of the single linkage were considered in this case. The experimental results for chained trees were averaged for 21 trials.</p>
      <p>The experiments confirmed that the single linkage was superior in terms of alignment quality. The smallest, yet statistically significant advance (<italic>p</italic><sub>SP</sub> = 0.000011, <italic>p</italic><sub>TC</sub> = 0.000019), was observed when compared with UPGMA. This, together with memory efficiency, made the authors choose the single linkage for FAMSA. To provide a deeper insight into the structure of the trees rendered by different strategies, the Sackin index<xref ref-type="bibr" rid="b44">44</xref> was used, defined as the sum of heights of all leaves in the tree. <xref ref-type="fig" rid="f7">Figure 7</xref> shows the comparison of the normalized Sackin indexes (i.e. the Sackin indexes divided by the number of sequences in the family) for trees produced by FAMSA + single linkage, FAMSA + UPGMA, and Clustal Omega. The lines corresponding to perfectly balanced and imbalanced (i.e. chained) trees are also presented for convenience. It can be seen that the indexes for single linkage trees are noticeably higher than those for UPGMA and Clustal Omega. Interestingly enough, the normalized Sackin indexes for UPGMA and Clustal Omega trees are approximately twice as large as in the perfectly balanced case.</p>
      <p>The last experimental step involved the analysis of the guide tree structure in terms of the reference alignments coverage (<xref ref-type="table" rid="t4">Table 4</xref>). For each family the fraction of a guide tree covering reference sequences was calculated. It was defined as the number of leaves in the smallest part of the tree containing all reference sequences divided by the family size. The results were averaged over all families in the benchmark. The obtained fractions were then compared with a random model determined by performing a Monte Carlo simulation (1000 trials) for each guide tree. The trial involved a random selection of a sequence subset with the same cardinality as the reference alignment.</p>
      <p>Interestingly enough, the fractions for the single linkage were smaller than those for UPGMA and Clustal Omega. This was probably caused by single linkage trees being noticeably more imbalanced. It can also be seen that for all tree generation algorithms, fractions containing reference sequences were smaller than the corresponding Monte Carlo results (when analyzing the entire extHomFam, the difference varied from 0.14 to 0.19). This means that the reference sequences were located in the guide trees closer to each other than suggested by the random model.</p>
      <p>The same analysis was performed on the resampled sets employed for scalability experiments. The results coincide with the observations made for the entire benchmark.</p>
    </sec>
    <sec disp-level="2">
      <title>Classic benchmark evaluation</title>
      <p>For completeness, the accuracy of algorithms was investigated on classic benchmarks with families ranging from a few to approximately one hundred sequences (<xref ref-type="table" rid="t5">Table 5</xref>). As expected, consistency-based methods (QuickProbs 2, MSAProbs, and GLProbs) were superior to the competitors. When it comes to the non-consistency approaches, FAMSA was characterized by moderate performance on the majority of the benchmarks, except SABmark, on which it was the best. The analysis of execution times confirms that FAMSA is one of the fastest algorithms for low and moderately-sized sets, like those contained in the investigated benchmarks.</p>
    </sec>
  </sec>
  <sec disp-level="1">
    <title>Discussion</title>
    <p>The abundance of protein families containing hundreds of thousands of members imposes the development of algorithms computationally capable of aligning immense sets of sequences. The traditional progressive scheme was successfully modified by Clustal Omega and MAFFT aligners to eliminate its greatest bottleneck in large-scale analyzes—calculation of all pairwise similarities. Nevertheless, the experiments with FAMSA show that the computation of the entire similarity matrix with the use of LCS measure, combined with a memory-efficient single-linkage tree construction and in-place profile alignment, is orders of magnitude faster than the competing solutions. Importantly enough, this comes with superior alignment quality—FAMSA was significantly more accurate than Clustal Omega and MAFFT on sets of a few thousand and more sequences. <italic>ABC_tran</italic>, the largest among the investigated families containing 415 519 sequences, reveals the potential of the presented software. The set was processed by FAMSA within 2 hours in less than 8 GB of RAM, which is suitable for a typical laptop. In contrast, Clustal Omega crashed after 2 days of computations on a 128 GB machine due to excessive memory requirements. MAFFT in memory-efficient mode completed the analysis in 5 hours allocating 47 GB of RAM, yet only 5.7% of columns were successfully aligned, while FAMSA restored as much as 16.8%. No columns were aligned properly by UPP.</p>
    <p>The scalability of the presented algorithm in terms of the alignment quality as well as time and memory requirements, makes it applicable for protein families even of a million sequences—a no-go area for the competing software. Such families will likely be present in the Pfam database in the near future, as a consequence of advances in sequencing technologies. Importantly enough, the efficiency of FAMSA has the potential to be further improved. The natural option is the parallelization of the dynamic programming procedure at the profile construction stage; this appeared to be a bottleneck in the scalability tests. Another possibility could be better utilization of massively parallel architectures by optimizing the OpenCL code for GPUs or adapting it for Intel Xeon Phi co-processors.</p>
    <p>An alternative development direction concerns the alignment quality. Iterative refinement is one of the numerous techniques designed to improve accuracy. For computational reasons, it is performed by FAMSA on families of fewer than 1000 sequences, though. Some limited, less time-consuming refinement scheme could be applied also for larger sets of sequences. Other ideas include the introduction of profile Markov models or consistency. Until recently the latter was found infeasible for large families because of excessive computational requirements. However, our latest research<xref ref-type="bibr" rid="b19">19</xref> shows that consistency applied to a small, carefully selected fraction of sequences, may improve the alignment quality without compromising on the execution time. The experiments involved sets of up to a thousand of sequences. Accordingly, the scalability of the presented ideas to families two orders of magnitude larger is an open question. Moreover, designing a consistency scheme suitable for FAMSA is by no means an easy task.</p>
    <p>Another issue related to large-scale analyzes is an accuracy assessment, particularly the unavailability of reference sequences. Evaluating the quality of the alignment of 10 000 or more proteins on the basis of a reference containing only a small fraction of the members is the largest flaw of the experimental pipeline used in the current research. The authors believe that the progress in multiple alignment domain is likely to be facilitated with the development of new benchmark datasets containing more reference sequences.</p>
    <p>An interesting attempt into this direction is the recent work by Fox <italic>et al</italic>.<xref ref-type="bibr" rid="b45">45</xref>. The proposed ContTest benchmark predicts a contact map for some protein that has a known three-dimensional structure on the ground of the evaluated multiple sequence alignment. Then the contact map is compared with the known contact map for the same protein. The benchmark contains families up to 44 thousand sequences.</p>
    <p>FAMSA executables together with the source code are available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://github.com/refresh-bio/FAMSA">https://github.com/refresh-bio/FAMSA</ext-link>; extHomFam can be downloaded from <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://dx.doi.org/10.7910/DVN/BO2SVW">http://dx.doi.org/10.7910/DVN/BO2SVW</ext-link>. Web service for remote analyzes is under development.</p>
  </sec>
  <sec disp-level="1">
    <title>Additional Information</title>
    <p><bold>How to cite this article</bold>: Deorowicz, S. <italic>et al</italic>. FAMSA: Fast and accurate multiple sequence alignment of huge protein families. <italic>Sci. Rep.</italic><bold>6</bold>, 33964; doi: 10.1038/srep33964 (2016).</p>
  </sec>
  <sec sec-type="supplementary-material" id="S1">
    <title>Supplementary Material</title>
    <supplementary-material id="d33e37" content-type="local-data">
      <caption>
        <title>Supplementary Information</title>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep33964-s1.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>The work was supported by Polish National Science Centre under the projects DEC-2011/03/B/ST6/01588, DEC-2012/05/N/ST6/03158 and DEC-2015/17/B/ST6/01890 and by Silesian University of Technology under the project BK-263/RAu2/2015, performed using the infrastructure supported by POIG.02.03.01-24-099/13 grant: ‘GeCONiI—Upper Silesian Center for Computational Science and Engineering’.</p>
  </ack>
  <ref-list>
    <ref id="b1">
      <mixed-citation publication-type="journal"><name><surname>Chatzou</surname><given-names>M.</given-names></name><etal/>. <article-title>Multiple sequence alignment modeling: methods and applications</article-title>. <source>Brief. Bioinform.</source><pub-id pub-id-type="doi">10.1093/bib/bbv099</pub-id> (<year>2015</year>).</mixed-citation>
    </ref>
    <ref id="b2">
      <mixed-citation publication-type="journal"><name><surname>Thompson</surname><given-names>J. D.</given-names></name>, <name><surname>Higgins</surname><given-names>D. G.</given-names></name> &amp; <name><surname>Gibson</surname><given-names>T. J.</given-names></name>
<article-title>CLUSTAL W: improving the sensitivity of progressive multiple sequence alignment through sequence weighting, position-specific gap penalties and weight matrix choice</article-title>. <source>Nucleic Acids Res.</source>
<volume>22</volume>(22), <fpage>4673</fpage>–<lpage>4680</lpage> (<year>1994</year>).<pub-id pub-id-type="pmid">7984417</pub-id></mixed-citation>
    </ref>
    <ref id="b3">
      <mixed-citation publication-type="journal"><name><surname>Do</surname><given-names>Ch. B.</given-names></name>, <name><surname>Mahabhashyam</surname><given-names>M. S. P.</given-names></name>, <name><surname>Brudno</surname><given-names>M.</given-names></name> &amp; <name><surname>Batzoglou</surname><given-names>S.</given-names></name>
<article-title>ProbCons: Probabilistic consistency-based multiple sequence alignment</article-title>. <source>Genome Res.</source>
<volume>15</volume>(2), <fpage>330</fpage>–<lpage>340</lpage> (<year>2005</year>).<pub-id pub-id-type="pmid">15687296</pub-id></mixed-citation>
    </ref>
    <ref id="b4">
      <mixed-citation publication-type="journal"><name><surname>Edgar</surname><given-names>R. C.</given-names></name><article-title>MUSCLE: a multiple sequence alignment method with reduced time and space complexity</article-title>. <source>BMC Bioinformatics</source><volume>5</volume>, <fpage>113</fpage> (<year>2004</year>).<pub-id pub-id-type="pmid">15318951</pub-id></mixed-citation>
    </ref>
    <ref id="b5">
      <mixed-citation publication-type="journal"><name><surname>Notredame</surname><given-names>C.</given-names></name>, <name><surname>Higgins</surname><given-names>D. G.</given-names></name> &amp; <name><surname>Heringa</surname><given-names>J.</given-names></name>
<article-title>T-Coffee: A novel method for fast and accurate multiple sequence alignment</article-title>. <source>J. Mol. Biol.</source>
<volume>302</volume>(1), <fpage>205</fpage>–<lpage>217</lpage> (<year>2000</year>).<pub-id pub-id-type="pmid">10964570</pub-id></mixed-citation>
    </ref>
    <ref id="b6">
      <mixed-citation publication-type="journal"><name><surname>Lassmann</surname><given-names>T.</given-names></name> &amp; <name><surname>Sonnhammer</surname><given-names>E. L. L.</given-names></name>
<article-title>Kalign—an accurate and fast multiple sequence alignment algorithm</article-title>. <source>BMC Bioinformatics</source>
<volume>6</volume>, <fpage>298</fpage> (<year>2005</year>).<pub-id pub-id-type="pmid">16343337</pub-id></mixed-citation>
    </ref>
    <ref id="b7">
      <mixed-citation publication-type="journal"><name><surname>Lassmann</surname><given-names>T.</given-names></name>, <name><surname>Frings</surname><given-names>O.</given-names></name> &amp; <name><surname>Sonnhammer</surname><given-names>E. L. L.</given-names></name>
<article-title>Kalign2: high-performance multiple alignment of protein and nucleotide sequences allowing external features</article-title>. <source>Nucleic Acids Res.</source>
<volume>37</volume>, <fpage>858</fpage>–<lpage>865</lpage> (<year>2009</year>).<pub-id pub-id-type="pmid">19103665</pub-id></mixed-citation>
    </ref>
    <ref id="b8">
      <mixed-citation publication-type="journal"><name><surname>Wu</surname><given-names>S.</given-names></name> &amp; <name><surname>Manber</surname><given-names>U.</given-names></name>
<article-title>Fast text searching: allowing errors</article-title>. <source>Commun. ACM</source>
<volume>35</volume>(10), <fpage>83</fpage>–<lpage>91</lpage> (<year>1992</year>).</mixed-citation>
    </ref>
    <ref id="b9">
      <mixed-citation publication-type="other"><name><surname>Muth</surname><given-names>R.</given-names></name> &amp; <name><surname>Manber</surname><given-names>U.</given-names></name> Approximate multiple string search in <italic>Proceedings of the 7th Annual Symposium on Combinatorial Pattern Matching</italic>, 75–86 (1996).</mixed-citation>
    </ref>
    <ref id="b10">
      <mixed-citation publication-type="journal"><name><surname>Deorowicz</surname><given-names>S.</given-names></name>, <name><surname>Debudaj-Grabysz</surname><given-names>A.</given-names></name> &amp; <name><surname>Gudyś</surname><given-names>A.</given-names></name>
<article-title>Kalign-LCS—A More Accurate and Faster Variant of Kalign2 Algorithm for the Multiple Sequence Alignment Problem</article-title> in <source>Man-Machine Interactions 3</source>, AISC 242 (eds <name><surname>Gruca</surname><given-names>A.</given-names></name>
<etal/>.) <fpage>495</fpage>–<lpage>502</lpage> (Springer-Verlag, <year>2014</year>).</mixed-citation>
    </ref>
    <ref id="b11">
      <mixed-citation publication-type="journal"><name><surname>Katoh</surname><given-names>K.</given-names></name> &amp; <name><surname>Toh</surname><given-names>H.</given-names></name>
<article-title>PartTree: an algorithm to build an approximate tree from a large number of unaligned sequences</article-title>. <source>Bioinformatics</source>
<volume>23</volume>, <fpage>372</fpage>–<lpage>374</lpage> (<year>2007</year>).<pub-id pub-id-type="pmid">17118958</pub-id></mixed-citation>
    </ref>
    <ref id="b12">
      <mixed-citation publication-type="journal"><name><surname>Katoh</surname><given-names>K.</given-names></name> &amp; <name><surname>Toh</surname><given-names>H.</given-names></name>
<article-title>Recent developments in the MAFFT multiple sequence alignment program</article-title>. <source>Brief. Bioinform.</source>
<volume>9</volume>(4), <fpage>286</fpage>–<lpage>298</lpage> (<year>2008</year>).<pub-id pub-id-type="pmid">18372315</pub-id></mixed-citation>
    </ref>
    <ref id="b13">
      <mixed-citation publication-type="journal"><name><surname>Sievers</surname><given-names>F.</given-names></name><etal/>. <article-title>Fast, scalable generation of high-quality protein multiple sequence alignments using Clustal Omega</article-title>. <source>Mol. Syst. Biol.</source><volume>7</volume>, <fpage>539</fpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21988835</pub-id></mixed-citation>
    </ref>
    <ref id="b14">
      <mixed-citation publication-type="journal"><name><surname>Blackshields</surname><given-names>G.</given-names></name>, <name><surname>Sievers</surname><given-names>F.</given-names></name>, <name><surname>Shi</surname><given-names>W.</given-names></name>, <name><surname>Wilm</surname><given-names>A.</given-names></name> &amp; <name><surname>Higgins</surname><given-names>D. G.</given-names></name>
<article-title>Sequence embedding for fast construction of guide trees for multiple sequence alignment</article-title>. <source>Algorithm. Mol. Biol.</source>
<volume>5</volume>(1), <fpage>21</fpage> (<year>2010</year>).</mixed-citation>
    </ref>
    <ref id="b15">
      <mixed-citation publication-type="journal"><name><surname>Nguyen</surname><given-names>Np. D.</given-names></name>, <name><surname>Mirarab</surname><given-names>S.</given-names></name>, <name><surname>Kumar</surname><given-names>K.</given-names></name> &amp; <name><surname>Warnow</surname><given-names>T.</given-names></name>
<article-title>Ultra-large alignments using phylogeny-aware profiles</article-title>. <source>Genome Biol.</source>
<volume>16</volume>, <fpage>124</fpage> (<year>2015</year>).<pub-id pub-id-type="pmid">26076734</pub-id></mixed-citation>
    </ref>
    <ref id="b16">
      <mixed-citation publication-type="other">Intel Corporation, <italic>Intel 64 and IA-32 Architectures Software Developer’s Manual. Combined Volumes: 1, 2A, 2B, 2C, 3A, 3B, 3C and 3D</italic>
<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://www.intel.com/content/www/us/en/processors/architectures-software-developer-manuals.html">http://www.intel.com/content/www/us/en/processors/architectures-software-developer-manuals.html</ext-link>. (Accessed: 30th June 2016).</mixed-citation>
    </ref>
    <ref id="b17">
      <mixed-citation publication-type="journal"><name><surname>Sibson</surname><given-names>R.</given-names></name><article-title>SLINK: An optimally efficient algorithm for the single-link cluster method</article-title>. <source>Comput. J.</source><volume>16</volume>, <fpage>30</fpage>–<lpage>34</lpage> (<year>1973</year>).</mixed-citation>
    </ref>
    <ref id="b18">
      <mixed-citation publication-type="journal"><name><surname>Yamada</surname><given-names>K.</given-names></name> &amp; <name><surname>Tomii</surname><given-names>K.</given-names></name>
<article-title>Revisiting amino acid substitution matrices for identifying distantly related proteins</article-title>. <source>Bioinformatics</source>
<volume>30</volume>, <fpage>317</fpage>–<lpage>325</lpage> (<year>2014</year>).<pub-id pub-id-type="pmid">24281694</pub-id></mixed-citation>
    </ref>
    <ref id="b19">
      <mixed-citation publication-type="other"><name><surname>Gudyś</surname><given-names>A.</given-names></name> &amp; <name><surname>Deorowicz</surname><given-names>S.</given-names></name> QuickProbs 2: towards rapid construction of high-quality alignments of large protein families. Preprint available at: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://arxiv.org/abs/1512.07437">http://arxiv.org/abs/1512.07437</ext-link> (<year>2015</year>).</mixed-citation>
    </ref>
    <ref id="b20">
      <mixed-citation publication-type="journal"><name><surname>Mizuguchi</surname><given-names>K.</given-names></name>, <name><surname>Deane</surname><given-names>C. M.</given-names></name>, <name><surname>Blundell</surname><given-names>T. L.</given-names></name> &amp; <name><surname>Overington</surname><given-names>J. P.</given-names></name>
<article-title>HOMSTRAD: a database of protein structure alignments for homologous families</article-title>. <source>Protein Sci.</source>
<volume>7</volume>(11), <fpage>2469</fpage>–<lpage>2471</lpage> (<year>1998</year>).<pub-id pub-id-type="pmid">9828015</pub-id></mixed-citation>
    </ref>
    <ref id="b21">
      <mixed-citation publication-type="journal"><name><surname>Punta</surname><given-names>M.</given-names></name><etal/>. <article-title>The Pfam protein families database</article-title>. <source>Nucleic Acids Res.</source><volume>40</volume>(D1), <fpage>D281</fpage>–<lpage>D288</lpage> (<year>2012</year>).</mixed-citation>
    </ref>
    <ref id="b22">
      <mixed-citation publication-type="journal"><name><surname>Plyusnin</surname><given-names>I.</given-names></name> &amp; <name><surname>Holm</surname><given-names>L.</given-names></name>
<article-title>Comprehensive comparison of graph based multiple protein sequence alignment strategies</article-title>. <source>BMC Bioinformatics</source>
<volume>13</volume>, <fpage>64</fpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22540977</pub-id></mixed-citation>
    </ref>
    <ref id="b23">
      <mixed-citation publication-type="journal"><name><surname>Gusfield</surname><given-names>D.</given-names></name><source>Algorithms on Strings, Trees and Sequences</source> (Cambridge University Press, <year>1997</year>).</mixed-citation>
    </ref>
    <ref id="b24">
      <mixed-citation publication-type="other"><name><surname>Hyyrö</surname><given-names>H.</given-names></name> Bit-parallel LCS-length computation revisited in <italic>Proceedings of the 15th Australian Workshop on Combinatorial Algorithms</italic>, 16–27 (2004).</mixed-citation>
    </ref>
    <ref id="b25">
      <mixed-citation publication-type="other">Khronos Group, The open standard for parallel programming of heterogeneous systems. <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://www.khronos.org/opencl">https://www.khronos.org/opencl</ext-link>. (Accessed: 30th June 2016).</mixed-citation>
    </ref>
    <ref id="b26">
      <mixed-citation publication-type="journal"><name><surname>Saitou</surname><given-names>N.</given-names></name> &amp; <name><surname>Nei</surname><given-names>M.</given-names></name>
<article-title>The neighbor-joining method: a new method for reconstructing phylogenetic trees</article-title>. <source>Mol. Biol. Evol.</source>
<volume>4</volume>(4), <fpage>406</fpage>–<lpage>425</lpage> (<year>1987</year>).<pub-id pub-id-type="pmid">3447015</pub-id></mixed-citation>
    </ref>
    <ref id="b27">
      <mixed-citation publication-type="journal"><name><surname>Sokal</surname><given-names>R. R.</given-names></name> &amp; <name><surname>Michener</surname><given-names>C. D.</given-names></name>
<article-title>A statistical method for evaluating systematic relationships</article-title>. <source>Univ. Kans. Sci. Bull.</source>
<volume>38</volume>, <fpage>1409</fpage>–<lpage>1438</lpage> (<year>1958</year>).</mixed-citation>
    </ref>
    <ref id="b28">
      <mixed-citation publication-type="journal"><name><surname>Florek</surname><given-names>K.</given-names></name>, <name><surname>Łukaszewicz</surname><given-names>J.</given-names></name>, <name><surname>Perkal</surname><given-names>J.</given-names></name>, <name><surname>Steinhaus</surname><given-names>H.</given-names></name> &amp; <name><surname>Zubrzycki</surname><given-names>S.</given-names></name>
<article-title>Sur la liaison et la division des points d’un ensemble fini</article-title>. <source>Colloq Math</source>
<volume>2</volume>, <fpage>282</fpage>–<lpage>285</lpage> (<year>1951</year>).</mixed-citation>
    </ref>
    <ref id="b29">
      <mixed-citation publication-type="journal"><name><surname>Wheeler</surname><given-names>T. J.</given-names></name> &amp; <name><surname>Kececioglu</surname><given-names>J. D.</given-names></name>
<article-title>Multiple alignment by aligning alignments</article-title>. <source>Bioinformatics</source>
<volume>23</volume>(13), <fpage>i559</fpage>–<lpage>i568</lpage> (<year>2007</year>).<pub-id pub-id-type="pmid">17646343</pub-id></mixed-citation>
    </ref>
    <ref id="b30">
      <mixed-citation publication-type="journal"><name><surname>Edgar</surname><given-names>R. C.</given-names></name><article-title>Optimizing substitution matrix choice and gap parameters for sequence alignment</article-title><source>BMC Bioinformatics</source><volume>10</volume>, <fpage>396</fpage> (<year>2009</year>).<pub-id pub-id-type="pmid">19954534</pub-id></mixed-citation>
    </ref>
    <ref id="b31">
      <mixed-citation publication-type="journal"><name><surname>Chakrabarti</surname><given-names>S.</given-names></name><etal/>. <article-title>Refining multiple sequence alignments with conserved core regions</article-title>. <source>Nucleic Acids Res.</source><volume>34</volume>(9), <fpage>2598</fpage>–<lpage>2606</lpage> (<year>2006</year>).<pub-id pub-id-type="pmid">16707662</pub-id></mixed-citation>
    </ref>
    <ref id="b32">
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>Y.</given-names></name>, <name><surname>Schmidt</surname><given-names>B.</given-names></name> &amp; <name><surname>Maskell</surname><given-names>D. L.</given-names></name>
<article-title>MSAProbs: multiple sequence alignment based on pair hidden Markov models and partition function posterior probabilities</article-title>. <source>Bioinformatics</source>
<volume>26</volume>, <fpage>1958</fpage>–<lpage>1964</lpage> (<year>2010</year>).<pub-id pub-id-type="pmid">20576627</pub-id></mixed-citation>
    </ref>
    <ref id="b33">
      <mixed-citation publication-type="other"><name><surname>Edgar</surname><given-names>R. C.</given-names></name> QSCORE multiple alignment scoring software. <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://www.drive5.com/qscore">http://www.drive5.com/qscore</ext-link>. (Accessed: 30th June 2016).</mixed-citation>
    </ref>
    <ref id="b34">
      <mixed-citation publication-type="journal"><name><surname>Thompson</surname><given-names>J. D.</given-names></name>, <name><surname>Plewniak</surname><given-names>F.</given-names></name> &amp; <name><surname>Poch</surname><given-names>O.</given-names></name>
<article-title>BAliBASE: a benchmark alignment database for the evaluation of multiple alignment programs</article-title>. <source>Bioinformatics</source>
<volume>15</volume>(1), <fpage>87</fpage>–<lpage>88</lpage> (<year>1999</year>).<pub-id pub-id-type="pmid">10068696</pub-id></mixed-citation>
    </ref>
    <ref id="b35">
      <mixed-citation publication-type="journal"><name><surname>Raghava</surname><given-names>G.</given-names></name>, <name><surname>Searle</surname><given-names>G.</given-names></name>, <name><surname>Audley</surname><given-names>P.</given-names></name>, <name><surname>Barber</surname><given-names>J.</given-names></name> &amp; <name><surname>Barton</surname><given-names>G.</given-names></name>
<article-title>OXBench: A benchmark for evaluation of protein multiple sequence alignment accuracy</article-title>. <source>BMC Bioinformatics</source>
<volume>4</volume>(1), <fpage>47</fpage> (<year>2003</year>).<pub-id pub-id-type="pmid">14552658</pub-id></mixed-citation>
    </ref>
    <ref id="b36">
      <mixed-citation publication-type="journal"><name><surname>Walle</surname><given-names>I.</given-names></name>, <name><surname>Lasters</surname><given-names>I.</given-names></name> &amp; <name><surname>Wyns</surname><given-names>L.</given-names></name>
<article-title>SABmark—a benchmark for sequence alignment that covers the entire known fold space</article-title>. <source>Bioinformatics</source>
<volume>21</volume>(7), <fpage>1267</fpage>–<lpage>1268</lpage> (<year>2005</year>).<pub-id pub-id-type="pmid">15333456</pub-id></mixed-citation>
    </ref>
    <ref id="b37">
      <mixed-citation publication-type="journal"><name><surname>Katoh</surname><given-names>K.</given-names></name> &amp; <name><surname>Standley</surname><given-names>D. M.</given-names></name>
<article-title>MAFFT multiple sequence alignment software version 7: improvements in performance and usability</article-title>. <source>Mol. Biol. Evol.</source>
<volume>30</volume>, <fpage>772</fpage>–<lpage>780</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23329690</pub-id></mixed-citation>
    </ref>
    <ref id="b38">
      <mixed-citation publication-type="journal"><name><surname>Sievers</surname><given-names>F.</given-names></name>, <name><surname>Dinnen</surname><given-names>D.</given-names></name>, <name><surname>Wilm</surname><given-names>A.</given-names></name> &amp; <name><surname>Higgins</surname><given-names>D. G.</given-names></name>
<article-title>Making automated multiple alignments of very large numbers of protein sequences</article-title>. <source>Bioinformatics</source>
<volume>29</volume>, <fpage>989</fpage>–<lpage>995</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23428640</pub-id></mixed-citation>
    </ref>
    <ref id="b39">
      <mixed-citation publication-type="journal"><name><surname>Gudyś</surname><given-names>A.</given-names></name> &amp; <name><surname>Deorowicz</surname><given-names>S.</given-names></name>
<article-title>QuickProbs—A Fast Multiple Sequence Alignment Algorithm Designed for Graphics Processors</article-title>. <source>PLoS One</source>
<volume>9</volume>(7), <fpage>e103051</fpage> (<year>2014</year>).</mixed-citation>
    </ref>
    <ref id="b40">
      <mixed-citation publication-type="journal"><name><surname>Ye</surname><given-names>Y.</given-names></name><etal/>. <article-title>GLProbs: Aligning Multiple Sequences Adaptively</article-title>. <source>IEEE/ACM Trans. Comput. Biol. Bioinf.</source><volume>12</volume>, <fpage>67</fpage>–<lpage>78</lpage> (<year>2015</year>).</mixed-citation>
    </ref>
    <ref id="b41">
      <mixed-citation publication-type="journal"><name><surname>Boyce</surname><given-names>K.</given-names></name>, <name><surname>Sievers</surname><given-names>F.</given-names></name> &amp; <name><surname>Higgins</surname><given-names>D. G.</given-names></name>
<article-title>Simple chained guide trees give high-quality protein multiple sequence alignments</article-title>. <source>Proc. Nat. Acad. Sci. USA</source>
<volume>111</volume>(29), <fpage>10556</fpage>–<lpage>10561</lpage> (<year>2014</year>).<pub-id pub-id-type="pmid">25002495</pub-id></mixed-citation>
    </ref>
    <ref id="b42">
      <mixed-citation publication-type="journal"><name><surname>Boyce</surname><given-names>K.</given-names></name>, <name><surname>Sievers</surname><given-names>F.</given-names></name> &amp; <name><surname>Higgins</surname><given-names>D. G.</given-names></name>
<article-title>Reply to Tan <italic>et al</italic>.: Differences between real and simulated proteins in multiple sequence alignments</article-title>. <source>Proc. Nat. Acad. Sci. USA</source>
<volume>112</volume>(2), <fpage>E101</fpage> (<year>2015</year>).<pub-id pub-id-type="pmid">25564671</pub-id></mixed-citation>
    </ref>
    <ref id="b43">
      <mixed-citation publication-type="journal"><name><surname>Tan</surname><given-names>G.</given-names></name>, <name><surname>Gil</surname><given-names>M.</given-names></name>, <name><surname>Löytynoja</surname><given-names>A. P.</given-names></name>, <name><surname>Goldman</surname><given-names>N.</given-names></name> &amp; <name><surname>Dessimoz</surname><given-names>C.</given-names></name>
<article-title>Simple chained guide trees give poorer multiple sequence alignments than inferred trees in simulation and phylogenetic benchmarks</article-title>. <source>Proc. Nat. Acad. Sci. USA</source>
<volume>112</volume>, <fpage>E99</fpage>–<lpage>E100</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">25564672</pub-id></mixed-citation>
    </ref>
    <ref id="b44">
      <mixed-citation publication-type="journal"><name><surname>Sackin</surname><given-names>M. J.</given-names></name><article-title>“Good” and “bad” phenograms</article-title>. <source>Syst. Biol.</source><volume>21</volume>(2), <fpage>225</fpage>–<lpage>226</lpage> (<year>1972</year>).</mixed-citation>
    </ref>
    <ref id="b45">
      <mixed-citation publication-type="journal"><name><surname>Fox</surname><given-names>G.</given-names></name>, <name><surname>Sievers</surname><given-names>F.</given-names></name> &amp; <name><surname>Higgins</surname><given-names>D. G.</given-names></name>
<article-title>Using de novo protein structure predictions to measure the quality of very large multiple sequence alignments</article-title>. <source>Bioinformatics</source>
<volume>32</volume>(6), <fpage>814</fpage>–<lpage>820</lpage> (<year>2016</year>).<pub-id pub-id-type="pmid">26568625</pub-id></mixed-citation>
    </ref>
  </ref-list>
  <fn-group>
    <fn>
      <p><bold>Author Contributions</bold> S.D. and A.D.-G. designed the main part of the algorithm. A.G. and S.D. designed the GPU part of the algorithm. S.D., A.D.-G. and A.G. prepared the implementation. A.G. and S.D. designed and prepared the new benchmark. S.D. performed the experiments. S.D., A.G. and A.D.-G. drafted the manuscript and <xref ref-type="supplementary-material" rid="S1">Supplementary material</xref>. All authors read and approved the final manuscript.</p>
    </fn>
  </fn-group>
</back>
<floats-group>
  <fig id="f1">
    <label>Figure 1</label>
    <caption>
      <title>Illustration of gapped sequence representation of – – C A – – H – F – – – Q – G A C – – D L M – – – – F A – P – S.</title>
      <p>The ‘+’ symbol is a guard, present to simplify the implementation. The values of <italic>dps</italic> are computed according to the rule: <italic>dps</italic>[<italic>i</italic>] = <italic>dps</italic>[2<italic>i</italic>] + <italic>dps</italic>[2<italic>i</italic> + 1], provided that the necessary cells are present. Otherwise, they are calculated on the <italic>no</italic>_<italic>gaps</italic> and <italic>sequence</italic> vectors. For example, <italic>dps</italic>[8] is the number of symbols in <italic>sequence</italic> [0 … 1] (equal to 2), incremented by the number of gaps present just before these symbols, i.e. <italic>no</italic>_<italic>gaps</italic>[0] and <italic>no</italic>_<italic>gaps</italic>[1].</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep33964-f1"/>
  </fig>
  <fig id="f2">
    <label>Figure 2</label>
    <caption>
      <title>Example of how gap columns are inserted during profile alignment.</title>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep33964-f2"/>
  </fig>
  <fig id="f3">
    <label>Figure 3</label>
    <caption>
      <title>Comparison of algorithms on extHomFam.</title>
      <p>The solid bars (lower) represent TC scores, while the transparent ones (higher) —SP scores. For each subset, the algorithms were sorted in an increasing order according to the TC measure. Execution times are provided above the bars in an <italic>hours:minutes</italic> format.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep33964-f3"/>
  </fig>
  <fig id="f4">
    <label>Figure 4</label>
    <caption>
      <title>Absolute differences in SP (red) and TC (blue) scores between FAMSA and competing software for extHomFam subsets.</title>
      <p>Each interval at the horizontal axis contains approximately 35 families. Medians are represented as solid lines. Dashed lines indicate 12.5th and 87.5th percentiles (thus, filled areas contain 75% of the observations). Means are additionally given by circular (SP) and cross (TC) markers.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep33964-f4"/>
  </fig>
  <fig id="f5">
    <label>Figure 5</label>
    <caption>
      <title>Scalability of SP (dashed lines) and TC (solid lines) scores with respect to the number of sequences.</title>
      <p>Experiments were performed on the 53 largest extHomFam families, randomly resampled to obtain the desired set size. Processing times for selected values of <italic>k</italic> are provided as bar plots.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep33964-f5"/>
  </fig>
  <fig id="f6">
    <label>Figure 6</label>
    <caption>
      <title>Computational scalability of FAMSA with respect to the number of cores evaluated on the ten largest extHomFam families (<italic>k</italic> ≥ 100000).</title>
      <p>The algorithm stages are represented by different colors. Execution times of the largest set (<italic>ABC_tran</italic>) are marked with solid fill, the other families are printed in with transparency.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep33964-f6"/>
  </fig>
  <fig id="f7">
    <label>Figure 7</label>
    <caption>
      <title>The normalized Sackin indexes (Sackin indexes divided by the cardinality of input sets) for various guide tree computation methods.</title>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep33964-f7"/>
  </fig>
  <table-wrap position="float" id="t1">
    <label>Table 1</label>
    <caption>
      <title>Comparison of algorithms on HomFam.</title>
    </caption>
    <table frame="hsides" rules="groups" border="1">
      <colgroup>
        <col align="left"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
      </colgroup>
      <thead valign="bottom">
        <tr>
          <th rowspan="3" align="left" valign="bottom" charoff="50">Algorithm</th>
          <th colspan="3" align="center" valign="top" charoff="50">93 ≤ <italic>k</italic> ≤ 3000</th>
          <th colspan="3" align="center" valign="top" charoff="50">3000 &lt; <italic>k</italic> ≤ 10000</th>
          <th colspan="3" align="center" valign="top" charoff="50">10000 &lt; <italic>k</italic> ≤ 50157</th>
          <th colspan="3" align="center" valign="top" charoff="50">All</th>
        </tr>
        <tr>
          <th colspan="3" align="center" valign="top" charoff="50">41 families<hr/></th>
          <th colspan="3" align="center" valign="top" charoff="50">33 families<hr/></th>
          <th colspan="3" align="center" valign="top" charoff="50">18 families<hr/></th>
          <th colspan="3" align="center" valign="top" charoff="50">92 families<hr/></th>
        </tr>
        <tr>
          <th align="center" valign="top" charoff="50">SP</th>
          <th align="center" valign="top" charoff="50">TC</th>
          <th align="center" valign="top" charoff="50">time</th>
          <th align="center" valign="top" charoff="50">SP</th>
          <th align="center" valign="top" charoff="50">TC</th>
          <th align="center" valign="top" charoff="50">time</th>
          <th align="center" valign="top" charoff="50">SP</th>
          <th align="center" valign="top" charoff="50">TC</th>
          <th align="center" valign="top" charoff="50">time</th>
          <th align="center" valign="top" charoff="50">SP</th>
          <th align="center" valign="top" charoff="50">TC</th>
          <th align="center" valign="top" charoff="50">time</th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td align="left" valign="top" charoff="50">FAMSA</td>
          <td align="center" valign="top" charoff="50">83.2</td>
          <td align="center" valign="top" charoff="50">64.3</td>
          <td align="center" valign="top" charoff="50">
            <bold>34</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <bold>88.3</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <bold>71.3</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <bold>2:36</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <bold>79.4</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <bold>56.9</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <bold>8:25</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <bold>84.3</bold>
          </td>
          <td align="center" valign="top" charoff="50">65.4</td>
          <td align="center" valign="top" charoff="50">
            <bold>11:35</bold>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Clustal-iter2</td>
          <td align="center" valign="top" charoff="50">
            <bold>86.3</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <bold>71.5</bold>
          </td>
          <td align="center" valign="top" charoff="50">2:14:18</td>
          <td align="center" valign="top" charoff="50">85.0</td>
          <td align="center" valign="top" charoff="50">68.9</td>
          <td align="center" valign="top" charoff="50">14:33:00</td>
          <td align="center" valign="top" charoff="50">69.5</td>
          <td align="center" valign="top" charoff="50">48.3</td>
          <td align="center" valign="top" charoff="50">34:50:54</td>
          <td align="center" valign="top" charoff="50">82.5</td>
          <td align="center" valign="top" charoff="50">
            <bold>66.0</bold>
          </td>
          <td align="center" valign="top" charoff="50">51:38:12</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Clustal-default</td>
          <td align="center" valign="top" charoff="50">85.7</td>
          <td align="center" valign="top" charoff="50">70.8</td>
          <td align="center" valign="top" charoff="50">27:02</td>
          <td align="center" valign="top" charoff="50">82.7</td>
          <td align="center" valign="top" charoff="50">63.9</td>
          <td align="center" valign="top" charoff="50">2:24:36</td>
          <td align="center" valign="top" charoff="50">67.6</td>
          <td align="center" valign="top" charoff="50">46.4</td>
          <td align="center" valign="top" charoff="50">5:51:10</td>
          <td align="center" valign="top" charoff="50">81.1</td>
          <td align="center" valign="top" charoff="50">63.6</td>
          <td align="center" valign="top" charoff="50">8:42:50</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">MAFFT-default</td>
          <td align="center" valign="top" charoff="50">81.9</td>
          <td align="center" valign="top" charoff="50">64.0</td>
          <td align="center" valign="top" charoff="50">2:15</td>
          <td align="center" valign="top" charoff="50">80.8</td>
          <td align="center" valign="top" charoff="50">57.6</td>
          <td align="center" valign="top" charoff="50">23:55</td>
          <td align="center" valign="top" charoff="50">69.1</td>
          <td align="center" valign="top" charoff="50">46.2</td>
          <td align="center" valign="top" charoff="50">2:05:52</td>
          <td align="center" valign="top" charoff="50">79.0</td>
          <td align="center" valign="top" charoff="50">58.2</td>
          <td align="center" valign="top" charoff="50">2:32:02</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">MAFFT-parttree</td>
          <td align="center" valign="top" charoff="50">77.0</td>
          <td align="center" valign="top" charoff="50">55.2</td>
          <td align="center" valign="top" charoff="50">2:43</td>
          <td align="center" valign="top" charoff="50">72.4</td>
          <td align="center" valign="top" charoff="50">46.6</td>
          <td align="center" valign="top" charoff="50">15:38</td>
          <td align="center" valign="top" charoff="50">58.0</td>
          <td align="center" valign="top" charoff="50">33.0</td>
          <td align="center" valign="top" charoff="50">43:08</td>
          <td align="center" valign="top" charoff="50">71.6</td>
          <td align="center" valign="top" charoff="50">47.8</td>
          <td align="center" valign="top" charoff="50">1:01:29</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">MAFFT-dpparttree</td>
          <td align="center" valign="top" charoff="50">80.3</td>
          <td align="center" valign="top" charoff="50">61.2</td>
          <td align="center" valign="top" charoff="50">10:40</td>
          <td align="center" valign="top" charoff="50">79.0</td>
          <td align="center" valign="top" charoff="50">54.5</td>
          <td align="center" valign="top" charoff="50">57:41</td>
          <td align="center" valign="top" charoff="50">63.5</td>
          <td align="center" valign="top" charoff="50">37.8</td>
          <td align="center" valign="top" charoff="50">1:57:02</td>
          <td align="center" valign="top" charoff="50">76.5</td>
          <td align="center" valign="top" charoff="50">54.2</td>
          <td align="center" valign="top" charoff="50">3:05:23</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">UPP</td>
          <td align="center" valign="top" charoff="50">79.8</td>
          <td align="center" valign="top" charoff="50">62.0</td>
          <td align="center" valign="top" charoff="50">2:58:50</td>
          <td align="center" valign="top" charoff="50">81.8</td>
          <td align="center" valign="top" charoff="50">64.3</td>
          <td align="center" valign="top" charoff="50">6:45:21</td>
          <td align="center" valign="top" charoff="50">61.9</td>
          <td align="center" valign="top" charoff="50">42.2</td>
          <td align="center" valign="top" charoff="50">6:48:59</td>
          <td align="center" valign="top" charoff="50">77.0</td>
          <td align="center" valign="top" charoff="50">59.0</td>
          <td align="center" valign="top" charoff="50">16:33:10</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Kalign-LCS</td>
          <td align="center" valign="top" charoff="50">79.8</td>
          <td align="center" valign="top" charoff="50">61.3</td>
          <td align="center" valign="top" charoff="50">4:17</td>
          <td align="center" valign="top" charoff="50">80.6</td>
          <td align="center" valign="top" charoff="50">57.6</td>
          <td align="center" valign="top" charoff="50">1:31:45</td>
          <td align="center" valign="top" charoff="50">67.9</td>
          <td align="center" valign="top" charoff="50">44.4</td>
          <td align="center" valign="top" charoff="50">64:23:14</td>
          <td align="center" valign="top" charoff="50">77.8</td>
          <td align="center" valign="top" charoff="50">56.7</td>
          <td align="center" valign="top" charoff="50">65:59:16</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Kalign2</td>
          <td align="center" valign="top" charoff="50">77.4</td>
          <td align="center" valign="top" charoff="50">56.2</td>
          <td align="center" valign="top" charoff="50">7:04</td>
          <td align="center" valign="top" charoff="50">77.6</td>
          <td align="center" valign="top" charoff="50">57.1</td>
          <td align="center" valign="top" charoff="50">2:30:45</td>
          <td align="center" valign="top" charoff="50">64.8</td>
          <td align="center" valign="top" charoff="50">41.6</td>
          <td align="center" valign="top" charoff="50">97:48:46</td>
          <td align="center" valign="top" charoff="50">75.0</td>
          <td align="center" valign="top" charoff="50">53.7</td>
          <td align="center" valign="top" charoff="50">100:26:35</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">MUSCLE-default</td>
          <td align="center" valign="top" charoff="50">72.0</td>
          <td align="center" valign="top" charoff="50">53.2</td>
          <td align="center" valign="top" charoff="50">35:35:44</td>
          <td align="center" valign="top" charoff="50">—</td>
          <td align="center" valign="top" charoff="50">—</td>
          <td align="center" valign="top" charoff="50">—</td>
          <td align="center" valign="top" charoff="50">—</td>
          <td align="center" valign="top" charoff="50">—</td>
          <td align="center" valign="top" charoff="50">—</td>
          <td align="center" valign="top" charoff="50">—</td>
          <td align="center" valign="top" charoff="50">—</td>
          <td align="center" valign="top" charoff="50">—</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">MUSCLE-maxiters2</td>
          <td align="center" valign="top" charoff="50">71.8</td>
          <td align="center" valign="top" charoff="50">51.4</td>
          <td align="center" valign="top" charoff="50">12:35</td>
          <td align="center" valign="top" charoff="50">67.1</td>
          <td align="center" valign="top" charoff="50">41.6</td>
          <td align="center" valign="top" charoff="50">2:27:51</td>
          <td align="center" valign="top" charoff="50">40.6</td>
          <td align="center" valign="top" charoff="50">21.6</td>
          <td align="center" valign="top" charoff="50">30:35:03</td>
          <td align="center" valign="top" charoff="50">68.8</td>
          <td align="center" valign="top" charoff="50">42.1</td>
          <td align="center" valign="top" charoff="50">33:15:29</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <table-wrap position="float" id="t2">
    <label>Table 2</label>
    <caption>
      <title>Statistical significance of FAMSA advances over selected competitors on extHomFam; <italic>p</italic>-values were calculated using the Wilcoxon signed-rank test.</title>
    </caption>
    <table frame="hsides" rules="groups" border="1">
      <colgroup>
        <col align="left"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
      </colgroup>
      <thead valign="bottom">
        <tr>
          <th rowspan="2" align="left" valign="bottom" charoff="50">Algorithm</th>
          <th colspan="2" align="center" valign="top" charoff="50">
            <italic>medium</italic>
            <hr/>
          </th>
          <th colspan="2" align="center" valign="top" charoff="50">
            <italic>large</italic>
            <hr/>
          </th>
          <th colspan="2" align="center" valign="top" charoff="50">
            <italic>extra-large</italic>
            <hr/>
          </th>
        </tr>
        <tr>
          <th align="center" valign="top" charoff="50">SP</th>
          <th align="center" valign="top" charoff="50">TC</th>
          <th align="center" valign="top" charoff="50">SP</th>
          <th align="center" valign="top" charoff="50">TC</th>
          <th align="center" valign="top" charoff="50">SP</th>
          <th align="center" valign="top" charoff="50">TC</th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td align="left" valign="top" charoff="50">UPP</td>
          <td align="center" valign="top" charoff="50">&lt;10<sup>−9</sup></td>
          <td align="center" valign="top" charoff="50">&lt;10<sup>−8</sup></td>
          <td align="center" valign="top" charoff="50">&lt;10<sup>−7</sup></td>
          <td align="center" valign="top" charoff="50">0.00002</td>
          <td align="center" valign="top" charoff="50">&lt;10<sup>−6</sup></td>
          <td align="center" valign="top" charoff="50">0.00168</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Clustal-iter2</td>
          <td align="center" valign="top" charoff="50">&lt;10<sup>−8</sup></td>
          <td align="center" valign="top" charoff="50">&lt;10<sup>−7</sup></td>
          <td align="center" valign="top" charoff="50">&lt;10<sup>−7</sup></td>
          <td align="center" valign="top" charoff="50">&lt;10<sup>−5</sup></td>
          <td align="center" valign="top" charoff="50">0.00001</td>
          <td align="center" valign="top" charoff="50">0.00002</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Clustal-default</td>
          <td align="center" valign="top" charoff="50">&lt;10<sup>−12</sup></td>
          <td align="center" valign="top" charoff="50">&lt;10<sup>−11</sup></td>
          <td align="center" valign="top" charoff="50">&lt;10<sup>−8</sup></td>
          <td align="center" valign="top" charoff="50">&lt;10<sup>−6</sup></td>
          <td align="center" valign="top" charoff="50">&lt;10<sup>−7</sup></td>
          <td align="center" valign="top" charoff="50">&lt;10<sup>−6</sup></td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">MAFFT-default</td>
          <td align="center" valign="top" charoff="50">&lt;10<sup>−16</sup></td>
          <td align="center" valign="top" charoff="50">&lt;10<sup>−16</sup></td>
          <td align="center" valign="top" charoff="50">&lt;10<sup>−11</sup></td>
          <td align="center" valign="top" charoff="50">&lt;10<sup>−11</sup></td>
          <td align="center" valign="top" charoff="50">&lt;10<sup>−9</sup></td>
          <td align="center" valign="top" charoff="50">&lt;10<sup>−8</sup></td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">MAFFT-dpparttree</td>
          <td align="center" valign="top" charoff="50">&lt;10<sup>−20</sup></td>
          <td align="center" valign="top" charoff="50">&lt;10<sup>−20</sup></td>
          <td align="center" valign="top" charoff="50">&lt;10<sup>−14</sup></td>
          <td align="center" valign="top" charoff="50">&lt;10<sup>−13</sup></td>
          <td align="center" valign="top" charoff="50">&lt;10<sup>−11</sup></td>
          <td align="center" valign="top" charoff="50">&lt;10<sup>−11</sup></td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Kalign-LCS</td>
          <td align="center" valign="top" charoff="50">&lt;10<sup>−6</sup></td>
          <td align="center" valign="top" charoff="50">&lt;10<sup>−7</sup></td>
          <td align="center" valign="top" charoff="50">&lt;10<sup>−13</sup></td>
          <td align="center" valign="top" charoff="50">&lt;10<sup>−12</sup></td>
          <td align="center" valign="top" charoff="50">—</td>
          <td align="center" valign="top" charoff="50">—</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <table-wrap position="float" id="t3">
    <label>Table 3</label>
    <caption>
      <title>Comparison of guide tree construction algorithms on extHomFam.</title>
    </caption>
    <table frame="hsides" rules="groups" border="1">
      <colgroup>
        <col align="left"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
      </colgroup>
      <thead valign="bottom">
        <tr>
          <th rowspan="4" align="left" valign="bottom" charoff="50">Algorithm</th>
          <th colspan="3" align="center" valign="top" charoff="50">
            <italic>small</italic>
          </th>
          <th colspan="3" align="center" valign="top" charoff="50">
            <italic>medium</italic>
          </th>
          <th colspan="3" align="center" valign="top" charoff="50">
            <italic>large</italic>
          </th>
          <th colspan="3" align="center" valign="top" charoff="50">
            <italic>extra-large</italic>
          </th>
          <th colspan="3" align="center" valign="top" charoff="50"> </th>
        </tr>
        <tr>
          <th colspan="3" align="center" valign="top" charoff="50">200 &lt; <italic>k</italic> ≤ 4000</th>
          <th colspan="3" align="center" valign="top" charoff="50">4000 &lt; <italic>k</italic> ≤ 10000</th>
          <th colspan="3" align="center" valign="top" charoff="50">10000 &lt; <italic>k</italic> &lt; ≤ 25000</th>
          <th colspan="3" align="center" valign="top" charoff="50">25000 &lt; <italic>k</italic> ≤ 415519</th>
          <th colspan="3" align="center" valign="top" charoff="50">All</th>
        </tr>
        <tr>
          <th colspan="3" align="center" valign="top" charoff="50">113 families<hr/></th>
          <th colspan="3" align="center" valign="top" charoff="50">101 families<hr/></th>
          <th colspan="3" align="center" valign="top" charoff="50">96 families<hr/></th>
          <th colspan="3" align="center" valign="top" charoff="50">70 families<hr/></th>
          <th colspan="3" align="center" valign="top" charoff="50">380 families<hr/></th>
        </tr>
        <tr>
          <th align="center" valign="top" charoff="50">SP</th>
          <th align="center" valign="top" charoff="50">TC</th>
          <th align="center" valign="top" charoff="50">time</th>
          <th align="center" valign="top" charoff="50">SP</th>
          <th align="center" valign="top" charoff="50">TC</th>
          <th align="center" valign="top" charoff="50">time</th>
          <th align="center" valign="top" charoff="50">SP</th>
          <th align="center" valign="top" charoff="50">TC</th>
          <th align="center" valign="top" charoff="50">time</th>
          <th align="center" valign="top" charoff="50">SP</th>
          <th align="center" valign="top" charoff="50">TC</th>
          <th align="center" valign="top" charoff="50">time</th>
          <th align="center" valign="top" charoff="50">SP</th>
          <th align="center" valign="top" charoff="50">TC</th>
          <th align="center" valign="top" charoff="50">time</th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td align="left" valign="top" charoff="50">FAMSA + single linkage</td>
          <td align="center" valign="top" charoff="50">82.9</td>
          <td align="center" valign="top" charoff="50">71.5</td>
          <td align="center" valign="top" charoff="50">1:31</td>
          <td align="center" valign="top" charoff="50">
            <bold>82.8</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <bold>71.9</bold>
          </td>
          <td align="center" valign="top" charoff="50">8:14</td>
          <td align="center" valign="top" charoff="50">
            <bold>76.1</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <bold>60.8</bold>
          </td>
          <td align="center" valign="top" charoff="50">29:50</td>
          <td align="center" valign="top" charoff="50">
            <bold>66.3</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <bold>47.7</bold>
          </td>
          <td align="center" valign="top" charoff="50">6:19:10</td>
          <td align="center" valign="top" charoff="50">
            <bold>78.1</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <bold>64.5</bold>
          </td>
          <td align="center" valign="top" charoff="50">6:58:45</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">FAMSA + UPGMA</td>
          <td align="center" valign="top" charoff="50">
            <bold>83.6</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <bold>72.6</bold>
          </td>
          <td align="center" valign="top" charoff="50">1:09</td>
          <td align="center" valign="top" charoff="50">80.8</td>
          <td align="center" valign="top" charoff="50">69.0</td>
          <td align="center" valign="top" charoff="50">6:50</td>
          <td align="center" valign="top" charoff="50">73.6</td>
          <td align="center" valign="top" charoff="50">56.8</td>
          <td align="center" valign="top" charoff="50">28:29</td>
          <td align="center" valign="top" charoff="50">64.2</td>
          <td align="center" valign="top" charoff="50">45.6</td>
          <td align="center" valign="top" charoff="50">6:42:14</td>
          <td align="center" valign="top" charoff="50">76.8</td>
          <td align="center" valign="top" charoff="50">62.7</td>
          <td align="center" valign="top" charoff="50">7:18:42</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">FAMSA + chained</td>
          <td align="center" valign="top" charoff="50">77.4</td>
          <td align="center" valign="top" charoff="50">66.1</td>
          <td align="center" valign="top" charoff="50">2:50</td>
          <td align="center" valign="top" charoff="50">74.6</td>
          <td align="center" valign="top" charoff="50">62.1</td>
          <td align="center" valign="top" charoff="50">17:16</td>
          <td align="center" valign="top" charoff="50">64.6</td>
          <td align="center" valign="top" charoff="50">48.7</td>
          <td align="center" valign="top" charoff="50">45:25</td>
          <td align="center" valign="top" charoff="50">53.6</td>
          <td align="center" valign="top" charoff="50">35.4</td>
          <td align="center" valign="top" charoff="50">3:58:40</td>
          <td align="center" valign="top" charoff="50">69.0</td>
          <td align="center" valign="top" charoff="50">55.0</td>
          <td align="center" valign="top" charoff="50">5:04:11</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">FAMSA + Clustal Omega trees</td>
          <td align="center" valign="top" charoff="50">79.9</td>
          <td align="center" valign="top" charoff="50">67.5</td>
          <td align="center" valign="top" charoff="50">—</td>
          <td align="center" valign="top" charoff="50">78.9</td>
          <td align="center" valign="top" charoff="50">66.1</td>
          <td align="center" valign="top" charoff="50">—</td>
          <td align="center" valign="top" charoff="50">72.0</td>
          <td align="center" valign="top" charoff="50">55.3</td>
          <td align="center" valign="top" charoff="50">—</td>
          <td align="center" valign="top" charoff="50">60.0</td>
          <td align="center" valign="top" charoff="50">38.8</td>
          <td align="center" valign="top" charoff="50">—</td>
          <td align="center" valign="top" charoff="50">74.0</td>
          <td align="center" valign="top" charoff="50">58.8</td>
          <td align="center" valign="top" charoff="50">—</td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn id="t3-fn1">
        <p>Times are provided in the hours:minutes:seconds format. The largest family (<italic>ABC_tran</italic>) was analyzed using the single linkage instead of UPGMA due to memory requirements.</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
  <table-wrap position="float" id="t4">
    <label>Table 4</label>
    <caption>
      <title>The structure of the guide trees generated by different algorithms in terms of the coverage of reference alignments.</title>
    </caption>
    <table frame="hsides" rules="groups" border="1">
      <colgroup>
        <col align="left"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
      </colgroup>
      <thead valign="bottom">
        <tr>
          <th rowspan="2" align="left" valign="bottom" charoff="50">Dataset</th>
          <th colspan="3" align="center" valign="top" charoff="50">single linkage<hr/></th>
          <th colspan="3" align="center" valign="top" charoff="50">UPGMA<hr/></th>
          <th colspan="3" align="center" valign="top" charoff="50">Clustal Omega<hr/></th>
        </tr>
        <tr>
          <th align="center" valign="top" charoff="50">Sackin idx</th>
          <th align="center" valign="top" charoff="50">Ref. frac.</th>
          <th align="center" valign="top" charoff="50">MC frac.</th>
          <th align="center" valign="top" charoff="50">Sackin idx</th>
          <th align="center" valign="top" charoff="50">Ref. frac.</th>
          <th align="center" valign="top" charoff="50">MC frac.</th>
          <th align="center" valign="top" charoff="50">Sackin idx</th>
          <th align="center" valign="top" charoff="50">Ref. frac.</th>
          <th align="center" valign="top" charoff="50">MC frac.</th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td align="left" valign="top" charoff="50">
            <italic>small</italic>
          </td>
          <td align="center" valign="top" charoff="50">147.09</td>
          <td align="center" valign="top" charoff="50">0.624</td>
          <td align="center" valign="top" charoff="50">0.835</td>
          <td align="center" valign="top" charoff="50">21.30</td>
          <td align="center" valign="top" charoff="50">0.691</td>
          <td align="center" valign="top" charoff="50">0.879</td>
          <td align="center" valign="top" charoff="50">18.71</td>
          <td align="center" valign="top" charoff="50">0.726</td>
          <td align="center" valign="top" charoff="50">0.882</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">
            <italic>medium</italic>
          </td>
          <td align="center" valign="top" charoff="50">457.50</td>
          <td align="center" valign="top" charoff="50">0.627</td>
          <td align="center" valign="top" charoff="50">0.837</td>
          <td align="center" valign="top" charoff="50">28.63</td>
          <td align="center" valign="top" charoff="50">0.714</td>
          <td align="center" valign="top" charoff="50">0.883</td>
          <td align="center" valign="top" charoff="50">24.76</td>
          <td align="center" valign="top" charoff="50">0.726</td>
          <td align="center" valign="top" charoff="50">0.893</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">
            <italic>large</italic>
          </td>
          <td align="center" valign="top" charoff="50">941.30</td>
          <td align="center" valign="top" charoff="50">0.681</td>
          <td align="center" valign="top" charoff="50">0.842</td>
          <td align="center" valign="top" charoff="50">31.13</td>
          <td align="center" valign="top" charoff="50">0.675</td>
          <td align="center" valign="top" charoff="50">0.885</td>
          <td align="center" valign="top" charoff="50">25.90</td>
          <td align="center" valign="top" charoff="50">0.772</td>
          <td align="center" valign="top" charoff="50">0.895</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">
            <italic>extra-large</italic>
          </td>
          <td align="center" valign="top" charoff="50">3,440.74</td>
          <td align="center" valign="top" charoff="50">0.750</td>
          <td align="center" valign="top" charoff="50">0.857</td>
          <td align="center" valign="top" charoff="50">36.09</td>
          <td align="center" valign="top" charoff="50">0.697</td>
          <td align="center" valign="top" charoff="50">0.901</td>
          <td align="center" valign="top" charoff="50">29.39</td>
          <td align="center" valign="top" charoff="50">0.839</td>
          <td align="center" valign="top" charoff="50">0.910</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">All</td>
          <td align="center" valign="top" charoff="50">—</td>
          <td align="center" valign="top" charoff="50">0.662</td>
          <td align="center" valign="top" charoff="50">0.841</td>
          <td align="center" valign="top" charoff="50">—</td>
          <td align="center" valign="top" charoff="50">0.694</td>
          <td align="center" valign="top" charoff="50">0.886</td>
          <td align="center" valign="top" charoff="50">—</td>
          <td align="center" valign="top" charoff="50">0.758</td>
          <td align="center" valign="top" charoff="50">0.893</td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn id="t4-fn1">
        <p>Column “Sackin idx” presents the normalized Sackin indexes. Column “Ref. frac.” provides the fractions of guide trees covering all reference sequences. Column “MC frac.” Shows the fractions of guide trees covering randomly selected subsets of sequences, averaged over 1000 trials.</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
  <table-wrap position="float" id="t5">
    <label>Table 5</label>
    <caption>
      <title>Comparison of algorithms for small datasets.</title>
    </caption>
    <table frame="hsides" rules="groups" border="1">
      <colgroup>
        <col align="left"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
      </colgroup>
      <thead valign="bottom">
        <tr>
          <th rowspan="2" align="left" valign="bottom" charoff="50">Algorithm</th>
          <th colspan="3" align="center" valign="top" charoff="50">BAliBASE<hr/></th>
          <th colspan="2" align="center" valign="top" charoff="50">PREFAB<hr/></th>
          <th colspan="3" align="center" valign="top" charoff="50">OXBench-X<hr/></th>
          <th colspan="3" align="center" valign="top" charoff="50">SABmark<hr/></th>
        </tr>
        <tr>
          <th align="center" valign="top" charoff="50">SP</th>
          <th align="center" valign="top" charoff="50">TC</th>
          <th align="center" valign="top" charoff="50">time</th>
          <th align="center" valign="top" charoff="50">SP/TC</th>
          <th align="center" valign="top" charoff="50">time</th>
          <th align="center" valign="top" charoff="50">SP</th>
          <th align="center" valign="top" charoff="50">TC</th>
          <th align="center" valign="top" charoff="50">time</th>
          <th align="center" valign="top" charoff="50">SP</th>
          <th align="center" valign="top" charoff="50">TC</th>
          <th align="center" valign="top" charoff="50">time</th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td align="left" valign="top" charoff="50">QuickProbs 2</td>
          <td align="center" valign="top" charoff="50">88.0</td>
          <td align="center" valign="top" charoff="50">61.7</td>
          <td align="center" valign="top" charoff="50">23:41</td>
          <td align="center" valign="top" charoff="50">74.2</td>
          <td align="center" valign="top" charoff="50">1:41:26</td>
          <td align="center" valign="top" charoff="50">89.5</td>
          <td align="center" valign="top" charoff="50">80.3</td>
          <td align="center" valign="top" charoff="50">1:35:35</td>
          <td align="center" valign="top" charoff="50">61.1</td>
          <td align="center" valign="top" charoff="50">40.8</td>
          <td align="center" valign="top" charoff="50">24</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">MSAProbs</td>
          <td align="center" valign="top" charoff="50">87.8</td>
          <td align="center" valign="top" charoff="50">60.8</td>
          <td align="center" valign="top" charoff="50">35:29</td>
          <td align="center" valign="top" charoff="50">73.7</td>
          <td align="center" valign="top" charoff="50">2:26:39</td>
          <td align="center" valign="top" charoff="50">89.1</td>
          <td align="center" valign="top" charoff="50">80.0</td>
          <td align="center" valign="top" charoff="50">2:42:09</td>
          <td align="center" valign="top" charoff="50">60.2</td>
          <td align="center" valign="top" charoff="50">40.0</td>
          <td align="center" valign="top" charoff="50">29</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">GLProbs</td>
          <td align="center" valign="top" charoff="50">87.9</td>
          <td align="center" valign="top" charoff="50">59.3</td>
          <td align="center" valign="top" charoff="50">23:21</td>
          <td align="center" valign="top" charoff="50">72.4</td>
          <td align="center" valign="top" charoff="50">1:25:40</td>
          <td align="center" valign="top" charoff="50">89.1</td>
          <td align="center" valign="top" charoff="50">80.0</td>
          <td align="center" valign="top" charoff="50">1:10:08</td>
          <td align="center" valign="top" charoff="50">61.4</td>
          <td align="center" valign="top" charoff="50">41.4</td>
          <td align="center" valign="top" charoff="50">3:55</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">MAFFT auto</td>
          <td align="center" valign="top" charoff="50">86.5</td>
          <td align="center" valign="top" charoff="50">58.7</td>
          <td align="center" valign="top" charoff="50">10:20</td>
          <td align="center" valign="top" charoff="50">72.6</td>
          <td align="center" valign="top" charoff="50">17:28</td>
          <td align="center" valign="top" charoff="50">88.7</td>
          <td align="center" valign="top" charoff="50">79.4</td>
          <td align="center" valign="top" charoff="50">7:13</td>
          <td align="center" valign="top" charoff="50">57.3</td>
          <td align="center" valign="top" charoff="50">36.8</td>
          <td align="center" valign="top" charoff="50">1:01</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Clustal-iter2</td>
          <td align="center" valign="top" charoff="50">84.8</td>
          <td align="center" valign="top" charoff="50">56.7</td>
          <td align="center" valign="top" charoff="50">67:32</td>
          <td align="center" valign="top" charoff="50">71.0</td>
          <td align="center" valign="top" charoff="50">2:35:46</td>
          <td align="center" valign="top" charoff="50">88.5</td>
          <td align="center" valign="top" charoff="50">79.5</td>
          <td align="center" valign="top" charoff="50">45:30</td>
          <td align="center" valign="top" charoff="50">55.2</td>
          <td align="center" valign="top" charoff="50">35.7</td>
          <td align="center" valign="top" charoff="50">2:52</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Clustal-default</td>
          <td align="center" valign="top" charoff="50">84.2</td>
          <td align="center" valign="top" charoff="50">55.9</td>
          <td align="center" valign="top" charoff="50">7:41</td>
          <td align="center" valign="top" charoff="50">70.0</td>
          <td align="center" valign="top" charoff="50">21:56</td>
          <td align="center" valign="top" charoff="50">87.8</td>
          <td align="center" valign="top" charoff="50">78.1</td>
          <td align="center" valign="top" charoff="50">7:34</td>
          <td align="center" valign="top" charoff="50">55.0</td>
          <td align="center" valign="top" charoff="50">35.5</td>
          <td align="center" valign="top" charoff="50">3:52</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">UPP</td>
          <td align="center" valign="top" charoff="50">83.0</td>
          <td align="center" valign="top" charoff="50">54.2</td>
          <td align="center" valign="top" charoff="50">1:23:33</td>
          <td align="center" valign="top" charoff="50">69.1</td>
          <td align="center" valign="top" charoff="50">5:00:29</td>
          <td align="center" valign="top" charoff="50">88.9</td>
          <td align="center" valign="top" charoff="50">80.0</td>
          <td align="center" valign="top" charoff="50">2:49:29</td>
          <td align="center" valign="top" charoff="50">52.9</td>
          <td align="center" valign="top" charoff="50">33.1</td>
          <td align="center" valign="top" charoff="50">18:36</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">FAMSA</td>
          <td align="center" valign="top" charoff="50">82.6</td>
          <td align="center" valign="top" charoff="50">50.1</td>
          <td align="center" valign="top" charoff="50">2:40</td>
          <td align="center" valign="top" charoff="50">68.3</td>
          <td align="center" valign="top" charoff="50">5:39</td>
          <td align="center" valign="top" charoff="50">87.4</td>
          <td align="center" valign="top" charoff="50">77.5</td>
          <td align="center" valign="top" charoff="50">1:30</td>
          <td align="center" valign="top" charoff="50">56.4</td>
          <td align="center" valign="top" charoff="50">36.8</td>
          <td align="center" valign="top" charoff="50">23</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Kalign-LCS</td>
          <td align="center" valign="top" charoff="50">83.0</td>
          <td align="center" valign="top" charoff="50">50.4</td>
          <td align="center" valign="top" charoff="50">29</td>
          <td align="center" valign="top" charoff="50">65.9</td>
          <td align="center" valign="top" charoff="50">1:51</td>
          <td align="center" valign="top" charoff="50">86.8</td>
          <td align="center" valign="top" charoff="50">76.4</td>
          <td align="center" valign="top" charoff="50">36</td>
          <td align="center" valign="top" charoff="50">55.6</td>
          <td align="center" valign="top" charoff="50">35.6</td>
          <td align="center" valign="top" charoff="50">2</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Muscle</td>
          <td align="center" valign="top" charoff="50">81.9</td>
          <td align="center" valign="top" charoff="50">47.8</td>
          <td align="center" valign="top" charoff="50">14:10</td>
          <td align="center" valign="top" charoff="50">67.7</td>
          <td align="center" valign="top" charoff="50">35:04</td>
          <td align="center" valign="top" charoff="50">87.5</td>
          <td align="center" valign="top" charoff="50">77.6</td>
          <td align="center" valign="top" charoff="50">26:44</td>
          <td align="center" valign="top" charoff="50">54.5</td>
          <td align="center" valign="top" charoff="50">33.5</td>
          <td align="center" valign="top" charoff="50">45</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">MAFFT default</td>
          <td align="center" valign="top" charoff="50">81.7</td>
          <td align="center" valign="top" charoff="50">47.5</td>
          <td align="center" valign="top" charoff="50">1:48</td>
          <td align="center" valign="top" charoff="50">68.0</td>
          <td align="center" valign="top" charoff="50">5:58</td>
          <td align="center" valign="top" charoff="50">86.6</td>
          <td align="center" valign="top" charoff="50">76.2</td>
          <td align="center" valign="top" charoff="50">1:39</td>
          <td align="center" valign="top" charoff="50">53.2</td>
          <td align="center" valign="top" charoff="50">33.0</td>
          <td align="center" valign="top" charoff="50">39</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Kalign2</td>
          <td align="center" valign="top" charoff="50">81.1</td>
          <td align="center" valign="top" charoff="50">47.1</td>
          <td align="center" valign="top" charoff="50">37</td>
          <td align="center" valign="top" charoff="50">65.5</td>
          <td align="center" valign="top" charoff="50">2:03</td>
          <td align="center" valign="top" charoff="50">86.3</td>
          <td align="center" valign="top" charoff="50">75.9</td>
          <td align="center" valign="top" charoff="50">48</td>
          <td align="center" valign="top" charoff="50">52.4</td>
          <td align="center" valign="top" charoff="50">32.6</td>
          <td align="center" valign="top" charoff="50">2</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</floats-group>
