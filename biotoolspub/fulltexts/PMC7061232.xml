<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol Evol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol Evol</journal-id>
    <journal-id journal-id-type="publisher-id">gbe</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology and Evolution</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1759-6653</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7061232</article-id>
    <article-id pub-id-type="doi">10.1093/gbe/evaa022</article-id>
    <article-id pub-id-type="publisher-id">evaa022</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Maximum Likelihood Estimation of Species Trees from Gene Trees in the Presence of Ancestral Population Structure</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Koch</surname>
          <given-names>Hillary</given-names>
        </name>
        <xref ref-type="aff" rid="evaa022-aff1">e1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>DeGiorgio</surname>
          <given-names>Michael</given-names>
        </name>
        <xref ref-type="corresp" rid="evaa022-cor1"/>
        <xref ref-type="aff" rid="evaa022-aff2">e2</xref>
        <!--<email>mdegiorg@fau.edu</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Enard</surname>
          <given-names>David</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="evaa022-aff1">
      <label>e1</label>
      <institution>Department of Statistics, Pennsylvania State University</institution>
    </aff>
    <aff id="evaa022-aff2">
      <label>e2</label>
      <institution>Department of Computer and Electrical Engineering and Computer Science, Florida Atlantic University</institution>
    </aff>
    <author-notes>
      <corresp id="evaa022-cor1">Corresponding author: E-mail: <email>mdegiorg@fau.edu</email>.</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-02-05">
      <day>05</day>
      <month>2</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>2</month>
      <year>2020</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>12</volume>
    <issue>2</issue>
    <fpage>3977</fpage>
    <lpage>3995</lpage>
    <history>
      <date date-type="accepted">
        <day>23</day>
        <month>1</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020. Published by Oxford University Press on behalf of the Society for Molecular Biology and Evolution.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="evaa022.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Though large multilocus genomic data sets have led to overall improvements in phylogenetic inference, they have posed the new challenge of addressing conflicting signals across the genome. In particular, ancestral population structure, which has been uncovered in a number of diverse species, can skew gene tree frequencies, thereby hindering the performance of species tree estimators. Here we develop a novel maximum likelihood method, termed TASTI (Taxa with Ancestral structure Species Tree Inference), that can infer phylogenies under such scenarios, and find that it has increasing accuracy with increasing numbers of input gene trees, contrasting with the relatively poor performances of methods not tailored for ancestral structure. Moreover, we propose a supertree approach that allows TASTI to scale computationally with increasing numbers of input taxa. We use genetic simulations to assess TASTI’s performance in the three- and four-taxon settings and demonstrate the application of TASTI on a six-species Afrotropical mosquito data set. Finally, we have implemented TASTI in an open-source software package for ease of use by the scientific community.</p>
    </abstract>
    <kwd-group>
      <kwd>consistency</kwd>
      <kwd>discordance</kwd>
      <kwd>phylogenetics</kwd>
      <kwd>structure</kwd>
      <kwd>TASTI</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Science Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/100000001</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>DEB-1753489</award-id>
        <award-id>DEB-1949268</award-id>
        <award-id>BCS-2001063</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R35-GM128590</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Alfred P. Sloan Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/100000879</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="19"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>Large multilocus data sets are becoming ever more common in systematic biology (<xref rid="evaa022-B6" ref-type="bibr">Cranston et al. 2009</xref>; <xref rid="evaa022-B78" ref-type="bibr">Song et al. 2012</xref>; <xref rid="evaa022-B54" ref-type="bibr">Song et al. 2012</xref>; <xref rid="evaa022-B71" ref-type="bibr">Salichos and Rokas 2013</xref>; <xref rid="evaa022-B9" ref-type="bibr">DeGiorgio et al. 2014</xref>; <xref rid="evaa022-B19" ref-type="bibr">Fontaine et al. 2015</xref>; <xref rid="evaa022-B66" ref-type="bibr">Peters et al. 2017</xref>). However, even with these more substantial data sets, the presence of gene tree discordance, in which inferred gene tree topologies conflict across loci, can be problematic when making phylogenetic inference. A major source of gene tree discordance is incomplete lineage sorting, which occurs when sampled lineages fail to coalesce, or find a common ancestor, in the first population in which they are able to do so. Accordingly, several statistically consistent methods for species tree inference that are robust to incomplete lineage sorting under the multispecies coalescent model have been developed (<xref rid="evaa022-B41" ref-type="bibr">Kubatko et al. 2009</xref>; <xref rid="evaa022-B13" ref-type="bibr">Degnan et al. 2009</xref>; <xref rid="evaa022-B50" ref-type="bibr">Liu, Yu, and Pearl 2010</xref>; <xref rid="evaa022-B60" ref-type="bibr">Mossel and Roch 2010</xref>; <xref rid="evaa022-B26" ref-type="bibr">Helmkamp et al. 2012</xref>; <xref rid="evaa022-B38" ref-type="bibr">Jewett and Rosenberg 2012</xref>; <xref rid="evaa022-B94" ref-type="bibr">Wu 2012</xref>; <xref rid="evaa022-B58" ref-type="bibr">Mirarab et al. 2014</xref>; <xref rid="evaa022-B59" ref-type="bibr">Mirarab and Warnow 2015)</xref>.</p>
    <p>The multispecies coalescent assumes that each modern and ancestral species is unstructured and has a constant population size and that each pair of lineages within a given ancestral species has an equal probability of coalescing (<xref rid="evaa022-B61" ref-type="bibr">Nakhleh 2013</xref>). Under these assumptions, incomplete lineage sorting leads to symmetries in gene tree distributions for any species tree, regardless of the number of taxa. For example, if a pair of taxa A and B are sister species on a species tree, then for all other species <italic>X</italic>, species A and <italic>X</italic> and species B and <italic>X</italic> have the same probability of being sister taxa in a gene tree (<xref rid="evaa022-B1" ref-type="bibr">Allman et al. 2011</xref>). In the face of some form of gene flow between species, such as hybridization, continuous migration, or horizontal gene transfer, asymmetries in gene tree distributions can arise (<xref rid="evaa022-B100" ref-type="bibr">Yu et al. 2011</xref>, <xref rid="evaa022-B97" ref-type="bibr">2012</xref>; <xref rid="evaa022-B42" ref-type="bibr">Leaché et al. 2014</xref>; <xref rid="evaa022-B77" ref-type="bibr">Solís-Lemus et al. 2016</xref>; <xref rid="evaa022-B85" ref-type="bibr">Tian and Kubatko 2016</xref>; <xref rid="evaa022-B51" ref-type="bibr">Long and Kubatko 2018</xref>). As such, asymmetries in gene tree distributions are often attributed to gene flow between species (<xref rid="evaa022-B55" ref-type="bibr">McGuire et al. 2007</xref>; <xref rid="evaa022-B15" ref-type="bibr">Escobar et al. 2012</xref>; <xref rid="evaa022-B53" ref-type="bibr">Marcussen et al. 2014</xref>).</p>
    <p>Despite the common crediting of asymmetries in gene tree distribution to interspecies gene flow, they can also emerge in the absence of such gene flow when ancestral populations are structured (<xref rid="evaa022-B75" ref-type="bibr">Slatkin and Pollack 2008</xref>). In this case, gene flow does not occur between taxa, but rather between demes within taxa. There are several hypothesized examples of structured ancestral species (<xref rid="evaa022-B20" ref-type="bibr">Garrigan et al. 2005</xref>; <xref rid="evaa022-B83" ref-type="bibr">Thalmann et al. 2006</xref>; <xref rid="evaa022-B91" ref-type="bibr">White et al. 2009</xref>), and genomic signatures of ancestral structure have been uncovered in a number of diverse lineages, including mouse (<xref rid="evaa022-B91" ref-type="bibr">White et al. 2009</xref>) and yeast (<xref rid="evaa022-B97" ref-type="bibr">Yu et al. 2012</xref>). Still, many methods for inferring species trees from multilocus data are not robust to ancestral structure and can be proven to be positively misleading (<xref rid="evaa022-B12" ref-type="bibr">DeGiorgio and Rosenberg 2016</xref>). <xref rid="evaa022-B12" ref-type="bibr">DeGiorgio and Rosenberg (2016)</xref> demonstrate that exceptions to this rule are the maximum likelihood estimators of the species tree implemented in GLASS (<xref rid="evaa022-B60" ref-type="bibr">Mossel and Roch 2010</xref>), STEM (<xref rid="evaa022-B41" ref-type="bibr">Kubatko et al. 2009</xref>), and Maximum Tree (<xref rid="evaa022-B50" ref-type="bibr">Liu, Yu, and Pearl 2010</xref>); however, these algorithms underperform on empirical data when gene trees are inferred rather than known.</p>
    <p>Here we detail an algorithm named TASTI (Taxa with Ancestral structure Species Tree Inference), a maximum likelihood method for inferring three-taxon species tree topologies when ancestral species are structured. We demonstrate that by explicitly incorporating the potential for population structure into a multispecies coalescent framework, the method is robust to population structure, and its performance typically does not significantly erode when applied to empirical data. Finally, we propose an approach to infer species tree topologies under ancestral population structure for an arbitrarily large number of species. We acknowledge that our method, which generalizes the standard multispecies coalescent, contains its own oversimplifications of ancestry, but maintain that it is a step in relaxing the common assumption of unstructured ancestral populations used in phylogenetics. We show via simulations in the three- and four-taxon settings that TASTI outperforms competing methods MP-EST (<xref rid="evaa022-B49" ref-type="bibr">Liu, Yu, and Edwards 2010</xref>), STELLS2 (<xref rid="evaa022-B65" ref-type="bibr">Pei and Wu 2017</xref>), and STEM2.0 (<xref rid="evaa022-B41" ref-type="bibr">Kubatko et al. 2009</xref>, hereafter referred to as STEM) when population structure is present, but remains competitive under the unstructured multispecies coalescent.</p>
  </sec>
  <sec>
    <title>Materials and Methods</title>
    <sec>
      <title>Modeling Three Species with Ancestral Population Structure</title>
      <p>In this section, we describe a model relating three species with population structure in each ancestral population and use it to construct probabilities of gene trees given a set of model parameters. In our model, the topologies <inline-formula id="IE1"><mml:math id="IM1"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and ((AB)C) denote a gene tree and species tree, respectively, with sister species A and B and outgroup C. <xref ref-type="fig" rid="evaa022-F1">Figure 1<italic>a</italic></xref> depicts a species tree with topology ((AB)C), in a configuration such that species B and C descend from the same ancestral subpopulation.
</p>
      <fig id="evaa022-F1" orientation="portrait" position="float">
        <label><sc>Fig</sc>. 1.</label>
        <caption>
          <p>—Modeling ancestral population structure. (<italic>a</italic>) Model of the relationships among species A, B, and C with divergence times <italic>τ</italic><sub>1</sub> and <italic>τ</italic><sub>2</sub>. Ancestral species belong to one of two subpopulations of scaled coalescent rates <inline-formula id="IE2"><mml:math id="IM2"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> with migration between subpopulations at rates <inline-formula id="IE3"><mml:math id="IM3"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE4"><mml:math id="IM4"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> below the root and <inline-formula id="IE5"><mml:math id="IM5"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE6"><mml:math id="IM6"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> above the root. Lineages from species A descend from subpopulation 1, whereas lineages from species B and C descend from subpopulation 2. (<italic>b</italic>) Incorporating population structure into the model increases the number of possible paths lineages from species A, B, and C might take to find their most recent common ancestor. For example, assuming that lineages from species A merge into subpopulation 1 and lineages from species B and C merge into subpopulation 2, a gene tree where lineages from species A and B coalesce first may arise from eight possible histories, as depicted here.</p>
        </caption>
        <graphic xlink:href="evaa022f1"/>
      </fig>
      <p>The species tree in our two-subpopulation model is characterized as follows. Divergence times, measured in expected number of mutations per site, are denoted <inline-formula id="IE7"><mml:math id="IM7"><mml:mrow><mml:mi mathvariant="bold-italic">τ</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>), where the internal branch length <inline-formula id="IE8"><mml:math id="IM8"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is of particular interest. For all ancestral species <italic>X</italic>, <inline-formula id="IE9"><mml:math id="IM9"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>μ</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE10"><mml:math id="IM10"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the effective population size of subpopulation <italic>j</italic> in ancestral species <italic>X</italic>, and <italic>μ</italic> is the mutation rate per site per generation. The mutation-scaled coalescent rates within subpopulations of ancestral species are inversely proportional to their respective values described in the vector <inline-formula id="IE11"><mml:math id="IM11"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Migration occurs between subpopulations at mutation-scaled rates according to the vector <inline-formula id="IE12"><mml:math id="IM12"><mml:mrow><mml:mi mathvariant="bold">M</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE13"><mml:math id="IM13"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the rate at which lineages move to subpopulation <italic>j</italic> when in ancestral species <italic>X</italic>. Specifically, we define <inline-formula id="IE14"><mml:math id="IM14"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE15"><mml:math id="IM15"><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the fraction of subpopulation <italic>j</italic> in ancestral species <italic>X</italic> made up of migrants from its complementary subpopulation each generation.</p>
      <p>Our method partitions the species tree into three distinct time transects on the intervals <inline-formula id="IE16"><mml:math id="IM16"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE17"><mml:math id="IM17"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>∞</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. During the interval <inline-formula id="IE18"><mml:math id="IM18"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>), we assume extant populations to be unstructured. Along the internal branch <inline-formula id="IE19"><mml:math id="IM19"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, we introduce ancestral subpopulations such that migration and coalescence events may occur between the two lineages from sister species A (originating in subpopulation 1) and B (originating in subpopulation 2). In the final interval <inline-formula id="IE20"><mml:math id="IM20"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>∞</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, the lineage from species C is introduced into subpopulation 2. This setting matches the one presented by <xref rid="evaa022-B75" ref-type="bibr">Slatkin and Pollack (2008)</xref>, up to the first coalescence event. Migration and coalescence events occur until lineages from each species find their most recent common ancestor (MRCA), which may only happen between two lineages when they are in the same subpopulation. Since we are in essence estimating the waiting times until some occurrence, the distribution of migration and coalescent events can be modeled using an exponential distribution parametrized by an instantaneous rate matrix (<xref rid="evaa022-B30" ref-type="bibr">Hobolth et al. 2011</xref>; <xref rid="evaa022-B85" ref-type="bibr">Tian and Kubatko 2016</xref>). This parameterization yields the matrix exponential <inline-formula id="IE21"><mml:math id="IM21"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>∞</mml:mo></mml:msubsup><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow><mml:mo>/</mml:mo><mml:mi>k</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:math></inline-formula>, whose (<italic>i</italic>, <italic>j</italic>)th entry is denoted <inline-formula id="IE22"><mml:math id="IM22"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>Instantaneous Rate Matrices for the Model</title>
      <p>The migration and coalescence of lineages within a structured population can be explicitly modeled using instantaneous rate matrices. For time to the first coalescence <inline-formula id="IE23"><mml:math id="IM23"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where migration and coalescence can only occur for a pair of lineages, one from species A and one from species B, we define the instantaneous rate matrix <inline-formula id="IE24"><mml:math id="IM24"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.
<disp-formula id="E1"><label>(1)</label><mml:math id="M1"><mml:mtable><mml:mtr><mml:mtd><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtable><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>−</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>−</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>−</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>−</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>−</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>−</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
      <p>In our notation, <inline-formula id="IE25"><mml:math id="IM25"><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> indicates that the lineage (denoted <italic>a</italic>) from species A is currently in subpopulation <italic>i</italic> and the lineage (denoted <italic>b</italic>) from species B is currently in subpopulation <italic>j</italic>, where <inline-formula id="IE26"><mml:math id="IM26"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. Further, <inline-formula id="IE27"><mml:math id="IM27"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> indicates that lineages <italic>a</italic> and <italic>b</italic> have coalesced and are in subpopulation <italic>i</italic>, where <inline-formula id="IE28"><mml:math id="IM28"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. We refer to these states in the coalescent history as states 1 through 6 (i.e., states <inline-formula id="IE29"><mml:math id="IM29"><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> through <inline-formula id="IE30"><mml:math id="IM30"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>) of <inline-formula id="IE31"><mml:math id="IM31"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. The coalescence rate in subpopulation <italic>i</italic> is <inline-formula id="IE32"><mml:math id="IM32"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and the dashes along the diagonal represent the negative sum of the elements of the corresponding row, such that each row sums to zero (<xref rid="evaa022-B40" ref-type="bibr">Kingman 1982</xref>). One can see that this matrix embeds several assumptions. First, we only allow for one event at any given instant. For example, we do not permit a lineage in one subpopulation and a lineage in another subpopulation to migrate simultaneously. Additionally, once lineages coalesce, they cannot uncoalesce. Under our model, at time <italic>τ</italic><sub>1</sub>, lineages from species A are in subpopulation 1, and lineages from species B are in subpopulation 2.</p>
      <p>The interval <inline-formula id="IE33"><mml:math id="IM33"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>∞</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is described using one of two possible instantaneous rate matrices. If the first coalescence is yet to occur, then the 20 × 20 matrix <inline-formula id="IE34"><mml:math id="IM34"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> governs the dynamics. In the interest of space, this matrix is left to <xref ref-type="supplementary-material" rid="sup1">supplementary figure S1</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online. We should note, however, that because any two lineages are equally likely to coalesce in states when all three lineages are in subpopulation <italic>i</italic>, the rate of coalescence in subpopulation <italic>i</italic> in these scenarios is <inline-formula id="IE35"><mml:math id="IM35"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mn>3</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, with <inline-formula id="IE36"><mml:math id="IM36"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Under our model, at time <italic>τ</italic><sub>2</sub>, the lineage <italic>c</italic> from species C must be in subpopulation 2, whereas lineages <italic>a</italic> and <italic>b</italic> from species A and B, or the coalesced lineage (<italic>ab</italic>), could be in either subpopulation. Above the root, once the first coalescence has occurred, the generic instantaneous rate matrix <inline-formula id="IE37"><mml:math id="IM37"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> models the dynamics. Letting <italic>X</italic> be a coalesced pair of lineages and <italic>Y</italic> be the remaining lineage, we have
<disp-formula id="E2"><label>(2)</label><mml:math id="M2"><mml:mtable><mml:mtr><mml:mtd><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtable><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>−</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>−</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>−</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>−</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>−</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>−</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
where <italic>x</italic> represents a lineage from coalesced pair <italic>X</italic> and <italic>y</italic> represents the lineage from species <italic>Y</italic>, and the same assumptions as for matrix <inline-formula id="IE38"><mml:math id="IM38"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> hold. These states are similarly referred to as states 1 through 6 (i.e., <inline-formula id="IE39"><mml:math id="IM39"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> through <inline-formula id="IE40"><mml:math id="IM40"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>) of <inline-formula id="IE41"><mml:math id="IM41"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>XY</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>Probability Distributions of Gene Tree Topologies under the Model</title>
      <p>We treat the dynamics in our model as a continuous-time Markov process that describes the waiting times between events. It follows that the waiting time to a given event is distributed exponentially with rate matrix Q, where events are independent as a consequence of the memoryless property of the exponential distribution (<xref rid="evaa022-B70" ref-type="bibr">Ross 2014</xref>, Chapter 5).</p>
      <p>Let <italic>T</italic><sub>1</sub> and <italic>T</italic><sub>2</sub> be random variables denoting the times to the first and second coalescence going backward in time, respectively. Further, let <italic>G</italic> and <italic>σ</italic> be random variables denoting the gene tree and species tree topologies, respectively. With the set of parameters <inline-formula id="IE42"><mml:math id="IM42"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mo>σ</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">τ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">M</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, let <inline-formula id="IE43"><mml:math id="IM43"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> be the joint density of gene tree <italic>G </italic>=<italic> g</italic> and coalescence times <italic>T</italic><sub>1</sub> = <italic>t</italic><sub>1</sub> and <italic>T</italic><sub>2</sub> = <italic>t</italic><sub>2</sub> when <inline-formula id="IE44"><mml:math id="IM44"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. Further, let <inline-formula id="IE45"><mml:math id="IM45"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, be the joint density of gene tree <italic>G</italic> = <italic>g<sub>j</sub></italic> and coalescence times <italic>T</italic><sub>1</sub> = <italic>t</italic><sub>1</sub> and <italic>T</italic><sub>2</sub> = <italic>t</italic><sub>2</sub> when <inline-formula id="IE46"><mml:math id="IM46"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE47"><mml:math id="IM47"><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE48"><mml:math id="IM48"><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Note that <inline-formula id="IE49"><mml:math id="IM49"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> does not accumulate mass for <inline-formula id="IE50"><mml:math id="IM50"><mml:mrow><mml:mi>G</mml:mi><mml:mo>≠</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> because only lineages from species A and B can coalesce along the internal branch <inline-formula id="IE51"><mml:math id="IM51"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      <p>We can split the joint probability densities into a product of marginal densities <inline-formula id="IE52"><mml:math id="IM52"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE53"><mml:math id="IM53"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> of going from <italic>i</italic> lineages to <italic>j</italic> lineages in the internal branch and the branch above the root, respectively, because the waiting times to coalescence events are independent. These marginal densities describe each possible coalescent history through all of the coalescent states described by instantaneous rate matrices <inline-formula id="IE54"><mml:math id="IM54"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>XY</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE55"><mml:math id="IM55"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. In order to cohesively describe the different coalescent histories, we introduce mapping functions <inline-formula id="IE56"><mml:math id="IM56"><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE57"><mml:math id="IM57"><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> that map coalescent states between, respectively, <inline-formula id="IE58"><mml:math id="IM58"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE59"><mml:math id="IM59"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>XY</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>XY</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE60"><mml:math id="IM60"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE61"><mml:math id="IM61"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE62"><mml:math id="IM62"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, as follows:
<disp-formula id="E3"><label>(3)</label><mml:math id="M3"><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>4</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="E4"><label>(4)</label><mml:math id="M4"><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>5</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>6</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>2</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>8</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="E5"><label>(5)</label><mml:math id="M5"><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>3</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>9</mml:mn><mml:mo>,</mml:mo><mml:mn>13</mml:mn><mml:mo>,</mml:mo><mml:mn>17</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>14</mml:mn><mml:mo>,</mml:mo><mml:mn>18</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>2</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>11</mml:mn><mml:mo>,</mml:mo><mml:mn>15</mml:mn><mml:mo>,</mml:mo><mml:mn>19</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>4</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>12</mml:mn><mml:mo>,</mml:mo><mml:mn>16</mml:mn><mml:mo>,</mml:mo><mml:mn>20</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>The function <inline-formula id="IE63"><mml:math id="IM63"><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> maps a coalesced state <italic>s</italic> in matrix <inline-formula id="IE64"><mml:math id="IM64"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> to a corresponding state in matrix <inline-formula id="IE65"><mml:math id="IM65"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (e.g., mapping state 5 in <inline-formula id="IE66"><mml:math id="IM66"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, where lineages <italic>a</italic> and <italic>b</italic> are coalesced in subpopulation 1, into corresponding state 1 of <inline-formula id="IE67"><mml:math id="IM67"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, where the coalesced lineage is in subpopulation 1 and lineage <italic>c</italic> is in subpopulation 2). The function <inline-formula id="IE68"><mml:math id="IM68"><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> maps uncoalesced state <italic>s</italic> in matrix <inline-formula id="IE69"><mml:math id="IM69"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> to a corresponding state in matrix <inline-formula id="IE70"><mml:math id="IM70"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (e.g., mapping state 4 in <inline-formula id="IE71"><mml:math id="IM71"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, where lineages <italic>a</italic> and <italic>b</italic> are both in subpopulation 2, to state 8 in <inline-formula id="IE72"><mml:math id="IM72"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, where all uncoalesced lineages are in subpopulation 2). The function <inline-formula id="IE73"><mml:math id="IM73"><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> maps a coalesced state <italic>s</italic> in matrix <inline-formula id="IE74"><mml:math id="IM74"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> to a corresponding state in matrix <inline-formula id="IE75"><mml:math id="IM75"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (e.g., mapping state 19 in <inline-formula id="IE76"><mml:math id="IM76"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, where lineages <italic>b</italic> and <italic>c</italic> are coalesced in subpopulation 2 and lineage <italic>a</italic> is in subpopulation 1, to state 2 in <inline-formula id="IE77"><mml:math id="IM77"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, where the coalesced lineage is in subpopulation 2 whereas the remaining lineage is in subpopulation 1). As one example, to capture the path to a common ancestor between the three lineages drawn in the top left of <xref ref-type="fig" rid="evaa022-F1">Figure 1<italic>b</italic></xref>, we see that the system is in state 5 of <inline-formula id="IE78"><mml:math id="IM78"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> [<inline-formula id="IE79"><mml:math id="IM79"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>] before speciation time <italic>τ</italic><sub>2</sub>. Therefore at this time, <inline-formula id="IE80"><mml:math id="IM80"><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is invoked to capture that lineages <italic>a</italic> and <italic>b</italic> coalesced along the internal branch in subpopulation 1, whereas the remaining lineage is also in subpopulation 2. This mapping takes us from state 5 of <inline-formula id="IE81"><mml:math id="IM81"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> to state 1 of <inline-formula id="IE82"><mml:math id="IM82"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>XY</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> [<inline-formula id="IE83"><mml:math id="IM83"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>], where here <italic>a</italic> and <italic>b</italic> are represented by coalesced lineage <italic>x</italic>, and <italic>c</italic> is represented by lineage <italic>y</italic>.</p>
      <p>Put symbolically, let <inline-formula id="IE84"><mml:math id="IM84"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE85"><mml:math id="IM85"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> be the coalescence rates leading to state <italic>s</italic>. For example, if the system has <italic>n</italic> lineages in subpopulation <italic>i</italic>, and a coalescence is about to occur there, then the rate of coalescence is <inline-formula id="IE86"><mml:math id="IM86"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for the internal branch and <inline-formula id="IE87"><mml:math id="IM87"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> above the root. The marginal densities that describe the possible coalescent histories are
<disp-formula id="E6"><label>(6)</label><mml:math id="M6"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow><mml:mn>6</mml:mn></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>21</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>×</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow><mml:mn>6</mml:mn></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>21</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo> </mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="E7"><label>(7)</label><mml:math id="M7"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>4</mml:mn></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>22</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>×</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>9</mml:mn></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>32</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>21</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:msub><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula><disp-formula id="E8"><label>(8)</label><mml:math id="M8"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>4</mml:mn></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>22</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>×</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>13</mml:mn></mml:mrow><mml:mrow><mml:mn>16</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>32</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>21</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:msub><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo> </mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula><disp-formula id="E9"><label>(9)</label><mml:math id="M9"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>4</mml:mn></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>22</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>×</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>17</mml:mn></mml:mrow><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>32</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>21</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:msub><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo> </mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>
where
<disp-formula id="E10"><label>(10)</label><mml:math id="M10"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>21</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>22</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>21</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>6</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>.</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>32</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <p>For <inline-formula id="IE88"><mml:math id="IM88"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>21</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE89"><mml:math id="IM89"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>22</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, <italic>s</italic> represents the state of the system, according to instantaneous rate matrix <inline-formula id="IE90"><mml:math id="IM90"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, at time <italic>t</italic>. Specifically, <inline-formula id="IE91"><mml:math id="IM91"><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> for <inline-formula id="IE92"><mml:math id="IM92"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>21</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE93"><mml:math id="IM93"><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> for <inline-formula id="IE94"><mml:math id="IM94"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>22</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. For <inline-formula id="IE95"><mml:math id="IM95"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>32</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub> represent the states at time 0 and at time <italic>t</italic>, respectively. That is, <inline-formula id="IE96"><mml:math id="IM96"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:mn>7</mml:mn><mml:mo>,</mml:mo><mml:mn>8</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE97"><mml:math id="IM97"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>9</mml:mn><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>20</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. Similarly, for <inline-formula id="IE98"><mml:math id="IM98"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>21</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, <italic>s</italic> represents the state of the system at <italic>t </italic>=<italic> </italic>0, with <inline-formula id="IE99"><mml:math id="IM99"><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. Though long, <xref ref-type="disp-formula" rid="E6 E7 E8 E9">equations (6)–(9)</xref> are simply capturing the probability density of all coalescent histories (<xref ref-type="fig" rid="evaa022-F1">fig. 1<italic>b</italic></xref>).</p>
      <p>It follows that the probability of observing gene tree topology <italic>G</italic> given the model parameters <inline-formula id="IE100"><mml:math id="IM100"><mml:mi mathvariant="bold">Ω</mml:mi></mml:math></inline-formula> can be computed from these densities as:
<disp-formula id="E11"><label>(11)</label><mml:math id="M11"><mml:mrow><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>∞</mml:mo></mml:msubsup><mml:mrow><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>∞</mml:mo></mml:msubsup><mml:mrow><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="E12"><label>(12)</label><mml:math id="M12"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>∞</mml:mo></mml:msubsup><mml:mrow><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="E13"><label>(13)</label><mml:math id="M13"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>∞</mml:mo></mml:msubsup><mml:mrow><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p>
    </sec>
    <sec>
      <title>Maximum Likelihood Parameter Estimation</title>
      <p>It is possible to compute the likelihood from a set of alignments <inline-formula id="IE101"><mml:math id="IM101"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>K</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> at <italic>K</italic> independent loci as
<disp-formula id="E14"><label>(14)</label><mml:math id="M14"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo>;</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>K</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:msub><mml:mo>∫</mml:mo><mml:mi>G</mml:mi></mml:msub><mml:mi mathvariant="double-struck">P</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>·</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:mi>G</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE102"><mml:math id="IM102"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> is the probability of observing the <italic>i</italic>th alignment <italic>A<sub>i</sub></italic> given gene tree <italic>G</italic>. The reason that we integrate over gene tree <italic>G</italic> rather than sum over gene trees is that a gene tree in this context represents a topology together with branch lengths, where the distribution over branch lengths is continuous. Although the likelihood is tractable, it is computationally challenging and changes with the choice of substitution model used to compute the term <inline-formula id="IE103"><mml:math id="IM103"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> (<xref rid="evaa022-B28" ref-type="bibr">Hey and Nielsen 2007)</xref>. As such, it is common practice in likelihood methods to use estimated gene trees, <inline-formula id="IE104"><mml:math id="IM104"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>K</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, as input data, and treat these data as known. Assuming the collection of <italic>K</italic> inferred gene trees are independent, the likelihood of the model may be computed as
<disp-formula id="E15"><label>(15)</label><mml:math id="M15"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo>;</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>K</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>Denoting <inline-formula id="IE105"><mml:math id="IM105"><mml:msub><mml:mo mathvariant="bold">Ω</mml:mo><mml:mrow><mml:mo mathvariant="bold">−</mml:mo><mml:mo mathvariant="bold">σ</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo>∖</mml:mo><mml:mo>{</mml:mo><mml:mo>σ</mml:mo><mml:mo>}</mml:mo></mml:math></inline-formula> as the parameter set <inline-formula id="IE106"><mml:math id="IM106"><mml:mo mathvariant="bold">Ω</mml:mo></mml:math></inline-formula> excluding the species tree topology <italic>σ</italic>, then for a fixed configuration of species tree topology <italic>σ</italic>, we search over all possible values of unknown parameters in <inline-formula id="IE107"><mml:math id="IM107"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mo>σ</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> to maximize the log likelihood. Thus, each configuration of the species tree topology is linked with its own set of maximum likelihood estimates <inline-formula id="IE108"><mml:math id="IM108"><mml:msub><mml:mover accent="true"><mml:mi>Ω</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>−</mml:mo><mml:mo>σ</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula>. We infer the species tree and associated parameter estimates <inline-formula id="IE109"><mml:math id="IM109"><mml:mrow><mml:mover accent="true"><mml:mi>Ω</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> that give rise to the largest associated likelihood.</p>
      <p>It must be emphasized that in this scenario of ancestral structure with two subpopulations, although the three possible species tree topologies are ((AB)C), ((AC)B), and ((BC)A), there are six total species tree model configurations in which species branch from ancestral subpopulations. The reason is that for each species tree topology <inline-formula id="IE110"><mml:math id="IM110"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mi>Y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> relating species <italic>X</italic>, <italic>Y</italic>, and <italic>Z</italic>, it is possible that either <italic>Y</italic> and <italic>Z</italic> or <italic>X</italic> and <italic>Z</italic> descend from the same ancestral subpopulation. Therefore, we must find the maximum likelihood parameter estimates for six configurations of the species tree.</p>
    </sec>
    <sec>
      <title>Extension to <italic>n</italic> Taxa</title>
      <p>With three species, there are only three species tree topologies and two configurations of each topology to consider. However, as the number of taxa grows, the number of available topologies, which grows in complexity at a rate proportional to the double factorial of the number of taxa <italic>n</italic> (<xref rid="evaa022-B18" ref-type="bibr">Felsenstein 2004</xref>), makes direct application of our method computationally infeasible. However, as illustrated in <xref ref-type="fig" rid="evaa022-F2">figure 2</xref>, dividing the <italic>n</italic>-taxon problem into multiple subproblems can ameliorate this burden. Because a rooted <italic>n</italic>-taxon tree is characterized by its set of rooted triples (<xref rid="evaa022-B80" ref-type="bibr">Steel 1992</xref>), we can implement a supertree approach (<xref rid="evaa022-B10" ref-type="bibr">DeGiorgio and Degnan 2010</xref>) to estimate the <italic>n</italic>-taxon species tree topology. This tactic reduces computation time to the order of <inline-formula id="IE111"><mml:math id="IM111"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>3</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> times the original complexity of the problem on three taxa.
</p>
      <fig id="evaa022-F2" orientation="portrait" position="float">
        <label><sc>Fig</sc>. 2</label>
        <caption>
          <p>—Schematic of a supertree approach for inferring <italic>n</italic>-taxon species tree topologies under a model of ancestral population structure. (Step 1) At each locus, infer a rooted <italic>n</italic>-taxon (here <italic>n </italic>=<italic> </italic>4) gene tree. (Step 2) For each gene tree, extract the set of <inline-formula id="IE112"><mml:math id="IM112"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>3</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (here equaling four) rooted three-taxon gene trees compatible with each <italic>n</italic>-taxon gene tree. (Step 3) For a given set of three taxa (e.g., species A, B, and C), apply TASTI to infer a rooted three-taxon species tree under a model of ancestral population structure by using all three-taxon gene trees with the given set of taxa across all loci. (Step 4) Given the set of <inline-formula id="IE113"><mml:math id="IM113"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>3</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (here equaling four) rooted three-taxon species trees inferred by TASTI, use a supertree approach to infer a rooted <italic>n</italic>-taxon species tree topology for the full set of <italic>n</italic> taxa.</p>
        </caption>
        <graphic xlink:href="evaa022f2"/>
      </fig>
    </sec>
    <sec>
      <title>Implementation</title>
      <p>TASTI jointly optimizes over divergence times and migration rates, though the computation varies depending on the type of input data—that is, gene tree topologies with, or without, branch lengths. From this point forward, for simplicity and clarity, we drop the “hats” on our estimates for gene trees, as we treat them as fully known.</p>
      <p>We first consider the case when branch lengths are included to make inference. Under this scenario, estimated coalescence times <italic>t</italic><sub>1</sub> and <italic>t</italic><sub>2</sub> are already fixed, eliminating the need to integrate out their values and permitting direct computation of the probability density given <inline-formula id="IE114"><mml:math id="IM114"><mml:mi mathvariant="bold">Ω</mml:mi></mml:math></inline-formula>. For coalescence times <inline-formula id="IE115"><mml:math id="IM115"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE116"><mml:math id="IM116"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> of gene tree <italic>g<sub>i</sub></italic>, computing the likelihood reduces to
<disp-formula id="E16"><label>(16)</label><mml:math id="M16"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo>;</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mi>K</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>4</mml:mn></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p>
      <p>On the other hand, when simply inputting gene tree topologies, we can decrease the size of the parameter space by optimizing over the length of the internal branch, rather than estimating each divergence time separately, because our model assumes no coalescence occurs in the interval <inline-formula id="IE117"><mml:math id="IM117"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The problem posed in <xref ref-type="disp-formula" rid="E11 E12 E13">equations (11)–(13)</xref> also reduces to integrating only over <italic>t</italic><sub>1</sub>, as the coalescence event at <italic>t</italic><sub>1</sub> uniquely determines the topology of the tree. Given data <inline-formula id="IE118"><mml:math id="IM118"><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <italic>n<sub>xy</sub></italic> represents the number of three-taxon gene tree topologies in a sample displaying clade {<italic>x</italic>, <italic>y</italic>} for lineages <italic>x</italic> and <italic>y</italic> from species <italic>X</italic> and <italic>Y</italic>, we can compute the likelihood under <inline-formula id="IE119"><mml:math id="IM119"><mml:mi mathvariant="bold">Ω</mml:mi></mml:math></inline-formula> as
<disp-formula id="E17"><label>(17)</label><mml:math id="M17"><mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo>;</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo>×</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo>×</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <p>To implement a constrained optimization procedure, we first need to derive bounds on our unknowns. First, we consider the migration rate. Recall that the migration rate is given by <inline-formula id="IE120"><mml:math id="IM120"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mi>N</mml:mi><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mo>θ</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE121"><mml:math id="IM121"><mml:mrow><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> This formulation gives rise to a lower bound of <italic>M </italic>&gt;<italic> </italic>0 when <italic>m</italic> is arbitrarily close to 0, since <italic>m </italic>=<italic> </italic>0 would imply no migration between subpopulations and thus would prevent the process from stopping. Similarly, we have an upper bound on <italic>M</italic> of <inline-formula id="IE122"><mml:math id="IM122"><mml:mrow><mml:mn>4</mml:mn><mml:mi>N</mml:mi><mml:mo>/</mml:mo><mml:mo>θ</mml:mo></mml:mrow></mml:math></inline-formula> when <italic>m </italic>=<italic> </italic>1. As the migration rate grows toward its upper bound, the species ancestry becomes effectively unstructured, generalizing our model to the standard multispecies coalescent.</p>
      <p>If branch lengths are used as input, then the estimated coalescence times determine the bounds on the speciation times. Let <inline-formula id="IE123"><mml:math id="IM123"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE124"><mml:math id="IM124"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> be the collections of first and second coalescent times at <italic>K</italic> loci, respectively, going backward in time. Then by our model construction, <inline-formula id="IE125"><mml:math id="IM125"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mtext>min</mml:mtext><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE126"><mml:math id="IM126"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mtext>min</mml:mtext><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>.</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. In a maximum likelihood framework, if branches of a gene tree in the sample are uninformative, it is then possible to encounter a “star tree” scenario in which <inline-formula id="IE127"><mml:math id="IM127"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Here, we cannot resolve the relationship among the taxa and are left to infer the unresolved species tree topology (ABC). Additional details regarding the implementation of the optimization procedure are discussed in the supplementary section “Parameter Estimation for Gene Trees with Branch Lengths,” <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online.</p>
      <p>When only topologies are considered, however, the internal branch length is no longer bounded by the set of observed divergence times. Therefore, we bound the length of the internal branch of the species tree in a manner similar in spirit to other methods that assume some minimum level of incomplete lineage sorting (<xref rid="evaa022-B84" ref-type="bibr">Than et al. 2008</xref>; <xref rid="evaa022-B94" ref-type="bibr">Wu 2012</xref>). To do this, we claim it is reasonable to search only over internal branch lengths that allow for some reasonable level of gene tree discordance (<xref rid="evaa022-B32" ref-type="bibr">Hudson 1983</xref>; <xref rid="evaa022-B81" ref-type="bibr">Tajima 1983</xref>; <xref rid="evaa022-B64" ref-type="bibr">Pamilo and Nei 1988</xref>). This is done because as the length of the internal branch of the species tree increases, the probability of discordance in the presence of population structure, even with low migration rates, goes to zero. Letting <italic>τ</italic> represent the length of the internal branch, this probability of discordance is computed by
<disp-formula id="E18"><label>(18)</label><mml:math id="M18"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>G</mml:mi><mml:mo>≠</mml:mo><mml:mo>σ</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>τ</mml:mo><mml:mo>/</mml:mo><mml:mo>θ</mml:mo></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>We propose that the lowest reasonable level of discordance to assume is <inline-formula id="IE128"><mml:math id="IM128"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>G</mml:mi><mml:mo>≠</mml:mo><mml:mo>σ</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>, implying that out of 100 sampled loci, only five will exhibit discordance.</p>
      <p>With topology data only, an analysis of three taxa with TASTI takes approximately 10 min, regardless of the number of observed loci. When including branch lengths, the running time grows with the number of observed loci. As the number <italic>n</italic> of taxa grows, complexity is multiplied by the number <inline-formula id="IE129"><mml:math id="IM129"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>3</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of rooted triples, but the computing task is trivially parallelizable across these triples (see <xref ref-type="supplementary-material" rid="sup1">supplementary fig. S2</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online).</p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <p>In this section, we aim to examine the performance and robustness of our proposed method using various forms of input data and compare this performance with existing methods MP-EST (<xref rid="evaa022-B49" ref-type="bibr">Liu, Yu, and Edwards 2010</xref>), STELLS2 (<xref rid="evaa022-B65" ref-type="bibr">Pei and Wu 2017</xref>), and STEM (<xref rid="evaa022-B41" ref-type="bibr">Kubatko et al. 2009</xref>). MP-EST is a pseudo-likelihood approach based on triples of taxa, whereas STELLS2 and STEM are likelihood approaches based on gene tree topologies and gene tree topologies with branch lengths, respectively. We selected these methods for comparison specifically because they are state-of-the-art methods for estimating species trees from gene trees which 1) operate within the maximum likelihood paradigm but 2) do not assume any sort of structure or other inter- or intraspecies gene flow. For TASTI, we considered using gene tree topologies with and without branch lengths in cases where the input data are both inferred and known with certainty. The gene trees in our simulations were generated using the coalescent simulator <italic>ms</italic> (<xref rid="evaa022-B33" ref-type="bibr">Hudson 2002</xref>). To simulate sequence alignments conditional on these gene trees, we employed Seq-Gen (<xref rid="evaa022-B68" ref-type="bibr">Rambaut and Grass 1997</xref>) to generate 1-kilobase (kb) and 0.5-kb-long sequences (with an additional outgroup sequence) under the HKY substitution model (<xref rid="evaa022-B24" ref-type="bibr">Hasegawa et al. 1985</xref>) with a transition–transversion ratio of 4.6 and base frequencies A, T, C, and G, respectively, equal to 0.3, 0.3, 0.2, and 0.2.</p>
    <p>From these simulated sequences, we used dnamlk of PHYLIP under the HKY substitution model (<xref rid="evaa022-B17" ref-type="bibr">Felsenstein 1989</xref>) to infer gene trees using maximum likelihood assuming a molecular clock with a transition–transversion ratio of 4.6 and empirical base frequencies. We applied this pipeline to create samples of 100 replicates of <italic>K</italic> independent loci, where <italic>K</italic> ranged from 10 to 10<sup>4</sup>, under fixed species tree topology ((AB)C). We let <inline-formula id="IE130"><mml:math id="IM130"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE131"><mml:math id="IM131"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>θ</mml:mo></mml:mrow></mml:math></inline-formula>. We set a constant effective population size of <inline-formula id="IE132"><mml:math id="IM132"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> across both subpopulations and employed a per-site per-generation mutation rate of <inline-formula id="IE133"><mml:math id="IM133"><mml:mrow><mml:mo>μ</mml:mo><mml:mo>=</mml:mo><mml:mn>2.5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, yielding <inline-formula id="IE134"><mml:math id="IM134"><mml:mrow><mml:mo>θ</mml:mo><mml:mo>=</mml:mo><mml:mn>0.005</mml:mn></mml:mrow></mml:math></inline-formula>. When gene tree topologies were used as input, this resulted in a bound on the length of the internal branch of the species tree of <inline-formula id="IE135"><mml:math id="IM135"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>≈</mml:mo><mml:mn>6.5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> mutation units, as derived from <xref ref-type="disp-formula" rid="E18">equation (18)</xref>. We focus on this case, with a short internal branch, as it is a challenging scenario which helps elucidate method performance under the most extreme settings. We do, however, further evaluate the performance of TASTI in cases with longer internal branch lengths (see, e.g., <xref rid="evaa022-T1" ref-type="table">table 1</xref>, <xref ref-type="fig" rid="evaa022-F4">fig. 4</xref>, or <xref ref-type="supplementary-material" rid="sup1">supplementary fig. S9</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online). These parameter settings were inspired by the great ape data set of <xref rid="evaa022-B3" ref-type="bibr">Burgess and Yang (2008)</xref>.
</p>
    <table-wrap id="evaa022-T1" orientation="portrait" position="float">
      <label>Table 1</label>
      <caption>
        <p>Accuracy of the Maximum Likelihood Estimator as a Function of Migration Rate <inline-formula id="IE136"><mml:math id="IM136"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mi>N</mml:mi><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mo>θ</mml:mo></mml:mrow></mml:math></inline-formula></p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
        </colgroup>
        <thead align="center">
          <tr>
            <th rowspan="1" colspan="1"/>
            <th colspan="3" rowspan="1">Exact Topologies<hr/></th>
            <th colspan="3" rowspan="1">Inferred Topologies<hr/></th>
            <th colspan="3" rowspan="1">Exact Gene Trees<hr/></th>
            <th colspan="3" rowspan="1">Inferred Gene Trees<hr/></th>
          </tr>
          <tr>
            <th align="left" rowspan="1" colspan="1">
              <italic>M</italic>
            </th>
            <th rowspan="1" colspan="1">((AB)C)</th>
            <th rowspan="1" colspan="1">((BC)A)</th>
            <th rowspan="1" colspan="1">((AC)B)</th>
            <th rowspan="1" colspan="1">((AB)C)</th>
            <th rowspan="1" colspan="1">((BC)A)</th>
            <th rowspan="1" colspan="1">((AC)B)</th>
            <th rowspan="1" colspan="1">((AB)C)</th>
            <th rowspan="1" colspan="1">((BC)A)</th>
            <th rowspan="1" colspan="1">((AC)B)</th>
            <th rowspan="1" colspan="1">((AB)C)</th>
            <th rowspan="1" colspan="1">((BC)A)</th>
            <th rowspan="1" colspan="1">((AC)B)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">0.5</td>
            <td rowspan="1" colspan="1">60</td>
            <td rowspan="1" colspan="1">23</td>
            <td rowspan="1" colspan="1">17</td>
            <td rowspan="1" colspan="1">63</td>
            <td rowspan="1" colspan="1">19</td>
            <td rowspan="1" colspan="1">18</td>
            <td rowspan="1" colspan="1">84</td>
            <td rowspan="1" colspan="1">0</td>
            <td rowspan="1" colspan="1">16</td>
            <td rowspan="1" colspan="1">75</td>
            <td rowspan="1" colspan="1">0</td>
            <td rowspan="1" colspan="1">25</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">5</td>
            <td rowspan="1" colspan="1">73</td>
            <td rowspan="1" colspan="1">27</td>
            <td rowspan="1" colspan="1">0</td>
            <td rowspan="1" colspan="1">75</td>
            <td rowspan="1" colspan="1">25</td>
            <td rowspan="1" colspan="1">0</td>
            <td rowspan="1" colspan="1">94</td>
            <td rowspan="1" colspan="1">0</td>
            <td rowspan="1" colspan="1">6</td>
            <td rowspan="1" colspan="1">93</td>
            <td rowspan="1" colspan="1">0</td>
            <td rowspan="1" colspan="1">7</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">50</td>
            <td rowspan="1" colspan="1">77</td>
            <td rowspan="1" colspan="1">23</td>
            <td rowspan="1" colspan="1">0</td>
            <td rowspan="1" colspan="1">75</td>
            <td rowspan="1" colspan="1">25</td>
            <td rowspan="1" colspan="1">0</td>
            <td rowspan="1" colspan="1">94</td>
            <td rowspan="1" colspan="1">0</td>
            <td rowspan="1" colspan="1">6</td>
            <td rowspan="1" colspan="1">91</td>
            <td rowspan="1" colspan="1">0</td>
            <td rowspan="1" colspan="1">9</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE137">
                <mml:math id="IM137">
                  <mml:mrow>
                    <mml:mn>4</mml:mn>
                    <mml:mi>N</mml:mi>
                    <mml:mo>/</mml:mo>
                    <mml:mo>θ</mml:mo>
                  </mml:mrow>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1">74</td>
            <td rowspan="1" colspan="1">13</td>
            <td rowspan="1" colspan="1">13</td>
            <td rowspan="1" colspan="1">52</td>
            <td rowspan="1" colspan="1">25</td>
            <td rowspan="1" colspan="1">23</td>
            <td rowspan="1" colspan="1">100</td>
            <td rowspan="1" colspan="1">0</td>
            <td rowspan="1" colspan="1">0</td>
            <td rowspan="1" colspan="1">84</td>
            <td rowspan="1" colspan="1">5</td>
            <td rowspan="1" colspan="1">11</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="tblfn1">
          <p><sc>note</sc>.—Accuracy is based on the percentage of 100 simulated replicates of 10<sup>3</sup> loci that inferred a specific species tree topology under a scenario with <inline-formula id="IE138"><mml:math id="IM138"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>2.5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE139"><mml:math id="IM139"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>5.25</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <sec>
      <title>Ancestral Population Structure Alters Expected Gene Tree Distributions</title>
      <p>Although symmetries among the distribution of gene tree topologies are expected under the standard multispecies coalescent (<xref rid="evaa022-B1" ref-type="bibr">Allman et al. 2011</xref>), population structure skews this distribution, as lineages above the root are no longer guaranteed to have equal probability of coalescing (<xref rid="evaa022-B75" ref-type="bibr">Slatkin and Pollack 2008</xref>). In <xref ref-type="supplementary-material" rid="sup1">supplementary figure S3</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online, distributions of gene trees are plotted for varying levels of migration when the internal branch is <inline-formula id="IE140"><mml:math id="IM140"><mml:mrow><mml:mn>6.5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> mutation units. Indeed, as <inline-formula id="IE141"><mml:math id="IM141"><mml:mrow><mml:mi>M</mml:mi><mml:mo>→</mml:mo><mml:mn>4</mml:mn><mml:mi>N</mml:mi><mml:mo>/</mml:mo><mml:mo>θ</mml:mo></mml:mrow></mml:math></inline-formula>—the scenario under which our model reduces to the standard multispecies coalescent—this symmetry between topologies <inline-formula id="IE142"><mml:math id="IM142"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE143"><mml:math id="IM143"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is present. However, as the migration rate decreases, the distribution skews toward a dominant <inline-formula id="IE144"><mml:math id="IM144"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> topology, and symmetry between gene tree topologies <inline-formula id="IE145"><mml:math id="IM145"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE146"><mml:math id="IM146"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> no longer persists. Further, although estimated gene tree topologies (<xref ref-type="supplementary-material" rid="sup1">supplementary fig. S3</xref><italic>c</italic>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online) obey the same large-sample distribution as the topologies known exactly (<xref ref-type="supplementary-material" rid="sup1">supplementary fig. S3</xref><italic>a</italic>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online), there is an increased variability in their distribution across samples, which in general is detrimental to inference (<xref rid="evaa022-B4" ref-type="bibr">Casella and Berger 2002</xref>, Chapter 10).</p>
      <p>TASTI incorporates the possibility for these skewed distributions of gene tree topologies. In what follows, we demonstrate that TASTI provides reasonable estimates of the true species tree topology under conditions in which other methods have previously failed (<xref rid="evaa022-B12" ref-type="bibr">DeGiorgio and Rosenberg 2016</xref>). We simulated data as described at the start of this section, assuming a species tree with speciation times <inline-formula id="IE147"><mml:math id="IM147"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>2.5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE148"><mml:math id="IM148"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>2.75</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> mutation units. This setting, with such a short internal branch, makes correct inference especially challenging. In order to understand the effects of various evolutionary parameters on TASTI’s performance, we first conduct a detailed exploration of the method’s accuracy. A summary of TASTI’s accuracy is in <xref ref-type="fig" rid="evaa022-F3">figure 3</xref>, whereas tables of median parameter estimates and 95% confidence intervals are in <xref ref-type="supplementary-material" rid="sup1">supplementary tables S1 and S2</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online, respectively. Summaries of additional simulations studying the performance of TASTI against MP-EST, STELLS2, and STEM under a variety of different simulation settings are in <xref ref-type="fig" rid="evaa022-F4">figure 4</xref>.
</p>
      <fig id="evaa022-F3" orientation="portrait" position="float">
        <label><sc>Fig</sc>. 3.</label>
        <caption>
          <p>—Accuracy of the maximum likelihood estimator of <italic>σ</italic> as a function of the number of input gene trees. Accuracy is based on the proportion of 100 simulated replicates of <italic>K</italic> loci (before filtering “star trees”), with <italic>K</italic> ranging from 10 to 10<sup>4</sup>, where our method inferred a specific species tree topology under a scenario with <inline-formula id="IE149"><mml:math id="IM149"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>2.5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE150"><mml:math id="IM150"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>2.75</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</p>
        </caption>
        <graphic xlink:href="evaa022f3"/>
      </fig>
      <fig id="evaa022-F4" orientation="portrait" position="float">
        <label><sc>Fig</sc>. 4.</label>
        <caption>
          <p>—Accuracy of TASTI, MP-EST, STELLS2, and STEM when estimating the true species tree topology <italic>σ</italic> as a function of the number of input gene trees. Accuracy is based on the proportion of 100 simulated replicates of <italic>K</italic> loci with <italic>K</italic> ranging from 10 to 10<sup>3</sup>. In these simulations, we only use inferred gene tree topologies as input to TASTI. Comparisons are made across four internal branch lengths (<inline-formula id="IE151"><mml:math id="IM151"><mml:mrow><mml:mo>Δ</mml:mo><mml:mo>τ</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>) in cases when populations are both structured and unstructured and when gene trees are estimated from both 1- and 0.5-kb sequences.</p>
        </caption>
        <graphic xlink:href="evaa022f4"/>
      </fig>
      <p>Our results drive home several key points. First, phylogenetic inference methods are sensitive to the quality of input data, and TASTI taking gene tree topologies as input tends to be more robust to stochasticity encountered in practice than when gene tree branch length information is incorporated into TASTI’s input as well. However, if accurate data on gene tree branch lengths are available, then TASTI will naturally perform better when this information is included rather than obscured. This is especially true when multiple candidate species trees are equally likely under a model of gene tree topologies alone. Furthermore, when species trees have longer internal branch lengths, then more accurate input data can be estimated, yielding more reliable downstream inference of the complete species trees. Lastly, although TASTI is typically competitive with alternative methods under the standard multispecies coalescent, it is the only method that exhibits favorable performance in the presence of ancestral population structure.</p>
    </sec>
    <sec>
      <title>Gene Tree Topology Data Permit Accurate, Robust Species Tree Inference</title>
      <p>The first column of <xref ref-type="fig" rid="evaa022-F3">figure 3</xref> shows the performance of TASTI with exact gene tree topologies for data input across all investigated levels of migration. In the case of no ancestral structure (<inline-formula id="IE152"><mml:math id="IM152"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mi>N</mml:mi><mml:mo>/</mml:mo><mml:mo>θ</mml:mo></mml:mrow></mml:math></inline-formula>), we obtain consistent estimates of the true species tree even with a small number of sampled loci. Similarly, when the ancestral populations are structured with <italic>M </italic>=<italic> </italic>5, TASTI’s species tree estimate begins favoring the truth over alternative topologies fairly quickly. In contrast, with a combination of a higher rate of migration between subpopulations (<italic>M </italic>=<italic> </italic>50) and a short internal branch of the species tree, the effects of ancestral population structure begin to break down. Consequently, the distribution of gene tree topologies resembles one we would expect under the standard multispecies coalescent with sister species B and C, such that TASTI is led to infer the dominant gene tree topology ((BC)A) as the true species tree. When migration is at its lowest (<italic>M </italic>=<italic> </italic>0.5), and especially with few sampled loci, the data do not convey any detectable signal in the distribution of topologies. That is, nearly all of the observed topologies are of the form <inline-formula id="IE153"><mml:math id="IM153"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and the true species tree is difficult to determine. Interestingly, though <inline-formula id="IE154"><mml:math id="IM154"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is by far the dominant gene tree in these input data, ((BC)A) is never TASTI’s estimated maximum likelihood species tree. This result is expounded upon in supplementary section “Bounding the Length of the Internal Branch of the Species Tree in the Low Signal Setting,” <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online.</p>
      <p>The second column of <xref ref-type="fig" rid="evaa022-F3">figure 3</xref> illustrates TASTI’s accuracy when gene tree topologies are no longer known with certainty, but rather, are inferred from 1-kb sequences. A comparison of these results with those in the first column suggests that TASTI is robust to noise incurred in the process of gene tree inference. Although accuracy in general is reduced, the overall trends are still present. For the no structure setting, and when ancestral populations are structured with <italic>M </italic>=<italic> </italic>5, TASTI still favors the true species tree topology ((AB)C), but with less immediacy and certainty as is found in the case when topologies are known exactly. When <italic>M </italic>=<italic> </italic>50, TASTI goes from slowly favoring the misleading species tree topology ((BC)A) to quickly being positively misleading for ((BC)A). Interestingly, when migration is at its lowest, the gene tree distribution skews toward a more frequent occurrence of <inline-formula id="IE155"><mml:math id="IM155"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> than <inline-formula id="IE156"><mml:math id="IM156"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> when compared against the distribution of gene tree topologies which are known exactly. This in turn improves TASTI’s accuracy.</p>
    </sec>
    <sec>
      <title>Knowledge of Gene Tree Branch Lengths Improves Estimation</title>
      <p>Incorporating branch length data from input gene trees can improve inference under TASTI, as knowledge about presence or absence of symmetries in the distribution of gene tree topologies may sometimes be insufficient for making the correct judgment. The performance of TASTI when gene tree topologies with branch lengths are known with certainty, displayed in the third column of <xref ref-type="fig" rid="evaa022-F3">figure 3</xref>, provides a benchmark best case that TASTI can hope to achieve under our highly challenging simulation settings. In the case when ancestral populations are not structured, we see perfect performance by TASTI with few input loci. With ancestral structure, we still achieve good performance under each level of migration, with weaker trends as structure between subpopulations increases. Remarkably, although TASTI’s estimate of the species tree topology is inconsistent when <italic>M </italic>=<italic> </italic>50, the addition of branch lengths rescues inference. Another advantage of using branch lengths is that we eliminate the need to set an upper bound on the length of the internal branch heuristically, as the estimated gene trees determine this automatically.</p>
      <p>Using estimated gene trees and branch lengths introduces increased variability into the model when compared with the noise introduced by only using estimated topologies. In general, although we obtain fairly accurate species tree estimates using gene tree data known with certainty, the overall trend is that TASTI experiences a larger reduction in accuracy from using estimated gene trees than it does from using estimated topologies alone. For example, we can see that under the standard multispecies coalescent, though we obtained near-perfect performance when branch lengths were known with certainty, the variability in the estimated branch lengths greatly reduces TASTI’s accuracy. This trend is apparent across all migration rates, but it increases in severity as population structure decreases. This is consequent to the claim that if gene tree branch lengths are shorter, they are more difficult to estimate accurately (<xref rid="evaa022-B11" ref-type="bibr">DeGiorgio and Degnan 2014</xref>). This notion is explored more deeply in the following section.</p>
    </sec>
    <sec>
      <title>Species Trees with Longer Total Branch Length Permit Better Inference</title>
      <p>Our simulations test the accuracy of TASTI under a highly challenging scenario where the internal branch of the species tree is excessively short. With a short internal branch under ancestral population structure, the chance of observing gene trees concordant with the species tree decreases. Additionally, for a fixed migration rate and divergence time <italic>τ</italic><sub>1</sub>, the time to the MRCA among lineages in the phylogeny decreases on average with a decreasing internal branch length. These shorter gene tree branch lengths make accurate gene tree inference more difficult, as loci become less informative because fewer mutations will have occurred among the species (<xref rid="evaa022-B11" ref-type="bibr">DeGiorgio and Degnan 2014</xref>).</p>
      <p>The impact of the short gene tree branch lengths can be seen directly by comparing the accuracy of TASTI when applied to gene trees known with certainty as opposed to when it is applied to inferred gene trees (<xref ref-type="fig" rid="evaa022-F3">fig. 3</xref>, third and fourth columns). When migration is low, gene tree branch lengths are longer, and hence more informative. Thus, in lower-migration settings (e.g., when <italic>M </italic>=<italic> </italic>0.5 or <italic>M </italic>=<italic> </italic>5), we can infer more accurate gene trees and branch lengths than in higher-migration scenarios. However, when migration is high (e.g., when <italic>M </italic>=<italic> </italic>50) or when the ancestral species are unstructured, gene tree branch lengths are much shorter, thereby leading to less accurately inferred divergence times. We can see that the accuracy of TASTI suffers the most when gene tree branch lengths are inferred under the no ancestral structure and high migration scenarios. Meanwhile, species tree inference is not dramatically affected when migration is low.</p>
      <p>With this in mind, we tested the influence of noisy gene trees on TASTI’s performance in two ways. First, we considered the effect of less accurate input gene trees by following an identical simulation protocol to the one described above, with the exception that we inferred gene trees from 0.5 kb instead of 1-kb-long regions. Results display similar, though slightly worsened, performance when compared with our original simulations (compare <xref ref-type="fig" rid="evaa022-F3">fig. 3</xref> and <xref ref-type="supplementary-material" rid="sup1">supplementary fig. S4</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online). We also tested the accuracy of TASTI with a longer internal branch of the true species tree, such that the time to the MRCA is on average longer. To evaluate this scenario, we simulated 100 replicates of 10<sup>3</sup> loci using the same parameters and protocols as previously described, with the exception that we increased the age <italic>τ</italic><sub>2</sub> of the species tree root. Specifically, we employed divergence times of <inline-formula id="IE157"><mml:math id="IM157"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>2.5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE158"><mml:math id="IM158"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>5.25</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. As expected, we observe the same trends as in our original simulations (<xref ref-type="fig" rid="evaa022-F3">fig. 3</xref>) but with overall more accurate species tree inference (<xref rid="evaa022-T1" ref-type="table">table 1</xref>). This is still a challenging setting, noting that the probabilities of observing concordant gene trees are <inline-formula id="IE159"><mml:math id="IM159"><mml:mrow><mml:mn>3.62</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>3.46</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, 0.236, and 0.596 for <italic>M </italic>=<italic> </italic>0.5, 5, 50, and <inline-formula id="IE160"><mml:math id="IM160"><mml:mrow><mml:mn>4</mml:mn><mml:mi>N</mml:mi><mml:mo>/</mml:mo><mml:mo>θ</mml:mo></mml:mrow></mml:math></inline-formula>, respectively, with the longer internal branch length. This can be compared against concordance probabilities of <inline-formula id="IE161"><mml:math id="IM161"><mml:mrow><mml:mn>1.83</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>1.75</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, 0.122, and 0.366 for <italic>M </italic>=<italic> </italic>0.5, 5, 50, and <inline-formula id="IE162"><mml:math id="IM162"><mml:mrow><mml:mn>4</mml:mn><mml:mi>N</mml:mi><mml:mo>/</mml:mo><mml:mo>θ</mml:mo></mml:mrow></mml:math></inline-formula>, respectively, with the shorter internal branch length.</p>
      <p>Although our study operated on gene trees inferred by maximum likelihood, the use of Bayesian methods to infer gene trees may alleviate these concerns by improving gene tree estimates and decreasing the chance of estimating gene trees with branches of length zero (<xref rid="evaa022-B11" ref-type="bibr">DeGiorgio and Degnan 2014</xref>). Alternatively, it is possible that imposing a constraint on a minimum value on <inline-formula id="IE163"><mml:math id="IM163"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> when using whole gene trees would avoid the deleterious effects of gene trees with poorly estimated branch lengths.</p>
    </sec>
    <sec>
      <title>Comparison of Competing Methods in the Three-Taxon Setting</title>
      <p>We used simulations to compare TASTI with three other methods for inferring species trees from gene trees: MP-EST, STELLS2, and STEM. We designed the study similarly to the one presented in <xref ref-type="fig" rid="evaa022-F3">figure 3</xref>, examining the methods’ collective performance over varying internal branch lengths and levels of population structure. Specifically, we let (<inline-formula id="IE164"><mml:math id="IM164"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>2.5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mn>5.0</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mn>1.0</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mn>2.0</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> mutation units and <inline-formula id="IE165"><mml:math id="IM165"><mml:mrow><mml:mi>M</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mi>N</mml:mi><mml:mo>/</mml:mo><mml:mo>θ</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. We only investigate the more realistic case of estimated gene trees as input, where gene trees were inferred from 0.5 and 1-kb-long sequences. For TASTI, we study the setting where gene tree topologies are used as input. Other details of the simulations, including parameters <italic>N</italic> and <italic>θ</italic>, remain the same as in previous simulations.</p>
      <p>Results (<xref ref-type="fig" rid="evaa022-F4">fig. 4</xref>) show the proportion of times out of 100 replicate simulations that each method inferred the correct species tree for the given parameter settings. Comparing between the top two rows, we see that TASTI’s accuracy increases with more accurate input topologies and with a longer internal branch, where the signals are stronger. Meanwhile, all other methods nearly always infer the wrong species tree topology nearly (or exactly) 100% of the time, demonstrating that MP-EST, STELLS2, and STEM are not robust to ancestral population structure.</p>
      <p>The bottom two rows, on the other hand, evaluate all methods when the populations are unstructured. Here, MP-EST and STELLS2 show the same consistent performance; TASTI is competitive with these two methods. Though STEM is known to perform well when gene trees are known exactly, we see that this method is not robust to empirical data and therefore underperforms, especially when the gene trees are inferred from shorter sequences (<xref rid="evaa022-B43" ref-type="bibr">Leaché and Rannala 2011</xref>; <xref rid="evaa022-B11" ref-type="bibr">DeGiorgio and Degnan 2014</xref>). An exception is that, as the internal branch length grows longer, sometimes a structured species tree topology becomes more likely than the unstructured ((AB)C) topology under TASTI. This occurs when stochasticity in the observed data results in asymmetries in the observed distribution of gene tree topologies. Options that would remedy the unidentifiability in this case are to limit the length of the internal branch using some sort of external information or to include divergence times in the analysis. As these options may not always be possible, we recognize this issue as a drawback of TASTI.</p>
    </sec>
    <sec>
      <title>Accuracy of the Supertree Approach Applied to Four Taxa</title>
      <p>With the wide availability of multilocus sequence data from a number of species (<xref rid="evaa022-B39" ref-type="bibr">Johnson et al. 2013</xref>; <xref rid="evaa022-B46" ref-type="bibr">Lin et al. 2014</xref>; <xref rid="evaa022-B96" ref-type="bibr">Yang et al. 2015</xref>; <xref rid="evaa022-B73" ref-type="bibr">Shen et al. 2016</xref>), it is common practice to construct species-level phylogenies for more than three taxa. However, when performing model-based species tree estimation, the inference problem becomes increasingly complex and computationally difficult (<xref rid="evaa022-B14" ref-type="bibr">Drummond and Rambaut 2007</xref>; <xref rid="evaa022-B48" ref-type="bibr">Liu and Pearl 2007</xref>; <xref rid="evaa022-B25" ref-type="bibr">Heled and Drummond 2010</xref>; <xref rid="evaa022-B94" ref-type="bibr">Wu 2012</xref>). We therefore chose to evaluate the performance of TASTI for an increased problem size. Using again the identical simulation protocol, we generated data assuming a four-taxon species tree with fixed species tree topology (((AB)C)D) and speciation times <inline-formula id="IE166"><mml:math id="IM166"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1.25</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1.375</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE167"><mml:math id="IM167"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> mutation units. Species A originated from subpopulation 1 whereas species B, C, and D originated from subpopulation 2, as depicted in <xref ref-type="fig" rid="evaa022-F5">figure 5</xref>. We again set a constant effective population size of <inline-formula id="IE168"><mml:math id="IM168"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> across both of these subpopulations and considered both the unstructured ancestral population case as well as the case with symmetric migration rate of <italic>M </italic>=<italic> </italic>5 between subpopulations in ancestral species.
</p>
      <fig id="evaa022-F5" orientation="portrait" position="float">
        <label><sc>Fig</sc>. 5.</label>
        <caption>
          <p>—Model four-taxon species tree used in our supertree simulations, displaying the relationships among species A, B, C, and D, with divergence times <italic>τ</italic><sub>1</sub>, <italic>τ</italic><sub>2</sub>, and <italic>τ</italic><sub>3</sub>. Ancestral species belong to one of two subpopulations with migration between subpopulations at rates <inline-formula id="IE169"><mml:math id="IM169"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE170"><mml:math id="IM170"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> directly ancestral to species A and B, <inline-formula id="IE171"><mml:math id="IM171"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE172"><mml:math id="IM172"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABC</mml:mtext><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> directly ancestral to the split of species A and B with species C, and <inline-formula id="IE173"><mml:math id="IM173"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABCD</mml:mtext><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE174"><mml:math id="IM174"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext>ABCD</mml:mtext><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> above the root. Lineages from species A descend from subpopulation 1, whereas lineages from species B, C, and D descend from subpopulation 2. Under our simulation scenarios, we set <inline-formula id="IE175"><mml:math id="IM175"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> for all species <italic>X</italic> and <italic>Y</italic> and for all subpopulations <italic>i</italic> and <italic>j</italic>.</p>
        </caption>
        <graphic xlink:href="evaa022f5"/>
      </fig>
      <p>To infer four-taxon species trees, we followed the procedure depicted in <xref ref-type="fig" rid="evaa022-F2">figure 2</xref>. For each simulated replicate, we extracted the <inline-formula id="IE176"><mml:math id="IM176"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mn>4</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>3</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> rooted triples displayed by each four-taxon gene tree at each of the <italic>K</italic> simulated loci. That is, at every locus, we extracted the rooted gene tree (topology with corresponding branch lengths) associated with each set of three species, such that we obtained rooted gene trees for the sets of taxa {<italic>a</italic>, <italic>b</italic>, <italic>c</italic>}, {<italic>a</italic>, <italic>b</italic>, <italic>d</italic>}, {<italic>a</italic>, <italic>c</italic>, <italic>d</italic>}, and {<italic>b</italic>, <italic>c</italic>, <italic>d</italic>}. For each set of three species, we estimated a three-taxon species tree topology using TASTI based upon the set of rooted triples for that set of three species across the <italic>K</italic> simulated loci. This procedure yielded <inline-formula id="IE177"><mml:math id="IM177"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mn>4</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>3</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> three-taxon species tree topology estimates. These four triples were then used to construct a supertree using the modified mincut supertree algorithm (<xref rid="evaa022-B63" ref-type="bibr">Page 2002</xref>).</p>
      <p>We chose to use the modified mincut supertree algorithm based on six properties it exhibits (<xref rid="evaa022-B63" ref-type="bibr">Page 2002</xref>; <xref rid="evaa022-B72" ref-type="bibr">Semple and Steel 2003</xref>). First, any species that is in one of the input gene trees is also in the inferred supertree. Second, if a tree exists that could display each input tree as a subtree, then the supertree will display each of these trees. Third, the order in which gene tree topologies are provided to the algorithm does not affect its supertree estimate. Fourth, changing the labeling of species in the set of input trees will produce the same output supertree with the set of relabeled species. Fifth, the algorithm runs in polynomial time as a function of the number of input species <italic>n</italic>. Finally, nestings that are not contradicted are also displayed in the supertree. Though we employ a specific supertree algorithm here, other supertree approaches may have complementary desirable properties that could lead to improvements in performance. However, an extensive assessment of the wide diversity of supertree algorithms (<xref rid="evaa022-B92" ref-type="bibr">Wilkinson et al. 2005</xref>) is beyond the scope of this article.</p>
      <p>In general, the most frequently inferred species tree topologies are the true topology (((AB)C)D) and the partially unresolved topology ((AB)CD) (<xref ref-type="supplementary-material" rid="sup1">supplementary fig. S9</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online). These unresolved trees occur as a consequence of the supertree construction algorithm when inferred triples are in conflict. We further investigated the performance of TASTI by examining the mean Robinson–Foulds (RF) distance (<xref rid="evaa022-B69" ref-type="bibr">Robinson and Foulds 1981</xref>) between the inferred species tree topology and the true topology for each set of 100 replicates given <italic>K</italic> simulated loci. We followed the procedure of <xref rid="evaa022-B11" ref-type="bibr">DeGiorgio and Degnan (2014)</xref> and defined the RF distance as the sum of the number of false positive clades and false negative clades between the inferred topology and the true topology, such that the distance metric applies to multifurcating trees. Mean RF distances, numbers of false positive clades, and numbers of false negative clades across all simulations are summarized in <xref ref-type="supplementary-material" rid="sup1">supplementary figure S10</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online. Results show that false negative clades occur more frequently than false positive clades. This result indicates that the largest errors of this approach are due to partially unresolved species trees, rather than species trees displaying incorrect clades. Further, RF distance decreases as the number of input loci increases, with the exception of species tree estimates based on inferred gene trees with branch lengths.</p>
    </sec>
    <sec>
      <title>Comparing Accuracy of Multiple Methods Applied to Four Taxa</title>
      <p>In order to place the above results in better context, we compared TASTI with MP-EST, STELLS2, and STEM in the four-taxon setting as well. We followed the same protocol for simulation that was used in the section “Accuracy with the Supertree Approach Applied to Four Taxa.” In each simulation, we assumed equispaced divergence times (e.g., <inline-formula id="IE178"><mml:math id="IM178"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>) along an asymmetric species tree. The simulations include settings where the divergence times are separated by one of <inline-formula id="IE179"><mml:math id="IM179"><mml:mrow><mml:mn>2.5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>5.0</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>1.0</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, or <inline-formula id="IE180"><mml:math id="IM180"><mml:mrow><mml:mn>2.0</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> mutation units. We considered the structured case with migration rate <italic>M </italic>=<italic> </italic>5 and the unstructured case. We applied this comparison only to inferred gene trees, where the gene trees were estimated from 1- and 0.5-kb sequences. For TASTI, we only used gene tree topologies as input.</p>
      <p>The results from this simulation, summarized using the RF distance in <xref ref-type="fig" rid="evaa022-F6">figure 6</xref>, behave as expected (the same simulations, described by number of false positive clades and false negative clades, are reported in <xref ref-type="supplementary-material" rid="sup1">supplementary figs. S7 and S8</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online, respectively). The top two rows, showing simulations when the populations are structured, indicate that MP-EST, STELLS2, and STEM behave similarly poorly; each method on average infers a tree that is as far away in RF distance from the true tree as possible. TASTI, on the other hand gets closer to the true tree, in particular as the internal branches grow longer. In the unstructured case, although TASTI, MP-EST and STELLS2 are all competitive, STELLS2 uniformly performs the best. TASTI and MP-EST perform very similarly because MP-EST takes a pseudolikelihood approach that, like TASTI, is also based in rooted triples. Because STEM is sensitive to noisy data, this method again underperforms relative to the other three. As observed in the three-taxon simulations in <xref ref-type="fig" rid="evaa022-F4">figure 4</xref>, we note one exception where TASTI underperforms when the internal branch length grows but the populations are unstructured. The driver of TASTI’s underperformance remains the same, resulting in an increase in false negative clades (<xref ref-type="supplementary-material" rid="sup1">supplementary fig. S8</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online), though TASTI performs similarly to MP-EST and STELLS2 with regard to false positive clades (<xref ref-type="supplementary-material" rid="sup1">supplementary fig. S7</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online).
</p>
      <fig id="evaa022-F6" orientation="portrait" position="float">
        <label><sc>Fig</sc>. 6.</label>
        <caption>
          <p>—Accuracy of the competing methods’ estimators of <italic>σ</italic> as a function of the number of input gene trees in the four-taxon setting. Accuracy is based on the average RF distance between the estimated and true species trees across 100 simulated replicated of <italic>K</italic> loci, with <italic>K</italic> ranging from 10 to 10<sup>3</sup>. We considered a migration rate <italic>M </italic>=<italic> </italic>5 as well as the unstructured scenario.</p>
        </caption>
        <graphic xlink:href="evaa022f6"/>
      </fig>
    </sec>
    <sec>
      <title>Application to Data from the <italic>Anopheles gambiae</italic> Complex</title>
      <p>The <italic>Anopheles gambiae</italic> complex comprised several morphologically indistinguishable yet genetically different species of mosquitos living in sympatry in sub-Saharan Africa (<xref rid="evaa022-B8" ref-type="bibr">Davidson 1962</xref>). Though the species belonging to the <italic>A.</italic> <italic>gambiae</italic> complex are closely related, only a small fraction of them possess significant malaria vectorial capacity. Studying their ancestry is critical as it may lead to key insights regarding how evolutionary history affects the development of traits that drive successful malaria vectors (<xref rid="evaa022-B62" ref-type="bibr">Neafsey et al. 2015</xref>). <xref rid="evaa022-B19" ref-type="bibr">Fontaine et al. (2015)</xref> originally studied six species in this complex: <italic>Anopheles arabiensis</italic>, <italic>Anopheles coluzzii</italic>, <italic>A.</italic> <italic>gambiae sensu stricto</italic>, <italic>Anopheles melus</italic>, <italic>Anopheles merus</italic>, and <italic>Anopheles quadriannulatus</italic>. In their work, they identified that two of the most important malaria vectors in the complex, <italic>A. arabiensis</italic> and <italic>A. gambiae</italic>, are in fact not the most closely related. However, the similarities in their genome could be attributed to introgression between them found on their autosomes. <xref rid="evaa022-B89" ref-type="bibr">Wen, Yu, Hahn, et al. (2016</xref>) built on the analyses of <xref rid="evaa022-B19" ref-type="bibr">Fontaine et al. (2015)</xref> by applying a phylogenetic network model to the <italic>Anopheles</italic> data.</p>
      <p>Previously, however, <xref rid="evaa022-B45" ref-type="bibr">Lehmann et al. (1998)</xref> found significant evidence for population structure within the <italic>A.</italic> <italic>gambiae</italic> complex. They note that, though anopheline species are broadly present across Africa, there are regions where populations generally cannot establish, thereby isolating some subpopulations. Moreover, though studies have found anopheline species to be fairly homogenous over long ranges within a given environment, different ecoclimatological environments (e.g., dry savanna vs. humid coast) were found to drive selection, suggesting that the anopheline species may exhibit population structure across different environments (<xref rid="evaa022-B44" ref-type="bibr">Lehmann et al. 1997</xref>). Given the evidence for population structure, and that the phylogenetic signals found in this data set are more complex than one expects to find assuming incomplete lineage sorting in panmictic ancestral populations alone, we deemed this a viable system in which to apply TASTI. In what follows, we conduct analyses of the autosomes for the <italic>A.</italic> <italic>gambiae</italic> complex, using a seventh species, <italic>A. christyi</italic>, as an outgroup.</p>
      <p>A single individual from each of the six species was sequenced at high coverage. <xref rid="evaa022-B89" ref-type="bibr">Wen, Yu, Hahn, et al. (2016</xref>) subset these high-coverage samples to generate independent genomic regions. Because TASTI also assumes independent loci, we used these alignments as input. After subsetting by <xref rid="evaa022-B89" ref-type="bibr">Wen, Yu, Hahn, et al. (2016</xref>), an ample 2,791 independent alignments across the autosomes with an estimated mean length of 3.4 kb remained in this data set (<xref ref-type="supplementary-material" rid="sup1">figure S1</xref> of <xref rid="evaa022-B89" ref-type="bibr">Wen, Yu, Hahn, et al. [2016</xref>] shows a histogram of locus lengths). Following the procedures of both <xref rid="evaa022-B19" ref-type="bibr">Fontaine et al. (2015)</xref> and <xref rid="evaa022-B89" ref-type="bibr">Wen, Yu, Hahn, et al. (2016</xref>), we estimated maximum likelihood gene tree topologies under the GTR+Gamma model at each locus using RAxML (<xref rid="evaa022-B79" ref-type="bibr">Stamatakis 2014</xref>). <xref ref-type="supplementary-material" rid="sup1">Supplementary figure S11</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online, displays the distributions of input rooted triples estimated in this manner, revealing asymmetries among some of the distributions of topologies. Following <xref rid="evaa022-B89" ref-type="bibr">Wen, Yu, Hahn, et al. (2016</xref>), we also generated 100 bootstrap alignments at each locus and estimated the maximum likelihood topology for each bootstrap replicate. These bootstraps can be used to account for uncertainty in gene tree topology estimates, analogous to the Bayesian approach described by <xref rid="evaa022-B97" ref-type="bibr">Yu et al. (2012)</xref>. Briefly, let <italic>K</italic> be the number of loci, and for each locus <italic>k</italic>, let <inline-formula id="IE181"><mml:math id="IM181"><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> be the <italic>q</italic> different gene tree topologies estimated at that locus from the bootstrap alignments. Denote <inline-formula id="IE182"><mml:math id="IM182"><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> as the proportion of times that gene tree topologies <inline-formula id="IE183"><mml:math id="IM183"><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:math></inline-formula> were, respectively, inferred from these alignments at locus <italic>k</italic>, such that <inline-formula id="IE184"><mml:math id="IM184"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Then, letting <inline-formula id="IE185"><mml:math id="IM185"><mml:mi mathvariant="script" class="calligraphy">G</mml:mi></mml:math></inline-formula> be the set of all gene tree topologies computed across the bootstrap replicates across <italic>K</italic> loci, we define for each <inline-formula id="IE186"><mml:math id="IM186"><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script" class="calligraphy">G</mml:mi></mml:mrow></mml:math></inline-formula> the sum of bootstrap probabilities associated with all loci whose topology is <italic>g</italic> as <italic>p<sub>g</sub></italic>. That is, for each <inline-formula id="IE187"><mml:math id="IM187"><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script" class="calligraphy">G</mml:mi></mml:mrow></mml:math></inline-formula>, we have <inline-formula id="IE188"><mml:math id="IM188"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> such that <inline-formula id="IE189"><mml:math id="IM189"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script" class="calligraphy">G</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>. Let <inline-formula id="IE190"><mml:math id="IM190"><mml:mrow><mml:msub><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi mathvariant="script" class="calligraphy">T</mml:mi><mml:mo> </mml:mo><mml:mtext>display</mml:mtext><mml:mo> </mml:mo><mml:mi mathvariant="script" class="calligraphy">T</mml:mi><mml:mo>′</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> be an indicator random variable that takes the value 1 if tree topology <inline-formula id="IE191"><mml:math id="IM191"><mml:mi mathvariant="script" class="calligraphy">T</mml:mi></mml:math></inline-formula> displays tree topology <inline-formula id="IE192"><mml:math id="IM192"><mml:mrow><mml:mi mathvariant="script" class="calligraphy">T</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>, and 0 otherwise. We thus modify the likelihood of a species tree in <xref ref-type="disp-formula" rid="E17">equation (17)</xref> to be
<disp-formula id="E19"><label>(19)</label><mml:math id="M19"><mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo>×</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo>×</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where
<disp-formula id="E20"><label>(20)</label><mml:math id="M20"><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>
and
<disp-formula id="E21"><label>(21)</label><mml:math id="M21"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script" class="calligraphy">G</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>g</mml:mi><mml:mo> </mml:mo><mml:mtext>displays</mml:mtext><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula>
denotes the sum of probabilities of gene trees displaying the rooted triple <inline-formula id="IE193"><mml:math id="IM193"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, such that <inline-formula id="IE194"><mml:math id="IM194"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>.</p>
      <p>To conduct our analyses, we first needed to obtain an estimate for the diversity parameter <inline-formula id="IE195"><mml:math id="IM195"><mml:mrow><mml:mo>θ</mml:mo><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mi>N</mml:mi><mml:mo>μ</mml:mo></mml:mrow></mml:math></inline-formula>. <xref rid="evaa022-B19" ref-type="bibr">Fontaine et al. (2015)</xref> sequenced several individuals from each of the six species under study in the complex at lower coverage. We computed the mean pairwise sequence difference <inline-formula id="IE196"><mml:math id="IM196"><mml:mrow><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> (<xref rid="evaa022-B81" ref-type="bibr">Tajima 1983</xref>) within populations after filtering out indels using VCFtools (<xref rid="evaa022-B7" ref-type="bibr">Danecek et al. 2011</xref>). Recalling that <inline-formula id="IE197"><mml:math id="IM197"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mo>θ</mml:mo></mml:mrow></mml:math></inline-formula> (<xref rid="evaa022-B81" ref-type="bibr">Tajima 1983</xref>), we proceeded by using <inline-formula id="IE198"><mml:math id="IM198"><mml:mrow><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> as an estimate of <italic>θ</italic>. Across the genome, however, the estimate of <italic>θ</italic> within each species in the complex varied by over an order of magnitude (from <inline-formula id="IE199"><mml:math id="IM199"><mml:mrow><mml:mo>∼</mml:mo><mml:mn>1.4</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> in <italic>Anopheles</italic> <italic>melas</italic> to <inline-formula id="IE200"><mml:math id="IM200"><mml:mrow><mml:mo>∼</mml:mo><mml:mn>1.4</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> in <italic>A. arabiensis</italic>). To approximate the ancestral estimates of <italic>θ</italic>, for any triple analyzed, we selected the maximum of the three corresponding estimates of <italic>θ</italic> as the value to pass to TASTI. The maximum was chosen to be robust to the bottleneck <xref rid="evaa022-B19" ref-type="bibr">Fontaine et al. (2015)</xref> suspected to have occurred in the recent ancestry of some species in the complex.</p>
      <p>Estimates of the effective population size of anopheline species are highly variable in the literature (<xref rid="evaa022-B82" ref-type="bibr">Taylor et al. 1993</xref>; <xref rid="evaa022-B57" ref-type="bibr">Michel et al. 2006</xref>; <xref rid="evaa022-B31" ref-type="bibr">Hodges et al. 2013</xref>). We therefore considered supplying TASTI effective population sizes across different orders of magnitude. By fitting a model with <inline-formula id="IE201"><mml:math id="IM201"><mml:mrow><mml:mi>N</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>3</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>4</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>5</mml:mn></mml:msup><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, we found that our results were robust to effective population size. This is reasonable, since while the choice of <italic>θ</italic> directly affects the coalescent rate in the evolutionary process, the effective population size in essence only sets an upper bound on the migration rate. Analyses presented here assume an effective population size of <inline-formula id="IE202"><mml:math id="IM202"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> across all populations.</p>
      <p>We applied TASTI to the original data set as well as 100 replicate data sets created by bootstrapping the original alignments. Parameter estimates with 95% confidence intervals for each estimated triple are shown in <xref ref-type="supplementary-material" rid="sup1">supplementary table S6</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online. Because <inline-formula id="IE203"><mml:math id="IM203"><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> lies on a continuum from complete structure to no structure, we used a testing procedure based on a parametric bootstrap to identify which triplets were estimated to be structured. The details of the testing procedure are in <xref ref-type="boxed-text" rid="evaa022-BOX1">Algorithm 1</xref>, and the <italic>P</italic>-values indicating support for ancestral structure over the unstructured case are in <xref ref-type="supplementary-material" rid="sup1">supplementary table S6</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online. Note that even though we simulate bootstrap replicate gene tree sets under the best-fit structured population model from TASTI, the two least frequent gene tree topologies are set to have the same expected counts to mimic the symmetry expected under the null hypothesis of no structure. We applied this procedure to each set of rooted triples setting the number of bootstrap samples to <italic>B </italic>=<italic> </italic>100.
<boxed-text id="evaa022-BOX1" position="float" orientation="portrait"><label>Algorithm 1</label><caption><p>Testing <inline-formula id="IE377"><mml:math id="IM204"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">H</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>:= panmictic populations versus <inline-formula><mml:math id="IM205"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">H</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:math></inline-formula> nonpanmictic populations among taxa <italic>x</italic>, <italic>y</italic>, and <italic>z</italic> using a parametric bootstrap</p></caption><p>1: Define <italic>B</italic>:= # of parametric bootstrap samples</p><p>2: <bold>for</bold> <italic>b</italic> in 1 to <italic>B</italic> <bold>do</bold></p><p>3:   Simulate 2,791 gene tree topologies based on <inline-formula><mml:math id="IM206"><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="IM207"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula> obtained from analysis of bootstrapped alignments (<xref ref-type="supplementary-material" rid="sup1">supplementary table S6</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online)</p><p>4:   Define observed counts <inline-formula><mml:math id="IM208"><mml:mrow><mml:msup><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula></p><p>5:   Define <italic>i</italic>:= <inline-formula><mml:math id="IM209"><mml:mrow><mml:mtext>argmax</mml:mtext><mml:mo>{</mml:mo><mml:msup><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msup><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula></p><p>6:      Define expected counts <inline-formula><mml:math id="IM210"><mml:mrow><mml:msup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>max</mml:mi><mml:mo>{</mml:mo><mml:msup><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msup><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mtext>mean</mml:mtext><mml:mo>{</mml:mo><mml:msubsup><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mtext>mean</mml:mtext><mml:mo>{</mml:mo><mml:msubsup><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>}</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula></p><p>7:   Compute <italic>P<sup>b</sup></italic> according to multinomial goodness-of-fit test based on the observed and expected counts using a <inline-formula><mml:math id="IM211"><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> distribution with 1 degree of freedom</p><p>8: Define <italic>P<sub>xyz</sub></italic>:= <inline-formula><mml:math id="IM212"><mml:mrow><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> combined into one <italic>P</italic>-value using Simes’ procedure (<xref rid="evaa022-B74" ref-type="bibr">Simes 1986</xref>)</p><p>9: Reject <inline-formula><mml:math id="IM213"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">H</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> when <inline-formula><mml:math id="IM214"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">xyz</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mo>α</mml:mo></mml:mrow></mml:math></inline-formula></p></boxed-text></p>
      <p>Our results are concordant with earlier findings, indicating ancestral structure is frequently found among species belonging to the <italic>A.</italic> <italic>gambiae</italic> complex. We identified four triplets that are exceptions to this rule based on the testing procedure in <xref ref-type="boxed-text" rid="evaa022-BOX1">Algorithm 1</xref> with <inline-formula id="IE204"><mml:math id="IM215"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>: ((CG)L), ((CG)R), ((LR)C), and ((LR)G). These results support a claim that the pairs <italic>A. coluzzii</italic> and <italic>A. gambiae</italic>, and <italic>A. melus</italic> and <italic>A. merus</italic>, derive from panmictic ancestral populations. The full six-species estimated species tree topology with branch confidence determined by bootstraps is presented in <xref ref-type="fig" rid="evaa022-F7">figure 7</xref>. Our analysis returns the nearly fully resolved species tree ((<italic>A. coluzzii</italic>, <italic>A. gambiae</italic>), (<italic>A. arabiensis</italic>, (<italic>A. melus</italic>, <italic>A. quadriannulatus</italic>), <italic>A. merus</italic>)) with strong bootstrap support for the clades.
</p>
      <fig id="evaa022-F7" orientation="portrait" position="float">
        <label><sc>Fig</sc>. 7.</label>
        <caption>
          <p>—Species tree topology for the <italic>Anopheles gambiae</italic> complex estimated by applying the modified mincut supertree algorithm to the set of all distinct three-species tree topologies inferred by TASTI, with bootstrap branch support obtained from 100 bootstrap replicates. The proportion of gray in each pie chart corresponds to the degree of support for each clade. That is, a fully gray chart implies 100% bootstrap support for a given clade.</p>
        </caption>
        <graphic xlink:href="evaa022f7"/>
      </fig>
      <p>In line with previous work, we estimated a well-supported clade between species <italic>A. coluzzii</italic> and <italic>A. gambiae</italic>. Though our analysis and the analyses of both <xref rid="evaa022-B19" ref-type="bibr">Fontaine et al. (2015)</xref> and <xref rid="evaa022-B89" ref-type="bibr">Wen, Yu, Hahn, et al. (2016</xref>) do not fully agree on the placement of the remaining four species in the phylogeny, because all three analyses assume a different model, the final results need not agree. It is notable, though, that the phylogeny inferred by TASTI in fact most resembles the phylogeny deduced from the X chromosome by <xref rid="evaa022-B19" ref-type="bibr">Fontaine et al. (2015)</xref>. The X chromosome of the anopheline species does not harbor signals of introgression (<xref rid="evaa022-B19" ref-type="bibr">Fontaine et al. 2015</xref>), so the species tree constructed from those gene trees may be more reliable in that the underlying evolutionary process is simpler to tease out. That TASTI infers a phylogeny from the autosomal data which is similar to that of the X chromosome is a reassuring result; however, identifying the correct model to assume is a nontrivial task which deserves thorough investigation in the future.</p>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>In this article, we developed TASTI, an algorithm that can be used to infer species trees from gene trees when a group of taxa’s ancestral populations are structured, which offers the possibility to operate on larger numbers of taxa with a supertree approach. TASTI improves upon previous approaches (e.g., GLASS, STEM, and Maximum Tree) that accurately infer trees under this scenario (provided input trees are known with certainty) because it exhibits robustness to empirical data.</p>
    <p>We recognize TASTI makes some simplifying assumptions about ancestral structure. Although the assumed persistent population structure may not be entirely realistic, it is plausible for this model to approximate signals of ancestral population structure that arise from organisms experiencing periodic separation based on environmental changes such as glaciations and sea level fluctuations (<xref rid="evaa022-B86" ref-type="bibr">Toms et al. 2014</xref>) or limited offspring dispersal (<xref rid="evaa022-B23" ref-type="bibr">Habets et al. 2006</xref>, <xref rid="evaa022-B22" ref-type="bibr">2007</xref>). Moreover, the assumption of no more than two subpopulations may for some species be insufficient. Additionally, even with only two subpopulations, one could forseeably introduce more complex species tree orientations by considering other ways in which an ancestry could be structured. However, for this model, such intricacies would come at the cost of total unidentifiability of the species tree model. This issue for phylogenetic inference has been discussed at length and is not unique to TASTI (<xref rid="evaa022-B5" ref-type="bibr">Chang 1996</xref>; <xref rid="evaa022-B16" ref-type="bibr">Evans and Warnow 2004</xref>; <xref rid="evaa022-B29" ref-type="bibr">Ho and Ané 2014</xref>; <xref rid="evaa022-B95" ref-type="bibr">Xu and Yang 2016</xref>).</p>
    <p>A substantial amount of recent research has focused on advancing models for estimating reticulate evolutionary histories caused by events such as hybridization and continuous gene flow (<xref rid="evaa022-B37" ref-type="bibr">Huson et al. 2005</xref>; <xref rid="evaa022-B2" ref-type="bibr">Baum 2007</xref>; <xref rid="evaa022-B56" ref-type="bibr">Meng and Kubatko 2009</xref>; <xref rid="evaa022-B21" ref-type="bibr">Gerard et al. 2011</xref>; <xref rid="evaa022-B98" ref-type="bibr">Yu et al. 2014</xref>; <xref rid="evaa022-B76" ref-type="bibr">Solís-Lemus and Ané 2016</xref>; <xref rid="evaa022-B85" ref-type="bibr">Tian and Kubatko 2016</xref>; <xref rid="evaa022-B88" ref-type="bibr">Wen and Nakhleh 2017</xref>; <xref rid="evaa022-B27" ref-type="bibr">Hey et al. 2018</xref>; <xref rid="evaa022-B51" ref-type="bibr">Long and Kubatko 2018</xref>). To contrast, our extensive simulations support the idea that asymmetries in gene tree topology distributions not observed under the standard multispecies coalescent, which are frequently attributed to interspecies gene flow, also arise under ancestral population structure (<xref rid="evaa022-B75" ref-type="bibr">Slatkin and Pollack 2008</xref>). However, such asymmetries in gene tree topology distributions are likely to be generated only under settings where the degree <italic>M</italic> of gene flow relative to the time <italic>τ</italic> between species divergences is small. Consider the internal branch of our structured population three-taxon model with topology ((AB)C). The waiting time to the first migration event (either from the first or the second subpopulation) is exponentially distributed with rate 2<italic>m</italic>, where <italic>m</italic> is the per-generation migration rate. Following <xref rid="evaa022-B12" ref-type="bibr">DeGiorgio and Rosenberg (2016)</xref>, the probability of no migration event on the internal branch of length <italic>t</italic> generations (i.e., neither lineage migrates) is <inline-formula id="IE216"><mml:math id="IM216"><mml:mrow><mml:mtext>exp</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>m</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mtext>exp</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>M</mml:mi><mml:mo>τ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE217"><mml:math id="IM217"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mi>N</mml:mi><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mo>θ</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE218"><mml:math id="IM218"><mml:mrow><mml:mo>τ</mml:mo><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mo>θ</mml:mo><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are scaled in mutation units. Moreover, the probability that the first event above the root is a coalescence event that would lead to gene tree topology <inline-formula id="IE219"><mml:math id="IM219"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is <inline-formula id="IE220"><mml:math id="IM220"><mml:mrow><mml:mtext>exp</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>m</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>6</mml:mn><mml:mi>N</mml:mi><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mtext>exp</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>M</mml:mi><mml:mo>τ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:mi>M</mml:mi><mml:mo>θ</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, which is arbitrarily close to one for <italic>M</italic> small enough with fixed <italic>τ</italic>. This result indicates that asymmetries in gene tree distributions will manifest in scenarios when <inline-formula id="IE221"><mml:math id="IM221"><mml:mrow><mml:mi>M</mml:mi><mml:mo>τ</mml:mo></mml:mrow></mml:math></inline-formula> is small—that is, when gene flow between subpopulations is infrequent on the time scale separating species splits.</p>
    <p>Though population structure is often explored in analyses of evolutionary histories (e.g., <italic>F</italic>-statistics such as <italic>F</italic><sub>ST</sub> [<xref rid="evaa022-B93" ref-type="bibr">Wright 1949</xref>; <xref rid="evaa022-B87" ref-type="bibr">Weir and Cockerham 1984</xref>] and software such as STRUCTURE [<xref rid="evaa022-B67" ref-type="bibr">Pritchard et al. 2000]</xref> for exploring population structure enjoy widespread use), model-based approaches incorporating such structure within species inference frameworks have been lacking. Our analyses of the <italic>A.</italic> <italic>gambiae</italic> complex data further demonstrate, when comparing to the work of <xref rid="evaa022-B89" ref-type="bibr">Wen, Yu, Hahn, et al. (2016</xref>) and <xref rid="evaa022-B19" ref-type="bibr">Fontaine et al. (2015)</xref>, that similar phylogenies can be inferred when assuming either a reticulate history or ancestral population structure. Indeed, the identifiability of such histories given gene tree topologies alone is severely limited or impossible. An investigation via comprehensive simulation studies of how distributions of gene tree branch lengths differ under various evolutionary assumptions such as hybridization and population structure may provide key insights into selection of an appropriate evolutionary model.</p>
    <p>A promising alternative, especially in the absence of external information, would reformulate TASTI in terms of a hypothesis test. That is, it may be meaningful to test for significant confidence in ancestral structure versus unstructured populations using a bootstrapping approach. Moreover, a different test could assess the likelihood of ancestral structure versus hybridization, though addressing such a question may be challenging based on topology data alone. Further work remains in examining how phylogenetic signals differ under these various modeling assumptions, such that an appropriate model may be determined on a case-by-case basis.</p>
    <p>If possible, external information or expert opinion can be used to aid in model performance. In the case of identifiability, external knowledge can be supplied to restrict the domain of certain free parameters, namely the divergence times, such that the model becomes identifiable (<xref rid="evaa022-B34" ref-type="bibr">Huelsenbeck et al. 2008</xref>). Models equally likely to produce a given distribution of gene tree topologies can further be evaluated by more closely examining branch lengths or molecular sequences (<xref rid="evaa022-B99" ref-type="bibr">Yu and Nakhleh 2015</xref>). External information in the form of Bayesian prior distributions can boost the performance of gene tree inference as well (<xref rid="evaa022-B36" ref-type="bibr">Huelsenbeck and Ronquist 2001</xref>; <xref rid="evaa022-B35" ref-type="bibr">Huelsenbeck et al. 2004)</xref>. The more accurate the input data, the closer TASTI gets to achieving optimal performance. This is especially crucial when using data on gene trees with branch lengths. Simultaneous estimation of genes trees and the species tree from multilocus data in a Bayesian hierarchical framework has also proven effective and popular (<xref rid="evaa022-B48" ref-type="bibr">Liu and Pearl 2007</xref>; <xref rid="evaa022-B47" ref-type="bibr">Liu 2008</xref>; <xref rid="evaa022-B25" ref-type="bibr">Heled and Drummond 2010</xref>; <xref rid="evaa022-B90" ref-type="bibr">Wen, Yu, and Nakhleh 2016</xref>; <xref rid="evaa022-B101" ref-type="bibr">Zhang et al. 2017</xref>), and an extension of TASTI to such a framework may be powerful.</p>
    <p>Some avenues are available to reduce computation time and improve performance in analyses with larger numbers of species. Maximum pseudolikelihood methods based on groups of rooted triples have been proposed both for the standard multispecies coalescent with incomplete lineage sorting (<xref rid="evaa022-B50" ref-type="bibr">Liu, Yu, and Pearl 2010</xref>) and with hybridization (<xref rid="evaa022-B99" ref-type="bibr">Yu and Nakhleh 2015</xref>; <xref rid="evaa022-B76" ref-type="bibr">Solís-Lemus and Ané 2016</xref>). These approaches have been shown to reduce computational burden, an important feature given that, even with greatly diminishing the computational task using a supertree approach, TASTI’s computation time grows with the number of taxa at a rate of <inline-formula id="IE222"><mml:math id="IM222"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>3</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Thus, a pseudolikelihood method for taxa with ancestral population structure would be a useful extension to our work. Finally, although we find favorable performance of the modified mincut supertree algorithm of <xref rid="evaa022-B63" ref-type="bibr">Page (2002)</xref>, the effect of alternative supertree construction algorithms (<xref rid="evaa022-B92" ref-type="bibr">Wilkinson et al. 2005</xref>) could nevertheless be explored.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data Availability</title>
    <p>Independent alignments of high-depth samples from the <italic>Anopheles</italic> <italic>gambiae</italic> complex, first generated by <xref rid="evaa022-B89" ref-type="bibr">Wen, Yu, Hahn, et al. (2016</xref>), are available from the Dryad Digital Repository: <ext-link ext-link-type="doi" xlink:href="10.5061/dryad.tn47c">http://dx.doi.org/10.5061/dryad.tn47c</ext-link>. The VCF files for low-depth samples from the <italic>A. gambiae</italic> complex, detailed by <xref rid="evaa022-B19" ref-type="bibr">Fontaine et al. (2015)</xref>, are also available from the Dryad Digital Repository: <ext-link ext-link-type="doi" xlink:href="10.5061/dryad.f4114">http://dx.doi.org/10.5061/dryad.f4114</ext-link>. An R package, called TASTI, containing the functions used to implement the core analyses presented here is available for download from <ext-link ext-link-type="uri" xlink:href="https://github.com/hillarykoch/TASTI">https://github.com/hillarykoch/TASTI</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>evaa022_Supplementary_Data</label>
      <media xlink:href="evaa022_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgments</title>
    <p>This work was supported by National Science Foundation (Grant Nos. DEB-1753489, DEB-1949268, and BCS-2001063), National Institutes of Health (Grant No. R35-GM128590), the Alfred P. Sloan Foundation, a National Institute of General Medical Sciences-funded training grant on Computation, Bioinformatics and Statistics (Predoctoral Training Program T32GM102057), and by a National Human Genome Research Institute pre-doctoral fellowship (1F31HG010574-01). Portions of this research were conducted with Advanced CyberInfrastructure computational resources provided by the Institute for CyberScience at Pennsylvania State University.</p>
  </ack>
  <ref-list id="ref1">
    <title>Literature Cited</title>
    <ref id="evaa022-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Allman</surname><given-names>ES</given-names></name>, <name name-style="western"><surname>Degnan</surname><given-names>JH</given-names></name>, <name name-style="western"><surname>Rhodes</surname><given-names>JA.</given-names></name></person-group><year>2011</year><article-title>Determining species tree topologies from clade probabilities under the coalescent</article-title>. <source>J Theor Biol</source>. <volume>289</volume>:<fpage>96</fpage>–<lpage>106</lpage>.<pub-id pub-id-type="pmid">21867714</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Baum</surname><given-names>DA.</given-names></name></person-group><year>2007</year><article-title>Concordance trees, concordance factors, and the exploration of reticulate genealogy</article-title>. <source>Taxon</source><volume>56</volume>(<issue>2</issue>):<fpage>417</fpage>–<lpage>426</lpage>.</mixed-citation>
    </ref>
    <ref id="evaa022-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Burgess</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Yang</surname><given-names>Z.</given-names></name></person-group><year>2008</year><article-title>Estimation of hominoid ancestral population sizes under Bayesian coalescent models incorporating mutation rate variation and sequencing errors</article-title>. <source>Mol Biol Evol</source>. <volume>25</volume>(<issue>9</issue>):<fpage>1979</fpage>–<lpage>1994</lpage>.<pub-id pub-id-type="pmid">18603620</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B4">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Casella</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Berger</surname><given-names>RL.</given-names></name></person-group><year>2002</year><source>Statistical inference</source>. Vol. <volume>2</volume><publisher-loc>Pacific Grove (CA</publisher-loc>): <publisher-name>Duxbury</publisher-name>.</mixed-citation>
    </ref>
    <ref id="evaa022-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chang</surname><given-names>JT.</given-names></name></person-group><year>1996</year><article-title>Full reconstruction of Markov models on evolutionary trees: identifiability and consistency</article-title>. <source>Math Biosci</source>. <volume>137</volume>(<issue>1</issue>):<fpage>51</fpage>–<lpage>73</lpage>.<pub-id pub-id-type="pmid">8854662</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cranston</surname><given-names>KA</given-names></name>, <name name-style="western"><surname>Hurwitz</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Ware</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Stein</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Wing</surname><given-names>RA.</given-names></name></person-group><year>2009</year><article-title>Species trees from highly incongruent gene trees in rice</article-title>. <source>Syst Biol</source>. <volume>583</volume>:<fpage>489</fpage>–<lpage>600</lpage>.</mixed-citation>
    </ref>
    <ref id="evaa022-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Danecek</surname><given-names>P</given-names></name></person-group>, 
<etal>et al</etal><year>2011</year><article-title>The variant call format and VCFtools</article-title>. <source>Bioinformatics</source>. <volume>27</volume>(<issue>15</issue>):<fpage>2156</fpage>–<lpage>2158</lpage>.<pub-id pub-id-type="pmid">21653522</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Davidson</surname><given-names>G.</given-names></name></person-group><year>1962</year><article-title><italic>Anopheles gambiae</italic> complex</article-title>. <source>Nature</source><volume>196</volume>(<issue>4857</issue>):<fpage>907</fpage>.</mixed-citation>
    </ref>
    <ref id="evaa022-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>DeGiorgio</surname><given-names>M</given-names></name></person-group>, 
<etal>et al</etal><year>2014</year><article-title>An empirical evaluation of two-stage species tree inference strategies using a multilocus dataset from North American pines</article-title>. <source>BMC Evol Biol</source>. <volume>14</volume>(<issue>1</issue>):<fpage>67</fpage>.<pub-id pub-id-type="pmid">24678701</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>DeGiorgio</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Degnan</surname><given-names>JH.</given-names></name></person-group><year>2010</year><article-title>Fast and consistent estimation of species trees using supermatrix rooted triples</article-title>. <source>Mol Biol Evol</source>. <volume>27</volume>(<issue>3</issue>):<fpage>552</fpage>–<lpage>569</lpage>.<pub-id pub-id-type="pmid">19833741</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>DeGiorgio</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Degnan</surname><given-names>JH.</given-names></name></person-group><year>2014</year><article-title>Robustness to divergence time underestimation when inferring species trees from estimated gene trees</article-title>. <source>Syst Biol</source>. <volume>64</volume>:<fpage>66</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">25246662</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>DeGiorgio</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Rosenberg</surname><given-names>NA.</given-names></name></person-group><year>2016</year><article-title>Consistency and inconsistency of consensus methods for estimating species trees from gene trees</article-title>. <source>Theor Popul Biol</source>. <volume>110</volume>:<fpage>12</fpage>–<lpage>24</lpage>.<pub-id pub-id-type="pmid">27086043</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Degnan</surname><given-names>JS</given-names></name>, <name name-style="western"><surname>DeGiorgio</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Bryant</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Rosenberg</surname><given-names>NA.</given-names></name></person-group><year>2009</year><article-title>Properties of consensus methods for inferring species trees from gene trees</article-title>. <source>Syst Biol</source>. <volume>58</volume>(<issue>1</issue>):<fpage>35</fpage>–<lpage>54</lpage>.<pub-id pub-id-type="pmid">20525567</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Drummond</surname><given-names>AJ</given-names></name>, <name name-style="western"><surname>Rambaut</surname><given-names>A.</given-names></name></person-group><year>2007</year><article-title>Beast: Bayesian evolutionary analysis by sampling trees</article-title>. <source>BMC Evol Biol</source>. <volume>7</volume>(<issue>1</issue>):<fpage>214</fpage>.<pub-id pub-id-type="pmid">17996036</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Escobar</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Zea</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Sánchez</surname><given-names>JA.</given-names></name></person-group><year>2012</year><article-title>Phylogenetic relationships among the Caribbean members of the <italic>Cliona viridis</italic> complex (Porifera, Demospongiae, Hadromerida) using nuclear and mitochondrial DNA sequences</article-title>. <source>Mol Phylogenet Evol</source>. <volume>64</volume>(<issue>2</issue>):<fpage>271</fpage>–<lpage>284</lpage>.<pub-id pub-id-type="pmid">22510309</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Evans</surname><given-names>SN</given-names></name>, <name name-style="western"><surname>Warnow</surname><given-names>T.</given-names></name></person-group><year>2004</year><article-title>Unidentifiable divergence times in rates-across-sites models</article-title>. <source>IEEE/ACM Trans Comput Biol Bioinform</source>. <volume>1</volume>(<issue>3</issue>):<fpage>130</fpage>–<lpage>134</lpage>.<pub-id pub-id-type="pmid">17048388</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Felsenstein</surname><given-names>J.</given-names></name></person-group><year>1989</year><article-title>Phylip—phylogeny inference package</article-title>. <source>Cladistics</source><volume>5</volume>:<fpage>164</fpage>–<lpage>166</lpage>.</mixed-citation>
    </ref>
    <ref id="evaa022-B18">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Felsenstein</surname><given-names>J.</given-names></name></person-group><year>2004</year><source>Inferring phylogenies</source>. Vol. <volume>2</volume><publisher-loc>Sunderland (MA)</publisher-loc>: <publisher-name>Sinauer Associates</publisher-name>.</mixed-citation>
    </ref>
    <ref id="evaa022-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fontaine</surname><given-names>MC</given-names></name></person-group>, 
<etal>et al</etal><year>2015</year><article-title>Extensive introgression in a malaria vector species complex revealed by phylogenomics</article-title>. <source>Science</source><volume>347</volume>(<issue>6217</issue>):<fpage>1258524</fpage>.<pub-id pub-id-type="pmid">25431491</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Garrigan</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Mobasher</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Kingan</surname><given-names>SB</given-names></name>, <name name-style="western"><surname>Wilder</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Hammer</surname><given-names>MF.</given-names></name></person-group><year>2005</year><article-title>Deep haplotype divergence and long-range linkage disequilibrium at xp21.1 provide evidence that humans descend from a structured ancestral population</article-title>. <source>Genetics</source><volume>170</volume>(<issue>4</issue>):<fpage>1849</fpage>–<lpage>1856</lpage>.<pub-id pub-id-type="pmid">15937130</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gerard</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Gibbs</surname><given-names>HL</given-names></name>, <name name-style="western"><surname>Kubatko</surname><given-names>L.</given-names></name></person-group><year>2011</year><article-title>Estimating hybridization in the presence of coalescence using phylogenetic intraspecific sampling</article-title>. <source>BMC Evol Biol</source>. <volume>11</volume>(<issue>1</issue>):<fpage>291</fpage>.<pub-id pub-id-type="pmid">21978073</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Habets</surname><given-names>MG</given-names></name>, <name name-style="western"><surname>Czaran</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Hoekstra</surname><given-names>RF</given-names></name>, <name name-style="western"><surname>De Visser</surname><given-names>JAG.</given-names></name></person-group><year>2007</year><article-title>Spatial structure inhibits the rate of invasion of beneficial mutations in asexual populations</article-title>. <source>Proc R Soc B</source>. <volume>274</volume>(<issue>1622</issue>):<fpage>2139</fpage>–<lpage>2143</lpage>.</mixed-citation>
    </ref>
    <ref id="evaa022-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Habets</surname><given-names>MG</given-names></name>, <name name-style="western"><surname>Rozen</surname><given-names>DE</given-names></name>, <name name-style="western"><surname>Hoekstra</surname><given-names>RF</given-names></name>, <name name-style="western"><surname>de Visser</surname><given-names>JAG.</given-names></name></person-group><year>2006</year><article-title>The effect of population structure on the adaptive radiation of microbial populations evolving in spatially structured environments</article-title>. <source>Ecol Lett</source>. <volume>9</volume>(<issue>9</issue>):<fpage>1041</fpage>–<lpage>1048</lpage>.<pub-id pub-id-type="pmid">16925653</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hasegawa</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Kishino</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Yano</surname><given-names>T.</given-names></name></person-group><year>1985</year><article-title>Dating of the human-ape splitting by a molecular clock of mitochondrial DNA</article-title>. <source>J Mol Evol</source>. <volume>22</volume>(<issue>2</issue>):<fpage>160</fpage>–<lpage>174</lpage>.<pub-id pub-id-type="pmid">3934395</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Heled</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Drummond</surname><given-names>AJ.</given-names></name></person-group><year>2010</year><article-title>Bayesian inference of species trees from multilocus data</article-title>. <source>Mol Biol Evol</source>. <volume>27</volume>(<issue>3</issue>):<fpage>570</fpage>–<lpage>580</lpage>.<pub-id pub-id-type="pmid">19906793</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Helmkamp</surname><given-names>LJ</given-names></name>, <name name-style="western"><surname>Jewett</surname><given-names>EM</given-names></name>, <name name-style="western"><surname>Rosenberg</surname><given-names>NA.</given-names></name></person-group><year>2012</year><article-title>Improvements to a class of distance matrix methods for inferring species trees from gene trees</article-title>. <source>J Comput Biol</source>. <volume>19</volume>(<issue>6</issue>):<fpage>632</fpage>–<lpage>649</lpage>.<pub-id pub-id-type="pmid">22697239</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hey</surname><given-names>J</given-names></name></person-group>, 
<etal>et al</etal><year>2018</year><article-title>Phylogeny estimation by integration over isolation with migration models</article-title>. <source>Mol Biol Evol</source>. <volume>35</volume>(<issue>11</issue>):<fpage>2805</fpage>–<lpage>2818</lpage>.<pub-id pub-id-type="pmid">30137463</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hey</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Nielsen</surname><given-names>R.</given-names></name></person-group><year>2007</year><article-title>Integration within the Felsenstein equation for improved Markov chain Monte Carlo methods in population genetics</article-title>. <source>Proc Natl Acad Sci U S A</source>. <volume>104</volume>(<issue>8</issue>):<fpage>2785</fpage>–<lpage>2790</lpage>.<pub-id pub-id-type="pmid">17301231</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ho</surname><given-names>LST</given-names></name>, <name name-style="western"><surname>Ané</surname><given-names>C.</given-names></name></person-group><year>2014</year><article-title>Intrinsic inference difficulties for trait evolution with Ornstein-Uhlenbeck models</article-title>. <source>Methods Ecol Evol</source>. <volume>5</volume>(<issue>11</issue>):<fpage>1133</fpage>–<lpage>1146</lpage>.</mixed-citation>
    </ref>
    <ref id="evaa022-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hobolth</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Norvang Andersen</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Mailund</surname><given-names>T.</given-names></name></person-group><year>2011</year><article-title>On computing the coalescence time density in an isolation-with-migration model with few samples</article-title>. <source>Genetics</source><volume>187</volume>(<issue>4</issue>):<fpage>1241</fpage>–<lpage>1243</lpage>.<pub-id pub-id-type="pmid">21321131</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hodges</surname><given-names>TK</given-names></name></person-group>, 
<etal>et al</etal><year>2013</year><article-title>Large fluctuations in the effective population size of the malaria mosquito <italic>Anopheles gambiae</italic> s.s. during vector control cycle</article-title>. <source>Evol Appl</source>. <volume>6</volume>(<issue>8</issue>):<fpage>1171</fpage>–<lpage>1183</lpage>.<pub-id pub-id-type="pmid">24478799</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hudson</surname><given-names>RR.</given-names></name></person-group><year>1983</year><article-title>Testing the constant-rate neutral allele model with protein sequence data</article-title>. <source>Evolution</source><volume>37</volume>(<issue>1</issue>):<fpage>203</fpage>–<lpage>217</lpage>.<pub-id pub-id-type="pmid">28568026</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hudson</surname><given-names>RR.</given-names></name></person-group><year>2002</year><article-title>Generating samples under a wright-fisher neutral model of genetic variation</article-title>. <source>Bioinformatics</source><volume>18</volume>(<issue>2</issue>):<fpage>337</fpage>–<lpage>338</lpage>.<pub-id pub-id-type="pmid">11847089</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Huelsenbeck</surname><given-names>JP</given-names></name>, <name name-style="western"><surname>Joyce</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Lakner</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Ronquist</surname><given-names>F.</given-names></name></person-group><year>2008</year><article-title>Bayesian analysis of amino acid substitution models</article-title>. <source>Philos Trans R Soc B</source>. <volume>363</volume>(<issue>1512</issue>):<fpage>3941</fpage>–<lpage>3953</lpage>.</mixed-citation>
    </ref>
    <ref id="evaa022-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Huelsenbeck</surname><given-names>JP</given-names></name>, <name name-style="western"><surname>Larget</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Alfaro</surname><given-names>ME.</given-names></name></person-group><year>2004</year><article-title>Bayesian phylogenetic model selection using reversible jump Markov chain Monte Carlo</article-title>. <source>Mol Biol Evol</source>. <volume>21</volume>(<issue>6</issue>):<fpage>1123</fpage>–<lpage>1133</lpage>.<pub-id pub-id-type="pmid">15034130</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Huelsenbeck</surname><given-names>JP</given-names></name>, <name name-style="western"><surname>Ronquist</surname><given-names>F.</given-names></name></person-group><year>2001</year><article-title>MRBAYES: Bayesian inference of phylogenetic trees</article-title>. <source>Bioinformatics</source><volume>17</volume>(<issue>8</issue>):<fpage>754</fpage>–<lpage>755</lpage>.<pub-id pub-id-type="pmid">11524383</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B37">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Huson</surname><given-names>DH</given-names></name>, <name name-style="western"><surname>Klöpper</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Lockhart</surname><given-names>PJ</given-names></name>, <name name-style="western"><surname>Steel</surname><given-names>MA.</given-names></name></person-group><year>2005</year><chapter-title>Reconstruction of reticulate networks from gene trees</chapter-title> In: <source>Annual International Conference on Research in Computational Molecular Biology</source>; 2005 May 14; Berlin, Heidelberg: <publisher-name>Springer</publisher-name> p. <fpage>233</fpage>–<lpage>249</lpage>.</mixed-citation>
    </ref>
    <ref id="evaa022-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jewett</surname><given-names>EM</given-names></name>, <name name-style="western"><surname>Rosenberg</surname><given-names>NA.</given-names></name></person-group><year>2012</year><article-title>iGLASS: an improvement to the GLASS method for estimating species trees from gene trees</article-title>. <source>J Comput Biol</source>. <volume>19</volume>(<issue>3</issue>):<fpage>293</fpage>–<lpage>315</lpage>.<pub-id pub-id-type="pmid">22216756</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Johnson</surname><given-names>BR</given-names></name></person-group>, 
<etal>et al</etal><year>2013</year><article-title>Phylogenomics resolves evolutionary relationships among ants, bees, and wasps</article-title>. <source>Curr Biol</source>. <volume>23</volume>(<issue>20</issue>):<fpage>2058</fpage>–<lpage>2062</lpage>.<pub-id pub-id-type="pmid">24094856</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kingman</surname><given-names>JFC.</given-names></name></person-group><year>1982</year><article-title>The coalescent</article-title>. <source>Stoch Proc Appl</source>. <volume>13</volume>(<issue>3</issue>):<fpage>235</fpage>–<lpage>248</lpage>.</mixed-citation>
    </ref>
    <ref id="evaa022-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kubatko</surname><given-names>LS</given-names></name>, <name name-style="western"><surname>Carstens</surname><given-names>BC</given-names></name>, <name name-style="western"><surname>Knowles</surname><given-names>LL.</given-names></name></person-group><year>2009</year><article-title>STEM: species tree estimation using maximum likelihood for gene trees under coalescence</article-title>. <source>Bioinformatics</source><volume>25</volume>(<issue>7</issue>):<fpage>971</fpage>–<lpage>973</lpage>.<pub-id pub-id-type="pmid">19211573</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Leaché</surname><given-names>AD</given-names></name>, <name name-style="western"><surname>Harris</surname><given-names>RB</given-names></name>, <name name-style="western"><surname>Rannala</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Yang</surname><given-names>Z.</given-names></name></person-group><year>2014</year><article-title>The influence of gene flow on species tree estimation: a simulation study</article-title>. <source>Syst Biol</source>. <volume>63</volume>(<issue>1</issue>):<fpage>17</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">23945075</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Leaché</surname><given-names>AD</given-names></name>, <name name-style="western"><surname>Rannala</surname><given-names>B.</given-names></name></person-group><year>2011</year><article-title>The accuracy of species tree estimation under simulation: a comparison of methods</article-title>. <source>Syst Biol</source>. <volume>60</volume>(<issue>2</issue>):<fpage>126</fpage>–<lpage>137</lpage>.<pub-id pub-id-type="pmid">21088009</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lehmann</surname><given-names>T</given-names></name></person-group>, 
<etal>et al</etal><year>1997</year><article-title>Microgeographic structure of <italic>Anopheles gambiae</italic> in western Kenya based on mtDNA and microsatellite loci</article-title>. <source>Mol Ecol</source>. <volume>6</volume>(<issue>3</issue>):<fpage>243</fpage>–<lpage>253</lpage>.<pub-id pub-id-type="pmid">9076979</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lehmann</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Hawley</surname><given-names>WA</given-names></name>, <name name-style="western"><surname>Grebert</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Collins</surname><given-names>FH.</given-names></name></person-group><year>1998</year><article-title>The effective population size of <italic>Anopheles gambiae</italic> in Kenya: implications for population structure</article-title>. <source>Mol Biol Evol</source>. <volume>15</volume>(<issue>3</issue>):<fpage>264</fpage>–<lpage>276</lpage>.<pub-id pub-id-type="pmid">9501493</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lin</surname><given-names>M</given-names></name></person-group>, 
<etal>et al</etal><year>2014</year><article-title>Mitochondrial genome rearrangements in the scleractinia/corallimorpharia complex: implications for coral phylogeny</article-title>. <source>Genome Biol Evol</source>. <volume>6</volume>(<issue>5</issue>):<fpage>1086</fpage>–<lpage>1095</lpage>.<pub-id pub-id-type="pmid">24769753</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Liu</surname><given-names>L.</given-names></name></person-group><year>2008</year><article-title>BEST: Bayesian estimation of species trees under the coalescent model</article-title>. <source>Bioinformatics</source><volume>24</volume>(<issue>21</issue>):<fpage>2542</fpage>–<lpage>2543</lpage>.<pub-id pub-id-type="pmid">18799483</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Liu</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Pearl</surname><given-names>DK.</given-names></name></person-group><year>2007</year><article-title>Species trees from gene trees: reconstructing Bayesian posterior distributions of a species phylogeny using estimated gene tree distributions</article-title>. <source>Syst Biol</source>. <volume>56</volume>(<issue>3</issue>):<fpage>504</fpage>–<lpage>514</lpage>.<pub-id pub-id-type="pmid">17562474</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Liu</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Yu</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Edwards</surname><given-names>SV.</given-names></name></person-group><year>2010</year><article-title>A maximum pseudo-likelihood approach for estimating species trees under the coalescent model</article-title>. <source>BMC Evol Biol</source>. <volume>10</volume>(<issue>1</issue>):<fpage>302</fpage>.<pub-id pub-id-type="pmid">20937096</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Liu</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Yu</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Pearl</surname><given-names>DK.</given-names></name></person-group><year>2010</year><article-title>Maximum tree: a consistent estimator of the species tree</article-title>. <source>J Math Biol</source>. <volume>60</volume>(<issue>1</issue>):<fpage>95</fpage>–<lpage>106</lpage>.<pub-id pub-id-type="pmid">19283383</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Long</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Kubatko</surname><given-names>LS.</given-names></name></person-group><year>2018</year><article-title>The effect of gene flow on coalescent-based species-tree inference</article-title>. <source>Syst Biol</source>. <volume>67</volume>(<issue>5</issue>):<fpage>770</fpage>–<lpage>785</lpage>.<pub-id pub-id-type="pmid">29566212</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mailund</surname><given-names>T</given-names></name></person-group>, 
<etal>et al</etal><year>2012</year><article-title>A new isolation with migration model along complete genomes infers very different divergence processes among closely related great ape species</article-title>. <source>PLoS Genet</source>. <volume>8</volume>(<issue>12</issue>):<fpage>e1003125</fpage>.<pub-id pub-id-type="pmid">23284294</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B53">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Marcussen</surname><given-names>T</given-names></name></person-group>, 
<etal>et al</etal><year>2014</year><article-title>Ancient hybridizations among the ancestral genomes of bread wheat</article-title>. <source>New Phytol</source>. <volume>345</volume>(<issue>6194</issue>):<fpage>1250092</fpage>.</mixed-citation>
    </ref>
    <ref id="evaa022-B55">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>McGuire</surname><given-names>JA</given-names></name></person-group>, 
<etal>et al</etal><year>2007</year><article-title>Mitochondrial introgression and incomplete lineage sorting through space and time: phylogenetics of crotaphytid lizards</article-title>. <source>Mol Phylogenet Evol</source>. <volume>61</volume>(<issue>12</issue>):<fpage>2879</fpage>–<lpage>2897</lpage>.</mixed-citation>
    </ref>
    <ref id="evaa022-B56">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Meng</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Kubatko</surname><given-names>LS.</given-names></name></person-group><year>2009</year><article-title>Detecting hybrid speciation in the presence of incomplete lineage sorting using gene tree incongruence: a model</article-title>. <source>Theor Popul Biol</source>. <volume>75</volume>(<issue>1</issue>):<fpage>35</fpage>–<lpage>45</lpage>.<pub-id pub-id-type="pmid">19038278</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B57">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Michel</surname><given-names>AP</given-names></name></person-group>, 
<etal>et al</etal><year>2006</year><article-title>Effective population size of <italic>Anopheles funestus</italic> chromosomal forms in Burkina Faso</article-title>. <source>Malar J</source>. <volume>5</volume>(<issue>1</issue>):<fpage>115</fpage>.<pub-id pub-id-type="pmid">17125511</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B58">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mirarab</surname><given-names>S</given-names></name></person-group>, 
<etal>et al</etal><year>2014</year><article-title>ASTRAL: genome-scale coalescent-based species tree estimation</article-title>. <source>Bioinformatics</source><volume>30</volume>(<issue>17</issue>):<fpage>i541</fpage>–<lpage>i548</lpage>.<pub-id pub-id-type="pmid">25161245</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B59">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mirarab</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Warnow</surname><given-names>T.</given-names></name></person-group><year>2015</year><article-title>ASTRAL-II: coalescent-based species tree estimation with many hundreds of taxa and thousands of genes</article-title>. <source>Bioinformatics</source><volume>31</volume>(<issue>12</issue>):<fpage>i44</fpage>–<lpage>i52</lpage>.<pub-id pub-id-type="pmid">26072508</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B60">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mossel</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Roch</surname><given-names>S.</given-names></name></person-group><year>2010</year><article-title>Incomplete lineage sorting: consistent phylogeny estimation from multiple loci</article-title>. <source>IEEE/ACM Trans Comput Biol Bioinform</source>. <volume>7</volume>:<fpage>166</fpage>–<lpage>171</lpage>.<pub-id pub-id-type="pmid">20150678</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B61">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nakhleh</surname><given-names>L.</given-names></name></person-group><year>2013</year><article-title>Computational approaches to species phylogeny inference and gene tree reconciliation</article-title>. <source>Trends Ecol Evol</source>. <volume>28</volume>(<issue>12</issue>):<fpage>719</fpage>–<lpage>728</lpage>.<pub-id pub-id-type="pmid">24094331</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B62">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Neafsey</surname><given-names>DE</given-names></name></person-group>, 
<etal>et al</etal><year>2015</year><article-title>Highly evolvable malaria vectors: the genomes of 16 <italic>Anopheles</italic> mosquitoes</article-title>. <source>Science</source><volume>347</volume>(<issue>6217</issue>):<fpage>1258522</fpage>.<pub-id pub-id-type="pmid">25554792</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B63">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Page</surname><given-names>RDM.</given-names></name></person-group><year>2002</year><chapter-title>Modified mincut supertrees</chapter-title> In: <person-group person-group-type="editor"><name name-style="western"><surname>Guigó</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Gusfield</surname><given-names>D</given-names></name></person-group>, editors. <source>Proceedings of the Second International Workshop on Algorithms in Bioinformatics (WABI, 2002 September 17)</source>. Vol. 2452 (Lecture Notes in Computer Science). <publisher-loc>Berlin (Germany</publisher-loc>). Berlin, Heidelberg: <publisher-name>Springer</publisher-name> p. <fpage>537</fpage>–<lpage>551</lpage>.</mixed-citation>
    </ref>
    <ref id="evaa022-B64">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pamilo</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Nei</surname><given-names>M.</given-names></name></person-group><year>1988</year><article-title>Relationships between gene trees and species trees</article-title>. <source>Mol Biol Evol</source>. <volume>5</volume>(<issue>5</issue>):<fpage>568</fpage>–<lpage>583</lpage>.<pub-id pub-id-type="pmid">3193878</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B65">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pei</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Wu</surname><given-names>Y.</given-names></name></person-group><year>2017</year><article-title>STELLS2: fast and accurate coalescent-based maximum likelihood inference of species trees from gene tree topologies</article-title>. <source>Bioinformatics</source><volume>33</volume>(<issue>12</issue>):<fpage>1789</fpage>–<lpage>1797</lpage>.<pub-id pub-id-type="pmid">28186220</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B66">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Peters</surname><given-names>RS</given-names></name></person-group>, 
<etal>et al</etal><year>2017</year><article-title>Evolutionary history of the hymenoptera</article-title>. <source>Curr Biol</source>. <volume>27</volume>(<issue>7</issue>):<fpage>1013</fpage>–<lpage>1018</lpage>.<pub-id pub-id-type="pmid">28343967</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B67">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pritchard</surname><given-names>JK</given-names></name>, <name name-style="western"><surname>Stephens</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Donnelly</surname><given-names>P.</given-names></name></person-group><year>2000</year><article-title>Inference of population structure using multilocus genotype data</article-title>. <source>Genetics</source><volume>155</volume>(<issue>2</issue>):<fpage>945</fpage>–<lpage>959</lpage>.<pub-id pub-id-type="pmid">10835412</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B68">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rambaut</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Grass</surname><given-names>NC.</given-names></name></person-group><year>1997</year><article-title>Seq-Gen: an application for the Monte Carlo simulation of DNA sequence evolution along phylogenetic trees</article-title>. <source>Bioinformatics</source><volume>13</volume>(<issue>3</issue>):<fpage>235</fpage>–<lpage>238</lpage>.</mixed-citation>
    </ref>
    <ref id="evaa022-B69">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Robinson</surname><given-names>DF</given-names></name>, <name name-style="western"><surname>Foulds</surname><given-names>LR.</given-names></name></person-group><year>1981</year><article-title>Comparison of phylogenetic trees</article-title>. <source>Math Biosci</source>. <volume>53</volume>(<issue>1–2</issue>):<fpage>131</fpage>–<lpage>147</lpage>.</mixed-citation>
    </ref>
    <ref id="evaa022-B70">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Ross</surname><given-names>SM.</given-names></name></person-group><year>2014</year><source>Introduction to probability models</source>. <publisher-name>Cambridge</publisher-name>: Academic Press.</mixed-citation>
    </ref>
    <ref id="evaa022-B71">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Salichos</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Rokas</surname><given-names>A.</given-names></name></person-group><year>2013</year><article-title>Inferring ancient divergences requires genes with strong phylogenetic signals</article-title>. <source>Nature</source><volume>497</volume>(<issue>7449</issue>):<fpage>327</fpage>–<lpage>331</lpage>.<pub-id pub-id-type="pmid">23657258</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B72">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Semple</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Steel</surname><given-names>MA.</given-names></name></person-group><year>2003</year><source>Phylogenetics</source>. Vol. <volume>24</volume><publisher-name>Oxford</publisher-name>: Oxford University Press.</mixed-citation>
    </ref>
    <ref id="evaa022-B73">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Shen</surname><given-names>X</given-names></name></person-group>, 
<etal>et al</etal><year>2016</year><article-title>Reconstructing the backbone of the <italic>Saccharomycotina</italic> yeast phylogeny using genome-scale data</article-title>. <source>G3</source><volume>6</volume>(<issue>12</issue>):<fpage>3927</fpage>–<lpage>3939</lpage>.<pub-id pub-id-type="pmid">27672114</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B74">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Simes</surname><given-names>RJ.</given-names></name></person-group><year>1986</year><article-title>An improved Bonferroni procedure for multiple tests of significance</article-title>. <source>Biometrika</source><volume>73</volume>(<issue>3</issue>):<fpage>751</fpage>–<lpage>754</lpage>.</mixed-citation>
    </ref>
    <ref id="evaa022-B75">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Slatkin</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Pollack</surname><given-names>JL.</given-names></name></person-group><year>2008</year><article-title>Subdivision in an ancestral species creates asymmetry in gene trees</article-title>. <source>Mol Biol Evol</source>. <volume>25</volume>(<issue>10</issue>):<fpage>2241</fpage>–<lpage>2246</lpage>.<pub-id pub-id-type="pmid">18689871</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B76">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Solís-Lemus</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Ané</surname><given-names>C.</given-names></name></person-group><year>2016</year><article-title>Inferring phylogenetic networks with maximum pseudolikelihood under incomplete lineage sorting</article-title>. <source>PLoS Genet</source>. <volume>12</volume>(<issue>3</issue>):<fpage>e1005896</fpage>.<pub-id pub-id-type="pmid">26950302</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B77">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Solís-Lemus</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Yang</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Ané</surname><given-names>C.</given-names></name></person-group><year>2016</year><article-title>Inconsistency of species tree methods under gene flow</article-title>. <source>Syst Biol</source>. <volume>65</volume>(<issue>5</issue>):<fpage>843</fpage>–<lpage>851</lpage>.<pub-id pub-id-type="pmid">27151419</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B78">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Song</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Liu</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Edwards</surname><given-names>SV</given-names></name>, <name name-style="western"><surname>Wu</surname><given-names>S.</given-names></name></person-group><year>2012</year><article-title>A phylogeny of birds based on over 1,500 loci collected by target enrichment and high-throughput sequencing</article-title>. <source>PLoS One</source><volume>8</volume>:<fpage>e54848</fpage>.</mixed-citation>
    </ref>
    <ref id="evaa022-B54">
      <mixed-citation publication-type="journal">Song S, 
<etal>et al</etal>
<year>2012</year>
<article-title>Resolving conflict in eutherian mammal phylogeny using phylogenomics and the multispecies coalescent model</article-title>. <source>Proc Natl Acad Sci U S A</source>. <volume>109</volume>(<issue>37</issue>):<fpage>14942</fpage>–<lpage>14947</lpage>.<pub-id pub-id-type="pmid">22930817</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B79">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Stamatakis</surname><given-names>A.</given-names></name></person-group><year>2014</year><article-title>RAxML version 8: a tool for phylogenetic analysis and post-analysis of large phylogenies</article-title>. <source>Bioinformatics</source><volume>30</volume>(<issue>9</issue>):<fpage>1312</fpage>–<lpage>1313</lpage>.<pub-id pub-id-type="pmid">24451623</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B80">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Steel</surname><given-names>MA.</given-names></name></person-group><year>1992</year><article-title>The complexity of reconstructing trees from qualitative characters and subtrees</article-title>. <source>J Classif</source>. <volume>9</volume>(<issue>1</issue>):<fpage>91</fpage>–<lpage>116</lpage>.</mixed-citation>
    </ref>
    <ref id="evaa022-B81">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tajima</surname><given-names>F.</given-names></name></person-group><year>1983</year><article-title>Evolutionary relationship of DNA sequences in finite populations</article-title>. <source>Genetics</source><volume>105</volume>(<issue>2</issue>):<fpage>437</fpage>–<lpage>460</lpage>.<pub-id pub-id-type="pmid">6628982</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B82">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Taylor</surname><given-names>CE</given-names></name>, <name name-style="western"><surname>Toure</surname><given-names>YT</given-names></name>, <name name-style="western"><surname>Coluzzi</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Petrarca</surname><given-names>V.</given-names></name></person-group><year>1993</year><article-title>Effective population size and persistence of <italic>Anopheles arabiensis</italic> during the dry season in West Africa</article-title>. <source>Med Vet Entomol</source>. <volume>7</volume>(<issue>4</issue>):<fpage>351</fpage>–<lpage>357</lpage>.<pub-id pub-id-type="pmid">8268490</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B83">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Thalmann</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Fischer</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Lankester</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Paabo</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Vigilant</surname><given-names>L.</given-names></name></person-group><year>2006</year><article-title>The complex evolutionary histories of gorillas: insights from genomic data</article-title>. <source>Mol Biol Evol</source>. <volume>24</volume>(<issue>1</issue>):<fpage>146</fpage>–<lpage>158</lpage>.<pub-id pub-id-type="pmid">17065595</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B84">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Than</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Ruths</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Nakhleh</surname><given-names>L.</given-names></name></person-group><year>2008</year><article-title>PhyloNet: a software package for analyzing and reconstructing reticulate evolutionary histories</article-title>. <source>BMC Bioinformatics</source><volume>9</volume>(<issue>1</issue>):<fpage>322</fpage>.<pub-id pub-id-type="pmid">18662388</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B85">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tian</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Kubatko</surname><given-names>LS.</given-names></name></person-group><year>2016</year><article-title>Distribution of coalescent histories under the coalescent model with gene flow</article-title>. <source>Mol Phylogenet Evol</source>. <volume>105</volume>:<fpage>177</fpage>–<lpage>192</lpage>.<pub-id pub-id-type="pmid">27614251</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B86">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Toms</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Compton</surname><given-names>JS</given-names></name>, <name name-style="western"><surname>Smale</surname><given-names>M</given-names></name>, <name name-style="western"><surname>von der Heyden</surname><given-names>S.</given-names></name></person-group><year>2014</year><article-title>Variation in palaeo-shorelines explains contemporary population genetic patterns of rocky shore species</article-title>. <source>Biol Lett</source>. <volume>10</volume>(<issue>6</issue>):<fpage>20140330</fpage>.<pub-id pub-id-type="pmid">24966206</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B87">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Weir</surname><given-names>BS</given-names></name>, <name name-style="western"><surname>Cockerham</surname><given-names>CC.</given-names></name></person-group><year>1984</year><article-title>Estimating F-statistics for the analysis of population structure</article-title>. <source>Evolution</source><volume>38</volume>(<issue>6</issue>):<fpage>1358</fpage>–<lpage>1370</lpage>.<pub-id pub-id-type="pmid">28563791</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B88">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wen</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Nakhleh</surname><given-names>L.</given-names></name></person-group><year>2017</year><article-title>Co-estimating reticulate phylogenies and gene trees from multi-locus sequence data</article-title>. <source>Syst Biol</source>. <volume>67</volume>(<issue>3</issue>):<fpage>439</fpage>–<lpage>457</lpage>.</mixed-citation>
    </ref>
    <ref id="evaa022-B89">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wen</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Yu</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Hahn</surname><given-names>MW</given-names></name>, <name name-style="western"><surname>Nakhleh</surname><given-names>L.</given-names></name></person-group><year>2016</year><article-title>Reticulate evolutionary history and extensive introgression in mosquito species revealed by phylogenetic network analysis</article-title>. <source>Mol Ecol</source>. <volume>25</volume>(<issue>11</issue>):<fpage>2361</fpage>–<lpage>2372</lpage>.<pub-id pub-id-type="pmid">26808290</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B90">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wen</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Yu</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Nakhleh</surname><given-names>L.</given-names></name></person-group><year>2016</year><article-title>Bayesian inference of reticulate phylogenies under the multispecies network coalescent</article-title>. <source>PLoS Genet</source>. <volume>12</volume>(<issue>5</issue>):<fpage>e1006006</fpage>.<pub-id pub-id-type="pmid">27144273</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B91">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>White</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Ané</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Dewey</surname><given-names>CN</given-names></name>, <name name-style="western"><surname>Larget</surname><given-names>BR</given-names></name>, <name name-style="western"><surname>Payseur</surname><given-names>BA.</given-names></name></person-group><year>2009</year><article-title>Fine-scale phylogenetic discordance across the house mouse genome</article-title>. <source>PLoS Genet</source>. <volume>5</volume>(<issue>11</issue>):<fpage>e1000729</fpage>.<pub-id pub-id-type="pmid">19936022</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B92">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wilkinson</surname><given-names>M</given-names></name></person-group>, 
<etal>et al</etal><year>2005</year><article-title>The shape of supertrees to come: tree shape related properties of fourteen supertree methods</article-title>. <source>Syst Biol</source>. <volume>54</volume>(<issue>3</issue>):<fpage>419</fpage>–<lpage>431</lpage>.<pub-id pub-id-type="pmid">16012108</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B93">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wright</surname><given-names>S.</given-names></name></person-group><year>1949</year><article-title>The genetical structure of populations</article-title>. <source>Ann Eugen</source>. <volume>15</volume>(<issue>4</issue>):<fpage>323</fpage>–<lpage>354</lpage>.</mixed-citation>
    </ref>
    <ref id="evaa022-B94">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wu</surname><given-names>Y.</given-names></name></person-group><year>2012</year><article-title>Coalescent-based species tree inference from gene tree topologies under incomplete lineage sorting by maximum likelihood</article-title>. <source>Evolution</source><volume>66</volume>(<issue>3</issue>):<fpage>763</fpage>–<lpage>775</lpage>.<pub-id pub-id-type="pmid">22380439</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B95">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Xu</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Yang</surname><given-names>Z.</given-names></name></person-group><year>2016</year><article-title>Challenges in species tree estimation under the multispecies coalescent model</article-title>. <source>Genetics</source><volume>204</volume>(<issue>4</issue>):<fpage>1353</fpage>–<lpage>1368</lpage>.<pub-id pub-id-type="pmid">27927902</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B96">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>Y</given-names></name></person-group>, 
<etal>et al</etal><year>2015</year><article-title>Dissecting molecular evolution in the highly diverse plant clade Caryophyllales using transcriptome sequencing</article-title>. <source>Mol Biol Evol</source>. <volume>32</volume>(<issue>8</issue>):<fpage>2001</fpage>–<lpage>2014</lpage>.<pub-id pub-id-type="pmid">25837578</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B97">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yu</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Degnan</surname><given-names>JH</given-names></name>, <name name-style="western"><surname>Nakhleh</surname><given-names>L.</given-names></name></person-group><year>2012</year><article-title>The probability of a gene tree topology within a phylogenetic network with applications to hybridization detection</article-title>. <source>PLoS Genet</source>. <volume>8</volume>(<issue>4</issue>):<fpage>e1002660</fpage>.<pub-id pub-id-type="pmid">22536161</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B98">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yu</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Dong</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Liu</surname><given-names>KJ</given-names></name>, <name name-style="western"><surname>Nakhleh</surname><given-names>L.</given-names></name></person-group><year>2014</year><article-title>Maximum likelihood inference of reticulate evolutionary histories</article-title>. <source>Proc Natl Acad Sci U S A</source>. <volume>111</volume>(<issue>46</issue>):<fpage>16448</fpage>–<lpage>16453</lpage>.<pub-id pub-id-type="pmid">25368173</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B99">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yu</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Nakhleh</surname><given-names>L.</given-names></name></person-group><year>2015</year><article-title>A maximum pseudo-likelihood approach for phylogenetic networks</article-title>. <source>BMC Genomics</source>. <volume>16</volume>(<issue>S10</issue>):<fpage>S10</fpage>.</mixed-citation>
    </ref>
    <ref id="evaa022-B100">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yu</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Than</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Degnan</surname><given-names>JH</given-names></name>, <name name-style="western"><surname>Nakhleh</surname><given-names>L.</given-names></name></person-group><year>2011</year><article-title>Coalescent histories on phylogenetic networks and detection of hybridization despite incomplete lineage sorting</article-title>. <source>Syst Biol</source>. <volume>60</volume>(<issue>2</issue>):<fpage>138</fpage>–<lpage>149</lpage>.<pub-id pub-id-type="pmid">21248369</pub-id></mixed-citation>
    </ref>
    <ref id="evaa022-B101">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Ogilvie</surname><given-names>HA</given-names></name>, <name name-style="western"><surname>Drummond</surname><given-names>AJ</given-names></name>, <name name-style="western"><surname>Stadler</surname><given-names>T.</given-names></name></person-group><year>2017</year><article-title>Bayesian inference of species networks from multilocus sequence data</article-title>. <source>Mol Biol Evol</source>. <volume>35</volume>(<issue>2</issue>):<fpage>504</fpage>–<lpage>517</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
