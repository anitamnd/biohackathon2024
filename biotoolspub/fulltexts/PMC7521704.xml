<?properties open_access?>
<?subarticle pcbi.1008194.r001?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput. Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">ploscomp</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7521704</article-id>
    <article-id pub-id-type="pmid">32936799</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008194</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-20-00463</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Bioengineering</subject>
          <subj-group>
            <subject>Genome Engineering</subject>
            <subj-group>
              <subject>Synthetic Genome Editing</subject>
              <subj-group>
                <subject>Crispr</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Bioengineering</subject>
          <subj-group>
            <subject>Genome Engineering</subject>
            <subj-group>
              <subject>Synthetic Genome Editing</subject>
              <subj-group>
                <subject>Crispr</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Synthetic Biology</subject>
          <subj-group>
            <subject>Synthetic Genomics</subject>
            <subj-group>
              <subject>Synthetic Genome Editing</subject>
              <subj-group>
                <subject>Crispr</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Synthetic Biology</subject>
          <subj-group>
            <subject>Synthetic Genomics</subject>
            <subj-group>
              <subject>Synthetic Genome Editing</subject>
              <subj-group>
                <subject>Crispr</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Functional Genomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Population Genetics</subject>
            <subj-group>
              <subject>Gene Pool</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Population Genetics</subject>
            <subj-group>
              <subject>Gene Pool</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Population Biology</subject>
          <subj-group>
            <subject>Population Genetics</subject>
            <subj-group>
              <subject>Gene Pool</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Health Care</subject>
          <subj-group>
            <subject>Health Care Policy</subject>
            <subj-group>
              <subject>Screening Guidelines</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Identification and Analysis</subject>
            <subj-group>
              <subject>Genetic Screens</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Discovering functional sequences with RELICS, an analysis method for CRISPR screens</article-title>
      <alt-title alt-title-type="running-head">Discovering functional sequences from CRISPR screens</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-9614-7370</contrib-id>
        <name>
          <surname>Fiaux</surname>
          <given-names>Patrick C.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Hsiuyi V.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Poshen B.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-4938-3834</contrib-id>
        <name>
          <surname>Chen</surname>
          <given-names>Aaron R.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0991-0951</contrib-id>
        <name>
          <surname>McVicker</surname>
          <given-names>Graham</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Project administration</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Bioinformatics and Systems Biology Graduate Program, University of California, San Diego, La Jolla, CA, Unites States of America</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Integrative Biology Laboratory, Salk Institute for Biological Studies, La Jolla, CA, Unites States of America</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Ludwig Institute for Cancer Research, La Jolla, CA, Unites States of America</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Division of Biological Sciences, University of California, San Diego, La Jolla, CA, Unites States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Ioshikhes</surname>
          <given-names>Ilya</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Ottawa, CANADA</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>pfiaux@ucsd.edu</email> (PCF); <email>gmcvicker@salk.edu</email> (GMV)</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <volume>16</volume>
    <issue>9</issue>
    <elocation-id>e1008194</elocation-id>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>3</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>7</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 Fiaux et al</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Fiaux et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1008194.pdf"/>
    <abstract>
      <p>CRISPR screens are a powerful technology for the identification of genome sequences that affect cellular phenotypes such as gene expression, survival, and proliferation. By targeting non-coding sequences for perturbation, CRISPR screens have the potential to systematically discover novel functional sequences, however, a lack of purpose-built analysis tools limits the effectiveness of this approach. Here we describe RELICS, a Bayesian hierarchical model for the discovery of functional sequences from CRISPR screens. RELICS specifically addresses many of the challenges of non-coding CRISPR screens such as the unknown locations of functional sequences, overdispersion in the observed single guide RNA counts, and the need to combine information across multiple pools in an experiment. RELICS outperforms existing methods with higher precision, higher recall, and finer-resolution predictions on simulated datasets. We apply RELICS to published CRISPR interference and CRISPR activation screens to predict and experimentally validate novel regulatory sequences that are missed by other analysis methods. In summary, RELICS is a powerful new analysis method for CRISPR screens that enables the discovery of functional sequences with unprecedented resolution and accuracy.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Non-coding genome sequences contain a disproportionate number of genetic variants associated with human traits and diseases, however, interpretation of non-coding genetic variants is difficult because the molecular function of most non-coding sequences is unknown. By perturbing the genome using CRISPR, the function of non-coding sequences can be tested. Here we develop a new computational tool, RELICS, for the analysis of high-throughput CRISPR screens in which thousands of genome sequences are perturbed in a single experiment. Using simulated data, we find that RELICS has higher accuracy and resolution than other analysis methods. We apply RELICS to existing datasets to discover novel functional sequences and verify these predictions with experiments. In summary, RELICS is a powerful new analysis method for the discovery of functional sequences from CRISPR screens.</p>
    </abstract>
    <funding-group>
      <funding-statement>This research was supported by NIH/NIAID grant 2R01AI107027-06; by NIH/NIDDK grant 1 R01 DK122607-01; by the National Cancer Institute funded Salk Institute Cancer Center (NIH/NCI CCSG: 2 P30 014195); by a gift from the Jacobs Foundation; by a fellowship from the H.A. and Mary K. Chapman Charitable Trust to P.C.F.; by a fellowship from the Jesse and Caryl Philips Foundation to P.C.F; by a Salk Alumni Fellowship to H.V.C; and by the Frederick B. Rentschler Developmental Chair to G.M. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="5"/>
      <table-count count="0"/>
      <page-count count="23"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2020-09-28</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All data were obtained from published papers or simulated. The formatted data that we used for analyses can be downloaded from figshare: <ext-link ext-link-type="uri" xlink:href="https://figshare.com/projects/RELICS_2_data/74376">https://figshare.com/projects/RELICS_2_data/74376</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All data were obtained from published papers or simulated. The formatted data that we used for analyses can be downloaded from figshare: <ext-link ext-link-type="uri" xlink:href="https://figshare.com/projects/RELICS_2_data/74376">https://figshare.com/projects/RELICS_2_data/74376</ext-link>.</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic>PLOS Computational Biology</italic> Methods paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>CRISPR screens perturb the genome to discover sequences that affect cellular phenotypes such as growth, survival, or gene expression. The first CRISPR screens targeted protein-coding genes [<xref rid="pcbi.1008194.ref001" ref-type="bibr">1</xref>], however recent advances have enabled screens that tile sgRNAs across non-coding regions of the genome [<xref rid="pcbi.1008194.ref002" ref-type="bibr">2</xref>–<xref rid="pcbi.1008194.ref012" ref-type="bibr">12</xref>], allowing the systematic discovery of novel functional sequences in their native genomic context.</p>
    <p>In a pooled CRISPR screen, thousands of single-guide RNAs (sgRNAs) are delivered to cells and target sequences for genomic perturbations, which can include mutation, repression (CRISPR interference, CRISPRi), or activation (CRISPRa). To target sequences for mutation, sgRNAs are introduced to cells alongside Cas9. Cas9 creates double strand breaks at the targeted sites, and mutations are introduced by error-prone non-homologous end-joining [<xref rid="pcbi.1008194.ref013" ref-type="bibr">13</xref>]. In a CRISPRi experiment, targeted sites are silenced by a deactivated Cas9 (dCas9) fused to a repressive domain such as the Krüppel-associated box (dCas9:KRAB) [<xref rid="pcbi.1008194.ref014" ref-type="bibr">14</xref>, <xref rid="pcbi.1008194.ref015" ref-type="bibr">15</xref>]. Similarly, in a CRISPRa experiment, dCas9 is fused to an activation domain such as VP64 or p300 [<xref rid="pcbi.1008194.ref016" ref-type="bibr">16</xref>–<xref rid="pcbi.1008194.ref018" ref-type="bibr">18</xref>].</p>
    <p>Following genomic perturbation, the cells are subsequently sorted into pools based on a cellular phenotype (e.g. high vs. low gene expression, survival, proliferation), and the distributions of sequenced sgRNAs are compared across pools to identify functional genomic sequences that affect the cellular phenotype used for sorting. For example, sgRNAs that disrupt activating regulatory sequences would result in reduced target gene expression and thus be enriched in pools selected for low target gene expression.</p>
    <p>The analysis of tiling CRISPR screens poses numerous challenges including (i) the need to combine information across multiple sequencing pools, (ii) the noisy and overdispersed nature of genomic count data [<xref rid="pcbi.1008194.ref019" ref-type="bibr">19</xref>, <xref rid="pcbi.1008194.ref020" ref-type="bibr">20</xref>], (iii) the spatial organization of sgRNA target sites and functional sequences, and (iv) the ‘area of effect’ of genomic perturbations, which often extends well beyond the genomic location targeted by the sgRNA (e.g. in CRISPRa or CRISPRi screens activating or silencing epigenetic modifications can spread over 1kb or more from target sites [<xref rid="pcbi.1008194.ref015" ref-type="bibr">15</xref>]). Currently, no existing methods address all of these challenges and moreover, almost all analysis methods for CRISPR screens were designed for gene-based screens, as opposed to tiling non-coding screens where the identity of functional sequences are unknown.</p>
    <p>Here we describe RELICS (<underline><bold>R</bold></underline>egulatory <underline><bold>E</bold></underline>lement <underline><bold>L</bold></underline>ocation <underline><bold>I</bold></underline>dentification in <underline><bold>C</bold></underline>RISPR <underline><bold>S</bold></underline>creens), a new method for the analysis of CRISPR screens which specifically addresses all of the above challenges. RELICS uses a flexible Bayesian hierarchical model to jointly analyze sgRNA counts across multiple pools, uses count distributions that can accommodate overdispersion, and considers the overlapping effects of multiple sgRNAs and the potential presence of multiple nearby functional sequences. RELICS also estimates the total number of functional sequences that are supported by the data. Using simulated data, we demonstrate that RELICS out-performs existing analysis methods (MAGeCK [<xref rid="pcbi.1008194.ref021" ref-type="bibr">21</xref>], BAGEL [<xref rid="pcbi.1008194.ref022" ref-type="bibr">22</xref>], and CRISPR-SURF [<xref rid="pcbi.1008194.ref023" ref-type="bibr">23</xref>]), with better precision and recall across a wide variety of conditions. In addition, the sequences predicted by RELICS have higher resolution—they are smaller but still contain the true functional sequences. Finally, when applied to published datasets, RELICS identifies novel regulatory sequences that we experimentally validate, and that are missed by other analysis methods.</p>
  </sec>
  <sec sec-type="results" id="sec002">
    <title>Results</title>
    <sec id="sec003">
      <title>The RELICS model</title>
      <p>RELICS is designed to discover functional sequences from pooled CRISPR screens including those based on cell survival, cell proliferation, and gene expression (<xref ref-type="fig" rid="pcbi.1008194.g001">Fig 1A and 1B</xref>). RELICS aims to determine both the number and location of functional sequences in the screened genome sequence and includes several important features: (i) it increases power by jointly modeling data from multiple pools; (ii) it models overdispersed sgRNA counts appropriately without requiring transformation of the data or assuming normality; (iii) it considers the spatial organization of sgRNA target sites and functional sequences; (iv) it accounts for the ‘area of effect’ of sgRNAs; and (v) it provides interpretable probabilities for the genome location of each predicted functional sequence.</p>
      <fig id="pcbi.1008194.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008194.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Schematic of a tiling CRISPR screen and RELICS.</title>
          <p>(A) sgRNAs are designed to target sites tiling across a genomic region. Bars around each target site indicate the area of effect. sgRNAs ‘overlap’ genome sequences within their area of effect. In this example, sgRNAs overlapping functional sequences (FSs) are colored red, purple and blue. (B) In a CRISPR screen, sgRNAs are introduced into cells and the cells are sorted into pools or subjected to selection (e.g. for proliferation or survival). The sgRNAs in each pool are counted and analyzed by RELICS to predict FSs. (C) RELICS predicts FSs using an Iterative Bayesian Stepwise Selection Algorithm. <underline>Step 0 (initialization):</underline> the screened region is divided into small (e.g. 100bp) genome segments; segments containing known FSs are labeled FS0. <underline>Step 1:</underline> Using the predicted FSs, RELICS estimates sorting probability distributions for sgRNAs that do/do-not overlap FSs. <underline>Step 2:</underline> RELICS uses the sorting probability distributions to compute the probability each genome segment contains a functional sequence. <underline>Step 3:</underline> Steps 1–3 are repeated until convergence.</p>
        </caption>
        <graphic xlink:href="pcbi.1008194.g001"/>
      </fig>
      <p>One of RELICS’ features is its ability to jointly analyze sgRNA count data across multiple pools, while controlling for extra variability (overdispersion) in the data. Modeling genomic count data while accounting for overdispersion increases power and reduces false positives [<xref rid="pcbi.1008194.ref019" ref-type="bibr">19</xref>, <xref rid="pcbi.1008194.ref020" ref-type="bibr">20</xref>, <xref rid="pcbi.1008194.ref024" ref-type="bibr">24</xref>]. In RELICS this is accomplished using a Dirichlet multinomial distribution, which describes the probability that a cell containing an sgRNA will be observed in each pool.</p>
      <p>It is also important to consider the genome locations of both functional sequences and sgRNA target sites as well as the area of effect for each sgRNA. The area of effect of CRISPR perturbations means that a single sgRNA can potentially affect multiple functional sequences in the vicinity of the target site. Similarly, a single functional sequence can be perturbed by multiple sgRNAs with nearby target sites. To model the spatial organization of functional sequences and sgRNA-directed perturbations, RELICS divides the sequence targeted by the screen into small windows called genome segments. Each genome segment is then associated with all sgRNAs that are predicted to affect that genome segment, based on their overlap with the sgRNA’s area of effect (<xref ref-type="fig" rid="pcbi.1008194.g001">Fig 1</xref>).</p>
      <p>RELICS assumes that the counts of sgRNAs are affected when the genome segment they are associated with contains a functional sequence. sgRNAs that affect functional sequences are expected to have a different count distribution across pools, and RELICS uses different Dirichlet distributions for sgRNAs that do or do not overlap functional sequences (<xref ref-type="fig" rid="pcbi.1008194.g001">Fig 1C</xref>). The hyperparameters for both distributions are estimated empirically by maximum likelihood in a semi-supervised manner. Known functional sequences (positive controls), such as genome segments overlapping the promoter or established enhancer of the target gene are used to start this process. We refer to these positive controls as functional sequence 0 (FS0). The hyperparameters can be estimated not only from FS0, but can also be continually updated as new functional sequences (FS1 through FSK) are identified.</p>
      <p>Using the hyperparameters and the observed sgRNA counts, RELICS calculates the posterior probability that a genome segment contains a functional sequence. We refer to the probability that a genome segment contains a functional sequence as the ‘functional sequence probability’.</p>
      <p>Exact calculation of functional sequence probabilities for every genome segment is impractical, however, because all combinations of functional sequence placements would have to be calculated. To overcome this problem, RELICS uses a novel Iterative Bayesian Stepwise Selection (IBSS) algorithm [<xref rid="pcbi.1008194.ref025" ref-type="bibr">25</xref>] to calculate approximate functional sequence probabilities, while automatically estimating the number of functional sequences, <italic>K</italic>, from the data.</p>
      <p>The final output from RELICS is an estimate of <italic>K</italic>, the number of functional sequences, and the probability that each genome segment contains each functional sequence. An important feature of RELICS is that it outputs separate probabilities for each functional sequence, providing discrete genome segments that can be used for follow-up validation experiments (<xref ref-type="fig" rid="pcbi.1008194.g001">Fig 1C</xref>). We plot these functional sequence probabilities as separate tracks or as a combined track with different colors. In addition, the functional sequences output by RELICS are rank-ordered, with functional sequence 1 (FS1) having the strongest statistical support.</p>
    </sec>
    <sec id="sec004">
      <title>Application of RELICS to simulated data</title>
      <p>To evaluate the performance of RELICS and other analysis methods, we developed a CRISPR screen simulation framework, CRSsim, that generates realistic datasets where the ground truth is known (<xref ref-type="supplementary-material" rid="pcbi.1008194.s001">S1 Fig</xref>). We compared the simulated data to experimental data and found it to be highly similar (<xref ref-type="supplementary-material" rid="pcbi.1008194.s001">S1 Fig</xref>). The simulated datasets are useful to benchmark performance since there is currently no large gold-standard set of known functional sequences. We simulated datasets with two different sequencing depths (medium/high), three sgRNA efficiency distributions (low/medium/high), and two selection strengths (weak/strong). The selection strength describes the probability of a cell being sorted into each pool given the presence or absence of an sgRNA targeting a functional sequence. We performed 30 simulations for the 12 combinations of parameter settings under two experimental scenarios: scenario 1 a cellular proliferation screen with two pools per replicate, and scenario 2 a gene expression screen with four pools per replicate. In total we performed 720 simulations, with each simulation consisting of 8,700 sgRNAs targeting a 150kb region with 8 functional sequences each spanning 50bp.</p>
      <p>We ran RELICS on the simulated datasets and allowed it to estimate the number of functional sequences, <italic>K</italic>, by calculating the pairwise correlation between functional sequence probabilities for different values of <italic>K</italic>. An example of RELICS’ predictions on a single simulated dataset is shown in <xref ref-type="fig" rid="pcbi.1008194.g002">Fig 2</xref>. In this example, RELICS identified all 8 of the functional sequences before the pairwise correlations between functional sequence probabilities increased due to overlapping placements (<xref ref-type="fig" rid="pcbi.1008194.g002">Fig 2A and 2B</xref>).</p>
      <fig id="pcbi.1008194.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008194.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>RELICS functional sequence (FS) prediction and performance of RELICS and other analysis methods on simulated data.</title>
          <p>(A) Example of functional sequence (FS) probabilities output by RELICS for a single simulation. FS0 is the known positive control sequence. RELICS correctly predicts all 8 of the simulated enhancers (grey vertical bars), which it labels FS1-FS8. FS9 is displayed to demonstrate the choice of <italic>K</italic> = 8. (B) Boxplots of pairwise correlations of FS probabilities for different choices of <italic>K</italic> (number of FSs). The red dashed line is the maximum pairwise correlation. The black dotted line is the cutoff used to determine <italic>K</italic>. In this example, RELICS chooses <italic>K</italic> = 8. The hinges of the boxplots correspond to the first and third quartiles, the center lines are the medians, and the whiskers extend to the furthest datapoints that are within 1.5x the interquartile range from the hinge. (C) Performance on 180 simulations summarized by average precision and base pair (BP) accuracy. For this figure, 30 simulations were performed for 6 simulation scenarios with high read depth and different values of the key parameters “selection strength” and “guide efficiency”. Additional simulations and performance metrics are provided in <xref ref-type="supplementary-material" rid="pcbi.1008194.s002">S2 Fig</xref>, <xref ref-type="supplementary-material" rid="pcbi.1008194.s003">S3 Fig</xref>, and <xref ref-type="supplementary-material" rid="pcbi.1008194.s004">S4 Fig</xref>. BP accuracy is the fraction of the significant bases identified by each method which are true functional sequences. In these simulations, all methods predict regions that are substantially larger than the small (50bp) simulated functional sequences due to the comparatively large area of effect around sgRNA target sites (1000bp), RELICS predicts the smallest regions with the highest BP accuracy.</p>
        </caption>
        <graphic xlink:href="pcbi.1008194.g002"/>
      </fig>
      <p>We compared RELICS’ predictions on simulated data to those from (i) MAGeCK [<xref rid="pcbi.1008194.ref021" ref-type="bibr">21</xref>], the dominant method for gene-based CRISPR screens; (ii) BAGEL [<xref rid="pcbi.1008194.ref022" ref-type="bibr">22</xref>], a supervised method for gene-based CRISPR screens; and (iii) CRISPR-SURF [<xref rid="pcbi.1008194.ref023" ref-type="bibr">23</xref>], a new tool for tiling CRISPR screens. While both MAGeCK and BAGEL are designed for gene-based screens, we compare against them because MAGeCK is the most popular analysis method for CRISPR screens and has previously been used to analyze tiling CRISPR screens [<xref rid="pcbi.1008194.ref011" ref-type="bibr">11</xref>]. We use BAGEL to provide a comparison to another method that utilizes training data to estimate model parameters.</p>
      <p>We first quantified performance using scores output by each method and computing the average precision (AP), which summarizes a precision recall curve. As scores, we used the functional sequence probability (RELICS), the effect size (CRISPR-SURF), the BayesFactor (BAGEL), and the -log10(FDR) (MAGeCK). We found that RELICS has by far the best performance with the highest AP in 321/360 simulations for scenario 1 and 276/360 simulations for scenario 2 (<xref ref-type="fig" rid="pcbi.1008194.g002">Fig 2C</xref>, <xref ref-type="supplementary-material" rid="pcbi.1008194.s002">S2A Fig</xref>, <xref ref-type="supplementary-material" rid="pcbi.1008194.s003">S3A Fig</xref>). We next quantified performance using the functional sequences that each method reported as significant. RELICS had the highest precision in 338/360 of the simulations in scenario 1 and 324/360 of the simulations in scenario 2 (<xref ref-type="supplementary-material" rid="pcbi.1008194.s002">S2B Fig</xref>, <xref ref-type="supplementary-material" rid="pcbi.1008194.s003">S3B Fig</xref>). RELICS also had the highest recall in 331/360 of the scenario 1 simulations and 359/360 of the scenario 2 simulations (<xref ref-type="supplementary-material" rid="pcbi.1008194.s002">S2C Fig</xref>, <xref ref-type="supplementary-material" rid="pcbi.1008194.s003">S3C Fig</xref>). Notably, RELICS has far better performance than the other methods in scenarios with low sgRNA efficiency and/or weak selection strength. This is important because many sgRNAs in screening libraries have medium or low efficiency [<xref rid="pcbi.1008194.ref026" ref-type="bibr">26</xref>].</p>
      <p>We quantified the resolution of predicted functional sequences with basepair (BP) accuracy—the total number of significant genomic bases that overlap with true simulated functional sequences. For each simulated functional sequence, we quantified the fraction of base pairs that were called significant and overlapped a simulated functional sequence. Due to the large area of effect (1000bp) and small functional sequences (50bp) used by the simulations, all of the methods had low BP accuracy and predicted regions that are substantially larger than the functional sequences. Nonetheless, the predictions made by RELICS covered much smaller regions than the other methods and it had the highest BP accuracy in 313/360 of the scenario 1 simulations and 304/360 of the scenario 2 simulations (<xref ref-type="fig" rid="pcbi.1008194.g002">Fig 2C</xref>, <xref ref-type="supplementary-material" rid="pcbi.1008194.s002">S2D Fig</xref>, <xref ref-type="supplementary-material" rid="pcbi.1008194.s003">S3D Fig</xref>).</p>
      <p>We also simulated data using a tool recently developed by Bodapati et al. [<xref rid="pcbi.1008194.ref027" ref-type="bibr">27</xref>]. Using the data from these simulations RELICS again outperformed all other methods in AP, precision, recall and BP accuracy (see <xref ref-type="sec" rid="sec007">methods</xref>, <xref ref-type="supplementary-material" rid="pcbi.1008194.s004">S4 Fig</xref>). Note that neither of the simulations are biased to favor RELICS since CRSsim was designed to mimic experimental procedures and is not tailored to RELICS, and the Bodapati et al. simulation tool was developed by an independent research group. In summary, RELICS outperforms the other methods on simulated data and has the best overall precision, recall, and resolution.</p>
    </sec>
    <sec id="sec005">
      <title>Application of RELICS to published datasets</title>
      <p>We applied RELICS to four published tiling CRISPR screens. The first two data sets are CRISPRa screens for functional sequences that affect the expression of <italic>CD69</italic> and <italic>IL2RA</italic> in Jurkat T cells [<xref rid="pcbi.1008194.ref009" ref-type="bibr">9</xref>]. For both genes, cells were flow sorted into four pools based on expression (negative, low, medium, high), and in the published analysis putative functional sequences were identified by computing log fold change between pairs of pools. We ran RELICS, CRISPR-SURF, and MAGeCK on both datasets. RELICS predicts <italic>K</italic> = 5 functional sequences for <italic>CD69</italic>, which we label as FS1 through FS5 (<xref ref-type="fig" rid="pcbi.1008194.g003">Fig 3</xref>, <xref ref-type="supplementary-material" rid="pcbi.1008194.s005">S5 Fig</xref>). In contrast, MAGeCK predicts a large number of significant regions (23) under a false discovery rate of 0.05, while CRISPR-SURF predicts multiple large functional sequences at and downstream of the <italic>CD69</italic> promoter (<xref ref-type="fig" rid="pcbi.1008194.g003">Fig 3B</xref>).</p>
      <fig id="pcbi.1008194.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008194.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Analysis of a published CRISPR activation (CRISPRa) screen for <italic>CD69</italic> expression in Jurkat T cells.</title>
          <p>(A) RELICS detects 5 functional sequences (FSs) labeled FS1-FS5. FS0 is a known positive control sequence (the CD69 promoter) provided as input to RELICS and CRISPR-SURF. (B) Analysis of the CD69 screen by RELICS, CRISPR-SURF, MAGeCK and log2 fold change. The RELICS probabilities for each FS are collapsed into a single track. An H3K27ac ChIP-seq track for Jurkat cells is included. (C) Zoom in of a 20kb region (indicated by dashed box in (a) and (b)). Experimentally tested regions are indicated by colored bars. (D) Experimental validations. Lentiviruses carrying sgRNAs targeting different regions were transduced to Jurkat cells expressing dCas9:VP64, and the expression of CD69 was measured by flow cytometry using PE-conjugated anti-human CD69 antibody. The results from each experiment are overlaid those from a non-targeting negative control sgRNA (blue). Targeting sgRNAs were chosen for their high specificity and high predicted efficiency (relative to possible sgRNAs in the region) and in some cases are adjacent to the predicted FS rather than within the FS. Results from additional validation experiments are shown in <xref ref-type="supplementary-material" rid="pcbi.1008194.s006">S6 Fig</xref>.</p>
        </caption>
        <graphic xlink:href="pcbi.1008194.g003"/>
      </fig>
      <p>To test a subset of the <italic>CD69</italic> functional sequence predictions, we designed sgRNAs to target the putative functional sequences, cloned the sgRNAs into lentiviral vectors, and transduced them into Jurkat T cells expressing dCas9:VP64. As a negative control we used a non-targeting sgRNA, and as positive control we used an sgRNA targeting a site near the <italic>CD69</italic> transcription start site (<xref ref-type="fig" rid="pcbi.1008194.g003">Fig 3C and 3D</xref>). The region including FS1 and FS2 was previously found to activate <italic>CD69</italic> expression [<xref rid="pcbi.1008194.ref009" ref-type="bibr">9</xref>] and we confirm that CRISPRa targeting of this region increased the number of <italic>CD69</italic> positive cells. Similarly, we validated that FS4 also increases <italic>CD69</italic> expression. All methods detected a signal at FS3, however we were not able to confirm that targeting of this region affects <italic>CD69</italic> expression (<xref ref-type="supplementary-material" rid="pcbi.1008194.s006">S6 Fig</xref>). Finally, targeting a “negative sequence” that was not predicted by RELICS, but is on the edge of a large significant region reported by CRISPR-SURF, did not change <italic>CD69</italic> expression. These results confirm that the predictions made by RELICS are accurate. In addition, the output from RELICS is easier to interpret because it provides ranked, cleanly-delineated predictions for each functional sequence (<xref ref-type="fig" rid="pcbi.1008194.g003">Fig 3A</xref>).</p>
      <p>RELICS identified 15 functional sequences for <italic>IL2RA</italic>, of which all but one (FS6) are within or very close to the 6 regions identified in the original study (<xref ref-type="supplementary-material" rid="pcbi.1008194.s007">S7 Fig</xref>). Since RELICS predictions have higher resolution than other methods, the multiple smaller regions predicted by RELICS may reflect the true presence of multiple functional sequences. Alternatively, some large functional sequences may be split into smaller sequences by RELICS, particularly if some of the sgRNAs targeting the middle of the sequence have very low efficiency.</p>
      <p>We next applied RELICS to a CRISPRi proliferation screen surrounding the <italic>MYC</italic> locus in K562 cells [<xref rid="pcbi.1008194.ref003" ref-type="bibr">3</xref>] (<xref ref-type="fig" rid="pcbi.1008194.g004">Fig 4</xref>). As with <italic>IL2RA</italic>, RELICS detected all of the previously-reported signals, but split one of them into smaller predicted functional sequences. Interestingly, RELICS also identified 6 regions that have not been previously reported and that neither CRISPR-SURF nor MAGeCK detected. To test whether these sequences are functional we targeted 5 of them with CRISPRi. As a positive control we targeted a previously-detected functional sequence reported by Fulco et al. (referred to as e2), and as negative controls we used dCas9:KRAB alone or dCas9:KRAB with an sgRNA targeting a safe harbor sequence on chromosome 8 with no known function. Of the 5 FSs we tested, 4/5 showed a substantial decrease in proliferation and 1/5 (FS10) showed a small decrease in proliferation with at least one of the targeting sgRNAs (<xref ref-type="fig" rid="pcbi.1008194.g004">Fig 4B</xref>). This confirms that RELICS discovered additional functional sequences that are missed by other methods.</p>
      <fig id="pcbi.1008194.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008194.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Analysis of a <italic>MYC</italic> CRISPRi cellular proliferation screen published by Fulco et al. 2016.</title>
          <p>(A) Output of RELICS and other analysis methods. Each FS predicted by RELICS is given a different color and the labels are arranged by genomic position. (B) Experimental validations. Each validation experiment is a cellular proliferation assay, in which the percent of GFP-positive cells (i.e. those that received the sgRNA) are measured at day 0, day 6 and day 14. As negative controls we used dCas9:KRAB only (no sgRNA) as well as sgRNAs targeting a ‘safe harbor’ non-functional region on chromosome 8. As positive controls we used sgRNAs targeting a known regulatory region (e2, identified by Fulco et al., corresponding to FS2 and FS3). Each functional sequence was targeted with either one, two, or three different sgRNAs with two replicates each. sgRNAs that resulted in a significant reduction in % GFP compared to negative controls (dCas9 only, Neg. Ctrl.) at day 14 have an asterisk (Student’s one-sided t-test, p &lt; 0.05).</p>
        </caption>
        <graphic xlink:href="pcbi.1008194.g004"/>
      </fig>
      <p>Finally, we applied RELICS to a CRISPRi proliferation screen surrounding <italic>GATA1</italic> [<xref rid="pcbi.1008194.ref003" ref-type="bibr">3</xref>]. RELICS predicted five functional sequences, two of which (FS1 and FS2) have been previously validated [<xref rid="pcbi.1008194.ref003" ref-type="bibr">3</xref>], two of which are within <italic>GATA1</italic> (FS3, FS4), and one of which is upstream of <italic>GATA1</italic> (FS5) but not detected by any of the other methods (<xref ref-type="fig" rid="pcbi.1008194.g005">Fig 5A</xref>). We confirmed that inhibition of this newly-discovered functional sequence with CRISPRi reduces proliferation (<xref ref-type="fig" rid="pcbi.1008194.g005">Fig 5B</xref>). The original study also predicted a functional region near <italic>GLOD5</italic> (<xref ref-type="supplementary-material" rid="pcbi.1008194.s008">S8A Fig</xref>). However, neither RELICS nor the other two methods identified a functional sequence at this location. This suggested to us that the region near <italic>GLOD5</italic> may have been a false positive detected in the original study. To test this hypothesis, we used CRISPRi to target the <italic>GLOD5</italic> region, the <italic>GATA1</italic> promoter (positive control), and a sequence on chromosome 8 (negative control). While the sgRNAs targeting the <italic>GATA1</italic> promoter decreased cellular proliferation as expected, targeting of the <italic>GLOD5</italic> region did not affect proliferation relative to the negative control (<xref ref-type="supplementary-material" rid="pcbi.1008194.s008">S8B Fig</xref>). Thus, this region is unlikely to be a functional sequence, and the low probability reported by RELICS is appropriate. Overall, RELICS accurately identifies functional sequences, and provides an easily interpretable output that quantifies its certainty that a region contains a functional sequence.</p>
      <fig id="pcbi.1008194.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008194.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Analysis of a published CRISPR inhibition (CRISPRi) cellular proliferation screen around <italic>GATA1</italic>.</title>
          <p>(A) Results from RELICS and other analysis methods. RELICS detects 5 functional sequences (FS1-5). FS1 and FS2 have previously been validated; FS3 and FS4 fall within GATA1. (B) Results from validation experiments (2 replicates each). As negative controls we used dCas9:KRAB only as well as guides targeting a non-functional region on chromosome 8. As positive controls we used sgRNA targeting a known regulatory region (e2, previously identified by Fulco et al. 2016). Each validation experiment is a cellular proliferation assay, in which the percent of GFP-positive cells (i.e. those that received the sgRNA) are measured at day 0, day 6 and day 14. Targeting the positive control region and FS5 clearly reduces proliferation compared to the negative controls.</p>
        </caption>
        <graphic xlink:href="pcbi.1008194.g005"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec006">
    <title>Discussion</title>
    <p>We have developed RELICS, a Bayesian hierarchical model for the analysis of CRISPR screens. Unlike gene-based analysis methods, RELICS is specifically designed to analyze CRISPR screens where the locations of functional sequences are not known. The RELICS model provides numerous advantages. First, it considers the overlapping effects of multiple nearby sgRNA target sites and functional sequences. Second, it provides interpretable probabilistic output for each functional sequence that can be used to delineate small genome regions that confidently contain each functional sequence. Third, it models sgRNA counts appropriately without requiring transformation of the data or assuming normality. Fourth, it increases power by jointly modeling data from multiple sgRNA pools. While other methods include some of these features (e.g. CRISPR-SURF deconvolves the effects of multiple sgRNAs, and MAGeCK models overdispersed count data with a negative binomial distribution), only RELICS combines all of them into a single model. We also tested the robustness of RELICS to sequencing depth and density of sgRNA target sites by downsampling 75% of the sgRNA counts as well as 75% of all sgRNAs for the <italic>CD69</italic> CRISPRa screen (<xref ref-type="supplementary-material" rid="pcbi.1008194.s009">S9 Fig</xref>). In both cases, the RELICS predictions remained consistent indicating that it is relatively insensitive to sequencing depth and sgRNA density. This is also supported by our simulations, which found that sgRNA efficiency and functional sequence strength affect performance more than sequencing depth (<xref ref-type="supplementary-material" rid="pcbi.1008194.s002">S2 Fig</xref>, <xref ref-type="supplementary-material" rid="pcbi.1008194.s003">S3 Fig</xref>).</p>
    <p>To test the performance of RELICS and other analysis methods we developed a simulation tool, CRSsim. Using CRSsim, we generated hundreds of datasets, performed the first systematic comparison of analysis methods for non-coding CRISPR screens, and found that RELICS has the best performance under a wide variety of conditions. CRSsim is open-source and we envision that it will be a useful tool for future performance comparisons, power analyses, and making informed decisions about experimental designs for CRISPR screens (e.g. spacing of sites targeted by sgRNAs, the sequencing depth, and the complexity of the vector library).</p>
    <p>RELICS leverages known functional sequences (labeled positive controls) as well as unlabeled sequences to learn model hyperparameters. It is therefore a semi-supervised method. CRISPR-SURF and BAGEL similarly make use of known control sequences. A strength of this approach is that RELICS learns the behavior of sgRNAs across different pools from the data. A limitation is that it might be difficult to apply RELICS to datasets that do not contain a known positive control region or that have a low number of sgRNAs overlapping positive control regions, although it is generally advisable to include positive controls in all screen designs. In addition, positive controls may not adequately represent all types of functional sequences, such as repressive or weak regulatory elements. As an alternative approach, the hyperparameters can be specified by the user. It may also be possible to develop an unsupervised learning approach where positive control labels are not provided and instead sequences with similarly-behaving sgRNAs are identified by clustering. Ideally the categories identified by such an approach would represent different types of sequences (e.g. strong regulatory elements, weak regulatory elements, silencers, non-regulatory elements).</p>
    <p>RELICS does not currently model variation in sgRNA efficiency, variation in the strength of regulatory elements, or off-target effects. These limitations are mitigated by combining information across multiple sgRNAs, and by modeling overdispersion, which allows for the extra-variability that is introduced by factors such as off-target effects [<xref rid="pcbi.1008194.ref026" ref-type="bibr">26</xref>, <xref rid="pcbi.1008194.ref028" ref-type="bibr">28</xref>] or sgRNA efficiency [<xref rid="pcbi.1008194.ref029" ref-type="bibr">29</xref>–<xref rid="pcbi.1008194.ref031" ref-type="bibr">31</xref>]. In addition, sgRNAs can be pre-filtered to remove those that have low predicted specificity or efficiency, as we have done in our analyses using GuideScan (see <xref ref-type="sec" rid="sec007">methods</xref>). Our simulations demonstrate that RELICS performs better compared to other methods, especially in the presence of weak enhancers or weak sgRNA efficiency (<xref ref-type="fig" rid="pcbi.1008194.g002">Fig 2C</xref>, <xref ref-type="supplementary-material" rid="pcbi.1008194.s002">S2 Fig</xref>, <xref ref-type="supplementary-material" rid="pcbi.1008194.s003">S3 Fig</xref>, <xref ref-type="supplementary-material" rid="pcbi.1008194.s004">S4 Fig</xref>). Nonetheless, future versions of RELICS that explicitly model these sources of variation will likely achieve even better results.</p>
    <p>In summary, RELICS performs better than previous analysis methods under most simulation conditions and, when applied to real data, identifies both previously-validated functional sequences and new functional sequences. Thus, RELICS is an extremely useful tool for the discovery of functional sequences from CRISPR screens.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec007">
    <title>Materials and methods</title>
    <sec id="sec008">
      <title>CRSsim simulation framework</title>
      <p>The CRSsim simulation tool is open source and available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/patfiaux/CRSsim">https://github.com/patfiaux/CRSsim</ext-link>). To run it, the user first specifies the screen type, which can either be a selection screen (e.g. drop out or proliferation) or an expression screen, with an arbitrary number of expression pools. Next, the user specifies the screening method (Cas9, CRISPRi, CRISPRa, dual-guide CRISPR), the number and size of true functional sequences, the spacing/density of sgRNA target sites, and the distribution of sgRNA counts in the initial set of cells (i.e. the frequency of each sgRNA).</p>
      <p>The probability of a cell being sorted into each pool depends on whether the sgRNA in that cell targets a functional sequence. We refer to the difference in sorting probabilities between sgRNAs that do/do not target functional sequences as the “strength of selection”, <italic>T</italic>. The sorting of sgRNAs into the different pools is simulated by sampling from a Dirichlet multinomial distribution. The sorting probabilities of sgRNAs that do not target functional sequences are given by a vector of Dirichlet parameters <italic>α</italic>, where the probability of being sorted into pool <italic>j</italic> is <inline-formula id="pcbi.1008194.e001"><alternatives><graphic xlink:href="pcbi.1008194.e001.jpg" id="pcbi.1008194.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>. The sorting probabilities of an sgRNA, <italic>n</italic>, that overlaps a functional sequence, <italic>k</italic>, depends on the strength of selection, <italic>T</italic>, the sgRNA efficiency, <italic>f</italic><sub><italic>n</italic></sub>, and the strength of the functional sequence, <italic>h</italic><sub><italic>k</italic></sub>. Both <italic>f</italic><sub><italic>n</italic></sub> and <italic>h</italic><sub><italic>k</italic></sub> are proportions between 0 and 1. Guides targeting strong functional sequences, with a strength near <italic>h</italic><sub><italic>k</italic></sub> = 1, behave like positive control sgRNAs. Guides targeting non-functional sequences have <italic>h</italic><sub><italic>k</italic></sub> = 0. The simulation sets the efficiency of each sgRNA and the strength of each functional sequence by sampling from beta distributions with user-configurable shapes. Finally, the user can specify how deeply the sgRNA pools are sequenced.</p>
      <p>The sgRNA efficiency, <italic>f</italic><sub><italic>n</italic></sub>, specifies the fraction of cells where the sgRNA is ‘effective’ and perturbs the sorting probabilities. For example, if <italic>c</italic> cells contain sgRNA <italic>n</italic>, then <italic>w</italic> = <italic>cf</italic><sub><italic>n</italic></sub> cells contain sgRNAs that are effective and they are sorted with probabilities specified by the Dirichlet vector <italic>α</italic>+<italic>h</italic><sub><italic>k</italic></sub><italic>T</italic>. The sorting vector for the c−<italic>w</italic> cells with ‘ineffective’ sgRNAs, is simply <italic>α</italic>.</p>
      <p>Each simulation starts with an sgRNA library with a distribution of sgRNA counts. We assume the sgRNA counts follow a zero-inflated negative binomial distribution (ZINB), <italic>y</italic>~<italic>ZINB</italic>(<italic>μ</italic>,<italic>d</italic>,<italic>ε</italic>), where <italic>μ</italic> is the mean, <italic>d</italic> is the dispersion and <italic>ε</italic> is the proportion of the distribution that comes from the zero point mass. The parameters of the ZINB distribution can be specified or estimated by maximum likelihood from a provided table of sgRNA counts. After the sgRNA counts in the sgRNA library are obtained by sampling from the ZINB distribution, an input pool of cells containing sgRNAs is generated by performing multinomial sampling from the sgRNA library. We simulate the sorting of cells from the input pool into downstream pools by sampling from the Dirichlet multinomial distribution described above. Lastly, we simulate the sequencing step and obtain the count of sgRNAs in the sorted pools by drawing from a multivariate hypergeometric distribution (sampling without replacement) or a multinomial distribution (sampling with replacement). Sampling without replacement is used to simulate the use of unique molecular identifiers that allow duplicate reads to be filtered.</p>
    </sec>
    <sec id="sec009">
      <title>Bodapati et al. simulations</title>
      <p>We downloaded the Bodapati et al. simulation tool from GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/sbodapati/CRISPR_Benchmarking_Algorithms">https://github.com/sbodapati/CRISPR_Benchmarking_Algorithms</ext-link>). We varied guide efficiency (low = 0.4 / high = 0.8), the number of guides per gene (low = 5 / high = 20) and the sequencing depth (low = 100 / medium = 200 / high = 400). We performed 15 simulations for various combinations of guide efficiency, guides per gene, and sequencing depth. This resulted in 12 scenarios and a total of 180 simulations, each with ~8400 sgRNAs and 8 functional sequences. For simulations with 5 guides per gene we simulated a total of 36 essential genes. Of those, 28 were used as training data for FS0, the remaining 8 were used as functional sequences which are to be detected. In simulations with 20 guides per gene we simulated 15 essential genes of which 7 were used as a known positive control functional sequence (FS0) and the remaining 8 were treated as unknown functional sequences. This resulted in ~150 guides as FS0 training which is similar to the datasets we analyzed in this paper. To keep the same number of guides across the scenarios we simulated 1653 or 407 non-essential genes with either 5 guides or 20 guides per gene respectively.</p>
      <p>Since the Bodapati et al. simulation tool was originally designed for gene-based screens we adapted the data to resemble a tiling CRISPR screen. We first randomized the order of the non-essential genes and the genes used as functional sequences while holding out the genes used for FS0. Next, we mapped all genes to genomic coordinates with guides spaced 6 bp apart (6 bp was used because that was the average tiling density of Fulco et al. 2016). All genes used for FS0 training were mapped to the middle of the tiling region to mimic the gene of interest.</p>
    </sec>
    <sec id="sec010">
      <title>Performance assessment in simulations</title>
      <p>We compared the performance of analysis methods for CRISPR screens using several metrics. We computed the average precision, which summarizes a precision-recall curve, using scores provided by each method. Specifically, as scores we used the functional sequence probability for RELICS, the -log10(FDR) for MAGeCK, the effect size (Beta) for CRISPR-SURF, and the Bayes Factor for BAGEL. Furthermore, we computed precision and recall using the set of regions labeled as significant by each method (BayesFactor &gt; 5 for BAGEL, adjusted p-value &lt; 0.05 for MAGeCK, positive significant regions output by CRISPR-SURF, and the functional sequences predicted by RELICS). Lastly, we also evaluated the fraction of all base pairs identified as significant that contained the simulated functional sequences.</p>
      <p>The BP accuracy for the CRSSim simulations was not very high for all methods. This is due to the large area of effect (1000bp) and the small functional sequence size (50bp) used in these simulations. This area of effect is typical of CRISPRi and CRISPRa. RELICS used a genome-segment size of 100bp segments, so the best possible BP accuracy for a functional sequence that is wholly contained with a genome segment is 50%. In the case where a true FS (50bp) is split between two segments and RELICS labels correctly labels both segments as FSs, the BP accuracy is only 25%. The Bodapati simulations do not include an area of effect (i.e. the area of effect is 1bp), and RELICS used 20bp genome segments for analyzing these simulations, which allows for finer-resolution predictions and higher BP accuracy (<xref ref-type="supplementary-material" rid="pcbi.1008194.s004">S4 Fig</xref>).</p>
    </sec>
    <sec id="sec011">
      <title>Running MAGeCK</title>
      <p>MAGeCK (version 0.5.9.2) is designed to be run on sgRNAs that are grouped into functional units (i.e. genes). To run MAGeCK, we therefore grouped sgRNAs into non-overlapping genome windows containing 10 sgRNAs per window (note that the GeCKO v2 sgRNA library that MAGeCK is commonly applied to uses 6 sgRNAs per gene). To run MAGeCK we used the following command line:</p>
      <p specific-use="line">                   mageck test -k MAGeCK_Input.txt -t 0,1 -c 2,3 -n mageckOut</p>
      <p>where the MAGeCK_Input.txt file contains the observed counts for each sgRNA.</p>
    </sec>
    <sec id="sec012">
      <title>Running BAGEL</title>
      <p>BAGEL (downloaded from sourceforge on 12/12/2019) is designed to be run on sgRNAs that are grouped into functional units (i.e. genes). To run BAGEL we grouped sgRNAs using the same 10-sgRNA genomic windows that we used for MAGeCK. Since BAGEL takes log2 fold change as input, we calculated log2 fold change from the sgRNA counts. BAGEL is a supervised method and requires positive and negative controls as training. We provided a set of positive and negative sgRNAs to be used as such. For the simulations, the positive sgRNAs were taken from the simulated ‘positive control region’. For the experimental datasets, we provided the same positive controls that RELICS used for training. As negative sgRNAs we used the first few 10-sgRNA windows which corresponded to the background and selected the same number of windows as was used as positive controls. To run BAGEL we used the following command:</p>
      <p specific-use="line">                   python BAGEL.py -i BAGEL_Input.txt -o BAGEL_out.bf -e Input_posTrain.txt -n Input_negTrain.txt -c 1,2</p>
    </sec>
    <sec id="sec013">
      <title>Running CRISPR-SURF</title>
      <p>CRISPR-SURF (downloaded 02/13/2019 from GitHub) was run using the procedure specified in the supplemental materials of Hsu et al. 2018. CRISPR-SURF analyzes count data in two steps. The first step filters out guides of low quality and computes log2 fold change (command ‘<monospace>SURF_count</monospace>’). The second step performs the deconvolution (command ‘<monospace>SURF_ deconvolution</monospace>’) to identify functional sequences. During the first step, all guides which have a count less than 50 in any of the pools are removed. While this works with data sets that have been sequenced deeply, this can become an issue when the sequencing depth is not as high. For this reason, to run CRISPR-SURF on the simulated datasets, we set the guide count filter to 15 instead of 50. For the experimental datasets we used the default guide count filter of 50. CRISPR-SURF accepts positive control as input, which can improve the output. We provided CRISPR-SURF with the same positive controls that RELICS used for training. The SURF_count command was run as follows:</p>
      <p specific-use="line">                   docker run -v $Path_to_file/:$Path_to_file -w $Path_to_file pinellolab/crisprsurf SURF_count -f CRISPR_SURF_count.csv -nuclease cas9 -pert crispri</p>
      <p>The SURF_deconvolution command was run as follows:</p>
      <p specific-use="line">                   docker run -v $Path_to_file/:$Path_to_file -w $Path_to_file pinellolab/crisprsurf SURF_deconvolution -f CRISPR_SURF_Input.csv -pert crispri</p>
    </sec>
    <sec id="sec014">
      <title>Running RELICS</title>
      <p>To run RELICS on the CRSsim data we used the default parameters for analyzing a CRISPRi screen. For analyzing the Bodapati et al. simulation data we used a genome segment size of 20bp in addition to the default parameters for a Cas9 screen. To run RELICS on experimental datasets we used the default parameters for a CRISPRi/CRISPRa screen which has an sgRNA area of effect of 400bp (+/-200bp around each target site). The promoter regions of the genes of interest were used as positive control regions. The same positive control regions were used for CRISPR-SURF and BAGEL.</p>
    </sec>
    <sec id="sec015">
      <title>CRISPRa screen data</title>
      <p>We obtained data from published CRISPRa screens for <italic>IL2RA</italic> and <italic>CD69</italic> gene expression in Jurkat T cells [<xref rid="pcbi.1008194.ref009" ref-type="bibr">9</xref>]. We downloaded the sgRNA counts from the paper supplement and converted them to the RELICS input format. The promoter regions were used as positive control regions for RELICS and CRISPR-SURF and were defined as the transcription start site (TSS) +/- 1kb. RELICS jointly analyzed all pools for the analysis. For MAGeCK and CRISPR-SURF, the input pool was used as control pool and the high-expression pool was used as the treatment pool. RELICS and CRISPR-SURF used the same positive control sgRNAs.</p>
    </sec>
    <sec id="sec016">
      <title>CRISPRi screen data</title>
      <p>We obtained data from published CRISPRi proliferation screens for <italic>GATA1</italic> and <italic>MYC</italic> in K562 cells [<xref rid="pcbi.1008194.ref003" ref-type="bibr">3</xref>]. We downloaded the sgRNA counts from the paper supplement and converted them to the RELICS input format. For detecting <italic>MYC</italic> regulatory elements, all sgRNAs labelled as ‘<italic>MYC</italic> Tiling’ sgRNAs as well as ‘Protein Coding Gene Promoters’ sgRNAs were used. For detecting <italic>GATA1</italic> regulatory elements, all sgRNAs labelled as ‘<italic>GATA1</italic> Tiling’ as well as ‘Protein Coding Gene Promoters’ were used. For MAGeCK and CRISPR-SURF, the pool at T0 (before) was used as the treatment pool and the pool at T14 (after) was used as the control pool in order to look for enrichment instead of depletion. RELICS and CRISPR-SURF used the same positive control sgRNAs.</p>
    </sec>
    <sec id="sec017">
      <title>Filtering guides with GuideScan</title>
      <p>We filtered all guides from both the CRISPRi and CRISPRa experimental screens using GuideScan [<xref rid="pcbi.1008194.ref032" ref-type="bibr">32</xref>]. All possible guides for the regions targeted in each screen were obtained from the online version of the GuideScan tool (<ext-link ext-link-type="uri" xlink:href="http://www.guidescan.com/">http://www.guidescan.com/</ext-link>, used 05/08/2020). GuideScan eliminates all guides with either a perfect match or a 1bp mismatch at any other site in the genome. All remaining guides receive a specificity score. We used the specificity score cutoff of 0.2 recommended by Tycko et al. [<xref rid="pcbi.1008194.ref033" ref-type="bibr">33</xref>]. All remaining guide sequences were then matched to the guide sequences from the studies described above. Filtering sgRNAs with GuideScan reduced the total number of guides in each study substantially (<xref ref-type="supplementary-material" rid="pcbi.1008194.s010">S1 Table</xref>), however removal of these sgRNAs did not substantially affect the results. Results for <italic>CD69</italic> without GuideScan filtering are shown in <xref ref-type="supplementary-material" rid="pcbi.1008194.s009">S9 Fig</xref>.</p>
    </sec>
    <sec id="sec018">
      <title>H3K27ac data</title>
      <p>Jurkat H3K27ac data from Mansour et al. [<xref rid="pcbi.1008194.ref034" ref-type="bibr">34</xref>] was downloaded from GEO (GSM1296384). The reads were aligned with BWA-MEM [<xref rid="pcbi.1008194.ref035" ref-type="bibr">35</xref>] using default parameters and filtered for duplicates and low mapping quality (MAPQ &lt; 30) using samtools [<xref rid="pcbi.1008194.ref036" ref-type="bibr">36</xref>]. The reads were then converted to reads per kilobase per million in 200bp bins using deepTools2 [<xref rid="pcbi.1008194.ref037" ref-type="bibr">37</xref>]. ENCODE H3K27ac ChIP-seq data for the K562 cell line was downloaded in bedgraph format from the UCSC genome browser.</p>
    </sec>
    <sec id="sec019">
      <title>CRISPRa validation experiments</title>
      <p>We used FlashFry [<xref rid="pcbi.1008194.ref031" ref-type="bibr">31</xref>] to design two sgRNAs per target site. FlashFry calculates guide efficiency and off-target effects for each guide by reporting the Doench 2014 [<xref rid="pcbi.1008194.ref038" ref-type="bibr">38</xref>], Doench 2016 [<xref rid="pcbi.1008194.ref026" ref-type="bibr">26</xref>], and Hsu 2013 scores [<xref rid="pcbi.1008194.ref028" ref-type="bibr">28</xref>]. For each of the sites we selected guides with low estimated off-target effects and high estimated efficiency relative to the other possible guides in the region (<xref ref-type="supplementary-material" rid="pcbi.1008194.s011">S2 Table</xref>). The designed sgRNAs were cloned into pCRISPRiaV2 plasmids (Addgene #84832). Lentiviruses carrying the sgRNAs were generated and transduced into Jurkat cells expressing dCas9-VP64 [<xref rid="pcbi.1008194.ref009" ref-type="bibr">9</xref>], which were obtained from the Berkeley Cell Culture Facility. 7–10 days after transduction, cells from different treatments were stained with PE anti-human CD69 antibody (Biolegend #310906) and the expression of CD69 was measured by flow cytometry using a BD FACSCanto II system.</p>
    </sec>
    <sec id="sec020">
      <title>CRISPRi validation experiments</title>
      <p>K562 cells were transduced with dCas9-KRAB-GFP lentivirus (Addgene #71237) carrying different sgRNAs (<xref ref-type="supplementary-material" rid="pcbi.1008194.s012">S3 Table</xref>, <xref ref-type="supplementary-material" rid="pcbi.1008194.s013">S4 Table</xref>). The percentage of GFP positive cells was recorded by FACS 3 days after transduction (D0) and again after an additional 6 (D6) and 14 (D14) days of culture. Two biological replicates (from separate cultures) were performed at each time point.</p>
    </sec>
    <sec id="sec021">
      <title>RELICS model setup and organization</title>
      <p>A description of the variables for the RELICS model is provided in <xref ref-type="supplementary-material" rid="pcbi.1008194.s012">S3 Table</xref>. RELICS divides the screened genome region into <italic>M</italic> small non-overlapping genome segments indexed as <italic>m</italic> = 1,2,…,<italic>M</italic>. In practice we have found a segment size of 100bp to work well, and we use this as the default. As input, RELICS takes a table of observed counts for <italic>N</italic> sgRNAs (indexed as <italic>n</italic> = 1,2,…,<italic>N</italic>) across <italic>J</italic> pools. We represent these counts as an <italic>N</italic>×<italic>J</italic> matrix, <bold><italic>y</italic>,</bold> and use <bold><italic>y</italic></bold><sub><italic>n</italic></sub> to denote the vector of observed counts for sgRNA <italic>n</italic> across the <italic>J</italic> pools. Let <italic>g</italic>(<italic>n</italic>) be a function that maps sgRNAs to associated ‘overlapping’ genome segments. I.e. <italic>g</italic>(<italic>n</italic>) returns the set of genome segments that are overlapped by sgRNA <italic>n</italic>. RELICS does not use non-targeting sgRNAs.</p>
    </sec>
    <sec id="sec022">
      <title>RELICS sgRNA count model</title>
      <p>RELICS assumes there are <italic>K</italic> functional genome sequences, indexed as <italic>k</italic> = 1,2,…,<italic>K</italic> and that each functional sequence affects the sorting probabilities of overlapping sgRNAs. Each functional sequence has a length, <italic>l</italic><sub><italic>k</italic></sub>, which is the number of genome segments that it spans. The maximum length of a functional sequence is set to <italic>L</italic>, so that <italic>l</italic><sub><italic>k</italic></sub>∈{1,…,<italic>L</italic>}. By default, <italic>L</italic> = 10.</p>
      <p>We describe the observed counts for an sgRNA across pools with a Dirichlet multinomial distribution and refer to the Dirichlet portion of the distribution as the sorting probability distribution. The sgRNAs that overlap a functional genome sequence have one sorting probability distribution, and the sgRNAs that do not overlap a functional genome sequence have another. Each Dirichlet distribution has <italic>J</italic> shape parameters, which define the dispersion and the expected proportion of counts in each pool. The vectors of shape parameters for the Dirichlet distributions are denoted <bold><italic>α</italic></bold><sub><bold>1</bold></sub> and <bold><italic>α</italic></bold><sub><bold>0</bold></sub> for sgRNAs that do and do not overlap a functional sequence. Then:
<disp-formula id="pcbi.1008194.e002"><alternatives><graphic xlink:href="pcbi.1008194.e002.jpg" id="pcbi.1008194.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1008194.e003"><alternatives><graphic xlink:href="pcbi.1008194.e003.jpg" id="pcbi.1008194.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>0</mml:mn><mml:mi mathvariant="normal"> </mml:mi><mml:mo>~</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1008194.e004"><alternatives><graphic xlink:href="pcbi.1008194.e004.jpg" id="pcbi.1008194.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>~</mml:mo><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></alternatives></disp-formula>
where <italic>r</italic><sub><italic>n</italic></sub> is the total number of genome segments containing functional sequences that are overlapped by sgRNA <italic>n</italic>.</p>
    </sec>
    <sec id="sec023">
      <title>RELICS functional sequence configurations</title>
      <p>We define a configuration to be the positions and lengths of all of the functional sequences. We specify a configuration with a matrix, <bold><italic>δ</italic>,</bold> of dimension <italic>K</italic>×<italic>M</italic>, where an element, <italic>δ</italic><sub><bold><italic>k</italic>,<italic>m</italic></bold></sub>, is 1 if genome segment <italic>m</italic> contains functional sequence <italic>k</italic>, and is 0 otherwise. We call a single row vector of the configuration matrix, <bold><italic>δ</italic></bold><sub><bold><italic>k</italic></bold></sub>, the placement of a functional sequence. In other words, a configuration is a collection of functional sequence placements.</p>
      <p>We want to estimate the probability, <italic>p</italic><sub><italic>m</italic></sub>, that a given genome segment, <italic>m</italic>, contains a functional sequence. To compute <italic>p</italic><sub><italic>m</italic></sub> we could sum the posterior probabilities of all configurations that have a functional sequence in genome segment <italic>m</italic>. However, exact calculation of <italic>p</italic><sub><italic>m</italic></sub> is intractable because the likelihoods of all possible configurations must be computed. For example, even in a simple case where there are <italic>M</italic> = 10,000 genome segments and <italic>K</italic> = 5 regulatory sequences of length <italic>L</italic> = 1, the number of possible <bold><italic>δ</italic></bold> configurations is <inline-formula id="pcbi.1008194.e005"><alternatives><graphic xlink:href="pcbi.1008194.e005.jpg" id="pcbi.1008194.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mfenced separators="|"><mml:mrow><mml:mfrac linethickness="0pt"><mml:mrow><mml:mn>10,000</mml:mn></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mn>8.3</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mn>17</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>.</p>
      <p>To overcome this problem, we developed an approximate inference algorithm known as Iterative Bayesian Stepwise Selection (IBSS) [<xref rid="pcbi.1008194.ref025" ref-type="bibr">25</xref>]. Our version of the IBSS algorithm includes extensions that are specific to RELICS including allowing for functional sequences of variable length and the use of non-normal count data with a Dirichlet multinomial error distribution. Our IBSS algorithm performs stepwise placement of a single functional sequence at a time, while accounting for the (uncertain) placements of all of the other functional sequences.</p>
      <p>To implement the IBSS algorithm, and to account for uncertainty in functional sequence placements, we introduce a functional sequence probability matrix, <bold><italic>π</italic></bold>. This is like the <bold><italic>δ</italic></bold> matrix, but rather than binary values, it contains probabilities. Specifically, each element is the probability that a genome segment contains a specific functional sequence: <italic>π</italic><sub><italic>k</italic>,<italic>m</italic></sub> = Pr(<italic>δ</italic><sub><italic>k</italic>,<italic>m</italic></sub> = 1).</p>
      <p>To allow the positions of known functional sequences (positive controls) to be specified, we add an additional row to the functional sequence probability matrix, which we index as row 0 and denote <bold><italic>π</italic></bold><sub><bold>0</bold></sub>. The probability that a genome segment contains <italic>any</italic> functional sequence is then:<inline-formula id="pcbi.1008194.e006"><alternatives><graphic xlink:href="pcbi.1008194.e006.jpg" id="pcbi.1008194.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
      <p>The number of genome segments that are overlapped by sgRNA <italic>n</italic> and contain a functional sequence follows a Poisson binomial distribution. In other words, the Poisson binomial is used to calculate the probability that an sgRNA overlaps <italic>r</italic><sub><italic>n</italic></sub> genome segments containing functional sequences:
<disp-formula id="pcbi.1008194.e007"><alternatives><graphic xlink:href="pcbi.1008194.e007.jpg" id="pcbi.1008194.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">B</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></alternatives></disp-formula>
where <bold><italic>p</italic></bold><sub><italic>g</italic>(<italic>n</italic>)</sub> is the vector of probabilities for all genome segments associated with sgRNA <italic>n</italic>.</p>
    </sec>
    <sec id="sec024">
      <title>RELICS IBSS algorithm</title>
      <p>The following is a description of the IBSS algorithm that is used to estimate the functional sequence probability matrix <bold><italic>π</italic></bold>.</p>
      <p>
        <underline>Initialize:</underline>
      </p>
      <list list-type="bullet">
        <list-item>
          <p>Set <italic>K</italic> to number of functional sequences.</p>
        </list-item>
        <list-item>
          <p>Set known functional sequences (positive controls) to 1.0 in row <bold><italic>π</italic></bold><sub><bold>0</bold></sub>.</p>
        </list-item>
        <list-item>
          <p>Set all other elements of <bold><italic>π</italic></bold> to 0.0.</p>
        </list-item>
      </list>
      <p>While not converged:</p>
      <list list-type="bullet">
        <list-item>
          <p>Estimate sgRNA sorting hyperparameters (<italic>α</italic><sub>0</sub>, <italic>α</italic><sub>1</sub>) by maximum likelihood.</p>
          <p># Estimate configuration probabilities</p>
        </list-item>
        <list-item>
          <p>For <italic>k</italic> in 1…<italic>K</italic>:
<list list-type="simple"><list-item><label>○</label><p>Set elements of row <bold><italic>π</italic></bold><sub><bold><italic>k</italic></bold></sub> to 0.</p></list-item><list-item><label>○</label><p>Compute <bold><italic>p</italic></bold>, the probability each genome segment contains one of the other functional sequences</p></list-item><list-item><label>○</label><p>Set elements of <bold><italic>π</italic></bold><sub><bold><italic>k</italic></bold></sub> by calculating posterior probability of every possible placement of functional sequence <italic>k</italic>, conditional on <bold><italic>p</italic></bold>.</p></list-item></list></p>
        </list-item>
      </list>
      <p>The algorithm is considered to be converged when the maximum absolute difference in the updated functional sequence probability matrix (max(abs(<bold><italic>π</italic></bold>′−<bold><italic>π</italic></bold>))) less than a defined threshold.</p>
    </sec>
    <sec id="sec025">
      <title>RELICS posterior probabilities of functional sequence placements</title>
      <p>To compute the posterior probability of each functional sequence placement, we first compute the likelihood of all possible placements of functional sequence <italic>k</italic>, taking into account the placements of all of the other functional sequences. We set the elements of <bold><italic>π</italic></bold><sub><bold><italic>k</italic></bold></sub> to 0 and also set all elements of <bold><italic>δ</italic></bold><sub><bold><italic>k</italic></bold></sub> to 0, except those corresponding to the functional sequence placement being considered, which are set to 1. We denote a specific placement as <bold><italic>δ</italic></bold><sub><bold><italic>k</italic></bold></sub><sup>&lt;<italic>m</italic>,<italic>l</italic>&gt;</sup>, where <italic>m</italic> is the genome segment containing the start of the functional sequence, and <italic>l</italic> is the length of the functional sequence. That is, <bold><italic>δ</italic></bold><sub><bold><italic>k</italic></bold></sub><sup>&lt;<italic>m</italic>,<italic>l</italic>&gt;</sup>, is a vector of 0s except for elements <italic>m</italic>.(<italic>m</italic>+<italic>l</italic>−1), which are set to 1. We can compute the probability that a given genome segment contains a functional sequence as <inline-formula id="pcbi.1008194.e008"><alternatives><graphic xlink:href="pcbi.1008194.e008.jpg" id="pcbi.1008194.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi mathvariant="bold-italic"> </mml:mi><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The likelihood of a specific functional sequence placement is then:
<disp-formula id="pcbi.1008194.e009"><alternatives><graphic xlink:href="pcbi.1008194.e009.jpg" id="pcbi.1008194.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:mi mathvariant="script">L</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="normal"> </mml:mi><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>&gt;</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold"> </mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mrow><mml:munder><mml:mo stretchy="false">∏</mml:mo><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="normal">Pr</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">PB</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="normal">Pr</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">DMN</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="normal">Pr</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">PB</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>0</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="normal">Pr</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">DMN</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>
where the product is over all sgRNAs with observed counts, <inline-formula id="pcbi.1008194.e010"><alternatives><graphic xlink:href="pcbi.1008194.e010.jpg" id="pcbi.1008194.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="normal">Pr</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">DMN</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the probability of the observed counts (computed using the Dirichlet multinomial distribution), and <inline-formula id="pcbi.1008194.e011"><alternatives><graphic xlink:href="pcbi.1008194.e011.jpg" id="pcbi.1008194.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:munder><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Pr</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">B</mml:mi></mml:mrow></mml:munder></mml:math></alternatives></inline-formula> is the probability an sgRNA has <italic>r</italic> overlapping functional sequences (computed using the Poisson binomial distribution).</p>
      <p>The posterior probability of a specific functional sequence placement is:
<disp-formula id="pcbi.1008194.e012"><alternatives><graphic xlink:href="pcbi.1008194.e012.jpg" id="pcbi.1008194.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:mi>P</mml:mi><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>&gt;</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mfrac><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Pr</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mi mathvariant="normal"> </mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>&gt;</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="normal"> </mml:mi><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>&gt;</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Pr</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mi mathvariant="normal"> </mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&gt;</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="normal"> </mml:mi><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&gt;</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:math></alternatives></disp-formula>
where the denominator is the sum over all possible placements of this functional sequence and Pr(<bold><italic>δ</italic></bold><sub><bold><italic>k</italic></bold></sub><sup>&lt;<italic>m</italic>,<italic>l</italic>&gt;</sup>) is the prior probability of a specific functional sequence placement.</p>
      <p>We can compute the posterior probability that a genome segment contains functional sequence <italic>k</italic>, by summing the probabilities from all of the possible placements overlapping the segment. We use these posteriors to set the elements of <bold><italic>π</italic></bold><sub><bold><italic>k</italic></bold></sub>:
<disp-formula id="pcbi.1008194.e013"><alternatives><graphic xlink:href="pcbi.1008194.e013.jpg" id="pcbi.1008194.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mi>P</mml:mi><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal"> </mml:mi><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>&gt;</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
    </sec>
    <sec id="sec026">
      <title>RELICS prior probabilities of functional sequence placements</title>
      <p>As prior probabilities for each functional sequence placement, we use a weighting that favors shorter functional sequences. Specifically, we use a geometric distribution, truncated at a maximum of <italic>L</italic>, to weight each possible length:
<disp-formula id="pcbi.1008194.e014"><alternatives><graphic xlink:href="pcbi.1008194.e014.jpg" id="pcbi.1008194.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:mi>w</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>λ</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:math></alternatives></disp-formula>
where <italic>λ</italic> is a constant between 0 and 1 that controls the weighting. We make the prior uniform for all placements with the same value of <italic>l</italic>.</p>
    </sec>
    <sec id="sec027">
      <title>RELICS empirical estimation of hyperparameters</title>
      <p>The RELICS model has hyperparameters, <bold><italic>α</italic></bold><sub><bold>0</bold></sub> and <bold><italic>α</italic></bold><sub><bold>1</bold></sub>, which control the sorting probabilities and dispersion of sgRNA counts across pools. RELICS performs maximum likelihood estimation (MLE) of these parameters each iteration of the IBSS algorithm. This estimation is performed using the full dataset of sgRNA counts, and keeping the functional sequence probabilities fixed to their current estimates, <inline-formula id="pcbi.1008194.e015"><alternatives><graphic xlink:href="pcbi.1008194.e015.jpg" id="pcbi.1008194.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>:
<disp-formula id="pcbi.1008194.e016"><alternatives><graphic xlink:href="pcbi.1008194.e016.jpg" id="pcbi.1008194.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mtext>argmax</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mi mathvariant="script"> </mml:mi><mml:mi mathvariant="script">L</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold"> </mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mfenced></mml:math></alternatives></disp-formula></p>
      <p>We perform MLE by numerical optimization using the L-BFGS-B algorithm [<xref rid="pcbi.1008194.ref039" ref-type="bibr">39</xref>].</p>
    </sec>
    <sec id="sec028">
      <title>RELICS choice of the number of functional sequences (<italic>K</italic>)</title>
      <p>RELICS estimates the number of functional sequences by first setting <italic>K</italic> to 1, and using the IBSS algorithm to estimate the functional sequence probability matrix, <bold><italic>π</italic></bold>. <italic>K</italic> is then increased by one and the process is repeated. Each iteration we compute the pairwise Pearson correlations between all rows of <bold><italic>π</italic></bold>. Initially the pairwise correlations are very low, however once the value of <italic>K</italic> is too high, the functional sequences placed by the algorithm begin to overlap causing positive correlations between pairs of functional sequence probabilities. In both simulations and real data, we have found it practical to set <italic>K</italic> to the largest value that yields a maximum pairwise correlation of less than 0.1. <xref ref-type="fig" rid="pcbi.1008194.g002">Fig 2</xref>, <xref ref-type="supplementary-material" rid="pcbi.1008194.s005">S5 Fig</xref>, and <xref ref-type="supplementary-material" rid="pcbi.1008194.s007">S7 Fig</xref> show how the maximum pairwise correlations increase dramatically once <italic>K</italic> exceeds the number of distinct functional sequences that can be identified from the data.</p>
    </sec>
    <sec id="sec029">
      <title>RELICS input format</title>
      <p>RELICS takes a text-based.csv file as input (for examples see <ext-link ext-link-type="uri" xlink:href="https://github.com/patfiaux/RELICS">https://github.com/patfiaux/RELICS</ext-link>). The file contains the sgRNA information as well as the observed sgRNA counts in different pools. We have made the public datasets we analyzed available in this format at <ext-link ext-link-type="uri" xlink:href="https://figshare.com/projects/RELICS_2_data/74376">https://figshare.com/projects/RELICS_2_data/74376</ext-link>. Alternatively, RELICS can also take in two.csv files, where one file contains the sgRNA information and the other file contains the observed sgRNA counts in different pools.</p>
    </sec>
    <sec sec-type="data-availability" id="sec030">
      <title>Availability of data and materials</title>
      <p>RELICS is open source and available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/patfiaux/RELICS">https://github.com/patfiaux/RELICS</ext-link>). All data were obtained from published papers or simulated as described above. The formatted data that we used for analyses can be downloaded from: <ext-link ext-link-type="uri" xlink:href="https://figshare.com/projects/RELICS_2_data/74376">https://figshare.com/projects/RELICS_2_data/74376</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="sec031">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pcbi.1008194.s001">
      <label>S1 Fig</label>
      <caption>
        <p>CRISPR screen simulation framework (A) Experimental workflow. sgRNAs are introduced into cells and only cells which receive sgRNAs are retained. These cells are then either sorted based on gene expression, or placed under selective pressure (e.g. for survival or proliferation). sgRNA counts and guide ranks before and after selection are shown. (B) In our simulations, we generate an initial sgRNA count distribution and mimic the experimental steps using several different sampling procedures. The simulated sgRNA counts for before and after simulated selection are shown for comparison with the experimental data. (C) Quantile-quantile plots of simulated vs experimental data, before and after selection. (D) Combinations of parameters used for the simulations. We simulated two different types of screens with two different selection strengths, 3 different guide efficiency distributions, and two sequencing depths. For each scenario, we simulated 30 data sets.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1008194.s001.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008194.s002">
      <label>S2 Fig</label>
      <caption>
        <title>Performance evaluation of analysis methods on simulated data for a selection screen with 2 pools.</title>
        <p>(A) Boxplots of average precision for different simulation parameters. (B) Boxplots of precision, the fraction of significant regions that contain a simulated enhancer. (C) Boxplots of recall, the number of simulated enhancers detected (out of 8) amongst the significant regions identified. (D) Boxplots of base pair (BP) accuracy, the fraction of base pairs in significant regions that overlap a simulated enhancer. The hinges of the boxplots correspond to the first and third quartiles, the center lines are the medians, and the whiskers extend to the furthest datapoints that are within 1.5x the interquartile range from the hinge.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1008194.s002.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008194.s003">
      <label>S3 Fig</label>
      <caption>
        <title>Performance evaluation of analysis methods on simulated data for a gene expression (FACS) screen with 4 pools.</title>
        <p>(A) Boxplots of average precision for different simulation parameters. (B) Boxplots of precision, the fraction of significant regions that contain a simulated enhancer. (C) Boxplots of recall, the number of simulated enhancers detected (out of 8) amongst the significant regions identified. (D) Boxplots of base pair (BP) accuracy, the fraction of base pairs in significant regions that overlap a simulated enhancer. The hinges of the boxplots correspond to the first and third quartiles, the center lines are the medians, and the whiskers extend to the furthest datapoints that are within 1.5x the interquartile range from the hinge.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1008194.s003.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008194.s004">
      <label>S4 Fig</label>
      <caption>
        <title>Performance evaluation of analysis methods on data simulated using the simulation tool by Bodapati et al.</title>
        <p>The simulated data is for a selection screen with 2 pools. (A) Boxplots of average precision for different simulation parameters. (B) Boxplots of precision, the fraction of significant regions that contain a simulated enhancer. (C) Boxplots of recall, the number of simulated enhancers detected (out of 8) amongst the significant regions identified. (D) Boxplots of base pair (BP) accuracy, the fraction of base pairs in significant regions that overlap a simulated enhancer. The hinges of the boxplots correspond to the first and third quartiles, the center lines are the medians, and the whiskers extend to the furthest datapoints that are within 1.5x the interquartile range from the hinge. The simulation details are described in the methods. In 117/180 of the simulations RELICS had the highest AP. RELICS also had the highest precision (157/180), recall (163/180) and BP accuracy (102/180).</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1008194.s004.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008194.s005">
      <label>S5 Fig</label>
      <caption>
        <title>Log-likelihood progression and pairwise correlations between functional sequence (FS) probabilities as the number of functional sequences (<italic>K</italic>) is increased.</title>
        <p>(A,C,E) Log likelihood as the number of FSs increases for <italic>CD69</italic>, <italic>MYC</italic> and <italic>GATA1</italic>. (B,D,F) Pairwise FS placement probability correlations for <italic>CD69</italic>, <italic>MYC</italic> and <italic>GATA1</italic>. The red dashed lines indicate the highest pairwise correlation across all FSs. The hinges of the boxplots in (B), (D) and (F) correspond to the first and third quartiles, the center lines are the medians, and the whiskers extend to the furthest datapoints that are within 1.5x the interquartile range from the hinge.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1008194.s005.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008194.s006">
      <label>S6 Fig</label>
      <caption>
        <title>Experimental validation experiments for <italic>CD69</italic>.</title>
        <p>(A) Analysis results for the CD69 screen by RELICS, CRISPR-SURF, MAGeCK and log2 fold change. The RELICS probabilities for each FS are collapsed into a single track. An H3K27ac ChIP-seq track for Jurkat cells is included. The locations of sequences chosen for experimental validation are indicated by colored lines. (B) Results from validation experiments. Lentiviral vectors encoding sgRNAs and dCas9:VP64 were co-transduced into Jurkat cells, and the expression of CD69 protein was quantified by flow cytometry. Non-targeting sgRNAs were used as a negative control. Targeting sgRNAs were chosen for their specificity and high predicted efficiency (relative to other possible sgRNAs in the region) and in some cases are adjacent to the predicted FS rather than within the FS.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1008194.s006.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008194.s007">
      <label>S7 Fig</label>
      <caption>
        <title>Analysis of a CRISPRa screen for <italic>IL2RA</italic> expression published by Simeonov et al. 2017.</title>
        <p>(A) Log-likelihood progression. With the addition of each functional sequence (FS), the model log-likelihood is recorded. (B) The pairwise correlations between functional sequence probabilities as a function of the number of FSs. The red dashed line indicates the highest pairwise correlation between all pairs of FSs. The hinges of the boxplots correspond to the first and third quartiles, the center lines are the medians, and the whiskers extend to the furthest datapoints that are within 1.5x the interquartile range from the hinge. (C) Output of RELICS and another analysis methods. Each FS predicted by RELICS is given a different color and the labels are arranged by genomic position.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1008194.s007.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008194.s008">
      <label>S8 Fig</label>
      <caption>
        <title>Analysis of a published CRISPR inhibition (CRISPRi) cellular proliferation screen around <italic>GATA1</italic> and experimental validation of sequence that is not predicted by RELICS.</title>
        <p>(A) Results from RELICS and other analysis methods. RELICS detects 5 functional sequences (FS1-5). FS1 and FS2 have previously been validated; FS3 and FS4 fall within GATA1. sgRNA target sites for validation experiments are indicated with a red circle (GATA1 promoter) and grey and black triangles (<italic>GLOD5</italic>). (B) Results from validation experiments (2 replicates) using sgRNAs targeting sites indicated in panel A. Each validation experiment is a cellular proliferation assay, in which the percent of GFP-positive cells (i.e. those that received the sgRNA) are measured at day 0, day 6 and day 14. While targeting the <italic>GATA1</italic> promoter greatly reduces proliferation, targeting the <italic>GLOD5</italic> region does not change proliferation compared to a negative control sgRNA, which targets a non-functional ‘safe harbor’ region on chromosome 8.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1008194.s008.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008194.s009">
      <label>S9 Fig</label>
      <caption>
        <title>Analysis results for a CD69 CRISPRa screen without GuideScan filtering and after downsampling sgRNAs or sgRNA counts.</title>
        <p>sgRNA counts were downsampled to 25% of all counts or sgRNA density was downsampled to 25%. Dashed blocks group results from different analysis methods together (RELICS, CRISPR-SURF, MAGeCK, log2 Fold Change).</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1008194.s009.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008194.s010">
      <label>S1 Table</label>
      <caption>
        <title>Number of sgRNAs present in each data set before and after filtering with GuideScan.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1008194.s010.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008194.s011">
      <label>S2 Table</label>
      <caption>
        <title><italic>CD69</italic> CRISPRa validation sgRNAs. TSS sgRNAs target the transcription start site of <italic>CD69</italic>.</title>
        <p>FSs, and ‘Neg. Target’ sgRNAs correspond to labels in <xref ref-type="fig" rid="pcbi.1008194.g004">Fig 4D</xref>. NTC is a non-targeting control sgRNA.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1008194.s011.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008194.s012">
      <label>S3 Table</label>
      <caption>
        <title><italic>MYC and GATA1</italic> CRISPRi validation sgRNAs.</title>
        <p>Guide sequences are given for each target. The positive control targets a known functional sequence (e2) identified by Fulco et al. As negative controls a dCas9:KRAB only or an sgRNA targeting a non-functional safe harbor region on chromosome 8 were used.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1008194.s012.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008194.s013">
      <label>S4 Table</label>
      <caption>
        <title><italic>GATA1</italic> CRISPRi validation sgRNAs.</title>
        <p>Coordinates are given in both hg38 and hg19 genome assemblies. NS is a negative control sgRNA targeting a safe harbor region on chromosome 8. GATA1_TSS sgRNA targets the transcription start site of <italic>GATA1</italic>. The Glod5-1 / Glod5-2 sgRNAs target the putative functional sequence near <italic>GLOD5</italic> identified by Fulco et al. 2016.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1008194.s013.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008194.s014">
      <label>S5 Table</label>
      <caption>
        <title>Description of variables in the RELICS model.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pcbi.1008194.s014.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank Yarui Diao, Rongxin Fang, Ye Zheng, Zhi Liu, and members of the McVicker lab for helpful discussions about analysis methods for CRISPR regulatory screens; Arko Sen for guidance in obtaining and processing public datasets; Bing Ren, for his laboratory’s assistance with CRISPRi validation experiments; and Jessica Zhou and Arya Massarat for testing RELICS and CRSsim.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1008194.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>T</given-names></name>, <name><surname>Wei</surname><given-names>JJ</given-names></name>, <name><surname>Sabatini</surname><given-names>DM</given-names></name>, <name><surname>Lander</surname><given-names>ES</given-names></name>. <article-title>Genetic screens in human cells using the CRISPR-Cas9 system</article-title>. <source>Science</source>. <year>2014</year>;<volume>343</volume>(<issue>6166</issue>):<fpage>80</fpage>–<lpage>4</lpage>. <pub-id pub-id-type="doi">10.1126/science.1246981</pub-id><?supplied-pmid 24336569?><pub-id pub-id-type="pmid">24336569</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Canver</surname><given-names>MC</given-names></name>, <name><surname>Smith</surname><given-names>EC</given-names></name>, <name><surname>Sher</surname><given-names>F</given-names></name>, <name><surname>Pinello</surname><given-names>L</given-names></name>, <name><surname>Sanjana</surname><given-names>NE</given-names></name>, <name><surname>Shalem</surname><given-names>O</given-names></name>, <etal>et al</etal><article-title>BCL11A enhancer dissection by Cas9-mediated in situ saturating mutagenesis</article-title>. <source>Nature</source>. <year>2015</year>;<volume>527</volume>(<issue>7577</issue>):<fpage>192</fpage>–<lpage>7</lpage>. <pub-id pub-id-type="doi">10.1038/nature15521</pub-id><?supplied-pmid 26375006?><pub-id pub-id-type="pmid">26375006</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Fulco</surname><given-names>CP</given-names></name>, <name><surname>Munschauer</surname><given-names>M</given-names></name>, <name><surname>Anyoha</surname><given-names>R</given-names></name>, <name><surname>Munson</surname><given-names>G</given-names></name>, <name><surname>Grossman</surname><given-names>SR</given-names></name>, <name><surname>Perez</surname><given-names>EM</given-names></name>, <etal>et al</etal><article-title>Systematic mapping of functional enhancer-promoter connections with CRISPR interference</article-title>. <source>Science</source>. <year>2016</year>;<volume>354</volume>(<issue>6313</issue>):<fpage>769</fpage>–<lpage>73</lpage>. <pub-id pub-id-type="doi">10.1126/science.aag2445</pub-id><?supplied-pmid 27708057?><pub-id pub-id-type="pmid">27708057</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Diao</surname><given-names>Y</given-names></name>, <name><surname>Li</surname><given-names>B</given-names></name>, <name><surname>Meng</surname><given-names>Z</given-names></name>, <name><surname>Jung</surname><given-names>I</given-names></name>, <name><surname>Lee</surname><given-names>AY</given-names></name>, <name><surname>Dixon</surname><given-names>J</given-names></name>, <etal>et al</etal><article-title>A new class of temporarily phenotypic enhancers identified by CRISPR/Cas9-mediated genetic screening</article-title>. <source>Genome Res</source>. <year>2016</year>;<volume>26</volume>(<issue>3</issue>):<fpage>397</fpage>–<lpage>405</lpage>. <pub-id pub-id-type="doi">10.1101/gr.197152.115</pub-id><?supplied-pmid 26813977?><pub-id pub-id-type="pmid">26813977</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Korkmaz</surname><given-names>G</given-names></name>, <name><surname>Lopes</surname><given-names>R</given-names></name>, <name><surname>Ugalde</surname><given-names>AP</given-names></name>, <name><surname>Nevedomskaya</surname><given-names>E</given-names></name>, <name><surname>Han</surname><given-names>R</given-names></name>, <name><surname>Myacheva</surname><given-names>K</given-names></name>, <etal>et al</etal><article-title>Functional genetic screens for enhancer elements in the human genome using CRISPR-Cas9</article-title>. <source>Nat Biotechnol</source>. <year>2016</year>;<volume>34</volume>(<issue>2</issue>):<fpage>192</fpage>–<lpage>8</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.3450</pub-id><?supplied-pmid 26751173?><pub-id pub-id-type="pmid">26751173</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Sanjana</surname><given-names>NE</given-names></name>, <name><surname>Wright</surname><given-names>J</given-names></name>, <name><surname>Zheng</surname><given-names>K</given-names></name>, <name><surname>Shalem</surname><given-names>O</given-names></name>, <name><surname>Fontanillas</surname><given-names>P</given-names></name>, <name><surname>Joung</surname><given-names>J</given-names></name>, <etal>et al</etal><article-title>High-resolution interrogation of functional elements in the noncoding genome</article-title>. <source>Science</source><year>2016</year>;<volume>353</volume>(<issue>6307</issue>):<fpage>1545</fpage>–<lpage>9</lpage>. <pub-id pub-id-type="doi">10.1126/science.aaf7613</pub-id><?supplied-pmid 27708104?><pub-id pub-id-type="pmid">27708104</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Rajagopal</surname><given-names>N</given-names></name>, <name><surname>Srinivasan</surname><given-names>S</given-names></name>, <name><surname>Kooshesh</surname><given-names>K</given-names></name>, <name><surname>Guo</surname><given-names>Y</given-names></name>, <name><surname>Edwards</surname><given-names>MD</given-names></name>, <name><surname>Banerjee</surname><given-names>B</given-names></name>, <etal>et al</etal><article-title>High-throughput mapping of regulatory DNA</article-title>. <source>Nat Biotechnol</source>. <year>2016</year>;<volume>34</volume>(<issue>2</issue>):<fpage>167</fpage>–<lpage>74</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.3468</pub-id><?supplied-pmid 26807528?><pub-id pub-id-type="pmid">26807528</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Gasperini</surname><given-names>M</given-names></name>, <name><surname>Findlay</surname><given-names>GM</given-names></name>, <name><surname>McKenna</surname><given-names>A</given-names></name>, <name><surname>Milbank</surname><given-names>JH</given-names></name>, <name><surname>Lee</surname><given-names>C</given-names></name>, <name><surname>Zhang</surname><given-names>MD</given-names></name>, <etal>et al</etal><article-title>CRISPR/Cas9-Mediated Scanning for Regulatory Elements Required for HPRT1 Expression via Thousands of Large, Programmed Genomic Deletions</article-title>. <source>Am J Hum Genet</source>. <year>2017</year>;<volume>101</volume>(<issue>2</issue>):<fpage>192</fpage>–<lpage>205</lpage>. Epub 2017/07/18. <pub-id pub-id-type="doi">10.1016/j.ajhg.2017.06.010</pub-id><?supplied-pmid 28712454?><pub-id pub-id-type="pmid">28712454</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Simeonov</surname><given-names>DR</given-names></name>, <name><surname>Gowen</surname><given-names>BG</given-names></name>, <name><surname>Boontanrart</surname><given-names>M</given-names></name>, <name><surname>Roth</surname><given-names>TL</given-names></name>, <name><surname>Gagnon</surname><given-names>JD</given-names></name>, <name><surname>Mumbach</surname><given-names>MR</given-names></name>, <etal>et al</etal><article-title>Discovery of stimulation-responsive immune enhancers with CRISPR activation</article-title>. <source>Nature</source>. <year>2017</year> Epub 2017/08/31. <pub-id pub-id-type="doi">10.1038/nature23875</pub-id> .<?supplied-pmid 28854172?><pub-id pub-id-type="pmid">28854172</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Klann</surname><given-names>TS</given-names></name>, <name><surname>Black</surname><given-names>JB</given-names></name>, <name><surname>Chellappan</surname><given-names>M</given-names></name>, <name><surname>Safi</surname><given-names>A</given-names></name>, <name><surname>Song</surname><given-names>L</given-names></name>, <name><surname>Hilton</surname><given-names>IB</given-names></name>, <etal>et al</etal><article-title>CRISPR-Cas9 epigenome editing enables high-throughput screening for functional regulatory elements in the human genome</article-title>. <source>Nat Biotechnol</source>. <year>2017</year><pub-id pub-id-type="doi">10.1038/nbt.3853</pub-id><?supplied-pmid 28369033?><pub-id pub-id-type="pmid">28369033</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Diao</surname><given-names>Y</given-names></name>, <name><surname>Fang</surname><given-names>R</given-names></name>, <name><surname>Li</surname><given-names>B</given-names></name>, <name><surname>Meng</surname><given-names>Z</given-names></name>, <name><surname>Yu</surname><given-names>J</given-names></name>, <name><surname>Qiu</surname><given-names>Y</given-names></name>, <etal>et al</etal><article-title>A tiling-deletion-based genetic screen for cis-regulatory element identification in mammalian cells</article-title>. <source>Nat Methods</source>. <year>2017</year>;<volume>14</volume>(<issue>6</issue>):<fpage>629</fpage>–<lpage>35</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.4264</pub-id><?supplied-pmid 28417999?><pub-id pub-id-type="pmid">28417999</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Fulco</surname><given-names>CP</given-names></name>, <name><surname>Nasser</surname><given-names>J</given-names></name>, <name><surname>Jones</surname><given-names>TR</given-names></name>, <name><surname>Munson</surname><given-names>G</given-names></name>, <name><surname>Bergman</surname><given-names>DT</given-names></name>, <name><surname>Subramanian</surname><given-names>V</given-names></name>, <etal>et al</etal><article-title>Activity-by-contact model of enhancer-promoter regulation from thousands of CRISPR perturbations</article-title>. <source>Nat Genet</source>. <year>2019</year>;<volume>51</volume>(<issue>12</issue>):<fpage>1664</fpage>–<lpage>9</lpage>. Epub 2019/12/01. <pub-id pub-id-type="doi">10.1038/s41588-019-0538-0</pub-id><?supplied-pmid 31784727?><pub-id pub-id-type="pmid">31784727</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Jinek</surname><given-names>M</given-names></name>, <name><surname>East</surname><given-names>A</given-names></name>, <name><surname>Cheng</surname><given-names>A</given-names></name>, <name><surname>Lin</surname><given-names>S</given-names></name>, <name><surname>Ma</surname><given-names>E</given-names></name>, <name><surname>Doudna</surname><given-names>J</given-names></name>. <article-title>RNA-programmed genome editing in human cells</article-title>. <source>Elife</source>. <year>2013</year>;<volume>2</volume>:<fpage>e00471</fpage> Epub 2013/02/07. <pub-id pub-id-type="doi">10.7554/eLife.00471</pub-id>
<?supplied-pmid 23386978?><pub-id pub-id-type="pmid">23386978</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Gilbert</surname><given-names>LA</given-names></name>, <name><surname>Horlbeck</surname><given-names>MA</given-names></name>, <name><surname>Adamson</surname><given-names>B</given-names></name>, <name><surname>Villalta</surname><given-names>JE</given-names></name>, <name><surname>Chen</surname><given-names>Y</given-names></name>, <name><surname>Whitehead</surname><given-names>EH</given-names></name>, <etal>et al</etal><article-title>Genome-Scale CRISPR-Mediated Control of Gene Repression and Activation</article-title>. <source>Cell</source>. <year>2014</year>;<volume>159</volume>(<issue>3</issue>):<fpage>647</fpage>–<lpage>61</lpage>. Epub 2014/10/14. <pub-id pub-id-type="doi">10.1016/j.cell.2014.09.029</pub-id><?supplied-pmid 25307932?><pub-id pub-id-type="pmid">25307932</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Thakore</surname><given-names>PI</given-names></name>, <name><surname>D'Ippolito</surname><given-names>AM</given-names></name>, <name><surname>Song</surname><given-names>L</given-names></name>, <name><surname>Safi</surname><given-names>A</given-names></name>, <name><surname>Shivakumar</surname><given-names>NK</given-names></name>, <name><surname>Kabadi</surname><given-names>AM</given-names></name>, <etal>et al</etal><article-title>Highly specific epigenome editing by CRISPR-Cas9 repressors for silencing of distal regulatory elements.</article-title><source>Nat Methods</source>. <year>2015</year>;<volume>12</volume>(<issue>12</issue>):<fpage>1143</fpage>–<lpage>9</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.3630</pub-id><?supplied-pmid 26501517?><pub-id pub-id-type="pmid">26501517</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Konermann</surname><given-names>S</given-names></name>, <name><surname>Brigham</surname><given-names>MD</given-names></name>, <name><surname>Trevino</surname><given-names>AE</given-names></name>, <name><surname>Joung</surname><given-names>J</given-names></name>, <name><surname>Abudayyeh</surname><given-names>OO</given-names></name>, <name><surname>Barcena</surname><given-names>C</given-names></name>, <etal>et al</etal><article-title>Genome-scale transcriptional activation by an engineered CRISPR-Cas9 complex</article-title>. <source>Nature</source>. <year>2015</year>;<volume>517</volume>(<issue>7536</issue>):<fpage>583</fpage>–<lpage>8</lpage>. <pub-id pub-id-type="doi">10.1038/nature14136</pub-id><?supplied-pmid 25494202?><pub-id pub-id-type="pmid">25494202</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Hilton</surname><given-names>IB</given-names></name>, <name><surname>D'Ippolito</surname><given-names>AM</given-names></name>, <name><surname>Vockley</surname><given-names>CM</given-names></name>, <name><surname>Thakore</surname><given-names>PI</given-names></name>, <name><surname>Crawford</surname><given-names>GE</given-names></name>, <name><surname>Reddy</surname><given-names>TE</given-names></name>, <etal>et al</etal><article-title>Epigenome editing by a CRISPR-Cas9-based acetyltransferase activates genes from promoters and enhancers</article-title>. <source>Nat Biotechnol</source>. <year>2015</year>;<volume>33</volume>(<issue>5</issue>):<fpage>510</fpage>–<lpage>7</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.3199</pub-id><?supplied-pmid 25849900?><pub-id pub-id-type="pmid">25849900</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Perez-Pinera</surname><given-names>P</given-names></name>, <name><surname>Kocak</surname><given-names>DD</given-names></name>, <name><surname>Vockley</surname><given-names>CM</given-names></name>, <name><surname>Adler</surname><given-names>AF</given-names></name>, <name><surname>Kabadi</surname><given-names>AM</given-names></name>, <name><surname>Polstein</surname><given-names>LR</given-names></name>, <etal>et al</etal><article-title>RNA-guided gene activation by CRISPR-Cas9-based transcription factors</article-title>. <source>Nat Methods</source>. <year>2013</year>;<volume>10</volume>(<issue>10</issue>):<fpage>973</fpage>–<lpage>6</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.2600</pub-id><?supplied-pmid 23892895?><pub-id pub-id-type="pmid">23892895</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Love</surname><given-names>MI</given-names></name>, <name><surname>Huber</surname><given-names>W</given-names></name>, <name><surname>Anders</surname><given-names>S</given-names></name>. <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>. <source>Genome Biol</source>. <year>2014</year>;<volume>15</volume>(<issue>12</issue>):<fpage>550</fpage> Epub 2014/12/18. <pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id>
<?supplied-pmid 25516281?><pub-id pub-id-type="pmid">25516281</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>van de Geijn</surname><given-names>B</given-names></name>, <name><surname>McVicker</surname><given-names>G</given-names></name>, <name><surname>Gilad</surname><given-names>Y</given-names></name>, <name><surname>Pritchard</surname><given-names>JK</given-names></name>. <article-title>WASP: allele-specific software for robust molecular quantitative trait locus discovery</article-title>. <source>Nat Methods</source>. <year>2015</year>;<volume>12</volume>(<issue>11</issue>):<fpage>1061</fpage>–<lpage>3</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.3582</pub-id> PubMed Central PMCID:PMC4626402. <?supplied-pmid 26366987?><pub-id pub-id-type="pmid">26366987</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>W</given-names></name>, <name><surname>Xu</surname><given-names>H</given-names></name>, <name><surname>Xiao</surname><given-names>T</given-names></name>, <name><surname>Cong</surname><given-names>L</given-names></name>, <name><surname>Love</surname><given-names>MI</given-names></name>, <name><surname>Zhang</surname><given-names>F</given-names></name>, <etal>et al</etal><article-title>MAGeCK enables robust identification of essential genes from genome-scale CRISPR/Cas9 knockout screens</article-title>. <source>Genome Biol</source>. <year>2014</year>;<volume>15</volume>(<issue>12</issue>):<fpage>554</fpage><pub-id pub-id-type="doi">10.1186/s13059-014-0554-4</pub-id><?supplied-pmid 25476604?><pub-id pub-id-type="pmid">25476604</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Hart</surname><given-names>T</given-names></name>, <name><surname>Moffat</surname><given-names>J</given-names></name>. <article-title>BAGEL: a computational framework for identifying essential genes from pooled library screens</article-title>. <source>BMC Bioinformatics</source>. <year>2016</year>;<volume>17</volume>:<fpage>164</fpage> Epub 2016/04/17. <pub-id pub-id-type="doi">10.1186/s12859-016-1015-8</pub-id>
<?supplied-pmid 27083490?><pub-id pub-id-type="pmid">27083490</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Hsu</surname><given-names>JY</given-names></name>, <name><surname>Fulco</surname><given-names>CP</given-names></name>, <name><surname>Cole</surname><given-names>MA</given-names></name>, <name><surname>Canver</surname><given-names>MC</given-names></name>, <name><surname>Pellin</surname><given-names>D</given-names></name>, <name><surname>Sher</surname><given-names>F</given-names></name>, <etal>et al</etal><article-title>CRISPR-SURF: discovering regulatory elements by deconvolution of CRISPR tiling screen data</article-title>. <source>Nat Methods</source>. <year>2018</year>;<volume>15</volume>(<issue>12</issue>):<fpage>992</fpage>–<lpage>3</lpage>. Epub 2018/12/07. <pub-id pub-id-type="doi">10.1038/s41592-018-0225-6</pub-id> ; <source>PubMed Central PMCID</source>:PMC6620603.<?supplied-pmid 30504875?><pub-id pub-id-type="pmid">30504875</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Robinson</surname><given-names>MD</given-names></name>, <name><surname>McCarthy</surname><given-names>DJ</given-names></name>, <name><surname>Smyth</surname><given-names>GK</given-names></name>. <article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>1</issue>):<fpage>139</fpage>–<lpage>40</lpage>. Epub 2009/11/17. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id><?supplied-pmid 19910308?><pub-id pub-id-type="pmid">19910308</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>G</given-names></name>, <name><surname>Sarkar</surname><given-names>AK</given-names></name>, <name><surname>Carbonetto</surname><given-names>P</given-names></name>, <name><surname>Stephens</surname><given-names>M</given-names></name>. <article-title>A simple new approach to variable selection in regression, with application to genetic fine-mapping</article-title>. <source>J R Stat Soc B</source>. <year>2020</year><pub-id pub-id-type="doi">10.1111/rssb.12388</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Doench</surname><given-names>JG</given-names></name>, <name><surname>Fusi</surname><given-names>N</given-names></name>, <name><surname>Sullender</surname><given-names>M</given-names></name>, <name><surname>Hegde</surname><given-names>M</given-names></name>, <name><surname>Vaimberg</surname><given-names>EW</given-names></name>, <name><surname>Donovan</surname><given-names>KF</given-names></name>, <etal>et al</etal><article-title>Optimized sgRNA design to maximize activity and minimize off-target effects of CRISPR-Cas9</article-title>. <source>Nat Biotechnol</source>. <year>2016</year>;<volume>34</volume>(<issue>2</issue>):<fpage>184</fpage>–<lpage>91</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.3437</pub-id><?supplied-pmid 26780180?><pub-id pub-id-type="pmid">26780180</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Bodapati</surname><given-names>S</given-names></name>, <name><surname>Daley</surname><given-names>TP</given-names></name>, <name><surname>Lin</surname><given-names>X</given-names></name>, <name><surname>Zou</surname><given-names>J</given-names></name>, <name><surname>Qi</surname><given-names>LS</given-names></name>. <article-title>A benchmark of algorithms for the analysis of pooled CRISPR screens</article-title>. <source>Genome Biol</source>. <year>2020</year>;<volume>21</volume>(<issue>1</issue>):<fpage>62</fpage> Epub 2020/03/11. <pub-id pub-id-type="doi">10.1186/s13059-020-01972-x</pub-id>
<?supplied-pmid 32151271?><pub-id pub-id-type="pmid">32151271</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Hsu</surname><given-names>PD</given-names></name>, <name><surname>Scott</surname><given-names>DA</given-names></name>, <name><surname>Weinstein</surname><given-names>JA</given-names></name>, <name><surname>Ran</surname><given-names>FA</given-names></name>, <name><surname>Konermann</surname><given-names>S</given-names></name>, <name><surname>Agarwala</surname><given-names>V</given-names></name>, <etal>et al</etal><article-title>DNA targeting specificity of RNA-guided Cas9 nucleases</article-title>. <source>Nat Biotechnol</source>. <year>2013</year>;<volume>31</volume>(<issue>9</issue>):<fpage>827</fpage>–<lpage>32</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.2647</pub-id><?supplied-pmid 23873081?><pub-id pub-id-type="pmid">23873081</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Xu</surname><given-names>H</given-names></name>, <name><surname>Xiao</surname><given-names>T</given-names></name>, <name><surname>Chen</surname><given-names>C-H</given-names></name>, <name><surname>Li</surname><given-names>W</given-names></name>, <name><surname>Meyer</surname><given-names>CA</given-names></name>, <name><surname>Wu</surname><given-names>Q</given-names></name>, <etal>et al</etal><article-title>Sequence determinants of improved CRISPR sgRNA design</article-title>. <source>Genome Res</source>. <year>2015</year>;<volume>25</volume>(<issue>8</issue>):<fpage>1147</fpage>–<lpage>57</lpage>. <pub-id pub-id-type="doi">10.1101/gr.191452.115</pub-id><?supplied-pmid 26063738?><pub-id pub-id-type="pmid">26063738</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Abadi</surname><given-names>S</given-names></name>, <name><surname>Yan</surname><given-names>WX</given-names></name>, <name><surname>Amar</surname><given-names>D</given-names></name>, <name><surname>Mayrose</surname><given-names>I</given-names></name>. <article-title>A machine learning approach for predicting CRISPR-Cas9 cleavage efficiencies and patterns underlying its mechanism of action</article-title>. <source>PLoS Comput Biol</source>. <year>2017</year>;<volume>13</volume>(<issue>10</issue>):<fpage>e1005807</fpage> Epub 2017/10/17. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1005807</pub-id>
<?supplied-pmid 29036168?><pub-id pub-id-type="pmid">29036168</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>McKenna</surname><given-names>A</given-names></name>, <name><surname>Shendure</surname><given-names>J</given-names></name>. <article-title>FlashFry: a fast and flexible tool for large-scale CRISPR target design</article-title>. <source>BMC Biol</source>. <year>2018</year>;<volume>16</volume>(<issue>1</issue>):<fpage>74</fpage> Epub 2018/07/07. <pub-id pub-id-type="doi">10.1186/s12915-018-0545-0</pub-id>
<?supplied-pmid 29976198?><pub-id pub-id-type="pmid">29976198</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Perez</surname><given-names>AR</given-names></name>, <name><surname>Pritykin</surname><given-names>Y</given-names></name>, <name><surname>Vidigal</surname><given-names>JA</given-names></name>, <name><surname>Chhangawala</surname><given-names>S</given-names></name>, <name><surname>Zamparo</surname><given-names>L</given-names></name>, <name><surname>Leslie</surname><given-names>CS</given-names></name>, <etal>et al</etal><article-title>GuideScan software for improved single and paired CRISPR guide RNA design</article-title>. <source>Nat Biotechnol</source>. <year>2017</year>;<volume>35</volume>(<issue>4</issue>):<fpage>347</fpage>–<lpage>9</lpage>. Epub 2017/03/07. <pub-id pub-id-type="doi">10.1038/nbt.3804</pub-id><?supplied-pmid 28263296?><pub-id pub-id-type="pmid">28263296</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Tycko</surname><given-names>J</given-names></name>, <name><surname>Wainberg</surname><given-names>M</given-names></name>, <name><surname>Marinov</surname><given-names>GK</given-names></name>, <name><surname>Ursu</surname><given-names>O</given-names></name>, <name><surname>Hess</surname><given-names>GT</given-names></name>, <name><surname>Ego</surname><given-names>BK</given-names></name>, <etal>et al</etal><article-title>Mitigation of off-target toxicity in CRISPR-Cas9 screens for essential non-coding elements</article-title>. <source>Nat Commun</source>. <year>2019</year>;<volume>10</volume>(<issue>1</issue>):<fpage>4063</fpage> Epub 2019/09/08. <pub-id pub-id-type="doi">10.1038/s41467-019-11955-7</pub-id>
<?supplied-pmid 31492858?><pub-id pub-id-type="pmid">31492858</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Mansour</surname><given-names>MR</given-names></name>, <name><surname>Abraham</surname><given-names>BJ</given-names></name>, <name><surname>Anders</surname><given-names>L</given-names></name>, <name><surname>Berezovskaya</surname><given-names>A</given-names></name>, <name><surname>Gutierrez</surname><given-names>A</given-names></name>, <name><surname>Durbin</surname><given-names>AD</given-names></name>, <etal>et al</etal><article-title>An oncogenic super-enhancer formed through somatic mutation of a noncoding intergenic element</article-title>. <source>Science</source>. <year>2014</year>;<volume>346</volume>(<issue>6215</issue>):<fpage>1373</fpage>–<lpage>7</lpage>. <pub-id pub-id-type="doi">10.1126/science.1259037</pub-id><?supplied-pmid 25394790?><pub-id pub-id-type="pmid">25394790</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H.</given-names></name><article-title>Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM</article-title>. <source>arXiv [q-bioGN]</source>. <year>2013</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Handsaker</surname><given-names>B</given-names></name>, <name><surname>Wysoker</surname><given-names>A</given-names></name>, <name><surname>Fennell</surname><given-names>T</given-names></name>, <name><surname>Ruan</surname><given-names>J</given-names></name>, <name><surname>Homer</surname><given-names>N</given-names></name>, <etal>et al</etal><article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>(<issue>16</issue>):<fpage>2078</fpage>–<lpage>9</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id><?supplied-pmid 19505943?><pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Ramirez</surname><given-names>F</given-names></name>, <name><surname>Ryan</surname><given-names>DP</given-names></name>, <name><surname>Gruning</surname><given-names>B</given-names></name>, <name><surname>Bhardwaj</surname><given-names>V</given-names></name>, <name><surname>Kilpert</surname><given-names>F</given-names></name>, <name><surname>Richter</surname><given-names>AS</given-names></name>, <etal>et al</etal><article-title>deepTools2: a next generation web server for deep-sequencing data analysis</article-title>. <source>Nucleic Acids Res</source>. <year>2016</year>;<volume>44</volume>(<issue>W1</issue>):<fpage>W160</fpage>–<lpage>5</lpage>. Epub 2016/04/16. <pub-id pub-id-type="doi">10.1093/nar/gkw257</pub-id><?supplied-pmid 27079975?><pub-id pub-id-type="pmid">27079975</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Doench</surname><given-names>JG</given-names></name>, <name><surname>Hartenian</surname><given-names>E</given-names></name>, <name><surname>Graham</surname><given-names>DB</given-names></name>, <name><surname>Tothova</surname><given-names>Z</given-names></name>, <name><surname>Hegde</surname><given-names>M</given-names></name>, <name><surname>Smith</surname><given-names>I</given-names></name>, <etal>et al</etal><article-title>Rational design of highly active sgRNAs for CRISPR-Cas9-mediated gene inactivation</article-title>. <source>Nat Biotechnol</source>. <year>2014</year>;<volume>32</volume>(<issue>12</issue>):<fpage>1262</fpage>–<lpage>7</lpage>. Epub 2014/09/04. <pub-id pub-id-type="doi">10.1038/nbt.3026</pub-id><?supplied-pmid 25184501?><pub-id pub-id-type="pmid">25184501</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008194.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Byrd</surname><given-names>RH</given-names></name>, <name><surname>Lu</surname><given-names>P</given-names></name>, <name><surname>Nocedal</surname><given-names>J</given-names></name>, <name><surname>Zhu</surname><given-names>C</given-names></name>. <article-title>A Limited Memory Algorithm for Bound Constrained Optimization</article-title>. <source>SIAM Journal on Scientific Computing</source>. <year>1995</year>;<volume>16</volume>(<issue>5</issue>):<fpage>1190</fpage>–<lpage>208</lpage>. <pub-id pub-id-type="doi">10.1137/0916069</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="pcbi.1008194.r001" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008194.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ioshikhes</surname>
          <given-names>Ilya</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Jian</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Ioshikhes, Ma</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Ioshikhes, Ma</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj001" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008194" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">4 May 2020</named-content>
    </p>
    <p>Dear Dr. McVicker,</p>
    <p>Thank you very much for submitting your manuscript "Discovering functional sequences with RELICS, an analysis method for CRISPR screens" for consideration at PLOS Computational Biology.</p>
    <p>As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. In light of the reviews (below this email), we would like to invite the resubmission of a significantly-revised version that takes into account the reviewers' comments.</p>
    <p>We cannot make any decision about publication until we have seen the revised manuscript and your response to the reviewers' comments. Your revised manuscript is also likely to be sent to reviewers for further evaluation.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Please prepare and submit your revised manuscript within 60 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. Please note that revised manuscripts received after the 60-day due date may require evaluation and peer review similar to newly submitted manuscripts.</p>
    <p>Thank you again for your submission. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Ilya Ioshikhes</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Jian Ma</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p><bold>Reviewer #1: </bold>The study entitled "Discovering functional sequences with RELICs, an analysis method for CRISPR screens" by Fiaux et al describes a novel method for analyzing pooled genetic screens. Overall, this study is clearly written and uses an innovative approach for screen analytics, which is distinct from previously described methods (BAGEL, MAGECK). The use of simulated and 'real' data is effective and strongly supports the power of this approach. In summary, I believe this study describes a useful tool that will be of broad utility to the field.</p>
    <p><bold>Reviewer #2: </bold>In this manuscript, Fiaux et al. describe Regulatory Element Location Identification in CRISPR Screens (RELICS), a computational method to identify functional regulatory sequences from CRISPR tiling screens using sgRNA counts from multiple pools. To evaluate the performance of their method, the authors also developed a CRISPR simulation framework, CRSsim. They generated a total of 720 simulations using this framework by varying the strength of the guide, sequencing depth and the strength of selection. RELICS was tested on these simulated datasets and then compared to the predictions from BAGEL, MAGeCK and CRISPR-SURF. The authors then applied their method to existing CRISPRa/i tiling screens to show that RELICS predicts functional sequences predicted by other existing algorithms and also novel ones. They validated RELICS predicted functional sequences by using CRISPRa to overexpress CD69 assayed by flow cytometry.</p>
    <p>Overall, RELICS could potentially help in discovering functional sequences using CRISPR screens but this manuscript needs to be supported with more evidence that this method is better than existing tools. The novelty of this method is not very clear in the current state of the manuscript. The lack of “ground truth” in most of these cases could be a problem. The authors clearly note in the discussion that prior knowledge of a positive control region is necessary to run this analysis and might be difficult to obtain. The existing tools used for comparison also do not seem relevant as elaborated below.</p>
    <p>Major points</p>
    <p>
      <list list-type="order">
        <list-item>
          <p>The authors mention that the simulation framework CRSsim generates “realistic datasets where the ground truth is known”. A figure comparing the data generated by this framework to some existing CRISPR datasets would strengthen this manuscript.</p>
        </list-item>
        <list-item>
          <p>Base pair accuracy (BP) is defined as the fraction of significant bases identified which are true functional sequences. How are “true” functional sequences identified here? Also, in Figure 2, RELICS does predict functional sequences with higher BP accuracy than other methods especially for a guide with lower efficiency and weak selection strength but the BP accuracy does not get better for stronger guides or stronger selection strengths. Why is that the case?</p>
        </list-item>
        <list-item>
          <p>The authors use four other methods to compare RELICS to. The log-fold change is just a simple transformation of the data and not really a “method”. Likewise, BAGEL and MAGeCK are approaches to find essential genes, not identify functional elements. These comparisons should be excluded and the only relevant comparison to CRISPR-SURF should be included in this manuscript.</p>
        </list-item>
        <list-item>
          <p>The authors also show that their method is better than BAGEL, MAGeCK and CRISPR-SURF using precision-recall AUC and BP accuracy on the simulated datasets. These metrics should also be used to demonstrate that RELICS is better than the other methods using the published data sets.</p>
        </list-item>
        <list-item>
          <p>Only a single guide is used to validate the “negative sequence” prediction that was made by MAGeCK and is in a significant portion predicted by CRISPR-SURF but not RELICS. The Rule Set 2 score of this guide is 0.39 which makes it an inefficient guide. The authors do note in the legend of Figure 4 that “Targeting sgRNAs were chosen for their high predicted efficiency”. Based on what criteria were the targeting sgRNAs picked? Also, when a single guide is used for validation, it is difficult to determine if CD69 activation was not observed due to the inefficiency of the guide or the region did not indeed have a functional sequence. The authors do validate most other regions with 2 sgRNAs but why was this region only targeted with one guide? </p>
        </list-item>
        <list-item>
          <p>To support their claim of RELICS identifying new regions, the authors should validate the 5 regions identified around the MYC locus that have not been reported previously. This would help in proving the novelty of this method.</p>
        </list-item>
        <list-item>
          <p>RELICS was easy to use and the instructions were very clear on GitHub. Well documented tools are hard to find and the authors have done a very good job on explaining the various parameters that can be used to run this tool.</p>
        </list-item>
        <list-item>
          <p>Bodapati et al., 2020 describes a simulation framework for CRISPR screens and the use of similar hyperparameters as described in this paper. It might be useful to compare CRSsim to their framework and also apply RELICS to datasets simulated by their framework.</p>
        </list-item>
      </list>
    </p>
    <p>Minor points</p>
    <p>
      <list list-type="order">
        <list-item>
          <p>Typo in Line 152, it should be “functional sequence probabilities”.</p>
        </list-item>
        <list-item>
          <p>In line 157, the authors mention that RELICS predictions on the simulated datasets were compared to “log-fold change”, but this comparison has neither been demonstrated in the main or supplementary figures nor has been further discussed in the text.</p>
        </list-item>
        <list-item>
          <p>In line 190, Figure 3(a, b) are referenced but do not directly correspond to the text. Figure 3(c, d) are referenced after Figure 4. It might be helpful to re-order the figures to go with the flow of the text.</p>
        </list-item>
        <list-item>
          <p>In Figure 5b., indicate what the two lines for GLOD5 sgRNA1, GLOD5 sgRNA2 and Negative control indicate? Are they replicates?</p>
        </list-item>
        <list-item>
          <p>Supplementary Figure 3 &amp; 4 indicate the method used as “RELICS 2” but other figures say “RELICS ''. Please explain the difference between these methods.</p>
        </list-item>
        <list-item>
          <p>Please include why and how sgRNAs were filtered to run CRISPR-SURF on the experimental datasets?</p>
        </list-item>
        <list-item>
          <p>Another analysis that might be worth adding would be to filter out promiscuous guides from the tiling libraries as shown by Tycko et al., 2019 and re-assessing the performance of RELICS.</p>
        </list-item>
      </list>
    </p>
    <p><bold>Reviewer #3: </bold>The paper by Fiaux et al. introduces a Bayesian hierarchical model, which the authors termed RELICS, designed to help identifying functional sequences using CRISPR screens. The model performs best when offered data that contain positive controls (known functional sequences) and as such uses a semi-supervised approach. To test the performance of their model, the authors also developed an open source simulation tool, CRSsim, which should be useful for cross-validation of performances of different models. The RELICS method seems interesting and may embody a considerable advance as it outperformed existing models in the analyses shown. The manuscript is well-written and the data are aesthetically well present.</p>
    <p>Major point:</p>
    <p>The RELICS methodology is not well explained and confusingly presented. Although most of the information can be found in the manuscript, most readers will miss it because it takes a while to find. In some sections the presentation is a bit too technical and as such makes for a tedious read. To make this manuscript more accessible to a broader authorship, the authors are encouraged to walk the reader through the key design steps of RELICS in plain language, to reduce jargon and where needed explain terminology on first use. In its current form, readers will also find it difficult to fully appreciate the strengths of the methodology and to independently validate that comparisons to existing models were undertaken in a way that did not favor RELICS.</p>
    <p>Minor points:</p>
    <p>Figure 1a: The ‘area of effect’ depictions in this schematic are indicating identical spans for each guide. In reality, guides that target overlapping functional sequences would be expected to often have the boundaries of their ‘areas of effect’ coincide.</p>
    <p>Figure 1b and c: The authors chose to depict guides in different pools with the same colors, which I presume does not indicate that indeed the guides used in the different pools were identical? This is confusing and should be changed unless I misunderstood the methodology.</p>
    <p>P18, Lines 335 -369: It seems that positive controls (i.e., known functional sequences) were specified only for RELICS, not any of the other platforms it performance was compared against. Since the authors mentioned that RELICS may be difficult to apply to datasets without an identified positive control (line 265), would the lack of a positive control have disadvantaged the performance of the other platforms, and if so, to which extent would this have compromised their performance when compared with RELICS?</p>
    <p>P23, Lines 487-488: Note that the font is changing in unexpected ways in this section.</p>
    <p>Overall, this reviewer is excited about this paper but strongly advises the authors to change the presentation such that the key design features and steps distinguishing RELICS from existing methodologies are explained early on.</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Computational Biology</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: None</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>Reviewer #3: No</p>
    <p>
      <underline>Figure Files:</underline>
    </p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <underline><ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/" xlink:type="simple">https://pacev2.apexcovantage.com</ext-link></underline>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <underline><email xlink:type="simple">figures@plos.org</email></underline>.</p>
    <p>
      <underline>Data Requirements:</underline>
    </p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link ext-link-type="uri" xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>
      <underline>Reproducibility:</underline>
    </p>
    <p>To enhance the reproducibility of your results, PLOS recommends that you deposit laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions, please see <underline><ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plospathogens/s/submission-guidelines" xlink:type="simple">http://journals.plos.org/compbiol/s/submission-guidelines#loc-materials-and-methods</ext-link></underline></p>
  </body>
</sub-article>
<sub-article id="pcbi.1008194.r002" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008194.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article id="rel-obj002" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008194" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">13 Jul 2020</named-content>
    </p>
    <supplementary-material content-type="local-data" id="pcbi.1008194.s015">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Fiaux_et_al_rebuttal.docx</named-content></p>
      </caption>
      <media xlink:href="pcbi.1008194.s015.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pcbi.1008194.r003" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008194.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ioshikhes</surname>
          <given-names>Ilya</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Jian</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Ioshikhes, Ma</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Ioshikhes, Ma</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj003" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008194" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">25 Jul 2020</named-content>
    </p>
    <p>Dear Dr. McVicker,</p>
    <p>We are pleased to inform you that your manuscript 'Discovering functional sequences with RELICS, an analysis method for CRISPR screens' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Ilya Ioshikhes</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Jian Ma</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #2: Fiaux et al. have addressed my concerns regarding this manuscript. I appreciate that they took the time to assess the existing simulation framework. The validation of novel functional sequences identified by RELICS adds a lot of value to this manuscript. I believe that this tool will be useful to the community for analysis of non-coding CRISPR screens.</p>
    <p>Reviewer #3: The authors are commended for their sincere efforts to address reviewer comments. The revised manuscript is considerably improved and should be of interest to the pertinent readership in this growing field of study.</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Computational Biology</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #2: No</p>
    <p>Reviewer #3: No</p>
  </body>
</sub-article>
<sub-article id="pcbi.1008194.r004" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008194.r004</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ioshikhes</surname>
          <given-names>Ilya</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Jian</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Ioshikhes, Ma</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Ioshikhes, Ma</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj004" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008194" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">10 Sep 2020</named-content>
    </p>
    <p>PCOMPBIOL-D-20-00463R1 </p>
    <p>Discovering functional sequences with RELICS, an analysis method for CRISPR screens</p>
    <p>Dear Dr McVicker,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Laura Mallard</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link ext-link-type="uri" xlink:href="http://ploscompbiol.org">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
