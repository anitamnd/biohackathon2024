<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName archivearticle.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Immunol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Immunol</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Immunol.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Immunology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1664-3224</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5095119</article-id>
    <article-id pub-id-type="doi">10.3389/fimmu.2016.00457</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Immunology</subject>
        <subj-group>
          <subject>Methods</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>IMPre: An Accurate and Efficient Software for Prediction of T- and B-Cell Receptor Germline Genes and Alleles from Rearranged Repertoire Data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Wei</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://frontiersin.org/people/u/344989"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>I-Ming</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://frontiersin.org/people/u/300183"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Changxi</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lin</surname>
          <given-names>Liya</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chai</surname>
          <given-names>Xianghua</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://frontiersin.org/people/u/376125"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wu</surname>
          <given-names>Jinghua</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://frontiersin.org/people/u/362770"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bett</surname>
          <given-names>Andrew J.</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dhanasekaran</surname>
          <given-names>Govindarajan</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Casimiro</surname>
          <given-names>Danilo R.</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Xiao</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">*</xref>
        <uri xlink:type="simple" xlink:href="http://frontiersin.org/people/u/360272"/>
      </contrib>
    </contrib-group>
    <aff id="aff1"><sup>1</sup><institution>Beijing Genomics Institute (BGI-Shenzhen)</institution>, <addr-line>Shenzhen</addr-line>, <country>China</country></aff>
    <aff id="aff2"><sup>2</sup><institution>Merck Research Laboratories</institution>, <addr-line>West Point, PA</addr-line>, <country>USA</country></aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p>Edited by: Nichol E. Holodick, The Feinstein Institute for Medical Research, USA</p>
      </fn>
      <fn fn-type="edited-by">
        <p>Reviewed by: Hedda Wardemann, German Cancer Research Center (HZ), Germany; Christof Von Kalle, Nationales Centrum für Tumorerkrankungen, Germany; Christian Busse contributed to the review of Hedda Wardemann</p>
      </fn>
      <corresp content-type="corresp" id="cor1">*Correspondence: Xiao Liu, <email>liuxiao@genomics.cn</email></corresp>
      <fn fn-type="other" id="fn001">
        <p>Specialty section: This article was submitted to B Cell Biology, a section of the journal Frontiers in Immunology</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>04</day>
      <month>11</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2016</year>
    </pub-date>
    <volume>7</volume>
    <elocation-id>457</elocation-id>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>4</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>10</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2016 Zhang, Wang, Wang, Lin, Chai, Wu, Bett, Dhanasekaran, Casimiro and Liu.</copyright-statement>
      <copyright-year>2016</copyright-year>
      <copyright-holder>Zhang, Wang, Wang, Lin, Chai, Wu, Bett, Dhanasekaran, Casimiro and Liu</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) or licensor are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Large-scale study of the properties of T-cell receptor (TCR) and B-cell receptor (BCR) repertoires through next-generation sequencing is providing excellent insights into the understanding of adaptive immune responses. Variable(Diversity)Joining [V(D)J] germline genes and alleles must be characterized in detail to facilitate repertoire analyses. However, most species do not have well-characterized TCR/BCR germline genes because of their high homology. Also, more germline alleles are required for humans and other species, which limits the capacity for studying immune repertoires. Herein, we developed “Immune Germline Prediction” (IMPre), a tool for predicting germline V/J genes and alleles using deep-sequencing data derived from TCR/BCR repertoires. We developed a new algorithm, “Seed_Clust,” for clustering, produced a multiway tree for assembly and optimized the sequence according to the characteristics of rearrangement. We trained IMPre on human samples of T-cell receptor beta (TRB) and immunoglobulin heavy chain and then tested it on additional human samples. Accuracy of 97.7, 100, 92.9, and 100% was obtained for TRBV, TRBJ, IGHV, and IGHJ, respectively. Analyses of subsampling performance for these samples showed IMPre to be robust using different data quantities. Subsequently, IMPre was tested on samples from rhesus monkeys and human long sequences: the highly accurate results demonstrated IMPre to be stable with animal and multiple data types. With rapid accumulation of high-throughput sequence data for TCR and BCR repertoires, IMPre can be applied broadly for obtaining novel genes and a large number of novel alleles. IMPre is available at <uri xlink:type="simple" xlink:href="https://github.com/zhangwei2015/IMPre">https://github.com/zhangwei2015/IMPre</uri>.</p>
    </abstract>
    <kwd-group>
      <kwd>immune repertoire</kwd>
      <kwd>novel germline gene</kwd>
      <kwd>novel germline allele</kwd>
      <kwd>TCR</kwd>
      <kwd>BCR</kwd>
    </kwd-group>
    <counts>
      <fig-count count="8"/>
      <table-count count="1"/>
      <equation-count count="10"/>
      <ref-count count="20"/>
      <page-count count="14"/>
      <word-count count="8841"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="introduction" id="S1">
    <title>Introduction</title>
    <p>The “immune repertoire” is defined as the collection of diverse T-cell receptors (TCRs) and B-cell receptors (BCRs) created by somatic recombination of many germline V (variable), D (diversity), J (joining), and C (constant) gene segments. The immune repertoire (hereafter termed “repertoire”) comprises the adaptive wing of the immune system. In recent years, advances in next-generation sequencing technology have enabled assessment of millions of B- or TCRs from a single sequencing assay. This strategy allows researchers to study the repertoire in a more comprehensive way. Sequencing of the repertoire (Rep-seq) is being applied in several research areas: (i) monitoring of residual disease and immune reconstitution in cancers; (ii) understanding the diversity of T- and B-cell repertoires generated upon vaccination or infection; (iii) investigation of the mechanisms of immune surveillance in specific diseases (especially in infectious and autoimmune diseases); and (iv) production of monoclonal antibodies targeting specific antigens (<xref rid="B1" ref-type="bibr">1</xref>–<xref rid="B5" ref-type="bibr">5</xref>).</p>
    <p>Well-characterized TCR/BCR germline genes are critical for analyses and interpretation of Rep-seq data. The publically available ImMunoGeneTics (IMGT) database<xref ref-type="fn" rid="fn1"><sup>1</sup></xref> collects the genes of certain species. However, such information is not available for most species, which makes studying of repertoires highly challenging (if not unattainable). Deciphering of TCR and BCR germline loci requires additional resource-intensive efforts beyond conventional sequencing of the whole genome because these loci comprise multiple highly homologous and polymorphic gene family members. For instance, according to the IMGT database, the human immunoglobulin heavy-chain (IGH) locus, located at chromosome 14 (<xref rid="B6" ref-type="bibr">6</xref>), is composed of 123–129 V genes, 27 D segments, 9 J segments, and 9 C genes. The other two immunoglobulin light chain and four TCR loci are organized in a similar way, so exact identification of the many homologous gene sequences is difficult. In addition, like gene loci from human leukocyte antigens, germline genes also exhibit high polymorphism of alleles. There are &gt;470 IGH V alleles in the IMGT database, but recently reported novel alleles (<xref rid="B7" ref-type="bibr">7</xref>, <xref rid="B8" ref-type="bibr">8</xref>) from a few individuals suggest that numerous V alleles are absent. Many alleles for humans and other species have not been found. Absence of alleles may influence analyses of repertoires greatly. If the segment allele is assigned in error, the somatic hypermutation (SHM) cannot be identified exactly and may result in misleading clinically relevant decision-making processes (<xref rid="B9" ref-type="bibr">9</xref>). Well-characterized TCR/BCR germline alleles (polymorphisms) are critical for Rep-seq analyses.</p>
    <p>Investigation of BCR/TCR germline genes and alleles is problematic, a validated method is lacking, and few studies in this area have been published. The conventional method employs a polymerase chain reaction (PCR)-based cloning strategy. That is, primers are designed based on human germline genes and are used to extract the species’ counterparts through PCR amplification using genomic DNA (<xref rid="B10" ref-type="bibr">10</xref>–<xref rid="B12" ref-type="bibr">12</xref>). This is the most direct approach for obtaining sequences with high accuracy but is suitable only for species that are significantly homologous with humans. With this approach, iterative PCR optimization might be needed, which requires designing of primers on multiple occasions. Greenaway and colleagues showed germline genes to be inferred from the genomes of assembled species (<xref rid="B13" ref-type="bibr">13</xref>). However, precise and accurate assembly of genes from the V/J region is difficult due to their high homology; the inferred germline genes extracted from the genome could, therefore, contain errors. In addition, Gadala-Maria and coworkers discovered 11 unreported alleles (polymorphisms) from Rep-seq data on human IGH (<xref rid="B8" ref-type="bibr">8</xref>). However, that research focused on human IGH alleles with five or fewer mutations, required known germline sequences, and could not be used to predict novel genes. To resolve these issues, a tool for inferring novel germline genes/alleles without a genome and known germline genes/alleles is needed.</p>
    <p>We designed primers at the conservative C region to capture the TCR/BCR rearranged repertoires using high-throughput sequencing. We developed a <italic>de novo</italic> tool, Immune Germline Prediction (IMPre), to infer novel TCR/BCR germline genes and alleles using Rep-seq data without known germline sequences or assembled genome data. Without knowing V/J gene segments, primers designed at the C region are available for all species, which is a perfect perspective to infer the highly homologous germline genes/alleles, and IMPre is the first tool to do this. IMPre is implemented using C and Perl programs and comprises four main steps: data processing, clustering, assembly, and optimization. As part of this effort, we developed a clustering algorithm, Seed_Clust, based on the same seed k-mer (i.e., all the possible substrings of length k contained in a string) to classify sequences. Subsequently, a multiway tree structure was used in the assembly step to extend seeds in both directions. T-cell receptor beta (TRB) and IGH samples from humans were sequenced to train IMPre, and additional human samples were used for testing. Accuracies were 97.7, 100, 92.9, and 100% for TRBV, TRBJ, IGHV, and IGHJ, respectively. Subsampling performance was estimated, and results showed IMPre to be robust even with different data quantities, and that 1 million sequences were sufficient for germline prediction. IMPre performs with good efficiency and speed while using less memory. TRB samples from rhesus monkeys and additional long-sequence human samples were used to retest IMPre. The highly accurate results obtained suggest that IMPre is stable with animal and long-sequence data.</p>
  </sec>
  <sec sec-type="materials|methods" id="S2">
    <title>Materials and Methods</title>
    <sec id="S2-1">
      <title>Design and Overview of the IMPre System</title>
      <p>Two main recombination characteristics support the notion that rearranged repertoire data can be used to infer germline genes. First, the probability of V(D)J insertion/deletion at a gene terminus in an individual tends to decrease with increasing length of the deletion (<xref rid="B14" ref-type="bibr">14</xref>, <xref rid="B15" ref-type="bibr">15</xref>). We analyzed our data (Table S1 in Supplementary Material) on the distribution of length of the V/J deletion (Figures S1A,B in Supplementary Material). We found that a length of the V deletion &gt;50% for TRB and 70% for IGH were within 1 bp, whereas the length of the J deletion was much more diverse; however, the value tended to decrease if the deletion length increased. Then, we downloaded the rearranged sequences from the IMGT database and observed the same trend from 3907 fully annotated sequences (Figure S1C in Supplementary Material). Second, researchers have reported that immunoglobulin (Ig) genes introduce SHMs at 10<sup>–3</sup> per bp per cell division (<xref rid="B16" ref-type="bibr">16</xref>, <xref rid="B17" ref-type="bibr">17</xref>). SHMs are, in general, random with a low frequency (≤5%), except for known G/C “hotspots” (≤10%) among large-scale repertoire data (<xref rid="B7" ref-type="bibr">7</xref>). Germline genes can be predicted after elimination of SHM effects. These phenomena provide a strong theoretical basis for accurate identification of germline genes and alleles.</p>
      <p>The IMPre pipeline mimics the reverse process of VDJ rearrangement in TCRs and BCRs (Figure <xref ref-type="fig" rid="F1">1</xref>A) and comprises four steps: data processing, clustering, assembly, and optimization (Figure <xref ref-type="fig" rid="F1">1</xref>B). During data processing, rearranged repertoire sequences are converted into forward sequences and partitioned into V and J parts. During clustering, the Seed_Clust algorithm is based on seed k-mers and used for sequence clustering that prioritizes large clusters with the same seed k-mers. A pseudocode that describes this step in detail is shown in Figure <xref ref-type="fig" rid="F1">1</xref>C. Each sequence is assigned to one cluster. During assembly, for each cluster, a multiway tree structure is constructed to store the seed and upstream/downstream nucleotides. It begins at the seed and is extended using a one-nucleotide extension strategy for <italic>de novo</italic> assembly. The <italic>Ar</italic> and <italic>Ur</italic> (detailed definitions are shown below) are used to ascertain if a nucleotide should be added or not added (Figure <xref ref-type="fig" rid="F1">1</xref>D). During optimization, three steps are used. The <italic>Trim5 Ratio</italic>, <italic>Trim5 Rate</italic>, and <italic>More5 Rate</italic> (definitions are shown below) are calculated to filter out false-positive (FP) readings. Sequences with the same overlapping region are merged to eliminate redundancy. Similar low-frequency sequences are removed to filter out sequences with SHM and PCR/sequencing errors. Finally, inferred sequences are annotated by known germline sequences.</p>
      <fig id="F1" position="float">
        <label>Figure 1</label>
        <caption>
          <p><bold>Overview of IMPre workflow</bold>. <bold>(A)</bold> Rearrangement. <bold>(B)</bold> IMPre flowchart shows four steps and uses rearranged sequences as the input. Sequences are divided into V and J parts during the data-processing step. The Seed_Clust algorithm is used to cluster sequences for each part. For each cluster, sequences are used for assembly and further optimization. <bold>(C)</bold> Clustering. The pseudocode outlines the Seed_Clust clustering algorithm. <bold>(D)</bold> Assembly. A multiway tree structure stores nucleotides and assembles using a one-nucleotide extension strategy. The V gene begins to extend from the right subtree and then from the left subtree. Two parameters, <italic>Ar</italic> and <italic>Ur</italic>, determine whether a nucleotide should be added or not.</p>
        </caption>
        <graphic xlink:href="fimmu-07-00457-g001"/>
      </fig>
      <sec id="S2-1-1">
        <title>Data Processing</title>
        <p>Immune Germline Prediction can process the rearranged sequences with or without the C region. If the C region is embodied, it is identified using previously reported publically available C sequences with a limit of two mismatches for the first 18 bp. The identified C region is used to convert all the sequences to forward sequences and then is trimmed for further analyses. To predict V and J genes independently, rearranged sequences are partitioned into two parts. IMPre extracts the last 60 bp (parameter: −<italic>jm</italic>) from the 3’ end of sequences to define the “J part.” Sequences that are trimmed in the last 40 bp (parameter: −<italic>vm</italic>) of the 3’ end are defined as the “V part.” Parameters can be adjusted, but they must cover the entire potential V and J regions. To avoid missing regions, the V portion of the sequence is tolerated to contain a D gene (for IGH and TRB) and a partial J gene. Also, the J portion may contain a D gene (for IGH and TRB) and a partial V gene (Figure <xref ref-type="fig" rid="F1">1</xref>B).</p>
      </sec>
      <sec id="S2-1-2">
        <title>Clustering</title>
        <p>Immune Germline Prediction clusters V and J sequences separately (Figure <xref ref-type="fig" rid="F1">1</xref>B), and both use the same clustering strategy detailed in Figure <xref ref-type="fig" rid="F1">1</xref>C. Heyer et al. reported a quality cluster algorithm (QT_Clust) for expression data (<xref rid="B18" ref-type="bibr">18</xref>). Similarly, to discover large clusters, we developed a clustering algorithm for V and J sequences. The algorithm prioritizes the largest cluster that included the same seed k-mer, defined as Seed_Clust.</p>
        <p>Seed_Clust operates in five main steps (Figure <xref ref-type="fig" rid="F1">1</xref>C). In step (1), length-provided subsequences (k-mer) are created as seeds (<italic>S</italic>) from all sequences. In step (2), a matrix <bold><italic>M</italic></bold><italic><sup>m</sup></italic><sup> ×</sup> <italic><sup>n</sup></italic> is constructed using the seed k-mer, where <italic>m</italic> is the number of seeds and <italic>n</italic> is the number of unique sequences. If the seed <bold><italic>S</italic></bold><italic><sub>j</sub></italic> is included in the sequence <bold><italic>N</italic></bold><italic><sub>i</sub></italic>, then <bold><italic>M</italic></bold><italic><sub>j,i</sub></italic><sub> = 1</sub>; otherwise, <bold><italic>M</italic></bold><italic><sub>j,i</sub></italic><sub> = 0.2</sub>. The score <bold><italic>T</italic></bold><italic><sub>j</sub></italic> (defined in Figure <xref ref-type="fig" rid="F1">1</xref>C) is calculated for each seed <bold><italic>S</italic></bold><italic><sub>j</sub></italic>. In step (3), the maximum score <bold><italic>T</italic></bold><italic><sub>j</sub></italic> is selected, and the sequences that embody the seed <bold><italic>S</italic></bold><italic><sub>j</sub></italic> are regarded as one cluster and are outputted. In step (4), the output sequences are removed from the matrix <bold><italic>M</italic></bold><italic><sup>m</sup></italic><sup> ×</sup> <italic><sup>n</sup></italic>. In step (5), steps (1)–(4) are repeated under iteration until all sequences belong to one cluster.</p>
        <p>The seed k-mer is dependent upon sequence length and other characteristics. However, the last 10 bp of the 3’ end at the “V part” sequence are excluded for seed creation because this region might not truly belong to the V gene; similarly, the first 5 bp at the 5’ end of the J portion are not considered.</p>
      </sec>
      <sec id="S2-1-3">
        <title>Assembly</title>
        <p>Each cluster is assembled independently (Figure <xref ref-type="fig" rid="F1">1</xref>B). We developed an assembly strategy based on seeds and one-nucleotide-by-one-nucleotide extension (Figure <xref ref-type="fig" rid="F1">1</xref>D). In this step, a multiway tree is generated to store data and to aid assembly. First, the seed of each sequence is set as the center position <italic>k</italic>, and the upstream nucleotides are set at positions <italic>k</italic> − 1, <italic>k</italic> − 2, …, in order, whereas the downstream nucleotides are set at positions <italic>k</italic> + 1, <italic>k</italic> + 2, …, in order. Each position may consist of four nucleotides, except position <italic>k</italic>, and the number of supporting sequences for each nucleotide is calculated.</p>
        <p>The assembly begins from the seed and extends in the direction of the right subtree [usually in the direction toward CDR3 (complementarity-determining regions) sequences]. After the right subtree is complete, it extends further in the direction toward the left subtree. Criteria and rules are identical for left and right subtrees (Figure <xref ref-type="fig" rid="F1">1</xref>D). For each time, one nucleotide (“note”) is considered to be added for extension, and then all “brother-notes” are considered successively. After finishing all brother-notes, the algorithm extends to all “child-notes.” For example, three nucleotides (“A,” “C,” and “G”) at position <italic>k</italic> + 1 are considered for addition to the seed, and three extended sequences are created if the nucleotides meet requirements. Then, three nucleotides (“C,” “G,” and “T”) at position <italic>k</italic> + 2 are considered for addition to the extended sequences separately. Nucleotides at the remaining positions comply with the same rule iteratively. Finally, multiple qualified extended sequences can be retained.</p>
        <p>For each time, to ascertain if the nucleotide (note) should or should not be added for extension, we defined two parameters, <italic>Ar</italic> and <italic>Ur</italic>:
<disp-formula id="E1"><mml:math id="M1"><mml:mrow><mml:mtext>Ar</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>i</mml:mtext><mml:mo>,</mml:mo><mml:mtext>j</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo class="MathClass-rel">=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>Number of supporting reads for an extended sequence</mml:mtext></mml:mrow><mml:mrow><mml:mtext>Number of total reads at position </mml:mtext><mml:mi>i</mml:mi></mml:mrow></mml:mfrac></mml:math></disp-formula>
<disp-formula id="E2"><mml:math id="M2"><mml:mtable class="align-star"><mml:mtr><mml:mtd columnalign="center" class="align-odd"><mml:mrow><mml:mtext>Ur</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>i</mml:mtext><mml:mo>,</mml:mo><mml:mtext>j</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo class="MathClass-rel">=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>Number of unique supporting reads for an extended sequence</mml:mtext></mml:mrow><mml:mrow><mml:mtext>Total number of unique reads at position </mml:mtext><mml:mi>i</mml:mi></mml:mrow></mml:mfrac><mml:mo class="MathClass-punc">,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left" class="align-label"><mml:mspace width="9em" class="thinspace"/><mml:mi>i</mml:mi><mml:mo class="MathClass-rel">∈</mml:mo><mml:mfenced separators="" open="{" close="}"><mml:mrow><mml:mo class="MathClass-punc">..,</mml:mo><mml:mi>k</mml:mi><mml:mo class="MathClass-bin">−</mml:mo><mml:mn>2</mml:mn><mml:mo class="MathClass-punc">,</mml:mo><mml:mi>k</mml:mi><mml:mo class="MathClass-bin">−</mml:mo><mml:mn>1</mml:mn><mml:mo class="MathClass-punc">,</mml:mo><mml:mi>k</mml:mi><mml:mo class="MathClass-punc">,</mml:mo><mml:mi>k</mml:mi><mml:mo class="MathClass-bin">+</mml:mo><mml:mn>1</mml:mn><mml:mo class="MathClass-punc">,</mml:mo><mml:mi>k</mml:mi><mml:mo class="MathClass-bin">+</mml:mo><mml:mn>2</mml:mn><mml:mo class="MathClass-punc">,</mml:mo><mml:mo class="MathClass-op">…</mml:mo></mml:mrow></mml:mfenced><mml:mo class="MathClass-punc">,</mml:mo><mml:mi>j</mml:mi><mml:mo class="MathClass-rel">∈</mml:mo><mml:mfenced separators="" open="{" close="}"><mml:mrow><mml:mi>A</mml:mi><mml:mo class="MathClass-punc">,</mml:mo><mml:mi>C</mml:mi><mml:mo class="MathClass-punc">,</mml:mo><mml:mi>T</mml:mi><mml:mo class="MathClass-punc">,</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
        <p>Here, an “extended sequence” is defined as the sequence after one nucleotide <italic>j</italic> is added in position <italic>i</italic>. We provide an example to illustrate these two parameters (Figure <xref ref-type="fig" rid="F2">2</xref>A). Here, there are 10 reads in the cluster. When it extends to position <italic>i</italic>, three reads contain the nucleotide “A” in a total of seven reads, so <italic>Ar(i,A)</italic> is equal to 42.9%. Likewise, two unique reads contain the “A” in the total of six unique reads, so <italic>Ur(i,A)</italic> is equal to 33.3%. The two values can be calculated for other nucleotides in the same way. Defaults for the two parameters are V: <italic>Ar</italic> &gt; 0.15, <italic>Ur</italic> &gt; 0.12; J: <italic>Ar</italic> &gt; 0.12, and <italic>Ur</italic> &gt; 0.10. Actually, most SHMs can be filtered in this step.</p>
        <fig id="F2" position="float">
          <label>Figure 2</label>
          <caption>
            <p><bold>Parameters in assembly and optimization steps (schematic)</bold>. <bold>(A)</bold> An example for <italic>Ar</italic> and <italic>Ur</italic> calculation in the assembly step. There are 10 reads in a cluster. Each time, we determine whether the nucleotides in position <italic>i</italic> should be added for extension or terminated using the values of <italic>Ar</italic> and <italic>Ur</italic>. <bold>(B)</bold> Four types of inferred sequences obtained from the assembly step. For the reads, orange denotes the V region, red is inserted nucleotides, green is the D region, blue is the J region, and gray is the reads from non-specific amplification. <italic>S<sub>trim</sub></italic><sub>5</sub> are 5 bp shorter than <italic>S</italic>, and <italic>S<sub>more</sub></italic><sub>5</sub> is a 5 bp fragment.</p>
          </caption>
          <graphic xlink:href="fimmu-07-00457-g002"/>
        </fig>
      </sec>
      <sec id="S2-1-4">
        <title>Optimization</title>
        <p>Numerous potential germline sequences are obtained from the assembly step, but they must be optimized further to eliminate incorrect sequences. The assembly step yields four types of sequences (Figure <xref ref-type="fig" rid="F2">2</xref>B), among which three are not accurate or precise, and are defined as FPs. Among them, one is derived from a non-specific PCR amplification and the other two types exhibit missing portions of the germline sequence (too short) or contain extra V–D/D–J additions (too long).</p>
        <p>Three steps are used to filter incorrect sequences (Figure <xref ref-type="fig" rid="F3">3</xref>A). First, FP sequences are filtered. Genuine rearranged V/J gene segments feature diverse V/J deletion/insertion lengths and recombine with multiple adjacent D genes. Therefore, the diversity of the 5 bp-trimmed or extended sequences is significantly higher for the correct type of sequence (Figure <xref ref-type="fig" rid="F2">2</xref>B). Three factors (<italic>Trim5 Ratio</italic>, <italic>Trim5 Rate</italic>, and <italic>More5 Rate</italic>) derived from these characteristics are introduced to filter out the incorrect sequences, and the definitions are listed as shown below: (The <italic>Trim5 Ratio</italic> includes <italic>Trim5 Ratio1</italic> and <italic>Trim5 Ratio2</italic>, whereas the <italic>Trim5 Rate</italic> includes <italic>Trim5 Rate1</italic> and <italic>Trim5 Rate2</italic>.)
<disp-formula id="E3"><mml:math id="M3"><mml:mtext>Trim</mml:mtext><mml:mn>5</mml:mn><mml:mtext> Ratio</mml:mtext><mml:mn>1</mml:mn><mml:mo class="MathClass-rel">=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>Number of supporting reads for </mml:mtext><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mtext>trim</mml:mtext><mml:mn>5</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mtext>Number of supporting reads for </mml:mtext><mml:mi>S</mml:mi></mml:mrow></mml:mfrac><mml:mo class="MathClass-bin">×</mml:mo><mml:mn>100</mml:mn></mml:math></disp-formula>
<disp-formula id="E4"><mml:math id="M4"><mml:mtext>Trim</mml:mtext><mml:mn>5</mml:mn><mml:mtext> Ratio</mml:mtext><mml:mn>2</mml:mn><mml:mo class="MathClass-rel">=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>Number of unique supporting reads for </mml:mtext><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mtext>trim5</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mtext>Number of unique supporting reads for </mml:mtext><mml:mi>S</mml:mi></mml:mrow></mml:mfrac><mml:mo class="MathClass-bin">×</mml:mo><mml:mn>100</mml:mn></mml:math></disp-formula>
<disp-formula id="E5"><mml:math id="M5"><mml:mtext>Trim</mml:mtext><mml:mn>5</mml:mn><mml:mtext> Rate</mml:mtext><mml:mn>1</mml:mn><mml:mo class="MathClass-rel">=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>Number of supporting reads for </mml:mtext><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mtext>trim</mml:mtext><mml:mn>5</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mo class="MathClass-op">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mfenced separators="" open="{" close="}"><mml:mrow><mml:mtext>Number of supporting reads for </mml:mtext><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mtext>trim</mml:mtext><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mfrac><mml:mo class="MathClass-bin">×</mml:mo><mml:mn>100</mml:mn></mml:math></disp-formula>
<disp-formula id="E6"><mml:math id="M6"><mml:mtext>Trim</mml:mtext><mml:mn>5</mml:mn><mml:mtext> Rate</mml:mtext><mml:mn>2</mml:mn><mml:mo class="MathClass-rel">=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>Number of unique supporting reads for </mml:mtext><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mtext>trim</mml:mtext><mml:mn>5</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mo class="MathClass-op">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mfenced separators="" open="{" close="}"><mml:mrow><mml:mtext>Number of unique supporting reads for </mml:mtext><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mtext>trim</mml:mtext><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mfrac><mml:mo class="MathClass-bin">×</mml:mo><mml:mn>100</mml:mn></mml:math></disp-formula>
<disp-formula id="E7"><mml:math id="M7"><mml:mtext>More</mml:mtext><mml:mn>5</mml:mn><mml:mtext> Rate</mml:mtext><mml:mo class="MathClass-rel">=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>Number of unique supporting reads for </mml:mtext><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mtext>more</mml:mtext><mml:mn>5</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mo class="MathClass-op">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mfenced separators="" open="{" close="}"><mml:mrow><mml:mtext>Number of unique supporting reads for </mml:mtext><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mtext>more</mml:mtext><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mfrac><mml:mo class="MathClass-bin">×</mml:mo><mml:mn>100</mml:mn></mml:math></disp-formula>
where <italic>n</italic> is total number of inferred sequences, <italic>S</italic> is the inferred sequence from the assembly step, <italic>S</italic><sub>trim5</sub> is the 5 bp-trimmed <italic>S</italic> at the end (the V gene is trimmed at the 3′ end and the J gene is trimmed at the 5′ end), <italic>S</italic><sub>more5</sub> is a 5-mer subsequence which is extended from S (extended from the 3′ end of S for V and the 5′ end of S for the J gene). <italic>S</italic>, <italic>S</italic><sub>trim5</sub>, and <italic>S</italic><sub>more5</sub> are illustrated in Figure <xref ref-type="fig" rid="F2">2</xref>B. For example, taking <italic>Trim</italic>5 <italic>Ratio</italic>1 in Figure <xref ref-type="fig" rid="F2">2</xref>B, the value of <italic>Trim</italic>5 <italic>Ratio</italic>1 for the “Right” type sequence is 2, whereas the values for other three types of sequences are equal to 1.</p>
        <fig id="F3" position="float">
          <label>Figure 3</label>
          <caption>
            <p><bold>Detailed optimization strategy and output format</bold>. <bold>(A)</bold> Pipeline for the optimization step. <bold>(B)</bold> Details for elimination of SHM and PCR/sequencing errors. <bold>(C)</bold> Output format of IMPre. IMPre outputs two files: one is the annotation file and the other is the inferred sequence.</p>
          </caption>
          <graphic xlink:href="fimmu-07-00457-g003"/>
        </fig>
        <p>Defaults of three factors are set as: <italic>Trim5 Ratio</italic> &gt;1.5, <italic>Trim5 Rate</italic> &gt;2 (<italic>for TRB-J</italic> &gt;0.5), and <italic>More5 Rate</italic> &gt;5.</p>
        <p>Second, to eliminate redundancy in inferred germline sequences, sequences are merged if they have identical overlapping regions (two mismatches are allowed for the V gene at the 3′ end and two mismatches are allowed for the J gene at the 5′ end).</p>
        <p>Third, elimination of SHM and PCR/sequencing errors is attempted (Figure <xref ref-type="fig" rid="F3">3</xref>B). The predicted germline sequences are clustered into multiple groups using the QT_Clust algorithm (<xref rid="B18" ref-type="bibr">18</xref>). Sequences with the most reads are defined as the “center sequence,” and other sequences with more than three mismatches (two mismatches for the J gene) are clustered into the same group with the center sequences (the last 3 bp at the 3′ end for the V gene, and the first 3 bp at the 5′ end for the J gene are masked). According to analyses of human germline sequences from the IMGT database (Figure S2 in Supplementary Material), we assumed that the sequences within one group arose from the same germline genes. Theoretically, observation of more than two alleles for each gene in one sample is not possible, so some sequences must be filtered if there are more than two sequences in one cluster. Thus, Ratio(<italic>S</italic>) for each sequence <italic>S</italic> is introduced as
<disp-formula id="E8"><mml:math id="M8"><mml:mtext>Ratio</mml:mtext><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow><mml:mo class="MathClass-rel">=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>number of supporting reads for the center sequence</mml:mtext></mml:mrow><mml:mrow><mml:mtext>number of supporting reads of </mml:mtext><mml:mi>S</mml:mi></mml:mrow></mml:mfrac><mml:mo class="MathClass-punc">.</mml:mo></mml:math></disp-formula></p>
        <p>The predicted sequence <italic>S</italic> is filtered out if the Ratio(<italic>S</italic>) &gt;10 because Boyd and colleagues reported that almost all ratios of the two alleles in an individual were &lt;10 (<xref rid="B7" ref-type="bibr">7</xref>). Furthermore, at most, two sequences in a cluster are retained [retention of the center sequence and another sequence with the lowest Ratio(<italic>S</italic>)].</p>
        <p>Another effective way to eliminate SHMs is using multiple individuals to infer germline genes/alleles (Figure <xref ref-type="fig" rid="F3">3</xref>B). If the inferred sequence is observed in multiple individuals, it is likely to be the “true” germline sequence. SHMs would occur at random, and the chances of multiple individuals using identical alleles with the same SHMs are rare.</p>
      </sec>
      <sec id="S2-1-5">
        <title>Annotation and Output</title>
        <p>To measure the certainty of an inferred germline sequence, we provide a score for each inferred germline sequence according to seven important factors with different weight <italic>W</italic> (the total weight is 100 and the range of scores is between 0 and 100, Figure <xref ref-type="fig" rid="F3">3</xref>C). The score for each sequence <italic>S</italic> is defined as
<disp-formula id="E9"><mml:math id="M9"><mml:mtable columnalign="left" class="align"><mml:mtr><mml:mtd columnalign="left" class="align-odd"><mml:mtext>Score</mml:mtext><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow><mml:mo class="MathClass-rel">=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>Trim</mml:mtext><mml:mn>5</mml:mn><mml:mtext> Ratio</mml:mtext><mml:mn>1</mml:mn><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext><mml:mfenced separators="" open="{" close="}"><mml:mrow><mml:mtext>Trim</mml:mtext><mml:mn>5</mml:mn><mml:mtext> Ratio</mml:mtext><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo class="MathClass-bin">×</mml:mo><mml:msub><mml:mrow><mml:mtext>W</mml:mtext></mml:mrow><mml:mrow><mml:mtext>Trim</mml:mtext><mml:mn>5</mml:mn><mml:mtext> ratio</mml:mtext><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo class="MathClass-bin">+</mml:mo><mml:mfrac><mml:mrow><mml:mtext>Trim</mml:mtext><mml:mn>5</mml:mn><mml:mtext> Ratio</mml:mtext><mml:mn>2</mml:mn><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext><mml:mfenced separators="" open="{" close="}"><mml:mrow><mml:mtext>Trim</mml:mtext><mml:mn>5</mml:mn><mml:mtext> Ratio</mml:mtext><mml:mn>2</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo class="MathClass-bin">×</mml:mo><mml:msub><mml:mrow><mml:mtext>W</mml:mtext></mml:mrow><mml:mrow><mml:mtext>Trim</mml:mtext><mml:mn>5</mml:mn><mml:mtext> ratio</mml:mtext><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left" class="align-odd"><mml:mspace width="5.5em" class="thinspace"/><mml:mo class="MathClass-bin">+</mml:mo><mml:mfrac><mml:mrow><mml:mtext>More</mml:mtext><mml:mn>5</mml:mn><mml:mtext> Rate</mml:mtext><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext><mml:mfenced separators="" open="{" close="}"><mml:mrow><mml:mtext>More</mml:mtext><mml:mn>5</mml:mn><mml:mtext> Rate</mml:mtext></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo class="MathClass-bin">×</mml:mo><mml:msub><mml:mrow><mml:mtext>W</mml:mtext></mml:mrow><mml:mrow><mml:mtext>More</mml:mtext><mml:mn>5</mml:mn><mml:mtext> rate</mml:mtext></mml:mrow></mml:msub><mml:mo class="MathClass-bin">+</mml:mo><mml:mfrac><mml:mrow><mml:mtext>Trim</mml:mtext><mml:mn>5</mml:mn><mml:mtext> Rate</mml:mtext><mml:mn>1</mml:mn><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext><mml:mfenced separators="" open="{" close="}"><mml:mrow><mml:mtext>Trim</mml:mtext><mml:mn>5</mml:mn><mml:mtext> Rate</mml:mtext><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo class="MathClass-bin">×</mml:mo><mml:msub><mml:mrow><mml:mtext>W</mml:mtext></mml:mrow><mml:mrow><mml:mtext>Trim</mml:mtext><mml:mn>5</mml:mn><mml:mtext> rate</mml:mtext><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left" class="align-odd"><mml:mspace width="5.5em" class="thinspace"/><mml:mo class="MathClass-bin">+</mml:mo><mml:mfrac><mml:mrow><mml:mtext>Trim</mml:mtext><mml:mn>5</mml:mn><mml:mtext> Rate</mml:mtext><mml:mn>2</mml:mn><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext><mml:mfenced separators="" open="{" close="}"><mml:mrow><mml:mtext>Trim</mml:mtext><mml:mn>5</mml:mn><mml:mtext> Rate</mml:mtext><mml:mn>2</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo class="MathClass-bin">×</mml:mo><mml:msub><mml:mrow><mml:mtext>W</mml:mtext></mml:mrow><mml:mrow><mml:mtext>Trim</mml:mtext><mml:mn>5</mml:mn><mml:mtext> rate</mml:mtext><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo class="MathClass-bin">+</mml:mo><mml:mfrac><mml:mrow><mml:mo>#</mml:mo><mml:mtext>merged sequences</mml:mtext></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext><mml:mfenced separators="" open="{" close="}"><mml:mrow><mml:mo>#</mml:mo><mml:mtext>merged sequences</mml:mtext></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo class="MathClass-bin">×</mml:mo><mml:msub><mml:mrow><mml:mtext>W</mml:mtext></mml:mrow><mml:mrow><mml:mtext>merged num</mml:mtext></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left" class="align-odd"><mml:mspace width="5.5em" class="thinspace"/><mml:mo class="MathClass-bin">+</mml:mo><mml:mrow><mml:mo class="MathClass-open">{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mtext>W</mml:mtext></mml:mrow><mml:mrow><mml:mtext>major</mml:mtext></mml:mrow></mml:msub><mml:mo class="MathClass-rel">|</mml:mo><mml:msub><mml:mrow><mml:mtext>W</mml:mtext></mml:mrow><mml:mrow><mml:mtext>minor</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo class="MathClass-close">}</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
<disp-formula id="E10"><mml:math id="M10"><mml:mtable columnalign="left" class="align-star"><mml:mtr><mml:mtd columnalign="left" class="align-odd"><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mtext>W</mml:mtext></mml:mrow><mml:mrow><mml:mtext>Trim5 ratio1</mml:mtext></mml:mrow></mml:msub><mml:mo class="MathClass-punc">,</mml:mo><mml:msub><mml:mrow><mml:mtext>W</mml:mtext></mml:mrow><mml:mrow><mml:mtext>Trim5 ratio2</mml:mtext></mml:mrow></mml:msub><mml:mo class="MathClass-punc">,</mml:mo><mml:msub><mml:mrow><mml:mtext>W</mml:mtext></mml:mrow><mml:mrow><mml:mtext>More5 rate</mml:mtext></mml:mrow></mml:msub><mml:mo class="MathClass-punc">,</mml:mo><mml:msub><mml:mrow><mml:mtext>W</mml:mtext></mml:mrow><mml:mrow><mml:mtext>Trim5 rate1</mml:mtext></mml:mrow></mml:msub><mml:mo class="MathClass-punc">,</mml:mo><mml:msub><mml:mrow><mml:mtext>W</mml:mtext></mml:mrow><mml:mrow><mml:mtext>Trim5 rate2</mml:mtext></mml:mrow></mml:msub><mml:mo class="MathClass-punc">,</mml:mo><mml:msub><mml:mrow><mml:mtext>W</mml:mtext></mml:mrow><mml:mrow><mml:mtext>merged num</mml:mtext></mml:mrow></mml:msub><mml:mo class="MathClass-punc">,</mml:mo><mml:msub><mml:mrow><mml:mtext>W</mml:mtext></mml:mrow><mml:mrow><mml:mtext>major</mml:mtext></mml:mrow></mml:msub><mml:mo class="MathClass-punc">,</mml:mo><mml:msub><mml:mrow><mml:mtext>W</mml:mtext></mml:mrow><mml:mrow><mml:mtext>minor</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow><mml:mo class="MathClass-rel">=</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left" class="align-odd"><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:mn>20</mml:mn><mml:mo class="MathClass-punc">,</mml:mo><mml:mn>20</mml:mn><mml:mo class="MathClass-punc">,</mml:mo><mml:mn>15</mml:mn><mml:mo class="MathClass-punc">,</mml:mo><mml:mn>10</mml:mn><mml:mo class="MathClass-punc">,</mml:mo><mml:mn>10</mml:mn><mml:mo class="MathClass-punc">,</mml:mo><mml:mn>15</mml:mn><mml:mo class="MathClass-punc">,</mml:mo><mml:mn>10</mml:mn><mml:mo class="MathClass-punc">,</mml:mo><mml:mn>5</mml:mn><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
where “#merged sequences” is the number of sequences merged in the optimization step.</p>
        <p>Similarity of human alleles for α and β chains, as well as for heavy and light chains, in IMGT, was analyzed. Hamming distances between any alleles and the *01 allele in a gene were calculated (Figure S5 in Supplementary Material, Inner_gene). As a control, Hamming distances between the *01 allele and one of the alleles in other genes (Figure S5 in Supplementary Material, Outer_gene) were also calculated and had the highest similarity with the *01 allele. Thus, the most probable dividing lines between the Inner_gene and Outer_gene were a Hamming distance for the V and J gene of 7 and 5, respectively (Figure S5 in Supplementary Material). To distinguish between inferred germline genes and alleles, and to determine which alleles belonged to the same genes, two steps were used to provide a recommended name for each inferred sequence. First, sequences were aligned to the known germline sequences of the human and mouse from the IMGT database, where other known germline sequences could also be added for annotation using the parameter “−<italic>known</italic>.” If the mismatch number between the sequence and nearest known germline sequence was &lt;7 bp (for J: ≤5 bp), the sequence was regarded as a novel allele belonging to the gene of the nearest known germline. Second, for sequences with a mismatch number &gt;7 bp (for J: &gt;5 bp), we clustered sequences into a group if their Hamming distance was &lt;7 bp (for J: ≤5 bp) using the QT_Clust algorithm (<xref rid="B18" ref-type="bibr">18</xref>) and assumed that the sequences in a group belonged to one gene. We named the group using a character as an assumed gene name followed by an asterisk and allele number (Figure <xref ref-type="fig" rid="F3">3</xref>C) according to the nomenclature rules set by the IMGT collaboration. Notably, accurate nomenclature requires complete assembly of the genome for TCR and BCR germline loci, which is not available for most species. Besides, a few independent V segments are high homologous between each other, with the mismatch number less than 7 bp. Therefore, the gene and allele names provided here are just as reference, and much more sufficient evidence are required by further work.</p>
        <p>To annotate the inferred sequences, information of the mapped nearest known germline sequence was provided in the output file, which included the nearest allele, number of mismatches, and number of deviated bases (Figure <xref ref-type="fig" rid="F3">3</xref>C). Each sequence was marked as “known,” “novel_allele,” or “novel_gene,” and a name recommended in terms of the standards and rules stated above. Overall, IMPre outputs two files: one is the annotation file and the other is the inferred sequence with the FASTA format (Figure <xref ref-type="fig" rid="F3">3</xref>C).</p>
      </sec>
    </sec>
    <sec id="S2-2">
      <title>Simulation of <italic>In Silico</italic> Sequences</title>
      <p>The method to generate simulated BCR repertoire sequences were described in the previous paper (<xref rid="B14" ref-type="bibr">14</xref>). Here, we create 12 datasets and each one includes 10<sup>5</sup> rearranged sequences. First, we generate sequencing error with the rate of 0.5% (per base) for all sequences. Second, we generate the SHM for 80% of sequences of dataset, with different SHM level rates: 0, 1, 5, 10, 15, and 20% (per base) for six dataset separately, and with the SHM rate 1% for the other six datasets, where the mutations occur at random. Third, for the latter six datasets, we generate the hotspot mutation in them, with the hotspot rate of 5, 10, 15, 20, 25, and 30%, respectively. We generate the hotspot mutations like that: for the sequences derived from the same germline allele, partial of them (hotspot rate 5% means 5% of them) create a same specific mutation. For example, there are 100 rearranged sequences derived from the germline <italic>IGHV1-1*01</italic>, 20 of them have the same mutation at position 120, such as A- &gt;C, so the hotspot rate is 20%. Therefore, all germline alleles made up the dataset generate the same hotspot mutation rate.</p>
    </sec>
    <sec id="S2-3">
      <title>Collection and Preprocessing of Samples</title>
      <p>Research was reviewed prospectively and approved by a duly constituted ethics committee (Institutional Review Board on Bioethics and Biosafety of BGI-Shenzhen).</p>
      <p>All human samples were recruited after obtaining written informed consent. Mononuclear cells were isolated from the peripheral blood of five healthy individuals using Ficoll-Paque (GE Healthcare, Little Chalfont, UK) gradient centrifugation. RNA was extracted using TRIzol<sup>®</sup> (Invitrogen, Carlsbad, CA, USA). Three samples were used to capture TRB, and two samples were used for IGH. We used a Rapid Amplification of cDNA Ends (5′ RACE) kit (v2.0, Invitrogen) to amplify the target region with primers at a C region. TRB primers were used based on the study by Warren and colleagues (<xref rid="B19" ref-type="bibr">19</xref>). PCR products were sheared using a Covaris S2 system (Applied Biosystems, Foster City, CA, USA). Biotinylated fragments were purified and excised in 100–200 fragments to prepare a library. Samples were sequenced using a HiSeq 2000 system (Illumina, San Diego, CA, USA) with a paired-end (PE) 100 bp (Table S1 in Supplementary Material). An additional human sample was collected. Multiplex PCR was used to amplify IGH with BIOMED-2 primers (<xref rid="B20" ref-type="bibr">20</xref>) at the FR1 region and C region. We undertook sequencing with MiSeq and PE 300 bp kits (Table S1 in Supplementary Material). Data of two healthy Indian rhesus monkeys were collected [we adhered to the <italic>Guidelines for the Care and use of Animals for Scientific Purposes</italic> (November 2004) established by the Singapore National Advisory Committee for Laboratory Animal Research]. TRB samples were sequenced using HiSeq 2000 with PE 150 bp kits (Table S1 in Supplementary Material). All sequence preprocessing was done and PE reads merged using IMonitor (<xref rid="B14" ref-type="bibr">14</xref>).</p>
      <p>Raw deep-sequencing data of human samples are available at the NCBI Short Read Archive<xref ref-type="fn" rid="fn2"><sup>2</sup></xref> under the accession numbers SRA339484 and RJNA309577.</p>
    </sec>
  </sec>
  <sec id="S3">
    <title>Results</title>
    <sec id="S3-4">
      <title>Training Parameters of Software Using Human Samples</title>
      <p>Currently, there are relatively complete germline sequences for humans in the IMGT database. If we align the TRB or IGH repertoires to the human known germline sequences, and we can identify which gene and allele exists in the TRB and IGH samples. Therefore, rearranged repertoire data for humans were adopted to train IMPre. Two TRB (S01-R and S03-R) samples and another IGH (H09, of which the mutation rate is 5.36% per base and 72.25% sequences contain error bases) sample from healthy humans (Table S1 in Supplementary Material), amplified by 5′ RACE and sequenced using the Illumina platform, were used as the training dataset. The assembly step used <italic>Ar</italic> and <italic>Ur</italic> to judge whether a sequence extension should continue or terminate. To train these two parameters, we calculated the <italic>Ar</italic> and <italic>Ur</italic> for the true germline sequence (TGS) and error germline sequence (EGS) in each cluster outputted by the clustering step of IMPre. After clustering, if the sequence contained the V or J germline allele without mismatch and &lt;3 bp deletion at the junction region, we defined it as the TGS, otherwise it was defined as an EGS. Human germline sequences from the IMGT database were trimmed 3 bp at the 3′ end for the V gene (or trimmed 3 bp at the 5′ end for the J gene) for use as the reference database. Sequences after clustering were aligned to the reference database using a global-alignment strategy. TGSs and EGSs were determined using the criteria stated above, and the <italic>Ar</italic> and <italic>Ur</italic> for them calculated (Figure <xref ref-type="fig" rid="F4">4</xref>A).<italic>Ar</italic> and <italic>Ur</italic> values for TGSs are shown in red, and EGSs are shown in black, in Figure <xref ref-type="fig" rid="F4">4</xref>A. Remarkably, TGSs exhibited much higher values than EGSs for <italic>Ur</italic> and <italic>Ar</italic>. Hence, we could use <italic>Ar</italic> and <italic>Ur</italic> (V: <italic>Ar</italic> &gt; 0.15, <italic>Ur</italic> &gt; 0.12; J: <italic>Ar</italic> &gt; 0.12, <italic>Ur</italic> &gt; 0.10) to distinguish most TGSs from EGSs.</p>
      <fig id="F4" position="float">
        <label>Figure 4</label>
        <caption>
          <p><bold>Training IMPre parameters using human samples</bold>. <bold>(A)</bold> Two human TRB samples and an IGH sample are used for training parameters, <italic>Ar</italic> and <italic>Ur</italic>, used in the assembly step. Red triangle: TGSs; black triangle: EGSs. The dashed line for TRB indicates the following: <italic>Ar</italic>(V) = 0.15, <italic>Ur</italic>(V) = 0.12, <italic>Ar</italic>(J) = 0.12, and <italic>Ur</italic>(J) = 0.10. The dashed line for IGH indicates the following: <italic>Ar</italic>(V) = 0.15, <italic>Ur</italic>(V) = 0.12, <italic>Ar</italic> (J) = 0.12, and <italic>Ur</italic>(J) = 0.10. <bold>(B)</bold> Two human TRB samples are used for training five parameters (<italic>Trim5 Ratio1</italic>, <italic>Trim5 Ratio2</italic>, <italic>Trim5 Rate1</italic>, <italic>Trim5 Rate2</italic>, and <italic>More5 Rate</italic>) used in the optimization step. The <italic>Trim5 Ratio</italic> includes <italic>Trim5 Ratio1</italic> and <italic>Trim5 Ratio2</italic> (solid), and the <italic>Trim5</italic> Rate includes <italic>Trim5 Rate1</italic> (hollow) and <italic>Trim5 Rate2</italic> (solid). Red: TP; black: FP. The dashed line denotes the following: <italic>Trim5 Ratio</italic> = 1.5, <italic>Trim5 Rate</italic> = 2, <italic>Trim5 Rate</italic>(J) = 0.5, and <italic>More5 Rate</italic> = 5. <bold>(C)</bold> A human IGH sample is used for training five parameters (<italic>Trim5 Ratio1</italic>, <italic>Trim5 Ratio2</italic>, <italic>Trim5 Rate1</italic>, <italic>Trim5 Rate2</italic>, and <italic>More5 Rate</italic>) used in the optimization step. Red: TP; black: FP. The dashed line denotes the following: <italic>Trim5 Ratio</italic> = 1.5, <italic>Trim5 Rate</italic> = 2, and <italic>More5 Rate</italic> = 5.</p>
        </caption>
        <graphic xlink:href="fimmu-07-00457-g004"/>
      </fig>
      <p>For the optimization step, we used five parameters (<italic>Trim5 Ratio1</italic>, <italic>Trim5 Ratio2</italic>, <italic>Trim5 Rate1</italic>, <italic>Trim5 Ratio1</italic>, and <italic>More5 Rate</italic>) to filter FP sequences. We observed four types of sequences from the assembly step (Figure <xref ref-type="fig" rid="F2">2</xref>B). Herein, we define the extended sequences of the “right” type as “true positive” (TP) and the other three types as FP. We aligned the extended sequences to known germline sequences in humans (as reference, from the IMGT database). If the identity was &gt;90%, missed nucleotides at the terminus (compared with the reference) were &lt;20 bp and extra nucleotides at the terminus were &lt;5 bp, the extended sequence was regarded to be a TP, otherwise it was defined as a FP. Then, we calculated the values of five parameters for TPs and FPs (Figures <xref ref-type="fig" rid="F4">4</xref>B,C). As expected, TPs exhibited higher values for all parameters than FPs, which demonstrated their discriminatory power on TPs and FPs for TRB and IGH samples [<italic>Trim5 Ratio</italic> &gt;1.5, <italic>Trim5 Rate</italic> &gt;2 (for <italic>TRB-J</italic> &gt;0.5), and <italic>More5 Rate</italic> &gt;5].</p>
    </sec>
    <sec id="S3-5">
      <title>Evaluation of IMPre Accuracy Using Human Samples</title>
      <p>A TRB sample (S02-R) and IGH sample (H08) from healthy humans were used to evaluate the accuracy of IMPre. Predicted germline sequences were aligned to known human germline genes and alleles, and the nearest allele was determined for each sequence to calculate the mismatch number, identity, and deviated bases (Figure <xref ref-type="fig" rid="F5">5</xref>). Deviating bases were the number of missed nucleotides (−) or extra nucleotides (+) at the 3′ end of V (and 5′ end of J) compared with the nearest allele. Currently, 48 V and 13 J TCR-β functional human genes as well as 53 V and 6 J IGH functional human genes have been reported in the IMGT database. For these samples, most VJ genes could be predicted with at least one allele using this method. All 13 J genes, 42 of 48 V genes for TRB, all 6 J genes and 36 of 53 V genes for IGH were observed in addition to 2 pseudogenes per sample. Compared with the nearest allele, the mismatch number, deviated bases, and identity were used to assess the quality of the predicted sequence. The sequence was considered to be correct if the identity was &gt;90%, and the absolute deviated base was &lt;5. Accuracies for TRBV, TRBJ, IGHV and IGHJ were 97.7, 100, 92.9, and 100%, respectively (Table <xref ref-type="table" rid="T1">1</xref>), which showed that IMPre is highly accurate for TRB and IGH. Average identity, average deviated base, and average mismatch were, respectively, 99.7%, 1.1, and 0.3 for TRBV; 100%, 1.1, and 0 for TRBJ; 99.1%, 1.7, and 0.6 for IGHV; and 98.9%, 1.1, and 0.6 for IGHJ. High identity, few deviated bases, and fewer mismatches suggest that IMPre could predict human germline genes/alleles accurately and precisely. Furthermore, most nearest alleles for samples were *01 for TRB and IGH samples, suggesting that *01 is the major allele in the population. The few heterozygous alleles observed in the present study are comparable to those noted by Boyd and coworkers (<xref rid="B7" ref-type="bibr">7</xref>).</p>
      <fig id="F5" position="float">
        <label>Figure 5</label>
        <caption>
          <p><bold>Detailed evaluation of the predicted sequences for human samples</bold>. Predicted sequences were aligned to known human germline genes to determine the nearest alleles and calculate the mismatch number, deviated base, and identity. A “+” for the nearest alleles indicates that the sequence has multiple nearest genes. A “+/−” in deviated bases indicates that it includes extra nucleotides/missed nucleotides at the terminus. F, functional; P, pseudogene; ORF, open reading frame (definition from the IMGT). <bold>(A)</bold> TRB S02-R sample. <bold>(B)</bold> IGH H08 sample.</p>
        </caption>
        <graphic xlink:href="fimmu-07-00457-g005"/>
      </fig>
      <table-wrap id="T1" position="float">
        <label>Table 1</label>
        <caption>
          <p><bold>Evaluation of the predicted V/J germline sequences of humans and rhesus monkey</bold>.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th valign="top" align="left" rowspan="1" colspan="1">Sample</th>
              <th valign="top" align="left" rowspan="1" colspan="1">Species-chain</th>
              <th valign="top" align="center" colspan="5" rowspan="1">Predicted V germline genes/alleles<xref ref-type="table-fn" rid="tfnT1_3"><sup>c</sup></xref><hr/></th>
              <th valign="top" align="center" colspan="5" rowspan="1">Predicted J germline genes/alleles<xref ref-type="table-fn" rid="tfnT1_3"><sup>c</sup></xref><hr/></th>
            </tr>
            <tr>
              <th valign="top" align="center" rowspan="1" colspan="1"/>
              <th valign="top" align="center" rowspan="1" colspan="1"/>
              <th valign="top" align="center" rowspan="1" colspan="1">Number</th>
              <th valign="top" align="center" rowspan="1" colspan="1">Accuracy (%)<xref ref-type="table-fn" rid="tfnT1_1"><sup>a</sup></xref></th>
              <th valign="top" align="center" rowspan="1" colspan="1">AVE identity (%)</th>
              <th valign="top" align="center" rowspan="1" colspan="1">AVE |deviated bases (bp)|<xref ref-type="table-fn" rid="tfnT1_2"><sup>b</sup></xref></th>
              <th valign="top" align="center" rowspan="1" colspan="1">AVE mismatch (bp)</th>
              <th valign="top" align="center" rowspan="1" colspan="1">Number</th>
              <th valign="top" align="center" rowspan="1" colspan="1">Accuracy (%)<xref ref-type="table-fn" rid="tfnT1_1"><sup>a</sup></xref></th>
              <th valign="top" align="center" rowspan="1" colspan="1">AVE identity (%)</th>
              <th valign="top" align="center" rowspan="1" colspan="1">AVE |deviated bases (bp)|<xref ref-type="table-fn" rid="tfnT1_2"><sup>b</sup></xref></th>
              <th valign="top" align="center" rowspan="1" colspan="1">AVE mismatch (bp)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">S02-R</td>
              <td valign="top" align="left" rowspan="1" colspan="1">Human-TRB</td>
              <td valign="top" align="center" rowspan="1" colspan="1">44</td>
              <td valign="top" align="center" rowspan="1" colspan="1">43 (97.7)</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.7</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.3</td>
              <td valign="top" align="center" rowspan="1" colspan="1">13</td>
              <td valign="top" align="center" rowspan="1" colspan="1">13 (100.0)</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100.0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">H08</td>
              <td valign="top" align="left" rowspan="1" colspan="1">Human-IGH</td>
              <td valign="top" align="center" rowspan="1" colspan="1">42</td>
              <td valign="top" align="center" rowspan="1" colspan="1">39 (92.9)</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.7</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.6</td>
              <td valign="top" align="center" rowspan="1" colspan="1">8</td>
              <td valign="top" align="center" rowspan="1" colspan="1">8 (100.0)</td>
              <td valign="top" align="center" rowspan="1" colspan="1">98.9</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.6</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">05D328</td>
              <td valign="top" align="left" rowspan="1" colspan="1">Monkey-TRB</td>
              <td valign="top" align="center" rowspan="1" colspan="1">46</td>
              <td valign="top" align="center" rowspan="1" colspan="1">44 (95.7)</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.3</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.6</td>
              <td valign="top" align="center" rowspan="1" colspan="1">15</td>
              <td valign="top" align="center" rowspan="1" colspan="1">15 (100.0)</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.5</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">A8L087</td>
              <td valign="top" align="left" rowspan="1" colspan="1">Monkey-TRB</td>
              <td valign="top" align="center" rowspan="1" colspan="1">46</td>
              <td valign="top" align="center" rowspan="1" colspan="1">43 (93.5)</td>
              <td valign="top" align="center" rowspan="1" colspan="1">98.9</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.3</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.8</td>
              <td valign="top" align="center" rowspan="1" colspan="1">14</td>
              <td valign="top" align="center" rowspan="1" colspan="1">14 (100.0)</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.9</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.4</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">AVE1<xref ref-type="table-fn" rid="tfnT1_4"><sup>d</sup></xref></td>
              <td valign="top" align="left" rowspan="1" colspan="1">Monkey-TRB</td>
              <td valign="top" align="center" rowspan="1" colspan="1">46</td>
              <td valign="top" align="center" rowspan="1" colspan="1">44 (94.6)</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.3</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.7</td>
              <td valign="top" align="center" rowspan="1" colspan="1">15</td>
              <td valign="top" align="center" rowspan="1" colspan="1">15 (100.0)</td>
              <td valign="top" align="center" rowspan="1" colspan="1">99.1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.5</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">H88-LS</td>
              <td valign="top" align="left" rowspan="1" colspan="1">Human-IGH</td>
              <td valign="top" align="center" rowspan="1" colspan="1">35</td>
              <td valign="top" align="center" rowspan="1" colspan="1">34 (97.1)</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100.0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">6</td>
              <td valign="top" align="center" rowspan="1" colspan="1">6 (100.0)</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100.0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tfnT1_1">
            <p><italic><sup>a</sup>Identity ≥90% and |deviated bases| ≤5 were defined as correct and used to calculate accuracy</italic>.</p>
          </fn>
          <fn id="tfnT1_2">
            <p><italic><sup>b</sup>AVE, average; absolute values of deviated bases were used to calculate average values</italic>.</p>
          </fn>
          <fn id="tfnT1_3">
            <p><italic><sup>c</sup>Identity ≥90% and |deviated bases| ≤5 were defined as correct and used to calculate the average identity, deviated bases, and mismatches</italic>.</p>
          </fn>
          <fn id="tfnT1_4">
            <p><italic><sup>d</sup>Average of 05D328 and A8L087 samples</italic>.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="S3-6">
      <title>Evaluation of Efficiency and Robustness</title>
      <p>Immune Germline Prediction was implemented using Perl and C programs. We optimized the programs multiple times to reduce memory use and increase the efficiency of clustering and assembly. One million subsequences were extracted at random from TRB and IGH samples, which were used to test IMPre performance. IMPre used 38 min and 41 s and 1.63 Gb peak memory for the entire TRB analysis, whereas 25 min and 17 s and 1.11 Gb peak memory were used for the IGH analysis (Figure <xref ref-type="fig" rid="F6">6</xref>A).</p>
      <fig id="F6" position="float">
        <label>Figure 6</label>
        <caption>
          <p><bold>Performance assessment</bold>. <bold>(A)</bold> Time and memory test. The following parameters were used: “−v_seed 40, −v_min_e 1, −j_min_e 1” and default for the remaining parameters. <bold>(B)</bold> Subsampling from five human samples. Predicted allele number, high identity, and deviated bases were used to assess the accuracy of predicted sequences.</p>
        </caption>
        <graphic xlink:href="fimmu-07-00457-g006"/>
      </fig>
      <p>Immune Germline Prediction exhibited good accuracy for human deep-sequencing data. However, we did not know if the method was stable for lower throughput data or for optimal and minimal data requirements. Random sampling was done using five samples at a sequence interval of 1 million from 1 million to 15 million sequences. For each subsample, germline sequences were predicted using IMPre and aligned to human known germline genes for assessment. The predicted allele number, high identity (&gt;90%) rate, and deviated base (≤5) rate were calculated (Figure <xref ref-type="fig" rid="F6">6</xref>B). Predicted numbers were fairly stable with a change in data size for TRB and IGHJ. Certain fluctuations were observed for IGHV, and the number tended to decrease with increase in data size. Similarly, the high identity and deviated base rate for TRB and IGHJ presented an almost flat line for most samples except for one TRBV sample (which produced lower values for both measures). IGHV exhibited a slight fluctuation for both measures, but they tended to have slightly high rates with increasing data size. In summary, the predicted accuracy was relatively stable for various subsamplings and demonstrated that IMPre is robust and reliable. Furthermore, accuracies between 1 million and 15 million sequences were similar, so 1 million sequences were sufficient for this analysis. The data size for IGH could be larger for greater accuracy.</p>
    </sec>
    <sec id="S3-7">
      <title>Evaluation of TRB Samples from Monkeys</title>
      <p>Immune Germline Prediction performed well using human samples, so the next step was to test its performance with non-human species. TCR-β germline alleles are incomplete, but the germline genes for rhesus monkeys are relatively complete in the IMGT database, thereby providing positive controls for our evaluation. Two rhesus monkeys (Table S1 in Supplementary Material) were sequenced for TCR-β using a 5′ RACE approach, and these data were used to predict TRB germline genes. IMPre parameters were the same as for human samples, and the predicted sequences were aligned to the known germline genes for rhesus monkeys (see text footnote 1). Assessment details are provided in Figure <xref ref-type="fig" rid="F7">7</xref>, Figure S3 in Supplementary Material, and Table <xref ref-type="table" rid="T1">1</xref>. Accuracy was 94.6% for V genes and 100% for J genes, values which were similar to the human results. Most V/J genes were predicted for at least one allele. All J genes and, on average, 39 of 59 V genes, were observed per sample. The inferred V sequences exhibited, on average, 99% identity, 1.3 deviated bases, and 1.7 mismatches per sample, whereas the J sequences exhibited 99.1% identity, 1.0% deviated bases, and 0.5% mismatches per sample (Table <xref ref-type="table" rid="T1">1</xref>). We also observed two V pseudogenes for each sample; only two predicted identities for sequences were &lt;90% for each sample; four deviated bases of sequences (absolute value) were &gt;5 bp (Figure <xref ref-type="fig" rid="F7">7</xref>B). However, compared with human samples, slightly more mismatches were observed (Figure <xref ref-type="fig" rid="F7">7</xref>B), which was probably due to incomplete alleles in the database. These data showed that IMPre and the parameters it employs can infer high-quality germline sequences for non-human samples precisely.</p>
      <fig id="F7" position="float">
        <label>Figure 7</label>
        <caption>
          <p><bold>Detailed evaluation of predicted sequences for TRB samples from rhesus monkeys</bold>. Predicted sequences were aligned to known germline genes for rhesus monkeys for the nearest alleles and to calculate the mismatch number, deviated bases, and identity. <bold>(A)</bold> 05D328 sample. A “+” in the nearest alleles indicates that the sequence exhibits multiple nearest genes. A “+/−” in the deviated bases indicates that it exhibits extra nucleotides/missed nucleotides at the terminus. F, functional; P, pseudogene; ORF, open reading frame. <bold>(B)</bold> Statistics of the predicted sequences for two TRB samples. The left panel is the predicted V/J gene and allele number, including functional gene (F) and pseudogene (P). The identity, deviated base, and mismatch number for predicted sequences are calculated and displayed. V and J sequences are combined together.</p>
        </caption>
        <graphic xlink:href="fimmu-07-00457-g007"/>
      </fig>
    </sec>
    <sec id="S3-8">
      <title>Evaluation Using Long-Sequence Human Samples</title>
      <p>The analyses carried out above were based on prevalent short-sequence data (Illumina Hiseq). To ascertain if all IMPre parameters were suitable for long sequences (the entire V region was sequenced using MiSeq), a human IGH sample (Table S1 in Supplementary Material) with primers designed at FR1 and C regions were used to test IMPre. The parameters applied were the same as those mentioned above except for the changed seed length (200 bp). Assessment results showed that IMPre performed well using a long sequence (Table <xref ref-type="table" rid="T1">1</xref>; Figure <xref ref-type="fig" rid="F8">8</xref>). The assessment detail for each sequence is displayed in Figure S4 in Supplementary Material. We predicted 27 V genes and most V3 genes were lost (Figure S4 in Supplementary Material) due to V3 accounting for only 3.7% of the raw sample sequences; all 6 J genes were identified (Figure <xref ref-type="fig" rid="F8">8</xref>A). Except for two sequences containing a mismatch, predicted V sequences were completely consistent with known germline gene/alleles in the IMGT database (Figure <xref ref-type="fig" rid="F8">8</xref>D), and the identities were 100% (Figure <xref ref-type="fig" rid="F8">8</xref>B); all predicted J germline sequences were consistent with known germline gene/alleles (Figures <xref ref-type="fig" rid="F8">8</xref>B,D). All deviated bases of predicted V/J sequences (absolute values) were between −2 and 3 bp (Figure <xref ref-type="fig" rid="F8">8</xref>C). All predicted V sequences were &gt;224 bp after trimming of the V primer (Figure <xref ref-type="fig" rid="F8">8</xref>E). Overall, this surprising accuracy showed that IMPre is suitable for long-sequence data. It was much better than the results obtained from short sequences, suggesting that long sequences are favorable for improved accuracy of prediction.</p>
      <fig id="F8" position="float">
        <label>Figure 8</label>
        <caption>
          <p><bold>Detailed evaluation of predicted long sequences for an IGH sample (H88-LS)</bold>. Predicted sequences were aligned to known human IGH germline alleles, and accuracy evaluated. <bold>(A)</bold> Predicted V/J gene and allele number. <bold>(B)</bold> Identity distribution for predicted V/J sequences. <bold>(C)</bold> Distribution of deviated bases for predicted V/J sequences. <bold>(D)</bold> Distribution of mismatch number for predicted V/J sequences. <bold>(E)</bold> Length distribution of predicted V sequence. The V primer is trimmed for these predicted V sequences. <bold>(F)</bold> The accuracy of inferred germline sequences for simulated datasets. e0.5%: 5% of sequencing error rate; m1%: 1% of mutation (occur at random) rate. Each dataset includes 10<sup>5</sup> sequences. <bold>(G)</bold> The accuracy of inferred germline sequences for simulated datasets (containing hotspot). hs5%: 5% of hotspot rate, that means 5% of rearranged sequences derived from the same germline allele occur a same specific mutation. Each dataset includes 10<sup>5</sup> sequences. <bold>(H)</bold> Comparison of inferred germline sequences from H88-LS sample and spiked-in sample. Venn diagram shows the number of inferred germline sequences.</p>
        </caption>
        <graphic xlink:href="fimmu-07-00457-g008"/>
      </fig>
    </sec>
    <sec id="S3-9">
      <title>Somatic Hypermutation Analysis and Novel Gene/Allele Effect</title>
      <p>To evaluate the different SHM levels effects on IMPre, we generated 12 datasets by computer with 0.05% sequencing error rate and different mutation rates, and 6 of datasets included different hotspot levels. Surprisingly, the accuracy is not declined along with the mutation (occur at random) rate increased (Figure <xref ref-type="fig" rid="F8">8</xref>F), which proves the good stability and performance of IMPre. Furthermore, for the dataset that 5% of simulated sequences of each germline allele contain a specific hotspot mutation, 90.91% of the germline sequences are inferred completely correct (Figure <xref ref-type="fig" rid="F8">8</xref>G). However, 65% of them can be identified when the hotspot rate reaches to 30% (Figure <xref ref-type="fig" rid="F8">8</xref>G). The decreasingly accuracy is expectable because it is difficult to discriminate between the mutation and real novel allele when 30% of sequences appear a same mutation.</p>
      <p>In our method, theoretically, we assemble the potential germline sequence using the reads in an independent cluster, where most of reads derive from the same V/J segments, so the presence of one segment do not influence the processing of other V/J segments inference. To test this speculation, the rearranged sequences were simulated (with 0.5% sequencing error rate and 1% mutation rate) from two novel V genes and two novel V alleles and then were spiked in the raw sequencing data of H-88 sample. As a result, the spiked-in 4 novel genes or alleles were inferred successfully by IMPre, and 34 (97.14%) germline alleles were repeated from the spiked-in data; however, 1 gene inferred from H-88 sample was not detected anymore in the spiked-in data (Figure <xref ref-type="fig" rid="F8">8</xref>H). The result demonstrates that the presence of one segment has little effect on other segments’ inference.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="S4">
    <title>Discussion</title>
    <p>In the present study, we introduced a novel tool, IMPre, based on rearranged repertoire data to predict novel genes and alleles. This method involves data processing, clustering, assembly, and optimization (Figure <xref ref-type="fig" rid="F1">1</xref>). We developed a clustering algorithm, Seed_Clust, to cluster sequences using the same seed k-mer. Then, a multiway tree was put in place to store nucleotides from a cluster, and a one-nucleotide extension strategy used for sequence assembly beginning with the seed. <italic>Ur</italic> and <italic>Ar</italic> values were applied further to determine where the extension should stop, which could be used to discriminate between a real gene segment and a FP sequence (Figure <xref ref-type="fig" rid="F4">4</xref>A). The three-step optimization process was designed to filter out FPs, merge redundant sequences, and remove SHM and PCR/sequencing errors (Figures <xref ref-type="fig" rid="F4">4</xref>B,C). We first trained this method using human samples and then assessed accuracy using additional samples (Figure <xref ref-type="fig" rid="F5">5</xref>; Table <xref ref-type="table" rid="T1">1</xref>).</p>
    <p>This method is based on certain probabilities of occurrence, including assembly and optimization parameters, so its stability had to be validated. We tested stability using three approaches. First, we selected data randomly from human samples at an interval of 1 million sequences with sizes from 1 million to 15 million sequences to evaluate the accuracy of the predicted sequences. Second, two non-human samples (TRB of rhesus monkeys) were used to test this method under the same key parameters. Third, three human IGH samples with the entire V region were used to ascertain if long-sequence data were suitable for this method using the same key parameters. The accuracy of all three tests was stable and similar to the results from the original human samples. Most parameters were derived from the characteristics of the V(D)J combinatorial mechanism, and we used human samples to train these parameters. Thus, if the V(D)J combinatorial mechanism of other species was similar to those of humans, IMPre could predict germline genes and alleles precisely. However, IMPre could miss a gene if its frequency in a sample was very low. To improve accuracy and infer all genes, more individuals are required. Also, the predicted sequence observed in multiple individuals is more credible and regarded to be the authentic germline gene or allele.</p>
    <p>Somatic hypermutation is one of the obstacles for inferring BCR germline sequence. We utilized some strategies to process this problem and proved it good (Figure <xref ref-type="fig" rid="F8">8</xref>). It was reported that the SHM creates at random and at low rate (<xref rid="B7" ref-type="bibr">7</xref>, <xref rid="B16" ref-type="bibr">16</xref>, <xref rid="B17" ref-type="bibr">17</xref>). Therefore, most of SHMs can be filtered in the assembly step, because the two parameters <italic>Ar</italic> and <italic>Ur</italic> for extension used in assembly step filter the low-frequency sequence in the cluster group. We simulated six datasets with different SHM levels and found our method can eliminate the SHM effect (Figure <xref ref-type="fig" rid="F8">8</xref>F). However, some cells experiencing continuous antigen exposure (such as HIV) or lymphocytes proliferating (such as leukemia) result in high rate of SHM (hotspot). We also simulated six datasets with different hotspot rates and found the accuracy declined when the hotspot rate more than 10%. In this case, we recommend using multiple individuals to infer the germline genes/alleles and select the inferred sequence appeared in different individuals.</p>
    <p>For some species, the rearranged repertoire cannot be amplified using multiplex PCR if the V/J germline genes are not known. However, the repertoire can be amplified using the 5′ RACE method for almost all species because the C region is conservative and it is easier to design the primer in this region. The arranged repertoire data generated by 5′ RACE provide an opportunity to infer the germline gene using IMPre. Unlike conventional PCR-based cloning strategies, we do not: (i) need to consider if the species is homologous with humans; (ii) use the known germline genes in a publically available database; or (iii) need the genome sequence. Hence, this is a simpler and more direct method to find germline genes. Unlike a method that infers the germline gene from a species genome, we predicted genes more accurately because exact and correct assembly for the highly homologous and polymorphic region is difficult.</p>
    <p>In the near future, there will be a rapid accumulation of high-throughput sequence data for TCR and BCR repertoires, including various large-scale disease studies and application projects. These data can be used to infer novel alleles for humans and other species using IMPre. Many novel V/J alleles could be identified from these data. The rearranged repertoire data generated by multiplex PCR are also available to infer novel alleles because the latter will be included among them.</p>
    <p>For future novel studies on prediction of germline genes, D genes can also be added using deep sequencing of repertoire data using the same strategy. Distributions of the length of 5′ and 3′ D deletions are similar to those in V genes (<xref rid="B14" ref-type="bibr">14</xref>). After the V and J germline genes have been identified for a rearranged sequence, the subsequence between V and J segments can be extracted and used to infer D germline segments. The IMPre tool that we developed provides a comprehensive approach for identification of novel BCR/TCR genes and alleles in certain species with greatly improved speed, cost, and accuracy.</p>
  </sec>
  <sec id="S5">
    <title>Author Contributions</title>
    <p>XL, WZ, and I-MW designed the project; WZ developed the methodology and wrote the manuscript; LL and JW carried out the experiments; WZ designed the bioinformatic workflow; WZ and XC developed the code for bioinformatic processing; WZ and CW analyzed the data; I-MW, AB, GD, and DC contributed reagents/materials.</p>
  </sec>
  <sec id="S6">
    <title>Conflict of Interest Statement</title>
    <p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
  </sec>
</body>
<back>
  <ack>
    <p>We thank the donors who denoted samples.</p>
  </ack>
  <fn-group>
    <fn id="fn1">
      <p><sup>1</sup><uri xlink:type="simple" xlink:href="http://www.imgt.org/">http://www.imgt.org/</uri>.</p>
    </fn>
    <fn id="fn2">
      <p><sup>2</sup><uri xlink:type="simple" xlink:href="http://www.ncbi.nlm.nih.gov/Traces/sra/">http://www.ncbi.nlm.nih.gov/Traces/sra/</uri>.</p>
    </fn>
  </fn-group>
  <sec id="S7">
    <title>Funding</title>
    <p>This project was funded by the Beijing Genomics Institute. The funder provided support in the form of salaries for WZ, CW, LL, XC, JW, and XL.</p>
  </sec>
  <sec id="S8" sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <p>The Supplementary Material for this article can be found online at <uri xlink:type="simple" xlink:href="http://journal.frontiersin.org/article/10.3389/fimmu.2016.00457">http://journal.frontiersin.org/article/10.3389/fimmu.2016.00457</uri>.</p>
    <supplementary-material content-type="local-data" id="SM1">
      <media xlink:href="Presentation_1.PDF">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jackson</surname><given-names>KJ</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name><name><surname>Roskin</surname><given-names>KM</given-names></name><name><surname>Glanville</surname><given-names>J</given-names></name><name><surname>Hoh</surname><given-names>RA</given-names></name><name><surname>Seo</surname><given-names>K</given-names></name><etal/></person-group><article-title>Human responses to influenza vaccination show seroconversion signatures and convergent antibody rearrangements</article-title>. <source>Cell Host Microbe</source> (<year>2014</year>) <volume>16</volume>(<issue>1</issue>):<fpage>105</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="doi">10.1016/j.chom.2014.05.013</pub-id><?supplied-pmid 24981332?><pub-id pub-id-type="pmid">24981332</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parameswaran</surname><given-names>P</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name><name><surname>Roskin</surname><given-names>KM</given-names></name><name><surname>Jackson</surname><given-names>KK</given-names></name><name><surname>Dixit</surname><given-names>VP</given-names></name><name><surname>Lee</surname><given-names>JY</given-names></name><etal/></person-group><article-title>Convergent antibody signatures in human dengue</article-title>. <source>Cell Host Microbe</source> (<year>2013</year>) <volume>13</volume>(<issue>6</issue>):<fpage>691</fpage>–<lpage>700</lpage>.<pub-id pub-id-type="doi">10.1016/j.chom.2013.05.008</pub-id><?supplied-pmid 23768493?><pub-id pub-id-type="pmid">23768493</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morris</surname><given-names>H</given-names></name><name><surname>DeWolf</surname><given-names>S</given-names></name><name><surname>Robins</surname><given-names>H</given-names></name><name><surname>Sprangers</surname><given-names>B</given-names></name><name><surname>LoCascio</surname><given-names>SA</given-names></name><name><surname>Shonts</surname><given-names>BA</given-names></name><etal/></person-group><article-title>Tracking donor-reactive T cells: evidence for clonal deletion in tolerant kidney transplant patients</article-title>. <source>Sci Transl Med</source> (<year>2015</year>) <volume>7</volume>(<issue>272</issue>):<fpage>272ra10</fpage>.<pub-id pub-id-type="doi">10.1126/scitranslmed.3010760</pub-id><?supplied-pmid 25632034?><pub-id pub-id-type="pmid">25632034</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname><given-names>N</given-names></name><name><surname>He</surname><given-names>J</given-names></name><name><surname>Weinstein</surname><given-names>JA</given-names></name><name><surname>Penland</surname><given-names>L</given-names></name><name><surname>Sasaki</surname><given-names>S</given-names></name><name><surname>He</surname><given-names>XS</given-names></name><etal/></person-group><article-title>Lineage structure of the human antibody repertoire in response to influenza vaccination</article-title>. <source>Sci Transl Med</source> (<year>2013</year>) <volume>5</volume>(<issue>171</issue>):<fpage>171ra19</fpage>.<pub-id pub-id-type="doi">10.1126/scitranslmed.3004794</pub-id><?supplied-pmid 23390249?><pub-id pub-id-type="pmid">23390249</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cheung</surname><given-names>WC</given-names></name><name><surname>Beausoleil</surname><given-names>SA</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Sato</surname><given-names>S</given-names></name><name><surname>Schieferl</surname><given-names>SM</given-names></name><name><surname>Wieler</surname><given-names>JS</given-names></name><etal/></person-group><article-title>A proteomics approach for the identification and cloning of monoclonal antibodies from serum</article-title>. <source>Nat Biotechnol</source> (<year>2012</year>) <volume>30</volume>(<issue>5</issue>):<fpage>447</fpage>–<lpage>52</lpage>.<pub-id pub-id-type="doi">10.1038/nbt.2167</pub-id><?supplied-pmid 22446692?><pub-id pub-id-type="pmid">22446692</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Croce</surname><given-names>CM</given-names></name><name><surname>Shander</surname><given-names>M</given-names></name><name><surname>Martinis</surname><given-names>J</given-names></name><name><surname>Cicurel</surname><given-names>L</given-names></name><name><surname>D’Ancona</surname><given-names>GG</given-names></name><name><surname>Dolby</surname><given-names>TW</given-names></name><etal/></person-group><article-title>Chromosomal location of the genes for human immunoglobulin heavy chains</article-title>. <source>Proc Natl Acad Sci U S A</source> (<year>1979</year>) <volume>76</volume>(<issue>7</issue>):<fpage>3416</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="doi">10.1073/pnas.76.7.3416</pub-id><?supplied-pmid 114999?><pub-id pub-id-type="pmid">114999</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boyd</surname><given-names>SD</given-names></name><name><surname>Gaeta</surname><given-names>BA</given-names></name><name><surname>Jackson</surname><given-names>KJ</given-names></name><name><surname>Fire</surname><given-names>AZ</given-names></name><name><surname>Marshall</surname><given-names>EL</given-names></name><name><surname>Merker</surname><given-names>JD</given-names></name><etal/></person-group><article-title>Individual variation in the germline Ig gene repertoire inferred from variable region gene rearrangements</article-title>. <source>J Immunol</source> (<year>2010</year>) <volume>184</volume>(<issue>12</issue>):<fpage>6986</fpage>–<lpage>92</lpage>.<pub-id pub-id-type="doi">10.4049/jimmunol.1000445</pub-id><?supplied-pmid 20495067?><pub-id pub-id-type="pmid">20495067</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gadala-Maria</surname><given-names>D</given-names></name><name><surname>Yaari</surname><given-names>G</given-names></name><name><surname>Uduman</surname><given-names>M</given-names></name><name><surname>Kleinstein</surname><given-names>SH</given-names></name></person-group>. <article-title>Automated analysis of high-throughput B-cell sequencing data reveals a high frequency of novel immunoglobulin V gene segment alleles</article-title>. <source>Proc Natl Acad Sci U S A</source> (<year>2015</year>) <volume>112</volume>(<issue>8</issue>):<fpage>E862</fpage>–<lpage>70</lpage>.<pub-id pub-id-type="doi">10.1073/pnas.1417683112</pub-id><?supplied-pmid 25675496?><pub-id pub-id-type="pmid">25675496</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xochelli</surname><given-names>A</given-names></name><name><surname>Agathangelidis</surname><given-names>A</given-names></name><name><surname>Kavakiotis</surname><given-names>I</given-names></name><name><surname>Minga</surname><given-names>E</given-names></name><name><surname>Sutton</surname><given-names>LA</given-names></name><name><surname>Baliakas</surname><given-names>P</given-names></name><etal/></person-group><article-title>Immunoglobulin heavy variable (IGHV) genes and alleles: new entities, new names and implications for research and prognostication in chronic lymphocytic leukaemia</article-title>. <source>Immunogenetics</source> (<year>2015</year>) <volume>67</volume>(<issue>1</issue>):<fpage>61</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="doi">10.1007/s00251-014-0812-3</pub-id><?supplied-pmid 25388851?><pub-id pub-id-type="pmid">25388851</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Griffin</surname><given-names>LM</given-names></name><name><surname>Snowden</surname><given-names>JR</given-names></name><name><surname>Lawson</surname><given-names>AD</given-names></name><name><surname>Wernery</surname><given-names>U</given-names></name><name><surname>Kinne</surname><given-names>J</given-names></name><name><surname>Baker</surname><given-names>TS</given-names></name></person-group>. <article-title>Analysis of heavy and light chain sequences of conventional camelid antibodies from <italic>Camelus dromedarius</italic> and <italic>Camelus bactrianus</italic> species</article-title>. <source>J Immunol Methods</source> (<year>2014</year>) <volume>405</volume>:<fpage>35</fpage>–<lpage>46</lpage>.<pub-id pub-id-type="doi">10.1016/j.jim.2014.01.003</pub-id><?supplied-pmid 24444705?><pub-id pub-id-type="pmid">24444705</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bible</surname><given-names>JM</given-names></name><name><surname>Howard</surname><given-names>W</given-names></name><name><surname>Robbins</surname><given-names>H</given-names></name><name><surname>Dunn-Walters</surname><given-names>DK</given-names></name></person-group>. <article-title>IGHV1, IGHV5 and IGHV7 subgroup genes in the rhesus macaque</article-title>. <source>Immunogenetics</source> (<year>2003</year>) <volume>54</volume>(<issue>12</issue>):<fpage>867</fpage>–<lpage>73</lpage>.<pub-id pub-id-type="doi">10.1007/s00251-003-0536-2</pub-id><?supplied-pmid 12671738?><pub-id pub-id-type="pmid">12671738</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Howard</surname><given-names>WA</given-names></name><name><surname>Bible</surname><given-names>JM</given-names></name><name><surname>Finlay-Dijsselbloem</surname><given-names>E</given-names></name><name><surname>Openshaw</surname><given-names>S</given-names></name><name><surname>Dunn-Walters</surname><given-names>DK</given-names></name></person-group>. <article-title>Immunoglobulin light-chain genes in the rhesus macaque I: kappa light-chain germline sequences for subgroups IGKV1, IGKV and IGKV3</article-title>. <source>Immunogenetics</source> (<year>2005</year>) <volume>57</volume>(<issue>3–4</issue>):<fpage>210</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="doi">10.1007/s00251-005-0794-2</pub-id><?supplied-pmid 15900492?><pub-id pub-id-type="pmid">15900492</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <label>13</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Greenaway</surname><given-names>HY</given-names></name><name><surname>Kurniawan</surname><given-names>M</given-names></name><name><surname>Price</surname><given-names>DA</given-names></name><name><surname>Douek</surname><given-names>DC</given-names></name><name><surname>Davenport</surname><given-names>MP</given-names></name><name><surname>Venturi</surname><given-names>V</given-names></name></person-group>. <article-title>Extraction and characterization of the rhesus macaque T-cell receptor beta-chain genes</article-title>. <source>Immunol Cell Biol</source> (<year>2009</year>) <volume>87</volume>(<issue>7</issue>):<fpage>546</fpage>–<lpage>53</lpage>.<pub-id pub-id-type="doi">10.1038/icb.2009.38</pub-id><?supplied-pmid 19506572?><pub-id pub-id-type="pmid">19506572</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <label>14</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>W</given-names></name><name><surname>Du</surname><given-names>Y</given-names></name><name><surname>Su</surname><given-names>Z</given-names></name><name><surname>Wang</surname><given-names>C</given-names></name><name><surname>Zeng</surname><given-names>X</given-names></name><name><surname>Zhang</surname><given-names>R</given-names></name><etal/></person-group><article-title>IMonitor: a robust pipeline for TCR and BCR repertoire analysis</article-title>. <source>Genetics</source> (<year>2015</year>) <volume>201</volume>(<issue>2</issue>):<fpage>459</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="doi">10.1534/genetics.115.176735</pub-id><?supplied-pmid 26297338?><pub-id pub-id-type="pmid">26297338</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <label>15</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Freeman</surname><given-names>JD</given-names></name><name><surname>Warren</surname><given-names>RL</given-names></name><name><surname>Webb</surname><given-names>JR</given-names></name><name><surname>Nelson</surname><given-names>BH</given-names></name><name><surname>Holt</surname><given-names>RA</given-names></name></person-group>. <article-title>Profiling the T-cell receptor beta-chain repertoire by massively parallel sequencing</article-title>. <source>Genome Res</source> (<year>2009</year>) <volume>19</volume>(<issue>10</issue>):<fpage>1817</fpage>–<lpage>24</lpage>.<pub-id pub-id-type="doi">10.1101/gr.092924.109</pub-id><?supplied-pmid 19541912?><pub-id pub-id-type="pmid">19541912</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <label>16</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Papavasiliou</surname><given-names>FN</given-names></name><name><surname>Schatz</surname><given-names>DG</given-names></name></person-group>. <article-title>Somatic hypermutation of immunoglobulin genes: merging mechanisms for genetic diversity</article-title>. <source>Cell</source> (<year>2002</year>) <volume>109</volume>(<issue>Suppl</issue>):<fpage>S35</fpage>–<lpage>44</lpage>.<pub-id pub-id-type="doi">10.1016/S0092-8674(02)00706-7</pub-id><?supplied-pmid 11983151?><pub-id pub-id-type="pmid">11983151</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <label>17</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muramatsu</surname><given-names>M</given-names></name><name><surname>Kinoshita</surname><given-names>K</given-names></name><name><surname>Fagarasan</surname><given-names>S</given-names></name><name><surname>Yamada</surname><given-names>S</given-names></name><name><surname>Shinkai</surname><given-names>Y</given-names></name><name><surname>Honjo</surname><given-names>T</given-names></name></person-group>. <article-title>Class switch recombination and hypermutation require activation-induced cytidine deaminase (AID), a potential RNA editing enzyme</article-title>. <source>Cell</source> (<year>2000</year>) <volume>102</volume>(<issue>5</issue>):<fpage>553</fpage>–<lpage>63</lpage>.<pub-id pub-id-type="doi">10.1016/S0092-8674(00)00078-7</pub-id><?supplied-pmid 11007474?><pub-id pub-id-type="pmid">11007474</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <label>18</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heyer</surname><given-names>LJ</given-names></name><name><surname>Kruglyak</surname><given-names>S</given-names></name><name><surname>Yooseph</surname><given-names>S</given-names></name></person-group>. <article-title>Exploring expression data: identification and analysis of coexpressed genes</article-title>. <source>Genome Res</source> (<year>1999</year>) <volume>9</volume>(<issue>11</issue>):<fpage>1106</fpage>–<lpage>15</lpage>.<pub-id pub-id-type="doi">10.1101/gr.9.11.1106</pub-id><?supplied-pmid 10568750?><pub-id pub-id-type="pmid">10568750</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <label>19</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Warren</surname><given-names>RL</given-names></name><name><surname>Freeman</surname><given-names>JD</given-names></name><name><surname>Zeng</surname><given-names>T</given-names></name><name><surname>Choe</surname><given-names>G</given-names></name><name><surname>Munro</surname><given-names>S</given-names></name><name><surname>Moore</surname><given-names>R</given-names></name><etal/></person-group><article-title>Exhaustive T-cell repertoire sequencing of human peripheral blood samples reveals signatures of antigen selection and a directly measured repertoire size of at least 1 million clonotypes</article-title>. <source>Genome Res</source> (<year>2011</year>) <volume>21</volume>(<issue>5</issue>):<fpage>790</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="doi">10.1101/gr.115428.110</pub-id><?supplied-pmid 21349924?><pub-id pub-id-type="pmid">21349924</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <label>20</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Dongen</surname><given-names>JJ</given-names></name><name><surname>Langerak</surname><given-names>AW</given-names></name><name><surname>Bruggemann</surname><given-names>M</given-names></name><name><surname>Evans</surname><given-names>PA</given-names></name><name><surname>Hummel</surname><given-names>M</given-names></name><name><surname>Lavender</surname><given-names>FL</given-names></name><etal/></person-group><article-title>Design and standardization of PCR primers and protocols for detection of clonal immunoglobulin and T-cell receptor gene recombinations in suspect lymphoproliferations: report of the BIOMED-2 Concerted Action BMH4-CT98-3936</article-title>. <source>Leukemia</source> (<year>2003</year>) <volume>17</volume>(<issue>12</issue>):<fpage>2257</fpage>–<lpage>317</lpage>.<pub-id pub-id-type="doi">10.1038/sj.leu.2403202</pub-id><?supplied-pmid 14671650?><pub-id pub-id-type="pmid">14671650</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
