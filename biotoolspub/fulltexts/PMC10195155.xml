<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Mol Biol Evol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Mol Biol Evol</journal-id>
    <journal-id journal-id-type="publisher-id">molbev</journal-id>
    <journal-title-group>
      <journal-title>Molecular Biology and Evolution</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0737-4038</issn>
    <issn pub-type="epub">1537-1719</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
      <publisher-loc>US</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10195155</article-id>
    <article-id pub-id-type="pmid">37158385</article-id>
    <article-id pub-id-type="doi">10.1093/molbev/msad106</article-id>
    <article-id pub-id-type="publisher-id">msad106</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methods</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01130</subject>
        <subject>AcademicSubjects/SCI01180</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CAGEE: Computational Analysis of Gene Expression Evolution</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Bertram</surname>
          <given-names>Jason</given-names>
        </name>
        <xref rid="msad106-cor1" ref-type="corresp"/>
        <aff><institution>Department of Biology, Indiana University</institution>, <addr-line>Bloomington, IN</addr-line></aff>
        <aff><institution>Department of Mathematics, Western University</institution>, <addr-line>London, ON</addr-line>, <country country="CA">Canada</country></aff>
        <!--jason.bertram@uwo.ca-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fulton</surname>
          <given-names>Ben</given-names>
        </name>
        <aff><institution>Department of Biology, Indiana University</institution>, <addr-line>Bloomington, IN</addr-line></aff>
        <aff><institution>University Information Technology Services, Indiana University</institution>, <addr-line>Bloomington, IN</addr-line></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tourigny</surname>
          <given-names>Jason P</given-names>
        </name>
        <aff><institution>Department of Biology, Indiana University</institution>, <addr-line>Bloomington, IN</addr-line></aff>
        <aff><institution>Department of Computer Science, Indiana University</institution>, <addr-line>Bloomington, IN</addr-line></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Peña-Garcia</surname>
          <given-names>Yadira</given-names>
        </name>
        <aff><institution>Department of Biology, Indiana University</institution>, <addr-line>Bloomington, IN</addr-line></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Moyle</surname>
          <given-names>Leonie C</given-names>
        </name>
        <aff><institution>Department of Biology, Indiana University</institution>, <addr-line>Bloomington, IN</addr-line></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Hahn</surname>
          <given-names>Matthew W</given-names>
        </name>
        <xref rid="msad106-cor1" ref-type="corresp"/>
        <aff><institution>Department of Biology, Indiana University</institution>, <addr-line>Bloomington, IN</addr-line></aff>
        <aff><institution>Department of Computer Science, Indiana University</institution>, <addr-line>Bloomington, IN</addr-line></aff>
        <!--mwh@indiana.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Nowick</surname>
          <given-names>Katja</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="msad106-cor1"><bold>Corresponding authors:</bold> E-mails: <email>jason.bertram@uwo.ca</email>; <email>mwh@indiana.edu</email>.</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-05-09">
      <day>09</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>09</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <volume>40</volume>
    <issue>5</issue>
    <elocation-id>msad106</elocation-id>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press on behalf of Society for Molecular Biology and Evolution.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="msad106.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Despite the increasing abundance of whole transcriptome data, few methods are available to analyze global gene expression across phylogenies. Here, we present a new software package (Computational Analysis of Gene Expression Evolution [CAGEE]) for inferring patterns of increases and decreases in gene expression across a phylogenetic tree, as well as the rate at which these changes occur. In contrast to previous methods that treat each gene independently, CAGEE can calculate genome-wide rates of gene expression, along with ancestral states for each gene. The statistical approach developed here makes it possible to infer lineage-specific shifts in rates of evolution across the genome, in addition to possible differences in rates among multiple tissues sampled from the same species. We demonstrate the accuracy and robustness of our method on simulated data and apply it to a data set of ovule gene expression collected from multiple self-compatible and self-incompatible species in the genus <italic toggle="yes">Solanum</italic> to test hypotheses about the evolutionary forces acting during mating system shifts. These comparisons allow us to highlight the power of CAGEE, demonstrating its utility for use in any empirical system and for the analysis of most morphological traits. Our software is available at <ext-link xlink:href="https://github.com/hahnlab/CAGEE/" ext-link-type="uri">https://github.com/hahnlab/CAGEE/</ext-link>.</p>
    </abstract>
    <kwd-group>
      <kwd>RNA-seq</kwd>
      <kwd>phylogenetic comparative methods</kwd>
      <kwd>Brownian motion</kwd>
      <kwd>
        <italic toggle="yes">Solanum</italic>
      </kwd>
    </kwd-group>
    <counts>
      <page-count count="12"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="msad106-s0">
    <title>Introduction</title>
    <p>Early studies of gene expression in single genes revealed widespread and frequent changes in the levels, timing, and breadth of expression across species (reviewed in <xref rid="msad106-B75" ref-type="bibr">Wray et al. 2003</xref>; <xref rid="msad106-B23" ref-type="bibr">Fay and Wittkopp 2008</xref>; <xref rid="msad106-B42" ref-type="bibr">Hill et al. 2021</xref>). Such changes in gene expression have been shown to be responsible for many differences between species and may be a major driver of evolution (<xref rid="msad106-B46" ref-type="bibr">King and Wilson 1975</xref>). Advances in sequencing technologies (i.e., RNA-seq) have transformed research into gene expression, allowing researchers to cheaply and accurately measure transcript levels for every gene in a genome, in multiple tissues, and across several timepoints or conditions (<xref rid="msad106-B72" ref-type="bibr">Wang et al. 2009</xref>). There is now a flood of interest in applying RNA-seq to whole clades of organisms in order to identify the genetic changes and evolutionary forces driving species differences (e.g., <xref rid="msad106-B9" ref-type="bibr">Brawand et al. 2011</xref>; <xref rid="msad106-B50" ref-type="bibr">Meisel et al. 2012</xref>; <xref rid="msad106-B17" ref-type="bibr">Coolon et al. 2014</xref>; <xref rid="msad106-B40" ref-type="bibr">Harrison et al. 2015</xref>; <xref rid="msad106-B5" ref-type="bibr">Berthelot et al. 2018</xref>; <xref rid="msad106-B13" ref-type="bibr">Catalan et al. 2019</xref>; <xref rid="msad106-B6" ref-type="bibr">Blake et al. 2020</xref>; <xref rid="msad106-B21" ref-type="bibr">El Taher et al. 2021</xref>).</p>
    <p>To better understand the importance of changes in gene expression, researchers must be able to characterize the mechanisms and modes by which gene expression evolves. Such work entails understanding the role of natural selection in driving species differences, the stages of development or the tissues that evolve most rapidly, as well as the environments most likely to generate changes in gene expression (<xref rid="msad106-B20" ref-type="bibr">Dunn et al. 2013</xref>; <xref rid="msad106-B42" ref-type="bibr">Hill et al. 2021</xref>; <xref rid="msad106-B60" ref-type="bibr">Price et al. 2022</xref>). Phylogenetic comparative methods enable the rigorous study of traits like gene expression across a species tree (<xref rid="msad106-B61" ref-type="bibr">Revell and Harmon 2022</xref>). These methods can be used for testing hypotheses about natural selection, the inference of ancestral states (allowing us to polarize the direction of changes), and the estimation of evolutionary rates. Multiple software packages are available that implement a wide variety of comparative methods (e.g., <xref rid="msad106-B58" ref-type="bibr">Pennell et al. 2014</xref>), including models specifically intended for studying gene expression across a tree (<xref rid="msad106-B3" ref-type="bibr">Bedford and Hartl 2009</xref>; <xref rid="msad106-B64" ref-type="bibr">Rohlfs et al. 2014</xref>; <xref rid="msad106-B65" ref-type="bibr">Rohlfs and Nielsen 2015</xref>; <xref rid="msad106-B13" ref-type="bibr">Catalán et al. 2019</xref>; <xref rid="msad106-B15" ref-type="bibr">Chen et al. 2019</xref>; <xref rid="msad106-B77" ref-type="bibr">Yang et al. 2019</xref>).</p>
    <p>However, as far as we are aware, all existing comparative methods for analyzing gene expression implement fundamentally single-gene analyses. Each gene is considered a separate trait, such that evolutionary parameters for each gene are estimated separately. Single-gene analyses can be used to identify tissue-specific or lineage-specific shifts in evolutionary rates, but their power is quite low (<xref rid="msad106-B2" ref-type="bibr">Beaulieu et al. 2012</xref>). As a result, identifying trends in evolution must be carried out post hoc by summing the number of genes found to be individually significant (e.g., <xref rid="msad106-B40" ref-type="bibr">Harrison et al. 2015</xref>; <xref rid="msad106-B21" ref-type="bibr">El Taher et al. 2021</xref>). This approach is less than ideal, especially when carrying out comparisons between branches of different lengths or between tissues with different average expression levels (both of which can result in differential statistical power).</p>
    <p>Therefore, to better characterize the forces affecting gene expression evolution, we must be able to model effects shared along a lineage, experienced by many genes in the same tissue, or experienced by all genes found in the same environment. In this article, we present a genome-scale platform for the analysis of gene expression data that allows for such shared factors. Our software, Computational Analysis of Gene Expression Evolution (CAGEE), provides a robust set of methods for analyzing expression data across a species tree. CAGEE estimates ancestral states and rates, with rates shared by all or subsets of genes (single-gene analyses can also be carried out). We show that lineage-specific and tissue-specific (or condition-specific) rates can be accurately inferred, and we provide principled statistical approaches for model selection. Our current implementation uses a bounded Brownian motion (BBM) model and assumes expression data are accurate, but the architecture and codebase will easily allow for future extensions that relax these and other assumptions.</p>
  </sec>
  <sec id="msad106-s1">
    <title>New Approaches</title>
    <p>We model gene expression evolution as a BBM process on a known species tree (cf. <xref rid="msad106-B7" ref-type="bibr">Boucher and Démery 2016</xref>). Our model has a single bound: trait values must be greater than or equal to zero; there is no upper bound (<xref rid="msad106-F1" ref-type="fig">fig. 1</xref>). Previous researchers have often modeled gene expression using an Ornstein–Uhlenbeck (OU) process <sans-serif>(e.g.,</sans-serif><xref rid="msad106-B3" ref-type="bibr">Bedford and Hartl 2009</xref><sans-serif>;</sans-serif><xref rid="msad106-B64" ref-type="bibr">Rohlfs et al. 2014</xref><sans-serif>;</sans-serif><xref rid="msad106-B65" ref-type="bibr">Rohlfs and Nielsen 2015</xref><sans-serif>;</sans-serif><xref rid="msad106-B15" ref-type="bibr">Chen et al. 2019</xref><sans-serif>), a model that includes a force constraining traits about the mean. However, to our knowledge, the OU model has only been compared against an unbounded Brownian motion model (i.e., one that allows negative expression values), making fair comparisons difficult. In addition, OU models may be frequently and incorrectly favored over simpler models due to several biases (e.g., measurement error), especially when the number of tips in a tree is small (</sans-serif><xref rid="msad106-B59" ref-type="bibr">Pennell et al. 2015</xref><sans-serif>;</sans-serif><xref rid="msad106-B66" ref-type="bibr">Silvestro et al. 2015</xref><sans-serif>;</sans-serif><xref rid="msad106-B7" ref-type="bibr">Boucher and Démery 2016</xref>; <xref rid="msad106-B18" ref-type="bibr">C<sans-serif>ooper et al. 201</sans-serif>6</xref><sans-serif>;</sans-serif><xref rid="msad106-B13" ref-type="bibr"><sans-serif>Catalán et al. 2019</sans-serif></xref><sans-serif>). Therefore, the initial version of our software models gene expression with the BBM process, which naturally bounds possible values without invoking an additional constraining force.</sans-serif></p>
    <fig position="float" id="msad106-F1" fig-type="figure">
      <label><sc>Fig.</sc> 1.</label>
      <caption>
        <p>BBM model. An example trait is shown in the bottom graph, evolving along the tree shown above. Although the data inputs to CAGEE are linear expression levels, internally, it logs expression to ensure higher variance among more highly expressed genes. There is also a minimum value, <italic toggle="yes">x</italic><sub>min</sub>, added to all tips.</p>
      </caption>
      <graphic xlink:href="msad106f1" position="float"/>
    </fig>
    <p>Let <inline-formula><mml:math id="IM1" display="inline" overflow="scroll"><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> be the expression level of gene <italic toggle="yes">i</italic> in species <italic toggle="yes">j</italic>. We assume that log-transformed expression <inline-formula><mml:math id="IM2" display="inline" overflow="scroll"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>ln</mml:mi><mml:mspace width="0.2em"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> evolves as a Brownian motion process with variance <inline-formula><mml:math id="IM3" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> per unit time, where <inline-formula><mml:math id="IM4" display="inline" overflow="scroll"><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula> is a small offset (constant across genes and species) that prevents <inline-formula><mml:math id="IM5" display="inline" overflow="scroll"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> from taking infinite values if measured values of <inline-formula><mml:math id="IM6" display="inline" overflow="scroll"><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are zero. We log-transform before assuming Brownian motion because we expect the variance in the evolutionary process to scale with expression level. Assuming that <inline-formula><mml:math id="IM7" display="inline" overflow="scroll"><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is itself Brownian would unrealistically assume that the rate of evolution is constant across expression levels, even though expression levels vary by many orders of magnitude. We impose a reflecting lower boundary at <inline-formula><mml:math id="IM8" display="inline" overflow="scroll"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mi>ln</mml:mi><mml:mspace width="0.2em"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, meaning that the Brownian walk immediately bounces back if it reaches <inline-formula><mml:math id="IM9" display="inline" overflow="scroll"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula>. Expression can therefore effectively never reach zero, our theoretical lower bound (<xref rid="msad106-F1" ref-type="fig">fig. 1</xref>).</p>
    <p>The second major feature of our model (as implemented in CAGEE) is that many genes can share the evolutionary rate parameter, <inline-formula><mml:math id="IM10" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>. This rate may be shared among genes expressed in the same tissue or sample, among genes located on the same chromosome, or among genes evolving along the same lineage of the phylogenetic tree. The simplest model allows <inline-formula><mml:math id="IM11" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> to be shared among all genes, providing an average rate of evolution across the genome and over time; this average may include genes that vary in their individual rates of evolution. We explain this model briefly here, with more detail provided in the Materials and Methods.</p>
    <p>CAGEE infers the most likely value(s) of <inline-formula><mml:math id="IM12" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> consistent with an ultrametric tree, <italic toggle="yes">T</italic>, and a set <inline-formula><mml:math id="IM13" display="inline" overflow="scroll"><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> of measured expression values at the tips of the tree; that is, it maximizes the likelihood <inline-formula><mml:math id="IM14" display="inline" overflow="scroll"><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo fence="false" stretchy="false">|</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>. Each gene is assumed to evolve independently, and so the likelihood for each gene <inline-formula><mml:math id="IM15" display="inline" overflow="scroll"><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo fence="false" stretchy="false">|</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mi>j</mml:mi><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is computed independently. The overall likelihood is obtained as the product <inline-formula><mml:math id="IM16" display="inline" overflow="scroll"><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Π</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo fence="false" stretchy="false">|</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mi>j</mml:mi><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> across genes. The likelihood for each gene <inline-formula><mml:math id="IM17" display="inline" overflow="scroll"><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo fence="false" stretchy="false">|</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mi>j</mml:mi><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is computed using the pruning algorithm (<xref rid="msad106-B24" ref-type="bibr">Felsenstein 1973</xref>). The key ingredient needed to apply the pruning algorithm is the transition probability density <inline-formula><mml:math id="IM18" display="inline" overflow="scroll"><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">Pr</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo fence="false" stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:math></inline-formula> for log expression at time <italic toggle="yes">t</italic> conditional on having log expression <inline-formula><mml:math id="IM19" display="inline" overflow="scroll"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> at time <inline-formula><mml:math id="IM20" display="inline" overflow="scroll"><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> along a lineage. CAGEE computes the transition density by solving the standard Brownian diffusion equation with reflecting boundary conditions (Materials and Methods). The transition density is used to propagate expression probabilities along the tree: if the probability density of log expression at time <inline-formula><mml:math id="IM21" display="inline" overflow="scroll"><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> is <inline-formula><mml:math id="IM22" display="inline" overflow="scroll"><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, then the probability density at time <italic toggle="yes">t</italic> on the same lineage is <inline-formula><mml:math id="IM23" display="inline" overflow="scroll"><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo largeop="false">∫</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula>. At each tip, the probability density <inline-formula><mml:math id="IM24" display="inline" overflow="scroll"><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is a delta function centered at the corresponding measured value of <inline-formula><mml:math id="IM25" display="inline" overflow="scroll"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>.</p>
    <p>Starting with the known tip distributions, the pruning algorithm propagates back to the tips’ parent nodes. The distribution at the parent node is then the product of the two backward-propagated child node distributions. Proceeding iteratively across the tree, we ultimately obtain the gene-specific probability density for expression value at the root <inline-formula><mml:math id="IM26" display="inline" overflow="scroll"><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>. Viewed as a likelihood for <inline-formula><mml:math id="IM27" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="IM28" display="inline" overflow="scroll"><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is the gene-specific likelihood conditional on the unknown ancestral root value; that is, <inline-formula><mml:math id="IM29" display="inline" overflow="scroll"><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo fence="false" stretchy="false">|</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mi>j</mml:mi><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>. Therefore, we integrate over all possible <inline-formula><mml:math id="IM30" display="inline" overflow="scroll"><mml:msub><mml:mi>x</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula> to obtain,</p>
    <disp-formula id="M0001">
      <label>(1)</label>
      <mml:math id="M1" display="block" overflow="scroll">
        <mml:msub>
          <mml:mi>L</mml:mi>
          <mml:mi>i</mml:mi>
        </mml:msub>
        <mml:mo stretchy="false">(</mml:mo>
        <mml:mrow>
          <mml:msup>
            <mml:mi>σ</mml:mi>
            <mml:mn>2</mml:mn>
          </mml:msup>
          <mml:mrow>
            <mml:mo fence="false" stretchy="false">|</mml:mo>
          </mml:mrow>
          <mml:msub>
            <mml:mi>E</mml:mi>
            <mml:mrow>
              <mml:mi>i</mml:mi>
              <mml:mo fence="false" stretchy="false">{</mml:mo>
              <mml:mi>j</mml:mi>
              <mml:mo fence="false" stretchy="false">}</mml:mo>
            </mml:mrow>
          </mml:msub>
          <mml:mo>,</mml:mo>
          <mml:mi>T</mml:mi>
        </mml:mrow>
        <mml:mo stretchy="false">)</mml:mo>
        <mml:mo>=</mml:mo>
        <mml:mo largeop="false">∫</mml:mo>
        <mml:msub>
          <mml:mi>L</mml:mi>
          <mml:mi>i</mml:mi>
        </mml:msub>
        <mml:mo stretchy="false">(</mml:mo>
        <mml:mrow>
          <mml:msup>
            <mml:mi>σ</mml:mi>
            <mml:mn>2</mml:mn>
          </mml:msup>
          <mml:mrow>
            <mml:mo fence="false" stretchy="false">|</mml:mo>
          </mml:mrow>
          <mml:msub>
            <mml:mi>E</mml:mi>
            <mml:mrow>
              <mml:mi>i</mml:mi>
              <mml:mo fence="false" stretchy="false">{</mml:mo>
              <mml:mi>j</mml:mi>
              <mml:mo fence="false" stretchy="false">}</mml:mo>
            </mml:mrow>
          </mml:msub>
          <mml:mo>,</mml:mo>
          <mml:mi>T</mml:mi>
          <mml:mo>,</mml:mo>
          <mml:msub>
            <mml:mi>x</mml:mi>
            <mml:mi>R</mml:mi>
          </mml:msub>
        </mml:mrow>
        <mml:mo stretchy="false">)</mml:mo>
        <mml:mi>ρ</mml:mi>
        <mml:mo stretchy="false">(</mml:mo>
        <mml:mrow>
          <mml:msub>
            <mml:mi>x</mml:mi>
            <mml:mi>R</mml:mi>
          </mml:msub>
        </mml:mrow>
        <mml:mo stretchy="false">)</mml:mo>
        <mml:mi>d</mml:mi>
        <mml:msub>
          <mml:mi>x</mml:mi>
          <mml:mi>R</mml:mi>
        </mml:msub>
        <mml:mo>,</mml:mo>
      </mml:math>
    </disp-formula>
    <p>where <inline-formula><mml:math id="IM31" display="inline" overflow="scroll"><mml:mi>ρ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is the prior distribution for the root value of a randomly selected gene.</p>
    <p>The default prior <inline-formula><mml:math id="IM32" display="inline" overflow="scroll"><mml:mi>ρ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is assumed to be a gamma distribution with <inline-formula><mml:math id="IM33" display="inline" overflow="scroll"><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0.375</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="IM34" display="inline" overflow="scroll"><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>1600</mml:mn></mml:math></inline-formula>, though this distribution can also be set by the user in CAGEE. This choice is based on estimated expression distributions across genes in individual species, which we take as our baseline for the ancestral distribution. CAGEE uses the Nelder–Mead simplex method to find the optimal value(s) of <inline-formula><mml:math id="IM35" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>.</p>
  </sec>
  <sec sec-type="results" id="msad106-s2">
    <title>Results</title>
    <sec id="msad106-s2.1">
      <title>Using CAGEE</title>
      <p>The required inputs for CAGEE are a Newick-formatted, rooted, ultrametric tree (with branch lengths) and a tab-delimited data file containing the expression levels of all species or taxa being studied. The data file can consist of data on one gene/transcript or thousands of different genes. The first line of the data file should contain the species’ names (matching those used in the Newick tree). In addition, headers for gene names, gene descriptions, and sample IDs (see next section for an explanation of “samples” in CAGEE) can be used. Subsequent lines each correspond to a single gene and contain expression levels for each species. Missing data can be denoted using multiple characters (-/?/N). Examples of Newick trees and corresponding data files can be found in the online user manual (<ext-link xlink:href="https://github.com/hahnlab/CAGEE/blob/main/docs/manual/troubleshooting_and_technical.md" ext-link-type="uri">https://github.com/hahnlab/CAGEE/blob/main/docs/manual/troubleshooting_and_technical.md</ext-link>).</p>
      <p>We expect that CAGEE will most often be used to calculate the following outputs: one or more <inline-formula><mml:math id="IM36" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> values, ancestral states at each internal node (including 95% credible intervals around these states), and the final likelihood associated with a model. However, users do not have to search for <inline-formula><mml:math id="IM37" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>: if a value for this parameter is specified, then the output of CAGEE will just be the ancestral states and a likelihood. In addition to the raw outputs provided in multiple formats (both tab-delimited files and NEXUS-formatted files), CAGEE computes basic statistics about changes in expression levels by comparing values at parent and child nodes. Summaries of these inferred changes for every gene and for every branch of the tree are output, so that the evolutionary history of gene expression changes in every gene is accessible to users. To avoid overinterpretation of small changes in inferred expression levels—especially when there is uncertainty in ancestral states—CAGEE will also compare the credible intervals at parent and child nodes to note if a change is “credible” (i.e., the intervals do not overlap). Credible intervals are calculated by summing the probabilities across possible ancestral states at each node, so that 95% of the probability density is included. Credible changes on each branch are annotated as such in the output.</p>
      <p>We most often expect that an ultrametric species tree will be used as the input topology, but this is not required by CAGEE. If users wish to specify a gene tree, or some other bifurcating tree, as input, those can be used in CAGEE as well. However, the major advantage of CAGEE—incorporating information from multiple genes to accurately estimate genome-wide rates—will rapidly diminish for trees that represent the history of only a minority of the genome. Trees that include duplication events should provide suitable estimates for any genes that follow this topology, but CAGEE does not have a way to further combine disparate gene trees.</p>
      <p>There are multiple options available for running CAGEE. Users who can take advantage of multiple threads can specify the number to use on the command line. Complex models can also take a long time to converge; by default, CAGEE runs a maximum of 300 iterations of the Nelder–Mead search, but users can increase this number in subsequent runs if the likelihood is still improving when the limit is hit. As mentioned above, the default prior distribution for the root state is a gamma distribution with <inline-formula><mml:math id="IM38" display="inline" overflow="scroll"><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0.375</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="IM39" display="inline" overflow="scroll"><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>1600</mml:mn></mml:math></inline-formula>. This distribution can also be specified by the user if desired. Information on how to run more complex evolutionary models, beyond a single <inline-formula><mml:math id="IM40" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>, is given in the next section.</p>
    </sec>
    <sec id="msad106-s2.2">
      <title>Estimating Evolutionary Rates in CAGEE</title>
      <p>We tested CAGEE's ability to accurately estimate <inline-formula><mml:math id="IM41" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> by varying this rate parameter and the number of genes used for inference, as well as the amount of missing data in each data set. We simulated different single values of <inline-formula><mml:math id="IM42" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> across a tree with constant branch lengths (<xref rid="sup1" ref-type="supplementary-material">supplementary fig. S1, Supplementary Material</xref> online) using the simulation tool available within CAGEE. (Note that the total amount of evolution in a tree is determined by the product <inline-formula><mml:math id="IM43" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⋅</mml:mo><mml:mi>t</mml:mi></mml:math></inline-formula>, such that changes in branch lengths will have an effect commensurate with changes in <inline-formula><mml:math id="IM44" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>.) <xref rid="msad106-F2" ref-type="fig">Figure 2</xref> shows the average error associated with estimates of different <inline-formula><mml:math id="IM45" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> values and using different numbers of genes within each data set. As can be seen, the error across all parameter values and data set sizes is quite small (generally &lt;2.5%) and is less variable for larger data set sizes. Fortunately, we expect that most empirical data sets will contain closer to 10,000 genes than 1,000 genes. The results in <xref rid="msad106-F2" ref-type="fig">figure 2</xref> are for an ancestral state vector of length <italic toggle="yes">N</italic> = 200 (the default setting in CAGEE; Materials and Methods); we also estimated <inline-formula><mml:math id="IM46" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> when allowing the ancestral state vector to have length <italic toggle="yes">N</italic> = 500 (<xref rid="sup1" ref-type="supplementary-material">supplementary fig. S2</xref><italic toggle="yes"><xref rid="sup1" ref-type="supplementary-material">A</xref></italic><xref rid="sup1" ref-type="supplementary-material">, Supplementary Material</xref> online). There appears to be minimal gain from increasing the resolution in this vector, though the computational time is greatly increased (similar to results in <xref rid="msad106-B7" ref-type="bibr">Boucher and Démery 2016</xref>). We evaluated the accuracy of CAGEE when different amounts of data were randomly missing: from 0% to 75% for a data set of 1,000 genes. As shown in <xref rid="sup1" ref-type="supplementary-material">supplementary figure S2</xref><italic toggle="yes"><xref rid="sup1" ref-type="supplementary-material">B</xref></italic><xref rid="sup1" ref-type="supplementary-material">, Supplementary Material</xref> online, CAGEE has high accuracy even when large amounts of data are missing (at random) from a data set.</p>
      <fig position="float" id="msad106-F2" fig-type="figure">
        <label><sc>Fig.</sc> 2.</label>
        <caption>
          <p>Accuracy of CAGEE. For five different values of <inline-formula><mml:math id="IM47" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>, we simulated 1,000 data sets, with each data set comprised of either 1,000 genes or 10,000 genes. All genes in a data set shared the same <inline-formula><mml:math id="IM48" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>, but their values at the root were drawn independently from the prior. We then provided each simulated data set to CAGEE in order to infer <inline-formula><mml:math id="IM49" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>. Each box-and-whisker plot shows the mean (horizontal line), 50% interquartile range (box), 1.5 × the interquartile range (vertical lines), and outliers (dots).</p>
        </caption>
        <graphic xlink:href="msad106f2" position="float"/>
      </fig>
      <p>One major advantage of using CAGEE is that it combines information from multiple genes to infer a rate of evolution: This is why it can return estimates with high accuracy even when a large fraction of the data are missing. To further demonstrate this advantage, we simulated evolution in 1,000 genes using the same parameter value (<inline-formula><mml:math id="IM50" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> = 1) and then estimated <inline-formula><mml:math id="IM51" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> for each of the 1,000 genes individually. <xref rid="sup1" ref-type="supplementary-material">Supplementary figure S2</xref><italic toggle="yes"><xref rid="sup1" ref-type="supplementary-material">C</xref></italic><xref rid="sup1" ref-type="supplementary-material">, Supplementary Material</xref> online, shows that these individual estimates of <inline-formula><mml:math id="IM52" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> are quite error-prone: although the mean of all genes is close to the true value, individual estimates can be 7–8 × higher or lower, and there is a large amount of variance. Although we have not shown it here, we do expect that the accuracy of <inline-formula><mml:math id="IM53" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> will be greater for trees with larger numbers of tips, even for estimates derived from single genes (cf. <xref rid="msad106-B56" ref-type="bibr">O’Meara et al. 2006</xref>). On the other hand, CAGEE is combining information from multiple genes to infer an average rate of evolution, even when the underlying rate may be quite variable. To explore any effect of underlying rate variation, we carried out further simulations that combined 3 simulations of 1,000 genes each with <inline-formula><mml:math id="IM54" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> equal to 0.5, 3, and 9, respectively (we repeated these simulations 10 times). When analyzed as single data sets with 3,000 genes total, the average <inline-formula><mml:math id="IM55" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> inferred was 3.76, ∼9% lower than the arithmetic mean rate (<xref rid="sup1" ref-type="supplementary-material">supplementary fig. S2</xref><italic toggle="yes"><xref rid="sup1" ref-type="supplementary-material">D</xref></italic><xref rid="sup1" ref-type="supplementary-material">, Supplementary Material</xref> online). It is well-known that single-rate phylogenetic likelihood models tend to underestimate rates of evolution when there is underlying variation (<xref rid="msad106-B30" ref-type="bibr">Golding 1983</xref>; <xref rid="msad106-B28" ref-type="bibr">Gillespie 1986</xref>; <xref rid="msad106-B76" ref-type="bibr">Yang 1996</xref>; <xref rid="msad106-B52" ref-type="bibr">Mendes et al. 2020</xref>), and we see this effect here. Fortunately, the bias is small and can be corrected in the future by including gamma-distributed rate variation into CAGEE. Overall, inferences of <inline-formula><mml:math id="IM56" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> should be quite accurate when a single rate parameter is shared across the tree and across all genes and lineages.</p>
      <p>Variation in the rate of expression can currently be accommodated by CAGEE in a number of ways, using multi-rate <inline-formula><mml:math id="IM57" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> models. One type of model allows users to specify that their data come from different “samples”: these samples can represent tissues, conditions, timepoints, and even subsets of the genome (e.g., the X chromosome or a specific functional class of genes). In the input data file, the “SAMPLETYPE” column is used to indicate which sample each gene is a member of; a separate <inline-formula><mml:math id="IM58" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> value will be calculated for each sample or set of samples (these values are assumed to be shared among all lineages in the tree). Specifying more than one sample means that an individual gene or transcript name can be used more than once (i.e., once for each sample), but there is no requirement that genes are measured in each sample. For instance, assigning all autosomal genes to sample 1 and all X-linked genes to sample 2 would not permit for any overlap in gene assignment but is perfectly allowable in CAGEE.</p>
      <p>Each additional sample requires another <inline-formula><mml:math id="IM59" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> parameter to be estimated, and often researchers would like to know if fitting this extra parameter is justified by the data. Under standard information–theoretic criteria (<xref rid="msad106-B11" ref-type="bibr">Burnham and Anderson 2002</xref>), twice the difference in log likelihoods between nested models should be χ<sup>2</sup>-distributed with degrees of freedom equal to the difference in the number of parameters between models. To test this expectation, we simulated 1,000 data sets with a single <inline-formula><mml:math id="IM60" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> value but fit models with two <inline-formula><mml:math id="IM61" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> values (assigning 1,000 genes to two equal-sized samples at random; the relative size of the samples should not affect the false positive rate). As anticipated, the results fit a χ<sup>2</sup> distribution with one degree of freedom, with 4.4% of data sets having a difference in 2*log-likelihood &gt;3.84 (5% are expected by chance). This indicates that standard statistical procedures should adequately control the false positive rate when fitting multi-sample <inline-formula><mml:math id="IM62" display="inline" overflow="scroll"><mml:mspace width="0.25em"/><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> models.</p>
      <p>CAGEE also allows models in which <inline-formula><mml:math id="IM63" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> varies across branches of the species tree. It does so by fitting separate <inline-formula><mml:math id="IM64" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> parameters for different parts of the tree. On the command line, CAGEE enables users to specify how multiple <inline-formula><mml:math id="IM65" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> parameters should be assigned to branches. For <italic toggle="yes">n</italic> taxa, from 1 to 2<italic toggle="yes">n</italic>-2 parameters can be specified, and branches can be grouped together in any way. For instance, a two-parameter model can have all branches that share a rate adjacent to one another in the tree (<xref rid="sup1" ref-type="supplementary-material">supplementary fig. S3</xref><italic toggle="yes"><xref rid="sup1" ref-type="supplementary-material">A</xref></italic><xref rid="sup1" ref-type="supplementary-material">, Supplementary Material</xref> online) or spread out across the tree (<xref rid="sup1" ref-type="supplementary-material">supplementary fig. S3</xref><italic toggle="yes"><xref rid="sup1" ref-type="supplementary-material">B</xref></italic><xref rid="sup1" ref-type="supplementary-material">, Supplementary Material</xref> online). Similar to the analyses carried out above for the false positive rate associated with multiple samples, we simulated data with a single <inline-formula><mml:math id="IM66" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> value and then fit models with multiple <inline-formula><mml:math id="IM67" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> parameters. Regardless of how we distributed the two rate classes across the tree, we observed good control of the false positive rate: 4.5% and 5.4% of 1,000 simulated data sets were significant at the <italic toggle="yes">P</italic> = 0.05 level (for the trees shown in <xref rid="sup1" ref-type="supplementary-material">supplementary fig. S3</xref><italic toggle="yes"><xref rid="sup1" ref-type="supplementary-material">A</xref></italic><xref rid="sup1" ref-type="supplementary-material">and</xref><italic toggle="yes"><xref rid="sup1" ref-type="supplementary-material">B</xref></italic><xref rid="sup1" ref-type="supplementary-material">, Supplementary Material</xref> online, respectively). More limited simulations also showed that we could accurately estimate multiple <inline-formula><mml:math id="IM68" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> parameters when the data were simulated with multiple rates (<xref rid="sup1" ref-type="supplementary-material">supplementary table S1, Supplementary Material</xref> online). Together, our results suggest that we can estimate multiple types of multi-rate models and can accurately control the false positive rate when doing so.</p>
    </sec>
    <sec id="msad106-s2.3">
      <title>Analysis of Wild Tomato Transcriptome Data</title>
      <p>To demonstrate the utility of CAGEE in an empirical system, we analyzed data from a clade that includes domesticated tomato, <italic toggle="yes">Solanum lycopersicum</italic>. This data set contains gene expression levels in unfertilized ovules from the flowers of six species, one of which (<italic toggle="yes">Solanum pennellii</italic>) has two different populations represented (<xref rid="msad106-F3" ref-type="fig">fig. 3</xref>). There are 14,556 genes with expression levels measured in all 7 accessions. RNA-seq data for five of the seven accessions have been published previously (<xref rid="msad106-B41" ref-type="bibr">Hibbins and Hahn 2021</xref>; <xref rid="msad106-B55" ref-type="bibr">Moyle et al. 2021</xref>), whereas two others are presented here for the first time (Materials and Methods). Note, however, that all data were collected from all samples at the same time (Materials and Methods).</p>
      <fig position="float" id="msad106-F3" fig-type="figure">
        <label><sc>Fig.</sc> 3.</label>
        <caption>
          <p>Changes in gene expression along the tomato phylogeny. Given the set of relationships among the seven <italic toggle="yes">Solanum</italic> accessions used here, we tested multiple models that had branches assigned as different <inline-formula><mml:math id="IM69" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> parameters (<xref rid="msad106-T1" ref-type="table">table 1</xref>). In model A, all branches share <inline-formula><mml:math id="IM70" display="inline" overflow="scroll"><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>. In model B, all black branches share <inline-formula><mml:math id="IM71" display="inline" overflow="scroll"><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>, whereas all red branches share <inline-formula><mml:math id="IM72" display="inline" overflow="scroll"><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>. In model C, all black branches and the dashed red branch share <inline-formula><mml:math id="IM73" display="inline" overflow="scroll"><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>, whereas all solid red branches share <inline-formula><mml:math id="IM74" display="inline" overflow="scroll"><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>. In model D, all black branches share <inline-formula><mml:math id="IM75" display="inline" overflow="scroll"><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>, all solid red branches share <inline-formula><mml:math id="IM76" display="inline" overflow="scroll"><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>, and the dashed red branch is assigned <inline-formula><mml:math id="IM77" display="inline" overflow="scroll"><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>. Using the results from model D, we inferred the number of genes that had credible increases or decreases in expression level along each branch (results for all changes are shown in <xref rid="sup1" ref-type="supplementary-material">supplementary fig. S4, Supplementary Material</xref> online). Numbers are reported as +increases/−decreases for each branch.</p>
        </caption>
        <graphic xlink:href="msad106f3" position="float"/>
      </fig>
      <p>Most species within the tomato clade are self-incompatible (SI), the ancestral state in the family Solanaceae (<xref rid="msad106-B45" ref-type="bibr">Igić et al. 2006</xref>). Self-incompatibility means that plants must outcross in order to successfully fertilize ovules. However, self-compatibility (SC) has evolved multiple times both within the Solanaceae and within the genus <italic toggle="yes">Solanum</italic> (<xref rid="msad106-B29" ref-type="bibr">Goldberg et al. 2010</xref>; <xref rid="msad106-B4" ref-type="bibr">Bedinger et al. 2011</xref>). Self-compatible individuals are able to successfully fertilize ovules using their own pollen, though many also still outcross (<xref rid="msad106-B73" ref-type="bibr">Whitehead et al 2018</xref>; including in <italic toggle="yes">Solanum</italic>: <xref rid="msad106-B70" ref-type="bibr">Vosters et al. 2014</xref> and references therein). Importantly, we have a priori expectations about the rate at which reproductive traits—including ovule gene expression—might evolve between groups with different mating systems. Due to conflict within and between the sexes, it is generally expected that reproductive traits in species that outcross more (i.e., SI taxa) should evolve more rapidly than in species that inbreed more (i.e., SC taxa; <xref rid="msad106-B16" ref-type="bibr">Clark et al. 2006</xref>). Such patterns are found in some analyses of the rate of protein evolution (e.g., <xref rid="msad106-B31" ref-type="bibr">Gossmann et al. 2016</xref>; <xref rid="msad106-B39" ref-type="bibr">Harrison et al. 2019</xref>) but are equivocal in other comparisons (e.g., <xref rid="msad106-B32" ref-type="bibr">Gossmann et al. 2014</xref>, <xref rid="msad106-B55" ref-type="bibr">Moyle et al. 2021</xref>). These complex patterns might reflect additional effects that also accompany mating system shifts; for instance, such shifts often lead to reductions in effective population size in more selfing lineages (<xref rid="msad106-B14" ref-type="bibr">Charlesworth and Wright 2001</xref>). Mating system shifts could also alter global patterns of molecular evolution (including gene expression) by changing the strength and pattern of purifying selection, as morphological changes often accompany mating system changes. The exact effect of shifts in mating system on molecular evolution remains an open question.</p>
      <p>The <italic toggle="yes">Solanum</italic> species sampled here represent two independent transitions from SI to SC, with one of the transitions (in accession <italic toggle="yes">S. pennellii</italic> LA0716) occurring recently enough that different populations within this species have different incompatibility systems (<xref rid="msad106-F3" ref-type="fig">fig. 3</xref>). We therefore fit a series of nested models within CAGEE to test two related hypotheses about ovule gene expression evolution. First, we would like to know whether the rate of evolution of ovule gene expression is different in SI species than in SC species. Second, given the recent transition to SC within accession <italic toggle="yes">S. pennellii</italic> LA0716, we wanted to know if it shows a pattern of evolution more similar to SI or to SC species. In total, we fit four separate evolutionary models (<xref rid="msad106-T1" ref-type="table">table 1</xref> and <xref rid="msad106-F3" ref-type="fig">fig. 3</xref>). Model A has a single rate parameter for the entire tree. Model B has two rate parameters, one for SI species and one for SC species. This model assigns the branch leading to <italic toggle="yes">S. pennellii</italic> LA0716 as SC. Model C also has two rate parameters, one for SI and one for SC, but assigns <italic toggle="yes">S. pennellii</italic> LA0716 as SI. Model D has three rate parameters: one for SI species, one for longer-term SC species, and one for <italic toggle="yes">S. pennellii</italic> LA0716.</p>
      <table-wrap position="float" id="msad106-T1">
        <label>Table 1.</label>
        <caption>
          <p>Model Parameters Estimated from the Tomato Data.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Model</th>
              <th align="center" rowspan="1" colspan="1">Number of rates</th>
              <th align="center" rowspan="1" colspan="1">−ln <italic toggle="yes">L</italic></th>
              <th align="center" rowspan="1" colspan="1">σ<sup>2</sup><sub>1</sub></th>
              <th align="center" rowspan="1" colspan="1">σ<sup>2</sup><sub>2</sub></th>
              <th align="center" rowspan="1" colspan="1">σ<sup>2</sup><sub>3</sub></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">A</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">67,252.4</td>
              <td rowspan="1" colspan="1">0.102</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">B</td>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">65,883.9</td>
              <td rowspan="1" colspan="1">0.074</td>
              <td rowspan="1" colspan="1">0.134</td>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">C</td>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">65,124.5</td>
              <td rowspan="1" colspan="1">0.075</td>
              <td rowspan="1" colspan="1">0.152</td>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">D</td>
              <td rowspan="1" colspan="1">3</td>
              <td rowspan="1" colspan="1">65,108.6</td>
              <td rowspan="1" colspan="1">0.077</td>
              <td rowspan="1" colspan="1">0.152</td>
              <td rowspan="1" colspan="1">0.067</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>Estimated results from the different models are shown in <xref rid="msad106-T1" ref-type="table">table 1</xref>. Model A has a worse fit than any other model, with a single <inline-formula><mml:math id="IM78" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> value of 0.102. For context, this value means that the BBM process the data are fit to has a variance of 0.102 per million years (of log-transformed expression values). This is the average rate across all 14,556 genes and across all branches of the tree. In contrast to a single-rate model, both models B and C are significantly better fits to the data. Contrary to some hypotheses, both models find that SI lineages (<inline-formula><mml:math id="IM79" display="inline" overflow="scroll"><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>) have a lower rate of evolution than SC lineages (<inline-formula><mml:math id="IM80" display="inline" overflow="scroll"><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>; <xref rid="msad106-T1" ref-type="table">table 1</xref>). There is also a difference between the models, with model C (the one in which <italic toggle="yes">S. pennellii</italic> LA0716 shares a rate with SI species) fitting significantly better. To further examine the evolution of <italic toggle="yes">S. pennellii</italic> LA0716, model D fits a three-parameter model, with this lineage assigned its own rate of evolution. This model is a significantly better fit than model C (<italic toggle="yes">P</italic> &lt; 0.00001; χ<sup>2</sup> test with 1 degree of freedom) and demonstrates that <italic toggle="yes">S. pennellii</italic> LA0716 has a rate of evolution (<inline-formula><mml:math id="IM81" display="inline" overflow="scroll"><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> in <xref rid="msad106-T1" ref-type="table">table 1</xref>) that is slightly lower than other SI species. This highly similar rate to SI species implies that it has only recently transitioned to SC, which is consistent with previous inferences about the timing of transition to SC in this particular accession (e.g., <xref rid="msad106-B62" ref-type="bibr">Rick and Tanksley 1981</xref>).</p>
      <p>CAGEE also allows users to infer the number and direction of changes in gene expression levels along each branch of the tree. <xref rid="msad106-F3" ref-type="fig">Figure 3</xref> reports the number of genes that had “credible” increases and decreases in expression level under model D. Credible changes require that the credible intervals around states at parent and daughter nodes do not overlap, in order to account for uncertainty in our inferences. However, because of this, fewer credible changes will be inferred deeper in the tree, where credible intervals get wider. Therefore, although inferences about the identity of the genes changing along each branch are greatly strengthened by using credible changes (these genes are noted in the raw output from CAGEE), the absolute numbers of credible changes cannot be compared across branches, except for sister branches of equal length. For completeness, we show the total numbers of increases and decreases of gene expression in <xref rid="sup1" ref-type="supplementary-material">supplementary figure S4, Supplementary Material</xref> online; as expected, these total numbers are more uniformly distributed across older and younger branches.</p>
      <p>We assessed whether the genes identified as having credible increases or decreases in expression specifically on any SC branch (solid red branches in <xref rid="msad106-F3" ref-type="fig">fig. 3</xref>) were significantly enriched for any biological process or molecular function gene ontology (GO) categories compared with genes with credible changes on any SI branch (black branches in <xref rid="msad106-F3" ref-type="fig">fig. 3</xref>). This comparison specifically assesses gene expression evolution associated with a transition to SC, over and above “background” rates of expression evolution across the rest of the clade. Although fold enrichment was modest 1.20–1.36X (<xref rid="sup1" ref-type="supplementary-material">supplementary table S2, Supplementary Material</xref> online), there were 11 terms significantly enriched (false discovery rate [FDR] &lt; 0.05) specifically on SC branches; these terms primarily focused on regulation of transcription, metabolic processes, and biosynthesis (<xref rid="sup1" ref-type="supplementary-material">supplementary table S2, Supplementary Material</xref> online). Among the genes in these overrepresented categories, a large fraction are transcription factors associated with development (e.g., WRKY and MADS-box), hormonal responses (including ethylene- and auxin-responsive transcription factors), and regulation of cell cycle (e.g., cyclins), in addition to protein kinases (<xref rid="sup1" ref-type="supplementary-material">supplementary table S2, Supplementary Material</xref> online). This enrichment is consistent with increased expression changes in genes involved in cell division, differentiation, and development that could follow transitions to SC.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="msad106-s3">
    <title>Discussion</title>
    <p>Here, we have developed a new software package that enables the estimation of rates of gene expression evolution across a tree, CAGEE. Gene expression levels are much like many other continuous traits, and multiple papers have introduced phylogenetic comparative methods for studying gene expression (<xref rid="msad106-B3" ref-type="bibr">Bedford and Hartl 2009</xref>; <xref rid="msad106-B64" ref-type="bibr">Rohlfs et al. 2014</xref>; <xref rid="msad106-B65" ref-type="bibr">Rohlfs and Nielsen 2015</xref>; <xref rid="msad106-B13" ref-type="bibr">Catalán et al. 2019</xref>; <xref rid="msad106-B15" ref-type="bibr">Chen et al. 2019</xref>). However, as far as we are aware, none of these methods allows genes to share evolutionary parameters, which precludes the analysis of genome-wide trends, either along the branches of a tree or between tissues/samples/conditions. To overcome this limitation, CAGEE calculates the likelihood of the data using the pruning algorithm (<xref rid="msad106-B24" ref-type="bibr">Felsenstein 1973</xref>) to facilitate the sharing of evolutionary parameters along branches of the species tree, providing more statistical power to test evolutionary hypotheses. Fortunately, we were able to take advantage of much of the codebase of our existing software, CAFE (<xref rid="msad106-B34" ref-type="bibr">Hahn et al. 2005</xref>, <xref rid="msad106-B35" ref-type="bibr">2007</xref>; <xref rid="msad106-B19" ref-type="bibr">De Bie et al. 2006</xref>; <xref rid="msad106-B38" ref-type="bibr">Han et al. 2013</xref>; <xref rid="msad106-B52" ref-type="bibr">Mendes et al. 2020</xref>), which implements the pruning algorithm for the analysis of gene family sizes across a tree. Although gene expression levels and gene family sizes differ in the type of data they represent (continuous vs. discrete) and their underlying evolutionary models (BBM vs. birth-death), many of the required likelihood calculations and software components are the same.</p>
    <p>An important thing to consider for the input to CAGEE is the normalization used to make gene expression levels comparable across species. The data from wild tomatoes used here were normalized using <sans-serif>transcripts per million (TPM;</sans-serif><xref rid="msad106-B71" ref-type="bibr">Wagner et al. 2012</xref><sans-serif>)</sans-serif>; other published data sets also use this normalization (<xref rid="msad106-B5" ref-type="bibr">Berthelot et al. 2018</xref>; <xref rid="msad106-B15" ref-type="bibr">Chen et al. 2019</xref>; <xref rid="msad106-B21" ref-type="bibr">El Taher et al. 2021</xref>). However, multiple other normalizations have also been used in comparative analyses, including reads per kilobase of transcript per million mapped reads (RPKM) (<xref rid="msad106-B9" ref-type="bibr">Brawand et al. 2011</xref>), fragments per kilobase of transcript per million mapped fragments (FPKM) (<xref rid="msad106-B13" ref-type="bibr">Catalán et al. 2019</xref>), and both trimmed mean of <italic toggle="yes">M</italic> values (TMM) and counts per million (CPM) (<xref rid="msad106-B6" ref-type="bibr">Blake et al. 2020</xref>). Each normalization approach has its advantages and disadvantages, and we cannot yet strongly recommend one specific approach as input to CAGEE. The normalization method used will likely depend on the conditions under which samples are collected: if all species can be raised simultaneously in a greenhouse, vivarium, or growth chamber, we expect many fewer batch effects than in samples collected from the field, which will therefore necessitate different normalizations. However, even animals raised in a common environment—but fed different diets—can show many differences in gene expression not due to heritable change (e.g., <xref rid="msad106-B67" ref-type="bibr">Somel et al. 2008</xref>). Conversely, many between-sample normalization approaches (e.g., TMM; <xref rid="msad106-B63" ref-type="bibr">Robinson and Oshlack 2010</xref>) make the assumption that differences in gene expression between samples are rare. Although such normalization is sensible in the context of testing for differential expression between samples from the same species, for a set of species that have been evolving independently for millions of years this is likely not an appropriate assumption.</p>
    <p>CAGEE currently has multiple limitations, both in the available models that can be applied and in the types of data that can be analyzed. As mentioned earlier, many researchers have modeled gene expression using an OU process <sans-serif>(</sans-serif><xref rid="msad106-B3" ref-type="bibr">Bedford and Hartl 2009</xref><sans-serif>;</sans-serif><xref rid="msad106-B64" ref-type="bibr">Rohlfs et al. 2014</xref><sans-serif>;</sans-serif><xref rid="msad106-B15" ref-type="bibr">Chen et al. 2019</xref><sans-serif>;</sans-serif><xref rid="msad106-B77" ref-type="bibr">Yang et al. 2019</xref><sans-serif>). Although OU models may be artifactually preferred over unbounded Brownian motion models due to a number of nonbiological factors (see discussion in New Approaches), it would still be helpful to be able to compare such a model with the BBM model used here. However, fitting such a model to genome-wide data is nontrivial: each gene must have its own mean expression value</sans-serif> (<italic toggle="yes">μ</italic><sans-serif>) but possibly shared constraint parameters</sans-serif> (<italic toggle="yes">α</italic><sans-serif>) across genes. We have the goal of implementing such a model in the near future, as well as other models commonly used in comparative methods research (e.g.,</sans-serif><xref rid="msad106-B47" ref-type="bibr">Landis and Schraiber 2017</xref><sans-serif>;</sans-serif><xref rid="msad106-B8" ref-type="bibr">Boucher et al. 2018</xref><sans-serif>). Implementation of multiple models will not only allow for the analysis of different types of traits—each of which may be evolving under different regimes—but will also allow users to test the sensitivity of their analyses to model choice. For instance, it is not currently clear how different the inferred ancestral states or rates of evolution will be under different models (e.g., BBM vs. OU) and therefore how different the conclusions drawn from any such analyses might be. Ideally, qualitative results will be similar, even when there are slight quantitative differences.</sans-serif></p>
    <p>Beyond the evolutionary model applied to any data set, there are multiple additional sources of variation that could be modeled. For instance, we have previously accounted for measurement error in a likelihood framework, using an empirically parameterized error model (<xref rid="msad106-B38" ref-type="bibr">Han et al. 2013</xref>). We can imagine both applying a similar model here to RNA-seq data, as well as extending CAGEE to more error-prone data such as single-cell sequencing. Such an extension would treat the level of expression in each cell within a cell type as an error-prone draw from an underlying distribution; one would then be able to infer the rate of evolution within and across cell types across multiple species. The biggest obstacle to this approach may be in identifying homologous cell types across species (e.g., <xref rid="msad106-B69" ref-type="bibr">Tarashansky et al. 2021</xref>). In addition, not all genes necessarily share the same average rate of evolution; gamma-distributed rate categories can be used to model this variation among genes (cf. <xref rid="msad106-B1" ref-type="bibr">Ames et al. 2012</xref>; <xref rid="msad106-B52" ref-type="bibr">Mendes et al. 2020</xref>). As shown above, not accounting for this rate variation leads to a slight underestimate of <inline-formula><mml:math id="IM82" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> but also obscures interesting patterns of evolution among genes. Finally, the gene tree discordance found in many phylogenomic data sets implies that complex traits (such as expression levels) will also be controlled by discordant gene trees (<xref rid="msad106-B36" ref-type="bibr">Hahn and Nakhleh 2016</xref>; <xref rid="msad106-B41" ref-type="bibr">Hibbins and Hahn 2021</xref>). This underlying discordance can cause evolutionary rates to be overestimated (<xref rid="msad106-B51" ref-type="bibr">Mendes et al. 2018</xref>) and should be taken into account when seeking accurate parameter estimates (see discussion of wild tomato data below). Our goal is to include methods for dealing with all these sources of variation in future versions of CAGEE.</p>
    <p>In terms of the types of data that can be analyzed, at present, CAGEE is limited to positive, continuously varying traits (i.e., the BBM model). However, we also envision different ways to represent and model gene expression data, including as a ratio (e.g., male/female expression). Such a ratio, after log2-transformation, would be most appropriately modeled by an unbounded Brownian motion model since both negative and positive values are possible. This and other data types will be supported in future releases. Moreover, CAGEE does not have to analyze whole-genome or even molecular data: it can be applied to any single trait for which the BBM model is appropriate, even morphological traits. One intriguing application of CAGEE could be to suites of morphological traits that are hypothesized to share a common evolutionary rate parameter. If, for instance, there is a shift in body plan along some lineages, then multiple traits may all increase or decrease their rate of evolution at once, and CAGEE can be used to estimate these shared parameters. Even in the context of single-trait analyses, the pruning algorithm has been hailed as a solution for large-scale comparative analyses (<xref rid="msad106-B26" ref-type="bibr">Freckleton 2012</xref>). Importantly, the number of branches in a rooted, bifurcating tree with <italic toggle="yes">n</italic> tips is 2<italic toggle="yes">n</italic>-2, so that the number of calculations scales linearly with the number of species. This makes the pruning algorithm ideal for comparative data sets with large numbers of taxa (e.g., <xref rid="msad106-B34" ref-type="bibr">Hahn et al. 2005</xref>; <xref rid="msad106-B25" ref-type="bibr">FitzJohn 2012</xref>; <xref rid="msad106-B43" ref-type="bibr">Hiscott et al. 2016</xref>; <xref rid="msad106-B12" ref-type="bibr">Caetano and Harmon 2018</xref>; <xref rid="msad106-B54" ref-type="bibr">Mitov et al. 2020</xref>).</p>
    <p>The analysis of data from a clade of wild tomatoes revealed a possibly unexpected result: the rate of ovule gene expression evolution among SC species is twice as high as the rate among SI species (<xref rid="msad106-T1" ref-type="table">table 1</xref>). This finding is contrary to some prior expectations—informed by research focused on male–female interactions, especially between interacting proteins in the reproductive tract (e.g., <xref rid="msad106-B68" ref-type="bibr">Swanson and Vacquier 2002</xref>; <xref rid="msad106-B16" ref-type="bibr">Clark et al. 2006</xref>)—that suggest that lineages might experience slower evolution after transitioning to SC. However, it is possible that global gene expression levels do not evolve in the same sort of tit-for-tat manner as interacting protein sequences, such that increases/decreases in male-expressed genes are not matched by increases/decreases in interacting female-expressed genes (or vice versa). Alternatively, only a very small subset of genes may evolve in this manner. Indeed, even prior studies comparing protein evolution have failed to find clear evidence of slower global evolutionary rates in more inbreeding species (e.g., <xref rid="msad106-B74" ref-type="bibr">Wong 2011</xref>). One caveat to the observed rate differences in our data is that underlying gene tree discordance, whether due to incomplete lineage sorting or introgression, can lead to artifactually higher rate estimates (<xref rid="msad106-B51" ref-type="bibr">Mendes et al. 2018</xref>; <xref rid="msad106-B41" ref-type="bibr">Hibbins and Hahn 2021</xref>). However, there is in fact less discordance among the SC lineages sampled here (<xref rid="msad106-B57" ref-type="bibr">Pease et al. 2016</xref>), which is the reverse of the pattern that would be required to explain our results.</p>
    <p>If not due to underlying bias in our estimates, these findings still raise the question: why is ovule gene expression evolving more rapidly in SC than SI species? One possibility is that this increased rate is due to a relaxation of selection in SC species, possibly because genes involved in male–female interactions are no longer needed. If this were the case, we might expect to see a general decrease in expression levels in SC species; however, there appears to be no consistent directionality to the changes along SC branches (<xref rid="msad106-F3" ref-type="fig">fig. 3</xref> and <xref rid="sup1" ref-type="supplementary-material">supplementary fig. S4, Supplementary Material</xref> online). Instead, an alternative hypothesis is that transitions to SC involve adaptation to new optima of ovule gene expression, compared with SI species that tend to maintain ancestral optima. For example, transitions to SC might favor greater investment in fewer ovules, because SC decreases the probability that each ovule within a flower will go unfertilized—an otherwise wasted investment under conditions (like SI) where receiving sufficient compatible pollen to fertilize each ovule is less predictable (<xref rid="msad106-B10" ref-type="bibr">Burd et al. 2009</xref>). The nature of these new optima might be even more complex, as traits like ovule size and number can vary with multiple reproductive and ecological conditions and often trade-off with each other (<xref rid="msad106-B33" ref-type="bibr">Greenway and Harder 2007</xref>). Of the species examine here, for example, two SC lineages (<italic toggle="yes">Solanum pimpinellifolium</italic> and <italic toggle="yes">Solanum lycopersicon</italic>—domesticated tomato) have significantly larger seeds than most of the SI lineages and SC <italic toggle="yes">S. pennellii</italic> (unpubl. data). Indeed, individual genes identified in our GO analysis are known to directly influence ovule and/or seed size in <italic toggle="yes">Solanum</italic> (e.g., <italic toggle="yes">NOR-like1</italic> [SOLYC07G063420.3.1; <xref rid="msad106-B37" ref-type="bibr">Han et al. 2014</xref>], <italic toggle="yes">GRAS2</italic> [SOLYC07G063940.2.1; <xref rid="msad106-B48" ref-type="bibr">Li et al. 2018</xref>], and <italic toggle="yes">CRY2</italic> [SOLYC09G090100.3.1; <xref rid="msad106-B22" ref-type="bibr">Fantini et al. 2019</xref>]). Some of our hypotheses could be evaluated with matching gene expression data from other (nonovule) reproductive tissues. Analyses including pollen in the same SI and SC lineages, and/or data addressing alternative constraints and conditions shaping ovule evolution including ovule size and number (e.g., <xref rid="msad106-B53" ref-type="bibr">Mione and Anderson 1992</xref>), would be useful in teasing apart these hypotheses.</p>
  </sec>
  <sec sec-type="materials|methods" id="msad106-s4">
    <title>Materials and Methods</title>
    <sec id="msad106-s4.1">
      <title>BBM Model of Expression Evolution</title>
      <p>
        <sans-serif>The probability density of expression,</sans-serif>
        <inline-formula>
          <mml:math id="IM83" display="inline" overflow="scroll">
            <mml:mi>p</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:mi>x</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>t</mml:mi>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
          </mml:math>
        </inline-formula>
        <sans-serif>, at time</sans-serif>
        <italic toggle="yes">t</italic>
        <sans-serif>for evolutionary trajectories following a Brownian motion process starting at value</sans-serif>
        <inline-formula>
          <mml:math id="IM84" display="inline" overflow="scroll">
            <mml:msub>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:msub>
                  <mml:mi>t</mml:mi>
                  <mml:mn>0</mml:mn>
                </mml:msub>
              </mml:mrow>
            </mml:msub>
          </mml:math>
        </inline-formula>
        <sans-serif>at time</sans-serif>
        <inline-formula>
          <mml:math id="IM85" display="inline" overflow="scroll">
            <mml:msub>
              <mml:mi>t</mml:mi>
              <mml:mn>0</mml:mn>
            </mml:msub>
          </mml:math>
        </inline-formula>
        <sans-serif>is governed by the diffusion equation:</sans-serif>
      </p>
      <disp-formula id="M0002">
        <label>(2)</label>
        <mml:math id="M2" display="block" overflow="scroll">
          <mml:mstyle displaystyle="true" scriptlevel="0">
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi mathvariant="normal">∂</mml:mi>
                  <mml:mi>p</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:mi>x</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>t</mml:mi>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">∂</mml:mi>
                  <mml:mi>t</mml:mi>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mstyle displaystyle="true" scriptlevel="0">
              <mml:mrow>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mi>σ</mml:mi>
                      <mml:mn>2</mml:mn>
                    </mml:msup>
                  </mml:mrow>
                  <mml:mn>2</mml:mn>
                </mml:mfrac>
              </mml:mrow>
              <mml:mstyle displaystyle="true" scriptlevel="0">
                <mml:mrow>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mi mathvariant="normal">∂</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msup>
                      <mml:mi>p</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:mi>x</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>t</mml:mi>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi mathvariant="normal">∂</mml:mi>
                      <mml:msup>
                        <mml:mi>x</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msup>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:mrow>
                <mml:mo>,</mml:mo>
              </mml:mstyle>
            </mml:mstyle>
          </mml:mstyle>
        </mml:math>
      </disp-formula>
      <p>with initial condition <inline-formula><mml:math id="IM86" display="inline" overflow="scroll"><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> where <inline-formula><mml:math id="IM87" display="inline" overflow="scroll"><mml:mi>δ</mml:mi></mml:math></inline-formula> is the Dirac delta function. The reflective boundary condition at <inline-formula><mml:math id="IM88" display="inline" overflow="scroll"><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula> implies that the probability fluxes into and out of the boundary are balanced, imposing the boundary condition:</p>
      <disp-formula id="M0003">
        <label>(3)</label>
        <mml:math id="M3" display="block" overflow="scroll">
          <mml:mstyle displaystyle="true" scriptlevel="0">
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi mathvariant="normal">∂</mml:mi>
                  <mml:mi>p</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:mi>x</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:msub>
                      <mml:mi>x</mml:mi>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">min</mml:mi>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:mi>t</mml:mi>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">∂</mml:mi>
                  <mml:mi>x</mml:mi>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mn>0.</mml:mn>
          </mml:mstyle>
        </mml:math>
      </disp-formula>
      <p>Note that <inline-formula><mml:math id="IM89" display="inline" overflow="scroll"><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is identical to the transition density <inline-formula><mml:math id="IM90" display="inline" overflow="scroll"><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo fence="false" stretchy="false">|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>.</p>
      <p>Without the reflecting boundary, <inline-formula><mml:math id="IM91" display="inline" overflow="scroll"><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> is a normal distribution with variance <inline-formula><mml:math id="IM92" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>. The variance therefore scales linearly with elapsed time, <inline-formula><mml:math id="IM93" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>. With the reflecting boundary, <inline-formula><mml:math id="IM94" display="inline" overflow="scroll"><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is the sum of this spreading normal and its mirror image centered at <inline-formula><mml:math id="IM95" display="inline" overflow="scroll"><mml:mn>2</mml:mn><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula>. The analytical solution to this bounded process is helpful for understanding the behavior of <inline-formula><mml:math id="IM96" display="inline" overflow="scroll"><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> but is not used in CAGEE. In anticipation of implementing additional (and possibly more complicated) processes into CAGEE, we instead solve Eq. (2) numerically using the approach described in <xref rid="msad106-B7" ref-type="bibr">Boucher and Démery (2016)</xref>. Briefly, the continuous diffusion equation is converted into a matrix equation by discretizing expression values into <italic toggle="yes">N</italic> equal bins of width <inline-formula><mml:math id="IM97" display="inline" overflow="scroll"><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. Following <xref rid="msad106-B7" ref-type="bibr">Boucher and Démery (2016)</xref>, we have used a default <italic toggle="yes">N</italic> = 200, but this number can be set by the user (see Results). This approach gives,</p>
      <disp-formula id="M0004">
        <label>(4)</label>
        <mml:math id="M4" display="block" overflow="scroll">
          <mml:mstyle displaystyle="true" scriptlevel="0">
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi mathvariant="normal">∂</mml:mi>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>t</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">∂</mml:mi>
                  <mml:mi>t</mml:mi>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mstyle displaystyle="true" scriptlevel="0">
              <mml:mrow>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mi>σ</mml:mi>
                      <mml:mn>2</mml:mn>
                    </mml:msup>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                    <mml:msup>
                      <mml:mi>δ</mml:mi>
                      <mml:mn>2</mml:mn>
                    </mml:msup>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mrow>
              <mml:mi>M</mml:mi>
              <mml:mo>⋅</mml:mo>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>t</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:mstyle>
          </mml:mstyle>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula><mml:math id="IM98" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is the vector obtained by discretizing <inline-formula><mml:math id="IM99" display="inline" overflow="scroll"><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> and <inline-formula><mml:math id="IM100" display="inline" overflow="scroll"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula> is the largest expression value accounted for. The matrix <italic toggle="yes">M</italic> is tridiagonal with <inline-formula><mml:math id="IM101" display="inline" overflow="scroll"><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula> on the diagonal except at the first and last diagonal entries which are <inline-formula><mml:math id="IM102" display="inline" overflow="scroll"><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>. The sub- and supradiagonal entries are 1. This equation has the matrix exponential solution:<disp-formula id="M0005"><label>(5)</label><mml:math id="M5" display="block" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mi>M</mml:mi></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula>which is evaluated by diagonalizing <italic toggle="yes">M</italic>.</p>
    </sec>
    <sec id="msad106-s4.2">
      <title>Implementation of CAGEE</title>
      <p>CAGEE is written in C++ and is compatible with the C++11 standard. A comprehensive manual and extensive unit tests facilitate further code development and maintenance. CAGEE is organized into modular components. A “clade” class, with references to a parent clade and any number of descendant clades, represents a tree structure, and a “gene_transcript” class represents the expression levels observed in the various species. These two classes comprise the fundamental data structures upon which CAGEE performs its analysis (<xref rid="sup1" ref-type="supplementary-material">supplementary fig. S5, Supplementary Material</xref> online).</p>
      <p>Calculations are carried out by additional classes. The “optimizer” class has the responsibility of determining the <inline-formula><mml:math id="IM103" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> value with the highest likelihood, by comparing the likelihood of candidate values and searching the likelihood surface using the Nelder–Mead optimization algorithm. The work of computing the likelihood of a given <inline-formula><mml:math id="IM104" display="inline" overflow="scroll"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> value is performed by a subclass of the “model” class, which for now is limited to a single “Base” model (allowing for further development in the future). After appropriate estimated values are found, the “transcript_reconstructor” class builds a possible set of transcript values for the entire tree (<xref rid="sup1" ref-type="supplementary-material">supplementary fig. S5, Supplementary Material</xref> online).</p>
      <p>Performing the likelihood calculations requires extensive matrix operations; it is recommended (though not required) that these be passed off to a specialized library such as Intel's MKL or Nvidia's CUBLAS. If no external library is available, CAGEE will carry out these calculations (slowly) by itself. Creating the diffusion matrix (<italic toggle="yes">M</italic>) requires calculation of eigenvalues and eigenvectors and is computationally expensive. This work is performed by the Eigen linear algebra library (<ext-link xlink:href="https://eigen.tuxfamily.org" ext-link-type="uri">https://eigen.tuxfamily.org</ext-link>); various internal data structures also take advantage of Eigen classes. To enable faster searching, the matrix for an ancestral state vector of length 200 (the default in CAGEE) has been precomputed and is included with CAGEE. Users who wish to use vectors of different lengths can specify this as an option.</p>
      <p>Unit-testing is performed using the doctest testing framework (<ext-link xlink:href="https://github.com/doctest/doctest" ext-link-type="uri">https://github.com/doctest/doctest</ext-link>). At the time of writing, more than 200 unit tests had been created, comprising more than 1,200 individual assertions. For complex logging and debugging cases, CAGEE uses the EasyLogging framework (<ext-link xlink:href="https://github.com/amrayn/easyloggingpp" ext-link-type="uri">https://github.com/amrayn/easyloggingpp</ext-link>). C++ development is always made easier by using the Boost C++ libraries (<ext-link xlink:href="https://www.boost.org/" ext-link-type="uri">https://www.boost.org/</ext-link>), so we include them as well in CAGEE.</p>
    </sec>
    <sec id="msad106-s4.3">
      <title>RNA-seq Data from Wild Tomatoes</title>
      <p>We briefly describe here the data collected from seven accessions of wild tomatoes (<italic toggle="yes">S. lycopersicum</italic> LA3475, <italic toggle="yes">Solanum chmielewskii</italic> LA1316, <italic toggle="yes">S. pimpinellifolium</italic> LA1589, <italic toggle="yes">Solanum habrochaites</italic> LA1777, <italic toggle="yes">Solanum chilense</italic> LA4117A, <italic toggle="yes">S. pennellii</italic> LA3778, and <italic toggle="yes">S. pennellii</italic> LA0716; all accession ID numbers from tgrc.ucdavis.edu). Further details are given in <xref rid="msad106-B55" ref-type="bibr">Moyle et al. (2021)</xref>. Ovule RNA-seq was performed on between one and four (usually three) biological replicates (individual plants) from each accession. Plants were germinated from seed and cultivated until flowering. For each replicate individual, ovules were dissected from mature, unpollinated flowers, flash frozen, and maintained at −80 °C until extraction. For each individual, all ovule collections were pooled into a single sample prior to library construction and sequencing on an Illumina HiSeq 2000. Reads were mapped against the tomato reference genome (ITAG 2.4), and the number of reads mapped onto genic regions was estimated with featureCounts (<xref rid="msad106-B49" ref-type="bibr">Liao et al. 2014</xref>). We normalized the read counts from each library by calculating TPM (<xref rid="msad106-B71" ref-type="bibr">Wagner et al. 2012</xref>) and then calculated the mean normalized read counts across all samples (individuals) within each accession. These means per accession were used as input to CAGEE.</p>
      <p>To construct a species tree for use with CAGEE, we started with the topology given in <xref rid="msad106-B57" ref-type="bibr">Pease et al. (2016)</xref>. Specifically, we used the tree found in the supplementary file Pease_etal_TomatoPhylo_RAxMLConcatTree_no1360_Fig 2A.nwk and pruned it to include only the accessions in our study using the software ETE (<xref rid="msad106-B44" ref-type="bibr">Huerta-Cepas et al. 2016</xref>). Using the “extend” method found in ETE, we converted this tree to ultrametric (same root-to-tip distance for all taxa). Setting the root age to 2.48 million years ago (following <xref rid="msad106-B57" ref-type="bibr">Pease et al. 2016</xref>), we were able to express all branches in millions of years. Analyses of GO enrichment were carried out using ShinyGO (<xref rid="msad106-B27" ref-type="bibr">Ge et al. 2020</xref>) with an FDR of 0.05.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="msad106-s5">
    <title>Supplementary material</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Molecular Biology and Evolution</italic> online.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>msad106_Supplementary_Data</label>
      <media xlink:href="msad106_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgments</title>
    <p>We thank Mark Hibbins for assistance with the tomato phylogeny, Matthew Gibson for putting together the tomato gene expression data, and especially Dan Vanderpool for invaluable help in the initial development of CAGEE. Two reviewers provided helpful comments, and Scott Edwards pointed out relevant work that we had previously missed. This work was supported by National Science Foundation grants DEB-1856469 to L.C.M. and DBI-2146866 to M.W.H.</p>
  </ack>
  <sec sec-type="data-availability" id="msad106-s6">
    <title>Data availability</title>
    <p>
      <sans-serif>Raw reads for each sample library are available at NCBI BioProject PRJNA714065. The CAGEE software is available at</sans-serif>
      <ext-link xlink:href="https://github.com/hahnlab/CAGEE" ext-link-type="uri">https://github.com/hahnlab/CAGEE</ext-link>
      <sans-serif>.</sans-serif>
    </p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="msad106-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ames</surname><given-names>RM</given-names></string-name>, <string-name><surname>Money</surname><given-names>D</given-names></string-name>, <string-name><surname>Ghatge</surname><given-names>VP</given-names></string-name>, <string-name><surname>Whelan</surname><given-names>S</given-names></string-name>, <string-name><surname>Lovell</surname><given-names>SC</given-names></string-name></person-group>. <year>2012</year>. <article-title>Determining the evolutionary history of gene families</article-title>. <source>Bioinformatics</source><volume>28</volume>:<fpage>48</fpage>–<lpage>55</lpage>.<pub-id pub-id-type="pmid">22039210</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Beaulieu</surname><given-names>JM</given-names></string-name>, <string-name><surname>Jhwueng</surname><given-names>DC</given-names></string-name>, <string-name><surname>Boettiger</surname><given-names>C</given-names></string-name>, <string-name><surname>O’Meara</surname><given-names>BC</given-names></string-name></person-group>. <year>2012</year>. <article-title>Modeling stabilizing selection: expanding the Ornstein–Uhlenbeck model of adaptive evolution</article-title>. <source>Evolution</source><volume>66</volume>:<fpage>2369</fpage>–<lpage>2383</lpage>.<pub-id pub-id-type="pmid">22834738</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bedford</surname><given-names>T</given-names></string-name>, <string-name><surname>Hartl</surname><given-names>DL</given-names></string-name></person-group>. <year>2009</year>. <article-title>Optimization of gene expression by natural selection</article-title>. <source>Proc Natl Acad Sci U S A</source>. <volume>106</volume>:<fpage>1133</fpage>–<lpage>1138</lpage>.<pub-id pub-id-type="pmid">19139403</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bedinger</surname><given-names>PA</given-names></string-name>, <string-name><surname>Chetelat</surname><given-names>RT</given-names></string-name>, <string-name><surname>McClure</surname><given-names>B</given-names></string-name>, <string-name><surname>Moyle</surname><given-names>LC</given-names></string-name>, <string-name><surname>Rose</surname><given-names>JK</given-names></string-name>, <string-name><surname>Stack</surname><given-names>SM</given-names></string-name>, <string-name><surname>van der Knaap</surname><given-names>E</given-names></string-name>, <string-name><surname>Baek</surname><given-names>YS</given-names></string-name>, <string-name><surname>Lopez-Casado</surname><given-names>G</given-names></string-name>, <string-name><surname>Covey</surname><given-names>PA</given-names></string-name></person-group>. <year>2011</year>. <article-title>Interspecific reproductive barriers in the tomato clade: opportunities to decipher mechanisms of reproductive isolation</article-title>. <source>Sexual Plant Reprod</source>. <volume>24</volume>:<fpage>171</fpage>–<lpage>187</lpage>.</mixed-citation>
    </ref>
    <ref id="msad106-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Berthelot</surname><given-names>C</given-names></string-name>, <string-name><surname>Villar</surname><given-names>D</given-names></string-name>, <string-name><surname>Horvath</surname><given-names>JE</given-names></string-name>, <string-name><surname>Odom</surname><given-names>DT</given-names></string-name>, <string-name><surname>Flicek</surname><given-names>P</given-names></string-name></person-group>. <year>2018</year>. <article-title>Complexity and conservation of regulatory landscapes underlie evolutionary resilience of mammalian gene expression</article-title>. <source>Nat Ecol Evol</source>. <volume>2</volume>:<fpage>152</fpage>–<lpage>163</lpage>.<pub-id pub-id-type="pmid">29180706</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Blake</surname><given-names>LE</given-names></string-name>, <string-name><surname>Roux</surname><given-names>J</given-names></string-name>, <string-name><surname>Hernando-Herraez</surname><given-names>I</given-names></string-name>, <string-name><surname>Banovich</surname><given-names>NE</given-names></string-name>, <string-name><surname>Perez</surname><given-names>RG</given-names></string-name>, <string-name><surname>Hsiao</surname><given-names>CJ</given-names></string-name>, <string-name><surname>Eres</surname><given-names>I</given-names></string-name>, <string-name><surname>Cuevas</surname><given-names>C</given-names></string-name>, <string-name><surname>Marques-Bonet</surname><given-names>T</given-names></string-name>, <string-name><surname>Gilad</surname><given-names>Y</given-names></string-name></person-group>. <year>2020</year>. <article-title>A comparison of gene expression and DNA methylation patterns across tissues and species</article-title>. <source>Genome Res</source>. <volume>30</volume>:<fpage>250</fpage>–<lpage>262</lpage>.<pub-id pub-id-type="pmid">31953346</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Boucher</surname><given-names>FC</given-names></string-name>, <string-name><surname>Démery</surname><given-names>V</given-names></string-name></person-group>. <year>2016</year>. <article-title>Inferring bounded evolution in phenotypic characters from phylogenetic comparative data</article-title>. <source>System Biol</source>. <volume>65</volume>:<fpage>651</fpage>–<lpage>661</lpage>.<pub-id pub-id-type="pmid">26865274</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Boucher</surname><given-names>FC</given-names></string-name>, <string-name><surname>Démery</surname><given-names>V</given-names></string-name>, <string-name><surname>Conti</surname><given-names>E</given-names></string-name>, <string-name><surname>Harmon</surname><given-names>LJ</given-names></string-name>, <string-name><surname>Uyeda</surname><given-names>J</given-names></string-name></person-group>. <year>2018</year>. <article-title>A general model for estimating macroevolutionary landscapes</article-title>. <source>System Biol</source>. <volume>67</volume>:<fpage>304</fpage>–<lpage>319</lpage>.<pub-id pub-id-type="pmid">29029264</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brawand</surname><given-names>D</given-names></string-name>, <string-name><surname>Soumillon</surname><given-names>M</given-names></string-name>, <string-name><surname>Necsulea</surname><given-names>A</given-names></string-name>, <string-name><surname>Julien</surname><given-names>P</given-names></string-name>, <string-name><surname>Csárdi</surname><given-names>G</given-names></string-name>, <string-name><surname>Harrigan</surname><given-names>P</given-names></string-name>, <string-name><surname>Weier</surname><given-names>M</given-names></string-name>, <string-name><surname>Liechti</surname><given-names>A</given-names></string-name>, <string-name><surname>Aximu-Petri</surname><given-names>A</given-names></string-name>, <string-name><surname>Kircher</surname><given-names>M</given-names></string-name>, <etal>et al</etal></person-group><year>2011</year>. <article-title>The evolution of gene expression levels in mammalian organs</article-title>. <source>Nature</source><volume>478</volume>:<fpage>343</fpage>–<lpage>348</lpage>.<pub-id pub-id-type="pmid">22012392</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Burd</surname><given-names>M</given-names></string-name>, <string-name><surname>Ashman</surname><given-names>T-L</given-names></string-name>, <string-name><surname>Campbell</surname><given-names>DR</given-names></string-name>, <string-name><surname>Dudash</surname><given-names>MR</given-names></string-name>, <string-name><surname>Johnston</surname><given-names>MO</given-names></string-name>, <string-name><surname>Knight</surname><given-names>TM</given-names></string-name>, <string-name><surname>Mazer</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Mitchell</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Steets</surname><given-names>JA</given-names></string-name>, <string-name><surname>Vamosi</surname><given-names>JC</given-names></string-name></person-group>. <year>2009</year>. <article-title>Ovule number per flower in a world of unpredictable pollination</article-title>. <source>Am JBot</source>. <volume>96</volume>:<fpage>1159</fpage>–<lpage>1167</lpage>.<pub-id pub-id-type="pmid">21628266</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B11">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Burnham</surname><given-names>KP</given-names></string-name>, <string-name><surname>Anderson</surname><given-names>DR</given-names></string-name></person-group>. <year>2002</year>. <source>Model selection and multimodel inference: a practical information–theoretic approach</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Springer</publisher-name>.</mixed-citation>
    </ref>
    <ref id="msad106-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Caetano</surname><given-names>DS</given-names></string-name>, <string-name><surname>Harmon</surname><given-names>LJ</given-names></string-name></person-group>. <year>2018</year>. <article-title>Estimating correlated rates of trait evolution with uncertainty</article-title>. <source>System Biol</source>. <volume>68</volume>:<fpage>412</fpage>–<lpage>429</lpage>.</mixed-citation>
    </ref>
    <ref id="msad106-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Catalán</surname><given-names>A</given-names></string-name>, <string-name><surname>Briscoe</surname><given-names>AD</given-names></string-name>, <string-name><surname>Höhna</surname><given-names>S</given-names></string-name></person-group>. <year>2019</year>. <article-title>Drift and directional selection are the evolutionary forces driving gene expression divergence in eye and brain tissue of <italic toggle="yes">Heliconius</italic> butterflies</article-title>. <source>Genetics</source><volume>213</volume>:<fpage>581</fpage>–<lpage>594</lpage>.<pub-id pub-id-type="pmid">31467133</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Charlesworth</surname><given-names>D</given-names></string-name>, <string-name><surname>Wright</surname><given-names>SI</given-names></string-name></person-group>. <year>2001</year>. <article-title>Breeding systems and genome evolution</article-title>. <source>Curr Opin Genet Dev</source>. <volume>11</volume>:<fpage>685</fpage>–<lpage>690</lpage>.<pub-id pub-id-type="pmid">11682314</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>J</given-names></string-name>, <string-name><surname>Swofford</surname><given-names>R</given-names></string-name>, <string-name><surname>Johnson</surname><given-names>J</given-names></string-name>, <string-name><surname>Cummings</surname><given-names>BB</given-names></string-name>, <string-name><surname>Rogel</surname><given-names>N</given-names></string-name>, <string-name><surname>Lindblad-Toh</surname><given-names>K</given-names></string-name>, <string-name><surname>Haerty</surname><given-names>W</given-names></string-name>, <string-name><surname>Di Palma</surname><given-names>F</given-names></string-name>, <string-name><surname>Regev</surname><given-names>A</given-names></string-name></person-group>. <year>2019</year>. <article-title>A quantitative framework for characterizing the evolutionary history of mammalian gene expression</article-title>. <source>Genome Res</source>. <volume>29</volume>:<fpage>53</fpage>–<lpage>63</lpage>.<pub-id pub-id-type="pmid">30552105</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Clark</surname><given-names>NL</given-names></string-name>, <string-name><surname>Aagaard</surname><given-names>JE</given-names></string-name>, <string-name><surname>Swanson</surname><given-names>WJ</given-names></string-name></person-group>. <year>2006</year>. <article-title>Evolution of reproductive proteins from animals and plants</article-title>. <source>Reproduction</source><volume>131</volume>:<fpage>11</fpage>–<lpage>22</lpage>.<pub-id pub-id-type="pmid">16388004</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Coolon</surname><given-names>JD</given-names></string-name>, <string-name><surname>McManus</surname><given-names>CJ</given-names></string-name>, <string-name><surname>Stevenson</surname><given-names>KR</given-names></string-name>, <string-name><surname>Graveley</surname><given-names>BR</given-names></string-name>, <string-name><surname>Wittkopp</surname><given-names>PJ</given-names></string-name></person-group>. <year>2014</year>. <article-title>Tempo and mode of regulatory evolution in <italic toggle="yes">Drosophila</italic></article-title>. <source>Genome Res</source>. <volume>24</volume>:<fpage>797</fpage>–<lpage>808</lpage>.<pub-id pub-id-type="pmid">24567308</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cooper</surname><given-names>N</given-names></string-name>, <string-name><surname>Thomas</surname><given-names>GH</given-names></string-name>, <string-name><surname>Venditti</surname><given-names>C</given-names></string-name>, <string-name><surname>Meade</surname><given-names>A</given-names></string-name>, <string-name><surname>Freckleton</surname><given-names>RP</given-names></string-name></person-group>. <year>2016</year>. <article-title>A cautionary note on the use of Ornstein Uhlenbeck models in macroevolutionary studies</article-title>. <source>Biol J Linnean Soc</source>. <volume>118</volume>:<fpage>64</fpage>–<lpage>77</lpage>.</mixed-citation>
    </ref>
    <ref id="msad106-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>De Bie</surname><given-names>T</given-names></string-name>, <string-name><surname>Demuth</surname><given-names>JP</given-names></string-name>, <string-name><surname>Cristianini</surname><given-names>N</given-names></string-name>, <string-name><surname>Hahn</surname><given-names>MW</given-names></string-name></person-group>. <year>2006</year>. <article-title>CAFE: a computational tool for the study of gene family evolution</article-title>. <source>Bioinformatics</source><volume>22</volume>:<fpage>1269</fpage>–<lpage>1271</lpage>.<pub-id pub-id-type="pmid">16543274</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dunn</surname><given-names>CW</given-names></string-name>, <string-name><surname>Luo</surname><given-names>X</given-names></string-name>, <string-name><surname>Wu</surname><given-names>Z</given-names></string-name></person-group>. <year>2013</year>. <article-title>Phylogenetic analysis of gene expression</article-title>. <source>Integr Comp Biol</source>. <volume>53</volume>:<fpage>847</fpage>–<lpage>856</lpage>.<pub-id pub-id-type="pmid">23748631</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>El Taher</surname><given-names>A</given-names></string-name>, <string-name><surname>Böhne</surname><given-names>A</given-names></string-name>, <string-name><surname>Boileau</surname><given-names>N</given-names></string-name>, <string-name><surname>Ronco</surname><given-names>F</given-names></string-name>, <string-name><surname>Indermaur</surname><given-names>A</given-names></string-name>, <string-name><surname>Widmer</surname><given-names>L</given-names></string-name>, <string-name><surname>Salzburger</surname><given-names>W</given-names></string-name></person-group>. <year>2021</year>. <article-title>Gene expression dynamics during rapid organismal diversification in African cichlid fishes</article-title>. <source>Nat Ecol Evol</source>. <volume>5</volume>:<fpage>243</fpage>–<lpage>250</lpage>.<pub-id pub-id-type="pmid">33230257</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fantini</surname><given-names>E</given-names></string-name>, <string-name><surname>Sulli</surname><given-names>M</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>L</given-names></string-name>, <string-name><surname>Aprea</surname><given-names>G</given-names></string-name>, <string-name><surname>Jiménez-Gómez</surname><given-names>JM</given-names></string-name>, <string-name><surname>Bendahmane</surname><given-names>A</given-names></string-name>, <string-name><surname>Perrotta</surname><given-names>G</given-names></string-name>, <string-name><surname>Giuliano</surname><given-names>G</given-names></string-name>, <string-name><surname>Facella</surname><given-names>P</given-names></string-name></person-group>. <year>2019</year>. <article-title>Pivotal roles of cryptochromes 1a and 2 in tomato development and physiology</article-title>. <source>Plant Physiol</source>. <volume>179</volume>:<fpage>732</fpage>–<lpage>748</lpage>.<pub-id pub-id-type="pmid">30541876</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fay</surname><given-names>JC</given-names></string-name>, <string-name><surname>Wittkopp</surname><given-names>PJ</given-names></string-name></person-group>. <year>2008</year>. <article-title>Evaluating the role of natural selection in the evolution of gene regulation</article-title>. <source>Heredity (Edinb).</source><volume>100</volume>:<fpage>191</fpage>–<lpage>199</lpage>.<pub-id pub-id-type="pmid">17519966</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Felsenstein</surname><given-names>J</given-names></string-name></person-group>. <year>1973</year>. <article-title>Maximum likelihood and minimum-steps methods for estimating evolutionary trees from data on discrete characters</article-title>. <source>System Biol</source>. <volume>22</volume>:<fpage>240</fpage>–<lpage>249</lpage>.</mixed-citation>
    </ref>
    <ref id="msad106-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>FitzJohn</surname><given-names>RG</given-names></string-name></person-group>. <year>2012</year>. <article-title>Diversitree: comparative phylogenetic analyses of diversification in R</article-title>. <source>Methods Ecol Evol</source>. <volume>3</volume>:<fpage>1084</fpage>–<lpage>1092</lpage>.</mixed-citation>
    </ref>
    <ref id="msad106-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Freckleton</surname><given-names>RP</given-names></string-name></person-group>. <year>2012</year>. <article-title>Fast likelihood calculations for comparative analyses</article-title>. <source>Methods Ecol Evol</source>. <volume>3</volume>:<fpage>940</fpage>–<lpage>947</lpage>.</mixed-citation>
    </ref>
    <ref id="msad106-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ge</surname><given-names>SX</given-names></string-name>, <string-name><surname>Jung</surname><given-names>D</given-names></string-name>, <string-name><surname>Yao</surname><given-names>R</given-names></string-name></person-group>. <year>2020</year>. <article-title>ShinyGO: a graphical gene-set enrichment tool for animals and plants</article-title>. <source>Bioinformatics</source><volume>36</volume>:<fpage>2628</fpage>–<lpage>2629</lpage>.<pub-id pub-id-type="pmid">31882993</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gillespie</surname><given-names>JH</given-names></string-name></person-group>. <year>1986</year>. <article-title>Variability of evolutionary rates of DNA</article-title>. <source>Genetics</source><volume>113</volume>:<fpage>1077</fpage>–<lpage>1091</lpage>.<pub-id pub-id-type="pmid">3744027</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Goldberg</surname><given-names>EE</given-names></string-name>, <string-name><surname>Kohn</surname><given-names>JR</given-names></string-name>, <string-name><surname>Lande</surname><given-names>R</given-names></string-name>, <string-name><surname>Robertson</surname><given-names>KA</given-names></string-name>, <string-name><surname>Smith</surname><given-names>SA</given-names></string-name>, <string-name><surname>Igić</surname><given-names>B</given-names></string-name></person-group>. <year>2010</year>. <article-title>Species selection maintains self-incompatibility</article-title>. <source>Science</source><volume>330</volume>:<fpage>493</fpage>–<lpage>495</lpage>.<pub-id pub-id-type="pmid">20966249</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Golding</surname><given-names>G</given-names></string-name></person-group>. <year>1983</year>. <article-title>Estimates of DNA and protein sequence divergence: an examination of some assumptions</article-title>. <source>Mol Biol Evol</source>. <volume>1</volume>:<fpage>125</fpage>–<lpage>142</lpage>.<pub-id pub-id-type="pmid">6599960</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gossmann</surname><given-names>TI</given-names></string-name>, <string-name><surname>Saleh</surname><given-names>D</given-names></string-name>, <string-name><surname>Schmid</surname><given-names>MW</given-names></string-name>, <string-name><surname>Spence</surname><given-names>MA</given-names></string-name>, <string-name><surname>Schmid</surname><given-names>KJ</given-names></string-name></person-group>. <year>2016</year>. <article-title>Transcriptomes of plant gametophytes have a higher proportion of rapidly evolving and young genes than sporophytes</article-title>. <source>Mol Biol Evol</source>. <volume>33</volume>:<fpage>1669</fpage>–<lpage>1678</lpage>.<pub-id pub-id-type="pmid">26956888</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gossmann</surname><given-names>TI</given-names></string-name>, <string-name><surname>Schmid</surname><given-names>MW</given-names></string-name>, <string-name><surname>Grossniklaus</surname><given-names>U</given-names></string-name>, <string-name><surname>Schmid</surname><given-names>KJ</given-names></string-name></person-group>. <year>2014</year>. <article-title>Selection-driven evolution of sex-biased genes is consistent with sexual selection in <italic toggle="yes">Arabidopsis thaliana</italic></article-title>. <source>Mol Biol Evol</source>. <volume>31</volume>:<fpage>574</fpage>–<lpage>583</lpage>.<pub-id pub-id-type="pmid">24273323</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Greenway</surname><given-names>CA</given-names></string-name>, <string-name><surname>Harder</surname><given-names>LD</given-names></string-name></person-group>. <year>2007</year>. <article-title>Variation in ovule and seed size and associated size–number trade-offs in angiosperms</article-title>. <source>Am J Bot</source>. <volume>94</volume>:<fpage>840</fpage>–<lpage>846</lpage>.<pub-id pub-id-type="pmid">21636453</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hahn</surname><given-names>MW</given-names></string-name>, <string-name><surname>De Bie</surname><given-names>T</given-names></string-name>, <string-name><surname>Stajich</surname><given-names>JE</given-names></string-name>, <string-name><surname>Nguyen</surname><given-names>C</given-names></string-name>, <string-name><surname>Cristianini</surname><given-names>N</given-names></string-name></person-group>. <year>2005</year>. <article-title>Estimating the tempo and mode of gene family evolution from comparative genomic data</article-title>. <source>Genome Res</source>. <volume>15</volume>:<fpage>1153</fpage>–<lpage>1160</lpage>.<pub-id pub-id-type="pmid">16077014</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hahn</surname><given-names>MW</given-names></string-name>, <string-name><surname>Demuth</surname><given-names>JP</given-names></string-name>, <string-name><surname>Han</surname><given-names>S-G</given-names></string-name></person-group>. <year>2007</year>. <article-title>Accelerated rate of gene gain and loss in primates</article-title>. <source>Genetics</source><volume>177</volume>:<fpage>1941</fpage>–<lpage>1949</lpage>.<pub-id pub-id-type="pmid">17947411</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hahn</surname><given-names>MW</given-names></string-name>, <string-name><surname>Nakhleh</surname><given-names>L</given-names></string-name></person-group>. <year>2016</year>. <article-title>Irrational exuberance for resolved species trees</article-title>. <source>Evolution</source><volume>70</volume>:<fpage>7</fpage>–<lpage>17</lpage>.<pub-id pub-id-type="pmid">26639662</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Han</surname><given-names>QQ</given-names></string-name>, <string-name><surname>Song</surname><given-names>YZ</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>JY</given-names></string-name>, <string-name><surname>Liu</surname><given-names>LF</given-names></string-name></person-group>. <year>2014</year>. <article-title>Studies on the role of the <italic toggle="yes">SlNAC3</italic> gene in regulating seed development in tomato (<italic toggle="yes">Solanum lycopersicum</italic>)</article-title>. <source>J Hortic Sci Biotechnol</source>. <volume>89</volume>:<fpage>423</fpage>–<lpage>429</lpage>.</mixed-citation>
    </ref>
    <ref id="msad106-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Han</surname><given-names>MV</given-names></string-name>, <string-name><surname>Thomas</surname><given-names>GWC</given-names></string-name>, <string-name><surname>Lugo-Martinez</surname><given-names>J</given-names></string-name>, <string-name><surname>Hahn</surname><given-names>MW</given-names></string-name></person-group>. <year>2013</year>. <article-title>Estimating gene gain and loss rates in the presence of error in genome assembly and annotation using CAFE 3</article-title>. <source>Mol Biol Evol</source>. <volume>30</volume>:<fpage>1987</fpage>–<lpage>1997</lpage>.<pub-id pub-id-type="pmid">23709260</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Harrison</surname><given-names>MC</given-names></string-name>, <string-name><surname>Mallon</surname><given-names>EB</given-names></string-name>, <string-name><surname>Twell</surname><given-names>D</given-names></string-name>, <string-name><surname>Hammond</surname><given-names>RL</given-names></string-name></person-group>. <year>2019</year>. <article-title>Deleterious mutation accumulation in <italic toggle="yes">Arabidopsis thaliana</italic> pollen genes: a role for a recent relaxation of selection</article-title>. <source>Genome Biol Evol</source>. <volume>11</volume>:<fpage>1939</fpage>–<lpage>1951</lpage>.<pub-id pub-id-type="pmid">31209485</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Harrison</surname><given-names>PW</given-names></string-name>, <string-name><surname>Wright</surname><given-names>AE</given-names></string-name>, <string-name><surname>Zimmer</surname><given-names>F</given-names></string-name>, <string-name><surname>Dean</surname><given-names>R</given-names></string-name>, <string-name><surname>Montgomery</surname><given-names>SH</given-names></string-name>, <string-name><surname>Pointer</surname><given-names>MA</given-names></string-name>, <string-name><surname>Mank</surname><given-names>JE</given-names></string-name></person-group>. <year>2015</year>. <article-title>Sexual selection drives evolution and rapid turnover of male gene expression</article-title>. <source>Proc Natl Acad Sci U S A</source>. <volume>112</volume>:<fpage>4393</fpage>–<lpage>4398</lpage>.<pub-id pub-id-type="pmid">25831521</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hibbins</surname><given-names>MS</given-names></string-name>, <string-name><surname>Hahn</surname><given-names>MW</given-names></string-name></person-group>. <year>2021</year>. <article-title>The effects of introgression across thousands of quantitative traits revealed by gene expression in wild tomatoes</article-title>. <source>PLoS Genet</source>. <volume>17</volume>:<comment>e1009892</comment>.</mixed-citation>
    </ref>
    <ref id="msad106-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hill</surname><given-names>MS</given-names></string-name>, <string-name><surname>Zande</surname><given-names>PV</given-names></string-name>, <string-name><surname>Wittkopp</surname><given-names>PJ</given-names></string-name></person-group>. <year>2021</year>. <article-title>Molecular and evolutionary processes generating variation in gene expression</article-title>. <source>Nat Rev Genet</source>. <volume>22</volume>:<fpage>203</fpage>–<lpage>215</lpage>.<pub-id pub-id-type="pmid">33268840</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hiscott</surname><given-names>G</given-names></string-name>, <string-name><surname>Fox</surname><given-names>C</given-names></string-name>, <string-name><surname>Parry</surname><given-names>M</given-names></string-name>, <string-name><surname>Bryant</surname><given-names>D</given-names></string-name></person-group>. <year>2016</year>. <article-title>Efficient recycled algorithms for quantitative trait models on phylogenies</article-title>. <source>Genome Biol Evol</source>. <volume>8</volume>:<fpage>1338</fpage>–<lpage>1350</lpage>.<pub-id pub-id-type="pmid">27056412</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huerta-Cepas</surname><given-names>J</given-names></string-name>, <string-name><surname>Serra</surname><given-names>F</given-names></string-name>, <string-name><surname>Bork</surname><given-names>P</given-names></string-name></person-group>. <year>2016</year>. <article-title>ETE 3: reconstruction, analysis, and visualization of phylogenomic data</article-title>. <source>Mol Biol Evol</source>. <volume>33</volume>:<fpage>1635</fpage>–<lpage>1638</lpage>.<pub-id pub-id-type="pmid">26921390</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Igić</surname><given-names>B</given-names></string-name>, <string-name><surname>Bohs</surname><given-names>L</given-names></string-name>, <string-name><surname>Kohn</surname><given-names>JR</given-names></string-name></person-group>. <year>2006</year>. <article-title>Ancient polymorphism reveals unidirectional breeding system shifts</article-title>. <source>Proc Natl Acad Sci U S A</source>. <volume>103</volume>:<fpage>1359</fpage>–<lpage>1363</lpage>.<pub-id pub-id-type="pmid">16428289</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>King</surname><given-names>M-C</given-names></string-name>, <string-name><surname>Wilson</surname><given-names>AC</given-names></string-name></person-group>. <year>1975</year>. <article-title>Evolution at two levels in humans and chimpanzees</article-title>. <source>Science</source><volume>188</volume>:<fpage>107</fpage>–<lpage>116</lpage>.<pub-id pub-id-type="pmid">1090005</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Landis</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Schraiber</surname><given-names>JG</given-names></string-name></person-group>. <year>2017</year>. <article-title>Pulsed evolution shaped modern vertebrate body sizes</article-title>. <source>Proc Natl Acad Sci U S A</source>. <volume>114</volume>:<fpage>13224</fpage>–<lpage>13229</lpage>.<pub-id pub-id-type="pmid">29114046</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>M</given-names></string-name>, <string-name><surname>Wang</surname><given-names>X</given-names></string-name>, <string-name><surname>Li</surname><given-names>C</given-names></string-name>, <string-name><surname>Li</surname><given-names>H</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>J</given-names></string-name>, <string-name><surname>Ye</surname><given-names>Z</given-names></string-name></person-group>. <year>2018</year>. <article-title>Silencing <italic toggle="yes">GRAS2</italic> reduces fruit weight in tomato</article-title>. <source>J Integr Plant Biol</source>. <volume>60</volume>:<fpage>498</fpage>–<lpage>513</lpage>.<pub-id pub-id-type="pmid">29359472</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liao</surname><given-names>Y</given-names></string-name>, <string-name><surname>Smyth</surname><given-names>GK</given-names></string-name>, <string-name><surname>Shi</surname><given-names>W</given-names></string-name></person-group>. <year>2014</year>. <article-title>Featurecounts: an efficient general purpose program for assigning sequence reads to genomic features</article-title>. <source>Bioinformatics</source><volume>30</volume>:<fpage>923</fpage>–<lpage>930</lpage>.<pub-id pub-id-type="pmid">24227677</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meisel</surname><given-names>RP</given-names></string-name>, <string-name><surname>Malone</surname><given-names>JH</given-names></string-name>, <string-name><surname>Clark</surname><given-names>AG</given-names></string-name></person-group>. <year>2012</year>. <article-title>Disentangling the relationship between sex-biased gene expression and X-linkage</article-title>. <source>Genome Res</source>. <volume>22</volume>:<fpage>1255</fpage>–<lpage>1265</lpage>.<pub-id pub-id-type="pmid">22499666</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mendes</surname><given-names>FK</given-names></string-name>, <string-name><surname>Fuentes-González</surname><given-names>JA</given-names></string-name>, <string-name><surname>Schraiber</surname><given-names>JG</given-names></string-name>, <string-name><surname>Hahn</surname><given-names>MW</given-names></string-name></person-group>. <year>2018</year>. <article-title>A multispecies coalescent model for quantitative traits</article-title>. <source>eLife</source><volume>7</volume>:<comment>e36482</comment>.</mixed-citation>
    </ref>
    <ref id="msad106-B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mendes</surname><given-names>FK</given-names></string-name>, <string-name><surname>Vanderpool</surname><given-names>D</given-names></string-name>, <string-name><surname>Fulton</surname><given-names>B</given-names></string-name>, <string-name><surname>Hahn</surname><given-names>MW</given-names></string-name></person-group>. <year>2020</year>. <article-title>CAFE 5 models variation in evolutionary rates among gene families</article-title>. <source>Bioinformatics</source><volume>36</volume>:<fpage>5516</fpage>–<lpage>5518</lpage>.</mixed-citation>
    </ref>
    <ref id="msad106-B53">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mione</surname><given-names>T</given-names></string-name>, <string-name><surname>Anderson</surname><given-names>GJ</given-names></string-name></person-group>. <year>1992</year>. <article-title>Pollen-ovule ratios and breeding system evolution in <italic toggle="yes">Solanum</italic> section <italic toggle="yes">Basarthrum</italic> (Solanaceae)</article-title>. <source>Am J Bot</source>. <volume>79</volume>:<fpage>279</fpage>–<lpage>287</lpage>.</mixed-citation>
    </ref>
    <ref id="msad106-B54">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mitov</surname><given-names>V</given-names></string-name>, <string-name><surname>Bartoszek</surname><given-names>K</given-names></string-name>, <string-name><surname>Asimomitis</surname><given-names>G</given-names></string-name>, <string-name><surname>Stadler</surname><given-names>T</given-names></string-name></person-group>. <year>2020</year>. <article-title>Fast likelihood calculation for multivariate Gaussian phylogenetic models with shifts</article-title>. <source>Theor Popul Biol</source>. <volume>131</volume>:<fpage>66</fpage>–<lpage>78</lpage>.<pub-id pub-id-type="pmid">31805292</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B55">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moyle</surname><given-names>LC</given-names></string-name>, <string-name><surname>Wu</surname><given-names>M</given-names></string-name>, <string-name><surname>Gibson</surname><given-names>MJ</given-names></string-name></person-group>. <year>2021</year>. <article-title>Reproductive proteins evolve faster than non-reproductive proteins among <italic toggle="yes">Solanum</italic> species</article-title>. <source>Front Plant Sci</source>. <volume>12</volume>:<comment>635990</comment>.</mixed-citation>
    </ref>
    <ref id="msad106-B56">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>O’Meara</surname><given-names>BC</given-names></string-name>, <string-name><surname>Ané</surname><given-names>C</given-names></string-name>, <string-name><surname>Sanderson</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Wainwright</surname><given-names>PC</given-names></string-name></person-group>. <year>2006</year>. <article-title>Testing for different rates of continuous trait evolution using likelihood</article-title>. <source>Evolution</source><volume>60</volume>:<fpage>922</fpage>–<lpage>933</lpage>.<pub-id pub-id-type="pmid">16817533</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B57">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pease</surname><given-names>JB</given-names></string-name>, <string-name><surname>Haak</surname><given-names>DC</given-names></string-name>, <string-name><surname>Hahn</surname><given-names>MW</given-names></string-name>, <string-name><surname>Moyle</surname><given-names>LC</given-names></string-name></person-group>. <year>2016</year>. <article-title>Phylogenomics reveals three sources of adaptive variation during a rapid radiation</article-title>. <source>PLoS Biol</source>. <volume>14</volume>:<comment>e1002379</comment>.</mixed-citation>
    </ref>
    <ref id="msad106-B58">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pennell</surname><given-names>MW</given-names></string-name>, <string-name><surname>Eastman</surname><given-names>JM</given-names></string-name>, <string-name><surname>Slater</surname><given-names>GJ</given-names></string-name>, <string-name><surname>Brown</surname><given-names>JW</given-names></string-name>, <string-name><surname>Uyeda</surname><given-names>JC</given-names></string-name>, <string-name><surname>FitzJohn</surname><given-names>RG</given-names></string-name>, <string-name><surname>Alfaro</surname><given-names>ME</given-names></string-name>, <string-name><surname>Harmon</surname><given-names>LJ</given-names></string-name></person-group>. <year>2014</year>. <article-title>Geiger v2. 0: an expanded suite of methods for fitting macroevolutionary models to phylogenetic trees</article-title>. <source>Bioinformatics</source><volume>30</volume>:<fpage>2216</fpage>–<lpage>2218</lpage>.<pub-id pub-id-type="pmid">24728855</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B59">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pennell</surname><given-names>MW</given-names></string-name>, <string-name><surname>FitzJohn</surname><given-names>RG</given-names></string-name>, <string-name><surname>Cornwell</surname><given-names>WK</given-names></string-name>, <string-name><surname>Harmon</surname><given-names>LJ</given-names></string-name></person-group>. <year>2015</year>. <article-title>Model adequacy and the macroevolution of angiosperm functional traits</article-title>. <source>Am Nat</source>. <volume>186</volume>:<fpage>E33</fpage>–<lpage>E50</lpage>.<pub-id pub-id-type="pmid">26655160</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B60">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Price</surname><given-names>PD</given-names></string-name>, <string-name><surname>Palmer Droguett</surname><given-names>DH</given-names></string-name>, <string-name><surname>Taylor</surname><given-names>JA</given-names></string-name>, <string-name><surname>Kim</surname><given-names>DW</given-names></string-name>, <string-name><surname>Place</surname><given-names>ES</given-names></string-name>, <string-name><surname>Rogers</surname><given-names>TF</given-names></string-name>, <string-name><surname>Mank</surname><given-names>JE</given-names></string-name>, <string-name><surname>Cooney</surname><given-names>CR</given-names></string-name>, <string-name><surname>Wright</surname><given-names>AE</given-names></string-name></person-group>. <year>2022</year>. <article-title>Detecting signatures of selection on gene expression</article-title>. <source>Nat Ecol Evol</source>. <volume>6</volume>:<fpage>1035</fpage>–<lpage>1045</lpage>.<pub-id pub-id-type="pmid">35551249</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B61">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Revell</surname><given-names>LJ</given-names></string-name>, <string-name><surname>Harmon</surname><given-names>LJ</given-names></string-name></person-group>. <year>2022</year>. <source>Phylogenetic comparative methods in R</source>. <publisher-name>Princeton, NJ: Princeton University Press</publisher-name>.</mixed-citation>
    </ref>
    <ref id="msad106-B62">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rick</surname><given-names>CM</given-names></string-name>, <string-name><surname>Tanksley</surname><given-names>SD</given-names></string-name></person-group>. <year>1981</year>. <article-title>Genetic variation in <italic toggle="yes">Solanum pennellii</italic>: comparisons with two other sympatric tomato species</article-title>. <source>Plant System Evol</source>. <volume>139</volume>:<fpage>11</fpage>–<lpage>45</lpage>.</mixed-citation>
    </ref>
    <ref id="msad106-B63">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robinson</surname><given-names>MD</given-names></string-name>, <string-name><surname>Oshlack</surname><given-names>A</given-names></string-name></person-group>. <year>2010</year>. <article-title>A scaling normalization method for differential expression analysis of RNA-seq data</article-title>. <source>Genome Biol</source>. <volume>11</volume>:<fpage>R25</fpage>.<pub-id pub-id-type="pmid">20196867</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B64">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rohlfs</surname><given-names>RV</given-names></string-name>, <string-name><surname>Harrigan</surname><given-names>P</given-names></string-name>, <string-name><surname>Nielsen</surname><given-names>R</given-names></string-name></person-group>. <year>2014</year>. <article-title>Modeling gene expression evolution with an extended Ornstein–Uhlenbeck process accounting for within-species variation</article-title>. <source>Mol Biol Evol</source>. <volume>31</volume>:<fpage>201</fpage>–<lpage>211</lpage>.<pub-id pub-id-type="pmid">24113538</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B65">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rohlfs</surname><given-names>RV</given-names></string-name>, <string-name><surname>Nielsen</surname><given-names>R</given-names></string-name></person-group>. <year>2015</year>. <article-title>Phylogenetic ANOVA: the expression variance and evolution model for quantitative trait evolution</article-title>. <source>System Biol</source>. <volume>64</volume>:<fpage>695</fpage>–<lpage>708</lpage>.<pub-id pub-id-type="pmid">26169525</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B66">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Silvestro</surname><given-names>D</given-names></string-name>, <string-name><surname>Kostikova</surname><given-names>A</given-names></string-name>, <string-name><surname>Litsios</surname><given-names>G</given-names></string-name>, <string-name><surname>Pearman</surname><given-names>PB</given-names></string-name>, <string-name><surname>Salamin</surname><given-names>N</given-names></string-name></person-group>. <year>2015</year>. <article-title>Measurement errors should always be incorporated in phylogenetic comparative analysis</article-title>. <source>Methods Ecol Evol</source>. <volume>6</volume>:<fpage>340</fpage>–<lpage>346</lpage>.</mixed-citation>
    </ref>
    <ref id="msad106-B67">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Somel</surname><given-names>M</given-names></string-name>, <string-name><surname>Creely</surname><given-names>H</given-names></string-name>, <string-name><surname>Franz</surname><given-names>H</given-names></string-name>, <string-name><surname>Mueller</surname><given-names>U</given-names></string-name>, <string-name><surname>Lachmann</surname><given-names>M</given-names></string-name>, <string-name><surname>Khaitovich</surname><given-names>P</given-names></string-name>, <string-name><surname>Pääbo</surname><given-names>S</given-names></string-name></person-group>. <year>2008</year>. <article-title>Human and chimpanzee gene expression differences replicated in mice fed different diets</article-title>. <source>PLoS One</source><volume>3</volume>:<fpage>e1504</fpage>.<pub-id pub-id-type="pmid">18231591</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B68">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Swanson</surname><given-names>WJ</given-names></string-name>, <string-name><surname>Vacquier</surname><given-names>VD</given-names></string-name></person-group>. <year>2002</year>. <article-title>The rapid evolution of reproductive proteins</article-title>. <source>Nat Rev Genet</source>. <volume>3</volume>:<fpage>137</fpage>–<lpage>144</lpage>.<pub-id pub-id-type="pmid">11836507</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B69">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tarashansky</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Musser</surname><given-names>JM</given-names></string-name>, <string-name><surname>Khariton</surname><given-names>M</given-names></string-name>, <string-name><surname>Li</surname><given-names>P</given-names></string-name>, <string-name><surname>Arendt</surname><given-names>D</given-names></string-name>, <string-name><surname>Quake</surname><given-names>SR</given-names></string-name>, <string-name><surname>Wang</surname><given-names>B</given-names></string-name></person-group>. <year>2021</year>. <article-title>Mapping single-cell atlases throughout Metazoa unravels cell type evolution</article-title>. <source>eLife</source><volume>10</volume>:<comment>e66747</comment>.</mixed-citation>
    </ref>
    <ref id="msad106-B70">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vosters</surname><given-names>SL</given-names></string-name>, <string-name><surname>Jewell</surname><given-names>CP</given-names></string-name>, <string-name><surname>Sherman</surname><given-names>NA</given-names></string-name>, <string-name><surname>Einterz</surname><given-names>F</given-names></string-name>, <string-name><surname>Blackman</surname><given-names>BK</given-names></string-name>, <string-name><surname>Moyle</surname><given-names>LC</given-names></string-name></person-group>. <year>2014</year>. <article-title>The timing of molecular and morphological changes underlying reproductive transitions in wild tomatoes (<italic toggle="yes">Solanum</italic> sect. <italic toggle="yes">Lycopersicon</italic>)</article-title>. <source>Mol Ecol</source>. <volume>23</volume>:<fpage>1965</fpage>–<lpage>1978</lpage>.<pub-id pub-id-type="pmid">24589309</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B71">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wagner</surname><given-names>GP</given-names></string-name>, <string-name><surname>Kin</surname><given-names>K</given-names></string-name>, <string-name><surname>Lynch</surname><given-names>VJ</given-names></string-name></person-group>. <year>2012</year>. <article-title>Measurement of mRNA abundance using RNA-seq data: RPKM measure is inconsistent among samples</article-title>. <source>Theory Biosci</source>. <volume>131</volume>:<fpage>281</fpage>–<lpage>285</lpage>.<pub-id pub-id-type="pmid">22872506</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B72">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>Z</given-names></string-name>, <string-name><surname>Gerstein</surname><given-names>M</given-names></string-name>, <string-name><surname>Snyder</surname><given-names>M</given-names></string-name></person-group>. <year>2009</year>. <article-title>RNA-Seq: a revolutionary tool for transcriptomics</article-title>. <source>Nat Rev Genet</source>. <volume>10</volume>:<fpage>57</fpage>–<lpage>63</lpage>.<pub-id pub-id-type="pmid">19015660</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B73">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Whitehead</surname><given-names>MR</given-names></string-name>, <string-name><surname>Lanfear</surname><given-names>R</given-names></string-name>, <string-name><surname>Mitchell</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Karron</surname><given-names>JD</given-names></string-name></person-group>. <year>2018</year>. <article-title>Plant mating systems often vary widely among populations</article-title>. <source>Front Ecol Evol</source>. <volume>6</volume>:<fpage>38</fpage>.</mixed-citation>
    </ref>
    <ref id="msad106-B74">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wong</surname><given-names>A</given-names></string-name></person-group>. <year>2011</year>. <article-title>The molecular evolution of animal reproductive tract proteins: what have we learned from mating-system comparisons?</article-title><source>Int J Evol Biol</source>. <volume>2011</volume>:<comment>908735</comment>.</mixed-citation>
    </ref>
    <ref id="msad106-B75">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wray</surname><given-names>GA</given-names></string-name>, <string-name><surname>Hahn</surname><given-names>MW</given-names></string-name>, <string-name><surname>Abouheif</surname><given-names>E</given-names></string-name>, <string-name><surname>Balhoff</surname><given-names>JP</given-names></string-name>, <string-name><surname>Pizer</surname><given-names>M</given-names></string-name>, <string-name><surname>Rockman</surname><given-names>MV</given-names></string-name>, <string-name><surname>Romano</surname><given-names>LA</given-names></string-name></person-group>. <year>2003</year>. <article-title>The evolution of transcriptional regulation in eukaryotes</article-title>. <source>Mol Biol Evol</source>. <volume>20</volume>:<fpage>1377</fpage>–<lpage>1419</lpage>.<pub-id pub-id-type="pmid">12777501</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B76">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>Z</given-names></string-name></person-group>. <year>1996</year>. <article-title>Among-site rate variation and its impact on phylogenetic analyses</article-title>. <source>Trends Ecol Evol</source>. <volume>11</volume>:<fpage>367</fpage>–<lpage>372</lpage>.<pub-id pub-id-type="pmid">21237881</pub-id></mixed-citation>
    </ref>
    <ref id="msad106-B77">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>J</given-names></string-name>, <string-name><surname>Ruan</surname><given-names>H</given-names></string-name>, <string-name><surname>Xu</surname><given-names>W</given-names></string-name>, <string-name><surname>Gu</surname><given-names>X</given-names></string-name></person-group>. <year>2019</year>. <article-title>Treeexp2: an integrated framework for phylogenetic transcriptome analysis</article-title>. <source>Genome Biol Evol</source>. <volume>11</volume>:<fpage>3276</fpage>–<lpage>3282</lpage>.<pub-id pub-id-type="pmid">31609424</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
