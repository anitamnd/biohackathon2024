<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id>
    <journal-title-group>
      <journal-title>Scientific Reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-2322</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7935934</article-id>
    <article-id pub-id-type="publisher-id">84781</article-id>
    <article-id pub-id-type="doi">10.1038/s41598-021-84781-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Individualized prediction of COVID-19 adverse outcomes with MLHO</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0204-8978</contrib-id>
        <name>
          <surname>Estiri</surname>
          <given-names>Hossein</given-names>
        </name>
        <address>
          <email>hestiri@mgh.harvard.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Strasser</surname>
          <given-names>Zachary H.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Murphy</surname>
          <given-names>Shawn N.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.32224.35</institution-id><institution-id institution-id-type="ISNI">0000 0004 0386 9924</institution-id><institution>Laboratory of Computer Science, </institution><institution>Massachusetts General Hospital, </institution></institution-wrap>Boston, MA 02144 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.32224.35</institution-id><institution-id institution-id-type="ISNI">0000 0004 0386 9924</institution-id><institution>Department of Medicine, </institution><institution>Massachusetts General Hospital, </institution></institution-wrap>Boston, MA 02114 USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.38142.3c</institution-id><institution-id institution-id-type="ISNI">000000041936754X</institution-id><institution>Harvard Medical School, </institution></institution-wrap>Boston, MA 02115 USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.38142.3c</institution-id><institution-id institution-id-type="ISNI">000000041936754X</institution-id><institution>Department of Biomedical Informatics, </institution><institution>Harvard Medical School, </institution></institution-wrap>Boston, MA 02115 USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.32224.35</institution-id><institution-id institution-id-type="ISNI">0000 0004 0386 9924</institution-id><institution>Department of Neurology, </institution><institution>Massachusetts General Hospital, </institution></institution-wrap>Boston, MA 02114 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>5</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>11</volume>
    <elocation-id>5322</elocation-id>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>9</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>2</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">The COVID-19 pandemic has devastated the world with health and economic wreckage. Precise estimates of adverse outcomes from COVID-19 could have led to better allocation of healthcare resources and more efficient targeted preventive measures, including insight into prioritizing how to best distribute a vaccination. We developed MLHO (pronounced as melo), an end-to-end Machine Learning framework that leverages iterative feature and algorithm selection to predict Health Outcomes. MLHO implements iterative sequential representation mining, and feature and model selection, for predicting patient-level risk of hospitalization, ICU admission, need for mechanical ventilation, and death. It bases this prediction on data from patients’ past medical records (before their COVID-19 infection). MLHO’s architecture enables a parallel and outcome-oriented model calibration, in which different statistical learning algorithms and vectors of features are simultaneously tested to improve prediction of health outcomes. Using clinical and demographic data from a large cohort of over 13,000 COVID-19-positive patients, we modeled the four adverse outcomes utilizing about 600 features representing patients’ pre-COVID health records and demographics. The mean AUC ROC for mortality prediction was 0.91, while the prediction performance ranged between 0.80 and 0.81 for the ICU, hospitalization, and ventilation. We broadly describe the clusters of features that were utilized in modeling and their relative influence for predicting each outcome. Our results demonstrated that while demographic variables (namely age) are important predictors of adverse outcomes after a COVID-19 infection, the incorporation of the past clinical records are vital for a reliable prediction model. As the COVID-19 pandemic unfolds around the world, adaptable and interpretable machine learning frameworks (like MLHO) are crucial to improve our readiness for confronting the potential future waves of COVID-19, as well as other novel infectious diseases that may emerge.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Predictive medicine</kwd>
      <kwd>Risk factors</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par2">The global spread of COVID-19, the disease caused by SARS-CoV-2, has resulted in the loss of around 700,000 lives. Repercussions of the pandemic have wreaked havoc on the economy, sending billions of people into lockdown and resulting in record-high unemployment around the world. The American Hospital Association estimates a total four-month financial impact of over $200 billion in losses for the U.S. healthcare system as a result of cancelled hospital services (e.g., cancelled non-elective surgeries and outpatient treatment) due to the COVID-19 pandemic<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. Our inability to provide precise estimates of COVID-19 outcomes such as death, hospitalization, and need for ICU and ventilation, has contributed to lost opportunities for saving lives with personalized preventive measures and making smart resource allocation plans, such as the distribution of vaccinations. Although our inability to predict was partly due to the novelty of the disease, now the critical question is: do we have the data and technology to accurately predict outcomes?</p>
    <p id="Par3">Over the past decade, the U.S. federal government has made extensive investments to institute meaningful use of electronic health record (EHR) systems. Clinical data in EHRs, however, are still complex and have important quality issues, impeding their ability to address pressing health issues that require rapid responses. Nevertheless, biomedical researchers are increasingly applying data mining and machine learning techniques to clinical data for predicting health outcomes.</p>
    <p id="Par4">Recent studies have shown that COVID-19 disease severity and mortality are associated with a number of comorbidities including cardiovascular disease, diabetes mellitus, hypertension, chronic lung disease, cancer, chronic kidney disease, and obesity, and demographics including age, sex, and race/ethnicity<sup><xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR8">8</xref></sup>. A number of Machine Learning (ML) models have been developed to predict susceptibility in the general population, the likelihood of a positive diagnosis in a patient with symptoms, and prognosis in those with the disease<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. Many of these models are based on a combination of demographics, comorbidities, symptoms, and biomarkers<sup><xref ref-type="bibr" rid="CR10">10</xref>–<xref ref-type="bibr" rid="CR15">15</xref></sup>, and use data from relatively small cohorts of COVID-19 patients. Jiangfent et al.<sup><xref ref-type="bibr" rid="CR10">10</xref></sup> for example, performed a logistic regression analysis on 299 patients that identified age, lymphocyte count, lactate dehydrogenase, and oxygen saturation as independent predictors for mortality. Jiang et al.<sup><xref ref-type="bibr" rid="CR15">15</xref></sup> used data from 53 patients to develop ML models that identified elevated alanine aminotransferase (ALT), the presence of myalgias, and an elevated hemoglobin as the most predictive features for disease severity, achieving approximately 70–80% accuracy in modeling COVID-19 morality. Huang et al.<sup><xref ref-type="bibr" rid="CR11">11</xref></sup> examined clinical data from 125 COVID-19 patients and identified the presence of comorbidities, increased respiratory rate, elevated C-reactive protein, and elevated lactate dehydrogenase as independently associated with a worse prognosis. While the inclusion of vital signs and biomarkers in these models may be highly predictive of some adverse outcomes of COVID-19 infection, they are typically measured after the patient has already started to show signs of the disease and may be at a point that is too late for a useful intervention.</p>
    <p id="Par5">Estiri et al. (2020) introduced the transitive Sequential Pattern Mining (tSPM) along with a dimensionality reduction algorithm (MSMR), and demonstrated that together, the two algorithms can successfully predict different health outcomes<sup><xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup>. The goal in tSPM is to mine temporal data representations from clinical data for application in downstream ML. The MSMR algorithm—the short form stands for Minimize Sparsity, Maximize Relevance—applies high performance dimensionality reduction to tSPM representations. It takes the initial set of N features mined by the tSPM algorithm and provides a list of &lt; 400 features, through a three-step process including frequency-based and information-based (mutual information and joint mutual information) filtering of a large number of features<sup><xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup>.</p>
    <p id="Par6">We adapt the tSPM temporal representation mining and MSMR dimensionality reduction algorithms and make adjustments to architect an end-to-end ML framework that enables iterative feature and algorithm selection to predict Health Outcomes (MLHO, pronounced as melo). MLHO offers an architecture for parallel outcome-targeted calibration of the features and algorithms. The goal in MLHO is to mine relevant data representations and select the most efficient algorithmic solution for accurately predicting future health outcomes. As the COVID-19 pandemic unfolds in many areas of the world, being able to provide personalized predictions of adverse outcomes could be transformative to a healthcare system. In this study, we focus on predicting four outcomes (hospitalization, ICU admission, mechanical ventilation, and death) in patients with a verified COVID-19 infection, using their past medical records. Utilizing about 600 clinical features mined from patients’ past medical records (before contracting COVID-19), we trained and tested predictive models that estimate risks of hospitalization, ICU admission, mechanical ventilation, and death. We also demonstrate and discuss the predictiveness of demographic features, such as age.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <p id="Par7">The overall mortality rate in the patient cohort was 5.3%. Table <xref rid="MOESM1" ref-type="media">1</xref>S provides a summary of demographic characteristics of this patient cohort. White patients had the highest mortality rate (7.3%) of any race or ethnic group. However, the rate of hospitalization and mechanical ventilation was highest among African American/black patients. Compared to females, male COVID-19 patients had a significantly higher chance of hospitalization, ICU admission, ventilation, and mortality. While the average age in the cohort of COVID-19 patients was 51, the average age of patients who were hospitalized, admitted to the ICU, or needed mechanical ventilation was between 62 and 64. The average age of mortality in COVID-19 patients was much higher at 78 (Table <xref rid="MOESM1" ref-type="media">1</xref>S).<table-wrap id="Tab1"><label>Table 1</label><caption><p>The classification performance of the final models.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">Mortality</th><th align="left">ICU</th><th align="left">Ventilation</th><th align="left">Hospitalization</th></tr></thead><tbody><tr><td align="left">Demographic</td><td align="left">0.888<sup>a</sup> (0.887–0.888)<sup>b</sup></td><td align="left">0.756 (0.751–0.76)</td><td align="left">0.773 (0.768–0.778)</td><td align="left">0.736 (0.735–0.737)</td></tr><tr><td align="left">Clinical</td><td align="left">0.865 (0.862–0.868)</td><td align="left">0.784 (0.782–0.786)</td><td align="left">0.748 (0.741–0.755)</td><td align="left">0.777 (0.774–0.780)</td></tr><tr><td align="left">Demographic + clinical</td><td align="left">0.914 (0.910–0.918)</td><td align="left">0.805 (0.801–0.810)</td><td align="left">0.795 (0.791–0.797)</td><td align="left">0.800 (0.798–0.800)</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>Mean</p><p><sup>b</sup>95% Confidence Interval.</p></table-wrap-foot></table-wrap></p>
    <p id="Par8">Figure <xref rid="Fig1" ref-type="fig">1</xref> summarizes the sequential scenarios in which the four adverse outcomes are observed in COVID-19 patients. Overall, in more than 72% of the patients, we did not observe any adverse outcomes. Approximately, 13% of patients were hospitalized and then discharged. The cumulative probability of patients needing to be admitted to the ICU was about 10%, which sorted in a declining order of subsequent sequential events of 5.4% (Hospitalized → ICU → Discharged), to 4.2% (Hospitalized → ICU → Ventilation), to less than 1% (Hospitalized → ICU → Died). This order supports our general hypothesis about the severity spectrum. Of the 5.3% who died, about 4% fall into the sequential scenarios of Hospitalized → ICU → Ventilation → Death, Hospitalized → ICU → Death, and Hospitalized → Death.<fig id="Fig1"><label>Figure 1</label><caption><p>Probability of the sequential scenarios for outcomes after COVID-19 infection.</p></caption><graphic xlink:href="41598_2021_84781_Fig1_HTML" id="MO1"/></fig></p>
    <sec id="Sec3">
      <title>Iterative feature and algorithm selection</title>
      <p id="Par9">In phase 1, MLHO mined over 60 thousand raw (e.g., diagnosis/medication/procedure codes) and 160 million transitive sequential (e.g., medication → diagnosis) representations. Through the iterative feature selection, these features were shrunk to over 2300 representations, about 900 of which were raw features and about 1400 were transitive sequential features. As described in the methods, both MSMR filter method and embedded methods (while training preliminary classification algorithms) were utilized in iterative sampling of train-test data. The other outcome of this step was identification of the top predictive algorithms. Figure <xref rid="Fig2" ref-type="fig">2</xref> illustrates the Area Under the Receiver Operating Characteristic Curve (AUC ROC) results obtained from the ten algorithms for estimating the risk of hospitalization. We found that two Boosting algorithms obtained the best overall results: The Stochastic Gradient Boosting (gbm)—a.k.a., gradient boosting machine—and the eXtreme Gradient Boosting (xgb) with DART booster (xgbDART).<fig id="Fig2"><label>Figure 2</label><caption><p>AUC ROC result of the preliminary classification (phase 1) for predicting hospitalization.</p></caption><graphic xlink:href="41598_2021_84781_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Final modeling</title>
      <p id="Par10">We fed the shrunken clinical feature set (with ~ 2300 features) to the two top algorithms for the final model training—with ten iterative train-test sampling and fivefold cross-validation, which means for each outcome, we trained 20 final clinical models. For each outcome, we then trained 20 demographic models, in which we only used demographic features (age, gender, race, and ethnicity). We also trained 20 models (for each outcome) using the combination of demographic and clinical features. Table <xref rid="Tab1" ref-type="table">1</xref> presents the mean AUC ROC values obtained from the final models for each outcome and feature class, representing the model’s discrimination power.</p>
      <p id="Par11">Overall, the models that relied on both the combined demographic and clinical features resulted in the best modeling performance (as measured by AUC ROC). For predicting mortality and the need for ventilation, demographic models provided slightly superior discrimination power. In contrast, only using the clinical features resulted in superior performance in predicting ICU and hospital admission, over demographic-only models.</p>
      <p id="Par12">To further evaluate the utility of demographic and clinical features for predicting adverse outcomes after COVID-19 infection, we also assessed the models’ reliability for clinical interpretation using diagnostic reliability diagrams (calibration curves). To compare the models, we fitted smoothed trend lines as a representation of the overall calibration curve obtained from the 10 calibration plots for each model (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). The calibration plots are produced from the raw predicted probabilities computed by each algorithm (X axis) against the true probabilities of patients falling under probability bins (Y axis). In a well-calibrated model, the calibration curve appears along the main diagonal—the closer to the line, the more reliable. The calibration curves from the both the clinical and the combined demographic + clinical models provide more reliable predictions than the demographic-only models. Specifically, in predicting the need for ventilation, mortality, and ICU admission, only using the demographic features does not provide clinically reliable estimates of the risk for the adverse outcome.<fig id="Fig3"><label>Figure 3</label><caption><p>The diagnostic reliability diagrams (calibration curves).</p></caption><graphic xlink:href="41598_2021_84781_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Features’ relative influence</title>
      <p id="Par13">The features with the highest weights from the gbm models were assigned to 100, and the remaining values were scaled accordingly<sup>33</sup>. Using only the non-zero relative influence values, a final set of 598 features used for predicting at least one of the outcomes, were identified.</p>
      <p id="Par14">Each feature was then assigned a label to assist with its interpretability. International Classification of Diseases (ICD) codes, both ICD-9 and ICD-10, were assigned to corresponding general comorbidities. This list included cardiovascular disease, chronic renal disease, chronic lung disease, neurological disorder, diabetes mellitus, and other chronic illness. The listed comorbidities were previously identified as associated with poor outcomes in COVID-19<sup>33</sup>. The “Other chronic illness” cluster includes comorbidities such as hypertension, hyperlipidemia, hypothyroidism, obstructive sleep apnea, and obesity. Other features that were included in the clinical model, but that did not fit neatly into a specific comorbidity, were assigned to clusters that described their general category. Many of these categories were labeled as either complex or general depending on the implied severity of the feature. For example, a previous billing code for a critical care encounter was interpreted as a “Complex Inpatient Episode”, whereas a billing code for a 25-min inpatient encounter was interpreted as a “General Inpatient Episode”.</p>
      <p id="Par15">After transforming the features to more interpretable labels, the top five labels of each outcome (excluding age) are listed in Table <xref rid="Tab2" ref-type="table">2</xref>. In each of the combined demographic + clinical models, age is the feature with the greatest influence on the outcome. However, after age, the features with influence varied significantly between the different models.<table-wrap id="Tab2"><label>Table 2</label><caption><p>The top five ranked features from the clinical records that are associated with death, ICU admission, mechanical ventilation, and hospitalization.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Death</th><th align="left">ICU</th><th align="left">Ventilation</th><th align="left">Hospitalization</th></tr></thead><tbody><tr><td align="left"><p>Neurological disorder</p><p><italic>(Unspecified delirium)*</italic></p></td><td align="left"><p>Imaging <italic>(Electrocardiogram)</italic>- &gt; Inpatient medication</p><p><italic>(Liquid acetaminophen)</italic></p></td><td align="left"><p>Complex inpatient episode</p><p><italic>(Patient encounter billing, complex med)</italic></p></td><td align="left"><p>Inpatient episode</p><p><italic>(Patient encounter billing)</italic></p></td></tr><tr><td align="left"><p>Cardiovascular disease</p><p><italic>(Unspecified heart failure)</italic></p></td><td align="left"><p>Complex inpatient episode</p><p><italic>(Patient encounter billing, complex med)</italic></p></td><td align="left"><p>Chronic lung disease</p><p>(Interstitial Pulmonary Disease)</p></td><td align="left"><p>Complex inpatient episode</p><p><italic>(Patient encounter billing, complex med)</italic></p></td></tr><tr><td align="left"><p>Other chronic illness</p><p><italic>(Hypertension)</italic></p></td><td align="left"><p>Inpatient Procedure</p><p><italic>(Venous blood draw)</italic></p></td><td align="left"><p>Inpatient medication</p><p><italic>(Subcutaneous NPH insulin)</italic></p></td><td align="left"><p>Complex inpatient episode</p><p><italic>(Patient encounter billing, complex med)</italic></p></td></tr><tr><td align="left"><p>Diabetes mellitus &amp; Chronic renal disease</p><p><italic>(Type II diabetes w/chronic kidney disease)</italic></p></td><td align="left"><p>Other chronic illness <italic>(Hypertension)</italic></p><p>- &gt; Inpatient medication</p><p><italic>(Liquid acetaminophen)</italic></p></td><td align="left"><p>Lab Value</p><p><italic>(Proteinuria)</italic></p></td><td align="left"><p>Inpatient episode</p><p><italic>(Patient encounter billing)</italic></p></td></tr><tr><td align="left"><p>Imaging</p><p><italic>(CT scan of abdomen)</italic></p></td><td align="left"><p>Inpatient medication</p><p><italic>(IV ceftriaxone)</italic></p></td><td align="left"><p>Diabetes mellitus</p><p><italic>(Type II Diabetes w/Foot Ulcer)</italic></p></td><td align="left"><p>Inpatient procedure</p><p>(Chest X-ray)</p></td></tr></tbody></table><table-wrap-foot><p>*Parentheses below each of the interpreted terms include a shorthand version of the actual feature.</p></table-wrap-foot></table-wrap></p>
      <p id="Par16">For mortality, the critical features were neurological disorder, cardiovascular disease, other chronic illness, diabetes mellitus and chronic kidney disease. The features with the greatest weight for predicting an ICU admission were healthcare utilization episodes including previous complex inpatient episodes, inpatient procedures, and inpatient medications. Some of the ICU features included transitive sequence features that captured common patient narratives. For example, a previous imaging episode followed by an inpatient medication was helpful for predicting an ICU admission. In this case, both previous complex inpatient episodes and inpatient medications were the most important features for determining the outcome. The critical features for predicting mechanical ventilation were a combination of chronic lung disease and significant healthcare utilization. Finally, the top features for a hospitalization were almost entirely billing codes that suggested a previous hospitalization.</p>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Discussion</title>
    <p id="Par17">Using the MLHO framework, we developed models for predicting risks of hospitalization, ICU admission, need for mechanical ventilation, and death for patients infected with COVID-19. We were able to model the four adverse outcomes with about 600 features from patients’ past medical records, before they contracted COVID-19. MLHO can leverage the past medical records in clinical repositories to quickly develop predictive models with acceptable accuracy. One could envision different applications for such predictions. For example, we could aggregate MLHO’s predictions based on a population’s expected rates of infection during a pandemic, to better allocate healthcare resources in preparation for a surge in cases. It could also help inform the allocation of critical care nurses and doctors, ventilators, hospital beds, and supplies in the case of a resurgence of the pandemic.</p>
    <p id="Par18">Being able to predict outcomes can create possibilities for better preventive measures. For instance, healthcare systems and regional health authorities can estimate the probability of an outcome, to identify patients who might be at higher risk and plan for more intensive preventive measures such as alerting the patients’ primary care providers to prioritize healthcare maintenance visits. At such an appointment, one could ensure the patient is up-to-date on immunizations and have an in-person discussion on the importance of taking precaution against contracting COVID-19. Given there are limited resources for addressing this public health crisis, being able to estimate the relative risk even among otherwise seemingly similar populations could be extremely advantageous. For example, the algorithm could help determine who among a nursing home population has the greatest need for receiving a vaccination.</p>
    <p id="Par19">The average age of infection in this cohort was 51. The average age for hospitalization, mechanical ventilation, or ICU admission was between 62 and 64. But the average age of death was 78. While the best performing models were a combination of all of the clinical records including demographics and clinical features, age was always the highest weighted feature in every model for determining the adverse outcome. The models’ dependence on age, emphasizes that COVID-19 is a disease that poses extreme risk to the elderly. No other features of the clinical record, including comorbidities or previous hospitalizations, have as much of an impact on predicting how an individual will respond to contracting COVID-19.</p>
    <p id="Par20">Evaluating the top weighted features of the model excluding age, gives insight into how each of the models relies on specific sets of features for making its prediction. The most important features identified for predicting mortality, correspond well with many of the known associations of disease severity in COVID-19<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>. This includes cardiovascular disease, neurological disease, chronic kidney disease, diabetes mellitus, and other chronic illnesses. Features predictive of future ventilation include chronic lung disease and previous complex hospitalizations. For predicting ventilation, the model accurately identifies medically relevant features for who would need intensive respiratory support. In the case of ICU admissions and hospitalizations, the models depend to a greater extent on previous healthcare utilization such as inpatient stays, inpatient medications, and inpatient procedures. These healthcare utilization features are likely correlated with underlying disease, but they collectively predict a subsequent hospitalization or ICU admission better than the chronic diseases themselves. All four of the outcome models have their highest AUC when clinical records are incorporated with the demographics. The diagnostic labels in the clinical records are critical for predicting mortality and ventilation, whereas it is the healthcare processes embedded in the clinical records that are relatively more important for predicting ICU and hospital admissions.</p>
  </sec>
  <sec id="Sec7">
    <title>Methods</title>
    <p id="Par21">MLHO mines both sequential temporal and raw data representations from clinical data and performs iterative feature and algorithm selection in a 2-phase process to learn from the unfolding COVID-19 pandemic (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). MLHO’s architecture enables a parallel outcome-targeted calibration of the features and algorithms, in which different statistical learning algorithms and vectors of features are simultaneously tested and leveraged to improve prediction of health outcomes. The four adverse outcomes of interest in this study reflect a hypothetical sequential spectrum of outcome severity in patients with verified COVID-19 infection, ranging from hospitalization to ICU admission, to need for mechanical ventilation, and ultimately to death (Hospitalization → ICU → Ventilation →  Death).<fig id="Fig4"><label>Figure 4</label><caption><p>Implementation of the MLHO framework for predicting COVID-19 adverse outcomes.</p></caption><graphic xlink:href="41598_2021_84781_Fig4_HTML" id="MO4"/></fig></p>
  </sec>
  <sec id="Sec8">
    <title>Experimental setup</title>
    <p id="Par24">We used electronic health records data from over 13,400 patients with a confirmed case for COVID-19 between March and September 2020 and who had at least 1 year of medical history with Mass General Brigham (MGB), since 2016. Table <xref rid="MOESM1" ref-type="media">1</xref>S presents general demographic information about the study cohort. For each patient, we only included clinical records from 14 days prior to the positive COVID-19 test date. This temporal buffer ensures that no COVID-19-related medical conditions are included in the model as a risk factor. The use of data for this study was approved by the Mass General Brigham Institutional Review Board (2020P001063)—a waiver of informed consent was also approved. All research was performed in accordance with relevant guidelines and regulations. We randomly split the data with an 80–20 training-to-testing ratio. We iterated the train-test sampling ten times to account for possible patient population differences caused by the sampling.</p>
    <sec id="Sec9">
      <title>Representation mining</title>
      <p id="Par25">We used the tSPM algorithm to mine temporal sequential representations. Given a list of clinical records <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{R}_{1}, {R}_{2},..., R}_{n}$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq1.gif"/></alternatives></inline-formula> for patient <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p$$\end{document}</tex-math><mml:math id="M4"><mml:mi>p</mml:mi></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq2.gif"/></alternatives></inline-formula> at times <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${t}_{i1}\le {t}_{i2}\le ... \le {t}_{i{k}_{i}}$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>≤</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq3.gif"/></alternatives></inline-formula>, the tSPM algorithm mines all avector of transitive sequential patterns <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{ij}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq4.gif"/></alternatives></inline-formula> from possible pairs of distinct records <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$({R}_{i},{R}_{j}),$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq5.gif"/></alternatives></inline-formula> where <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i\ne j\le n,$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq6.gif"/></alternatives></inline-formula> by setting <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{ij}$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq7.gif"/></alternatives></inline-formula>(as samples of random variable <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{ij}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq8.gif"/></alternatives></inline-formula> for patient <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p$$\end{document}</tex-math><mml:math id="M18"><mml:mi>p</mml:mi></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq9.gif"/></alternatives></inline-formula>) to be 1 if <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${k}_{i}\ge 1, {k}_{j}\ge 1$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq10.gif"/></alternatives></inline-formula> and <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${t}_{i1}\le {t}_{ji},$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">ji</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq11.gif"/></alternatives></inline-formula> and 0 otherwise. We also mined raw representations from the clinical data, which are composed of all clinical records. To obtain a count of the raw records, for each patient <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p$$\end{document}</tex-math><mml:math id="M24"><mml:mi>p</mml:mi></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq12.gif"/></alternatives></inline-formula>, we sum the frequency of <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${k}_{1}, {k}_{2}, ...,{k}_{n}$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq13.gif"/></alternatives></inline-formula>, as samples of a random variable <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{i}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq14.gif"/></alternatives></inline-formula>. On the training sets, we performed feature and algorithm selection (phase 1) and the final predictive modeling (phase 2). We feed the combined representations <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X^{\prime}=({X}_{i}\cup {X}_{ij}{)}_{i\ne j}$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo></mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∪</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq15.gif"/></alternatives></inline-formula> to the feature selection step.</p>
    </sec>
    <sec id="Sec10">
      <title>Phase 1: iterative feature and algorithm selection</title>
      <p id="Par26">In phase 1, as many aspects of the COVID-19 pandemic was still unknown, we perform iterative feature and model selection on weekly-updated data from COVID-19 patients during the first four months of the pandemic (March–June 2020). Unlike other studies that begin with a limited set of hypothetical risk factors, we took a primarily inductive approach to selecting clinical representations for predicting the risk of adverse outcomes in COVID-19 patients. First, we apply a filter method for feature selection, using a computational algorithm that minimizes sparsity and maximizes relevance (MSMR<sup><xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup>). Step 1 in MSMR is to cut the initial combined vector of representations <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X^{\prime}$$\end{document}</tex-math><mml:math id="M32"><mml:msup><mml:mi>X</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq16.gif"/></alternatives></inline-formula> to those that were observed in fewer than 0.2 percent of the patients. On the remaining representations, step 2 in MSMR computes the mutual information with the outcome variable <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y= ({y}_{1}, ..., {y}_{i}),$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq17.gif"/></alternatives></inline-formula> which in this study includes labels for hospitalization, ICU, ventilation, and death. Mutual information<sup><xref ref-type="bibr" rid="CR18">18</xref>,<xref ref-type="bibr" rid="CR19">19</xref></sup>, in this case, measures the amount of information that each remaining representation contains about the outcome. Given the joint probability distribution <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{X^{\prime}Y}(x^{\prime},y)$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq18.gif"/></alternatives></inline-formula>, the mutual information between them is denoted as <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I(X^{\prime}:Y)$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>:</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq19.gif"/></alternatives></inline-formula> is:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sum }_{x^{\prime}y}{P}_{X^{\prime}Y}(x^{\prime},y)\times log\frac{{P}_{X^{\prime}Y}(x^{\prime},y)}{{P}_{X^{\prime}}(x^{\prime}) {\times P}_{Y}(y)}$$\end{document}</tex-math><mml:math id="M40" display="block"><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mfrac><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:msup><mml:mi>X</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mo>×</mml:mo><mml:mi>P</mml:mi></mml:mrow><mml:mi>Y</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="41598_2021_84781_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par27">We cut the remaining representations from <inline-formula id="IEq20"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X^{\prime}$$\end{document}</tex-math><mml:math id="M42"><mml:msup><mml:mi>X</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq20.gif"/></alternatives></inline-formula> by ranking based on the mutual information coefficient, and update <inline-formula id="IEq21"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X^{\prime}$$\end{document}</tex-math><mml:math id="M44"><mml:msup><mml:mi>X</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq21.gif"/></alternatives></inline-formula> to a list of around 30,000 representations with the highest mutual information. In the third and final step, MSMR computes the joint mutual information (JMI)<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> score for the updated vector of remaining representations, <inline-formula id="IEq22"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X^{\prime}$$\end{document}</tex-math><mml:math id="M46"><mml:msup><mml:mi>X</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq22.gif"/></alternatives></inline-formula>. The algorithm starts with a set <inline-formula id="IEq23"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S$$\end{document}</tex-math><mml:math id="M48"><mml:mi>S</mml:mi></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq23.gif"/></alternatives></inline-formula> containing the top feature according to mutual information, then iteratively adds to <inline-formula id="IEq24"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S$$\end{document}</tex-math><mml:math id="M50"><mml:mi>S</mml:mi></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq24.gif"/></alternatives></inline-formula> the features maximizing the joint mutual information score<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${J}_{jmi}(X^{\prime}) = {\sum }_{X{^{\prime}}^{*}\in S}I(X^{\prime}X{^{\prime}}^{*};Y)$$\end{document}</tex-math><mml:math id="M52" display="block"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi mathvariant="italic">jmi</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>X</mml:mi><mml:msup><mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi>X</mml:mi><mml:msup><mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>;</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="41598_2021_84781_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where the random variable <inline-formula id="IEq25"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X^{\prime}X{^{\prime}}^{*}$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi>X</mml:mi><mml:msup><mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq25.gif"/></alternatives></inline-formula> corresponds to the joint distribution of <inline-formula id="IEq26"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X^{\prime}$$\end{document}</tex-math><mml:math id="M56"><mml:msup><mml:mi>X</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq26.gif"/></alternatives></inline-formula> and <inline-formula id="IEq27"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X{^{\prime}}^{*}$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:mi>X</mml:mi><mml:msup><mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq27.gif"/></alternatives></inline-formula>. As a result, JMI also takes into account the redundancy between the features—i.e., reducing multicollinearity among covariates. Second, we combine the feature selection with a preliminary evaluation of algorithms for the prediction task.</p>
      <p id="Par29">Using the &lt; 400 clinical features identified by the MSMR algorithm, we train a set of preliminary classification algorithms that perform embedded feature selection. The preliminary classification serves two goals. First, we screened features used in those algorithms to compile a list of the common features used for modeling the four outcomes. Second, during each sampling iteration, we computed the Area Under the Receiver Operating Characteristic Curve (AUC ROC) on the held-out test sets to evaluate the algorithms’ performance for predicting the outcome labels. We used tenfold cross-validation to train the prediction algorithm—therefore, a 72-8-20, train-evaluation-test split. We tested ten classification algorithms—bartMachine: Bayesian Additive Regression Trees<sup><xref ref-type="bibr" rid="CR21">21</xref>,<xref ref-type="bibr" rid="CR22">22</xref></sup>, Stacked AutoEncoder Deep Neural Network (dnn), Stochastic Gradient Boosting (gbm)<sup><xref ref-type="bibr" rid="CR23">23</xref>,<xref ref-type="bibr" rid="CR24">24</xref></sup>, glmboost: Boosted Generalized Linear Model, eXtreme Gradient Boosting (xgb)<sup><xref ref-type="bibr" rid="CR25">25</xref></sup> with DART booster (xgbDART)<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>, linear model solver (xgbLinear), tree learning (xgbTree), model-averaged Neural Network (avNNet), Elastic-Net regularized generalized linear model (glmnet)<sup><xref ref-type="bibr" rid="CR27">27</xref>,<xref ref-type="bibr" rid="CR28">28</xref></sup>, and Oblique random forest (ORFlog)<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>.</p>
    </sec>
    <sec id="Sec11">
      <title>Phase 2: calibrated predictive modeling</title>
      <p id="Par30">The iterative feature and algorithm (preliminary classification) selection in phase 1 results in a set of common features and a ranking of classification algorithms. The predictive modeling in phase 2 are therefore calibrated specific outcomes. We use the top-performing algorithms (as measured by AUC ROC) and the common clinical features to perform a final round of training predictive models with ten train-test sampling iteration and tenfold cross-validation in phase 2.</p>
      <p id="Par31">We summarize and report the AUC ROCs and calibration curves from the final models as well as the features’ relative influence values. Further, we evaluate the role of demographic covariates in predicting the adverse outcomes after COVID-19 infection. To do so, we run three classes of models using: (1) only clinical features (from MLHO’s phase 1), (2) only demographic features (age, gender, race, and ethnicity), and (3) clinical plus demographic features.</p>
      <p id="Par32">As we shall reveal in the results, the gbm algorithm was one of the top 2 performing algorithms. As a result, we computed the relative feature influence metrics from the final gbm models to measure features’ importance. In the gbm model, boosting estimates <inline-formula id="IEq28"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{F}(X)$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq28.gif"/></alternatives></inline-formula> as an ‘additive’ expansion of the form<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{F}(X) ={\sum }_{m=0}^{M}{\beta }_{m}h(X;{a}_{m})$$\end{document}</tex-math><mml:math id="M62" display="block"><mml:mrow><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:msub><mml:mi>β</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="41598_2021_84781_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where the expansion coefficients <inline-formula id="IEq29"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\{{\beta }_{m}\}}_{0}^{M}$$\end{document}</tex-math><mml:math id="M64"><mml:msubsup><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq29.gif"/></alternatives></inline-formula> and the base learner’s—<inline-formula id="IEq30"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h\left(X;a\right)$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mi>h</mml:mi><mml:mfenced close=")" open="("><mml:mi>X</mml:mi><mml:mo>;</mml:mo><mml:mi>a</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq30.gif"/></alternatives></inline-formula>—parameters <inline-formula id="IEq31"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\{{a}_{m}\}}_{0}^{M}$$\end{document}</tex-math><mml:math id="M68"><mml:msubsup><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq31.gif"/></alternatives></inline-formula> are jointly fit to the training data in a feedforward process. A regression tree model specializes tue base learner <inline-formula id="IEq32"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{m}(X;{\{{R}_{jm}\}}_{1}^{J})$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>;</mml:mo><mml:msubsup><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="italic">jm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq32.gif"/></alternatives></inline-formula> partitions the feature space into <inline-formula id="IEq33"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J$$\end{document}</tex-math><mml:math id="M72"><mml:mi>J</mml:mi></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq33.gif"/></alternatives></inline-formula> disjoint regions <inline-formula id="IEq34"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\{{R}_{jm}\}}_{j=1}^{J}$$\end{document}</tex-math><mml:math id="M74"><mml:msubsup><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="italic">jm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq34.gif"/></alternatives></inline-formula> to predict a different constant value for each<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>. The relative influence (or contribution), <inline-formula id="IEq35"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${I}_{j}^{2}$$\end{document}</tex-math><mml:math id="M76"><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq35.gif"/></alternatives></inline-formula> averages the improvement made by each variable when it is permuted from all trees in which the given variable was incorporated<sup><xref ref-type="bibr" rid="CR30">30</xref>,<xref ref-type="bibr" rid="CR31">31</xref></sup>. In an additive tree model, the relative influence measure is provided by Friedman and Meulman (2003)<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${I}_{j}^{2}= \frac{1}{M}{\sum }_{m=1}^{M}{I}_{j}^{2}({T}_{m})$$\end{document}</tex-math><mml:math id="M78" display="block"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>M</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="41598_2021_84781_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq36"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${I}_{j}^{2}(T)$$\end{document}</tex-math><mml:math id="M80"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq36.gif"/></alternatives></inline-formula> is the measure of relevance for a single tree <inline-formula id="IEq37"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T$$\end{document}</tex-math><mml:math id="M82"><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="41598_2021_84781_Article_IEq37.gif"/></alternatives></inline-formula><sup><xref ref-type="bibr" rid="CR32">32</xref></sup>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec12">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41598_2021_84781_MOESM1_ESM.docx">
            <caption>
              <p>Supplementary Information.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary Information</title>
    <p>The online version contains supplementary material available at 10.1038/s41598-021-84781-x.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This work was supported by the National Human Genome Research Institute grants R01-HG009174 and 3U01HG008685-05S2 and the National Library of Medicine Grant T15LM007092.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>Conceptualization, H.E., Z.H.S, and S.N.M.; Methodology, H.E.; Formal Analysis, H.E.; Investigation, H.E. and Z.H.S.; Writing—Original Draft, H.E. and Z.H.S.; Writing—Review &amp; Editing, H.E. and Z.H.S.; Funding Acquisition, S.N.M.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>Protected Health Information restrictions apply to the availability of the clinical data here, which were used under IRB approval for use only in the current study. As a result, this dataset is not publicly available.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>The computer code for MLHO is available at: <ext-link ext-link-type="uri" xlink:href="https://www.hestiri.github.io/mlho">https://hestiri.github.io/mlho</ext-link>.</p>
  </notes>
  <notes id="FPar1" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par35">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other"><italic>Hospitals and Health Systems Face Unprecedented Financial Pressures Due to COVID-19</italic>. <ext-link ext-link-type="uri" xlink:href="https://www.aha.org/guidesreports/2020-05-05-hospitals-and-health-systems-face-unprecedented-financial-pressures-due">https://www.aha.org/guidesreports/2020-05-05-hospitals-and-health-systems-face-unprecedented-financial-pressures-due</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>McGoogan</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Characteristics of and important lessons from the coronavirus disease 2019 (COVID-19) outbreak in China: Summary of a report of 72 314 cases from the Chinese Center for Disease Control and Prevention</article-title>
        <source>JAMA</source>
        <year>2020</year>
        <volume>323</volume>
        <fpage>1239</fpage>
        <lpage>1242</lpage>
        <pub-id pub-id-type="doi">10.1001/jama.2020.2648</pub-id>
        <pub-id pub-id-type="pmid">32091533</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Petrilli</surname>
            <given-names>CM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Factors associated with hospital admission and critical illness among 5279 people with coronavirus disease 2019 in New York City: Prospective cohort study</article-title>
        <source>BMJ</source>
        <year>2020</year>
        <volume>369</volume>
        <fpage>m1966</fpage>
        <pub-id pub-id-type="doi">10.1136/bmj.m1966</pub-id>
        <pub-id pub-id-type="pmid">32444366</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Clinical course and risk factors for mortality of adult inpatients with COVID-19 in Wuhan, China: A retrospective cohort study</article-title>
        <source>Lancet</source>
        <year>2020</year>
        <volume>395</volume>
        <fpage>1054</fpage>
        <lpage>1062</lpage>
        <pub-id pub-id-type="doi">10.1016/S0140-6736(20)30566-3</pub-id>
        <pub-id pub-id-type="pmid">32171076</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liang</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cancer patients in SARS-CoV-2 infection: A nationwide analysis in China</article-title>
        <source>Lancet Oncol.</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>335</fpage>
        <lpage>337</lpage>
        <pub-id pub-id-type="doi">10.1016/S1470-2045(20)30096-6</pub-id>
        <pub-id pub-id-type="pmid">32066541</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Covid</surname>
            <given-names>CDC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Preliminary estimates of the prevalence of selected underlying health conditions among patients with coronavirus disease 2019—United States, February 12–March 28, 2020</article-title>
        <source>MMWR Surveill. Summ.</source>
        <year>2020</year>
        <volume>69</volume>
        <fpage>382</fpage>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lighter</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Obesity in patients younger than 60 years is a risk factor for COVID-19 hospital admission</article-title>
        <source>Clin. Infect. Dis.</source>
        <year>2020</year>
        <volume>71</volume>
        <fpage>896</fpage>
        <lpage>897</lpage>
        <pub-id pub-id-type="doi">10.1093/cid/ciaa415</pub-id>
        <pub-id pub-id-type="pmid">32271368</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Williamson</surname>
            <given-names>EJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>OpenSAFELY: factors associated with COVID-19 death in 17 million patients</article-title>
        <source>Nature</source>
        <year>2020</year>
        <pub-id pub-id-type="doi">10.1038/s41586-020-2521-4</pub-id>
        <?supplied-pmid 32788729?>
        <pub-id pub-id-type="pmid">32788729</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wynants</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Prediction models for diagnosis and prognosis of covid-19 infection: Systematic review and critical appraisal</article-title>
        <source>BMJ</source>
        <year>2020</year>
        <volume>369</volume>
        <fpage>m1328</fpage>
        <pub-id pub-id-type="doi">10.1136/bmj.m1328</pub-id>
        <pub-id pub-id-type="pmid">32265220</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Jianfeng, X. <italic>et al.</italic><italic>Development and External Validation of a Prognostic Multivariable Model on Admission for Hospitalized Patients with COVID-19</italic>. <ext-link ext-link-type="uri" xlink:href="https://www.medrxiv.org/content/medrxiv/early/2020/03/30/2020.03.28.20045997.full.pdf">https://www.medrxiv.org/content/medrxiv/early/2020/03/30/2020.03.28.20045997.full.pdf</ext-link> (2020).</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Huang <italic>et al.</italic> Prognostic factors for COVID-19 pneumonia progression to severe symptom based on the earlier clinical features: A retrospective analysis. 10.1101/2020.03.28.20045989.</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Yan, L. <italic>et al.</italic> Prediction of criticality in patients with severe Covid-19 infection using three clinical features: A machine learning-based prognostic model with clinical data in Wuhan. <italic>MedRxiv</italic> (2020).</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Sarkar, J. &amp; Chakrabarti, P. A machine learning model reveals older age and delayed hospitalization as predictors of mortality in patients with COVID-19. 10.1101/2020.03.25.20043331.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">McRae, M. P. <italic>et al.</italic> Clinical decision support tool and rapid point-of-care platform for determining disease severity in patients with COVID-19. <italic>medRxiv.</italic>10.1101/2020.04.16.20068411 (2020).</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Towards an artificial intelligence framework for data-driven prediction of coronavirus clinical severity</article-title>
        <source>CMC Comput. Mater. Contin.</source>
        <year>2020</year>
        <volume>63</volume>
        <fpage>537</fpage>
        <lpage>551</lpage>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Estiri, H., Strasser, Z.H., Klann, J.G., McCoy, T.H. Jr., Wagholikar, K.B., Vasey, S., Castro, V.M., Murphy, M.E., Murphy, S.N. Transitive sequencing medical records for mining predictive and interpretable temporal representations. <italic>Patterns</italic> (2020).</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Estiri, H., Vasey, S., Murphy, S.N. Transitive sequential pattern mining for discrete clinical data. in <italic>Artificial Intelligence in Medicine</italic> (ed. Martin Michalowski, R. M.) (Springer, 2020).</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shannon</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Weaver</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Recent contributions to the mathematical theory of communication</article-title>
        <source>Math. Theory Commun.</source>
        <year>1949</year>
        <volume>1</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Cover, T. M. &amp; Thomas, J. A. <italic>Elements of Information Theory</italic>. (Wiley, 2012).</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Battiti</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Using mutual information for selecting features in supervised neural net learning</article-title>
        <source>IEEE Trans. Neural Netw.</source>
        <year>1994</year>
        <volume>5</volume>
        <fpage>537</fpage>
        <lpage>550</lpage>
        <pub-id pub-id-type="doi">10.1109/72.298224</pub-id>
        <pub-id pub-id-type="pmid">18267827</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chipman</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>George</surname>
            <given-names>EI</given-names>
          </name>
          <name>
            <surname>McCulloch</surname>
            <given-names>RE</given-names>
          </name>
        </person-group>
        <article-title>BART: Bayesian additive regression trees</article-title>
        <source>Ann. Appl. Stat.</source>
        <year>2010</year>
        <volume>4</volume>
        <fpage>266</fpage>
        <lpage>298</lpage>
        <pub-id pub-id-type="doi">10.1214/09-AOAS285</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kapelner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bleich</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>bartMachine: Machine learning with bayesian additive regression trees</article-title>
        <source>J. Stat. Softw. Articles</source>
        <year>2016</year>
        <volume>70</volume>
        <fpage>1</fpage>
        <lpage>40</lpage>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Friedman</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>Stochastic gradient boosting</article-title>
        <source>Comput. Stat. Data Anal.</source>
        <year>2002</year>
        <volume>38</volume>
        <fpage>367</fpage>
        <lpage>378</lpage>
        <pub-id pub-id-type="doi">10.1016/S0167-9473(01)00065-2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Greenwell, B., Boehmke, B., Cunningham, J., Developers, G. B. M. &amp; Greenwell, M. B. Package ‘gbm’. in <italic>R Package Version</italic> 2 (2019).</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">Chen, T. &amp; Guestrin, C. XGBoost: A scalable tree boosting system. in <italic>Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</italic> 785–794 (Association for Computing Machinery, 2016).</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Vinayak, R. K. &amp; Gilad-Bachrach, R. DART: Dropouts meet multiple additive regression trees. in <italic>Proceedings of the Eighteenth International Conference on Artificial Intelligence and Statistics</italic> (eds. Lebanon, G. &amp; Vishwanathan, S. V. N.) Vol. 38 489–497 (PMLR, 2015).</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Friedman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Regularization paths for generalized linear models via coordinate descent</article-title>
        <source>J. Stat. Softw.</source>
        <year>2010</year>
        <volume>33</volume>
        <fpage>1</fpage>
        <pub-id pub-id-type="doi">10.18637/jss.v033.i01</pub-id>
        <pub-id pub-id-type="pmid">20808728</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Simon, N., Friedman, J. &amp; Hastie, T. <italic>A Blockwise Descent Algorithm for Group-penalized Multiresponse and Multinomial Regression</italic>. arXiv [stat.CO] (2013).</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Menze, B. H., Kelm, B. M., Splitthoff, D. N., Koethe, U. &amp; Hamprecht, F. A. On oblique random forests. in <italic>Machine Learning and Knowledge Discovery in Databases</italic> 453–469 (Springer, 2011).</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Friedman</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Meulman</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>Multiple additive regression trees with application in epidemiology</article-title>
        <source>Stat. Med.</source>
        <year>2003</year>
        <volume>22</volume>
        <fpage>1365</fpage>
        <lpage>1381</lpage>
        <pub-id pub-id-type="doi">10.1002/sim.1501</pub-id>
        <pub-id pub-id-type="pmid">12704603</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Friedman</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>Greedy function approximation: A gradient boosting machine</article-title>
        <source>Ann. Stat.</source>
        <year>2001</year>
        <volume>29</volume>
        <fpage>1189</fpage>
        <lpage>1232</lpage>
        <pub-id pub-id-type="doi">10.1214/aos/1013203451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Breiman, L., Friedman, J., Stone, C. J. &amp; Olshen, R. A. <italic>Classification and Regression Trees</italic>. (CRC Press, 1984).</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>COVID, C. D. C. &amp; Team, R</collab>
        </person-group>
        <article-title>Severe outcomes among patients with coronavirus disease 2019 (COVID-19)—United States, February 12–March 16, 2020</article-title>
        <source>MMWR Morb. Mortal. Wkly. Rep.</source>
        <year>2020</year>
        <volume>69</volume>
        <fpage>343</fpage>
        <lpage>346</lpage>
        <pub-id pub-id-type="doi">10.15585/mmwr.mm6912e2</pub-id>
        <pub-id pub-id-type="pmid">32214079</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
