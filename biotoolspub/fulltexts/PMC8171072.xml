<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Acta Crystallogr D Struct Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Acta Crystallogr D Struct Biol</journal-id>
    <journal-id journal-id-type="publisher-id">Acta Cryst. D</journal-id>
    <journal-title-group>
      <journal-title>Acta Crystallographica. Section D, Structural Biology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2059-7983</issn>
    <publisher>
      <publisher-name>International Union of Crystallography</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8171072</article-id>
    <article-id pub-id-type="publisher-id">tz5106</article-id>
    <article-id pub-id-type="doi">10.1107/S2059798321003818</article-id>
    <article-id pub-id-type="coden">ACSDAD</article-id>
    <article-id pub-id-type="pii">S2059798321003818</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Papers</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>FragMAXapp</italic>: crystallographic fragment-screening data-analysis and project-management system</article-title>
      <alt-title>
        <italic>FragMAXapp</italic>
      </alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-0011-5559</contrib-id>
        <name>
          <surname>Lima</surname>
          <given-names>Gustavo M. A.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
        <xref ref-type="author-notes" rid="aunote1">‡</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jagudin</surname>
          <given-names>Elmir</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-1135-2744</contrib-id>
        <name>
          <surname>Talibov</surname>
          <given-names>Vladimir O.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-6369-8707</contrib-id>
        <name>
          <surname>Benz</surname>
          <given-names>Laila S.</given-names>
        </name>
        <xref ref-type="aff" rid="b">b</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Marullo</surname>
          <given-names>Costantino</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-8747-3112</contrib-id>
        <name>
          <surname>Barthel</surname>
          <given-names>Tatjana</given-names>
        </name>
        <xref ref-type="aff" rid="c">c</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-3418-5213</contrib-id>
        <name>
          <surname>Wollenhaupt</surname>
          <given-names>Jan</given-names>
        </name>
        <xref ref-type="aff" rid="c">c</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-2362-7047</contrib-id>
        <name>
          <surname>Weiss</surname>
          <given-names>Manfred S.</given-names>
        </name>
        <xref ref-type="aff" rid="c">c</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-7139-0718</contrib-id>
        <name>
          <surname>Mueller</surname>
          <given-names>Uwe</given-names>
        </name>
        <xref ref-type="aff" rid="c">c</xref>
        <xref ref-type="corresp" rid="cor">*</xref>
      </contrib>
      <aff id="a"><label>a</label>BioMAX, <institution>MAX IV Laboratory</institution>, Fotongatan 2, 224 84 Lund, <country>Sweden</country></aff>
      <aff id="b"><label>b</label>Institut für Chemie und Biochemie, <institution>Freie Universität Berlin</institution>, Thielallee 63, 14195 Berlin, <country>Germany</country></aff>
      <aff id="c"><label>c</label>Macromolecular Crystallography, <institution>Helmholtz-Zentrum Berlin</institution>, Albert-Einstein-Strasse 15, 12489 Berlin, <country>Germany</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor">Correspondence e-mail: <email>uwe.mueller@helmholtz-berlin.de</email></corresp>
      <fn id="aunote1">
        <label>‡</label>
        <p>Current address: Astex Pharmaceuticals, 436 Cambridge Science Park, Milton Road, Cambridge CB4 0QA, United Kingdom.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>6</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>77</volume>
    <issue>Pt 6</issue>
    <issue-id pub-id-type="publisher-id">d210600</issue-id>
    <fpage>799</fpage>
    <lpage>808</lpage>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>9</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>08</day>
        <month>4</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Lima et al. 2021</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution (CC-BY) Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original authors and source are cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="https://doi.org/10.1107/S2059798321003818">A full version of this article is available from Crystallography Journals Online.</self-uri>
    <abstract abstract-type="toc">
      <p>The amount of data generated during crystallographic fragment-screening projects requires sophisticated automated methods to analyse the data and to identify binders. <italic>FragMAXapp</italic> is the MAX IV Laboratory approach to managing fragment-screening campaigns: a web application that provides scientists with access to the MAX IV computing cluster and visualization tools.</p>
    </abstract>
    <abstract>
      <p>Crystallographic fragment screening (CFS) has become one of the major techniques for screening compounds in the early stages of drug-discovery projects. Following the advances in automation and throughput at modern macromolecular crystallography beamlines, the bottleneck for CFS has shifted from collecting data to organizing and handling the analysis of such projects. The complexity that emerges from the use of multiple methods for processing and refinement and to search for ligands requires an equally sophisticated solution to summarize the output, allowing researchers to focus on the scientific questions instead of on software technicalities. <italic>FragMAXapp</italic> is the fragment-screening project-management tool designed to handle CFS projects at MAX IV Laboratory. It benefits from the powerful computing infrastructure of large-scale facilities and, as a web application, it is accessible from everywhere.</p>
    </abstract>
    <kwd-group>
      <kwd>fragment screening</kwd>
      <kwd>high-throughput data analysis</kwd>
      <kwd>protein crystallography</kwd>
      <kwd>drug discovery</kwd>
      <kwd>fragment-based lead discovery</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>Vetenskapsrådet</funding-source>
        <award-id>2018-06454</award-id>
        <award-id>2018-05973</award-id>
      </award-group>
      <award-group>
        <funding-source>VINNOVA</funding-source>
        <award-id>2019-02567</award-id>
      </award-group>
      <funding-statement>This work was funded by <funding-source>Vetenskapsrådet</funding-source> grants <award-id>2018-06454</award-id> and <award-id>2018-05973</award-id>. <funding-source>VINNOVA</funding-source> grant <award-id>2019-02567</award-id>. </funding-statement>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="introduction" id="sec1">
    <label>1.</label>
    <title>Introduction   </title>
    <p>Fragment-based lead discovery utilizes a toolbox of biophysical methods, with X-ray crystallography-based fragment screening (CFS) being the main screening technique to obtain 3D structural information on protein–ligand complexes. In its methodological development, CFS co-evolves together with the scientific instrumentation and, more importantly, with the scientific infrastructure that supports contemporary macromolecular X-ray crystallography (MX) (Davies &amp; Tickle, 2011<xref ref-type="bibr" rid="bb8"> ▸</xref>; Grimes <italic>et al.</italic>, 2018<xref ref-type="bibr" rid="bb18"> ▸</xref>). In its current state, CFS relies on experimental setups and data-analysis methodologies that deviate from a classical crystallographic workflow (Krojer <italic>et al.</italic>, 2017<xref ref-type="bibr" rid="bb24"> ▸</xref>; Davies &amp; Tickle, 2011<xref ref-type="bibr" rid="bb8"> ▸</xref>; Wollenhaupt <italic>et al.</italic>, 2021<xref ref-type="bibr" rid="bb41"> ▸</xref>).</p>
    <p>Advances in MX data acquisition are setting new standards in structural biology (Grimes <italic>et al.</italic>, 2018<xref ref-type="bibr" rid="bb18"> ▸</xref>). With the advent of MX beamlines at fourth-generation photon sources at synchrotron-radiation facilities such as BioMAX at MAX IV Laboratory (Ursby <italic>et al.</italic>, 2020<xref ref-type="bibr" rid="bb55"> ▸</xref>), Manacá at the SIRIUS Light Source (Nascimento, 2020<xref ref-type="bibr" rid="bb36"> ▸</xref>), AMX and FMX at NSLS II (Fuchs <italic>et al.</italic>, 2016<xref ref-type="bibr" rid="bb15"> ▸</xref>) and MASSIF-1, MASSIF-2 and MASSIF-3 at ESRF–EBS (von Stetten <italic>et al.</italic>, 2020<xref ref-type="bibr" rid="bb57"> ▸</xref>; McCarthy <italic>et al.</italic>, 2018<xref ref-type="bibr" rid="bb30"> ▸</xref>; Svensson <italic>et al.</italic>, 2018<xref ref-type="bibr" rid="bb52"> ▸</xref>), the average data-collection time has been reduced by a factor of ten to less than 40 s for a 360° ω scan. With improved beamline sample capacity allied with reliable and fast robotic sample handling (Martiel <italic>et al.</italic>, 2020<xref ref-type="bibr" rid="bb29"> ▸</xref>; Ursby <italic>et al.</italic>, 2020<xref ref-type="bibr" rid="bb55"> ▸</xref>; Murakami <italic>et al.</italic>, 2020<xref ref-type="bibr" rid="bb35"> ▸</xref>), automated crystal centring (Ito <italic>et al.</italic>, 2019<xref ref-type="bibr" rid="bb20"> ▸</xref>; Di Castro <italic>et al.</italic>, 2008<xref ref-type="bibr" rid="bb10"> ▸</xref>; Schurmann <italic>et al.</italic>, 2019<xref ref-type="bibr" rid="bb46"> ▸</xref>; Svensson <italic>et al.</italic>, 2020<xref ref-type="bibr" rid="bb51"> ▸</xref>) and the possibility of unattended data collections (Mueller <italic>et al.</italic>, 2017<xref ref-type="bibr" rid="bb34"> ▸</xref>; Cipriani <italic>et al.</italic>, 2012<xref ref-type="bibr" rid="bb7"> ▸</xref>; Nurizzo <italic>et al.</italic>, 2016<xref ref-type="bibr" rid="bb38"> ▸</xref>; Sanchez-Weatherby <italic>et al.</italic>, 2019<xref ref-type="bibr" rid="bb44"> ▸</xref>), contemporary MX experiments generate a massive volume of data within a short time frame, for example more than 100 data sets during a single 8 h session. Finally, advances in crystal-harvesting including new tools (Barthel <italic>et al.</italic>., 2021<xref ref-type="bibr" rid="bb65"> ▸</xref>) as well as new methods such as acoustic crystal harvesting (Samara <italic>et al.</italic>, 2018<xref ref-type="bibr" rid="bb43"> ▸</xref>; Yin <italic>et al.</italic>, 2014<xref ref-type="bibr" rid="bb64"> ▸</xref>), robot-aided harvesting (Wright <italic>et al.</italic>, 2021<xref ref-type="bibr" rid="bb63"> ▸</xref>) and fully automated systems (Cipriani <italic>et al.</italic>, 2012<xref ref-type="bibr" rid="bb7"> ▸</xref>) are increasing the number of crystals harvested by an order of magnitude. Thus, collecting data for CFS at such facilities is a relatively robust procedure and the main bottleneck in MX-based fragment-screening experiments is shifting from sample preparation and data acquisition to data analysis, the building of multiple models and the interpretation of the results.</p>
    <p>Currently, automated methods for data processing and structure determination are the best way to deal with the enormous amount of data created in screening experiments. Although those methods are becoming very efficient, one major limitation is still computing power. For example, using a reasonably performing desktop computer, indexing and integrating a single high-resolution data set collected using a high-resolution detector such as an EIGER 16M can take up to 1 h 30 min. Automated and parallel approaches for data analyses benefit from exploring the solutions from several pipelines and cherry-picking the best solution, but the problem of limited computing power is aggravated. To facilitate parallel data processing for hundreds of data sets, data-collection facilities are investing in high-performance computing (HPC). Facilities such as MAX IV provide user access to their computing infrastructure, with the as-yet underestimated advantages of local availability of the data. CFS can benefit greatly from HPC-mediated data processing and analysis, as it improves the quality of the screening results and may possibly increase the sensitivity of the method.</p>
    <p>The massive amount of raw experimental data, its processing and the refinement of all potential structures of protein–ligand complexes, the exploration of bound ligands and the corresponding ligand-binding sites, and meta analysis of the data must be treated integrally. This concept was pioneered and first implemented by Astex Therapeutics Ltd (Cambridge, UK; currently part of Astex Pharmaceuticals) within their Pyramid Platform (Davies <italic>et al.</italic>, 2006<xref ref-type="bibr" rid="bb9"> ▸</xref>; Davies &amp; Tickle, 2011<xref ref-type="bibr" rid="bb8"> ▸</xref>). A similar logic was applied by XChem, a fragment-screening facility at Diamond Light Source, Didcot, UK that has operated since 2015. XChem users manage CFS data with a standalone graphical application called <italic>XChemExplorer</italic> (Krojer <italic>et al.</italic>, 2017<xref ref-type="bibr" rid="bb24"> ▸</xref>), which is also available within the <italic>CCP</italic>4 software suite (Winn <italic>et al.</italic>, 2011<xref ref-type="bibr" rid="bb58"> ▸</xref>). The application guides the user through most stages of the screening experiment, including data processing, analysis, refinement of the models and their deposition in the Protein Data Bank (Berman <italic>et al.</italic>, 2000<xref ref-type="bibr" rid="bb2"> ▸</xref>). Another implementation of the concept was made by EMBL with the web-based <italic>Crystallographic Information Management System</italic> (<italic>CRIMS</italic>). This application records all experiments performed with a given target and allows automated data analysis using <italic>Pipedream</italic> (Vonrhein <italic>et al.</italic>, 2011<xref ref-type="bibr" rid="bb56"> ▸</xref>; Smart <italic>et al.</italic>, 2014<xref ref-type="bibr" rid="bb49"> ▸</xref>; Bricogne <italic>et al.</italic>, 2017<xref ref-type="bibr" rid="bb5"> ▸</xref>; Kabsch, 2010<xref ref-type="bibr" rid="bb23"> ▸</xref>; Joosten <italic>et al.</italic>, 2011<xref ref-type="bibr" rid="bb21"> ▸</xref>; Collaborative Computational Project, Number 4, 1994<xref ref-type="bibr" rid="bb6"> ▸</xref>).</p>
    <p>Here, we present <italic>FragMAXapp</italic>, our solution to facilitate the scientific analysis, presentation and storage of large data sets from CFS and similar high-throughput crystallographic experiments (<ext-link ext-link-type="uri" xlink:href="https://maxiv.lu.se/fragmax/fragmaxapp">https://maxiv.lu.se/fragmax/fragmaxapp</ext-link>). <italic>FragMAXapp</italic> is a web-based expert system that links all of the steps of crystallographic ligand screening from experimental design and sample preparation to the deposition of the final structures in the Protein Data Bank. The application focuses on user accessibility, flexibility of the data analysis and high performance, linking the MAX IV HPC infrastructure with a selection of automated data-processing and analysis workflows (Fig. 1<xref ref-type="fig" rid="fig1"> ▸</xref>
<italic>a</italic>). <italic>FragMAXapp</italic> was designed within the operation framework of the BioMAX beamline (Ursby <italic>et al.</italic>, 2020<xref ref-type="bibr" rid="bb55"> ▸</xref>) and connects to other beamline applications, such as the ISPyB sample database (Beteva <italic>et al.</italic>, 2006<xref ref-type="bibr" rid="bb3"> ▸</xref>) and the <italic>MXCuBE</italic> experiment-control software (Mueller <italic>et al.</italic>, 2017<xref ref-type="bibr" rid="bb34"> ▸</xref>; Oscarsson <italic>et al.</italic>, 2019<xref ref-type="bibr" rid="bb66"> ▸</xref>). However, the abstraction level of <italic>FragMAXapp</italic> provides modularity that allows it to be ported and adapted to other sites. In fact, at the time of this publication, working versions of <italic>FragMAXapp</italic> are deployed on BESSY II at the Helmholtz-Zentrum Berlin (Mueller <italic>et al.</italic>, 2015<xref ref-type="bibr" rid="bb33"> ▸</xref>; Wollenhaupt <italic>et al.</italic>, 2021<xref ref-type="bibr" rid="bb41"> ▸</xref>) and at the University of São Paulo using data from the SIRIUS Light Source (Noske <italic>et al.</italic>, 2021<xref ref-type="bibr" rid="bb37"> ▸</xref>).</p>
  </sec>
  <sec id="sec2">
    <label>2.</label>
    <title>Software design and operation   </title>
    <p><italic>FragMAXapp</italic> has been developed using Python3/Django (Django version 2.2.1; <ext-link ext-link-type="uri" xlink:href="https://djangoproject.com">https://djangoproject.com</ext-link>) as its back end and using JavaScript for front-end features (Fig. 1<xref ref-type="fig" rid="fig1"> ▸</xref>
<italic>b</italic>). The project definition, including protein models, the structures of the small molecules and user information, is stored in an SQLite3 database.</p>
    <p>As a web application, <italic>FragMAXapp</italic> requires a web browser with the support of WebGL (Web Graphics Library API, Mozilla). This feature allows data analysis to be performed using virtually any device connected to the internet. The user interface is designed using HTML5, CSS3 and JavaScript for responsiveness and functionality. User access can be obtained using the ISPyB authentication system, which provides access to data and results based on the MAX IV user-account system, or with a local account with access privileges granted by the system administrator.</p>
    <p>The application offers a variety of choices for data processing, including <italic>DIALS</italic> (Winter <italic>et al.</italic>, 2018<xref ref-type="bibr" rid="bb60"> ▸</xref>) and <italic>XDS </italic>(Kabsch, 2010<xref ref-type="bibr" rid="bb23"> ▸</xref>) through <italic>xia</italic>2 (Winter <italic>et al.</italic>, 2018<xref ref-type="bibr" rid="bb60"> ▸</xref>; Evans, 2006<xref ref-type="bibr" rid="bb13"> ▸</xref>; Gildea <italic>et al.</italic>, 2011<xref ref-type="bibr" rid="bb16"> ▸</xref>),<italic> autoPROC</italic> (Vonrhein <italic>et al.</italic>, 2011<xref ref-type="bibr" rid="bb56"> ▸</xref>), <italic>XDSAPP</italic> (Krug <italic>et al.</italic>, 2012<xref ref-type="bibr" rid="bb25"> ▸</xref>; Sparta <italic>et al.</italic>, 2016<xref ref-type="bibr" rid="bb50"> ▸</xref>), <italic>fastdp</italic> (Winter &amp; McAuley, 2011<xref ref-type="bibr" rid="bb59"> ▸</xref>) and <italic>EDNAproc</italic> (Incardona <italic>et al.</italic>, 2009<xref ref-type="bibr" rid="bb19"> ▸</xref>). Automated structure refinement is performed by <italic>DIMPLE</italic>, <italic>BUSTER</italic> (Bricogne <italic>et al.</italic>, 2017<xref ref-type="bibr" rid="bb5"> ▸</xref>; Smart <italic>et al.</italic>, 2012<xref ref-type="bibr" rid="bb47"> ▸</xref>) and <italic>fspipeline</italic> (Schiebel <italic>et al.</italic>, 2016<xref ref-type="bibr" rid="bb45"> ▸</xref>). The ligand-finding step is performed by <italic>Rhofit</italic> (Smart <italic>et al.</italic>, 2014<xref ref-type="bibr" rid="bb49"> ▸</xref>), <italic>Phenix LigandFit</italic> (Terwilliger <italic>et al.</italic>, 2006<xref ref-type="bibr" rid="bb54"> ▸</xref>, 2007<xref ref-type="bibr" rid="bb53"> ▸</xref>) and <italic>PanDDA</italic> (Pearce <italic>et al.</italic>, 2017<xref ref-type="bibr" rid="bb39"> ▸</xref>), with ligand coordinates and restraints generated by <italic>Phenix eLBOW</italic> (Moriarty <italic>et al.</italic>, 2009<xref ref-type="bibr" rid="bb31"> ▸</xref>), <italic>GRADE</italic> (Smart <italic>et al.</italic>, 2011<xref ref-type="bibr" rid="bb48"> ▸</xref>) or <italic>AceDRG</italic> (Long <italic>et al.</italic>, 2017<xref ref-type="bibr" rid="bb28"> ▸</xref>). Within the application interface, structural representation of the ligands is created using the <italic>RDKit</italic> (Landrum, 2012<xref ref-type="bibr" rid="bb26"> ▸</xref>) and 3<italic>Dmol</italic> (Rego &amp; Koes, 2015<xref ref-type="bibr" rid="bb42"> ▸</xref>) libraries. Protein atomic coordinates, electron-density maps and reciprocal space are displayed using the <italic>UglyMol</italic> (Wojdyr, 2016<xref ref-type="bibr" rid="bb61"> ▸</xref>) library with minor modifications that allow the visualization and comparison of multiple models. Interactive plots for data statistics are created using the <italic>D</italic>3 library (Bostock, 2017<xref ref-type="bibr" rid="bb4"> ▸</xref>). The X-ray diffraction representations are created using <italic>Adxv</italic> (Arvai, 2012<xref ref-type="bibr" rid="bb1"> ▸</xref>) with sufficient images to cover 1° of crystal oscillation. The selection of software available in a specific facility is defined during the deployment of the application.</p>
    <p>The MAX IV HPC infrastructure manages its workload using Slurm, which is interfaced with the <italic>FragMAXapp</italic> server using a Celery workload manager and a Redis server. These two services run together with the Django server to enable promise-like requests for data while maintaining fluid navigation in the web app.</p>
    <p>All services run from a Docker container allocated in a virtual machine configured with GitHub’s continuous integration feature, allowing easy deployment and updating of the tools. The Docker deployment uses NGINX/uWSGI to serve the application.</p>
    <sec id="sec2.1">
      <label>2.1.</label>
      <title>Project management   </title>
      <p>The application organizes experimental data and their analysis into application-specific projects. A <italic>FragMAXapp</italic> project is defined by a unique combination of four parameters: the protein name, a common identifier of the compounds (for example the name of the fragment library), the BioMAX proposal number and the corresponding data-collection sessions (<ext-link ext-link-type="uri" xlink:href="#suppinfoanchor">Supplementary Fig. S1</ext-link>). These values can be updated to incorporate follow-up experiments related to the same protein within the same proposal.</p>
      <p>To facilitate work with sensitive information and to allow users to follow up specific policies for data handling, the project can be created in an encrypted mode. With this option the project-related data are encrypted, and are decrypted only temporarily when the user or the processing software require access. For increased security, the user can manage the availability of the encryption key. It is possible to download, remove and re-upload the encryption key that is used for the project. When the encryption key is removed, the project data effectively become inaccessible unless the user re-uploads the key.</p>
      <p>Beyond meta-management of the projects, <italic>FragMAXapp</italic> allows the examination of individual data sets and other experimental details. Often, this information is stored in sample databases such as ISPyB and can be retrieved at any time by the user. With <italic>FragMAXapp</italic>, browsing this information is also possible (Fig. 2<xref ref-type="fig" rid="fig2"> ▸</xref>).</p>
    </sec>
    <sec id="sec2.2">
      <label>2.2.</label>
      <title>Sample management   </title>
      <p>Definition of the screening collection is an essential step in project management. <italic>FragMAXapp</italic> requires the user to upload a comma-separated file (CSV) with library specifications, including compound identifiers, which must be identical to the sample names, and optional SMILES strings for the chemical structures of the ligands. The library view page displays updated information about the sample database, with 2D and/or 3D representations of each molecule, and the SMILES code for each compound ID in the project (Fig. 3<xref ref-type="fig" rid="fig3"> ▸</xref>). Missing entries in the sample database are displayed in the page header, based on the sample names available and the compound IDs in the database. It is possible to update the definition of the samples, which allows work with follow-up experiments within the same project.</p>
    </sec>
    <sec id="sec2.3">
      <label>2.3.</label>
      <title>Data processing and structure solution   </title>
      <p>The most powerful feature of <italic>FragMAXapp</italic> is its capability to handle numerous data-analysis methods in a parallel and multiplexed manner (Fig. 4<xref ref-type="fig" rid="fig4"> ▸</xref>). It is widely accepted that no single combination of processing and analysis software outperforms any available solution, meaning that only after testing all possible combinations of automated pipelines is it possible to identify the best strategy for a particular data set (Powell, 2017<xref ref-type="bibr" rid="bb40"> ▸</xref>). As we focus on fully automated data-analysis schemes, <italic>FragMAXapp</italic> offers a combination of six data-processing software packages: <italic>autoPROC</italic>, <italic>xia</italic>2/<italic>DIALS</italic>, <italic>xia</italic>2/<italic>XDS</italic>, <italic>EDNAproc</italic>, <italic>fastdp</italic> and <italic>XDSAPP</italic>, three structure-refinement pipelines, <italic>BUSTER</italic>, <italic>DIMPLE</italic> and <italic>fspipeline</italic>, and three automatic ligand-searching programs, <italic>Phenix LigandFit</italic>, <italic>Rhofit</italic> and <italic>PanDDA</italic>. Selecting all available software can generate a total of 54 combinations for the evaluation of each diffraction data set. For each software, <italic>FragMAXapp</italic> suggests options to optimize its function, such as the definition of resolution cutoffs for the data, alternative frame ranges for the data sets, the application of Friedel’s law during processing, the water-placement method in structure-refinement stages and many more, efficiently acting as a unified GUI front end. Providing customized parameters for data analyses is optionally possible; otherwise the application chooses default values when no input is given. Using a built-in selection table, only selected data sets can be analysed or re-analysed. To ensure that all software will have the necessary information to run properly, <italic>FragMAXapp</italic> keeps a set of mandatory inputs.</p>
      <p>A dedicated tab is available to check all currently running data-analysis jobs and inspect the processing logs. This feature displays live information from the computing nodes and the queueing system. Within this page, it is possible to remove jobs from the processing queue or to kill running analyses.</p>
      <p><italic>FragMAXapp</italic> integrates <italic>PanDDA</italic> analysis, with several features that allow the sensitivity of the screening experiment to be increased. Under the <italic>PanDDA</italic> tab on the Data Analysis page, it is possible to choose which data-analysis output will be used to run <italic>PanDDA</italic>. If the result is missing, <italic>FragMAXapp</italic> will check whether a solution was offered by other combinations of analysis software. Alternatively, the application offers the <italic>FragPLEX</italic> option, a method to decide which results to submit for <italic>PanDDA</italic> analysis. The method is based on the evaluation of processing and refinement statistics. The first step of the selection process discards all processed data sets with an overall <italic>R</italic>
<sub>meas</sub> of &gt;10%. The second step ranks solutions by higher ISa value and resolution and lower <italic>R</italic>
<sub>free</sub>/<italic>R</italic>
<sub>work</sub>. The selection is saved in the <italic>FragMAXapp</italic> database. In our tests, applying this selection logic allows the retrieval of all hits found by combining hits from all individual analysis (<italic>i.e.</italic> a single combination of data processing and structure refinement). Additionally, <italic>FragMAXapp</italic> offers the option to build ground-state models using exclusively known apo structures or to use data sets without peaks in the <italic>Z</italic>-maps (the latter requires at least one <italic>PanDDA</italic> analysis before use). In the final steps of <italic>PanDDA</italic> analysis, the evaluation of modelled ligands can be performed through the <italic>PanDDA</italic> Giant scoring scripts (Pearce <italic>et al.</italic>, 2017<xref ref-type="bibr" rid="bb39"> ▸</xref>), and the radar plots of fitting quality generated in this step are shown in the web app.</p>
    </sec>
    <sec id="sec2.4">
      <label>2.4.</label>
      <title>Data visualization   </title>
      <p>The results generated by the automatic analysis pipelines can be visualized in the web browser without any external tools or plugins. It is possible to open and read the output logs from each software used, visualize reciprocal-lattice representation and load refined models with electron density with a <italic>Coot</italic>-like look and feel using <italic>UglyMol</italic> (Fig. 5<xref ref-type="fig" rid="fig5"> ▸</xref>). Besides, the web app provides interactive and comprehensive overview plots for many statistical parameters such as resolution, ISa, <italic>R</italic>
<sub>work</sub>/<italic>R</italic>
<sub>free</sub> and unit-cell parameters. This allows the whole CFS data evaluation to be compared within one view, including averaged values and standard deviations for various combinations of methods. These plots can be extremely helpful to obtain a quick overview of the data analysis and to identify data sets that require reprocessing or manual examination.</p>
      <p>The <italic>PanDDA</italic> results visualization within <italic>FragMAXapp</italic> displays the event map and the average map obtained from the ground-state model side by side (<ext-link ext-link-type="uri" xlink:href="#suppinfoanchor">Supplementary Fig. S6</ext-link>). Using this visual feature, it is easier to interpret unexplained or modelled densities that are also present in the averaged ligand-free model.</p>
    </sec>
    <sec id="sec2.5">
      <label>2.5.</label>
      <title>Export tools   </title>
      <p>After the analyses are finished, the web app provides tools to download the data. A variety of choices for which data to export is available, combining process data, log files, structure files and electron densities. Pre-processing results using <italic>PDB-REDO</italic> (Joosten <italic>et al.</italic>, 2012<xref ref-type="bibr" rid="bb22"> ▸</xref>) before deposition is optional but is highly recommended as it improves the quality of automatically refined structures and prepares them for subsequent deposition in the PDB. Using this feature, users are no longer required to manually deposit every model; instead, a compressed archive file with structures, reflection data and the index file is generated, ready to be uploaded using the OneDep system. The compressed file can be downloaded from <italic>FragMAXapp</italic> or using regular tools available at MAX IV. At the time of publication, SFTP and Globus (Foster, 2011<xref ref-type="bibr" rid="bb14"> ▸</xref>) are offered to users. A final option supported by <italic>FragMAXapp</italic> is uploading of the raw data to public diffraction databases such as proteindiffraction.org (Grabowski <italic>et al.</italic>, 2016<xref ref-type="bibr" rid="bb17"> ▸</xref>).</p>
    </sec>
  </sec>
  <sec id="sec3">
    <label>3.</label>
    <title>Fragment screening using <italic>FragMAXapp</italic>   </title>
    <p>To test our implementation of the automated methods, a fragment-screening campaign was performed using proteinase K (PROK) from <italic>Tritirachium album</italic> (UniProt accession code P06873). PROK is a study model of serine proteases (Larson <italic>et al.</italic>, 2009<xref ref-type="bibr" rid="bb27"> ▸</xref>). The materials and methods used to obtain PROK crystals, including the soaking and harvesting procedures, are described in <ext-link ext-link-type="uri" xlink:href="#suppinfoanchor">Section S1</ext-link>. Data-collection parameters are given in Table 1<xref ref-type="table" rid="table1"> ▸</xref>.</p>
    <p>Fragment screening of the 96 samples prepared as ligand soaks using the Frag Xtal Screen library, and an extra 40 apo crystals, was performed and data analysis was performed using <italic>FragMAXapp</italic>. The plots, with an overview of data processing and structure refinement, are available in <ext-link ext-link-type="uri" xlink:href="#suppinfoanchor">Supplementary Table S1</ext-link>. Applying different automated ligand-fitting (<italic>LigandFit</italic> and <italic>Rhofit</italic>) and ligand-searching (<italic>PanDDA</italic> with manual inspection of <italic>Z</italic>-maps) methods led to very time-efficient hit identification in two weeks of data analysis, including post-refinement and preparation for deposition. This is remarkable when compared with the expected time required to perform the analysis of 136 data sets. At the time of writing this article (GitHub commit <ext-link ext-link-type="uri" xlink:href="https://github.com/FragMAX/FragMAXapp/commit/14199af229a43b25a5994c5d58bc92df523cb31d">https://github.com/FragMAX/FragMAXapp/commit/14199af229a43b25a5994c5d58bc92df523cb31d</ext-link>), ligand modelling requires <italic>Coot</italic> (Emsley <italic>et al.</italic>, 2010<xref ref-type="bibr" rid="bb12"> ▸</xref>), which can be achieved by accessing a virtual computer at synchrotron facility. <italic>PanDDA</italic> analysis was performed by allowing <italic>FragMAXapp</italic> to select the best combination of data processing and structure refinement; the selection is available in <ext-link ext-link-type="uri" xlink:href="#suppinfoanchor">Section S1</ext-link>. <italic>PanDDA</italic> identified events and clustered them into seven sites (Fig. 6<xref ref-type="fig" rid="fig6"> ▸</xref>), which were compared with standard difference density map analysis and automated ligand-fitting methods (Fig. 7<xref ref-type="fig" rid="fig7"> ▸</xref>). In general, when the unexplained density was sufficiently defined to fit a large portion of the corresponding fragment, all methods modelled the bound ligand with a certain degree of precision and would require little real-space refinement to make it ready for deposition. However, using the information from the <italic>PanDDA</italic> event map is likely to improve the model, as shown for fragments A12 and B5 in Fig. 7<xref ref-type="fig" rid="fig7"> ▸</xref>. In several cases, such as fragments B7 and C11, automated fitting methods disagree on the site in which to locate the ligand, making the <italic>PanDDA</italic> event map decisive in ligand modelling. To highlight how each of these methods compares with each other and what the user can typically expect from the automated methods in <italic>FragMAXapp</italic>, no further modelling was performed on the protein–ligand complexes. Overall, <italic>PanDDA</italic> led to an increase in the hit rate, from ten to 18 identified binding events, and a better modelling of bound fragments with partial occupancy.</p>
    <p>The results from the PROK fragment screening and the apo structures used to build the ground-state model in <italic>PanDDA</italic> were submitted to the Protein Data Bank (PDB) using the export tool built into<italic> FragMAXapp</italic>. Overall, this fragment-screening campaign is an example of the application of the software and its capabilities, demonstrating what the user can expect from the web app. The fragment-screening platform of MAX IV, including <italic>FragMAXapp</italic>, has also been used for the validation of a structurally diverse fragment library collection, F2X-Entry, on two protein targets (Wollenhaupt <italic>et al.</italic>, 2020<xref ref-type="bibr" rid="bb62"> ▸</xref>).</p>
  </sec>
  <sec sec-type="conclusions" id="sec4">
    <label>4.</label>
    <title>Conclusions   </title>
    <p>Crystallographic fragment screening is becoming a common method in the early stages of drug-discovery projects, sometimes replacing other biophysical methods as the primary screening technique. Advances in light-source facilities have shifted the bottleneck from generating data to analysing data, requiring equal efforts to improve software support to enable CFS. The strong automation provided at modern MX beamlines, not only for data collection but also for data processing, enables medicinal chemistry-focused groups to utilize structural biology within their research.</p>
    <p><italic>FragMAXapp</italic> was developed with a focus on providing the necessary tools to manage, process, analyse and export fragment-screening projects from a web browser. The host facility benefits from software that is easy to deploy and develop, based on popular programming languages such as Python and JavaScript. With our plugin-based system, adding or removing functionalities is possible, thus adapting <italic>FragMAXapp</italic> to a variety of scenarios. The user will benefit from a zero-installation setup that is ‘ready to go’ from any internet-connected device. Furthermore, remote data analysis significantly decreases the time required to obtain results by skipping data transfer and using highly parallelized computing architecture. Similar solutions available at other sites such as <italic>XChemExplorer</italic> and <italic>CRIMS</italic> lack the extensive data-analysis features and/or easy access to the application through a web browser. Therefore, <italic>FragMAXapp</italic> will set the standard for CFS project-management and data-processing tools with its full web-stack implementation, parallel computing support and user-friendly interface.</p>
  </sec>
  <sec id="sec5">
    <label>5.</label>
    <title>Availability   </title>
    <p>Documentation and source code for <italic>FragMAXapp</italic> can be obtained from the FragMAX project GitHub page (<ext-link ext-link-type="uri" xlink:href="https://github.com/FragMAX/FragMAXapp">https://github.com/FragMAX/FragMAXapp</ext-link>) free of charge for academic use or noncommercial applications. Detailed tutorial and other instructions can be found on the <italic>FragMAXapp</italic> project page (<ext-link ext-link-type="uri" xlink:href="https://fragmax.github.io/">https://fragmax.github.io/</ext-link>).</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data">
      <p>Supplementary Figures, proteinase K fragment screening and Supplementary Table. DOI: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1107/S2059798321003818/tz5106sup1.pdf">10.1107/S2059798321003818/tz5106sup1.pdf</ext-link>
</p>
      <media mimetype="application" mime-subtype="pdf" xlink:href="d-77-00799-sup1.pdf" orientation="portrait" id="d24e166" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>The FragMAX group would like to thank all of the BioMAX staff for supporting and improving the beamline that makes the project possible. The authors would like to thank Lionel Trésaugues (Sprint Biosciences AB, Sweden) and Yousif Ali (Linköping University, Sweden) for collaboration during the development of the <italic>FragMAXapp</italic> encryption mode and for testing the software. The authors would like to thank the PReSTO group for providing the scientific software infrastructure, especially Martin Moche (Karolinska Institutet, Sweden) and Sebastian Thorarensen (Linköping University, Sweden) for promptly providing help when needed. The authors would also like to thank Zdenek Matej (MAX IV Laboratory) for valuable help with the MAX IV computing environment. Finally, the authors would like to thank Nicholas Pearce (Utrecht University, Netherlands) for his insights regarding <italic>PanDDA</italic> usage and web implementation. The computations and software access were enabled by resources provided by the Swedish National Infrastructure for Computing (SNIC) at MAX IV, partially funded by the Swedish Research Council.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="bb1">
      <mixed-citation publication-type="other">Arvai, A. (2012). <italic>Adxv – A Program to Display X-ray Diffraction Images</italic>. http://www.scripps.edu/~arvai/adxv.html.</mixed-citation>
    </ref>
    <ref id="bb65">
      <mixed-citation publication-type="journal">Barthel, T., Huschmann, F. U., Wallacher, D., Feiler, C. G., Klebe, G., Weiss, M. S. &amp; Wollenhaupt, J. (2021). <italic>J. Appl. Cryst.</italic>
<bold>54</bold>, 376–382.</mixed-citation>
    </ref>
    <ref id="bb2">
      <mixed-citation publication-type="other">Berman, H. M., Westbrook, J., Feng, Z., Gilliland, G., Bhat, T. N., Weissig, H., Shindyalov, I. N. &amp; Bourne, P. E. (2000). <italic>Nucleic Acids Res.</italic>
<bold>28</bold>, 235–242.</mixed-citation>
    </ref>
    <ref id="bb3">
      <mixed-citation publication-type="other">Beteva, A., Cipriani, F., Cusack, S., Delageniere, S., Gabadinho, J., Gordon, E. J., Guijarro, M., Hall, D. R., Larsen, S., Launer, L., Lavault, C. B., Leonard, G. A., Mairs, T., McCarthy, A., McCarthy, J., Meyer, J., Mitchell, E., Monaco, S., Nurizzo, D., Pernot, P., Pieritz, R., Ravelli, R. G. B., Rey, V., Shepard, W., Spruce, D., Stuart, D. I., Svensson, O., Theveneau, P., Thibault, X., Turkenburg, J., Walsh, M. &amp; McSweeney, S. M. (2006). <italic>Acta Cryst.</italic> D<bold>62</bold>, 1162–1169.</mixed-citation>
    </ref>
    <ref id="bb4">
      <mixed-citation publication-type="other">Bostock, M. (2017). <italic>D3: Bring Data to Life with SVG, Canvas and HTML</italic>. https://github.com/d3/d3.</mixed-citation>
    </ref>
    <ref id="bb5">
      <mixed-citation publication-type="other">Bricogne, G., Blanc, E., Brandl, M., Flensburg, C., Keller, P., Paciorek, W., Roversi, P., Sharff, A., Smart, O. S., Vonrhein, C. &amp; Womack, T. O. (2017). <italic>BUSTER</italic> version 2.10.3. Global Phasing Ltd, Cambridge, UK.</mixed-citation>
    </ref>
    <ref id="bb7">
      <mixed-citation publication-type="other">Cipriani, F., Röwer, M., Landret, C., Zander, U., Felisaz, F. &amp; Márquez, J. A. (2012). <italic>Acta Cryst.</italic> D<bold>68</bold>, 1393–1399.</mixed-citation>
    </ref>
    <ref id="bb6">
      <mixed-citation publication-type="other">Collaborative Computational Project, Number 4 (1994). <italic>Acta Cryst.</italic> D<bold>50</bold>, 760–763.</mixed-citation>
    </ref>
    <ref id="bb8">
      <mixed-citation publication-type="other">Davies, T. G. &amp; Tickle, I. J. (2011). <italic>Top. Curr. Chem.</italic>, <bold>317</bold>, 33–59.</mixed-citation>
    </ref>
    <ref id="bb9">
      <mixed-citation publication-type="other">Davies, T. G., Van Montfort, R. L. M., Williams, G. &amp; Jhoti, H. (2006). <italic>Fragment-based Approaches in Drug Discovery</italic>, edited by W. Jahnke &amp; D. A. Erlanson, pp. 193–214. Weinheim: Wiley-VCH.</mixed-citation>
    </ref>
    <ref id="bb10">
      <mixed-citation publication-type="other">Di Castro, M., Pazos, A., Ridoutt, F., Ristau, U. &amp; Fiedler, S. (2008). <italic>PCaPAC 2008 – International Workshop on Personal Computers and Particle Accelerator Controls</italic>, pp. 192–194.</mixed-citation>
    </ref>
    <ref id="bb12">
      <mixed-citation publication-type="other">Emsley, P., Lohkamp, B., Scott, W. G. &amp; Cowtan, K. (2010). <italic>Acta Cryst.</italic> D<bold>66</bold>, 486–501.</mixed-citation>
    </ref>
    <ref id="bb13">
      <mixed-citation publication-type="other">Evans, P. (2006). <italic>Acta Cryst.</italic> D<bold>62</bold>, 72–82.</mixed-citation>
    </ref>
    <ref id="bb14">
      <mixed-citation publication-type="other">Foster, I. (2011). <italic>IEEE Internet Comput.</italic>
<bold>15</bold>, 70–73.</mixed-citation>
    </ref>
    <ref id="bb15">
      <mixed-citation publication-type="other">Fuchs, M. R., Bhogadi, D. K., Jakoncic, J., Myers, S., Sweet, R. M., Berman, L. E., Skinner, J., Idir, M., Chubar, O., McSweeney, S. &amp; Schneider, D. K. (2016). <italic>AIP Conf. Proc.</italic>
<bold>1741</bold>, 030006.</mixed-citation>
    </ref>
    <ref id="bb16">
      <mixed-citation publication-type="other">Gildea, R. J., Bourhis, L. J., Dolomanov, O. V., Grosse-Kunstleve, R. W., Puschmann, H., Adams, P. D. &amp; Howard, J. A. K. (2011). <italic>J. Appl. Cryst.</italic>
<bold>44</bold>, 1259–1263.</mixed-citation>
    </ref>
    <ref id="bb17">
      <mixed-citation publication-type="other">Grabowski, M., Langner, K. M., Cymborowski, M., Porebski, P. J., Sroka, P., Zheng, H., Cooper, D. R., Zimmerman, M. D., Elsliger, M.-A., Burley, S. K. &amp; Minor, W. (2016). <italic>Acta Cryst.</italic> D<bold>72</bold>, 1181–1193.</mixed-citation>
    </ref>
    <ref id="bb18">
      <mixed-citation publication-type="other">Grimes, J. M., Hall, D. R., Ashton, A. W., Evans, G., Owen, R. L., Wagner, A., McAuley, K. E., von Delft, F., Orville, A. M., Sorensen, T., Walsh, M. A., Ginn, H. M. &amp; Stuart, D. I. (2018). <italic>Acta Cryst.</italic> D<bold>74</bold>, 152–166.</mixed-citation>
    </ref>
    <ref id="bb19">
      <mixed-citation publication-type="other">Incardona, M.-F., Bourenkov, G. P., Levik, K., Pieritz, R. A., Popov, A. N. &amp; Svensson, O. (2009). <italic>J. Synchrotron Rad.</italic>
<bold>16</bold>, 872–879.</mixed-citation>
    </ref>
    <ref id="bb20">
      <mixed-citation publication-type="other">Ito, S., Ueno, G. &amp; Yamamoto, M. (2019). <italic>J. Synchrotron Rad.</italic>
<bold>26</bold>, 1361–1366.</mixed-citation>
    </ref>
    <ref id="bb21">
      <mixed-citation publication-type="other">Joosten, R. P., Joosten, K., Cohen, S. X., Vriend, G. &amp; Perrakis, A. (2011). <italic>Bioinformatics</italic>, <bold>27</bold>, 3392–3398.</mixed-citation>
    </ref>
    <ref id="bb22">
      <mixed-citation publication-type="other">Joosten, R. P., Joosten, K., Murshudov, G. N. &amp; Perrakis, A. (2012). <italic>Acta Cryst.</italic> D<bold>68</bold>, 484–496.</mixed-citation>
    </ref>
    <ref id="bb23">
      <mixed-citation publication-type="other">Kabsch, W. (2010). <italic>Acta Cryst.</italic> D<bold>66</bold>, 125–132.</mixed-citation>
    </ref>
    <ref id="bb24">
      <mixed-citation publication-type="other">Krojer, T., Talon, R., Pearce, N., Collins, P., Douangamath, A., Brandao-Neto, J., Dias, A., Marsden, B. &amp; von Delft, F. (2017). <italic>Acta Cryst.</italic> D<bold>73</bold>, 267–278.</mixed-citation>
    </ref>
    <ref id="bb25">
      <mixed-citation publication-type="other">Krug, M., Weiss, M. S., Heinemann, U. &amp; Mueller, U. (2012). <italic>J. Appl. Cryst.</italic>
<bold>45</bold>, 568–572.</mixed-citation>
    </ref>
    <ref id="bb26">
      <mixed-citation publication-type="other">Landrum, G. (2012).<italic> RDKit. The Official Sources for the RDKit Library</italic>. https://github.com/rdkit/rdkit.</mixed-citation>
    </ref>
    <ref id="bb27">
      <mixed-citation publication-type="other">Larson, S. B., Day, J. S., Nguyen, C., Cudney, R. &amp; McPherson, A. (2009). <italic>Acta Cryst.</italic> F<bold>65</bold>, 192–198.</mixed-citation>
    </ref>
    <ref id="bb28">
      <mixed-citation publication-type="other">Long, F., Nicholls, R. A., Emsley, P., Gražulis, S., Merkys, A., Vaitkus, A. &amp; Murshudov, G. N. (2017). <italic>Acta Cryst.</italic> D<bold>73</bold>, 112–122.</mixed-citation>
    </ref>
    <ref id="bb29">
      <mixed-citation publication-type="other">Martiel, I., Buntschu, D., Meier, N., Gobbo, A., Panepucci, E., Schneider, R., Heimgartner, P., Müller, D., Bühlmann, K., Birri, M., Kaminski, J. W., Leuenberger, J., Oliéric, V., Glettig, W. &amp; Wang, M. (2020). <italic>J. Synchrotron Rad.</italic>
<bold>27</bold>, 860–863.</mixed-citation>
    </ref>
    <ref id="bb30">
      <mixed-citation publication-type="other">McCarthy, A. A., Barrett, R., Beteva, A., Caserotto, H., Dobias, F., Felisaz, F., Giraud, T., Guijarro, M., Janocha, R., Khadrouche, A., Lentini, M., Leonard, G. A., Lopez Marrero, M., Malbet-Monaco, S., McSweeney, S., Nurizzo, D., Papp, G., Rossi, C., Sinoir, J., Sorez, C., Surr, J., Svensson, O., Zander, U., Cipriani, F., Theveneau, P. &amp; Mueller-Dieckmann, C. (2018). <italic>J. Synchrotron Rad.</italic>
<bold>25</bold>, 1249–1260.</mixed-citation>
    </ref>
    <ref id="bb31">
      <mixed-citation publication-type="other">Moriarty, N. W., Grosse-Kunstleve, R. W. &amp; Adams, P. D. (2009). <italic>Acta Cryst.</italic> D<bold>65</bold>, 1074–1080.</mixed-citation>
    </ref>
    <ref id="bb33">
      <mixed-citation publication-type="other">Mueller, U., Förster, R., Hellmig, M., Huschmann, F. U., Kastner, A., Malecki, P., Pühringer, S., Röwer, M., Sparta, K., Steffien, M., Ühlein, M., Wilk, P. &amp; Weiss, M. S. (2015). <italic>Eur. Phys. J. Plus</italic>, <bold>130</bold>, 141.</mixed-citation>
    </ref>
    <ref id="bb34">
      <mixed-citation publication-type="other">Mueller, U., Thunnissen, M., Nan, J., Eguiraun, M., Bolmsten, F., Milàn-Otero, A., Guijarro, M., Oscarsson, M., de Sanctis, D. &amp; Leonard, G. (2017). <italic>Synchrotron Radiat. News</italic>, <bold>30</bold>, 22–27.</mixed-citation>
    </ref>
    <ref id="bb35">
      <mixed-citation publication-type="other">Murakami, H., Hasegawa, K., Ueno, G., Yagi, N., Yamamoto, M. &amp; Kumasaka, T. (2020). <italic>Acta Cryst.</italic> D<bold>76</bold>, 155–165.</mixed-citation>
    </ref>
    <ref id="bb36">
      <mixed-citation publication-type="other">Nascimento, A. F. Z. (2020). <italic>11th International Workshop on X-ray Radiation Damage to Biological Samples</italic>.</mixed-citation>
    </ref>
    <ref id="bb37">
      <mixed-citation publication-type="other">Noske, G. D., Nakamura, A. M., Gawriljuk, V. O., Fernandes, R. S., Lima, G. M. A., Rosa, H. V. D., Pereira, H. D., Zeri, A. C. M., Nascimento, A. F. Z., Freire, M. C. L. C., Oliva, G. &amp; Godoy, A. S. (2021). <italic>bioRxiv</italic>, 2020.12.23.424149.</mixed-citation>
    </ref>
    <ref id="bb38">
      <mixed-citation publication-type="other">Nurizzo, D., Bowler, M. W., Caserotto, H., Dobias, F., Giraud, T., Surr, J., Guichard, N., Papp, G., Guijarro, M., Mueller-Dieckmann, C., Flot, D., McSweeney, S., Cipriani, F., Theveneau, P. &amp; Leonard, G. A. (2016). <italic>Acta Cryst.</italic> D<bold>72</bold>, 966–975.</mixed-citation>
    </ref>
    <ref id="bb66">
      <mixed-citation publication-type="journal">Oscarsson, M., Beteva, A., Flot, D., Gordon, E., Guijarro, M., Leonard, G., McSweeney, S., Monaco, S., Mueller-Dieckmann, C., Nanao, M., Nurizzo, D., Popov, A., von Stetten, D., Svensson, O., Rey-Bakaikoa, V., Chado, I., Chavas, L., Gadea, L., Gourhant, P., Isabet, T., Legrand, P., Savko, M., Sirigu, S., Shepard, W., Thompson, A., Mueller, U., Nan, J., Eguiraun, M., Bolmsten, F., Nardella, A., Milàn-Otero, A., Thunnissen, M., Hellmig, M., Kastner, A., Schmuckermaier, L., Gerlach, M., Feiler, C., Weiss, M. S., Bowler, M. W., Gobbo, A., Papp, G., Sinoir, J., McCarthy, A., Karpics, I., Nikolova, M., Bourenkov, G., Schneider, T., Andreu, J., Cuní, G., Juanhuix, J., Boer, R., Fogh, R., Keller, P., Flensburg, C., Paciorek, W., Vonrhein, C., Bricogne, G. &amp; de Sanctis, D. (2019). <italic>J. Synchrotron Rad.</italic>
<bold>26</bold>, 393–405.</mixed-citation>
    </ref>
    <ref id="bb39">
      <mixed-citation publication-type="other">Pearce, N. M., Krojer, T., Bradley, A. R., Collins, P., Nowak, R. P., Talon, R., Marsden, B. D., Kelm, S., Shi, J., Deane, C. M. &amp; von Delft, F. (2017). <italic>Nat. Commun.</italic>
<bold>8</bold>, 15123.</mixed-citation>
    </ref>
    <ref id="bb40">
      <mixed-citation publication-type="other">Powell, H. R. (2017). <italic>Biosci. Rep.</italic>
<bold>37</bold>, BSR20170227.</mixed-citation>
    </ref>
    <ref id="bb42">
      <mixed-citation publication-type="other">Rego, N. &amp; Koes, D. (2015). <italic>Bioinformatics</italic>, <bold>31</bold>, 1322–1324.</mixed-citation>
    </ref>
    <ref id="bb43">
      <mixed-citation publication-type="other">Samara, Y. N., Brennan, H. M., McCarthy, L., Bollard, M. T., Laspina, D., Wlodek, J. M., Campos, S. L., Natarajan, R., Gofron, K., McSweeney, S., Soares, A. S. &amp; Leroy, L. (2018). <italic>Acta Cryst.</italic> D<bold>74</bold>, 986–999.</mixed-citation>
    </ref>
    <ref id="bb44">
      <mixed-citation publication-type="other">Sanchez-Weatherby, J., Sandy, J., Mikolajek, H., Lobley, C. M. C., Mazzorana, M., Kelly, J., Preece, G., Littlewood, R. &amp; Sørensen, T. L.-M. (2019). <italic>J. Synchrotron Rad.</italic>
<bold>26</bold>, 291–301.</mixed-citation>
    </ref>
    <ref id="bb45">
      <mixed-citation publication-type="other">Schiebel, J., Krimmer, S. G., Röwer, K., Knörlein, A., Wang, X., Park, A. Y., Stieler, M., Ehrmann, F. R., Fu, K., Radeva, N., Krug, M., Huschmann, F. U., Glöckner, S., Weiss, M. S., Mueller, U., Klebe, G. &amp; Heine, A. (2016). <italic>Structure</italic>, <bold>24</bold>, 1398–1409.</mixed-citation>
    </ref>
    <ref id="bb46">
      <mixed-citation publication-type="other">Schurmann, J., Lindhe, I., Janneck, J. W., Lima, G. &amp; Matej, Z. (2019). <italic>2019 53rd Asilomar Conference on Signals, Systems, and Computers</italic>, pp. 978–983. Piscataway: IEEE.</mixed-citation>
    </ref>
    <ref id="bb47">
      <mixed-citation publication-type="other">Smart, O. S., Womack, T. O., Flensburg, C., Keller, P., Paciorek, W., Sharff, A., Vonrhein, C. &amp; Bricogne, G. (2012). <italic>Acta Cryst.</italic> D<bold>68</bold>, 368–380.</mixed-citation>
    </ref>
    <ref id="bb48">
      <mixed-citation publication-type="other">Smart, O. S., Womack, T. O., Sharff, A., Flensburg, C., Keller, P., Paciorek, W., Vonrhein, C. &amp; Bricogne, G. (2011). <italic>GRADE</italic>. Global Phasing Ltd, Cambridge, UK.</mixed-citation>
    </ref>
    <ref id="bb49">
      <mixed-citation publication-type="other">Smart, O. S., Womack, T. O., Sharff, A., Flensburg, C., Keller, P., Paciorek, W., Vonrhein, C. &amp; Bricogne, G. (2014). <italic>Rhofit</italic>. Global Phasing Ltd, Cambridge, UK.</mixed-citation>
    </ref>
    <ref id="bb50">
      <mixed-citation publication-type="other">Sparta, K. M., Krug, M., Heinemann, U., Mueller, U. &amp; Weiss, M. S. (2016). <italic>J. Appl. Cryst.</italic>
<bold>49</bold>, 1085–1092.</mixed-citation>
    </ref>
    <ref id="bb57">
      <mixed-citation publication-type="other">Stetten, D. von, Carpentier, P., Flot, D., Beteva, A., Caserotto, H., Dobias, F., Guijarro, M., Giraud, T., Lentini, M., McSweeney, S., Royant, A., Petitdemange, S., Sinoir, J., Surr, J., Svensson, O., Theveneau, P., Leonard, G. A. &amp; Mueller-Dieckmann, C. (2020). <italic>J. Synchrotron Rad.</italic>
<bold>27</bold>, 844–851.</mixed-citation>
    </ref>
    <ref id="bb51">
      <mixed-citation publication-type="other">Svensson, O., Andreu, J., Karpics, I. &amp; Nan, J. (2020). <italic>Lucid3: A Computer Vision Python Library that Detects Crystallography Sample Holders. </italic>https://github.com/mxcube/lucid3.</mixed-citation>
    </ref>
    <ref id="bb52">
      <mixed-citation publication-type="other">Svensson, O., Gilski, M., Nurizzo, D. &amp; Bowler, M. W. (2018). <italic>Acta Cryst.</italic> D<bold>74</bold>, 433–440.</mixed-citation>
    </ref>
    <ref id="bb53">
      <mixed-citation publication-type="other">Terwilliger, T. C., Adams, P. D., Moriarty, N. W. &amp; Cohn, J. D. (2007). <italic>Acta Cryst.</italic> D<bold>63</bold>, 101–107.</mixed-citation>
    </ref>
    <ref id="bb54">
      <mixed-citation publication-type="other">Terwilliger, T. C., Klei, H., Adams, P. D., Moriarty, N. W. &amp; Cohn, J. D. (2006). <italic>Acta Cryst.</italic> D<bold>62</bold>, 915–922.</mixed-citation>
    </ref>
    <ref id="bb55">
      <mixed-citation publication-type="other">Ursby, T., Åhnberg, K., Appio, R., Aurelius, O., Barczyk, A., Bartalesi, A., Bjelčić, M., Bolmsten, F., Cerenius, Y., Doak, R. B., Eguiraun, M., Eriksson, T., Friel, R. J., Gorgisyan, I., Gross, A., Haghighat, V., Hennies, F., Jagudin, E., Norsk Jensen, B., Jeppsson, T., Kloos, M., Lidon-Simon, J., de Lima, G. M. A., Lizatovic, R., Lundin, M., Milan-Otero, A., Milas, M., Nan, J., Nardella, A., Rosborg, A., Shilova, A., Shoeman, R. L., Siewert, F., Sondhauss, P., Talibov, V. O., Tarawneh, H., Thånell, J., Thunnissen, M., Unge, J., Ward, C., Gonzalez, A. &amp; Mueller, U. (2020). <italic>J. Synchrotron Rad.</italic>
<bold>27</bold>, 1415–1429.</mixed-citation>
    </ref>
    <ref id="bb56">
      <mixed-citation publication-type="other">Vonrhein, C., Flensburg, C., Keller, P., Sharff, A., Smart, O., Paciorek, W., Womack, T. &amp; Bricogne, G. (2011). <italic>Acta Cryst.</italic> D<bold>67</bold>, 293–302.</mixed-citation>
    </ref>
    <ref id="bb58">
      <mixed-citation publication-type="other">Winn, M. D., Ballard, C. C., Cowtan, K. D., Dodson, E. J., Emsley, P., Evans, P. R., Keegan, R. M., Krissinel, E. B., Leslie, A. G. W., McCoy, A., McNicholas, S. J., Murshudov, G. N., Pannu, N. S., Potterton, E. A., Powell, H. R., Read, R. J., Vagin, A. &amp; Wilson, K. S. (2011). <italic>Acta Cryst.</italic> D<bold>67</bold>, 235–242.</mixed-citation>
    </ref>
    <ref id="bb59">
      <mixed-citation publication-type="other">Winter, G. &amp; McAuley, K. E. (2011). <italic>Methods</italic>, <bold>55</bold>, 81–93.</mixed-citation>
    </ref>
    <ref id="bb60">
      <mixed-citation publication-type="other">Winter, G., Waterman, D. G., Parkhurst, J. M., Brewster, A. S., Gildea, R. J., Gerstel, M., Fuentes-Montero, L., Vollmar, M., Michels-Clark, T., Young, I. D., Sauter, N. K. &amp; Evans, G. (2018). <italic>Acta Cryst.</italic> D<bold>74</bold>, 85–97.</mixed-citation>
    </ref>
    <ref id="bb61">
      <mixed-citation publication-type="other">Wojdyr, M. (2016). <italic>UglyMol – View Protein Models and Electron Density</italic>. https://uglymol.github.io/.</mixed-citation>
    </ref>
    <ref id="bb41">
      <mixed-citation publication-type="other">Wollenhaupt, J., Barthel, T., Lima, G. M. A., Metz, A., Wallacher, D., Jagudin, E., Huschmann, F. U., Hauss, T., Feiler, C. G., Gerlach, M., Hellmig, M., Förster, R., Steffien, M., Heine, A., Klebe, G., Mueller, U. &amp; Weiss, M. S. (2021). <italic>J. Vis. Exp.</italic>
<bold>3</bold>, doi:10.3791/62208.</mixed-citation>
    </ref>
    <ref id="bb62">
      <mixed-citation publication-type="other">Wollenhaupt, J., Metz, A., Barthel, T., Lima, G. M. A., Heine, A., Mueller, U., Klebe, G. &amp; Weiss, M. S. (2020). <italic>Structure</italic>, <bold>28</bold>, 694–706.</mixed-citation>
    </ref>
    <ref id="bb63">
      <mixed-citation publication-type="other">Wright, N. D., Collins, P., Koekemoer, L., Krojer, T., Talon, R., Nelson, E., Ye, M., Nowak, R., Newman, J., Ng, J. T., Mitrovich, N., Wiggers, H. &amp; von Delft, F. (2021). <italic>Acta Cryst.</italic> D<bold>77</bold>, 62–74.</mixed-citation>
    </ref>
    <ref id="bb64">
      <mixed-citation publication-type="other">Yin, X., Scalia, A., Leroy, L., Cuttitta, C. M., Polizzo, G. M., Ericson, D. L., Roessler, C. G., Campos, O., Ma, M. Y., Agarwal, R., Jackimowicz, R., Allaire, M., Orville, A. M., Sweet, R. M. &amp; Soares, A. S. (2014). <italic>Acta Cryst.</italic> D<bold>70</bold>, 1177–1189.</mixed-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="fig1" orientation="portrait" position="float">
    <label>Figure 1</label>
    <caption>
      <p>(<italic>a</italic>) <italic>FragMAXapp</italic> schematic diagram. The diagram shows connected steps and the relationship between each interaction, process and database entry. It is divided into three groups based on where the actions take place. Steps coloured dark grey use the HTML interface for interaction, light grey steps are tasks performed in the experimental laboratory and chequered steps are tasks performed in the background (for example HPC jobs). (<italic>b</italic>) <italic>FragMAXapp</italic> development design. Processing jobs are controlled by a Slurm workload manager installed in the front end of the MAX IV HPC. The three servers and the database necessary for <italic>FragMAXapp</italic> are deployed inside a Docker container inside a virtual machine, ensuring performance and stability of the installation. The user interface is designed using HTML5, CSS3 and JavaScript, which are available in all modern browsers.</p>
    </caption>
    <graphic xlink:href="d-77-00799-fig1"/>
  </fig>
  <fig id="fig2" orientation="portrait" position="float">
    <label>Figure 2</label>
    <caption>
      <p><italic>FragMAXapp</italic> Project Overview page. It displays information about the data collection and the status of data processing. A full representation of the user interface is available in <ext-link ext-link-type="uri" xlink:href="#suppinfoanchor">Supplementary Fig. S2</ext-link>.</p>
    </caption>
    <graphic xlink:href="d-77-00799-fig2"/>
  </fig>
  <fig id="fig3" orientation="portrait" position="float">
    <label>Figure 3</label>
    <caption>
      <p><italic>FragMAXapp</italic> sample-management page. The 2D representations of the ligands are generated using <italic>RDKit</italic>, while 3D representations are displayed using the 3<italic>Dmol</italic> library. This page allows additions or updates to the sample definitions within the project. A full representation of the user interface is available in <ext-link ext-link-type="uri" xlink:href="#suppinfoanchor">Supplementary Fig. S3</ext-link>.</p>
    </caption>
    <graphic xlink:href="d-77-00799-fig3"/>
  </fig>
  <fig id="fig4" orientation="portrait" position="float">
    <label>Figure 4</label>
    <caption>
      <p><italic>FragMAXapp</italic> Data Analysis page. An extensive selection of software and pipelines is available to analyse the data. A full representation of the user interface is available in <ext-link ext-link-type="uri" xlink:href="#suppinfoanchor">Supplementary Fig. S4</ext-link>.</p>
    </caption>
    <graphic xlink:href="d-77-00799-fig4"/>
  </fig>
  <fig id="fig5" orientation="portrait" position="float">
    <label>Figure 5</label>
    <caption>
      <p><italic>FragMAXapp</italic> density viewer. The viewer features unexplained blobs and navigation between the models, information about the result, log access, ligand navigation for automatic ligand-fitting results and structure scores. The density viewer is based on <italic>UglyMOL</italic>. A full representation of the user interface is available in <ext-link ext-link-type="uri" xlink:href="#suppinfoanchor">Supplementary Fig. S5</ext-link>.</p>
    </caption>
    <graphic xlink:href="d-77-00799-fig5"/>
  </fig>
  <fig id="fig6" orientation="portrait" position="float">
    <label>Figure 6</label>
    <caption>
      <p>Proteinase K sites numbered from 1 to 7 as identified by <italic>PanDDA</italic> analysis.</p>
    </caption>
    <graphic xlink:href="d-77-00799-fig6"/>
  </fig>
  <fig id="fig7" orientation="portrait" position="float">
    <label>Figure 7</label>
    <caption>
      <p>Automated ligand-searching comparison. The <italic>LigandFit</italic> and <italic>Rhofit</italic> columns take the highest scored ligand from each method. The <italic>PanDDA</italic> column shows ligands that were manually modelled. Ligands with a different binding site for different methods are annotated. All structures and density maps are publicly available.</p>
    </caption>
    <graphic xlink:href="d-77-00799-fig7"/>
  </fig>
  <table-wrap id="table1" orientation="portrait" position="float">
    <label>Table 1</label>
    <caption>
      <title>Data-collection parameters for PROK crystals at BioMAX</title>
    </caption>
    <table frame="hsides" rules="groups">
      <thead valign="bottom">
        <tr>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom"> </th>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">Cryo temperature</th>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">Room temperature</th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">Wavelength (Å)</td>
          <td rowspan="1" colspan="1" align="left" valign="top">0.976</td>
          <td rowspan="1" colspan="1" align="left" valign="top">0.976</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">No. of images</td>
          <td rowspan="1" colspan="1" align="left" valign="top">3600</td>
          <td rowspan="1" colspan="1" align="left" valign="top">1800</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">Oscillation (°)</td>
          <td rowspan="1" colspan="1" align="left" valign="top">0.1</td>
          <td rowspan="1" colspan="1" align="left" valign="top">0.20 (helical scan)</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">Exposure (ms)</td>
          <td rowspan="1" colspan="1" align="left" valign="top">11</td>
          <td rowspan="1" colspan="1" align="left" valign="top">10</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">Photon flux (photons s<sup>−1</sup>)</td>
          <td rowspan="1" colspan="1" align="left" valign="top">∼1 × 10<sup>12</sup>
</td>
          <td rowspan="1" colspan="1" align="left" valign="top">∼1 × 10<sup>11</sup>
</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">Beam size (µm)</td>
          <td rowspan="1" colspan="1" align="left" valign="top">50 × 50</td>
          <td rowspan="1" colspan="1" align="left" valign="top">50 × 50</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">Resolution (at the edge) (Å)</td>
          <td rowspan="1" colspan="1" align="left" valign="top">1.24</td>
          <td rowspan="1" colspan="1" align="left" valign="top">1.24</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</floats-group>
