<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Data</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Data</journal-id>
    <journal-title-group>
      <journal-title>Scientific Data</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2052-4463</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7359037</article-id>
    <article-id pub-id-type="publisher-id">574</article-id>
    <article-id pub-id-type="doi">10.1038/s41597-020-0574-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Data Descriptor</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>TAASRAD19, a high-resolution weather radar reflectivity dataset for precipitation nowcasting</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1264-0529</contrib-id>
        <name>
          <surname>Franch</surname>
          <given-names>Gabriele</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Maggio</surname>
          <given-names>Valerio</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Coviello</surname>
          <given-names>Luca</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pendesini</surname>
          <given-names>Marta</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2705-5728</contrib-id>
        <name>
          <surname>Jurman</surname>
          <given-names>Giuseppe</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5384-3605</contrib-id>
        <name>
          <surname>Furlanello</surname>
          <given-names>Cesare</given-names>
        </name>
        <address>
          <email>cesare.furlanello@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.11469.3b</institution-id><institution-id institution-id-type="ISNI">0000 0000 9780 0901</institution-id><institution>Fondazione Bruno Kessler, </institution></institution-wrap>Trento, Italy </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.11696.39</institution-id><institution-id institution-id-type="ISNI">0000 0004 1937 0351</institution-id><institution>University of Trento, </institution></institution-wrap>Trento, Italy </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.5337.2</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 7603</institution-id><institution>University of Bristol, </institution></institution-wrap>Bristol, UK </aff>
      <aff id="Aff4"><label>4</label>Meteotrentino, Trento, Italy </aff>
      <aff id="Aff5"><label>5</label>HK3 Lab, Milan, Italy </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>7</volume>
    <elocation-id>234</elocation-id>
    <history>
      <date date-type="received">
        <day>3</day>
        <month>1</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>6</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
        <license-p>The Creative Commons Public Domain Dedication waiver <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link> applies to the metadata files associated with this article.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">We introduce TAASRAD19, a high-resolution radar reflectivity dataset collected by the Civil Protection weather radar of the Trentino South Tyrol Region, in the Italian Alps. The dataset includes 894,916 timesteps of precipitation from more than 9 years of data, offering a novel resource to develop and benchmark analog ensemble models and machine learning solutions for precipitation nowcasting. Data are expressed as 2D images, considering the maximum reflectivity on the vertical section at 5 min sampling rate, covering an area of 240 km of diameter at 500 m horizontal resolution. The TAASRAD19 distribution also includes a curated set of 1,732 sequences, for a total of 362,233 radar images, labeled with precipitation type tags assigned by expert meteorologists. We validate TAASRAD19 as a benchmark for nowcasting methods by introducing a TrajGRU deep learning model to forecast reflectivity, and a procedure based on the UMAP dimensionality reduction algorithm for interactive exploration. Software methods for data pre-processing, model training and inference, and a pre-trained model are publicly available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/MPBA/TAASRAD19">https://github.com/MPBA/TAASRAD19</ext-link>) for study replication and reproducibility.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="summary">
      <p id="Par2">
        <table-wrap id="Taba">
          <table frame="hsides" rules="groups">
            <tbody>
              <tr>
                <td>Measurement(s)</td>
                <td>hydrological precipitation process</td>
              </tr>
              <tr>
                <td>Technology Type(s)</td>
                <td>computational modeling technique • digital curation</td>
              </tr>
              <tr>
                <td>Factor Type(s)</td>
                <td>year of data collection</td>
              </tr>
              <tr>
                <td>Sample Characteristic - Environment</td>
                <td>climate system</td>
              </tr>
              <tr>
                <td>Sample Characteristic - Location</td>
                <td>Autonomous Region of Trentino-Alto Adige/Sudtirol</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </p>
      <p id="Par3">Machine-accessible metadata file describing the reported data: 10.6084/m9.figshare.12529484</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Computational science</kwd>
      <kwd>Atmospheric dynamics</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background &amp; Summary</title>
    <p id="Par4">Effects of climate change on the increased frequency and magnitude of extreme weather events have been consistently described<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR2">2</xref></sup>, and a shift towards a more extreme precipitation climate (the so-called “tropicalisation”) has been predicted by models<sup><xref ref-type="bibr" rid="CR3">3</xref></sup> and observed across Europe<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR5">5</xref></sup>. In this work, we focus on precipitation <italic>nowcasting</italic>, i.e. forecasting within a short time interval (e.g. 0 to 6 hours), in particular for extreme and fast evolving precipitation events<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>.</p>
    <p id="Par5">State of the art solutions for precipitation nowcasting are solidly based on weather radar data<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>, due to a known direct relationship between radar reflectivity and rain rate<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. Significant efforts have been undertaken to share open source weather radar resources, including software for analysis and visualization<sup><xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR14">14</xref></sup> and open data repositories (see <ext-link ext-link-type="uri" xlink:href="https://openradarscience.org/opendata/">https://openradarscience.org/opendata/</ext-link>). Open datasets are collected and maintained by international Weather Data institutions across the US and Europe. The main publicly available products are (a) RADOLAN and RADKLIM<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>, by the German Weather Service; (b) NEXRAD Level II<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>, by the US National Oceanic and Atmospheric Service (NOAA); and (c) the dataset by the Royal Netherlands Meteorological Institute (KNMI)<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>. All these datasets provide radar reflectivity (as well as rain-gauge) data, with 1 km spatial resolution, and 5 min temporal resolution.</p>
    <p id="Par6">Here we release TAASRAD19, a dataset of weather radar maps covering an area of 240 km of diameter, collected in the Trentino South Tyrol region, in the center of the Italian Alps. TAASRAD19 features more than 9 years (7/2010–12/2019) of reflectivity product of the radar, at high spatial resolution (0.5 km) with 5 min temporal updates. TAASRAD19 is the first available resource for sub-kilometer, high-frequency, extended time-span weather data for the Italian Alps. Notably, highly variable orography and environmental complexity make precipitation forecasting exceptionally challenging in the area. The temporal coverage of the dataset (almost 900 thousand time steps over about 1,250 days with precipitations) is thus a key enabler for developing computational models for precipitation nowcasting and early detection of extreme events, in particular for implementing analog ensemble models and machine learning solutions.</p>
    <p id="Par7">The dataset has been released on Zenodo, providing the full collection of all time steps<sup><xref ref-type="bibr" rid="CR18">18</xref>,<xref ref-type="bibr" rid="CR19">19</xref></sup>, along with a curated selection of 1,732 sequences of precipitation (362,233 time steps)<sup><xref ref-type="bibr" rid="CR20">20</xref>,<xref ref-type="bibr" rid="CR21">21</xref></sup>. The sequences describe a wide range of precipitation events, including extreme rain phenomena, exceptional downpours, long intense snowfalls, and localized hailstorms. Events have been annotated by experts with precipitation classification tags extracted from daily weather summaries. As a technical validation of TAASRAD19, the annotated data are used to develop a deep learning solution for precipitation nowcasting<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. Finally, the structure of each image data can be explored with an interactive data visualization of an Uniform Manifold Approximation and Projection (UMAP) embedding<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>. The UMAP dimensionality reduction method can be used for unsupervised machine learning analysis<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>; on TAASRAD19, it has been used in combination with a generalization of Dynamic Time Warping distance<sup><xref ref-type="bibr" rid="CR25">25</xref></sup> to implement fast analog ensemble search among radar sequences<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <p id="Par8">The data included in TAASRAD19 were provided by <italic>Meteotrentino</italic>, the official Civil Protection Weather Forecasting Agency of the Autonomous Province of Trento, Italy. The agency operates a single-polarization Doppler C-Band Radar, in collaboration with <italic>Meteobolzano</italic>, the Civil Protection Agency of the Autonomous Province of Bolzano. The latter is responsible for the maintenance, operation and calibration of the receiver, as well as the generation of the products, while Meteotrentino is responsible for all the downstream tasks, <italic>i.e</italic> quality control, rainrate conversion, forecasting and alerting. The radar is located on Mt. Macaion (1,866 m.a.s.l.), within a complex orographic environment in the center of the Italian Alps (N 46 29′18″, E 11 12′38″). The radar system is an EEC DWSR-2500C and has been in operation since 2001 at the beginning with different operating modes and scan strategies (6 to 10 minutes time-steps). Between 2009 and 2010 the radar analog receiver was upgraded with the installation of an Eldes NDRX digital receiver. The update has improved both the signal quality and the scanning frequency of the radar system. Since the upgrade completed in mid 2010, the radar has been operating with the same scan strategy at a constant time-step of 5 minutes, for a total of 288 time steps per day. Details about the operational parameters and scan strategy are reported in Table <xref rid="Tab1" ref-type="table">1</xref> and Fig. <xref rid="Fig1" ref-type="fig">1</xref> respectively.<fig id="Fig1"><label>Fig. 1</label><caption><p>Scan strategy and signal characteristics of the mt. Macaion radar. Different Pulse Request Frequency (PRF), Power and rotation speeds are used in low and high elevation scans. Low elevation scans perform slower rotation (9°/<italic>s</italic>), use higher pulse frequency (1200) and lower power (281 kW), while high elevation scans perform fast rotation (28°/<italic>s</italic>), use low pulse frequency (310) and higher power (307 kW). The maximum terrain altitude for each range bin is reported in gray, showing that substantial beam blocking is encountered at lower elevations (0–2 degrees).</p></caption><graphic xlink:href="41597_2020_574_Fig1_HTML" id="d30e496"/></fig><fig id="Fig2"><label>Fig. 2</label><caption><p>Beam Blockage Fraction (BBF) at different range and altitude. The upper row shows the digital terrain model, and the beam blockage percentage for the scans at 0, 1 and 2 degrees of elevation. The blue, green and red segments at 13 degrees azimuth on the maps (above) correspond to the cross section lines shown in the lower plot. The dashed lines represent the Beam Blockage Fraction (BBF) for each elevation at a given range.</p></caption><graphic xlink:href="41597_2020_574_Fig2_HTML" id="d30e505"/></fig><fig id="Fig3"><label>Fig. 3</label><caption><p>Example of the radar reflectivity (MAX(<italic>Z</italic>) product) in TAASRAD19.</p></caption><graphic xlink:href="41597_2020_574_Fig3_HTML" id="d30e520"/></fig><fig id="Fig4"><label>Fig. 4</label><caption><p>Overview of software methods for pre-processing and modeling of TAASRAD19 data.</p></caption><graphic xlink:href="41597_2020_574_Fig4_HTML" id="d30e532"/></fig><fig id="Fig5"><label>Fig. 5</label><caption><p>Radar operativity. Bar length represents the amount of time the radar has been in operation (not in maintenance or shut down), as percentage of valid 5 min frames over the total feasible in the year; yellow line: mean radar operativity (89.55).</p></caption><graphic xlink:href="41597_2020_574_Fig5_HTML" id="d30e541"/></fig></p>
    <p id="Par9">Offline calibration of the radar system is performed at least once a year with scheduled maintenance for the calibration of both the transmitter and receiver ends. During normal operations, continuous monitoring on the receiver end is performed by the Built In Test Equipment (BITE), while polar volume quality assessment is performed as part of the regular scan strategy by monitoring variations of the recorded background noise at high elevation (long PTR scan at high elevations) and by solar scans. The polar reflectivity generated by the scan is filtered and corrected from the back-scattering of most of fixed obstacles using a Doppler correction filter<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>. The products used here are calibrated by the data provider Meteobolzano by taking into account the corrections computed as a results of the monitoring and calibration.</p>
    <p id="Par10">Although multiple data products can be derived by the radar, in this data descriptor we focus on the 2D maximum reflectivity MAX(<italic>Z</italic>) generated from the filtered polar volume provided to the authors from Meteobolzano. The MAX(<italic>Z</italic>) product is computed as the maximum value (expressed in dBZ) for each pixel of a predefined grid, measured on the vertical section in the filtered and corrected polar volume. For the Mt. Macaion radar, the product consists of a bi-dimensional metric grid of 480 × 480 pixels (projected in UTM 32 N coordinate system), with 500 m pixel size covering an area of 240 km of diameter (27,225 sq km) and centered at the radar site.</p>
    <p id="Par11">Despite the maximum reflectivity is potentially affected by noise, MAX(<italic>Z</italic>) is still preferred in the case of mountainous environments over alternative features commonly used for quantitative precipitation estimation, e.g. the <italic>Constant Altitude Plain Position Indicators</italic> (CAPPI). In fact, due to the high operating altitude of the receiver, CAPPI and similar products can miss precipitation events at altitudes lower than the radar location. Moreover, the MAX(<italic>Z</italic>) products helps alleviating the severe beam blockage that the radar experiences by the nearby mountains at lower elevation scans. Computation of the occlusion experienced by the radar at the first three elevations (0, 1 and 2 degrees) of the volume is displayed in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, along with an example cross section. Note that MAX(<italic>Z</italic>) has been recently adopted as the standard by the pan-european radar composite for real time assessment purposes<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>.</p>
    <p id="Par12">The MAX(<italic>Z</italic>) product is thresholded at a lower bound of 0 dBZ: while the receiver can indeed observe a certain amount of drizzle in the negative range of MAX(<italic>Z</italic>), its detection is exceptionally uneven for the mt. Macaion radar, being drizzle mainly a low altitude phenomena. The high altitude of the receiver (1870 m.a.s.l.) and the severe beam blockage at low elevations allow the receiver to register drizzle almost exclusively in the underlying Adige valley, situated below the radar (200 m.a.s.l.). Even there, most of the drizzle is observed several hundred meters above the ground, and as such, it evaporates before reaching the ground. Given all these considerations and the specificity of the MAX(Z), it has always been standard practice for Meteotrentino to threshold the product at 0 dBZ.</p>
    <p id="Par13">An example of MAX(<italic>Z</italic>) product overlaid on the digital elevation model (gray colour map), main idrography (in blue), and administrative borders (red line) is displayed in Fig. <xref rid="Fig3" ref-type="fig">3</xref>.</p>
    <p id="Par14">In order to standardize the development of nowcasting models from TAASRAD19, both the original MAX(<italic>Z</italic>) products and the processed version of the dataset are available. For reproducibility, the methods used for pre-processing, modeling and validation are also provided. They are composed of three main sections:</p>
    <sec id="Sec3">
      <title>Sequence extraction</title>
      <p id="Par15">Obtaining contiguous and labelled precipitation sequences from the full image repository;</p>
    </sec>
    <sec id="Sec4">
      <title>Noise mitigation</title>
      <p id="Par16">Reducing noise and systematic artefacts in the MAX(<italic>Z</italic>) product;</p>
    </sec>
    <sec id="Sec5">
      <title>Technical validation</title>
      <p id="Par17">Deep learning forecasting and UMAP analysis.</p>
      <p id="Par18">In particular, the methods can be combined into a pipeline for developing nowcasting applications, with emphasis on those applying deep learning models. An overview of software methods for TAASRAD19 is displayed in Fig. <xref rid="Fig4" ref-type="fig">4</xref>; details for each main software module are provided in the following subsections.</p>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Sequence Extraction</title>
    <p id="Par19">The elementary patterns for training and operating nowcasting systems are sequences of radar time steps (frames). The sequence extraction process applied to the raw TAASRAD19 data is based on four basic requirements:<list list-type="order"><list-item><p id="Par20">Each sequence must be contiguous in time (no missing frames), of sufficient length (at least two hours per sequence, to account for operational requirements of nowcasting methods and to guarantee sufficient decorrelation time<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>);</p></list-item><list-item><p id="Par21">Each sequence should include at least one frame precipitation; sequences without precipitation signal are removed;</p></list-item><list-item><p id="Par22">The full set of sequences should match the original data distribution in terms of seasonal occurrence (day/night, months, seasons), as well as precipitation types;</p></list-item><list-item><p id="Par23">The sequences should be as clean as possible from noise or artefacts.</p></list-item></list></p>
    <p id="Par24">Descriptive statistics on the original data are listed in Table <xref rid="Tab2" ref-type="table">2</xref>. The mean pixel value per frame varies from a minimum of 4.5 · 10<sup>−4</sup> to a maximum of 32.3. Clearly, a positive minimum indicates the presence of noise in images, even in the absence of precipitation. A noise-mitigation strategy is thus needed. Figure <xref rid="Fig5" ref-type="fig">5</xref> reports the annual radar operativity, i.e., the amount of time the radar has been in operation over the ten years (thus, not in maintenance or shut down), expressed as the percentage of valid 5 min frames over the total feasible in the year.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Technical characteristics and operational parameters of the mt. Macaion radar.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Parameter</th><th>Value</th></tr></thead><tbody><tr><td>Operational range</td><td>120 km</td></tr><tr><td>Maximum range</td><td>480 km</td></tr><tr><td>Resolution in range</td><td>250 m</td></tr><tr><td>Antenna Gain</td><td>45.8 db</td></tr><tr><td>dB beamwidth</td><td>0.9°</td></tr><tr><td>Wavelength</td><td>5.3 cm (5.6 Ghz)</td></tr><tr><td>Peak Power</td><td>307 kW</td></tr><tr><td>Pulse duration</td><td>0.8 <italic>μ</italic>s</td></tr><tr><td>Clutter to Signal Ratio (CSR)</td><td>8.0</td></tr><tr><td>Signal Quality Index (SQI)</td><td>0.25</td></tr><tr><td>Ground clutter correction</td><td>Doppler filter</td></tr></tbody></table></table-wrap><table-wrap id="Tab2"><label>Table 2</label><caption><p>Descriptive Statistics of Radar frames included in TAASRAD19.</p></caption><table frame="hsides" rules="groups"><tbody><tr><td>Total number of time steps</td><td>894,916</td></tr><tr><td>Total number of recorded days</td><td>3,292</td></tr><tr><td>Minimum – Maximum pixel values</td><td>0–52.5</td></tr><tr><td>Minimum – Maximum frame mean pixel values</td><td>4.5 · 10<sup>−4</sup>–32.3</td></tr><tr><td>Radar operativity between Jun 2010 and Dec 2019</td><td>89.55%</td></tr></tbody></table></table-wrap><table-wrap id="Tab3"><label>Table 3</label><caption><p>Keywords used to extract the weak labels from the daily weather summaries.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Keyword</th><th>weak-label</th></tr></thead><tbody><tr><td>precip, piov, piog</td><td>rain</td></tr><tr><td>grand</td><td>hail</td></tr><tr><td>temporal</td><td>storm</td></tr><tr><td>rovesc</td><td>downpour</td></tr><tr><td>nev</td><td>snow</td></tr></tbody></table><table-wrap-foot><p>Keywords correspond to word stems (in Italian) to account for plurals and other morphological inflections.</p></table-wrap-foot></table-wrap></p>
    <p id="Par25">In addition to radar products, we collected the daily weather summary written by an operational meteorologist for each day. The summaries are provided in the form of a short overview, in Italian, describing the main meteorological conditions in the region during the day. A set of keywords corresponding to specific meteorological events (e.g. <italic>storm, rain, snow, hail</italic>) were extracted automatically from the summaries to tag the precipitation patterns from the radar sequences by <italic>weak-labels</italic>, i.e. labels that should be considered incomplete, inexact and inaccurate but are nonetheless useful for machine learning purposes<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>. The annotations in TAASRAD19 can be used in supervised or semi-supervised machine learning algorithms. The absence of those keywords has been combined with other descriptors of the radar images to identify and exclude sequences without precipitation events. The complete text of daily weather summaries are also released together with the radar data in the TAASRAD19 repositories<sup><xref ref-type="bibr" rid="CR18">18</xref>,<xref ref-type="bibr" rid="CR19">19</xref></sup>.</p>
    <p id="Par26">In summary, the sequence extraction process is composed of four steps:</p>
    <sec id="Sec7">
      <title>Data selection</title>
      <p id="Par27">To avoid seasonal imbalance, we select the interval 2010-11-01 and 2019-10-31, corresponding to exactly 9 years of data.</p>
    </sec>
    <sec id="Sec8">
      <title>Data chunking</title>
      <p id="Par28">The set of time steps is partitioned into multiple chunks of contiguous frames within a single day. Since some frames might be missing due to radar’s fault or errors in the processing pipeline, multiple chunks can account for the same day. Moreover, only chunks longer than 2 hours (i.e. 24 frames) are retained. Thus the length of each sequence varies from 25 to 288 contiguous frames, i.e. a single whole day with no missing data.</p>
    </sec>
    <sec id="Sec9">
      <title>Sequence filtering</title>
      <p id="Par29">Sequences with no or few precipitation events are removed. To retain useful chunks, we adopt a selection strategy based on the <italic>Average Pixel Value</italic> (APV) of the chunk (defined as the mean value over all pixels of the sequence), and the <italic>weak-labels</italic> assigned to the corresponding day. First, all the sequences <italic>s</italic> where APV(<italic>s</italic>) &lt; 0.5 dBZ are immediately discarded, whereas those with APV(<italic>s</italic>) &gt; 1.0 dBZ are retained. We thus filter out sequences with only background noise and retain those with at least one precipitation pattern. For all the remaining sequences (i.e. 0.5 dBZ ≤ APV(<italic>s</italic>) ≤ 1.0 dBZ), we leverage on the <italic>weak-labels</italic> annotated from the daily summaries to identify sequences with precipitation events. Sequences with no label - <italic>i.e.</italic> with no precipitation event registered for the corresponding day - are discarded. A graphical representation of the decision strategy workflow is depicted in Fig. <xref rid="Fig6" ref-type="fig">6</xref>.<fig id="Fig6"><label>Fig. 6</label><caption><p>Decision tree of the strategy used to filter frame sequences based on corresponding APV value (the mean value over all pixels of the sequence), and <italic>weak-labels</italic>.</p></caption><graphic xlink:href="41597_2020_574_Fig6_HTML" id="d30e972"/></fig><fig id="Fig7"><label>Fig. 7</label><caption><p>The left figure shows the map of noisy pixels and orography in the operation region; noise value is computed as the average of radar signal over the most clear sky images, showing systematic artifacts. The right image shows TAASRAD19 outlier mask; black pixels correspond to outliers and the area outside the radar operational range.</p></caption><graphic xlink:href="41597_2020_574_Fig7_HTML" id="d30e984"/></fig><fig id="Fig8"><label>Fig. 8</label><caption><p>File structure of the TAASRAD19 ASCII image archive in the 2018–19 repository.</p></caption><graphic xlink:href="41597_2020_574_Fig8_HTML" id="d30e996"/></fig><fig id="Fig9"><label>Fig. 9</label><caption><p>File structure of the TAASRAD19 HDF5 sequence archive.</p></caption><graphic xlink:href="41597_2020_574_Fig9_HTML" id="d30e1009"/></fig><fig id="Fig10"><label>Fig. 10</label><caption><p>UMAP Embedding for TAASRAD19_u162k: plot of the first (x axis) and third (y axis) components. Each point is a radar frame in the projected UMAP space, colorized by Wet Area Ratio (WAR). Frames with similar rain patterns are placed closer together. Insets show examples of three different precipitation patterns and their position in the UMAP projected space.</p></caption><graphic xlink:href="41597_2020_574_Fig10_HTML" id="d30e1027"/></fig><fig id="Fig11"><label>Fig. 11</label><caption><p>Screenshot of the interactive radar analog exploration tool.</p></caption><graphic xlink:href="41597_2020_574_Fig11_HTML" id="d30e1036"/></fig></p>
    </sec>
    <sec id="Sec10">
      <title>Sequence labelling</title>
      <p id="Par30">All the retained sequences are labelled according to the corresponding <italic>weak-label</italic> from the daily summary, wherever possible. The complete list of all keywords used (in the form of word stems, in Italian), and corresponding <italic>weak-labels</italic> is reported in Table <xref rid="Tab3" ref-type="table">3</xref>.</p>
      <p id="Par31">The resulting number of sequences in TAASRAD19 is 1,732, describing a total of 362,233 time steps, mapped to 1,258 days of precipitation data. Sequences are available at the Zenodo TAASRAD19 repository<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>, along with related metadata files, including labels and statistics.</p>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Noise Mitigation</title>
    <p id="Par32">The main goal of the noise removal step is to identify recurring noise patterns (i.e. outliers in specific pixel location) that can consistently occur in most radar images. Removing such outliers is particularly important, especially for methods (e.g. machine learning) whose performance may be affected by the presence of values (largely) out of the data distribution. We investigate the issue by generating a map to observe the presence of outlier pixels, from which we then derive a data-driven strategy for a <italic>global outlier mask</italic>.</p>
    <sec id="Sec12">
      <title>Noise analysis</title>
      <p id="Par33">To check for outlier pixels, we ranked each time step for increasing APV (i.e. from the least to the most rainy) and we considered the top 0.1% of the ranking (895 frames) to compute a map of background noise. The noise map was generated as the average (per-pixel) of the 895 less rainy frames, which correspond to clear sky condition sampled at different times through the dataset.</p>
      <p id="Par34">As shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref>, where the computed map is overlaid to the digital terrain model, there is thus evidence of systematic artifacts in the signal.</p>
    </sec>
    <sec id="Sec13">
      <title>Outlier mask</title>
      <p id="Par35">Systematic noise signals can be associated to non-fixed structures, e.g. clutter, multipath returns, or several other effects. In the case of the mt. Macaion radar, most of the noise still present in the data product is due to moving objects sensed on the terrain surface (e.g. trees moving during high wind days). The objective is thus to build a mitigation technique aimed at reducing the impact of high value noise in localized pixels present in most dataset operating days, thus managing possible non-meteorological moving artefacts on the ground. In order to filter the noise in the frames, a <italic>global outlier mask</italic> can be generated based on a distance measurement between distributions of pixel values over time (Fig. <xref rid="Fig7" ref-type="fig">7</xref>). We construct this mask using the <italic>Mahalanobis distance</italic>, as in<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>. In details, first the distribution histogram of the pixel values over a random sample (20% of the sequences) is computed by binning the ratios of pixel value in a location <italic>i</italic> in <italic>N</italic> = 526 bins <italic>x</italic><sub><italic>i</italic></sub> (each bin corresponding to a step of 0.1 dBZ). Then, we extract the corresponding sample mean<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\mu }=\frac{1}{N}\mathop{\sum }\limits_{i=1}^{N}{x}_{i}$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41597_2020_574_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>and covariance matrix<disp-formula id="Equb"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{S}=\frac{1}{N-1}\mathop{\sum }\limits_{i=1}^{N}({x}_{i}-\mu )({x}_{i}-{\mu }^{T})$$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mover accent="true"><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41597_2020_574_Article_Equb.gif" position="anchor"/></alternatives></disp-formula>to evaluate the Mahalanobis distance of <italic>x</italic> as<disp-formula id="Equc"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${D}_{M}=\sqrt{{(x-\widehat{\mu })}^{T}{\widehat{S}}^{-1}(x-\widehat{\mu })}$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:math><graphic xlink:href="41597_2020_574_Article_Equc.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq1"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{S}}^{-1}$$\end{document}</tex-math><mml:math id="M8"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41597_2020_574_Article_IEq1.gif"/></alternatives></inline-formula> is derived by using the Moore-Penrose pseudoinverse. Pixels that have a Mahalanobis distance higher than the mean distance plus three times the standard deviation are marked as outliers. We finally obtain a binary mask with 179,333 inliers. Excluded pixels are 1,627 outliers and 49,440 points outside the radar operation range of 120 km (equivalent to a 240 pixel radius from the Mt. Macaion site). The TAASRAD19 outlier mask is mapped in Fig. <xref rid="Fig7" ref-type="fig">7</xref>. Notably, the binary mask can also be used to skip calculation on the masked pixels when computing the loss function in deep learning models. The TAASRAD19 outlier mask is also available as binary PNG file in the Zenodo repository<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>.</p>
    </sec>
  </sec>
  <sec id="Sec14">
    <title>Data Records</title>
    <p id="Par36">TAASRAD19 is available on Zenodo, split in four repositories to comply with data size limits. The full MAX(<italic>Z</italic>) raw data archive is organized in two different repositories, one for years 2010–2016<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> and another one for years 2017–2019<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>, while the sequences are available at<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> and<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>, respectively. The product archive is organized by acquisition time for an easier automatic processing, using a three-level structure represented in Fig. <xref rid="Fig8" ref-type="fig">8</xref>. The organization of the data retains the hierarchy originally provided by Meteotrentino: this decision is motivated by the aim to provide a fully reproducible end-to-end data generation pipeline that can be run starting from the original raw dataset. Frames recorded the same year are archived together in a single ZIP file; each day of the year is archived in a single TAR files containing radar scan compressed using the GZIP algorithm to reduce disk space. A CSV file with the daily weather summaries (i.e. daily_weather_report.csv) for all 9 years is also available, replicated in the two product repositories.</p>
    <p id="Par37">The data hierarchy has been designed to facilitate training machine learning models. The experimental setup of a classification/regression task usually requires an extensive number of repeated runs where data is supplied to the learning algorithms in small chunks, whose corresponding archived batches can be decompressed at runtime, thus optimizing the operational flow. In this scenario, the per-year organisation of the archives for the raw data is preferred over the unique monolithic alternative to allow users to set a preferred training strategy for training and testing over specific time intervals within data analysis plans, also considering appropriate cross-validation procedures. The configuration is indeed used in the analysis. For example, practitioners usually find it convenient to keep the elementary batch file compressed, thus we keep the basic blocks as zip files. One level up, an organization for yearly time steps allows accounting for seasonalities, also maintaining large flexibility. The data structure in our case, including four different repositories, 2 reps for the raw data and 2 reps for the sequences, each split in one rep for the years 2010–2016 and one for the years 2017–2019 enables an easy generation of training/validation/test partitions in Machine/Deep Learning settings.</p>
    <p id="Par38">The text files follow the GRASS ASCII Grid format (<ext-link ext-link-type="uri" xlink:href="https://gdal.org/drivers/raster/grassasciigrid.html">https://gdal.org/drivers/raster/grassasciigrid.html</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://grass.osgeo.org/grass78/manuals/r.in.ascii.html">https://grass.osgeo.org/grass78/manuals/r.in.ascii.html</ext-link>), which is a plain-text, human readable grid representation: each row in the file represents a row in the grid, where each cell value is a floating point number separated by a tabulation character. An optional nodata value (representing NULL value) can be specified: by convention, in TAASRAD19, the NULL data value is −99, and in our workflow it is converted to 0 upon parsing the files. The format can be parsed in any programming language without the need of specific software packages; geo-reference information is included in a header before the data rows. This structure allows a seamless data loading into Geographical Information Systems (GIS) software suites, e.g. QGIS<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>, GRASS<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>. It also facilitates the conversion of the product in different formats of choice by libraries such as GDAL<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>.</p>
    <p id="Par39">However, even if the compressed ASCII format is extremely easy to create and manipulate programmatically, it is very inefficient in terms of throughput, and processing power required for data ingestion. Moreover, metadata and other attributes cannot be incorporated using this data format.</p>
    <p id="Par40">For these reasons, the extracted sequences are made available in both HDF5<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> and NetCDF<sup><xref ref-type="bibr" rid="CR36">36</xref></sup> format, that are both widely used in meteorological applications<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>. Conversion between the two formats can be easily obtained by well established libraries such as <italic>xarray</italic>.</p>
    <p id="Par41">The HDF5 release<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> is mainly aimed at supporting a straight integration of the dataset into modeling pipelines, thanks to the large support of the format in many machine learning platforms, and in the majority of scientific environments. Notably, HDF5 is the format of choice for many Deep Learning (DL) frameworks, that offer native support (e.g. Keras, TensorFlow), or straightforward integration hooks (e.g. PyTorch, mxnet/Gluon) for HDF5 datasets. Sequence data in the HDF5 release is organized similarly to the image archive (see Fig. <xref rid="Fig9" ref-type="fig">9</xref>). Sequences from the same day are saved together in a single HDF5 file named after the date of the day. A file named all_data.hdf5 stores links to all the daily files, and can be used to iterate over all the sequences. The whole HDF5 archive is stored on Zenodo on a single ZIP file (i.e. hdf_archives.zip). The minimum hdf5 library version to read the files is 1.10.4. Two other files are available: a PNG image (mask.png) representing the pre-computed outlier mask, and a CSV file (hdf_metadata.csv) with relevant metadata about each sequence. Metadata include: id of the sequence, start and end time, sequence length, average pixel value, corresponding weak-labels extracted from the daily weather summaries (if any).</p>
    <p id="Par42">The NetCDF release<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> is aimed at maximum compatibility with existing meteorological and climatological tools for data analysis and exploration. The dataset mimics the same file structure of the HDF5 release (one file per day) and is further supplemented by extensive metadata (e.g. reference coordinates, data types, date/time reference, daily tags, sequences length). To ensure maximum compatibility, a flattened structure is used and NetCDF4 groups are avoided. Sequence lengths and date-time attributes are both reported in metadata, and can be used to determine the start and end frame of each sequence. The produced format follows the Climate and Forecast (CF) Metadata conventions and has been validated for the use with compatible tools using the CF-Checker suite (<ext-link ext-link-type="uri" xlink:href="https://github.com/cedadev/cf-checker">https://github.com/cedadev/cf-checker</ext-link>) against the CF-Convention 1.7 standard.</p>
  </sec>
  <sec id="Sec15">
    <title>Technical Validation</title>
    <p id="Par43">We outline here two examples of deep learning and analytical applications in meteorology and precipitation forecasting based on TAASRAD19.</p>
    <sec id="Sec16">
      <title>Deep learning for precipitation nowcasting</title>
      <p id="Par44">Analog ensemble models<sup><xref ref-type="bibr" rid="CR26">26</xref>,<xref ref-type="bibr" rid="CR38">38</xref>,<xref ref-type="bibr" rid="CR39">39</xref></sup> or extrapolation methods<sup><xref ref-type="bibr" rid="CR12">12</xref></sup> are mainly used for probabilistic forecasting; however convolutional recurrent neural networks are now the state of the art for deterministic nowcasting<sup><xref ref-type="bibr" rid="CR31">31</xref>,<xref ref-type="bibr" rid="CR40">40</xref>–<xref ref-type="bibr" rid="CR43">43</xref></sup>. In<sup><xref ref-type="bibr" rid="CR22">22</xref></sup> we used TAASRAD19 to train a deep learning model that forecasts reflectivity up to 100 min ahead (i.e. 20 frames) at full spatial spatial resolution of the radar (0.5 × 0.5 km), based on 25 min (i.e. 5 frames) of input data. The model is an evolution of<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>, based on the TrajGRU architecture, described in<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>. A Python implementation using the Apache MXNet<sup><xref ref-type="bibr" rid="CR44">44</xref></sup> deep learning framework is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/MPBA/TAASRAD19">https://github.com/MPBA/TAASRAD19</ext-link> (for the original version see <ext-link ext-link-type="uri" xlink:href="https://github.com/sxjscience/HKO-7">https://github.com/sxjscience/HKO-7</ext-link>).</p>
      <p id="Par45">In our experimental setup, TAASRAD19 sequences extracted from June 2010 to December 2016 are used for training, whilst the model is tested in inference on sequences from 2017 to 2019. Training and validation sequences are extracted with a moving-window strategy applied along the entire set of contiguous sequences included in TAASRAD19. The generated sub-sequences are 25 frames long, where the first 5 frames are used as input, and the remaining 20 ones are used as ground truth for validation. In summary, 220,054 and 122,548 sub-sequences have been generated for <italic>training</italic> and <italic>validation</italic>, respectively.</p>
      <p id="Par46">To allow a fair comparison with results reported in<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> on the Hong Kong (HKO-7) dataset, we implement the same model hyper-parameters: the model is trained for 100,000 iterations considering a batch size of 4, using two NVIDIA GTX1080 GPUs in parallel, with 8 GB of memory each. Network weights for our trained model are available on GitHub. We evaluate results using the Critical Success Index (CSI) score, a metric commonly used in computational meteorology, as defined in<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>: output predictions and ground truth frames are first converted to rain rate using the Marshall-Palmer Z-R relationship<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, then binarized at different thresholds to test model performance over different rain regimes. Results on the validation data set are reported in Table <xref rid="Tab4" ref-type="table">4</xref>. Scores for both models are satisfactory for potential application as a score of CSI &gt; 0.45 (for <italic>r</italic> ≥ 0.5) means that the model is reliable for predicting precipitation occurrence. Results reported for the HKO-7 dataset are consistently better; disregarding the use of the MAX(<italic>Z</italic>) product instead of CAPPI as inputs, differences are expected due to the higher variability of Alpine landscape and the different spatial resolutions (0.5 km for TAASRAD19 vs. 1.07 km for HKO-7).<table-wrap id="Tab4"><label>Table 4</label><caption><p>Critical Success Index (CSI) scores for TrajGRU on TAASRAD19 and in Shi <italic>et al</italic>.<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>, on HKO-7 dataset; <italic>r</italic> is the instantaneous rain rate (mm/h).</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Model and Dataset</th><th><italic>r</italic> ≥ 0.5</th><th><italic>r</italic> ≥ 2</th><th><italic>r</italic> ≥ 5</th><th><italic>r</italic> ≥ 10</th><th><italic>r</italic> ≥ 30</th></tr></thead><tbody><tr><td>TrajGRU on HKO-7<sup><xref ref-type="bibr" rid="CR31">31</xref></sup></td><td>0.553</td><td>0.476</td><td>0.375</td><td>0.284</td><td>0.186</td></tr><tr><td>TrajGRU on TAASRAD19</td><td>0.487</td><td>0.283</td><td>0.190</td><td>0.144</td><td>0.078</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec17">
      <title>Analog exploration by UMAP embedding</title>
      <p id="Par47">The search for analogs, i.e. similar weather patterns in the past, is a key approach in meteorology. It usually requires to perform a fast and accurate query for similar spatio-temporal precipitation patterns in very large archive of historical records.</p>
      <p id="Par48">In<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>, we introduced a framework for fast approximate analog search retrieval of radar sequences that employs a two-step process dimensionality reduction and fast similarity search to improve accuracy and computational performance. The framework combines Mueen’s Algorithm for Similarity Search<sup><xref ref-type="bibr" rid="CR25">25</xref></sup> (MASS) with the Uniform Manifold Approximation and Projection (UMAP) algorithm<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>. UMAP resulted more effective as a dimensionality reduction technique for radar images, in combination with MASS, than the standard Principal Component Analysis (PCA)<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>.</p>
      <p id="Par49">Here we leverage UMAP dimensionality reduction features for the interactive visualization of radar images from the TAASRAD19 dataset. To realize a real-time interaction on a massive sample of images, we first pre-processed all HDF5 sequences by resizing the images from 480 × 480 to 64 × 64 pixel using bi-linear interpolation. Normalization between 0 and 1 is obtained by dividing each pixel value by 52.5, i.e. the maximum reflectivity value supported by the radar (see Table <xref rid="Tab2" ref-type="table">2</xref>). The first 200,000 images (out of 362,233) are used as training data for a UMAP model with the following hyper-parameters: neighbors = 200; components (dimensions) = 5; min-distance = 0.1; metric = <italic>euclidean</italic>. The UMAP algorithm outputs a dimensionality reduction map (from 64 × 64 = 4,096 to 5), which distributes images in the reduced space by preserving the reference distance metric as in the original space (Euclidean, in this case). Given that Euclidean distance is rank preserving with regard to mean squared error, similar precipitation patterns result closer in the reduced space. In Fig. <xref rid="Fig10" ref-type="fig">10</xref> we show an example of UMAP planar embedding of the remaining 162,233 frames (TAASRAD19_u162k), where each point is coloured by Wet Area Ratio (WAR), defined as the percentage of pixels in the frame with a rain rate higher than 0.1 mm/h. Examples of different precipitation patterns in TAASRAD19_u162k are shown as insets within the figure. From left to right (UMAP component 1), locations in the projected space correspond to patterns of increasing WAR.</p>
      <p id="Par50">The approach has been engineered as UMAP Radar Sequence Visualizer, a tool for interactive exploration of sequence analogues in radar archives. Sets of radar sequences can be imported for visualization in an interactive web canvas built as React/NodeJS application, derived from the UMAP Explorer tool (<ext-link ext-link-type="uri" xlink:href="https://grantcuster.github.io/umap-explorer/">https://grantcuster.github.io/umap-explorer/</ext-link>).</p>
      <p id="Par51">Each radar frame is placed as a mini image on the explorable canvas based on its coordinates in the UMAP projection. The canvas can be panned and zoomed, and each image is colored by WAR using a yellow-to-blue gradient. When an image is selected, the lower panel shows the next images in the sequence, highlighting the evolution of the precipitation pattern. Projections over different UMAP axis pairs can be selected. The source code of the tool, along with scripts and examples on how to export data for visualization, are available in the GitHub repository.</p>
      <p id="Par52">An online demo of the UMAP Radar Sequence Visualizer is also available (reachable from the TAASRAD19 GitHub repository). The online dashboard is currently equipped with TAASRAD19_u50k, a sample of moderate size (50,000 images for 18 months of observations) to allow browsing with limited RAM resources (Fig. <xref rid="Fig11" ref-type="fig">11</xref>). In the online tool, frames with precipitation concentrated in the Northern part of the region are also located on the upper area of the plot, while those with rain in the South lie on the lower part of the plot. Blue images on the rightmost sector of the plot represent extreme events, while scattered points on the left of the main cloud correspond to less severe precipitation patterns.</p>
    </sec>
  </sec>
  <sec id="Sec18">
    <title>Usage Notes</title>
    <p id="Par53">When using the frames or the sequences in machine learning workflows, we suggest to set no-data cells (value −99.0) to 0 and normalize the data in <inline-formula id="IEq2"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[0,1]$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41597_2020_574_Article_IEq2.gif"/></alternatives></inline-formula> interval by dividing by 52.5 before feeding the batch of data to the model; whilst for computer vision applications it can be useful to transform the frames to grayscale images by applying a lossy conversion to 8-bit integers (values from 0 to 255).</p>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>These authors contributed equally: Gabriele Franch, Valerio Maggio.</p>
    </fn>
    <fn>
      <p>These authors jointly supervised this work: Giuseppe Jurman, Cesare Furlanello.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Meteotentino and Meteobolzano, the Civil Protection Agencies of the two Autonomous Provinces of Trento and Bolzano for their help and their daily commitment in the maintenance of all weather data collection systems. We also thank two anonymous reviewers for their positive comments and careful review, which helped improving the manuscript. Computing resources were partially funded by a Microsoft Azure Grant AI for Earth (2018–19), assigned to C.F. PhD grant funded by TIM S.p.A., assigned to G.F.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>G.F. designed data sets, processed data, wrote the paper, wrote the code. V.M. wrote the paper, wrote the code. L.C. processed data, made plots and wrote the code. G.J. wrote the paper. M.P. provided the datasets. C.F. provided funding, contributed to experiment design, wrote the paper.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>All the software described in Technical Validation is available in a public GitHub repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/MPBA/TAASRAD19">https://github.com/MPBA/TAASRAD19</ext-link>), along with the Python scripts for sequence pre-processing, installation scripts for the MXNet<sup><xref ref-type="bibr" rid="CR44">44</xref></sup> framework, pre-trained network model weights, and examples of radar prediction output sequences. All the code was written in Python 3.6 and tested on Ubuntu releases 16.04/18.04. Some pre-processing steps (e.g. sequence and outlier mask generation) require a non trivial amount of computing resources and memory. Training the deep learning model with the same parameters described in the paper requires either two GPUs with 8GB of RAM or one GPU with 16GB. Please refer to the README files in the code release for further instructions.</p>
  </notes>
  <notes id="FPar1" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par54">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kothavala</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Extreme precipitation events and the applicability of global climate models to the study of floods and droughts</article-title>
        <source>Math. Comput. Simulat.</source>
        <year>1997</year>
        <volume>43</volume>
        <fpage>261</fpage>
        <lpage>268</lpage>
        <pub-id pub-id-type="doi">10.1016/S0378-4754(97)00008-6</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meehl</surname>
            <given-names>GA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Trends in extreme weather and climate events: issues related to modeling extremes in projections of future climate change</article-title>
        <source>Bull. Am. Meteorol. Soc.</source>
        <year>2000</year>
        <volume>81</volume>
        <fpage>427</fpage>
        <lpage>436</lpage>
        <pub-id pub-id-type="doi">10.1175/1520-0477(2000)081&lt;0427:TIEWAC&gt;2.3.CO;2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gobiet</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>21st century climate change in the European Alps: A review</article-title>
        <source>Sci. Total Environ.</source>
        <year>2014</year>
        <volume>493</volume>
        <fpage>1138</fpage>
        <lpage>1151</lpage>
        <pub-id pub-id-type="doi">10.1016/j.scitotenv.2013.07.050</pub-id>
        <pub-id pub-id-type="pmid">23953405</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durman</surname>
            <given-names>CF</given-names>
          </name>
          <name>
            <surname>Gregory</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Hassell</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>RG</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>A comparison of extreme European daily precipitation simulated by a global and a regional climate model for present and future climates</article-title>
        <source>Q. J. R. Meteorol. Soc.</source>
        <year>2001</year>
        <volume>127</volume>
        <fpage>1005</fpage>
        <lpage>1015</lpage>
        <pub-id pub-id-type="doi">10.1002/qj.49712757316</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lehtonenl</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Ruosteenoja</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Jylhä</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Projected changes in European extreme precipitation indices on the basis of global and regional climate model ensembles</article-title>
        <source>Int. J. Climatol.</source>
        <year>2014</year>
        <volume>34</volume>
        <fpage>1208</fpage>
        <lpage>1222</lpage>
        <pub-id pub-id-type="doi">10.1002/joc.3758</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilson</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Crook</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Mueller</surname>
            <given-names>CK</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dixon</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Nowcasting thunderstorms: A status report</article-title>
        <source>Bull. Am. Meteorol. Soc.</source>
        <year>1998</year>
        <volume>79</volume>
        <fpage>2079</fpage>
        <lpage>2100</lpage>
        <pub-id pub-id-type="doi">10.1175/1520-0477(1998)079&lt;2079:NTASR&gt;2.0.CO;2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Norbiato</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Borga</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sangati</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zanon</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Regional frequency analysis of extreme precipitation in the eastern Italian Alps and the August 29, 2003 flash flood</article-title>
        <source>J. Hydrol.</source>
        <year>2007</year>
        <volume>345</volume>
        <fpage>149</fpage>
        <lpage>166</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jhydrol.2007.07.009</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marshall</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Palmer</surname>
            <given-names>WMK</given-names>
          </name>
        </person-group>
        <article-title>The distribution of raindrops with size</article-title>
        <source>J. Meteorol.</source>
        <year>1948</year>
        <volume>5</volume>
        <fpage>165</fpage>
        <lpage>166</lpage>
        <pub-id pub-id-type="doi">10.1175/1520-0469(1948)005&lt;0165:TDORWS&gt;2.0.CO;2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heistermann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jacobi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pfaff</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Technical Note: An open source library for processing weather radar data (wradlib)</article-title>
        <source>Hydrol. Earth Syst. Sci.</source>
        <year>2013</year>
        <volume>17</volume>
        <fpage>863</fpage>
        <lpage>871</lpage>
        <pub-id pub-id-type="doi">10.5194/hess-17-863-2013</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heistermann</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The emergence of open-source software for the weather radar community</article-title>
        <source>Bull. Amer. Meteor. Soc.</source>
        <year>2015</year>
        <volume>96</volume>
        <fpage>117</fpage>
        <lpage>128</lpage>
        <pub-id pub-id-type="doi">10.1175/BAMS-D-13-00240.1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Helmus, J. J. &amp; Collis, S. M. The Python ARM Radar Toolkit (Py-ART), a library for working with weather radar data in the Python programming language. <italic>J</italic>. <italic>Open Source Softw</italic>. <bold>4</bold> (2016).</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pulkkinen</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pysteps: an open-source Python library for probabilistic precipitation nowcasting (v1.0)</article-title>
        <source>Geosci. Model Dev.</source>
        <year>2019</year>
        <volume>12</volume>
        <fpage>4185</fpage>
        <lpage>4219</lpage>
        <pub-id pub-id-type="doi">10.5194/gmd-12-4185-2019</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ayzel</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Heistermann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Winterrath</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Optical flow models as an open benchmark for radar-based precipitation nowcasting (rainymotion v0. 1)</article-title>
        <source>Geosci. Model Dev.</source>
        <year>2019</year>
        <volume>12</volume>
        <fpage>1387</fpage>
        <lpage>1402</lpage>
        <pub-id pub-id-type="doi">10.5194/gmd-12-1387-2019</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kreklow</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Facilitating radar precipitation data processing, assessment and analysis: a GIS-compatible Python approach</article-title>
        <source>J. Hydroinf.</source>
        <year>2019</year>
        <volume>21</volume>
        <fpage>652</fpage>
        <lpage>670</lpage>
        <pub-id pub-id-type="doi">10.2166/hydro.2019.048</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ramsauer</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Weiss</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Marzahn</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Comparison of the GPM IMERG final precipitation product to RADOLAN weather radar data over the topographically and climatically diverse Germany</article-title>
        <source>Remote Sens.</source>
        <year>2018</year>
        <volume>10</volume>
        <fpage>2029</fpage>
        <pub-id pub-id-type="doi">10.3390/rs10122029</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ansari</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Unlocking the potential of NEXRAD data through NOAA’s Big Data Partnership</article-title>
        <source>Bull. Amer. Meteor. Soc.</source>
        <year>2018</year>
        <volume>99</volume>
        <fpage>189</fpage>
        <lpage>204</lpage>
        <pub-id pub-id-type="doi">10.1175/BAMS-D-16-0021.1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Holleman</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Bias adjustment and long-term verification of radar-based precipitation estimates</article-title>
        <source>Meteorol. Appl.</source>
        <year>2007</year>
        <volume>14</volume>
        <fpage>195</fpage>
        <lpage>203</lpage>
        <pub-id pub-id-type="doi">10.1002/met.22</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="data">
        <name>
          <surname>Franch</surname>
          <given-names>G</given-names>
        </name>
        <etal/>
        <year>2019</year>
        <data-title>TAASRAD19 Radar Scans 2010–2016</data-title>
        <source>Zenodo</source>
        <pub-id pub-id-type="doi">10.5281/zenodo.3577451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="data">
        <name>
          <surname>Franch</surname>
          <given-names>G</given-names>
        </name>
        <etal/>
        <year>2019</year>
        <data-title>TAASRAD19 Radar Scans 2017–2019</data-title>
        <source>Zenodo</source>
        <pub-id pub-id-type="doi">10.5281/zenodo.3591396</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="data">
        <name>
          <surname>Franch</surname>
          <given-names>G</given-names>
        </name>
        <etal/>
        <year>2020</year>
        <data-title>TAASRAD19 Radar Sequences 2010–2019 HDF5</data-title>
        <source>Zenodo</source>
        <pub-id pub-id-type="doi">10.5281/zenodo.3865889</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="data">
        <name>
          <surname>Franch</surname>
          <given-names>G</given-names>
        </name>
        <etal/>
        <year>2020</year>
        <data-title>TAASRAD19 Radar Sequences 2010–2019 NetCDF</data-title>
        <source>Zenodo</source>
        <pub-id pub-id-type="doi">10.5281/zenodo.3866204</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Franch</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Precipitation nowcasting with orographic enhanced stacked generalization: Improving deep learning predictions on extreme events</article-title>
        <source>Atmosphere</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>267</fpage>
        <pub-id pub-id-type="doi">10.3390/atmos11030267</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">McInnes, L., Healy, J. &amp; Melville, J. UMAP: Uniform Manifold Approximation and Projection for dimension reduction. Preprint at <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1802.03426">https://arxiv.org/abs/1802.03426</ext-link> (2018).</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">McConville, R., Santos-Rodríguez, R., Piechocki, R. J. &amp; Craddock, I. N2D: (Not Too) Deep Clustering via Clustering the Local Manifold of an Autoencoded Embedding. Preprint at <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1908.05968">https://arxiv.org/abs/1908.05968</ext-link> (2019).</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">Mueen, A. <italic>et al</italic>. The fastest similarity search algorithm for time series subsequences under Euclidean distance, <ext-link ext-link-type="uri" xlink:href="http://www.cs.unm.edu/mueen/FastestSimilaritySearch.html">http://www.cs.unm.edu/mueen/FastestSimilaritySearch.html</ext-link> (2017).</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Franch</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Jurman</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Coviello</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pendesini</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Furlanello</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>MASS-UMAP: Fast and accurate analog ensemble search in weather radar archives</article-title>
        <source>Remote Sens.</source>
        <year>2019</year>
        <volume>11</volume>
        <fpage>2922</fpage>
        <pub-id pub-id-type="doi">10.3390/rs11242922</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Bringi, V. N. &amp; Chandrasekar, V. In <italic>Polarimetric Doppler Weather Radar: Principles and Applications</italic> Ch. 5 (Cambridge University Press, 2001).</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saltikoff</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>OPERA the radar project</article-title>
        <source>Atmosphere</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>320</fpage>
        <pub-id pub-id-type="doi">10.3390/atmos10060320</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zawadzki</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Morneau</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Laprise</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Predictability of precipitation patterns: An operational approach</article-title>
        <source>J. Appl. Meteorol.</source>
        <year>1994</year>
        <volume>33</volume>
        <fpage>1562</fpage>
        <lpage>1571</lpage>
        <pub-id pub-id-type="doi">10.1175/1520-0450(1994)033&lt;1562:POPPAO&gt;2.0.CO;2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>ZH</given-names>
          </name>
        </person-group>
        <article-title>A brief introduction to weakly supervised learning</article-title>
        <source>Natl. Sci. Rev.</source>
        <year>2017</year>
        <volume>5</volume>
        <fpage>44</fpage>
        <lpage>53</lpage>
        <pub-id pub-id-type="doi">10.1093/nsr/nwx106</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shi</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deep learning for precipitation nowcasting: A benchmark and a new model</article-title>
        <source>Adv. Neural Inf. Process. Syst.</source>
        <year>2017</year>
        <volume>30</volume>
        <fpage>5617</fpage>
        <lpage>5627</lpage>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">QGIS Development Team. QGIS Geographic Information System, version 3.12.3. <italic>Open Source Geospatial Foundation Project</italic>, <ext-link ext-link-type="uri" xlink:href="https://qgis.org/en/site/">https://qgis.org/en/site/</ext-link> (2020).</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">Neteler, M. &amp; Mitasova, H. Open source GIS: a GRASS GIS approach. <italic>Springer Science &amp; Business Media</italic><bold>689</bold> (2013).</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Warmerdam, F. The geospatial data abstraction library. In <italic>Open Source Approaches in Spatial Data Handling</italic>, 87-104 (Springer, 2008).</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <mixed-citation publication-type="other">The HDF Group. Hierarchical data format version 5, <ext-link ext-link-type="uri" xlink:href="https://www.hdfgroup.org/solutions/hdf5/">https://www.hdfgroup.org/solutions/hdf5/</ext-link> (2016).</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rew</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>NetCDF: an interface for scientific data access</article-title>
        <source>IEEE Comput. Graph. Appl.</source>
        <year>1990</year>
        <volume>10</volume>
        <fpage>76</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1109/38.56302</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Michelson, D. B., Lewandowski, R., Szewczykowski, M., Beekhuis, H. &amp; Haase, G. EUMETNET OPERA weather radar information model for implementation with the HDF5 file format. <italic>OPERA deliverable OPERA_2008_03</italic> (2011).</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Delle Monache</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Eckel</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Rife</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Nagarajan</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Searight</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Probabilistic weather prediction with an analog ensemble</article-title>
        <source>Mon. Weather Rev.</source>
        <year>2013</year>
        <volume>141</volume>
        <fpage>3498</fpage>
        <lpage>3516</lpage>
        <pub-id pub-id-type="doi">10.1175/MWR-D-12-00281.1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Foresti</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Panziera</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mandapaka</surname>
            <given-names>PV</given-names>
          </name>
          <name>
            <surname>Germann</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Seed</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Retrieval of analogue radar images for ensemble nowcasting of orographic rainfall</article-title>
        <source>Meteorol. Appl.</source>
        <year>2015</year>
        <volume>22</volume>
        <fpage>141</fpage>
        <lpage>155</lpage>
        <pub-id pub-id-type="doi">10.1002/met.1416</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shi</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Convolutional LSTM network: A machine learning approach for precipitation nowcasting</article-title>
        <source>Adv. Neural Inf. Process. Syst.</source>
        <year>2015</year>
        <volume>28</volume>
        <fpage>802</fpage>
        <lpage>810</lpage>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="data">
        <name>
          <surname>Franch</surname>
          <given-names>G</given-names>
        </name>
        <etal/>
        <year>2019</year>
        <data-title>Deep learning for rain and lightning nowcasting</data-title>
        <source>Zenodo</source>
        <pub-id pub-id-type="doi">10.5281/zenodo.3594325</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Long</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>PS</given-names>
          </name>
        </person-group>
        <article-title>PredRNN: Recurrent neural networks for predictive learning using spatiotemporal LSTMs</article-title>
        <source>Adv. Neural Inf. Process. Syst.</source>
        <year>2017</year>
        <volume>30</volume>
        <fpage>879</fpage>
        <lpage>888</lpage>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Long</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>PS</given-names>
          </name>
        </person-group>
        <article-title>PredRNN++: Towards a resolution of the deep-in-time dilemma in spatiotemporal predictive learning</article-title>
        <source>Proc. 35th International Conference on Machine Learning</source>
        <year>2018</year>
        <volume>80</volume>
        <fpage>5123</fpage>
        <lpage>5132</lpage>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Chen, T. <italic>et al</italic>. Mxnet: A flexible and efficient machine learning library for heterogeneous distributed systems. <italic>Neural Information Processing Systems, Workshop on Machine Learning Systems</italic> (2015).</mixed-citation>
    </ref>
  </ref-list>
</back>
