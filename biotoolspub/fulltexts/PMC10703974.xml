<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Comput Aided Mol Des</journal-id>
    <journal-id journal-id-type="iso-abbrev">J Comput Aided Mol Des</journal-id>
    <journal-title-group>
      <journal-title>Journal of Computer-Aided Molecular Design</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0920-654X</issn>
    <issn pub-type="epub">1573-4951</issn>
    <publisher>
      <publisher-name>Springer International Publishing</publisher-name>
      <publisher-loc>Cham</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10703974</article-id>
    <article-id pub-id-type="pmid">38062207</article-id>
    <article-id pub-id-type="publisher-id">544</article-id>
    <article-id pub-id-type="doi">10.1007/s10822-023-00544-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Open-ComBind: harnessing unlabeled data for improved binding pose prediction</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>McNutt</surname>
          <given-names>Andrew T.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Koes</surname>
          <given-names>David Ryan</given-names>
        </name>
        <address>
          <email>dkoes@pitt.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/01an3r305</institution-id><institution-id institution-id-type="GRID">grid.21925.3d</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 9000</institution-id><institution>Department of Computational and Systems Biology, </institution><institution>University of Pittsburgh, </institution></institution-wrap>Pittsburgh, PA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <year>2024</year>
    </pub-date>
    <volume>38</volume>
    <issue>1</issue>
    <elocation-id>3</elocation-id>
    <history>
      <date date-type="received">
        <day>6</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>11</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Determination of the bound pose of a ligand is a critical first step in many in silico drug discovery tasks. Molecular docking is the main tool for the prediction of non-covalent binding of a protein and ligand system. Molecular docking pipelines often only utilize the information of one ligand binding to the protein despite the commonly held hypothesis that different ligands share binding interactions when bound to the same receptor. Here we describe Open-ComBind, an easy-to-use, open-source version of the ComBind molecular docking pipeline that leverages information from multiple ligands without known bound structures to enhance pose selection. We first create distributions of feature similarities between ligand pose pairs, comparing near-native poses with all sampled docked poses. These distributions capture the likelihood of observing similar features, such as hydrogen bonds or hydrophobic contacts, in different pose configurations. These similarity distributions are then combined with a per-ligand docking score to enhance overall pose selection by 5% and 4.5% for high-affinity and congeneric series helper ligands, respectively. Open-ComBind reduces the average RMSD of ligands in our benchmark dataset by 9.0%. We provide Open-ComBind as an easy-to-use command line and Python API to increase pose prediction performance at <ext-link ext-link-type="uri" xlink:href="http://www.github.com/drewnutt/open_combind">www.github.com/drewnutt/open_combind</ext-link>.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1007/s10822-023-00544-y.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Molecular docking</kwd>
      <kwd>Machine learning</kwd>
      <kwd>Structure-based drug design</kwd>
      <kwd>Open-source</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id>
            <institution>National Institute of General Medical Sciences</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R35GM140753</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>CHE-2102474</award-id>
        <award-id>CHE-2102474</award-id>
        <principal-award-recipient>
          <name>
            <surname>McNutt</surname>
            <given-names>Andrew T.</given-names>
          </name>
          <name>
            <surname>Koes</surname>
            <given-names>David Ryan</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature Switzerland AG 2024</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par2">Drug discovery is a complex, multifaceted process involving the identification of small molecules capable of interacting with specific biological targets to produce a therapeutic effect. Computer-aided drug design (CADD) tools allow for the reduction of the enormous complexity and cost of the traditional drug discovery pipeline [<xref ref-type="bibr" rid="CR1">1</xref>]. CADD can be broadly divided into two main techniques: structure-based and ligand-based. Structure-based drug design (SBDD) uses the knowledge of the three-dimensional structure of a target protein to guide the selection of molecules that can bind with high affinity and selectivity [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>].</p>
    <p id="Par3">Molecular docking is a vital tool in the SBDD toolbox that predicts the non-covalent binding of two molecules in three-dimensional space. Knowledge of the ligand binding pose is critical for many downstream drug discovery tasks, such as lead optimization, affinity prediction, and virtual screening. Typical molecular docking algorithms either utilize energetics of interactions or the statistics of known binding interactions to predict the relative placement of the molecules [<xref ref-type="bibr" rid="CR4">4</xref>]. Conventional docking algorithms, such as Autodock Vina [<xref ref-type="bibr" rid="CR5">5</xref>] or Glide [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>], and even deep learning-based docking algorithms, like <sc>gnina</sc> [<xref ref-type="bibr" rid="CR8">8</xref>]or DiffDock [<xref ref-type="bibr" rid="CR9">9</xref>], predict the binding of every ligand separately even when multiple ligands are docked to the same receptor structure. Many drug targets are unsuitable for molecular docking due to a lack of suitable crystal structures (i.e. large ligand volume difference with cognate ligand or no available <italic>holo</italic> crystal structures). In these cases, alternative approaches must be employed.</p>
    <p id="Par4">One such approach is ligand-based drug design (LBDD), which relies on the analysis of known active compounds rather than the target protein itself. LBDD typically involves comparing the chemical features of known actives to those of putative inactives in order to identify pharmacophores - sets of chemical properties necessary for activity against a target [<xref ref-type="bibr" rid="CR10">10</xref>]. These pharmacophores can be one, two, or three-dimensional, providing an understanding of active molecule properties or shape [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. The generated pharmacophores are used to screen large libraries of compounds to find drug-like molecules with similar properties. LBDD allows for fast screening of incredibly large molecule libraries. Still, its reliance on empirical observations means it can struggle to capture subtle differences between closely related analogs. The results may not always generalize to a new series of compounds.</p>
    <p id="Par5">There have been several recent works that integrate LBDD with molecular docking to improve predictive performance. [<xref ref-type="bibr" rid="CR13">13</xref>] and [<xref ref-type="bibr" rid="CR14">14</xref>] utilize LBDD techniques to determine protein conformations that will increase docking performance with a given drug molecule. [<xref ref-type="bibr" rid="CR15">15</xref>] use protein-ligand interaction fingerprints to increase the scoring power of standard molecular docking scoring functions. [<xref ref-type="bibr" rid="CR16">16</xref>] and [<xref ref-type="bibr" rid="CR17">17</xref>] harness knowledge of known bound poses to guide the molecular docking of novel ligands binding to the same receptor. These methods are able to reduce the sampling space of the ligands during docking by using known bound ligand poses as a bias to their sampling procedure. [<xref ref-type="bibr" rid="CR18">18</xref>] integrated structure-based docking from Glide, a commercial docking software, [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>] and 3D ligand similarities to increase pose prediction performance with their docking pipeline ComBind. Their work allows the use of abundant information on known active molecules that have no known bound structure to improve pose selection. Using Glide to dock a diverse protein-ligand benchmark set, they derive two distributions describing the pairwise pose similarity of poses near the ground truth and the pairwise pose similarity of all docked poses with respect to features such as hydrogen bonds or hydrophobic contacts. During the pose selection procedure, the feature distributions are converted to energy-like terms using the log ratio of the near-native similarity distribution to the all-pose similarity distribution. These likelihood terms are used in combination with Glide’s pose score to select a pose for a query ligand as well as for a set of ligands known to bind to the same receptor that do not require resolved structures. Their pipeline showed increased pose selection performance over only using Glide’s pose score, however, their pipeline utilized closed-source, licensed tools for pose generation and featurization, limiting its adoption by the molecular modeling community.</p>
    <p id="Par6">Here we present an easy-to-use, open-source alternative to ComBind that we call Open-ComBind. The open-source, deep learning-based molecular docking software <sc>gnina</sc> is used to generate high quality ligand poses, and open-source tools like ProDy [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>] and RDKit are used to featurize the docked compounds. Using a likelihood framework identical to ComBind, we utilize a set of helper ligands without known structural information to improve the pose quality of our docked ligand. The pose selection procedure strikes a balance between the individual pose scores assigned by the per-ligand deep learning scoring functions and the similarities and differences between the poses of various ligands. As a result, Open-ComBind produces a set of optimized poses for all ligands simultaneously, without requiring a shared ligand scaffold or knowledge of any ligand’s binding pose.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <p id="Par7">Here, we detail the dataset used in the creation of the docking pipeline as well as the dataset employed for evaluation of our pipeline. We describe the creation of inter-pose similarity statistics by performing cross-docking on a diverse protein-ligand benchmark dataset. The Open-ComBind docking pipeline is described, harnessing the similarity statistics to performing pose selection on a ligand of interest, the ‘docking ligand’, using a set of ligands with unknown bound structures, the ‘helper ligands’. Finally, an experiment to determine the validity of Open-ComBind’s underlying hypothesis: ‘distinct ligands bind to a receptor in similar ways’.</p>
    <sec id="Sec3">
      <title>Data</title>
      <sec id="Sec4">
        <title>Similarity dataset</title>
        <p id="Par8">Following [<xref ref-type="bibr" rid="CR18">18</xref>], a list of 30 target proteins (Table S1) representative of all major families of drug targets is used to generate the pairwise pose feature similarity distributions. The entire benchmark dataset of 421 protein-ligand pairs is used to generate the similarity statistics.</p>
      </sec>
      <sec id="Sec5">
        <title>Benchmark dataset</title>
        <p id="Par9">Generating the dataset used for evaluating pose prediction pipelines necessitates removal of easy-to-dock ligands. Following [<xref ref-type="bibr" rid="CR18">18</xref>], we filter the Similarity Dataset to remove any ligand that has greater than 50% of its atoms in the maximum common substructure computed with the cognate ligand of the receptor structure used for docking. If a new ligand shares most of the same structure as the cognate ligand then its probable the pocket has an appropriate configuration to bind the similar ligand. This reduces the set to 245 protein-ligand complexes for determining the performance of a pose prediction pipeline. These ligands are used as the ‘docking ligand’ during the evaluation of the pipeline.</p>
      </sec>
      <sec id="Sec6">
        <title>Helper ligands</title>
        <p id="Par10">Helper ligands are a set of ligands known to bind to the receptor of interest with <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;1\mu M$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn><mml:mi>μ</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq1.gif"/></alternatives></inline-formula> affinity, but may not have a solved bound structure. These ligands are used along with the ‘docking ligand’ in the Open-ComBind pipeline to improve pose selection of both the ‘docking ligand’ and the ‘helper ligands.’</p>
        <p id="Par11">We utilize the same two sets of helper ligands as in [<xref ref-type="bibr" rid="CR18">18</xref>]: one in which the helper ligands do not share a scaffold with the docking ligand, termed ‘High-affinity helper ligands’, and the other in which the ligands have the largest Maximum Common Substructure (MCSS) with the docking ligand, termed ‘Congeneric series helper ligands’. We use the MCSS definition from [<xref ref-type="bibr" rid="CR18">18</xref>] to ensure we are using the same set of helper ligands.</p>
      </sec>
    </sec>
    <sec id="Sec7">
      <title>Derivation of similarity distributions</title>
      <p id="Par12">Here we detail the development of pairwise similarity distributions for near-native poses and all docked poses using the Similarity Dataset.</p>
      <sec id="Sec8">
        <title>Protein and ligand pre-processing</title>
        <p id="Par13">Protein and ligand pre-processing separates the protein and ligand into separate docking-ready structures. Initially, a set of co-crystallized protein-ligand structures for each receptor in the Similarity Dataset is downloaded from RCSB.org [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>]. The ligand of interest in each co-crystallized structure is then designated based on its residue name. Using ProDy [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>], separate files are generated for the protein, ligand, waters, and other heteroatoms that are present in the original crystal structure. The instance coordinates of the ligand structure are downloaded directly from RCSB.org [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>] using their File Download Service to ensure proper coordinate and bond information. Using only the protein and ligand complex, we align all structures of a receptor based on the residues closest to the binding pocket. Protein residues within 15 Å of the ligand are used to align each receptor structure with PyMol [<xref ref-type="bibr" rid="CR23">23</xref>] to the alphabetically lowest PDB ID (PDB IDs specified in Table S1). The co-crystallized ligand’s coordinates are transformed according to the receptor alignment object. The aligned ligand and receptor are then separated into their own files to provide a ground-truth ligand and a <italic>holo</italic> structure for cross-docking with non-cognate ligands. After removal of the ligand, missing residues, atoms, and hydrogens are added (at a pH of 7.0) to the receptor structures using PDBFixer and minimized, ensuring interactions are detected properly after docking. Missing atoms and hydrogens are minimized using the default OpenMM forcefield. Finally, a <sc>gnina</sc> docking command template is created for each protein. The <sc>gnina</sc> docking command template specifies the docking protein structure (i.e. the aligned-to receptor structure) as well as the binding box location, defined by the cognate ligand of the docking receptor.</p>
        <p id="Par14">Docking with <sc>gnina</sc> requires knowledge of the 3D structure of the ligands to be docked. Conformations are generated for ligands using Experimental-Torsion with basic Knowledge Distance Geometry (ETKDG) [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR25">25</xref>] to yield likely conformations of the ligand based on trends seen in crystal conformations. Using RDKit, we generate 50 conformations, and use the Universal Force Field (UFF) to minimize and report the energy of each generated conformation. Combining the ten lowest energy conformations into a single file for each ligand. A set of low-energy conformations gives a higher likelihood that one of the conformations is close to the ground-truth ligand conformation. Additionally, <sc>gnina</sc> docking keeps rigid bond angles and lengths, so using multiple conformations of a ligand during docking allows for exploration of different bond angles and lengths.</p>
      </sec>
      <sec id="Sec9">
        <title>Cross-docking</title>
        <p id="Par15">After both ligand and protein preparation, cross-docking is performed with <sc>gnina</sc>. All of the ligands are docked against the receptor structure used for the alignment, the alphabetically lowest PDB ID (Table S1). The receptor’s cognate ligand identifies the binding site. Docking is performed using all default parameters, except for exhaustiveness, min_rmsd_filter, and num_modes (Table S2). exhaustiveness is increased to 16 to perform more sampling of the ligand during docking. min_rmsd_filter is reduced to 0.01 to allow highly similar, high-scoring poses to be output. num_modes is set to 30 to ensure we have a max number of 300 total poses for each ligand if we have ten starting conformations for each ligand. Following the docked pose statistics of [<xref ref-type="bibr" rid="CR18">18</xref>], which have up to 300 poses per docked ligand, we attempt to sample 300 docked poses per ligand complex. Additionally, <sc>gnina</sc> tends to produce distinct poses in comparison to Glide which tends to output highly similar poses, often leading to generating several near-native poses. Therefore, we utilize several ligand conformations during docking to increase the likelihood that <sc>gnina</sc> outputs more than one pose close to the native state. After docking, we re-sort the combined output poses from <sc>gnina</sc> for each ligand according to the ‘CNNscore’, a score in the range [0,1] denoting the likelihood a ligand pose is correct [<xref ref-type="bibr" rid="CR26">26</xref>]. Following [<xref ref-type="bibr" rid="CR18">18</xref>] and to reduce computation, only the top 100 docked poses of each ligand are used for subsequent steps.</p>
      </sec>
      <sec id="Sec10">
        <title>Featurization</title>
        <p id="Par16">The top 100 docked poses of each ligand are investigated for their interactions with the receptor and their distance from the ground truth, if available. Each pose has associated docking scores from both Autodock Vina and the Convolutional Neural Network (CNN) scoring functions in <sc>gnina</sc>. Additionally, the interaction fingerprint of each docked pose is computed. The interaction fingerprint profiles and scores the hydrogen bonds, salt bridges, and hydrophobic contacts between the protein and ligand. Hydrogen bond scores are a product of the distance between the donor and the acceptor’s hydrogen and the angle between the donor, hydrogen, and acceptor. However, since <sc>gnina</sc> ignores hydrogens in both the input and output, we add hydrogens to the docked poses with RDKit and minimize the hydrogen atom placement with UFF, ignoring the effect of the protein environment. Both the salt bridge and hydrophobic contact scores are simply the distance between the involved atoms. Unique to Open-ComBind, salt bridges are determined via ligand substructure matches to SMARTS strings, taken from Pharmit [<xref ref-type="bibr" rid="CR27">27</xref>], for the detection of positive and negative ions rather than using atoms with a formal charge since <sc>gnina</sc> does not modify the formal charge of the input molecule based on the receptor environment. These scores are summed by protein residue for each feature type.</p>
        <p id="Par17">Following the featurization of individual poses, we can calculate the similarity of pairs of poses based on their features. A pseudo-Tanimoto Similarity is used for the similarity of hydrogen bonds, salt bridges, and hydrophobic contacts. Since the features are not bit vectors, the Tanimoto Similarity between pose <italic>i</italic> and <italic>j</italic> is calculated as follows:<disp-formula id="Equ1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \mathrm {psuedo-}TS_{ij} = \frac{1+\sum \limits _{r\in {\mathcal {P}}} \sqrt{f^r_i} \sqrt{f^r_j}}{2 + \sum f_i + \sum f_j + \sum \limits _{r\in {\mathcal {P}}} \sqrt{f^r_i} \sqrt{f^r_j}} \end{aligned}$$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">psuedo</mml:mi><mml:mo>-</mml:mo></mml:mrow><mml:mi>T</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:munder><mml:msqrt><mml:msubsup><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi></mml:msubsup></mml:msqrt><mml:msqrt><mml:msubsup><mml:mi>f</mml:mi><mml:mi>j</mml:mi><mml:mi>r</mml:mi></mml:msubsup></mml:msqrt></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mo>∑</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo>∑</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:munder><mml:msqrt><mml:msubsup><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi></mml:msubsup></mml:msqrt><mml:msqrt><mml:msubsup><mml:mi>f</mml:mi><mml:mi>j</mml:mi><mml:mi>r</mml:mi></mml:msubsup></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="10822_2023_544_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <italic>f</italic> is one of the features and <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {P}}$$\end{document}</tex-math><mml:math id="M6"><mml:mi mathvariant="script">P</mml:mi></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq2.gif"/></alternatives></inline-formula> are all of the residues of the docking protein. An additional inter-pose feature is calculated via the RMSD between the MCSS of the two poses. We utilize a set of MCSS parameters that find a substructure with both matching atom IDs and bond orders. However, halogen atoms are allowed to match any other halogen atoms and rings are constrained to only match other, complete rings. We do not consider the MCSS if the number of heavy atoms in the MCSS is less than half the number of heavy atoms in the smallest ligand.</p>
      </sec>
      <sec id="Sec11">
        <title>Generating similarity statistics</title>
        <p id="Par18">Given our inter-pose features, we can now compute the extent to which ligands binding to the same receptor do so in a similar manner. We first define the ‘native distribution’, which looks at the inter-pose similarity between only poses with &lt; 2Å RMSD from the ground truth, denoted as <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(s(\cdot ,\cdot )|\,\text {Native})$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>Native</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq3.gif"/></alternatives></inline-formula>. We next define the ‘reference distribution’ to be the inter-pose similarity between all pairs of the top 100 poses output by <sc>gnina</sc>, denoted as <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(s(\cdot ,\cdot )|\,\text {Reference})$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>Reference</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq4.gif"/></alternatives></inline-formula>. Both distributions are determined via a Gaussian kernel density estimate on each of the inter-pose features. Following [<xref ref-type="bibr" rid="CR18">18</xref>], the Gaussian kernel density estimate uses a standard deviation of 0.03 for interaction similarities and 0.18 for MCSS RMSD. Reflected boundaries are used to reduce bias near the boundaries.</p>
        <p id="Par19">The distributions for MCSS RMSD were both capped at 6 Å to eliminate the effect of the sparse distribution for higher RMSDs. Any values greater than 6 Å were set to 6 Å.</p>
      </sec>
    </sec>
    <sec id="Sec12">
      <title>Open-ComBind pose prediction pipeline</title>
      <p id="Par20">
        <fig id="Fig1">
          <label>Fig. 1</label>
          <caption>
            <p>Open-ComBind pose prediction pipeline: the user provides a docking ligand, a <italic>holo</italic> receptor structure, and a defined binding pocket on the structure. The user can then define a set of helper ligands: molecules with <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;1\mu M$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn><mml:mi>μ</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq5.gif"/></alternatives></inline-formula> affinity to the receptor but not requiring any bound structure. A set of conformations is generated for the docking ligand and the helper ligands. <sc>gnina</sc> is used to dock the docking and helper ligands, outputs are sorted by CNNscore. The poses for each ligand are featurized and inter-pose similarities are calculated between all pairs of poses. Finally, the poses for the docking ligand as well as the helper ligands are selected using the Open-ComBind objective function which harnesses the pre-computed similiarity distributions</p>
          </caption>
          <graphic xlink:href="10822_2023_544_Fig1_HTML" id="MO1"/>
        </fig>
      </p>
      <p id="Par21">Open-ComBind provides a pipeline (Fig. <xref rid="Fig1" ref-type="fig">1</xref>) that prepares protein and ligand structures for docking, a suite of methods to compute the similarity of features from pairs of docked ligands, as well as predicting a set of poses utilizing pre-computed similarity distributions. Protein-ligand ground-truth complexes, usually determined via X-ray crystallography, are manipulated to extract separate protein and ligand structures after alignment of the pocket residues of similar protein structures. Ligands are prepared for docking by generating a set of low-energy 3D ligand conformations. Docking is run on a single receptor conformation with all of the generated conformers per ligand and the output for each ligand is sorted according to its docking score. Featurization of the top poses for each ligand includes their docking score and fingerprint of the protein-ligand interactions. Feature similarities are computed between all pairs of ligand poses, both inter- and intra-ligand pairs, utilizing the pose interaction fingerprints and the RMSD between the MCSS of the pose pair. We use the same protein and ligand pre-processing, conformation generation, docking, and featurization procedure as enumerated in “Derivation of similarity distributions” section. Finally, a pose is selected for each docked ligand by maximizing the sum of the similarity between the pose selected for each ligand and the pose’s docking score.</p>
      <p id="Par22">Poses are selected for the docking ligand and the set of helper ligands utilizing the inter-pose features in tandem with the pre-computed native and reference distributions. Adhering to the same procedure as [<xref ref-type="bibr" rid="CR18">18</xref>], we randomly initialize pose selections and randomly iterate through the ligands, picking a pose that maximizes the objective:<disp-formula id="Equ2"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}{} &amp; {} {\mathcal {L}}_{\text {Open-ComBind}} = -C\cdot \text {CNNscore}(\ell _i) \\{} &amp; {} \quad + \frac{1}{n-1}\sum \limits _{s\in {\mathcal {S}}}\sum \limits _{j\ne i}\log \frac{f(s(\ell _i,\ell _j)|\,\text {Native})}{f(s(\ell _i,\ell _j)|\,\text {Reference})} \end{aligned}$$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mtext>Open-ComBind</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>C</mml:mi><mml:mo>·</mml:mo><mml:mtext>CNNscore</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mrow/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mo>log</mml:mo><mml:mfrac><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>Native</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>Reference</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="10822_2023_544_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq6"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell _i$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq6.gif"/></alternatives></inline-formula> is the pose selected for the current ligand, <inline-formula id="IEq7"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}$$\end{document}</tex-math><mml:math id="M18"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq7.gif"/></alternatives></inline-formula> is our set of similarities, <inline-formula id="IEq8"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(s(\cdot ,\cdot )|\,\text {Native})$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>Native</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq8.gif"/></alternatives></inline-formula> and <inline-formula id="IEq9"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(s(\cdot ,\cdot )|\,\text {Reference})$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>Reference</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq9.gif"/></alternatives></inline-formula> refer to the pre-computed native and reference similarity distributions, respectively, and <italic>C</italic> is a hyperparameter to weight the CNNscore. We attempt to identify the set of selected poses that optimizes this objective function through a greedy iterative process. We continue iterating through the ligands, updating the selected pose, until no new poses are selected for any ligands. This procedure is run 500 times to increase the likelihood of finding the global minimum. The poses selected by the objective function for each ligand are returned.</p>
      <sec id="Sec13">
        <title>Selection of CNNscore weight</title>
        <p id="Par23">We select the hyperparameter, <italic>C</italic>, for the weight of the CNNscore (the pose score output by <sc>gnina</sc> [<xref ref-type="bibr" rid="CR26">26</xref>]) within the Open-ComBind score function in the same way as [<xref ref-type="bibr" rid="CR18">18</xref>]. The same cross-docked top 100 poses for each ligand used for computing the similarity statistics are pooled and sorted according to their CNNscore. For each consecutive cluster of 100 poses, we calculate the average CNNscore and the negative log-likelihood of those 100 poses being a correct pose (i.e. <inline-formula id="IEq10"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le 2$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq10.gif"/></alternatives></inline-formula>Å from the ground truth). A line is fit to the data and the slope is used as the weight for the CNNscore.</p>
      </sec>
    </sec>
    <sec id="Sec14">
      <title>Benchmark dataset evaluation</title>
      <p id="Par24">Cross-docking is the main focus of many docking studies as it most closely emulates docking experiments in drug discovery campaigns. We test the performance of Open-ComBind by performing cross-docking on the Benchmark Dataset. We utilize the protein and ligand pre-processing available in the Open-ComBind pipeline to prepare the ligands for cross-docking. A protein and ligand file are created for each complex of the Benchmark Dataset, however, binding site cofactors are manually added back to the protein, following ComBind’s preparation procedure for a fair comparison. Next, we create two sets of helper ligands for each ligand we are docking, as defined above: high-affinity binders and congeneric series. We then use the Open-ComBind Pose Prediction Pipeline (Fig. <xref rid="Fig1" ref-type="fig">1</xref>) on each ligand in which we are performing cross-docking with each set of helper ligands. When predicting poses for docking ligands of a given receptor, we omit that receptor’s docked ligand similarity statistics from the pre-computed similarity statistics used in the Open-ComBind objective function.</p>
      <p id="Par25">We run the evaluation, for each docking ligand, using five different random seeds to determine the variability of Open-ComBind given slightly different ligand poses. The random seed are used for the creation of the conformations of the docking ligand and helper ligands as well as the <sc>gnina</sc> docking procedure.</p>
    </sec>
    <sec id="Sec15">
      <title>Hypothesis evaluation</title>
      <p id="Par26">[<xref ref-type="bibr" rid="CR18">18</xref>] built ComBind on the hypothesis that distinct ligands bind to a receptor in similar ways. We aim to investigate whether this underlying hypothesis of the pipeline is correct by comparing the value of the Open-ComBind objective function for the lowest RMSD ligand poses to the value of the objective when selecting from all <sc>gnina</sc> generated poses. We only look at target proteins in the Benchmark dataset containing at least ten ligands with a <sc>gnina</sc> generated near-native pose. In the following experiment, we only use ligands with a defined ground truth pose (i.e. the set of docking ligands for each target receptor in the benchmark dataset) and only ligands that have a <sc>gnina</sc> generated pose &lt; 2Å RMSD from the ground truth. We first measure the value of the Open-ComBind objective function when we restrict our selection to the best <sc>gnina</sc> generated pose, according to lowest RMSD to the ground truth. We next evaluate the value of the Open-ComBind objective function when we select from all <sc>gnina</sc> generated poses of the ligands. If the underlying hypothesis of Open-ComBind is true, then the Open-ComBind objective function value when selecting from the best poses will be greater than or equal to the objective function value when selecting from all <sc>gnina</sc> generated poses. The Open-ComBind objective is optimized in a stochastic manner, so it is possible we will not converge on the globally optimal pose selections which is assumed to be the set of poses with the lowest RMSD to the ground truth.</p>
    </sec>
  </sec>
  <sec id="Sec16">
    <title>Results</title>
    <sec id="Sec17">
      <title>Similarity distributions</title>
      <p id="Par27">The pairwise feature similarity distributions are pivotal to the Open-ComBind objective function. Shifts from the reference to native distribution help to ensure the poses selected by the Open-ComBind objective are more likely to be pulled from the set of near-native poses. We calculate the pairwise feature similarity distributions by cross-docking all ligands in the Similarity Dataset using <sc>gnina</sc>. Then the top 100 poses of each ligand were analyzed for their interaction with the receptor structure used for docking. We see in Fig. <xref rid="Fig2" ref-type="fig">2</xref> that all of the intermolecular interactions: Hydrogen bonds, Salt Bridges, and Hydrophobic contacts have higher similarity in the native distribution than in the reference distribution. The hydrogen bonds reference distribution is heavily right-skewed, while the native distribution is centered around 0.43 with a Gaussian-like appearance. Salt Bridges are much less frequent interactions, therefore both the native and reference distributions are heavily focused on the points <inline-formula id="IEq11"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{3}$$\end{document}</tex-math><mml:math id="M26"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq11.gif"/></alternatives></inline-formula>, <inline-formula id="IEq12"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{2}$$\end{document}</tex-math><mml:math id="M28"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq12.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq13"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{2}{3}$$\end{document}</tex-math><mml:math id="M30"><mml:mfrac><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq13.gif"/></alternatives></inline-formula> indicating that most ligands only make a small number of salt bridges with the protein. The native distribution shift is not as pronounced in the salt bridge due to its infrequency; however, we still see an increase in the density centered around <inline-formula id="IEq14"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{2}{3}$$\end{document}</tex-math><mml:math id="M32"><mml:mfrac><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq14.gif"/></alternatives></inline-formula> and a slight decrease in the density around <inline-formula id="IEq15"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{3}$$\end{document}</tex-math><mml:math id="M34"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq15.gif"/></alternatives></inline-formula> Pseudo-Tanimoto similarity relative to the reference distribution. Hydrophobic contact similarity is left skewed in both the native and reference distributions. The native distribution has a mean of 0.83, while the reference distribution has a mean of 0.69. The RMSD of the MCSS shows the same trend as the intermolecular interactions, with the native poses being more similar than the similarity distribution of all poses. Due to the cutoff at 6 Å we see a spike in both distributions at 6 Å. The spike in the reference distribution far outweighs the left tail.<fig id="Fig2"><label>Fig. 2</label><caption><p>Pairwise similarities of different intra-molecular features and inter-pose similarities. The mean distribution across five seeds is plotted with the shading denoting the standard deviation</p></caption><graphic xlink:href="10822_2023_544_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par28">The hyperparameter <italic>C</italic> is set to 1 following the slopes of the best fit lines in Figure S1.</p>
    </sec>
    <sec id="Sec18">
      <title>Docking results</title>
      <p id="Par29">After defining our pairwise similarity distributions and the hyperparameter for the weight of the CNNscore, we can utilize the Open-ComBind framework to select poses from <sc>gnina</sc>’s sampled poses. Binders lacking structural information are used as helper ligands to select docked poses for our ligand of interest that interact with the receptor in similar ways to the helper ligands. Utilizing the pairwise similarity distributions shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref> along with the <sc>gnina</sc> docking scores enables selection of near-native poses more often than when only the <sc>gnina</sc> score is used to select a pose (Fig. <xref rid="Fig3" ref-type="fig">3</xref> and S2). Following [<xref ref-type="bibr" rid="CR18">18</xref>], we compute the “Overall" statistic, which is the weighted average of the different protein classes according to the proportion of FDA-approved drugs for that class of proteins. Open-ComBind increases the Overall percentage of ligands with a correct pose by 5% and 4.5% for high-affinity and congeneric series helper ligands, respectively. Nuclear receptors, GPCRs, and ion channels have the greatest increase in performance for high-affinity ligands over only the <sc>gnina</sc> docking score, 6.8%, 6.3%, and 4.7%, respectively (4.7%, 3.2%, and 12.7%, respectively for congeneric series ligands). However, in contrast to [<xref ref-type="bibr" rid="CR18">18</xref>], we find that many proteins show a reduced performance when utilizing the Open-ComBind framework relative to <sc>gnina</sc>. Additionally, for most of the proteins, we see large variances in Open-ComBind’s performance with different runs of <sc>gnina</sc>.<fig id="Fig3"><label>Fig. 3</label><caption><p>Average difference in percent of ligands whose pose is predicted correctly between <sc>gnina</sc>’s top scoring pose and the pose selected by Open-ComBind when high-affinity helper ligands are used. Error bars show the standard deviation across the five seeds. Performance with the congeneric series helper ligands is shown in Figure S2</p></caption><graphic xlink:href="10822_2023_544_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par30">When we compare our overall performance to that of [<xref ref-type="bibr" rid="CR18">18</xref>] in Fig. <xref rid="Fig4" ref-type="fig">4</xref> and S3, we see that our open-source version is slightly below the performance of ComBind. However, when comparing ComBind to Open-ComBind on each individual protein, we see a different story. ComBind tends to either increase or not change the percentage of ligands whose pose is predicted correctly across all of the proteins in the benchmark dataset. Open-ComBind has widely varying performance across different protein targets, with some protein targets seeing a major boost in performance for their docked ligands, like SMO and NR3C2 with a 100% and 50% increase, respectively. Other protein targets show a drastic decrease in the percentage of ligands whose pose is predicted correctly, for instance, MGLUR5 and NR3C1 with a 50% and 11% decrease, respectively. ComBind only has worse pose selection than Glide on one protein target when using high-affinity helper ligands, while Open-ComBind has worse pose selection than <sc>gnina</sc> on five protein targets across varying protein classes. This is all in spite of the fact that <sc>gnina</sc> and Glide demonstrate similar pose selection performance across a majority of the protein targets.<fig id="Fig4"><label>Fig. 4</label><caption><p>Comparing the docking performance of the best performing Open-ComBind seed and its associated <sc>gnina</sc> run to the performance of ComBind and Glide. Performance of ComBind and Glide scraped from [<xref ref-type="bibr" rid="CR18">18</xref>] using WebPlotDigitizer [<xref ref-type="bibr" rid="CR28">28</xref>]</p></caption><graphic xlink:href="10822_2023_544_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par31">The RMSD to ground truth of poses selected by <sc>gnina</sc> is higher than the RMSD of the poses selected by Open-ComBind for the exact same ligand (Figures S4 and S5), average RMSDs of 2.67 and 2.43 Å for <sc>gnina</sc> and Open-ComBind using high-affinity ligands, respectively. Across all of the random seeds, there is a reduction in the average RMSD of the ligands when using Open-ComBind. However, Open-ComBind does not always choose a lower or equivalent RMSD pose for each ligand. This could be due to the fact that some of the featurizations do not contribute to better pose selections.</p>
      <p id="Par32">The importance of Open-ComBind docking components to the pose selection is inspected by removing pieces from the full docking pipeline to see their impact on performance. We see from Figs. <xref rid="Fig5" ref-type="fig">5</xref> and S6 that removing the CNNscore from the pose selection process completely destroys Open-ComBind’s ability to select correct poses, dropping from 63.1 to 33.3% when using high-affinity helper ligands (62.5–38.8% when using congeneric series helper ligands). Removing individual features from Open-ComBind does not have as great an effect as removing the CNNscore, but can significantly impact Open-ComBind’s pose selection. The interaction fingerprint is pivotal to pose selection. Still, we see that only using the H-bonds (55.9%) or salt bridges (58.2%) gets about the same performance as <sc>gnina</sc>-only pose selection (58.1%). Using only Hydrophobic contacts in Open-ComBind is not significantly different (p = 0.20 and p = 0.29 for high-affinity and congeneric series helper ligands, respectively) from using all of the features. Removing the whole interaction fingerprint and only using the maximum common substructure RMSD between ligand poses slightly increases performance (63.3%, p = 0.44 and 64.6%, p = 0.11 for high-affinity and congeneric series helper ligands, respectively) but still shows improvements over <sc>gnina</sc> pose selection. Removing both the H-bonds and salt bridges from the Open-ComBind pose selection process gets about the same performance as when they are used (65.1%, p = 0.09 and 63.1%, p = 0.38 for high-affinity and congeneric series helper ligands, respectively), further demonstrating the inadequacy of H-Bond and salt bridges for pose selection improvements in Open-ComBind.<fig id="Fig5"><label>Fig. 5</label><caption><p>Removing components of Open-ComBind to determine their importance to the selection of docked poses when using the high-affinity helper ligands. ‘G’ indicates that <sc>gnina</sc> scores are used, ‘HB’,‘C’, and ‘SB’ indicate that hydrogen-bond, hydrophobic contact, and salt bridge similarity is used, respectively. ‘MCSS’ indicates that the RMSD between the MCSS of ligand poses is used and ‘Relax MCSS’ indicates a relaxed MCSS strategy was used where strict atom and bond typing were not enforced. ‘<inline-formula id="IEq16"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\cdot$$\end{document}</tex-math><mml:math id="M36"><mml:mo>·</mml:mo></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq16.gif"/></alternatives></inline-formula>’ indicates a p-value less than 0.05 while ‘<inline-formula id="IEq17"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$**$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq17.gif"/></alternatives></inline-formula>’ denotes a p-value less than 0.01 in comparison to standard Open-ComBind</p></caption><graphic xlink:href="10822_2023_544_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par33">Pose selection performance should be dependent on the number of helper ligands we use during pose selection. When no helper ligands are used during the pose selection process, we see that the percentage of ligands whose pose is predicted correctly drops (‘<sc>gnina</sc>(G)’ in Fig. <xref rid="Fig5" ref-type="fig">5</xref> and S6). However, we see in Figs. <xref rid="Fig6" ref-type="fig">6</xref> and S7 that performance plateaus as more helper ligands are added. The performance with ten helper ligands, (61.47% and 62.55% for high-affinity and congeneric series helper ligands, respectively) is about the same as using all 20 helper ligands (61.56% and 62.59% for high-affinity and congeneric series helper ligands, respectively).<fig id="Fig6"><label>Fig. 6</label><caption><p>Reducing the number of similar helper ligands used in the Open-ComBind pipeline decreases the number of docked ligands whose pose is predicted correctly. The line is the average and the shaded area is the standard deviation across 15 different subsamples of helper ligands for each number of helper ligands</p></caption><graphic xlink:href="10822_2023_544_Fig6_HTML" id="MO6"/></fig></p>
    </sec>
    <sec id="Sec19">
      <title>Hypothesis evaluation</title>
      <p id="Par34">The Open-ComBind objective function is formulated to encourage all the ligands being docked to assume similar interactions with the receptor. However, when we compare the Open-ComBind objective function value of the best <sc>gnina</sc> poses for each ligand to the optimal value when selecting from all <sc>gnina</sc> poses, we find that they are never the same when the full objective is used. (Fig. <xref rid="Fig7" ref-type="fig">7</xref>). The value of the objective function when only using the lowest RMSD to the ground truth pose found by <sc>gnina</sc> for each of the ligands being docked is less than selecting from all <sc>gnina</sc> poses, except when only the MCSS featurization is used. This implies that the underlying hypothesis of Open-ComBind is not necessarily true for these protein-ligand complexes during cross-docking. When we remove the hydrogen-bond and salt bridge interactions from the Open-ComBind objective function, the values from the two sets of poses come closer together. This is exacerbated when all interaction fingerprint features are removed from the Open-ComBind objective function and only RMSD of the MCSS is used and some proteins even have equal values of the objective function for both sets. The collection of poses identified by Open-ComBind is more similar in their interactions according to the objective function than the ensemble of lowest RMSD to ground truth poses. We additionally find that the Open-ComBind objective will not always select the native-pose when it is included in the list of poses to select from (Figure S8).<fig id="Fig7"><label>Fig. 7</label><caption><p>The difference of the Open-ComBind objective function when selecting from all <sc>gnina</sc> generated poses and the lowest RMSD to ground truth <sc>gnina</sc> pose. ‘G’ indicates that <sc>gnina</sc> scores are used, ‘HB’,‘C’, and ‘SB’ indicate that hydrogen-bond, hydrophobic contact, and salt bridge similarity is used, respectively. ‘MCSS’ indicates that the RMSD between the MCSS of ligand poses is used</p></caption><graphic xlink:href="10822_2023_544_Fig7_HTML" id="MO7"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec20">
    <title>Discussion</title>
    <sec id="Sec21">
      <title>Implementing an open-source ComBind alternative</title>
      <p id="Par35">Open-ComBind is an open-source alternative to ComBind, developed by [<xref ref-type="bibr" rid="CR18">18</xref>], that has comparable increases in pose prediction performance over the respective baseline docking method. Building out Open-ComBind took a concerted effort as the original pipeline uses opaque software tools with unspecified methods for pose generation and featurization of the docked poses. The feature distributions generated with only the poses of a single ligand conformation <sc>gnina</sc> docking run did not show more similarity in the native distribution than in the reference distributions. By comparing the inter-pose RMSD pose of both <sc>gnina</sc> and Glide, we found that Glide was much more likely to output a set of highly similar poses while <sc>gnina</sc> did not. Therefore, we were able to increase similarity of the native distributions by docking a set of ten ligand conformations and combining the docking runs of each conformation into one single set of poses which were sorted by CNNscore. This produces a list of 100 conformations that has a higher likelihood of being less than 2 Å RMSD from the ground truth and reduces the RMSD between better scoring poses.</p>
      <p id="Par36">Differences between <sc>gnina</sc>’s and Glide’s output poses required further development of the featurization pipeline as Glide produces poses with hydrogens placed to maximize hydrogen bonding and alters the tautomeric form of the ligand to form salt bridges with the protein. We overcame these differences by adding hydrogens with RDKit during featurization and detecting salt bridge forming moieties with SMARTS string patterns. Placing the hydrogens in this manner ignores the location of hydrogen bond-forming donors and acceptors on the receptor; this likely decreases the strength of the hydrogen bonds seen in Open-ComBind in comparison to ComBind. We see that the Hydrogen bond similarities do not add information over only utilizing the CNNscore in Figs. <xref rid="Fig5" ref-type="fig">5</xref> and S6, despite the fact that there are many hydrogen bonds detected in the benchmark dataset (Table S3). The usage of SMARTS string patterns for detection of salt bridges may also decrease the information provided by salt bridge similarity for increasing pose selection performance, but it is difficult to be sure as salt bridges are a rare occurrence in the benchmark dataset (Table S3).</p>
      <p id="Par37">The RMSD calculation between the MCSS of two ligand poses is the largest difference between Open-ComBind and ComBind. ComBind uses a MCSS strategy in which any two atoms can match in the graph regardless of atom type. We tested this relaxed MCSS strategy with Open-ComBind and found reduced performance (Figs. <xref rid="Fig5" ref-type="fig">5</xref> and S6). Therefore, our MCSS calculation enforces stringent atom type matching (excluding halogens which can all match each other). We additionally require that bond orders be identical for the bond to be included in the MCSS and that rings can only match other complete rings. These MCSS requirements enforce a stronger match between substructures of ligands and ensure that the scaffold of a congeneric series is placed in a similar location for all ligands.</p>
    </sec>
    <sec id="Sec22">
      <title>Open ComBind performance</title>
      <p id="Par38">The exact poses selected by Open-ComBind vary significantly when the generated, docked ligand poses are changed via different random seeds. However, on average Open-ComBind tends to improve pose selection in comparison to the <sc>gnina</sc> baseline. We see in Figs. <xref rid="Fig4" ref-type="fig">4</xref> and S3 that the standard deviation for a given protein is often much larger than its mean, indicating the results of Open-ComBind pose selection are highly dependent on the poses of the ligands. Altering the random seed affects the poses in the top scoring 100 used for the pose selection process, which can affect the consensus pose found for the docking ligand and helper ligands. We do see that the average RMSD decreases in comparison to the baseline docking method, <sc>gnina</sc>, regardless of the random seed used (Figures S4 and S5).</p>
      <p id="Par39">Hydrophobic contact similarity and MCSS RMSD are sufficient features to increase the pose prediction performance to that of the full Open-ComBind pipeline. This is likely due to the fact that hydrophobic contacts are the most common intramolecular interaction seen in the benchmark dataset by a factor of 6 (Table S3). Only utilizing these two features significantly decreases the computational cost of Open-ComBind. In fact, with congeneric series, we see (Figure S6) that only MCSS is required for the same performance as the full Open-ComBind pipeline. We expect congeneric series to have a much higher consistency in the placement of the MCSS because the MCSS is likely referring to the scaffold of the congeneric series. We also see that only 10 helper ligands are required to reach the pose prediction power of 20 helper ligands (Figs. <xref rid="Fig6" ref-type="fig">6</xref> and S7). Reducing the number of helper ligands will also decrease the computational cost of the docking pipeline as a similarity matrix must be constructed for each feature which is <inline-formula id="IEq18"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {O}}(N^2)$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq18.gif"/></alternatives></inline-formula> with the number of ligands used, <italic>N</italic>.</p>
      <p id="Par40">[<xref ref-type="bibr" rid="CR18">18</xref>] built the ComBind pose selection pipeline on the hypothesis that distinct ligands bind to the same receptor in similar ways. However, we show in Fig. <xref rid="Fig7" ref-type="fig">7</xref> that the Open-ComBind objective function does not always select ligand poses that are the lowest RMSD to the ground truth. All of the proteins tested show a lower full objective function value when evaluating on the lowest RMSD near-native poses sampled by <sc>gnina</sc> in comparison to the objective function value when selecting from all sampled poses. However, we do see that our inspection of the underlying hypothesis agrees with the ablation studies in that the usage of only the hydrophobic contacts similarity and RMSD of MCSS improves the objective function’s performance in selecting near-native poses. Further, we see that use of only the RMSD of MCSS is able to find poses with the same objective function value as the lowest RMSD to ground truth poses. This implies that the RMSD of MCSS featurization aligns well with the underlying hypothesis, while the other features do not. It is likely that the hydrogen bonds, salt bridges, and hydrophobic contacts of the lowest RMSD to ground truth poses do not show as great of a consensus due to side chain rearrangement during binding of different ligands. Therefore, allowing side chain rearrangement during docking would likely improve the performance of Open-ComBind pose selection.</p>
    </sec>
    <sec id="Sec23">
      <title>Future directions</title>
      <p id="Par41">Open-ComBind is an easy-to-use, open-source alternative to ComBind, although more work is needed to match the performance gains achieved by [<xref ref-type="bibr" rid="CR18">18</xref>]. Open-ComBind provides the molecular modeling community the opportunity to quickly and easily modify the featurization pipeline for increased pose prediction performance utilizing the large quantity of available, non-structural data. Features such as <inline-formula id="IEq19"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi -\pi$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mi>π</mml:mi><mml:mo>-</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq19.gif"/></alternatives></inline-formula> bonds and ligand shape similarity can be added easily to the docking pipeline. Since Open-ComBind uses <sc>gnina</sc> as the pose generator, we can utilize the internal representation of the CNN scoring functions within the docking pipeline as a featurization of the protein-ligand interaction for little extra computational cost. <sc>gnina</sc> also allows flexible sidechains during docking which could be used in the Open-ComBind framework for finding different pocket configurations to fit ligands of different sizes or ligands forming non-bonded interactions in different relative locations. Finally, Open-ComBind could be extended to predict the protonation state of the ligand to form better hydrogen bonds with the receptor and select better ligand poses than docking with the input protonation state.</p>
    </sec>
    <sec id="Sec24">
      <title>Ease to use API</title>
      <p id="Par42">Open-ComBind has been developed as a Python package with an accompanying command-line interface for running the entire pipeline. We provide the pre-processing, docking, featurization, and pose selection as easy-to-use Python modules or a single command on the command line. After installation of Open-ComBind and its pre-requisites from our github repository: <ext-link ext-link-type="uri" xlink:href="http://www.github.com/drewnutt/open_combind">www.github.com/drewnutt/open_combind</ext-link>, users can run the entire Open-ComBind pipeline with the command:<graphic position="anchor" xlink:href="10822_2023_544_Figa_HTML" id="MO8"/> where helper_ligands.csv is a comma-delimited file of the helper ligands SMILES strings and identifiers. The user must specify the location of the raw protein-ligand complex to use for docking. Other protein-ligand crystals can be placed in the same directory for pre-processing.</p>
      <p id="Par43">Additionally, we provide scripts and instructions for using the Open-ComBind pose prediction pipeline with other molecular docking tools. Use of molecular docking tools that directly consider hydrogen bonds and predict ligand hydrogen coordinates would likely improve the utility of the hydrogen bond similarity in enhancing pose prediction.</p>
    </sec>
  </sec>
  <sec id="Sec25">
    <title>Conclusion</title>
    <p id="Par44">In this work, we developed Open-ComBind, an open-source alternative to ComBind, to increase pose prediction performance over <sc>gnina</sc>. Open-ComBind reduces the average RMSD to ground truth from <sc>gnina</sc>’s 3.24 Å to 3.03 Å for all ligands. We utilize ligands lacking structural information as well as a distribution of ligand feature similarity of both native poses and all poses. Open-ComBind utilizes pairwise similarities between sets of ligand poses to determine the poses which maximize inter-ligand similarity of binding. We see pose selection improvement equal to the full pipeline when using only hydrophobic contact similarity and the RMSD between the MCSS of ligand pairs. Additionally, we observe that Open-ComBind only requires ten helper ligands to reach the pose prediction performance of using 20 helper ligands. We provide the Open-ComBind in an easy-to-use API as well as source code and data to use the Open-ComBind pipeline at our GitHub repo: <ext-link ext-link-type="uri" xlink:href="http://www.github.com/drewnutt/open_combind/">www.github.com/drewnutt/open_combind/</ext-link></p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec100">
      <title>Supplementary Information</title>
      <p>Below is the link to the electronic supplementary material.<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="10822_2023_544_MOESM1_ESM.pdf"><caption><p>Supplementary file1 (PDF 512 kb)</p></caption></media></supplementary-material></p>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank Jonathan King, Dakota Folmsbee, and Rishal Aggarwal for their comments during the preparation of the manuscript. The authors would like to thank Joseph M. Paggi for providing the structural data used for deriving the similarity statistics of ComBind. This work is supported by the R35GM140753 from the National Institute of General Medical Sciences and CHE-2102474 from the National Science Foundation.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>ATM designed and completed the computational study under the supervision of DRK. ATM and DRK wrote the paper.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Not applicable.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>Information for downloading the datasets are available at <ext-link ext-link-type="uri" xlink:href="http://www.github.com/drewnutt/open_combind/">www.github.com/drewnutt/open_combind/</ext-link>.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>Our pipeline is open source and available under a CC BY-NC-SA 3.0 license. The full Open-ComBind pipeline code, documentation, and evaluation scripts are available at <ext-link ext-link-type="uri" xlink:href="http://www.github.com/drewnutt/open_combind/">www.github.com/drewnutt/open_combind/</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1" notes-type="COI-statement">
      <title>Conflict of interest</title>
      <p id="Par45">The authors declare no competing interests.</p>
    </notes>
    <notes id="FPar2">
      <title>Ethics approval</title>
      <p id="Par46">Not applicable.</p>
    </notes>
    <notes id="FPar3">
      <title>Consent to participate</title>
      <p id="Par47">Not applicable.</p>
    </notes>
    <notes id="FPar4">
      <title>Consent for publication</title>
      <p id="Par48">Not applicable.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sliwoski</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Kothiwale</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Meiler</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lowe</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <article-title>Computational methods in drug discovery</article-title>
        <source>Pharmacol Rev</source>
        <year>2014</year>
        <volume>66</volume>
        <issue>1</issue>
        <fpage>334</fpage>
        <lpage>395</lpage>
        <pub-id pub-id-type="doi">10.1124/pr.112.007336</pub-id>
        <?supplied-pmid 24381236?>
        <pub-id pub-id-type="pmid">24381236</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Gubernator</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Böhm</surname>
            <given-names>H-J</given-names>
          </name>
          <name>
            <surname>Mannhold</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kubinyi</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Timmerman</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <source>Structure-based ligand design</source>
        <year>1998</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Wiley Online Library</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anderson</surname>
            <given-names>AC</given-names>
          </name>
        </person-group>
        <article-title>The process of structure-based drug design</article-title>
        <source>Chem Biol</source>
        <year>2003</year>
        <volume>10</volume>
        <issue>9</issue>
        <fpage>787</fpage>
        <lpage>797</lpage>
        <pub-id pub-id-type="doi">10.1016/j.chembiol.2003.09.002</pub-id>
        <?supplied-pmid 14522049?>
        <pub-id pub-id-type="pmid">14522049</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kitchen</surname>
            <given-names>DB</given-names>
          </name>
          <name>
            <surname>Decornez</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Furr</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Bajorath</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Docking and scoring in virtual screening for drug discovery: methods and applications</article-title>
        <source>Nat Rev Drug Discov</source>
        <year>2004</year>
        <volume>3</volume>
        <issue>11</issue>
        <fpage>935</fpage>
        <lpage>949</lpage>
        <pub-id pub-id-type="doi">10.1038/nrd1549</pub-id>
        <?supplied-pmid 15520816?>
        <pub-id pub-id-type="pmid">15520816</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trott</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Olson</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Autodock vina: improving the speed and accuracy of docking with a new scoring function, efficient optimization, and multithreading</article-title>
        <source>J Comput Chem</source>
        <year>2010</year>
        <volume>31</volume>
        <issue>2</issue>
        <fpage>455</fpage>
        <lpage>461</lpage>
        <pub-id pub-id-type="doi">10.1002/jcc.21334</pub-id>
        <?supplied-pmid 19499576?>
        <pub-id pub-id-type="pmid">19499576</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Friesner</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Banks</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Halgren</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Klicic</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Mainz</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Repasky</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Knoll</surname>
            <given-names>EH</given-names>
          </name>
          <name>
            <surname>Shelley</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Perry</surname>
            <given-names>JK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Glide: a new approach for rapid, accurate docking and scoring. 1. Method and assessment of docking accuracy</article-title>
        <source>J Med Chem</source>
        <year>2004</year>
        <volume>47</volume>
        <issue>7</issue>
        <fpage>1739</fpage>
        <lpage>1749</lpage>
        <pub-id pub-id-type="doi">10.1021/jm0306430</pub-id>
        <?supplied-pmid 15027865?>
        <pub-id pub-id-type="pmid">15027865</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Halgren</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Friesner</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Beard</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Frye</surname>
            <given-names>LL</given-names>
          </name>
          <name>
            <surname>Pollard</surname>
            <given-names>WT</given-names>
          </name>
          <name>
            <surname>Banks</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>Glide: a new approach for rapid, accurate docking and scoring. 2. Enrichment factors in database screening.</article-title>
        <source>J Med Chem</source>
        <year>2004</year>
        <volume>47</volume>
        <issue>7</issue>
        <fpage>1750</fpage>
        <lpage>1759</lpage>
        <pub-id pub-id-type="doi">10.1021/jm030644s</pub-id>
        <?supplied-pmid 15027866?>
        <pub-id pub-id-type="pmid">15027866</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McNutt</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Francoeur</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Aggarwal</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Masuda</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Meli</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ragoza</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sunseri</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Koes</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>Gnina 1.0: molecular docking with deep learning</article-title>
        <source>J Cheminform</source>
        <year>2021</year>
        <volume>13</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="doi">10.1186/s13321-021-00522-2</pub-id>
        <pub-id pub-id-type="pmid">33407901</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Corso G, Stärk H, Jing B, Barzilay R, Jaakkola, T (2023) Diffdock: diffusion steps, twists, and turns for molecular docking. In: International conference on learning representations (ICLR)</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vidal</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Garcia-Serna</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Mestres</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Ligand-based approaches to in silico pharmacology</article-title>
        <source>Chemoinform Comput Chem Biol</source>
        <year>2011</year>
        <pub-id pub-id-type="doi">10.1007/978-1-60761-839-3_19</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Banegas-Luna</surname>
            <given-names>A-J</given-names>
          </name>
          <name>
            <surname>Ceron-Carrasco</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Perez-Sanchez</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A review of ligand-based virtual screening web tools and screening algorithms in large molecular databases in the age of big data</article-title>
        <source>Future Med Chem</source>
        <year>2018</year>
        <volume>10</volume>
        <issue>22</issue>
        <fpage>2641</fpage>
        <lpage>2658</lpage>
        <pub-id pub-id-type="doi">10.4155/fmc-2018-0076</pub-id>
        <?supplied-pmid 30499744?>
        <pub-id pub-id-type="pmid">30499744</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grimm</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Bu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Xiao</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Ligmate: a multifeature integration algorithm for ligand-similarity-based virtual screening</article-title>
        <source>J Chem Inf Model</source>
        <year>2020</year>
        <volume>60</volume>
        <issue>12</issue>
        <fpage>6044</fpage>
        <lpage>6053</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.9b01210</pub-id>
        <?supplied-pmid 33190499?>
        <pub-id pub-id-type="pmid">33190499</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Broccatelli</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Best of both worlds: on the complementarity of ligand-based and structure-based virtual screening</article-title>
        <source>J Chem Inf Model</source>
        <year>2014</year>
        <volume>54</volume>
        <issue>6</issue>
        <fpage>1634</fpage>
        <lpage>1641</lpage>
        <pub-id pub-id-type="doi">10.1021/ci5001604</pub-id>
        <?supplied-pmid 24877883?>
        <pub-id pub-id-type="pmid">24877883</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kumar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>KY</given-names>
          </name>
        </person-group>
        <article-title>A cross docking pipeline for improving pose prediction and virtual screening performance</article-title>
        <source>J Comput Aided Mol Des</source>
        <year>2018</year>
        <volume>32</volume>
        <fpage>163</fpage>
        <lpage>173</lpage>
        <pub-id pub-id-type="doi">10.1007/s10822-017-0048-z</pub-id>
        <?supplied-pmid 28836076?>
        <pub-id pub-id-type="pmid">28836076</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Enhance the performance of current scoring functions with the aid of 3d protein-ligand interaction fingerprints</article-title>
        <source>BMC Bioinform</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.1186/s12859-017-1750-5</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lam</surname>
            <given-names>PC-H</given-names>
          </name>
          <name>
            <surname>Abagyan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Totrov</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Ligand-biased ensemble receptor docking (LigBEnD): a hybrid ligand/receptor structure-based approach</article-title>
        <source>J Comput Aided Mol Des</source>
        <year>2018</year>
        <volume>32</volume>
        <fpage>187</fpage>
        <lpage>198</lpage>
        <pub-id pub-id-type="doi">10.1007/s10822-017-0058-x</pub-id>
        <?supplied-pmid 28887659?>
        <pub-id pub-id-type="pmid">28887659</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>S-Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Hybriddock: a hybrid protein-ligand docking protocol integrating protein-and ligand-based approaches</article-title>
        <source>J Chem Inf Model</source>
        <year>2016</year>
        <volume>56</volume>
        <issue>6</issue>
        <fpage>1078</fpage>
        <lpage>1087</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.5b00275</pub-id>
        <?supplied-pmid 26317502?>
        <pub-id pub-id-type="pmid">26317502</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paggi</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Belk</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Hollingsworth</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Villanueva</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Powers</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Chemparathy</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Tynan</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Lau</surname>
            <given-names>TK</given-names>
          </name>
          <name>
            <surname>Sunahara</surname>
            <given-names>RK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Leveraging nonstructural data to predict structures and affinities of protein-ligand complexes</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2021</year>
        <volume>118</volume>
        <issue>51</issue>
        <fpage>2112621118</fpage>
        <pub-id pub-id-type="doi">10.1073/pnas.2112621118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bakan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Meireles</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Bahar</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Prody: protein dynamics inferred from theory and experiments</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>11</issue>
        <fpage>1575</fpage>
        <lpage>1577</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr168</pub-id>
        <?supplied-pmid 21471012?>
        <pub-id pub-id-type="pmid">21471012</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Krieger</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kaya</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kaynak</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Mikulska-Ruminska</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Doruker</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bahar</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Prody 2.0: increased scale and scope after 10 years of protein dynamics modelling with python</article-title>
        <source>Bioinformatics</source>
        <year>2021</year>
        <volume>37</volume>
        <issue>20</issue>
        <fpage>3657</fpage>
        <lpage>3659</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btab187</pub-id>
        <?supplied-pmid 33822884?>
        <pub-id pub-id-type="pmid">33822884</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berman</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>Westbrook</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Gilliland</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Bhat</surname>
            <given-names>TN</given-names>
          </name>
          <name>
            <surname>Weissig</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Shindyalov</surname>
            <given-names>IN</given-names>
          </name>
          <name>
            <surname>Bourne</surname>
            <given-names>PE</given-names>
          </name>
        </person-group>
        <article-title>The protein data bank</article-title>
        <source>Nucleic Acids Res</source>
        <year>2000</year>
        <volume>28</volume>
        <issue>1</issue>
        <fpage>235</fpage>
        <lpage>242</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/28.1.235</pub-id>
        <?supplied-pmid 10592235?>
        <pub-id pub-id-type="pmid">10592235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Burley</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Bhikadiya</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bittrich</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Craig</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Crichlow</surname>
            <given-names>GV</given-names>
          </name>
          <name>
            <surname>Dalenberg</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Duarte</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RCSB protein data bank (rcsb.org): delivery of experimentally-determined PDB structures alongside one million computed structure models of proteins from artificial intelligence/machine learning</article-title>
        <source>Nucleic Acids Res</source>
        <year>2023</year>
        <volume>51</volume>
        <issue>D1</issue>
        <fpage>488</fpage>
        <lpage>508</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkac1077</pub-id>
        <pub-id pub-id-type="pmid">36583345</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Schrödinger, LLC: the PyMOL molecular graphics system, version 1.8 (2015)</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Riniker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Landrum</surname>
            <given-names>GA</given-names>
          </name>
        </person-group>
        <article-title>Better informed distance geometry: using what we know to improve conformation generation</article-title>
        <source>J Chem Inf Model</source>
        <year>2015</year>
        <volume>55</volume>
        <issue>12</issue>
        <fpage>2562</fpage>
        <lpage>2574</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.5b00654</pub-id>
        <?supplied-pmid 26575315?>
        <pub-id pub-id-type="pmid">26575315</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Witek</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Landrum</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Riniker</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Improving conformer generation for small rings and macrocycles based on distance geometry and experimental torsional-angle preferences</article-title>
        <source>J Chem Inf Model</source>
        <year>2020</year>
        <volume>60</volume>
        <issue>4</issue>
        <fpage>2044</fpage>
        <lpage>2058</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.0c00025</pub-id>
        <?supplied-pmid 32155061?>
        <pub-id pub-id-type="pmid">32155061</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Francoeur</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Masuda</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sunseri</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jia</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Iovanisci</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Koes</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>Three-dimensional convolutional neural networks and a cross-docked data set for structure-based drug design</article-title>
        <source>J Chem Inf Model</source>
        <year>2020</year>
        <volume>60</volume>
        <issue>9</issue>
        <fpage>4200</fpage>
        <lpage>4215</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.0c00411</pub-id>
        <?supplied-pmid 32865404?>
        <pub-id pub-id-type="pmid">32865404</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sunseri</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Koes</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>Pharmit: interactive exploration of chemical space</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <issue>W1</issue>
        <fpage>442</fpage>
        <lpage>448</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw287</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Rohatgi A (2022) Webplotdigitizer: version 4.6. <ext-link ext-link-type="uri" xlink:href="https://automeris.io/WebPlotDigitizer">https://automeris.io/WebPlotDigitizer</ext-link></mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Comput Aided Mol Des</journal-id>
    <journal-id journal-id-type="iso-abbrev">J Comput Aided Mol Des</journal-id>
    <journal-title-group>
      <journal-title>Journal of Computer-Aided Molecular Design</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0920-654X</issn>
    <issn pub-type="epub">1573-4951</issn>
    <publisher>
      <publisher-name>Springer International Publishing</publisher-name>
      <publisher-loc>Cham</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10703974</article-id>
    <article-id pub-id-type="pmid">38062207</article-id>
    <article-id pub-id-type="publisher-id">544</article-id>
    <article-id pub-id-type="doi">10.1007/s10822-023-00544-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Open-ComBind: harnessing unlabeled data for improved binding pose prediction</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>McNutt</surname>
          <given-names>Andrew T.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Koes</surname>
          <given-names>David Ryan</given-names>
        </name>
        <address>
          <email>dkoes@pitt.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/01an3r305</institution-id><institution-id institution-id-type="GRID">grid.21925.3d</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 9000</institution-id><institution>Department of Computational and Systems Biology, </institution><institution>University of Pittsburgh, </institution></institution-wrap>Pittsburgh, PA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <year>2024</year>
    </pub-date>
    <volume>38</volume>
    <issue>1</issue>
    <elocation-id>3</elocation-id>
    <history>
      <date date-type="received">
        <day>6</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>11</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Determination of the bound pose of a ligand is a critical first step in many in silico drug discovery tasks. Molecular docking is the main tool for the prediction of non-covalent binding of a protein and ligand system. Molecular docking pipelines often only utilize the information of one ligand binding to the protein despite the commonly held hypothesis that different ligands share binding interactions when bound to the same receptor. Here we describe Open-ComBind, an easy-to-use, open-source version of the ComBind molecular docking pipeline that leverages information from multiple ligands without known bound structures to enhance pose selection. We first create distributions of feature similarities between ligand pose pairs, comparing near-native poses with all sampled docked poses. These distributions capture the likelihood of observing similar features, such as hydrogen bonds or hydrophobic contacts, in different pose configurations. These similarity distributions are then combined with a per-ligand docking score to enhance overall pose selection by 5% and 4.5% for high-affinity and congeneric series helper ligands, respectively. Open-ComBind reduces the average RMSD of ligands in our benchmark dataset by 9.0%. We provide Open-ComBind as an easy-to-use command line and Python API to increase pose prediction performance at <ext-link ext-link-type="uri" xlink:href="http://www.github.com/drewnutt/open_combind">www.github.com/drewnutt/open_combind</ext-link>.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1007/s10822-023-00544-y.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Molecular docking</kwd>
      <kwd>Machine learning</kwd>
      <kwd>Structure-based drug design</kwd>
      <kwd>Open-source</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id>
            <institution>National Institute of General Medical Sciences</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R35GM140753</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>CHE-2102474</award-id>
        <award-id>CHE-2102474</award-id>
        <principal-award-recipient>
          <name>
            <surname>McNutt</surname>
            <given-names>Andrew T.</given-names>
          </name>
          <name>
            <surname>Koes</surname>
            <given-names>David Ryan</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature Switzerland AG 2024</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par2">Drug discovery is a complex, multifaceted process involving the identification of small molecules capable of interacting with specific biological targets to produce a therapeutic effect. Computer-aided drug design (CADD) tools allow for the reduction of the enormous complexity and cost of the traditional drug discovery pipeline [<xref ref-type="bibr" rid="CR1">1</xref>]. CADD can be broadly divided into two main techniques: structure-based and ligand-based. Structure-based drug design (SBDD) uses the knowledge of the three-dimensional structure of a target protein to guide the selection of molecules that can bind with high affinity and selectivity [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>].</p>
    <p id="Par3">Molecular docking is a vital tool in the SBDD toolbox that predicts the non-covalent binding of two molecules in three-dimensional space. Knowledge of the ligand binding pose is critical for many downstream drug discovery tasks, such as lead optimization, affinity prediction, and virtual screening. Typical molecular docking algorithms either utilize energetics of interactions or the statistics of known binding interactions to predict the relative placement of the molecules [<xref ref-type="bibr" rid="CR4">4</xref>]. Conventional docking algorithms, such as Autodock Vina [<xref ref-type="bibr" rid="CR5">5</xref>] or Glide [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>], and even deep learning-based docking algorithms, like <sc>gnina</sc> [<xref ref-type="bibr" rid="CR8">8</xref>]or DiffDock [<xref ref-type="bibr" rid="CR9">9</xref>], predict the binding of every ligand separately even when multiple ligands are docked to the same receptor structure. Many drug targets are unsuitable for molecular docking due to a lack of suitable crystal structures (i.e. large ligand volume difference with cognate ligand or no available <italic>holo</italic> crystal structures). In these cases, alternative approaches must be employed.</p>
    <p id="Par4">One such approach is ligand-based drug design (LBDD), which relies on the analysis of known active compounds rather than the target protein itself. LBDD typically involves comparing the chemical features of known actives to those of putative inactives in order to identify pharmacophores - sets of chemical properties necessary for activity against a target [<xref ref-type="bibr" rid="CR10">10</xref>]. These pharmacophores can be one, two, or three-dimensional, providing an understanding of active molecule properties or shape [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. The generated pharmacophores are used to screen large libraries of compounds to find drug-like molecules with similar properties. LBDD allows for fast screening of incredibly large molecule libraries. Still, its reliance on empirical observations means it can struggle to capture subtle differences between closely related analogs. The results may not always generalize to a new series of compounds.</p>
    <p id="Par5">There have been several recent works that integrate LBDD with molecular docking to improve predictive performance. [<xref ref-type="bibr" rid="CR13">13</xref>] and [<xref ref-type="bibr" rid="CR14">14</xref>] utilize LBDD techniques to determine protein conformations that will increase docking performance with a given drug molecule. [<xref ref-type="bibr" rid="CR15">15</xref>] use protein-ligand interaction fingerprints to increase the scoring power of standard molecular docking scoring functions. [<xref ref-type="bibr" rid="CR16">16</xref>] and [<xref ref-type="bibr" rid="CR17">17</xref>] harness knowledge of known bound poses to guide the molecular docking of novel ligands binding to the same receptor. These methods are able to reduce the sampling space of the ligands during docking by using known bound ligand poses as a bias to their sampling procedure. [<xref ref-type="bibr" rid="CR18">18</xref>] integrated structure-based docking from Glide, a commercial docking software, [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>] and 3D ligand similarities to increase pose prediction performance with their docking pipeline ComBind. Their work allows the use of abundant information on known active molecules that have no known bound structure to improve pose selection. Using Glide to dock a diverse protein-ligand benchmark set, they derive two distributions describing the pairwise pose similarity of poses near the ground truth and the pairwise pose similarity of all docked poses with respect to features such as hydrogen bonds or hydrophobic contacts. During the pose selection procedure, the feature distributions are converted to energy-like terms using the log ratio of the near-native similarity distribution to the all-pose similarity distribution. These likelihood terms are used in combination with Glide’s pose score to select a pose for a query ligand as well as for a set of ligands known to bind to the same receptor that do not require resolved structures. Their pipeline showed increased pose selection performance over only using Glide’s pose score, however, their pipeline utilized closed-source, licensed tools for pose generation and featurization, limiting its adoption by the molecular modeling community.</p>
    <p id="Par6">Here we present an easy-to-use, open-source alternative to ComBind that we call Open-ComBind. The open-source, deep learning-based molecular docking software <sc>gnina</sc> is used to generate high quality ligand poses, and open-source tools like ProDy [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>] and RDKit are used to featurize the docked compounds. Using a likelihood framework identical to ComBind, we utilize a set of helper ligands without known structural information to improve the pose quality of our docked ligand. The pose selection procedure strikes a balance between the individual pose scores assigned by the per-ligand deep learning scoring functions and the similarities and differences between the poses of various ligands. As a result, Open-ComBind produces a set of optimized poses for all ligands simultaneously, without requiring a shared ligand scaffold or knowledge of any ligand’s binding pose.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <p id="Par7">Here, we detail the dataset used in the creation of the docking pipeline as well as the dataset employed for evaluation of our pipeline. We describe the creation of inter-pose similarity statistics by performing cross-docking on a diverse protein-ligand benchmark dataset. The Open-ComBind docking pipeline is described, harnessing the similarity statistics to performing pose selection on a ligand of interest, the ‘docking ligand’, using a set of ligands with unknown bound structures, the ‘helper ligands’. Finally, an experiment to determine the validity of Open-ComBind’s underlying hypothesis: ‘distinct ligands bind to a receptor in similar ways’.</p>
    <sec id="Sec3">
      <title>Data</title>
      <sec id="Sec4">
        <title>Similarity dataset</title>
        <p id="Par8">Following [<xref ref-type="bibr" rid="CR18">18</xref>], a list of 30 target proteins (Table S1) representative of all major families of drug targets is used to generate the pairwise pose feature similarity distributions. The entire benchmark dataset of 421 protein-ligand pairs is used to generate the similarity statistics.</p>
      </sec>
      <sec id="Sec5">
        <title>Benchmark dataset</title>
        <p id="Par9">Generating the dataset used for evaluating pose prediction pipelines necessitates removal of easy-to-dock ligands. Following [<xref ref-type="bibr" rid="CR18">18</xref>], we filter the Similarity Dataset to remove any ligand that has greater than 50% of its atoms in the maximum common substructure computed with the cognate ligand of the receptor structure used for docking. If a new ligand shares most of the same structure as the cognate ligand then its probable the pocket has an appropriate configuration to bind the similar ligand. This reduces the set to 245 protein-ligand complexes for determining the performance of a pose prediction pipeline. These ligands are used as the ‘docking ligand’ during the evaluation of the pipeline.</p>
      </sec>
      <sec id="Sec6">
        <title>Helper ligands</title>
        <p id="Par10">Helper ligands are a set of ligands known to bind to the receptor of interest with <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;1\mu M$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn><mml:mi>μ</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq1.gif"/></alternatives></inline-formula> affinity, but may not have a solved bound structure. These ligands are used along with the ‘docking ligand’ in the Open-ComBind pipeline to improve pose selection of both the ‘docking ligand’ and the ‘helper ligands.’</p>
        <p id="Par11">We utilize the same two sets of helper ligands as in [<xref ref-type="bibr" rid="CR18">18</xref>]: one in which the helper ligands do not share a scaffold with the docking ligand, termed ‘High-affinity helper ligands’, and the other in which the ligands have the largest Maximum Common Substructure (MCSS) with the docking ligand, termed ‘Congeneric series helper ligands’. We use the MCSS definition from [<xref ref-type="bibr" rid="CR18">18</xref>] to ensure we are using the same set of helper ligands.</p>
      </sec>
    </sec>
    <sec id="Sec7">
      <title>Derivation of similarity distributions</title>
      <p id="Par12">Here we detail the development of pairwise similarity distributions for near-native poses and all docked poses using the Similarity Dataset.</p>
      <sec id="Sec8">
        <title>Protein and ligand pre-processing</title>
        <p id="Par13">Protein and ligand pre-processing separates the protein and ligand into separate docking-ready structures. Initially, a set of co-crystallized protein-ligand structures for each receptor in the Similarity Dataset is downloaded from RCSB.org [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>]. The ligand of interest in each co-crystallized structure is then designated based on its residue name. Using ProDy [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>], separate files are generated for the protein, ligand, waters, and other heteroatoms that are present in the original crystal structure. The instance coordinates of the ligand structure are downloaded directly from RCSB.org [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>] using their File Download Service to ensure proper coordinate and bond information. Using only the protein and ligand complex, we align all structures of a receptor based on the residues closest to the binding pocket. Protein residues within 15 Å of the ligand are used to align each receptor structure with PyMol [<xref ref-type="bibr" rid="CR23">23</xref>] to the alphabetically lowest PDB ID (PDB IDs specified in Table S1). The co-crystallized ligand’s coordinates are transformed according to the receptor alignment object. The aligned ligand and receptor are then separated into their own files to provide a ground-truth ligand and a <italic>holo</italic> structure for cross-docking with non-cognate ligands. After removal of the ligand, missing residues, atoms, and hydrogens are added (at a pH of 7.0) to the receptor structures using PDBFixer and minimized, ensuring interactions are detected properly after docking. Missing atoms and hydrogens are minimized using the default OpenMM forcefield. Finally, a <sc>gnina</sc> docking command template is created for each protein. The <sc>gnina</sc> docking command template specifies the docking protein structure (i.e. the aligned-to receptor structure) as well as the binding box location, defined by the cognate ligand of the docking receptor.</p>
        <p id="Par14">Docking with <sc>gnina</sc> requires knowledge of the 3D structure of the ligands to be docked. Conformations are generated for ligands using Experimental-Torsion with basic Knowledge Distance Geometry (ETKDG) [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR25">25</xref>] to yield likely conformations of the ligand based on trends seen in crystal conformations. Using RDKit, we generate 50 conformations, and use the Universal Force Field (UFF) to minimize and report the energy of each generated conformation. Combining the ten lowest energy conformations into a single file for each ligand. A set of low-energy conformations gives a higher likelihood that one of the conformations is close to the ground-truth ligand conformation. Additionally, <sc>gnina</sc> docking keeps rigid bond angles and lengths, so using multiple conformations of a ligand during docking allows for exploration of different bond angles and lengths.</p>
      </sec>
      <sec id="Sec9">
        <title>Cross-docking</title>
        <p id="Par15">After both ligand and protein preparation, cross-docking is performed with <sc>gnina</sc>. All of the ligands are docked against the receptor structure used for the alignment, the alphabetically lowest PDB ID (Table S1). The receptor’s cognate ligand identifies the binding site. Docking is performed using all default parameters, except for exhaustiveness, min_rmsd_filter, and num_modes (Table S2). exhaustiveness is increased to 16 to perform more sampling of the ligand during docking. min_rmsd_filter is reduced to 0.01 to allow highly similar, high-scoring poses to be output. num_modes is set to 30 to ensure we have a max number of 300 total poses for each ligand if we have ten starting conformations for each ligand. Following the docked pose statistics of [<xref ref-type="bibr" rid="CR18">18</xref>], which have up to 300 poses per docked ligand, we attempt to sample 300 docked poses per ligand complex. Additionally, <sc>gnina</sc> tends to produce distinct poses in comparison to Glide which tends to output highly similar poses, often leading to generating several near-native poses. Therefore, we utilize several ligand conformations during docking to increase the likelihood that <sc>gnina</sc> outputs more than one pose close to the native state. After docking, we re-sort the combined output poses from <sc>gnina</sc> for each ligand according to the ‘CNNscore’, a score in the range [0,1] denoting the likelihood a ligand pose is correct [<xref ref-type="bibr" rid="CR26">26</xref>]. Following [<xref ref-type="bibr" rid="CR18">18</xref>] and to reduce computation, only the top 100 docked poses of each ligand are used for subsequent steps.</p>
      </sec>
      <sec id="Sec10">
        <title>Featurization</title>
        <p id="Par16">The top 100 docked poses of each ligand are investigated for their interactions with the receptor and their distance from the ground truth, if available. Each pose has associated docking scores from both Autodock Vina and the Convolutional Neural Network (CNN) scoring functions in <sc>gnina</sc>. Additionally, the interaction fingerprint of each docked pose is computed. The interaction fingerprint profiles and scores the hydrogen bonds, salt bridges, and hydrophobic contacts between the protein and ligand. Hydrogen bond scores are a product of the distance between the donor and the acceptor’s hydrogen and the angle between the donor, hydrogen, and acceptor. However, since <sc>gnina</sc> ignores hydrogens in both the input and output, we add hydrogens to the docked poses with RDKit and minimize the hydrogen atom placement with UFF, ignoring the effect of the protein environment. Both the salt bridge and hydrophobic contact scores are simply the distance between the involved atoms. Unique to Open-ComBind, salt bridges are determined via ligand substructure matches to SMARTS strings, taken from Pharmit [<xref ref-type="bibr" rid="CR27">27</xref>], for the detection of positive and negative ions rather than using atoms with a formal charge since <sc>gnina</sc> does not modify the formal charge of the input molecule based on the receptor environment. These scores are summed by protein residue for each feature type.</p>
        <p id="Par17">Following the featurization of individual poses, we can calculate the similarity of pairs of poses based on their features. A pseudo-Tanimoto Similarity is used for the similarity of hydrogen bonds, salt bridges, and hydrophobic contacts. Since the features are not bit vectors, the Tanimoto Similarity between pose <italic>i</italic> and <italic>j</italic> is calculated as follows:<disp-formula id="Equ1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \mathrm {psuedo-}TS_{ij} = \frac{1+\sum \limits _{r\in {\mathcal {P}}} \sqrt{f^r_i} \sqrt{f^r_j}}{2 + \sum f_i + \sum f_j + \sum \limits _{r\in {\mathcal {P}}} \sqrt{f^r_i} \sqrt{f^r_j}} \end{aligned}$$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">psuedo</mml:mi><mml:mo>-</mml:mo></mml:mrow><mml:mi>T</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:munder><mml:msqrt><mml:msubsup><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi></mml:msubsup></mml:msqrt><mml:msqrt><mml:msubsup><mml:mi>f</mml:mi><mml:mi>j</mml:mi><mml:mi>r</mml:mi></mml:msubsup></mml:msqrt></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mo>∑</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo>∑</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:munder><mml:msqrt><mml:msubsup><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi></mml:msubsup></mml:msqrt><mml:msqrt><mml:msubsup><mml:mi>f</mml:mi><mml:mi>j</mml:mi><mml:mi>r</mml:mi></mml:msubsup></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="10822_2023_544_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <italic>f</italic> is one of the features and <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {P}}$$\end{document}</tex-math><mml:math id="M6"><mml:mi mathvariant="script">P</mml:mi></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq2.gif"/></alternatives></inline-formula> are all of the residues of the docking protein. An additional inter-pose feature is calculated via the RMSD between the MCSS of the two poses. We utilize a set of MCSS parameters that find a substructure with both matching atom IDs and bond orders. However, halogen atoms are allowed to match any other halogen atoms and rings are constrained to only match other, complete rings. We do not consider the MCSS if the number of heavy atoms in the MCSS is less than half the number of heavy atoms in the smallest ligand.</p>
      </sec>
      <sec id="Sec11">
        <title>Generating similarity statistics</title>
        <p id="Par18">Given our inter-pose features, we can now compute the extent to which ligands binding to the same receptor do so in a similar manner. We first define the ‘native distribution’, which looks at the inter-pose similarity between only poses with &lt; 2Å RMSD from the ground truth, denoted as <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(s(\cdot ,\cdot )|\,\text {Native})$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>Native</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq3.gif"/></alternatives></inline-formula>. We next define the ‘reference distribution’ to be the inter-pose similarity between all pairs of the top 100 poses output by <sc>gnina</sc>, denoted as <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(s(\cdot ,\cdot )|\,\text {Reference})$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>Reference</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq4.gif"/></alternatives></inline-formula>. Both distributions are determined via a Gaussian kernel density estimate on each of the inter-pose features. Following [<xref ref-type="bibr" rid="CR18">18</xref>], the Gaussian kernel density estimate uses a standard deviation of 0.03 for interaction similarities and 0.18 for MCSS RMSD. Reflected boundaries are used to reduce bias near the boundaries.</p>
        <p id="Par19">The distributions for MCSS RMSD were both capped at 6 Å to eliminate the effect of the sparse distribution for higher RMSDs. Any values greater than 6 Å were set to 6 Å.</p>
      </sec>
    </sec>
    <sec id="Sec12">
      <title>Open-ComBind pose prediction pipeline</title>
      <p id="Par20">
        <fig id="Fig1">
          <label>Fig. 1</label>
          <caption>
            <p>Open-ComBind pose prediction pipeline: the user provides a docking ligand, a <italic>holo</italic> receptor structure, and a defined binding pocket on the structure. The user can then define a set of helper ligands: molecules with <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;1\mu M$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn><mml:mi>μ</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq5.gif"/></alternatives></inline-formula> affinity to the receptor but not requiring any bound structure. A set of conformations is generated for the docking ligand and the helper ligands. <sc>gnina</sc> is used to dock the docking and helper ligands, outputs are sorted by CNNscore. The poses for each ligand are featurized and inter-pose similarities are calculated between all pairs of poses. Finally, the poses for the docking ligand as well as the helper ligands are selected using the Open-ComBind objective function which harnesses the pre-computed similiarity distributions</p>
          </caption>
          <graphic xlink:href="10822_2023_544_Fig1_HTML" id="MO1"/>
        </fig>
      </p>
      <p id="Par21">Open-ComBind provides a pipeline (Fig. <xref rid="Fig1" ref-type="fig">1</xref>) that prepares protein and ligand structures for docking, a suite of methods to compute the similarity of features from pairs of docked ligands, as well as predicting a set of poses utilizing pre-computed similarity distributions. Protein-ligand ground-truth complexes, usually determined via X-ray crystallography, are manipulated to extract separate protein and ligand structures after alignment of the pocket residues of similar protein structures. Ligands are prepared for docking by generating a set of low-energy 3D ligand conformations. Docking is run on a single receptor conformation with all of the generated conformers per ligand and the output for each ligand is sorted according to its docking score. Featurization of the top poses for each ligand includes their docking score and fingerprint of the protein-ligand interactions. Feature similarities are computed between all pairs of ligand poses, both inter- and intra-ligand pairs, utilizing the pose interaction fingerprints and the RMSD between the MCSS of the pose pair. We use the same protein and ligand pre-processing, conformation generation, docking, and featurization procedure as enumerated in “Derivation of similarity distributions” section. Finally, a pose is selected for each docked ligand by maximizing the sum of the similarity between the pose selected for each ligand and the pose’s docking score.</p>
      <p id="Par22">Poses are selected for the docking ligand and the set of helper ligands utilizing the inter-pose features in tandem with the pre-computed native and reference distributions. Adhering to the same procedure as [<xref ref-type="bibr" rid="CR18">18</xref>], we randomly initialize pose selections and randomly iterate through the ligands, picking a pose that maximizes the objective:<disp-formula id="Equ2"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}{} &amp; {} {\mathcal {L}}_{\text {Open-ComBind}} = -C\cdot \text {CNNscore}(\ell _i) \\{} &amp; {} \quad + \frac{1}{n-1}\sum \limits _{s\in {\mathcal {S}}}\sum \limits _{j\ne i}\log \frac{f(s(\ell _i,\ell _j)|\,\text {Native})}{f(s(\ell _i,\ell _j)|\,\text {Reference})} \end{aligned}$$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mtext>Open-ComBind</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>C</mml:mi><mml:mo>·</mml:mo><mml:mtext>CNNscore</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mrow/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mo>log</mml:mo><mml:mfrac><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>Native</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>Reference</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="10822_2023_544_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq6"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell _i$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq6.gif"/></alternatives></inline-formula> is the pose selected for the current ligand, <inline-formula id="IEq7"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}$$\end{document}</tex-math><mml:math id="M18"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq7.gif"/></alternatives></inline-formula> is our set of similarities, <inline-formula id="IEq8"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(s(\cdot ,\cdot )|\,\text {Native})$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>Native</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq8.gif"/></alternatives></inline-formula> and <inline-formula id="IEq9"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(s(\cdot ,\cdot )|\,\text {Reference})$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>Reference</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq9.gif"/></alternatives></inline-formula> refer to the pre-computed native and reference similarity distributions, respectively, and <italic>C</italic> is a hyperparameter to weight the CNNscore. We attempt to identify the set of selected poses that optimizes this objective function through a greedy iterative process. We continue iterating through the ligands, updating the selected pose, until no new poses are selected for any ligands. This procedure is run 500 times to increase the likelihood of finding the global minimum. The poses selected by the objective function for each ligand are returned.</p>
      <sec id="Sec13">
        <title>Selection of CNNscore weight</title>
        <p id="Par23">We select the hyperparameter, <italic>C</italic>, for the weight of the CNNscore (the pose score output by <sc>gnina</sc> [<xref ref-type="bibr" rid="CR26">26</xref>]) within the Open-ComBind score function in the same way as [<xref ref-type="bibr" rid="CR18">18</xref>]. The same cross-docked top 100 poses for each ligand used for computing the similarity statistics are pooled and sorted according to their CNNscore. For each consecutive cluster of 100 poses, we calculate the average CNNscore and the negative log-likelihood of those 100 poses being a correct pose (i.e. <inline-formula id="IEq10"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le 2$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq10.gif"/></alternatives></inline-formula>Å from the ground truth). A line is fit to the data and the slope is used as the weight for the CNNscore.</p>
      </sec>
    </sec>
    <sec id="Sec14">
      <title>Benchmark dataset evaluation</title>
      <p id="Par24">Cross-docking is the main focus of many docking studies as it most closely emulates docking experiments in drug discovery campaigns. We test the performance of Open-ComBind by performing cross-docking on the Benchmark Dataset. We utilize the protein and ligand pre-processing available in the Open-ComBind pipeline to prepare the ligands for cross-docking. A protein and ligand file are created for each complex of the Benchmark Dataset, however, binding site cofactors are manually added back to the protein, following ComBind’s preparation procedure for a fair comparison. Next, we create two sets of helper ligands for each ligand we are docking, as defined above: high-affinity binders and congeneric series. We then use the Open-ComBind Pose Prediction Pipeline (Fig. <xref rid="Fig1" ref-type="fig">1</xref>) on each ligand in which we are performing cross-docking with each set of helper ligands. When predicting poses for docking ligands of a given receptor, we omit that receptor’s docked ligand similarity statistics from the pre-computed similarity statistics used in the Open-ComBind objective function.</p>
      <p id="Par25">We run the evaluation, for each docking ligand, using five different random seeds to determine the variability of Open-ComBind given slightly different ligand poses. The random seed are used for the creation of the conformations of the docking ligand and helper ligands as well as the <sc>gnina</sc> docking procedure.</p>
    </sec>
    <sec id="Sec15">
      <title>Hypothesis evaluation</title>
      <p id="Par26">[<xref ref-type="bibr" rid="CR18">18</xref>] built ComBind on the hypothesis that distinct ligands bind to a receptor in similar ways. We aim to investigate whether this underlying hypothesis of the pipeline is correct by comparing the value of the Open-ComBind objective function for the lowest RMSD ligand poses to the value of the objective when selecting from all <sc>gnina</sc> generated poses. We only look at target proteins in the Benchmark dataset containing at least ten ligands with a <sc>gnina</sc> generated near-native pose. In the following experiment, we only use ligands with a defined ground truth pose (i.e. the set of docking ligands for each target receptor in the benchmark dataset) and only ligands that have a <sc>gnina</sc> generated pose &lt; 2Å RMSD from the ground truth. We first measure the value of the Open-ComBind objective function when we restrict our selection to the best <sc>gnina</sc> generated pose, according to lowest RMSD to the ground truth. We next evaluate the value of the Open-ComBind objective function when we select from all <sc>gnina</sc> generated poses of the ligands. If the underlying hypothesis of Open-ComBind is true, then the Open-ComBind objective function value when selecting from the best poses will be greater than or equal to the objective function value when selecting from all <sc>gnina</sc> generated poses. The Open-ComBind objective is optimized in a stochastic manner, so it is possible we will not converge on the globally optimal pose selections which is assumed to be the set of poses with the lowest RMSD to the ground truth.</p>
    </sec>
  </sec>
  <sec id="Sec16">
    <title>Results</title>
    <sec id="Sec17">
      <title>Similarity distributions</title>
      <p id="Par27">The pairwise feature similarity distributions are pivotal to the Open-ComBind objective function. Shifts from the reference to native distribution help to ensure the poses selected by the Open-ComBind objective are more likely to be pulled from the set of near-native poses. We calculate the pairwise feature similarity distributions by cross-docking all ligands in the Similarity Dataset using <sc>gnina</sc>. Then the top 100 poses of each ligand were analyzed for their interaction with the receptor structure used for docking. We see in Fig. <xref rid="Fig2" ref-type="fig">2</xref> that all of the intermolecular interactions: Hydrogen bonds, Salt Bridges, and Hydrophobic contacts have higher similarity in the native distribution than in the reference distribution. The hydrogen bonds reference distribution is heavily right-skewed, while the native distribution is centered around 0.43 with a Gaussian-like appearance. Salt Bridges are much less frequent interactions, therefore both the native and reference distributions are heavily focused on the points <inline-formula id="IEq11"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{3}$$\end{document}</tex-math><mml:math id="M26"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq11.gif"/></alternatives></inline-formula>, <inline-formula id="IEq12"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{2}$$\end{document}</tex-math><mml:math id="M28"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq12.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq13"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{2}{3}$$\end{document}</tex-math><mml:math id="M30"><mml:mfrac><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq13.gif"/></alternatives></inline-formula> indicating that most ligands only make a small number of salt bridges with the protein. The native distribution shift is not as pronounced in the salt bridge due to its infrequency; however, we still see an increase in the density centered around <inline-formula id="IEq14"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{2}{3}$$\end{document}</tex-math><mml:math id="M32"><mml:mfrac><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq14.gif"/></alternatives></inline-formula> and a slight decrease in the density around <inline-formula id="IEq15"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{3}$$\end{document}</tex-math><mml:math id="M34"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq15.gif"/></alternatives></inline-formula> Pseudo-Tanimoto similarity relative to the reference distribution. Hydrophobic contact similarity is left skewed in both the native and reference distributions. The native distribution has a mean of 0.83, while the reference distribution has a mean of 0.69. The RMSD of the MCSS shows the same trend as the intermolecular interactions, with the native poses being more similar than the similarity distribution of all poses. Due to the cutoff at 6 Å we see a spike in both distributions at 6 Å. The spike in the reference distribution far outweighs the left tail.<fig id="Fig2"><label>Fig. 2</label><caption><p>Pairwise similarities of different intra-molecular features and inter-pose similarities. The mean distribution across five seeds is plotted with the shading denoting the standard deviation</p></caption><graphic xlink:href="10822_2023_544_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par28">The hyperparameter <italic>C</italic> is set to 1 following the slopes of the best fit lines in Figure S1.</p>
    </sec>
    <sec id="Sec18">
      <title>Docking results</title>
      <p id="Par29">After defining our pairwise similarity distributions and the hyperparameter for the weight of the CNNscore, we can utilize the Open-ComBind framework to select poses from <sc>gnina</sc>’s sampled poses. Binders lacking structural information are used as helper ligands to select docked poses for our ligand of interest that interact with the receptor in similar ways to the helper ligands. Utilizing the pairwise similarity distributions shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref> along with the <sc>gnina</sc> docking scores enables selection of near-native poses more often than when only the <sc>gnina</sc> score is used to select a pose (Fig. <xref rid="Fig3" ref-type="fig">3</xref> and S2). Following [<xref ref-type="bibr" rid="CR18">18</xref>], we compute the “Overall" statistic, which is the weighted average of the different protein classes according to the proportion of FDA-approved drugs for that class of proteins. Open-ComBind increases the Overall percentage of ligands with a correct pose by 5% and 4.5% for high-affinity and congeneric series helper ligands, respectively. Nuclear receptors, GPCRs, and ion channels have the greatest increase in performance for high-affinity ligands over only the <sc>gnina</sc> docking score, 6.8%, 6.3%, and 4.7%, respectively (4.7%, 3.2%, and 12.7%, respectively for congeneric series ligands). However, in contrast to [<xref ref-type="bibr" rid="CR18">18</xref>], we find that many proteins show a reduced performance when utilizing the Open-ComBind framework relative to <sc>gnina</sc>. Additionally, for most of the proteins, we see large variances in Open-ComBind’s performance with different runs of <sc>gnina</sc>.<fig id="Fig3"><label>Fig. 3</label><caption><p>Average difference in percent of ligands whose pose is predicted correctly between <sc>gnina</sc>’s top scoring pose and the pose selected by Open-ComBind when high-affinity helper ligands are used. Error bars show the standard deviation across the five seeds. Performance with the congeneric series helper ligands is shown in Figure S2</p></caption><graphic xlink:href="10822_2023_544_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par30">When we compare our overall performance to that of [<xref ref-type="bibr" rid="CR18">18</xref>] in Fig. <xref rid="Fig4" ref-type="fig">4</xref> and S3, we see that our open-source version is slightly below the performance of ComBind. However, when comparing ComBind to Open-ComBind on each individual protein, we see a different story. ComBind tends to either increase or not change the percentage of ligands whose pose is predicted correctly across all of the proteins in the benchmark dataset. Open-ComBind has widely varying performance across different protein targets, with some protein targets seeing a major boost in performance for their docked ligands, like SMO and NR3C2 with a 100% and 50% increase, respectively. Other protein targets show a drastic decrease in the percentage of ligands whose pose is predicted correctly, for instance, MGLUR5 and NR3C1 with a 50% and 11% decrease, respectively. ComBind only has worse pose selection than Glide on one protein target when using high-affinity helper ligands, while Open-ComBind has worse pose selection than <sc>gnina</sc> on five protein targets across varying protein classes. This is all in spite of the fact that <sc>gnina</sc> and Glide demonstrate similar pose selection performance across a majority of the protein targets.<fig id="Fig4"><label>Fig. 4</label><caption><p>Comparing the docking performance of the best performing Open-ComBind seed and its associated <sc>gnina</sc> run to the performance of ComBind and Glide. Performance of ComBind and Glide scraped from [<xref ref-type="bibr" rid="CR18">18</xref>] using WebPlotDigitizer [<xref ref-type="bibr" rid="CR28">28</xref>]</p></caption><graphic xlink:href="10822_2023_544_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par31">The RMSD to ground truth of poses selected by <sc>gnina</sc> is higher than the RMSD of the poses selected by Open-ComBind for the exact same ligand (Figures S4 and S5), average RMSDs of 2.67 and 2.43 Å for <sc>gnina</sc> and Open-ComBind using high-affinity ligands, respectively. Across all of the random seeds, there is a reduction in the average RMSD of the ligands when using Open-ComBind. However, Open-ComBind does not always choose a lower or equivalent RMSD pose for each ligand. This could be due to the fact that some of the featurizations do not contribute to better pose selections.</p>
      <p id="Par32">The importance of Open-ComBind docking components to the pose selection is inspected by removing pieces from the full docking pipeline to see their impact on performance. We see from Figs. <xref rid="Fig5" ref-type="fig">5</xref> and S6 that removing the CNNscore from the pose selection process completely destroys Open-ComBind’s ability to select correct poses, dropping from 63.1 to 33.3% when using high-affinity helper ligands (62.5–38.8% when using congeneric series helper ligands). Removing individual features from Open-ComBind does not have as great an effect as removing the CNNscore, but can significantly impact Open-ComBind’s pose selection. The interaction fingerprint is pivotal to pose selection. Still, we see that only using the H-bonds (55.9%) or salt bridges (58.2%) gets about the same performance as <sc>gnina</sc>-only pose selection (58.1%). Using only Hydrophobic contacts in Open-ComBind is not significantly different (p = 0.20 and p = 0.29 for high-affinity and congeneric series helper ligands, respectively) from using all of the features. Removing the whole interaction fingerprint and only using the maximum common substructure RMSD between ligand poses slightly increases performance (63.3%, p = 0.44 and 64.6%, p = 0.11 for high-affinity and congeneric series helper ligands, respectively) but still shows improvements over <sc>gnina</sc> pose selection. Removing both the H-bonds and salt bridges from the Open-ComBind pose selection process gets about the same performance as when they are used (65.1%, p = 0.09 and 63.1%, p = 0.38 for high-affinity and congeneric series helper ligands, respectively), further demonstrating the inadequacy of H-Bond and salt bridges for pose selection improvements in Open-ComBind.<fig id="Fig5"><label>Fig. 5</label><caption><p>Removing components of Open-ComBind to determine their importance to the selection of docked poses when using the high-affinity helper ligands. ‘G’ indicates that <sc>gnina</sc> scores are used, ‘HB’,‘C’, and ‘SB’ indicate that hydrogen-bond, hydrophobic contact, and salt bridge similarity is used, respectively. ‘MCSS’ indicates that the RMSD between the MCSS of ligand poses is used and ‘Relax MCSS’ indicates a relaxed MCSS strategy was used where strict atom and bond typing were not enforced. ‘<inline-formula id="IEq16"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\cdot$$\end{document}</tex-math><mml:math id="M36"><mml:mo>·</mml:mo></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq16.gif"/></alternatives></inline-formula>’ indicates a p-value less than 0.05 while ‘<inline-formula id="IEq17"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$**$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq17.gif"/></alternatives></inline-formula>’ denotes a p-value less than 0.01 in comparison to standard Open-ComBind</p></caption><graphic xlink:href="10822_2023_544_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par33">Pose selection performance should be dependent on the number of helper ligands we use during pose selection. When no helper ligands are used during the pose selection process, we see that the percentage of ligands whose pose is predicted correctly drops (‘<sc>gnina</sc>(G)’ in Fig. <xref rid="Fig5" ref-type="fig">5</xref> and S6). However, we see in Figs. <xref rid="Fig6" ref-type="fig">6</xref> and S7 that performance plateaus as more helper ligands are added. The performance with ten helper ligands, (61.47% and 62.55% for high-affinity and congeneric series helper ligands, respectively) is about the same as using all 20 helper ligands (61.56% and 62.59% for high-affinity and congeneric series helper ligands, respectively).<fig id="Fig6"><label>Fig. 6</label><caption><p>Reducing the number of similar helper ligands used in the Open-ComBind pipeline decreases the number of docked ligands whose pose is predicted correctly. The line is the average and the shaded area is the standard deviation across 15 different subsamples of helper ligands for each number of helper ligands</p></caption><graphic xlink:href="10822_2023_544_Fig6_HTML" id="MO6"/></fig></p>
    </sec>
    <sec id="Sec19">
      <title>Hypothesis evaluation</title>
      <p id="Par34">The Open-ComBind objective function is formulated to encourage all the ligands being docked to assume similar interactions with the receptor. However, when we compare the Open-ComBind objective function value of the best <sc>gnina</sc> poses for each ligand to the optimal value when selecting from all <sc>gnina</sc> poses, we find that they are never the same when the full objective is used. (Fig. <xref rid="Fig7" ref-type="fig">7</xref>). The value of the objective function when only using the lowest RMSD to the ground truth pose found by <sc>gnina</sc> for each of the ligands being docked is less than selecting from all <sc>gnina</sc> poses, except when only the MCSS featurization is used. This implies that the underlying hypothesis of Open-ComBind is not necessarily true for these protein-ligand complexes during cross-docking. When we remove the hydrogen-bond and salt bridge interactions from the Open-ComBind objective function, the values from the two sets of poses come closer together. This is exacerbated when all interaction fingerprint features are removed from the Open-ComBind objective function and only RMSD of the MCSS is used and some proteins even have equal values of the objective function for both sets. The collection of poses identified by Open-ComBind is more similar in their interactions according to the objective function than the ensemble of lowest RMSD to ground truth poses. We additionally find that the Open-ComBind objective will not always select the native-pose when it is included in the list of poses to select from (Figure S8).<fig id="Fig7"><label>Fig. 7</label><caption><p>The difference of the Open-ComBind objective function when selecting from all <sc>gnina</sc> generated poses and the lowest RMSD to ground truth <sc>gnina</sc> pose. ‘G’ indicates that <sc>gnina</sc> scores are used, ‘HB’,‘C’, and ‘SB’ indicate that hydrogen-bond, hydrophobic contact, and salt bridge similarity is used, respectively. ‘MCSS’ indicates that the RMSD between the MCSS of ligand poses is used</p></caption><graphic xlink:href="10822_2023_544_Fig7_HTML" id="MO7"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec20">
    <title>Discussion</title>
    <sec id="Sec21">
      <title>Implementing an open-source ComBind alternative</title>
      <p id="Par35">Open-ComBind is an open-source alternative to ComBind, developed by [<xref ref-type="bibr" rid="CR18">18</xref>], that has comparable increases in pose prediction performance over the respective baseline docking method. Building out Open-ComBind took a concerted effort as the original pipeline uses opaque software tools with unspecified methods for pose generation and featurization of the docked poses. The feature distributions generated with only the poses of a single ligand conformation <sc>gnina</sc> docking run did not show more similarity in the native distribution than in the reference distributions. By comparing the inter-pose RMSD pose of both <sc>gnina</sc> and Glide, we found that Glide was much more likely to output a set of highly similar poses while <sc>gnina</sc> did not. Therefore, we were able to increase similarity of the native distributions by docking a set of ten ligand conformations and combining the docking runs of each conformation into one single set of poses which were sorted by CNNscore. This produces a list of 100 conformations that has a higher likelihood of being less than 2 Å RMSD from the ground truth and reduces the RMSD between better scoring poses.</p>
      <p id="Par36">Differences between <sc>gnina</sc>’s and Glide’s output poses required further development of the featurization pipeline as Glide produces poses with hydrogens placed to maximize hydrogen bonding and alters the tautomeric form of the ligand to form salt bridges with the protein. We overcame these differences by adding hydrogens with RDKit during featurization and detecting salt bridge forming moieties with SMARTS string patterns. Placing the hydrogens in this manner ignores the location of hydrogen bond-forming donors and acceptors on the receptor; this likely decreases the strength of the hydrogen bonds seen in Open-ComBind in comparison to ComBind. We see that the Hydrogen bond similarities do not add information over only utilizing the CNNscore in Figs. <xref rid="Fig5" ref-type="fig">5</xref> and S6, despite the fact that there are many hydrogen bonds detected in the benchmark dataset (Table S3). The usage of SMARTS string patterns for detection of salt bridges may also decrease the information provided by salt bridge similarity for increasing pose selection performance, but it is difficult to be sure as salt bridges are a rare occurrence in the benchmark dataset (Table S3).</p>
      <p id="Par37">The RMSD calculation between the MCSS of two ligand poses is the largest difference between Open-ComBind and ComBind. ComBind uses a MCSS strategy in which any two atoms can match in the graph regardless of atom type. We tested this relaxed MCSS strategy with Open-ComBind and found reduced performance (Figs. <xref rid="Fig5" ref-type="fig">5</xref> and S6). Therefore, our MCSS calculation enforces stringent atom type matching (excluding halogens which can all match each other). We additionally require that bond orders be identical for the bond to be included in the MCSS and that rings can only match other complete rings. These MCSS requirements enforce a stronger match between substructures of ligands and ensure that the scaffold of a congeneric series is placed in a similar location for all ligands.</p>
    </sec>
    <sec id="Sec22">
      <title>Open ComBind performance</title>
      <p id="Par38">The exact poses selected by Open-ComBind vary significantly when the generated, docked ligand poses are changed via different random seeds. However, on average Open-ComBind tends to improve pose selection in comparison to the <sc>gnina</sc> baseline. We see in Figs. <xref rid="Fig4" ref-type="fig">4</xref> and S3 that the standard deviation for a given protein is often much larger than its mean, indicating the results of Open-ComBind pose selection are highly dependent on the poses of the ligands. Altering the random seed affects the poses in the top scoring 100 used for the pose selection process, which can affect the consensus pose found for the docking ligand and helper ligands. We do see that the average RMSD decreases in comparison to the baseline docking method, <sc>gnina</sc>, regardless of the random seed used (Figures S4 and S5).</p>
      <p id="Par39">Hydrophobic contact similarity and MCSS RMSD are sufficient features to increase the pose prediction performance to that of the full Open-ComBind pipeline. This is likely due to the fact that hydrophobic contacts are the most common intramolecular interaction seen in the benchmark dataset by a factor of 6 (Table S3). Only utilizing these two features significantly decreases the computational cost of Open-ComBind. In fact, with congeneric series, we see (Figure S6) that only MCSS is required for the same performance as the full Open-ComBind pipeline. We expect congeneric series to have a much higher consistency in the placement of the MCSS because the MCSS is likely referring to the scaffold of the congeneric series. We also see that only 10 helper ligands are required to reach the pose prediction power of 20 helper ligands (Figs. <xref rid="Fig6" ref-type="fig">6</xref> and S7). Reducing the number of helper ligands will also decrease the computational cost of the docking pipeline as a similarity matrix must be constructed for each feature which is <inline-formula id="IEq18"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {O}}(N^2)$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq18.gif"/></alternatives></inline-formula> with the number of ligands used, <italic>N</italic>.</p>
      <p id="Par40">[<xref ref-type="bibr" rid="CR18">18</xref>] built the ComBind pose selection pipeline on the hypothesis that distinct ligands bind to the same receptor in similar ways. However, we show in Fig. <xref rid="Fig7" ref-type="fig">7</xref> that the Open-ComBind objective function does not always select ligand poses that are the lowest RMSD to the ground truth. All of the proteins tested show a lower full objective function value when evaluating on the lowest RMSD near-native poses sampled by <sc>gnina</sc> in comparison to the objective function value when selecting from all sampled poses. However, we do see that our inspection of the underlying hypothesis agrees with the ablation studies in that the usage of only the hydrophobic contacts similarity and RMSD of MCSS improves the objective function’s performance in selecting near-native poses. Further, we see that use of only the RMSD of MCSS is able to find poses with the same objective function value as the lowest RMSD to ground truth poses. This implies that the RMSD of MCSS featurization aligns well with the underlying hypothesis, while the other features do not. It is likely that the hydrogen bonds, salt bridges, and hydrophobic contacts of the lowest RMSD to ground truth poses do not show as great of a consensus due to side chain rearrangement during binding of different ligands. Therefore, allowing side chain rearrangement during docking would likely improve the performance of Open-ComBind pose selection.</p>
    </sec>
    <sec id="Sec23">
      <title>Future directions</title>
      <p id="Par41">Open-ComBind is an easy-to-use, open-source alternative to ComBind, although more work is needed to match the performance gains achieved by [<xref ref-type="bibr" rid="CR18">18</xref>]. Open-ComBind provides the molecular modeling community the opportunity to quickly and easily modify the featurization pipeline for increased pose prediction performance utilizing the large quantity of available, non-structural data. Features such as <inline-formula id="IEq19"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi -\pi$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mi>π</mml:mi><mml:mo>-</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq19.gif"/></alternatives></inline-formula> bonds and ligand shape similarity can be added easily to the docking pipeline. Since Open-ComBind uses <sc>gnina</sc> as the pose generator, we can utilize the internal representation of the CNN scoring functions within the docking pipeline as a featurization of the protein-ligand interaction for little extra computational cost. <sc>gnina</sc> also allows flexible sidechains during docking which could be used in the Open-ComBind framework for finding different pocket configurations to fit ligands of different sizes or ligands forming non-bonded interactions in different relative locations. Finally, Open-ComBind could be extended to predict the protonation state of the ligand to form better hydrogen bonds with the receptor and select better ligand poses than docking with the input protonation state.</p>
    </sec>
    <sec id="Sec24">
      <title>Ease to use API</title>
      <p id="Par42">Open-ComBind has been developed as a Python package with an accompanying command-line interface for running the entire pipeline. We provide the pre-processing, docking, featurization, and pose selection as easy-to-use Python modules or a single command on the command line. After installation of Open-ComBind and its pre-requisites from our github repository: <ext-link ext-link-type="uri" xlink:href="http://www.github.com/drewnutt/open_combind">www.github.com/drewnutt/open_combind</ext-link>, users can run the entire Open-ComBind pipeline with the command:<graphic position="anchor" xlink:href="10822_2023_544_Figa_HTML" id="MO8"/> where helper_ligands.csv is a comma-delimited file of the helper ligands SMILES strings and identifiers. The user must specify the location of the raw protein-ligand complex to use for docking. Other protein-ligand crystals can be placed in the same directory for pre-processing.</p>
      <p id="Par43">Additionally, we provide scripts and instructions for using the Open-ComBind pose prediction pipeline with other molecular docking tools. Use of molecular docking tools that directly consider hydrogen bonds and predict ligand hydrogen coordinates would likely improve the utility of the hydrogen bond similarity in enhancing pose prediction.</p>
    </sec>
  </sec>
  <sec id="Sec25">
    <title>Conclusion</title>
    <p id="Par44">In this work, we developed Open-ComBind, an open-source alternative to ComBind, to increase pose prediction performance over <sc>gnina</sc>. Open-ComBind reduces the average RMSD to ground truth from <sc>gnina</sc>’s 3.24 Å to 3.03 Å for all ligands. We utilize ligands lacking structural information as well as a distribution of ligand feature similarity of both native poses and all poses. Open-ComBind utilizes pairwise similarities between sets of ligand poses to determine the poses which maximize inter-ligand similarity of binding. We see pose selection improvement equal to the full pipeline when using only hydrophobic contact similarity and the RMSD between the MCSS of ligand pairs. Additionally, we observe that Open-ComBind only requires ten helper ligands to reach the pose prediction performance of using 20 helper ligands. We provide the Open-ComBind in an easy-to-use API as well as source code and data to use the Open-ComBind pipeline at our GitHub repo: <ext-link ext-link-type="uri" xlink:href="http://www.github.com/drewnutt/open_combind/">www.github.com/drewnutt/open_combind/</ext-link></p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec100">
      <title>Supplementary Information</title>
      <p>Below is the link to the electronic supplementary material.<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="10822_2023_544_MOESM1_ESM.pdf"><caption><p>Supplementary file1 (PDF 512 kb)</p></caption></media></supplementary-material></p>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank Jonathan King, Dakota Folmsbee, and Rishal Aggarwal for their comments during the preparation of the manuscript. The authors would like to thank Joseph M. Paggi for providing the structural data used for deriving the similarity statistics of ComBind. This work is supported by the R35GM140753 from the National Institute of General Medical Sciences and CHE-2102474 from the National Science Foundation.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>ATM designed and completed the computational study under the supervision of DRK. ATM and DRK wrote the paper.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Not applicable.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>Information for downloading the datasets are available at <ext-link ext-link-type="uri" xlink:href="http://www.github.com/drewnutt/open_combind/">www.github.com/drewnutt/open_combind/</ext-link>.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>Our pipeline is open source and available under a CC BY-NC-SA 3.0 license. The full Open-ComBind pipeline code, documentation, and evaluation scripts are available at <ext-link ext-link-type="uri" xlink:href="http://www.github.com/drewnutt/open_combind/">www.github.com/drewnutt/open_combind/</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1" notes-type="COI-statement">
      <title>Conflict of interest</title>
      <p id="Par45">The authors declare no competing interests.</p>
    </notes>
    <notes id="FPar2">
      <title>Ethics approval</title>
      <p id="Par46">Not applicable.</p>
    </notes>
    <notes id="FPar3">
      <title>Consent to participate</title>
      <p id="Par47">Not applicable.</p>
    </notes>
    <notes id="FPar4">
      <title>Consent for publication</title>
      <p id="Par48">Not applicable.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sliwoski</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Kothiwale</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Meiler</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lowe</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <article-title>Computational methods in drug discovery</article-title>
        <source>Pharmacol Rev</source>
        <year>2014</year>
        <volume>66</volume>
        <issue>1</issue>
        <fpage>334</fpage>
        <lpage>395</lpage>
        <pub-id pub-id-type="doi">10.1124/pr.112.007336</pub-id>
        <?supplied-pmid 24381236?>
        <pub-id pub-id-type="pmid">24381236</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Gubernator</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Böhm</surname>
            <given-names>H-J</given-names>
          </name>
          <name>
            <surname>Mannhold</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kubinyi</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Timmerman</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <source>Structure-based ligand design</source>
        <year>1998</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Wiley Online Library</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anderson</surname>
            <given-names>AC</given-names>
          </name>
        </person-group>
        <article-title>The process of structure-based drug design</article-title>
        <source>Chem Biol</source>
        <year>2003</year>
        <volume>10</volume>
        <issue>9</issue>
        <fpage>787</fpage>
        <lpage>797</lpage>
        <pub-id pub-id-type="doi">10.1016/j.chembiol.2003.09.002</pub-id>
        <?supplied-pmid 14522049?>
        <pub-id pub-id-type="pmid">14522049</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kitchen</surname>
            <given-names>DB</given-names>
          </name>
          <name>
            <surname>Decornez</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Furr</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Bajorath</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Docking and scoring in virtual screening for drug discovery: methods and applications</article-title>
        <source>Nat Rev Drug Discov</source>
        <year>2004</year>
        <volume>3</volume>
        <issue>11</issue>
        <fpage>935</fpage>
        <lpage>949</lpage>
        <pub-id pub-id-type="doi">10.1038/nrd1549</pub-id>
        <?supplied-pmid 15520816?>
        <pub-id pub-id-type="pmid">15520816</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trott</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Olson</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Autodock vina: improving the speed and accuracy of docking with a new scoring function, efficient optimization, and multithreading</article-title>
        <source>J Comput Chem</source>
        <year>2010</year>
        <volume>31</volume>
        <issue>2</issue>
        <fpage>455</fpage>
        <lpage>461</lpage>
        <pub-id pub-id-type="doi">10.1002/jcc.21334</pub-id>
        <?supplied-pmid 19499576?>
        <pub-id pub-id-type="pmid">19499576</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Friesner</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Banks</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Halgren</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Klicic</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Mainz</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Repasky</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Knoll</surname>
            <given-names>EH</given-names>
          </name>
          <name>
            <surname>Shelley</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Perry</surname>
            <given-names>JK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Glide: a new approach for rapid, accurate docking and scoring. 1. Method and assessment of docking accuracy</article-title>
        <source>J Med Chem</source>
        <year>2004</year>
        <volume>47</volume>
        <issue>7</issue>
        <fpage>1739</fpage>
        <lpage>1749</lpage>
        <pub-id pub-id-type="doi">10.1021/jm0306430</pub-id>
        <?supplied-pmid 15027865?>
        <pub-id pub-id-type="pmid">15027865</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Halgren</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Friesner</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Beard</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Frye</surname>
            <given-names>LL</given-names>
          </name>
          <name>
            <surname>Pollard</surname>
            <given-names>WT</given-names>
          </name>
          <name>
            <surname>Banks</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>Glide: a new approach for rapid, accurate docking and scoring. 2. Enrichment factors in database screening.</article-title>
        <source>J Med Chem</source>
        <year>2004</year>
        <volume>47</volume>
        <issue>7</issue>
        <fpage>1750</fpage>
        <lpage>1759</lpage>
        <pub-id pub-id-type="doi">10.1021/jm030644s</pub-id>
        <?supplied-pmid 15027866?>
        <pub-id pub-id-type="pmid">15027866</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McNutt</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Francoeur</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Aggarwal</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Masuda</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Meli</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ragoza</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sunseri</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Koes</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>Gnina 1.0: molecular docking with deep learning</article-title>
        <source>J Cheminform</source>
        <year>2021</year>
        <volume>13</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="doi">10.1186/s13321-021-00522-2</pub-id>
        <pub-id pub-id-type="pmid">33407901</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Corso G, Stärk H, Jing B, Barzilay R, Jaakkola, T (2023) Diffdock: diffusion steps, twists, and turns for molecular docking. In: International conference on learning representations (ICLR)</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vidal</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Garcia-Serna</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Mestres</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Ligand-based approaches to in silico pharmacology</article-title>
        <source>Chemoinform Comput Chem Biol</source>
        <year>2011</year>
        <pub-id pub-id-type="doi">10.1007/978-1-60761-839-3_19</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Banegas-Luna</surname>
            <given-names>A-J</given-names>
          </name>
          <name>
            <surname>Ceron-Carrasco</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Perez-Sanchez</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A review of ligand-based virtual screening web tools and screening algorithms in large molecular databases in the age of big data</article-title>
        <source>Future Med Chem</source>
        <year>2018</year>
        <volume>10</volume>
        <issue>22</issue>
        <fpage>2641</fpage>
        <lpage>2658</lpage>
        <pub-id pub-id-type="doi">10.4155/fmc-2018-0076</pub-id>
        <?supplied-pmid 30499744?>
        <pub-id pub-id-type="pmid">30499744</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grimm</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Bu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Xiao</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Ligmate: a multifeature integration algorithm for ligand-similarity-based virtual screening</article-title>
        <source>J Chem Inf Model</source>
        <year>2020</year>
        <volume>60</volume>
        <issue>12</issue>
        <fpage>6044</fpage>
        <lpage>6053</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.9b01210</pub-id>
        <?supplied-pmid 33190499?>
        <pub-id pub-id-type="pmid">33190499</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Broccatelli</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Best of both worlds: on the complementarity of ligand-based and structure-based virtual screening</article-title>
        <source>J Chem Inf Model</source>
        <year>2014</year>
        <volume>54</volume>
        <issue>6</issue>
        <fpage>1634</fpage>
        <lpage>1641</lpage>
        <pub-id pub-id-type="doi">10.1021/ci5001604</pub-id>
        <?supplied-pmid 24877883?>
        <pub-id pub-id-type="pmid">24877883</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kumar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>KY</given-names>
          </name>
        </person-group>
        <article-title>A cross docking pipeline for improving pose prediction and virtual screening performance</article-title>
        <source>J Comput Aided Mol Des</source>
        <year>2018</year>
        <volume>32</volume>
        <fpage>163</fpage>
        <lpage>173</lpage>
        <pub-id pub-id-type="doi">10.1007/s10822-017-0048-z</pub-id>
        <?supplied-pmid 28836076?>
        <pub-id pub-id-type="pmid">28836076</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Enhance the performance of current scoring functions with the aid of 3d protein-ligand interaction fingerprints</article-title>
        <source>BMC Bioinform</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.1186/s12859-017-1750-5</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lam</surname>
            <given-names>PC-H</given-names>
          </name>
          <name>
            <surname>Abagyan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Totrov</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Ligand-biased ensemble receptor docking (LigBEnD): a hybrid ligand/receptor structure-based approach</article-title>
        <source>J Comput Aided Mol Des</source>
        <year>2018</year>
        <volume>32</volume>
        <fpage>187</fpage>
        <lpage>198</lpage>
        <pub-id pub-id-type="doi">10.1007/s10822-017-0058-x</pub-id>
        <?supplied-pmid 28887659?>
        <pub-id pub-id-type="pmid">28887659</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>S-Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Hybriddock: a hybrid protein-ligand docking protocol integrating protein-and ligand-based approaches</article-title>
        <source>J Chem Inf Model</source>
        <year>2016</year>
        <volume>56</volume>
        <issue>6</issue>
        <fpage>1078</fpage>
        <lpage>1087</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.5b00275</pub-id>
        <?supplied-pmid 26317502?>
        <pub-id pub-id-type="pmid">26317502</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paggi</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Belk</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Hollingsworth</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Villanueva</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Powers</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Chemparathy</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Tynan</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Lau</surname>
            <given-names>TK</given-names>
          </name>
          <name>
            <surname>Sunahara</surname>
            <given-names>RK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Leveraging nonstructural data to predict structures and affinities of protein-ligand complexes</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2021</year>
        <volume>118</volume>
        <issue>51</issue>
        <fpage>2112621118</fpage>
        <pub-id pub-id-type="doi">10.1073/pnas.2112621118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bakan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Meireles</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Bahar</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Prody: protein dynamics inferred from theory and experiments</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>11</issue>
        <fpage>1575</fpage>
        <lpage>1577</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr168</pub-id>
        <?supplied-pmid 21471012?>
        <pub-id pub-id-type="pmid">21471012</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Krieger</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kaya</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kaynak</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Mikulska-Ruminska</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Doruker</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bahar</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Prody 2.0: increased scale and scope after 10 years of protein dynamics modelling with python</article-title>
        <source>Bioinformatics</source>
        <year>2021</year>
        <volume>37</volume>
        <issue>20</issue>
        <fpage>3657</fpage>
        <lpage>3659</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btab187</pub-id>
        <?supplied-pmid 33822884?>
        <pub-id pub-id-type="pmid">33822884</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berman</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>Westbrook</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Gilliland</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Bhat</surname>
            <given-names>TN</given-names>
          </name>
          <name>
            <surname>Weissig</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Shindyalov</surname>
            <given-names>IN</given-names>
          </name>
          <name>
            <surname>Bourne</surname>
            <given-names>PE</given-names>
          </name>
        </person-group>
        <article-title>The protein data bank</article-title>
        <source>Nucleic Acids Res</source>
        <year>2000</year>
        <volume>28</volume>
        <issue>1</issue>
        <fpage>235</fpage>
        <lpage>242</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/28.1.235</pub-id>
        <?supplied-pmid 10592235?>
        <pub-id pub-id-type="pmid">10592235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Burley</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Bhikadiya</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bittrich</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Craig</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Crichlow</surname>
            <given-names>GV</given-names>
          </name>
          <name>
            <surname>Dalenberg</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Duarte</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RCSB protein data bank (rcsb.org): delivery of experimentally-determined PDB structures alongside one million computed structure models of proteins from artificial intelligence/machine learning</article-title>
        <source>Nucleic Acids Res</source>
        <year>2023</year>
        <volume>51</volume>
        <issue>D1</issue>
        <fpage>488</fpage>
        <lpage>508</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkac1077</pub-id>
        <pub-id pub-id-type="pmid">36583345</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Schrödinger, LLC: the PyMOL molecular graphics system, version 1.8 (2015)</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Riniker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Landrum</surname>
            <given-names>GA</given-names>
          </name>
        </person-group>
        <article-title>Better informed distance geometry: using what we know to improve conformation generation</article-title>
        <source>J Chem Inf Model</source>
        <year>2015</year>
        <volume>55</volume>
        <issue>12</issue>
        <fpage>2562</fpage>
        <lpage>2574</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.5b00654</pub-id>
        <?supplied-pmid 26575315?>
        <pub-id pub-id-type="pmid">26575315</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Witek</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Landrum</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Riniker</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Improving conformer generation for small rings and macrocycles based on distance geometry and experimental torsional-angle preferences</article-title>
        <source>J Chem Inf Model</source>
        <year>2020</year>
        <volume>60</volume>
        <issue>4</issue>
        <fpage>2044</fpage>
        <lpage>2058</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.0c00025</pub-id>
        <?supplied-pmid 32155061?>
        <pub-id pub-id-type="pmid">32155061</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Francoeur</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Masuda</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sunseri</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jia</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Iovanisci</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Koes</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>Three-dimensional convolutional neural networks and a cross-docked data set for structure-based drug design</article-title>
        <source>J Chem Inf Model</source>
        <year>2020</year>
        <volume>60</volume>
        <issue>9</issue>
        <fpage>4200</fpage>
        <lpage>4215</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.0c00411</pub-id>
        <?supplied-pmid 32865404?>
        <pub-id pub-id-type="pmid">32865404</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sunseri</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Koes</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>Pharmit: interactive exploration of chemical space</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <issue>W1</issue>
        <fpage>442</fpage>
        <lpage>448</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw287</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Rohatgi A (2022) Webplotdigitizer: version 4.6. <ext-link ext-link-type="uri" xlink:href="https://automeris.io/WebPlotDigitizer">https://automeris.io/WebPlotDigitizer</ext-link></mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Comput Aided Mol Des</journal-id>
    <journal-id journal-id-type="iso-abbrev">J Comput Aided Mol Des</journal-id>
    <journal-title-group>
      <journal-title>Journal of Computer-Aided Molecular Design</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0920-654X</issn>
    <issn pub-type="epub">1573-4951</issn>
    <publisher>
      <publisher-name>Springer International Publishing</publisher-name>
      <publisher-loc>Cham</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10703974</article-id>
    <article-id pub-id-type="pmid">38062207</article-id>
    <article-id pub-id-type="publisher-id">544</article-id>
    <article-id pub-id-type="doi">10.1007/s10822-023-00544-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Open-ComBind: harnessing unlabeled data for improved binding pose prediction</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>McNutt</surname>
          <given-names>Andrew T.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Koes</surname>
          <given-names>David Ryan</given-names>
        </name>
        <address>
          <email>dkoes@pitt.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/01an3r305</institution-id><institution-id institution-id-type="GRID">grid.21925.3d</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 9000</institution-id><institution>Department of Computational and Systems Biology, </institution><institution>University of Pittsburgh, </institution></institution-wrap>Pittsburgh, PA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <year>2024</year>
    </pub-date>
    <volume>38</volume>
    <issue>1</issue>
    <elocation-id>3</elocation-id>
    <history>
      <date date-type="received">
        <day>6</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>11</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Determination of the bound pose of a ligand is a critical first step in many in silico drug discovery tasks. Molecular docking is the main tool for the prediction of non-covalent binding of a protein and ligand system. Molecular docking pipelines often only utilize the information of one ligand binding to the protein despite the commonly held hypothesis that different ligands share binding interactions when bound to the same receptor. Here we describe Open-ComBind, an easy-to-use, open-source version of the ComBind molecular docking pipeline that leverages information from multiple ligands without known bound structures to enhance pose selection. We first create distributions of feature similarities between ligand pose pairs, comparing near-native poses with all sampled docked poses. These distributions capture the likelihood of observing similar features, such as hydrogen bonds or hydrophobic contacts, in different pose configurations. These similarity distributions are then combined with a per-ligand docking score to enhance overall pose selection by 5% and 4.5% for high-affinity and congeneric series helper ligands, respectively. Open-ComBind reduces the average RMSD of ligands in our benchmark dataset by 9.0%. We provide Open-ComBind as an easy-to-use command line and Python API to increase pose prediction performance at <ext-link ext-link-type="uri" xlink:href="http://www.github.com/drewnutt/open_combind">www.github.com/drewnutt/open_combind</ext-link>.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1007/s10822-023-00544-y.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Molecular docking</kwd>
      <kwd>Machine learning</kwd>
      <kwd>Structure-based drug design</kwd>
      <kwd>Open-source</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id>
            <institution>National Institute of General Medical Sciences</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R35GM140753</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>CHE-2102474</award-id>
        <award-id>CHE-2102474</award-id>
        <principal-award-recipient>
          <name>
            <surname>McNutt</surname>
            <given-names>Andrew T.</given-names>
          </name>
          <name>
            <surname>Koes</surname>
            <given-names>David Ryan</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature Switzerland AG 2024</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par2">Drug discovery is a complex, multifaceted process involving the identification of small molecules capable of interacting with specific biological targets to produce a therapeutic effect. Computer-aided drug design (CADD) tools allow for the reduction of the enormous complexity and cost of the traditional drug discovery pipeline [<xref ref-type="bibr" rid="CR1">1</xref>]. CADD can be broadly divided into two main techniques: structure-based and ligand-based. Structure-based drug design (SBDD) uses the knowledge of the three-dimensional structure of a target protein to guide the selection of molecules that can bind with high affinity and selectivity [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>].</p>
    <p id="Par3">Molecular docking is a vital tool in the SBDD toolbox that predicts the non-covalent binding of two molecules in three-dimensional space. Knowledge of the ligand binding pose is critical for many downstream drug discovery tasks, such as lead optimization, affinity prediction, and virtual screening. Typical molecular docking algorithms either utilize energetics of interactions or the statistics of known binding interactions to predict the relative placement of the molecules [<xref ref-type="bibr" rid="CR4">4</xref>]. Conventional docking algorithms, such as Autodock Vina [<xref ref-type="bibr" rid="CR5">5</xref>] or Glide [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>], and even deep learning-based docking algorithms, like <sc>gnina</sc> [<xref ref-type="bibr" rid="CR8">8</xref>]or DiffDock [<xref ref-type="bibr" rid="CR9">9</xref>], predict the binding of every ligand separately even when multiple ligands are docked to the same receptor structure. Many drug targets are unsuitable for molecular docking due to a lack of suitable crystal structures (i.e. large ligand volume difference with cognate ligand or no available <italic>holo</italic> crystal structures). In these cases, alternative approaches must be employed.</p>
    <p id="Par4">One such approach is ligand-based drug design (LBDD), which relies on the analysis of known active compounds rather than the target protein itself. LBDD typically involves comparing the chemical features of known actives to those of putative inactives in order to identify pharmacophores - sets of chemical properties necessary for activity against a target [<xref ref-type="bibr" rid="CR10">10</xref>]. These pharmacophores can be one, two, or three-dimensional, providing an understanding of active molecule properties or shape [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. The generated pharmacophores are used to screen large libraries of compounds to find drug-like molecules with similar properties. LBDD allows for fast screening of incredibly large molecule libraries. Still, its reliance on empirical observations means it can struggle to capture subtle differences between closely related analogs. The results may not always generalize to a new series of compounds.</p>
    <p id="Par5">There have been several recent works that integrate LBDD with molecular docking to improve predictive performance. [<xref ref-type="bibr" rid="CR13">13</xref>] and [<xref ref-type="bibr" rid="CR14">14</xref>] utilize LBDD techniques to determine protein conformations that will increase docking performance with a given drug molecule. [<xref ref-type="bibr" rid="CR15">15</xref>] use protein-ligand interaction fingerprints to increase the scoring power of standard molecular docking scoring functions. [<xref ref-type="bibr" rid="CR16">16</xref>] and [<xref ref-type="bibr" rid="CR17">17</xref>] harness knowledge of known bound poses to guide the molecular docking of novel ligands binding to the same receptor. These methods are able to reduce the sampling space of the ligands during docking by using known bound ligand poses as a bias to their sampling procedure. [<xref ref-type="bibr" rid="CR18">18</xref>] integrated structure-based docking from Glide, a commercial docking software, [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>] and 3D ligand similarities to increase pose prediction performance with their docking pipeline ComBind. Their work allows the use of abundant information on known active molecules that have no known bound structure to improve pose selection. Using Glide to dock a diverse protein-ligand benchmark set, they derive two distributions describing the pairwise pose similarity of poses near the ground truth and the pairwise pose similarity of all docked poses with respect to features such as hydrogen bonds or hydrophobic contacts. During the pose selection procedure, the feature distributions are converted to energy-like terms using the log ratio of the near-native similarity distribution to the all-pose similarity distribution. These likelihood terms are used in combination with Glide’s pose score to select a pose for a query ligand as well as for a set of ligands known to bind to the same receptor that do not require resolved structures. Their pipeline showed increased pose selection performance over only using Glide’s pose score, however, their pipeline utilized closed-source, licensed tools for pose generation and featurization, limiting its adoption by the molecular modeling community.</p>
    <p id="Par6">Here we present an easy-to-use, open-source alternative to ComBind that we call Open-ComBind. The open-source, deep learning-based molecular docking software <sc>gnina</sc> is used to generate high quality ligand poses, and open-source tools like ProDy [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>] and RDKit are used to featurize the docked compounds. Using a likelihood framework identical to ComBind, we utilize a set of helper ligands without known structural information to improve the pose quality of our docked ligand. The pose selection procedure strikes a balance between the individual pose scores assigned by the per-ligand deep learning scoring functions and the similarities and differences between the poses of various ligands. As a result, Open-ComBind produces a set of optimized poses for all ligands simultaneously, without requiring a shared ligand scaffold or knowledge of any ligand’s binding pose.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <p id="Par7">Here, we detail the dataset used in the creation of the docking pipeline as well as the dataset employed for evaluation of our pipeline. We describe the creation of inter-pose similarity statistics by performing cross-docking on a diverse protein-ligand benchmark dataset. The Open-ComBind docking pipeline is described, harnessing the similarity statistics to performing pose selection on a ligand of interest, the ‘docking ligand’, using a set of ligands with unknown bound structures, the ‘helper ligands’. Finally, an experiment to determine the validity of Open-ComBind’s underlying hypothesis: ‘distinct ligands bind to a receptor in similar ways’.</p>
    <sec id="Sec3">
      <title>Data</title>
      <sec id="Sec4">
        <title>Similarity dataset</title>
        <p id="Par8">Following [<xref ref-type="bibr" rid="CR18">18</xref>], a list of 30 target proteins (Table S1) representative of all major families of drug targets is used to generate the pairwise pose feature similarity distributions. The entire benchmark dataset of 421 protein-ligand pairs is used to generate the similarity statistics.</p>
      </sec>
      <sec id="Sec5">
        <title>Benchmark dataset</title>
        <p id="Par9">Generating the dataset used for evaluating pose prediction pipelines necessitates removal of easy-to-dock ligands. Following [<xref ref-type="bibr" rid="CR18">18</xref>], we filter the Similarity Dataset to remove any ligand that has greater than 50% of its atoms in the maximum common substructure computed with the cognate ligand of the receptor structure used for docking. If a new ligand shares most of the same structure as the cognate ligand then its probable the pocket has an appropriate configuration to bind the similar ligand. This reduces the set to 245 protein-ligand complexes for determining the performance of a pose prediction pipeline. These ligands are used as the ‘docking ligand’ during the evaluation of the pipeline.</p>
      </sec>
      <sec id="Sec6">
        <title>Helper ligands</title>
        <p id="Par10">Helper ligands are a set of ligands known to bind to the receptor of interest with <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;1\mu M$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn><mml:mi>μ</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq1.gif"/></alternatives></inline-formula> affinity, but may not have a solved bound structure. These ligands are used along with the ‘docking ligand’ in the Open-ComBind pipeline to improve pose selection of both the ‘docking ligand’ and the ‘helper ligands.’</p>
        <p id="Par11">We utilize the same two sets of helper ligands as in [<xref ref-type="bibr" rid="CR18">18</xref>]: one in which the helper ligands do not share a scaffold with the docking ligand, termed ‘High-affinity helper ligands’, and the other in which the ligands have the largest Maximum Common Substructure (MCSS) with the docking ligand, termed ‘Congeneric series helper ligands’. We use the MCSS definition from [<xref ref-type="bibr" rid="CR18">18</xref>] to ensure we are using the same set of helper ligands.</p>
      </sec>
    </sec>
    <sec id="Sec7">
      <title>Derivation of similarity distributions</title>
      <p id="Par12">Here we detail the development of pairwise similarity distributions for near-native poses and all docked poses using the Similarity Dataset.</p>
      <sec id="Sec8">
        <title>Protein and ligand pre-processing</title>
        <p id="Par13">Protein and ligand pre-processing separates the protein and ligand into separate docking-ready structures. Initially, a set of co-crystallized protein-ligand structures for each receptor in the Similarity Dataset is downloaded from RCSB.org [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>]. The ligand of interest in each co-crystallized structure is then designated based on its residue name. Using ProDy [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>], separate files are generated for the protein, ligand, waters, and other heteroatoms that are present in the original crystal structure. The instance coordinates of the ligand structure are downloaded directly from RCSB.org [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>] using their File Download Service to ensure proper coordinate and bond information. Using only the protein and ligand complex, we align all structures of a receptor based on the residues closest to the binding pocket. Protein residues within 15 Å of the ligand are used to align each receptor structure with PyMol [<xref ref-type="bibr" rid="CR23">23</xref>] to the alphabetically lowest PDB ID (PDB IDs specified in Table S1). The co-crystallized ligand’s coordinates are transformed according to the receptor alignment object. The aligned ligand and receptor are then separated into their own files to provide a ground-truth ligand and a <italic>holo</italic> structure for cross-docking with non-cognate ligands. After removal of the ligand, missing residues, atoms, and hydrogens are added (at a pH of 7.0) to the receptor structures using PDBFixer and minimized, ensuring interactions are detected properly after docking. Missing atoms and hydrogens are minimized using the default OpenMM forcefield. Finally, a <sc>gnina</sc> docking command template is created for each protein. The <sc>gnina</sc> docking command template specifies the docking protein structure (i.e. the aligned-to receptor structure) as well as the binding box location, defined by the cognate ligand of the docking receptor.</p>
        <p id="Par14">Docking with <sc>gnina</sc> requires knowledge of the 3D structure of the ligands to be docked. Conformations are generated for ligands using Experimental-Torsion with basic Knowledge Distance Geometry (ETKDG) [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR25">25</xref>] to yield likely conformations of the ligand based on trends seen in crystal conformations. Using RDKit, we generate 50 conformations, and use the Universal Force Field (UFF) to minimize and report the energy of each generated conformation. Combining the ten lowest energy conformations into a single file for each ligand. A set of low-energy conformations gives a higher likelihood that one of the conformations is close to the ground-truth ligand conformation. Additionally, <sc>gnina</sc> docking keeps rigid bond angles and lengths, so using multiple conformations of a ligand during docking allows for exploration of different bond angles and lengths.</p>
      </sec>
      <sec id="Sec9">
        <title>Cross-docking</title>
        <p id="Par15">After both ligand and protein preparation, cross-docking is performed with <sc>gnina</sc>. All of the ligands are docked against the receptor structure used for the alignment, the alphabetically lowest PDB ID (Table S1). The receptor’s cognate ligand identifies the binding site. Docking is performed using all default parameters, except for exhaustiveness, min_rmsd_filter, and num_modes (Table S2). exhaustiveness is increased to 16 to perform more sampling of the ligand during docking. min_rmsd_filter is reduced to 0.01 to allow highly similar, high-scoring poses to be output. num_modes is set to 30 to ensure we have a max number of 300 total poses for each ligand if we have ten starting conformations for each ligand. Following the docked pose statistics of [<xref ref-type="bibr" rid="CR18">18</xref>], which have up to 300 poses per docked ligand, we attempt to sample 300 docked poses per ligand complex. Additionally, <sc>gnina</sc> tends to produce distinct poses in comparison to Glide which tends to output highly similar poses, often leading to generating several near-native poses. Therefore, we utilize several ligand conformations during docking to increase the likelihood that <sc>gnina</sc> outputs more than one pose close to the native state. After docking, we re-sort the combined output poses from <sc>gnina</sc> for each ligand according to the ‘CNNscore’, a score in the range [0,1] denoting the likelihood a ligand pose is correct [<xref ref-type="bibr" rid="CR26">26</xref>]. Following [<xref ref-type="bibr" rid="CR18">18</xref>] and to reduce computation, only the top 100 docked poses of each ligand are used for subsequent steps.</p>
      </sec>
      <sec id="Sec10">
        <title>Featurization</title>
        <p id="Par16">The top 100 docked poses of each ligand are investigated for their interactions with the receptor and their distance from the ground truth, if available. Each pose has associated docking scores from both Autodock Vina and the Convolutional Neural Network (CNN) scoring functions in <sc>gnina</sc>. Additionally, the interaction fingerprint of each docked pose is computed. The interaction fingerprint profiles and scores the hydrogen bonds, salt bridges, and hydrophobic contacts between the protein and ligand. Hydrogen bond scores are a product of the distance between the donor and the acceptor’s hydrogen and the angle between the donor, hydrogen, and acceptor. However, since <sc>gnina</sc> ignores hydrogens in both the input and output, we add hydrogens to the docked poses with RDKit and minimize the hydrogen atom placement with UFF, ignoring the effect of the protein environment. Both the salt bridge and hydrophobic contact scores are simply the distance between the involved atoms. Unique to Open-ComBind, salt bridges are determined via ligand substructure matches to SMARTS strings, taken from Pharmit [<xref ref-type="bibr" rid="CR27">27</xref>], for the detection of positive and negative ions rather than using atoms with a formal charge since <sc>gnina</sc> does not modify the formal charge of the input molecule based on the receptor environment. These scores are summed by protein residue for each feature type.</p>
        <p id="Par17">Following the featurization of individual poses, we can calculate the similarity of pairs of poses based on their features. A pseudo-Tanimoto Similarity is used for the similarity of hydrogen bonds, salt bridges, and hydrophobic contacts. Since the features are not bit vectors, the Tanimoto Similarity between pose <italic>i</italic> and <italic>j</italic> is calculated as follows:<disp-formula id="Equ1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \mathrm {psuedo-}TS_{ij} = \frac{1+\sum \limits _{r\in {\mathcal {P}}} \sqrt{f^r_i} \sqrt{f^r_j}}{2 + \sum f_i + \sum f_j + \sum \limits _{r\in {\mathcal {P}}} \sqrt{f^r_i} \sqrt{f^r_j}} \end{aligned}$$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">psuedo</mml:mi><mml:mo>-</mml:mo></mml:mrow><mml:mi>T</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:munder><mml:msqrt><mml:msubsup><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi></mml:msubsup></mml:msqrt><mml:msqrt><mml:msubsup><mml:mi>f</mml:mi><mml:mi>j</mml:mi><mml:mi>r</mml:mi></mml:msubsup></mml:msqrt></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mo>∑</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo>∑</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:munder><mml:msqrt><mml:msubsup><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi></mml:msubsup></mml:msqrt><mml:msqrt><mml:msubsup><mml:mi>f</mml:mi><mml:mi>j</mml:mi><mml:mi>r</mml:mi></mml:msubsup></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="10822_2023_544_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <italic>f</italic> is one of the features and <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {P}}$$\end{document}</tex-math><mml:math id="M6"><mml:mi mathvariant="script">P</mml:mi></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq2.gif"/></alternatives></inline-formula> are all of the residues of the docking protein. An additional inter-pose feature is calculated via the RMSD between the MCSS of the two poses. We utilize a set of MCSS parameters that find a substructure with both matching atom IDs and bond orders. However, halogen atoms are allowed to match any other halogen atoms and rings are constrained to only match other, complete rings. We do not consider the MCSS if the number of heavy atoms in the MCSS is less than half the number of heavy atoms in the smallest ligand.</p>
      </sec>
      <sec id="Sec11">
        <title>Generating similarity statistics</title>
        <p id="Par18">Given our inter-pose features, we can now compute the extent to which ligands binding to the same receptor do so in a similar manner. We first define the ‘native distribution’, which looks at the inter-pose similarity between only poses with &lt; 2Å RMSD from the ground truth, denoted as <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(s(\cdot ,\cdot )|\,\text {Native})$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>Native</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq3.gif"/></alternatives></inline-formula>. We next define the ‘reference distribution’ to be the inter-pose similarity between all pairs of the top 100 poses output by <sc>gnina</sc>, denoted as <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(s(\cdot ,\cdot )|\,\text {Reference})$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>Reference</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq4.gif"/></alternatives></inline-formula>. Both distributions are determined via a Gaussian kernel density estimate on each of the inter-pose features. Following [<xref ref-type="bibr" rid="CR18">18</xref>], the Gaussian kernel density estimate uses a standard deviation of 0.03 for interaction similarities and 0.18 for MCSS RMSD. Reflected boundaries are used to reduce bias near the boundaries.</p>
        <p id="Par19">The distributions for MCSS RMSD were both capped at 6 Å to eliminate the effect of the sparse distribution for higher RMSDs. Any values greater than 6 Å were set to 6 Å.</p>
      </sec>
    </sec>
    <sec id="Sec12">
      <title>Open-ComBind pose prediction pipeline</title>
      <p id="Par20">
        <fig id="Fig1">
          <label>Fig. 1</label>
          <caption>
            <p>Open-ComBind pose prediction pipeline: the user provides a docking ligand, a <italic>holo</italic> receptor structure, and a defined binding pocket on the structure. The user can then define a set of helper ligands: molecules with <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;1\mu M$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn><mml:mi>μ</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq5.gif"/></alternatives></inline-formula> affinity to the receptor but not requiring any bound structure. A set of conformations is generated for the docking ligand and the helper ligands. <sc>gnina</sc> is used to dock the docking and helper ligands, outputs are sorted by CNNscore. The poses for each ligand are featurized and inter-pose similarities are calculated between all pairs of poses. Finally, the poses for the docking ligand as well as the helper ligands are selected using the Open-ComBind objective function which harnesses the pre-computed similiarity distributions</p>
          </caption>
          <graphic xlink:href="10822_2023_544_Fig1_HTML" id="MO1"/>
        </fig>
      </p>
      <p id="Par21">Open-ComBind provides a pipeline (Fig. <xref rid="Fig1" ref-type="fig">1</xref>) that prepares protein and ligand structures for docking, a suite of methods to compute the similarity of features from pairs of docked ligands, as well as predicting a set of poses utilizing pre-computed similarity distributions. Protein-ligand ground-truth complexes, usually determined via X-ray crystallography, are manipulated to extract separate protein and ligand structures after alignment of the pocket residues of similar protein structures. Ligands are prepared for docking by generating a set of low-energy 3D ligand conformations. Docking is run on a single receptor conformation with all of the generated conformers per ligand and the output for each ligand is sorted according to its docking score. Featurization of the top poses for each ligand includes their docking score and fingerprint of the protein-ligand interactions. Feature similarities are computed between all pairs of ligand poses, both inter- and intra-ligand pairs, utilizing the pose interaction fingerprints and the RMSD between the MCSS of the pose pair. We use the same protein and ligand pre-processing, conformation generation, docking, and featurization procedure as enumerated in “Derivation of similarity distributions” section. Finally, a pose is selected for each docked ligand by maximizing the sum of the similarity between the pose selected for each ligand and the pose’s docking score.</p>
      <p id="Par22">Poses are selected for the docking ligand and the set of helper ligands utilizing the inter-pose features in tandem with the pre-computed native and reference distributions. Adhering to the same procedure as [<xref ref-type="bibr" rid="CR18">18</xref>], we randomly initialize pose selections and randomly iterate through the ligands, picking a pose that maximizes the objective:<disp-formula id="Equ2"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}{} &amp; {} {\mathcal {L}}_{\text {Open-ComBind}} = -C\cdot \text {CNNscore}(\ell _i) \\{} &amp; {} \quad + \frac{1}{n-1}\sum \limits _{s\in {\mathcal {S}}}\sum \limits _{j\ne i}\log \frac{f(s(\ell _i,\ell _j)|\,\text {Native})}{f(s(\ell _i,\ell _j)|\,\text {Reference})} \end{aligned}$$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mtext>Open-ComBind</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>C</mml:mi><mml:mo>·</mml:mo><mml:mtext>CNNscore</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mrow/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mo>log</mml:mo><mml:mfrac><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>Native</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>Reference</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="10822_2023_544_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq6"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell _i$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq6.gif"/></alternatives></inline-formula> is the pose selected for the current ligand, <inline-formula id="IEq7"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {S}}$$\end{document}</tex-math><mml:math id="M18"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq7.gif"/></alternatives></inline-formula> is our set of similarities, <inline-formula id="IEq8"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(s(\cdot ,\cdot )|\,\text {Native})$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>Native</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq8.gif"/></alternatives></inline-formula> and <inline-formula id="IEq9"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(s(\cdot ,\cdot )|\,\text {Reference})$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>Reference</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq9.gif"/></alternatives></inline-formula> refer to the pre-computed native and reference similarity distributions, respectively, and <italic>C</italic> is a hyperparameter to weight the CNNscore. We attempt to identify the set of selected poses that optimizes this objective function through a greedy iterative process. We continue iterating through the ligands, updating the selected pose, until no new poses are selected for any ligands. This procedure is run 500 times to increase the likelihood of finding the global minimum. The poses selected by the objective function for each ligand are returned.</p>
      <sec id="Sec13">
        <title>Selection of CNNscore weight</title>
        <p id="Par23">We select the hyperparameter, <italic>C</italic>, for the weight of the CNNscore (the pose score output by <sc>gnina</sc> [<xref ref-type="bibr" rid="CR26">26</xref>]) within the Open-ComBind score function in the same way as [<xref ref-type="bibr" rid="CR18">18</xref>]. The same cross-docked top 100 poses for each ligand used for computing the similarity statistics are pooled and sorted according to their CNNscore. For each consecutive cluster of 100 poses, we calculate the average CNNscore and the negative log-likelihood of those 100 poses being a correct pose (i.e. <inline-formula id="IEq10"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le 2$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq10.gif"/></alternatives></inline-formula>Å from the ground truth). A line is fit to the data and the slope is used as the weight for the CNNscore.</p>
      </sec>
    </sec>
    <sec id="Sec14">
      <title>Benchmark dataset evaluation</title>
      <p id="Par24">Cross-docking is the main focus of many docking studies as it most closely emulates docking experiments in drug discovery campaigns. We test the performance of Open-ComBind by performing cross-docking on the Benchmark Dataset. We utilize the protein and ligand pre-processing available in the Open-ComBind pipeline to prepare the ligands for cross-docking. A protein and ligand file are created for each complex of the Benchmark Dataset, however, binding site cofactors are manually added back to the protein, following ComBind’s preparation procedure for a fair comparison. Next, we create two sets of helper ligands for each ligand we are docking, as defined above: high-affinity binders and congeneric series. We then use the Open-ComBind Pose Prediction Pipeline (Fig. <xref rid="Fig1" ref-type="fig">1</xref>) on each ligand in which we are performing cross-docking with each set of helper ligands. When predicting poses for docking ligands of a given receptor, we omit that receptor’s docked ligand similarity statistics from the pre-computed similarity statistics used in the Open-ComBind objective function.</p>
      <p id="Par25">We run the evaluation, for each docking ligand, using five different random seeds to determine the variability of Open-ComBind given slightly different ligand poses. The random seed are used for the creation of the conformations of the docking ligand and helper ligands as well as the <sc>gnina</sc> docking procedure.</p>
    </sec>
    <sec id="Sec15">
      <title>Hypothesis evaluation</title>
      <p id="Par26">[<xref ref-type="bibr" rid="CR18">18</xref>] built ComBind on the hypothesis that distinct ligands bind to a receptor in similar ways. We aim to investigate whether this underlying hypothesis of the pipeline is correct by comparing the value of the Open-ComBind objective function for the lowest RMSD ligand poses to the value of the objective when selecting from all <sc>gnina</sc> generated poses. We only look at target proteins in the Benchmark dataset containing at least ten ligands with a <sc>gnina</sc> generated near-native pose. In the following experiment, we only use ligands with a defined ground truth pose (i.e. the set of docking ligands for each target receptor in the benchmark dataset) and only ligands that have a <sc>gnina</sc> generated pose &lt; 2Å RMSD from the ground truth. We first measure the value of the Open-ComBind objective function when we restrict our selection to the best <sc>gnina</sc> generated pose, according to lowest RMSD to the ground truth. We next evaluate the value of the Open-ComBind objective function when we select from all <sc>gnina</sc> generated poses of the ligands. If the underlying hypothesis of Open-ComBind is true, then the Open-ComBind objective function value when selecting from the best poses will be greater than or equal to the objective function value when selecting from all <sc>gnina</sc> generated poses. The Open-ComBind objective is optimized in a stochastic manner, so it is possible we will not converge on the globally optimal pose selections which is assumed to be the set of poses with the lowest RMSD to the ground truth.</p>
    </sec>
  </sec>
  <sec id="Sec16">
    <title>Results</title>
    <sec id="Sec17">
      <title>Similarity distributions</title>
      <p id="Par27">The pairwise feature similarity distributions are pivotal to the Open-ComBind objective function. Shifts from the reference to native distribution help to ensure the poses selected by the Open-ComBind objective are more likely to be pulled from the set of near-native poses. We calculate the pairwise feature similarity distributions by cross-docking all ligands in the Similarity Dataset using <sc>gnina</sc>. Then the top 100 poses of each ligand were analyzed for their interaction with the receptor structure used for docking. We see in Fig. <xref rid="Fig2" ref-type="fig">2</xref> that all of the intermolecular interactions: Hydrogen bonds, Salt Bridges, and Hydrophobic contacts have higher similarity in the native distribution than in the reference distribution. The hydrogen bonds reference distribution is heavily right-skewed, while the native distribution is centered around 0.43 with a Gaussian-like appearance. Salt Bridges are much less frequent interactions, therefore both the native and reference distributions are heavily focused on the points <inline-formula id="IEq11"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{3}$$\end{document}</tex-math><mml:math id="M26"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq11.gif"/></alternatives></inline-formula>, <inline-formula id="IEq12"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{2}$$\end{document}</tex-math><mml:math id="M28"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq12.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq13"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{2}{3}$$\end{document}</tex-math><mml:math id="M30"><mml:mfrac><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq13.gif"/></alternatives></inline-formula> indicating that most ligands only make a small number of salt bridges with the protein. The native distribution shift is not as pronounced in the salt bridge due to its infrequency; however, we still see an increase in the density centered around <inline-formula id="IEq14"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{2}{3}$$\end{document}</tex-math><mml:math id="M32"><mml:mfrac><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq14.gif"/></alternatives></inline-formula> and a slight decrease in the density around <inline-formula id="IEq15"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{3}$$\end{document}</tex-math><mml:math id="M34"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq15.gif"/></alternatives></inline-formula> Pseudo-Tanimoto similarity relative to the reference distribution. Hydrophobic contact similarity is left skewed in both the native and reference distributions. The native distribution has a mean of 0.83, while the reference distribution has a mean of 0.69. The RMSD of the MCSS shows the same trend as the intermolecular interactions, with the native poses being more similar than the similarity distribution of all poses. Due to the cutoff at 6 Å we see a spike in both distributions at 6 Å. The spike in the reference distribution far outweighs the left tail.<fig id="Fig2"><label>Fig. 2</label><caption><p>Pairwise similarities of different intra-molecular features and inter-pose similarities. The mean distribution across five seeds is plotted with the shading denoting the standard deviation</p></caption><graphic xlink:href="10822_2023_544_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par28">The hyperparameter <italic>C</italic> is set to 1 following the slopes of the best fit lines in Figure S1.</p>
    </sec>
    <sec id="Sec18">
      <title>Docking results</title>
      <p id="Par29">After defining our pairwise similarity distributions and the hyperparameter for the weight of the CNNscore, we can utilize the Open-ComBind framework to select poses from <sc>gnina</sc>’s sampled poses. Binders lacking structural information are used as helper ligands to select docked poses for our ligand of interest that interact with the receptor in similar ways to the helper ligands. Utilizing the pairwise similarity distributions shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref> along with the <sc>gnina</sc> docking scores enables selection of near-native poses more often than when only the <sc>gnina</sc> score is used to select a pose (Fig. <xref rid="Fig3" ref-type="fig">3</xref> and S2). Following [<xref ref-type="bibr" rid="CR18">18</xref>], we compute the “Overall" statistic, which is the weighted average of the different protein classes according to the proportion of FDA-approved drugs for that class of proteins. Open-ComBind increases the Overall percentage of ligands with a correct pose by 5% and 4.5% for high-affinity and congeneric series helper ligands, respectively. Nuclear receptors, GPCRs, and ion channels have the greatest increase in performance for high-affinity ligands over only the <sc>gnina</sc> docking score, 6.8%, 6.3%, and 4.7%, respectively (4.7%, 3.2%, and 12.7%, respectively for congeneric series ligands). However, in contrast to [<xref ref-type="bibr" rid="CR18">18</xref>], we find that many proteins show a reduced performance when utilizing the Open-ComBind framework relative to <sc>gnina</sc>. Additionally, for most of the proteins, we see large variances in Open-ComBind’s performance with different runs of <sc>gnina</sc>.<fig id="Fig3"><label>Fig. 3</label><caption><p>Average difference in percent of ligands whose pose is predicted correctly between <sc>gnina</sc>’s top scoring pose and the pose selected by Open-ComBind when high-affinity helper ligands are used. Error bars show the standard deviation across the five seeds. Performance with the congeneric series helper ligands is shown in Figure S2</p></caption><graphic xlink:href="10822_2023_544_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par30">When we compare our overall performance to that of [<xref ref-type="bibr" rid="CR18">18</xref>] in Fig. <xref rid="Fig4" ref-type="fig">4</xref> and S3, we see that our open-source version is slightly below the performance of ComBind. However, when comparing ComBind to Open-ComBind on each individual protein, we see a different story. ComBind tends to either increase or not change the percentage of ligands whose pose is predicted correctly across all of the proteins in the benchmark dataset. Open-ComBind has widely varying performance across different protein targets, with some protein targets seeing a major boost in performance for their docked ligands, like SMO and NR3C2 with a 100% and 50% increase, respectively. Other protein targets show a drastic decrease in the percentage of ligands whose pose is predicted correctly, for instance, MGLUR5 and NR3C1 with a 50% and 11% decrease, respectively. ComBind only has worse pose selection than Glide on one protein target when using high-affinity helper ligands, while Open-ComBind has worse pose selection than <sc>gnina</sc> on five protein targets across varying protein classes. This is all in spite of the fact that <sc>gnina</sc> and Glide demonstrate similar pose selection performance across a majority of the protein targets.<fig id="Fig4"><label>Fig. 4</label><caption><p>Comparing the docking performance of the best performing Open-ComBind seed and its associated <sc>gnina</sc> run to the performance of ComBind and Glide. Performance of ComBind and Glide scraped from [<xref ref-type="bibr" rid="CR18">18</xref>] using WebPlotDigitizer [<xref ref-type="bibr" rid="CR28">28</xref>]</p></caption><graphic xlink:href="10822_2023_544_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par31">The RMSD to ground truth of poses selected by <sc>gnina</sc> is higher than the RMSD of the poses selected by Open-ComBind for the exact same ligand (Figures S4 and S5), average RMSDs of 2.67 and 2.43 Å for <sc>gnina</sc> and Open-ComBind using high-affinity ligands, respectively. Across all of the random seeds, there is a reduction in the average RMSD of the ligands when using Open-ComBind. However, Open-ComBind does not always choose a lower or equivalent RMSD pose for each ligand. This could be due to the fact that some of the featurizations do not contribute to better pose selections.</p>
      <p id="Par32">The importance of Open-ComBind docking components to the pose selection is inspected by removing pieces from the full docking pipeline to see their impact on performance. We see from Figs. <xref rid="Fig5" ref-type="fig">5</xref> and S6 that removing the CNNscore from the pose selection process completely destroys Open-ComBind’s ability to select correct poses, dropping from 63.1 to 33.3% when using high-affinity helper ligands (62.5–38.8% when using congeneric series helper ligands). Removing individual features from Open-ComBind does not have as great an effect as removing the CNNscore, but can significantly impact Open-ComBind’s pose selection. The interaction fingerprint is pivotal to pose selection. Still, we see that only using the H-bonds (55.9%) or salt bridges (58.2%) gets about the same performance as <sc>gnina</sc>-only pose selection (58.1%). Using only Hydrophobic contacts in Open-ComBind is not significantly different (p = 0.20 and p = 0.29 for high-affinity and congeneric series helper ligands, respectively) from using all of the features. Removing the whole interaction fingerprint and only using the maximum common substructure RMSD between ligand poses slightly increases performance (63.3%, p = 0.44 and 64.6%, p = 0.11 for high-affinity and congeneric series helper ligands, respectively) but still shows improvements over <sc>gnina</sc> pose selection. Removing both the H-bonds and salt bridges from the Open-ComBind pose selection process gets about the same performance as when they are used (65.1%, p = 0.09 and 63.1%, p = 0.38 for high-affinity and congeneric series helper ligands, respectively), further demonstrating the inadequacy of H-Bond and salt bridges for pose selection improvements in Open-ComBind.<fig id="Fig5"><label>Fig. 5</label><caption><p>Removing components of Open-ComBind to determine their importance to the selection of docked poses when using the high-affinity helper ligands. ‘G’ indicates that <sc>gnina</sc> scores are used, ‘HB’,‘C’, and ‘SB’ indicate that hydrogen-bond, hydrophobic contact, and salt bridge similarity is used, respectively. ‘MCSS’ indicates that the RMSD between the MCSS of ligand poses is used and ‘Relax MCSS’ indicates a relaxed MCSS strategy was used where strict atom and bond typing were not enforced. ‘<inline-formula id="IEq16"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\cdot$$\end{document}</tex-math><mml:math id="M36"><mml:mo>·</mml:mo></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq16.gif"/></alternatives></inline-formula>’ indicates a p-value less than 0.05 while ‘<inline-formula id="IEq17"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$**$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq17.gif"/></alternatives></inline-formula>’ denotes a p-value less than 0.01 in comparison to standard Open-ComBind</p></caption><graphic xlink:href="10822_2023_544_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par33">Pose selection performance should be dependent on the number of helper ligands we use during pose selection. When no helper ligands are used during the pose selection process, we see that the percentage of ligands whose pose is predicted correctly drops (‘<sc>gnina</sc>(G)’ in Fig. <xref rid="Fig5" ref-type="fig">5</xref> and S6). However, we see in Figs. <xref rid="Fig6" ref-type="fig">6</xref> and S7 that performance plateaus as more helper ligands are added. The performance with ten helper ligands, (61.47% and 62.55% for high-affinity and congeneric series helper ligands, respectively) is about the same as using all 20 helper ligands (61.56% and 62.59% for high-affinity and congeneric series helper ligands, respectively).<fig id="Fig6"><label>Fig. 6</label><caption><p>Reducing the number of similar helper ligands used in the Open-ComBind pipeline decreases the number of docked ligands whose pose is predicted correctly. The line is the average and the shaded area is the standard deviation across 15 different subsamples of helper ligands for each number of helper ligands</p></caption><graphic xlink:href="10822_2023_544_Fig6_HTML" id="MO6"/></fig></p>
    </sec>
    <sec id="Sec19">
      <title>Hypothesis evaluation</title>
      <p id="Par34">The Open-ComBind objective function is formulated to encourage all the ligands being docked to assume similar interactions with the receptor. However, when we compare the Open-ComBind objective function value of the best <sc>gnina</sc> poses for each ligand to the optimal value when selecting from all <sc>gnina</sc> poses, we find that they are never the same when the full objective is used. (Fig. <xref rid="Fig7" ref-type="fig">7</xref>). The value of the objective function when only using the lowest RMSD to the ground truth pose found by <sc>gnina</sc> for each of the ligands being docked is less than selecting from all <sc>gnina</sc> poses, except when only the MCSS featurization is used. This implies that the underlying hypothesis of Open-ComBind is not necessarily true for these protein-ligand complexes during cross-docking. When we remove the hydrogen-bond and salt bridge interactions from the Open-ComBind objective function, the values from the two sets of poses come closer together. This is exacerbated when all interaction fingerprint features are removed from the Open-ComBind objective function and only RMSD of the MCSS is used and some proteins even have equal values of the objective function for both sets. The collection of poses identified by Open-ComBind is more similar in their interactions according to the objective function than the ensemble of lowest RMSD to ground truth poses. We additionally find that the Open-ComBind objective will not always select the native-pose when it is included in the list of poses to select from (Figure S8).<fig id="Fig7"><label>Fig. 7</label><caption><p>The difference of the Open-ComBind objective function when selecting from all <sc>gnina</sc> generated poses and the lowest RMSD to ground truth <sc>gnina</sc> pose. ‘G’ indicates that <sc>gnina</sc> scores are used, ‘HB’,‘C’, and ‘SB’ indicate that hydrogen-bond, hydrophobic contact, and salt bridge similarity is used, respectively. ‘MCSS’ indicates that the RMSD between the MCSS of ligand poses is used</p></caption><graphic xlink:href="10822_2023_544_Fig7_HTML" id="MO7"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec20">
    <title>Discussion</title>
    <sec id="Sec21">
      <title>Implementing an open-source ComBind alternative</title>
      <p id="Par35">Open-ComBind is an open-source alternative to ComBind, developed by [<xref ref-type="bibr" rid="CR18">18</xref>], that has comparable increases in pose prediction performance over the respective baseline docking method. Building out Open-ComBind took a concerted effort as the original pipeline uses opaque software tools with unspecified methods for pose generation and featurization of the docked poses. The feature distributions generated with only the poses of a single ligand conformation <sc>gnina</sc> docking run did not show more similarity in the native distribution than in the reference distributions. By comparing the inter-pose RMSD pose of both <sc>gnina</sc> and Glide, we found that Glide was much more likely to output a set of highly similar poses while <sc>gnina</sc> did not. Therefore, we were able to increase similarity of the native distributions by docking a set of ten ligand conformations and combining the docking runs of each conformation into one single set of poses which were sorted by CNNscore. This produces a list of 100 conformations that has a higher likelihood of being less than 2 Å RMSD from the ground truth and reduces the RMSD between better scoring poses.</p>
      <p id="Par36">Differences between <sc>gnina</sc>’s and Glide’s output poses required further development of the featurization pipeline as Glide produces poses with hydrogens placed to maximize hydrogen bonding and alters the tautomeric form of the ligand to form salt bridges with the protein. We overcame these differences by adding hydrogens with RDKit during featurization and detecting salt bridge forming moieties with SMARTS string patterns. Placing the hydrogens in this manner ignores the location of hydrogen bond-forming donors and acceptors on the receptor; this likely decreases the strength of the hydrogen bonds seen in Open-ComBind in comparison to ComBind. We see that the Hydrogen bond similarities do not add information over only utilizing the CNNscore in Figs. <xref rid="Fig5" ref-type="fig">5</xref> and S6, despite the fact that there are many hydrogen bonds detected in the benchmark dataset (Table S3). The usage of SMARTS string patterns for detection of salt bridges may also decrease the information provided by salt bridge similarity for increasing pose selection performance, but it is difficult to be sure as salt bridges are a rare occurrence in the benchmark dataset (Table S3).</p>
      <p id="Par37">The RMSD calculation between the MCSS of two ligand poses is the largest difference between Open-ComBind and ComBind. ComBind uses a MCSS strategy in which any two atoms can match in the graph regardless of atom type. We tested this relaxed MCSS strategy with Open-ComBind and found reduced performance (Figs. <xref rid="Fig5" ref-type="fig">5</xref> and S6). Therefore, our MCSS calculation enforces stringent atom type matching (excluding halogens which can all match each other). We additionally require that bond orders be identical for the bond to be included in the MCSS and that rings can only match other complete rings. These MCSS requirements enforce a stronger match between substructures of ligands and ensure that the scaffold of a congeneric series is placed in a similar location for all ligands.</p>
    </sec>
    <sec id="Sec22">
      <title>Open ComBind performance</title>
      <p id="Par38">The exact poses selected by Open-ComBind vary significantly when the generated, docked ligand poses are changed via different random seeds. However, on average Open-ComBind tends to improve pose selection in comparison to the <sc>gnina</sc> baseline. We see in Figs. <xref rid="Fig4" ref-type="fig">4</xref> and S3 that the standard deviation for a given protein is often much larger than its mean, indicating the results of Open-ComBind pose selection are highly dependent on the poses of the ligands. Altering the random seed affects the poses in the top scoring 100 used for the pose selection process, which can affect the consensus pose found for the docking ligand and helper ligands. We do see that the average RMSD decreases in comparison to the baseline docking method, <sc>gnina</sc>, regardless of the random seed used (Figures S4 and S5).</p>
      <p id="Par39">Hydrophobic contact similarity and MCSS RMSD are sufficient features to increase the pose prediction performance to that of the full Open-ComBind pipeline. This is likely due to the fact that hydrophobic contacts are the most common intramolecular interaction seen in the benchmark dataset by a factor of 6 (Table S3). Only utilizing these two features significantly decreases the computational cost of Open-ComBind. In fact, with congeneric series, we see (Figure S6) that only MCSS is required for the same performance as the full Open-ComBind pipeline. We expect congeneric series to have a much higher consistency in the placement of the MCSS because the MCSS is likely referring to the scaffold of the congeneric series. We also see that only 10 helper ligands are required to reach the pose prediction power of 20 helper ligands (Figs. <xref rid="Fig6" ref-type="fig">6</xref> and S7). Reducing the number of helper ligands will also decrease the computational cost of the docking pipeline as a similarity matrix must be constructed for each feature which is <inline-formula id="IEq18"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {O}}(N^2)$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq18.gif"/></alternatives></inline-formula> with the number of ligands used, <italic>N</italic>.</p>
      <p id="Par40">[<xref ref-type="bibr" rid="CR18">18</xref>] built the ComBind pose selection pipeline on the hypothesis that distinct ligands bind to the same receptor in similar ways. However, we show in Fig. <xref rid="Fig7" ref-type="fig">7</xref> that the Open-ComBind objective function does not always select ligand poses that are the lowest RMSD to the ground truth. All of the proteins tested show a lower full objective function value when evaluating on the lowest RMSD near-native poses sampled by <sc>gnina</sc> in comparison to the objective function value when selecting from all sampled poses. However, we do see that our inspection of the underlying hypothesis agrees with the ablation studies in that the usage of only the hydrophobic contacts similarity and RMSD of MCSS improves the objective function’s performance in selecting near-native poses. Further, we see that use of only the RMSD of MCSS is able to find poses with the same objective function value as the lowest RMSD to ground truth poses. This implies that the RMSD of MCSS featurization aligns well with the underlying hypothesis, while the other features do not. It is likely that the hydrogen bonds, salt bridges, and hydrophobic contacts of the lowest RMSD to ground truth poses do not show as great of a consensus due to side chain rearrangement during binding of different ligands. Therefore, allowing side chain rearrangement during docking would likely improve the performance of Open-ComBind pose selection.</p>
    </sec>
    <sec id="Sec23">
      <title>Future directions</title>
      <p id="Par41">Open-ComBind is an easy-to-use, open-source alternative to ComBind, although more work is needed to match the performance gains achieved by [<xref ref-type="bibr" rid="CR18">18</xref>]. Open-ComBind provides the molecular modeling community the opportunity to quickly and easily modify the featurization pipeline for increased pose prediction performance utilizing the large quantity of available, non-structural data. Features such as <inline-formula id="IEq19"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi -\pi$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mi>π</mml:mi><mml:mo>-</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="10822_2023_544_Article_IEq19.gif"/></alternatives></inline-formula> bonds and ligand shape similarity can be added easily to the docking pipeline. Since Open-ComBind uses <sc>gnina</sc> as the pose generator, we can utilize the internal representation of the CNN scoring functions within the docking pipeline as a featurization of the protein-ligand interaction for little extra computational cost. <sc>gnina</sc> also allows flexible sidechains during docking which could be used in the Open-ComBind framework for finding different pocket configurations to fit ligands of different sizes or ligands forming non-bonded interactions in different relative locations. Finally, Open-ComBind could be extended to predict the protonation state of the ligand to form better hydrogen bonds with the receptor and select better ligand poses than docking with the input protonation state.</p>
    </sec>
    <sec id="Sec24">
      <title>Ease to use API</title>
      <p id="Par42">Open-ComBind has been developed as a Python package with an accompanying command-line interface for running the entire pipeline. We provide the pre-processing, docking, featurization, and pose selection as easy-to-use Python modules or a single command on the command line. After installation of Open-ComBind and its pre-requisites from our github repository: <ext-link ext-link-type="uri" xlink:href="http://www.github.com/drewnutt/open_combind">www.github.com/drewnutt/open_combind</ext-link>, users can run the entire Open-ComBind pipeline with the command:<graphic position="anchor" xlink:href="10822_2023_544_Figa_HTML" id="MO8"/> where helper_ligands.csv is a comma-delimited file of the helper ligands SMILES strings and identifiers. The user must specify the location of the raw protein-ligand complex to use for docking. Other protein-ligand crystals can be placed in the same directory for pre-processing.</p>
      <p id="Par43">Additionally, we provide scripts and instructions for using the Open-ComBind pose prediction pipeline with other molecular docking tools. Use of molecular docking tools that directly consider hydrogen bonds and predict ligand hydrogen coordinates would likely improve the utility of the hydrogen bond similarity in enhancing pose prediction.</p>
    </sec>
  </sec>
  <sec id="Sec25">
    <title>Conclusion</title>
    <p id="Par44">In this work, we developed Open-ComBind, an open-source alternative to ComBind, to increase pose prediction performance over <sc>gnina</sc>. Open-ComBind reduces the average RMSD to ground truth from <sc>gnina</sc>’s 3.24 Å to 3.03 Å for all ligands. We utilize ligands lacking structural information as well as a distribution of ligand feature similarity of both native poses and all poses. Open-ComBind utilizes pairwise similarities between sets of ligand poses to determine the poses which maximize inter-ligand similarity of binding. We see pose selection improvement equal to the full pipeline when using only hydrophobic contact similarity and the RMSD between the MCSS of ligand pairs. Additionally, we observe that Open-ComBind only requires ten helper ligands to reach the pose prediction performance of using 20 helper ligands. We provide the Open-ComBind in an easy-to-use API as well as source code and data to use the Open-ComBind pipeline at our GitHub repo: <ext-link ext-link-type="uri" xlink:href="http://www.github.com/drewnutt/open_combind/">www.github.com/drewnutt/open_combind/</ext-link></p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec100">
      <title>Supplementary Information</title>
      <p>Below is the link to the electronic supplementary material.<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="10822_2023_544_MOESM1_ESM.pdf"><caption><p>Supplementary file1 (PDF 512 kb)</p></caption></media></supplementary-material></p>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank Jonathan King, Dakota Folmsbee, and Rishal Aggarwal for their comments during the preparation of the manuscript. The authors would like to thank Joseph M. Paggi for providing the structural data used for deriving the similarity statistics of ComBind. This work is supported by the R35GM140753 from the National Institute of General Medical Sciences and CHE-2102474 from the National Science Foundation.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>ATM designed and completed the computational study under the supervision of DRK. ATM and DRK wrote the paper.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Not applicable.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>Information for downloading the datasets are available at <ext-link ext-link-type="uri" xlink:href="http://www.github.com/drewnutt/open_combind/">www.github.com/drewnutt/open_combind/</ext-link>.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>Our pipeline is open source and available under a CC BY-NC-SA 3.0 license. The full Open-ComBind pipeline code, documentation, and evaluation scripts are available at <ext-link ext-link-type="uri" xlink:href="http://www.github.com/drewnutt/open_combind/">www.github.com/drewnutt/open_combind/</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1" notes-type="COI-statement">
      <title>Conflict of interest</title>
      <p id="Par45">The authors declare no competing interests.</p>
    </notes>
    <notes id="FPar2">
      <title>Ethics approval</title>
      <p id="Par46">Not applicable.</p>
    </notes>
    <notes id="FPar3">
      <title>Consent to participate</title>
      <p id="Par47">Not applicable.</p>
    </notes>
    <notes id="FPar4">
      <title>Consent for publication</title>
      <p id="Par48">Not applicable.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sliwoski</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Kothiwale</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Meiler</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lowe</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <article-title>Computational methods in drug discovery</article-title>
        <source>Pharmacol Rev</source>
        <year>2014</year>
        <volume>66</volume>
        <issue>1</issue>
        <fpage>334</fpage>
        <lpage>395</lpage>
        <pub-id pub-id-type="doi">10.1124/pr.112.007336</pub-id>
        <?supplied-pmid 24381236?>
        <pub-id pub-id-type="pmid">24381236</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Gubernator</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Böhm</surname>
            <given-names>H-J</given-names>
          </name>
          <name>
            <surname>Mannhold</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kubinyi</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Timmerman</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <source>Structure-based ligand design</source>
        <year>1998</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Wiley Online Library</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anderson</surname>
            <given-names>AC</given-names>
          </name>
        </person-group>
        <article-title>The process of structure-based drug design</article-title>
        <source>Chem Biol</source>
        <year>2003</year>
        <volume>10</volume>
        <issue>9</issue>
        <fpage>787</fpage>
        <lpage>797</lpage>
        <pub-id pub-id-type="doi">10.1016/j.chembiol.2003.09.002</pub-id>
        <?supplied-pmid 14522049?>
        <pub-id pub-id-type="pmid">14522049</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kitchen</surname>
            <given-names>DB</given-names>
          </name>
          <name>
            <surname>Decornez</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Furr</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Bajorath</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Docking and scoring in virtual screening for drug discovery: methods and applications</article-title>
        <source>Nat Rev Drug Discov</source>
        <year>2004</year>
        <volume>3</volume>
        <issue>11</issue>
        <fpage>935</fpage>
        <lpage>949</lpage>
        <pub-id pub-id-type="doi">10.1038/nrd1549</pub-id>
        <?supplied-pmid 15520816?>
        <pub-id pub-id-type="pmid">15520816</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trott</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Olson</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Autodock vina: improving the speed and accuracy of docking with a new scoring function, efficient optimization, and multithreading</article-title>
        <source>J Comput Chem</source>
        <year>2010</year>
        <volume>31</volume>
        <issue>2</issue>
        <fpage>455</fpage>
        <lpage>461</lpage>
        <pub-id pub-id-type="doi">10.1002/jcc.21334</pub-id>
        <?supplied-pmid 19499576?>
        <pub-id pub-id-type="pmid">19499576</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Friesner</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Banks</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Halgren</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Klicic</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Mainz</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Repasky</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Knoll</surname>
            <given-names>EH</given-names>
          </name>
          <name>
            <surname>Shelley</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Perry</surname>
            <given-names>JK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Glide: a new approach for rapid, accurate docking and scoring. 1. Method and assessment of docking accuracy</article-title>
        <source>J Med Chem</source>
        <year>2004</year>
        <volume>47</volume>
        <issue>7</issue>
        <fpage>1739</fpage>
        <lpage>1749</lpage>
        <pub-id pub-id-type="doi">10.1021/jm0306430</pub-id>
        <?supplied-pmid 15027865?>
        <pub-id pub-id-type="pmid">15027865</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Halgren</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Friesner</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Beard</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Frye</surname>
            <given-names>LL</given-names>
          </name>
          <name>
            <surname>Pollard</surname>
            <given-names>WT</given-names>
          </name>
          <name>
            <surname>Banks</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>Glide: a new approach for rapid, accurate docking and scoring. 2. Enrichment factors in database screening.</article-title>
        <source>J Med Chem</source>
        <year>2004</year>
        <volume>47</volume>
        <issue>7</issue>
        <fpage>1750</fpage>
        <lpage>1759</lpage>
        <pub-id pub-id-type="doi">10.1021/jm030644s</pub-id>
        <?supplied-pmid 15027866?>
        <pub-id pub-id-type="pmid">15027866</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McNutt</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Francoeur</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Aggarwal</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Masuda</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Meli</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ragoza</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sunseri</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Koes</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>Gnina 1.0: molecular docking with deep learning</article-title>
        <source>J Cheminform</source>
        <year>2021</year>
        <volume>13</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="doi">10.1186/s13321-021-00522-2</pub-id>
        <pub-id pub-id-type="pmid">33407901</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Corso G, Stärk H, Jing B, Barzilay R, Jaakkola, T (2023) Diffdock: diffusion steps, twists, and turns for molecular docking. In: International conference on learning representations (ICLR)</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vidal</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Garcia-Serna</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Mestres</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Ligand-based approaches to in silico pharmacology</article-title>
        <source>Chemoinform Comput Chem Biol</source>
        <year>2011</year>
        <pub-id pub-id-type="doi">10.1007/978-1-60761-839-3_19</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Banegas-Luna</surname>
            <given-names>A-J</given-names>
          </name>
          <name>
            <surname>Ceron-Carrasco</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Perez-Sanchez</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A review of ligand-based virtual screening web tools and screening algorithms in large molecular databases in the age of big data</article-title>
        <source>Future Med Chem</source>
        <year>2018</year>
        <volume>10</volume>
        <issue>22</issue>
        <fpage>2641</fpage>
        <lpage>2658</lpage>
        <pub-id pub-id-type="doi">10.4155/fmc-2018-0076</pub-id>
        <?supplied-pmid 30499744?>
        <pub-id pub-id-type="pmid">30499744</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grimm</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Bu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Xiao</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Ligmate: a multifeature integration algorithm for ligand-similarity-based virtual screening</article-title>
        <source>J Chem Inf Model</source>
        <year>2020</year>
        <volume>60</volume>
        <issue>12</issue>
        <fpage>6044</fpage>
        <lpage>6053</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.9b01210</pub-id>
        <?supplied-pmid 33190499?>
        <pub-id pub-id-type="pmid">33190499</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Broccatelli</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Best of both worlds: on the complementarity of ligand-based and structure-based virtual screening</article-title>
        <source>J Chem Inf Model</source>
        <year>2014</year>
        <volume>54</volume>
        <issue>6</issue>
        <fpage>1634</fpage>
        <lpage>1641</lpage>
        <pub-id pub-id-type="doi">10.1021/ci5001604</pub-id>
        <?supplied-pmid 24877883?>
        <pub-id pub-id-type="pmid">24877883</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kumar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>KY</given-names>
          </name>
        </person-group>
        <article-title>A cross docking pipeline for improving pose prediction and virtual screening performance</article-title>
        <source>J Comput Aided Mol Des</source>
        <year>2018</year>
        <volume>32</volume>
        <fpage>163</fpage>
        <lpage>173</lpage>
        <pub-id pub-id-type="doi">10.1007/s10822-017-0048-z</pub-id>
        <?supplied-pmid 28836076?>
        <pub-id pub-id-type="pmid">28836076</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Enhance the performance of current scoring functions with the aid of 3d protein-ligand interaction fingerprints</article-title>
        <source>BMC Bioinform</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.1186/s12859-017-1750-5</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lam</surname>
            <given-names>PC-H</given-names>
          </name>
          <name>
            <surname>Abagyan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Totrov</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Ligand-biased ensemble receptor docking (LigBEnD): a hybrid ligand/receptor structure-based approach</article-title>
        <source>J Comput Aided Mol Des</source>
        <year>2018</year>
        <volume>32</volume>
        <fpage>187</fpage>
        <lpage>198</lpage>
        <pub-id pub-id-type="doi">10.1007/s10822-017-0058-x</pub-id>
        <?supplied-pmid 28887659?>
        <pub-id pub-id-type="pmid">28887659</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>S-Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Hybriddock: a hybrid protein-ligand docking protocol integrating protein-and ligand-based approaches</article-title>
        <source>J Chem Inf Model</source>
        <year>2016</year>
        <volume>56</volume>
        <issue>6</issue>
        <fpage>1078</fpage>
        <lpage>1087</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.5b00275</pub-id>
        <?supplied-pmid 26317502?>
        <pub-id pub-id-type="pmid">26317502</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paggi</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Belk</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Hollingsworth</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Villanueva</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Powers</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Chemparathy</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Tynan</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Lau</surname>
            <given-names>TK</given-names>
          </name>
          <name>
            <surname>Sunahara</surname>
            <given-names>RK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Leveraging nonstructural data to predict structures and affinities of protein-ligand complexes</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2021</year>
        <volume>118</volume>
        <issue>51</issue>
        <fpage>2112621118</fpage>
        <pub-id pub-id-type="doi">10.1073/pnas.2112621118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bakan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Meireles</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Bahar</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Prody: protein dynamics inferred from theory and experiments</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>11</issue>
        <fpage>1575</fpage>
        <lpage>1577</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr168</pub-id>
        <?supplied-pmid 21471012?>
        <pub-id pub-id-type="pmid">21471012</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Krieger</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kaya</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kaynak</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Mikulska-Ruminska</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Doruker</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bahar</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Prody 2.0: increased scale and scope after 10 years of protein dynamics modelling with python</article-title>
        <source>Bioinformatics</source>
        <year>2021</year>
        <volume>37</volume>
        <issue>20</issue>
        <fpage>3657</fpage>
        <lpage>3659</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btab187</pub-id>
        <?supplied-pmid 33822884?>
        <pub-id pub-id-type="pmid">33822884</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berman</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>Westbrook</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Gilliland</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Bhat</surname>
            <given-names>TN</given-names>
          </name>
          <name>
            <surname>Weissig</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Shindyalov</surname>
            <given-names>IN</given-names>
          </name>
          <name>
            <surname>Bourne</surname>
            <given-names>PE</given-names>
          </name>
        </person-group>
        <article-title>The protein data bank</article-title>
        <source>Nucleic Acids Res</source>
        <year>2000</year>
        <volume>28</volume>
        <issue>1</issue>
        <fpage>235</fpage>
        <lpage>242</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/28.1.235</pub-id>
        <?supplied-pmid 10592235?>
        <pub-id pub-id-type="pmid">10592235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Burley</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Bhikadiya</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bittrich</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Craig</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Crichlow</surname>
            <given-names>GV</given-names>
          </name>
          <name>
            <surname>Dalenberg</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Duarte</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RCSB protein data bank (rcsb.org): delivery of experimentally-determined PDB structures alongside one million computed structure models of proteins from artificial intelligence/machine learning</article-title>
        <source>Nucleic Acids Res</source>
        <year>2023</year>
        <volume>51</volume>
        <issue>D1</issue>
        <fpage>488</fpage>
        <lpage>508</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkac1077</pub-id>
        <pub-id pub-id-type="pmid">36583345</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Schrödinger, LLC: the PyMOL molecular graphics system, version 1.8 (2015)</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Riniker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Landrum</surname>
            <given-names>GA</given-names>
          </name>
        </person-group>
        <article-title>Better informed distance geometry: using what we know to improve conformation generation</article-title>
        <source>J Chem Inf Model</source>
        <year>2015</year>
        <volume>55</volume>
        <issue>12</issue>
        <fpage>2562</fpage>
        <lpage>2574</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.5b00654</pub-id>
        <?supplied-pmid 26575315?>
        <pub-id pub-id-type="pmid">26575315</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Witek</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Landrum</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Riniker</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Improving conformer generation for small rings and macrocycles based on distance geometry and experimental torsional-angle preferences</article-title>
        <source>J Chem Inf Model</source>
        <year>2020</year>
        <volume>60</volume>
        <issue>4</issue>
        <fpage>2044</fpage>
        <lpage>2058</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.0c00025</pub-id>
        <?supplied-pmid 32155061?>
        <pub-id pub-id-type="pmid">32155061</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Francoeur</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Masuda</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sunseri</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jia</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Iovanisci</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Koes</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>Three-dimensional convolutional neural networks and a cross-docked data set for structure-based drug design</article-title>
        <source>J Chem Inf Model</source>
        <year>2020</year>
        <volume>60</volume>
        <issue>9</issue>
        <fpage>4200</fpage>
        <lpage>4215</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.0c00411</pub-id>
        <?supplied-pmid 32865404?>
        <pub-id pub-id-type="pmid">32865404</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sunseri</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Koes</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>Pharmit: interactive exploration of chemical space</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <issue>W1</issue>
        <fpage>442</fpage>
        <lpage>448</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw287</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Rohatgi A (2022) Webplotdigitizer: version 4.6. <ext-link ext-link-type="uri" xlink:href="https://automeris.io/WebPlotDigitizer">https://automeris.io/WebPlotDigitizer</ext-link></mixed-citation>
    </ref>
  </ref-list>
</back>
