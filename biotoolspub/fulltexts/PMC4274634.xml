<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.0 20120330//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">RNA</journal-id>
    <journal-id journal-id-type="iso-abbrev">RNA</journal-id>
    <journal-id journal-id-type="publisher-id">RNA</journal-id>
    <journal-title-group>
      <journal-title>RNA</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1355-8382</issn>
    <issn pub-type="epub">1469-9001</issn>
    <publisher>
      <publisher-name>Cold Spring Harbor Laboratory Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4274634</article-id>
    <article-id pub-id-type="pmid">25406361</article-id>
    <article-id pub-id-type="medline">9509184</article-id>
    <article-id pub-id-type="publisher-id">RA</article-id>
    <article-id pub-id-type="doi">10.1261/rna.046037.114</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Bioinformatics</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>IsoSCM: improved and alternative 3′ UTR annotation using multiple change-point inference</article-title>
      <alt-title alt-title-type="left-running">Shenker et al.</alt-title>
      <alt-title alt-title-type="right-running">Inferring alternative 3′ UTRs from RNA-seq data</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Shenker</surname>
          <given-names>Sol</given-names>
        </name>
        <xref ref-type="aff" rid="af1">1</xref>
        <xref ref-type="aff" rid="af2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Miura</surname>
          <given-names>Pedro</given-names>
        </name>
        <xref ref-type="aff" rid="af1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sanfilippo</surname>
          <given-names>Piero</given-names>
        </name>
        <xref ref-type="aff" rid="af1">1</xref>
        <xref ref-type="aff" rid="af2">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Lai</surname>
          <given-names>Eric C.</given-names>
        </name>
        <xref ref-type="aff" rid="af1">1</xref>
      </contrib>
    </contrib-group>
    <aff id="af1"><label>1</label>Department of Developmental Biology, Sloan-Kettering Institute, New York, New York 10065, USA</aff>
    <aff id="af2"><label>2</label>Tri-Institutional Program in Computational Biology and Medicine, Weill Cornell Medical College, New York, New York 10065, USA</aff>
    <aff id="af3"><label>3</label>Louis V. Gerstner, Jr. Graduate School of Biomedical Sciences, Memorial Sloan Kettering Cancer Center, New York, New York 10065, USA</aff>
    <author-notes>
      <corresp>Corresponding author: <email>laie@mskcc.org</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>1</month>
      <year>2015</year>
    </pub-date>
    <volume>21</volume>
    <issue>1</issue>
    <fpage>14</fpage>
    <lpage>27</lpage>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>4</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>10</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>
        <ext-link ext-link-type="uri" xlink:href="http://www.rnajournal.org/site/misc/terms.xhtml">© 2014 Shenker et al.; Published by Cold Spring Harbor Laboratory Press for the RNA Society</ext-link>
      </copyright-statement>
      <copyright-year>2014</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This article is distributed exclusively by the RNA Society for the first 12 months after the full-issue publication date (see <ext-link ext-link-type="uri" xlink:href="http://rnajournal.cshlp.org/site/misc/terms.xhtml">http://rnajournal.cshlp.org/site/misc/terms.xhtml</ext-link>). After 12 months, it is available under a Creative Commons License (Attribution-NonCommercial 4.0 International), as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="14.pdf"/>
    <abstract>
      <p>Major applications of RNA-seq data include studies of how the transcriptome is modulated at the levels of gene expression and RNA processing, and how these events are related to cellular identity, environmental condition, and/or disease status. While many excellent tools have been developed to analyze RNA-seq data, these generally have limited efficacy for annotating 3′ UTRs. Existing assembly strategies often fragment long 3′ UTRs, and importantly, none of the algorithms in popular use can apportion data into tandem 3′ UTR isoforms, which are frequently generated by alternative cleavage and polyadenylation (APA). Consequently, it is often not possible to identify patterns of differential APA using existing assembly tools. To address these limitations, we present a new method for transcript assembly, Isoform Structural Change Model (IsoSCM) that incorporates change-point analysis to improve the 3′ UTR annotation process. Through evaluation on simulated and genuine data sets, we demonstrate that IsoSCM annotates 3′ termini with higher sensitivity and specificity than can be achieved with existing methods. We highlight the utility of IsoSCM by demonstrating its ability to recover known patterns of tissue-regulated APA. IsoSCM will facilitate future efforts for 3′ UTR annotation and genome-wide studies of the breadth, regulation, and roles of APA leveraging RNA-seq data. The IsoSCM software and source code are available from our website https://github.com/shenkers/isoscm.</p>
    </abstract>
    <kwd-group>
      <kwd>3′ UTR</kwd>
      <kwd>APA</kwd>
      <kwd>RNA-seq</kwd>
      <kwd>IsoSCM</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="award1">
        <funding-source id="GS1">Tri-Institutional Training Program in Computational Biology and Medicine</funding-source>
      </award-group>
      <award-group id="award2">
        <funding-source id="GS2">Canadian Institutes of Health Research</funding-source>
      </award-group>
      <award-group id="award3">
        <funding-source id="GS3">Burroughs Wellcome Fund</funding-source>
      </award-group>
      <award-group id="award4">
        <funding-source id="GS4">National Institutes of Health</funding-source>
        <award-id>R01-NS074037</award-id>
        <award-id>R01-NS083833</award-id>
      </award-group>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec sec-type="introduction" id="s1">
    <title>INTRODUCTION</title>
    <p>The recent astonishing advances in RNA-sequencing (RNA-seq) technologies have spurred the development of numerous methods to exploit these data for diverse applications, such as inferring transcript structures, differential gene expression, and alternative RNA processing. These analyses require models of transcript structure that serve as a foundation for transcriptome analysis, and to quantify differences in read mapping between conditions (<xref rid="SHENKERRNA046037C21" ref-type="bibr">Martin and Wang 2011</xref>). While transcript structures were historically inferred from full-length cDNA sequences (<xref rid="SHENKERRNA046037C1" ref-type="bibr">Adams et al. 1995</xref>), the wealth of data from RNA-seq experiments has greatly expanded transcriptome annotation pipelines more recently (<xref rid="SHENKERRNA046037C9" ref-type="bibr">Djebali et al. 2012</xref>; <xref rid="SHENKERRNA046037C5" ref-type="bibr">Brown et al. 2014</xref>).</p>
    <p>Strategies for transcript assembly can be categorized based on their dependence on a reference genome sequence. Genome-independent (de novo) approaches typically construct a De Brujin graph representing reads sharing compatible subsequences, then use heuristics to decompose this graph to recover full-length transcript sequences (<xref rid="SHENKERRNA046037C21" ref-type="bibr">Martin and Wang 2011</xref>). Genome-dependent approaches decompose the transcript assembly problem into smaller subproblems by first mapping the reads to the reference sequence, and then constructing gene models that are consistent with the aligned reads (<xref rid="SHENKERRNA046037C7" ref-type="bibr">Denoeud et al. 2008</xref>; <xref rid="SHENKERRNA046037C27" ref-type="bibr">Mortazavi et al. 2008</xref>; <xref rid="SHENKERRNA046037C34" ref-type="bibr">Yassour et al. 2009</xref>; <xref rid="SHENKERRNA046037C13" ref-type="bibr">Guttman et al. 2010</xref>; <xref rid="SHENKERRNA046037C32" ref-type="bibr">Trapnell et al. 2010</xref>). Since these strategies operate in the absence of any reference gene models, they are termed ab initio transcript assembly methods.</p>
    <p>In addition to transcript assembly, a separate class of methods attempts to quantify the relative abundance of transcripts and isoforms using RNA-seq data (<xref rid="SHENKERRNA046037C12" ref-type="bibr">Feng et al. 2011</xref>; <xref rid="SHENKERRNA046037C19" ref-type="bibr">Li et al. 2011a</xref>,<xref rid="SHENKERRNA046037C20" ref-type="bibr">b</xref>; <xref rid="SHENKERRNA046037C3" ref-type="bibr">Behr et al. 2013</xref>; <xref rid="SHENKERRNA046037C15" ref-type="bibr">Hiller and Wong 2013</xref>). Since alternatively processed gene products are frequently encoded in overlapping genomic locales, and RNA-seq reads typically cannot be unambiguously assigned to overlapping transcripts, these methods attempt to construct parsimonious models for transcript abundance that are consistent with observed read counts. Importantly, these approaches cannot be applied if a set of reference models is not available, and may provide inaccurate quantification if these models are not complete.</p>
    <p>While the problem of full-length transcript assembly from short reads is in general difficult and underdetermined (<xref rid="SHENKERRNA046037C3" ref-type="bibr">Behr et al. 2013</xref>), current methods have particular difficulties in annotating 3′ terminal exons correctly. In contrast to the boundaries of internal exons, which can be identified precisely by virtue of reads that span splice junctions, terminal exon boundaries only evince themselves in RNA-seq data as the position at which read coverage decreases. To identify terminal boundaries the popular transcriptome assembly tool Cufflinks constructs a minimum path cover from compatible RNA-seq reads, resulting in a single terminal exon annotation that extends from the last splice acceptor site to the position where there is zero read coverage (<xref rid="SHENKERRNA046037C32" ref-type="bibr">Trapnell et al. 2010</xref>). Since low-frequency polyadenylation site read-through events are captured in RNA-seq experiments, this strategy will often result in the terminal 3′ exon boundary being extended beyond the dominantly used polyadenylation site. Cufflinks implements a post hoc trimming process to mitigate this problem. Another well-utilized transcriptome assembly tool, Scripture, identifies transcribed segments of the genome using scan statistics. Here, the terminal exon boundary is determined as the location where the statistic calculated within a window overlapping the terminal exon drops below the genome-wide significance threshold (<xref rid="SHENKERRNA046037C13" ref-type="bibr">Guttman et al. 2010</xref>).</p>
    <p>Neither of these strategies is specifically designed to identify the set of positions at which the level of RNA-seq coverage transitions from high-to-low coverage, and neither is capable of generating more than one terminal exon annotation. Consequently, the terminal exon annotations built from RNA-seq data can be inaccurate and incomplete. This point was emphasized during a recent comparative assessment of 14 different algorithms for transcript assembly and exon identification, conducted as part of the RNA-seq Genome Annotation Assessment Project (RGASP) (<xref rid="SHENKERRNA046037C31" ref-type="bibr">Steijger et al. 2013</xref>). In particular, the outputs for transcript termini from all of the algorithms tested were sufficiently inaccurate that a relaxed criteria exon correctness was used that evaluated only on the 5′ boundary of the 3′ terminal exon (<xref rid="SHENKERRNA046037C31" ref-type="bibr">Steijger et al. 2013</xref>). This highlighted the need for improved methods to identify transcript termini from RNA-seq data.</p>
    <p>The 3′ untranslated region (3′ UTR) is an important location of post-transcriptional regulation, and deregulation of 3′ end formation has medical relevance (<xref rid="SHENKERRNA046037C10" ref-type="bibr">Elkon et al. 2013</xref>). In recent years, there has been increasing appreciation that most genes are subject to alternative cleavage and polyadenylation (APA) to yield multiple 3′ UTR isoforms, and that APA is frequently modulated in tissue-specific, state-specific, or environmentally responsive manner (<xref rid="SHENKERRNA046037C26" ref-type="bibr">Miura et al. 2014</xref>). Although various specialized techniques have been developed to sequence the 3′ ends of transcripts (<xref rid="SHENKERRNA046037C10" ref-type="bibr">Elkon et al. 2013</xref>), conventional RNA-seq methods remain the methodology of choice for most laboratories, and the amount of existing RNA-seq data is far greater than for 3′-seq data. Thus, it would be highly desirable to improve the accuracy with which we can infer 3′ UTR boundaries and alternative isoform expression from RNA-seq data.</p>
    <p>Recently, we used tissue-specific RNA-seq data to refine terminal exon models in the human and mouse genomes (<xref rid="SHENKERRNA046037C25" ref-type="bibr">Miura et al. 2013</xref>). We encountered unique challenges when refining terminal exons, which motivated the implementation of a specialized annotation process for 3′ terminal exons. For example, while transposable element insertions are strongly selected against in the coding exons of a gene, UTRs are less constrained and harbor thousands of repetitive elements genome wide (<xref rid="SHENKERRNA046037C6" ref-type="bibr">Chen et al. 2009</xref>). Nonuniform read coverage arising from sequence specific (<xref rid="SHENKERRNA046037C14" ref-type="bibr">Hansen et al. 2010</xref>; <xref rid="SHENKERRNA046037C18" ref-type="bibr">Lahens et al. 2014</xref>) as well as positional biases (<xref rid="SHENKERRNA046037C4" ref-type="bibr">Bohnert and Rätsch 2010</xref>), and uncertain allocation of multimapping reads (<xref rid="SHENKERRNA046037C27" ref-type="bibr">Mortazavi et al. 2008</xref>) can cause artificial local gaps in RNA-seq coverage, making it difficult to annotate full-length 3′ UTR models using next-generation sequencing data alone (<xref ref-type="fig" rid="SHENKERRNA046037F1">Fig. 1</xref>A). We previously developed an ad hoc procedure to bridge short gaps in RNA-seq coverage when known sources of sequencing bias could be identified. This enabled us to extend thousands of 3′ UTR models in the extensively annotated mouse and human genomes. A substantial proportion of these extensions show tissue-specific expression patterns, and identify a previously unappreciated potential for post-transcriptional regulation in the extended genes (<xref rid="SHENKERRNA046037C25" ref-type="bibr">Miura et al. 2013</xref>).</p>
    <p>We formalize this procedure here, extending our previous work for terminal exon annotation, using a segmentation approach that integrates long-range patterns of RNA-seq coverage to identify polyadenylation sites with greater sensitivity and specificity than existing methods. More importantly, we demonstrate its utility for identifying complex patterns of tandem polyadenylation site usage that are inaccessible with conventional annotation strategies. We implement our approach as the stand-alone program <bold>Iso</bold>form <bold>S</bold>tructural <bold>C</bold>hange <bold>M</bold>odel (IsoSCM), which is available from our website (<uri xlink:href="https://github.com/shenkers/isoscm">https://github.com/shenkers/isoscm</uri>).</p>
  </sec>
  <sec sec-type="results" id="s2">
    <title>RESULTS</title>
    <sec id="s2a">
      <title>Transitions in coverage depth identify 3′ UTR boundaries</title>
      <p>RNA-seq protocols sample reads from across transcript bodies, approximately uniformly, although with certain biases (<xref rid="SHENKERRNA046037C27" ref-type="bibr">Mortazavi et al. 2008</xref>). Existing approaches use minimum path coverage (<xref rid="SHENKERRNA046037C32" ref-type="bibr">Trapnell et al. 2010</xref>), or a scan statistic (<xref rid="SHENKERRNA046037C13" ref-type="bibr">Guttman et al. 2010</xref>), to identify transcribed segments, and annotate at most one 3′ boundary for each terminal exon, typically the longest isoform compatible with the reads. Since the longest isoform will not in general reflect the dominant 3′ UTR isoform used by a gene, Cufflinks uses a heuristic post-assembly processing step to trim terminal exon annotations to a prespecified fraction of the average level of coverage. While such a strategy will identify high abundance short isoforms at a subset of loci, a single trimming parameter will not result in optimal annotations genome wide. Moreover, these strategies tend to generate incomplete 3′ UTR assemblies because they cannot capture tandem terminal exon isoforms that are coexpressed in a given sample, as illustrated in <xref ref-type="fig" rid="SHENKERRNA046037F1">Figure 1</xref>B.</p>
      <fig id="SHENKERRNA046037F1" orientation="portrait" position="float">
        <label>FIGURE 1.</label>
        <caption>
          <p>Challenges and proposed solutions for 3′ UTR annotation from RNA-seq data. (<italic>A</italic>) Genome browser view of <italic>Kif3a</italic> illustrates how regions of low-coverage RNA-seq can result in fragmented 3′ UTR assemblies reported by Cufflinks and Scripture. There is an annotated repetitive element coinciding with the position of the gap, which could explain the observed decrease in coverage at this location, due to ambiguous read mappability. (<italic>B</italic>) <italic>Hdlbp</italic> illustrates a gene with tandem polyadenylation sites that is not completely annotated using either Cufflinks or Scripture. The Ensembl 73 annotation contains transcript models with alternative short/long 3′ UTR isoforms, and the relative abundance of these isoforms is reflected by the pattern of RNA-seq depth. However, neither Cufflinks nor Scripture is able to assemble the short isoform; both exclusively report the long isoform. (<italic>C</italic>) The maximum marginal likelihood segmentation is computed using a dynamic programming algorithm that recursively computes <italic>Q</italic>(<italic>t</italic>), the likelihood of the optimal segmentation of the subsequence of observations <italic>y</italic><sub><italic>t</italic></sub><sub>:<italic>n</italic></sub>, given that there is a change point at position <italic>t</italic> − 1. This graphic illustrates how the value of <italic>Q</italic>(<italic>t</italic>) at each position in the sequence is decomposed into a component representing the likelihood of sequences of the data starting at position <italic>t</italic> (red) and the maximum likelihood segmentation of the remainder of the data (blue), and a component representing the likelihood that there are no change points in the sequence <italic>y</italic><sub><italic>t</italic></sub><sub>:<italic>n</italic></sub> (green). RNA-seq data are shown for the <italic>Ict1</italic> gene, which utilizes tandem alternative 3′ ends, both of which are supported by 3′-seq data. (<italic>D</italic>) Toy data are used to illustrate the effect of constraints on the segmentation process. <italic>Above</italic>, the scatter plot displays simulated coverage data, with a local region of low coverage indicated by the bracket at <italic>top</italic>. <italic>Below</italic>, vertical lines indicate location of change points identified using the standard and constrained formulations of the change-point inference algorithm, where red lines indicate locations of decreased coverage and green lines indicate the locations of increased coverage. The unconstrained solution identifies both the local dip and the most distal change point, while the constrained solution reports the most likely configuration of change points that conforms to the requirement for monotonically decreasing coverage in sequential segments.</p>
        </caption>
        <graphic xlink:href="14f01"/>
      </fig>
      <p>Given the unique challenges associated with transcript assembly within 3′ UTRs, and to address the limitations of existing tools, we developed a more expressive framework for transcript assembly that incorporates information from the patterns of read coverage into the process of UTR boundary definition. If we assume that sequenced reads are distributed approximately uniformly across the transcript, the boundaries of transcription will be marked by a change in the level of coverage. In instances where a shorter exon is nested within a longer exon, there can still be a significant number of reads aligning downstream from the shorter isoform, creating a “step-like” pattern of coverage at the boundary of the nested exon model. For example, RNA-seq data for the <italic>Hdlbp</italic> and <italic>Ict1</italic> genes show such drop-offs within their 3′ UTRs, indicative of tandem APA events (<xref ref-type="fig" rid="SHENKERRNA046037F1">Fig. 1</xref>B,C).</p>
      <p>To identify terminal exon boundaries, we thus seek critical points (“change points”) that mark transitions in RNA-seq coverage. Previously, segmentation approaches were used to identify transcript boundaries from tiling microarray probe intensities (<xref rid="SHENKERRNA046037C16" ref-type="bibr">Huber et al. 2006</xref>), and while these change points have been described in RNA-seq data (<xref rid="SHENKERRNA046037C28" ref-type="bibr">Nagalakshmi et al. 2008</xref>), no existing RNA-seq ab initio transcript assembly tool fully leverages this information to annotate 3′ UTR boundaries. To fill this gap, we adapt multiple change-point inference to the problem of 3′ UTR isoform identification.</p>
    </sec>
    <sec id="s2b">
      <title>Inference for multiple change-point problems</title>
      <p>To implement change-point inference, we made use of a Bayesian framework for change-point inference established previously (<xref rid="SHENKERRNA046037C11" ref-type="bibr">Fearnhead 2006</xref>). For a sequence of <italic>n</italic> observations <italic>y</italic><sub>1:<italic>n</italic></sub> = <italic>y</italic><sub>1</sub>,…,<italic>y</italic><sub><italic>n</italic></sub> representing the level of coverage at sequential genomic positions, we consider all possible combinations of <italic>m</italic> change points τ<sub>1</sub>,…,τ<sub><italic>m</italic></sub> where 0 &lt; τ<sub><italic>i</italic></sub> &lt; <italic>n</italic> and τ<sub><italic>i</italic></sub> &lt; τ<sub><italic>i</italic></sub><sub>+1</sub>, and 0 ≤ <italic>m</italic> &lt; <italic>n</italic>, such that the <italic>j</italic>th segment pertains to the observed level of coverage between two successive change points. We assume that the level of coverage observed at each position within a segment are independent samples from a common probability distribution <italic>f</italic>(<italic>x</italic>|θ), parameterized by θ, with prior distribution π(θ). To model the expected length of a segment, we define a probability mass function <italic>g</italic>(<italic>t</italic>) for the length <italic>t</italic> of the genomic segment between two successive change points, with a cumulative mass function <mml:math id="il01"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math>. Given this probability model, the goal of change-point inference is to identify the set of change points that maximizes the marginal likelihood of the data, i.e., the set of change points that “best explain” the observed pattern of read coverage.</p>
      <p>To achieve this, we implemented a dynamic programming algorithm that recursively calculates the maximum marginal likelihood solution for nested subsequences of the observations. To begin, for all indices in a subsequences <italic>y</italic><sub><italic>t</italic></sub><sub>:<italic>s</italic></sub>, such that 0 ≤ <italic>t</italic> ≤ <italic>s</italic> ≤ <italic>n</italic> we calculate a marginal likelihood <italic>P</italic>(<italic>t</italic>,<italic>s</italic>) that the observations <italic>y</italic><sub><italic>t</italic></sub><sub>:<italic>s</italic></sub> were sampled from a common distribution as the integral of the joint data likelihood over the possible parameter values within that segment:
<disp-formula id="SHENKERRNA046037M1"><label>(1)</label><graphic xlink:href="14eq01.jpg" position="float" orientation="portrait"/></disp-formula>
The most likely segmentation using this model is defined recursively in terms of the likelihood of the current segment (<xref ref-type="fig" rid="SHENKERRNA046037F1">Fig. 1</xref>C, red bracket), and the likelihood of the remainder of the data (<xref ref-type="fig" rid="SHENKERRNA046037F1">Fig. 1</xref>C, blue bracket), and alternately, the likelihood of the remainder of the data coming from a single segment (<xref ref-type="fig" rid="SHENKERRNA046037F1">Fig. 1</xref>C, green bracket). This requires the construction of two tables <italic>Q</italic>(<italic>t</italic>) and <italic>R</italic>(<italic>t</italic>) of length <italic>n</italic>, indexed by <italic>t</italic>, the location of the start of the current segment. <italic>Q</italic>(<italic>t</italic>) stores the maximum marginal likelihood of a segmentation of the subsequence of observations from <italic>y</italic><sub><italic>t</italic></sub><sub>:<italic>n</italic></sub>, given a change point at <italic>t</italic> − 1, while <italic>R</italic>(<italic>t</italic>) stores the index of the next change point in the maximum marginal likelihood segmentation, given a change point at <italic>t</italic> − 1. These tables can be recursively computed in <italic>O</italic>(<italic>n</italic><sup>2</sup>) operations using the formulas:
<disp-formula id="SHENKERRNA046037M2"><label>(2)</label><graphic xlink:href="14eq02.jpg" position="float" orientation="portrait"/></disp-formula>
<disp-formula id="SHENKERRNA046037M3"><label>(3)</label><graphic xlink:href="14eq03.jpg" position="float" orientation="portrait"/></disp-formula>
The sequence of change points can be recovered by performing a trace-back through table <italic>R</italic>(<italic>t</italic>); the location of the first change point τ<sub>1</sub> is given by <italic>R</italic>(1), and subsequent change points are given by τ<sub><italic>j</italic> + 1</sub> = <italic>R</italic>(τ<sub><italic>j</italic></sub>), while τ<sub><italic>j</italic></sub> &lt; <italic>n</italic>. A more detailed derivation of these equations along with proofs is given previously (<xref rid="SHENKERRNA046037C11" ref-type="bibr">Fearnhead 2006</xref>).</p>
    </sec>
    <sec id="s2c">
      <title>Constraining the location of change points</title>
      <p>Although the change point model is able to tolerate a degree of variation within each segment, real RNA-seq data contain sequencing biases that can cause the sampling of reads across the transcript body to deviate from a uniform distribution. These biases typically cause short segments of the transcript to be sequenced at a lower frequency, resulting in a local drop in the level of coverage. The conventional (unconstrained) implementation of the change-point detection procedure identifies these local in-homogeneities in coverage as a segment with a distinct coverage distribution. However, in the context of annotating terminal exon boundaries we wish to disregard these local aberrations as they do not correspond to terminal exon boundaries. In order to minimize the effect of local biases on transcript model inference we introduce additional constraints to the change-point identification procedure.</p>
      <p>To distinguish local changes from change points that mark a sustained decrease in the level of coverage, we restrict the set of identified change points to conform to a pattern of monotonically decreasing coverage over sequential segments. Solutions satisfying this requirement are achieved by discarding any configurations of change points in which the fold change in the level of coverage between two neighboring segments is less than a specified fold-ϕ.</p>
      <p>This constraint is implemented by modifying the recursions in Equations <xref ref-type="disp-formula" rid="SHENKERRNA046037M2">2</xref> and <xref ref-type="disp-formula" rid="SHENKERRNA046037M3">3</xref>. To do so, we introduce the functions <italic>M</italic>(<italic>t</italic>,<italic>s</italic>) to represent a point estimator of the level of coverage for observations <italic>y</italic><sub><italic>t</italic></sub><sub>:<italic>s</italic></sub>, and <italic>C</italic>(<italic>s</italic>) to represent the maximum estimated coverage of the most likely segmentation of observations <italic>y</italic><sub><italic>s</italic></sub><sub>:<italic>n</italic></sub>, respectively. We enforce this constraint by assigning zero probability to all configurations in which the estimated coverage of a downstream segment exceeds the estimated coverage of an upstream segment. Formally, this requires replacing the unconstrained recursions (Equations <xref ref-type="disp-formula" rid="SHENKERRNA046037M2">2</xref> and <xref ref-type="disp-formula" rid="SHENKERRNA046037M3">3</xref>), with constrained versions (Equations <xref ref-type="disp-formula" rid="SHENKERRNA046037M4">4</xref> and <xref ref-type="disp-formula" rid="SHENKERRNA046037M5">5</xref>).
<disp-formula id="SHENKERRNA046037M4"><label>(4)</label><graphic xlink:href="14eq04.jpg" position="float" orientation="portrait"/></disp-formula>
<disp-formula id="SHENKERRNA046037M5"><label>(5)</label><graphic xlink:href="14eq05.jpg" position="float" orientation="portrait"/></disp-formula>
Here, a parameterization ϕ = 1 corresponds to a requirement that the level of coverage of sequential segments are strictly decreasing, while ϕ = 2 the level of coverage of sequential segments drops at least twofold at each change point. The consequences of including these constraints are illustrated for a toy example in <xref ref-type="fig" rid="SHENKERRNA046037F1">Figure 1</xref>D. In this scenario, a hypothetical 3′ UTR has relatively uniform coverage, except for a local region (<xref ref-type="fig" rid="SHENKERRNA046037F1">Fig. 1</xref>D, bracket), where read coverage is underrepresented. When the unconstrained implementation of change-point detection procedure is applied to identify polyadenylation sites within the last exon, it detects two locations where the coverage drops, one upstream of the underrepresented segment, and the other at the polyadenylation site of the hypothetical exon. While this accurately reflects the observed pattern of coverage, for the purpose of polyadenylation site annotation, we are only interested in the location of the second change point.</p>
      <p>Application of the constrained segmentation procedure has the desired effect; a change point is reported at the position of the polyadenylation site, while the change point caused by the local drop in coverage is omitted. While this limits the ability to identify arbitrary combinations of change points, reads sampled from tandem terminal exon isoforms are expected to produce a “step-like” coverage pattern. Thus, this constraint is intended to promote sensible inference of change-point location in situations where read distributions deviate from a theoretically uniform sampling across the transcript body.</p>
    </sec>
    <sec id="s2d">
      <title>Implementing change-point detection for 3′ UTR annotation</title>
      <p>In order to implement the described change-point inference algorithm, one needs to specify the distributions <italic>f</italic>(<italic>y</italic><sub><italic>i</italic></sub>|θ), π(θ), and <italic>g</italic>(<italic>t</italic>). While the depth of sequencing coverage is a discrete counting process and would typically be modeled using a Poisson distribution, it has been suggested that read counts from sequencing data are overdispersed, and are more appropriately modeled by a Negative Binomial distribution (<xref rid="SHENKERRNA046037C2" ref-type="bibr">Anders and Huber 2010</xref>). Therefore, we model <italic>f</italic>(<italic>y</italic><sub><italic>i</italic></sub>|θ) ∼ <italic>NB</italic>(<italic>p</italic>,<italic>r</italic>), and use an uninformative conjugate prior π(<italic>p</italic>) ∼ β(1,1), which allows for analytical integration of Equation <xref ref-type="disp-formula" rid="SHENKERRNA046037M1">1</xref>.</p>
      <p>While the procedure described above efficiently identifies optimal sets of change points, these do not by themselves provide meaningful transcript models. For this reason the change points need to be interpreted in the context of the exon that they occur. For example, a transition from high-to-low coverage (over increasing genomic coordinates) would suggest the presence of a polyadenylation site on the plus strand, and vice versa for a gene on the minus strand. To enable application of change-point detection in an ab initio setting, prior to segmentation, covered genomic segments and spliced reads are used to identify regions that will be searched for change points. The output, including inferred overlapping terminal exons models, is reported in a compact splice graph. This graph identifies exon boundaries and connections between exons supported by spliced reads. The stages of the IsoSCM annotation algorithm are illustrated in <xref ref-type="fig" rid="SHENKERRNA046037F2">Figure 2</xref>.</p>
      <fig id="SHENKERRNA046037F2" orientation="portrait" position="float">
        <label>FIGURE 2.</label>
        <caption>
          <p>Implementation of the IsoSCM analysis pipeline. (<italic>A</italic>) The sequence of steps IsoSCM uses to build a splice graph are illustrated as a flow chart, starting from a set of reads that have been mapped to a genome using splice-aware alignment software. (<italic>B</italic>) The assembly operations from the flow chart at <italic>left</italic> are illustrated for a prototypical gene with tandem 3′ ends. These steps are (1) identification of segments of the genome where continuous read coverage is observed; if paired end reads information is available mate-pairs will be used to scaffold segments together. Locations with expected low coverage (i.e., repetitive elements or low-complexity sequence) can also be used to scaffold segments separated by gaps. (2) The location of splice junctions is recovered from the mapped reads; (3) the boundaries of spliced exons are inferred by intersecting continuously transcribed regions with the positions of splice junctions; (4) change points in the level of coverage are identified, using the constrained segmentation procedure; (5) terminal exon structure is inferred from change-point location; (6) the assembled splice-graph is reported, where exons are labeled as elements of a common transcription unit if they are connected either by spliced reads, or occupy overlapping genomic segments.</p>
        </caption>
        <graphic xlink:href="14f02"/>
      </fig>
    </sec>
    <sec id="s2e">
      <title>Method evaluation: simulated data</title>
      <p>To assess the benefit of incorporating coverage-based segmentation for terminal exon annotation, we compared the performance of IsoSCM with two widely used ab initio reference based annotation tools: Cufflinks (<xref rid="SHENKERRNA046037C32" ref-type="bibr">Trapnell et al. 2010</xref>) and Scripture (<xref rid="SHENKERRNA046037C13" ref-type="bibr">Guttman et al. 2010</xref>). We prepared a test set using simulated data, where the transcript structures underlying the sequencing data are known a priori (illustrated in Supplemental Fig. 1A). This test set was comprised of 14,263 nonoverlapping genes, based on transcript models obtained from the mouse Ensembl 73 release. For each gene, we selected a single-transcript isoform, and generated a new isoform by randomly truncating the terminal exon at a random position that was at least 150 nt from both the 5′ and 3′ boundaries of the original exon.</p>
      <p>As we expect the accuracy of assembled models to relate to sequencing depth, we measured the performance of each method over a range of coverage levels. For each pair of isoforms we simulated reads sampled uniformly across the body of the transcript, such that the aggregate density of reads over exonic segments was 2000 reads per kilo base (kb). This library was recursively subsampled such that evaluations spanned a range of read densities from 5 to 2000 reads/kb. For each simulated data set, we used IsoSCM, Cufflinks, and Scripture to assemble a set of predicted transcript models. For each assembly we assessed the correctness of 3′ UTR predictions by classifying assembled terminal exons as true positives (TP), true negatives (TN), false positives (FP), and false negatives (FN) with respect to the reference ground truth transcript set.</p>
      <p>Since it is difficult to predict nested terminal exon boundaries with nucleotide-level accuracy from RNA-seq data, and there is value in an annotation that is “close” to the true transcript model, we use a classification scheme that allows a degree of flexibility. In contrast to the relatively generous assessment scheme used by the RGASP project (<xref rid="SHENKERRNA046037C31" ref-type="bibr">Steijger et al. 2013</xref>), which required only the spliced 5′ boundary of the terminal exon to match the reference and disregards the predicted 3′ end, we require both 5′ and 3′ boundaries to be similar to reference models. We classified predictions that are within a small (100 nt) distance of a reference model to be correct by dividing the interval spanning the terminal exon into segments that are positive or negative for polyadenylation, such that assemblies can be judged for their consistency with these segments (Supplemental Fig. 1C). The genomic segments within 100 nt of a reference 3′ ends were counted as TPs if an assembled 3′ end fell within that segment, and were otherwise counted as FN. Likewise, segments &gt;100 nt from a reference end were counted as FP if an assembled 3′ end fell within that segment, and TN otherwise. Using these counts we calculated the PPV = TP/TP + FP, TPR = TP/TP + FN, FPR = FP/FP + TN, NPV = TN/TN+ FN, for each assembly.</p>
      <p>These metrics are plotted as a function of sequencing depth in <xref ref-type="fig" rid="SHENKERRNA046037F3">Figure 3</xref>A,B and Supplemental Figure 2. In these simulations, IsoSCM identifies the terminal exon boundaries with a PPV comparable to Cufflinks and Scripture at all sequencing depths, indicating that the change-point inference procedure does not inappropriately increase the number of false positives compared with methods that attempt to assemble only a single 3′ UTR isoform. In contrast, comparisons of the TPR achieved by each method highlight the fact that the models built by Cufflinks and Scripture were unable to annotate tandem terminal exons. Even as the number of available reads is increased toward infinity, the maximum TPR achieved by these methods was 0.5. A priori, we expect that Cufflinks and Scripture cannot exceed this level of sensitivity since the gene models they build are not expressive enough to represent tandem overlapping terminal exons, and one out of every two 3′ terminal exons in the test set is nested within a longer exon. In contrast, given sufficient data to statistically identify changes in the level of coverage, IsoSCM is able to achieve perfect TPR for the test set (<xref ref-type="fig" rid="SHENKERRNA046037F3">Fig. 3</xref>A).</p>
      <fig id="SHENKERRNA046037F3" orientation="portrait" position="float">
        <label>FIGURE 3.</label>
        <caption>
          <p>Comparison of IsoSCM with existing transcript assembly methods. (<italic>A</italic>,<italic>B</italic>) Simulated RNA-seq data were used to assess predictive positive value (<italic>A</italic>) and true positive rate (<italic>B</italic>) of IsoSCM, Cufflinks, and Scripture outputs for 3′ end prediction. We generated a set of 14,263 nonoverlapping gene models that contain transcripts with nested 3′ terminal exons, and used these as a reference set of “true” transcripts. These metrics were calculated for simulated sequencing depths ranging from 5 to 2000 reads/kb. (<italic>C</italic>,<italic>D</italic>) We assessed the positional accuracy of IsoSCM outputs across a range of change-point magnitudes. We partitioned these events into quintiles (with <italic>n</italic> = 3005 termini in each group), corresponding to bins of &lt;4<italic>x</italic>, 4–10<italic>x</italic>, 10–40<italic>x</italic>, 40–175<italic>x</italic>, and ≥175<italic>x</italic> drop-offs in read coverage. For each group the fraction of predicted termini with either canonical polyadenylation signals (PAS, AATAAA, or ATTAAA) or 3′-seq tags within 20 nt are shown at each position relative to the predicted boundary. Based on signals for appropriate positional enrichment, we utilized the top four cutoffs for running IsoSCM. (<italic>E</italic>) Proximity of IsoSCM, Cufflinks, and Scripture terminal outputs relative to Ensembl 3′ end annotations. The cumulative number of annotations at each distance to the closest Ensembl 3′ end is plotted. Based on apparent inflection points (dashed lines), we categorize annotations within 20 nt of Ensembl as precise annotations, and ones between 20 and 100 nt as imprecise matches to reference models. (<italic>F</italic>) Validation of IsoSCM, Cufflinks, and Scripture terminal outputs within ±20-nt windows of various types of supporting evidence. Ends were initially assigned, if possible, to Ensembl models, and then checked for proximity to PAS and/or 3′-seq tags. Of the remaining termini with “no evidence,” many would be validated using a relaxed 100-nt window. As the largest numbers of these correspond to “imprecise” calls of Ensembl ends (see <italic>E</italic>), we marked their numbers as sub-bars in the “no evidence” category. Regardless of the type or types of evidence considered, IsoSCM yields the largest numbers of validated termini without inflating numbers of unvalidated predictions.</p>
        </caption>
        <graphic xlink:href="14f03"/>
      </fig>
      <p>We explored TPR, PPV, NPV, FPR measurements further, by subdividing the aggregate performance on the entire test set into component corresponding to proximal and distal isoforms exclusively (Supplemental Fig. 2). The methods performed comparably for the task of distal isoform identification, and the performance gain achieved by IsoSCM corresponds to an increased number of correct annotations of nested isoforms. To explore the relationship between sequencing depth and annotation accuracy we repeated the evaluation, requiring that predictions be within 10 nt of the reference transcript to be classified as TP. Under these conditions, we observed qualitatively the same pattern; only IsoSCM is able to reconstruct the nested isoforms correctly (Supplemental Fig. 3). However, while a sequencing depth of 200 reads/kb was sufficient to achieve a TPR = 0.9 and FPR = 0.1 with 100-nt resolution, this level of performance required over 1000 reads/kb at the 10-nt resolution. We note that all methods fail to reliably assemble low expressed transcripts, and that the advantages of IsoSCM are more fully realized when there are sufficient data to distinguish overlapping isoforms. Nevertheless, IsoSCM performs equally or better to Cufflinks and Scripture over a range of sequencing depths.</p>
    </sec>
    <sec id="s2f">
      <title>Method evaluation: real RNA-seq data</title>
      <p>Of course, we do not expect experimentally generated RNA-seq data to be as well-behaved as simulated data. To verify that the benefits observed in our simulation experiment are achieved when IsoSCM is applied to real RNA-seq data, we utilized published RNA-seq data comprised of nine mouse tissues analyzed in triplicates (<xref rid="SHENKERRNA046037C23" ref-type="bibr">Merkin et al. 2012</xref>). In contrast to the simulation experiment, the ground truth set of transcripts expressed in each sample is not known a priori. As a first measure of model correctness, we compared the terminal boundaries of constructed transcript models with those in the Ensembl 73 reference annotation. However, as existing 3′ UTR reference annotations are incomplete (<xref rid="SHENKERRNA046037C25" ref-type="bibr">Miura et al. 2013</xref>), we expect that sole comparisons to the Ensembl reference to inflate FPR estimates. Therefore, we sought additional orthogonal sources of evidence to support predicted polyadenylation sites. Directed 3′-sequencing (3′-seq) protocols permit experimental mapping of polyadenylation sites, and we used an atlas of 3′-seq data from multiple mouse tissues (<xref rid="SHENKERRNA046037C8" ref-type="bibr">Derti et al. 2012</xref>). As well, cleavage and polyadenylation sites have long been known to be associated with a polyadenylation signal (PAS) hexamer (<xref rid="SHENKERRNA046037C29" ref-type="bibr">Proudfoot and Brownlee 1976</xref>), most frequently either AATAAA or ATTAAA, located ∼21 upstream of the cleavage site. While such motifs are not sufficient to specify 3′ end formation, we could assay PAS enrichment in the vicinity of novel 3′ end annotations as another measure of their quality.</p>
      <p>We first sought to evaluate change-point cutoffs that delivered appropriate accuracy for genuine 3′ termini. We tested this using mouse brain (SRR594393), and partitioned predicted ends into quintiles by the magnitude of the change point. We then evaluated the positional enrichment of PAS and 3′-seq data supporting these groups, to examine the genomic precision with which IsoSCM called 3′ termini. We observed robust positional enrichments of PAS and 3′-seq tags in the appropriate locations relative to IsoSCM annotations (<xref ref-type="fig" rid="SHENKERRNA046037F3">Figure 3</xref>C,D), demonstrating that these sources of evidence could be used to evaluate de novo predictions. As expected, annotated 3′ termini associated with the sharpest drops in coverage identified genuine polyadenylation sites with greatest accuracy, while positional support for PAS and 3′-seq tags was distributed more broadly for weaker change points. We focused on models for which the coverage drops at least fourfold in order to balance sensitivity and specificity of the predictions.</p>
      <p>We then compared the performance of the different transcript assembly methods on the mouse brain RNA-seq reads, from which 11,000 3′ terminal exon models were constructed by IsoSCM, 9722 by Cufflinks, and 6282 by Scripture. Upon examining the distribution of the distance to the closest Ensembl 3′ end for each method (<xref ref-type="fig" rid="SHENKERRNA046037F3">Fig. 3</xref>E) we observed that all three methods generate two populations of predictions distinguished by the precision with which they identify Ensembl 3′ ends. The inflection point at ∼20 nt identifies a population of predictions that capture annotated termini quite precisely, while a second inflection point at ∼100 nt identifies a set of predictions that are localized in a wider window around annotated 3′ ends (<xref ref-type="fig" rid="SHENKERRNA046037F3">Fig. 3</xref>E, “imprecise”). For many types of genome-wide analysis, i.e., when assessing general trends of transcript isoform expression, nucleotide-precise annotations of 3′ termini are not necessary. Nevertheless, as the narrow 20-nt window enables the merits of predicted models to be evaluated stringently, we assessed how frequently each method produced 3′ termini that were validated by polyadenylation site features at a distance of ±20 nt (<xref ref-type="fig" rid="SHENKERRNA046037F3">Fig. 3</xref>F).</p>
      <p>Of the total set of predictions, IsoSCM made 4785 annotations that were ±20 nt of Ensembl 3′ ends, compared with 2450 by Cufflinks and 1827 by Scripture. In addition, each method annotated thousands of termini not supported by reference models. Among these, IsoSCM identified 2718 novel termini supported by 3′-seq tags, PAS, or both features, within 20 nt, compared with 1914 identified by Cufflinks and 941 identified by Scripture (<xref ref-type="fig" rid="SHENKERRNA046037F3">Fig. 3</xref>F). These evaluations demonstrate the strong performance of IsoSCM on real RNA-seq data using a stringent cutoff. Finally, a substantial portion of the remaining termini annotated by each method (“no evidence”) could be considered validated if one utilized a broader window, e.g., 100 nt. Since the majority of these events can be defined as being “imprecise” captures of Ensembl ends, we have noted their numbers within the “no evidence” category of <xref ref-type="fig" rid="SHENKERRNA046037F3">Fig. 3</xref>F, and using the relaxed 100-nt criteria in Supplemental Figure 4A. A full accounting of the termini annotated by the three algorithms using both 20- and 100-nt windows is given in Supplemental Table 1. Overall, we find that IsoSCM correctly annotates more 3′ UTRs while simultaneously reporting the fewest unvalidated annotations, regardless of the window size used for model evaluation.</p>
      <fig id="SHENKERRNA046037F4" orientation="portrait" position="float">
        <label>FIGURE 4.</label>
        <caption>
          <p>Evaluating spatial accuracy of 3′ end predictions. Analysis of all 3′ ends reported by each method shows the frequency of 3′-seq evidence (<italic>A</italic>), canonical PAS (<italic>B</italic>), and genomic conservation (<italic>C</italic>) relative to predicted termini. The fraction of predicted 3′ end sites with the indicated type of support within 20 nt is shown at each position relative to the predicted boundary. The peak position of the PAS and 3′-seq tags are at their characteristic locations, about −21 and 0, respectively, while average PhastCons show characteristic peaked conservation at −21. All of these features are most robust for IsoSCM termini. (<italic>D</italic>–<italic>F</italic>) Positional enrichment of features examined for all method-specific ends, defined as termini that are &gt;100 nt away from those generated by the other methods. Here, IsoSCM is the only method with substantial enrichment of 3′-seq evidence (<italic>D</italic>) and PAS (<italic>E</italic>) in the appropriate locations. The IsoSCM-specific annotations also exhibit the most robust conservation signature at these termini (<italic>F</italic>). (<italic>G</italic>–<italic>I</italic>) Positional enrichment of features examined for all method-specific ends that are “substantially novel,” defined as being located &gt;250 nt from Ensembl termini and &gt;100 nt away from other method predictions. Again, IsoSCM is the only method that displays the expected enrichment of polyadenylation site features for this subset of predicted 3′ ends.</p>
        </caption>
        <graphic xlink:href="14f04"/>
      </fig>
    </sec>
    <sec id="s2g">
      <title>Positional enrichments of functional features in predicted 3′ termini</title>
      <p>To gain further insight into the resolution of the predictions made by each method, we investigated positional enrichments of PAS signals, 3′-seq reads, and conservation profiles around predicted 3′ termini. Considering all predictions of each method in aggregate, we see PAS signals enriched ∼21-nt upstream, 3′-seq tags at position 0, and a conservation profile characteristic of polyadenylation sites for all three methods (<xref ref-type="fig" rid="SHENKERRNA046037F4">Fig. 4</xref>A–C). However, when we compare the relative frequency of evidence at these positions, we see that ends predicted by IsoSCM are supported 22.6%–23.1% more frequently by 3′-seq (<xref ref-type="fig" rid="SHENKERRNA046037F4">Fig. 4</xref>A) and 19.9%–20.4% more frequently by a PAS (<xref ref-type="fig" rid="SHENKERRNA046037F4">Fig. 4</xref>B) than either Cufflinks or Scripture. The 3′ ends annotated by IsoSCM also exhibited greater overall conservation, as assessed by PhastCons (<xref ref-type="fig" rid="SHENKERRNA046037F4">Fig. 4</xref>C).</p>
      <p>Close inspection of these analyses reveal differential biases of the methods. In particular, consideration of the tail of “imprecise” PAS and 3′-seq predictions showed that they are biased to be upstream of annotations provided by Scripture, while they are more likely to be downstream from Cufflinks and IsoSCM predictions (<xref ref-type="fig" rid="SHENKERRNA046037F4">Fig. 4</xref>A,B). This suggests that Scripture has some tendency to overextend transcript models, whereas IsoSCM and Cufflinks are slightly more likely to truncate 3′ UTRs. The overextension bias observed for Scripture is a known consequence of the scan statistic used by this method to define the boundaries of transcribed regions (<xref rid="SHENKERRNA046037C16" ref-type="bibr">Huber et al. 2006</xref>). We might expect a bias toward slight truncation using IsoSCM and Cufflinks if the regions directly upstream of the polyadenylation site are underrepresented in input reads, perhaps due to a cloning, sequencing, or mapping bias. Nevertheless, the robust peaks at positions −21 and 0, for PAS and 3′-seq evidence, respectively, indicate that IsoSCM accurately localizes polyadenylation sites in the majority of its predictions, and that its performance is substantially higher than Cufflinks or Scripture.</p>
      <p>We next judged the qualities of the substantial populations of 3′ end annotations that were specific to each method. Of the 11,000 annotations of 3′ ends, IsoSCM identified 4115 termini that were &gt;100 nt away from annotations made by either Cufflinks or Scripture, and these annotations exhibit enrichment for polyadenylation site features that is comparable to the aggregate set of predictions for the three methods (<xref ref-type="fig" rid="SHENKERRNA046037F4">Fig. 4</xref>D–F). In contrast, analysis of 3′ end annotations specific to Cufflinks (<italic>n</italic> = 3717) or Scripture (<italic>n</italic> = 2962) outputs show little or no positional enrichment of 3′-seq tags (<xref ref-type="fig" rid="SHENKERRNA046037F4">Fig. 4</xref>D) or PAS (<xref ref-type="fig" rid="SHENKERRNA046037F4">Fig. 4</xref>E) at the appropriate locations. Therefore, IsoSCM identifies thousands of sites that in aggregate exhibit the expected features of 3′ ends, and are not reported by either Cufflinks or Scripture. Reciprocally, the ends that are uniquely provided by the other methods are not supported by similar evidence.</p>
      <p>Finally, we were interested to assess the quality of substantially novel, method-specific termini. As mentioned, all methods report a population of ends that localize near Ensembl termini, but do not identify cleavage sites precisely (<xref ref-type="fig" rid="SHENKERRNA046037F3">Fig. 3</xref>C). We found that positional assessments of bulk novel ends was compromised by inclusion of these “Ensembl-imprecise” termini, which create offset peaks of evidence at the boundary of the window utilized (Supplemental Fig. 4B–D). To provide clarity to these comparisons, we differentiated the population of “substantially novel” ends from imprecise annotations, by investigating predictions located &gt;250 nt from Ensembl annotations. At this distance, IsoSCM identified 2472 termini, compared with 3513 by Cufflinks and 2367 by Scripture (Supplemental Fig. 4D). To highlight the differences between methods, we focused on “substantially novel” annotations that were specific to each method. This yielded sets of IsoSCM-specific (<italic>n</italic> = 1340), Cufflinks-specific (<italic>n</italic> = 2485), and Scripture-specific (<italic>n</italic> = 1969) ends that were &gt;100 nt from each other. Analysis of these novel 3′ termini showed that only the IsoSCM-specific ends were enriched for 3′-seq tags (<xref ref-type="fig" rid="SHENKERRNA046037F4">Fig. 4</xref>G) and PAS (<xref ref-type="fig" rid="SHENKERRNA046037F4">Fig. 4</xref>H), whereas the other sets of method-specific ends were not distinguishable from background. As well, the IsoSCM-specific novel ends exhibited the highest level of genomic conservation (<xref ref-type="fig" rid="SHENKERRNA046037F4">Fig. 4</xref>I).</p>
    </sec>
    <sec id="s2h">
      <title>Robust performance of IsoSCM across data sets</title>
      <p>To assess if the performance differences we observed are representative, we used the framework for evaluating transcript assemblies from the simulation experiment to compare the performance of each method for 26 other mouse tissue RNA-seq data sets (<xref rid="SHENKERRNA046037C23" ref-type="bibr">Merkin et al. 2012</xref>). To provide a compact visualization of the evaluation, we used evidence of Ensembl terminal exons, 3′-seq, and PAS within ±20 nt to define sets of true and false predicted 3′ ends and plotted the differences in TPR and PPV obtained using IsoSCM and Cufflinks or Scripture in <xref ref-type="fig" rid="SHENKERRNA046037F5">Figure 5</xref>A.</p>
      <fig id="SHENKERRNA046037F5" orientation="portrait" position="float">
        <label>FIGURE 5.</label>
        <caption>
          <p>Relative performance of IsoSCM, Cufflinks, and Scripture on multiple data sets. (<italic>A</italic>) We used 26 RNA-seq data sets from nine mouse tissues to assess the ability of each method to correctly annotate 3′ terminal exons. For this analysis, we estimated the true positive rate and positive predictive value of each method by its ability to recapitulate Ensembl reference termini, or otherwise be supported by 3′-seq and/or PAS (as described in <xref ref-type="fig" rid="SHENKERRNA046037F3">Fig. 3</xref>). The sensitivity and specificity of Cufflinks and Scripture was compared with IsoSCM by subtracting the value of each metric from the value obtained using IsoSCM, such that each point represents the relative performance of a pair of methods on a single sample. Each comparison involved evaluation of 9237–22,955 3′ exon annotations (median 18,737), depending on the number expressed in each sample. For every data set comparison, the TPR and PPV of IsoSCM annotations exceed those of Cufflinks or Scripture. (<italic>B</italic>) The genes <italic>Map3k2</italic>, <italic>Aen</italic>, and <italic>Eif1ad</italic> illustrate scenarios where Cufflinks and Scripture assemble gene models that are less optimal than those reported by IsoSCM. <italic>Map3k2</italic> is a gene where a gap in RNA-seq coverage fragments the 3′ UTR of models reported by Cufflinks and Scripture, due to a repetitive element (green bar). IsoSCM is able to scaffold the complete 3′ UTR together. <italic>Aen</italic> and <italic>Eif1ad</italic> are examples of genes whose tandem polyadenylation sites are missed by Cufflinks and Scripture, but are captured by IsoSCM. IsoSCM correctly annotates the short and long 3′ UTR isoforms of both genes by identifying a change point in the level of RNA-seq coverage. In these examples, Cufflinks and Scripture annotate at most one isoform correctly, and sometimes neither. AWTAAA track indicates genomic matches to the two most common PAS, AATAAA and ATTAAA; note that many such instances are not actually functional PAS.</p>
        </caption>
        <graphic xlink:href="14f05"/>
      </fig>
      <p>While there is sample-to-sample variability in these estimated performance metrics, IsoSCM consistently achieved a TPR that is at least 12.2% higher than the other methods, without compromising the PPV. Additional metrics of predictive performance for each method, including evaluations at both the 20-nt and 100-nt resolution, are provided in Supplemental Table 2. Concrete examples illustrating how IsoSCM reduces the number of incorrectly truncated 3′ UTRs and identifies additional 3′ UTR isoforms that are missed by Cufflinks and Scripture are given in <xref ref-type="fig" rid="SHENKERRNA046037F5">Figure 5</xref>B.</p>
    </sec>
    <sec id="s2i">
      <title>Application of IsoSCM to identify tissue-differential tandem APA events</title>
      <p>To illustrate a practical application, we next applied change-point inference to examine differential usage of 3′ UTR isoforms between different tissues. In the previous section, we demonstrate that the IsoSCM segmentation strategy is effective for annotating terminal transcript boundaries within an individual sample; however, the quantification of differential isoform usage requires an accounting of all transcripts expressed among the samples being compared. When generating a single annotation that is representative of two samples, one could attempt to merge annotations assembled independently from each sample. However, it is not obvious what the optimal strategy is for combining annotations from separate samples, while preserving alternative events. For example, the <italic>cuffmerge</italic> program, available as part of the Cufflinks suite, merges transcript models that share overlapping and compatible chains of introns, and during this process discards shorter terminal exon annotations, reporting only the longest 3′ exon. While such an approach could be used to identify the longest 3′ UTR isoform, it discards potential alternative events, and is thus inappropriate for assessing tissue-differential tandem APA events.</p>
      <p>Conveniently, the change-point detection framework described above can be extended naturally to the assembly of tandem 3′ UTR boundaries from multiple samples simultaneously. To do this, we define <italic>P</italic><sub>joint</sub>, the joint likelihood of <italic>k</italic> independent samples,
<disp-formula id="SHENKERRNA046037M6"><label>(6)</label><graphic xlink:href="14eq06.jpg" position="float" orientation="portrait"/></disp-formula>
where <italic>P</italic><sub><italic>i</italic></sub> is the marginal likelihood of the <italic>i</italic>th sample. Thus, by replacing <italic>P</italic> in Equations <xref ref-type="disp-formula" rid="SHENKERRNA046037M2">2</xref> and <xref ref-type="disp-formula" rid="SHENKERRNA046037M3">3</xref> with <italic>P</italic><sub>joint</sub>, the segmentation procedure will identify the configuration of change points that maximize the joint marginal likelihood of all the samples simultaneously. Importantly, this modification enables identification of polyadenylation sites that are specific to one condition, in addition to sites that are common among the samples being compared.</p>
      <p>Previously, we and others observed that the nervous system accumulates many transcripts with longer 3′ UTR isoforms than in other tissues, whereas the testis expresses many transcripts with relatively shorter 3′ UTR isoforms (<xref rid="SHENKERRNA046037C35" ref-type="bibr">Zhang et al. 2005</xref>; <xref rid="SHENKERRNA046037C17" ref-type="bibr">Jan et al. 2011</xref>; <xref rid="SHENKERRNA046037C8" ref-type="bibr">Derti et al. 2012</xref>; <xref rid="SHENKERRNA046037C30" ref-type="bibr">Smibert et al. 2012</xref>; <xref rid="SHENKERRNA046037C33" ref-type="bibr">Ulitsky et al. 2012</xref>; <xref rid="SHENKERRNA046037C25" ref-type="bibr">Miura et al. 2013</xref>). Using the IsoSCM framework, we reexamined these observations by analyzing differential polyadenylation site usage in nine mouse tissues. By performing the joint segmentation for each pair of tissues, we identified a set of change points representing tandem polyadenylation events. For each of these events, we estimated a polyadenylation-site-usage index in each condition, representing the relative frequency with which a particular polyadenylation site is used. By calculating the difference in this index between a pair of conditions, we identified polyadenylation events with differential usage patterns among tissues. <italic>St8sia3</italic> and <italic>Sap30l</italic> typify transcripts IsoSCM identifies as being differentially polyadenylated between a pair of tissues, and are illustrated in <xref ref-type="fig" rid="SHENKERRNA046037F6">Figure 6</xref>A. By identifying global differences in the distribution of the polyadenylation-site-usage statistic at proximal sites between tissue pairs, we assessed whether there were systematic patterns of altered 3′ UTR length. Indeed, we observed clear signatures in which the termini annotated by IsoSCM were broadly extended in brain relative to all other tissues, whereas they were generally shorter in testis relative to all other tissues (<xref ref-type="fig" rid="SHENKERRNA046037F6">Fig. 6</xref>B).</p>
      <fig id="SHENKERRNA046037F6" orientation="portrait" position="float">
        <label>FIGURE 6.</label>
        <caption>
          <p>Analysis of tissue-differential APA using IsoSCM. (<italic>A</italic>) Instances of tissue-differential APA identified by IsoSCM are illustrated <italic>St8sia3</italic> and <italic>Sap30l</italic>. IsoSCM models generated by the joint segmentation procedure are compared with models assembled by Cufflinks and Scripture analyzing each tissue independently. In these examples, Cufflinks is able to recover switches in tandem polyadenylation site usage for <italic>St8sia3</italic> when comparing independent assemblies of the data sets, but does not detect the more nuanced difference with <italic>Sap30l</italic> as the short was not assembled. Scripture does not generate alternative models in either case. Since IsoSCM uses change-point detection for 3′ UTR boundary annotation, IsoSCM assembles both isoforms correctly, and is able to consistently capture these patterns. The AWTAAA track indicates genomic matches to the two most common PAS, AATAAA and ATTAAA; note that many such instances are not actually functional PAS. (<italic>B</italic>) Exon models built using IsoSCM were used to identify global patterns in differential 3′ UTR usage between nine mouse tissues. Events arising from overlapping tandem 3′ exons were used to estimate the relative usage of 3′ ends in each tissue. For all genes that are expressed in a pair of tissues, the difference in relative usage of a polyadenylation site is computed. To assess whether there are global trends toward 3′ UTR lengthening (or shortening) between tissues, the observed distribution of differences in 3′ end usage is compared with a null model that lengthening (or shortening) events are equally likely to occur in either sample. The 36 pairwise comparisons are represented in a matrix, with the tissues being compared labeled at the <italic>left</italic> of each row, and the <italic>bottom</italic> of each column. A cell shaded blue indicates that the tissue labeled at the <italic>left</italic> of the row tends to have lower usage of proximal 3′ ends than the tissue labeled at the <italic>bottom</italic> of the column, while red shading indicates the opposite pattern. Here, we see that the brain tends to use polyadenylation sites that are more distal, while the testis tends to use more proximal polyadenylation sites. (<italic>C</italic>) Neural APA event detected for <italic>Shank2</italic>; the alternative 3′ UTRs annotated by IsoSCM are supported by 3′-seq data. Probes were designed against a universal region present in both isoforms (green), and a region exclusive to the extended isoform (red). (<italic>D</italic>) Sequential Northern blotting shows that the universal probe hybridizes to two bands with estimated lengths of 8.2 and 9.7 kb, while the extension probe hybridizes only with the 9.7-kb band. These bands are consistent with the 3′ exon annotations assembled by IsoSCM, and likely correspond to the transcript ENSMUST00000105900 (8169-nt long) as well as an isoform bearing a 1.5-kb 3′ UTR extension.</p>
        </caption>
        <graphic xlink:href="14f06"/>
      </fig>
      <p>To emphasize the importance of using accurate terminal exon annotations when quantifying tandem terminal exon expression patterns, we repeated the analysis using the transcript assemblies of Cufflinks and Scripture in place of the models generated by IsoSCM. As these methods do not provide a means to assemble transcript models considering two samples simultaneously, we used the union of terminal exon models from tissues being compared to define the set of tandem polyadenylation events identified by these methods. As shown in <xref ref-type="fig" rid="SHENKERRNA046037F6">Figure 6</xref>B, there is only modest agreement between patterns identified using models built by Cufflinks and Scripture and IsoSCM. Enhanced usage of proximal polyadenylation sites in the testis was reliably recovered using Cufflinks. This is likely because the abrupt truncation events observed in testis can be captured by the Cufflinks assembly procedure, as is the case for <italic>St8sia3</italic> (<xref ref-type="fig" rid="SHENKERRNA046037F6">Fig. 6</xref>A). However, neither Cufflinks nor Scripture were able to assemble models that consistently captured the pattern of increased abundance of extended 3′ UTRs when comparing brain with other tissues (<xref ref-type="fig" rid="SHENKERRNA046037F6">Fig. 6</xref>B).</p>
      <p>Cufflinks and Scripture seek only to annotate the longest terminal isoform that is consistent with the reads, and in brain we observe many cases where both isoforms are expressed and only their relative usage changes between tissues. In such cases, it is expected that the short 3′ UTR isoform will not be captured by these methods. This is illustrated by the gene <italic>Sap30l</italic> in <xref ref-type="fig" rid="SHENKERRNA046037F6">Figure 6</xref>A, for which both a short and long isoform are expressed in brain and liver, but there is a higher proportion of isoforms bearing the extended 3′ UTR in the brain. In this case, using Cufflinks or Scripture this alternative event is not identified, since neither method annotates the short isoform correctly.</p>
      <p>We previously provided extensive molecular validation of neural 3′ UTR lengthening events of a similar quality to those identified by the IsoSCM pipeline, although those APA events were previously cataloged by a combination of visual annotation and partially automated procedures (<xref rid="SHENKERRNA046037C30" ref-type="bibr">Smibert et al. 2012</xref>; <xref rid="SHENKERRNA046037C25" ref-type="bibr">Miura et al. 2013</xref>). Along these lines, we tested a 3′ UTR extension for <italic>Shank2</italic> identified by IsoSCM (<xref ref-type="fig" rid="SHENKERRNA046037F6">Fig. 6</xref>C) by Northern blot. We designed double stranded DNA probes that either hybridize to the region common to both transcripts (“uni”), or that exclusively recognizes the extended 3′ UTR isoform (“ext”). Based on the predicted size of the full-length transcript differing only in the 3′ boundary of the terminal exon, we expect full-length transcripts of length 8.2 and 9.7 kb. Northern blotting showed that the common probe hybridize to two dominant bands that are consistent with these lengths, while extension-specific probe hybridizes exclusively to the longer RNA species (<xref ref-type="fig" rid="SHENKERRNA046037F6">Fig. 6</xref>D), confirming our inference of tandem terminal exon boundaries from stepped patterns of RNA-seq coverage. Overall, these analyses are consistent with previously described patterns of tissue-specific APA, and suggest that the methodology encapsulated by IsoSCM can be readily applied in other settings to gain new insights into alternative 3′ UTR isoform regulation.</p>
    </sec>
  </sec>
  <sec sec-type="conclusion" id="s3">
    <title>CONCLUSIONS</title>
    <p>The inference of transcript structures from short RNA-seq reads is a complex problem, particularly for the identification of 3′ UTR boundaries. As we have illustrated, confounding factors such as the presence of repetitive sequences, overlapping coexpressed isoforms, and nonuniform coverage patterns make the identification of 3′ UTR boundaries from RNA-seq data a nontrivial problem. These issues are exacerbated by the absence of a framework to incorporate observed patterns of read depth into the transcript assembly process. To address these challenges and the limitations of existing tools, we developed IsoSCM. By benchmarking IsoSCM against state of the art methods for transcript assembly on simulated and experimentally generated RNA-seq data sets, we have demonstrated by several measures that the performance of IsoSCM is superior to existing tools for 3′ UTR reconstruction. Although evaluations indicate substantial benefits of change-point inference, we reiterate that the advantages of IsoSCM are manifest where sufficient levels of isoform expression exist, and that it does not correctly identify 3′ UTR isoforms if the level of coverage over exonic segments is not proportional to isoform abundance. These are indeed general challenges for ab initio transcript assemblers. Nevertheless, we show that IsoSCM consistently identifies thousands of functionally supported 3′ termini in excess of Cufflinks and Scripture, and reduces the number of false predictions reported.</p>
    <p>The improvement in sensitivity and accuracy of reconstructed transcript models gained by using IsoSCM has implications beyond transcriptome annotation. A major application of RNA-seq technologies is for the inference of alternative isoform regulation, and these inferences require accurate gene models. By analyzing a panel of RNA-seq samples from different tissues, we demonstrate how previously observed patterns of APA are faithfully recapitulated by IsoSCM. Moreover, by extending the constrained change-point detection procedure we developed for single-sample annotation to the joint analysis of two samples, we obtain an effective method to detect and annotate differential APA in an ab initio setting. Notably, these patterns are not recovered using existing tools for transcript reconstruction, because these methods are by design not expressive enough to annotate tandem 3′ UTR isoforms.</p>
    <p>While this work was in revision, Wagner and colleagues reported their algorithm DaPars and used it to identify genes with altered polyadenylation patterns following CFIm25 knockdown and in glioblastoma (<xref rid="SHENKERRNA046037C22" ref-type="bibr">Masamha et al. 2014</xref>). While their work also exploits change points in RNA-seq data, it provides only a subset of the functionalities of IsoSCM, making direct comparisons of the methods difficult. A significant advantage of IsoSCM is that it operates in an ab initio setting, and its accuracy does not depend on the quality and completeness of a reference annotation. Even for the well-annotated mouse transcriptome, dominant isoforms are missing (i.e., the extended isoform of <italic>Sap30l</italic>) (<xref ref-type="fig" rid="SHENKERRNA046037F6">Fig. 6</xref>A), and could only be analyzed using ab initio methods such as IsoSCM. For many species, especially nonmodel organisms, 3′ UTR models are incomplete or absent, precluding the application of DaPars to these transcriptomes. The generality of IsoSCM will enable change-point analysis to be applied to APA in a wider scope of problems.</p>
    <p>While IsoSCM utilizes only RNA-seq to identify 3′ ends, there also exist specialized protocols for high-throughput mapping of 3′ UTR boundaries by direct cloning and sequencing of 3′ ends. Clearly such methods provide greater and more direct information on 3′ ends. However, as these strategies are technically more complicated than conventional RNA-seq protocols, the available 3′-seq data are only a small fraction of the aggregate RNA-seq data that are available for diverse organisms. We present IsoSCM as a methodological advance for ab initio 3′ end identification that can take advantage of existing RNA-seq data and extend its analysis beyond current algorithms. The refinement of 3′ UTR boundaries provided by IsoSCM provides greater accuracy and more systematic accounting of 3′ end processing, and enables diverse studies of differential APA using the wealth of RNA-seq data now available.</p>
  </sec>
  <sec sec-type="materials|methods" id="s4">
    <title>MATERIALS AND METHODS</title>
    <sec id="s4a">
      <title>RNA-seq simulations</title>
      <p>A graphic overview of the simulation framework is given in Supplemental Figure 1A. To generate a set of reference transcript models with tandem polyadenylation events we selected 14,263 nonoverlapping transcript models that contain a terminal exon at least 500-nt long from the Ensembl 73 annotation for RNA-seq simulations. Within the last exon of each transcript model, a truncated isoform was generated by uniformly sampling a position at least 150 nt from both 5′ and 3′ exon boundaries, and generating a new model sharing the complete upstream exon structure, while bearing a terminal exon truncated to this sampled position. Unstranded 50-nt single end reads were simulated by sampling alignment start positions uniformly across the body of the transcript until a target depth of 2000 reads/kb of exonic sequence (94,962,730 reads total) was reached. This library was recursively subsampled to generate a test set spanning the range of depths (5, 7.5, 10, 20, 30, 40, 50, 100, 200, 400, 600, 800, 1000, 2000) reads/kb (Supplemental Fig. 1B).</p>
    </sec>
    <sec id="s4b">
      <title>Evaluation of transcript models</title>
      <p>For each method, we assessed the quality of 3′ terminal exon assemblies of annotated protein coding genes. After identifying assembled 3′ terminal exon models for each method that shared a 5′ splice boundary with the terminal coding exon of an expressed gene from the Ensembl 73 annotation, we assessed the extent to which that annotation is supported by various types of evidence. For each predicted 3′ end we assessed whether an Ensembl 73 annotation, 3′-seq tag, or polyadenylation signal were detected within a short distance of the predicted boundary of the 3′ UTR. We assessed evidence supporting assembled exon model using both a stringent (20 nt) and relaxed (100 nt) windows. Annotations from one method that were within 100 nt of an annotation made by another method were defined to be common between those methods, while annotations that were &gt;100 nt from an annotation made by any other method were considered to be method-specific ends. The number of distinct 3′ ends was counted, such that a 3′ end that was common between two terminal exon models was only counted once.</p>
      <p>To calculate the positional enrichment of polyadenylation signals and 3′-seq data, all annotations of terminal exons of known protein coding genes were aligned with their 3′ boundary at position 0. At each position in a 200-nt window upstream of and downstream from each annotation, we calculated the fraction of sequences that have either a PAS or 3′-seq evidence within 20 nt of that position. For the PAS we considered the two most frequent motifs, AATAAA and ATTAAA, and at the terminally aligned position of a 3′-seq read was used as the position for 3′-seq evidence.</p>
    </sec>
    <sec id="s4c">
      <title>Transcript assembly</title>
      <p>Cufflinks 2.2.0 was downloaded from <uri xlink:href="http://cufflinks.cbcb.umd.edu/downloads/cufflinks-2.2.0.Linux_x86_64.tar.gz">http://cufflinks.cbcb.umd.edu/downloads/cufflinks-2.2.0.Linux_x86_64.tar.gz</uri>, and was run with the default parameters, except that --library-type fr-firststrand was provided to indicate the strandedness of the sequencing data, and the --overlap-radius was set to 100 bp.</p>
      <p>The scripture-beta2.jar was downloaded from ftp://ftp.broadinstitute.org/pub/papers/lincRNA/scripture-beta2.jar. Scripture was run on each chromosome independently, with the default parameters except that 48 GB of memory was allocated, as smaller allocations resulted in “out of memory” errors. The resulting bed files from assemblies for each chromosome were concatenated to form the final assembly for each sample.</p>
    </sec>
    <sec id="s4d">
      <title>Data sets analyzed</title>
      <p>Sequencing fastq files with RNA-seq (GSE41637) (<xref rid="SHENKERRNA046037C23" ref-type="bibr">Merkin et al. 2012</xref>) and 3′-seq GSE30198 (<xref rid="SHENKERRNA046037C8" ref-type="bibr">Derti et al. 2012</xref>) were downloaded from GEO. Reference genome sequences were downloaded from Ensembl, ftp://ftp.ensembl.org/pub/release-73/fasta/. RNA-seq was mapped to the genome using Tophat2 with default parameters, except that an Ensembl 73 reference annotation was provided with the -G option, and the --segment-length was set to 20. Bowtie was used to map the 3′-seq data, with the default parameters.</p>
    </sec>
    <sec id="s4e">
      <title>Identification of tissue differential APA events</title>
      <p>For each pair of tissues, a joint segmentation of the two samples was computed. For each change point identified between a pair of conditions, we calculated the magnitude of change in the level of coverage in each condition. From these values a usage score (<italic>U</italic>) was calculated as <italic>U</italic> = 1 − (cov<sub>dn</sub>/cov<sub>up</sub>), where cov<sub>up</sub> and cov<sub>dn</sub> are point estimates of the level of read density in the segments upstream of and downstream from the change point, respectively. The differential usage between conditions <italic>A</italic> and <italic>B</italic> was calculated as the difference in the estimated usage at that change point, <italic>U</italic><sub>Δ<italic>AB</italic></sub> = <italic>U</italic><sub><italic>A</italic></sub> − <italic>U</italic><sub><italic>B</italic></sub>.</p>
    </sec>
    <sec id="s4f">
      <title>Northern analysis</title>
      <p>We used PCR to amplify universal and proximal regions of the predicted isoforms of <italic>Shank2</italic> using these primer sets.
<list list-type="simple"><list-item><p>shank2_uni; GGACCTCTTTGGCTTGAACC</p></list-item><list-item><p>shank2_uni; CTATGGCAGCCTCTGAGACC</p></list-item><list-item><p>chr7:151606740-151607287</p></list-item><list-item><p>shank2_ext2; GGGAGCAGAAGACTGAGTGG</p></list-item><list-item><p>shank2_ext2; CAGCATCATCAGGACAGTGG</p></list-item><list-item><p>chr7:151610801-151611426</p></list-item></list></p>
      <p>Random primed radiolabeled probes were generated using these templates. RNA was isolated from mouse brains, and sequentially hybridized with extension and universal probes as described previously (<xref rid="SHENKERRNA046037C25" ref-type="bibr">Miura et al. 2013</xref>).</p>
    </sec>
    <sec id="s4g">
      <title>Software availability</title>
      <p>IsoSCM transcript assembly is implemented as a standalone Java program, available at <uri xlink:href="https://github.com/shenkers/isoscm">https://github.com/shenkers/isoscm</uri>. Using the “assemble” keyword IsoSCM will assemble the mapped reads in a BAM file into a splice graph, identify nested terminal exons boundaries using the constrained segmentation procedure, and report the resulting models in GTF format. Functionality to enumerate splice isoforms from the assembled splice graph can be accessed by the keyword “enumerate.” Pairwise comparison of tandem isoform usage can be performed using the “compare” keyword, which reports the relative usage of change points in each sample in a tabular format. Complete documentation is available from the IsoSCM website (<uri xlink:href="https://github.com/shenkers/isoscm">https://github.com/shenkers/isoscm</uri>).</p>
    </sec>
  </sec>
  <sec id="s5">
    <title>SUPPLEMENTAL MATERIAL</title>
    <p>Supplemental material is available for this article.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplemental Material</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_21_1_14__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_046037.114_SuppMaterial.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGMENTS</title>
    <p>S.S. was supported by the Tri-Institutional Training Program in Computational Biology and Medicine. P.M. was supported by a fellowship from the Canadian Institutes of Health Research. Work in E.C.L.’s group was supported by the Burroughs Wellcome Fund and the National Institute of General Medical Sciences of the National Institutes of Health (National Institute of Neurological Disorders and Stroke: R01-NS074037 and R01-NS083833).</p>
  </ack>
  <fn-group>
    <fn>
      <p>Article published online ahead of print. Article and publication date are at <ext-link ext-link-type="uri" xlink:href="http://www.rnajournal.org/cgi/doi/10.1261/rna.046037.114">http://www.rnajournal.org/cgi/doi/10.1261/rna.046037.114</ext-link>.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="SHENKERRNA046037C1">
      <mixed-citation publication-type="journal"><name><surname>Adams</surname><given-names>MD</given-names></name>, <name><surname>Kerlavage</surname><given-names>AR</given-names></name>, <name><surname>Fleischmann</surname><given-names>RD</given-names></name>, <name><surname>Fuldner</surname><given-names>RA</given-names></name>, <name><surname>Bult</surname><given-names>CJ</given-names></name>, <name><surname>Lee</surname><given-names>NH</given-names></name>, <name><surname>Kirkness</surname><given-names>EF</given-names></name>, <name><surname>Weinstock</surname><given-names>KG</given-names></name>, <name><surname>Gocayne</surname><given-names>JD</given-names></name>, <name><surname>White</surname><given-names>O</given-names></name>, <etal/><year>1995</year><article-title>Initial assessment of human gene diversity and expression patterns based upon 83 million nucleotides of cDNA sequence</article-title>. <source>Nature</source><volume>377</volume>: <fpage>3</fpage>–<lpage>174</lpage>.<pub-id pub-id-type="pmid">7566098</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C2">
      <mixed-citation publication-type="journal"><name><surname>Anders</surname><given-names>S</given-names></name>, <name><surname>Huber</surname><given-names>W</given-names></name><year>2010</year><article-title>Differential expression analysis for sequence count data</article-title>. <source>Genome Biol</source><volume>11</volume>: <fpage>R106</fpage>.<pub-id pub-id-type="pmid">20979621</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C3">
      <mixed-citation publication-type="journal"><name><surname>Behr</surname><given-names>J</given-names></name>, <name><surname>Kahles</surname><given-names>A</given-names></name>, <name><surname>Zhong</surname><given-names>Y</given-names></name>, <name><surname>Sreedharan</surname><given-names>VT</given-names></name>, <name><surname>Drewe</surname><given-names>P</given-names></name>, <name><surname>Rätsch</surname><given-names>G</given-names></name><year>2013</year><article-title>MITIE: simultaneous RNA-Seq-based transcript identification and quantification in multiple samples</article-title>. <source>Bioinformatics</source><volume>29</volume>: <fpage>2529</fpage>–<lpage>2538</lpage>.<pub-id pub-id-type="pmid">23980025</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C4">
      <mixed-citation publication-type="journal"><name><surname>Bohnert</surname><given-names>R</given-names></name>, <name><surname>Rätsch</surname><given-names>G</given-names></name><year>2010</year><article-title>rQuant.web: a tool for RNA-Seq-based transcript quantitation</article-title>. <source>Nucleic Acids Res</source><volume>38</volume>: <fpage>W348</fpage>–<lpage>W351</lpage>.<pub-id pub-id-type="pmid">20551130</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C5">
      <mixed-citation publication-type="journal"><name><surname>Brown</surname><given-names>JB</given-names></name>, <name><surname>Boley</surname><given-names>N</given-names></name>, <name><surname>Eisman</surname><given-names>R</given-names></name>, <name><surname>May</surname><given-names>G</given-names></name>, <name><surname>Stoiber</surname><given-names>M</given-names></name>, <name><surname>Duff</surname><given-names>MO</given-names></name>, <name><surname>Booth</surname><given-names>BW</given-names></name>, <name><surname>Wen</surname><given-names>J</given-names></name>, <name><surname>Park</surname><given-names>S</given-names></name>, <name><surname>Suzuki</surname><given-names>AM</given-names></name>, <etal/><year>2014</year><article-title>Diversity and dynamics of the <italic>Drosophila</italic> transcriptome</article-title>. <source>Nature</source><volume>512</volume>: <fpage>393</fpage>–<lpage>399</lpage>.<pub-id pub-id-type="pmid">24670639</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C6">
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>C</given-names></name>, <name><surname>Ara</surname><given-names>T</given-names></name>, <name><surname>Gautheret</surname><given-names>D</given-names></name><year>2009</year><article-title>Using <italic>Alu</italic> elements as polyadenylation sites: a case of retroposon exaptation</article-title>. <source>Mol Biol Evol</source><volume>26</volume>: <fpage>327</fpage>–<lpage>334</lpage>.<pub-id pub-id-type="pmid">18984903</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C7">
      <mixed-citation publication-type="journal"><name><surname>Denoeud</surname><given-names>F</given-names></name>, <name><surname>Aury</surname><given-names>JM</given-names></name>, <name><surname>Da Silva</surname><given-names>C</given-names></name>, <name><surname>Noel</surname><given-names>B</given-names></name>, <name><surname>Rogier</surname><given-names>O</given-names></name>, <name><surname>Delledonne</surname><given-names>M</given-names></name>, <name><surname>Morgante</surname><given-names>M</given-names></name>, <name><surname>Valle</surname><given-names>G</given-names></name>, <name><surname>Wincker</surname><given-names>P</given-names></name>, <name><surname>Scarpelli</surname><given-names>C</given-names></name>, <etal/><year>2008</year><article-title>Annotating genomes with massive-scale RNA sequencing</article-title>. <source>Genome Biol</source><volume>9</volume>: <fpage>R175</fpage>.<pub-id pub-id-type="pmid">19087247</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C8">
      <mixed-citation publication-type="journal"><name><surname>Derti</surname><given-names>A</given-names></name>, <name><surname>Garrett-Engele</surname><given-names>P</given-names></name>, <name><surname>Macisaac</surname><given-names>KD</given-names></name>, <name><surname>Stevens</surname><given-names>RC</given-names></name>, <name><surname>Sriram</surname><given-names>S</given-names></name>, <name><surname>Chen</surname><given-names>R</given-names></name>, <name><surname>Rohl</surname><given-names>CA</given-names></name>, <name><surname>Johnson</surname><given-names>JM</given-names></name>, <name><surname>Babak</surname><given-names>T</given-names></name><year>2012</year><article-title>A quantitative atlas of polyadenylation in five mammals</article-title>. <source>Genome Res</source><volume>22</volume>: <fpage>1173</fpage>–<lpage>1183</lpage>.<pub-id pub-id-type="pmid">22454233</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C9">
      <mixed-citation publication-type="journal"><name><surname>Djebali</surname><given-names>S</given-names></name>, <name><surname>Davis</surname><given-names>CA</given-names></name>, <name><surname>Merkel</surname><given-names>A</given-names></name>, <name><surname>Dobin</surname><given-names>A</given-names></name>, <name><surname>Lassmann</surname><given-names>T</given-names></name>, <name><surname>Mortazavi</surname><given-names>A</given-names></name>, <name><surname>Tanzer</surname><given-names>A</given-names></name>, <name><surname>Lagarde</surname><given-names>J</given-names></name>, <name><surname>Lin</surname><given-names>W</given-names></name>, <name><surname>Schlesinger</surname><given-names>F</given-names></name>, <etal/><year>2012</year><article-title>Landscape of transcription in human cells</article-title>. <source>Nature</source><volume>489</volume>: <fpage>101</fpage>–<lpage>108</lpage>.<pub-id pub-id-type="pmid">22955620</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C10">
      <mixed-citation publication-type="journal"><name><surname>Elkon</surname><given-names>R</given-names></name>, <name><surname>Ugalde</surname><given-names>AP</given-names></name>, <name><surname>Agami</surname><given-names>R</given-names></name><year>2013</year><article-title>Alternative cleavage and polyadenylation: extent, regulation and function</article-title>. <source>Nat Rev Genet</source><volume>14</volume>: <fpage>496</fpage>–<lpage>506</lpage>.<pub-id pub-id-type="pmid">23774734</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C11">
      <mixed-citation publication-type="journal"><name><surname>Fearnhead</surname><given-names>P</given-names></name><year>2006</year><article-title>Exact and efficient Bayesian inference for multiple changepoint problems</article-title>. <source>Stat Comput</source><volume>16</volume>: <fpage>203</fpage>–<lpage>213</lpage>.</mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C12">
      <mixed-citation publication-type="journal"><name><surname>Feng</surname><given-names>J</given-names></name>, <name><surname>Li</surname><given-names>W</given-names></name>, <name><surname>Jiang</surname><given-names>T</given-names></name><year>2011</year><article-title>Inference of isoforms from short sequence reads</article-title>. <source>J Comput Biol</source><volume>18</volume>: <fpage>305</fpage>–<lpage>321</lpage>.<pub-id pub-id-type="pmid">21385036</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C13">
      <mixed-citation publication-type="journal"><name><surname>Guttman</surname><given-names>M</given-names></name>, <name><surname>Garber</surname><given-names>M</given-names></name>, <name><surname>Levin</surname><given-names>JZ</given-names></name>, <name><surname>Donaghey</surname><given-names>J</given-names></name>, <name><surname>Robinson</surname><given-names>J</given-names></name>, <name><surname>Adiconis</surname><given-names>X</given-names></name>, <name><surname>Fan</surname><given-names>L</given-names></name>, <name><surname>Koziol</surname><given-names>MJ</given-names></name>, <name><surname>Gnirke</surname><given-names>A</given-names></name>, <name><surname>Nusbaum</surname><given-names>C</given-names></name>, <etal/><year>2010</year><article-title><italic>Ab initio</italic> reconstruction of cell type–specific transcriptomes in mouse reveals the conserved multi-exonic structure of lincRNAs</article-title>. <source>Nat Biotechnol</source><volume>28</volume>: <fpage>503</fpage>–<lpage>510</lpage>.<pub-id pub-id-type="pmid">20436462</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C14">
      <mixed-citation publication-type="journal"><name><surname>Hansen</surname><given-names>KD</given-names></name>, <name><surname>Brenner</surname><given-names>SE</given-names></name>, <name><surname>Dudoit</surname><given-names>S</given-names></name><year>2010</year><article-title>Biases in Illumina transcriptome sequencing caused by random hexamer priming</article-title>. <source>Nucleic Acids Res</source><volume>38</volume>: <fpage>e131</fpage>.<pub-id pub-id-type="pmid">20395217</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C15">
      <mixed-citation publication-type="journal"><name><surname>Hiller</surname><given-names>D</given-names></name>, <name><surname>Wong</surname><given-names>WH</given-names></name><year>2013</year><article-title>Simultaneous isoform discovery and quantification from RNA-seq</article-title>. <source>Stat Biosci</source><volume>5</volume>: <fpage>100</fpage>–<lpage>118</lpage>.<pub-id pub-id-type="pmid">23888185</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C16">
      <mixed-citation publication-type="journal"><name><surname>Huber</surname><given-names>W</given-names></name>, <name><surname>Toedling</surname><given-names>J</given-names></name>, <name><surname>Steinmetz</surname><given-names>LM</given-names></name><year>2006</year><article-title>Transcript mapping with high-density oligonucleotide tiling arrays</article-title>. <source>Bioinformatics</source><volume>22</volume>: <fpage>1963</fpage>–<lpage>1970</lpage>.<pub-id pub-id-type="pmid">16787969</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C17">
      <mixed-citation publication-type="journal"><name><surname>Jan</surname><given-names>CH</given-names></name>, <name><surname>Friedman</surname><given-names>RC</given-names></name>, <name><surname>Ruby</surname><given-names>JG</given-names></name>, <name><surname>Bartel</surname><given-names>DP</given-names></name><year>2011</year><article-title>Formation, regulation and evolution of <italic>Caenorhabditis elegans</italic> 3′UTRs</article-title>. <source>Nature</source><volume>469</volume>: <fpage>97</fpage>–<lpage>101</lpage>.<pub-id pub-id-type="pmid">21085120</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C18">
      <mixed-citation publication-type="journal"><name><surname>Lahens</surname><given-names>NF</given-names></name>, <name><surname>Kavakli</surname><given-names>IH</given-names></name>, <name><surname>Zhang</surname><given-names>R</given-names></name>, <name><surname>Hayer</surname><given-names>K</given-names></name>, <name><surname>Black</surname><given-names>MB</given-names></name>, <name><surname>Dueck</surname><given-names>H</given-names></name>, <name><surname>Pizarro</surname><given-names>A</given-names></name>, <name><surname>Kim</surname><given-names>J</given-names></name>, <name><surname>Irizarry</surname><given-names>R</given-names></name>, <name><surname>Thomas</surname><given-names>RS</given-names></name>, <etal/><year>2014</year><article-title>IVT-seq reveals extreme bias in RNA sequencing</article-title>. <source>Genome Biol</source><volume>15</volume>: <fpage>R86</fpage>.<pub-id pub-id-type="pmid">24981968</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C19">
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>JJ</given-names></name>, <name><surname>Jiang</surname><given-names>CR</given-names></name>, <name><surname>Brown</surname><given-names>JB</given-names></name>, <name><surname>Huang</surname><given-names>H</given-names></name>, <name><surname>Bickel</surname><given-names>PJ</given-names></name><year>2011a</year><article-title>Sparse linear modeling of next-generation mRNA sequencing (RNA-Seq) data for isoform discovery and abundance estimation</article-title>. <source>Proc Natl Acad Sci</source><volume>108</volume>: <fpage>19867</fpage>–<lpage>19872</lpage>.<pub-id pub-id-type="pmid">22135461</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C20">
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>W</given-names></name>, <name><surname>Feng</surname><given-names>J</given-names></name>, <name><surname>Jiang</surname><given-names>T</given-names></name><year>2011b</year><article-title>IsoLasso: a LASSO regression approach to RNA-Seq based transcriptome assembly</article-title>. <source>J Comput Biol</source><volume>18</volume>: <fpage>1693</fpage>–<lpage>1707</lpage>.<pub-id pub-id-type="pmid">21951053</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C21">
      <mixed-citation publication-type="journal"><name><surname>Martin</surname><given-names>JA</given-names></name>, <name><surname>Wang</surname><given-names>Z</given-names></name><year>2011</year><article-title>Next-generation transcriptome assembly</article-title>. <source>Nat Rev Genet</source><volume>12</volume>: <fpage>671</fpage>–<lpage>682</lpage>.<pub-id pub-id-type="pmid">21897427</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C22">
      <mixed-citation publication-type="journal"><name><surname>Masamha</surname><given-names>CP</given-names></name>, <name><surname>Xia</surname><given-names>Z</given-names></name>, <name><surname>Yang</surname><given-names>J</given-names></name>, <name><surname>Albrecht</surname><given-names>TR</given-names></name>, <name><surname>Li</surname><given-names>M</given-names></name>, <name><surname>Shyu</surname><given-names>AB</given-names></name>, <name><surname>Li</surname><given-names>W</given-names></name>, <name><surname>Wagner</surname><given-names>EJ</given-names></name><year>2014</year><article-title>CFIm25 links alternative polyadenylation to glioblastoma tumour suppression</article-title>. <source>Nature</source><volume>510</volume>: <fpage>412</fpage>–<lpage>416</lpage>.<pub-id pub-id-type="pmid">24814343</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C23">
      <mixed-citation publication-type="journal"><name><surname>Merkin</surname><given-names>J</given-names></name>, <name><surname>Russell</surname><given-names>C</given-names></name>, <name><surname>Chen</surname><given-names>P</given-names></name>, <name><surname>Burge</surname><given-names>CB</given-names></name><year>2012</year><article-title>Evolutionary dynamics of gene and isoform regulation in mammalian tissues</article-title>. <source>Science</source><volume>338</volume>: <fpage>1593</fpage>–<lpage>1599</lpage>.<pub-id pub-id-type="pmid">23258891</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C25">
      <mixed-citation publication-type="journal"><name><surname>Miura</surname><given-names>P</given-names></name>, <name><surname>Shenker</surname><given-names>S</given-names></name>, <name><surname>Andreu-Agullo</surname><given-names>C</given-names></name>, <name><surname>Westholm</surname><given-names>JO</given-names></name>, <name><surname>Lai</surname><given-names>EC</given-names></name><year>2013</year><article-title>Widespread and extensive lengthening of 3′ UTRs in the mammalian brain</article-title>. <source>Genome Res</source><volume>23</volume>: <fpage>812</fpage>–<lpage>825</lpage>.<pub-id pub-id-type="pmid">23520388</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C26">
      <mixed-citation publication-type="journal"><name><surname>Miura</surname><given-names>P</given-names></name>, <name><surname>Sanfilippo</surname><given-names>P</given-names></name>, <name><surname>Shenker</surname><given-names>S</given-names></name>, <name><surname>Lai</surname><given-names>EC</given-names></name><year>2014</year><article-title>Alternative polyadenylation in the nervous system: To what lengths will 3′ UTR extensions take us?</article-title><source>Bioessays</source><volume>36</volume>: <fpage>766</fpage>–<lpage>777</lpage>.<pub-id pub-id-type="pmid">24903459</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C27">
      <mixed-citation publication-type="journal"><name><surname>Mortazavi</surname><given-names>A</given-names></name>, <name><surname>Williams</surname><given-names>BA</given-names></name>, <name><surname>McCue</surname><given-names>K</given-names></name>, <name><surname>Schaeffer</surname><given-names>L</given-names></name>, <name><surname>Wold</surname><given-names>B</given-names></name><year>2008</year><article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq</article-title>. <source>Nat Methods</source><volume>5</volume>: <fpage>621</fpage>–<lpage>628</lpage>.<pub-id pub-id-type="pmid">18516045</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C28">
      <mixed-citation publication-type="journal"><name><surname>Nagalakshmi</surname><given-names>U</given-names></name>, <name><surname>Wang</surname><given-names>Z</given-names></name>, <name><surname>Waern</surname><given-names>K</given-names></name>, <name><surname>Shou</surname><given-names>C</given-names></name>, <name><surname>Raha</surname><given-names>D</given-names></name>, <name><surname>Gerstein</surname><given-names>M</given-names></name>, <name><surname>Snyder</surname><given-names>M</given-names></name><year>2008</year><article-title>The transcriptional landscape of the yeast genome defined by RNA sequencing</article-title>. <source>Science</source><volume>320</volume>: <fpage>1344</fpage>–<lpage>1349</lpage>.<pub-id pub-id-type="pmid">18451266</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C29">
      <mixed-citation publication-type="journal"><name><surname>Proudfoot</surname><given-names>NJ</given-names></name>, <name><surname>Brownlee</surname><given-names>GG</given-names></name><year>1976</year><article-title>3′ Non-coding region sequences in eukaryotic messenger RNA</article-title>. <source>Nature</source><volume>263</volume>: <fpage>211</fpage>–<lpage>214</lpage>.<pub-id pub-id-type="pmid">822353</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C30">
      <mixed-citation publication-type="journal"><name><surname>Smibert</surname><given-names>P</given-names></name>, <name><surname>Miura</surname><given-names>P</given-names></name>, <name><surname>Westholm</surname><given-names>JO</given-names></name>, <name><surname>Shenker</surname><given-names>S</given-names></name>, <name><surname>May</surname><given-names>G</given-names></name>, <name><surname>Duff</surname><given-names>MO</given-names></name>, <name><surname>Zhang</surname><given-names>D</given-names></name>, <name><surname>Eads</surname><given-names>BD</given-names></name>, <name><surname>Carlson</surname><given-names>J</given-names></name>, <name><surname>Brown</surname><given-names>JB</given-names></name>, <etal/><year>2012</year><article-title>Global patterns of tissue-specific alternative polyadenylation in <italic>Drosophila</italic></article-title>. <source>Cell Rep</source><volume>1</volume>: <fpage>277</fpage>–<lpage>289</lpage>.<pub-id pub-id-type="pmid">22685694</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C31">
      <mixed-citation publication-type="journal"><name><surname>Steijger</surname><given-names>T</given-names></name>, <name><surname>Abril</surname><given-names>JF</given-names></name>, <name><surname>Engstrom</surname><given-names>PG</given-names></name>, <name><surname>Kokocinski</surname><given-names>F</given-names></name>, <name><surname>Hubbard</surname><given-names>TJ</given-names></name>, <name><surname>Guigó</surname><given-names>R</given-names></name>, <name><surname>Harrow</surname><given-names>J</given-names></name>, <name><surname>Bertone</surname><given-names>P</given-names></name>; <collab>RGASP Consortium</collab>. <year>2013</year><article-title>Assessment of transcript reconstruction methods for RNA-seq</article-title>. <source>Nat Methods</source><volume>10</volume>: <fpage>1177</fpage>–<lpage>1184</lpage>.<pub-id pub-id-type="pmid">24185837</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C32">
      <mixed-citation publication-type="journal"><name><surname>Trapnell</surname><given-names>C</given-names></name>, <name><surname>Williams</surname><given-names>BA</given-names></name>, <name><surname>Pertea</surname><given-names>G</given-names></name>, <name><surname>Mortazavi</surname><given-names>A</given-names></name>, <name><surname>Kwan</surname><given-names>G</given-names></name>, <name><surname>van Baren</surname><given-names>MJ</given-names></name>, <name><surname>Salzberg</surname><given-names>SL</given-names></name>, <name><surname>Wold</surname><given-names>BJ</given-names></name>, <name><surname>Pachter</surname><given-names>L</given-names></name><year>2010</year><article-title>Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title>. <source>Nat Biotechnol</source><volume>28</volume>: <fpage>511</fpage>–<lpage>515</lpage>.<pub-id pub-id-type="pmid">20436464</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C33">
      <mixed-citation publication-type="journal"><name><surname>Ulitsky</surname><given-names>I</given-names></name>, <name><surname>Shkumatava</surname><given-names>A</given-names></name>, <name><surname>Jan</surname><given-names>CH</given-names></name>, <name><surname>Subtelny</surname><given-names>AO</given-names></name>, <name><surname>Koppstein</surname><given-names>D</given-names></name>, <name><surname>Bell</surname><given-names>GW</given-names></name>, <name><surname>Sive</surname><given-names>H</given-names></name>, <name><surname>Bartel</surname><given-names>DP</given-names></name><year>2012</year><article-title>Extensive alternative polyadenylation during zebrafish development</article-title>. <source>Genome Res</source><volume>22</volume>: <fpage>2054</fpage>–<lpage>2066</lpage>.<pub-id pub-id-type="pmid">22722342</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C34">
      <mixed-citation publication-type="journal"><name><surname>Yassour</surname><given-names>M</given-names></name>, <name><surname>Kaplan</surname><given-names>T</given-names></name>, <name><surname>Fraser</surname><given-names>HB</given-names></name>, <name><surname>Levin</surname><given-names>JZ</given-names></name>, <name><surname>Pfiffner</surname><given-names>J</given-names></name>, <name><surname>Adiconis</surname><given-names>X</given-names></name>, <name><surname>Schroth</surname><given-names>G</given-names></name>, <name><surname>Luo</surname><given-names>S</given-names></name>, <name><surname>Khrebtukova</surname><given-names>I</given-names></name>, <name><surname>Gnirke</surname><given-names>A</given-names></name>, <etal/><year>2009</year><article-title>Ab initio construction of a eukaryotic transcriptome by massively parallel mRNA sequencing</article-title>. <source>Proc Natl Acad Sci</source><volume>106</volume>: <fpage>3264</fpage>–<lpage>3269</lpage>.<pub-id pub-id-type="pmid">19208812</pub-id></mixed-citation>
    </ref>
    <ref id="SHENKERRNA046037C35">
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>H</given-names></name>, <name><surname>Lee</surname><given-names>JY</given-names></name>, <name><surname>Tian</surname><given-names>B</given-names></name><year>2005</year><article-title>Biased alternative polyadenylation in human tissues</article-title>. <source>Genome Biol</source><volume>6</volume>: <fpage>R100</fpage>.<pub-id pub-id-type="pmid">16356263</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
