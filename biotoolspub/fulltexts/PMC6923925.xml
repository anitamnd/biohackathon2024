<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Med Genomics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Med Genomics</journal-id>
    <journal-title-group>
      <journal-title>BMC Medical Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1755-8794</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6923925</article-id>
    <article-id pub-id-type="publisher-id">613</article-id>
    <article-id pub-id-type="doi">10.1186/s12920-019-0613-5</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Improved cell composition deconvolution method of bulk gene expression profiles to quantify subsets of immune cells</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Chiu</surname>
          <given-names>Yen-Jung</given-names>
        </name>
        <address>
          <email>zx12as3420@ym.edu.tw</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hsieh</surname>
          <given-names>Yi-Hsuan</given-names>
        </name>
        <address>
          <email>hyihsuan@ym.edu.tw</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7932-374X</contrib-id>
        <name>
          <surname>Huang</surname>
          <given-names>Yen-Hua</given-names>
        </name>
        <address>
          <phone>886-2-28267982</phone>
          <email>yhhuang@ym.edu.tw</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0425 5914</institution-id><institution-id institution-id-type="GRID">grid.260770.4</institution-id><institution>Institute of Biomedical Informatics, </institution><institution>National Yang-Ming University, </institution></institution-wrap>No.155, Sec. 2, Li-Nong St., Beitou Dist, Taipei, 11221 Taiwan </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0425 5914</institution-id><institution-id institution-id-type="GRID">grid.260770.4</institution-id><institution>Centre for Systems and Synthetic Biology, </institution><institution>National Yang-Ming University, </institution></institution-wrap>Taipei, 11221 Taiwan </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>12</volume>
    <issue>Suppl 8</issue>
    <elocation-id>169</elocation-id>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>10</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>31</day>
        <month>10</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">To facilitate the investigation of the pathogenic roles played by various immune cells in complex tissues such as tumors, a few computational methods for deconvoluting bulk gene expression profiles to predict cell composition have been created. However, available methods were usually developed along with a set of reference gene expression profiles consisting of imbalanced replicates across different cell types. Therefore, the objective of this study was to create a new deconvolution method equipped with a new set of reference gene expression profiles that incorporate more microarray replicates of the immune cells that have been frequently implicated in the poor prognosis of cancers, such as T helper cells, regulatory T cells and macrophage M1/M2 cells.</p>
      </sec>
      <sec>
        <title>Methods</title>
        <p id="Par2">Our deconvolution method was developed by choosing ε-support vector regression (ε-SVR) as the core algorithm assigned with a loss function subject to the <italic>L1</italic>-norm penalty. To construct the reference gene expression signature matrix for regression, a subset of differentially expressed genes were chosen from 148 microarray-based gene expression profiles for 9 types of immune cells by using ANOVA and minimizing condition number. Agreement analyses including mean absolute percentage errors and Bland-Altman plots were carried out to compare the performances of our method and CIBERSORT.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par3">In silico cell mixtures, simulated bulk tissues, and real human samples with known immune-cell fractions were used as the test datasets for benchmarking. Our method outperformed CIBERSORT in the benchmarks using in silico breast tissue-immune cell mixtures in the proportions of 30:70 and 50:50, and in the benchmark using 164 human PBMC samples. Our results suggest that the performance of our method was at least comparable to that of a state-of-the-art tool, CIBERSORT.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par4">We developed a new cell composition deconvolution method and the implementation was entirely based on the publicly available R and Python packages. In addition, we compiled a new set of reference gene expression profiles, which might allow for a more robust prediction of the immune cell fractions from the expression profiles of cell mixtures. The source code of our method could be downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/holiday01/deconvolution-to-estimate-immune-cell-subsets">https://github.com/holiday01/deconvolution-to-estimate-immune-cell-subsets</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Deconvolution</kwd>
      <kwd>Immune cells</kwd>
      <kwd>Bulk gene expression profiles</kwd>
    </kwd-group>
    <conference xlink:href="https://incob2019.org/">
      <conf-name>International Conference on Bioinformatics (InCoB 2019)</conf-name>
      <conf-acronym>InCoB 2019</conf-acronym>
      <conf-loc>Jakarta, Indonesia</conf-loc>
      <conf-date>10-12 Septemebr 2019</conf-date>
    </conference>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par34">Tumors are heterogeneous systems containing not only cancer cells but also a variety of other types of genetically normal cells. Those non-cancer cells are not just unimportant players, and accumulating evidence has revealed that certain types of immune cells infiltrating in the tumor microenvironment (TME) may actively interact with cancer cells and thus promote their malignant phenotypes such as enhancing survival of cancer cells and supporting their metastasis (for review see [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]).</p>
    <p id="Par35">Modulating the tumor immunity could be an effective strategy to treat cancers. The success of checkpoint blockade therapy against CTLA4 or PD1/PDL1 suggests that immunotherapy of cancers is promising and the effect could be fairly durable, at least for some patients with certain tumors. Therefore, more in-depth studies might help resolve questions such as finding the distinctive expression features of each type of immune cells, and the association between patients’ immunophenotypes and responses to differential anticancer treatments.</p>
    <p id="Par36">To further study cancer immunity, quantifying the composition of the immune infiltrates in cancer tissues is an important issue. Apart from pure experimental approaches in cell biology, such as immunohistochemistry (IHC) and flow cytometry, computational approaches that can take bulk transcriptome profiling data as the input to estimate the relative abundance of each immune cell subset have been developed (for review see [<xref ref-type="bibr" rid="CR3">3</xref>]). The underlying rationale of such computational approaches is treating bulk expression profiles as a linear combination of the expression profiles of a variety of cell subsets, and thus deconvolution of the mixture of profiles may recover the fractions of different types of cells.</p>
    <p id="Par37">A number of different methods have been proposed to perform the deconvolution of the gene expression profiles of cell mixtures, including linear least squares regressions [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>], non-negative matrix factorization [<xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR8">8</xref>], quadratic programming [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>], <italic>v</italic>-support vector regression [<xref ref-type="bibr" rid="CR11">11</xref>], etc. Among the approaches, Newman et al. developed a novel tool, CIBERSORT, which can perform linear support vector regression (SVR) to deconvolute a mixture of gene expression profiles [<xref ref-type="bibr" rid="CR11">11</xref>]. One of the benchmark experiments of CIBERSORT, which was performed by taking the samples of peripheral blood mononuclear cells (PBMC) with the fractions of cell subsets confirmed by flow cytometry, revealed a high Pearson correlation of approximately 0.5 to 0.76 between the predicted abundance and the ground truth. Furthermore, to enumerate different types of immune cells, CIBERSORT utilizes a reference set consisting of 113 gene expression profiles, which correspond to 22 types of immune cells, to construct a reference gene signature matrix LM22. This means that CIBERSORT has been designed to predict the relative proportions of diverse immune cell types.</p>
    <p id="Par38">However, there is some bias in the choice of reference gene expression profiles to build LM22, which makes CIBERSORT a tool that might not be very optimized for the purpose of deconvoluting certain immune cells that have been reported to modulate cancer immunity, such as regulatory T cells (Treg), T helper cells (Th), and macrophage M1 and M2 cells.</p>
    <p id="Par39">For example, even though in LM22 there are 7 and 8 gene expression signatures of naïve B cells and memory B cells respectively, there are only 3 signatures collected each for Treg cells and Th cells. In addition, in LM22 there are 24 microarray samples collected for monocytes and macrophage M0 cells, whereas there are only 3 microarray samples derived from macrophage M2 cells. The obviously lower number of replicates in the reference dataset for certain types of immune cells may introduce a risk of decreasing the robustness in finding the differentially expressed genes to build specific expression signatures for those cells, influencing the precision of the predicted fractions. After all, while monocytes are found in bone marrow, blood, and spleen, they differentiate into macrophages under the control of a series of cytokines when recruited into tissues (for review see [<xref ref-type="bibr" rid="CR12">12</xref>]). In particular, tumor-associated macrophages which have been correlated with the poor prognosis of a number of cancers have been reported to express M2-like phenotypes (for review see [<xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR15">15</xref>]). Therefore, in this study, we developed an immune cell deconvolution method that might achieve a better accuracy on the expression profiles derived from complex tissue samples such as tumor masses.</p>
    <p id="Par40">We built a new dataset of reference gene expression profiles such that a higher number of microarray samples could be recruited for the immune cell types that have been reported to influence the survival of cancer patients, including Treg, Th, M1, and M2 cells. The expression levels of well-known marker genes for each of those immune cells were assessed in the microarray data. Benchmarking of our method was performed by assessing the cell composition in the microarray datasets of single-type cells, cell mixtures such as PBMC, and in silico cell mixtures.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Study design</title>
      <p id="Par41">The workflow overview of the development of our method is illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. To construct the reference gene signature matrix to be used in regression, we surveyed the NCBI Gene Expression Omnibus (GEO) microarray datasets and thus we collected the gene expression profiles for 9 types of immune cells, including dendritic cells (DCs), macrophage M1 cells, macrophage M2 cells, natural killer cells (NK cells), naïve CD4 T cells, T helper cells, regulatory T cells, naïve CD8+ T cells, and memory CD8+ T cells. Then by using ANOVA and calculating condition numbers we chose a subset of differentially expressed genes to create the reference gene expression signature matrix. For implementation of the computational codes for our method, we took advantage of the linearSVR class in the Python package scikit-learn. We chose ε-support vector regression (ε-SVR) as the core algorithm to perform deconvolution in this study, and the <italic>L1</italic>-loss was applied. Our ε-SVR based deconvolution method could take bulk expression profiles with unknown cell composition to predict the fractions of 9 types of immune cells in complex tissues.
<fig id="Fig1"><label>Fig. 1</label><caption><p>The workflow of our deconvolution method</p></caption><graphic xlink:href="12920_2019_613_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Datasets for building the reference expression signature</title>
      <p id="Par42">We downloaded 148 microarray samples from NCBI GEO, where at least 9 replicate samples were included for each cell type. The numbers of samples for different types of immune cells are listed in Table <xref rid="Tab1" ref-type="table">1</xref> and the NCBI GEO sample accession numbers for those microarray samples are provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>The numbers of microarray samples for building the reference expression signature for 9 types of immune cells</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Immune cell types</th><th>Subtypes</th><th>Treatments</th><th>Replicates</th></tr></thead><tbody><tr><td rowspan="3">Dendritic cell</td><td>Immature</td><td/><td>9</td></tr><tr><td>Mature</td><td/><td>7</td></tr><tr><td>Tolerogenic</td><td/><td>8</td></tr><tr><td>Naïve CD4 T cell</td><td>CD4+ CD45RA+</td><td/><td>9</td></tr><tr><td>Naïve CD8 T cell</td><td>CD3+ CD8+</td><td/><td>13</td></tr><tr><td>Memory CD8+ T cell</td><td>CD45RO+</td><td/><td>12</td></tr><tr><td>Natural killer cell</td><td>IL-2 treatment</td><td>IL-2</td><td>12</td></tr><tr><td rowspan="2">Macrophage M1</td><td>IFNγ treatment</td><td>IFNγ</td><td>9</td></tr><tr><td>IFNγ  + TNF treatment</td><td>IFNγ  + TNF</td><td>5</td></tr><tr><td>Macrophage M2</td><td>IL-4 treatment</td><td>IL-4</td><td>25</td></tr><tr><td rowspan="2">T helper cell</td><td>CD4 + IL-12 treatment</td><td>CD4 + IL-12</td><td>11</td></tr><tr><td>CD4 + IL-4 treatment</td><td>CD4 + IL-4</td><td>12</td></tr><tr><td rowspan="2">Regulatory T cell</td><td>IFNγ treatment</td><td>IFNγ</td><td>8</td></tr><tr><td>No treatment</td><td/><td>8</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec5">
      <title>Building the gene expression signature matrix</title>
      <p id="Par43">The microarray platform of all the samples obtained for building the reference gene signatures is Affymetrix U133 plus 2 (see Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S1). The microarray data were quantile normalized using the Robust Multi-array Average (RMA) procedure offered in the R package affy [<xref ref-type="bibr" rid="CR16">16</xref>]. Analysis of variance (ANOVA) was performed using the R package stats to find genes that have significantly higher values in certain types of immune cells than in the others. The expression values of those differentially expressed genes (DEGs) were taken to build the initial matrix for the gene expression signatures of the immune cells.</p>
      <p id="Par44">To make the reference gene signature matrix more robust against input variations or noises, we used condition number as a means to determine how many DEGs should be included in the final matrix. Technically, the condition number of a matrix is the product of the norm of the matrix and the norm of its inverse. Condition number is a measurement of how sensitive a mathematical function might be to changes or errors in the input data. In numerical analysis, a function with a low value of condition number is considered to be well-conditioned, since it might have a relatively stable solution when there are small fluctuations in the input data. A number of cell deconvolution methods have applied the minimization of condition numbers to the optimization of the reference gene signature matrix [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR11">11</xref>].</p>
      <p id="Par45">To select the genes to generate the final gene expression signature matrix that has the minimal condition number, all of the probe sets in the raw expression signature matrix were firstly sorted by the ANOVA <italic>p</italic>-value in ascending order. The condition numbers for the gene expression matrix consisting of the top <italic>G</italic> probe sets × 148 arrays were calculated by iterating through different <italic>G</italic> values with a step size of 500. The R function kappa was used to estimate the condition number of each matrix.</p>
      <p id="Par46">The list of probe sets that could give the minimal condition number among all of the top lists (i.e. top 500, 1000, 1500, <italic>...</italic>) was taken to build the final reference gene signature matrix. After selecting the final <italic>G</italic> probe sets, the median expression level of each probe set for all of the replicates of one type of immune cells was estimated and thus the final gene expression signature matrix consists of column vectors for immune cell types, each column vector containing <italic>G</italic> values for each immune cell type. Then the R package hgu133plus2.db was used to map probe sets to human genes. Whenever multiple probes/probe sets could be mapped to one gene, they would be collapsed to just one record by using a homemade R function, where the expression value of this gene would be assigned with the probe/probe set that has the highest median value across samples.</p>
    </sec>
    <sec id="Sec6">
      <title>Assessment of the reference gene expression signature in clustering cells</title>
      <p id="Par47">To further evaluate if the final reference expression signature of genes might allow for a robust composition deconvolution of immune cells, linear discriminant analysis (LDA), which can consider class-label information, was applied to visualize the clustering of different types of immune cells in the context of the selected <italic>G</italic> genes by using the LinearDiscriminantAnalysis class in the Python package scikit-learn. In addition, hierarchical clustering, K-means, and weighted gene co-expression network analysis (WGCNA) [<xref ref-type="bibr" rid="CR17">17</xref>] were carried out to determine if the cell clustering based on the expression values of the selected <italic>G</italic> genes agreed with the cell phenotypes.</p>
    </sec>
    <sec id="Sec7">
      <title>ε-Support vector regression</title>
      <p id="Par48">Deconvolution can be conceived as finding the solution to the convolution equation:
<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mathrm{b}}_i={\mathrm{a}}_{i,1}{\mathrm{x}}_1+{\mathrm{a}}_{i,2}{\mathrm{x}}_2\dots {\mathrm{a}}_{i,j}{\mathrm{x}}_j $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:msub><mml:mi mathvariant="normal">b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="normal">a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="normal">x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="normal">x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi mathvariant="normal">a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="normal">x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><graphic xlink:href="12920_2019_613_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par49">where b<sub><italic>i</italic></sub> is the expression level of gene <italic>i</italic> in a sample of cell mixture, a<sub><italic>i,j</italic></sub> is the expression level of gene <italic>i</italic> in cell type <italic>j</italic> (derived from the reference expression signature for this cell type), and x <sub><italic>j</italic></sub> is the unknown proportion of cell type <italic>j</italic> in the cell mixture. Among the available cell composition deconvolution tools, CIBERSORT uses a ν-SVR based approach and it outperformed the other tools in benchmarking experiments [<xref ref-type="bibr" rid="CR11">11</xref>]. Since SVR might be superior to the other regression methods in providing a sparse solution, we chose one type of SVR, ε-insensitive support vector regression (ε-SVR), as the core algorithm to perform deconvolution in this study. To implement our method, we took advantage of the linearSVR class in the Python package scikit-learn. Unlike ν-SVR that is used by CIBERSORT, ε-SVR does not control the proportion of the support vectors to use in the final model [<xref ref-type="bibr" rid="CR18">18</xref>]. This means that an ε-SVR based deconvolution model might allow for a higher flexibility in combining different predictor variables, without setting a lower bound on support vectors. After all, for one bulk tissue without prior knowledge about its cell composition, it would be arbitrary to decide a lower bound of immune cell types. In addition, <italic>L1</italic>-loss function was applied in order to minimize the mean average error (MAE) between the predicted and ground truth values [<xref ref-type="bibr" rid="CR19">19</xref>]. <italic>L1</italic>-loss function might make the regression model more robust to outlier values in the input data than <italic>L2</italic>-loss function, since <italic>L2</italic>-loss function leads to the much larger error for outliers because of the consideration of the squared differences.</p>
    </sec>
    <sec id="Sec8">
      <title>Benchmark of our deconvolution method</title>
      <p id="Par50">To assess the performance of our cell-type deconvolution method, a series of benchmarking approaches were used by recruiting a variety of test samples such as pure cells, in silico cell mixtures, simulated bulk tissues, and PBMC samples with flow cytometry results.</p>
    </sec>
    <sec id="Sec9">
      <title>Analysis of pure cell types</title>
      <p id="Par51">We started with the analysis of pure cell types by using a leave-one-out strategy. In each test run, one of the 148 microarray samples obtained from NCBI GEO for building the reference gene expression signature for the 9 types of immune cells was used as the test dataset to perform deconvolution, while the remaining 147 samples were put through to build the reference gene expression signature for testing by using the aforementioned ANOVA-based procedure. Box plots and bar charts were produced to show the distributions of the predicted cell-type fractions in those pure-cell samples. The results were compared with the predictions made by CIBERSORT.</p>
    </sec>
    <sec id="Sec10">
      <title>Analysis of in silico cell mixtures</title>
      <p id="Par52">To further evaluate the performance of our method in predicting the immune cell composition, we prepared expression profiles of in silico cell mixtures. In silico mixture samples of 9 types of immune cells were prepared for this benchmark. In each test run, a set of 9 microarrays, each from one unique immune cell type, were randomly sampled from the 148 microarrays presented in Table <xref rid="Tab1" ref-type="table">1</xref>. The expression value for each gene in an in silico mixture sample was a randomly-weighted sum across 9 types of immune cells. The remaining 139 microarrays were used to build the gene expression signature matrix dedicated to a single testing run. Bland-Altman plots were generated by using a homemade R function in order to assess the agreement of the predicted cell fractions with the real cell-specific weights in the in silico cell mixture samples [<xref ref-type="bibr" rid="CR20">20</xref>]. The agreement for individual tests was summarized by using the limits of agreement (LoA) technique [<xref ref-type="bibr" rid="CR21">21</xref>]. LoA corresponds to the 95% confidence interval (CIs) computed as the mean difference ± 1.96 × standard deviation (SD) of the differences. A smaller LoA might suggest that the predicted cell fractions agree better with the real composition.</p>
    </sec>
    <sec id="Sec11">
      <title>Analysis of simulated bulk tissues</title>
      <p id="Par53">To assess if our method might be readily applied to estimate the cell composition using the bulk expression profiles derived from tissues consisting of many non-immune cells, we simulated the bulk gene expression profiles of tissues by in silico spiking the expression signals of immune cells into the microarray data of breast tissues. The microarray sample of three breast tissues, GSM739223-GSM739225, were downloaded from NCBI GEO and normalized by using the justRMA function of R package affy. In the simulated samples, three different proportions of the gene expression signals from breast tissues, namely, 30, 50 and 70% were tested. The expression profiles of the 9 samples for the immune cells to be in silico spiked into the simulated bulk breast tissue were randomly sampled and weighted from the 148 microarrays as shown in Table <xref rid="Tab1" ref-type="table">1</xref>. In each test run, the deconvolution was performed by taking the remaining 139 microarrays to build the reference gene expression signature matrix for testing. To reveal the agreement between the predictions made by our method and the ground truths, Bland-Altman (BA) plots were generated in order to compare the prediction-truth agreements between CIBERSORT and our method. The cumulative percentages of observations for the difference between predictions and real values were tabulated in order to facilitate the comparison of performances between our method and CIBERSORT. Besides, mean absolute percentage errors (MAPEs) were calculated to measure the percentage of errors of the predicted cell fractions relative to the real cell-specific weights in the simulated bulk tissues. Box plots were produced to show the distributions of MAPEs and the results were compared with the MAPEs of the predictions made by CIBERSORT.</p>
    </sec>
    <sec id="Sec12">
      <title>Analysis of human PBMCs with flow cytometry results</title>
      <p id="Par54">On the other hand, the performance of our method was assessed by using real mixture gene expression profiles derived from PBMCs. Three sets of microarray samples of human PBMCs, including GSE65133 [<xref ref-type="bibr" rid="CR11">11</xref>], GSE106898 [<xref ref-type="bibr" rid="CR22">22</xref>], and GSE107990 [<xref ref-type="bibr" rid="CR22">22</xref>], were downloaded from NCBI GEO, and the three datasets contain 20, 12, and 164 microarray samples, respectively. Since each of these PBMC samples has been determined for its composition of immune cells by using flow cytometry, the agreement of the cell abundance predicted by our method with the experimentally determined composition could be measured. The platform of those microarray samples is the Illumina HumanHT-12 V4.0 expression beadchip, and the raw data were quantile-normalized by using the R package preprocessCore. Because our RefGES was created by using the expression profiles generated by Affymetrix U133 Plus 2.0 platform, there was an issue about inconsistent distribution of expression levels when data generated by non-Affymetrix platforms were used. Thus, we followed a simple cross-platform quantile normalization approach as used in [<xref ref-type="bibr" rid="CR23">23</xref>]. We took the 148 microarrays used in this study as the reference set, and then the expression profiles generated by the Illumina platform were transformed to make their empirical cumulative distribution function similar to the reference set. MAPEs were calculated, BA plots were generated, and cumulative percentages of observations for the difference between predictions and real values were tabulated to compare the performances of our method and CIBERSORT.</p>
    </sec>
  </sec>
  <sec id="Sec13">
    <title>Results</title>
    <sec id="Sec14">
      <title>Building the reference gene expression signature matrix</title>
      <p id="Par55">Of the 54,675 probe sets in the Affymetrix GeneChip Human Genome U133 Plus 2.0 Array, 44,224 probe sets were found to be differentially expressed across 9 types of immune cells in the ANOVA of the 148 microarray samples for building the reference gene signature. By using the approach of minimizing the condition number as mentioned, it was determined that the optimal <italic>G</italic> value was 21,500 (Fig. <xref rid="Fig2" ref-type="fig">2</xref>), corresponding to 12,366 genes, including 11,114 protein coding genes and 1252 non-protein coding genes. The gene expression matrix of 12,366 genes × 148 arrays was further collapsed to a matrix of 12,366 genes × 9 immune cell types by taking the median value of the expression levels of each gene within each type of immune cells. This matrix was used as the reference gene expression signature matrix (RefGES) in this study. The RefGES matrix is provided in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S2. Those 12,366 genes as a whole will be described in the following text as the signature genes (SGs). To reveal the global structure of the data [<xref ref-type="bibr" rid="CR24">24</xref>], these SGs were used to perform a linear discriminant analysis (LDA) and the first three axes that can maximize the separation between multiple classes were taken to generate a three-dimensional (3D) plot for visualization (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). In general, different types of cells could be distinctly separated from the others by rotating the 3D LDA plot, except for that 3 samples of M1 cells and 2 samples of dendritic cells clearly located outside of their respective clusters (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). Besides, by using WGCNA, the 148 cells could be clustered into nine groups, each group containing cells exclusively belonging to a single type of immune cells.
<fig id="Fig2"><label>Fig. 2</label><caption><p>The condition numbers for the top lists of the DEGs ranked by <italic>P</italic>-value. Red circle is to indicate the location of the minimum condition number, where the number of probe sets is 21,500</p></caption><graphic xlink:href="12920_2019_613_Fig2_HTML" id="MO2"/></fig>
<fig id="Fig3"><label>Fig. 3</label><caption><p>The LDA plot of the 148 immune cell samples using the expression data of SGs. <bold>a</bold> The 3D LDA plot for all the samples. <bold>b</bold> The zoom-in view of the LDA plot for the samples of M1, M2, and DC cells</p></caption><graphic xlink:href="12920_2019_613_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec15">
      <title>Concordance between the predicted cell composition and the true proportions</title>
      <sec id="Sec16">
        <title>Pure-cell samples</title>
        <p id="Par56">Our method was then assessed by using the gene expression profiles with known proportions of immune cells. First, each of the 148 microarray samples was tested by using a leave-one-out strategy as mentioned in the Materials and Methods. Since each microarray sample was derived from only a single type of immune cell, these microarray samples were labeled as pure-cell samples, and the true cell composition for each of the pure-cell samples is 1.00 for its distinctive type of immune cell.</p>
        <p id="Par57">In this benchmark, the prediction made by our method could recover the major cell composition in the pure-cell samples. For example, for all of the 12 pure-cell samples consisting of only memory CD8 T cells (Fig. <xref rid="Fig4" ref-type="fig">4</xref>), our method consistently predicted that memory CD8 T cells were the dominant type of immune cells (&gt; 0.8), and the predicted fractions for other cell types were mostly lower than 0.10. In addition, the prediction made by our method also agreed well with the ground truth for the other 8 types of cells, as illustrated in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1.
<fig id="Fig4"><label>Fig. 4</label><caption><p>The (<bold>a</bold>) bar charts and (<bold>b</bold>) box plots of the predicted cell fractions for the pure-cell samples consisting of only memory CD8 T cells (denoted as memory_CD8T in the figures)</p></caption><graphic xlink:href="12920_2019_613_Fig4_HTML" id="MO4"/></fig></p>
        <p id="Par58">The results of this benchmark are summarized in Table <xref rid="Tab2" ref-type="table">2</xref>. Our method achieved a mean value of at least 0.81 for each type of pure-cell microarray samples, whereas the mean cell fractions predicted by CIBERSORT were much lower for each type of pure-cell sample. In addition, the cell fractions predicted by CIBERSORT also showed a higher variation when deconvoluting the pure-cell samples of DC, M2, NK, and CD4 T cells, than those predicted by our method. Among the 9 types of pure-cell samples, the performance of CIBERSORT was the worst for M1 cells, T helper cells, Treg cells, and memory CD8 T cells, where the mean predicted fractions for them were 0.0, ~ 0.05, ~ 0.09, and ~ 0.0005, respectively. To sum up, for this benchmark CIBERSORT failed to recover the dominant cell type from the gene expression profiles of pure-cell samples for M1 cells, T helper cells, Treg cells and memory CD8 T cells, respectively.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>The means and standard deviations (SD) of the predicted cell fractions by our method and by CIBERSORT, respectively, using the 148 pure-cell samples</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2"/><th colspan="2">Our method</th><th colspan="2">CIBERSORT</th></tr><tr><th>Mean</th><th>SD</th><th>Mean</th><th>SD</th></tr></thead><tbody><tr><td>DC</td><td>0.85</td><td>0.09</td><td>0.24</td><td>0.33</td></tr><tr><td>M1</td><td>0.81</td><td>0.07</td><td>0</td><td>0</td></tr><tr><td>M2</td><td>0.84</td><td>0.14</td><td>0.38</td><td>0.38</td></tr><tr><td>NK</td><td>0.81</td><td>0.11</td><td>0.26</td><td>0.37</td></tr><tr><td>CD4 T</td><td>0.82</td><td>0.08</td><td>0.71</td><td>0.19</td></tr><tr><td>Th</td><td>0.87</td><td>0.09</td><td>0.05</td><td>0.04</td></tr><tr><td>Treg</td><td>0.87</td><td>0.05</td><td>0.09</td><td>0.06</td></tr><tr><td>CD8 T</td><td>0.85</td><td>0.11</td><td>0.27</td><td>0.10</td></tr><tr><td>Memory CD8 T</td><td>0.87</td><td>0.04</td><td>0.0005</td><td>0.001</td></tr></tbody></table></table-wrap></p>
      </sec>
    </sec>
    <sec id="Sec17">
      <title>In silico cell mixtures and simulated bulk tissues</title>
      <p id="Par59">To evaluate if our method might recover the cell composition by taking the expression profiles of cell mixtures, we prepared in silico mixtures of immune cells and simulated bulk tissues. First, one hundred cell mixtures were generated, and each mixture with a randomly assigned fraction. It turns out that for each of the 9 immune cell types the predicted cell fractions had high agreements with the true cell proportions (Fig. <xref rid="Fig5" ref-type="fig">5</xref>), since all of the 95% limits of agreement (LoA) in the BA plots were small (mean of difference = 0, all of the LoAs are within the range of − 8 and 8%).
<fig id="Fig5"><label>Fig. 5</label><caption><p>The BA plots showing the agreement of predicted cell fractions with the real cell compositions of in silico pure-cell mixtures. CD4_Tcell and CD8_Tcell correspond to naïve CD4 T cells and naïve CD8 T cells, respectively</p></caption><graphic xlink:href="12920_2019_613_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par60">Next, simulated bulk tissues were created, where 30, 50%, or 70% of the convoluted expression levels were from breast tissues, and the remaining part was composed of the 9 types of immune cells with randomly assigned weights. For a performance comparison, the same set of expression profiles of simulated bulk tissues were used for cell composition prediction by CIBERSORT and by our method. For the benchmark of using the simulated bulk tissues containing 30% expression levels from breast tissues and 70% from immune cells, the result suggests that, across all of the 9 types of immune cells, our method might have higher accuracy than CIBERSORT. The median value of the mean absolute percentage errors (MAPEs) of the predictions made by our method and the true values were 59% at the sample level. Our method might recover the cell fractions in each simulated bulk tissue more accurately and more consistently than CIBERSORT, as revealed by the lower median value and the narrower interquartile range (IQR) of the MAPEs estimated for the predictions made by our method (t-test, <italic>p</italic>-value &lt; 0.001) (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a). The cumulative percentages for the prediction-truth difference also reveal a trend that the predictions made by our method were less deviated from the real values, as compared to the predictions made by CIBERSORT (see Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3). The BA plots suggest that there might be a higher level of agreement of the predictions made by our method with the ground truth, since the widths of the limits of agreement (LoA) of our method were smaller than those of CIBERSORT (Fig. <xref rid="Fig6" ref-type="fig">6</xref>b). In addition, the BA plots for the predictions made by CIBERSORT show evidence of increasing variability of differences with increasing the average of the predicted and real cell compositions (Fig. <xref rid="Fig6" ref-type="fig">6</xref>b).
<fig id="Fig6"><label>Fig. 6</label><caption><p>Agreement analysis for the predicted cell fractions with the real cell composition, in the simulated bulk tissues with 30% expression levels from breast tissues. <bold>a</bold> The box plot for the mean absolute percentage errors (MAPEs) at the sample level. <bold>b</bold> The BA plots for the agreement for each cell type in each of the samples</p></caption><graphic xlink:href="12920_2019_613_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par61">By using the simulated bulk tissues containing less than 70% expression levels from immune cells, we noticed that the performance of our method degraded obviously (see the changes from Figs. <xref rid="Fig6" ref-type="fig">6</xref> and <xref rid="Fig7" ref-type="fig">7</xref> to Fig. <xref rid="Fig8" ref-type="fig">8</xref>). When only 30% of the expression levels of the simulated bulk tissues were derived from immune cells, the median values of MAPEs were increased to 96% at the sample level (Fig. <xref rid="Fig8" ref-type="fig">8</xref>a). The performances of CIBERSORT and our method were not statistically different at the sample level (Fig. <xref rid="Fig8" ref-type="fig">8</xref>a, t-test, <italic>p</italic>-value = 0.25). The BA plot also shows evidence of increasing variability of differences, with increasing the average of the predicted and true cell compositions, for both of the predictions made by CIBERSORT and by our method (Fig. <xref rid="Fig8" ref-type="fig">8</xref>b). Nonetheless, the BA plots for this benchmark reveal that our method might be better in predicting the fractions for naïve CD4 T cells, CD8 T cells, dendritic cells, NK cells, and Treg cells, since for these cell types the widths of the limits of agreements (LoAs) of our method were smaller than those of CIBERSORT (Fig. <xref rid="Fig8" ref-type="fig">8</xref>b).
<fig id="Fig7"><label>Fig. 7</label><caption><p>Agreement analysis for the predicted cell fractions with the real cell composition, in the simulated bulk tissues with 50% expression levels from breast tissues. <bold>a</bold> The box plot for the mean absolute percentage errors (MAPEs) at the sample level. <bold>b</bold> The BA plots for the agreement for each cell type in each of the samples</p></caption><graphic xlink:href="12920_2019_613_Fig7_HTML" id="MO7"/></fig>
<fig id="Fig8"><label>Fig. 8</label><caption><p>Agreement analysis for the predicted cell fractions with the real cell composition, in the simulated bulk tissues with 70% expression levels from breast tissues. <bold>a</bold> The box plot for the mean absolute percentage errors (MAPEs) at the sample level. <bold>b</bold> The BA plots for the agreement for each cell type in each of the samples</p></caption><graphic xlink:href="12920_2019_613_Fig8_HTML" id="MO8"/></fig></p>
    </sec>
    <sec id="Sec18">
      <title>The human PBMCs with flow cytometry results</title>
      <p id="Par62">Unlike the previous evaluations of our method where only pure-cell samples and in silico cell mixtures and simulated bulk tissues were used, the next set of benchmarks were based on real human samples consisting of multiple cell types — the human PBMCs with flow cytometry results. The purpose of these benchmarks was to evaluate if our method might still perform well when samples derived from real human tissues were analyzed. However, one consideration about this assessment is that our method was not designed to predict the fractions of all of the cell types that have been determined for the human PBMC samples. For example, only 4 out of the 9 cell types in the PBMC samples of GSE65133 could be treated by our method. The 9 cell types of the PBMC samples of GSE65133 are naïve B cells, memory B cells, CD8 T cells, naïve CD4 T cells, resting memory CD4 T cells, activated memory CD4 T cells, gamma delta T cells, NK cells, monocytes. Only naïve CD4 T cells, CD8 T cells and NK cells matched exactly with the types of immune cells that our method could predict their fractions in a mixture.</p>
      <p id="Par63">Therefore, in order to slightly expand the cell types that our method could treat for this benchmark, the fractions predicted by our method for macrophage M1 and M2 cells, as well as dendritic cells, were summed up as a means to estimate the fraction of the monocytes in the samples. This approach was used because monocytes can enter tissues and then be induced to differentiate into M1/M2 cells and dendritic cells, and those types of cells might still reserve certain gene expression signature of monocytes [<xref ref-type="bibr" rid="CR25">25</xref>]. Besides, the fractions predicted for naïve CD4 T cells, T helper cells, and Treg cells would be summed up to estimate the fraction for CD4 T cells in the PBMC samples. Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S6 is provided to reveal the aforementioned cell type mapping from the PBMCs to cell types of LM22 and the RefGES in this study.</p>
      <p id="Par64">Thus, for the benchmark using GSE65133, the cell fractions predicted by our method for naïve CD8 T cells, CD4 T cells, natural killer cells, and monocytes were normalized to a sum of 1. The results of this benchmark suggest that there was no significant difference in the MAPEs of the predictions between CIBERSORT and our method (Fig. <xref rid="Fig9" ref-type="fig">9</xref>a). The predictions made by our method for monocytes might have a better agreement with the real values (Fig. <xref rid="Fig9" ref-type="fig">9</xref>b and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S7), although for the other cell types the widths of LoAs of our method were larger than those of CIBERSORT (Fig. <xref rid="Fig9" ref-type="fig">9</xref>b).
<fig id="Fig9"><label>Fig. 9</label><caption><p>Agreement analysis for the predicted cell fractions with the real cell composition, in the 20 human PBMC samples of NCBI GEO GSE65133. <bold>a</bold> The box plot for the mean absolute percentage errors (MAPEs) at the sample level. <bold>b</bold> The BA plots for the agreement for each cell type in each of the samples</p></caption><graphic xlink:href="12920_2019_613_Fig9_HTML" id="MO9"/></fig></p>
      <p id="Par65">On the other hand, for the benchmark using the 12 PBMC samples of NCBI GEO GSE106898, the flow cytometry confirmed data contains the cell composition of 29 types of immune cells. In order to assess our method by using this dataset, a mapping table was created such that the cell composition of certain subtypes of immune cells were combined in order to assess its agreement with the predicted fraction of either one of the 7 cell types that could be treated by our method (see Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S8 for the mapping table). The results of this benchmark suggest that there was no significant difference in the MAPEs of the predictions between CIBERSORT and our method (Fig. <xref rid="Fig10" ref-type="fig">10</xref>a). In this benchmark, the predictions made by CIBERSORT might have a higher level of agreement with real values than the ones made by our method, since the widths of LoAs of our method were larger for NK cells and T helper cells (Fig. <xref rid="Fig10" ref-type="fig">10</xref>b). The cumulative percentages of observations for the prediction-truth difference also reveal that the predictions made by our method were more deviated from the real values for these cell types (see Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S9).
<fig id="Fig10"><label>Fig. 10</label><caption><p>Agreement analysis for the predicted cell fractions with the real cell composition, in the 12 human PBMC samples of NCBI GEO GSE106898. <bold>a</bold> The box plot for the mean absolute percentage errors (MAPEs) at the sample level. <bold>b</bold> The BA plots for the agreement for each cell type in each of the samples</p></caption><graphic xlink:href="12920_2019_613_Fig10_HTML" id="MO10"/></fig></p>
      <p id="Par66">To further evaluate our method, another PBMC dataset GSE107990, which contained 164 samples, were downloaded from NCBI GEO database. The mapping between the 11 types of immune cells in this dataset and the 9 cell types in this study is given in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S10. In this benchmark, the MAPEs of the predictions made by our method was significantly lower than those predicted by CIBERSORT at the sample level (t-test, <italic>p</italic>-value &lt; 0.001) (Fig. <xref rid="Fig11" ref-type="fig">11</xref>a). The BA plots show evidence of increasing variability of differences, with increasing the average of the predicted and true cell compositions, for both of the predictions made by CIBERSORT and by our method (Fig. <xref rid="Fig11" ref-type="fig">11</xref>b). Nevertheless, the predictions made by our method might have a better agreement with the ground truth for CD4 T cells, CD8 T cells, monocytes, and dendritic cells, since for the 4 types of cells the widths of LoAs of our method were smaller than those of CIBERSORT (Fig. <xref rid="Fig11" ref-type="fig">11</xref>b), which is also supported by the cumulative percentages of observations for the prediction-truth difference (see Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S11).
<fig id="Fig11"><label>Fig. 11</label><caption><p>Agreement analysis for the predicted cell fractions with the real cell composition, in the 164 human PBMC samples of NCBI GEO GSE107990. <bold>a</bold> The box plots for the mean absolute percentage errors (MAPEs) at the sample level. <bold>b</bold> The BA plots for the agreement for each cell type in each of the samples</p></caption><graphic xlink:href="12920_2019_613_Fig11_HTML" id="MO11"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec19">
    <title>Discussion</title>
    <p id="Par67">We developed a cell composition deconvolution method that could use the gene expression profiles of complex samples to predict the cell fractions. Our method was designed to focus on the types of immune cells that have been suggested to influence the prognosis of cancers. There are several unique features that make our method very different from the other tools designed for the same purpose.</p>
    <p id="Par68">First, for each immune cell type to be analyzed in this study, at least 9 replicates of microarrays were recruited to build our reference gene expression signature (RefGES) (Table <xref rid="Tab1" ref-type="table">1</xref>). For example, we recruited 16 replicates for Treg cells, 14 replicates for M1 cells, and 25 replicates for M2 cells. Since the general approach to creating a reference expression profile matrix is to take the median value of the expression levels of a gene across all the samples of a single cell type, between-sample variations for a probe set due to technical limitations might have a certain impact on the robustness of the RefGES, which might in turn influence the performance of the cell deconvolution methods. Therefore in this study, more replicates for each cell type were included in an attempt to create a more robust RefGES matrix for the use of regression-based deconvolution.</p>
    <p id="Par69">Second, since the microarray platform of the samples for building our RefGES is Affymetrix U133 plus 2, this means that not only protein-coding genes but also non-coding RNA genes might be included in the reference gene expression signature (RefGES) that would be used to perform cell composition deconvolution. For example, among the probe sets of Affymetrix U133 plus 2, there are 6492 probe sets corresponding to 5563 lncRNAs [<xref ref-type="bibr" rid="CR26">26</xref>]. We know that the number of human non-coding RNA genes is still growing, and to date more non-coding RNA genes than protein-coding genes have been annotated in the human genome (for the statistics see [<xref ref-type="bibr" rid="CR27">27</xref>]). In a modern RNA-seq experiment, it is quite common that ~ 10 k to ~ 20 k non-coding RNAs would be sequenced. Thus, including non-coding RNA genes in a RefGES for cell composition deconvolution appears to be a natural choice if a deconvolution method is to take RNA-seq data sets as the input.</p>
    <p id="Par70">Third, ANOVA was used in this study to choose differentially expressed genes across different types of immune cells. By contrast, other available cell deconvolution methods have selected their immune signature genes by recruiting well-known cell specific markers [<xref ref-type="bibr" rid="CR28">28</xref>] or by applying a pairwise t-tests approach to gather differentially expressed genes [<xref ref-type="bibr" rid="CR11">11</xref>]. Our gene selection approach leads to the inclusion of ~ 13 k genes in the RefGES. This number is ~ 23 times greater than the genes recruited in the reference profile, LM22, that was created and used by CIBERSORT [<xref ref-type="bibr" rid="CR11">11</xref>]. At first glance, it seems suspicious that including so many genes in this method is likely to incorporate genes with outlier expression levels and thus introduce more noise into the RefGES. Nonetheless, the benchmarks of our method reveal that our method along with the reference profiles might have a performance at least comparable to the state-of-the-art deconvolution method, CIBERSORT. In addition, our method might have the merit that the agreement of the predicted cell composition with the ground truth did not degrade in a monotonously increasing manner as the magnitude of the variable of interest increases, which is supported by the BA plots for the benchmark of using simulated bulk tissues with 70 and 30% of expression levels from immune cells and breast tissues, respectively, and by the BA plots for the benchmark of using the PBMC samples of NCBI GEO GSE107990.</p>
    <p id="Par71">There are several limitations on the current results of our method. Due to the limited sources of testing data sets derived from real complex samples, our method has been evaluated mainly by using expression profile samples composed of simple pure-cell types, in silico cell mixtures and simulated bulk tissues. The agreement analyses in the benchmarks using simulated bulk tissues suggest that the performance of our method is likely to degrade by increasing the level of contribution of non-immune cells to the bulk gene expression profiles. However, it is difficult to further investigate this issue by using real samples, since to the best of our knowledge no public-domain bulk gene expression profiles with experimentally confirmed cell composition are derived from real human complex tissues such as tumor masses, which might contain abundant non-immune cells as well as immune cells.</p>
    <p id="Par72">On the other hand, the only real complex samples used for the benchmarking in this study are the three sets of microarrays of human PBMC samples with flow-cytometry confirmed cell composition results. However, our method could predict the fractions of only a subset of the cell types discovered in the human PBMC datasets, since our RefGES matrix does not include the reference expression profiles for all of the cell types in the PBMC samples. This means that these PBMC-based benchmarks could just partially assess the performance of our method in terms of the scope of immune cell types, since the accuracy of our method in predicting the fractions of M1 and M2 cells could not be evaluated based on real complex samples. The PBMC cell types missed by our method may still influence the performance of our method, since the gene expression signals of the inevitably missed cell types might be falsely deconvoluted into the 9 types of immune cells that could be analyzed by our method. Nonetheless, this limitation is also one of the bottlenecks that each cell composition deconvolution method may encounter, since benchmarking with the gene expression profiles derived from real complex tissues is most critical to demonstrate the accuracy of such methods, and it is difficult to acquire a decent dataset of gene expression profiles with confirmed fractions of as many cell types as possible. After all, our method has been designed to focus on only the 9 types of immune cells that might be associated with cancer immunity and patients’ prognosis. This design has also limited the benchmarking, making us unable to conduct a completely fair comparison of the performance of our method with the available methods.</p>
    <p id="Par73">One topic that is beyond the current scope of this study is the cell composition deconvolution of the RNA-seq data derived from bulk tissues. Our method has been developed by recruiting microarray-derived transcriptomic profiling data of 9 types of immune cells to build the RefGES. Consequently, to use our method to analyze bulk-tissue RNA-seq data, non-trivial data normalization approaches must be tried in order to transform read counts to fit the distribution characteristics of the reference microarray data [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR29">29</xref>]. By contrast, an alternative approach to performing cell composition deconvolution of RNA-seq data of bulk tissues is to build the reference gene expression signatures by using the RNA-seq data derived from the cell types of interest for different research aims.</p>
    <p id="Par74">Recently several studies have utilized cell-type specific gene expression profiles derived from single-cell RNA-sequencing (scRNA-seq) technologies for cell composition deconvolution [<xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR31">31</xref>]. MuSiC is one of such methods ad hoc designed to take advantage of scRNA-seq data as the reference for cell-type deconvolution [<xref ref-type="bibr" rid="CR30">30</xref>]. The underlying rationale of the development of such methods is that scRNA-seq is likely to provide cell type-specific gene expression profiles, facilitating the build of a robust gene-expression reference for different cell types. Interestingly, MuSiC uses a tree-guided approach that allows an iteratively zoom-in deconvolution, which may remedy the multicollinearity problem when certain cell types of interest have very similar gene expression profiles. Therefore, MuSiC outperforms other cell composition deconvolution methods in analyzing the gene expression data derived from bulk renal tissues [<xref ref-type="bibr" rid="CR30">30</xref>]. However, there are concerns with respect to applying these methods to analyze bulk RNA-seq data derived from complex tissues other than kidney. For example, for deconvoluting the expression profiles derived from one type of tissue, MuSiC requires that the reference scRNA-seq data is derived from the same tissue type, or from a population with a similar abundance distribution of the cells involved in this tissue type [<xref ref-type="bibr" rid="CR30">30</xref>]. This requirement might not be very practical since in complex tissues such as tumors the types of infiltrating cells as well as their relative abundance might be varied from one sample to the others. In addition, apart from the major cell types in renal tissues, only three types of immune cells have been treated in the benchmarks of MuSiC. Hence, it is unclear whether MuSiC might be applicable to deconvolute more than 3 types of immune cells from the RNA-seq data of complex tissues. Nevertheless, deconvoluting cell composition from bulk-tissue RNA-seq data is definitely one of the central topics worthy of further exploration, since RNA-seq has been widely adopted to explore the transcriptomic features in different disease states, including cancers. To date, thousands of RNA-seq datasets derived from bulk samples of tumors in more than 30 types of cancers have been provided by public resources such as The Cancer Genome Atlas (TCGA) project [<xref ref-type="bibr" rid="CR32">32</xref>], and improving cell composition deconvolution methodologies in order to analyze bulk-tissue RNA-seq data is an important direction for future development.</p>
  </sec>
  <sec id="Sec20">
    <title>Conclusions</title>
    <p id="Par75">The deconvolution method created in this study is able to take bulk expression profiles to predict the fractions of 9 types of immune cells. The benchmark of our methods showed that the performance of our method might be superior to that of other methods being developed for the same purpose. The source code of our method could be downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/holiday01/deconvolution-to-estimate-immune-cell-subsets">https://github.com/holiday01/deconvolution-to-estimate-immune-cell-subsets</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec21">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12920_2019_613_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1: </bold><bold>Figure S1.</bold> The bar charts and box plots of the predicted cell fractions for the pure-cell samples. (A) and (B) for samples of naïve CD4 T cells, (C) and (D) for samples of naïve CD8 T cells, (E) and (F) for dendritic cells, (G) and (H) for macrophage M1 cells, (I) and (J) for macrophage M2 cells, (K) and (L) for natural killer cells, (M) and (N) for T helper cells, (O) and (P) for regulator T cells.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12920_2019_613_MOESM2_ESM.xlsx">
            <caption>
              <p><bold>Additional file 2: </bold><bold>Table S1.</bold> The microarray samples downloaded from NCBI GEO as the raw data to be used as the reference gene expression profiles, each being annotated with its source NCBI GEO sample accession numbers (GSM). <bold>Table S2.</bold> The reference gene expression signature (RefGES) matrix created in this study. <bold>Table S3.</bold> The cumulative percentages of observations for the difference between predictions and real values in the benchmark using the simulated bulk tissues with 30% expression levels from breast tissues and 70% from immune cells. <bold>Table S4.</bold> The cumulative percentages of observations for the difference between predictions and real values in the benchmark using the simulated bulk tissues with 50% expression levels from breast tissues and 50% from immune cells. <bold>Table S5.</bold> The cumulative percentages of observations for the difference between predictions and real values in the benchmark using the simulated bulk tissues with 70% expression levels from breast tissues and 30% from immune cells. <bold>Table S6.</bold> The mapping of the cell types of NCBI GEO GSE65133 to those of LM22 (CIBERSORT) and the RefGES used in this study. <bold>Table S7.</bold> The cumulative percentages of observations for the difference between predictions and real values in the benchmark using the 20 human PBMC samples of NCBI GEO GSE65133. <bold>Table S8.</bold> The mapping of the cell types of NCBI GEO GSE106898 to those of LM22 (CIBERSORT) and the RefGES used in this study. <bold>Table S9.</bold> The cumulative percentages of observations for the difference between predictions and real values in the benchmark using the 12 human PBMC samples of NCBI GEO GSE106898. <bold>Table S10.</bold> The mapping of the cell types of NCBI GEO GSE107990 to those of LM22 (CIBERSORT) and the RefGES used in this study. <bold>Table S11.</bold> The cumulative percentages of observations for the difference between predictions and real values in the benchmark using the 164 human PBMC samples of NCBI GEO GSE107990.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>3D</term>
        <def>
          <p id="Par5">Three-dimensional</p>
        </def>
      </def-item>
      <def-item>
        <term>ANOVA</term>
        <def>
          <p id="Par6">Analysis of variance</p>
        </def>
      </def-item>
      <def-item>
        <term>BA</term>
        <def>
          <p id="Par7">Bland-Altman</p>
        </def>
      </def-item>
      <def-item>
        <term>CI</term>
        <def>
          <p id="Par8">Confidence interval</p>
        </def>
      </def-item>
      <def-item>
        <term>DC</term>
        <def>
          <p id="Par9">Dendritic cell</p>
        </def>
      </def-item>
      <def-item>
        <term>DEG</term>
        <def>
          <p id="Par10">Differentially expressed gene</p>
        </def>
      </def-item>
      <def-item>
        <term>GEO</term>
        <def>
          <p id="Par11">Gene Expression Omnibus</p>
        </def>
      </def-item>
      <def-item>
        <term>IHC</term>
        <def>
          <p id="Par12">Immunohistochemistry</p>
        </def>
      </def-item>
      <def-item>
        <term>IQR</term>
        <def>
          <p id="Par13">Interquartile range</p>
        </def>
      </def-item>
      <def-item>
        <term>LDA</term>
        <def>
          <p id="Par14">Linear discriminant analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>lncRNA</term>
        <def>
          <p id="Par15">Long non-coding RNA</p>
        </def>
      </def-item>
      <def-item>
        <term>LoA</term>
        <def>
          <p id="Par16">Limits of agreement</p>
        </def>
      </def-item>
      <def-item>
        <term>MAE</term>
        <def>
          <p id="Par17">Mean average error</p>
        </def>
      </def-item>
      <def-item>
        <term>MAPE</term>
        <def>
          <p id="Par18">Mean absolute percentage error</p>
        </def>
      </def-item>
      <def-item>
        <term>NCBI</term>
        <def>
          <p id="Par19">National Center for Biotechnology Information</p>
        </def>
      </def-item>
      <def-item>
        <term>NK</term>
        <def>
          <p id="Par20">Natural killer</p>
        </def>
      </def-item>
      <def-item>
        <term>PBMC</term>
        <def>
          <p id="Par21">Peripheral blood mononuclear cell</p>
        </def>
      </def-item>
      <def-item>
        <term>RefGES</term>
        <def>
          <p id="Par22">Reference gene expression signature matrix</p>
        </def>
      </def-item>
      <def-item>
        <term>RMA</term>
        <def>
          <p id="Par23">Robust Multi-array Average</p>
        </def>
      </def-item>
      <def-item>
        <term>scRNA-seq</term>
        <def>
          <p id="Par24">Single-cell RNA-sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>SD</term>
        <def>
          <p id="Par25">Standard deviation</p>
        </def>
      </def-item>
      <def-item>
        <term>SG</term>
        <def>
          <p id="Par26">Signature gene</p>
        </def>
      </def-item>
      <def-item>
        <term>SVR</term>
        <def>
          <p id="Par27">Support vector regression</p>
        </def>
      </def-item>
      <def-item>
        <term>TCGA</term>
        <def>
          <p id="Par28">The Cancer Genome Atlas</p>
        </def>
      </def-item>
      <def-item>
        <term>Th</term>
        <def>
          <p id="Par29">T helper cell</p>
        </def>
      </def-item>
      <def-item>
        <term>TME</term>
        <def>
          <p id="Par30">Tumor microenvironment</p>
        </def>
      </def-item>
      <def-item>
        <term>Treg</term>
        <def>
          <p id="Par31">Regulatory T cell</p>
        </def>
      </def-item>
      <def-item>
        <term>WGCNA</term>
        <def>
          <p id="Par32">Weighted gene co-expression network analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>ε-SVR</term>
        <def>
          <p id="Par33">ε-insensitive support vector regression</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12920-019-0613-5.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank the Genomics Center for Clinical and Biotechnological Applications funded by the Ministry of Science and Technology, Taiwan (MOST 107-2319-B-010-002) for their technical support for the microarray data analysis. We would like to thank National Core Facility for Biopharmaceuticals (NCFB, MOST 108-2319-B-492-001) and National Center for High-performance Computing (NCHC) of National Applied Research Laboratories (NARLabs) of Taiwan for providing computational resources and storage resources. We thank the anonymous reviewers for their careful reading of our manuscript, and for their constructive comments and suggestions, which greatly helped us to improve the original version of this paper.</p>
    <sec id="FPar1">
      <title>About this supplement</title>
      <p id="Par76">This article has been published as part of BMC Medical Genomics, Volume 12 Supplement 8, 2019: 18th International Conference on Bioinformatics. The full contents of the supplement are available at <ext-link ext-link-type="uri" xlink:href="https://bmcmedgenomics.biomedcentral.com/articles/supplements/volume-12-supplement-8"><italic>https://bmcmedgenomics.biomedcentral.com/articles/supplements/volume-12-supplement-8</italic></ext-link></p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>YHH designed this study. YJC implemented the R and python code and performed the benchmark experiments of this method. YiHH surveyed and assessed the public domain microarray datasets for building the reference gene expression signature matrix for the immune cell types analyzed in this study. YHH supervised all of the data analysis. YJC and YHH drafted this manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Publication of this supplement was funded by grants from the Ministry of Health and Welfare (MOHW), Taiwan (MOHW108-TDU-B-211-124019), the Ministry of Science and Technology (MOST), Taiwan (MOST108–2320-B-010-041), Taipei Veterans General Hospital (V107D36–003-MY2–2), Yen Tjing Ling Medical Foundation, Taiwan (CI-108-17), and the Higher Education Sprout Project by the Ministry of Education (MOE), Taiwan (108 AC-D102). The funding bodies played no role in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>All of the source datasets downloaded from NCBI GEO for building the reference gene expression signature (RefGES) matrix are listed along with their GEO sample accessions numbers (GSM) in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S1. The RefGES matrix generated in this study is shown in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S2.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p id="Par77">Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p id="Par78">Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par79">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tu</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Ding</surname>
            <given-names>YH</given-names>
          </name>
          <name>
            <surname>Ying</surname>
            <given-names>XH</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>FZ</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>XM</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Zou</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Regulatory T cells, especially ICOS+ FOXP3+ regulatory T cells, are increased in the hepatocellular carcinoma microenvironment and predict reduced survival</article-title>
        <source>Sci Rep</source>
        <year>2016</year>
        <volume>6</volume>
        <fpage>35056</fpage>
        <pub-id pub-id-type="doi">10.1038/srep35056</pub-id>
        <pub-id pub-id-type="pmid">27725696</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Balkwill</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Mantovani</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Inflammation and cancer: back to Virchow?</article-title>
        <source>Lancet</source>
        <year>2001</year>
        <volume>357</volume>
        <issue>9255</issue>
        <fpage>539</fpage>
        <lpage>545</lpage>
        <pub-id pub-id-type="doi">10.1016/S0140-6736(00)04046-0</pub-id>
        <pub-id pub-id-type="pmid">11229684</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Finotello</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Trajanoski</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Quantifying tumor-infiltrating immune cells from transcriptomics data</article-title>
        <source>Cancer Immunol Immunother</source>
        <year>2018</year>
        <volume>67</volume>
        <issue>7</issue>
        <fpage>1031</fpage>
        <lpage>1040</lpage>
        <pub-id pub-id-type="doi">10.1007/s00262-018-2150-z</pub-id>
        <pub-id pub-id-type="pmid">29541787</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abbas</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Wolslegel</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Seshasayee</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Modrusan</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>HF</given-names>
          </name>
        </person-group>
        <article-title>Deconvolution of blood microarray data identifies cellular activation patterns in systemic lupus erythematosus</article-title>
        <source>PLoS One</source>
        <year>2009</year>
        <volume>4</volume>
        <issue>7</issue>
        <fpage>e6098</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0006098</pub-id>
        <pub-id pub-id-type="pmid">19568420</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clarke</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Seo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Statistical expression deconvolution from mixed tissue samples</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>8</issue>
        <fpage>1043</fpage>
        <lpage>1049</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq097</pub-id>
        <pub-id pub-id-type="pmid">20202973</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gaujoux</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Seoighe</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Semi-supervised nonnegative matrix factorization for gene expression deconvolution: a case study</article-title>
        <source>Infect Genet Evol</source>
        <year>2012</year>
        <volume>12</volume>
        <issue>5</issue>
        <fpage>913</fpage>
        <lpage>921</lpage>
        <pub-id pub-id-type="doi">10.1016/j.meegid.2011.08.014</pub-id>
        <pub-id pub-id-type="pmid">21930246</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qiao</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Quon</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Csaszar</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Zandstra</surname>
            <given-names>PW</given-names>
          </name>
        </person-group>
        <article-title>PERT: a method for expression deconvolution of human blood samples from varied microenvironmental and developmental conditions</article-title>
        <source>PLoS Comput Biol</source>
        <year>2012</year>
        <volume>8</volume>
        <issue>12</issue>
        <fpage>e1002838</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002838</pub-id>
        <pub-id pub-id-type="pmid">23284283</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liebner</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Parvin</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>MMAD: microarray microdissection with analysis of differences is a computational tool for deconvoluting cell type-specific contributions from tissue samples</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>5</issue>
        <fpage>682</fpage>
        <lpage>689</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt566</pub-id>
        <pub-id pub-id-type="pmid">24085566</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gong</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hartmann</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Kohane</surname>
            <given-names>IS</given-names>
          </name>
          <name>
            <surname>Brinkmann</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Staedtler</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Letzkus</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bongiovanni</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Szustakowski</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Optimal deconvolution of transcriptional profiling data using quadratic programming with application to complex clinical blood samples</article-title>
        <source>PLoS One</source>
        <year>2011</year>
        <volume>6</volume>
        <issue>11</issue>
        <fpage>e27156</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0027156</pub-id>
        <pub-id pub-id-type="pmid">22110609</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhong</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>YW</given-names>
          </name>
          <name>
            <surname>Pang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Chow</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Digital sorting of complex tissues for cell type-specific gene expression profiles</article-title>
        <source>BMC Bioinformatics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>89</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-89</pub-id>
        <pub-id pub-id-type="pmid">23497278</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newman</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Gentles</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hoang</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Diehn</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Alizadeh</surname>
            <given-names>AA</given-names>
          </name>
        </person-group>
        <article-title>Robust enumeration of cell subsets from tissue expression profiles</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <issue>5</issue>
        <fpage>453</fpage>
        <lpage>457</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3337</pub-id>
        <pub-id pub-id-type="pmid">25822800</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Richards</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Hettinger</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Feuerer</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Monocytes and macrophages in cancer: development and functions</article-title>
        <source>Cancer Microenviron</source>
        <year>2013</year>
        <volume>6</volume>
        <issue>2</issue>
        <fpage>179</fpage>
        <lpage>191</lpage>
        <pub-id pub-id-type="doi">10.1007/s12307-012-0123-x</pub-id>
        <pub-id pub-id-type="pmid">23179263</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bingle</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <article-title>The role of tumour-associated macrophages in tumour progression: implications for new anticancer therapies</article-title>
        <source>J Pathol</source>
        <year>2002</year>
        <volume>196</volume>
        <issue>3</issue>
        <fpage>254</fpage>
        <lpage>265</lpage>
        <pub-id pub-id-type="doi">10.1002/path.1027</pub-id>
        <pub-id pub-id-type="pmid">11857487</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nielsen</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Schmid</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>Macrophages as key drivers of cancer progression and metastasis</article-title>
        <source>Mediat Inflamm</source>
        <year>2017</year>
        <volume>2017</volume>
        <fpage>9624760</fpage>
        <pub-id pub-id-type="doi">10.1155/2017/9624760</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mantovani</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sozzani</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Locati</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Allavena</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sica</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Macrophage polarization: tumor-associated macrophages as a paradigm for polarized M2 mononuclear phagocytes</article-title>
        <source>Trends Immunol</source>
        <year>2002</year>
        <volume>23</volume>
        <issue>11</issue>
        <fpage>549</fpage>
        <lpage>555</lpage>
        <pub-id pub-id-type="doi">10.1016/S1471-4906(02)02302-5</pub-id>
        <pub-id pub-id-type="pmid">12401408</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Hobbs</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Collin</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Beazer-Barclay</surname>
            <given-names>YD</given-names>
          </name>
          <name>
            <surname>Antonellis</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Scherf</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
        </person-group>
        <article-title>Exploration, normalization, and summaries of high density oligonucleotide array probe level data</article-title>
        <source>Biostatistics</source>
        <year>2003</year>
        <volume>4</volume>
        <issue>2</issue>
        <fpage>249</fpage>
        <lpage>264</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/4.2.249</pub-id>
        <pub-id pub-id-type="pmid">12925520</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langfelder</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Horvath</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>WGCNA: an R package for weighted correlation network analysis</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>559</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-559</pub-id>
        <pub-id pub-id-type="pmid">19114008</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smola</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Schölkopf</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>A tutorial on support vector regression</article-title>
        <source>Stat Comput</source>
        <year>2004</year>
        <volume>14</volume>
        <issue>3</issue>
        <fpage>199</fpage>
        <lpage>222</lpage>
        <pub-id pub-id-type="doi">10.1023/B:STCO.0000035301.49549.88</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ho</surname>
            <given-names>C-H</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>C-J</given-names>
          </name>
        </person-group>
        <article-title>Large-scale linear support vector regression</article-title>
        <source>J Mach Learn Res</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>Nov</issue>
        <fpage>3323</fpage>
        <lpage>3348</lpage>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altman</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Bland</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Measurement in medicine: the analysis of method comparison studies</article-title>
        <source>J Royal Stat Soc</source>
        <year>1983</year>
        <volume>32</volume>
        <issue>3</issue>
        <fpage>307</fpage>
        <lpage>317</lpage>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bunce</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Correlation, agreement, and Bland-Altman analysis: statistical analysis of method comparison studies</article-title>
        <source>Am J Ophthalmol</source>
        <year>2009</year>
        <volume>148</volume>
        <issue>1</issue>
        <fpage>4</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajo.2008.09.032</pub-id>
        <pub-id pub-id-type="pmid">19540984</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Monaco</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Mustafah</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hwang</surname>
            <given-names>YY</given-names>
          </name>
          <name>
            <surname>Carre</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Burdin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Visan</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ceccarelli</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Poidinger</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-Seq signatures normalized by mRNA abundance allow absolute deconvolution of human immune cell types</article-title>
        <source>Cell Rep</source>
        <year>2019</year>
        <volume>26</volume>
        <issue>6</issue>
        <fpage>1627</fpage>
        <lpage>1640</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2019.01.041</pub-id>
        <pub-id pub-id-type="pmid">30726743</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Tao</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Sha</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tsai</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Joint analysis of two microarray gene-expression data sets to select lung adenocarcinoma marker genes</article-title>
        <source>BMC Bioinformatics</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>81</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-5-81</pub-id>
        <pub-id pub-id-type="pmid">15217521</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>LH</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Ten quick tips for effective dimensionality reduction</article-title>
        <source>PLoS Comput Biol</source>
        <year>2019</year>
        <volume>15</volume>
        <issue>6</issue>
        <fpage>e1006907</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1006907</pub-id>
        <pub-id pub-id-type="pmid">31220072</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martinez</surname>
            <given-names>FO</given-names>
          </name>
          <name>
            <surname>Gordon</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Locati</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mantovani</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Transcriptional profiling of the human monocyte-to-macrophage differentiation and polarization: new molecules and patterns of gene expression</article-title>
        <source>J Immunol</source>
        <year>2006</year>
        <volume>177</volume>
        <issue>10</issue>
        <fpage>7303</fpage>
        <lpage>7311</lpage>
        <pub-id pub-id-type="doi">10.4049/jimmunol.177.10.7303</pub-id>
        <pub-id pub-id-type="pmid">17082649</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Sui</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Zou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lv</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Analysis of distinct long noncoding RNA transcriptional fingerprints in pancreatic ductal adenocarcinoma</article-title>
        <source>Cancer Med</source>
        <year>2017</year>
        <volume>6</volume>
        <issue>3</issue>
        <fpage>673</fpage>
        <lpage>680</lpage>
        <pub-id pub-id-type="doi">10.1002/cam4.1027</pub-id>
        <pub-id pub-id-type="pmid">28220683</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Human assembly and gene annotation. 2019. <ext-link ext-link-type="uri" xlink:href="http://www.ensembl.org/Homo_sapiens/Info/Annotation">http://www.ensembl.org/Homo_sapiens/Info/Annotation</ext-link>. Accessed 1 Sept 2019<bold>.</bold></mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Severson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Pignon</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Novak</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Aster</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Rodig</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive analyses of tumor immunity: implications for cancer immunotherapy</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>174</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-1028-7</pub-id>
        <pub-id pub-id-type="pmid">27549193</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Charoentong</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Finotello</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Angelova</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mayer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Efremova</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rieder</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hackl</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Trajanoski</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Pan-cancer Immunogenomic analyses reveal genotype-Immunophenotype relationships and predictors of response to checkpoint blockade</article-title>
        <source>Cell Rep</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>248</fpage>
        <lpage>262</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2016.12.019</pub-id>
        <pub-id pub-id-type="pmid">28052254</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Susztak</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>NR</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Bulk tissue cell type deconvolution with multi-subject single-cell expression reference</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>380</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-08023-x</pub-id>
        <pub-id pub-id-type="pmid">30670690</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>YA</given-names>
          </name>
          <name>
            <surname>Conejo-Garcia</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Chung</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Estimation of immune cell content in tumor using single-cell RNA-seq reference data</article-title>
        <source>BMC Cancer</source>
        <year>2019</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>715</fpage>
        <pub-id pub-id-type="doi">10.1186/s12885-019-5927-3</pub-id>
        <pub-id pub-id-type="pmid">31324168</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tomczak</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Czerwinska</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wiznerowicz</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The Cancer genome atlas (TCGA): an immeasurable source of knowledge</article-title>
        <source>Contemp Oncol (Pozn)</source>
        <year>2015</year>
        <volume>19</volume>
        <issue>1A</issue>
        <fpage>A68</fpage>
        <lpage>A77</lpage>
        <pub-id pub-id-type="pmid">25691825</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
