<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id>
    <journal-title-group>
      <journal-title>Scientific Reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-2322</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7203241</article-id>
    <article-id pub-id-type="publisher-id">64516</article-id>
    <article-id pub-id-type="doi">10.1038/s41598-020-64516-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Cyto-Feature Engineering: A Pipeline for Flow Cytometry Analysis to Uncover Immune Populations and Associations with Disease</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Fox</surname>
          <given-names>Amy</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dutt</surname>
          <given-names>Taru S.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Karger</surname>
          <given-names>Burton</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rojas</surname>
          <given-names>Mauricio</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Obregón-Henao</surname>
          <given-names>Andrés</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Anderson</surname>
          <given-names>G. Brooke</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Henao-Tamayo</surname>
          <given-names>Marcela</given-names>
        </name>
        <address>
          <email>Marcela.Henao_Tamayo@ColoState.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 8083</institution-id><institution-id institution-id-type="GRID">grid.47894.36</institution-id><institution>Mycobacteria Research Laboratories, Department of Microbiology, Immunology, and Pathology, </institution><institution>Colorado State University, </institution></institution-wrap>Fort Collins, Colorado 80523 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 8882 5269</institution-id><institution-id institution-id-type="GRID">grid.412881.6</institution-id><institution>Grupo de Inmunología Celular e Inmunogenética, Facultad de Medicina, Unidad de Citometría de Flujo, Sede de Investigación Universitaria, Universidad de Antioquia, </institution></institution-wrap>Medellin, Colombia </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 8083</institution-id><institution-id institution-id-type="GRID">grid.47894.36</institution-id><institution>Department of Environmental and Radiological Health Sciences, </institution><institution>Colorado State University, </institution></institution-wrap>Fort Collins, Colorado 80523 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>6</day>
      <month>5</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>6</day>
      <month>5</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>10</volume>
    <elocation-id>7651</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>11</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>4</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Flow cytometers can now analyze up to 50 parameters per cell and millions of cells per sample; however, conventional methods to analyze data are subjective and time-consuming. To address these issues, we have developed a novel flow cytometry analysis pipeline to identify a plethora of cell populations efficiently. Coupled with feature engineering and immunological context, researchers can immediately extrapolate novel discoveries through easy-to-understand plots. The R-based pipeline uses Fluorescence Minus One (FMO) controls or distinct population differences to develop thresholds for positive/negative marker expression. The continuous data is transformed into binary data, capturing a positive/negative biological dichotomy often of interest in characterizing cells. Next, a filtering step refines the data from all identified cell phenotypes to populations of interest. The data can be partitioned by immune lineages and statistically correlated to other experimental measurements. The pipeline’s modularity allows customization of statistical testing, adoption of alternative initial gating steps, and incorporation of other datasets. Validation of this pipeline through manual gating of two datasets (murine splenocytes and human whole blood) confirmed its accuracy in identifying even rare subsets. Lastly, this pipeline can be applied in all disciplines utilizing flow cytometry regardless of cytometer or panel design. The code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/aef1004/cyto-feature_engineering">https://github.com/aef1004/cyto-feature_engineering</ext-link>.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Infectious diseases</kwd>
      <kwd>Vaccines</kwd>
      <kwd>Immunology</kwd>
      <kwd>Microbiology</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par2">Flow cytometers can now analyze up to 50 parameters (antigens, size, granularity, cytokines, transcription factors, etc.) per cell and millions of cells per sample<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. Conventional flow cytometry data analysis uses manual gating of cells on 2D plots to distinguish populations 1–2 dimensions at a time; this makes it both subjective and time consuming (up to 15 hours per experiment)<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>. Better methods are therefore critically needed to take full advantage of this powerful technology. Researchers have responded with open-source tools, including tools for automated gating to remove user input bias (e.g., <italic>openCyto</italic>) and tools to identify and cluster cell populations concurrently using all parameters (e.g., <italic>FlowSOM</italic>, t-SNE)<sup><xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR5">5</xref></sup>. While powerful advances, these new tools lack a straightforward way to integrate data from important technical controls or to compare resulting cell populations with other experimental measurements. Work is ongoing across several research groups to extend existing open-source tools to address some of these gaps. <italic>CytoCompare</italic> and <italic>cytofast</italic>, for example, focus on data analysis after clustering<sup><xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR7">7</xref></sup>. However, few tools exist that allow users to incorporate the many flow cytometry controls required for good data acquisition and analysis, and the output from the available clustering tools are often difficult for immunologists to interpret.</p>
    <p id="Par3">We have developed an end-to-end method for analyzing flow cytometry data that aims to address these limitations. For flow cytometry data, a parameter often represents a biologically binary phenomenon—that a marker is present or missing on a cell. While variation exists in the flow cytometry measurements for each parameter within cells in each binary group, that within-group variation is often uninformative noise. Our pipeline leverages this underlying biology—it uses feature engineering to create binary features for whether each cell has a positive or negative value for each marker. It does this using either external thresholds identified based on Fluorescence Minus One controls (FMOs) or the availability to separate the data based on clear population separation. The pipeline therefore identifies cell populations based on positive/negative combinations of each flow cytometry marker, a description that is readily interpretable by immunologists.</p>
    <p id="Par4">In four main steps, the pipeline: (1) cleans the data for live, single cells; (2) feature engineers the data based on FMO cutoffs or population separation; (3) analyzes the flow cytometry samples for all populations present in the sample and filters to populations above a population size threshold; (4) visualizes resulting populations through heatmaps of cell phenotypes and time series plots within experimental groups. Furthermore, it allows the use of statistical testing to identify cell populations associated with other experimental measurements (e.g., disease burden as measured through colony forming units) and novel populations induced by any experimental or clinical condition. All steps in the pipeline are modular, allowing each to be modified or replaced depending on the research question and features of the experimental data. As a case study, we illustrate the pipeline on a study involving <italic>Mycobacterium bovis</italic> Bacillus Calmette-Guérin (BCG)-vaccinated or control (Phosphate buffered saline (PBS)-injected) C57BL/6 mice infected with <italic>Mycobacterium tuberculosis (M. tuberculosis)</italic>. We further validate the pipeline analyzing human whole blood for B and T cells.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <p id="Par5">The workflow for the analysis pipeline includes reading flow cytometry data output, cleaning and feature engineering this data, performing data visualization, and performing hypothesis testing through integrating other experimental measurements (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Each step is described in detail below, and a route map describing the method can be found in Supplementary Fig. <xref rid="MOESM1" ref-type="media">S1</xref>.<fig id="Fig1"><label>Figure 1</label><caption><p>Pipeline workflow. Initial data cleaning is performed on all FMOs and samples. A singlet gate on the root population gates out doublets (top panel under “Data Cleaning”). Debris is removed from the samples with a “mindensity” gate from the R package <italic>openCyto</italic> (middle panel under “Data Cleaning”), and then the live cells (those negative for Zombie NIR) are gated, also using a “mindensity” gate (bottom panel under “Data Cleaning”). The data is then feature engineered into binary data based on FMOs. It is then filtered to a smaller number of populations that may help answer a research question, such as CD3+ cells. Finally, the data is visualized and statistically analyzed, for phenotype identification, population correlation, cell percentage, and population and CFU correlation.</p></caption><graphic xlink:href="41598_2020_64516_Fig1_HTML" id="d29e324"/></fig></p>
    <sec id="Sec3">
      <title>Cleaning data with gating input</title>
      <p id="Par6">Flow cytometers use a standardized file format for outputting data, the .fcs file, which includes cell measurements, metadata describing data collection, and the Median Fluorescent Intensities (MFIs) of fluorescently-conjugated antibodies or fluorescent probes <sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. Multiple .fcs files generated from an experiment can be read into R and manipulated as a “flowSet” object<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. Our pipeline begins by reading experimental data into a “flowSet” object, then cleaning the data using the <italic>openCyto</italic> package (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). This package provides infrastructure for the use of reproducible algorithms to gate cells based on marker density<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>. However, it alone is unable to control for instances where clumps of cells pass through the flow cytometer lasers, producing erroneous results and subsequently skewing the data. To address this phenomenon, the “singletGate” function from the <italic>flowStats</italic> package is used to remove doublet or larger cell clumps<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. The pipeline then funnels the data through the “mindensity” function, selecting for leukocytes via a threshold filter that distinguishes between populations based on cell density<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>. Finally, a “mindensity” gate is used with a live/dead stain (Zombie NIR), to filter the data to only live cells<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>. The data is next converted from a “flowSet” object into a dataframe object that complies with the “tidy data” standards, allowing further pipeline steps to draw on the powerful suite of “tidyverse” tools in R<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>.</p>
    </sec>
    <sec id="Sec4">
      <title>Feature engineering using FMOs</title>
      <p id="Par7">FMOs are often used in manual gating to control for data spread and spillover events, which are common during flow cytometry data collection<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. Take for example a panel consisting of 10 markers with different fluorophores. When excited, each of those 10 markers fluoresce at different intensities along the light spectrum. However, while they have different spectrums, tails of these spectrums can overlap. This overlap can lead to noise within a parameter’s measurements, and in extreme cases, to the detection of false positives/negatives in the presence or absence of a marker. FMOs are created experimentally; by running parallel samples where each sample has just one marker removed from the overall panel, all cells are guaranteed to be truly negative on that marker. With FMOs, we can therefore identify a threshold for the maximum parameter values possible for true negative marker signal on cells to determine marker presence in fully stained samples<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. Incorporation of FMOs greatly reduces the subjectivity of manual gating and helps support unbiased analysis of flow cytometry data. Despite the importance of FMOs for accurate analysis, limited flow cytometry computational tools exist that incorporate them into unsupervised analysis<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>.</p>
      <p id="Par8">Our pipeline processes the data from FMOs to include in further analysis. Traditionally, FMOs have been manually gated to identify the upper threshold of a parameter’s value for negative cells. In our pipeline, we instead automate this analysis of the FMOs, measuring the threshold as the 99<sup>th</sup> percentile of the parameter values in each FMO (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Noise can originate from very small particles or debris that pass through the flow cytometer. In an ideal world, a 100% threshold could be used, but in reality, the 99% threshold is used to account for this random noise. The user can assess this 99% threshold with the FMO plots in Fig. <xref rid="Fig2" ref-type="fig">2</xref> and adjust the thresholds if need be. The 99th percentile values are then saved and subsequently funneled into feature engineering of binary features (negative/positive) for each marker in the experimental data.<fig id="Fig2"><label>Figure 2</label><caption><p>Numerical feature engineering of FMOs. The 18 FMOs are shown with the individual marker MFI expression on the x-axis and Side Scatter (SSC-A) on the y-axis. The black vertical line indicates the 99<sup>th</sup> percentile threshold for identifying positive versus negative cells (i.e., 99% of the data is located to the left of the line in each plot). These thresholds are used on the subsequent samples to feature engineer new parameters on whether a cell positively or negatively expresses each marker.</p></caption><graphic xlink:href="41598_2020_64516_Fig2_HTML" id="d29e407"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Feature engineering identifies all cell phenotypes present in the samples</title>
      <p id="Par9">Features are measurements in a dataset, such as the MFIs used in flow cytometry. Feature engineering is a machine learning technique that uses the original features in a dataset, possibly with the integration of external knowledge or data, to create new features that make the data easier to understand<sup><xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR15">15</xref></sup>.</p>
      <p id="Par10">For flow cytometry, FMOs can add information about the possible range of expression measurements for cells that are truly negative for a marker. The threshold identified by FMOs can be used to create new binary features that capture whether the expression of each marker is positive or negative for the cell, thus, simplifying overly redundant, continuous MFI data with noise resulting from spillover. In the pipeline, we feature engineer each parameter using the thresholds identified from the FMOs, so that positive expression on cells (values above the FMO cutoff) equal 1 and negative cells equal 0.</p>
      <p id="Par11">For each cell in the experimental data, the cell phenotype is then identified based on the set of marker expressions (0’s and 1’s) of each population. Eighteen markers were used to elucidate memory T cell populations including markers for terminal differentiation and exhaustion in the <italic>M. tuberculosis</italic> case study. The pipeline identifies all cell populations (i.e., combinations of negative and positive marker expression values) for which at least one sample includes at least one cell. A total of 12,122 cell populations were identified in the samples for this study (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S2</xref>). As this number of populations is still very large, the data can be filtered to look at a smaller subset of the populations. In this case, we are specifically looking for CD3+ T cells that may mediate protection against <italic>M. tuberculosis</italic> infection. Immunologically, a protective population is unlikely to be present only in extremely small numbers. Therefore, in the filtering step of our pipeline we chose to filter to CD3+ T cell populations with population percentages greater than 0.5% in at least one sample (Fig. <xref rid="Fig3" ref-type="fig">3a</xref>). This analysis filtered the cells to look specifically at larger populations, but an alternative filter could be used to look at rare populations that compose &lt;0.1% of the sample, for example.<fig id="Fig3"><label>Figure 3</label><caption><p>Feature engineering identifies CD3+ phenotypes and correlates identified populations. (<bold>a</bold>) The heatmaps show the CD3+ phenotypes that constitute greater than 0.5% of the live leukocytes in at least one sample. Green indicates positive expression, and blue indicates negative expression of all 18 markers used for analysis in the flow cytometry experiment on the x-axis. The plots are separated by four different CD3+ lineages based on CD4 and CD8 expression (double negative immune cells, T helper cells, cytotoxic T cells, and double positive T cells). The “cell” column classifies cells as either central memory, effector, T stem-cell like memory, or unknown cells that need to be explored further. The “resident” column indicates if the population is a resident cell, as determined by expression of CD103. (<bold>b</bold>) The correlation across study samples between the percentage of cells in each population can be used to see the similarities and differences between different populations. Yellow indicates high positive correlation and purple is high negative correlation. Populations are grouped by cell lineages, and each number on the x-axis and y-axis identifies a separate cell population, corresponding to the population numbers in Fig. 3a.</p></caption><graphic xlink:href="41598_2020_64516_Fig3_HTML" id="d29e453"/></fig></p>
      <p id="Par12">The pipeline then classifies specific lineages and subsets of cells according to marker expression (Supplementary Tables <xref rid="MOESM1" ref-type="media">S1</xref> and <xref rid="MOESM1" ref-type="media">S2</xref>)<sup><xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup>. The pipeline identifies cell phenotypes that may be overlooked in manual analysis, due to combinations of markers that are uncommon (e.g., cells classified as “unknown” in this analysis) or combinations that have not yet been linked to a disease or condition of interest. In the case study, for example, there are six populations that express CD153; CD153 has only recently been shown to mediate protection against <italic>M. tuberculosis</italic><sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. These six double-negative populations likely would not have been gated for in a manual gating scheme, as thus far, the marker has only been shown to be present on CD4+ T helper cells<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>.</p>
      <p id="Par13">While we used T cell lineages and subsets in the case study analysis, the pipeline could easily be modified for different panels. If a panel aims to identify myeloid cells, they could be classified by lineage as macrophages, neutrophils, dendritic cells, and then subset further, for example, by alveolar macrophages and interstitial macrophages.</p>
    </sec>
    <sec id="Sec6">
      <title>Correlation between identified populations</title>
      <p id="Par14">The pipeline then visualizes a correlation matrix comparing the percentage of cells in each of the populations (Fig. <xref rid="Fig3" ref-type="fig">3b</xref>). This allows users to explore associations between cell populations. This plot can also allow for identifying unusual populations that do not behave like other populations within the same lineage. In the case study example, populations 21 and 28, which are T helper cell populations, are negatively correlated or uncorrelated with the other T helper cells (populations 19–31), and instead have patterns more similar to the identified double-negative cell populations. These are the only identified cell populations outside the double-negative cells that are negative for interferon-gamma (IFN-γ) expression. Importantly, IFN-γ is well known to be strongly associated with protection against <italic>M. tuberculosis</italic><sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. As these cell populations do not behave similarly to the other T helper cells, they may be a good candidate for further, more targeted exploration in later experiments.</p>
    </sec>
    <sec id="Sec7">
      <title>Visualizing the percentage of cells in each population</title>
      <p id="Par15">Whereas less modular pipelines may provide more limited options for visualizations at later stages of analysis, our pipeline’s modularity and its use of a common “tidy” data format provide the researcher wide flexibility to create visualizations suited to their research question and data characteristics through the <italic>ggplot2</italic> package<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>. For this study, the percentage of cells in each population at each timepoint is plotted to compare the dynamic changes in populations over time and between groups (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). Some populations may steadily increase or decrease over time, while others behave in unexpected ways. Comparing the two groups, we can see that some cell populations (e.g., population 20) are similar over time regardless of vaccination status. It is also possible to elucidate differences based on cell lineages. For example, the largest differences in population percentages occurs at Day 30 post-infection, before BCG-vaccination protection begins to wane<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. This difference primarily occurs in the double-negative CD3<sup>+</sup> immune cell populations. This example visualization, and its accompanying code, is just one application of visualizations that could be created at this step of the workflow (see Supplementary Fig. <xref rid="MOESM1" ref-type="media">S3</xref> for two more examples).<fig id="Fig4"><label>Figure 4</label><caption><p>Time series of percentage of cells in each population. Each small plot shows the time series of a single cell population identified in the pipeline at the three measured timepoints post-infection. Separate lines are shown for vaccinated (“BCG”) versus control mice. Each point represents average cell populations across all mouse replicates (4–5 per time point and vaccination status). The small plots give cell populations in the same order as Figs. <xref rid="Fig3" ref-type="fig">3</xref> and <xref rid="Fig5" ref-type="fig">5</xref>, with population identification numbers corresponding across the three plots. The background color of each plot matches the cell lineages plotted in Fig. <xref rid="Fig3" ref-type="fig">3a</xref>.</p></caption><graphic xlink:href="41598_2020_64516_Fig4_HTML" id="d29e538"/></fig></p>
    </sec>
    <sec id="Sec8">
      <title>Integrating cell population measurements with other experimental measurements</title>
      <p id="Par16">At this stage, the pipeline allows the integration of cell population measurements with other data from the experiment, such as lesion scores or gene expression. In the <italic>M. tuberculosis</italic> study, bacterial burden (expressed as log<sub>10</sub> transformed Colony Forming Units (CFUs)) is a measurement of the number of bacteria found in the lung. These CFU measurements were found to vary between experimental groups in the case study data, with significantly higher bacterial burden at days 30, 60, and 90 post-infection in the control group compared to the vaccinated group (Fig. <xref rid="Fig5" ref-type="fig">5a</xref>). It is of interest to investigate if certain cell populations identified through the pipeline, are associated with this measurement of bacterial burden, as this might help to identify cell populations possibly indicative of the host’s response to infection with or without vaccination.<fig id="Fig5"><label>Figure 5</label><caption><p>Populations associated with bacterial burden. (<bold>a</bold>) The log<sub>10</sub><sup>−</sup>
<italic>M. tuberculosis</italic> CFUs in each mouse at each time point is shown, separated into vaccinated (“BCG”) and control groups. Unpaired t-tests were used to calculate statistical significance (p &lt; 0.05). (<bold>b</bold>) Each small plot shows the association between a specific cell population and bacterial burden across all samples for the experiment. The small plots give cell populations in the same order as Figs. <xref rid="Fig3" ref-type="fig">3</xref> and <xref rid="Fig4" ref-type="fig">4</xref>, with population identification numbers and lineage colors corresponding across the three plots. The x-axis in each small plot gives the percentage of cells in a population, with each point providing the measurement from a single mouse. The y-axis gives the log<sub>10</sub>
<italic>M. tuberculosis</italic> CFUs for that mouse. Estimates of how well the linear models fit the data between cell population sizes and log<sub>10</sub> CFUs are given on each plot (“r<sup>2</sup>”).</p></caption><graphic xlink:href="41598_2020_64516_Fig5_HTML" id="d29e594"/></fig></p>
      <p id="Par17">For this case study, the pipeline investigates associations between CFUs and cell populations using scatterplot visualizations and linear regression (Fig. <xref rid="Fig5" ref-type="fig">5b</xref>). It tests the null hypothesis of a slope of zero for CFUs regressed on cell population size within a mouse’s lung (Fig. <xref rid="Fig5" ref-type="fig">5b</xref> and Supplementary Table <xref rid="MOESM1" ref-type="media">S3</xref>). Further, the coefficient of determination (r<sup>2</sup>) was estimated between the CFUs and each cell population. This analysis identified that cells that co-express CD44, CD153, and IFN-γ (populations 5, 7, 8) could be candidates for future experimental studies. They are potentially protective against <italic>M. tuberculosis</italic> infection, as a decreased bacterial burden is associated with a higher percentage of these populations.</p>
      <p id="Par18">In this section of the pipeline, the user can modify the statistical model and visualization used in the case study for a wide range of alternatives. For example, the linear model fit in this step of the example pipeline is based on an assumption of linearity in the relationship between cell populations and CFUs, but exploratory analysis might identify that this assumption is incorrect. In this case, since the pipeline is modular, the code fitting the linear models can be replaced with R code to fit non-linear or non-parametric models. Further, the pipeline allows users to add analysis steps at this point. For example, when performing multiple statistical tests there is an increased possibility of identifying false statistically relevant comparisons<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>. The user might want to adjust the acceptable p-values for the multiple comparisons made in fitting linear models for each cell population. The pipeline could be extended with the Benjamini and Hochberg False Discovery Rate correction (e.g., Supplementary Table <xref rid="MOESM1" ref-type="media">S3</xref>) or other multiple testing corrections (e.g., Bonferroni or Benjamini &amp; Yekutieli)<sup><xref ref-type="bibr" rid="CR22">22</xref>–<xref ref-type="bibr" rid="CR24">24</xref></sup>.</p>
    </sec>
    <sec id="Sec9">
      <title>Population validation via manual gating</title>
      <p id="Par19">As with the development of any new tool to analyze data, the pipeline must be tested against a traditional method, in this case, manual gating, to ensure that similar patterns and populations are captured in both analyses. To investigate if the estimated cell population sizes were similar between the automated and manual gating, a population for which we observed a relatively high percentage of cells (population 3) was manually gated (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S4</xref>). The percentage of cells in each of the populations at the different time points are very similar to the percentages calculated in this analysis pipeline with an average absolute difference of 0.26%. There is also a high correlation coefficient (ρ<sub>rs</sub> = 0.99, p &lt; 0.01), indicating a strong positive association between the manual and pipeline gating (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S4</xref>).</p>
    </sec>
    <sec id="Sec10">
      <title>Running time</title>
      <p id="Par20">Measurements for running time were made on a computer with 32GB RAM and a 4.2 GHz Intel Quad Core i7 processor. The initial data files contain a total of 7,299,424 cells (1.24GB); the FMO files contain 2,641,651 cells (0.57GB). Following gating, there were 468,754 cells from the FMOS and 1,023,402 cells from the sample data. These 1 million data points were input to the feature engineering algorithm. From the gating steps and feature engineering, through producing the plots in Fig. <xref rid="Fig3" ref-type="fig">3a</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">S2</xref>, the analysis script took 2.7 minutes running time. Half of this was spent on the gating steps (1.01 min). The running time was also evaluated based on the number of input cells to the feature engineering algorithm (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S5</xref>). It analyzes roughly 10,000 cells per second.</p>
    </sec>
    <sec id="Sec11">
      <title>Testing the pipeline with clinical human whole blood</title>
      <p id="Par21">Another dataset analyzing clinical human whole blood in a healthy individual was used to confirm the utility of this pipeline. This data was collected and compensated on a Fortessa II with a panel comprised of 5 markers: CD45, CD3, CD19, HLA-DR, and CD27. When used side-by-side, FMOs are a more robust depiction of the fluorescent marker composition in a sample as they account for spillover from other channels. However, it is not always possible to run FMOs. When there is good separation between the positive and negative populations within a marker, it is acceptable to base the MFI cutoffs on the sample data<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. The “mindensity” function from the <italic>openCyto</italic> package was used on the sample to determine thresholds for the feature engineering (Fig. <xref rid="Fig6" ref-type="fig">6a</xref>). Following feature engineering, a total of 19 populations were identified in the sample (Fig. <xref rid="Fig6" ref-type="fig">6b</xref>). The CD45+ populations, or leukocytes, were filtered and subset according to B cell and T cell lineages (Fig. <xref rid="Fig6" ref-type="fig">6c</xref>). The percentage of cells in each of the populations is shown in Fig. <xref rid="Fig6" ref-type="fig">6d</xref>. Finally, the comparison of the percentage of cells between the manual gating and the automated pipeline indicated high similarity between the two methods (Fig. <xref rid="Fig6" ref-type="fig">6e,f</xref>). The Spearman correlation coefficient (ρ<sub>rs</sub>) between the two methods is 0.96 with a p-value &lt; 0.001. There is therefore slightly more discrepancy between automated and manual gating for this dataset compared to the murine lung cells, although the ranking agreement between the two methods is still very high. The use of this clinical dataset shows the utility and flexibility of the pipeline for conventional flow cytometry without the need for FMOs.<fig id="Fig6"><label>Figure 6</label><caption><p>Testing the pipeline with human clinical samples. The data is first transformed so that it is viewable on a linear axis. (<bold>a</bold>) A “mindensity” gate from the R package <italic>openCyto</italic> is then used to determine the cutoff for positive and negative MFIs. (<bold>b</bold>) The data is feature engineered based on these cutoffs and identifies a total of 19 different populations. (<bold>c</bold>) The populations are then filtered to only view the leukocytes, or CD45+ populations. These populations are further subset by lineage. (<bold>d</bold>) The percentage of cells in each population is displayed. (<bold>e</bold>,<bold>f</bold>) Each population was manually gated in FlowJo and the difference in the percentage of cells from manual gating and the automated pipeline was compared. A table and plot compare the differences for each of the populations. Each point on the plot indicates a measurement for one of the 14 populations identified. The x-axis represents the value for the percentage of cells found via the automated pipeline, while the y-axis represents the percentage of cells found via manual gating. The y = x line through the center of the plot indicates where the points would be located if both of the gating methods output identical values. The Spearman correlation coefficient (ρ<sub>rs</sub>) comparing the methods and the p value are displayed at the top left of the plot.</p></caption><graphic xlink:href="41598_2020_64516_Fig6_HTML" id="d29e720"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec12" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par22">The exploration of large and complex biological datasets requires steps of simplification and aggregation; scientific research is improved if these steps draw on biological knowledge and principles, rather than relying exclusively on subject-agnostic statistical techniques. Flow cytometers generate data with continuous measurements of an underlying binary phenomenon, with much of the added noise in measurements due to spillover from other channels. FMO controls can be used to informatively distinguish negative and positive cell populations for a marker in flow cytometry data and are used for this purpose commonly in traditional manual gating. However, they have not yet been integrated with the open-source tools being created to improve objectivity and efficiency of flow cytometry analysis. As with any simplification step, the pipeline presented here does lose some of the information inherent in the original measurements. In cells that are positive for a marker, for example, the measurement of expression density may have some biological meaning, which is lost in creating binary distinctions in the feature engineering. Future development of this pipeline could focus on extending the methods to help explore meaningful variation among the positive values for a marker. In the case of markers in which there is low, intermediate, and high expression, the 99th percentile FMO cutoff could be used to determine the negative population. From here, a function like “mindensity” used to analyze the clinical data could be used to determine the minimum density between the intermediate and high population, thus splitting the marker into three expression levels. If a more continuous expression level is of interest, instead of using the “mindensity” function to separate the positive markers into intermediate and high expression, the continuous marker expression could be retained.</p>
    <p id="Par23">This pipeline’s modularity adheres to the Unix philosophy of combining small tools that each perform a discrete task to solve complex problems<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>. Excellent tools already exist in the R ecosystem, both specific to flow cytometry data (e.g., to perform initial gating on samples) and for more general data visualization and modeling. Rather than developing a “fixed” pipeline, where pre-existing tools are encapsulated within a framework that does not allow easy modifications or substitutions of steps in the pipeline, this pipeline is based on the principle of combining these existing tools from the R ecosystem. We designed this pipeline to use a common data format in later steps, which makes it useful to a variety of researchers, as it is easy to adapt with common R tools. For example, in the visualization and statistical testing stages, different statistical models and plots can easily be substituted for the linear regression that is used for the data described here. Another advantage of this modular pipeline is that it can be used on clinical and research cytometry samples from either conventional or spectral flow cytometers.</p>
    <p id="Par24">An added strength of the pipeline is that, since it is computationally simple, it does not require down-sampling of the raw flow cytometry data. For clustering algorithms that are computationally intensive (e.g., t-SNE), it is often necessary to down-sample data by taking a random sample of the data in order to improve computation time<sup><xref ref-type="bibr" rid="CR26">26</xref>,<xref ref-type="bibr" rid="CR27">27</xref></sup>. This manipulation of data can lead to the masking of novel discoveries. Each sample has a different total live leukocyte cell count allowing us to consider percentage of cells rather than total cell count throughout the pipeline. As our goal is to identify immune cells that are biologically involved in the protection against disease, we filtered the cell populations to those comprising &gt;0.5% of cells in at least one sample. In this case, even if only one animal in a group has a high percentage of cells in a certain population, it will be maintained to compare against all groups. In other contexts, for example, in cancer research where the goal is to identify very rare cell types, this percentage could be decreased with a low-set filter (e.g. to maintain populations with <underline>&lt;</underline>5 cells). The filtering and the feature engineering analyze the data in a way that makes it immediately interpretable to immunologists without the hassle and bias of manually looking for populations of interest or trying to understand complex clusters from other methods.</p>
    <p id="Par25">Another advantage of the pipeline is its ability to compile additional flow cytometry datasets. Other multiparametric approaches, such as UMAP and t-SNE, typically assign cells to unnamed clusters<sup><xref ref-type="bibr" rid="CR5">5</xref>,<xref ref-type="bibr" rid="CR28">28</xref></sup>. To compile replicated data, these methods map additional data back to the original data. Unlike these approaches, cyto-feature engineering does not assign data to unnamed clusters, but rather keeps groupings explicitly tied to specific, named markers in the original data. Provided that replicated or additional data contains the same markers as the original data, it can be seamlessly added to the pipeline by adding the data to the data folder. Any additional cell populations identified will be added to the plots when the analysis is run. Further, the data with cyto-feature engineering does not need to be manually gated to determine statistical significance between populations. Statistical analysis is a built-in feature that can be calculated based on the identified populations.</p>
    <p id="Par26">Researchers have an inherent bias in the types of cells they gate when analyzing flow cytometry data. By identifying all phenotypes present in the dataset, this pipeline allows users to analyze a variety of populations in an unbiased manner. These cell types, such as the CD153+ cells in the murine lung data, may have gone undiscovered if not for the use of this fast and reproducible pipeline. Importantly, this analysis pipeline relies on high quality flow cytometry methodology, and/or FMO samples, as well as, strong panel design. Spillover from other channels can greatly impact the analysis, so researchers must ensure that the controls are prepared correctly.</p>
    <p id="Par27">The analysis pipeline described here, allows for the use of necessary and rigorous technical controls in flow cytometry. The pipeline is able to identify populations that may not be normally gated. Provided that the samples and controls remain constant, the automated pipeline analysis will consistently produce the same results, removing person-to-person bias. Further, this pipeline drastically reduces the amount of time typically required to analyze flow cytometry data. Overall, this strategy is envisioned to help identify the elusive nature of cellular phenotypes through fast and accurate analysis of flow cytometry data.</p>
  </sec>
  <sec id="Sec13">
    <title>Methods</title>
    <sec id="Sec14">
      <title>Experimental setup</title>
      <p id="Par28">The experiment was designed to compare T cell populations between BCG-vaccinated and control (PBS-injected) mice following infection with <italic>M. tuberculosis</italic>. The populations could then be compared to the bacterial load (CFUs) to associate the immune cells with disease.</p>
    </sec>
    <sec id="Sec15">
      <title>Animals</title>
      <p id="Par29">C57BL/6 mice were purchased from the Jackson Laboratory (Bar Harbor, ME). The mice were retained in a BSL-3 facility at Colorado State University, and all experimental protocols were approved by the Institutional Animal Care and Use Committee at Colorado State University. All methods were carried out in accordance with relevant guidelines and regulations for care and use of laboratory animals.</p>
    </sec>
    <sec id="Sec16">
      <title>Vaccinations</title>
      <p id="Par30">Mice were vaccinated subcutaneously with 1 × 10<sup>6</sup> CFU <italic>M. bovis</italic> BCG Pasteur or 100 µL of phosphate buffered saline (PBS) (Corning, Corning, NY).</p>
    </sec>
    <sec id="Sec17">
      <title>Mycobacterium tuberculosis Infection</title>
      <p id="Par31">Twelve weeks after vaccination, mice were aerosol challenged with <italic>M. tuberculosis</italic> HN878 grown in 7H9 broth and stored at −80 °C. The <italic>M. tuberculosis</italic> was suspended in PBS and aerosolized using an aerosol chamber (Glas-Col, Terre Haute, IN). Aerosolization delivered 164 CFU/animal confirmed via plating whole lung homogenates on the same day of infection.</p>
    </sec>
    <sec id="Sec18">
      <title>Tissue preparation</title>
      <p id="Par32">Mice were euthanized by CO<sub>2</sub> inhalation. The superior and middle lung lobes were harvested and digested with DNase I- type IV Bovine (2.6 units/ml; Sigma-Aldrich, St. Louis, MO)/ Liberase (750 units/mL; Sigma-Aldrich, St. Louis, MO) at 37 °C for 30 minutes. The lungs were strained through a 70 µm cell strainer and treated for 1 minute with Red Blood Cell Lysing Buffer (Sigma-Aldrich, St. Louis, MO) to lyse erythrocytes. Complete DMEM, composed of 500 mL of 1x DMEM (Corning, Corning, NY), 45 mL of fetal bovine serum (Atlas Biologicals, Fort Collins, CO), 4.5 mL MEM non-essential amino acids (Corning, Corning, NY), 4.5 mL of Penicillin Streptomycin (10,000 units/mL Penicillin, 10,000 µg/mL Streptomycin; Thermo Fisher Scientific, Waltham, MA), and 4.5 mL of L-glutamine (Sigma-Aldrich, St. Louis, MO), was then added to neutralize the solution. Lung cells were resuspended in 500 µL of PBS (Corning, Corning, NY).</p>
    </sec>
    <sec id="Sec19">
      <title>Flow cytometry and analysis</title>
      <p id="Par33">Following single-cell suspension of lung cells in PBS, cells were stimulated with 1x BD Golgi Stop, a protein transport inhibitor (BD Biosciences, Cat# 554724) in complete media for 3 hours in a 37 °C incubator. Cells were then washed with PBS and incubated with a 1:2,000 dilution of Zombie-NIR viability stain (BioLegend, San Diego, CA) for 15 minutes in the dark at room temperature. After a wash with FACS Staining buffer (PBS (Corning, Corning, NY) containing 2% Fetal Bovine Serum (Atlas Biologicals, Fort Collins, CO) and 0.05% sodium azide (Thermo Fisher Scientific, Waltham, MA)), cells were incubated for 30 minutes at 4 °C with a fluorescently-labeled surface antibody cocktail containing a 1:200 dilution of FC Block (See Supplementary Table <xref rid="MOESM1" ref-type="media">S4</xref>). Following a wash with FACS staining buffer, cells were incubated with 150 µL of 1x Permeabilization/Fixation buffer (Invitrogen, Carlsbad, CA) for 1 hour at room temperature. Cells were subsequently washed with 150 µL of 1x permeabilization buffer (Invitrogen, Carlsbad, CA) before being incubated with an intracellular cytokine antibody cocktail overnight at 4 °C in the dark. Cells were then washed and finally resuspended in 1x permeabilization buffer. Eighteen markers were used to analyze memory T cell expression: Sca-1, CD3, CD62L, CD122, CD28, PD-1, CD103, CD44, CD4, CD8, CTLA-4, CD27, CD153, KLRG-1, IL-17, IFN-γ, IL-10, and TNF-α (Supplementary Table <xref rid="MOESM1" ref-type="media">S4</xref>). Antibodies and reagents were purchased from BD Biosciences, BioLegend, or Thermo Fisher Scientific. 100,000 events were collected per sample on a Cytek Aurora Flow Cytometer (Cytek, Fremont, CA) and analyzed with FlowJo version 10.5.2 software and the cyto-feature engineering pipeline. Cell populations were identified by unsupervised feature engineering of cells by phenotype and confirmed via traditional gating methods.</p>
    </sec>
    <sec id="Sec20">
      <title>Bacterial burden</title>
      <p id="Par34">One third lungs were placed in a Bullet Blender Blue (Next Advance, Troy, NY) and homogenized at speed 8 for 4 minutes. Tissue homogenate was plated at a 1:5 dilution on 7H11 agar plates. The limit of detection is 15 CFUs for lungs.</p>
    </sec>
    <sec id="Sec21">
      <title>Human clinical data</title>
      <p id="Par35">Human clinical data was obtained and processed as previously described<sup><xref ref-type="bibr" rid="CR29">29</xref>–<xref ref-type="bibr" rid="CR31">31</xref></sup>. All experimental protocols involving human subjects were approved by the Ethics Committee of the Institute of Medical Research of the Faculty of Medicine at the University of Antioquia and adhere to the ethical principles outlined in the Declaration of Helsinki. EDTA-anticoagulated (4 mL) whole cells were obtained from peripheral blood of healthy volunteers aged 20–30 years, after written informed consent to participate. Most of them worked in the Sede de Investigación Universitaria (SIU) at Universidad de Antioquia and signed a written informed consent approved by the Ethics Committee of the Institute of Medical Research of the Faculty of Medicine at the University of Antioquia. They declared that they were not taking any medication and that they had neither an autoimmune nor active infectious disease.</p>
      <p id="Par36">Thirty microliters of whole blood cells suspended in 100 µL eBioscience Flow Cytometry Staining Buffer (Cat# 00-4222-26) and stained with fluorochrome-conjugated mouse anti-human 0.5 µL CD45-PE-Cy7 (Clone: HI30), 5 µL CD3-PE (Clone: OKT3), 7 µL CD19-Alexa Fluor 488 (Clone: HIB19) and 5 µL CD27-APC (Clone: M-T271) monoclonal antibodies for twenty minutes at room temperature. Erythrocytes were lysed with 300 μL of OptiLyse Buffer for 10 minutes and 300 μL of sterile deionized water for an additional 10 minutes. The acquisition was performed in an LSR Fortessa II flow cytometer.</p>
    </sec>
    <sec id="Sec22">
      <title>Statistical analysis and reproducible code</title>
      <p id="Par37">Statistical significance for CFUs was determined using unpaired t-tests (p &lt; 0.05) using the <italic>ggpubr </italic>package, R version 3.6.2. The R and package versions can be found in Supplementary Fig. <xref rid="MOESM1" ref-type="media">S6</xref>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec23">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41598_2020_64516_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary information.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>is available for this paper at 10.1038/s41598-020-64516-0.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank the Colorado State University BSL-3 facility, as well as, the Colorado State University flow core for use of their facilities and services. The work reported here was supported by NIH grant 1R01 AI127475-01A1 and a National Science Foundation grant (DGE-1450032). Any options, findings, conclusions, or recommendations expressed are those of the authors and do not necessarily reflect the views of the National Science Foundation.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>A.F. developed the analysis pipeline. A.F., T.S.D., B.K., A.O.H., M.R., M.H.T. performed the experiments and acquired the data. A.F. performed statistical analyses. M.H.T. and G.B.A. supervised the study. A.F., M.H.T., and G.B.A. wrote the paper with input from the other authors. All authors reviewed the manuscript. M.H.T. funded the work.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The datasets generated during and/or analyzed during the current study are available online. The flow cytometry data can be found at Flow Repository: <ext-link ext-link-type="uri" xlink:href="https://flowrepository.org/id/RvFrMfWyY0wR3ZM3cvlsAsQPBmAOXmMUzURGm1D8V0ShqSNnH2UCrPdpttuoqNS4">https://flowrepository.org/id/RvFrMfWyY0wR3ZM3cvlsAsQPBmAOXmMUzURGm1D8V0ShqSNnH2UCrPdpttuoqNS4</ext-link>.</p>
    <p>All other data can be found at: <ext-link ext-link-type="uri" xlink:href="https://github.com/aef1004/cyto-feature_engineering">https://github.com/aef1004/cyto-feature_engineering</ext-link> in the “data” folder.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>Code to analyze the data and produce the graphs can be found at: <ext-link ext-link-type="uri" xlink:href="https://github.com/aef1004/cyto-feature_engineering">https://github.com/aef1004/cyto-feature_engineering</ext-link>.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par38">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">BD FACSymphony, <ext-link ext-link-type="uri" xlink:href="https://www.bdbiosciences.com/en-eu/instruments/research-instruments/research-cell-analyzers/facsymphony">https://www.bdbiosciences.com/en-eu/instruments/research-instruments/research-cell-analyzers/facsymphony</ext-link> (2019).</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">Verschoor, C. P., Lelic, A., Bramson, J. L. &amp; Bowdish, D. M. E. An introduction to automated flow cytometry gating tools and their implementation. <italic>Frontiers in Immunology</italic><bold>6</bold> (2015).</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Finak, G. <italic>et al</italic>. OpenCyto: An Open Source Infrastructure for Scalable, Robust, Reproducible, and Automated, End-to-End Flow Cytometry Data Analysis. <italic>Plos Computational Biology</italic><bold>10</bold> (2014).</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van Gassen</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>FlowSOM: Using self-organizing maps for visualization and interpretation of cytometry data</article-title>
        <source>Cytometry Part A</source>
        <year>2015</year>
        <volume>87A</volume>
        <fpage>636</fpage>
        <lpage>645</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.22625</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van der Maaten</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hinton</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Visualizing Data using t-SNE</article-title>
        <source>Journal of Machine Learning Research</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>2579</fpage>
        <lpage>2605</lpage>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Platon</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A computational approach for phenotypic comparisons of cell populations in high-dimensional cytometry data</article-title>
        <source>Methods</source>
        <year>2018</year>
        <volume>132</volume>
        <fpage>66</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ymeth.2017.09.005</pub-id>
        <pub-id pub-id-type="pmid">28917725</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beyrend</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Stam</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hollt</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ossendorp</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Arens</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Cytofast: A workflow for visual and quantitative analysis of flow andmass cytometry data to discover immune signatures and correlations</article-title>
        <source>Computational and Structural Biotechnology Journal</source>
        <year>2018</year>
        <volume>16</volume>
        <fpage>435</fpage>
        <lpage>442</lpage>
        <pub-id pub-id-type="doi">10.1016/j.csbj.2018.10.004</pub-id>
        <pub-id pub-id-type="pmid">30450167</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Spidlen</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Data File Standard for Flow Cytometry, Version FCS 3.1</article-title>
        <source>Cytometry Part A</source>
        <year>2010</year>
        <volume>77A</volume>
        <fpage>97</fpage>
        <lpage>100</lpage>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Hahne, F. <italic>et al</italic>. flowCore: a Bioconductor package for high throughput flow cytometry. <italic>Bmc Bioinformatics</italic><bold>10</bold> (2009).</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Hahne, F. <italic>et al</italic>. flowStats, <ext-link ext-link-type="uri" xlink:href="http://www.github.com/RGLab/flowStats">http://www.github.com/RGLab/flowStats</ext-link> (2019).</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Wickham, H. &amp; Grolemund, G. <italic>R for Data Science: Import, Tidy, Transform, Visualize, and Model Data</italic>. (O’Reilly Media, Inc., Sebastopol, 2017).</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Roederer, M. Compensation in flow cytometry. <italic>Current protocols in cytometry</italic> Chapter 1, Unit 1.14-Unit 11.14 (2002).</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saeys</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Van Gassen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lambrecht</surname>
            <given-names>BN</given-names>
          </name>
        </person-group>
        <article-title>Computational flow cytometry: helping to make sense of high-dimensional immunology data</article-title>
        <source>Nature Reviews Immunology</source>
        <year>2016</year>
        <volume>16</volume>
        <fpage>449</fpage>
        <lpage>462</lpage>
        <pub-id pub-id-type="doi">10.1038/nri.2016.56</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Zheng, A. &amp; Casari, A. <italic>Feature Engineering for Machine Learning: Principles and Techniques for Data Scientist</italic>. (O’Reilly Media, Inc., Sebastopol, 2018).</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Kuhn, M. &amp; Johnson, K. <italic>Feature Engineering and Selection: A Practical Approach for Predictive Models</italic>. (Taylor &amp; Francis Group, Boca Raton, 2019).</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Henao-Tamayo</surname>
            <given-names>MI</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phenotypic Definition of Effector and Memory T-Lymphocyte Subsets in Mice Chronically Infected with Mycobacterium tuberculosis</article-title>
        <source>Clinical and Vaccine Immunology</source>
        <year>2010</year>
        <volume>17</volume>
        <fpage>618</fpage>
        <lpage>625</lpage>
        <pub-id pub-id-type="doi">10.1128/CVI.00368-09</pub-id>
        <pub-id pub-id-type="pmid">20107011</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Wu, K. <italic>et al</italic>. CD4(+) TSCMs in the Bone Marrow Assist in Maturation of Antibodies against Influenza in Mice. <italic>Mediators of Inflammation</italic> (2019).</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sallin</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Host resistance to pulmonary Mycobacterium tuberculosis infection requires CD153 expression</article-title>
        <source>Nature Microbiology</source>
        <year>2018</year>
        <volume>3</volume>
        <fpage>1198</fpage>
        <lpage>1205</lpage>
        <pub-id pub-id-type="doi">10.1038/s41564-018-0231-6</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Flynn</surname>
            <given-names>JL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An Essential Role for Interferon-Gamma In Resistance to Mycobacterium-Tuberculosis Infection</article-title>
        <source>Journal of Experimental Medicine</source>
        <year>1993</year>
        <volume>178</volume>
        <fpage>2249</fpage>
        <lpage>2254</lpage>
        <pub-id pub-id-type="doi">10.1084/jem.178.6.2249</pub-id>
        <pub-id pub-id-type="pmid">7504064</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ordway</surname>
            <given-names>DJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mycobacterium bovis BCG-Mediated Protection against W-Beijing Strains of Mycobacterium tuberculosis Is Diminished Concomitant with the Emergence of Regulatory T Cells</article-title>
        <source>Clinical and Vaccine Immunology</source>
        <year>2011</year>
        <volume>18</volume>
        <fpage>1527</fpage>
        <lpage>1535</lpage>
        <pub-id pub-id-type="doi">10.1128/CVI.05127-11</pub-id>
        <pub-id pub-id-type="pmid">21795460</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Franceschi</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Giordan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wehrens</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Multiple comparisons in mass-spectrometry-based -omics technologies</article-title>
        <source>Trac-Trends in Analytical Chemistry</source>
        <year>2013</year>
        <volume>50</volume>
        <fpage>11</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1016/j.trac.2013.04.011</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the False Discovery Rate – A Practical And Powerful Approach to Multiple Testing</article-title>
        <source>Journal of the Royal Statistical Society Series B-Statistical Methodology</source>
        <year>1995</year>
        <volume>57</volume>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yekutieli</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>The control of the false discovery rate in multiple testing under dependency</article-title>
        <source>Annals of Statistics</source>
        <year>2001</year>
        <volume>29</volume>
        <fpage>1165</fpage>
        <lpage>1188</lpage>
        <pub-id pub-id-type="doi">10.1214/aos/1013699998</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Curtin</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Schulz</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Multiple correlations and Bonferroni’s correction</article-title>
        <source>Biological Psychiatry</source>
        <year>1998</year>
        <volume>44</volume>
        <fpage>775</fpage>
        <lpage>777</lpage>
        <pub-id pub-id-type="doi">10.1016/S0006-3223(98)00043-2</pub-id>
        <pub-id pub-id-type="pmid">9798082</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">Gancarz, M. The Unix Philosophy. (Butterworth-Heinemann, 1995).</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Belkina, A.C. <italic>et al</italic>. Automated optimized parameters for t-distributed stochastic neighbor embedding improve visualization and allow analysis of large datasets. <italic>Nature Communications</italic><bold>10</bold>, (2019).</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Crawford, T.Q. Dimensionatily Reduction with the tSNE algorithm, <ext-link ext-link-type="uri" xlink:href="https://www.flowjo.com/learn/flowjo-university/flowjo/tutorial/31">https://www.flowjo.com/learn/flowjo-university/flowjo/tutorial/31</ext-link> (2019).</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Becht</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dimensionality reduction for visualizing single-cell data using UMAP</article-title>
        <source>Nature Biotechnology</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>38</fpage>
        <lpage>+</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4314</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arroyo</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Rojas</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Franken</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ottenhoff</surname>
            <given-names>THM</given-names>
          </name>
          <name>
            <surname>Barrera</surname>
            <given-names>LF</given-names>
          </name>
        </person-group>
        <article-title>Multifunctional T Cell Response to DosR and Rpf Antigens Is Associated with Protection in Long-Term Mycobacterium tuberculosis-Infected Individuals in Colombia</article-title>
        <source>Clinical and Vaccine Immunology</source>
        <year>2016</year>
        <volume>23</volume>
        <fpage>813</fpage>
        <lpage>824</lpage>
        <pub-id pub-id-type="doi">10.1128/CVI.00217-16</pub-id>
        <pub-id pub-id-type="pmid">27489136</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marin</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Paris</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Rojas</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Garcia</surname>
            <given-names>LF</given-names>
          </name>
        </person-group>
        <article-title>Functional profile of CD4+ and CD8+ T cells in latently infected individuals and patients with active TB</article-title>
        <source>Tuberculosis</source>
        <year>2013</year>
        <volume>93</volume>
        <fpage>155</fpage>
        <lpage>166</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tube.2012.12.002</pub-id>
        <pub-id pub-id-type="pmid">23332142</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marin</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Paris</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Rojas</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Garcia</surname>
            <given-names>LF</given-names>
          </name>
        </person-group>
        <article-title>Reduced Frequency of Memory T Cells and Increased Th17 Responses in Patients with Active Tuberculosis</article-title>
        <source>Clinical and Vaccine Immunology</source>
        <year>2012</year>
        <volume>19</volume>
        <fpage>1667</fpage>
        <lpage>1676</lpage>
        <pub-id pub-id-type="doi">10.1128/CVI.00390-12</pub-id>
        <pub-id pub-id-type="pmid">22914361</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
