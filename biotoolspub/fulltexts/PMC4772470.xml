<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4772470</article-id>
    <article-id pub-id-type="publisher-id">944</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-016-0944-6</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Discrete distributional differential expression (D<sup>3</sup>E) - a tool for gene expression analysis of single-cell RNA-seq data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Delmans</surname>
          <given-names>Mihails</given-names>
        </name>
        <address>
          <email>md656@cam.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Hemberg</surname>
          <given-names>Martin</given-names>
        </name>
        <address>
          <email>mh26@sanger.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <aff id="Aff1"><label/>Department of Plant Sciences, University of Cambridge, Downing Street, Cambridge, CB2 3EA UK </aff>
      <aff id="Aff2"><label/>Wellcome Trust Sanger Institute, Wellcome Genome Campus, Hinxton, CB10 1SA UK </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>2</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>2</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2016</year>
    </pub-date>
    <volume>17</volume>
    <elocation-id>110</elocation-id>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>10</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>1</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Delmans and Hemberg. 2016</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>The advent of high throughput RNA-seq at the single-cell level has opened up new opportunities to elucidate the heterogeneity of gene expression. One of the most widespread applications of RNA-seq is to identify genes which are differentially expressed between two experimental conditions.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We present a discrete, distributional method for differential gene expression (D<sup>3</sup>E), a novel algorithm specifically designed for single-cell RNA-seq data. We use synthetic data to evaluate D<sup>3</sup>E, demonstrating that it can detect changes in expression, even when the mean level remains unchanged. Since D<sup>3</sup>E is based on an analytically tractable stochastic model, it provides additional biological insights by quantifying biologically meaningful properties, such as the average burst size and frequency. We use D<sup>3</sup>E to investigate experimental data, and with the help of the underlying model, we directly test hypotheses about the driving mechanism behind changes in gene expression.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>Evaluation using synthetic data shows that D<sup>3</sup>E performs better than other methods for identifying differentially expressed genes since it is designed to take full advantage of the information available from single-cell RNA-seq experiments. Moreover, the analytical model underlying D<sup>3</sup>E makes it possible to gain additional biological insights.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s12859-016-0944-6) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Single-cell RNA-seq</kwd>
      <kwd>Differential gene expression</kwd>
      <kwd>Stochastic gene expression</kwd>
      <kwd>Software</kwd>
      <kwd>Transcriptional bursting model</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100004440</institution-id>
            <institution>Wellcome Trust (GB)</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000268</institution-id>
            <institution>Biotechnology and Biological Sciences Research Council (GB)</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2016</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Over the last two decades, several methods for global quantitative profiling of gene expression have been developed [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR36">36</xref>]. One of the most common uses of gene expression data is to identify differentially-expressed (DE) genes between two groups of replicates collected from distinct experimental conditions, e.g. stimulated vs unstimulated, mutant vs wild-type, or at separate time-points. The goal of DE analysis is to identify genes that underlie the phenotypical differences between the conditions.</p>
    <p>The first method for genome-wide expression profiling was microarrays, but as sequencing costs have decreased, profiling by direct sequencing of the transcriptome (RNA-seq) has become more popular. Initially, RNA-seq experiments were carried out in bulk on samples of up to 10<sup>5</sup> cells. Consequently, only information about the mean expression of each gene in a sample could be extracted. However, it has been known since the 1950s [<xref ref-type="bibr" rid="CR20">20</xref>] that gene expression varies from cell to cell, and more recently it has been shown that stochastic variation may play an important role in development, signaling and stress response [<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR38">38</xref>]. Thus, recently developed single-cell RNA-seq protocols [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR34">34</xref>], could potentially provide a greater understanding of how the transcriptome varies between cells with the same genotype and cell-type. The main advantage of single-cell RNA-seq over bulk RNA-seq is the fact that one obtains the full distribution of expression levels, rather than the population mean. To take full advantage of single-cell data, for DE analysis as well as for other types of investigation, e.g. inference of gene regulatory networks, novel analysis methods are required.</p>
    <p>Single-cell DE analysis is complicated by the fact that comparison of two probability distributions is an ambiguous task. With the exception of SCDE [<xref ref-type="bibr" rid="CR16">16</xref>], most common tools for preforming single-cell DE analysis - DESeq2 [<xref ref-type="bibr" rid="CR18">18</xref>], Cuffdiff [<xref ref-type="bibr" rid="CR35">35</xref>], limma [<xref ref-type="bibr" rid="CR29">29</xref>] and EdgeR [<xref ref-type="bibr" rid="CR30">30</xref>] - are all adaptations of bulk RNA-sequencing methods. They mainly focus on filtration and normalisation of the raw data, and DE genes are identified based on changes in mean expression levels. The main drawback of using only the mean is that one ignores the gene expression heterogeneity, and will thus fail to detect situations where, for example, there is only a change in the variance of gene expression. Alternative methods for comparing probability distributions are the Kolmogorov-Smirnov test, the likelihood ratio test and the Cramér-von Mises test. What these methods have in common is that they summarize the difference between two distributions as a single value, which can be used to test for significance.</p>
    <p>Gene expression at the single-cell level has been studied theoretically for almost three decades [<xref ref-type="bibr" rid="CR5">5</xref>], and the most widely used model is referred to as the transcriptional bursting model. The transcriptional bursting model [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR24">24</xref>] provides a mechanistic description of the stochastic switching of the promoter as well as the the production and degradation of transcripts at the single cell level (Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">a</xref>,<xref rid="Fig1" ref-type="fig">b</xref>). The model makes it easy to generate synthetic data which closely resembles the experimental data. Since the model is analytically tractable it allows us to derive several other biologically relevant properties of gene expression (Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">c</xref>) [<xref ref-type="bibr" rid="CR17">17</xref>], which makes it easier to interpret results biologically. Despite its simplicity, the transcriptional bursting model enjoys strong experimental support [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR39">39</xref>, <xref ref-type="bibr" rid="CR40">40</xref>].
<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of D<sup>3</sup>E. <bold>a</bold> Graphical representation of the transcriptional bursting model. <bold>b</bold> Example of a realization of the transcriptional bursting model with parameters <italic>α</italic>=1,<italic>β</italic>=10, <italic>γ</italic>=100, and <italic>λ</italic>=1 [<xref ref-type="bibr" rid="CR12">12</xref>]. In this regime, the gene exhibits a bursty behavior with a bimodal stationary distribution. <bold>c</bold> Derivation of the biologically-relevant parameters from the parameters of the transcriptional bursting model. <bold>d</bold> Flowchart of the D<sup>3</sup>E algorithm</p></caption><graphic xlink:href="12859_2016_944_Fig1_HTML" id="MO1"/></fig></p>
    <p>In this paper, we present D<sup>3</sup>E, a method based on the comparison of two probability distributions for performing differential gene expression analysis. D<sup>3</sup>E consists of two separate modules: a module for comparing expression profiles using the Cramér-von Mises, the likelihood-ratio test, or the Kolmogorov-Smirnov test, and a module for fitting the transcriptional bursting model. Thus, D<sup>3</sup>E allows the user to go beyond merely identifying DE genes and provides biological insight into the mechanisms underlying the change in expression. We demonstrate the power of D<sup>3</sup>E to detect changes in gene expression using synthetic data. Finally, we apply D<sup>3</sup>E to experimental data to demonstrate its ability to detect significant changes which are not reflected by the mean.</p>
  </sec>
  <sec id="Sec2">
    <title>Results and discussion</title>
    <sec id="Sec3">
      <title>Algorithm and implementation</title>
      <p>D<sup>3</sup>E takes a read-count table as an input, with rows and columns corresponding to transcripts and cells, respectively. The user should split the columns into two or more groups by providing cell labels in the input file. If there are more than two groups of cells, they must be compared one pair at a time. D<sup>3</sup>E uses four steps to process the data. First, input data is normalised using the same algorithm as DESeq2 (see <xref rid="Sec9" ref-type="sec">Implementation</xref>) and filtered by removing the genes that are not expressed in any of the cells. Second, the Cramér-von Mises test, the Kolmogorov-Smirnov (KS) test, or the likelihood ratio test [<xref ref-type="bibr" rid="CR11">11</xref>] is used to identify the genes with a significant change in expression between the two samples of interest. Third, the transcriptional bursting model is fitted to the expression data for each gene in both samples using either the method of moments or a Bayesian method [<xref ref-type="bibr" rid="CR17">17</xref>]. Fourth, the change in parameters between the two samples is calculated for each gene (Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">d</xref>).</p>
      <p>A command-line version of D<sup>3</sup>E written in Python can be downloaded from GitHub (<ext-link ext-link-type="uri" xlink:href="https://hemberg-lab.github.io/D3E">https://hemberg-lab.github.io/D3E</ext-link>), and the source code is available under the GPL licence. Furthermore, there is also a web-version available at <ext-link ext-link-type="uri" xlink:href="http://www.sanger.ac.uk/sanger/GeneRegulation_D3E">http://www.sanger.ac.uk/sanger/GeneRegulation_D3E</ext-link>. Due to the time required to run D<sup>3</sup>E, the web version limits the number of genes and cells that may be analyzed, and it can only use the method of moments for estimating parameters.</p>
    </sec>
    <sec id="Sec4">
      <title>DE analysis module</title>
      <p>To compare distributions obtained from two different sets of cells, D<sup>3</sup>E uses either the Cramér-von Mises test, the KS test or the likelihood ratio test to quantify the difference in gene expression (see <xref rid="Sec9" ref-type="sec">Implementation</xref>). The first two tests are non-parametric which is advantageous since it allows us to apply D<sup>3</sup>E to any single-cell dataset, not just the ones collected using RNA-seq. The null hypothesis for all three tests is that the two samples are drawn from the same distribution. The premise of D<sup>3</sup>E is that when two samples are drawn from the same population of cells, the test should result in a high <italic>p</italic>-value. On the other hand, if the cells are drawn from two populations with different transcript distributions, then the resulting <italic>p</italic>-value should be low.</p>
      <p>We first evaluated D<sup>3</sup>E using synthetic data. Fortunately, there is a widely used, experimentally validated stochastic model available for single-cell gene expression [<xref ref-type="bibr" rid="CR22">22</xref>]. We refer to this model as the transcriptional bursting model (Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">a</xref>), and it is characterized by three parameters: <italic>α</italic>, the rate of promoter activation; <italic>β</italic>, the rate of promoter inactivation; <italic>γ</italic>, the rate of transcription when the promoter is in the active state; and a transcript degradation rate <italic>λ</italic>. The stationary distribution of the transcriptional bursting model takes the form of a Poisson-Beta mixture distribution [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR22">22</xref>] 
<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} PB(n \; | \; \alpha, \beta, \gamma, \lambda) &amp; = &amp; \text{Poi}(n \; | \; \gamma x/\lambda) \bigwedge_{x} \text{Beta}(x \;|\; \alpha, \beta) \\ &amp; = &amp; \frac{\gamma^{n}e^{-\gamma/\lambda}\Gamma(\alpha/\lambda+n)\Gamma(\alpha/\lambda + \beta/\lambda)}{\lambda^{n}\Gamma(n+1)\Gamma(\alpha/\lambda + \beta/\lambda + n)\Gamma(\alpha/\lambda)}\\&amp;&amp;\Phi\left(\frac{\alpha}{\lambda}, \frac{\alpha}{\lambda} + \frac{\beta}{\lambda} + n; \frac{\gamma}{\lambda}\right), \end{array} $$ \end{document}</tex-math><mml:math id="M2"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:mtext mathvariant="italic">PB</mml:mtext><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mspace width="2.77626pt"/><mml:mo>|</mml:mo><mml:mspace width="2.77626pt"/><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mi>γ</mml:mi><mml:mo>,</mml:mo><mml:mi>λ</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mtext>Poi</mml:mtext><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mspace width="2.77626pt"/><mml:mo>|</mml:mo><mml:mspace width="2.77626pt"/><mml:mi>γx</mml:mi><mml:mo>/</mml:mo><mml:mi>λ</mml:mi><mml:mo>)</mml:mo><mml:munder><mml:mrow><mml:mo>∧</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:munder><mml:mtext>Beta</mml:mtext><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mspace width="2.77626pt"/><mml:mo>|</mml:mo><mml:mspace width="2.77626pt"/><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"/><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:mo>/</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:msup><mml:mi>Γ</mml:mi><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>/</mml:mo><mml:mi>λ</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo><mml:mi>Γ</mml:mi><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>/</mml:mo><mml:mi>λ</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo>/</mml:mo><mml:mi>λ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mi>Γ</mml:mi><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mi>Γ</mml:mi><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>/</mml:mo><mml:mi>λ</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo>/</mml:mo><mml:mi>λ</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo><mml:mi>Γ</mml:mi><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>/</mml:mo><mml:mi>λ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"/><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"><mml:mi>Φ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mo>;</mml:mo><mml:mfrac><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2016_944_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>n</italic> is the number of transcripts of a particular gene, <italic>x</italic> is an auxiliary variable, <italic>Γ</italic> is the Euler Gamma function, and <italic>Φ</italic>(<italic>a,b</italic>;<italic>c</italic>) is the confluent hypergeometric function.</p>
      <p>An important feature of the Poisson-Beta distribution is that the three parameters <italic>α</italic>,<italic>β</italic> and <italic>γ</italic> are normalised by the rate of mRNA degradation <italic>λ</italic>. Consequently, when fitting the parameters for the Poisson-Beta distribution from a stationary sample, only three parameters can be estimated, and they are unique up to a common multiplicative factor, <italic>λ</italic>. Since a single-cell RNA-seq experiment corresponds to a snapshot of individual cells, it is often reasonable to assume that the samples are drawn from the stationary distribution. The inability to uniquely identify all four parameters from single-cell RNA-seq data means that it is only approprite to apply the transcriptional bursting model to DE analysis when <italic>λ</italic>s are constant between the compared samples, or when the degradation rates are known for both samples. Without knowledge of <italic>λ</italic> it is impossible to unambiguously determine how the parameters have changed.</p>
      <p>To evaluate the sensitivity of the Cramér-von Mises, the KS and the likelihood ratio test to changes in the parameters, we selected triplets of parameters (<italic>α</italic>,<italic>β</italic>,<italic>γ</italic>) from a range that is characteristic for single-cell RNA-seq data [<xref ref-type="bibr" rid="CR15">15</xref>]. For each parameter triplet one of the parameters was varied, while fixing the remaining two, and a series of tests was carried out on the corresponding Poisson-Beta samples. For each combination of parameters, we assumed that there were 50 cells from each condition when generating the data. The results can be summarized by a set of matrices, where rows and columns correspond to values of the varied parameter, and the elements in the matrix are <italic>p</italic>-values from the tests (Fig. <xref rid="Fig2" ref-type="fig">2</xref><xref rid="Fig2" ref-type="fig">c</xref>). Ideally we would like to find high <italic>p</italic>-values on the diagonal and low <italic>p</italic>-values away from the diagonal. We used a heuristic for characterizing the pattern of <italic>p</italic>-values, and for each matrix we obtained a single score, <italic>S</italic> (see <xref rid="Sec9" ref-type="sec">Implementation</xref>). When <italic>S</italic>=0, high <italic>p</italic>-values are only found on the diagonal, suggesting that D<sup>3</sup>E has successfully identified genes where there was a change in one of the parameters.
<fig id="Fig2"><label>Fig. 2</label><caption><p>DE analysis for synthetic data. <bold>a</bold> Sensitivity to changes in parameters of the Poisson-Beta distribution for the Cramér-von Mises, KS and likelihood ratio tests. A lighter color denotes a low sensitivity to changes of a particular parameter. <bold>b</bold> Average sensititivity scores for the panels in <bold>a</bold> as well as the run-times. <bold>c</bold> An example of a matrix which was used to assign the colors in <bold>a</bold>. Here, parameters <italic>α</italic>=.22 and <italic>β</italic>=.28, while <italic>γ</italic> is varied from 1 to 100 on a log-scale. Each element in the matrix reflects a <italic>p</italic>-value of a KS test between two Poisson-Beta distributions with the corresponding parameters. We expect to find high values along the diagonal, where the changes are smaller. <bold>d</bold> DE analysis for the scenario where the mean is fixed but the variance is changed. D<sup>3</sup>E is able to reliably identify differentially expressed genes based on the change in the shape of distribution alone. Here, the color represents the <italic>p</italic>-value for the Cramér-von Mises test with dark colors indicating a low value</p></caption><graphic xlink:href="12859_2016_944_Fig2_HTML" id="MO2"/></fig></p>
      <p>The results suggest that all three tests are capable of accurately detecting changes in the parameters in certain regions of the parameter space (Fig. <xref rid="Fig2" ref-type="fig">2</xref><xref rid="Fig2" ref-type="fig">a</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>). For all three tests, changes in <italic>β</italic> are the most difficult to detect while changes in <italic>γ</italic> are the easiest to identify. The methods perform poorly when <italic>γ</italic> is small and either <italic>β</italic> is large or <italic>α</italic> is small. In this regime, the Poisson-Beta distribution is similar to the Poisson distribution with a mean close to zero, and it is challenging to identify which parameter has changed, and by how much. From a biological perspective, when a transcription rate is small and a gene has a small duty cycle (small <italic>α</italic> or big <italic>β</italic>) there are almost no transcripts produced since the promoter spends most of its time in the inactive state. Therefore, changes in either of the three parameters will be difficult to distinguish. The performance of each method can be summarized by the average score across all combination of parameters and we find that the likelihood ratio test is the most accurate, followed by the Cramér-von Mises test and the KS test (Fig. <xref rid="Fig2" ref-type="fig">2</xref><xref rid="Fig2" ref-type="fig">b</xref>, S1). The accuracy, however, is also mirrored by the computational costs; analyzing the data in Fig. <xref rid="Fig2" ref-type="fig">2</xref><xref rid="Fig2" ref-type="fig">a</xref> takes about 18 s for the KS-test, 30 min for the Cramér-von Mises test and 8.3 h for the likelihood ratio test using a MacBook Pro laptop with a 3.2 GHz Intel i5 processor and 16 Gb of RAM.</p>
      <p>We also considered the scenario when the two distributions are different, but the mean is identical. This is a situation where it is all but impossible for methods which only use the mean to reliably detect that there has been a change in the expression profile. In contrast, D<sup>3</sup>E is able to reliably identify a change in expression. Our results show that a change of <italic>α</italic> and <italic>β</italic> by a factor of 2, which is roughly equivalent to changing the variance by the same factor, is sufficient for the <italic>p</italic>-value to drop below.05 for a sample of 50 cells (Fig. <xref rid="Fig2" ref-type="fig">2</xref><xref rid="Fig2" ref-type="fig">d</xref>).</p>
      <p>A particular challenge for DE analysis is to determine the <italic>p</italic>-value threshold for when a change can be considered significant. The traditional approach is to use a fixed value, e.g..05, and then adjust for multiple hypothesis testing. For D<sup>3</sup>E two different methods are offered for selecting the critical <italic>p</italic>-value. On the one hand, the user can specify a false discovery rate, and the tool will use the Benjamini-Hochberg procedure [<xref ref-type="bibr" rid="CR4">4</xref>] to identify the critical <italic>p</italic>-value. Alternatively, one may take an empirical approach whereby one of the two samples is first split into two parts. By definition, the two parts should have identical distributions for all genes, which means that it can be used as a negative control. D<sup>3</sup>E applies one of the three tests to the negative control, and records the lowest <italic>p</italic>-value identified, <italic>p</italic><sup>∗</sup>. When comparing the two original distributions, only genes with a <italic>p</italic>-value below <italic>a</italic>×<italic>p</italic><sup>∗</sup> are considered significant, where the default value for the parameter <italic>a</italic> is.1. We advice the user that the reduced sample size of the negative control set is likely to result in a less stringent cut-off than what would be expected if the negative control had the same sample size as the original data. To evaluate the heuristic strategy, we generated 1,000 pair of samples with the same number of reads and cells, using identical parameter values for the samples in each pair. Using the Cramér-von Mises test we recorded the lowest observed <italic>p</italic>-value, <italic>p</italic><sup>∗</sup>, and we used.1×<italic>p</italic><sup>∗</sup> as a threshold for when to call a test significant. For both the method of moments and the Bayesian method, we found that 97 % of the genes were detected as not DE. The control experiment demonstrates that D<sup>3</sup>E is capable of accurately distinguishing situations where the parameters are unchanged.</p>
      <p>To further evaluate the performance of D<sup>3</sup>E relative to other DE methods, we generated additional synthetic data sets where one of the three parameters was varied while the other two were fixed as before. For each data set we designated genes as DE where the parameter had changed by at least a factor of 1.5, 2 or 4. The arbitrary decision of what constitutes a significant change allows us to define the calls of the DE algorithms as either true positive, false positive, true negative or false negative. The results can be summarized as a ROC curve, and again we find that changes in <italic>β</italic> are more difficult to detect compared to the other two parameters (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). Importantly, we find that for larger parameter changes, D<sup>3</sup>E is always amongst the best performing methods (Fig. <xref rid="Fig3" ref-type="fig">3</xref>).
<fig id="Fig3"><label>Fig. 3</label><caption><p>Comparison of DE methods for synthetic data. Each panel shows the receiver operator characteristics (ROC) calculated for synthetic data using five different DE algorithms. The numbers below each panel indicate the area under the curve. The rows correspond to different thresholds for when a gene is considered significantly changed. DESeq2 reports NA for many genes. Since the NA cannot be interpreted as either DE or not DE, we treat these calls as false, which explains the unusual shape of the ROC curve and the fact that the AUC value is below.5</p></caption><graphic xlink:href="12859_2016_944_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Parameter estimation module</title>
      <p>The likelihood ratio test is a parametric test, and thus it requires estimates of the parameters <italic>α</italic>, <italic>β</italic> and <italic>γ</italic>. D<sup>3</sup>E has two approaches; the method of moments which is relatively fast and a more computationally costly Bayesian inference method (see <xref rid="Sec9" ref-type="sec">Implementation</xref>) [<xref ref-type="bibr" rid="CR17">17</xref>]. We evaluated the accuracy of the parameter estimates, both assuming perfect sampling as well as in the scenario when some transcripts are lost due to low starting levels of mRNA [<xref ref-type="bibr" rid="CR16">16</xref>]. In our simulations, we first generated parameters for the Poisson-Beta model by drawing from a distribution similar to the one for the data reported by Islam et al. [<xref ref-type="bibr" rid="CR15">15</xref>]. We then assumed that the dropout probability scaled with the mean expression level as <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$p_{dropout} = 1 - e^{-\mu ^{2}/b}$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">dropout</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>/</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2016_944_Article_IEq1.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR23">23</xref>], where the parameter <italic>b</italic> controls the rate of dropouts. In our simulations we used <italic>b</italic>=10,100 and 200. Our simulations show that the relative error for the estimates of the parameters <italic>α</italic>, <italic>β</italic> and <italic>γ</italic> are relatively robust to dropout events (Fig. <xref rid="Fig4" ref-type="fig">4</xref><xref rid="Fig4" ref-type="fig">a</xref>).
<fig id="Fig4"><label>Fig. 4</label><caption><p>Sensitivity to transcript dropout errors. <bold>a</bold> Errors for the estimates of the parameters for the synthetic data in Fig. <xref rid="Fig2" ref-type="fig">2</xref>
<xref rid="Fig2" ref-type="fig">a</xref> using the Bayesian inference method. Each bar represents the geometric mean squared relative error for the parameter estimates <bold>b</bold> Errors for the estimates of the correlations between the estimated changes in parameters for the synthetic data in Fig. <xref rid="Fig2" ref-type="fig">2</xref>
<xref rid="Fig2" ref-type="fig">a</xref>. Each bar represents the estimated Pearson correlation coefficient between the log-changes of the quantities</p></caption><graphic xlink:href="12859_2016_944_Fig4_HTML" id="MO4"/></fig></p>
      <p>An important advantage of using the transcriptional bursting model (Fig. <xref rid="Fig1" ref-type="fig">1</xref>) is that it is possible to derive other quantities - the average burst size, the burst frequency, the mean expression level, and the proportion of time in the active state (duty cycle) - which are easier to measure and interpret biologically than the parameters <italic>α</italic>, <italic>β</italic> and <italic>γ</italic>. Importantly, the transcriptional bursting model allows us to learn more about <italic>how</italic> the expression level has changed between the two conditions. In the transcriptional bursting model, there are three different ways to increase the mean expression level; by decreasing the degradation rate, by increasing the burst frequency, or by increasing the burst size. By comparing the correlations between the change in mean expression levels and the change in burst size or burst frequency, it is possible to gain additional biological insights relating to what aspect has led to the change in gene expression. In contrast to the estimates of the rate parameters the correlation estimates are sensitive to dropout events (Fig. <xref rid="Fig4" ref-type="fig">4</xref><xref rid="Fig4" ref-type="fig">b</xref>), and one must thus be careful when interpreting the results.</p>
    </sec>
    <sec id="Sec6">
      <title>Application to experimental data</title>
      <p>The tests on synthetic data suggest that D<sup>3</sup>E can reliably identify differentially expressed genes. A more useful test of the algorithm, however, involves experimental data which has been reliably validated. Unlike bulk data [<xref ref-type="bibr" rid="CR27">27</xref>], unfortunately there are no gold-standard datasets available. Nonetheless, to further evaluate D<sup>3</sup>E, we considered the single-cell RNA-seq data from two and four-cell mouse embryos where qPCR data from the same cell-types was collected for 90 genes [<xref ref-type="bibr" rid="CR6">6</xref>]. Unfortunately, the correlation of changes in gene expression between the qPCR and RNA-seq data (<italic>ρ</italic><sub><italic>Δ</italic></sub>=.46) (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S2) is even worse than the correlation of the individual samples (<italic>ρ</italic><sub>2</sub>=.6, <italic>ρ</italic><sub>4</sub>=.5). Thus, it does not come as a surprise that the overlap between the genes which are considered DE in the qPCR experiment has little overlap with genes which are considred DE from RNA-seq by any of the five algorithms that we compared (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S1). Even so, we find large differences in the number of genes identified as DE, ranging from 1 (edgeR) to 35 (DESeq2).</p>
      <p>To further evaluate D<sup>3</sup>E, we applied it to the two datasets collected by Islam et al. [<xref ref-type="bibr" rid="CR15">15</xref>] from 48 mouse embryonic stem cells and 44 mouse embryonic fibroblasts. To establish the <italic>p</italic>-value threshold, we first separated the stem cells into two groups, and compared the expression (see <xref rid="Sec9" ref-type="sec">Implementation</xref>). We used this approach for determining the threshold for D<sup>3</sup>E, SCDE, edgeR and limma, while for DESeq2, we used the adjusted <italic>p</italic>-value reported by the software. When comparing the two cell-types, D<sup>3</sup>E identified 4716 genes as DE, DESeq2 identified 6360 genes, limma-voom identified 7245 genes, edgeR identified 1140 genes, and SCDE identified 1092 genes (Fig. <xref rid="Fig5" ref-type="fig">5</xref><xref rid="Fig5" ref-type="fig">d</xref>). Surprisingly, the agreement between the five methods is quite low with only a core set of 380 genes identified by all three methods. If we require a gene to be identified of 4 out of 5 methods, then an additional 495 genes are idenitified as DE, suggesting that there is a set of around 900 genes which can confidently considered DE. To further evaluate the set of genes identified as DE by each method, we investigated the distiribution of fold-change values (Fig. <xref rid="Fig5" ref-type="fig">5</xref><xref rid="Fig5" ref-type="fig">a</xref>). The distributions gives an indication of how large fold changes are required for detection, and we note most of the genes have a higher expression in fibroblasts compared to stem cells. Compared to DESeq2, SCDE and edgeR, we also notice that D<sup>3</sup>E is able to identify genes with a lower fold change. Indeed, there were several examples of genes where the change in mean expression was modest, but they were still identified by D<sup>3</sup>E as differentially expressed (Fig. <xref rid="Fig5" ref-type="fig">5</xref><xref rid="Fig5" ref-type="fig">c</xref>).
<fig id="Fig5"><label>Fig. 5</label><caption><p>Analysis of experimental data. <bold>a</bold> Histogram showing the fold-changes for the genes which were considered significantly changed (<italic>blue</italic>) and not changed (<italic>gray</italic>) for D<sup>3</sup>E, DESeq2, limma, edgeR and SCDE. <bold>b</bold> Histograms showing the distribution of parameter values for all cells from [<xref ref-type="bibr" rid="CR15">15</xref>]. From top to bottom, the panels represent the frequency, the burst size, the inferred rates for the transcriptional bursting model, and the duty cycle. <bold>c</bold> Examples of two genes, Cdc42bpb in the top panel and Hist1h2bb in the bottom panel, which were identified as DE by D<sup>3</sup>E. In both cases, the change in mean expression is less than 70 % whereas the variance increases by &gt;10-fold. <bold>d</bold> Karnaugh table showing the number of genes identified as differentially expressed by D<sup>3</sup>E, SCDE, limma, edgeR, and DESeq2 for the two datasets collected by Islam et al. [<xref ref-type="bibr" rid="CR15">15</xref>]. <bold>e</bold> Scatterplots showing the mean in mESCs, and the fold-change, as well as the fold-change of the mean compared to the change in degradation rate, burst frequency and burst size. In all panels, black dots represent genes which did not change, red dots represent genes which were deemed significant by D<sup>3</sup>E</p></caption><graphic xlink:href="12859_2016_944_Fig5_HTML" id="MO5"/></fig></p>
      <p>Next, we took advantage of the transcriptional bursting model underlying D<sup>3</sup>E, and we fitted the parameters <italic>α</italic>, <italic>β</italic>, and <italic>γ</italic> for all genes. We found that for 85 % of the genes, at least one of the parameters changed by at least 2-fold, suggesting that there are substantial differences between the two cell-types. The results show that all three parameters follow log-normal distributions, spanning approximately one or two orders of magnitude in both cell-types (Fig. <xref rid="Fig5" ref-type="fig">5</xref><xref rid="Fig5" ref-type="fig">b</xref>, Additional files <xref rid="MOESM4" ref-type="media">4</xref> and <xref rid="MOESM5" ref-type="media">5</xref>). With the exception of the duty cycle which is constrained to be in the interval [0, 1], the derived quantities showed a similar distribution.</p>
      <p>We calculated the three derived quantities for each condition for the 2105 genes where we were able to obtain degradation rates for both cell-types [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>]. Next, we compared the changes in degradation rate, burst frequency and burst size to the change in mean expression level (Fig. <xref rid="Fig5" ref-type="fig">5</xref><xref rid="Fig5" ref-type="fig">e</xref>). The results clearly demonstrate that it is the change in burst size which underlies the change in mean expression levels (<italic>ρ</italic>=.91), suggesting that altering the burst size is the driving mechanism behind differences in mean expression between conditions. However, considering our simulation experiments (Fig. <xref rid="Fig4" ref-type="fig">4</xref><xref rid="Fig4" ref-type="fig">b</xref>), it is likely that the true correlation is lower.</p>
      <p>Another property of interest is the coefficient of variation (CV), defined as the standard deviation divided by the mean, which is used to quantify the gene expression noise. The CV is inversely correlated with the mean, and the transcriptional bursting model reveals that the change in CV is mainly correlated with the change in the duty cycle (<italic>ρ</italic>=.47), while the effect of a change in burst size is considerably smaller (<italic>ρ</italic>=.24, Additional file <xref rid="MOESM6" ref-type="media">6</xref>: Figure S3). To further demonstrate the use of the transcriptional bursting module, we also investigated changes in the auto-correlation times of each gene. The auto-correlation provides information about the time-scale of the noise, i.e. how quickly the gene expression level varies. The expected value of the autocorrelation, <italic>τ</italic><sub><italic>c</italic></sub>, is given by (<xref rid="Sec9" ref-type="sec">Implementation</xref>) 
<disp-formula id="Equ1"><label>(1)</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \tau_{c} = \frac{\sigma^{2}}{\frac{\mu}{\lambda}+\frac{1}{\alpha + \beta}}.  $$ \end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12859_2016_944_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Comparison of <italic>τ</italic><sub><italic>c</italic></sub> and the change in the mean for the Islam et al. data reveals that the two quantities are strongly correlated (<italic>ρ</italic>=.87, Additional file <xref rid="MOESM7" ref-type="media">7</xref>: Figure S4). However, when investigating all the quantities on the right hand side of Eq. (<xref rid="Equ1" ref-type="">1</xref>) the comparison shows that it is the change in variance which is most strongly correlated with the change in autocorrelation times (<italic>ρ</italic>=.90, Additional file <xref rid="MOESM7" ref-type="media">7</xref>: Figure S4).</p>
      <p>We also applied the methodology to cells from the early and late blastocyst from mouse embryos [<xref ref-type="bibr" rid="CR10">10</xref>]. Since we do not have access to degradation rates for these cell-types, not all of the correlations can be explored. Nevertheless, the correlations that can be calculated are largely similar to the ones observed for the Islam et al. data (Additional file <xref rid="MOESM8" ref-type="media">8</xref>: Figure S5–Additional file <xref rid="MOESM9" ref-type="media">9</xref>: Figure S6). Taken together, these results demonstrate that it is possible to generate testable hypotheses about how changes in the property of a gene has come about.</p>
    </sec>
    <sec id="Sec7">
      <title>Discussion</title>
      <p>DE analysis is one of the most common uses of bulk RNA-seq, and we expect that it will become an important application for single-cell RNA-seq as well. Here, we have presented D<sup>3</sup>E, a tool for analyszing DE for single-cell data. The main difference between D<sup>3</sup>E and other methods is that D<sup>3</sup>E compares the full distribution of each gene rather than just the first moment. Therefore, it becomes possible to identify genes where the higher moments have changed, with the mean remaining constant. To the best of our knowledge, D<sup>3</sup>E is the first method for DE analysis which considers properties other than the first and second moment of the distribution. Using synthetic data, we demonstrate that D<sup>3</sup>E can reliably detect when only the shape, but not the mean is changed.</p>
      <p>One of the main challenges in developing a DE analysis method for single-cell RNA-seq data is that, unlike for bulk data, there are no gold-standards available [<xref ref-type="bibr" rid="CR27">27</xref>]. Comparison of qPCR and RNA-seq data revealed only a modest correlation between the two methods, implying that the two methods are inconsistent. Thus, one must resort to synthetic data for evaluation. Fortunately, for single-cell gene expression, there is an analytically tractable transcriptional bursting model available which has been experimentally validated. Even with synthetic data, however, it is not obvious how one should define a change in expression. Consider the situation where one of the parameters changes by a small amount which is just sufficient to be detected given the limits of the technical noise, the read depth and the sample size. Then the question is whether or not the change is sufficient to be biologically meaningful. Another challenge stems from the difficulty of disentangling the technical and the biological noise. The transcriptional bursting model does not account for the technical noise in single-cell experiments which can be considerable [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR28">28</xref>]. Since each cell can only be sequenced once, one cannot carry out technical replicates in the same way that can be done for bulk experiments.</p>
      <p>Given the lack of ground truth and the difficulties involved in rigorously defining change in gene expression at the single-cell level, we recommend that more than one algorithm is used to identify DE genes. If the aim is to identify the genes which are most likely to have changed significantly, we believe that a consensus approach is the best one to use. Such a strategy will minimize the number of false positives with the drawback of increasing the number of false negatives.</p>
      <p>D<sup>3</sup>E implements two different non-parametric methods and one parametric method for comparing probability distributions. The methods emphasize different aspects of the distributions, and they are also associated with different computational costs. An important future research question is to determine what method is the most appropriate for single-cell DE analysis. Since the results are sensitive to technical noise, such developments should ideally be carried out taking the specific details of the protocol into consideration.</p>
      <p>We have shown that the transcriptional bursting model makes it possible to extract additional, biologically relevant results from the DE analysis. However, to be able to fully utilize the transcriptional bursting model, the mRNA degradation rates must be known, or assumed to be constant. Determining degradation rates directly remains experimentally challenging, and today they are only available for a handful of cell-types. However, alternative strategies have been proposed, whereby degradation rates are estimated from RNA-seq data using distribution of reads along the length of a gene [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR37">37</xref>]. The RNA-seq based methods make it possible to estimate degradation rates without further experiments, and they could thus significantly expand the range of samples where the transcriptional bursting model can be applied. Another restriction of our method is that the groups of cells must be known in advance. In many cases, e.g. when comparing samples from a mutant and wild-type or when comparing different stages of development [<xref ref-type="bibr" rid="CR6">6</xref>], it is straightforward to assign labels to cells. However, there are also situations, e.g. when analyzing a tissue-sample, when the cell-labels are unknown and in these scenarios D<sup>3</sup>E is no longer applicable.</p>
    </sec>
  </sec>
  <sec id="Sec8" sec-type="conclusion">
    <title>Conclusions</title>
    <p>Our work combines three important aspects of genomics - high-throughput sequencing technologies, computational data analysis, and systems biology modelling. In the present study, we have combined single cell RNA-seq, non-parametric comparison of distributions and an analytical model of stochastic gene expression which allows us to extract biologically meaningful quantities, providing insights not just about which genes have changed between two conditions, but also how the change has come about.</p>
  </sec>
  <sec id="Sec9">
    <title>Implementation</title>
    <sec id="Sec10">
      <title>Cramér-von Mises criterion</title>
      <p>To compare two empirical distributions of read counts from different cell samples, the Cramér-von Mises test was used. Let <italic>x</italic><sub>1</sub>,<italic>x</italic><sub>2</sub>,…<italic>x</italic><sub><italic>N</italic></sub> and <italic>y</italic><sub>1</sub>,<italic>y</italic><sub>2</sub>,…<italic>y</italic><sub><italic>M</italic></sub> be the observed read counts for the two samples. Given ranks <italic>q</italic><sub><italic>i</italic></sub> and <italic>s</italic><sub><italic>i</italic></sub> of the read-counts from the first and the second samples, in the ordered pooled sample, the Cramér-von Mises criterion is given by [<xref ref-type="bibr" rid="CR1">1</xref>]: 
<disp-formula id="Equ2"><label>(2)</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ T = \frac{U}{NM(N+M)} - \frac{4NM+1}{6(N+M)},  $$ \end{document}</tex-math><mml:math id="M8"><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">NM</mml:mtext><mml:mo>(</mml:mo><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>M</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:mtext mathvariant="italic">NM</mml:mtext><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>6</mml:mn><mml:mo>(</mml:mo><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>M</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12859_2016_944_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where 
<disp-formula id="Equ3"><label>(3)</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ U = N \sum\limits_{i=1}^{N} \left(q_{i}-i\right)^{2} + M \sum\limits_{j=1}^{M} \left(s_{i}-j\right)^{2}.  $$ \end{document}</tex-math><mml:math id="M10"><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>M</mml:mi><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12859_2016_944_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>The <italic>p</italic>-value associated with a null-hypothesis that two samples are drawn from the same distribution was calculated as [<xref ref-type="bibr" rid="CR2">2</xref>]: 
<disp-formula id="Equ4"><label>(4)</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} p(T) &amp; = &amp; 1 - \frac{1}{\pi \sqrt{T}} \sum\limits_{j=0}^{\infty} (-1)^{j} \left(\begin{array}{c}-0.5\\j\end{array}\right) (4j+1)^{0.5} \\ &amp; &amp; \exp{\frac{-(4j+1)^{2}}{16T}} K_{0.25}\frac{(4j+1)^{2}}{16T}, \end{array} $$ \end{document}</tex-math><mml:math id="M12"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>π</mml:mi><mml:msqrt><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>∞</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>−</mml:mo><mml:mn>0.5</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>j</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>4</mml:mn><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>0.5</mml:mn></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"/><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"><mml:mo>exp</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>4</mml:mn><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>16</mml:mn><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mn>0.25</mml:mn></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>4</mml:mn><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>16</mml:mn><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext/><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2016_944_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where 
<disp-formula id="Equ5"><label>(5)</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \left(\begin{array}{c}-0.5\\j\end{array}\right) = \frac{(-1)^{j} \Gamma(j+0.5)}{\Gamma(0.5)j!},  $$ \end{document}</tex-math><mml:math id="M14"><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>−</mml:mo><mml:mn>0.5</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>j</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:mi>Γ</mml:mi><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>0.5</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>Γ</mml:mi><mml:mo>(</mml:mo><mml:mn>0.5</mml:mn><mml:mo>)</mml:mo><mml:mi>j</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12859_2016_944_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
      <p><italic>Γ</italic>(<italic>z</italic>) is Euler’s Gamma function, and <italic>K</italic><sub><italic>ν</italic></sub>(<italic>z</italic>) is a modified Bessel function of the second kind.</p>
      <p>The infinite sum in (<xref rid="Equ4" ref-type="">4</xref>) converges fast after the first few terms. In practice, the <italic>p</italic>-value was calculated using first 100 terms of the sum for values of <italic>T</italic> less or equal to 12. For values of <italic>T</italic> greater than, 12 the <italic>p</italic>-value was set to zero.</p>
    </sec>
    <sec id="Sec11">
      <title>Parameter estimation</title>
      <p>A fast but inaccurate method for estimating parameters of a Poisson-Beta distribution is a moments matching technique. The parameters can be expressed through the sample exponential moments [<xref ref-type="bibr" rid="CR22">22</xref>]: 
<disp-formula id="Equ6"><label>(6)</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \alpha &amp;=&amp; \frac{2r_{1}(r_{3}-r_{2})} {r_{1}r_{2} - 2r_{1}r_{3}+r_{2}r_{3}} \end{array} $$ \end{document}</tex-math><mml:math id="M16"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mi>α</mml:mi></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2016_944_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>
        <disp-formula id="Equ7">
          <label>(7)</label>
          <alternatives>
            <tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \beta &amp;=&amp; \frac{2(r_{2}-r{1})(r_{1}-r_{3})(r_{3}-r_{2})}{(r_{1}r_{2}-2r_{1}r_{3}+r_{2}r_{3}) (r_{1}-2r_{2}+r_{3})} \end{array} $$ \end{document}</tex-math>
            <mml:math id="M18">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:mi>β</mml:mi>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                        <mml:mo>(</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:mi>r</mml:mi>
                        <mml:mn>1</mml:mn>
                        <mml:mo>)</mml:mo>
                        <mml:mo>(</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>3</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>)</mml:mo>
                        <mml:mo>(</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>3</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:mn>2</mml:mn>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>3</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>3</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>)</mml:mo>
                        <mml:mo>(</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:mn>2</mml:mn>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>3</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="12859_2016_944_Article_Equ7.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="Equ8">
          <label>(8)</label>
          <alternatives>
            <tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \gamma &amp;=&amp; \frac{-r_{1}r_{2} + 2r_{1}r_{3} - r_{2}r_{3}}{r_{1}-2r_{2}+r_{3}}, \end{array} $$ \end{document}</tex-math>
            <mml:math id="M20">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:mi>γ</mml:mi>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:mn>2</mml:mn>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>3</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>3</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:mn>2</mml:mn>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>3</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo>,</mml:mo>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="12859_2016_944_Article_Equ8.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>where <italic>r</italic><sub><italic>i</italic></sub> is a successive ratio of exponential moments <italic>e</italic><sub><italic>i</italic></sub>: 
<disp-formula id="Equ9"><label>(9)</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ r_{i} = \frac{e_{i}}{e_{i-1}}, e_{0} = 1,  $$ \end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12859_2016_944_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>for an i’th exponential moment: <italic>e</italic><sub><italic>i</italic></sub>=E[<italic>X</italic>(<italic>X</italic>−1)…(<italic>X</italic>−<italic>i</italic>+1)], where <italic>X</italic> is a sample of read counts.</p>
      <p>The parameters of a Poisson-Beta distribution can also be estimated by a Bayesian inference method [<xref ref-type="bibr" rid="CR17">17</xref>]. The Bayesian method is more accurate, but it requires more computational power. A Gamma distribution was used as a prior for the parameters <italic>α</italic>, <italic>β</italic> and <italic>γ</italic>: 
<disp-formula id="Equ10"><label>(10)</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \alpha &amp; \sim &amp; Gamma(k_{\alpha},\theta_{\alpha}) \end{array} $$ \end{document}</tex-math><mml:math id="M24"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mi>α</mml:mi></mml:mtd><mml:mtd class="align-2"><mml:mo>∼</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mtext mathvariant="italic">Gamma</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2016_944_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>
        <disp-formula id="Equ11">
          <label>(11)</label>
          <alternatives>
            <tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \beta &amp; \sim &amp; Gamma(k_{\beta},\theta_{\beta}) \end{array} $$ \end{document}</tex-math>
            <mml:math id="M26">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:mi>β</mml:mi>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>∼</mml:mo>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mtext mathvariant="italic">Gamma</mml:mtext>
                    <mml:mo>(</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>β</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>θ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>β</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>)</mml:mo>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="12859_2016_944_Article_Equ11.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="Equ12">
          <label>(12)</label>
          <alternatives>
            <tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \gamma &amp; \sim &amp; Gamma(k_{\gamma},\theta_{\gamma}), \end{array} $$ \end{document}</tex-math>
            <mml:math id="M28">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:mi>γ</mml:mi>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>∼</mml:mo>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mtext mathvariant="italic">Gamma</mml:mtext>
                    <mml:mo>(</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>γ</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>θ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>γ</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>)</mml:mo>
                    <mml:mo>,</mml:mo>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="12859_2016_944_Article_Equ12.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>where 
<disp-formula id="Equ13"><label>(13)</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} k_{\alpha} &amp; = &amp; k_{\beta} = k_{\gamma} = 1 \end{array} $$ \end{document}</tex-math><mml:math id="M30"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>γ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2016_944_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>
        <disp-formula id="Equ14">
          <label>(14)</label>
          <alternatives>
            <tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \theta_{\alpha} &amp; = &amp; \theta_{\beta} = 100 \end{array} $$ \end{document}</tex-math>
            <mml:math id="M32">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>θ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>α</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>θ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>β</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>=</mml:mo>
                    <mml:mn>100</mml:mn>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="12859_2016_944_Article_Equ14.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="Equ15">
          <label>(15)</label>
          <alternatives>
            <tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \theta_{\gamma} &amp; = &amp; max\{x : x \in X\}, \end{array} $$ \end{document}</tex-math>
            <mml:math id="M34">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>θ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>γ</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mtext mathvariant="italic">max</mml:mtext>
                    <mml:mo>{</mml:mo>
                    <mml:mi>x</mml:mi>
                    <mml:mo>:</mml:mo>
                    <mml:mi>x</mml:mi>
                    <mml:mo>∈</mml:mo>
                    <mml:mi>X</mml:mi>
                    <mml:mo>}</mml:mo>
                    <mml:mo>,</mml:mo>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="12859_2016_944_Article_Equ15.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>The number of read counts, <italic>x</italic>, was drawn from a Poisson-Beta distribution: 
<disp-formula id="Equ16"><label>(16)</label><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ x \sim Pois(x \; | \; \gamma c) \bigwedge_{c} Beta(c \;|\; \alpha, \beta)  $$ \end{document}</tex-math><mml:math id="M36"><mml:mi>x</mml:mi><mml:mo>∼</mml:mo><mml:mtext mathvariant="italic">Pois</mml:mtext><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mspace width="2.77626pt"/><mml:mo>|</mml:mo><mml:mspace width="2.77626pt"/><mml:mi>γc</mml:mi><mml:mo>)</mml:mo><mml:munder><mml:mrow><mml:mo>∧</mml:mo></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:munder><mml:mtext mathvariant="italic">Beta</mml:mtext><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mspace width="2.77626pt"/><mml:mo>|</mml:mo><mml:mspace width="2.77626pt"/><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>)</mml:mo></mml:math><graphic xlink:href="12859_2016_944_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Parameter estimation was performed by a collapsed Gibbs sampler, using Slice sampling [<xref ref-type="bibr" rid="CR19">19</xref>]. Conditional distributions for parameters during sampling were given by: 
<disp-formula id="Equ17"><label>(17)</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} P(c_{i}) &amp; \sim &amp; Beta(c_{i} | \alpha, \beta) Poisson(x_{i} | c_{i} \gamma) \end{array} $$ \end{document}</tex-math><mml:math id="M38"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd><mml:mtd class="align-2"><mml:mo>∼</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mtext mathvariant="italic">Beta</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>)</mml:mo><mml:mtext mathvariant="italic">Poisson</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>γ</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2016_944_Article_Equ17.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>
        <disp-formula id="Equ18">
          <label>(18)</label>
          <alternatives>
            <tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} P(\alpha) &amp; \sim &amp; Gamma(\alpha | k_{\alpha}, \theta_{\alpha})\prod\limits_{i=1}^{n} Beta(c_{i}|\alpha,\beta) \end{array} $$ \end{document}</tex-math>
            <mml:math id="M40">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:mi>P</mml:mi>
                    <mml:mo>(</mml:mo>
                    <mml:mi>α</mml:mi>
                    <mml:mo>)</mml:mo>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>∼</mml:mo>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mtext mathvariant="italic">Gamma</mml:mtext>
                    <mml:mo>(</mml:mo>
                    <mml:mi>α</mml:mi>
                    <mml:mo>|</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>α</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>θ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>α</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>)</mml:mo>
                    <mml:munderover accent="false" accentunder="false">
                      <mml:mrow>
                        <mml:mo mathsize="big">∏</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                    </mml:munderover>
                    <mml:mtext mathvariant="italic">Beta</mml:mtext>
                    <mml:mo>(</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>c</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>|</mml:mo>
                    <mml:mi>α</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>β</mml:mi>
                    <mml:mo>)</mml:mo>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="12859_2016_944_Article_Equ18.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="Equ19">
          <label>(19)</label>
          <alternatives>
            <tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} P(\beta) &amp; \sim &amp; Gamma(\beta | k_{\beta}, \theta_{\beta})\prod\limits_{i=1}^{n} Beta(c_{i}|\alpha,\beta) \end{array} $$ \end{document}</tex-math>
            <mml:math id="M42">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:mi>P</mml:mi>
                    <mml:mo>(</mml:mo>
                    <mml:mi>β</mml:mi>
                    <mml:mo>)</mml:mo>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>∼</mml:mo>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mtext mathvariant="italic">Gamma</mml:mtext>
                    <mml:mo>(</mml:mo>
                    <mml:mi>β</mml:mi>
                    <mml:mo>|</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>β</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>θ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>β</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>)</mml:mo>
                    <mml:munderover accent="false" accentunder="false">
                      <mml:mrow>
                        <mml:mo mathsize="big">∏</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                    </mml:munderover>
                    <mml:mtext mathvariant="italic">Beta</mml:mtext>
                    <mml:mo>(</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>c</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>|</mml:mo>
                    <mml:mi>α</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>β</mml:mi>
                    <mml:mo>)</mml:mo>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="12859_2016_944_Article_Equ19.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="Equ20">
          <label>(20)</label>
          <alternatives>
            <tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} P(\gamma) &amp; \sim &amp; Gamma(\gamma | k_{\gamma}, \theta_{\gamma})\prod\limits_{i=1}^{n}Pois(x_{i} | c_{i} \gamma) \end{array} $$ \end{document}</tex-math>
            <mml:math id="M44">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:mi>P</mml:mi>
                    <mml:mo>(</mml:mo>
                    <mml:mi>γ</mml:mi>
                    <mml:mo>)</mml:mo>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>∼</mml:mo>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mtext mathvariant="italic">Gamma</mml:mtext>
                    <mml:mo>(</mml:mo>
                    <mml:mi>γ</mml:mi>
                    <mml:mo>|</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>γ</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>θ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>γ</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>)</mml:mo>
                    <mml:munderover accent="false" accentunder="false">
                      <mml:mrow>
                        <mml:mo mathsize="big">∏</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                    </mml:munderover>
                    <mml:mtext mathvariant="italic">Pois</mml:mtext>
                    <mml:mo>(</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>x</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>|</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>c</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mi>γ</mml:mi>
                    <mml:mo>)</mml:mo>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="12859_2016_944_Article_Equ20.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
    </sec>
    <sec id="Sec12">
      <title>Likelihood ratio test</title>
      <p>The likelihood ratio test provides a parametric test for differential expression. One of the two conditions is designated as the control and the other is designated as the test conditions. For each gene, the log-likelihood of the data from the test condition is calculated using the parameters estimated for both the control and the test. We then test the null hypothesis that the ratio of the likelihoods calculated using the two parameters is not significantly different from 1.</p>
      <p>Calculating the likelihood using the Poisson-Beta distribution numerically is very challenging due to the presence of the confluent hypergeometric function [<xref ref-type="bibr" rid="CR17">17</xref>]. The methods available in Python become unreliable for large values of the third argument. To be able to evaluate the Poisson-Beta distribution we employ a Monte Carlo method whereby the PDF is estimated using <italic>N</italic> randomly generated samples. <italic>N</italic> can be set by the user as a flag and the default value is 1,000.</p>
    </sec>
    <sec id="Sec13">
      <title>Synthetic data</title>
      <p>Synthetic data was produced by sampling from a Poisson-Beta distribution, i.e. first drawing an auxiliary variable <italic>c</italic> from Beta distribution with parameters <italic>α</italic> and <italic>β</italic>: <italic>c</italic>∼<italic>B</italic><italic>e</italic><italic>t</italic><italic>a</italic>(<italic>α</italic>,<italic>β</italic>) and then drawing from a Poisson distribution with parameter <italic>λ</italic>=<italic>c</italic><italic>γ</italic>: <italic>x</italic>∼<italic>P</italic><italic>o</italic><italic>i</italic><italic>s</italic><italic>s</italic><italic>o</italic><italic>n</italic>(<italic>c</italic><italic>γ</italic>).</p>
    </sec>
    <sec id="Sec14">
      <title>Analyis of the sensitivity</title>
      <p>To evaluate how well D<sup>3</sup>E is capable of detecting changes in different regimes of the parameter space, we systematically varied the three parameters of the Poisson-Beta model across the range of values representative of the biological data, <italic>α</italic>∈[.01,.1],<italic>β</italic>∈[.1,1], and <italic>γ</italic>∈[1,100]. We fixed a pair of parameters and varied the third in 10 steps over its range, recording the <italic>p</italic>-value for one of the tests. For each of the 100 different combinations, it was assumed that the sample consisted of 50 cells from each condition was generated. Close to the diagonal, the changes in the parameters are small, and we expect a high <italic>p</italic>-value in these positions. To summarize the matrix of <italic>p</italic>-values, we calculate a composite score as 
<disp-formula id="Equ21"><label>(21)</label><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ {\begin{aligned} S = 1 - \frac{1}{100}\Big\vert\sum_{i=1}^{10}I(p_{ii}&gt;.05) - 10 \Big\vert + \frac{1}{100}\sum_{i=1}^{10}\sum_{j=1, j\neq i}^{10}I(p_{ij}&gt;.05), \end{aligned}}  $$ \end{document}</tex-math><mml:math id="M46"><mml:mspace width="-15.0pt"/><mml:mtable><mml:mtr><mml:mtd><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>100</mml:mn></mml:mrow></mml:mfrac><mml:mstyle mathsize="1.61em"><mml:mfenced close="" open="|" separators=""><mml:mrow/></mml:mfenced></mml:mstyle><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:munderover><mml:mi>I</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ii</mml:mtext></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mi>.</mml:mi><mml:mn>05</mml:mn><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mn>10</mml:mn><mml:mstyle mathsize="1.61em"><mml:mfenced close="" open="|" separators=""><mml:mrow/></mml:mfenced></mml:mstyle><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>100</mml:mn></mml:mrow></mml:mfrac><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:munderover><mml:mi>I</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mi>.</mml:mi><mml:mn>05</mml:mn><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2016_944_Article_Equ21.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>I</italic> is the indicator function. The score <italic>S</italic> ranges between 0 and 1, and 1 is obtained when all of the <italic>p</italic>-values on the diagonal are greater than.05 while the off-diagonal elements are smaller than.05. The score is mapped to a color and reported in Fig. <xref rid="Fig2" ref-type="fig">2</xref>.</p>
    </sec>
    <sec id="Sec15">
      <title>Dropout analysis</title>
      <p>To evaluate the effect of experimental noise, we considered the possibility of transcript dropout events. Dropouts are likely to occur either as a consequence of failure to isolate the transcript when lyzing the cell, failure of the RT reaction, or failure of the amplification. The probability of failure is poorly understood, but it has been suggested that the dropout probability can be modeled as <inline-formula id="IEq2"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$p_{dropout} = 1 - e^{-\mu ^{2}/b}$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">dropout</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>/</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2016_944_Article_IEq2.gif"/></alternatives></inline-formula>, where <italic>μ</italic> is the mean expression and <italic>b</italic> is a parameter [<xref ref-type="bibr" rid="CR23">23</xref>].</p>
      <p>For our dropout experiments, we randomly generated 1,000 parameter triplets based on the fitted data from Islam et al. [<xref ref-type="bibr" rid="CR15">15</xref>]. For each triplet, we changed one parameter at a time and the change was allowed to be up to 4-fold. Next, we generated realizations from both distributions for 50 cells in each condition. We used the parameter estimation module to evaluate the accuracy of the estimates for perfect samples as well as for three different values of the dropout parameter <italic>b</italic>=10,100,200.</p>
    </sec>
    <sec id="Sec16">
      <title>Normalization</title>
      <p>The normalization of the raw read counts was performed by the same method used by DESeq2 [<xref ref-type="bibr" rid="CR18">18</xref>]. Let <italic>x</italic><sub><italic>ij</italic></sub> represent the raw number of reads for <italic>i</italic>=1,2..<italic>N</italic> and <italic>j</italic>=1,2..<italic>M</italic>, where <italic>N</italic> is the number of genes, and <italic>M</italic> is the total number of cells in the experiment. Then, the size factor <italic>s</italic><sub><italic>j</italic></sub> is found as 
<disp-formula id="Equ22"><label>(22)</label><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ s_{j} = \text{median}_{i} \frac{x_{ij}} {\left(\prod\limits_{k=1}^{M} x_{ik}\right)^{1/M}}.  $$ \end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mtext>median</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12859_2016_944_Article_Equ22.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>The corrected read counts are then calculated as <inline-formula id="IEq3"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$x_{ij}^{*} = \frac {x_{ij}}{s{j}}$\end{document}</tex-math><mml:math id="M52"><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">sj</mml:mtext></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2016_944_Article_IEq3.gif"/></alternatives></inline-formula>. The size factors are calculated based on spike-ins data only if it is available.</p>
    </sec>
    <sec id="Sec17">
      <title>Determining <italic>p</italic>-value threshold</title>
      <p>To determine the <italic>p</italic>-value threshold for D<sup>3</sup>E, we first take the sample which will be used as the control group (i.e. in the denominator when calculating the fold-change), and split it into two non-overlapping subsets. Next, one of the tests is applied to the split sample, and the lowest <italic>p</italic>-value observed, <italic>p</italic><sup>∗</sup>, is recorded. When comparing the case and the control sets, 0.1∗<italic>p</italic><sup>∗</sup> is used as a threshold, and only genes with a <italic>p</italic>-value lower than 0.1∗<italic>p</italic><sup>∗</sup> are considered significant.</p>
      <p>SCDE reports a <italic>z</italic>-score which we transform to a <italic>p</italic>-value using the formula <italic>p</italic>=2<italic>Φ</italic>(−|<italic>z</italic>|), where <italic>Φ</italic>(<italic>x</italic>) is the cumulative density of the standard normal distribution. When choosing the threshold for SCDE, we used the same strategy as for D<sup>3</sup>E.</p>
      <p>For DESeq2 we used the adjusted <italic>p</italic>-value reported by the algorithm, and we required it to be &lt;.1 to be significant.</p>
    </sec>
    <sec id="Sec18">
      <title>Calculating auto-correlation times</title>
      <p>The power spectral density, <italic>S</italic>(<italic>ω</italic>), of the mRNAs for the transcriptional bursting model is given by [<xref ref-type="bibr" rid="CR9">9</xref>] 
<disp-formula id="Equ23"><label>(23)</label><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \begin{aligned} S(\omega) =&amp; \frac{2}{\lambda^{2} + \omega^{2}}\left(d\gamma + \frac{d\alpha\gamma^{2}}{(\alpha + \beta)^{2} - \lambda^{2}}\right)\\ &amp;- \frac{2}{(\alpha + \beta)^{2}+\omega^{2}}\frac{d\alpha\gamma^{2}}{(\alpha + \beta)^{2} - \lambda^{2}} \end{aligned}  $$ \end{document}</tex-math><mml:math id="M54"><mml:mtable><mml:mtr><mml:mtd><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:mi>ω</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mfrac><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>dγ</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>dα</mml:mi><mml:msup><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>dα</mml:mi><mml:msup><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2016_944_Article_Equ23.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>d</italic>=<italic>α</italic>/(<italic>α</italic>+<italic>β</italic>). By definition, the auto-correlation, <italic>R</italic>(<italic>t</italic>), is given by the inverse Fourier transform of <italic>S</italic>(<italic>ω</italic>), 
<disp-formula id="Equ24"><label>(24)</label><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \begin{aligned} R(t) =&amp; e^{-\lambda \vert t\vert}\left(\frac{d\gamma}{\lambda} + \frac{(\alpha+\beta)(d\gamma)^{2}}{\lambda(\alpha+\beta)^{2} - \lambda^{2})}\right)\\ &amp;- e^{-(\alpha+\beta) \vert t\vert}\frac{(d\gamma)^{2}}{(\alpha+\beta)^{2} - \lambda^{2}}. \end{aligned}  $$ \end{document}</tex-math><mml:math id="M56"><mml:mtable><mml:mtr><mml:mtd><mml:mi>R</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mo>|</mml:mo><mml:mi>t</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mi>dγ</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo>)</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>dγ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>λ</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo>)</mml:mo><mml:mo>|</mml:mo><mml:mi>t</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msup><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>dγ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2016_944_Article_Equ24.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>The characteristic time of the auto-correlation is defined as <italic>τ</italic><sub><italic>c</italic></sub>=<italic>S</italic>(0)/2<italic>R</italic>(0).</p>
    </sec>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec19">
        <title>Additional files</title>
        <p>
          <media position="anchor" xlink:href="12859_2016_944_MOESM1_ESM.jpeg" id="MOESM1">
            <label>Additional file 1</label>
            <caption>
              <p><bold>Figure S1.</bold> Sensitivity to changes in parameters of the Poisson-Beta distribution for the Cramér-von Mises, KS and likelihood ratio tests similar to Fig. <xref rid="Fig4" ref-type="fig">4</xref>. The range over which the parameters are varied is larger here. The increased presence of lighter colors shows that for the most part it is easier to identify DE genes for this set of parameters. (JPEG 246 kb)</p>
            </caption>
          </media>
        </p>
        <p>
          <media position="anchor" xlink:href="12859_2016_944_MOESM2_ESM.jpeg" id="MOESM2">
            <label>Additional file 2</label>
            <caption>
              <p><bold>Figure S2.</bold> Change in expression levels for 90 genes from the 2-cell and 4-cell mouse embryos as quantified using either qPCR or RNA-seq [<xref ref-type="bibr" rid="CR6">6</xref>]. (JPEG 113 kb)</p>
            </caption>
          </media>
        </p>
        <p>
          <media position="anchor" xlink:href="12859_2016_944_MOESM3_ESM.tsv" id="MOESM3">
            <label>Additional file 3</label>
            <caption>
              <p><bold>Table S1.</bold> Expression levels for the 90 genes from the 2-cell and 4-cell mouse embryos as quantified using either qPCR or RNA-seq [<xref ref-type="bibr" rid="CR6">6</xref>]. The last six columns indicate the genes that were identified as differentially expressed by different DE algorithms as well as a t-test for the qPCR data. (TSV 11.7 kb)</p>
            </caption>
          </media>
        </p>
        <p>
          <media position="anchor" xlink:href="12859_2016_944_MOESM4_ESM.tsv" id="MOESM4">
            <label>Additional file 4</label>
            <caption>
              <p><bold>Parameters for the Islam et al. data without degradation rates.</bold> Parameters for the 12,135 genes that were expressed in both cell types. (TSV 2631 kb)</p>
            </caption>
          </media>
        </p>
        <p>
          <media position="anchor" xlink:href="12859_2016_944_MOESM5_ESM.tsv" id="MOESM5">
            <label>Additional file 5</label>
            <caption>
              <p><bold>Parameters for the Islam et al. data with degradation rates.</bold> Parameters for the 2,105 genes that were expressed in both cell types, and where degradation rates were available. (TSV 369 kb)</p>
            </caption>
          </media>
        </p>
        <p>
          <media position="anchor" xlink:href="12859_2016_944_MOESM6_ESM.jpeg" id="MOESM6">
            <label>Additional file 6</label>
            <caption>
              <p><bold>Figure S3.</bold> Scatterplots showing the mean fold-change, as well as the fold-change of the CV compared to the change in degradation rate, burst frequency, duty cycle, burst size. In all panels, black dots represent genes which did not change, red dots represent genes which were deemed significant by D<sup>3</sup>E. (JPEG 355 kb)</p>
            </caption>
          </media>
        </p>
        <p>
          <media position="anchor" xlink:href="12859_2016_944_MOESM7_ESM.jpeg" id="MOESM7">
            <label>Additional file 7</label>
            <caption>
              <p><bold>Figure S4.</bold> Scatterplots showing the mean fold-change and the fold-change of the characteristic time, as well as the fold-change of the characteristic time compared to the change in degradation rate, variance and characteristic promoter time. In all panels, black dots represent genes which did not change, red dots represent genes which were deemed significant by D<sup>3</sup>E. (JPEG 301 kb)</p>
            </caption>
          </media>
        </p>
        <p>
          <media position="anchor" xlink:href="12859_2016_944_MOESM8_ESM.jpeg" id="MOESM8">
            <label>Additional file 8</label>
            <caption>
              <p><bold>Figure S5.</bold> Scatterplots showing the mean fold-change, as well as the fold-change of the mean compared to the change in burst frequency, duty cycle, burst size for early vs late blastocysts from Deng et al. [<xref ref-type="bibr" rid="CR10">10</xref>]. In all panels, black dots represent genes which did not change, red dots represent genes which were deemed significant by D<sup>3</sup>E. (JPEG 189 kb)</p>
            </caption>
          </media>
        </p>
        <p>
          <media position="anchor" xlink:href="12859_2016_944_MOESM9_ESM.jpeg" id="MOESM9">
            <label>Additional file 9</label>
            <caption>
              <p><bold>Figure S6.</bold> Scatterplots showing the mean fold-change, as well as the fold-change of the CV compared to the change in burst frequency, duty cycle, burst size for early vs late blastocysts from Deng et al. [<xref ref-type="bibr" rid="CR10">10</xref>]. In all panels, black dots represent genes which did not change, red dots represent genes which were deemed significant by D<sup>3</sup>E. (JPEG 345 kb)</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <fn-group>
    <fn>
      <p>
        <bold>Competing interests</bold>
      </p>
      <p>The authors declare that they have no competing interests.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors’ contributions</bold>
      </p>
      <p>MH conceived the study and supervised the research, MD and MH carried out the research, MD wrote the code, and MD and MH jointly wrote the manuscript. Both authors read and approved the final manuscript.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors would like to thank Tallulah Andrews, Daniel Gaffney, Vladimir Kiselev, Michael Kosicki, John Marioni, and Gosia Trynka for helpful discussions and comments on the manuscript. MD was funded by the University of Cambridge BBSRC DTP, and MH was funded by the Wellcome Trust.</p>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anderson</surname>
            <given-names>TW</given-names>
          </name>
        </person-group>
        <article-title>On the Distribution of the Two-Sample Cramér-von Mises Criterion</article-title>
        <source>Ann Math Stat</source>
        <year>1962</year>
        <volume>33</volume>
        <fpage>1148</fpage>
        <lpage>1159</lpage>
        <pub-id pub-id-type="doi">10.1214/aoms/1177704477</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anderson</surname>
            <given-names>TW</given-names>
          </name>
          <name>
            <surname>Darling</surname>
            <given-names>DA</given-names>
          </name>
        </person-group>
        <article-title>Asymptotic Theory of Certain Goodness of Fit Criteria Based on Stochastic Processes</article-title>
        <source>Ann Math Stat</source>
        <year>1952</year>
        <volume>23</volume>
        <fpage>193</fpage>
        <lpage>212</lpage>
        <pub-id pub-id-type="doi">10.1214/aoms/1177729437</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bengtsson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rorsman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ståhlberg</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Quantification of mRNA in single cells and modelling of RT-qPCR induced noise</article-title>
        <source>BMC Mol Bio</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>63</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2199-9-63</pub-id>
        <pub-id pub-id-type="pmid">18631407</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: A practical and powerful approach to multiple testing</article-title>
        <source>J R Stat Soc B</source>
        <year>1995</year>
        <volume>57</volume>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berg</surname>
            <given-names>OG</given-names>
          </name>
        </person-group>
        <article-title>A model for the statistical fluctuations of protein numbers in a microbial population</article-title>
        <source>J Theor Biol</source>
        <year>1978</year>
        <volume>71</volume>
        <fpage>587</fpage>
        <lpage>603</lpage>
        <pub-id pub-id-type="doi">10.1016/0022-5193(78)90326-0</pub-id>
        <?supplied-pmid 96307?>
        <pub-id pub-id-type="pmid">96307</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Biase</surname>
            <given-names>FH</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhong</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Cell fate indclination within 2-cell and 4-cell mouse embryos revealed by single-cell RNA sequencing</article-title>
        <source>Genome Res</source>
        <year>2014</year>
        <volume>24</volume>
        <fpage>1787</fpage>
        <lpage>96</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.177725.114</pub-id>
        <?supplied-pmid 25096407?>
        <pub-id pub-id-type="pmid">25096407</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brennecke</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Kolodziejczyk</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Proserpio</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Baying</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Benes</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Heisler</surname>
            <given-names>MG</given-names>
          </name>
        </person-group>
        <article-title>Accounting for technical noise in single-cell RNA-seq experiments</article-title>
        <source>Nat Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>1093</fpage>
        <lpage>95</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2645</pub-id>
        <?supplied-pmid 24056876?>
        <pub-id pub-id-type="pmid">24056876</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chubb</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Trcek</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Shenoy</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Singer</surname>
            <given-names>RH</given-names>
          </name>
        </person-group>
        <article-title>Transcriptional Pulsing of a Developmental Gene</article-title>
        <source>Current Biol</source>
        <year>2006</year>
        <volume>16</volume>
        <fpage>1018</fpage>
        <lpage>25</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cub.2006.03.092</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coulon</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gandrillon</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Beslon</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>On the spontaneous stochastic dynamics of a single gene: complexity of the molecular interplay at the promoter</article-title>
        <source>BMC Sys Bio</source>
        <year>2010</year>
        <volume>4</volume>
        <fpage>2</fpage>
        <pub-id pub-id-type="doi">10.1186/1752-0509-4-2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qiaolin</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ramsköld</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Reinius</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Sandberg</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA-seq reveals dynamic, random monoallelic gene expression in mammalian cells</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>343</volume>
        <fpage>193</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1245316</pub-id>
        <pub-id pub-id-type="pmid">24408435</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <mixed-citation publication-type="other">Gibbons JD, Chakraborti S. Nonparametric Statistical Inference, 2010: Chapman and Hall; 2010.</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gillespie</surname>
            <given-names>DT</given-names>
          </name>
        </person-group>
        <article-title>A general method for numerically simulating the stochastic time evolution of coupled chemical reactions</article-title>
        <source>J Comput Phys</source>
        <year>1976</year>
        <volume>22</volume>
        <issue>4</issue>
        <fpage>403</fpage>
        <lpage>34</lpage>
        <pub-id pub-id-type="doi">10.1016/0021-9991(76)90041-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grün</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kester</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>van Oudenaarden</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Validation of noise models for single-cell transcriptomics</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <fpage>637</fpage>
        <lpage>40</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2930</pub-id>
        <?supplied-pmid 24747814?>
        <pub-id pub-id-type="pmid">24747814</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <mixed-citation publication-type="other">Gray JM, Harmin DA, Boswell SA, Cloonan N, Mullen TE, Ling JJ, Miller N, Kuersten S, Ma Y-C, McCarroll SA, Grimmond SM, Springer M. SnapShot-Seq: A Method for Extracting Genome-Wide, In Vivo mRNA Dynamics from a Single Total RNA Sample. PLoS ONE. 2014. doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0089673">http://dx.doi.org/10.1371/journal.pone.0089673</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Islam</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kjällquist</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Moliner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zajac</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>J-B</given-names>
          </name>
          <name>
            <surname>Lönnerberg</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Linnarsson</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Characterization of the single-cell transcriptional landscape by highly multiplex RNA-seq</article-title>
        <source>Genome Res</source>
        <year>2011</year>
        <volume>11</volume>
        <fpage>1160</fpage>
        <lpage>1167</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.110882.110</pub-id>
        <pub-id pub-id-type="pmid">21543516</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kharchenko</surname>
            <given-names>PV</given-names>
          </name>
          <name>
            <surname>Silberstein</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Scadden</surname>
            <given-names>DT</given-names>
          </name>
        </person-group>
        <article-title>Bayesian approach to single-cell differential expression analysis</article-title>
        <source>Nature Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <fpage>740</fpage>
        <lpage>742</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2967</pub-id>
        <?supplied-pmid 24836921?>
        <pub-id pub-id-type="pmid">24836921</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Inferring the kinetics of stochastic gene expression from single-cell RNA-sequencing data</article-title>
        <source>Genome Biology</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>R7</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2013-14-1-r7</pub-id>
        <?supplied-pmid 23360624?>
        <pub-id pub-id-type="pmid">23360624</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>550</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id>
        <?supplied-pmid 25516281?>
        <pub-id pub-id-type="pmid">25516281</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <mixed-citation publication-type="other">Neal RM. Slice sampling. Ann Stat. 2003:705–767.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Novick</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Weiner</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Enzyme induction as an all-or-none phenomenon</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>1957</year>
        <volume>43</volume>
        <fpage>553</fpage>
        <lpage>566</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.43.7.553</pub-id>
        <?supplied-pmid 16590055?>
        <pub-id pub-id-type="pmid">16590055</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ozsolak</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Milos</surname>
            <given-names>PM</given-names>
          </name>
        </person-group>
        <article-title>RNA sequencing: advances, challenges and opportunities</article-title>
        <source>Nature Rev Genet</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>87</fpage>
        <lpage>98</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2934</pub-id>
        <?supplied-pmid 21191423?>
        <pub-id pub-id-type="pmid">21191423</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peccoud</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ycart</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Markovian modelling of gene product synthesis</article-title>
        <source>Theor Popul Biol</source>
        <year>1995</year>
        <volume>48</volume>
        <fpage>222</fpage>
        <lpage>234</lpage>
        <pub-id pub-id-type="doi">10.1006/tpbi.1995.1027</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <mixed-citation publication-type="other">Pierson E, Yau C. ZIFA. Dimensionality reduction for zero-inflated single cell gene expression analysis. Genome Biol. 2015; 16:241. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/019141">http://dx.doi.org/10.1101/019141</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <mixed-citation publication-type="other">Raj A, Peskin CS, Tranchina D, Vargas DY, Tyagi S. Stochastic mRNA Synthesis in Mammalian Cells. PLoS Biol. 2006. 0.1371/journal.pbio.0040309.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Raj</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>van Oudenaarden</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Stochastic gene expression and its consequences</article-title>
        <source>Cell</source>
        <year>2008</year>
        <volume>135</volume>
        <fpage>216</fpage>
        <lpage>226</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2008.09.050</pub-id>
        <?supplied-pmid 18957198?>
        <pub-id pub-id-type="pmid">18957198</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Raj</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rifkin</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Andersen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>van Oudenaarden</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Variability in gene expression underlies incomplete penetrance</article-title>
        <source>Nature</source>
        <year>2010</year>
        <volume>463</volume>
        <fpage>913</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1038/nature08781</pub-id>
        <?supplied-pmid 20164922?>
        <pub-id pub-id-type="pmid">20164922</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rapaport</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Khanin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Pirun</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Krek</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zumbo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mason</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Socci</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Betel</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive evaluation of differential gene expression analysis methods for RNA-seq data</article-title>
        <source>Genome Biol</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>R95</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2013-14-9-r95</pub-id>
        <?supplied-pmid 24020486?>
        <pub-id pub-id-type="pmid">24020486</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Risso</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ngai</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Normalization of RNA-seq data using factor analysis of control genes or samples</article-title>
        <source>Nat. Biotechnology</source>
        <year>2014</year>
        <volume>32</volume>
        <fpage>896</fpage>
        <lpage>902</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2931</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ritchie</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Phipson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Law</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Smyth G. limma powers differential expression analyses for RNA-sequencing and microarray studies</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <issue>7</issue>
        <fpage>e47</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv007</pub-id>
        <?supplied-pmid 25605792?>
        <pub-id pub-id-type="pmid">25605792</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <mixed-citation publication-type="other">Robinson MD, McCarthy DJ, Smyth GK. edgeR: a Bioconductor package for differential expression analysis of digital gene expression data. Bioinformatics; 26:139–140.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwanhäusser</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Busse</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Dittmar</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Schuchhardt</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wolf</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Selbach</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Global quantification of mammalian gene expression control</article-title>
        <source>Nature</source>
        <year>2011</year>
        <volume>473</volume>
        <fpage>337</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1038/nature10098</pub-id>
        <?supplied-pmid 21593866?>
        <pub-id pub-id-type="pmid">21593866</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sharova</surname>
            <given-names>LV</given-names>
          </name>
          <name>
            <surname>Sharov</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Nedorezov</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Piao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shaik</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ko</surname>
            <given-names>MSH</given-names>
          </name>
        </person-group>
        <article-title>Database for mRNA Half-Life of 19 977 Genes Obtained by DNA Microarray Analysis of Pluripotent and Differentiating Mouse Embryonic Stem Cells</article-title>
        <source>DNA Res</source>
        <year>2009</year>
        <volume>16</volume>
        <fpage>45</fpage>
        <lpage>58</lpage>
        <pub-id pub-id-type="doi">10.1093/dnares/dsn030</pub-id>
        <?supplied-pmid 19001483?>
        <pub-id pub-id-type="pmid">19001483</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stevense</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Muramoto</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Chubb</surname>
            <given-names>JR</given-names>
          </name>
        </person-group>
        <article-title>Digital nature of the immediate-early transcriptional response</article-title>
        <source>Development</source>
        <year>2010</year>
        <volume>137</volume>
        <fpage>579</fpage>
        <lpage>584</lpage>
        <pub-id pub-id-type="doi">10.1242/dev.043836</pub-id>
        <?supplied-pmid 20110323?>
        <pub-id pub-id-type="pmid">20110323</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Barbacioru</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Nordman</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Bodeau</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tuch</surname>
            <given-names>BB</given-names>
          </name>
          <name>
            <surname>Siddiqui</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lao</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Surani</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>mRNA-Seq whole-transcriptome analysis of a single cell</article-title>
        <source>Nat Methods</source>
        <year>2009</year>
        <volume>6</volume>
        <fpage>377</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1315</pub-id>
        <?supplied-pmid 19349980?>
        <pub-id pub-id-type="pmid">19349980</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hendrickson</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Sauvageau</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Goff</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Rinn</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Differential analysis of gene regulation at transcript resolution with RNA-seq</article-title>
        <source>Nature Biotechnology</source>
        <year>2013</year>
        <volume>31</volume>
        <fpage>46</fpage>
        <lpage>53</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2450</pub-id>
        <?supplied-pmid 23222703?>
        <pub-id pub-id-type="pmid">23222703</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trevino</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Falciani</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Barrera-Saldaña</surname>
            <given-names>HA</given-names>
          </name>
        </person-group>
        <article-title>DNA Microarrays: a Powerful Genomic Tool for Biomedical and Clinical Research</article-title>
        <source>Mol. Med</source>
        <year>2007</year>
        <volume>13</volume>
        <fpage>527</fpage>
        <lpage>541</lpage>
        <pub-id pub-id-type="doi">10.2119/2006-00107.Trevino</pub-id>
        <?supplied-pmid 17660860?>
        <pub-id pub-id-type="pmid">17660860</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wan</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Modeling RNA degradation for RNA-Seq with applications</article-title>
        <source>Biostatistics</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>734</fpage>
        <lpage>747</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxs001</pub-id>
        <?supplied-pmid 22353193?>
        <pub-id pub-id-type="pmid">22353193</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weinberger</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>Burnett</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Toettcher</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Arkin</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Schaffer</surname>
            <given-names>DV</given-names>
          </name>
        </person-group>
        <article-title>Stochastic Gene Expression in a Lentiviral Positive-Feedback Loop: HIV-1 Tat Fluctuations Drive Phenotypic Diversity</article-title>
        <source>Cell</source>
        <year>2005</year>
        <volume>122</volume>
        <issue>2</issue>
        <fpage>169</fpage>
        <lpage>182</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2005.06.006</pub-id>
        <?supplied-pmid 16051143?>
        <pub-id pub-id-type="pmid">16051143</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wills</surname>
            <given-names>QF</given-names>
          </name>
          <name>
            <surname>Livak</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Tipping</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Enver</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Goldson</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Sexton</surname>
            <given-names>DW</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Single-cell gene expression analysis reveals genetic associations masked in whole-tissue experiments</article-title>
        <source>Nat Biotech</source>
        <year>2013</year>
        <volume>31</volume>
        <fpage>748</fpage>
        <lpage>52</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2642</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yunger</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rosenfeld</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Garini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shav-Tal</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Single-allele analysis of transcription kinetics in living mammalian cells</article-title>
        <source>Nature Methods</source>
        <year>2010</year>
        <volume>7</volume>
        <fpage>631</fpage>
        <lpage>633</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1482</pub-id>
        <?supplied-pmid 20639867?>
        <pub-id pub-id-type="pmid">20639867</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
