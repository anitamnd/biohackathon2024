<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8364080</article-id>
    <article-id pub-id-type="publisher-id">4311</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-021-04311-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>HELLO: improved neural network architectures and methodologies for small variant calling</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Ramachandran</surname>
          <given-names>Anand</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lumetta</surname>
          <given-names>Steven S.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Klee</surname>
          <given-names>Eric W.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3016-0270</contrib-id>
        <name>
          <surname>Chen</surname>
          <given-names>Deming</given-names>
        </name>
        <address>
          <email>dchen@illinois.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.35403.31</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 9991</institution-id><institution>Department of Electrical and Computer Engineering, </institution><institution>University of Illinois At Urbana-Champaign, </institution></institution-wrap>Urbana, IL 61801 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.66875.3a</institution-id><institution-id institution-id-type="ISNI">0000 0004 0459 167X</institution-id><institution>Biomedical Statistics and Informatics, Department of Quantitative Health Sciences, </institution><institution>Mayo Clinic, </institution></institution-wrap>Rochester, MN USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>8</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>8</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>404</elocation-id>
    <history>
      <date date-type="received">
        <day>9</day>
        <month>1</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>7</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Modern Next Generation- and Third Generation- Sequencing methods such as Illumina and PacBio Circular Consensus Sequencing platforms provide accurate sequencing data. Parallel developments in Deep Learning have enabled the application of Deep Neural Networks to variant calling, surpassing the accuracy of classical approaches in many settings. DeepVariant, arguably the most popular among such methods, transforms the problem of variant calling into one of image recognition where a Deep Neural Network analyzes sequencing data that is formatted as images, achieving high accuracy. In this paper, we explore an alternative approach to designing Deep Neural Networks for variant calling, where we use meticulously designed Deep Neural Network architectures and customized variant inference functions that account for the underlying nature of sequencing data instead of converting the problem to one of image recognition.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Results from 27 whole-genome variant calling experiments spanning Illumina, PacBio and hybrid Illumina-PacBio settings suggest that our method allows vastly smaller Deep Neural Networks to outperform the Inception-v3 architecture used in DeepVariant for indel and substitution-type variant calls. For example, our method reduces the number of indel call errors by up to 18%, 55% and 65% for Illumina, PacBio and hybrid Illumina-PacBio variant calling respectively, compared to a similarly trained DeepVariant pipeline. In these cases, our models are between 7 and 14 times smaller.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">We believe that the improved accuracy and problem-specific customization of our models will enable more accurate pipelines and further method development in the field. HELLO is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/anands-repo/hello">https://github.com/anands-repo/hello</ext-link></p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-021-04311-4.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Variant calling</kwd>
      <kwd>Deep learning</kwd>
      <kwd>Deep neural networks</kwd>
      <kwd>Illumina</kwd>
      <kwd>PacBio</kwd>
      <kwd>Hybrid variant calling</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000144</institution-id>
            <institution>Division of Computer and Network Systems</institution>
          </institution-wrap>
        </funding-source>
        <award-id>1624790</award-id>
        <award-id>1337732</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>1725729</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par26">Variant calling has wide range of applicability in modern bioinformatics. Discovering the underlying genetic traits of Mendelian diseases [<xref ref-type="bibr" rid="CR1">1</xref>], understanding the individual’s susceptibility to cancer[<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>] and study of genetic diversity to help strategize crop-breeding methods [<xref ref-type="bibr" rid="CR4">4</xref>] are just a few of these applications. Substitutions and small insertions and deletions (indels), which account for most mutations in a typical human genome [<xref ref-type="bibr" rid="CR5">5</xref>], are of great interest in many of these studies.</p>
    <p id="Par27">Advances in sequencing technology have enabled probing genomes at a higher resolution than before. Sequencing reads from Next Generation Sequencing (NGS) platforms such as Illumina are typically of a few hundred bases long and are highly accurate. Recent advances in Third Generation Sequencing (TGS) have given rise to sequencing reads which are long (thousands to tens of thousands of bases) with improved accuracy, such as from the Pacific Biosciences’ Circular Consensus Sequencing (CCS) platform. The primary errors in Illumina sequencing reads are the substitution type [<xref ref-type="bibr" rid="CR6">6</xref>], and while the average base quality is high, these sequencing reads with errors cannot be mapped accurately (or at all) [<xref ref-type="bibr" rid="CR7">7</xref>] everywhere in a reference sequence due to their short length, which is a drawback. PacBio CCS reads are not affected by mapping and mappability issues as severely because of their longer length. While these reads also have low average error-rates, the errors are of indel type and are highly context specific [<xref ref-type="bibr" rid="CR8">8</xref>], hence it may be hard to call certain types of indel variants even when there is sufficient read coverage. Small variant calling using data from these two sequencing technologies provide high accuracy results. Since both sequencing platforms have different error profiles, it is also beneficial to combine data from the two platforms to perform hybrid variant calling that compensates each other’s weaknesses.</p>
    <p id="Par28">Traditionally, variant calling methods have used probabilistic models of sequencing errors and sequencing read alignment to determine likelihoods of variation at genomic loci from sequencing data. For instance, the pair-Hidden Markov Model (HMM) has been used [<xref ref-type="bibr" rid="CR9">9</xref>] to determine alignment probabilities of reads to different candidate haplotypes at a site leading to the determination of the best haplotypes at the site. DeepVariant [<xref ref-type="bibr" rid="CR10">10</xref>], which demonstrated how Deep Learning may be applied to variant calling, on the other hand uses a Deep Neural Network (DNN) that makes predictions for candidate alternative alleles and pairs of candidate alternative alleles at a site. These predictions are then converted into variant calls using additional algorithms to filter, sort and rank the different alleles at the site. DeepVariant outperforms traditional methods in many published experimental settings for both indels and substitutions and shows that a sophisticated and general-purpose pattern recognizer such as a DNN with a large parameter space can better capture sequencing noise and alignment characteristics at genomic loci than traditional statistical models which use a small number of parameters but a larger number of domain assumptions. We also note another Deep Learning-based tool, Clairvoyant [<xref ref-type="bibr" rid="CR11">11</xref>], a small variant caller which runs rapidly for noisy long-read technologies, which can call SNVs and indels of length up to 4 bp. Clairvoyant uses a single input summarizing all the data aligning to a location, and uses a DNN to predict variant alleles and lengths from this input. In this article, we look at high-accuracy small variant calling from both short and newer and higher accuracy long-read technologies, and the methods compared here make calls for the full range of small variant lengths (1–50 bp) by making predictions for each candidate allele based on analyzing their associated read supports.</p>
    <p id="Par29">While DeepVariant has shown the ability of DNNs to effectively call variants, it is important to challenge the fundamental approaches used in DeepVariant in order to make improvements in variant calling. Such efforts become increasingly relevant as more and more difficult-to-call sites are benchmarked. For example, recent efforts [<xref ref-type="bibr" rid="CR12">12</xref>] added more than 300,000 new Single Nucleotide Variants (SNVs) and 50,000 new indels to previous ground-truth sets in difficult regions of the genome. Continual improvements of such benchmarks can upend assumptions regarding best performing methods since methods developed previously may not work as effectively for newly revealed segments. In addition, smaller models that can be trained with smaller training sets are helpful for applications where obtaining new training data may not be easy, such as for new target organisms, or where a customized pipeline is desired that is tailored to a specific lab’s variant calling pipeline and quality control heuristics.</p>
    <p id="Par30">Machine Learning models use <italic>inductive biases</italic>, or simplifying assumptions, which constrain them to learning specific types of patterns that generalize well beyond the training set. Image recognition DNNs such as those used by DeepVariant (which uses the Inception-v3 DNN) encode certain inductive biases that work well for the problem of image recognition, such as stationarity and locality [<xref ref-type="bibr" rid="CR13">13</xref>]. However, the DNN in DeepVariant encodes scant assumptions specific to sequencing data in the model’s architecture. Not encoding stronger assumptions about the application can be helpful in the case where the data is complex, such as images of general objects or animals, where it is hard to manually and exhaustively define individual elements of the problem. However, in a problem such as variant calling, some basic elements of the data are easily and precisely defined. We know that sequencing data is in the form of read sequences, and that a variant call supported by a larger number of reads is more likely to be correct than a variant call supported by a smaller number of reads. The objectives difficult to engineer or define exhaustively in this case are models of sequencing and mapping errors, and how to factor these errors in deciding thresholds for calling a variant. The question then is whether we can constrain or encourage a Deep Learning method to expend its learning prowess on the unknown aspects of the problem, rather than spend it on learning almost everything about the problem from an abstract representation of the input data such as images. Incorporating genome sequencing-specific inductive biases into the Deep Learning machinery can achieve this goal.</p>
    <p id="Par31">The concept of <italic>relational inductive bias</italic> [<xref ref-type="bibr" rid="CR14">14</xref>], where the DNN designer explicitly creates structures in the architecture representing elements of the problem as well as their interrelationship, has been studied before. The basic objects in the variant calling setting are sequencing reads and candidate alleles. Taking our cue from these, we build a DNN architecture that recognizes reads and alleles as the elements of the problem, and introduces specific constructs encoding the relationships of reads to alleles, as well as the relationship of one allele to other alleles. Thus, our method, called HELLO (<bold>H</bold>ybrid and stand-alone <bold>E</bold>stimation of sma<bold>LL</bold> gen<bold>O</bold>mic variants), built for small variant calling, accounts for the nature and structure of genome sequencing data and tailors the DNN model to the problem at hand. Explicitly representing these aspects of the problem in the DNN can reduce the learning burden of the machinery as compared to, say, an image recognizer that lacks a notion of reads, or doesn’t use the concept requiring that evidence from multiple reads should add up, and instead operates with assumptions well-suited to another domain. Through this encoding of structure of the data into a DNN, we are effectively combining elements of hand-engineering approaches with the Deep Learning approach. Finally, we introduce a principled way in which DNN predictions for each allele at a site can be combined to produce the variant call result through log likelihood maximization instead of resorting to complex algorithms or a second machine learning method. This approach allows the entire framework to also be extended to polyploid cases with no changes to the underlying DNN.</p>
    <p id="Par32">We performed 27 whole-genome variant calling experiments at various coverage points for Illumina, PacBio and hybrid variant calling using data from the Genome-In-A-Bottle (GIAB) [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>] repository. We compared our methods to DeepVariant and Genome Analysis ToolKit (GATK) using these datasets. Our models are up to 14 × smaller in terms of parameter count compared to DeepVariant but performed similarly to or better than DeepVariant in different settings. In the following sections, we describe in detail, our experimental results and methodology.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <p id="Par33">In this section, we describe the tools, datasets, experimental setup, and evaluation results.</p>
    <sec id="Sec3">
      <title>Tool versions and training hardware</title>
      <p id="Par34">In addition to HELLO, we performed experiments using DeepVariant version 1.1 [<xref ref-type="bibr" rid="CR17">17</xref>] and GATK version 4.2.0.0 [<xref ref-type="bibr" rid="CR18">18</xref>]. Both HELLO and DeepVariant were trained using the same datasets in all our experiments. For training the DeepVariant models, we used Google Cloud Tensor Processing Unit (TPU). For training HELLO, we used our local cluster which contains machines with IBM POWER8 and POWER9 CPUs and NVIDIA Tesla V100 and Tesla K80 Graphics Processing Units (GPUs). GATK was run for Illumina and PacBio datasets using the Docker image downloaded from Dockerhub.</p>
    </sec>
    <sec id="Sec4">
      <title>Training datasets and training overview</title>
      <p id="Par35">For training HELLO and DeepVariant, we used the GIAB HG002 whole genome BAM files, and prepared alignments at multiple coverage points to enable the DNNs to make robust predictions across coverage points. For both Illumina and PacBio sequencing reads, we emphasized lower coverage data more than higher coverage data in the training set since variant calling is more challenging at lower coverages, but also quite valuable given that both sequencing and computation costs are lower at lower coverage. This relationship is true especially for PacBio reads since they are more expensive and have valid use cases for structural variant calling even at lower coverages. With these points in mind, we downloaded 300 × coverage Illumina alignment data from the GIAB repository. Following conversion from Binary Alignment Map (BAM) format to FASTQ files, we split the FASTQ files into non-overlapping paired-end FASTQ files of coverages 15x, 20x, 25x, 30x, 40x, and 50 × through random partitioning. For PacBio, we downloaded 52 × coverage CCS sequencing data for HG002 available from GIAB, and prepared non-overlapping BAM files through random partitioning at fractions of 1/3 and 1/6 to obtain three whole genome datasets at coverages approximately 52x, 17x, and 9x.</p>
      <p id="Par36">Each set of paired-end FASTQ files prepared for Illumina was aligned to the GRCh38 human reference build using the Burrows-Wheeler Aligner (BWA) tool [<xref ref-type="bibr" rid="CR19">19</xref>]. For HELLO, we performed indel realignment using GATK 3.8.1. DeepVariant performs indel realignment internally using its own implementation, so we directly used the alignment files without realignment.</p>
      <p id="Par37">Haplotagging is a procedure where reads estimated to be from the same haplotypes are tagged identically. This process can be performed using the Whatshap tool [<xref ref-type="bibr" rid="CR20">20</xref>] for PacBio sequencing reads. For DeepVariant, we trained the model on haplotagged PacBio alignment files since DeepVariant is known to perform the best when haplotags are present in the data for PacBio reads. For DeepVariant, options needed specially for PacBio data were added to the training dataset generation script. For PacBio datasets, we trained two HELLO models, one which calls variants from PacBio data without haplotags, and another which calls variants from alignment files which are haplotagged. We found the haplotag model to perform better and present those results in this article relegating the other result to the Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
      <p id="Par38">For hybrid training data, for each chromosome and for each Illumina dataset described above, we randomly selected a PacBio dataset described above and prepared hybrid training datasets using the two. The same chromosome and alignment file combinations were used for HELLO and DeepVariant. In addition, for DeepVariant we used the “samtools merge” [<xref ref-type="bibr" rid="CR21">21</xref>] command to produce a single BAM file with both PacBio and Illumina reads, and used Picard [<xref ref-type="bibr" rid="CR22">22</xref>] to apply the same read group to all the reads (both Illumina and PacBio) as needed for DeepVariant hybrid training. HELLO simply accepts PacBio and Illumina BAM files as inputs. For DeepVariant, the generated training datasets were shuffled as required for the tool before training.</p>
      <p id="Par39">Chromosomes 21 and 22 were not used for training HELLO and DeepVariant (the two chromosomes were held out completely and were not used for gradient descent nor for determining the best model). For both HELLO and DeepVariant, we designated a checkpoint interval (or epoch) as one complete pass through the training dataset. We performed, by default, 20 epochs of training for both methods. For DeepVariant hybrid training, we found the 20<sup>th</sup> epoch to have the highest validation accuracy, and we continued training for another 8 epochs when we found a pre-final epoch to give the best validation accuracy.</p>
      <p id="Par40">For labeling the training examples, we used GIAB benchmark variant set 4.2 for the GRCh38 reference. Details on data preparation are released with the Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
    </sec>
    <sec id="Sec5">
      <title>Evaluation datasets</title>
      <p id="Par41">We performed three evaluations as follows.<list list-type="bullet"><list-item><p id="Par42">GIAB HG003 whole genome data with GIAB benchmark variant set 4.2.1</p></list-item><list-item><p id="Par43">GIAB HG003 chromosomes 21, and 22 with GIAB benchmark variant set 4.2.1</p></list-item><list-item><p id="Par44">GIAB HG001 whole genome data with GIAB benchmark variant set 3.3.2 (the latest version available for this genome)</p></list-item></list></p>
      <p id="Par45">GIAB benchmark variant set 4.2.1 is the latest iteration of ground truth variant sets from the <italic>Genome In A Bottle</italic> consortium. It adds approximately 300,000 SNVs and 50,000 indels not included previously and reveals many regions in the reference that are difficult to call using short read sequencing technologies like Illumina. This variant calling set is only available currently for the trio HG002 (son), HG003 (father) and HG004 (mother). Using this ground-truth set for training exposes the models to challenging patterns in the reference producing more robust models. Using this ground-truth set for evaluation provides a more comprehensive picture of a tool’s capabilities. Hence it is important to test our models using this latest ground-truth version. So, we selected GIAB HG003 as one of the datasets on which to report variant calling accuracies.</p>
      <p id="Par46">HG002 and HG003 are genomes of different but related individuals. To quantify the similarity between the two genomes from a variant calling perspective, we used the hap.py tool [<xref ref-type="bibr" rid="CR23">23</xref>], designating HG003’s truth Variant Call Format (VCF) file as the truth VCF and HG002’s truth VCF as the query VCF restricting analysis to the confident regions in HG003. We got an F1 score of only 0.532 for indels and 0.579 for SNVs. Compared to this, HELLO produces variant calls with an F1 score of 0.99 for indels and 0.999 for SNVs with 30 × coverage PacBio data for HG003. This means that a model trained on HG002 cannot make such highly accurate predictions on HG003 simply through memorization (or overfitting) of the training data. However, while it seems very likely that a highly accurate model is not making predictions on one genome by overfitting on the other, there may still be an influence of their genetic relation in the variant calling accuracy. Hence it is important to examine variant calling accuracy where this genetic relation is not a factor.</p>
      <p id="Par47">To address this concern, we separately examine variant calling accuracy on GIAB HG003 chromosomes 21 and 22. As described before, chromosomes 21 and 22 were completely held out from the training procedure. Hence the models are not aware of the variants in chromosomes 21 and 22 of HG002 (the son), and the fact that HG002 and HG003 are genetically related does not influence variant calling accuracies for chromosomes 21 and 22 for HG003 (the father). In addition, using HG003 allows us to evaluate accuracies using the latest GIAB ground-truth set, which has many important qualities, as described before.</p>
      <p id="Par48">Additionally, we also present results on GIAB HG001 whole genome data. HG001 is not closely related to the individual HG002. For HG001, we use the GIAB benchmark set 3.3.2, which is the latest available GIAB truth set for that genome. As indicated before, this ground-truth set does not contain some of the challenging sites in the latest GIAB release.</p>
      <p id="Par49">For HG001 and HG003, we downloaded 300 × alignment files from the GIAB repository for Illumina. We subsampled the BAM files using samtools with different random seeds to 20x, 30x, 40x, and 50 × coverage alignment files for HG003 and to 20 × and 30 × alignment files for HG001. We converted each alignment file into paired-end FASTQ files and aligned them to the GRCh38 reference build using BWA. For GATK, we performed Base Quality Score Recalibration (BQSR) using known Single Nucleotide Polymorphism (SNP) and indel sets provided in the GATK resource bundle, and for HELLO we performed indel realignment using GATK 3.8.1. For HELLO and DeepVariant, single entry-point scripts run the complete variant call flow. For GATK, we launched haplotype calling, variant scoring, and variant filtering in succession as listed in the best practices webpage [<xref ref-type="bibr" rid="CR24">24</xref>].</p>
      <p id="Par50">For PacBio, we downloaded HG003 60 × coverage CCS alignments. From this dataset, we prepared 15x, 30x, and 60 × coverage alignment files through subsampling (where applicable using samtools view), BAM to FASTQ conversion, and alignment with pbmm2 [<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>]. For HG001, we downloaded 30 × coverage CCS alignments, and followed the same steps as for HG003 for preparing alignment files at 15 × and 30 × coverages. For HELLO, and DeepVariant, we performed haplotagging with the Whatshap tool [<xref ref-type="bibr" rid="CR20">20</xref>]. For GATK, we did not find detailed recommendations from Broad Institute regarding how to call variants using PacBio reads, but prior art has described running GATK for PacBio reads [<xref ref-type="bibr" rid="CR8">8</xref>], so we followed these recommendations.</p>
      <p id="Par51">For hybrid variant calling, we used the samtools merge command to merge each Illumina dataset described above to each PacBio dataset described above to produce 16 input files for DeepVariant. We used Picard tools to apply the same read group to all reads. HELLO accepts two different BAM files from two technologies. GATK doesn’t support hybrid variant calling as described in this paper yet.</p>
      <p id="Par52">Additional details on data preparation and variant calling are released with the Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
    </sec>
    <sec id="Sec6">
      <title>Evaluation results</title>
      <p id="Par53">We summarize the main results of the paper below.</p>
      <sec id="Sec7">
        <title>GIAB HG003 whole genome variant calling</title>
        <p id="Par54">Tables <xref rid="Tab1" ref-type="table">1</xref>, <xref rid="Tab2" ref-type="table">2</xref> show the results of calling variants for Illumina sequencing reads from the three methods we tested. As may be seen at lower coverages, all tools call indels at a lower accuracy than SNVs based on Precision and Recall values. The accuracy of calling indels increases significantly with coverage with many times fewer errors being called at higher coverages.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Indel results for HG003 Whole Genome Sequencing (WGS), Illumina</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">GATK</th><th align="left" colspan="3">DeepVariant</th><th align="left" colspan="3">HELLO</th></tr><tr><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th></tr></thead><tbody><tr><td align="left">20x</td><td char="." align="char">0.977132</td><td char="." align="char">0.962505</td><td align="left">30,699</td><td char="." align="char">0.980459</td><td char="." align="char">0.971863</td><td align="left">24,345</td><td char="." align="char">0.986638</td><td char="." align="char">0.973921</td><td align="left">20,052</td></tr><tr><td align="left">30x</td><td char="." align="char">0.987019</td><td char="." align="char">0.981851</td><td align="left">15,934</td><td char="." align="char">0.991070</td><td char="." align="char">0.987324</td><td align="left">11,067</td><td char="." align="char">0.994046</td><td char="." align="char">0.987738</td><td align="left">9284</td></tr><tr><td align="left">40x</td><td char="." align="char">0.990826</td><td char="." align="char">0.988121</td><td align="left">10,801</td><td char="." align="char">0.994484</td><td char="." align="char">0.991528</td><td align="left">7164</td><td char="." align="char">0.996235</td><td char="." align="char">0.990973</td><td align="left">6516</td></tr><tr><td align="left">50x</td><td char="." align="char"><bold>0.992820</bold></td><td char="." align="char"><bold>0.991235</bold></td><td align="left"><bold>8191</bold></td><td char="." align="char"><bold>0.996153</bold></td><td char="." align="char"><bold>0.993191</bold></td><td align="left"><bold>5451</bold></td><td char="." align="char"><bold>0.997263</bold></td><td char="." align="char"><bold>0.992274</bold></td><td align="left"><bold>5325</bold></td></tr></tbody></table><table-wrap-foot><p>Values in bold indicate the best operating point for each tool for the corresponding metric</p></table-wrap-foot></table-wrap><table-wrap id="Tab2"><label>Table 2</label><caption><p>SNV results for HG003 WGS, Illumina</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">GATK</th><th align="left" colspan="3">DeepVariant</th><th align="left" colspan="3">HELLO</th></tr><tr><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th></tr></thead><tbody><tr><td align="left">20x</td><td char="." align="char"><bold>0.993089</bold></td><td char="." align="char">0.987367</td><td align="left">64,904</td><td char="." align="char">0.994664</td><td char="." align="char">0.990906</td><td align="left">47,956</td><td char="." align="char">0.996837</td><td char="." align="char">0.990922</td><td align="left">40,679</td></tr><tr><td align="left">30x</td><td char="." align="char">0.992641</td><td char="." align="char">0.992285</td><td align="left">50,157</td><td char="." align="char">0.996820</td><td char="." align="char">0.993576</td><td align="left">31,928</td><td char="." align="char">0.998147</td><td char="." align="char">0.993197</td><td align="left">28,776</td></tr><tr><td align="left">40x</td><td char="." align="char">0.992119</td><td char="." align="char">0.993382</td><td align="left">48,286</td><td char="." align="char">0.997644</td><td char="." align="char"><bold>0.994059</bold></td><td align="left">27,584</td><td char="." align="char">0.998533</td><td char="." align="char"><bold>0.993424</bold></td><td align="left">26,742</td></tr><tr><td align="left">50x</td><td char="." align="char">0.991823</td><td char="." align="char"><bold>0.993881</bold></td><td align="left"><bold>47,633</bold></td><td char="." align="char"><bold>0.998125</bold></td><td char="." align="char">0.994017</td><td align="left"><bold>26,125</bold></td><td char="." align="char"><bold>0.998761</bold></td><td char="." align="char">0.993395</td><td align="left"><bold>26,082</bold></td></tr></tbody></table><table-wrap-foot><p>Values in bold indicate the best operating point for each tool for the corresponding metric</p></table-wrap-foot></table-wrap></p>
        <p id="Par55">To visualize the performance of GATK and DeepVariant relative to HELLO, we prepared plots shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. Each plot indicates the number of excess errors in GATK or DeepVariant with respect to HELLO. The bars indicate the absolute differences in the numbers of False Negative (FN) and False Positive (FP) calls and the lines indicate the excess total errors made by each tool as a fraction of the total number of errors called by the worse performing tool.<fig id="Fig1"><label>Fig. 1</label><caption><p>Excess errors in DeepVariant and GATK variant calls compared to HELLO for HG003 Illumina Whole Genome Sequencing (WGS) data. Positive values indicate better performance by HELLO over competitor. Bars reference the left y-axis and indicate differences in FP and FN counts between tool (GATK or DeepVariant) and HELLO. Formally, let <inline-formula id="IEq44"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{N}}_{{{\text{FP}}}}^{{\text{T}}} ,{\text{ N}}_{{{\text{FN}}}}^{{\text{T}}} , \in _{{\text{T}}} = \left( {{\text{N}}_{{{\text{FP}}}}^{{\text{T}}} + {\text{N}}_{{{\text{FN}}}}^{{\text{T}}} } \right)$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:msubsup><mml:mtext>N</mml:mtext><mml:mrow><mml:mtext>FP</mml:mtext></mml:mrow><mml:mtext>T</mml:mtext></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mspace width="0.333333em"/><mml:mtext>N</mml:mtext></mml:mrow><mml:mrow><mml:mtext>FN</mml:mtext></mml:mrow><mml:mtext>T</mml:mtext></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mo>∈</mml:mo><mml:mtext>T</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mtext>N</mml:mtext><mml:mrow><mml:mtext>FP</mml:mtext></mml:mrow><mml:mtext>T</mml:mtext></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mtext>N</mml:mtext><mml:mrow><mml:mtext>FN</mml:mtext></mml:mrow><mml:mtext>T</mml:mtext></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq44.gif"/></alternatives></inline-formula> represent, respectively, the false positive count, false negative count, and total error count for tool <inline-formula id="IEq45"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{T}}$$\end{document}</tex-math><mml:math id="M4"><mml:mtext>T</mml:mtext></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq45.gif"/></alternatives></inline-formula> at a given coverage point. Then, the value of the bar, marked “FP”, for that coverage point for tool <inline-formula id="IEq46"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{T}}$$\end{document}</tex-math><mml:math id="M6"><mml:mtext>T</mml:mtext></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq46.gif"/></alternatives></inline-formula>, is <inline-formula id="IEq47"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{N}}_{{{\text{FP}}}}^{{\text{T}}} - {\text{N}}_{{{\text{FP}}}}^{{{\text{HELLO}}}} ,$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:msubsup><mml:mtext>N</mml:mtext><mml:mrow><mml:mtext>FP</mml:mtext></mml:mrow><mml:mtext>T</mml:mtext></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mtext>N</mml:mtext><mml:mrow><mml:mtext>FP</mml:mtext></mml:mrow><mml:mtext>HELLO</mml:mtext></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq47.gif"/></alternatives></inline-formula> and the value of the bar marked “FN” is <inline-formula id="IEq48"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{N}}_{{{\text{FN}}}}^{{\text{T}}} - {\text{N}}_{{{\text{FN}}}}^{{{\text{HELLO}}}}$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:msubsup><mml:mtext>N</mml:mtext><mml:mrow><mml:mtext>FN</mml:mtext></mml:mrow><mml:mtext>T</mml:mtext></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mtext>N</mml:mtext><mml:mrow><mml:mtext>FN</mml:mtext></mml:mrow><mml:mtext>HELLO</mml:mtext></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq48.gif"/></alternatives></inline-formula>. The line plots reference the right y-axis, and indicate the differences in total error count as a fraction of total errors of the worse performing method at each coverage point. Formally, for the line plots for tool <inline-formula id="IEq49"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{T}}$$\end{document}</tex-math><mml:math id="M12"><mml:mtext>T</mml:mtext></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq49.gif"/></alternatives></inline-formula>, the value of a point in the line plot is <inline-formula id="IEq50"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {\in_{{\text{T}}} - \in{}_{{{\text{HELLO}}}} } \right)/{\text{max}}\left( {\in_{{\text{T}}} ,{ }\in_{{{\text{HELLO}}}} } \right).$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mo>∈</mml:mo><mml:mtext>T</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:mo>∈</mml:mo><mml:msub><mml:mrow/><mml:mtext>HELLO</mml:mtext></mml:msub></mml:mrow></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mtext>max</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mo>∈</mml:mo><mml:mtext>T</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:mrow/><mml:msub><mml:mo>∈</mml:mo><mml:mtext>HELLO</mml:mtext></mml:msub></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq50.gif"/></alternatives></inline-formula> This scheme is followed for Figs. 1, <xref rid="Fig2" ref-type="fig">2</xref>, <xref rid="Fig3" ref-type="fig">3</xref>, <xref rid="Fig4" ref-type="fig">4</xref>, <xref rid="Fig5" ref-type="fig">5</xref>, <xref rid="Fig6" ref-type="fig">6</xref>, <xref rid="Fig7" ref-type="fig">7</xref>, <xref rid="Fig8" ref-type="fig">8</xref>, <xref rid="Fig9" ref-type="fig">9</xref></p></caption><graphic xlink:href="12859_2021_4311_Fig1_HTML" id="MO1"/></fig></p>
        <p id="Par56">For indels, HELLO improves upon the number of errors in GATK by more than 30% for all cases. The improvement with respect to DeepVariant is more than 15% for 20 × and 30 × coverage data. At higher coverages, the advantage HELLO holds over DeepVariant steadily decreases. In all cases, HELLO makes fewer indel call errors than either method. Regarding SNV calls, HELLO improves upon GATK’s number of errors by more than 35% in all cases due mainly to fewer FP calls. Compared to DeepVariant, HELLO makes fewer erroneous calls in all cases, with improvements up to 15.17%.</p>
        <p id="Par57">Tables <xref rid="Tab3" ref-type="table">3</xref>, <xref rid="Tab4" ref-type="table">4</xref> indicate the results for PacBio variant calling. The accuracy of calling SNVs is higher than that of calling indels in all cases. Doubling the coverage from 15 × to 30 × results in reduction of errors by approximately 2 × to 3 × for SNV calls for all methods. However, increasing coverage further doesn’t seem to have as much effect. For GATK, increasing coverage results in only modest improvements for indel calls. For DeepVariant and HELLO, however, significant reductions in indel errors are observed at 30 × with respect to 15 × and at 60 × with respect to 30 × coverage data.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Indel results for HG003 WGS, PacBio</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">GATK</th><th align="left" colspan="3">DeepVariant</th><th align="left" colspan="3">HELLO</th></tr><tr><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th></tr></thead><tbody><tr><td align="left">15x</td><td char="." align="char">0.860057</td><td char="." align="char">0.858831</td><td align="left">144,331</td><td char="." align="char">0.949591</td><td char="." align="char">0.947211</td><td align="left">52,916</td><td char="." align="char">0.969548</td><td char="." align="char">0.962226</td><td align="left">34,847</td></tr><tr><td align="left">30x</td><td char="." align="char">0.891429</td><td char="." align="char">0.889284</td><td align="left">112,742</td><td char="." align="char">0.980414</td><td char="." align="char">0.982694</td><td align="left">19,026</td><td char="." align="char">0.990916</td><td char="." align="char">0.990159</td><td align="left">9720</td></tr><tr><td align="left">60x</td><td char="." align="char"><bold>0.897505</bold></td><td char="." align="char"><bold>0.899685</bold></td><td align="left"><bold>104,621</bold></td><td char="." align="char"><bold>0.991986</bold></td><td char="." align="char"><bold>0.992145</bold></td><td align="left"><bold>8172</bold></td><td char="." align="char"><bold>0.996676</bold></td><td char="." align="char"><bold>0.996115</bold></td><td align="left"><bold>3702</bold></td></tr></tbody></table><table-wrap-foot><p>Values in bold indicate the best operating point for each tool for the corresponding metric</p></table-wrap-foot></table-wrap><table-wrap id="Tab4"><label>Table 4</label><caption><p>SNV results for HG003 WGS, PacBio</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">GATK</th><th align="left" colspan="3">DeepVariant</th><th align="left" colspan="3">HELLO</th></tr><tr><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th></tr></thead><tbody><tr><td align="left">15x</td><td char="." align="char">0.996702</td><td char="." align="char">0.990138</td><td align="left">43,719</td><td char="." align="char">0.998137</td><td char="." align="char">0.994880</td><td align="left">23,218</td><td char="." align="char">0.998536</td><td char="." align="char">0.995063</td><td align="left">21,286</td></tr><tr><td align="left">30x</td><td char="." align="char">0.997521</td><td char="." align="char">0.995412</td><td align="left">23,501</td><td char="." align="char">0.999092</td><td char="." align="char"><bold>0.998774</bold></td><td align="left">7101</td><td char="." align="char">0.999470</td><td char="." align="char"><bold>0.998794</bold></td><td align="left">5776</td></tr><tr><td align="left">60x</td><td char="." align="char"><bold>0.997561</bold></td><td char="." align="char"><bold>0.995716</bold></td><td align="left"><bold>22,357</bold></td><td char="." align="char"><bold>0.999405</bold></td><td char="." align="char">0.998650</td><td align="left"><bold>6471</bold></td><td char="." align="char"><bold>0.999636</bold></td><td char="." align="char"><bold>0.998794</bold></td><td align="left"><bold>5223</bold></td></tr></tbody></table><table-wrap-foot><p>Values in bold indicate the best operating point for each tool for the corresponding metric</p></table-wrap-foot></table-wrap></p>
        <p id="Par58">It is interesting to look at GATK’s performance given that GATK is not optimized for PacBio sequencing data. The fact that even under this situation GATK produces relatively high accuracy for SNVs compared to indels is reflective of the dominant error type in PacBio sequencing data, which are indel type errors. The relative paucity of substitution type errors in PacBio data hides the difference in error modeling to a large extent; on the other hand, the incognizance of the accurate indel error model of PacBio sequencing by GATK results in significantly lower indel call accuracy and an inability to utilize higher coverage to improve the situation significantly.</p>
        <p id="Par59">To better visualize relative performance of the tools, we provide plots in Fig. <xref rid="Fig2" ref-type="fig">2</xref> which indicate excess errors in GATK and DeepVariant compared to HELLO. HELLO makes approximately 35%—55% fewer indel errors compared to DeepVariant. Improvements are seen in both FN and FP. In the case of SNVs, HELLO makes approximately up to 20% fewer errors compared to DeepVariant. Compared to GATK, HELLO makes approximately 75–95% fewer indel errors, and approximately 50–75% fewer SNV errors. HELLO’s lead increases with coverage in both cases. For PacBio, in all cases, HELLO makes fewer errors than the compared methods.<fig id="Fig2"><label>Fig. 2</label><caption><p>Excess errors in DeepVariant and GATK variant calls compared to HELLO for HG003 PacBio WGS data. Positive values indicate better performance by HELLO over competitor. Bars reference the left y-axis and indicate differences in FP and FN counts between tool (GATK or DeepVariant) and HELLO. The line plots reference the right y-axis, and indicate the differences in total error count as a fraction of total errors of the worse performing method at each coverage point. Please refer to Fig. <xref rid="Fig1" ref-type="fig">1</xref> for additional explanation</p></caption><graphic xlink:href="12859_2021_4311_Fig2_HTML" id="MO2"/></fig></p>
        <p id="Par60">Tables <xref rid="Tab5" ref-type="table">5</xref>, <xref rid="Tab6" ref-type="table">6</xref> summarize the results of calling variants in the hybrid Illumina-PacBio case. Hybrid variant calling is interesting because coupling data from two different sequencing platforms provides an opportunity to exploit any complementarity of properties of the two types of data—for example, Illumina sequencing reads face mapping issues in certain parts of the genome and PacBio reads have context-dependent and systematic indel errors.<table-wrap id="Tab5"><label>Table 5</label><caption><p>Indel results for HG003 WGS, Hybrid</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">DeepVariant</th><th align="left" colspan="3">HELLO</th></tr><tr><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th></tr></thead><tbody><tr><td align="left">20 × 15x</td><td char="." align="char">0.987302</td><td char="." align="char">0.988139</td><td align="left">12,661</td><td char="." align="char">0.994011</td><td char="." align="char">0.993572</td><td align="left">6381</td></tr><tr><td align="left">20 × 30x</td><td char="." align="char">0.989490</td><td char="." align="char">0.991368</td><td align="left">9894</td><td char="." align="char">0.996103</td><td char="." align="char">0.995849</td><td align="left">4137</td></tr><tr><td align="left">20 × 60x</td><td char="." align="char">0.989477</td><td char="." align="char">0.993166</td><td align="left">9012</td><td char="." align="char">0.997052</td><td char="." align="char">0.996892</td><td align="left">3114</td></tr><tr><td align="left">30 × 15x</td><td char="." align="char">0.993222</td><td char="." align="char">0.993308</td><td align="left">6939</td><td char="." align="char">0.996341</td><td char="." align="char">0.995970</td><td align="left">3951</td></tr><tr><td align="left">30 × 30x</td><td char="." align="char">0.993277</td><td char="." align="char">0.994482</td><td align="left">6324</td><td char="." align="char">0.997269</td><td char="." align="char">0.997177</td><td align="left">2856</td></tr><tr><td align="left">30 × 60x</td><td char="." align="char">0.992232</td><td char="." align="char">0.995110</td><td align="left">6570</td><td char="." align="char">0.997664</td><td char="." align="char">0.997566</td><td align="left">2453</td></tr><tr><td align="left">40 × 15x</td><td char="." align="char">0.995176</td><td char="." align="char">0.995084</td><td align="left">5016</td><td char="." align="char">0.997139</td><td char="." align="char">0.996838</td><td align="left">3095</td></tr><tr><td align="left">40 × 30x</td><td char="." align="char">0.995033</td><td char="." align="char">0.995756</td><td align="left">4755</td><td char="." align="char">0.997790</td><td char="." align="char">0.997649</td><td align="left">2345</td></tr><tr><td align="left">40 × 60x</td><td char="." align="char">0.993734</td><td char="." align="char">0.995974</td><td align="left">5338</td><td char="." align="char">0.998024</td><td char="." align="char">0.997841</td><td align="left">2125</td></tr><tr><td align="left">50 × 15x</td><td char="." align="char"><bold>0.996197</bold></td><td char="." align="char">0.995881</td><td align="left">4077</td><td char="." align="char">0.997726</td><td char="." align="char">0.997257</td><td align="left">2576</td></tr><tr><td align="left">50 × 30x</td><td char="." align="char">0.995982</td><td char="." align="char"><bold>0.996470</bold></td><td align="left"><bold>3895</bold></td><td char="." align="char">0.998047</td><td char="." align="char">0.997816</td><td align="left">2126</td></tr><tr><td align="left">50 × 60x</td><td char="." align="char">0.994690</td><td char="." align="char">0.996468</td><td align="left">4582</td><td char="." align="char"><bold>0.998192</bold></td><td char="." align="char"><bold>0.998016</bold></td><td align="left"><bold>1949</bold></td></tr></tbody></table><table-wrap-foot><p>Values in bold indicate the best operating point for each tool for the corresponding metric</p></table-wrap-foot></table-wrap><table-wrap id="Tab6"><label>Table 6</label><caption><p>SNV results for HG003 WGS, Hybrid</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">DeepVariant</th><th align="left" colspan="3">HELLO</th></tr><tr><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th></tr></thead><tbody><tr><td align="left">20 × 15x</td><td char="." align="char">0.998807</td><td char="." align="char">0.998758</td><td align="left">8104</td><td char="." align="char">0.998937</td><td char="." align="char">0.998999</td><td align="left">6872</td></tr><tr><td align="left">20 × 30x</td><td char="." align="char">0.998882</td><td char="." align="char">0.998790</td><td align="left">7748</td><td char="." align="char">0.999233</td><td char="." align="char">0.999186</td><td align="left">5266</td></tr><tr><td align="left">20 × 60x</td><td char="." align="char">0.999035</td><td char="." align="char">0.998691</td><td align="left">7565</td><td char="." align="char">0.999418</td><td char="." align="char">0.999234</td><td align="left">4487</td></tr><tr><td align="left">30 × 15x</td><td char="." align="char">0.999043</td><td char="." align="char">0.998848</td><td align="left">7018</td><td char="." align="char">0.999061</td><td char="." align="char">0.999022</td><td align="left">6382</td></tr><tr><td align="left">30 × 30x</td><td char="." align="char">0.999081</td><td char="." align="char">0.998938</td><td align="left">6594</td><td char="." align="char">0.999306</td><td char="." align="char">0.999185</td><td align="left">5022</td></tr><tr><td align="left">30 × 60x</td><td char="." align="char">0.999151</td><td char="." align="char">0.998820</td><td align="left">6752</td><td char="." align="char">0.999443</td><td char="." align="char"><bold>0.999248</bold></td><td align="left">4358</td></tr><tr><td align="left">40 × 15x</td><td char="." align="char">0.999185</td><td char="." align="char">0.998838</td><td align="left">6579</td><td char="." align="char">0.999165</td><td char="." align="char">0.998970</td><td align="left">6209</td></tr><tr><td align="left">40 × 30x</td><td char="." align="char">0.999193</td><td char="." align="char">0.999006</td><td align="left">5993</td><td char="." align="char">0.999354</td><td char="." align="char">0.999170</td><td align="left">4912</td></tr><tr><td align="left">40 × 60x</td><td char="." align="char">0.999223</td><td char="." align="char">0.998893</td><td align="left">6269</td><td char="." align="char">0.999473</td><td char="." align="char">0.999242</td><td align="left">4277</td></tr><tr><td align="left">50 × 15x</td><td char="." align="char"><bold>0.999286</bold></td><td char="." align="char">0.998796</td><td align="left">6383</td><td char="." align="char">0.999243</td><td char="." align="char">0.998915</td><td align="left">6131</td></tr><tr><td align="left">50 × 30x</td><td char="." align="char">0.999272</td><td char="." align="char"><bold>0.999035</bold></td><td align="left"><bold>5635</bold></td><td char="." align="char">0.999387</td><td char="." align="char">0.999130</td><td align="left">4937</td></tr><tr><td align="left">50 × 60x</td><td char="." align="char">0.999244</td><td char="." align="char">0.998932</td><td align="left">6071</td><td char="." align="char"><bold>0.999500</bold></td><td char="." align="char">0.999235</td><td align="left"><bold>4211</bold></td></tr></tbody></table><table-wrap-foot><p>Values in bold indicate the best operating point for each tool for the corresponding metric</p></table-wrap-foot></table-wrap></p>
        <p id="Par61">We first look at the effect of using Illumina reads along with PacBio reads in the hybrid setting compared to using pure PacBio data with the same PacBio coverage in the standalone setting. For DeepVariant, using 20 × Illumina reads with 15 × PacBio reads in the hybrid setting provides significant reduction in SNV errors, whereas using 20 × Illumina reads with 30 × or 60 × PacBio reads show only small differences. Similarly, HELLO shows significant improvements when 20 × Illumina reads are used along with 15 × PacBio reads, and marginal improvements when 20 × Illumina reads are used with 30 × and 60 × PacBio reads. This indicates that Illumina reads do not add to the quality of SNV calls when PacBio reads are available at sufficient coverage. The performance of both tools for SNV calls compared to standalone Illumina reads is significantly improved when additional PacBio sequencing reads are used in the hybrid setting. But this is an expected outcome given that standalone PacBio SNV performance with 15 × reads outperforms even 50 × SNV results with Illumina reads, even for GATK, which is optimized for short read platforms.</p>
        <p id="Par62">Next, we look at the hybrid setting with added Illumina reads compared to standalone PacBio calling with the same PacBio coverage from the perspective of indel errors. For both DeepVariant and HELLO, using 20 × Illumina sequencing reads in hybrid setting improves indel call errors in all cases by significant margins, except for the case of 60 × PacBio data where performance is very similar with or without Illumina data. Unlike the case of SNVs, PacBio reads are affected by a context-specific agglomeration of indel errors and in these contexts, it may be difficult to find sufficient support for non-erroneous alleles from reads. Meanwhile Illumina reads do not suffer from such issues and hence adding Illumina data seems to be able to neatly complement the PacBio reads in this situation. The indel performances of both tools are also improved with respect to standalone Illumina calls when additional PacBio sequencing reads are used in the hybrid setting.</p>
        <p id="Par63">So far, we have examined how the addition of <italic>extra</italic> PacBio or Illumina reads affects accuracy compared to standalone calling. Then, what if the added reads are not extra, but a <italic>replacement</italic> or a <italic>substitute</italic>? Interestingly, when HELLO is input with 20 × Illumina and 15 × PacBio dataset (total input data coverage of 35x), it outperforms 40 × coverage Illumina sequencing data for indel and SNV calls from all the three methods. In addition, it performs almost as well as 60 × PacBio variant calling using DeepVariant for both indels and SNVs. Coupled with the fact that long reads can provide strong performance for structural variants at 15 × coverage [<xref ref-type="bibr" rid="CR8">8</xref>], 20 × Illumina with 15 × PacBio hybrid calling may be an interesting use-case for many sequencing experiments where all types of variants (SNVs, indels, and large structural variants) are desired to be called.</p>
        <p id="Par64">Interestingly, prior literature [<xref ref-type="bibr" rid="CR27">27</xref>] reports an optimal configuration of 25 × coverage PacBio reads with 60 × coverage Illumina reads for hybrid structural variant calling. Newer sequencing techniques from PacBio, such as the CCS read platforms examined in our experiments, can potentially reduce the coverage requirements of both short and long reads in such hybrid setups for structural variant calling. Given that PacBio CCS data can provide accurate structural variants at 15 × coverage, as mentioned above, the recommendation in this article of using 20 × Illumina, and 15 × PacBio CCS reads may also be examined for its potential as a viable candidate for hybrid structural variant calling as well.</p>
        <p id="Par65">To help visualize the relative performance of the methods for the hybrid case, we prepared the plots shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref> that show surplus errors in DeepVariant compared to HELLO. For indel calls, HELLO consistently makes fewer false negative and false positive errors in all cases. Overall, HELLO improves upon the number of erroneous indel calls in DeepVariant by between 40 and 65% approximately. For SNV calls, HELLO makes fewer errors by up to 40% approximately. The advantage held by HELLO decreases at higher Illumina coverages, but increases at higher PacBio coverages for both indels and SNVs.<fig id="Fig3"><label>Fig. 3</label><caption><p>Excess errors in DeepVariant and GATK variant calls compared to HELLO for HG003 hybrid WGS data. Positive values indicate better performance by HELLO over competitor. Bars reference the left y-axis and indicate differences in FP and FN counts between tool (GATK or DeepVariant) and HELLO. The line plots reference the right y-axis, and indicate the differences in total error count as a fraction of total errors of the worse performing method at each coverage point. Please refer to Fig. <xref rid="Fig1" ref-type="fig">1</xref> for additional explanation</p></caption><graphic xlink:href="12859_2021_4311_Fig3_HTML" id="MO3"/></fig></p>
        <p id="Par66">We examined the number of trainable parameters in DeepVariant’s checkpoints. We found 21,775,363 parameters for both the hybrid and Illumina models, and 21,776,227 parameters for the PacBio model. HELLO uses 1,536,082 parameters for the PacBio model, 1,536,034 parameters for the Illumina model and 2,857,538 parameters for the hybrid model. These numbers indicate that HELLO’s DNNs are 7.6 × to 14.1 × smaller.</p>
      </sec>
      <sec id="Sec8">
        <title>GIAB HG003 chromosomes 21–22 variant calling</title>
        <p id="Par67">We examined the variant call performance of the methods for HG003 chromosomes 21 and 22 which were completely held out during training. The results are presented in Tables <xref rid="Tab7" ref-type="table">7</xref>, <xref rid="Tab8" ref-type="table">8</xref>, <xref rid="Tab9" ref-type="table">9</xref>, <xref rid="Tab10" ref-type="table">10</xref>, <xref rid="Tab11" ref-type="table">11</xref>, <xref rid="Tab12" ref-type="table">12</xref> and Figs. <xref rid="Fig4" ref-type="fig">4</xref>, <xref rid="Fig5" ref-type="fig">5</xref>, <xref rid="Fig6" ref-type="fig">6</xref>. We find that the precisions and recalls for chromosomes 21 and 22 track closely what was observed for the whole genome HG003 calling. In addition, HELLO maintains its lead over competitors in almost all cases.<table-wrap id="Tab7"><label>Table 7</label><caption><p>Indel results for HG003 chr21-22, Illumina</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">GATK</th><th align="left" colspan="3">DeepVariant</th><th align="left" colspan="3">HELLO</th></tr><tr><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th></tr></thead><tbody><tr><td align="left">20x</td><td char="." align="char">0.974686</td><td char="." align="char">0.953333</td><td align="left">993</td><td char="." align="char">0.978402</td><td char="." align="char">0.966126</td><td align="left">769</td><td char="." align="char">0.985003</td><td char="." align="char">0.968089</td><td align="left">648</td></tr><tr><td align="left">30x</td><td char="." align="char">0.987363</td><td char="." align="char">0.977466</td><td align="left">488</td><td char="." align="char">0.990523</td><td char="." align="char">0.983499</td><td align="left">361</td><td char="." align="char">0.993741</td><td char="." align="char">0.983717</td><td align="left">312</td></tr><tr><td align="left">40x</td><td char="." align="char">0.989344</td><td char="." align="char">0.983863</td><td align="left">373</td><td char="." align="char">0.994353</td><td char="." align="char">0.988878</td><td align="left">233</td><td char="." align="char">0.995318</td><td char="." align="char">0.987425</td><td align="left">239</td></tr><tr><td align="left">50x</td><td char="." align="char"><bold>0.991753</bold></td><td char="." align="char"><bold>0.986843</bold></td><td align="left"><bold>298</bold></td><td char="." align="char"><bold>0.995205</bold></td><td char="." align="char"><bold>0.990332</bold></td><td align="left"><bold>201</bold></td><td char="." align="char"><bold>0.996740</bold></td><td char="." align="char"><bold>0.989460</bold></td><td align="left"><bold>191</bold></td></tr></tbody></table><table-wrap-foot><p>Values in bold indicate the best operating point for each tool for the corresponding metric</p></table-wrap-foot></table-wrap><table-wrap id="Tab8"><label>Table 8</label><caption><p>SNV results for HG003 chr21-22, Illumina</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">GATK</th><th align="left" colspan="3">DeepVariant</th><th align="left" colspan="3">HELLO</th></tr><tr><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th></tr></thead><tbody><tr><td align="left">20x</td><td char="." align="char"><bold>0.991290</bold></td><td char="." align="char">0.985697</td><td align="left">1975</td><td char="." align="char">0.991890</td><td char="." align="char">0.989302</td><td align="left">1616</td><td char="." align="char">0.995664</td><td char="." align="char">0.989523</td><td align="left">1272</td></tr><tr><td align="left">30x</td><td char="." align="char">0.990683</td><td char="." align="char">0.991279</td><td align="left">1552</td><td char="." align="char">0.994724</td><td char="." align="char">0.992616</td><td align="left">1088</td><td char="." align="char">0.997117</td><td char="." align="char">0.992349</td><td align="left">905</td></tr><tr><td align="left">40x</td><td char="." align="char">0.989799</td><td char="." align="char">0.992535</td><td align="left">1522</td><td char="." align="char">0.996386</td><td char="." align="char">0.993291</td><td align="left">887</td><td char="." align="char">0.997759</td><td char="." align="char">0.992721</td><td align="left">818</td></tr><tr><td align="left">50x</td><td char="." align="char">0.989585</td><td char="." align="char"><bold>0.992988</bold></td><td align="left"><bold>1502</bold></td><td char="." align="char"><bold>0.996747</bold></td><td char="." align="char"><bold>0.993453</bold></td><td align="left"><bold>842</bold></td><td char="." align="char"><bold>0.998167</bold></td><td char="." align="char"><bold>0.993058</bold></td><td align="left"><bold>754</bold></td></tr></tbody></table><table-wrap-foot><p>Values in bold indicate the best operating point for each tool for the corresponding metric</p></table-wrap-foot></table-wrap><table-wrap id="Tab9"><label>Table 9</label><caption><p>Indel results for HG003 chr21-22, PacBio</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">GATK</th><th align="left" colspan="3">DeepVariant</th><th align="left" colspan="3">HELLO</th></tr><tr><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th></tr></thead><tbody><tr><td align="left">15x</td><td char="." align="char">0.862101</td><td char="." align="char">0.857818</td><td align="left">3903</td><td char="." align="char">0.943052</td><td char="." align="char">0.937196</td><td align="left">1666</td><td char="." align="char">0.964158</td><td char="." align="char">0.950716</td><td align="left">1179</td></tr><tr><td align="left">30x</td><td char="." align="char">0.902858</td><td char="." align="char">0.895181</td><td align="left">2812</td><td char="." align="char">0.977656</td><td char="." align="char">0.979065</td><td align="left">606</td><td char="." align="char">0.989340</td><td char="." align="char">0.986043</td><td align="left">343</td></tr><tr><td align="left">60x</td><td char="." align="char"><bold>0.909926</bold></td><td char="." align="char"><bold>0.904776</bold></td><td align="left"><bold>2585</bold></td><td char="." align="char"><bold>0.990084</bold></td><td char="." align="char"><bold>0.989460</bold></td><td align="left"><bold>286</bold></td><td char="." align="char"><bold>0.996480</bold></td><td char="." align="char"><bold>0.994912</bold></td><td align="left"><bold>120</bold></td></tr></tbody></table><table-wrap-foot><p>Values in bold indicate the best operating point for each tool for the corresponding metric</p></table-wrap-foot></table-wrap><table-wrap id="Tab10"><label>Table 10</label><caption><p>SNV results for HG003 chr21-22, PacBio</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">GATK</th><th align="left" colspan="3">DeepVariant</th><th align="left" colspan="3">HELLO</th></tr><tr><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th></tr></thead><tbody><tr><td align="left">15x</td><td char="." align="char">0.996704</td><td char="." align="char">0.984290</td><td align="left">1631</td><td char="." align="char">0.997950</td><td char="." align="char">0.989488</td><td align="left">1079</td><td char="." align="char">0.998090</td><td char="." align="char">0.989535</td><td align="left">1063</td></tr><tr><td align="left">30x</td><td char="." align="char">0.998283</td><td char="." align="char">0.993698</td><td align="left">689</td><td char="." align="char">0.998906</td><td char="." align="char">0.997105</td><td align="left">343</td><td char="." align="char">0.999558</td><td char="." align="char">0.997070</td><td align="left">290</td></tr><tr><td align="left">60x</td><td char="." align="char"><bold>0.998308</bold></td><td char="." align="char"><bold>0.994581</bold></td><td align="left"><bold>611</bold></td><td char="." align="char"><bold>0.999232</bold></td><td char="." align="char"><bold>0.997581</bold></td><td align="left"><bold>274</bold></td><td char="." align="char"><bold>0.999732</bold></td><td char="." align="char"><bold>0.997895</bold></td><td align="left"><bold>204</bold></td></tr></tbody></table><table-wrap-foot><p>Values in bold indicate the best operating point for each tool for the corresponding metric</p></table-wrap-foot></table-wrap><table-wrap id="Tab11"><label>Table 11</label><caption><p>Indel results for HG003 chr21-22, Hybrid</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">DeepVariant</th><th align="left" colspan="3">HELLO</th></tr><tr><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th></tr></thead><tbody><tr><td align="left">20 × 15x</td><td char="." align="char">0.986837</td><td char="." align="char">0.984444</td><td align="left">401</td><td char="." align="char">0.991683</td><td char="." align="char">0.989605</td><td align="left">261</td></tr><tr><td align="left">20 × 30x</td><td char="." align="char">0.988237</td><td char="." align="char">0.989823</td><td align="left">308</td><td char="." align="char">0.995143</td><td char="." align="char">0.993676</td><td align="left">156</td></tr><tr><td align="left">20 × 60x</td><td char="." align="char">0.989732</td><td char="." align="char">0.991568</td><td align="left">263</td><td char="." align="char">0.997114</td><td char="." align="char">0.995929</td><td align="left">97</td></tr><tr><td align="left">30 × 15x</td><td char="." align="char">0.992761</td><td char="." align="char">0.991059</td><td align="left">226</td><td char="." align="char">0.996052</td><td char="." align="char">0.993458</td><td align="left">146</td></tr><tr><td align="left">30 × 30x</td><td char="." align="char">0.992854</td><td char="." align="char">0.993458</td><td align="left">192</td><td char="." align="char">0.996902</td><td char="." align="char">0.995639</td><td align="left">104</td></tr><tr><td align="left">30 × 60x</td><td char="." align="char">0.992244</td><td char="." align="char">0.993821</td><td align="left">196</td><td char="." align="char"><bold>0.997958</bold></td><td char="." align="char">0.996802</td><td align="left">73</td></tr><tr><td align="left">40 × 15x</td><td char="." align="char">0.995501</td><td char="." align="char">0.993312</td><td align="left">156</td><td char="." align="char">0.996622</td><td char="." align="char">0.995202</td><td align="left">114</td></tr><tr><td align="left">40 × 30x</td><td char="." align="char">0.994741</td><td char="." align="char">0.994839</td><td align="left">146</td><td char="." align="char">0.997608</td><td char="." align="char">0.996874</td><td align="left">77</td></tr><tr><td align="left">40 × 60x</td><td char="." align="char">0.992944</td><td char="." align="char">0.994839</td><td align="left">172</td><td char="." align="char">0.997258</td><td char="." align="char">0.997165</td><td align="left">78</td></tr><tr><td align="left">50 × 15x</td><td char="." align="char">0.995572</td><td char="." align="char">0.993967</td><td align="left">146</td><td char="." align="char">0.997323</td><td char="." align="char">0.995202</td><td align="left">104</td></tr><tr><td align="left">50 × 30x</td><td char="." align="char"><bold>0.995649</bold></td><td char="." align="char"><bold>0.995348</bold></td><td align="left"><bold>126</bold></td><td char="." align="char">0.997257</td><td char="." align="char">0.996656</td><td align="left">85</td></tr><tr><td align="left">50 × 60x</td><td char="." align="char">0.993425</td><td char="." align="char"><bold>0.995348</bold></td><td align="left">158</td><td char="." align="char">0.997890</td><td char="." align="char"><bold>0.997383</bold></td><td align="left"><bold>66</bold></td></tr></tbody></table><table-wrap-foot><p>Values in bold indicate the best operating point for each tool for the corresponding metric</p></table-wrap-foot></table-wrap><table-wrap id="Tab12"><label>Table 12</label><caption><p>SNV results for HG003 chr21-22, Hybrid</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">DeepVariant</th><th align="left" colspan="3">HELLO</th></tr><tr><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th></tr></thead><tbody><tr><td align="left">20 × 15x</td><td char="." align="char">0.998487</td><td char="." align="char">0.997302</td><td align="left">362</td><td char="." align="char">0.998581</td><td char="." align="char">0.997442</td><td align="left">342</td></tr><tr><td align="left">20 × 30x</td><td char="." align="char">0.998732</td><td char="." align="char">0.997512</td><td align="left">323</td><td char="." align="char">0.998779</td><td char="." align="char">0.997802</td><td align="left">294</td></tr><tr><td align="left">20 × 60x</td><td char="." align="char">0.998709</td><td char="." align="char">0.997639</td><td align="left">314</td><td char="." align="char">0.999221</td><td char="." align="char">0.998035</td><td align="left">236</td></tr><tr><td align="left">30 × 15x</td><td char="." align="char">0.998894</td><td char="." align="char">0.997407</td><td align="left">318</td><td char="." align="char">0.998860</td><td char="." align="char">0.997570</td><td align="left">307</td></tr><tr><td align="left">30 × 30x</td><td char="." align="char"><bold>0.999104</bold></td><td char="." align="char">0.997802</td><td align="left"><bold>266</bold></td><td char="." align="char">0.998907</td><td char="." align="char">0.997837</td><td align="left">280</td></tr><tr><td align="left">30 × 60x</td><td char="." align="char">0.999011</td><td char="." align="char">0.997791</td><td align="left">275</td><td char="." align="char">0.999221</td><td char="." align="char">0.998058</td><td align="left">234</td></tr><tr><td align="left">40 × 15x</td><td char="." align="char">0.998929</td><td char="." align="char">0.997372</td><td align="left">318</td><td char="." align="char">0.998953</td><td char="." align="char">0.997523</td><td align="left">303</td></tr><tr><td align="left">40 × 30x</td><td char="." align="char">0.998976</td><td char="." align="char">0.997651</td><td align="left">290</td><td char="." align="char">0.998977</td><td char="." align="char">0.997826</td><td align="left">275</td></tr><tr><td align="left">40 × 60x</td><td char="." align="char">0.998953</td><td char="." align="char">0.997733</td><td align="left">285</td><td char="." align="char">0.999244</td><td char="." align="char">0.998023</td><td align="left">235</td></tr><tr><td align="left">50 × 15x</td><td char="." align="char">0.999011</td><td char="." align="char">0.997349</td><td align="left">313</td><td char="." align="char">0.999023</td><td char="." align="char">0.997500</td><td align="left">299</td></tr><tr><td align="left">50 × 30x</td><td char="." align="char">0.999057</td><td char="." align="char"><bold>0.997826</bold></td><td align="left">268</td><td char="." align="char">0.999128</td><td char="." align="char">0.997860</td><td align="left">259</td></tr><tr><td align="left">50 × 60x</td><td char="." align="char">0.998860</td><td char="." align="char"><bold>0.997826</bold></td><td align="left">285</td><td char="." align="char"><bold>0.999302</bold></td><td char="." align="char"><bold>0.998093</bold></td><td align="left"><bold>224</bold></td></tr></tbody></table><table-wrap-foot><p>Values in bold indicate the best operating point for each tool for the corresponding metric</p></table-wrap-foot></table-wrap><fig id="Fig4"><label>Fig. 4</label><caption><p>Excess errors in DeepVariant and GATK variant calls compared to HELLO for HG003 Illumina chr21-chr22 data. Positive values indicate better performance by HELLO over competitor. Bars reference the left y-axis and indicate differences in FP and FN counts between tool (GATK or DeepVariant) and HELLO. The line plots reference the right y-axis, and indicate the differences in total error count as a fraction of total errors of the worse performing method at each coverage point. Please refer to Fig. <xref rid="Fig1" ref-type="fig">1</xref> for additional explanation</p></caption><graphic xlink:href="12859_2021_4311_Fig4_HTML" id="MO4"/></fig><fig id="Fig5"><label>Fig. 5</label><caption><p>Excess errors in DeepVariant and GATK variant calls compared to HELLO for HG003 PacBio chr21-chr22 data. Positive values indicate better performance by HELLO over competitor. Bars reference the left y-axis and indicate differences in FP and FN counts between tool (GATK or DeepVariant) and HELLO. The line plots reference the right y-axis, and indicate the differences in total error count as a fraction of total errors of the worse performing method at each coverage point. Please refer to Fig. <xref rid="Fig1" ref-type="fig">1</xref> for additional explanation</p></caption><graphic xlink:href="12859_2021_4311_Fig5_HTML" id="MO5"/></fig><fig id="Fig6"><label>Fig. 6</label><caption><p>Excess errors in DeepVariant and GATK variant calls compared to HELLO for HG003 hybrid chr21-chr22 data. Positive values indicate better performance by HELLO over competitor. Bars reference the left y-axis and indicate differences in FP and FN counts between tool (GATK or DeepVariant) and HELLO. The line plots reference the right y-axis, and indicate the differences in total error count as a fraction of total errors of the worse performing method at each coverage point. Please refer to Fig. <xref rid="Fig1" ref-type="fig">1</xref> for additional explanation</p></caption><graphic xlink:href="12859_2021_4311_Fig6_HTML" id="MO6"/></fig></p>
        <p id="Par68">The following is a summary of the comparisons.<list list-type="bullet"><list-item><p id="Par69">For PacBio, HELLO outperforms DeepVariant and GATK in all cases.</p></list-item><list-item><p id="Par70">For Hybrid variant calling, HELLO outperforms DeepVariant in all cases except SNV calling for 30 × Illumina and 30 × PacBio reads; DeepVariant makes approximately 5% fewer errors in this case.</p></list-item><list-item><p id="Par71">For Illumina variant calling, HELLO outperforms DeepVariant and GATK in all cases except indel calling at 40 × Illumina coverage where DeepVariant makes approximately 3% fewer errors.</p></list-item></list></p>
      </sec>
      <sec id="Sec9">
        <title>GIAB HG001 whole genome variant calling</title>
        <p id="Par72">Some of the salient points of the variant calling results for HG001 are reflective of the nature of its ground-truth set and sequencing data, rather than of the variant callers themselves. In addition to having a different ground-truth set as discussed before, GIAB PacBio sequencing data available for HG002 and HG003 are from the newer chemistry 2 process from PacBio whereas for GIAB HG001, the available datasets are from chemistry 1, which indicates that the data quality of PacBio reads may also be poorer in this case. Combined, we expect improvements in Illumina variant call results, a decrease in the accuracy of PacBio results, and smaller differences between the methods in SNV calling for PacBio and hybrid variant calling.</p>
        <p id="Par73">Results for whole genome variant calling in HG001 are presented in Tables <xref rid="Tab13" ref-type="table">13</xref>, <xref rid="Tab14" ref-type="table">14</xref>, <xref rid="Tab15" ref-type="table">15</xref>, <xref rid="Tab16" ref-type="table">16</xref>, <xref rid="Tab17" ref-type="table">17</xref>, <xref rid="Tab18" ref-type="table">18</xref> and relative performances of the tools are presented in Figs. <xref rid="Fig7" ref-type="fig">7</xref>, <xref rid="Fig8" ref-type="fig">8</xref>, <xref rid="Fig9" ref-type="fig">9</xref>. All tools give higher accuracy SNV calls with Illumina rather than PacBio reads for HG001, the opposite situation compared to HG003. In addition, whereas hybrid SNV call performance was better compared to stand-alone Illumina calling in the case of HG003 for both tools at all coverage points, it is not so for HG001. This could be because of a combination of fewer challenging SNV sites for Illumina, and older PacBio sequencing data.<table-wrap id="Tab13"><label>Table 13</label><caption><p>Indel results for HG001 WGS, Illumina</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">GATK</th><th align="left" colspan="3">DeepVariant</th><th align="left" colspan="3">HELLO</th></tr><tr><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th></tr></thead><tbody><tr><td align="left">20x</td><td char="." align="char">0.975429</td><td char="." align="char">0.956826</td><td align="left">34,098</td><td char="." align="char">0.976854</td><td char="." align="char">0.968963</td><td align="left">27,455</td><td char="." align="char">0.984478</td><td char="." align="char">0.972669</td><td align="left">21,619</td></tr><tr><td align="left">30x</td><td char="." align="char"><bold>0.986186</bold></td><td char="." align="char"><bold>0.981593</bold></td><td align="left"><bold>16,367</bold></td><td char="." align="char"><bold>0.989031</bold></td><td char="." align="char"><bold>0.987899</bold></td><td align="left"><bold>11,763</bold></td><td char="." align="char"><bold>0.992588</bold></td><td char="." align="char"><bold>0.989808</bold></td><td align="left"><bold>8938</bold></td></tr></tbody></table><table-wrap-foot><p>Values in bold indicate the best operating point for each tool for the corresponding metric</p></table-wrap-foot></table-wrap><table-wrap id="Tab14"><label>Table 14</label><caption><p>SNV results for HG001 WGS, Illumina</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">GATK</th><th align="left" colspan="3">DeepVariant</th><th align="left" colspan="3">HELLO</th></tr><tr><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th></tr></thead><tbody><tr><td align="left">20x</td><td char="." align="char">0.996457</td><td char="." align="char">0.994914</td><td align="left">26,242</td><td char="." align="char">0.997263</td><td char="." align="char">0.996855</td><td align="left">17,898</td><td char="." align="char">0.998376</td><td char="." align="char">0.997280</td><td align="left">13,217</td></tr><tr><td align="left">30x</td><td char="." align="char"><bold>0.997000</bold></td><td char="." align="char"><bold>0.999002</bold></td><td align="left"><bold>12,188</bold></td><td char="." align="char"><bold>0.998809</bold></td><td char="." align="char"><bold>0.999297</bold></td><td align="left"><bold>5767</bold></td><td char="." align="char"><bold>0.999292</bold></td><td char="." align="char"><bold>0.999378</bold></td><td align="left"><bold>4048</bold></td></tr></tbody></table><table-wrap-foot><p>Values in bold indicate the best operating point for each tool for the corresponding metric</p></table-wrap-foot></table-wrap><table-wrap id="Tab15"><label>Table 15</label><caption><p>Indel results for HG001 WGS, PacBio</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">GATK</th><th align="left" colspan="3">DeepVariant</th><th align="left" colspan="3">HELLO</th></tr><tr><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th></tr></thead><tbody><tr><td align="left">15x</td><td char="." align="char">0.882206</td><td char="." align="char">0.848058</td><td align="left">134,865</td><td char="." align="char">0.951037</td><td char="." align="char">0.938379</td><td align="left">55,902</td><td char="." align="char">0.964688</td><td char="." align="char">0.950110</td><td align="left">42,985</td></tr><tr><td align="left">30x</td><td char="." align="char"><bold>0.917539</bold></td><td char="." align="char"><bold>0.887374</bold></td><td align="left"><bold>97,949</bold></td><td char="." align="char"><bold>0.979646</bold></td><td char="." align="char"><bold>0.980324</bold></td><td align="left"><bold>20,445</bold></td><td char="." align="char"><bold>0.987364</bold></td><td char="." align="char"><bold>0.986196</bold></td><td align="left"><bold>13,466</bold></td></tr></tbody></table><table-wrap-foot><p>Values in bold indicate the best operating point for each tool for the corresponding metric</p></table-wrap-foot></table-wrap><table-wrap id="Tab16"><label>Table 16</label><caption><p>SNV results for HG001 WGS, PacBio</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">GATK</th><th align="left" colspan="3">DeepVariant</th><th align="left" colspan="3">HELLO</th></tr><tr><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th></tr></thead><tbody><tr><td align="left">15x</td><td char="." align="char">0.993747</td><td char="." align="char">0.991098</td><td align="left">46,067</td><td char="." align="char">0.995494</td><td char="." align="char">0.994095</td><td align="left">31,673</td><td char="." align="char">0.995558</td><td char="." align="char">0.994285</td><td align="left">30,905</td></tr><tr><td align="left">30x</td><td char="." align="char"><bold>0.994958</bold></td><td char="." align="char"><bold>0.998203</bold></td><td align="left"><bold>20,865</bold></td><td char="." align="char"><bold>0.997091</bold></td><td char="." align="char"><bold>0.999462</bold></td><td align="left"><bold>10,520</bold></td><td char="." align="char"><bold>0.996894</bold></td><td char="." align="char"><bold>0.999524</bold></td><td align="left"><bold>10,934</bold></td></tr></tbody></table><table-wrap-foot><p>Values in bold indicate the best operating point for each tool for the corresponding metric</p></table-wrap-foot></table-wrap><table-wrap id="Tab17"><label>Table 17</label><caption><p>Indel results for HG001 WGS, Hybrid</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">DeepVariant</th><th align="left" colspan="3">HELLO</th></tr><tr><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th></tr></thead><tbody><tr><td align="left">20 × 15x</td><td char="." align="char">0.984914</td><td char="." align="char">0.986604</td><td align="left">14,582</td><td char="." align="char">0.990969</td><td char="." align="char">0.991731</td><td align="left">8840</td></tr><tr><td align="left">20 × 30x</td><td char="." align="char">0.986462</td><td char="." align="char">0.990168</td><td align="left">12,013</td><td char="." align="char">0.993106</td><td char="." align="char">0.994709</td><td align="left">6242</td></tr><tr><td align="left">30 × 15x</td><td char="." align="char"><bold>0.990535</bold></td><td char="." align="char">0.992549</td><td align="left">8676</td><td char="." align="char">0.993668</td><td char="." align="char">0.995411</td><td align="left">5598</td></tr><tr><td align="left">30 × 30x</td><td char="." align="char">0.990507</td><td char="." align="char"><bold>0.993720</bold></td><td align="left"><bold>8114</bold></td><td char="." align="char"><bold>0.994388</bold></td><td char="." align="char"><bold>0.996606</bold></td><td align="left"><bold>4627</bold></td></tr></tbody></table><table-wrap-foot><p>Values in bold indicate the best operating point for each tool for the corresponding metric</p></table-wrap-foot></table-wrap><table-wrap id="Tab18"><label>Table 18</label><caption><p>SNV results for HG001 WGS, Hybrid</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">DeepVariant</th><th align="left" colspan="3">HELLO</th></tr><tr><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th></tr></thead><tbody><tr><td align="left">20 × 15x</td><td char="." align="char">0.996889</td><td char="." align="char">0.999635</td><td align="left">10,610</td><td char="." align="char">0.996529</td><td char="." align="char">0.999816</td><td align="left">11,166</td></tr><tr><td align="left">20 × 30x</td><td char="." align="char">0.996778</td><td char="." align="char">0.999513</td><td align="left">11,320</td><td char="." align="char">0.996589</td><td char="." align="char">0.999858</td><td align="left">10,853</td></tr><tr><td align="left">30 × 15x</td><td char="." align="char"><bold>0.997409</bold></td><td char="." align="char"><bold>0.999743</bold></td><td align="left"><bold>8691</bold></td><td char="." align="char"><bold>0.996933</bold></td><td char="." align="char">0.999851</td><td align="left"><bold>9822</bold></td></tr><tr><td align="left">30 × 30x</td><td char="." align="char">0.997159</td><td char="." align="char">0.999649</td><td align="left">9738</td><td char="." align="char">0.996795</td><td char="." align="char"><bold>0.999870</bold></td><td align="left">10,188</td></tr></tbody></table><table-wrap-foot><p>Values in bold indicate the best operating point for each tool for the corresponding metric</p></table-wrap-foot></table-wrap><fig id="Fig7"><label>Fig. 7</label><caption><p>Excess errors in DeepVariant and GATK variant calls compared to HELLO for HG001 Illumina WGS data. Positive values indicate better performance by HELLO over competitor. Bars reference the left y-axis and indicate differences in FP and FN counts between tool (GATK or DeepVariant) and HELLO. The line plots reference the right y-axis, and indicate the differences in total error count as a fraction of total errors of the worse performing method at each coverage point. Please refer to Fig. <xref rid="Fig1" ref-type="fig">1</xref> for additional explanation</p></caption><graphic xlink:href="12859_2021_4311_Fig7_HTML" id="MO7"/></fig><fig id="Fig8"><label>Fig. 8</label><caption><p>Excess errors in DeepVariant and GATK variant calls compared to HELLO for HG001 PacBio WGS data. Positive values indicate better performance by HELLO over competitor. Bars reference the left y-axis and indicate differences in FP and FN counts between tool (GATK or DeepVariant) and HELLO. The line plots reference the right y-axis, and indicate the differences in total error count as a fraction of total errors of the worse performing method at each coverage point. Please refer to Fig. <xref rid="Fig1" ref-type="fig">1</xref> for additional explanation</p></caption><graphic xlink:href="12859_2021_4311_Fig8_HTML" id="MO8"/></fig><fig id="Fig9"><label>Fig. 9</label><caption><p>Excess errors in DeepVariant and GATK variant calls compared to HELLO for HG001 hybrid WGS data. Positive values indicate better performance by HELLO over competitor. Bars reference the left y-axis and indicate differences in FP and FN counts between tool (GATK or DeepVariant) and HELLO. The line plots reference the right y-axis, and indicate the differences in total error count as a fraction of total errors of the worse performing method at each coverage point. Please refer to Fig. <xref rid="Fig1" ref-type="fig">1</xref> for additional explanation</p></caption><graphic xlink:href="12859_2021_4311_Fig9_HTML" id="MO9"/></fig></p>
        <p id="Par74">Comparing the performances of the tools, the following main points may be observed:</p>
        <p id="Par75">For Illumina, HELLO makes approximately 35–45% fewer indel errors compared to GATK and 20–24% fewer indel errors compared to DeepVariant. The improvements are approximately 50–65% and 25–29% respectively for SNVs.</p>
        <p id="Par76">For PacBio, HELLO makes approximately 67–85% fewer indel errors compared to GATK and 22% to 34% fewer indel errors compared to DeepVariant. For SNVs, HELLO makes approximately 32–46% fewer errors compared to GATK. DeepVariant and HELLO perform at par for SNVs with HELLO making 2% fewer errors than DeepVariant at 15x, and DeepVariant making 4% fewer errors than HELLO at 30x.</p>
        <p id="Par77">For hybrid variant calling, HELLO makes approximately 35–48% fewer indel errors than DeepVariant. For SNVs, there is not a single winner with HELLO outperforming DeepVariant by approximately 4% in one case, and DeepVariant outperforming HELLO in other cases with the highest improvement of 12%.</p>
      </sec>
    </sec>
    <sec id="Sec10">
      <title>Other implementation considerations</title>
      <sec id="Sec11">
        <title>Execution speed, memory consumption and training time</title>
        <p id="Par78">We compared the execution time for HELLO vs DeepVariant on an Intel E5-2683 Central Processing Unit (CPU) for chromosome 21. We used PacBio 30 × coverage data and both models use haplotagged inputs. We used PacBio reads and not Illumina reads so that both pipelines are uniform in terms of input preprocessing steps. HELLO used 28 parallel threads and DeepVariant was configured to use 28 shards (tool option) which may be processed by the tool in parallel. HELLO took 1597 s on average among three runs while DeepVariant took 639 s. We also measured the peak memory and CPU utilization of the two flows over three runs. DeepVariant had a peak CPU utilization of approximately 40 threads and 14.83 GB peak memory usage, while HELLO had a peak CPU utilization of approximately 24 threads and a peak memory usage of 13.04 GB.</p>
        <p id="Par79">HELLO's flow is not optimized for speed and many software components of HELLO may be sub-optimal including reading of sequencing data, preparation of DNN inputs, and the preparation of output files. Improving these components through software engineering practices (for example, removing duplication of work between different stages, better work partitioning so CPU threads are better load-balanced, more efficient conversion of sequencing reads to DNN inputs, etc.) will be part of our future focus.</p>
        <p id="Par80">However, given the smaller DNNs in HELLO, it may be expected that HELLO's DNN runs faster than that of DeepVariant, even when a lot of engineering effort hasn't been spent on optimizing its running time. DeepVariant is divided into three separate scripts—DNN input preparation, DNN inference, and conversion of DNN inference results to variant calls, and the time taken for each stage is reported by DeepVariant. However, the standard HELLO flow is not written into separate scripts, making it difficult to compare the running time of the DNN in HELLO to the running time of the DNN in DeepVariant. To facilitate the comparison, we prepared a new flow for HELLO which operates similarly to the flow in DeepVariant. The new HELLO flow has three scripts as well—the first script prepares input data for the DNN and stores it on disk, the second script reads the DNN inputs, runs them through the DNN and writes the inference results to disk, and the third stage reads the inference results and converts them to output variant calls. It must be noted that this new flow is written for comparing DNN execution times, and for exploratory purposes of HELLO's execution speed and is not the standard HELLO flow. Using this new flow, we compared the execution times of the DNN inference stages of DeepVariant and HELLO on the same compute platform and for the same input data as described above. DeepVariant's DNN takes 338 s on average for completion over three runs, and HELLO takes 273.3 s on average for completion over three runs, indicating that the HELLO DNN is faster than the DeepVariant DNN. For this HELLO flow, we relied on PyTorch to manage the CPU utilization, and we measured a peak CPU utilization of approximately 29 threads and a peak memory usage of 18.28 GB, averaged over three runs. It may be noted that there are various aspects to these execution times and resource utilizations beyond the sole parameter counts of the two DNNs, which could include how input data is prepared for DNN consumption, DNN architectures, how the respective DNN libraries manage machine resources such as memory and CPU usage (PyTorch vs Tensorflow), and others.</p>
        <p id="Par81">Regarding training times, for PacBio data, DeepVariant took approximately 51 min to complete one epoch of training with a batch size of 256 on the Google Cloud TPU v2-8 platform (it has 8 TPUs), and HELLO took approximately 195 min with a batch size of 256 on a Power 9 machine using 2 NVIDIA V100 GPUs. Note that the two compute platforms are very different, and the training times cannot be easily compared. But this comparison provides readers an estimate of how long training the models can take.</p>
      </sec>
    </sec>
    <sec id="Sec12">
      <title>Use of GATK indel realigner</title>
      <p id="Par82">As mentioned before, we used GATK’s indel realigner to preprocess Illumina reads. This step can be avoided by implementing local haplotype assembly and readjustment of read alignments to the most prominent consensus haplotypes within HELLO. Code for doing similar operations is available open source, for example, in DeepVariant’s code repository, which does internal haplotype reassembly to preprocess Illumina reads. However, integrating such code into HELLO will require additional software engineering resources, which we could not allocate so far. We plan to make investments in this direction in the future.</p>
      <p id="Par83">In the meanwhile, it is interesting to measure the impact of not doing indel realignment on the accuracy of HELLO, since avoiding GATK-based preprocessing may be useful for certain users. Towards this goal, we ran variant calling for HG003 chr21 and chr22 without indel realignment, for both Illumina and hybrid variant calling, the two cases which can be influenced by indel realignment. Comparison of these runs to DeepVariant are given in Table <xref rid="Tab19" ref-type="table">19</xref>. HELLO seems to be robust to lack of indel realignment as it continues to perform competitively, outperforming DeepVariant in most of these cases. Note that HELLO models were trained with indel realignment and training the models without indel realignment could help further improve these accuracies.<table-wrap id="Tab19"><label>Table 19</label><caption><p>HELLO without indel realignment: results for HG003 chr21-22</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">DeepVariant</th><th align="left" colspan="3">HELLO</th></tr><tr><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Errors</th></tr></thead><tbody><tr><td align="left" colspan="7"><italic>a. Illumina indel</italic></td></tr><tr><td align="left">30x</td><td align="left">0.990523</td><td align="left">0.983499</td><td align="left">361</td><td align="left">0.992667</td><td align="left">0.981609</td><td align="left">356</td></tr><tr><td align="left" colspan="7"><italic>b. Illumina SNV</italic></td></tr><tr><td align="left">30x</td><td align="left">0.994724</td><td align="left">0.992616</td><td align="left">1088</td><td align="left">0.997012</td><td align="left">0.992349</td><td align="left">914</td></tr><tr><td align="left" colspan="7"><italic>c. Hybrid indel</italic></td></tr><tr><td align="left">20 × 15x</td><td align="left">0.988237</td><td align="left">0.989823</td><td align="left">308</td><td align="left">0.991680</td><td align="left">0.989096</td><td align="left">268</td></tr><tr><td align="left" colspan="7"><italic>d. Hybrid SNV</italic></td></tr><tr><td align="left">20 × 15x</td><td align="left">0.998732</td><td align="left">0.997512</td><td align="left">323</td><td align="left">0.998581</td><td align="left">0.997442</td><td align="left">342</td></tr></tbody></table></table-wrap></p>
    </sec>
  </sec>
  <sec id="Sec13">
    <title>Discussion</title>
    <p id="Par84">A challenge in developing Deep Learning-based methods for variant calling is the enormity of the data required for training, as well as the need for machines with high computational capacity. Models trained for variant calling, even when they are developed for a specific application such as whole-genome calling, need to account for a reasonable spectrum of use-cases such as different coverage points. While popular benchmarks in Deep Learning such as ImageNet do not explicitly check DNN efficacy under different instrument settings (e.g., performance under different levels of lighting for the same set of images), we believe similar checks (e.g., performance against different coverages) are essential in testing variant calling efficacy, since it may be difficult to shoehorn a single variant calling pipeline to operate under a fixed and specific coverage point. Coupled with this, the absence of theoretical guarantees from the Deep Learning machinery doesn’t provide the user confidence that a model works well when targeting different coverages, if such empirical benchmarking is not performed. In addition, variant calling is expected to provide high accuracy solutions compared to many other Deep Learning applications.</p>
    <p id="Par85">Covering any single use case (e.g., coverage point) may require hundreds of Gigabytes of data and hours of training on high-performance hardware. This strategy deviates from traditional approaches which encode domain assumptions necessitating very little, if any, training processes. As genome builds evolve and more difficult-to-call genomic regions become benchmarked, models will need to be trained and improved continually. Methods that perform well under current benchmark regions will need to be reevaluated in the future. Smaller and more efficient models, that have reduced parameter sizes enabled by the introduction of structure and domain assumptions into neural networks, can alleviate some such difficulties. Such models may be more easily trained for cases where procuring large amounts of ground-truth data is difficult or expensive – such as for example in the case of Whole Exome Sequencing, or building models customized to new organisms.</p>
  </sec>
  <sec id="Sec14">
    <title>Conclusions</title>
    <p id="Par86">We presented a novel DNN architecture for small variant calling that encodes the structure of the problem explicitly into the model. Specifically, we model that (i) reads are the fundamental units of sequencing data, (ii) more reads supporting the same candidate allele reinforce the confidence in the allele, and that (iii) the confidence in a candidate allele should be evaluated in relation to other candidate alleles in a simple manner. We introduce strict mathematical relations instead of heuristics to convert model predictions of allelic probabilities into variant calls, and these methods can be used for any ploidy without changing the Neural Network architecture. In experiments, we observe that our model uses 7—14 × fewer parameters than DeepVariant, yet provides variant calls with up to approximately 18 – 65% fewer indel errors across Illumina, PacBio, and hybrid variant calling scenarios.</p>
    <p id="Par87">Structurally well-suited models can provide better solutions to a problem than powerful, general purpose models. To an extent, the demands of <italic>end-to-end</italic> learning from large, monolithic models originally developed for a different, related application such as image recognition, where every aspect of the problem is learnt during training and a few aspects are explicitly coded into the DNN, can be met with very large amount of training data. However, it comes with added costs. Customized models may generalize well (i.e., offer higher accuracy on unseen examples) with a smaller amount of data, and can be advantageous where the correct inductive bias can be coded in by the tool designer.</p>
    <p id="Par88">There are clues in the design of DeepVariant that an image-recognizer may not be the most natural fit for the problem of variant calling, though it is an effective one. These hints manifest in the form of some level of input feature engineering in the DeepVariant pipeline, where (i) for short reads, the reads are sorted and ordered in alignment order and (ii) for PacBio reads, reads are haplotag sorted and aligned to reference and alternative alleles. These feature-engineering steps are aimed at making the input data more well-behaved and more easily accessible to the image processing DNN used in the tool; however, these steps appear arbitrary and the motivation behind them is not well-understood. Our goal is to build a DNN that works for the problem by encoding unmistakable assumptions that can be made about sequencing data and variant calling directly into the structure of the DNN. We also present clear motivations behind these constructions. We hope that these methods lead to improved variant calling accuracy in many use cases, as well as enable future method development for the myriad applications of variant calling.</p>
  </sec>
  <sec id="Sec15">
    <title>Methods</title>
    <p id="Par89">In a typical variant calling pipeline, sequencing data is first aligned to the reference sequence. Alignments indicate where the reads originated from during sequencing. At any site in the reference, we can infer a list of candidate alleles at that site by collecting the list of alleles implied by the reads aligned to that location. Furthermore, we can group the reads aligned to the site by the candidate alleles they imply. A local assembly and realignment of the reads may be performed before enumerating the candidate alleles so that identical alleles are not represented differently by different reads. Insufficient sequencing data can cause the true candidate allele to be missed by all sequencing reads at the site, in which case recovery of the true allele is impossible by looking at the sequencing data.</p>
    <p id="Par90">Traditional methods that probabilistically model sequencing error and read alignment to different candidate alleles have been popular [<xref ref-type="bibr" rid="CR9">9</xref>]. Here, explicit assumptions and algorithms are used that treat individual sequencing reads as fundamental data units supporting different hypotheses, leading to rules on how to combine support from multiple reads for a candidate allele, and how to evaluate the significance of evidence supporting a candidate allele. For example, one expects a candidate allele with a large proportion of sequencing reads with high base quality and high mapping quality to be a strong candidate, and such notions may be found systematized under this modeling approach.</p>
    <p id="Par91">DeepVariant follows many steps that have been followed traditionally up to a certain point. Local reassembly and realignment are performed for short reads to avoid equivocal representation of variants, and candidate alleles are listed. However, DeepVariant doesn’t explicitly model individual reads and how read support accumulates towards the evidence supporting a candidate allele. Instead pileup data at a site is converted to images with reads supporting different candidate alleles marked or colored differently. This data is then fed into a computer vision DNN, a Convolutional Neural Network (CNN), that predicts, for every non-reference candidate allele and pairs of non-reference candidate alleles, the probabilities for three possibilities – whether the site is homozygous reference, heterozygous, or homozygous alt. These predictions are used to determine scores supporting homozygous/heterozygous calls involving each non-reference candidate allele, and then additional algorithms perform ranking and selection of the top alleles at the site based on these scores. The reason to make predictions in this manner is that a standard CNN makes a fixed number of predictions, and in variant calling the number of candidate alleles and number of true alleles are not fixed. DeepVariant side-steps this discrepancy by decomposing the problem into one where a CNN predicts a fixed number of labels for each subproblem and using an algorithm to post-process these results. HELLO takes a different approach and makes probabilistic arguments to deal with this multi-allelic situation in a precise and well-reasoned manner, as described later.</p>
    <p id="Par92">DeepVariant’s overall approach largely follows the Deep Learning paradigm, in which only a few assumptions are encoded into the mathematical formulation of the problem, and the DNN’s universal function approximation property [<xref ref-type="bibr" rid="CR28">28</xref>] is leveraged to learn the necessary patterns and rules to make correct predictions by training the model using a large number of training examples. The use of a powerful DNN avoids the use of many, potentially oversimplifying, biases or assumptions, a pitfall of many traditional models. However, it may be possible to encode certain incontrovertible facts or notions about the problem into the Deep Learning machinery that reduces the learning burden of the DNN without affecting the learning efficacy of the algorithms. This approach can lead to more efficient DNN architectures offering higher accuracy solutions.</p>
    <p id="Par93">The DNN architecture in HELLO is structured with DNN elements representing fundamental data units of the problem such as reads and alleles. HELLO recognizes reads as the fundamental units of sequencing data, and the notion that reads that support the same allele reinforce the evidence for that allele. It introduces explicit operations to compare allelic evidence to the data content at a site to determine whether the allelic evidence is significant, or simply represents noise. This comparison recognizes the fact that the support for an allele should be evaluated in relation to the support for the remaining alleles at the site. Finally, HELLO uses simple formulae derived from probabilistic reasoning to produce variant calls from allelic predictions, an approach that can be easily extended to any ploidy without making any changes to the DNN architecture.</p>
    <sec id="Sec16">
      <title>DNN architecture</title>
      <p id="Par94">HELLO uses a DNN to predict the <italic>status</italic> of each candidate allele, the status being either that the candidate allele is a true allele at the site (indicating that the allele is present at the site), or a false allele (indicating that the allele is absent).</p>
      <p id="Par95">HELLO uses different DNN architectures for single-sequencing platform variant calling and dual platform hybrid variant calling. We first describe the single-platform architecture, and then describe how it is modified for the hybrid variant calling case.</p>
    </sec>
    <sec id="Sec17">
      <title>Single-platform architecture</title>
      <p id="Par96">Figures <xref rid="Fig10" ref-type="fig">10</xref>, <xref rid="Fig11" ref-type="fig">11</xref> represents the DNN architecture in HELLO for single sequencing platform analysis. HELLO’s DNN is split into three CNN stages. The input to the first stage is information of read alignments at and around the site being analyzed. How a single read alignment is encoded is indicated in Fig. <xref rid="Fig10" ref-type="fig">10</xref>. We collect both the portions of a read aligned to the site being analyzed as well as to surrounding contextual reference locations. The input representation of a read is a sequence of 6-dimensional vectors. Each vector is an encoding of the read base, the reference base, the base quality, the mapping quality of the read, the strand identity of the read, and a position flag indicating whether the vector corresponds to the genomic site that is being analyzed or whether it simply represents a position collected from the surrounding context. For the PacBio haplotag models, we include an additional dimension (not shown in figure) encoding the haplotag value.<fig id="Fig10"><label>Fig. 10</label><caption><p>Input read representation</p></caption><graphic xlink:href="12859_2021_4311_Fig10_HTML" id="MO10"/></fig><fig id="Fig11"><label>Fig. 11</label><caption><p>The architecture of HELLO</p></caption><graphic xlink:href="12859_2021_4311_Fig11_HTML" id="MO11"/></fig></p>
      <p id="Par97">Read representations are padded so that the position of the site being analyzed lines up at the center of the representation. The read representations are encoded following DeepVariant’s 8-bit encoding scheme. While it is possible to use floating point numbers or one-hot encoding, or other methods to represent some of these values, the 8-bit representation is compact.</p>
      <p id="Par98">This input representation is processed by the first stage CNN to produce feature representations of reads. The CNN performs 1-D convolutions on individual reads and produces output feature representations for each read, which we call the read-level feature. Read-level features are treated as <italic>superposable</italic>, by which we mean that adding two of these representations is expected to produce a meaningful representation (we depend on the Deep Learning machinery to learn features with such properties). Read feature representations of reads implying the same candidate allele at a site are added together and passed through a second CNN to produce allele-level feature representations. Allele-level feature representations are a summary of the evidence in support of each candidate allele at the site. The final stage CNN compares the allele-level feature for each allele <italic>j</italic> to the allele-level feature of every other candidate allele at the site and outputs the likelihood estimate that allele <italic>j</italic> is a true allele at the site. We further constrain the nature of these comparisons to a specific format that reduces the number of parameters and computations needed. This strategy is described in detail below.</p>
      <p id="Par99">Let <inline-formula id="IEq1"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{i}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq1.gif"/></alternatives></inline-formula> be the input representation of the <italic>i</italic>th read. Let <inline-formula id="IEq2"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{i}$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq2.gif"/></alternatives></inline-formula> be the read feature representation of the <italic>i</italic>th read. Let <inline-formula id="IEq3"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_{j}$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mi>A</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq3.gif"/></alternatives></inline-formula> be the allele-level representation for the <italic>j</italic>th allele, and <inline-formula id="IEq4"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{j}$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq4.gif"/></alternatives></inline-formula> represent the set of reads supporting allele <italic>j</italic>. Let <inline-formula id="IEq5"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$CNN_{1} , CNN_{2} , CNN_{3}$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mi>C</mml:mi><mml:mi>N</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mi>N</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mi>N</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq5.gif"/></alternatives></inline-formula> be the three CNNs in HELLO. Let <inline-formula id="IEq6"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><mml:math id="M26"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq6.gif"/></alternatives></inline-formula> represent the sequencing data at the site including the candidate allele list, and the reads supporting each candidate allele, as well as the reference context. We also define a term, <inline-formula id="IEq7"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M = \mathop \sum \limits_{j} A_{j}$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:msub><mml:mi>A</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq7.gif"/></alternatives></inline-formula>, which pools together the evidence from all alleles. <inline-formula id="IEq8"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M$$\end{document}</tex-math><mml:math id="M30"><mml:mi>M</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq8.gif"/></alternatives></inline-formula> is a representation produced from all the data at a site, thus we call it, the site-level feature. Then, we have the following mathematical relationships for the HELLO architecture.
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{i} = CNN_{1} \left( {R_{i} } \right)$$\end{document}</tex-math><mml:math id="M32" display="block"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mi>N</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2021_4311_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_{j} = CNN_{2} \left(\mathop \sum \limits_{{k \in S_{j} }} f_{k}\right )$$\end{document}</tex-math><mml:math id="M34" display="block"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mi>N</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mi>f</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2021_4311_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left[ {allele\, j\, is\, True|D} \right] = p_{j} = CNN_{3} (A_{j} - \mathop \sum \limits_{k \ne j} A_{k} ) = CNN_{3} \left( {2A_{j} - \mathop \sum \limits_{k} A_{k} } \right) = CNN_{3} \left( {2A_{j} - M} \right)$$\end{document}</tex-math><mml:math id="M36" display="block"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.166667em"/><mml:mi>j</mml:mi><mml:mspace width="0.166667em"/><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.166667em"/><mml:mi>T</mml:mi><mml:mi>r</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mi>N</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mi>N</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>A</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mi>N</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>A</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2021_4311_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par100">Equation <xref rid="Equ3" ref-type="">3</xref> indicates the specific type of computations that are used to compare the allelic evidence for one allele to the allelic evidence of all other alleles. That is, an allele’s evidence is judged to be significant only in relation to the evidence presented by all other alleles.</p>
      <p id="Par101">The architecture explicitly defines how alleles are inferred from reads, and how alleles should be compared amongst each other. Enforcing simple mathematical relationships between the basic elements of the problem here induces the relational inductive biases inherent to the problem of variant calling, and limits the DNN to learning feature representations from a subset of feature representations that are meaningful for the problem, rather than a space of possible representations that generally apply to a different class of problems such as, say, image processing problems.</p>
      <p id="Par102">In other words, limiting allelic comparisons to be performed through subtractions in this manner, as well as causing allelic representations to derive from read level representations through superpositions encourages the DNN to search within a solution-space that conforms to certain notions such as (i) more reads supporting a candidate allele result in higher confidence in that candidate allele (ii) the confidence in a candidate allele can be determined only in a <italic>simple relative sense</italic> with respect to the remaining candidate alleles at the site. As a technical aside, note that for <inline-formula id="IEq9"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M38"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq9.gif"/></alternatives></inline-formula> candidate alleles, this requires only <inline-formula id="IEq10"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M40"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq10.gif"/></alternatives></inline-formula> invocations of <inline-formula id="IEq11"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$CNN_{3}$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mi>C</mml:mi><mml:mi>N</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq11.gif"/></alternatives></inline-formula> instead of <inline-formula id="IEq12"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O\left( {\left( {\begin{array}{*{20}c} n \\ 2 \\ \end{array} } \right)} \right)$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:mi>O</mml:mi><mml:mfenced close=")" open="("><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq12.gif"/></alternatives></inline-formula> invocations that would be necessary for a pairwise comparison for all candidates.</p>
      <p id="Par103">After the CNN computations are performed, we have <inline-formula id="IEq13"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M46"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq13.gif"/></alternatives></inline-formula> values, <inline-formula id="IEq14"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{j} , 1 \le j \le n,$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq14.gif"/></alternatives></inline-formula> for <inline-formula id="IEq15"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M50"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq15.gif"/></alternatives></inline-formula> candidate alleles. As indicated in Eq. <xref rid="Equ3" ref-type="">3</xref>, <inline-formula id="IEq16"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{j}$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq16.gif"/></alternatives></inline-formula> represents the probability of allele <italic>j</italic> being a true allele at the site, which we model to be conditionally independent of the status (true/false) of another allele, given <inline-formula id="IEq17"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><mml:math id="M54"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq17.gif"/></alternatives></inline-formula>. This gives us the following probabilistic formulation where an outcome, <inline-formula id="IEq18"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E$$\end{document}</tex-math><mml:math id="M56"><mml:mi>E</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq18.gif"/></alternatives></inline-formula>, is an <italic>n-</italic>tuple of values <inline-formula id="IEq19"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_{j} \in \left\{ {True,False} \right\}, 1 \le j \le n$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mi>T</mml:mi><mml:mi>r</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mo>,</mml:mo><mml:mi>F</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq19.gif"/></alternatives></inline-formula>. <inline-formula id="IEq20"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_{j}$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mi>e</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq20.gif"/></alternatives></inline-formula> indicates the status of candidate allele <italic>j</italic>. The log-likelihood of the outcome, <inline-formula id="IEq21"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E$$\end{document}</tex-math><mml:math id="M62"><mml:mi>E</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq21.gif"/></alternatives></inline-formula>, is hence given as follows. Here, <inline-formula id="IEq22"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1_{v}$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mn>1</mml:mn><mml:mi>v</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq22.gif"/></alternatives></inline-formula> is the indicator function which takes the value 1 when the Boolean variable, <inline-formula id="IEq23"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v,$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq23.gif"/></alternatives></inline-formula> is <inline-formula id="IEq24"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$True$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mi mathvariant="italic">True</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq24.gif"/></alternatives></inline-formula>, and takes the value <inline-formula id="IEq25"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq25.gif"/></alternatives></inline-formula> otherwise.<disp-formula id="Equa"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\log P\left( {E{|}D} \right) = \mathop \sum \limits_{j = 1}^{n} {\text{log}}(1_{{e_{j} }} p_{j} + 1_{{\overline{e}_{j} }} (1 - p_{j} ))$$\end{document}</tex-math><mml:math id="M72" display="block"><mml:mrow><mml:mo>log</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mtext>log</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mn>1</mml:mn><mml:msub><mml:mi>e</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mn>1</mml:mn><mml:msub><mml:mover><mml:mi>e</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="12859_2021_4311_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par104">Ploidy of 2 requires the additional assumption that we only look at a subset of the event-space where either one allele has a true status or two alleles have true statuses, and the remaining have false statuses (assuming the true allele is never missed by sequencing reads). Denoting the set of such events as <inline-formula id="IEq26"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Omega }_{2}$$\end{document}</tex-math><mml:math id="M74"><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq26.gif"/></alternatives></inline-formula>, we have for each <inline-formula id="IEq27"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E \in \Omega _{2}$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mi>E</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq27.gif"/></alternatives></inline-formula>,<disp-formula id="Equb"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\log P\left( {E{|}D,ploidy = 2} \right) = \log P\left( {E{|}D} \right) - \log \mathop \sum \limits_{{E^{\prime} \in {\Omega }_{2} }} P\left( {E^{\prime}{|}D} \right)$$\end{document}</tex-math><mml:math id="M78" display="block"><mml:mrow><mml:mo>log</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mo>log</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msup><mml:mi>E</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mi>E</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">|</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2021_4311_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par105">Any event <inline-formula id="IEq28"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E \in {\Omega }_{2}$$\end{document}</tex-math><mml:math id="M80"><mml:mrow><mml:mi>E</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq28.gif"/></alternatives></inline-formula> corresponds to a valid variant call for ploidy = 2. We wish to pick the best event, or the event with the best log-likelihood from this set and determine the corresponding set <inline-formula id="IEq29"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V$$\end{document}</tex-math><mml:math id="M82"><mml:mi>V</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq29.gif"/></alternatives></inline-formula> of true alleles at the site. This selection may be done based on the following equations.<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E^{*} = argmax_{{E \in {\Omega }_{2} }} {\text{log P}}\left( {E{|}D,ploidy = 2} \right) = argmax_{{E \in {\Omega }_{2} }} \log P(E|D)$$\end{document}</tex-math><mml:math id="M84" display="block"><mml:mrow><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mtext>log P</mml:mtext></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="12859_2021_4311_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V = \{i {|} e_{i}^{*} is True\}$$\end{document}</tex-math><mml:math id="M86" display="block"><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>T</mml:mi><mml:mi>r</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2021_4311_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par106">Equations <xref rid="Equ4" ref-type="">4</xref> and <xref rid="Equ5" ref-type="">5</xref> are fairly easy to compute by looping through the set <inline-formula id="IEq30"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Omega }_{2}$$\end{document}</tex-math><mml:math id="M88"><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq30.gif"/></alternatives></inline-formula>. Once V is determined, HELLO converts it to variant records. If V is a singleton set, HELLO treats the site as homozygous, and if not, it treats the site as heterozygous and prints appropriate VCF records reflecting these determinations.</p>
    </sec>
    <sec id="Sec18">
      <title>Dual-platform (hybrid) architecture</title>
      <p id="Par107">The DNN architecture for calling variants from dual sequencing platforms is derived from the architecture presented earlier for the single sequencing platform. We use two copies of <inline-formula id="IEq31"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$CNN_{1}$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:mi>C</mml:mi><mml:mi>N</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq31.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq32"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$CNN_{2}$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:mi>C</mml:mi><mml:mi>N</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq32.gif"/></alternatives></inline-formula> each in the hybrid architecture corresponding to each sequencing platform. CNNs processing Illumina sequencing reads are labeled <inline-formula id="IEq33"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$CNN_{1}^{I} , CNN_{2}^{I}$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:mi>C</mml:mi><mml:mi>N</mml:mi><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mi>I</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mi>N</mml:mi><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mi>I</mml:mi></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq33.gif"/></alternatives></inline-formula> and CNNs processing the PacBio sequencing reads are labeled <inline-formula id="IEq34"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$CNN_{1}^{P} , CNN_{2}^{P}$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:mi>C</mml:mi><mml:mi>N</mml:mi><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mi>P</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mi>N</mml:mi><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mi>P</mml:mi></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq34.gif"/></alternatives></inline-formula>. The allelic features for allele <italic>j</italic> output from <inline-formula id="IEq35"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$CNN_{2}^{P}$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:mi>C</mml:mi><mml:mi>N</mml:mi><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mi>P</mml:mi></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq35.gif"/></alternatives></inline-formula> is labeled <inline-formula id="IEq36"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_{j}^{P}$$\end{document}</tex-math><mml:math id="M100"><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq36.gif"/></alternatives></inline-formula> and the allelic features output from <inline-formula id="IEq37"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$CNN_{2}^{I}$$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:mi>C</mml:mi><mml:mi>N</mml:mi><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mi>I</mml:mi></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq37.gif"/></alternatives></inline-formula> is labeled <inline-formula id="IEq38"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_{j}^{I}$$\end{document}</tex-math><mml:math id="M104"><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mi>I</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq38.gif"/></alternatives></inline-formula>. Similarly, the corresponding site-level features are <inline-formula id="IEq39"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M^{P}$$\end{document}</tex-math><mml:math id="M106"><mml:msup><mml:mi>M</mml:mi><mml:mi>P</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq39.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq40"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M^{I}$$\end{document}</tex-math><mml:math id="M108"><mml:msup><mml:mi>M</mml:mi><mml:mi>I</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq40.gif"/></alternatives></inline-formula> respectively. To make allele-level predictions as in Eq. <xref rid="Equ3" ref-type="">3</xref>, we need to consider allele and site-level features from both platforms. Towards this purpose, we create hybrid versions of both features as follows. Here, <inline-formula id="IEq41"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {a,b} \right)$$\end{document}</tex-math><mml:math id="M110"><mml:mfenced close=")" open="("><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq41.gif"/></alternatives></inline-formula> represents the concatenation operation along the channel dimension.<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_{j}^{hybrid} = CNN_{4} \left( {\left( {A_{j}^{I} ,A_{j}^{P} } \right)} \right)$$\end{document}</tex-math><mml:math id="M112" display="block"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">hybrid</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mi>N</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mi>I</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msubsup></mml:mrow></mml:mfenced></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2021_4311_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M^{hybrid} = CNN_{5} \left( {\left( {M^{I} ,M^{P} } \right)} \right)$$\end{document}</tex-math><mml:math id="M114" display="block"><mml:mrow><mml:msup><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">hybrid</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mi>N</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mi>M</mml:mi><mml:mi>I</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>M</mml:mi><mml:mi>P</mml:mi></mml:msup></mml:mrow></mml:mfenced></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2021_4311_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{j} = CNN_{3} \left( {2A^{hybrid} - M^{hybrid} } \right)$$\end{document}</tex-math><mml:math id="M116" display="block"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mi>N</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mi mathvariant="italic">hybrid</mml:mi></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">hybrid</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2021_4311_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par108"><inline-formula id="IEq42"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$CNN_{4}$$\end{document}</tex-math><mml:math id="M118"><mml:mrow><mml:mi>C</mml:mi><mml:mi>N</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq42.gif"/></alternatives></inline-formula> and <inline-formula id="IEq43"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$CNN_{5}$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:mi>C</mml:mi><mml:mi>N</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4311_Article_IEq43.gif"/></alternatives></inline-formula> are small two-layer networks which take two feature-maps, concatenate them along the channel dimension, and mix them together. We constructed these CNNs in such a manner that the output feature size is the same as the feature size of one of the inputs. Given the hybrid features, we can now rewrite Eq. <xref rid="Equ3" ref-type="">3</xref> using hybrid allele and site-level features instead of single-platform features as shown in Eq. <xref rid="Equ8" ref-type="">8</xref> and then proceed to perform variant calls using Eqs. <xref rid="Equ4" ref-type="">4</xref> and <xref rid="Equ5" ref-type="">5</xref>.</p>
    </sec>
    <sec id="Sec19">
      <title>Details of DNN construction</title>
      <p id="Par109">The CNNs in HELLO use standalone convolutional layers and Residual Blocks [<xref ref-type="bibr" rid="CR29">29</xref>] which form the bulk of the model. Residual Blocks use skip connections across multiple convolutional layers. In HELLO, skip connections are used over pairs of convolutional layers. We use rectified linear units as neuronal activations. We apply weight normalization [<xref ref-type="bibr" rid="CR30">30</xref>] to the DNN layers in HELLO, in favor of the more popular Batch Normalization [<xref ref-type="bibr" rid="CR31">31</xref>]. Batch Normalization estimates mean and variance statistics of the dataset from running mean and running variance of the layer input batches. In HELLO, the batches may have varying sizes because different sites may have different numbers of reads and candidate alleles because of the nature of sequencing data and hence these estimates may not be sufficiently accurate. Detailed architectural diagrams are provided in the Additional file <xref rid="MOESM1" ref-type="media">1</xref> (Figures S1 – S3).</p>
    </sec>
    <sec id="Sec20">
      <title>Variant calling pipeline</title>
      <p id="Par110">The DNN we described above is embedded into HELLO’s variant calling pipeline which consists of multiple steps. We describe these steps below.</p>
    </sec>
    <sec id="Sec21">
      <title>Indel Realignment for short reads</title>
      <p id="Par111">Short reads aligned independently can represent the same indel deviations from the reference in different ways. In addition, soft clipping can cause some legitimate insertions to be discarded from the aligned section of a read. To circumvent such issues, we realign Illumina reads using GATK 3.8.1’s indel realignment algorithm where reads are locally reassembled and realigned to produce consensus indels. This step is not performed for PacBio reads.</p>
    </sec>
    <sec id="Sec22">
      <title>Determining hotspots</title>
      <p id="Par112">Input alignment files (after realignment) are analyzed to determine for each reference position, the number of read bases in support of the reference bases as well as in support of each non-reference candidate allele. If any non-reference candidate allele has support from a sufficient fraction of reads aligning to the site, the site is determined to be a hotspot and is analyzed using the DNN. For the hybrid variant calling case, we prepare separate hotspots from the two sets of sequencing data from the two sequencing platforms and use the union of the two sets.</p>
    </sec>
    <sec id="Sec23">
      <title>Variant calling</title>
      <p id="Par113">For each hotspot location, we extract all candidate alleles and group the reads according to the candidate alleles they support. We construct input read representations for each read supporting each candidate allele. The input representations are sequences of 1-D sequences of length 150 and dimensionality six (seven for PacBio haplotagged reads) and padded such that the site of interest is at the center of the vectors, as described before. These input representations are fed to HELLO’s DNN architecture and variant calling proceeds according to Eq. 1 to Eq. <xref rid="Equ8" ref-type="">8</xref>. HELLO uses GNU parallel [<xref ref-type="bibr" rid="CR32">32</xref>] to launch analysis of multiple hotspots in parallel.</p>
    </sec>
    <sec id="Sec24">
      <title>Preparing training data</title>
      <p id="Par114">Training data preparation for HELLO follows many of the same steps as for variant calling starting with indel realignment and hotspot detection. In the next step, we prepare candidate alleles scanning reads at hotspots, and prepare input data for the DNN. However, since this process is for preparation of data for the training process, the data is not fed into a DNN and instead we have a different step, which is to label the candidate alleles as true or false alleles. To do so, HELLO accepts labeled ground-truth variants and high-confidence regions. Any candidate hotspots outside the high-confidence regions provided as part of the ground-truth set are discarded. Within the high-confidence regions, we label those candidate alleles as true alleles which match the descriptions in the ground-truth variants file. This labeling method is not straight-forward because the allelic representations in the ground-truth variants file may differ from the representation of candidate alleles as inferred by HELLO even when they are identical. To resolve this problem, we group hotspot locations which are nearby and collect all ground-truth variants at or near these locations constructing candidate ground-truth haplotype-pairs for the region. We then search for these haplotype pairs in a prefix-tree induced by the candidate alleles and the surrounding reference segment to locate the true alleles among the candidate alleles inferred by HELLO. The selected candidate alleles are labeled true, and the remaining candidate alleles are labeled false. The details of this algorithm may be seen in our source code and, except perhaps for the prefix-tree-based search implementation, is similar to methods developed elsewhere [<xref ref-type="bibr" rid="CR10">10</xref>]. The labeled candidate alleles and corresponding read sequence representations are written to disk and are then used to initiate a training process.</p>
    </sec>
  </sec>
  <sec id="Sec25">
    <title>Availability and requirements</title>
    <p id="Par115"><bold>Project name:</bold> HELLO.</p>
    <p id="Par116">
      <bold>Project homepage:</bold>
      <ext-link ext-link-type="uri" xlink:href="https://github.com/anands-repo/hello">https://github.com/anands-repo/hello</ext-link>
    </p>
    <p id="Par117"><bold>Operating system:</bold> Linux.</p>
    <p id="Par118"><bold>Programming Languages:</bold> Python, C +  + </p>
    <p id="Par119"><bold>Other requirements:</bold> Other software requirements provided in Docker image at <ext-link ext-link-type="uri" xlink:href="https://hub.docker.com/r/oddjobs/hello_image.x86_64">https://hub.docker.com/r/oddjobs/hello_image.x86_64</ext-link></p>
    <p id="Par120"><bold>License:</bold> MIT.</p>
    <p id="Par121"><bold>Restrictions for use by non-academics:</bold> Free to use.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec26">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2021_4311_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold>. The supplementary file provides details of steps followed in performing experiments, additional results, and additional information regarding the DNN architecture in HELLO</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>Indels</term>
        <def>
          <p id="Par4">Insertions and deletions</p>
        </def>
      </def-item>
      <def-item>
        <term>NGS</term>
        <def>
          <p id="Par5">Next generation sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>TGS</term>
        <def>
          <p id="Par6">Third generation sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>CCS</term>
        <def>
          <p id="Par7">Circular consensus sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>HMM</term>
        <def>
          <p id="Par8">Hidden Markov model</p>
        </def>
      </def-item>
      <def-item>
        <term>DNN</term>
        <def>
          <p id="Par9">Deep neural network</p>
        </def>
      </def-item>
      <def-item>
        <term>SNV</term>
        <def>
          <p id="Par10">Single nucleotide variant</p>
        </def>
      </def-item>
      <def-item>
        <term>HELLO</term>
        <def>
          <p id="Par11">Hybrid and stand-alone estimation of small genomic variants</p>
        </def>
      </def-item>
      <def-item>
        <term>GIAB</term>
        <def>
          <p id="Par12">Genome-in-a-bottle</p>
        </def>
      </def-item>
      <def-item>
        <term>GATK</term>
        <def>
          <p id="Par13">Genome analysis toolkit</p>
        </def>
      </def-item>
      <def-item>
        <term>TPU</term>
        <def>
          <p id="Par14">Tensor processing unit</p>
        </def>
      </def-item>
      <def-item>
        <term>GPU</term>
        <def>
          <p id="Par15">Graphics processing unit</p>
        </def>
      </def-item>
      <def-item>
        <term>BAM</term>
        <def>
          <p id="Par16">Binary alignment map</p>
        </def>
      </def-item>
      <def-item>
        <term>BWA</term>
        <def>
          <p id="Par17">Burrows-wheeler aligner</p>
        </def>
      </def-item>
      <def-item>
        <term>VCF</term>
        <def>
          <p id="Par18">Variant call format</p>
        </def>
      </def-item>
      <def-item>
        <term>BQSR</term>
        <def>
          <p id="Par19">Base quality score recalibration</p>
        </def>
      </def-item>
      <def-item>
        <term>SNP</term>
        <def>
          <p id="Par20">Single nucleotide polymorphism</p>
        </def>
      </def-item>
      <def-item>
        <term>FN</term>
        <def>
          <p id="Par21">False negative</p>
        </def>
      </def-item>
      <def-item>
        <term>FP</term>
        <def>
          <p id="Par22">False positive</p>
        </def>
      </def-item>
      <def-item>
        <term>CPU</term>
        <def>
          <p id="Par23">Central processing unit</p>
        </def>
      </def-item>
      <def-item>
        <term>WGS</term>
        <def>
          <p id="Par24">Whole genome sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>CNN</term>
        <def>
          <p id="Par25">Convolutional neural network</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Work done before joining Amazon</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Prof. Ravishankar K. Iyer and the University of Illinois-led Center for Computational Biotechnology and Genomic Medicine for continued support throughout the project. We also thank Kiran Koshy Thekumparambil for valuable inputs during the project.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors' contributions</title>
    <p>AR designed the DNNs, wrote the software and scripts used in this study, and ran the experiments. SSL and EK contributed to the conception of the variant calling pipeline, designing the experiments and the analysis of variant caller results. DC directed all aspects of the project from concept, to design, to engineering to experimentation. All authors have read and approved the final version of the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This material is based upon work supported by the National Science Foundation (NSF) under Grant Nos. CNS 1624790, and CNS 1337732. This work also utilizes resources supported by the National Science Foundation’s Major Research Instrumentation program, grant #1725729 [<xref ref-type="bibr" rid="CR33">33</xref>], as well as the University of Illinois at Urbana-Champaign. Any opinions, findings, and conclusions or recommendations expressed in this material are those of the author(s) and do not necessarily reflect the views of the National Science Foundation. The funding entities did not participate in the design of the study, or collection, analysis and interpretation of data, or in preparing or editing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>All experiments in this paper use GIAB data, which are available publicly at <ext-link ext-link-type="uri" xlink:href="ftp://ftp-trace.ncbi.nlm.nih.gov/ReferenceSamples/giab/data">ftp://ftp-trace.ncbi.nlm.nih.gov/ReferenceSamples/giab/data</ext-link><underline>.</underline> The GRCh38 reference genome is used as standard reference sequence for alignments, and may be found at the following link <ext-link ext-link-type="uri" xlink:href="ftp://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/000/001/405/GCA_000001405.15_GRCh38/seqs_for_alignment_pipelines.ucsc_ids/GCA_000001405.15_GRCh38_no_alt_plus_hs38d1_analysis_set.fna.gz">ftp://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/000/001/405/GCA_000001405.15_GRCh38/seqs_for_alignment_pipelines.ucsc_ids/GCA_000001405.15_GRCh38_no_alt_plus_hs38d1_analysis_set.fna.gz</ext-link><underline>.</underline> The ground-truth variants used this paper are downloaded from <ext-link ext-link-type="uri" xlink:href="ftp://ftp.ncbi.nlm.nih.gov/giab/ftp/data/AshkenazimTrio/analysis">ftp://ftp.ncbi.nlm.nih.gov/giab/ftp/data/AshkenazimTrio/analysis</ext-link>, <ext-link ext-link-type="uri" xlink:href="ftp://ftp-trace.ncbi.nlm.nih.gov/ReferenceSamples/giab/data/AshkenazimTrio/">ftp://ftp-trace.ncbi.nlm.nih.gov/ReferenceSamples/giab/data/AshkenazimTrio/</ext-link>, and <ext-link ext-link-type="uri" xlink:href="https://ftp-trace.ncbi.nlm.nih.gov/ReferenceSamples/giab/release/NA12878_HG001/">https://ftp-trace.ncbi.nlm.nih.gov/ReferenceSamples/giab/release/NA12878_HG001/</ext-link>, How this data is processed for different variant calling pipelines is described in the Additional file <xref rid="MOESM1" ref-type="media">1</xref> in detail.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par122">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication.</title>
      <p id="Par123">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par124">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bamshad</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Bigham</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Tabor</surname>
            <given-names>HK</given-names>
          </name>
          <name>
            <surname>Emond</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Nickerson</surname>
            <given-names>DA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Exome sequencing as a tool for Mendelian disease gene discovery</article-title>
        <source>Nat Rev Genet</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>11</issue>
        <fpage>745</fpage>
        <lpage>755</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3031</pub-id>
        <pub-id pub-id-type="pmid">21946919</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">Dai J, Huang M, Amos CI, Hung RJ, Tardon A, Andrew A, et al. Genome-wide association study of INDELs identified four novel susceptibility loci associated with lung cancer risk. International Journal of Cancer. 2019.</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deng</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Single nucleotide polymorphisms and cancer susceptibility</article-title>
        <source>Oncotarget</source>
        <year>2017</year>
        <volume>8</volume>
        <issue>66</issue>
        <fpage>110635</fpage>
        <lpage>110649</lpage>
        <pub-id pub-id-type="doi">10.18632/oncotarget.22372</pub-id>
        <pub-id pub-id-type="pmid">29299175</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Zeng</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide genetic changes during modern breeding of maize</article-title>
        <source>Nat Genet</source>
        <year>2012</year>
        <volume>44</volume>
        <issue>7</issue>
        <fpage>812</fpage>
        <lpage>815</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.2312</pub-id>
        <pub-id pub-id-type="pmid">22660547</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Auton</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Brooks</surname>
            <given-names>LD</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Garrison</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>Kang</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>Korbel</surname>
            <given-names>JO</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A global reference for human genetic variation</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>526</volume>
        <issue>7571</issue>
        <fpage>68</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1038/nature15393</pub-id>
        <pub-id pub-id-type="pmid">26432245</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Hoffmann S, Otto C, Kurtz S, Sharma CM, Khaitovich P, Vogel J, et al. Fast Mapping of Short Sequences with Mismatches, Insertions and Deletions Using Index Structures. PLOS Computational Biology. 2009; 5(9).</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Schatz</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>Genomic dark matter</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>16</issue>
        <fpage>2097</fpage>
        <lpage>2105</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts330</pub-id>
        <pub-id pub-id-type="pmid">22668792</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wenger</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Peluso</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Rowell</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Concepcion</surname>
            <given-names>GT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accurate circular consensus long-read sequencing improves variant detection and assembly of a human genome</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <issue>10</issue>
        <fpage>1155</fpage>
        <lpage>1162</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0217-9</pub-id>
        <pub-id pub-id-type="pmid">31406327</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DePristo</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Banks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Poplin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Garimella</surname>
            <given-names>KV</given-names>
          </name>
          <name>
            <surname>Maguire</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Hartl</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title>
        <source>Nat Genet</source>
        <year>2011</year>
        <volume>43</volume>
        <issue>5</issue>
        <fpage>491</fpage>
        <lpage>498</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.806</pub-id>
        <pub-id pub-id-type="pmid">21478889</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Poplin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Alexander</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schwartz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Colthurst</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ku</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A universal SNP and small-indel variant caller using deep neural networks</article-title>
        <source>Nat Biotechnol</source>
        <year>2018</year>
        <volume>36</volume>
        <issue>10</issue>
        <fpage>983</fpage>
        <lpage>987</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4235</pub-id>
        <pub-id pub-id-type="pmid">30247488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sedlazeck</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>TW</given-names>
          </name>
          <name>
            <surname>Schatz</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>A multi-task convolutional deep neural network for variant calling in single molecule sequencing</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>998</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-09025-z</pub-id>
        <pub-id pub-id-type="pmid">30824707</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Wagner J, Olson ND, Harris L, Khan Z, Farek J, Mahmoud M, et al. Benchmarking challenging small variants with linked and long reads. bioRxiv. 2020.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krizhevsky</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sutskever</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Hinton</surname>
            <given-names>GE</given-names>
          </name>
        </person-group>
        <article-title>ImageNet classification with deep convolutional neural networks</article-title>
        <source>Commun ACM</source>
        <year>2017</year>
        <volume>60</volume>
        <issue>6</issue>
        <fpage>84</fpage>
        <lpage>90</lpage>
        <pub-id pub-id-type="doi">10.1145/3065386</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Battaglia PW, Hamrick JB, Bapst V, Sanchez-Gonzalez A, Zambaldi VF, Malinowski M, et al. Relational inductive biases, deep learning, and graph networks. arXiv preprint <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1806.01261">https://arxiv.org/abs/1806.01261</ext-link>. 2018.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">NIST. Genome in a Bottle. [Online].; 2012. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.nist.gov/programs-projects/genome-bottle">https://www.nist.gov/programs-projects/genome-bottle</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Zook JM, McDaniel J, Olson ND, Wagner J, Parikh H, Heaton H, et al. An open resource for accurately benchmarking small variant and reference calls. Nature Biotechnology. 2019;: 561–566.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Google. Deepvariant Docker page. [Online]. [cited 2021. Available from: <ext-link ext-link-type="uri" xlink:href="https://hub.docker.com/r/google/deepvariant">https://hub.docker.com/r/google/deepvariant</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Broad Institute. [Online]. [cited 2021. Available from: <ext-link ext-link-type="uri" xlink:href="https://hub.docker.com/r/broadinstitute/gatk">https://hub.docker.com/r/broadinstitute/gatk</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>14</issue>
        <fpage>1754</fpage>
        <lpage>1760</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp324</pub-id>
        <pub-id pub-id-type="pmid">19451168</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Martin M, Patterson , (Shilpa) SG, Fischer S, Pisanti N, Klau GW, et al. WhatsHap: fast and accurate read-based phasing. bioRxiv. 2016;: 85050.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Handsaker</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wysoker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Homer</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Sequence Alignment/Map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>16</issue>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Broadinstitute. Picard tools. [Online].; 2020. Available from: <ext-link ext-link-type="uri" xlink:href="http://broadinstitute.github.io/picard/">http://broadinstitute.github.io/picard/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krusche</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Trigg</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Boutros</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Mason</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Vega</surname>
            <given-names>FMDL</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>BL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Best practices for benchmarking germline small-variant calls in human genomes</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <issue>5</issue>
        <fpage>555</fpage>
        <lpage>560</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0054-x</pub-id>
        <pub-id pub-id-type="pmid">30858580</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Broad-Institute. Germline short variant discovery. [Online].; 2020. Available from: <ext-link ext-link-type="uri" xlink:href="https://gatk.broadinstitute.org/hc/en-us/articles/360035535932-Germline-short-variant-discovery-SNPs-Indels">https://gatk.broadinstitute.org/hc/en-us/articles/360035535932-Germline-short-variant-discovery-SNPs-Indels</ext-link><underline>-</underline>.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">Pacific-Biosciences. pbmm2 aligner for long reads. [Online].; 2020. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/PacificBiosciences/pbmm2">https://github.com/PacificBiosciences/pbmm2</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>18</issue>
        <fpage>3094</fpage>
        <lpage>3100</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty191</pub-id>
        <pub-id pub-id-type="pmid">29750242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fan</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Chaisson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nakhleh</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>HySA: a Hybrid Structural variant Assembly approach using next-generation and single-molecule sequencing technologies</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <issue>5</issue>
        <fpage>793</fpage>
        <lpage>800</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.214767.116</pub-id>
        <pub-id pub-id-type="pmid">28104618</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hornik</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Stinchcombe</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Multilayer feedforward networks are universal approximators</article-title>
        <source>Neural Netw</source>
        <year>1989</year>
        <volume>2</volume>
        <issue>5</issue>
        <fpage>359</fpage>
        <lpage>366</lpage>
        <pub-id pub-id-type="doi">10.1016/0893-6080(89)90020-8</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">He K, Zhang X, Ren S, Sun J. Deep Residual Learning for Image Recognition. In 2016 IEEE Conference on Computer Vision and Pattern Recognition (CVPR); 2016. p. 770–778.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Salimans T, Kingma DP. Weight normalization: a simple reparameterization to accelerate training of deep neural networks. In NIPS'16 Proceedings of the 30th International Conference on Neural Information Processing Systems; 2016. p. 901–909.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Ioffe S, Szegedy C. Batch Normalization: Accelerating Deep Network Training by Reducing Internal Covariate Shift. In Proceedings of The 32nd International Conference on Machine Learning; 2015. p. 448–456.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Tange O. GNU Parallel: The Command-Line Power Tool. login Usenix Mag. 2011; 36.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">Volodymyr Kindratenko DM,Z,M,HH,R,X,C,P,G. HAL: Computer System for Scalable Deep Learning. Practice and Experience in Advanced Research Computing. 2020;: 41–48.</mixed-citation>
    </ref>
  </ref-list>
</back>
