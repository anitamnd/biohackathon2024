<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10236844</article-id>
    <article-id pub-id-type="pmid">37264324</article-id>
    <article-id pub-id-type="publisher-id">5351</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05351-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Comut-viz: efficiently creating and browsing comutation plots online</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Duan</surname>
          <given-names>Qiaonan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Wang</surname>
          <given-names>Weiyi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Feng</surname>
          <given-names>Feiling</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jiang</surname>
          <given-names>Xiaoqing</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Hao</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Zhang</surname>
          <given-names>Dadong</given-names>
        </name>
        <address>
          <email>dadong.zhang@3dmedcare.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Zhang</surname>
          <given-names>Tongyi</given-names>
        </name>
        <address>
          <email>tongyizhang1983@163.com</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.518716.c</institution-id><institution>Department of Translational Medicine, </institution><institution>3D Medicines Inc., </institution></institution-wrap>Shanghai, China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.413597.d</institution-id><institution-id institution-id-type="ISNI">0000 0004 1757 8802</institution-id><institution>General Surgery Department, </institution><institution>Huadong Hospital Affiliated to Fudan University, </institution></institution-wrap>Shanghai, China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.73113.37</institution-id><institution-id institution-id-type="ISNI">0000 0004 0369 1660</institution-id><institution>Department of Biliary Tract Surgery I, </institution><institution>Third Affiliated Hospital of Naval Medical University (Eastern Hepatobiliary Surgery Hospital), </institution></institution-wrap>Shanghai, China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>1</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>226</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Comutation plot is a widely used visualization method to deliver a global view of the mutation landscape of large-scale genomic studies. Current tools for creating comutation plot are either offline packages that require coding or online web servers with varied features. When a package is used, it often requires repetitive runs of code to adjust a single feature that might only be a few clicks in a web app. But web apps mostly have limited capacity for customization and cannot handle very large genomic files.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">To improve on existing tools, we identified features that are most frequently adjusted in creating a plot and incorporate them in Comut-viz that interactively filters and visualizes mutation data as downloadable plots. It includes colored labels for numeric metadata, a preloaded palette for changing colors and two input boxes for adjusting width and height. It accepts standard mutation annotation format (MAF) files as input and can handle large MAF files with more than 200 k rows. As a front-end only app, Comut-viz guarantees privacy of user data and no latency in the analysis.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Comut-viz is a highly responsive and extensible web app to make comutation plots. It provides customization for frequently adjusted features and accepts large genomic files as input. It is suitable for genomic studies with more than a thousand samples.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05351-8.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Visualization</kwd>
      <kwd>Comutation plot</kwd>
      <kwd>Genomic analysis</kwd>
      <kwd>Mutation</kwd>
      <kwd>Web server</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Shanghai Jiading District Health Commission</institution>
        </funding-source>
        <award-id>2020-ZD-01</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100007054</institution-id>
            <institution>Second Military Medical University</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2017JZ11</award-id>
        <principal-award-recipient>
          <name>
            <surname>Jiang</surname>
            <given-names>Xiaoqing</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par4">Comutation plot [<xref ref-type="bibr" rid="CR1">1</xref>] represents mutation data as a matrix of tiles with the rows being mutated genes and the columns being sequenced samples. It is widely used in genomic studies to visualize the mutation landscape. Several bioinformatics packages [<xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR4">4</xref>] have been developed to create the plots. These packages are largely language specific and not interactive, requiring repetitive runs to adjust a single feature. Interactive web tools have been developed to make the process more efficient. They include standalone web apps like CoMutPlotter [<xref ref-type="bibr" rid="CR5">5</xref>] and jsComut [<xref ref-type="bibr" rid="CR6">6</xref>], and more comprehensive platforms like cBioPortal [<xref ref-type="bibr" rid="CR7">7</xref>] and Oviz-Bio [<xref ref-type="bibr" rid="CR8">8</xref>]. CoMutPlotter generates static images with no customization. JsComut require users to manually click an update button when changing the appearance of an existing plot. It lacks colored labels for continuous data and the ability to modify width and height. The cBioPortal platform has the OncoPrinter module to generate comutaton plots but allows no color customization and height adjustment. The Oviz-Bio platform is a newly developed platform with more interactive features. But it is not open-sourced and accepts only a non-standard file format as input. This limits its use and adaption by the wider community of bioinformatics developers. Unsatisfied with current solutions, we developed Comut-viz, a highly responsive open-sourced web app that simplifies the steps in making a comutation plot.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par5">Considering the privacy and the security of mutation data, we designed Comut-viz as a front-end only app: a user’s input data is processed locally within a user’s browser and never sent to a back-end server. A schematic flow chart illustrating the implementation was provided in the supplementary (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5). React 18 was used as the front-end framework to orchestra the app. It implements three views: an input view to submit data, a filter view to the customize data and a visualization view to draw on the data.</p>
    <p id="Par6">A JavaScript (JS) ECMAScript6 (ES6) class named ComutData was developed to transform input tables into JS objects rendered in the visualization view. It implements waterfall sorting commonly used in organizing samples. In the visualization view, ES6 classes were built for each component of the plot including the grid, the colored labels, the bar plots and the legends. They share the same interface and can be easily arranged in a scalable vector graphics (SVG) container. A color picker was developed to customize colors on the plot including the base color of a gradient legend. The base color of a gradient legend was mapped into HSL values with the hue (H) and saturation (S) fixed and the lightness (L) mapped to the input continuous values.</p>
  </sec>
  <sec id="Sec3">
    <title>Results</title>
    <sec id="Sec4">
      <title>The input view</title>
      <p id="Par7">In the input view (Fig. <xref rid="Fig1" ref-type="fig">1</xref>), users upload a table of mutation data in a standard MAF file or a tab/comma delimited text file. The app will display a preview of the table with the first 10 rows. Three select elements will appear above the preview to let users choose the sample IDs, gene and mutation type columns in the table. They will be automatically selected if the input file is a standard MAF file. After selection, click on the Next button to navigate to the filter view. Users can optionally upload a table of sample metadata in a tab/comma delimited text file as the second input. The metadata must include an ID column containing the same sample IDs as in the mutation data. A similar preview will be displayed for the metadata. A select element will appear above the metadata preview to let users choose the sample column. By default, the first column is selected as the sample column.<fig id="Fig1"><label>Fig. 1</label><caption><p>A screen shot of the input view. It shows the input view with the “example 5 k” data and metadata loaded. The sample, gene and mutation type columns are automatically selected</p></caption><graphic xlink:href="12859_2023_5351_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par8">Users can test the app by clicking on the example buttons. The “example 5 k” button loads a tab delimited text file that contains mutation profiles of patient-derived primary cancer cell lines collected from different regions of gallbladder carcinoma tumors from seven patients [<xref ref-type="bibr" rid="CR9">9</xref>]. Its associated metadata includes patient ID, age, gender and serum Carbohydrate antigen 19-9 (CA19-9) levels. The “example 141 k” button loads a MAF file with 141 k rows that are mutation profiles of the TCGA-LUSC cohort [<xref ref-type="bibr" rid="CR10">10</xref>].</p>
    </sec>
    <sec id="Sec5">
      <title>The filter view</title>
      <p id="Par9">In the filter view (Fig. <xref rid="Fig2" ref-type="fig">2</xref>), the app display three tables: the filtered mutation table, a table of mutation types and a table of top mutated genes. In case the mutation table contains too many genes to visualize, the app provides an option to filter them by sample count. Summary statistics on top of each table are updated with each filtering. If a metadata table is provided, it will be also displayed in this view. The columns of the metadata table will be parsed at this stage according to the inferred data types. Columns of string type will be treated as categorical labels and those of numeric type as gradient labels.<fig id="Fig2"><label>Fig. 2</label><caption><p>A screen shot of the filter view. It shows the filter view of “example 5 k”</p></caption><graphic xlink:href="12859_2023_5351_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par10">By default, the filter view keeps at most 60 top mutated genes. Users can change the number of top mutated genes by adjusting the sample count filter. When the top mutated genes are less than or equal to 60, the waterfall checkbox is automatically checked. The app will sort the samples by waterfall sorting in the visualization view. When waterfall checkbox is unchecked and the metadata table provided, the app will sort the samples by the order in the metadata. This mechanism allows users to use the metadata to specify the sample order in the final visualization.</p>
      <p id="Par11">Users can use the checkboxes in the mutation type table to remove mutation types they do not want to show in the comutation plot. Uncheck a mutation type may cause the counts of other mutation types to change. The number of genes passing the current threshold may also change. This is because the reduced number of mutation types decreases the qualified mutations counted for each gene. Click on the Visualize button to navigate to the visualization view.</p>
    </sec>
    <sec id="Sec6">
      <title>The visualization view</title>
      <p id="Par12">The visualization view (Fig. <xref rid="Fig3" ref-type="fig">3</xref>) consists of three regions: the control and plotting regions on the left and the legend region on the right. In the control region, there are two input boxes to control width and height of the figure and a filter to fine-tune the number of genes displayed in the figure. In the plotting region, a bar plot is placed on top to show the number and types of mutations in each sample. A side bar chart on the right reveals the percentage of samples a gene is mutated in. If metadata is provided, colored labels will be displayed between the bar plot and the grid. They will be categorical if the data is of string type and gradient if of numeric type. Mouse-over on any shape will pop up detailed information. Mouse-over on a tile will also invoke black boxes highlighting its metadata on the X and Y axes.<fig id="Fig3"><label>Fig. 3</label><caption><p>A screen shot of the visualization view. It shows the visualization view of “example 5 k”. The color and height of the plot have been adjusted</p></caption><graphic xlink:href="12859_2023_5351_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par13">Legends are created for each colored component. Clicking on a legend opens up a color picker that is preloaded with 12 distinct colors for quick selection. Users can create a customized color by clicking on the color box in the picker. All text labels are auto-scaled when the size of the figure is changed. Clicking on the “Download” button downloads the plot and the legend as two separate SVG figures that can be edited in vector graphics editors such as Adobe Illustrator or Inkscape.</p>
      <p id="Par14">Besides the two examples provided in the app, we also tested Comut-viz on a large MAF file with 229 k rows (~ 33 MB). We tested it on a Windows desktop with an I5-10,400 CPU and 16 GB memory. The MAF file can be found in the Github repository and is a concatenation of the mutation data from the TCGA-LUSC and TCGA-BRCA studies.</p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Conclusions</title>
    <p id="Par15">We developed Comut-viz to make creation of comutation plots more efficient. We found filtering genes and changing colors the two most repetitive tasks in fine-tuning a final figure. Comut-viz implements two filters and a preloaded color palette to address that. Built with the React framework, it is instantly responsive to user manipulations. Developed using the object-oriented ES6 syntax, Comut-viz is a collection of reusable components and classes that are readily exported to other projects. Users can easily integrate Comut-viz into their existing data analysis pipeline and make the visualization process more efficient.</p>
  </sec>
  <sec id="Sec8">
    <title>Availability and requirements</title>
    <p id="Par16">Project name: Comut-viz. Project home page: <ext-link ext-link-type="uri" xlink:href="https://frlender.github.io/comut-viz-app/">https://frlender.github.io/comut-viz-app/</ext-link> (running instance). <ext-link ext-link-type="uri" xlink:href="https://github.com/frlender/comut-viz">https://github.com/frlender/comut-viz</ext-link> (development repository). Operating system(s): Platform independent. Programming language: JavaScript. License: MIT license. Any restrictions to use by non-academics: None.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec9">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5351_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold>. Detailed illustration of the many components of Comut-viz. The file provides detail illustration of the many components of Comut-viz in three views. It also provides a flow chart to illustrate how Comut-viz works on a high level.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Qiaonan Duan, Weiyi Wang and Feiling Feng contributed equally to this work.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>QD: project conception, system implementation, manuscript drafting; WW: system design, UI development, testing, manuscript editing; FF: system design, data processing, technical support, figure preparation, manuscript drafting; XJ: data curation, manuscript editing; HC: manuscript editing; DZ: project management, system design, manuscript writing; TZ: project design, supervision, manuscript editing; All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This study is partially supported by the following grants: the Special Fund for the Application and Transformation of Precision Medicine at the Second Military Medical University (no. 2017JZ11) and the key program of Shanghai Jiading District Health Commission (no. 2020-ZD-01).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The “example 5 k” data and metadata can be found at (<ext-link ext-link-type="uri" xlink:href="https://github.com/frlender/comut-viz/blob/main/public/gallbladder.maf">https://github.com/frlender/comut-viz/blob/main/public/gallbladder.maf</ext-link>) and at (<ext-link ext-link-type="uri" xlink:href="https://github.com/frlender/comut-viz/blob/main/public/gallbladder_meta.txt">https://github.com/frlender/comut-viz/blob/main/public/gallbladder_meta.txt</ext-link>). The “example 141 k” data can be found at (<ext-link ext-link-type="uri" xlink:href="https://github.com/frlender/comut-viz/blob/main/public/TCGA-LUSC.maf">https://github.com/frlender/comut-viz/blob/main/public/TCGA-LUSC.maf</ext-link>). The large MAF file with 229 k rows can be found at (<ext-link ext-link-type="uri" xlink:href="https://github.com/frlender/comut-viz/blob/‌main/public/TCGA-LUSC-BRCA.maf">https://github.com/frlender/comut-viz/blob/‌main/public/TCGA-LUSC-BRCA.maf</ext-link>).</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par17">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par18">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par19">Authors affiliated with 3D Medicines Inc. are current or former employees. No other disclosures were reported.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stransky</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Egloff</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Tward</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Kostic</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Cibulskis</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sivachenko</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The mutational landscape of head and neck squamous cell carcinoma</article-title>
        <source>Science</source>
        <year>2011</year>
        <volume>333</volume>
        <fpage>1157</fpage>
        <lpage>1160</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1208130</pub-id>
        <?supplied-pmid 21798893?>
        <pub-id pub-id-type="pmid">21798893</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Skidmore</surname>
            <given-names>ZL</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>Lesurf</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Kunisaki</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Griffith</surname>
            <given-names>OL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GenVisR: genomic visualizations in R</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>3012</fpage>
        <lpage>3014</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw325</pub-id>
        <?supplied-pmid 27288499?>
        <pub-id pub-id-type="pmid">27288499</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mayakonda</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>D-C</given-names>
          </name>
          <name>
            <surname>Assenov</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Plass</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Koeffler</surname>
            <given-names>HP</given-names>
          </name>
        </person-group>
        <article-title>Maftools: efficient and comprehensive analysis of somatic variants in cancer</article-title>
        <source>Genome Res</source>
        <year>2018</year>
        <volume>28</volume>
        <fpage>1747</fpage>
        <lpage>1756</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.239244.118</pub-id>
        <?supplied-pmid 30341162?>
        <pub-id pub-id-type="pmid">30341162</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crowdis</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>MX</given-names>
          </name>
          <name>
            <surname>Reardon</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Van Allen</surname>
            <given-names>EM</given-names>
          </name>
        </person-group>
        <article-title>CoMut: visualizing integrated molecular information with comutation plots</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <fpage>4348</fpage>
        <lpage>4349</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa554</pub-id>
        <?supplied-pmid 32502231?>
        <pub-id pub-id-type="pmid">32502231</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>P-J</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>H-H</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>C-C</given-names>
          </name>
          <name>
            <surname>Chiu</surname>
            <given-names>L-Y</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>S-M</given-names>
          </name>
          <name>
            <surname>Yeh</surname>
            <given-names>Y-M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CoMutPlotter: a web tool for visual summary of mutations in cancer cohorts</article-title>
        <source>BMC Med Genomics</source>
        <year>2019</year>
        <volume>12</volume>
        <fpage>1</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1186/s12920-019-0510-y</pub-id>
        <pub-id pub-id-type="pmid">30606219</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pearce</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Nikiforova</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Roy</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Interactive browser-based genomics data visualization tools for translational and clinical laboratory applications</article-title>
        <source>J Mol Diagn</source>
        <year>2019</year>
        <volume>21</volume>
        <fpage>985</fpage>
        <lpage>993</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jmoldx.2019.06.005</pub-id>
        <?supplied-pmid 31382034?>
        <pub-id pub-id-type="pmid">31382034</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lindsay</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Watt</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bahceci</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Lukasse</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Abeshouse</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The cBioPortal for cancer genomics and its application in precision oncology</article-title>
        <source>Cancer Res</source>
        <year>2016</year>
        <volume>76</volume>
        <fpage>5277</fpage>
        <lpage>5277</lpage>
        <pub-id pub-id-type="doi">10.1158/1538-7445.AM2016-5277</pub-id>
        <pub-id pub-id-type="pmid">27503933</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jia</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>SC</given-names>
          </name>
        </person-group>
        <article-title>Oviz-Bio: a web-based platform for interactive cancer genomics data visualization</article-title>
        <source>Nucleic Acids Res</source>
        <year>2020</year>
        <volume>48</volume>
        <fpage>W415</fpage>
        <lpage>W426</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkaa371</pub-id>
        <?supplied-pmid 32392343?>
        <pub-id pub-id-type="pmid">32392343</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feng</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Establishment and characterization of 38 novel patient-derived primary cancer cell lines using multi-region sampling revealing intra-tumor heterogeneity of gallbladder carcinoma</article-title>
        <source>Hum Cell</source>
        <year>2021</year>
        <volume>34</volume>
        <fpage>918</fpage>
        <lpage>931</lpage>
        <pub-id pub-id-type="doi">10.1007/s13577-021-00492-5</pub-id>
        <?supplied-pmid 33813726?>
        <pub-id pub-id-type="pmid">33813726</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weinstein</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Collisson</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Mills</surname>
            <given-names>GB</given-names>
          </name>
          <name>
            <surname>Shaw</surname>
            <given-names>KRM</given-names>
          </name>
          <name>
            <surname>Ozenberger</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Ellrott</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The cancer genome atlas pan-cancer analysis project</article-title>
        <source>Nat Genet</source>
        <year>2013</year>
        <volume>45</volume>
        <fpage>1113</fpage>
        <lpage>1120</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.2764</pub-id>
        <?supplied-pmid 24071849?>
        <pub-id pub-id-type="pmid">24071849</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10236844</article-id>
    <article-id pub-id-type="pmid">37264324</article-id>
    <article-id pub-id-type="publisher-id">5351</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05351-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Comut-viz: efficiently creating and browsing comutation plots online</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Duan</surname>
          <given-names>Qiaonan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Wang</surname>
          <given-names>Weiyi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Feng</surname>
          <given-names>Feiling</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jiang</surname>
          <given-names>Xiaoqing</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Hao</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Zhang</surname>
          <given-names>Dadong</given-names>
        </name>
        <address>
          <email>dadong.zhang@3dmedcare.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Zhang</surname>
          <given-names>Tongyi</given-names>
        </name>
        <address>
          <email>tongyizhang1983@163.com</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.518716.c</institution-id><institution>Department of Translational Medicine, </institution><institution>3D Medicines Inc., </institution></institution-wrap>Shanghai, China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.413597.d</institution-id><institution-id institution-id-type="ISNI">0000 0004 1757 8802</institution-id><institution>General Surgery Department, </institution><institution>Huadong Hospital Affiliated to Fudan University, </institution></institution-wrap>Shanghai, China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.73113.37</institution-id><institution-id institution-id-type="ISNI">0000 0004 0369 1660</institution-id><institution>Department of Biliary Tract Surgery I, </institution><institution>Third Affiliated Hospital of Naval Medical University (Eastern Hepatobiliary Surgery Hospital), </institution></institution-wrap>Shanghai, China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>1</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>226</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Comutation plot is a widely used visualization method to deliver a global view of the mutation landscape of large-scale genomic studies. Current tools for creating comutation plot are either offline packages that require coding or online web servers with varied features. When a package is used, it often requires repetitive runs of code to adjust a single feature that might only be a few clicks in a web app. But web apps mostly have limited capacity for customization and cannot handle very large genomic files.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">To improve on existing tools, we identified features that are most frequently adjusted in creating a plot and incorporate them in Comut-viz that interactively filters and visualizes mutation data as downloadable plots. It includes colored labels for numeric metadata, a preloaded palette for changing colors and two input boxes for adjusting width and height. It accepts standard mutation annotation format (MAF) files as input and can handle large MAF files with more than 200 k rows. As a front-end only app, Comut-viz guarantees privacy of user data and no latency in the analysis.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Comut-viz is a highly responsive and extensible web app to make comutation plots. It provides customization for frequently adjusted features and accepts large genomic files as input. It is suitable for genomic studies with more than a thousand samples.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05351-8.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Visualization</kwd>
      <kwd>Comutation plot</kwd>
      <kwd>Genomic analysis</kwd>
      <kwd>Mutation</kwd>
      <kwd>Web server</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Shanghai Jiading District Health Commission</institution>
        </funding-source>
        <award-id>2020-ZD-01</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100007054</institution-id>
            <institution>Second Military Medical University</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2017JZ11</award-id>
        <principal-award-recipient>
          <name>
            <surname>Jiang</surname>
            <given-names>Xiaoqing</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par4">Comutation plot [<xref ref-type="bibr" rid="CR1">1</xref>] represents mutation data as a matrix of tiles with the rows being mutated genes and the columns being sequenced samples. It is widely used in genomic studies to visualize the mutation landscape. Several bioinformatics packages [<xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR4">4</xref>] have been developed to create the plots. These packages are largely language specific and not interactive, requiring repetitive runs to adjust a single feature. Interactive web tools have been developed to make the process more efficient. They include standalone web apps like CoMutPlotter [<xref ref-type="bibr" rid="CR5">5</xref>] and jsComut [<xref ref-type="bibr" rid="CR6">6</xref>], and more comprehensive platforms like cBioPortal [<xref ref-type="bibr" rid="CR7">7</xref>] and Oviz-Bio [<xref ref-type="bibr" rid="CR8">8</xref>]. CoMutPlotter generates static images with no customization. JsComut require users to manually click an update button when changing the appearance of an existing plot. It lacks colored labels for continuous data and the ability to modify width and height. The cBioPortal platform has the OncoPrinter module to generate comutaton plots but allows no color customization and height adjustment. The Oviz-Bio platform is a newly developed platform with more interactive features. But it is not open-sourced and accepts only a non-standard file format as input. This limits its use and adaption by the wider community of bioinformatics developers. Unsatisfied with current solutions, we developed Comut-viz, a highly responsive open-sourced web app that simplifies the steps in making a comutation plot.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par5">Considering the privacy and the security of mutation data, we designed Comut-viz as a front-end only app: a user’s input data is processed locally within a user’s browser and never sent to a back-end server. A schematic flow chart illustrating the implementation was provided in the supplementary (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5). React 18 was used as the front-end framework to orchestra the app. It implements three views: an input view to submit data, a filter view to the customize data and a visualization view to draw on the data.</p>
    <p id="Par6">A JavaScript (JS) ECMAScript6 (ES6) class named ComutData was developed to transform input tables into JS objects rendered in the visualization view. It implements waterfall sorting commonly used in organizing samples. In the visualization view, ES6 classes were built for each component of the plot including the grid, the colored labels, the bar plots and the legends. They share the same interface and can be easily arranged in a scalable vector graphics (SVG) container. A color picker was developed to customize colors on the plot including the base color of a gradient legend. The base color of a gradient legend was mapped into HSL values with the hue (H) and saturation (S) fixed and the lightness (L) mapped to the input continuous values.</p>
  </sec>
  <sec id="Sec3">
    <title>Results</title>
    <sec id="Sec4">
      <title>The input view</title>
      <p id="Par7">In the input view (Fig. <xref rid="Fig1" ref-type="fig">1</xref>), users upload a table of mutation data in a standard MAF file or a tab/comma delimited text file. The app will display a preview of the table with the first 10 rows. Three select elements will appear above the preview to let users choose the sample IDs, gene and mutation type columns in the table. They will be automatically selected if the input file is a standard MAF file. After selection, click on the Next button to navigate to the filter view. Users can optionally upload a table of sample metadata in a tab/comma delimited text file as the second input. The metadata must include an ID column containing the same sample IDs as in the mutation data. A similar preview will be displayed for the metadata. A select element will appear above the metadata preview to let users choose the sample column. By default, the first column is selected as the sample column.<fig id="Fig1"><label>Fig. 1</label><caption><p>A screen shot of the input view. It shows the input view with the “example 5 k” data and metadata loaded. The sample, gene and mutation type columns are automatically selected</p></caption><graphic xlink:href="12859_2023_5351_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par8">Users can test the app by clicking on the example buttons. The “example 5 k” button loads a tab delimited text file that contains mutation profiles of patient-derived primary cancer cell lines collected from different regions of gallbladder carcinoma tumors from seven patients [<xref ref-type="bibr" rid="CR9">9</xref>]. Its associated metadata includes patient ID, age, gender and serum Carbohydrate antigen 19-9 (CA19-9) levels. The “example 141 k” button loads a MAF file with 141 k rows that are mutation profiles of the TCGA-LUSC cohort [<xref ref-type="bibr" rid="CR10">10</xref>].</p>
    </sec>
    <sec id="Sec5">
      <title>The filter view</title>
      <p id="Par9">In the filter view (Fig. <xref rid="Fig2" ref-type="fig">2</xref>), the app display three tables: the filtered mutation table, a table of mutation types and a table of top mutated genes. In case the mutation table contains too many genes to visualize, the app provides an option to filter them by sample count. Summary statistics on top of each table are updated with each filtering. If a metadata table is provided, it will be also displayed in this view. The columns of the metadata table will be parsed at this stage according to the inferred data types. Columns of string type will be treated as categorical labels and those of numeric type as gradient labels.<fig id="Fig2"><label>Fig. 2</label><caption><p>A screen shot of the filter view. It shows the filter view of “example 5 k”</p></caption><graphic xlink:href="12859_2023_5351_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par10">By default, the filter view keeps at most 60 top mutated genes. Users can change the number of top mutated genes by adjusting the sample count filter. When the top mutated genes are less than or equal to 60, the waterfall checkbox is automatically checked. The app will sort the samples by waterfall sorting in the visualization view. When waterfall checkbox is unchecked and the metadata table provided, the app will sort the samples by the order in the metadata. This mechanism allows users to use the metadata to specify the sample order in the final visualization.</p>
      <p id="Par11">Users can use the checkboxes in the mutation type table to remove mutation types they do not want to show in the comutation plot. Uncheck a mutation type may cause the counts of other mutation types to change. The number of genes passing the current threshold may also change. This is because the reduced number of mutation types decreases the qualified mutations counted for each gene. Click on the Visualize button to navigate to the visualization view.</p>
    </sec>
    <sec id="Sec6">
      <title>The visualization view</title>
      <p id="Par12">The visualization view (Fig. <xref rid="Fig3" ref-type="fig">3</xref>) consists of three regions: the control and plotting regions on the left and the legend region on the right. In the control region, there are two input boxes to control width and height of the figure and a filter to fine-tune the number of genes displayed in the figure. In the plotting region, a bar plot is placed on top to show the number and types of mutations in each sample. A side bar chart on the right reveals the percentage of samples a gene is mutated in. If metadata is provided, colored labels will be displayed between the bar plot and the grid. They will be categorical if the data is of string type and gradient if of numeric type. Mouse-over on any shape will pop up detailed information. Mouse-over on a tile will also invoke black boxes highlighting its metadata on the X and Y axes.<fig id="Fig3"><label>Fig. 3</label><caption><p>A screen shot of the visualization view. It shows the visualization view of “example 5 k”. The color and height of the plot have been adjusted</p></caption><graphic xlink:href="12859_2023_5351_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par13">Legends are created for each colored component. Clicking on a legend opens up a color picker that is preloaded with 12 distinct colors for quick selection. Users can create a customized color by clicking on the color box in the picker. All text labels are auto-scaled when the size of the figure is changed. Clicking on the “Download” button downloads the plot and the legend as two separate SVG figures that can be edited in vector graphics editors such as Adobe Illustrator or Inkscape.</p>
      <p id="Par14">Besides the two examples provided in the app, we also tested Comut-viz on a large MAF file with 229 k rows (~ 33 MB). We tested it on a Windows desktop with an I5-10,400 CPU and 16 GB memory. The MAF file can be found in the Github repository and is a concatenation of the mutation data from the TCGA-LUSC and TCGA-BRCA studies.</p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Conclusions</title>
    <p id="Par15">We developed Comut-viz to make creation of comutation plots more efficient. We found filtering genes and changing colors the two most repetitive tasks in fine-tuning a final figure. Comut-viz implements two filters and a preloaded color palette to address that. Built with the React framework, it is instantly responsive to user manipulations. Developed using the object-oriented ES6 syntax, Comut-viz is a collection of reusable components and classes that are readily exported to other projects. Users can easily integrate Comut-viz into their existing data analysis pipeline and make the visualization process more efficient.</p>
  </sec>
  <sec id="Sec8">
    <title>Availability and requirements</title>
    <p id="Par16">Project name: Comut-viz. Project home page: <ext-link ext-link-type="uri" xlink:href="https://frlender.github.io/comut-viz-app/">https://frlender.github.io/comut-viz-app/</ext-link> (running instance). <ext-link ext-link-type="uri" xlink:href="https://github.com/frlender/comut-viz">https://github.com/frlender/comut-viz</ext-link> (development repository). Operating system(s): Platform independent. Programming language: JavaScript. License: MIT license. Any restrictions to use by non-academics: None.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec9">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5351_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold>. Detailed illustration of the many components of Comut-viz. The file provides detail illustration of the many components of Comut-viz in three views. It also provides a flow chart to illustrate how Comut-viz works on a high level.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Qiaonan Duan, Weiyi Wang and Feiling Feng contributed equally to this work.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>QD: project conception, system implementation, manuscript drafting; WW: system design, UI development, testing, manuscript editing; FF: system design, data processing, technical support, figure preparation, manuscript drafting; XJ: data curation, manuscript editing; HC: manuscript editing; DZ: project management, system design, manuscript writing; TZ: project design, supervision, manuscript editing; All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This study is partially supported by the following grants: the Special Fund for the Application and Transformation of Precision Medicine at the Second Military Medical University (no. 2017JZ11) and the key program of Shanghai Jiading District Health Commission (no. 2020-ZD-01).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The “example 5 k” data and metadata can be found at (<ext-link ext-link-type="uri" xlink:href="https://github.com/frlender/comut-viz/blob/main/public/gallbladder.maf">https://github.com/frlender/comut-viz/blob/main/public/gallbladder.maf</ext-link>) and at (<ext-link ext-link-type="uri" xlink:href="https://github.com/frlender/comut-viz/blob/main/public/gallbladder_meta.txt">https://github.com/frlender/comut-viz/blob/main/public/gallbladder_meta.txt</ext-link>). The “example 141 k” data can be found at (<ext-link ext-link-type="uri" xlink:href="https://github.com/frlender/comut-viz/blob/main/public/TCGA-LUSC.maf">https://github.com/frlender/comut-viz/blob/main/public/TCGA-LUSC.maf</ext-link>). The large MAF file with 229 k rows can be found at (<ext-link ext-link-type="uri" xlink:href="https://github.com/frlender/comut-viz/blob/‌main/public/TCGA-LUSC-BRCA.maf">https://github.com/frlender/comut-viz/blob/‌main/public/TCGA-LUSC-BRCA.maf</ext-link>).</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par17">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par18">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par19">Authors affiliated with 3D Medicines Inc. are current or former employees. No other disclosures were reported.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stransky</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Egloff</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Tward</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Kostic</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Cibulskis</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sivachenko</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The mutational landscape of head and neck squamous cell carcinoma</article-title>
        <source>Science</source>
        <year>2011</year>
        <volume>333</volume>
        <fpage>1157</fpage>
        <lpage>1160</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1208130</pub-id>
        <?supplied-pmid 21798893?>
        <pub-id pub-id-type="pmid">21798893</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Skidmore</surname>
            <given-names>ZL</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>Lesurf</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Kunisaki</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Griffith</surname>
            <given-names>OL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GenVisR: genomic visualizations in R</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>3012</fpage>
        <lpage>3014</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw325</pub-id>
        <?supplied-pmid 27288499?>
        <pub-id pub-id-type="pmid">27288499</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mayakonda</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>D-C</given-names>
          </name>
          <name>
            <surname>Assenov</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Plass</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Koeffler</surname>
            <given-names>HP</given-names>
          </name>
        </person-group>
        <article-title>Maftools: efficient and comprehensive analysis of somatic variants in cancer</article-title>
        <source>Genome Res</source>
        <year>2018</year>
        <volume>28</volume>
        <fpage>1747</fpage>
        <lpage>1756</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.239244.118</pub-id>
        <?supplied-pmid 30341162?>
        <pub-id pub-id-type="pmid">30341162</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crowdis</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>MX</given-names>
          </name>
          <name>
            <surname>Reardon</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Van Allen</surname>
            <given-names>EM</given-names>
          </name>
        </person-group>
        <article-title>CoMut: visualizing integrated molecular information with comutation plots</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <fpage>4348</fpage>
        <lpage>4349</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa554</pub-id>
        <?supplied-pmid 32502231?>
        <pub-id pub-id-type="pmid">32502231</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>P-J</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>H-H</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>C-C</given-names>
          </name>
          <name>
            <surname>Chiu</surname>
            <given-names>L-Y</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>S-M</given-names>
          </name>
          <name>
            <surname>Yeh</surname>
            <given-names>Y-M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CoMutPlotter: a web tool for visual summary of mutations in cancer cohorts</article-title>
        <source>BMC Med Genomics</source>
        <year>2019</year>
        <volume>12</volume>
        <fpage>1</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1186/s12920-019-0510-y</pub-id>
        <pub-id pub-id-type="pmid">30606219</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pearce</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Nikiforova</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Roy</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Interactive browser-based genomics data visualization tools for translational and clinical laboratory applications</article-title>
        <source>J Mol Diagn</source>
        <year>2019</year>
        <volume>21</volume>
        <fpage>985</fpage>
        <lpage>993</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jmoldx.2019.06.005</pub-id>
        <?supplied-pmid 31382034?>
        <pub-id pub-id-type="pmid">31382034</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lindsay</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Watt</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bahceci</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Lukasse</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Abeshouse</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The cBioPortal for cancer genomics and its application in precision oncology</article-title>
        <source>Cancer Res</source>
        <year>2016</year>
        <volume>76</volume>
        <fpage>5277</fpage>
        <lpage>5277</lpage>
        <pub-id pub-id-type="doi">10.1158/1538-7445.AM2016-5277</pub-id>
        <pub-id pub-id-type="pmid">27503933</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jia</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>SC</given-names>
          </name>
        </person-group>
        <article-title>Oviz-Bio: a web-based platform for interactive cancer genomics data visualization</article-title>
        <source>Nucleic Acids Res</source>
        <year>2020</year>
        <volume>48</volume>
        <fpage>W415</fpage>
        <lpage>W426</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkaa371</pub-id>
        <?supplied-pmid 32392343?>
        <pub-id pub-id-type="pmid">32392343</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feng</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Establishment and characterization of 38 novel patient-derived primary cancer cell lines using multi-region sampling revealing intra-tumor heterogeneity of gallbladder carcinoma</article-title>
        <source>Hum Cell</source>
        <year>2021</year>
        <volume>34</volume>
        <fpage>918</fpage>
        <lpage>931</lpage>
        <pub-id pub-id-type="doi">10.1007/s13577-021-00492-5</pub-id>
        <?supplied-pmid 33813726?>
        <pub-id pub-id-type="pmid">33813726</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weinstein</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Collisson</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Mills</surname>
            <given-names>GB</given-names>
          </name>
          <name>
            <surname>Shaw</surname>
            <given-names>KRM</given-names>
          </name>
          <name>
            <surname>Ozenberger</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Ellrott</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The cancer genome atlas pan-cancer analysis project</article-title>
        <source>Nat Genet</source>
        <year>2013</year>
        <volume>45</volume>
        <fpage>1113</fpage>
        <lpage>1120</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.2764</pub-id>
        <?supplied-pmid 24071849?>
        <pub-id pub-id-type="pmid">24071849</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
