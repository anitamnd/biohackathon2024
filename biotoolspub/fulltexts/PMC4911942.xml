<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d1 20130915//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Syst Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Syst. Biol</journal-id>
    <journal-id journal-id-type="publisher-id">sysbio</journal-id>
    <journal-id journal-id-type="hwp">sysbio</journal-id>
    <journal-title-group>
      <journal-title>Systematic Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1063-5157</issn>
    <issn pub-type="epub">1076-836X</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4911942</article-id>
    <article-id pub-id-type="doi">10.1093/sysbio/syw021</article-id>
    <article-id pub-id-type="publisher-id">syw021</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software for Systematics and Evolution</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RevBayes: Bayesian Phylogenetic Inference Using Graphical Models and an Interactive Model-Specification Language</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Höhna</surname>
          <given-names>Sebastian</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF2">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="AFF3">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="AFF4">
          <sup>4</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Landis</surname>
          <given-names>Michael J.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Heath</surname>
          <given-names>Tracy A.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF5">
          <sup>5</sup>
        </xref>
        <xref ref-type="aff" rid="AFF6">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Boussau</surname>
          <given-names>Bastien</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF7">
          <sup>7</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Lartillot</surname>
          <given-names>Nicolas</given-names>
        </name>
        <xref ref-type="aff" rid="AFF7">
          <sup>7</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Moore</surname>
          <given-names>Brian R.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Huelsenbeck</surname>
          <given-names>John P.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Ronquist</surname>
          <given-names>Fredrik</given-names>
        </name>
        <xref ref-type="aff" rid="AFF8">
          <sup>8</sup>
        </xref>
      </contrib>
      <aff id="AFF1"><sup>1</sup>Department of Integrative Biology;</aff>
      <aff id="AFF2"><sup>2</sup>Department of Statistics, University of California, Berkeley, CA 94720, USA;</aff>
      <aff id="AFF3"><sup>3</sup>Department of Evolution and Ecology, University of California, Davis, CA 95616, USA;</aff>
      <aff id="AFF4"><sup>4</sup>Department of Mathematics, Stockholm University, Stockholm, SE-106 91 Stockholm, Sweden;</aff>
      <aff id="AFF5"><sup>5</sup>Department of Ecology and Evolutionary Biology, University of Kansas, Lawrence, KS 66045, USA;</aff>
      <aff id="AFF6"><sup>6</sup>Department of Ecology, Evolution and Organismal Biology, Iowa State University, Ames, IA 50011, USA;</aff>
      <aff id="AFF7"><sup>7</sup>Laboratoire de Biométrie et Biologie Evolutive, Centre National de la Recherche Scientifique, Unité Mixte de Recherche 5558, Université Lyon 1, F-69622 Villeurbanne, France; and</aff>
      <aff id="AFF8"><sup>8</sup>Department of Bioinformatics and Genetics, Swedish Museum of Natural History, SE-10405 Stockholm, Sweden</aff>
    </contrib-group>
    <author-notes>
      <corresp id="COR1">*Correspondence to be sent to: Department of Integrative Biology, University of California, Berkeley, CA 94720, USA; Email: <email>Sebastian.Hoehna@gmail.com</email></corresp>
      <fn id="NT100">
        <p>Associate Editor: David Posada</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>7</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>5</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>5</month>
      <year>2016</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>65</volume>
    <issue>4</issue>
    <fpage>726</fpage>
    <lpage>736</lpage>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>4</month>
        <year>2015</year>
      </date>
      <date date-type="rev-recd">
        <day>2</day>
        <month>3</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>1</day>
        <month>3</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2016. Published by Oxford University Press, on behalf of the Society of Systematic Biologists.</copyright-statement>
      <copyright-year>2016</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Programs for Bayesian inference of phylogeny currently implement a unique and ﬁxed suite of models. Consequently, users of these software packages are simultaneously forced to use a number of programs for a given study, while also lacking the freedom to explore models that have not been implemented by the developers of those programs. We developed a new open-source software package, RevBayes, to address these problems. RevBayes is entirely based on probabilistic graphical models, a powerful generic framework for specifying and analyzing statistical models. Phylogenetic-graphical models can be speciﬁed interactively in RevBayes, piece by piece, using a new succinct and intuitive language called Rev. Rev is similar to the R language and the BUGS model-speciﬁcation language, and should be easy to learn for most users. The strength of RevBayes is the simplicity with which one can design, specify, and implement new and complex models. Fortunately, this tremendous ﬂexibility does not come at the cost of slower computation; as we demonstrate, RevBayes outperforms competing software for several standard analyses. Compared with other programs, RevBayes has fewer black-box elements. Users need to explicitly specify each part of the model and analysis. Although this explicitness may initially be unfamiliar, we are convinced that this transparency will improve understanding of phylogenetic models in our ﬁeld. Moreover, it will motivate the search for improvements to existing methods by brazenly exposing the model choices that we make to critical scrutiny. RevBayes is freely available at <ext-link ext-link-type="uri" xlink:href="http://www.RevBayes.com">http://www.RevBayes.com</ext-link>. [Bayesian inference; Graphical models; MCMC; statistical phylogenetics.]</p>
    </abstract>
    <counts>
      <page-count count="11"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>I<sc>ntroduction</sc></title>
    <p>Phylogeny estimation is now widely pursued in a Bayesian statistical framework (<xref rid="B59" ref-type="bibr">Rannala and Yang 1996</xref>; <xref rid="B44" ref-type="bibr">Larget and Simon 1999</xref>; <xref rid="B54" ref-type="bibr">Li et al. 2000</xref>; <xref rid="B34" ref-type="bibr">Huelsenbeck et al. 2001</xref>; <xref rid="B73" ref-type="bibr">2002</xref>; <xref rid="B32" ref-type="bibr">Holder and Lewis 2003</xref>; <xref rid="B64" ref-type="bibr">Ronquist and Deans 2010</xref>; <xref rid="B79" ref-type="bibr">Yang and Rannala 2012</xref>) The success of the Bayesian approach derives largely from the availability of efficient algorithms that make it practical to compute the joint posterior probability distribution of phylogenetic model parameters (e.g., Markov chain Monte Carlo (MCMC); <xref rid="B56" ref-type="bibr">Metropolis et al. 1953</xref>; <xref rid="B25" ref-type="bibr">Hastings 1970</xref>), and by the development of computer programs that implement those models and algorithms. Biologists interested in Bayesian inference of phylogeny can now choose among a large number of software packages (<xref rid="B34" ref-type="bibr">Huelsenbeck and Ronquist 2001</xref>; <xref rid="B65" ref-type="bibr">Ronquist and Huelsenbeck 2003</xref>; <xref rid="B69" ref-type="bibr">Suchard and Redelings 2006</xref>; <xref rid="B11" ref-type="bibr">Drummond and Rambaut 2007</xref>; <xref rid="B77" ref-type="bibr">Yang 2007</xref>; <xref rid="B46" ref-type="bibr">Lartillot et al. 2009</xref>; <xref rid="B12" ref-type="bibr">Drummond et al. 2012</xref>; <xref rid="B67" ref-type="bibr">Ronquist et al. 2012b</xref>; <xref rid="B1" ref-type="bibr">Aberer et al. 2014</xref>; <xref rid="B6" ref-type="bibr">Bouckaert et al. 2014</xref>; <xref rid="B53" ref-type="bibr">Lewis et al. 2015</xref>). Yet, despite the sophistication and quality of the available software, we believe that all of the current Bayesian programs can be improved in several important respects.</p>
    <p>First, the number of phylogenetic models available in any single computer program is limited. This forces the user to learn the details of several different computer programs—each with its own idiosyncrasies—to perform the analyses necessary for a study. The patchy implementation of models across software packages is probably a result of the typical life cycle of a phylogenetic model. A model is conceived and described in a paper but may or may not actually be implemented in computer software. A new model typically spends its infancy implemented in special-purpose and quirky software, and may only reach maturity when (or if) it is eventually implemented in a robust software package. As an example of this model life cycle, consider the approach for averaging over substitution models proposed by <xref rid="B36" ref-type="bibr">Huelsenbeck et al. (2004</xref>). This model was initially implemented in a computer program that was quite limited in its capabilities; the user could not consider alternative models of rate variation or priors on the branch lengths, etc. The substitution-model averaging approach only gained traction when it was implemented almost a decade later in the program MrBayes (<xref rid="B67" ref-type="bibr">Ronquist et al. 2012b</xref>).</p>
    <p>Second, existing software, such as MrBayes (<xref rid="B34" ref-type="bibr">Huelsenbeck and Ronquist 2001</xref>; <xref rid="B65" ref-type="bibr">Ronquist and Huelsenbeck 2003</xref>; <xref rid="B67" ref-type="bibr">Ronquist et al. 2012b</xref>), can be difficult to extend as new models are described. Every computer program has a basic architecture that is developed around the set of models that had been described at the time the program was written. New models, however, might not be compatible with the basic architecture of the program. For example, MrBayes was developed under the assumption that the alignment of DNA sequences is known without error, which makes it difficult to implement models that treat the alignment as a random variable (see e.g., <xref rid="B62" ref-type="bibr">Redelings and Suchard 2005</xref>). Similarly, in MrBayes the substitution process is assumed to be homogeneous over branches and sites (although it accommodates variation in substitution rate across sites and allows different models to be applied to subsets of the data). This homogeneity assumption has been questioned under several different circumstances (<xref rid="B17" ref-type="bibr">Galtier and Gouy 1995</xref>; <xref rid="B45" ref-type="bibr">Lartillot et al. 2007</xref>; <xref rid="B7" ref-type="bibr">Boussau et al. 2008</xref>; <xref rid="B19" ref-type="bibr">Groussin et al. 2013</xref>). It is possible to modify the program to allow heterogeneity in the substitution process across branches, but only with extensive recoding.</p>
    <p>Third, all current phylogeny programs use awkward methods for specifying the assumptions of an analysis (IE the parameters of the phylogenetic model). In general, the user is asked to specify whether a specific parameter is, or is not, part of the model. Hence, model specification in current software is much like throwing the proper sequence of toggle switches in a Lunar Module; the correct sequence of toggles must be thrown to specify any particular model, and each model is represented by a different configuration of toggle positions. This method for specifying models is clumsy even when the number of models implemented in the software is small, but becomes unwieldy as the number and complexity of models increases. More generally, the current approach for phylogenetic model specification limits the range of available models to those imagined by the software developers rather than the collective imagination of all users.</p>
    <p>These considerations motivated the development of our new software package, RevBayes, an open-source program written in the C++ language. RevBayes was initially conceived as a major rewrite of the popular Bayesian phylogenetic-inference program MrBayes (<xref rid="B34" ref-type="bibr">Huelsenbeck and Ronquist 2001</xref>; <xref rid="B65" ref-type="bibr">Ronquist and Huelsenbeck 2003</xref>; <xref rid="B67" ref-type="bibr">Ronquist et al. 2012b</xref>). However, RevBayes shares no code with MrBayes and uses an entirely new way of specifying phylogenetic models. Indeed, we devised a language for specifying phylogenetic models that is similar to the R language (<xref rid="B58" ref-type="bibr">R Core Team 2014</xref>). RevBayes is a stand-alone software package, but relies heavily on the Nexus Class Library for parsing data (<xref rid="B52" ref-type="bibr">Lewis 2003</xref>). The resulting program had only superficial similarity to MrBayes, so we rechristened the program RevBayes (The new name also reconciles a criticism by Joe Felsenstein that Thomas Bayes was a reverend and would have been addressed as such.) to distinguish it from its predecessor.</p>
    <p>Similar shortcomings have been identified by other researchers, which led to different solutions implemented in BEAST 2 (<xref rid="B6" ref-type="bibr">Bouckaert et al. 2014</xref>), a re-implementation of the popular BEAST program (<xref rid="B11" ref-type="bibr">Drummond and Rambaut 2007</xref>; <xref rid="B12" ref-type="bibr">Drummond et al. 2012</xref>). General similarities between RevBayes and BEAST 2 include a modular and flexible software design that enables model diversity, complexity, and extensibility. The main differences include the user interface (XML vs. \Rev) and our strict adoption of the graphical-model framework. For example, BEAST 2 focuses on method developers by providing a plugin mechanism for adding new features written in Java, whereas RevBayes focuses on high-end users writing new models in Rev (similar to developments in R). Our development of RevBayes was guided by a few key principles: (i) the program should enable flexible-model specification and implementation; (ii) the program should be easy and intuitive to use, and; (iii) the program should provide fast computation and efficient inference. We describe our solutions to each of the requirements in a separate section below.</p>
  </sec>
  <sec>
    <title>T<sc>he</sc> G<sc>raphical</sc> M<sc>odel</sc> R<sc>epresentation for</sc> M<sc>odeling and</sc> I<sc>nference</sc></title>
    <p>RevBayes is designed around the central idea that a phylogenetic model—in fact, any probabilistic model—can be represented as a graph (<xref rid="B39" ref-type="bibr">Jordan 2004</xref>). The graphical-model framework provides the flexibility to specify and extend models, and also confers an efficient mathematical foundation for parameter estimation (<xref rid="B31" ref-type="bibr">Höhna et al. 2014</xref>). In RevBayes, a probabilistic model is built up in computer memory by executing a series of commands. The user has fine-scale control over the details of the probabilistic model because single commands introduce individual model parameters and also specify their relationships to other parameters. In this way, a probabilistic model is assembled in computer memory as one would use LEGO<inline-formula><mml:math id="I1"><mml:mrow><mml:msup><mml:mrow/><mml:mo>®</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> bricks. Any type of model can be built as long as the elementary pieces that make up a graphical model—the variables, distributions, and functions—are available.</p>
    <p>The graph representing a probabilistic model consists of a set of vertices (often referred to as “nodes” in the phylogenetic literature) corresponding to the variables in the model, connected by edges that depict the dependence relationships among them. In RevBayes, a model graph consists of three types of variables: constant variables, stochastic variables, and deterministic variables. Constant variables represent the fixed parameters of an analysis, such as the parameter values of a prior distribution. Stochastic variables in the graph represent parameters of the model or observations, and are associated with probability distributions. Finally, deterministic parts in the graphical model represent a transformation of variables. Details of phylogenetic-graphical models are described in <xref rid="B31" ref-type="bibr">Höhna et al. (2014</xref>).</p>
    <p>Designing the program around the idea of a graphical model has several advantages. First, the explicitness of the graphical-modeling approach has considerable pedagogical value. All of the parameters of the phylogenetic model are exposed, including the parameters associated with the prior probability distributions on the parameters. Programs such as MrBayes enable the user to ignore the prior assumptions because the program assigns default priors to all model parameters. By contrast, a graphical-model representation exposes the anatomy of the model (including prior assumptions) to the user.</p>
    <p>A second advantage of the graphical-modeling approach is the inherent flexibility. New models can be constructed from existing ones by changing the probability distributions assigned to stochastic variables, or by changing the functions assigned to deterministic variables, or by introducing new relationships among the variables (i.e., changing the graph structure of the model). An existing model can also be modified by swapping subgraphs, for example, by replacing a pure-birth model with a birth--death model. Finally, a model can be extended by adding another layer to it, for example by introducing a hyperprior distribution for the speciation rate instead of using a fixed value. The only limitation on the types of models that can be built by the user is the number of available “bricks” (i.e., functions and distributions); RevBayes provides a ton of bricks and the ability to easily create new bricks.</p>
  </sec>
  <sec>
    <title>T<sc>he</sc> Rev L<sc>anguage for</sc> U<sc>ser</sc> I<sc>nteraction</sc></title>
    <p>We have developed a new programming language, Rev, for interacting with RevBayes. Rev is suitable for both interactive use and batch processing. Through Rev, users define graphical-model components in a succinct and intuitive way. Rev is inspired by the R (R Core Team201 4) language and the BUGS (<xref rid="B55" ref-type="bibr">Lunn et al. 2009</xref>) model-specification language; their popularity should reduce the Rev learning curve. However, Rev differs from these other languages because of the primary focus of RevBayes on Bayesian inference of phylogeny, for which R or BUGS are not compatible. That is, R and BUGS are designed for statistical inference and visualization of numerical data (e.g., regression analysis and ANOVA). By contrast, the specialized parameter types used in phylogenetic inference—for example trees and nucleotide characters—need entirely different data structures and algorithms for parameter estimation.</p>
    <p>We believe that the benefits of a specifically designed Rev language for Bayesian phylogenetic inference outweigh the cost of developing a brand new programming language. Our focus while designing Rev has been on providing an intuitive and easy-to-learn syntax that also provides methods for automatic error checking (e.g., by using explicit types). Thus, Rev prevents users from declaring nonsensical relationships between model variables and their corresponding functions and distributions (e.g., specifying a normal distribution as a prior on tree topologies). Importantly, Rev scripts are easily shared with the community, providing a precise description of the details of a phylogenetic analysis that will facilitate replication of the results (<xref rid="B48" ref-type="bibr">Leebens-Mack et al. 2006</xref>), while also minimizing the effort required to repeat complex analyses on new data sets. These scripts should be easier to read and understand, and can easily be adapted to incorporate model variants. Moreover, Rev itself can easily be extended over time by adding new functions, distributions, data types, and inference algorithms.</p>
    <p>In the previous section, we introduced the three components of a graphical model; constant, stochastic, and deterministic variables. <xref ref-type="fig" rid="F1">Figure 1</xref> illustrates how these model variables are represented in Rev code. We will provide a more extensive treatment of the Rev language in a forthcoming paper; here we present examples for constructing models using Rev.
<fig id="F1" orientation="portrait" position="float"><label>F<sc>igure</sc> 1</label><caption><p>Assignment operations for graphical-model components. a) Constant assignment (“p &lt;- 0.5}”): Assignment of constant variables/parameters in the model. b) Stochastic assignment (“ <inline-formula><mml:math id="I2"><mml:mo>~</mml:mo></mml:math></inline-formula> dnBernoulli(p)}”): assignment of stochastic variables that are either estimated or observed. c) Observation (“ x.clamp(1)}”): assignment of observation to a stochastic variable. d) Deterministic assignment (“ x := exp(p)}”): assignment of deterministic variables that are transformations of other variables. <bold>e)</bold> Plates/repetitions (“ for (i in 1:N) { ... } ”): identical assignment of <inline-formula><mml:math id="I3"><mml:mi>N</mml:mi></mml:math></inline-formula>
<italic>variables</italic>.</p></caption><graphic xlink:href="syw021f1"/></fig></p>
  </sec>
  <sec>
    <title>B<sc>enchmarks</sc></title>
    <p>The success of a program like RevBayes depends on its ease of use, the diversity of models it implements, and also its efficiency. One might expect the efficiency of RevBayes to be hindered by the generality of its model-specification framework. To address this concern, we compared the efficiency of RevBayes to the two most popular Bayesian phylogenetic software packages: BEAST (<xref rid="B11" ref-type="bibr">Drummond and Rambaut 2007</xref>; <xref rid="B12" ref-type="bibr">Drummond et al. 2012</xref>; <xref rid="B6" ref-type="bibr">Bouckaert et al. 2014</xref>) and MrBayes (<xref rid="B34" ref-type="bibr">Huelsenbeck and Ronquist 2001</xref>; <xref rid="B65" ref-type="bibr">Ronquist and Huelsenbeck 2003</xref>;<xref rid="B66" ref-type="bibr">Ronquist et al. 2012</xref> b). The efficiency of a Bayesian phylogeny inference program can be measured in three ways. First, we can evaluate how fast the software computes the likelihood under a given model. This speed is particularly important because computing the likelihood of a phylogenetic tree is time-consuming, and typically needs to be performed millions of times over the course of a MCMC simulation. Second, we can compare run times for a MCMC simulation, which emphasizes shortcuts taken in the MCMC algorithm to avoid unnecessary calculations. This is particularly critical when few parameters of a model change during an update in the MCMC run, where only a small part of the entire model likelihood needs to be recomputed. Third, we can evaluate the MCMC algorithm itself according to how well and fast it explores parameter space. Here, we focus on the first two efficiency criteria, as the third aspect of efficiency is a property of the algorithm rather than the software. However, we note that RevBayes incorporates new MCMC algorithms—such as slice-sampling (<xref rid="B5" ref-type="bibr">Besag and Green 1993</xref>) and the guided-tree proposals described by <xref rid="B30" ref-type="bibr">Höhna and Drummond (2012</xref>) to efficiently explore tree space—and can easily incorporate new algorithmic developments. Note that RevBayes currently does not use any external library for fast likelihood computation, for example BEAGLE (<xref rid="B4" ref-type="bibr">Ayres et al. 2012</xref>) or PLL (<xref rid="B16" ref-type="bibr">Flouri et al. 2015</xref>), but these could be included in the future.
<table-wrap id="T1" orientation="portrait" position="float"><label>T<sc>able </sc>1.</label><caption><p>Comparing the efficiency of tree-likelihood computation in BEAST, MrBayes, and RevBayes</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th align="left" rowspan="1" colspan="1">Software</th><th align="center" rowspan="1" colspan="1">HKY</th><th align="center" rowspan="1" colspan="1">HYK+<inline-formula><mml:math id="I4"><mml:mi>Γ</mml:mi></mml:math></inline-formula></th><th align="center" rowspan="1" colspan="1">GTR</th><th align="center" rowspan="1" colspan="1">GTR+<inline-formula><mml:math id="I5"><mml:mi>Γ</mml:mi></mml:math></inline-formula></th></tr></thead><tbody align="left"><tr><td align="left" rowspan="1" colspan="1">BEAST v1.8</td><td align="center" rowspan="1" colspan="1">65.3</td><td align="center" rowspan="1" colspan="1">188.4</td><td align="center" rowspan="1" colspan="1">75.8</td><td align="center" rowspan="1" colspan="1">213.4</td></tr><tr><td align="left" rowspan="1" colspan="1">BEAST v1.8—BEAGLE</td><td align="center" rowspan="1" colspan="1">41.2</td><td align="center" rowspan="1" colspan="1">105.2</td><td align="center" rowspan="1" colspan="1">47.5</td><td align="center" rowspan="1" colspan="1">107.4</td></tr><tr><td align="left" rowspan="1" colspan="1">MrBayes 3.2</td><td align="center" rowspan="1" colspan="1">78.2</td><td align="center" rowspan="1" colspan="1">177.7</td><td align="center" rowspan="1" colspan="1">76.9</td><td align="center" rowspan="1" colspan="1">169.9</td></tr><tr><td align="left" rowspan="1" colspan="1">MrBayes 3.2—BEAGLE</td><td align="center" rowspan="1" colspan="1">92.5</td><td align="center" rowspan="1" colspan="1">221.2</td><td align="center" rowspan="1" colspan="1">91.4</td><td align="center" rowspan="1" colspan="1">222.7</td></tr><tr><td align="left" rowspan="1" colspan="1">RevBayes</td><td align="center" rowspan="1" colspan="1">46.9</td><td align="center" rowspan="1" colspan="1">161.3</td><td align="center" rowspan="1" colspan="1">62.5</td><td align="center" rowspan="1" colspan="1">181.2</td></tr></tbody></table><table-wrap-foot><fn id="NT11"><p><italic>Notes</italic>: BEAST and MrBayes were run with and without the CPU implementation of the BEAGLE library for fast computation (<xref rid="B4" ref-type="bibr">Ayres et al. 2012</xref>). Exactly one substitution model parameter was updated per iteration, ensuring recomputation of the entire tree likelihood. All analyses used the same fixed tree topology and branch lengths under one of four substitution models: HKY HKY (<xref rid="B24" ref-type="bibr">Hasegawa et al. 1985</xref>), HKY+<inline-formula><mml:math id="I6"><mml:mi>Γ</mml:mi></mml:math></inline-formula> (<xref rid="B75" ref-type="bibr">Yang 1994</xref>), GTR (<xref rid="B71" ref-type="bibr">Tavaré 1986</xref>), or GTR+<inline-formula><mml:math id="I7"><mml:mi>Γ</mml:mi></mml:math></inline-formula> (<xref rid="B75" ref-type="bibr">Yang 1994</xref>). Run times are given in seconds on a MacBookPro with a 3 GHz Intel Core i7 processor for <inline-formula><mml:math id="I8"><mml:mrow><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> iterations on a molecular data set with 12 species and 898 sites.</p></fn></table-wrap-foot></table-wrap></p>
    <p>The results demonstrate that RevBayes performs equally well or better than the basic implementations of MrBayes and BEAST in terms of the speed of likelihood computations (<xref ref-type="table" rid="T1">Table 1</xref>). Only BEAST with BEAGLE outperformed our implementation in RevBayes. The likelihood implementation in MrBayes is actually faster than the implementation of MrBayes with BEAGLE, which is due to the overhead of function calls to the BEAGLE library and the comparably modest speed improvement of BEAGLE for nucleotide substitution models. In terms of MCMC shortcuts, RevBayes outperformed all competing software (<xref ref-type="fig" rid="F2">Table 2</xref>). These benchmarks show that the graphical-model framework—which is generic and thus cannot use shortcuts specifically designed for a particular model—can compete in terms of computational efficiency with the most popular dedicated software used today.</p>
  </sec>
  <sec>
    <title>E<sc>xample</sc> A<sc>nalyses</sc></title>
    <p>Here, we provide examples that are based on tutorials using empirical data, which are available on our website <ext-link ext-link-type="uri" xlink:href="http://www.RevBayes.com">http://www.RevBayes.com</ext-link>. Our objective is to illustrate some of the features implemented in RevBayes, and to demonstrate the flexibility and explicitness of the graphical-model framework. Accordingly, we focus on the specification of the phylogenetic models, omitting specification of the analysis to save space.
<table-wrap id="T2" orientation="portrait" position="float"><label>T<sc>able</sc> 2.</label><caption><p>Comparing the efficiency of MCMC shortcuts in BEAST, MrBayes, and RevBayes.</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th align="left" rowspan="1" colspan="1">Software</th><th align="center" rowspan="1" colspan="1">NNI</th><th align="center" rowspan="1" colspan="1">Node-Slide</th></tr></thead><tbody align="left"><tr><td align="left" rowspan="1" colspan="1">BEAST v1.8</td><td align="center" rowspan="1" colspan="1">30.7</td><td align="center" rowspan="1" colspan="1">42.8</td></tr><tr><td align="left" rowspan="1" colspan="1">BEAST v1.8—BEAGLE</td><td align="center" rowspan="1" colspan="1">21.0</td><td align="center" rowspan="1" colspan="1">28.3</td></tr><tr><td align="left" rowspan="1" colspan="1">MrBayes 3.2</td><td align="center" rowspan="1" colspan="1">37.2</td><td align="center" rowspan="1" colspan="1">38.1</td></tr><tr><td align="left" rowspan="1" colspan="1">MrBayes 3.2—BEAGLE</td><td align="center" rowspan="1" colspan="1">42.6</td><td align="center" rowspan="1" colspan="1">31.9</td></tr><tr><td align="left" rowspan="1" colspan="1">RevBayes</td><td align="center" rowspan="1" colspan="1">17.8</td><td align="center" rowspan="1" colspan="1">23.5</td></tr></tbody></table><table-wrap-foot><fn id="NT12"><p><italic>Notes</italic>: The GTR substitution model (<xref rid="B71" ref-type="bibr">Tavaré 1986</xref>) was fixed but the tree was updated using either the Nearest Neighbor Interchange (NNI) or the Node-Slide move (<xref rid="B41" ref-type="bibr">Lakner et al. 2008</xref>; <xref rid="B29" ref-type="bibr">Höhna et al. 2008</xref>; <xref rid="B78" ref-type="bibr">Yang 2014</xref>). Other test conditions were identical to those described in <xref ref-type="table" rid="T1">Table 1</xref>.</p></fn></table-wrap-foot></table-wrap></p>
    <sec>
      <title>Molecular Phylogenetic Model</title>
      <p>We begin with a simple phylogenetic analysis of an unpartitioned molecular data set under the general time-reversible (GTR) substitution model (<xref rid="B71" ref-type="bibr">Tavaré 1986</xref>), with a constant-rate birth--death process as the prior distribution on the tree, and a constant substitution rate of 0.01 substitutions per million years per site (e.g., <xref rid="B28" ref-type="bibr">Ho et al. 2007</xref>) (<xref ref-type="fig" rid="F2">Figure 2</xref>). Note that the only two variables that are not declared are the <italic>data</italic> and the <italic>taxa</italic>, which are usually provided by the user. The inherent flexibility of this specification is readily apparent: we could, for example, estimate the speciation rate by defining a prior distribution for this parameter, for example, by using <italic>speciation <inline-formula><mml:math id="I9"><mml:mo>~</mml:mo></mml:math></inline-formula> dnExponential(10.0)</italic>. Similarly, we could easily substitute alternative substitution models, such as the HKY substitution model (<xref rid="B24" ref-type="bibr">Hasegawa et al. 1985</xref>) by replacing the <italic>fnGTR</italic> function with the <italic>fnHKY</italic> function. Or we could adopt an unconstrained (unrooted) tree by specifying a prior on unrooted trees (e.g., <italic>dnUniformTopology</italic>) and independent, exponentially distributed branch lengths instead of the birth--death process prior. We present some such extensions in the following model descriptions.
<fig id="F2" orientation="portrait" position="float"><label>F<sc>igure</sc> 2</label><caption><p>A simple phylogenetic
model depicted in graphical-model notation (left) and the corresponding specification in the Rev language (right). In graphical-model notation, constant variables are enclosed in boxes, stochastic variables are enclosed in solid circles, deterministic variables in stippled circles, and observations in shaded circles, with arrows indicating variable dependencies. For example, the root age (<inline-formula><mml:math id="I10"><mml:mrow><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>) is a random variable described by a uniform prior probability distribution with constant upper and lower bounds (in this case, 0 and 1000), the instantaneous-rate matrix, <inline-formula><mml:math id="I11"><mml:mi>Q</mml:mi></mml:math></inline-formula>, is a deterministic function of the base frequencies and exchangeability rates (<inline-formula><mml:math id="I12"><mml:mrow><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="I13"><mml:mrow><mml:mi>e</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:math></inline-formula>, respectively), and the observed sequences, <inline-formula><mml:math id="I14"><mml:mi>S</mml:mi></mml:math></inline-formula>, are realizations of the phylogenetic model that are clamped for inference. This model is mirrored in Rev code, where the first two lines create the birth--death process (with fixed speciation and extinction rates; <italic>lambda</italic>
<inline-formula><mml:math id="I15"><mml:mo>=</mml:mo></mml:math></inline-formula> 2.0 and <italic>mu</italic>
<inline-formula><mml:math id="I16"><mml:mo>=</mml:mo></mml:math></inline-formula> 1.0), and a uniform prior distribution on the root age. The following five lines instantiate the instantaneous-rate matrix for the GTR model, where both the base frequencies and exchangeability rates are drawn from flat Dirichlet distributions. Finally, we create the stochastic variable representing the character data drawn from the Phylo-CTMC (continuous-time Markov chain) process and attach (clamp) observations to the variable <italic>seq</italic>.</p></caption><graphic xlink:href="syw021f2"/></fig></p>
    </sec>
    <sec>
      <title>Partitioned-Data Models</title>
      <p>It is often important to partition a data set into multiple subsets to capture variation in the substitution process across the alignment (comprising multiple gene/genomic regions, codon positions of protein-coding genes, stem and loop regions of ribosomal genes, etc. <xref rid="B9" ref-type="bibr">Brown and Lemmon 2007</xref>). For example, we can extend the previous phylogenetic model by specifying independent base frequencies for each of <inline-formula><mml:math id="I17"><mml:mi>N</mml:mi></mml:math></inline-formula> data subsets (<xref ref-type="fig" rid="F3">Figure 3</xref>).
<fig id="F3" orientation="portrait" position="float"><label>F<sc>igure</sc> 3</label><caption><p>A partitioned-data model depicted in graphical-model notation (left) and the corresponding specification in the Rev language (right). Here, we extend the simple model depicted in <xref ref-type="fig" rid="F2">Figure 2</xref> by allowing base frequencies, <inline-formula><mml:math id="I18"><mml:mrow><mml:mi>p</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, to vary across the <inline-formula><mml:math id="I19"><mml:mi>N</mml:mi></mml:math></inline-formula> pre-specified data partitions (identical model components are grayed out). Graphically, this repetition is represented by the enclosure of the replicated variables within a dashed box, which is referred to as a “plate” (other aspects of the graphical-model notation follow the descriptions in <xref ref-type="fig" rid="F1">Figures 1</xref>–<xref ref-type="fig" rid="F2">2</xref>. In Rev, this repetition is specified using loops.</p></caption><graphic xlink:href="syw021f3"/></fig></p>
      <p>Again, this partitioned model can be modified in numerous ways, for example, by using independent exchangeability rates for all partitions. The user has complete control over specifying how parameters are shared across data subsets. Furthermore, any combination of substitution models is possible; for instance, we could specify a GTR substitution model for the first partition and an F81 substitution model (<xref rid="B14" ref-type="bibr">Felsenstein 1981</xref>) for the second partition, and so on.</p>
    </sec>
    <sec>
      <title>Relaxed-Clock Models</title>
      <p>We can specify relaxed-clock models to accommodate variation in substitution rates across branches. In this example, we allow each branch on the phylogenetic tree to have its own substitution rate that is drawn independently from a shared lognormal distribution; this is the uncorrelated lognormal (UCLN) branch-rate model (<xref rid="B10" ref-type="bibr">Drummond et al. 2006</xref>; <xref ref-type="fig" rid="F4">Figure 4</xref>).
<fig id="F4" orientation="portrait" position="float"><label>F<sc>igure </sc>4</label><caption><p>A relaxed-clock model
depicted in graphical-model notation (left) and the corresponding specification in the Rev language (right). Here, we extend the simple model depicted in <xref ref-type="fig" rid="F2">Figure 2</xref> by allowing substitution rates to vary across branches (identical model components are grayed out). Specifically, we invoke the UCLN branch-rate model (<xref rid="B10" ref-type="bibr">Drummond et al. 2006</xref>), which assumes that substitution rates on each of the <inline-formula><mml:math id="I20"><mml:mrow><mml:mn>2</mml:mn><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> branches are independent draws from a shared lognormal distribution, with constant hyperparameters specifying the mean (<inline-formula><mml:math id="I21"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) and standard deviation (<inline-formula><mml:math id="I22"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>). Graphical-model notation follows the descriptions in <xref ref-type="fig" rid="F1">Figures 1</xref>–<xref ref-type="fig" rid="F2">2</xref></p></caption><graphic xlink:href="syw021f4"/></fig></p>
      <p>The prior distribution on branch rates could just as easily be an exponential distribution or gamma distribution, or, in fact, any probability distribution defined for positive real numbers (<xref rid="B27" ref-type="bibr">Heath and Moore 2014</xref>). The graphical-model framework offers considerable flexibility in defining the relaxed-clock model, whether changes in substitution rate occur on branches or at nodes. The rates could be drawn from an autocorrelated process (<xref rid="B72" ref-type="bibr">Thorne et al. 1998</xref>; <xref rid="B73" ref-type="bibr">Thorne and Kishino 2002</xref>), any type of independent-rates model (<xref rid="B10" ref-type="bibr">Drummond et al. 2006</xref>; <xref rid="B50" ref-type="bibr">Lepage et al. 2007</xref>; <xref rid="B61" ref-type="bibr">Rannala and Yang 2007</xref>), a local-molecular clock model (<xref rid="B80" ref-type="bibr">Yang and Yoder 2003</xref>; <xref rid="B13" ref-type="bibr">Drummond and Suchard 2010</xref>), a Dirichlet process prior (<xref rid="B26" ref-type="bibr">Heath et al. 2012</xref>), or any other process. It is exceptionally easy to specify different relaxed-clock models in RevBayes because the Phylo-CTMC distribution can accommodate any vector of rates and does not restrict how those rates are defined. Accordingly, the user can readily substitute a new relaxed-clock model simply by changing the prior model describing how substitution rates vary across branches, thereby gaining access to the full flexibility of RevBayes.</p>
    </sec>
    <sec>
      <title>Gene-Tree Species-Tree Models</title>
      <p>RevBayes allows simultaneous inference of gene trees and species trees. In this example, we use a birth--death process prior on the species tree and a multispecies-coalescent process with constant, homogeneous population size as the prior for each gene tree (<xref rid="B60" ref-type="bibr">Rannala and Yang 2003</xref>; <xref ref-type="fig" rid="F5">Figure 5</xref>).
<fig id="F5" orientation="portrait" position="float"><label>F<sc>igure</sc> 5</label><caption><p>A species-tree model depicted in graphical-model notation (left) and the corresponding specification in the Rev language (right). Here, we extend the simple model depicted in Figure Ref{fig:molecular_model} by allowing the topology to vary across <inline-formula><mml:math id="I23"><mml:mi>N</mml:mi></mml:math></inline-formula> genes (identical model components are grayed out). Specifically, we invoke the multispecies-coalescent process (<xref rid="B60" ref-type="bibr">Rannala and Yang 2003</xref>) with constant population size, <inline-formula><mml:math id="I24"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula>, where we assume each gene has an independent substitution process, <inline-formula><mml:math id="I25"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, and gene-tree topology, <inline-formula><mml:math id="I26"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Graphical-model notation follows the descriptions in <xref ref-type="fig" rid="F1">Figures 1</xref>–<xref ref-type="fig" rid="F2">2</xref>.</p></caption><graphic xlink:href="syw021f5"/></fig></p>
      <p>Each gene tree is, in turn, used as a parameter of the Phylo-CTMC for the corresponding sequence data and can have its own substitution process, as defined in the partitioned-data example above. Current variations of this model include branch-specific population sizes. The choice of a prior distribution on the population size is only restricted to positive real numbers but otherwise can be any distribution. Additionally, RevBayes allows you to create any relationship between the gene trees and partition-specific substitution models; for example, data partitions with distinct substitution models can share the same gene trees, or data partitions with distinct gene trees can share the same substitution model.</p>
    </sec>
    <sec>
      <title>Discrete Morphological Models</title>
      <p>RevBayes provides several models for the analysis of discrete morphological data. Models of molecular evolution and discrete-trait evolution have a similar theoretical basis, with the main considerations being that invariant characters are typically not sampled in morphological data, and that the character states can be flipped without changing the meaning of the trait (i.e., changing all of the 0s to 1s and 1s to 0s\vpb{} does not alter the information in the discrete-trait data). In this example, we use the Jukes--Cantor instantaneous-rate matrix for binary traits, and accommodate among-trait rate variation using four discrete gamma categories (<xref rid="B76" ref-type="bibr">Yang 1996</xref>;<xref rid="B51" ref-type="bibr">Lewis 2001</xref>; <xref rid="B22" ref-type="bibr">Harrison and Larsson 2015</xref>; <xref ref-type="fig" rid="F6">Figure 6</xref>).
<fig id="F6" orientation="portrait" position="float"><label>F<sc>igure</sc> 6</label><caption><p>A discrete-trait model depicted in graphical-model notation (left) and the corresponding specification in the Rev language (right). Here, we modify the simple model depicted in Figure Ref{fig:molecular_model} by accommodating discrete morphological traits (identical model components are grayed out). Specifically, we invoke the <inline-formula><mml:math id="I27"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> model (<xref rid="B51" ref-type="bibr">Lewis 2001</xref>)—as a special case of the Jukes--Cantor model (<xref rid="B40" ref-type="bibr">Jukes and Cantor 1969</xref>)—with a discretized, mean-one gamma model, <inline-formula><mml:math id="I28"><mml:mi>Γ</mml:mi></mml:math></inline-formula>, to accommodate variation in the rate of evolution among traits (<xref rid="B76" ref-type="bibr">Yang 1996</xref>), which is controlled by the shape parameter, <inline-formula><mml:math id="I29"><mml:mi>α</mml:mi></mml:math></inline-formula>. Graphical-model notation follows the descriptions in <xref ref-type="fig" rid="F1">Figures 1</xref>–<xref ref-type="fig" rid="F2">2</xref></p></caption><graphic xlink:href="syw021f6"/></fig></p>
      <p>Many of the modeling choices for substitution models also apply to discrete-trait models. For example, morphological data can be partitioned, and rates of morphological evolution across branches can be described using various relaxed-clock models. Thus, in RevBayes we automatically gain a larger variety of models because each model only needs to be implemented once in order for it to be applied in combination with many other models.</p>
    </sec>
    <sec>
      <title>Continuous-Trait Models</title>
      <p>Continuous-trait evolution is conceptually different from discrete morphological evolution because it does not rely on an instantaneous-rate matrix. The simplest model of continuous-trait evolution is the Brownian-motion model (<xref rid="B15" ref-type="bibr">Felsenstein 1985</xref>). We can instantiate the Brownian-motion model in a way similar to the previous models (<xref ref-type="fig" rid="F7">Figure 7</xref>). The <italic>dnPhyloBrownianREML</italic> (phylogenetic Brownian motion using residual maximum likelihood) is a joint process on the continuous traits at the tips, which is equivalent to a full model (or data-augmented model) using a tree plate (Figure Ref{fig:treeplate_model}). Again, in Rev we use loops to represent any type of plate. The relative superiority of alternative representations of the same model depends on the application. For example, the residual maximum likelihood (REML) approach is faster to compute and allows more efficient mixing if the topology is unknown, whereas the data-augmented model automatically provides estimates for the values at the interior nodes of the tree and is more flexible. There are several extensions to the Brownian-motion model that have been implemented in RevBayes, such as the Ornstein--Uhlenbeck processes (<xref rid="B21" ref-type="bibr">Hansen 1997</xref>), Lévy jump processes (<xref rid="B43" ref-type="bibr">Landis et al. 2013b</xref>), and the multivariate normal distributed traits (<xref rid="B23" ref-type="bibr">Harvey and Pagel 1991</xref>; <xref rid="B47" ref-type="bibr">Lartillot and Poujol 2011</xref>) model. Additionally, all models and methods that can be applied to molecular data, for example, relaxed-clock models, can be applied to continuous-trait models.
<fig id="F7" orientation="portrait" position="float"><label>F<sc>igure</sc> 7</label><caption><p>A continuous-trait model depicted in graphical-model notation (left) and the corresponding specification in the Rev language (right). Here we use a fixed phylogeny, <inline-formula><mml:math id="I30"><mml:mrow><mml:mi>p</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula>, which is read in from a file. The rate of Brownian motion, <inline-formula><mml:math id="I31"><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:math></inline-formula>, is drawn from an exponential distribution with rate parameter 10. The observed traits, <inline-formula><mml:math id="I32"><mml:mi>T</mml:mi></mml:math></inline-formula>, are distributed according to a <italic>dnPhyloBrownianREML</italic>, which is a Brownian-motion process using the phylogenetic-independent contrasts method to integrate over the unobserved states at the internal nodes. Graphical-model notation follows the descriptions in <xref ref-type="fig" rid="F1">Figures 1</xref>–<xref ref-type="fig" rid="F2">2</xref>.</p></caption><graphic xlink:href="syw021f7"/></fig>
<fig id="F8" orientation="portrait" position="float"><label>F<sc>igure</sc> 8</label><caption><p>An alternative
continuous-trait model depicted in graphical-model notation (left) and the corresponding specification in the Rev language (right). Again, the phylogeny, <inline-formula><mml:math id="I33"><mml:mrow><mml:mi>p</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula>, is assumed to be known and the rate of the Brownian motion, <inline-formula><mml:math id="I34"><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:math></inline-formula>, is drawn from an exponential distribution with rate parameter 10. The root state, <inline-formula><mml:math id="I35"><mml:mrow><mml:mi>T</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>2</mml:mn><mml:mi>K</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="I36"><mml:mi>K</mml:mi></mml:math></inline-formula> is the number of tips, is drawn from a uniform distribution between <inline-formula><mml:math id="I37"><mml:mn>0</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="I38"><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>. The tree-plate notation explicitly specifies that traits evolve according to a normal distribution with mean <inline-formula><mml:math id="I39"><mml:mrow><mml:mi>T</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mo>.</mml:mo><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> (the trait value of the parent branch) and variance scaled by the branch length, <inline-formula><mml:math id="I40"><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi><mml:msup><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>*</mml:mo><mml:mi>p</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mo>.</mml:mo><mml:mi>b</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>L</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Only the values of the tips are clamped. Graphical-model notation follows the descriptions in <xref ref-type="fig" rid="F1">Figures 1</xref>–<xref ref-type="fig" rid="F2">2</xref>.</p></caption><graphic xlink:href="syw021f8"/></fig></p>
    </sec>
    <sec>
      <title>Biogeographic Models</title>
      <p>Our final example considers a simple dispersal, extirpation, and cladogenetic (DEC) model for a biogeographic inference (<xref rid="B63" ref-type="bibr">Ree et al. 2005</xref>). We assume <italic>iid</italic> dispersal rates between all areas and <italic>iid</italic> extirpation rates within all areas (<xref ref-type="fig" rid="F9">Figure 9</xref>). By explicitly creating each rate parameter, we gain full flexibility to model, for example, distance-dependent dispersal rates. The cladogenic Phylo-CTMC variant additionally integrates over state transitions that coincide with speciation. We have also implemented the data-augmented model described in <xref rid="B42" ref-type="bibr">Landis et al. (2013a</xref>), which enables biogeographic analyses for many areas. With RevBayes, one might instead model geographic position as an island-endemic or single-area character as proposed by <xref rid="B68" ref-type="bibr">Sanmartín et al. (2008</xref>) and <xref rid="B49" ref-type="bibr">Lemey et al. (2009</xref>) by adapting the discrete-morphological models described earlier.
<fig id="F9" orientation="portrait" position="float"><label>F<sc>igure</sc> 9</label><caption><p>A biogeographic model depicted in graphical-model notation (left) and the corresponding specification in the Rev language (right). Provided rates of dispersal (<inline-formula><mml:math id="I41"><mml:mi>d</mml:mi></mml:math></inline-formula>) and extirpation (<inline-formula><mml:math id="I42"><mml:mi>e</mml:mi></mml:math></inline-formula>), <inline-formula><mml:math id="I43"><mml:mi>Q</mml:mi></mml:math></inline-formula> encodes the instantaneous-rate matrix used to compute transition probabilities for range evolution during anagenesis (along branches). <inline-formula><mml:math id="I44"><mml:mi>P</mml:mi></mml:math></inline-formula> gives the transition probability of cladogenic events, where the probabilities of event types are given by the distribution, <inline-formula><mml:math id="I45"><mml:mi>c</mml:mi></mml:math></inline-formula>. Graphical-model notation follows the descriptions in <xref ref-type="fig" rid="F1">Figures 1</xref>–<xref ref-type="fig" rid="F2">2</xref>.</p></caption><graphic xlink:href="syw021f9"/></fig></p>
    </sec>
    <sec>
      <title>Joint Inference of Combined Data</title>
      <p>In the examples above, we described how to design analyses for different types of data. These analyses can be performed independently or jointly, as has been advocated by <xref rid="B57" ref-type="bibr">Nylander et al. (2004</xref>) and <xref rid="B66" ref-type="bibr">Ronquist et al. (2012a</xref>). Every analysis can be performed jointly if at least one variable in the model is shared. A shared variable will cause the resulting model graph to be connected, which is the only requirement in RevBayes. Note that we used the same variable for the tree (<italic>psi</italic>) for all the examples. Thus, we could jointly infer the phylogeny from molecular data, discrete morphological data, continuous-trait data, and biogeographic data. At the same time, we would accommodate uncertainty in the phylogeny when estimating parameters of the evolutionary process, such as the ancestral morphological states or species ranges.</p>
    </sec>
  </sec>
  <sec>
    <title>V<sc>alidation</sc></title>
    <p>The models used in the preceding examples have previously been described and tested in their original publications. Owing to its tremendous flexibility, it is impossible to present a detailed validation of all possible models that can be specified in RevBayes. Instead, we outline our efforts to validate our implementation.</p>
    <p>Our general strategy for validating our implementation of models in RevBayes entails several steps: (i) we directly compared the computed probabilities and/or function-return values in the C++ code (low-level comparison) to those of other established software, such as R, MrBayes, \Phycas, and \BEAST; (ii) we compared the computed probabilities and/or function-return values in small Rev examples (high-level comparison); (iii) we ran analyses on small data sets and compared the results to either MrBayes or \BEAST, where applicable.</p>
    <p>Most importantly, we implemented an automatic procedure to validate our implementation as follows. A developer or user specifies any model in Rev as if performing an analysis. Next, RevBayes simulates parameter values and data utilizing the imbedded simulation routines. Finally, RevBayes infers parameter estimates from the simulated data and checks how often the true parameters fall into a 90\% credible interval. The frequentist expectation of the credible intervals guarantees that 90\% of the simulations should recover the true parameters (<xref rid="B36" ref-type="bibr">Huelsenbeck and Rannala 2004</xref>). This procedure provides an unprecedented automatic feature to test and validate existing and new implementation in RevBayes.</p>
  </sec>
  <sec>
    <title>L<sc>imitations</sc></title>
    <p>Understandably, only a subset of all possible models are implemented in RevBayes. Nevertheless, the diversity of models implemented in RevBayes exceeds that of most other programs, such as MrBayes, owing to the immense flexibility for combining models using the Rev language. The addition of many other phylogenetic models will, of course, require extensions of the underlying C++ code. For example, it is currently not possible to specify models for gene-transfer or gene-duplication-and-loss that are available in other more specialized software (<xref rid="B3" ref-type="bibr">Arvestad et al. 2003</xref>; <xref rid="B70" ref-type="bibr">Szöllőosi et al. 2012</xref>; <xref rid="B7" ref-type="bibr">Boussau et al. 2013</xref>). As the development of RevBayes continues, such models will become available to users. The fact that not all conceivable models are currenly available in RevBayes, however, should not detract from its primary design strength: the capacity of RevBayes to easily add and extend existing models. We provide an overview of most of the currently implemented models in the RevBayes tutorials, which are available on our website <ext-link ext-link-type="uri" xlink:href="http://www.RevBayes.com">http://www.RevBayes.com</ext-link>.</p>
    <p>We note that the availability of a model by itself does not guarantee that it is possible to perform efficient (or even feasible) inference under that model. Instead, clever MCMC algorithms are often crucial for efficient exploration of parameter space, particularly for more complex models (e.g., <xref rid="B74" ref-type="bibr">Vaughan et al. 2014</xref>). From this perspective, the design of RevBayes offers several advantages. First, RevBayes provides a number of Monte Carlo algorithms—such as the Metropolis-Hastings (<xref rid="B56" ref-type="bibr">Metropolis et al. 1953</xref>; <xref rid="B25" ref-type="bibr">Hastings 1970</xref>), and the Metropolis-coupled MCMC (<xref rid="B18" ref-type="bibr">Gilks et al. 1996</xref>; <xref rid="B2" ref-type="bibr">Altekar et al. 2004</xref>) algorithms—that can be used interchangeably. Second, RevBayes provides a diverse array of proposal mechanisms that can be applied in various combinations to a given parameter to achieve efficient mixing. Third, RevBayes uses adaptive MCMC to automatically tune and optimize the proposal mechanisms (cf., <xref rid="B20" ref-type="bibr">Haario et al. 1999</xref>). %Fourth, proposal mechanisms can be added or exchanged without any constraint. Slow mixing is a common challenge of MCMC algorithms; RevBayes merely provides a new framework with many features to alleviate these issues.</p>
  </sec>
  <sec>
    <title>A<sc>vailability</sc></title>
    <p>RevBayes is open source and available from <ext-link ext-link-type="uri" xlink:href="https://github.com/revbayes">https://github.com/revbayes</ext-link>. It is freely available under GNU General Public License version 3.0. We are maintaining a website for RevBayes found at <ext-link ext-link-type="uri" xlink:href="http://www.RevBayes.com">http://www.RevBayes.com</ext-link> and a mailing list called <italic>revbayes-users</italic></p>
  </sec>
  <sec>
    <title>F<sc>unding</sc></title>
    <p>This work was supported by the Miller Institute for basic research in science [to S.H.]; National Science of Foundation (NSF) [grant DEB-1256993 to T.A.H.]; NSF [grants DEB-DEB-0842181, DEB-0919529, DBI-1356737, and DEB-1457835 to B.R.M.]; and the Swedish Research Council [grant 2011-5622 to F.R.].</p>
  </sec>
</body>
<back>
  <ack>
    <title>A<sc>cknowledgments</sc></title>
    <p>The authors wish to thank the National Evolutionary Synthesis Center (NESCent) for sponsoring the NESCent Academy Course entitled “Phylogenetic analysis using RevBayes”. The participants of this course provided extremely valuable feedback that significantly improved RevBayes and the Rev language. Furthermore, the developers of RevBayes acknowledge generous contributions from: Lars Arvestad, Daniel Ayres, Karen Cranston, Johan Dunfalk, Will Freyman, Laurent Guéguen, Mark Holder, Seraina Klopfstein, Bret Larget, Sibon Li, Ben Liebeskind, Mike May, Emily Jane McTavish, Conor Meehan, Will Pett, Ben Redelings, Felix Reichert, Isabel Sanmartín, Donald Simon, Tanja Stadler, Marc Suchard, Gergely Szölló́si, Paul van der Mark, April Wright, and Chi Zhang. Finally, we want to thank Paul Lewis, David Posada, Frank Anderson, and an anonymous reviewer for helpful comments on the manuscript.</p>
  </ack>
  <ref-list>
    <title>R<sc>eferences</sc></title>
    <ref id="B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aberer</surname><given-names>A.J.</given-names></name>, <name><surname>Kobert</surname><given-names>K.</given-names></name>, <name><surname>Stamatakis</surname><given-names>A.</given-names></name></person-group><year>2014</year><article-title>Exabayes: massively parallel Bayesian tree inference for the whole-genome era.</article-title><source>Mol. Biol. Evol.</source><volume>31</volume>:<fpage>2553</fpage>–<lpage>2556</lpage>.<pub-id pub-id-type="pmid">25135941</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altekar</surname><given-names>G.</given-names></name>, <name><surname>Dwarkadas</surname><given-names>S.</given-names></name>, <name><surname>Huelsenbeck</surname><given-names>J.P.</given-names></name>, <name><surname>Ronquist</surname><given-names>F.</given-names></name></person-group><year>2004</year><article-title>Parallel metropolis coupled Markov chain Monte Carlo for Bayesian phylogenetic inference.</article-title><source>Bioinformatics</source><volume>20</volume>:<fpage>407</fpage>–<lpage>415</lpage>.<pub-id pub-id-type="pmid">14960467</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arvestad</surname><given-names>L.</given-names></name>, <name><surname>Berglund</surname><given-names>A.-C.</given-names></name>, <name><surname>Lagergren</surname><given-names>J.</given-names></name>, <name><surname>Sennblad</surname><given-names>B.</given-names></name></person-group><year>2003</year><article-title>Bayesian gene/species tree reconciliation and orthology analysis using MCMC.</article-title><source>Bioinformatics</source><volume>19</volume>:<fpage>i7</fpage>–<lpage>i15</lpage>.<pub-id pub-id-type="pmid">12855432</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ayres</surname><given-names>D.L.</given-names></name>, <name><surname>Darling</surname><given-names>A.</given-names></name>, <name><surname>Zwickl</surname><given-names>D.J.</given-names></name>, <name><surname>Beerli</surname><given-names>P.</given-names></name>, <name><surname>Holder</surname><given-names>M.T.</given-names></name>, <name><surname>Lewis</surname><given-names>P.O.</given-names></name>, <name><surname>Huelsenbeck</surname><given-names>J.P.</given-names></name>, <name><surname>Ronquist</surname><given-names>F.</given-names></name>, <name><surname>Swofford</surname><given-names>D.L.</given-names></name>, <name><surname>Cummings</surname><given-names>M.P.</given-names></name>, <name><surname>Rambaut</surname><given-names>A.</given-names></name>, <name><surname>Suchard</surname><given-names>M.A.</given-names></name></person-group><year>2012</year><article-title>Beagle: an application programming interface and high-performance computing library for statistical phylogenetics.</article-title><source>Syst. Biol.</source><volume>61</volume>:<fpage>170</fpage>–<lpage>173</lpage>.<pub-id pub-id-type="pmid">21963610</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Besag</surname><given-names>J.</given-names></name>, <name><surname>Green</surname><given-names>P.J.</given-names></name></person-group><year>1993</year><article-title>Spatial statistics and Bayesian computation.</article-title><source>J. Roy. Stat. Soc. B Met.</source><volume>55</volume>:<fpage>25</fpage>–<lpage>37</lpage>.</mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bouckaert</surname><given-names>R.</given-names></name>, <name><surname>Heled</surname><given-names>J.</given-names></name>, <name><surname>Kühnert</surname><given-names>D.</given-names></name>, <name><surname>Vaughan</surname><given-names>T.</given-names></name>, <name><surname>Wu</surname><given-names>C.-H.</given-names></name>, <name><surname>Xie</surname><given-names>D.</given-names></name>, <name><surname>Suchard</surname><given-names>M.A.</given-names></name>, <name><surname>Rambaut</surname><given-names>A.</given-names></name>, <name><surname>Drummond</surname><given-names>A.J.</given-names></name></person-group><year>2014</year><article-title>BEAST 2: a software platform for Bayesian evolutionary analysis.</article-title><source>PLoS Comput. Biol.</source><volume>10</volume>:<comment>e1003537</comment>.</mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boussau</surname><given-names>B.</given-names></name>, <name><surname>Blanquart</surname><given-names>S.</given-names></name>, <name><surname>Necsulea</surname><given-names>A.</given-names></name>, <name><surname>Lartillot</surname><given-names>N.</given-names></name>, <name><surname>Gouy</surname><given-names>M.</given-names></name></person-group><year>2008</year><article-title>Parallel adaptations to high temperatures in the archaean eon.</article-title><source>Nature</source><volume>456</volume>:<fpage>942</fpage>–<lpage>945</lpage>.<pub-id pub-id-type="pmid">19037246</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boussau</surname><given-names>B.</given-names></name>, <name><surname>Szöllőosi</surname><given-names>G.J.</given-names></name>, <name><surname>Duret</surname><given-names>L.</given-names></name>, <name><surname>Gouy</surname><given-names>M.</given-names></name>, <name><surname>Tannier</surname><given-names>E.</given-names></name>, <name><surname>Daubin</surname><given-names>V.</given-names></name></person-group><year>2013</year><article-title>Genome-scale coestimation of species and gene trees.</article-title><source>Genome Res.</source><volume>23</volume>:<fpage>323</fpage>–<lpage>330</lpage>.<pub-id pub-id-type="pmid">23132911</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname><given-names>J.M.</given-names></name>, <name><surname>Lemmon</surname><given-names>A.R.</given-names></name></person-group><year>2007</year><article-title>The importance of data partitioning and the utility of Bayes factors in Bayesian phylogenetics.</article-title><source>Syst. Biol.</source><volume>56</volume>:<fpage>643</fpage>–<lpage>655</lpage>.<pub-id pub-id-type="pmid">17661232</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Drummond</surname><given-names>A.</given-names></name>, <name><surname>Ho</surname><given-names>S.</given-names></name>, <name><surname>Phillips</surname><given-names>M.</given-names></name>, <name><surname>Rambaut</surname><given-names>A.</given-names></name></person-group><year>2006</year><article-title>Relaxed phylogenetics and dating with confidence.</article-title><source>PLoS Biol.</source><volume>4</volume>:<fpage>e88</fpage>.<pub-id pub-id-type="pmid">16683862</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Drummond</surname><given-names>A.</given-names></name>, <name><surname>Rambaut</surname><given-names>A.</given-names></name></person-group><year>2007</year><article-title>BEAST: Bayesian evolutionary analysis sampling trees.</article-title><source>BMC Evol. Biol.</source><volume>7</volume>:<fpage>214</fpage>.<pub-id pub-id-type="pmid">17996036</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Drummond</surname><given-names>A.</given-names></name>, <name><surname>Suchard</surname><given-names>M.</given-names></name>, <name><surname>Xie</surname><given-names>D.</given-names></name>, <name><surname>Rambaut</surname><given-names>A.</given-names></name></person-group><year>2012</year><article-title>Bayesian phylogenetics with beauti and the beast 17.</article-title><source>Mol. Biol. Evol.</source><volume>29</volume>: <fpage>1969</fpage>–<lpage>1973</lpage>.<pub-id pub-id-type="pmid">22367748</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Drummond</surname><given-names>A.J.</given-names></name>, <name><surname>Suchard</surname><given-names>M.A.</given-names></name></person-group><year>2010</year><article-title>Bayesian random local clocks, or one rate to rule them all.</article-title><source>BMC Biol.</source><volume>8</volume>:<fpage>114</fpage>.<pub-id pub-id-type="pmid">20807414</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Felsenstein</surname><given-names>J.</given-names></name></person-group><year>1981</year><article-title>Evolutionary trees from DNA sequences: a maximum likelihood approach.</article-title><source>J. Mol. Evol.</source><volume>17</volume>:<fpage>368</fpage>–<lpage>376</lpage>.<pub-id pub-id-type="pmid">7288891</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Felsenstein</surname><given-names>J.</given-names></name></person-group><year>1985</year><article-title>Phylogenies and the comparative method.</article-title><source>Am. Nat.</source><volume>125</volume>:<fpage>1</fpage>–<lpage>15</lpage>.</mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Flouri</surname><given-names>T.</given-names></name>, <name><surname>Izquierdo-Carrasco</surname><given-names>F.</given-names></name>, <name><surname>Darriba</surname><given-names>D.</given-names></name>, <name><surname>Aberer</surname><given-names>A.</given-names></name>, <name><surname>Nguyen</surname><given-names>L.-T.</given-names></name>, <name><surname>Minh</surname><given-names>B.</given-names></name>, <name><surname>Von Haeseler</surname><given-names>A.</given-names></name>, <name><surname>Stamatakis</surname><given-names>A.</given-names></name></person-group><year>2015</year><article-title>The phylogenetic likelihood library.</article-title><source>Syst. Biol.</source><volume>64</volume>:<fpage>356</fpage>–<lpage>362</lpage>.<pub-id pub-id-type="pmid">25358969</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Galtier</surname><given-names>N.</given-names></name>, <name><surname>Gouy</surname><given-names>M.</given-names></name></person-group><year>1995</year><article-title>Inferring phylogenies from DNA sequences of unequal base compositions.</article-title><source>Proc. Natl Acad. Sci.</source><volume>92</volume>:<fpage>11317</fpage>–<lpage>11321</lpage>.<pub-id pub-id-type="pmid">7479987</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gilks</surname><given-names>W.</given-names></name>, <name><surname>Richardson</surname><given-names>S.</given-names></name>, <name><surname>Spiegelhalter</surname><given-names>D.</given-names></name></person-group><year>1996</year><article-title>Markov chain Monte Carlo in practice.</article-title><publisher-loc>London</publisher-loc>: <publisher-name>Chapman &amp; Hall/CRC</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Groussin</surname><given-names>M.</given-names></name>, <name><surname>Boussau</surname><given-names>B.</given-names></name>, <name><surname>Gouy</surname><given-names>M.</given-names></name></person-group><year>2013</year><article-title>A branch-heterogeneous model of protein evolution for efficient inference of ancestral sequences.</article-title><source>Syst. Biol.</source><volume>62</volume>:<fpage>523</fpage>–<lpage>538</lpage>.<pub-id pub-id-type="pmid">23475623</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haario</surname><given-names>H.</given-names></name>, <name><surname>Saksman</surname><given-names>E.</given-names></name>, <name><surname>Tamminen</surname><given-names>J.</given-names></name></person-group><year>1999</year><article-title>Adaptive proposal distribution for random walk Metropolis algorithm.</article-title><source>Comput. Stat.</source><volume>14</volume>:<fpage>375</fpage>–<lpage>396</lpage>.</mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hansen</surname><given-names>T.F.</given-names></name></person-group><year>1997</year><article-title>Stabilizing selection and the comparative analysis of adaptation.</article-title><source>Evolution</source><volume>51</volume>:<fpage>1341</fpage>–<lpage>1351</lpage>.</mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harrison</surname><given-names>L.B.</given-names></name>, <name><surname>Larsson,</surname><given-names>H.C.</given-names></name></person-group><year>2015</year><article-title>Among-character rate variation distributions in phylogenetic analysis of discrete morphological characters.</article-title><source>Syst. Biol.</source><volume>64</volume>:<fpage>307</fpage>–<lpage>324</lpage>.<pub-id pub-id-type="pmid">25527198</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Harvey</surname><given-names>P.H.</given-names></name>, <name><surname>Pagel</surname><given-names>M.D.</given-names></name></person-group><year>1991</year><article-title>The comparative method in evolutionary biology,</article-title><volume>Vol. 239</volume><publisher-loc>Oxford</publisher-loc>: <publisher-loc>Oxford university press</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hasegawa</surname><given-names>M.</given-names></name>, <name><surname>Kishino</surname><given-names>H.</given-names></name>, <name><surname>Yano</surname><given-names>T.</given-names></name></person-group><year>1985</year><article-title>Dating of the human-ape splitting by a molecular clock of mitochondrial DNA.</article-title><source>J. Mol. Evol.</source><volume>22</volume>:<fpage>160</fpage>–<lpage>174</lpage>.<pub-id pub-id-type="pmid">3934395</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hastings</surname><given-names>W.K.</given-names></name></person-group><year>1970</year><article-title>Monte Carlo sampling methods using Markov chains and their applications.</article-title><source>Biometrika</source><volume>57</volume>:<fpage>97</fpage>–<lpage>109</lpage>.</mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heath</surname><given-names>T.</given-names></name>, <name><surname>Holder</surname><given-names>M.</given-names></name>, <name><surname>Huelsenbeck</surname><given-names>J.</given-names></name></person-group><year>2012</year><article-title>A Dirichlet process prior for estimating lineage-specific substitution rates.</article-title><source>Mol. Biol. Evol.</source><volume>29</volume>:<fpage>939</fpage>–<lpage>955</lpage>.<pub-id pub-id-type="pmid">22049064</pub-id></mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Heath</surname><given-names>T.A.</given-names></name>, <name><surname>Moore</surname><given-names>B.R.</given-names></name></person-group><year>2014</year><article-title>Bayesian inference of species divergence times.</article-title> In: <person-group person-group-type="editor"><name><surname>Ming-Hui Chen</surname><given-names>L. K.</given-names></name>, <name><surname>Lewis</surname><given-names>P.</given-names></name></person-group>, editors. <article-title>Bayesian phylogenetics: methods, algorithms, and applications</article-title>. <publisher-loc>Sunderland, (MA)</publisher-loc>: <publisher-name>Sinauer Associates, p</publisher-name>
<fpage>487</fpage>–<lpage>533</lpage>.</mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ho</surname><given-names>S.Y.</given-names></name>, <name><surname>Shapiro</surname><given-names>B.</given-names></name>, <name><surname>Phillips</surname><given-names>M.J.</given-names></name>, <name><surname>Cooper</surname><given-names>A.</given-names></name>, <name><surname>Drummond</surname><given-names>A.J.</given-names></name></person-group><year>2007</year><article-title>Evidence for time dependency of molecular rate estimates.</article-title><source>Syst. Biol.</source><volume>56</volume>:<fpage>515</fpage>–<lpage>522</lpage>.<pub-id pub-id-type="pmid">17562475</pub-id></mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Höhna</surname><given-names>S.</given-names></name>, <name><surname>Defoin-Platel</surname><given-names>M.</given-names></name>, <name><surname>Drummond</surname><given-names>A.</given-names></name></person-group><year>2008</year><article-title>Clock-constrained tree proposal operators in Bayesian phylogenetic inference.</article-title><source>8th IEEE International Conference on Bioinformatics and Bioengineering (BIBE 2008)</source>, <publisher-loc>Athens, Greece</publisher-loc>, <comment>Oct 2008</comment>.</mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Höhna</surname><given-names>S.</given-names></name>, <name><surname>Drummond</surname><given-names>A.J.</given-names></name></person-group><year>2012</year><article-title>Guided tree topology proposals for Bayesian phylogenetic inference.</article-title><source>Syst. Biol.</source><volume>61</volume>:<fpage>1</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">21828081</pub-id></mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Höhna</surname><given-names>S.</given-names></name>, <name><surname>Heath</surname><given-names>T.A.</given-names></name>, <name><surname>Boussau</surname><given-names>B.</given-names></name>, <name><surname>Landis</surname><given-names>M.J.</given-names></name>, <name><surname>Ronquist</surname><given-names>F.</given-names></name>, <name><surname>Huelsenbeck</surname><given-names>J.P.</given-names></name></person-group><year>2014</year><article-title>Probabilistic graphical model representation in phylogenetics.</article-title><source>Syst. Biol.</source><volume>63</volume>:<fpage>753</fpage>–<lpage>771</lpage>.<pub-id pub-id-type="pmid">24951559</pub-id></mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Holder</surname><given-names>M.</given-names></name>, <name><surname>Lewis</surname><given-names>P.</given-names></name></person-group><year>2003</year><article-title>Phylogeny estimation: traditional and Bayesian approaches.</article-title><source>Nat. Rev. Genet.</source><volume>4</volume>:<fpage>275</fpage>.<pub-id pub-id-type="pmid">12671658</pub-id></mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huelsenbeck</surname><given-names>J.</given-names></name>, <name><surname>Larget</surname><given-names>B.</given-names></name>, <name><surname>Miller</surname><given-names>R.</given-names></name>, <name><surname>Ronquist</surname><given-names>F.</given-names></name></person-group><year>2002</year><article-title>Potential applications and pitfalls of Bayesian inference of phylogeny.</article-title><source>Syst. Biol.</source><volume>51</volume>:<fpage>673</fpage>–<lpage>688</lpage>.<pub-id pub-id-type="pmid">12396583</pub-id></mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huelsenbeck</surname><given-names>J.</given-names></name>, <name><surname>Ronquist</surname><given-names>F.</given-names></name></person-group><year>2001</year><article-title>MRBAYES: Bayesian inference of phylogenetic trees.</article-title><source>Bioinformatics</source><volume>17</volume>:<fpage>754</fpage>–<lpage>755</lpage>.<pub-id pub-id-type="pmid">11524383</pub-id></mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huelsenbeck</surname><given-names>J.</given-names></name>, <name><surname>Ronquist</surname><given-names>F.</given-names></name>, <name><surname>Nielsen</surname><given-names>R.</given-names></name>, <name><surname>Bollback</surname><given-names>J.</given-names></name></person-group><year>2001</year><article-title>Bayesian inference of phylogeny and its impact on evolutionary biology.</article-title><source>Science</source><volume>294</volume>:<fpage>2310</fpage>–<lpage>2314</lpage>.<pub-id pub-id-type="pmid">11743192</pub-id></mixed-citation>
    </ref>
    <ref id="B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huelsenbeck</surname><given-names>J.P.</given-names></name>, <name><surname>Larget</surname><given-names>B.</given-names></name>, <name><surname>Alfaro</surname><given-names>M.E.</given-names></name></person-group><year>2004</year><article-title>Bayesian phylogenetic model selection using reversible jump Markov chain Monte Carlo.</article-title><source>Mol. Biol. Evol.</source><volume>21</volume>:<fpage>1123</fpage>–<lpage>1133</lpage>.<pub-id pub-id-type="pmid">15034130</pub-id></mixed-citation>
    </ref>
    <ref id="B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huelsenbeck</surname><given-names>J.P.</given-names></name>, <name><surname>Larget</surname><given-names>B.</given-names></name>, <name><surname>Swofford</surname><given-names>D.L.</given-names></name></person-group><year>2000</year><article-title>A compound Poisson process for relaxing the molecular clock.</article-title><source>Genetics</source><volume>154</volume>:<fpage>1879</fpage>–<lpage>1892</lpage>.<pub-id pub-id-type="pmid">10747076</pub-id></mixed-citation>
    </ref>
    <ref id="B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huelsenbeck</surname><given-names>J.P.</given-names></name>, <name><surname>Rannala</surname><given-names>B.</given-names></name></person-group><year>2004</year><article-title>Frequentist properties of Bayesian posterior probabilities of phylogenetic trees under simple and complex substitution models.</article-title><source>Syst. Biol.</source><volume>53</volume>:<fpage>904</fpage>–<lpage>913</lpage>.<pub-id pub-id-type="pmid">15764559</pub-id></mixed-citation>
    </ref>
    <ref id="B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jordan</surname><given-names>M.</given-names></name></person-group><year>2004</year><article-title>Graphical models.</article-title><source>Stat. Sci.</source><volume>19</volume>:<fpage>140</fpage>–<lpage>155</lpage>.</mixed-citation>
    </ref>
    <ref id="B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jukes</surname><given-names>T.</given-names></name>, <name><surname>Cantor</surname><given-names>C.</given-names></name></person-group><year>1969</year><article-title>Evolution of protein molecules.</article-title><source>Mamm. Protein Metab.</source><volume>3</volume>:<fpage>21</fpage>–<lpage>132</lpage>.</mixed-citation>
    </ref>
    <ref id="B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lakner</surname><given-names>C.</given-names></name>, <name><surname>van der Mark</surname><given-names>P.</given-names></name>, <name><surname>Huelsenbeck</surname><given-names>J.P.</given-names></name>, <name><surname>Larget</surname><given-names>B.</given-names></name>, <name><surname>Ronquist</surname><given-names>F.</given-names></name></person-group><year>2008</year><article-title>Efficiency of Markov chain Monte Carlo tree proposals in Bayesian phylogenetics.</article-title><source>Syst. Biol.</source><volume>57</volume>:<fpage>86</fpage>–<lpage>103</lpage>.<pub-id pub-id-type="pmid">18278678</pub-id></mixed-citation>
    </ref>
    <ref id="B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Landis</surname><given-names>M.J.</given-names></name>, <name><surname>Matzke</surname><given-names>N.J.</given-names></name>, <name><surname>Moore</surname><given-names>B.R.</given-names></name>, <name><surname>Huelsenbeck</surname><given-names>J.P.</given-names></name></person-group><year>2013a</year><article-title>Bayesian analysis of biogeography when the number of areas is large.</article-title><source>Syst. Biol.</source><volume>62</volume>:<fpage>789</fpage>–<lpage>804</lpage>.<pub-id pub-id-type="pmid">23736102</pub-id></mixed-citation>
    </ref>
    <ref id="B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Landis</surname><given-names>M.J.</given-names></name>, <name><surname>Schraiber</surname><given-names>J.G.</given-names></name>, <name><surname>Liang</surname><given-names>M.</given-names></name></person-group><year>2013b</year><article-title>Phylogenetic analysis using lévy processes: finding jumps in the evolution of continuous traits.</article-title><source>Syst. Biol.</source><volume>62</volume>:<fpage>193</fpage>–<lpage>204</lpage>.<pub-id pub-id-type="pmid">23034385</pub-id></mixed-citation>
    </ref>
    <ref id="B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Larget</surname><given-names>B.</given-names></name>, <name><surname>Simon</surname><given-names>D.</given-names></name></person-group><year>1999</year><article-title>Markov chain Monte Carlo algorithms for the Bayesian analysis of phylogenetic trees.</article-title><source>Mol. Biol. Evol.</source><volume>16</volume>: <fpage>750</fpage>–<lpage>759</lpage>.</mixed-citation>
    </ref>
    <ref id="B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lartillot</surname><given-names>N.</given-names></name>, <name><surname>Brinkmann</surname><given-names>H.</given-names></name>, <name><surname>Philippe</surname><given-names>H.</given-names></name></person-group><year>2007</year><article-title>Suppression of long-branch attraction artefacts in the animal phylogeny using a site-heterogeneous model.</article-title><source>BMC Evol. Biol.</source><volume>7</volume>:<fpage>S4</fpage>.<pub-id pub-id-type="pmid">17288577</pub-id></mixed-citation>
    </ref>
    <ref id="B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lartillot</surname><given-names>N.</given-names></name>, <name><surname>LePage</surname><given-names>T.</given-names></name>, <name><surname>Blanquart</surname><given-names>S.</given-names></name></person-group><year>2009</year><article-title>Suppression of long-branch attraction artefacts in the animal phylogeny using a site-heterogeneous model.</article-title><source>Bioinformatics</source><volume>25</volume>:<fpage>2286</fpage>–<lpage>2288</lpage>.<pub-id pub-id-type="pmid">19535536</pub-id></mixed-citation>
    </ref>
    <ref id="B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lartillot</surname><given-names>N.</given-names></name>, <name><surname>Poujol</surname><given-names>R.</given-names></name></person-group><year>2011</year><article-title>A phylogenetic model for investigating correlated evolution of substitution rates and continuous phenotypic characters.</article-title><source>Mol. Biol. Evol.</source><volume>28</volume>:<fpage>729</fpage>–<lpage>744</lpage>.<pub-id pub-id-type="pmid">20926596</pub-id></mixed-citation>
    </ref>
    <ref id="B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leebens-Mack</surname><given-names>J.</given-names></name>, <name><surname>Vision</surname><given-names>T.</given-names></name>, <name><surname>Brenner</surname><given-names>E.</given-names></name>, <name><surname>Bowers</surname><given-names>J.E.</given-names></name>, <name><surname>Cannon</surname><given-names>S.</given-names></name>, <name><surname>Clement</surname><given-names>M.J.</given-names></name>, <name><surname>Cunningham</surname><given-names>C.W.</given-names></name>, <name><surname>dePamphilis</surname><given-names>C.</given-names></name>, <name><surname>deSalle</surname><given-names>R.</given-names></name>, <name><surname>Doyle</surname><given-names>J.J.</given-names></name>, <name><surname>Eisen</surname><given-names>J.A.</given-names></name>, <name><surname>Gu</surname><given-names>X.</given-names></name>, <name><surname>Harshman</surname><given-names>J.</given-names></name>, <name><surname>Jansen</surname><given-names>R.K.</given-names></name>, <name><surname>Kellogg</surname><given-names>E.A.</given-names></name>, <name><surname>Koonin</surname><given-names>E.V.</given-names></name>, <name><surname>Mishler</surname><given-names>B.D.</given-names></name>, <name><surname>Philippe</surname><given-names>H.</given-names></name>, <name><surname>Pires</surname><given-names>J.C.</given-names></name>, <name><surname>Qiu</surname><given-names>Y.-L.L.</given-names></name>, <name><surname>Rhee</surname><given-names>S.Y.</given-names></name>, <name><surname>Sjölander</surname><given-names>K.</given-names></name>, <name><surname>Soltis</surname><given-names>D.E.</given-names></name>, <name><surname>Soltis</surname><given-names>P.S.</given-names></name>, <name><surname>Stevenson</surname><given-names>D.W.</given-names></name>, <name><surname>Wall</surname><given-names>K.</given-names></name>, <name><surname>Warnow</surname><given-names>T.</given-names></name>, <name><surname>Zmasek</surname><given-names>C.</given-names></name></person-group><year>2006</year><article-title>Taking the first steps towards a standard for reporting on phylogenies: minimum information about a phylogenetic analysis (MIAPA).</article-title><source>OMICS</source><volume>10</volume>:<fpage>231</fpage>–<lpage>237</lpage>.<pub-id pub-id-type="pmid">16901231</pub-id></mixed-citation>
    </ref>
    <ref id="B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lemey</surname><given-names>P.</given-names></name>, <name><surname>Rambaut</surname><given-names>A.</given-names></name>, <name><surname>Drummond</surname><given-names>A.J.</given-names></name>, <name><surname>Suchard</surname><given-names>M.A.</given-names></name></person-group><year>2009</year><article-title>Bayesian phylogeography finds its roots.</article-title><source>PLoS Computat. Biol.</source><volume>5</volume>:<fpage>e1000520</fpage>.</mixed-citation>
    </ref>
    <ref id="B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lepage</surname><given-names>T.</given-names></name>, <name><surname>Bryant</surname><given-names>D.</given-names></name>, <name><surname>Philippe</surname><given-names>H.</given-names></name>, <name><surname>Lartillot</surname><given-names>N.</given-names></name></person-group><year>2007</year><article-title>A general comparison of relaxed molecular clock models.</article-title><source>Mol. Biol. Evol.</source><volume>24</volume>:<fpage>2669</fpage>–<lpage>2680</lpage>.<pub-id pub-id-type="pmid">17890241</pub-id></mixed-citation>
    </ref>
    <ref id="B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lewis</surname><given-names>P.O.</given-names></name></person-group><year>2001</year><article-title>A likelihood approach to estimating phylogeny from discrete morphological character data.</article-title><source>Syst. Biol.</source><volume>50</volume>:<fpage>913</fpage>–<lpage>925</lpage>.<pub-id pub-id-type="pmid">12116640</pub-id></mixed-citation>
    </ref>
    <ref id="B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lewis</surname><given-names>P.O.</given-names></name></person-group><year>2003</year><article-title>Ncl: a c++ class library for interpreting data files in nexus format.</article-title><source>Bioinformatics</source><volume>19</volume>:<fpage>2330</fpage>–<lpage>2331</lpage>.<pub-id pub-id-type="pmid">14630669</pub-id></mixed-citation>
    </ref>
    <ref id="B53">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lewis</surname><given-names>P.O.</given-names></name>, <name><surname>Holder</surname><given-names>M.T.</given-names></name>, <name><surname>Swofford</surname><given-names>D.L.</given-names></name></person-group><year>2015</year><article-title>Phycas: Software for bayesian phylogenetic analysis.</article-title><source>Syst. Biol.</source><volume>64</volume>:<fpage>525</fpage>–<lpage>531</lpage>.<pub-id pub-id-type="pmid">25577605</pub-id></mixed-citation>
    </ref>
    <ref id="B54">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>S.</given-names></name>, <name><surname>Pearl</surname><given-names>D.K.</given-names></name>, <name><surname>Doss</surname><given-names>H.</given-names></name></person-group><year>2000</year><article-title>Phylogenetic tree construction using Markov chain Monte Carlo.</article-title><source>J. Am. Stat. Assoc.</source><volume>95</volume>:<fpage>493</fpage>–<lpage>508</lpage>.</mixed-citation>
    </ref>
    <ref id="B55">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lunn</surname><given-names>D.</given-names></name>, <name><surname>Spiegelhalter</surname><given-names>D.</given-names></name>, <name><surname>Thomas</surname><given-names>A.</given-names></name>, <name><surname>Best</surname><given-names>N.</given-names></name></person-group><year>2009</year><article-title>The bugs project: evolution, critique and future directions.</article-title><source>Stat. Med.</source><volume>28</volume>:<fpage>3049</fpage>–<lpage>3067</lpage>.<pub-id pub-id-type="pmid">19630097</pub-id></mixed-citation>
    </ref>
    <ref id="B56">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Metropolis</surname><given-names>N.</given-names></name>, <name><surname>Rosenbluth</surname><given-names>A.</given-names></name>, <name><surname>Rosenbluth</surname><given-names>M.</given-names></name>, <name><surname>Teller</surname><given-names>A.</given-names></name>, <name><surname>Teller</surname><given-names>E.</given-names></name></person-group><year>1953</year><article-title>Equation of state calculations by fast computing machines.</article-title><source>J. Chem. Phys.</source><volume>21</volume>:<fpage>1087</fpage>–<lpage>1092</lpage>.</mixed-citation>
    </ref>
    <ref id="B57">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nylander</surname><given-names>J.A.</given-names></name>, <name><surname>Ronquist</surname><given-names>F.</given-names></name>, <name><surname>Huelsenbeck</surname><given-names>J.P.</given-names></name>, <name><surname>Nieves-Aldrey</surname><given-names>J.</given-names></name></person-group><year>2004</year><article-title>Bayesian phylogenetic analysis of combined data.</article-title><source>Syst. Biol.</source><volume>53</volume>: <fpage>47</fpage>–<lpage>67</lpage>.<pub-id pub-id-type="pmid">14965900</pub-id></mixed-citation>
    </ref>
    <ref id="B58">
      <mixed-citation publication-type="book"><collab>R Core Team</collab>. <year>2014</year><article-title>R: a language and environment for statistical computing.</article-title><publisher-loc>Vienna, Austria</publisher-loc>: <publisher-name>R Foundation for Statistical Computing</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B59">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rannala</surname><given-names>B.</given-names></name>, <name><surname>Yang</surname><given-names>Z.</given-names></name></person-group><year>1996</year><article-title>Probability distribution of molecular evolutionary trees: A new method of phylogenetic inference.</article-title><source>J. Mol. Evol.</source><volume>43</volume>:<fpage>304</fpage>–<lpage>311</lpage>.<pub-id pub-id-type="pmid">8703097</pub-id></mixed-citation>
    </ref>
    <ref id="B60">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rannala</surname><given-names>B.</given-names></name>, <name><surname>Yang</surname><given-names>Z.</given-names></name></person-group><year>2003</year><article-title>Bayes estimation of species divergence times and ancestral population sizes using DNA sequences from multiple loci.</article-title><source>Genetics</source><volume>164</volume>:<fpage>1645</fpage>–<lpage>1656</lpage>.<pub-id pub-id-type="pmid">12930768</pub-id></mixed-citation>
    </ref>
    <ref id="B61">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rannala</surname><given-names>B.</given-names></name>, <name><surname>Yang</surname><given-names>Z.</given-names></name></person-group><year>2007</year><article-title>Inferring speciation times under an episodic molecular clock.</article-title><source>Syst. Biol.</source><volume>56</volume>:<fpage>453</fpage>–<lpage>466</lpage>.<pub-id pub-id-type="pmid">17558967</pub-id></mixed-citation>
    </ref>
    <ref id="B62">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Redelings</surname><given-names>B.</given-names></name>, <name><surname>Suchard</surname><given-names>M.</given-names></name></person-group><year>2005</year><article-title>Joint Bayesian estimation of alignment and phylogeny.</article-title><source>Syst. Biol.</source><volume>54</volume>:<fpage>401</fpage>–<lpage>418</lpage>.<pub-id pub-id-type="pmid">16012107</pub-id></mixed-citation>
    </ref>
    <ref id="B63">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ree</surname><given-names>R.H.</given-names></name>, <name><surname>Moore</surname><given-names>B.R.</given-names></name>, <name><surname>Webb</surname><given-names>C.O.</given-names></name>, <name><surname>Donoghue</surname><given-names>M.J.</given-names></name></person-group><year>2005</year><article-title>A likelihood framework for inferring the evolution of geographic range on phylogenetic trees.</article-title><source>Evolution</source><volume>59</volume>:<fpage>2299</fpage>–<lpage>2311</lpage>.<pub-id pub-id-type="pmid">16396171</pub-id></mixed-citation>
    </ref>
    <ref id="B64">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ronquist</surname><given-names>F.</given-names></name>, <name><surname>Deans</surname><given-names>A.</given-names></name></person-group><year>2010</year><article-title>Bayesian phylogenetics and its influence on insect systematics.</article-title><source>Annu. Rev. Entomol.</source><volume>55</volume>:<fpage>189</fpage>–<lpage>206</lpage>.<pub-id pub-id-type="pmid">19961329</pub-id></mixed-citation>
    </ref>
    <ref id="B65">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ronquist</surname><given-names>F.</given-names></name>, <name><surname>Huelsenbeck</surname><given-names>J.</given-names></name></person-group><year>2003</year><article-title>MrBayes 3: Bayesian phylogenetic inference under mixed models.</article-title><source>Bioinformatics</source><volume>19</volume>:<fpage>1572</fpage>–<lpage>1574</lpage>.<pub-id pub-id-type="pmid">12912839</pub-id></mixed-citation>
    </ref>
    <ref id="B66">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ronquist</surname><given-names>F.</given-names></name>, <name><surname>Klopfstein</surname><given-names>S.</given-names></name>, <name><surname>Vilhelmsen</surname><given-names>L.</given-names></name>, <name><surname>Schulmeister</surname><given-names>S.</given-names></name>, <name><surname>Murray</surname><given-names>D.L.</given-names></name>, <name><surname>Rasnitsyn</surname><given-names>A.P.</given-names></name></person-group><year>2012</year>a. A total-evidence approach to dating with fossils, applied to the early radiation of the hymenoptera. Syst. Biol. <volume>61</volume>:<fpage>973</fpage>–<lpage>999</lpage>.</mixed-citation>
    </ref>
    <ref id="B67">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ronquist</surname><given-names>F.</given-names></name>, <name><surname>Teslenko</surname><given-names>M.</given-names></name>, van der Mark P., <name><surname>Ayres</surname><given-names>D.L.</given-names></name>, <name><surname>Darling</surname><given-names>A.</given-names></name>, <name><surname>Höhna</surname><given-names>S.</given-names></name>, <name><surname>Larget</surname><given-names>B.</given-names></name>, <name><surname>Liu</surname><given-names>L.</given-names></name>, <name><surname>Suchard</surname><given-names>M.A.</given-names></name>, <name><surname>Huelsenbeck</surname><given-names>J.P.</given-names></name></person-group><year>2012b</year><article-title>MrBayes 3.</article-title>2: efficient Bayesian phylogenetic inference and model choice across a large model space. Syst. Biol. <volume>61</volume>:<fpage>539</fpage>–<lpage>542</lpage>.</mixed-citation>
    </ref>
    <ref id="B68">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sanmartín</surname><given-names>I.</given-names></name>, <name><surname>van der Mark</surname><given-names>P.</given-names></name>, <name><surname>Ronquist</surname><given-names>F.</given-names></name></person-group><year>2008</year><article-title>Inferring dispersal: a Bayesian approach to phylogeny-based island biogeography, with special reference to the Canary Islands.</article-title><source>J. Biogeogr.</source><volume>35</volume>:<fpage>428</fpage>–<lpage>449</lpage>.</mixed-citation>
    </ref>
    <ref id="B69">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Suchard</surname><given-names>M.A.</given-names></name>, <name><surname>Redelings</surname><given-names>B.D.</given-names></name></person-group><year>2006</year><article-title>Bali-phy: simultaneous Bayesian inference of alignment and phylogeny.</article-title><source>Bioinformatics</source><volume>22</volume>:<fpage>2047</fpage>–<lpage>2048</lpage>.<pub-id pub-id-type="pmid">16679334</pub-id></mixed-citation>
    </ref>
    <ref id="B70">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Szöllőosi</surname><given-names>G.J.</given-names></name>, <name><surname>Boussau</surname><given-names>B.</given-names></name>, <name><surname>Abby</surname><given-names>S.S.</given-names></name>, <name><surname>Tannier</surname><given-names>E.</given-names></name>, <name><surname>Daubin</surname><given-names>V.</given-names></name></person-group><year>2012</year><article-title>Phylogenetic modeling of lateral gene transfer reconstructs the pattern and relative timing of speciations.</article-title><source>Proc. Natl Acad. Sci.</source><volume>109</volume>:<fpage>17513</fpage>–<lpage>17518</lpage>.<pub-id pub-id-type="pmid">23043116</pub-id></mixed-citation>
    </ref>
    <ref id="B71">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Tavaré</surname><given-names>S.</given-names></name></person-group><year>1986</year><article-title>Some probabilistic and statistical problems in the analysis of DNA sequences.</article-title> In: <person-group person-group-type="editor"><name><surname>Miura</surname><given-names>R.M.</given-names></name></person-group>, editor. <source>Some mathematical questions in biology DNA sequence analysis</source>, <volume>Vol. 17</volume>
<publisher-name>American Mathematical Society</publisher-name>, <publisher-loc>Providence (RI)</publisher-loc>, p. <fpage>57</fpage>–<lpage>86</lpage>.</mixed-citation>
    </ref>
    <ref id="B72">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thorne</surname><given-names>J.</given-names></name>, <name><surname>Kishino</surname><given-names>H.</given-names></name>, <name><surname>Painter</surname><given-names>I.S.</given-names></name></person-group><year>1998</year><article-title>Estimating the rate of evolution of the rate of molecular evolution.</article-title><source>Mol. Biol. Evol.</source><volume>15</volume>:<fpage>1647</fpage>–<lpage>1657</lpage>.<pub-id pub-id-type="pmid">9866200</pub-id></mixed-citation>
    </ref>
    <ref id="B73">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thorne</surname><given-names>J.L.</given-names></name>, <name><surname>Kishino</surname><given-names>H.</given-names></name></person-group><year>2002</year><article-title>Divergence time and evolutionary rate estimation with multilocus data.</article-title><source>Syst. Biol.</source><volume>51</volume>:<fpage>689</fpage>–<lpage>702</lpage>.<pub-id pub-id-type="pmid">12396584</pub-id></mixed-citation>
    </ref>
    <ref id="B74">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vaughan</surname><given-names>T.G.</given-names></name>, <name><surname>Kühnert</surname><given-names>D.</given-names></name>, <name><surname>Popinga</surname><given-names>A.</given-names></name>, <name><surname>Welch</surname><given-names>D.</given-names></name>, <name><surname>Drummond</surname><given-names>A.J.</given-names></name></person-group><year>2014</year><article-title>Efficient Bayesian inference under the structured coalescent.</article-title><source>Bioinformatics</source><volume>30</volume>:<fpage>2272</fpage>–<lpage>2279</lpage>.<pub-id pub-id-type="pmid">24753484</pub-id></mixed-citation>
    </ref>
    <ref id="B75">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z.</given-names></name></person-group><year>1994</year><article-title>Maximum likelihood phylogenetic estimation from DNA sequences with variable rates over sites: approximate methods.</article-title><source>J. Mol. Evol.</source><volume>39</volume>:<fpage>306</fpage>–<lpage>314</lpage>.<pub-id pub-id-type="pmid">7932792</pub-id></mixed-citation>
    </ref>
    <ref id="B76">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z.</given-names></name></person-group><year>1996</year><article-title>Among-site rate variation and its impact on phylogenetic analyses.</article-title><source>Trends in Ecol.&amp;Evol.</source><volume>11</volume>:<fpage>367</fpage>–<lpage>372</lpage>.</mixed-citation>
    </ref>
    <ref id="B77">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z.</given-names></name></person-group><year>2007</year><article-title>PAML 4: phylogenetic analysis by maximum likelihood.</article-title><source>Mol. Biol. Evol.</source><volume>24</volume>:<fpage>1586</fpage>–<lpage>1591</lpage>.<pub-id pub-id-type="pmid">17483113</pub-id></mixed-citation>
    </ref>
    <ref id="B78">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z.</given-names></name></person-group><year>2014</year><article-title>Molecular evolution: A statistical approach.</article-title><publisher-loc>Oxford, UK</publisher-loc>:</mixed-citation>
    </ref>
    <ref id="B79">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z.</given-names></name>, <name><surname>Rannala</surname><given-names>B.</given-names></name></person-group><year>2012</year><article-title>Molecular phylogenetics: principles and practice.</article-title><source>Nat. Rev. Genet.</source><volume>13</volume>:<fpage>303</fpage>–<lpage>314</lpage>.<pub-id pub-id-type="pmid">22456349</pub-id></mixed-citation>
    </ref>
    <ref id="B80">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z.</given-names></name>, <name><surname>Yoder</surname><given-names>A.D.</given-names></name></person-group><year>2003</year><article-title>Comparison of likelihood and Bayesian methods for estimating divergence times using multiple gene loci and calibration points, with application to a radiation of cute-looking mouse lemur species.</article-title><source>Syst. Biol.</source><volume>52</volume>:<fpage>705</fpage>–<lpage>716</lpage>.<pub-id pub-id-type="pmid">14530137</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
