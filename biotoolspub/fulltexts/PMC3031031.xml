<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3031031</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btq656</article-id>
    <article-id pub-id-type="publisher-id">btq656</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group>
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ABMapper: a suffix array-based tool for multi-location searching and splice-junction mapping</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lou</surname>
          <given-names>Shao-Ke</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
        <xref ref-type="author-notes" rid="FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ni</surname>
          <given-names>Bing</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
        <xref ref-type="author-notes" rid="FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lo</surname>
          <given-names>Leung-Yau</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tsui</surname>
          <given-names>Stephen Kwok-Wing</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chan</surname>
          <given-names>Ting-Fung</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Leung</surname>
          <given-names>Kwong-Sak</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup>Hong Kong Bioinformatics Centre, <sup>2</sup>School of Life Sciences, <sup>3</sup>Department of Computer Science and Engineering, and <sup>4</sup>School of Biomedical Sciences, The Chinese University of Hong Kong, Shatin NT, Hong Kong SAR</aff>
    <author-notes>
      <corresp id="COR1">* To whom correspondence should be addressed.</corresp>
      <fn id="FN1">
        <p><sup>†</sup> The authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First Authors.</p>
      </fn>
      <fn>
        <p>Associate Editor: Alex Bateman</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>1</day>
      <month>2</month>
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>12</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>12</month>
      <year>2010</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>27</volume>
    <issue>3</issue>
    <fpage>421</fpage>
    <lpage>422</lpage>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>7</month>
        <year>2010</year>
      </date>
      <date date-type="rev-recd">
        <day>18</day>
        <month>11</month>
        <year>2010</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>11</month>
        <year>2010</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2010. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2010</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.5">http://creativecommons.org/licenses/by-nc/2.5</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> Sequencing reads generated by RNA-sequencing (RNA-seq) must first be mapped back to the genome through alignment before they can be further analyzed. Current fast and memory-saving short-read mappers could give us a quick view of the transcriptome. However, they are neither designed for reads that span across splice junctions nor for repetitive reads, which can be mapped to multiple locations in the genome (multi-reads). Here, we describe a new software package: ABMapper, which is specifically designed for exploring all putative locations of reads that are mapped to splice junctions or repetitive in nature.</p>
      <p><bold>Availability and Implementation:</bold> The software is freely available at: <ext-link ext-link-type="uri" xlink:href="http://abmapper.sourceforge.net/">http://abmapper.sourceforge.net/</ext-link>. The software is written in C++ and PERL. It runs on all major platforms and operating systems including Windows, Mac OS X and LINUX.</p>
      <p>
        <bold>Contact:</bold>
        <email>tf.chan@cuhk.edu.hk</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq656/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>The advent of RNA-seq technology has dramatically transformed transcriptomics within just a few years (<xref ref-type="bibr" rid="B7">Wang <italic>et al.</italic>, 2009</xref>). The next-generation sequencing platform can generate far more data per experiment than traditional sequencing technology. Millions of short, sometimes paired-end reads have brought about new challenges: to map them back onto the genome for determining gene expression level and for detecting splicing events.</p>
    <p>Two groups, Li <italic>et al.</italic> and Langmead <italic>et al.</italic> have developed short-read alignment tools based on the Burrow–Wheeler transformation algorithm (<xref ref-type="bibr" rid="B3">Burrows and Wheeler, 1994</xref>), which runs fast and with low memory requirement (<xref ref-type="bibr" rid="B4">Langmead <italic>et al.</italic>, 2009</xref>; <xref ref-type="bibr" rid="B5">Li and Durbin, 2009</xref>). A major drawback of these fast aligners is that they require reads to map to contiguous genomic sequence, and thus are not appropriate for reads spanning splice junctions. SplitSeek (<xref ref-type="bibr" rid="B1">Ameur <italic>et al.</italic>, 2010</xref>), TopHat (<xref ref-type="bibr" rid="B6">Trapnell <italic>et al.</italic>, 2009</xref>) and SpliceMap (<xref ref-type="bibr" rid="B2">Au <italic>et al.</italic>, 2010</xref>) are three widely known software packages written to make up for the lack of ability of these short-read aligners for splice site identification. However, these tools have to rely on output from existing aligners: TopHat requires bowtie; SpliceMap requires ELAND or bowtie; and SplitSeek depends on the SOLiD Whole Transcriptome analysis pipeline and is therefore restricted only to SOLiD dataset.</p>
    <p>In this work, we present ABMapper, which has been developed as a stand-alone tool for <italic>ab initio</italic> mapping of sequencing reads that span across splicing junctions or reads that have multiple putative locations within the genome. It adopts a fast suffix-array algorithm and a dual-seed strategy to find all putative locations of reads.</p>
  </sec>
  <sec sec-type="methods" id="SEC2">
    <title>2 METHODS</title>
    <sec sec-type="intro" id="SEC2.1">
      <title>2.1 Overview</title>
      <p>ABMapper is a portable, easy-to-use package for spliced alignment, splice site detection and read mapping. The core module was written in C++ and wrapped in PERL scripts, and the executable file can be called by: Perl runABMapper.pl—ref chromosome list—input reads (.fa or .fq)</p>
      <p>Full documentation is available from the associated web site.</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Algorithm</title>
      <p>Reference genomic sequences are first indexed into <italic>k</italic>mers with a user-defined <italic>k</italic>, i.e. the respective suffix array consisting of all the <italic>k</italic>mers of the genome is built. After indexing, for every read being mapped, two seeds (namely A and B, by which the name of this tool was derived) with each at length <italic>k</italic> from each end of the read are retrieved and extended toward each other through alignment by steps as illustrated in <xref ref-type="fig" rid="F1">Figure 1</xref>.
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Workflow of ABMapper. (1) ‘A’ and ‘B’ refer to the two seeds from each end of a read. (2) Hits that are found within the genome (black line) matching the two seeds are represented by bars with the corresponding labels (A: a1, a2, a3; similarly for B). Finally, seeds are extended during (3a) exonic alignment; and (3b) spliced alignment.</p></caption><graphic xlink:href="btq656f1"/></fig></p>
      <p>Two possible scenarios could arise during a seed extension: without or with splice junctions. For the first case, the fully matched alignment without splicing (3.a in <xref ref-type="fig" rid="F1">Fig. 1</xref>), which is termed ‘exonic alignment’, only extends from one seed. For the second case, which is termed ‘spliced alignment’, one seed from each end of a read (3.b in <xref ref-type="fig" rid="F1">Fig. 1</xref>) will be extended toward each other until a stop point is reached. A good spliced alignment is defined as two extended fragments that could form a complete read. However, a seed could sometimes be extended beyond its real stop point, especially when errors are allowed. In such cases, an overlapping tolerance would be used, which allows the sum of the lengths of the two extensions to be larger than the length of the read. The two overlapped fragments would then be subjected to canonical splicing motifs search, i.e. ‘GT-AG’, ‘GC-AG’ and ‘AT-AC’, to determine a stop point for spliced alignment. The above steps are performed for one chromosome at a time. Finally, outputs including alignment details, junction sites, putative locations of repetitive reads, etc., which depend on user's parameter, will be reported.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>3 RESULTS</title>
    <p>We chose 213 893 reads, each with the size of 75 bp that cover all human known junction sites, and the same number of reads from the exons of human genome to compare the results of ABMapper (version 2.0.3; seed length = 11; maximum output <italic>m</italic> = 500 and output format <italic>t</italic> = 1) with SpliceMap (version 3.1.1) and TopHat (version 1.0.13). Performance of the three software packages are summarized in <xref ref-type="table" rid="T1">Table 1</xref>. Additional performance data of ABMapper, as well as resource usage of the three programs can be found in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq656/DC1">Supplementary Material</ext-link>.
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Comparison between TopHat (TH), SpliceMap (SM) and ABMapper (ABM)</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Total read = 427 786</th><th colspan="3" rowspan="1">sp.fa<hr/></th><th colspan="3" rowspan="1">sp_e1.fa<hr/></th><th colspan="3" rowspan="1">sp_e2.fa<hr/></th></tr><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">TH</th><th rowspan="1" colspan="1">SM</th><th rowspan="1" colspan="1">ABM</th><th rowspan="1" colspan="1">TH</th><th rowspan="1" colspan="1">SM</th><th rowspan="1" colspan="1">ABM</th><th rowspan="1" colspan="1">TH</th><th rowspan="1" colspan="1">SM</th><th rowspan="1" colspan="1">ABM</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Found</td><td rowspan="1" colspan="1">366 918</td><td rowspan="1" colspan="1">354 502</td><td rowspan="1" colspan="1"><bold>424 532</bold></td><td rowspan="1" colspan="1">367 249</td><td rowspan="1" colspan="1">320 949</td><td rowspan="1" colspan="1"><bold>424 385</bold></td><td rowspan="1" colspan="1">372 274</td><td rowspan="1" colspan="1">277 369</td><td rowspan="1" colspan="1"><bold>409 676</bold></td></tr><tr><td rowspan="1" colspan="1">Perfect hit</td><td rowspan="1" colspan="1">326 510</td><td rowspan="1" colspan="1">334 241</td><td rowspan="1" colspan="1"><bold>420 338</bold></td><td rowspan="1" colspan="1">326 422</td><td rowspan="1" colspan="1">279 146</td><td rowspan="1" colspan="1"><bold>421 543</bold></td><td rowspan="1" colspan="1">326 033</td><td rowspan="1" colspan="1">222 907</td><td rowspan="1" colspan="1"><bold>407 636</bold></td></tr><tr><td rowspan="1" colspan="1">Accuracy (%)</td><td rowspan="1" colspan="1">88.99</td><td rowspan="1" colspan="1">94.28</td><td rowspan="1" colspan="1"><bold>99.01</bold></td><td rowspan="1" colspan="1">88.88</td><td rowspan="1" colspan="1">86.98</td><td rowspan="1" colspan="1"><bold>99.33</bold></td><td rowspan="1" colspan="1">87.58</td><td rowspan="1" colspan="1">80.36</td><td rowspan="1" colspan="1"><bold>99.50</bold></td></tr><tr><td rowspan="1" colspan="1">Recall (%)</td><td rowspan="1" colspan="1">76.33</td><td rowspan="1" colspan="1">78.13</td><td rowspan="1" colspan="1"><bold>98.26</bold></td><td rowspan="1" colspan="1">76.30</td><td rowspan="1" colspan="1">65.25</td><td rowspan="1" colspan="1"><bold>98.54</bold></td><td rowspan="1" colspan="1">76.21</td><td rowspan="1" colspan="1">52.11</td><td rowspan="1" colspan="1"><bold>95.29</bold></td></tr></tbody></table><table-wrap-foot><fn><p>sp.fa is the benchmark dataset, with sp_e1.fa and sp_e2.fa having 1 and 2 random errors, respectively. We defined accuracy as %(Perfect hit/Found) and recall as %(Perfect hit/Total).</p></fn></table-wrap-foot></table-wrap>
</p>
    <list list-type="order">
      <list-item>
        <p>Support for multiple input formats: ABMapper supports BWA SAM file, reads file in raw, FASTA and FASTQ formats. Reads that are mapped to multiple locations (multi-reads) or unmapped reads could be extracted from BWA's SAM/BAM file and mapped by ABMapper.</p>
      </list-item>
      <list-item>
        <p>User-defined seed length: the seed length is a key parameter that would affect the searching speed, sensitivity and accuracy. The shorter the seed length is, the more sensitive and accurate the mapping becomes, but at the expense of running time. Users could define it according to sample size (i.e. number of reads to be processed) and computation power available. The default seed length is 10. (See <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq656/DC1">Supplementary Figure S1</ext-link> for resource usage based on seed lengths.)</p>
      </list-item>
      <list-item>
        <p>Dynamic error tolerance and overlapping extension exploration: ABMapper can give more chance to reads that would be extended exceeding a cutoff, to find out whether it could be mapped in full length by allowing one additional error. This is most useful in the case of paired-end reads, where it is a commonly known phenomenon that the second read (or p2) always has a lower quality (higher error rate) than the first read (p1). Another important feature of ABMapper is the processing of overlapping sequence of two fragments of a spliced read. Due to error tolerance, the two parts of a read could be extended from both ends beyond their corresponding mapped positions toward each other to an overlapping region, which can be further analyzed [see (4)]. This is more favorable than tools such as SpliceMap, which aligns and extends a read only from one end.</p>
      </list-item>
      <list-item>
        <p>Splice site detection: canonical motifs, ‘GT-AG’, ‘GC-AG’ ‘AT-AC’ are used to determine a probable junction, especially in the case where overlapping fragments are found.</p>
      </list-item>
      <list-item>
        <p>Repetitive reads filtering: repetitive elements are discovered and filtered in the RNA content by ABMapper according to the number of repeats specified by a user. This feature is also meaningful in research (<xref ref-type="bibr" rid="B8">Xu <italic>et al.</italic>, 2010</xref>). Filtered repetitive reads in FASTA format would be used for RepeatMasker analysis.</p>
      </list-item>
      <list-item>
        <p>Unbiased searching and support for multiple output formats: by default, ABMapper will provide as much useful information as possible, which includes alignment details, splicing junction sites and repetitive reads. In addition, ABMapper supports multiple formats including SAM and BED.</p>
      </list-item>
    </list>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_27_3_421__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="msword" xlink:href="supp_btq656_ABMapper_supplementary.doc"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We thank the anonymous reviewers for their comments.</p>
    <p><italic>Funding</italic>: This study is supported by a Focused Investment Scheme of the Chinese University of Hong Kong granted to S.K.-W.T.; and a General Research Fund (GRF461708) from the Research Grant Committee, Hong Kong SAR Government granted to T.-F.C.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ameur</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Global and unbiased detection of splice junctions from RNA-seq data</article-title>
        <source>Genome Biol.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R34</fpage>
        <pub-id pub-id-type="pmid">20236510</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Au</surname>
            <given-names>KF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Detection of splice junctions from paired-end RNA-seq data by SpliceMap</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>4570</fpage>
        <lpage>4578</lpage>
        <pub-id pub-id-type="pmid">20371516</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Burrows</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wheeler</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>A block-sorting lossless data compression algorithm</article-title>
        <source>Technical Report 124</source>
        <year>1994</year>
        <publisher-loc>Palo Alto, CA</publisher-loc>
        <publisher-name>Digital Equipment Corporation</publisher-name>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>
        <source>Genome Biol.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R25</fpage>
        <pub-id pub-id-type="pmid">19261174</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1754</fpage>
        <lpage>1760</lpage>
        <pub-id pub-id-type="pmid">19451168</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>TopHat: discovering splice junctions with RNA-Seq</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1105</fpage>
        <lpage>1111</lpage>
        <pub-id pub-id-type="pmid">19289445</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-Seq: a revolutionary tool for transcriptomics</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>57</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="pmid">19015660</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>AG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Intergenic and repeat transcription in human, chimpanzee and macaque brains measured by RNA-Seq</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2010</year>
        <volume>6</volume>
        <fpage>e1000843</fpage>
        <pub-id pub-id-type="pmid">20617162</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
