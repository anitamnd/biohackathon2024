<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Algorithms Mol Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Algorithms Mol Biol</journal-id>
    <journal-title-group>
      <journal-title>Algorithms for Molecular Biology : AMB</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1748-7188</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4181469</article-id>
    <article-id pub-id-type="pmid">25285153</article-id>
    <article-id pub-id-type="publisher-id">221</article-id>
    <article-id pub-id-type="doi">10.1186/1748-7188-9-19</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Graph-distance distribution of the Boltzmann ensemble of RNA secondary structures</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Qin</surname>
          <given-names>Jing</given-names>
        </name>
        <address>
          <email>qin@bioinf.uni-leipzig.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fricke</surname>
          <given-names>Markus</given-names>
        </name>
        <address>
          <email>markus.fricke2@uni-jena.de</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Marz</surname>
          <given-names>Manja</given-names>
        </name>
        <address>
          <email>manja@uni-jena.de</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stadler</surname>
          <given-names>Peter F</given-names>
        </name>
        <address>
          <email>studla@bioinf.uni-leipzig.de</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
        <xref ref-type="aff" rid="Aff8">8</xref>
        <xref ref-type="aff" rid="Aff9">9</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Backofen</surname>
          <given-names>Rolf</given-names>
        </name>
        <address>
          <email>backofen@informatik.uni-freiburg.de</email>
        </address>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label>Department of Mathematics and Computer Science, Campusvej 55, DK-5230 Odense M, Denmark </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.419532.8</institution-id><institution>Max Planck Institute for Mathematics in the Sciences, </institution></institution-wrap>Inselstraße 22, D-04103 Leipzig, Germany </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.9613.d</institution-id><institution-id institution-id-type="ISNI">0000000119392794</institution-id><institution>Bioinformatics/High Throughput Analysis Faculty of Mathematics und Computer Science Friedrich-Schiller-University, </institution></institution-wrap>Leutragraben 1, D-07743 Jena, Germany </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.5963.9</institution-id><institution>Department of Computer Science, Chair for Bioinformatics, </institution><institution>University of Freiburg, </institution></institution-wrap>Georges-Koehler-Allee 106, D-79110 Freiburg, Germany </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.5963.9</institution-id><institution>Center for Biological Signaling Studies (BIOSS), </institution><institution>Albert-Ludwigs-Universität, </institution></institution-wrap>Freiburg, Germany </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="GRID">grid.9647.c</institution-id><institution-id institution-id-type="ISNI">0000000122309752</institution-id><institution>Bioinformatics Group, Department of Computer Science, and Interdisciplinary Center for Bioinformatics, </institution><institution>University of Leipzig, </institution></institution-wrap>Härtelstrasse 16-18, D-04107 Leipzig, Germany </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="GRID">grid.418008.5</institution-id><institution-id institution-id-type="ISNI">0000000404943022</institution-id><institution>Fraunhofer Institut for Cell Therapy and Immunology, </institution></institution-wrap>Perlickstraße 1, D-04103 Leipzig, Germany </aff>
      <aff id="Aff8"><label>8</label><institution-wrap><institution-id institution-id-type="GRID">grid.10420.37</institution-id><institution-id institution-id-type="ISNI">0000000122861424</institution-id><institution>Institute for Theoretical Chemistry, </institution><institution>University of Vienna, </institution></institution-wrap>Währingerstrasse 17, A-1090 Vienna, Austria </aff>
      <aff id="Aff9"><label>9</label><institution-wrap><institution-id institution-id-type="GRID">grid.209665.e</institution-id><institution-id institution-id-type="ISNI">0000000119411940</institution-id><institution>Santa Fe Institute, </institution></institution-wrap>1399 Hyde Park Rd., NM87501 Santa Fe, USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>11</day>
      <month>9</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>11</day>
      <month>9</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <volume>9</volume>
    <elocation-id>19</elocation-id>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>11</month>
        <year>2013</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>6</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Qin et al.; licensee BioMed Central Ltd. 2014</copyright-statement>
      <license>
        <license-p>This article is made available via the PMC Open Access Subset for unrestricted research re-use and secondary analysis in any form or by any means with acknowledgement of the original source. These permissions are granted for the duration of the World Health Organization (WHO) declaration of COVID-19 as a global pandemic.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Large RNA molecules are often composed of multiple functional domains whose spatial arrangement strongly influences their function. Pre-mRNA splicing, for instance, relies on the spatial proximity of the splice junctions that can be separated by very long introns. Similar effects appear in the processing of RNA virus genomes. Albeit a crude measure, the distribution of spatial distances in thermodynamic equilibrium harbors useful information on the shape of the molecule that in turn can give insights into the interplay of its functional domains.</p>
      </sec>
      <sec>
        <title>Result</title>
        <p>Spatial distance can be approximated by the graph-distance in RNA secondary structure. We show here that the equilibrium distribution of graph-distances between a fixed pair of nucleotides can be computed in polynomial time by means of dynamic programming. While a naïve implementation would yield recursions with a very high time complexity of <italic>O</italic>(<italic>n</italic><sup>6</sup><italic>D</italic><sup>5</sup>) for sequence length <italic>n</italic> and <italic>D</italic> distinct distance values, it is possible to reduce this to <italic>O</italic>(<italic>n</italic><sup>4</sup>) for practical applications in which predominantly small distances are of of interest. Further reductions, however, seem to be difficult. Therefore, we introduced sampling approaches that are much easier to implement. They are also theoretically favorable for several real-life applications, in particular since these primarily concern long-range interactions in very large RNA molecules.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>The graph-distance distribution can be computed using a dynamic programming approach. Although a crude approximation of reality, our initial results indicate that the graph-distance can be related to the smFRET data. The additional file and the software of our paper are available from <ext-link ext-link-type="uri" xlink:href="http://www.rna.uni-jena.de/RNAgraphdist.html">http://www.rna.uni-jena.de/RNAgraphdist.html</ext-link>.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/1748-7188-9-19) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Graph-distance</kwd>
      <kwd>Boltzmann distribution</kwd>
      <kwd>Partition function</kwd>
      <kwd>Pre-mRNA splicing</kwd>
      <kwd>smFRET</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2014</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>The distance distribution within an RNA molecule is of interest in various contexts. Most directly, the question arises whether panhandle-like structures (in which 3’ and 5’ ends of long RNA molecules are placed in close proximity) are the rule or an exception. Panhandles have been reported in particular for many RNA virus genomes. Several studies [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR4">4</xref>] agree based on different models that the two ends of single-stranded RNA molecules are typically not far apart. On a more technical level, the problem to compute the partition function over RNA secondary structures with given end-to-end distance <italic>d</italic>, usually measured as the number of external bases (plus possibly the number of structural domains) arises for instance when predicting nucleic acid secondary structure in the presence of single-stranded binding proteins [<xref ref-type="bibr" rid="CR5">5</xref>] or in models of RNA subjected to pulling forces (e.g. in atom force microscopy or export through a small pore) [<xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR8">8</xref>]. It also plays a role for the effect of loop energy parameters [<xref ref-type="bibr" rid="CR9">9</xref>].</p>
    <p>In contrast to the end-to-end distance, the graph-distance between two <italic>arbitrarily</italic> prescribed nucleotides in a larger RNA structure does not seem to have been studied in any detail. However, this is of particular interest in the analysis of single-molecule fluorescence resonance energy transfer (smFRET) experiments [<xref ref-type="bibr" rid="CR10">10</xref>]. This technique allows to monitor the distance between two dye-labeled nucleotides and can reveal details of the kinetics of RNA folding in real time. It measures the non-radiative energy transfer between the dye-labeled donor and acceptor positions. The efficiency of this energy transfer, <italic>E</italic><sub><italic>fret</italic></sub>, strongly depends on the spatial distance <italic>R</italic> according to <inline-formula id="IEq1"><alternatives><mml:math id="M1"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mtext>fret</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msubsup><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq1_HTML.gif"/></alternatives></inline-formula>. The Förster radius <italic>R</italic><sub>0</sub> sets the length scale, e.g. <italic>R</italic><sub>0</sub>≈54 Å for the Cy3-Cy5 dye pair. A major obstacle is that, at present, there is no general and efficient way to link smFRET measurements to interpretations in terms of explicit molecular structures. To solve this problem, a natural first step is to compute the distribution of spatial distances for an equilibrium ensemble of 3D structures. Since this is not feasible in practice despite major progress in the field of RNA 3D structure prediction [<xref ref-type="bibr" rid="CR11">11</xref>], we can only resort to considering the graph-distances on the ensemble of RNA secondary structures instead. From a computer science point of view, furthermore, we show here that the distance distribution can be computed exactly using a dynamic programming approach. Although a crude approximation of reality, our initial results indicate that the graph-distance can be related to the smFRET data such as those reported by [<xref ref-type="bibr" rid="CR12">12</xref>] and help to explain effects of RNA structures in pre-mRNA splicing and viral subgenomic RNA species.</p>
  </sec>
  <sec id="Sec2">
    <title>Theory</title>
    <sec id="Sec3">
      <title>RNA secondary structures</title>
      <p>An RNA secondary structure is a vertex labeled outerplanar graph <italic>G</italic>(<italic>V</italic>,<italic>x</italic>,<italic>E</italic>), where <italic>V</italic> = {1,2,…,<italic>n</italic>} is a finite <italic>ordered</italic> set (of nucleotide positions) and <italic>x</italic> : {1,2,…,<italic>n</italic>} → {A,U,G,C},<italic>i</italic> ↦ <italic>x</italic><sub><italic>i</italic></sub> assigns to each vertex at position <italic>i</italic> (along the RNA sequence from 5’ to 3’) the corresponding nucleotide <italic>x</italic><sub><italic>i</italic></sub>. We write <italic>x</italic> = <italic>x</italic><sub>1</sub>…<italic>x</italic><sub><italic>n</italic></sub> for the <italic>sequence</italic> underlying secondary structure and use <italic>x</italic>[ <italic>i</italic>…<italic>j</italic>] = <italic>x</italic><sub><italic>i</italic></sub>…<italic>x</italic><sub><italic>j</italic></sub> to denote the <italic>subsequence</italic> from <italic>i</italic> to <italic>j</italic>. The edge set <italic>E</italic> is subdivided into backbone edges of the form {<italic>i</italic>,<italic>i</italic> + 1} for 1 ≤ <italic>i</italic>&lt;<italic>n</italic> and a set <italic>B</italic> of base pairs satisfying the following conditions: <list list-type="simple"><list-item><label>(i)</label><p>If {<italic>i</italic>,<italic>j</italic>} ∈ <italic>B</italic> then <italic>x</italic>
<sub><italic>i</italic></sub>
<italic>x</italic>
<sub><italic>k</italic></sub>∈ {GC,CG,AU,UA,GU,UG};</p></list-item><list-item><label>(ii)</label><p>If {<italic>i</italic>,<italic>j</italic>} ∈ <italic>B</italic> then |<italic>j</italic> - <italic>i</italic>| &gt; 3;</p></list-item><list-item><label>(iii)</label><p>If {<italic>i</italic>,<italic>j</italic>},{<italic>i</italic>,<italic>k</italic>} ∈ <italic>B</italic> then <italic>j</italic> = <italic>k</italic>;</p></list-item><list-item><label>(iv)</label><p>If {<italic>i</italic>,<italic>j</italic>},{<italic>k</italic>,<italic>l</italic>} ∈ <italic>B</italic> and <italic>i</italic> &lt; <italic>k</italic> &lt; <italic>j</italic> then <italic>i</italic> &lt; <italic>l</italic> &lt; <italic>j</italic>.</p></list-item></list></p>
      <p>The first condition allows base pairs only for Watson-Crick and GU base pairs. The second condition implements the minimal steric requirement for an RNA to bend back on itself. The third condition enforces that <italic>B</italic> forms a matching in the secondary structure. The last condition (nesting condition) forbids crossing base pairs, i.e. pseudoknots.</p>
      <p>The nesting condition results in a natural partial order in the set of base pairs <italic>B</italic> defined as {<italic>i</italic>,<italic>j</italic>} ≺ {<italic>k</italic>,<italic>l</italic>} if <italic>k</italic> &lt; <italic>i</italic> &lt; <italic>j</italic> &lt; <italic>l</italic>. In particular, given an arbitrary vertex <italic>k</italic>, the set <italic>B</italic><sub><italic>k</italic></sub>= {{<italic>i</italic>,<italic>j</italic>} ∈ <italic>B</italic>|<italic>i</italic> ≤ <italic>k</italic> ≤ <italic>j</italic>} of base pairs enclosing <italic>k</italic> is totally ordered. Note that <italic>k</italic> is explicitly allowed to be incident to its enclosing base pairs. A vertex <italic>k</italic> is <italic>external</italic> if <italic>B</italic><sub><italic>k</italic></sub>= <italic>∅</italic> . A base pair {<italic>k</italic>,<italic>l</italic>} is <italic>external</italic> if <italic>B</italic><sub><italic>k</italic></sub>= <italic>B</italic><sub><italic>l</italic></sub>= {{<italic>k</italic>,<italic>l</italic>}}.</p>
      <p>Consider a fixed secondary structure <italic>G</italic>, for a given base pair {<italic>i</italic>,<italic>j</italic>} ∈ <italic>B</italic>, we say a vertex <italic>k</italic> is <italic>accessible</italic> from {<italic>i</italic>,<italic>j</italic>} if <italic>i</italic> &lt; <italic>k</italic> &lt; <italic>j</italic> and there is no other pair {<italic>i</italic><sup>′</sup>,<italic>j</italic><sup>′</sup>} ∈ <italic>B</italic> such that <italic>i</italic> &lt; <italic>i</italic><sup>′</sup> &lt; <italic>k</italic> &lt; <italic>j</italic><sup>′</sup> &lt; <italic>j</italic>. The unique subgraph <inline-formula id="IEq2"><alternatives><mml:math id="M2"><mml:msub><mml:mrow><mml:mo mathvariant="script">ℒ</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq2_HTML.gif"/></alternatives></inline-formula> induced by <italic>i</italic>, <italic>j</italic>, and all the vertices accessible from {<italic>i</italic>,<italic>j</italic>} is known as the <italic>loop</italic> of {<italic>i</italic>,<italic>j</italic>}. The <italic>type</italic> of a loop <inline-formula id="IEq3"><alternatives><mml:math id="M3"><mml:msub><mml:mrow><mml:mo mathvariant="script">ℒ</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq3_HTML.gif"/></alternatives></inline-formula> is unique determined depending on whether {<italic>i</italic>,<italic>j</italic>} is external or not, and the numbers of unpaired vertices and base pairs. For details, see [<xref ref-type="bibr" rid="CR13">13</xref>]. Each secondary structure <italic>G</italic> has a unique set of loops <inline-formula id="IEq4"><alternatives><mml:math id="M4"><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mo mathvariant="script">ℒ</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>}</mml:mo><mml:mo>∈</mml:mo><mml:mi>B</mml:mi><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq4_HTML.gif"/></alternatives></inline-formula>, which is called the <italic>loop decomposition</italic> of <italic>G</italic>. The free energy <italic>f</italic>(<italic>G</italic>) of a given secondary structure, according to the standard energy model [<xref ref-type="bibr" rid="CR14">14</xref>], is defined as the sum of the energies of all loops in its unique loop decomposition.</p>
      <p>The relative location of two vertices <italic>v</italic> and <italic>w</italic> in <italic>G</italic> is determined by the base pairs <italic>B</italic><sub><italic>v</italic></sub> and <italic>B</italic><sub><italic>w</italic></sub> that enclose them. If <italic>B</italic><sub><italic>v</italic></sub>∩ <italic>B</italic><sub><italic>w</italic></sub>≠ <italic>∅</italic>, there is a unique ≺-minimal base pair {<italic>i</italic><sub><italic>v</italic>,<italic>w</italic></sub>,<italic>j</italic><sub><italic>v</italic>,<italic>w</italic></sub>} that encloses both vertices and thus a uniquely defined loop <inline-formula id="IEq5"><alternatives><mml:math id="M5"><mml:msub><mml:mrow><mml:mo mathvariant="script">ℒ</mml:mo></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq5_HTML.gif"/></alternatives></inline-formula> in the loop associated with <italic>v</italic> and <italic>w</italic>. If <italic>B</italic><sub><italic>v</italic></sub>∖ <italic>B</italic><sub><italic>w</italic></sub>= <italic>∅</italic> or <italic>B</italic><sub><italic>w</italic></sub>∖ <italic>B</italic><sub><italic>v</italic></sub>= <italic>∅</italic> then <italic>v</italic> or <italic>w</italic> is unpaired and part of <inline-formula id="IEq6"><alternatives><mml:math id="M6"><mml:msub><mml:mrow><mml:mo mathvariant="script">ℒ</mml:mo></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq6_HTML.gif"/></alternatives></inline-formula>. Otherwise, i.e. <italic>B</italic><sub><italic>v</italic></sub>∩ <italic>B</italic><sub><italic>w</italic></sub>= <italic>∅</italic>, there are uniquely defined ≺-maximal base pairs {<italic>k</italic><sub><italic>v</italic></sub>,<italic>l</italic><sub><italic>v</italic></sub>} ∈ <italic>B</italic><sub><italic>v</italic></sub>∖ <italic>B</italic><sub><italic>w</italic></sub> and {<italic>k</italic><sub><italic>w</italic></sub>,<italic>l</italic><sub><italic>w</italic></sub>} ∈ <italic>B</italic><sub><italic>w</italic></sub>∖ <italic>B</italic><sub><italic>v</italic></sub> that enclose <italic>v</italic> and <italic>w</italic>, respectively. We note that <italic>B</italic><sub><italic>v</italic></sub>∖ <italic>B</italic><sub><italic>w</italic></sub> (<italic>B</italic><sub><italic>w</italic></sub>∖ <italic>B</italic><sub><italic>v</italic></sub>) may be empty, in which case {<italic>k</italic><sub><italic>v</italic></sub>,<italic>l</italic><sub><italic>v</italic></sub>} ({<italic>k</italic><sub><italic>w</italic></sub>,<italic>l</italic><sub><italic>w</italic></sub>}) is also empty. This simple partition holds the key to computing distance distinguished partition functions below.</p>
      <p>In the following, we assign the weights <italic>a</italic> for backbone edges and <italic>b</italic> for base pairs, respectively. Given a path <italic>p</italic>, we define the weight of the path <italic>d</italic>(<italic>p</italic>) as the sum of the weights of edges in the path. The (weighted) <italic>graph-distance</italic><inline-formula id="IEq7"><alternatives><mml:math id="M7"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq7_HTML.gif"/></alternatives></inline-formula> in <italic>G</italic> is defined as the weight of the path <italic>p</italic> connecting <italic>v</italic> and <italic>w</italic> with <italic>d</italic>(<italic>p</italic>) being minimal. For the weights, we require the following condition:</p>
      <p>
        <list list-type="bullet">
          <list-item>
            <p>(W) If <italic>i</italic> and <italic>j</italic> are connected by an edge, then {<italic>i</italic>,<italic>j</italic>} ∈ <italic>E</italic> is the unique shortest path between <italic>i</italic> and <italic>j</italic>.</p>
          </list-item>
        </list>
      </p>
      <p>This condition ensures that single edges cannot be replaced by detours of shorter weight. Condition (W) and property (ii) of the secondary structure graphs implies <italic>b</italic> &lt; 3<italic>a</italic> because the closing base pair must be shorter than a hairpin loop. Furthermore, considering a stacked pair we need <italic>b</italic> &lt; <italic>b</italic> + 2 <italic>a</italic>, i.e. <italic>a</italic> &gt; 0. We allow the degenerate case <italic>b</italic> = 0 that neglects the traversals of base pairs.</p>
      <p>Before we continue with the calculations of the partition function, let us first consider the problem formulation in more detail. For the FRET application, it is well-known that FRET efficiency is correlated with spatial distance. Furthermore, only a limited range of distance changes (e.g. 20 Å-100 Å for Cy3-Cy5) can be reported by the FRET experiments. Thus a more useful formulation of our problem is not to use the full expected quantity for all positions. Instead, we are interested in the average for all distance-values within some threshold <italic>θ</italic><sub><italic>d</italic></sub>. As the space and time complexity will depend on the number of distances we consider, we will parametrise our complexity by the number of nucleotides <italic>n</italic> and the number of distances considered <italic>D</italic> = <italic>θ</italic><sub><italic>d</italic></sub>+ 1, as well. In the worst case, there is <italic>D</italic> = <italic>O</italic> (<italic>n</italic>). However, given that in practice only a limited range of distance changes are considered, we rather view <italic>D</italic> = <italic>O</italic>(1) as a small constant in our contribution.</p>
    </sec>
    <sec id="Sec4">
      <title>Boltzmann distribution of graph-distances</title>
      <p>For a fixed structure <italic>G</italic>, <inline-formula id="IEq8"><alternatives><mml:math id="M8"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq8_HTML.gif"/></alternatives></inline-formula> is easy to compute. Here, we are interested in the distribution <inline-formula id="IEq9"><alternatives><mml:math id="M9"><mml:mtext mathvariant="italic">Pr</mml:mtext><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq9_HTML.gif"/></alternatives></inline-formula> and its expected value <inline-formula id="IEq10"><alternatives><mml:math id="M10"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq10_HTML.gif"/></alternatives></inline-formula> over the ensemble of all possible structures <italic>G</italic> for a given sequence <italic>x</italic>. Both quantities can be calculated from the Boltzmann distribution <italic>P</italic>
<italic>r</italic>[ <italic>G</italic>|<italic>x</italic>] = <italic>e</italic><sup>- <italic>f</italic> (<italic>G</italic>)/<italic>R</italic><italic>T</italic></sup>/<italic>Q</italic> where <inline-formula id="IEq11"><alternatives><mml:math id="M11"><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mi>G</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mtext mathvariant="italic">RT</mml:mtext></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq11_HTML.gif"/></alternatives></inline-formula> denotes the partition function of the ensemble of structures. As first shown in [<xref ref-type="bibr" rid="CR15">15</xref>], <italic>Q</italic> and related quantities can be computed in quartic time. A reduction to a cubic algorithm may be obtained if the free energy of long interior loops may be regarded as prohibitive. This restriction has been widely used for long sequences [<xref ref-type="bibr" rid="CR16">16</xref>]. Cubic runtime can also be achieved for some but not all parametrizations of interior loop energies [<xref ref-type="bibr" rid="CR17">17</xref>].</p>
      <p>A crucial quantity for our task is the restricted partition function <disp-formula id="Equ1"><alternatives><mml:math id="M12"><mml:mrow><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mspace width="0.6em"/><mml:mtext>with</mml:mtext><mml:mspace width="0.6em"/><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mi>G</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mtext mathvariant="italic">RT</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math><graphic xlink:href="13015_2013_Article_221_Equa_HTML.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>for a given pair <italic>v</italic>,<italic>w</italic> of positions in a given RNA sequence <italic>x</italic>. A simple computation (Appendix A in Additional file <xref rid="MOESM1" ref-type="media">1</xref>) verifies that the <inline-formula id="IEq12"><alternatives><mml:math id="M13"><mml:mtext mathvariant="italic">Pr</mml:mtext><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="0.3em"/><mml:mo>=</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>]</mml:mo><mml:mo>/</mml:mo><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq12_HTML.gif"/></alternatives></inline-formula> and <inline-formula id="IEq13"><alternatives><mml:math id="M14"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:munder><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>]</mml:mo><mml:mo>/</mml:mo><mml:mi>Q</mml:mi><mml:mo>)</mml:mo><mml:mi>d</mml:mi></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq13_HTML.gif"/></alternatives></inline-formula>. Hence it suffices to compute <italic>Z</italic><sup><italic>v</italic>,<italic>w</italic></sup>[<italic>d</italic>] for any 1 ≤ <italic>d</italic> ≤ <italic>n</italic>. In the following sections we show that this can be achieved by a variant of McCaskill’s approach [<xref ref-type="bibr" rid="CR15">15</xref>].</p>
      <p>For the ease of presentation we describe in the following only the recursion for the simplified energy model for the “circular maximum matching”, in which energy contributions are associated with individual base pairs rather than loops. Our approach can be easily extended to the full model by using separating the partition functions into distinct cases for the loop types.</p>
      <p>We use the letters <italic>Z</italic> and <italic>Y</italic> to denote partition functions with distance constraints, while <italic>Q</italic> is used for quantities that appear in McCaskill’s algorithm and are considered as pre-computed here. For instance, let <inline-formula id="IEq16"><alternatives><mml:math id="M15"><mml:msubsup><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq16_HTML.gif"/></alternatives></inline-formula> denote the partition function over all secondary structures on <italic>x</italic>[ <italic>i</italic>..<italic>j</italic>] that are enclosed by the base pair {<italic>i</italic>,<italic>j</italic>}. We will later also need the partition function <italic>Q</italic><sub><italic>i</italic>,<italic>j</italic></sub> over the sub-sequence <italic>x</italic> [ <italic>i</italic>..<italic>j</italic>], regardless of whether {<italic>i</italic>,<italic>j</italic>} is paired or not. In Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Appendix C, we summarize the notations frequently used in our contribution.</p>
    </sec>
    <sec id="Sec5">
      <title>Recursions of <italic>Z</italic><sup><italic>v</italic>,<italic>w</italic></sup>[ <italic>d</italic>]: The case when <italic>v</italic> and <italic>w</italic>are external</title>
      <p>An important special case assumes that both <italic>v</italic> and <italic>w</italic> are external. This is the case e.g. when <italic>v</italic> and <italic>w</italic> are binded by proteins. In particular, the problem of computing end-to-end distances, i.e., <italic>v</italic> = 1 and <italic>w</italic> = <italic>n</italic>, is of this type.</p>
      <p>Assuming (W), the shortest path between two external vertices <italic>v</italic>,<italic>w</italic> consists of the external vertices and their backbone connections together with the external base pairs. We call this path the <italic>inside path</italic> of <italic>i</italic>,<italic>j</italic> since it does not involve any vertices “outside” the subsequence <italic>x</italic> [ <italic>i</italic>..<italic>j</italic>].</p>
      <p>For efficiently calculating the internal distance between any two vertices <italic>v</italic>,<italic>w</italic>, we denote by <inline-formula id="IEq17"><alternatives><mml:math id="M16"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq17_HTML.gif"/></alternatives></inline-formula> the partition function over all secondary structures on <italic>x</italic> [ <italic>i</italic>..<italic>j</italic>] with distance exactly <italic>d</italic>.</p>
      <p>Now note that any structure on <italic>x</italic>[ <italic>i</italic>..<italic>j</italic>] starts either with an unpaired base or with a base pair connecting <italic>i</italic> to some position <italic>k</italic> satisfying <italic>i</italic> &lt; <italic>k</italic> ≤ <italic>j</italic>. In the first case, we have <inline-formula id="IEq18"><alternatives><mml:math id="M17"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq18_HTML.gif"/></alternatives></inline-formula> where <inline-formula id="IEq19"><alternatives><mml:math id="M18"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>a</mml:mi></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq19_HTML.gif"/></alternatives></inline-formula>. In the second case, there exists <inline-formula id="IEq20"><alternatives><mml:math id="M19"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq20_HTML.gif"/></alternatives></inline-formula> with <inline-formula id="IEq21"><alternatives><mml:math id="M20"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>b</mml:mi></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq21_HTML.gif"/></alternatives></inline-formula> and <inline-formula id="IEq22"><alternatives><mml:math id="M21"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>a</mml:mi></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq22_HTML.gif"/></alternatives></inline-formula>. Thus, <inline-formula id="IEq23"><alternatives><mml:math id="M22"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq23_HTML.gif"/></alternatives></inline-formula> can be split as follows, <disp-formula id="Equ2"><graphic xlink:href="13015_2013_Article_221_Equb_HTML.gif" position="anchor"/></disp-formula></p>
      <p>This gives the recursion <disp-formula id="Equ3"><label>1</label><alternatives><mml:math id="M23"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>-</mml:mo><mml:mi>a</mml:mi><mml:mo>]</mml:mo><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mi>d</mml:mi><mml:mo>-</mml:mo><mml:mi>b</mml:mi><mml:mo>-</mml:mo><mml:mi>a</mml:mi><mml:mo>]</mml:mo></mml:math><graphic xlink:href="13015_2013_Article_221_Equ1_HTML.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>with the initialization <inline-formula id="IEq24"><alternatives><mml:math id="M24"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ii</mml:mtext></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mn>0</mml:mn><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq24_HTML.gif"/></alternatives></inline-formula> and <inline-formula id="IEq25"><alternatives><mml:math id="M25"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ii</mml:mtext></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq25_HTML.gif"/></alternatives></inline-formula> for <italic>d</italic> &gt; 0. For consecutive vertices, we have <inline-formula id="IEq26"><alternatives><mml:math id="M26"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>a</mml:mi><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq26_HTML.gif"/></alternatives></inline-formula> and <inline-formula id="IEq27"><alternatives><mml:math id="M27"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq27_HTML.gif"/></alternatives></inline-formula> for <italic>d</italic> ≠ <italic>a</italic>. These recursions have been derived in several different contexts, e.g. force induced RNA denaturations [<xref ref-type="bibr" rid="CR6">6</xref>], the investigate of loop entropy dependence [<xref ref-type="bibr" rid="CR9">9</xref>], the analysis of FRET signals in the presence of single-stranded binding proteins [<xref ref-type="bibr" rid="CR5">5</xref>], as well as in mathematical studies of RNA panhandle-like structures [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>].</p>
      <p>In the following, it will be convenient to define also a special term for the empty structure. Setting <inline-formula id="IEq28"><alternatives><mml:math id="M28"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mo>-</mml:mo><mml:mi>a</mml:mi><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq28_HTML.gif"/></alternatives></inline-formula> and <inline-formula id="IEq29"><alternatives><mml:math id="M29"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq29_HTML.gif"/></alternatives></inline-formula> for <italic>d</italic> ≠ -<italic>a</italic> allows us to formally write an individual backbone edge as two edges flanking the empty structure and hence to avoid the explicit treatment of special cases. This definition of <italic>Z</italic><sup><italic>I</italic></sup> also includes the case that <italic>i</italic> and <italic>j</italic> are base paired in the recursion (1). This is covered by the case <italic>k</italic>=<italic>j</italic>, where we evaluate <inline-formula id="IEq30"><alternatives><mml:math id="M30"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>-</mml:mo><mml:mi>b</mml:mi><mml:mo>-</mml:mo><mml:mi>a</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq30_HTML.gif"/></alternatives></inline-formula>. Since <italic>d</italic> = <italic>b</italic> is the only admissible value here, this refers to <inline-formula id="IEq31"><alternatives><mml:math id="M31"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mo>-</mml:mo><mml:mi>a</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq31_HTML.gif"/></alternatives></inline-formula>, which has the correct value of 1 due to our definition. Later on, we will also need <italic>Z</italic><sup><italic>I</italic></sup> under the additional condition that the path starts and ends with a backbone edge. We therefore introduce <inline-formula id="IEq32"><alternatives><mml:math id="M32"><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq32_HTML.gif"/></alternatives></inline-formula> defined as by <disp-formula id="Equ4"><label>2</label><alternatives><mml:math id="M33"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mi>a</mml:mi><mml:mo>]</mml:mo></mml:math><graphic xlink:href="13015_2013_Article_221_Equ2_HTML.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Note that if <inline-formula id="IEq33"><alternatives><mml:math id="M34"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq33_HTML.gif"/></alternatives></inline-formula> is called with <italic>j</italic> = <italic>i</italic> + 1, then we call <inline-formula id="IEq34"><alternatives><mml:math id="M35"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mi>a</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq34_HTML.gif"/></alternatives></inline-formula>. The only admissible value again is the correct value <italic>d</italic>=<italic>a</italic>. In sum, we have the following <disp-formula id="Equ5"><graphic xlink:href="13015_2013_Article_221_Equc_HTML.gif" position="anchor"/></disp-formula></p>
      <p>This recursion requires <italic>O</italic>(<italic>n</italic><sup>3</sup><italic>D</italic>) time and <italic>O</italic>(<italic>n</italic><sup>2</sup><italic>D</italic>) space. It is possible to reduce the complexity of computing the expected distance in this special case by a linear factor. The trick is to use conditional probabilities for arcs starting at <italic>i</italic> or the conditional probability for <italic>i</italic> to be single-stranded, which can be determined from the partition function for RNA folding [<xref ref-type="bibr" rid="CR3">3</xref>], see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Appendix B.</p>
    </sec>
    <sec id="Sec6">
      <title>Recursions of <italic>Z</italic><sup><italic>v</italic>,<italic>w</italic></sup>[ <italic>d</italic>]: the general case</title>
      <p>The distance between two positions <italic>v</italic> and <italic>w</italic> that are covered by an arc can be realized by both <italic>inside paths</italic> and <italic>outside paths</italic>. Here, “outside” emphasizes that the shortest path between two positions <italic>v</italic> and <italic>w</italic> contains vertex does not belongs to <italic>x</italic>[ <italic>v</italic>,<italic>w</italic>]. This case complicates the algorithmic approach, since both types of paths must be controlled simultaneously. Consider Figure <xref rid="Fig1" ref-type="fig">1</xref>, the shortest path between the green and blue regions includes some vertices outside the interval between these two regions. The basic idea is to generalize Equation (<xref rid="Equ1" ref-type="">1</xref>) to computing the partition function <italic>Z</italic><sup><italic>v</italic>,<italic>w</italic></sup>[ <italic>d</italic>]. The main question now becomes how to recurse over decompositions of both the inside and the outside paths.<fig id="Fig1"><label>Figure 1</label><caption><p><bold>Inside and outside paths.</bold> The shortest path (violet arrows) from <italic>v</italic> (green) to <italic>w</italic> (blue) is not an inside path: <italic>inside</italic> emphasizes that, in contrast to the shortest path (cyan arrows) between the red region and <italic>w</italic>, it is not contained in the interval determined by its end points.</p></caption><graphic xlink:href="13015_2013_Article_221_Fig1_HTML" id="d29e3229"/></fig></p>
      <p>Figure <xref rid="Fig1" ref-type="fig">1</xref> shows that the outside paths are important for the green region, i.e., the region that is covered by an arc. Hence, we have to consider the different cases that the two positions <italic>v</italic> and <italic>w</italic> are covered by arcs. The set <italic>Ω</italic> of all secondary structures on <italic>x</italic>can be divided into two disjoint subclasses that have to be treated differently:</p>
      <p>
        <list list-type="bullet">
          <list-item>
            <p> : <italic>v</italic> and <italic>w</italic> are not enclosed in a common base pair, i.e., <italic>B</italic><sub><italic>v</italic></sub>∩ <italic>B</italic><sub><italic>w</italic></sub>= <italic>∅</italic>.</p>
          </list-item>
          <list-item>
            <p> : there is a base pair enclosing both <italic>v</italic> and <italic>w</italic>, i.e., <italic>B</italic><sub><italic>v</italic></sub>∩ <italic>B</italic><sub><italic>w</italic></sub>≠ <italic>∅</italic>.</p>
          </list-item>
        </list>
      </p>
      <p>Note that this bipartition explicitly depends on <italic>v</italic> and <italic>w</italic>. In the following, we will first introduce the recursions that are required in <italic>Ω</italic><sub>0</sub> structures to compute <italic>Z</italic><sup><italic>v</italic>,<italic>w</italic></sup>[ <italic>d</italic>].</p>
      <sec id="Sec7">
        <title>Contribution of <italic>Ω</italic><sub>0</sub> structures to <italic>Z</italic><sup><italic>v</italic>,<italic>w</italic></sup>[ <italic>d</italic>]: <inline-formula id="IEq35"><alternatives><mml:math id="M36"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq35_HTML.gif"/></alternatives></inline-formula></title>
        <p>One example of this case is given in Figure <xref rid="Fig1" ref-type="fig">1</xref> with the red and blue region, where <italic>v</italic> (vertex in green region) is covered by an arc, and <italic>w</italic> (vertex in blue region) is external. Denote the ≺-maximal base pair enclosing <italic>v</italic> by {<italic>i</italic>,<italic>j</italic>}. Since at most one of <italic>v</italic> and <italic>w</italic> is covered by an arc, we know that <italic>j</italic> &lt; <italic>w</italic>. Hence, every path <italic>p</italic> from <italic>v</italic> to <italic>w</italic>, and hence also the shortest paths (not necessarily unique) must run through the right end <italic>j</italic> of the arc {<italic>i</italic>,<italic>j</italic>}. More precisely, there must sub-paths <italic>p</italic><sub>1</sub> and <italic>p</italic><sub>2</sub> with <italic>d</italic> (<italic>p</italic>) = <italic>d</italic>(<italic>p</italic><sub>1</sub>) + <italic>d</italic> (<italic>p</italic><sub>2</sub>) + <italic>a</italic> such that <inline-formula id="IEq36"><alternatives><mml:math id="M37"><mml:mi>v</mml:mi><mml:mover><mml:mrow><mml:mo>⇝</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:mrow></mml:mover><mml:mi>w</mml:mi><mml:mo>→</mml:mo><mml:mi>v</mml:mi><mml:mover><mml:mrow><mml:mo>⇝</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mover><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mover><mml:mrow><mml:mo>⇝</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mover><mml:mi>w</mml:mi></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq36_HTML.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq37"><alternatives><mml:math id="M38"><mml:mi>i</mml:mi><mml:mover><mml:mrow><mml:mo>⇝</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:mrow></mml:mover><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq37_HTML.gif"/></alternatives></inline-formula> denotes that <italic>p</italic> is <bold>a</bold> shortest path from <italic>i</italic> to <italic>j</italic> and - denotes a single backbone edge. For the shortest path from <italic>v</italic> to <italic>j</italic>, it consists either of a shortest path <inline-formula id="IEq38"><alternatives><mml:math id="M39"><mml:mi>v</mml:mi><mml:mover><mml:mrow><mml:mo>⇝</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mover><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq38_HTML.gif"/></alternatives></inline-formula> and the arc {<italic>i</italic>,<italic>j</italic>}, or it goes directly to <italic>j</italic> without using the arc {<italic>i</italic>,<italic>j</italic>}.</p>
        <p>How does this distinction translate to the partition function approach? If we want to calculate the contribution of this case to the partition function <italic>Z</italic><sup><italic>v</italic>,<italic>w</italic></sup>[ <italic>d</italic>], we have to split both the sequence <italic>x</italic>[ <italic>i</italic>,<italic>w</italic>] and distance <italic>d</italic> as follows</p>
        <p>a.) <disp-formula id="Equ6"><graphic xlink:href="13015_2013_Article_221_Equd_HTML.gif" position="anchor"/></disp-formula></p>
        <p>where <inline-formula id="IEq39"><alternatives><mml:math id="M40"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq39_HTML.gif"/></alternatives></inline-formula> is the partition function starting and ending with a single-stranded base as defined in Equation (<xref rid="Equ2" ref-type="">2</xref>), and <inline-formula id="IEq40"><alternatives><mml:math id="M41"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq40_HTML.gif"/></alternatives></inline-formula> is the partition function consisting of all structures of <italic>x</italic>[ <italic>i</italic>,<italic>j</italic>] containing the base pair {<italic>i</italic>,<italic>j</italic>} with the property that the shortest path from <italic>v</italic> to <italic>i</italic> has length <italic>d</italic><sub><italic>ℓ</italic></sub> and the shortest path from <italic>v</italic> to <italic>j</italic> has length <italic>d</italic><sub><italic>r</italic></sub>. In addition, <italic>d</italic>, <italic>d</italic><sub><italic>r</italic></sub> and <italic>d</italic><sub>2</sub> must satisfy <italic>d</italic> = <italic>d</italic><sub><italic>r</italic></sub>+ <italic>d</italic><sub>2</sub>.</p>
        <p>The remaining cases for the contribution of the class <italic>Ω</italic><sub>0</sub> to <italic>Z</italic><sup><italic>v</italic>,<italic>w</italic></sup>[ <italic>d</italic>] are given by all other possible combinations of <italic>v</italic> and <italic>w</italic> being single-stranded or being covered by an arc, i.e., <disp-formula id="Equ7"><graphic xlink:href="13015_2013_Article_221_Eque_HTML.gif" position="anchor"/></disp-formula></p>
        <p>To simplify, we extend the definition of <inline-formula id="IEq41"><alternatives><mml:math id="M42"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq41_HTML.gif"/></alternatives></inline-formula> by setting <inline-formula id="IEq42"><alternatives><mml:math id="M43"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq42_HTML.gif"/></alternatives></inline-formula> and <inline-formula id="IEq43"><alternatives><mml:math id="M44"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq43_HTML.gif"/></alternatives></inline-formula> for <italic>d</italic><sub><italic>ℓ</italic></sub>+ <italic>d</italic><sub><italic>r</italic></sub>&gt; 0. This allows us to conveniently model all cases where either <italic>v</italic> or <italic>w</italic> are external, i.e., a.), b.), and d.), as special cases of c.).</p>
        <p>In case c.), we have to split the distance <italic>d</italic> into five sub-distances <inline-formula id="IEq44"><alternatives><mml:math id="M45"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq44_HTML.gif"/></alternatives></inline-formula>, in which <italic>d</italic><sub><italic>I</italic></sub> can be retrieved from the first four distances. Furthermore, we would require four splitting positions for the sequence for all possible combinations of <italic>i</italic>,<italic>j</italic>,<italic>k</italic>,<italic>l</italic>. A naïve implementation of this idea would result in an algorithm with time complexity <italic>O</italic>(<italic>n</italic><sup>6</sup><italic>D</italic><sup>5</sup>) and space complexity <italic>O</italic>(<italic>n</italic><sup>2</sup><italic>D</italic><sup>2</sup>).</p>
        <p>A careful inspection shows, however, that the split of the distances for the arcs into <italic>d</italic><sub><italic>ℓ</italic></sub> and <italic>d</italic><sub><italic>r</italic></sub> is unnecessary. Since we want to know only distance to the left/right end, we can simply introduce two matrices <inline-formula id="IEq45"><alternatives><mml:math id="M46"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mo>ℓ</mml:mo></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq45_HTML.gif"/></alternatives></inline-formula> and <inline-formula id="IEq46"><alternatives><mml:math id="M47"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq46_HTML.gif"/></alternatives></inline-formula> that store these values. These matrices can be generated from <inline-formula id="IEq47"><alternatives><mml:math id="M48"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq47_HTML.gif"/></alternatives></inline-formula> as follows: <disp-formula id="Equ8"><alternatives><mml:math id="M49"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mo>ℓ</mml:mo></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mtable rowspacing="0"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo>≥</mml:mo><mml:mi>d</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mtable rowspacing="0"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mi>d</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>-</mml:mo><mml:mi>b</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:math><graphic xlink:href="13015_2013_Article_221_Equf_HTML.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Analogously, we compute <inline-formula id="IEq48"><alternatives><mml:math id="M50"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq48_HTML.gif"/></alternatives></inline-formula>. In this way, we split the distance <italic>d</italic> into three contributions and we require four splitting positions for the sequence for all possible combinations of <italic>i</italic>,<italic>j</italic>,<italic>k</italic>,<italic>ℓ</italic>. <disp-formula id="Equ9"><graphic xlink:href="13015_2013_Article_221_Equg_HTML.gif" position="anchor"/></disp-formula></p>
        <p>Therefore, the contribution to <italic>Z</italic><sup><italic>v</italic>,<italic>w</italic></sup>[ <italic>d</italic>] for structures in <italic>Ω</italic><sup>0</sup> is given by <disp-formula id="Equ10"><label>3</label><alternatives><mml:math id="M51"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:mspace width="-10.0pt"/><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mtable rowspacing="0"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mi>d</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mtable rowspacing="0"><mml:mtr><mml:mtd><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>v</mml:mi><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>w</mml:mi><mml:mo>≤</mml:mo><mml:mi>l</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>·</mml:mo><mml:mspace width="0.3em"/><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>-</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>]</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>·</mml:mo><mml:mspace width="0.3em"/><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mo>ℓ</mml:mo></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13015_2013_Article_221_Equ3_HTML.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Note that for splitting the distance, we reuse the same indices (e.g., the <italic>j</italic> in <inline-formula id="IEq49"><alternatives><mml:math id="M52"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>·</mml:mo><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>-</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq49_HTML.gif"/></alternatives></inline-formula>, where as for the remaining partition function, we use successive indices (e.g.,the <italic>i</italic> in <inline-formula id="IEq50"><alternatives><mml:math id="M53"><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq50_HTML.gif"/></alternatives></inline-formula>). This difference comes from the fact that splitting a sequence into subsequences is done naturally between two successive indices, whereas splitting a distance is naturally done by splitting at an individual position. We have only to guarantee that the substructures which participate in the split do agree on the structural context of the split position. This is guaranteed by requiring that <inline-formula id="IEq51"><alternatives><mml:math id="M54"><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq51_HTML.gif"/></alternatives></inline-formula> starts and ends with a backbone edge. We note that the incorporation of the full dangling end parameters makes is more tedious to handle the splitting positions.</p>
        <p>This results in a complexity of <italic>O</italic>(<italic>n</italic><sup>6</sup><italic>D</italic><sup>3</sup>) time and <italic>O</italic>(<italic>n</italic><sup>2</sup><italic>D</italic>) space. However, we do not need to split in <italic>i</italic>,<italic>j</italic>,<italic>k</italic>,<italic>l</italic> simultaneously. Instead, we could split case (c) at position <italic>j</italic> and introduce for all <italic>v</italic> ≤ <italic>j</italic> and <italic>k</italic> ≤ <italic>w</italic> the auxiliary variables <disp-formula id="Equ11"><alternatives><mml:math id="M55"><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mo>ℓ</mml:mo></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>≤</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mo>ℓ</mml:mo></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mspace width="0.3em"/><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mo>ℓ</mml:mo></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>]</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mtable rowspacing="0"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>·</mml:mo><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mo>ℓ</mml:mo></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13015_2013_Article_221_Equh_HTML.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Finally, we can replace recursion (3) by <disp-formula id="Equ12"><label>4</label><alternatives><mml:math id="M56"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>≤</mml:mo><mml:mspace width="0.3em"/><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>·</mml:mo><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mspace width="0.3em"/><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mo>ℓ</mml:mo></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:math><graphic xlink:href="13015_2013_Article_221_Equ4_HTML.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>We thus arrive at <italic>O</italic>(<italic>n</italic><sup>3</sup><italic>D</italic><sup>2</sup>) time and <italic>O</italic>(<italic>n</italic><sup>2</sup><italic>D</italic>) space complexity for the contribution of <italic>Ω</italic><sub>0</sub> structures to <italic>Z</italic><sup><italic>v</italic>,<italic>w</italic></sup>[ <italic>d</italic>], excluding the complexity of computing <inline-formula id="IEq52"><alternatives><mml:math id="M57"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq52_HTML.gif"/></alternatives></inline-formula>.</p>
      </sec>
      <sec id="Sec8">
        <title>Contribution of <italic>Ω</italic><sub>1</sub> structures to <italic>Z</italic><sup><italic>v</italic>,<italic>w</italic></sup>[ <italic>d</italic>]</title>
        <p><italic>Ω</italic><sub>1</sub> contains all cases where <italic>v</italic> and <italic>w</italic> are covered by a base pair. In the following, let {<italic>p</italic>,<italic>q</italic>} be the ≺-minimal base pair covering <italic>v</italic> and <italic>w</italic>. In principle, this case looks similar to the case for <italic>Ω</italic><sub>0</sub>. However, we have to take into considerations the paths between <italic>v</italic> and <italic>w</italic> over the base pair {<italic>p</italic>,<italic>q</italic>}. Thus, we need to store the partition function for all inside and outside for each ≺-minimal arc {<italic>p</italic>,<italic>q</italic>} that covers <italic>v</italic> and <italic>w</italic>, which we will call <inline-formula id="IEq53"><alternatives><mml:math id="M58"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq53_HTML.gif"/></alternatives></inline-formula>. In principle, a similar recursion as defined for <inline-formula id="IEq54"><alternatives><mml:math id="M59"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq54_HTML.gif"/></alternatives></inline-formula> in equation (<xref rid="Equ3" ref-type="">3</xref>) can be derived, with the additional complication since we have to take care of the additional outside distance due to the arc {<italic>p</italic>,<italic>q</italic>}. Thus, we obtain the following splitting: <disp-formula id="Equ13"><graphic xlink:href="13015_2013_Article_221_Equi_HTML.gif" position="anchor"/></disp-formula></p>
        <p>Again we can avoid the complexity of simultaneously splitting at {<italic>i</italic>,<italic>j</italic>}<italic>and</italic> {<italic>k</italic>,<italic>l</italic>} by doing a major split after <italic>j</italic>. Thus, we get the following picture, <disp-formula id="Equ14"><graphic xlink:href="13015_2013_Article_221_Equj_HTML.gif" position="anchor"/></disp-formula></p>
        <p>which leads to the following equivalent recursions: <disp-formula id="Equ15"><label>5</label><alternatives><mml:math id="M60"><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>]</mml:mo><mml:mo>·</mml:mo><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:math><graphic xlink:href="13015_2013_Article_221_Equ5_HTML.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ16"><label>6</label><alternatives><mml:math id="M61"><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mo>ℓ</mml:mo></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>≤</mml:mo><mml:mi>l</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>′′</mml:mi></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>′′</mml:mi></mml:mrow></mml:msubsup><mml:mo>]</mml:mo><mml:mo>·</mml:mo><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>′′</mml:mi></mml:mrow></mml:msubsup><mml:mo>]</mml:mo></mml:math><graphic xlink:href="13015_2013_Article_221_Equ6_HTML.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ17"><label>7</label><alternatives><mml:math id="M62"><mml:mspace width="-5.0pt"/><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mspace width="0.3em"/><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mo>ℓ</mml:mo></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">I</mml:mtext><mml:mo>ℓ</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mtable rowspacing="0"><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">I</mml:mtext><mml:mo>ℓ</mml:mo></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">I</mml:mtext><mml:mo>ℓ</mml:mo></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>]</mml:mo><mml:mo>·</mml:mo><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mo>ℓ</mml:mo></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>]</mml:mo></mml:math><graphic xlink:href="13015_2013_Article_221_Equ7_HTML.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Overall, we get the following recursion: <disp-formula id="Equ18"><label>8</label><alternatives><mml:math id="M63"><mml:mspace width="-15.0pt"/><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>≤</mml:mo><mml:mspace width="0.3em"/><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mtable rowspacing="0"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>d</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>·</mml:mo><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mspace width="0.3em"/><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mo>ℓ</mml:mo></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>d</mml:mi><mml:mo>]</mml:mo></mml:math><graphic xlink:href="13015_2013_Article_221_Equ8_HTML.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>We can now define <italic>Z</italic><sup><italic>v</italic>,<italic>w</italic></sup>[ <italic>d</italic>] by <disp-formula id="Equ19"><label>9</label><alternatives><mml:math id="M64"><mml:mspace width="-15.0pt"/><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>]</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msubsup><mml:mo>·</mml:mo></mml:mtd><mml:mtd><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mtable rowspacing="0"><mml:mtr><mml:mtd><mml:mo>{</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>}</mml:mo><mml:mo>≠</mml:mo><mml:mo>{</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>}</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mtable rowspacing="0"><mml:mtr><mml:mtd><mml:mo>{</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>}</mml:mo><mml:mo>≠</mml:mo><mml:mo>{</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>}</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>d</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13015_2013_Article_221_Equ9_HTML.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where <inline-formula id="IEq55"><alternatives><mml:math id="M65"><mml:msubsup><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq55_HTML.gif"/></alternatives></inline-formula> is the external partition function over all structures on the union of the intervals <italic>x</italic>[ 1..<italic>p</italic>] ∪ <italic>x</italic>[ <italic>q</italic>..<italic>n</italic>] so that {<italic>p</italic>,<italic>q</italic>} is a base pair. Since the base pair probability can be written as <inline-formula id="IEq56"><alternatives><mml:math id="M66"><mml:mtext mathvariant="italic">Pr</mml:mtext><mml:mo>(</mml:mo><mml:mo>{</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>}</mml:mo><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq56_HTML.gif"/></alternatives></inline-formula>, this quantity can be calculated as <inline-formula id="IEq57"><alternatives><mml:math id="M67"><mml:msubsup><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext mathvariant="italic">Pr</mml:mtext><mml:mo>(</mml:mo><mml:mo>{</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>}</mml:mo><mml:mo>)</mml:mo><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq57_HTML.gif"/></alternatives></inline-formula>. The base pair probability <italic>P</italic>
<italic>r</italic> ({<italic>p</italic>,<italic>q</italic>}), and the partition functions <italic>Q</italic> and <inline-formula id="IEq58"><alternatives><mml:math id="M68"><mml:msubsup><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq58_HTML.gif"/></alternatives></inline-formula> are computed by means of McCaskill’s algorithm.</p>
        <p>This part now has a complexity of <italic>O</italic>(<italic>n</italic><sup>2</sup><italic>D</italic><sup>2</sup>) space and <italic>O</italic>(<italic>n</italic><sup>3</sup><italic>D</italic><sup>4</sup>) time. For practical applications, however, we do not need to consider all possible {<italic>p</italic>,<italic>q</italic>}. Instead, there are only few base pairs that are likely to form <italic>and</italic> that cover <italic>v</italic>,<italic>w</italic>, especially for <italic>v</italic>,<italic>w</italic> where the internal distance of <italic>v</italic>,<italic>w</italic> is large enough such that an outside path has to be considered at all. If we assume a constant number of such long-range base-pairs, then the complexity is reduced by an <italic>n</italic><sup>2</sup>-factor. For the complexity in terms of distance, recall that <italic>D</italic> is typically small.</p>
      </sec>
    </sec>
    <sec id="Sec9">
      <title>Recursions for <inline-formula id="IEq59"><alternatives><mml:math id="M69"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq59_HTML.gif"/></alternatives></inline-formula></title>
      <p>So far, we have used <inline-formula id="IEq60"><alternatives><mml:math id="M70"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq60_HTML.gif"/></alternatives></inline-formula> as a black box. In order to compute these terms, we distinguish the limiting cases a.) <italic>v</italic> = <italic>i</italic>, b.) <italic>v</italic> = <italic>j</italic>, c.) is external from the generic case d.): <disp-formula id="Equ20"><graphic xlink:href="13015_2013_Article_221_Equk_HTML.gif" position="anchor"/></disp-formula></p>
      <p>Starting from the limiting cases, we initialize <inline-formula id="IEq61"><alternatives><mml:math id="M71"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq61_HTML.gif"/></alternatives></inline-formula> as follows: <disp-formula id="Equ21"><alternatives><mml:math id="M72"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mtd><mml:mtd><mml:mspace width="0.6em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.6em"/><mml:mi>a</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>b</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>≥</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>]</mml:mo></mml:mtd><mml:mtd><mml:mspace width="0.6em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.6em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>b</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mtext>otherwise</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13015_2013_Article_221_Equl_HTML.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>and analogously for <inline-formula id="IEq62"><alternatives><mml:math id="M73"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq62_HTML.gif"/></alternatives></inline-formula>. Furthermore, <inline-formula id="IEq63"><alternatives><mml:math id="M74"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq63_HTML.gif"/></alternatives></inline-formula> for <italic>i</italic> ≠ <italic>v</italic> ≠ <italic>j</italic>. These conventions allow us to model all cases as special cases of <italic>d</italic>). Our key observation here is that the dependency between <italic>d</italic><sub><italic>ℓ</italic></sub> and <italic>d</italic><sub><italic>r</italic></sub> can be used to reduce the time complexity. Instead of using the variables <italic>d</italic><sub><italic>ℓ</italic></sub> and <italic>d</italic><sub><italic>r</italic></sub> in <inline-formula id="IEq64"><alternatives><mml:math id="M75"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq64_HTML.gif"/></alternatives></inline-formula>, we use the pair <italic>d</italic><sub><italic>ℓ</italic></sub>,<italic>d</italic><sub>add</sub> in <inline-formula id="IEq65"><alternatives><mml:math id="M76"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext>add</mml:mtext></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq65_HTML.gif"/></alternatives></inline-formula>. Similarly, we use <inline-formula id="IEq66"><alternatives><mml:math id="M77"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext>add</mml:mtext></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq66_HTML.gif"/></alternatives></inline-formula> instead of <inline-formula id="IEq67"><alternatives><mml:math id="M78"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq67_HTML.gif"/></alternatives></inline-formula> for the inner base pair, which then determines completely the splitting the distances. This results in an recursion for <inline-formula id="IEq68"><alternatives><mml:math id="M79"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext>add</mml:mtext></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq68_HTML.gif"/></alternatives></inline-formula> with complexity <inline-formula id="IEq69"><alternatives><mml:math id="M80"><mml:mi>O</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq69_HTML.gif"/></alternatives></inline-formula> time and <italic>O</italic> (<italic>n</italic><sup>2</sup><italic>D</italic>
<italic>c</italic><sub><italic>b</italic></sub>) space. To be precise, there are three sub-cases as follows. <disp-formula id="Equ22"><graphic xlink:href="13015_2013_Article_221_Equm_HTML.gif" position="anchor"/></disp-formula></p>
      <p>The values that are chosen to split <italic>d</italic><sub><italic>ℓ</italic></sub> and <italic>d</italic><sub>add</sub> are indicated in green and blue. When the arc {<italic>i</italic>,<italic>j</italic>} is colored violet, then there is a shortest path that does not use the distance marked in red but uses the other direction together with the arc {<italic>i</italic>,<italic>j</italic>}. If -<italic>b</italic>&lt;<italic>d</italic><sub><italic>add</italic></sub>&lt;+<italic>b</italic>, then we know that neither a shortest path <inline-formula id="IEq70"><alternatives><mml:math id="M81"><mml:mi>v</mml:mi><mml:mover><mml:mrow><mml:mo>⇝</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:mrow></mml:mover><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq70_HTML.gif"/></alternatives></inline-formula> nor <inline-formula id="IEq71"><alternatives><mml:math id="M82"><mml:mi>v</mml:mi><mml:mover><mml:mrow><mml:mo>⇝</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:mrow></mml:mover><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq71_HTML.gif"/></alternatives></inline-formula> uses the arc {<italic>i</italic>,<italic>j</italic>}. The left distance is thus given by <inline-formula id="IEq72"><alternatives><mml:math id="M83"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq72_HTML.gif"/></alternatives></inline-formula>. Using the shortcuts <italic>d</italic><sub><italic>r</italic></sub>= <italic>d</italic><sub><italic>ℓ</italic></sub>+ <italic>d</italic><sub>add</sub> and <inline-formula id="IEq73"><alternatives><mml:math id="M84"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext>add</mml:mtext></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq73_HTML.gif"/></alternatives></inline-formula>, then the distance between <italic>l</italic> and <italic>j</italic> must be <inline-formula id="IEq74"><alternatives><mml:math id="M85"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext>add</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>-</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext>add</mml:mtext></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq74_HTML.gif"/></alternatives></inline-formula>. If, on the other hand, <italic>d</italic><sub>add</sub> = + <italic>b</italic>, then we know that there is at least one shortest path that can be composed by using a shortest path <inline-formula id="IEq75"><alternatives><mml:math id="M86"><mml:mi>v</mml:mi><mml:mo>⇝</mml:mo><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq75_HTML.gif"/></alternatives></inline-formula>, followed by the arc {<italic>i</italic>,<italic>j</italic>}. This of course implies that the shortest path <inline-formula id="IEq76"><alternatives><mml:math id="M87"><mml:mi>v</mml:mi><mml:mover><mml:mrow><mml:mo>⇝</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:mrow></mml:mover><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq76_HTML.gif"/></alternatives></inline-formula> is has exactly the length <italic>d</italic><sub><italic>ℓ</italic></sub>+ <italic>b</italic>, or is larger. For a sub-path <inline-formula id="IEq77"><alternatives><mml:math id="M88"><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mover><mml:mrow><mml:mo>⇝</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mover><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq77_HTML.gif"/></alternatives></inline-formula> this implies that the length is greater or equal <inline-formula id="IEq78"><alternatives><mml:math id="M89"><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext>add</mml:mtext></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq78_HTML.gif"/></alternatives></inline-formula>. Thus, we just have to add all partition functions <inline-formula id="IEq79"><alternatives><mml:math id="M90"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq79_HTML.gif"/></alternatives></inline-formula> with <italic>d</italic><sup>′</sup> &gt; <italic>d</italic>. This can be done efficiently by using a precalculated matrix <inline-formula id="IEq80"><alternatives><mml:math id="M91"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>≥</mml:mo></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq80_HTML.gif"/></alternatives></inline-formula>, which is defined as <inline-formula id="IEq81"><alternatives><mml:math id="M92"><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>≥</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq81_HTML.gif"/></alternatives></inline-formula>. Note that <inline-formula id="IEq82"><alternatives><mml:math id="M93"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>≥</mml:mo></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq82_HTML.gif"/></alternatives></inline-formula> can also be defined if we restrict in all recursion the distance <italic>d</italic> to a threshold <italic>θ</italic><sub><italic>d</italic></sub>, since <inline-formula id="IEq83"><alternatives><mml:math id="M94"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>≥</mml:mo></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>≥</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>&lt;</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq83_HTML.gif"/></alternatives></inline-formula>. In which, where <inline-formula id="IEq84"><alternatives><mml:math id="M95"><mml:msubsup><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq84_HTML.gif"/></alternatives></inline-formula> is <italic>Q</italic><sub><italic>i</italic> + 1,<italic>j</italic> - 1</sub> if <italic>j</italic> &gt; <italic>i</italic> + 1, 1 if <italic>j</italic> = <italic>i</italic> + 1 and 0 otherwise. Note, furthermore, that all <inline-formula id="IEq85"><alternatives><mml:math id="M96"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq85_HTML.gif"/></alternatives></inline-formula> for <italic>d</italic><sup>′</sup>&lt; <italic>d</italic> ≤ <italic>θ</italic><sub><italic>d</italic></sub> are calculated when we restrict the distance to <italic>θ</italic><sub><italic>d</italic></sub>.</p>
      <p>Finally, if <italic>d</italic><sub>ad d</sub>= - <italic>b</italic>, then the shortest path <inline-formula id="IEq86"><alternatives><mml:math id="M97"><mml:mi>l</mml:mi><mml:mover><mml:mrow><mml:mo>⇝</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:mrow></mml:mover><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq86_HTML.gif"/></alternatives></inline-formula> has distance <inline-formula id="IEq87"><alternatives><mml:math id="M98"><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>b</mml:mi><mml:mo>)</mml:mo><mml:mo>-</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext>add</mml:mtext></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq87_HTML.gif"/></alternatives></inline-formula>. For the shortest path <inline-formula id="IEq88"><alternatives><mml:math id="M99"><mml:mi>k</mml:mi><mml:mover><mml:mrow><mml:mo>⇝</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:mrow></mml:mover><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq88_HTML.gif"/></alternatives></inline-formula>, we know that it has length <inline-formula id="IEq89"><alternatives><mml:math id="M100"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq89_HTML.gif"/></alternatives></inline-formula> or greater, which can be resolved by again using <inline-formula id="IEq90"><alternatives><mml:math id="M101"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>≥</mml:mo></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq90_HTML.gif"/></alternatives></inline-formula>. Thus, we get the following optimized recursion for <inline-formula id="IEq91"><alternatives><mml:math id="M102"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext>add</mml:mtext></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq91_HTML.gif"/></alternatives></inline-formula> with <italic>d</italic><sub><italic>ℓ</italic></sub>≠ 0 and <italic>d</italic><sub><italic>ℓ</italic></sub>+ <italic>d</italic><sub>add</sub> ≠ 0: <disp-formula id="Equ23"><label>10</label><alternatives><mml:math id="M103"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msubsup><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext>add</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>≤</mml:mo><mml:mi>l</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder></mml:mrow></mml:munder></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext>add</mml:mtext></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>b</mml:mi><mml:mo>≤</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext>add</mml:mtext></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:munder></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>·</mml:mo><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msubsup><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext>add</mml:mtext></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>·</mml:mo><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext>add</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext>add</mml:mtext></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mspace width="2em"/><mml:mtext>if</mml:mtext><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mi>b</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext>add</mml:mtext></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>b</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>≤</mml:mo><mml:mi>l</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder></mml:mrow></mml:munder></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext>add</mml:mtext></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>b</mml:mi><mml:mo>≤</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext>add</mml:mtext></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:munder></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>·</mml:mo><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msubsup><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext>add</mml:mtext></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>·</mml:mo><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo>≥</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext>add</mml:mtext></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mspace width="2em"/><mml:mtext>if</mml:mtext><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext>add</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>b</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>≤</mml:mo><mml:mi>l</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder></mml:mrow></mml:munder></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext>add</mml:mtext></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>b</mml:mi><mml:mo>≤</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext>add</mml:mtext></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:munder></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>·</mml:mo><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msubsup><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext>add</mml:mtext></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>·</mml:mo><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext>add</mml:mtext></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mspace width="2em"/><mml:mtext>if</mml:mtext><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext>add</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>b</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13015_2013_Article_221_Equ10_HTML.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
  </sec>
  <sec id="Sec10">
    <title>Discussion and applications</title>
    <p>The theoretical analysis of the distance distribution problem shows that, while polynomial-time algorithms exist, they probably cannot be improved to space and time complexities that make them widely applicable to large RNA molecules. Due to the unfavorable time complexity of the current algorithm and the associated exact implementation in C, a rather simple and efficient sampling algorithm has been implemented. We resort to sampling Boltzmann-weighted secondary structures with RNAsubopt -p[<xref ref-type="bibr" rid="CR16">16</xref>], which uses the same stochastic backtracing approach as sfold[<xref ref-type="bibr" rid="CR18">18</xref>]. As the graph-distance for a pair of nucleotides in a given secondary structure can be computed in <italic>O</italic>(<italic>n</italic> log<italic>n</italic>) time by Dijkstra’s algorithm with Fibonacci heap [<xref ref-type="bibr" rid="CR19">19</xref>], even large samples can be evaluated efficiently.</p>
    <p>As we pointed out in the introduction, the graph-distance measure introduced in this paper can serve as a first step towards a structural interpretation of smFRET data. As an example, we consider the graph distance distribution of a Diels-Alderase (DAse) ribozyme (Figure <xref rid="Fig2" ref-type="fig">2</xref>A). Histograms of smFRET efficiency (<italic>E</italic><sub><italic>fret</italic></sub>) for this 49 nt long catalytic RNA are reported in [<xref ref-type="bibr" rid="CR12">12</xref>] for a large number of surface-immobilized ribozyme molecules as a function of the Mg <sup>2+</sup> concentration in the buffer solution. A sketch of their histograms is displayed in Figure <xref rid="Fig2" ref-type="fig">2</xref>B. The dyes are attached to sequence positions 6 (Cy3) and 42 (Cy5) and hence do not simply reflect the end-to-end distance, Figure <xref rid="Fig2" ref-type="fig">2</xref>A(c). In this example, we observe the expected correspondence small graph-distances with a strong smFRET signal. This is a particular interesting example, since the minimal free energy (mfe) structure (Figure <xref rid="Fig2" ref-type="fig">2</xref>A(a)) predicted with RNAfold is not identified with the real secondary structure (Figure <xref rid="Fig2" ref-type="fig">2</xref>A(c)). In fact, the ground state secondary structure is ranked as the 3rd best sub-optimal structure derived via RNAsubopt -e. The free energy difference between these two structures is only 0.1 kcal/mol. However, their graph-distances show a relatively larger difference. The 2nd best sub-optimal structure (Figure <xref rid="Fig2" ref-type="fig">2</xref>A(b)) looks rather similar with the 3rd structure, in particular, they share the same graph-distance value.<fig id="Fig2"><label>Figure 2</label><caption><p><bold>Relation between graph-distance distribution and smFRET data.</bold><bold>(A)</bold> The graph-distance distribution of a Diels-Alderase (DAse) ribozyme at temperature 37°C. Structures <bold>(a)</bold>, <bold>(b)</bold> and <bold>(c)</bold> are the top three secondary structures considering their free energy: the minimum free energy structure is shown in <bold>(a)</bold>, <bold>(c)</bold> is the experimentally determined secondary structure, which is ranked as the 3rd best sub-optimal structure with RNAsubopt -e. The graphic representations of these structures are produced with VARNA[<xref ref-type="bibr" rid="CR20">20</xref>]. <bold>(B)</bold> The corresponding smFRET efficiency (<italic>E</italic><sub><italic>fret</italic></sub>) histograms are reported in [<xref ref-type="bibr" rid="CR12">12</xref>]. From these data, three separate states of the DAse ribozyme can be distinguished, the unfolded (U), intermediate <bold>(I)</bold> and folded <bold>(F)</bold> states. <bold>(C)</bold> The graph-distance distribution in the ensemble which is approximated with RNAsubopt -p at temperature 50°C.</p></caption><graphic xlink:href="13015_2013_Article_221_Fig2_HTML" id="d29e9865"/></fig></p>
    <p>The smFRET data of [<xref ref-type="bibr" rid="CR12">12</xref>] indicates the presence of three sub-populations, corresponding to three different structural states: folded molecules (state F), intermediate conformation (state I) and unfolded molecules (state U). In the absence of Mg <sup>2+</sup>, the I state dominates, and only small fractions are found in states U and F. Unfortunately, the salt dependence of RNA folding is complex [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>] and currently is not properly modeled in the available folding programs. We can, however, make use of the qualitative correspondence of low salt concentrations with high temperature. In Figure <xref rid="Fig2" ref-type="fig">2</xref>C we therefore re-compute the graph-distance distribution in the ensemble at an elevated temperature of 50°C. Here, the real structure becomes the second best structure with free energy -10.82 kcal/mol and we observe a much larger fraction of (nearly) unfolded structures with longer distances between the two beacon positions. Qualitatively, this matches the smFRET data showed in Figure <xref rid="Fig2" ref-type="fig">2</xref>B.</p>
    <p>Furthermore, for a given pair <italic>v</italic>,<italic>w</italic> of positions in a given RNA sequence <italic>x</italic>, the importance <italic>I</italic><sub><italic>v</italic>,<italic>w</italic></sub>(<italic>e</italic>) of a backbone edge or base pair <italic>e</italic> in calculating the graph-distance distribution is evaluated by <inline-formula id="IEq92"><alternatives><mml:math id="M104"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>e</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mo>Π</mml:mo></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mtext mathvariant="italic">Pr</mml:mtext><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>G</mml:mi><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq92_HTML.gif"/></alternatives></inline-formula>, where the set <italic>Π</italic><sub><italic>e</italic></sub> comprises the secondary structures <italic>G</italic> with (at least) one shortest path between <italic>v</italic> and <italic>w</italic> that runs through <italic>e</italic>. Figure <xref rid="Fig3" ref-type="fig">3</xref> compares dot plots of <italic>I</italic><sub><italic>v</italic>,<italic>w</italic></sub>(<italic>e</italic>) with the base-pair probabilities in the RNA structure ensemble of the DAse ribozyme at temperatures 37°C and 50°C. Since RNAgraphdist computes only one of possible many shortest paths for each <italic>G</italic>, hence we obtain only a lower bound on <italic>I</italic><sub><italic>v</italic>,<italic>w</italic></sub>(<italic>e</italic>).<fig id="Fig3"><label>Figure 3</label><caption><p><bold>Comparison between the base-pair probabilities and the distance importance</bold><bold><italic>I</italic></bold><sub><bold>6,42</bold></sub><bold>(</bold><bold><italic>e</italic></bold><bold>).</bold> The base-pair probabilities (upper-right-triangle) and the distance importances <italic>I</italic><sub>6,42</sub>(<italic>e</italic>) (lower-left-triangle) of backbone edges and base pairs between 6(U) and 42(U) of DAse ribozyme (Figure <xref rid="Fig2" ref-type="fig">2</xref>) are computed at temperatures 37°C and 50°C, repectively. The size of the squares is proportional to the probability/value. The region covered by the between 6(U) and 42(U) is annotated by a red rectangle. For ease of comparison, backbone edges are added to the base-pair probability matrix.</p></caption><graphic xlink:href="13015_2013_Article_221_Fig3_HTML" id="d29e10071"/></fig></p>
    <p>We observe for DAse that the contributions from the backbone edges are larger than the base pairs at both temperatures. For <italic>T</italic> = 37°C, there are in total 14 edges with <italic>I</italic><sub>6,42</sub>(<italic>e</italic>) &gt; 0.4. Only two of them, 5(C)–18(G) and 2(G) – 21(C) are base pairs. For <italic>T</italic> = 50°C, there is only the pair 5(C) – 18(G) is heavily used (<italic>I</italic><sub>6,42</sub>(5,18) = 0.636). Combining the analysis of data illustrated in Figure <xref rid="Fig2" ref-type="fig">2</xref>, it may indicate that the existences of two base pairs, 2(G) – 21(C) and 28(G) – 39(C) can affect the graph-distance distribution of RNA secondary structure ensemble and consequently affect smFRET measurements. Such constraints may become an interesting source of constraints for RNA structure prediction.</p>
    <p>In addition, we compute the distribution of paths which pass through positions outside sequence interval <italic>x</italic>[ 6-<italic>h</italic>,42+<italic>h</italic>] of DAse ribozyme. As illustrated in Figure <xref rid="Fig4" ref-type="fig">4</xref>, this “outside-path” distribution, as expected, drops fast to 0 with respect to <italic>h</italic>.<fig id="Fig4"><label>Figure 4</label><caption><p><bold>“Outside-path” distribution of DAse ribozyme.</bold> The distribution of paths which pass through positions outside the sequence interval <italic>x</italic>[6-<italic>h</italic>,42+<italic>h</italic>] of DAse ribozyme (Figure <xref rid="Fig2" ref-type="fig">2</xref>). As expected, this probability drops fast to 0 with respect to <italic>h</italic>.</p></caption><graphic xlink:href="13015_2013_Article_221_Fig4_HTML" id="d29e10171"/></fig></p>
    <p>Long-range interactions play an important role in pre-mRNA splicing and in the regulation of alternative splicing [<xref ref-type="bibr" rid="CR23">23</xref>–<xref ref-type="bibr" rid="CR25">25</xref>], bringing splice donor, acceptor, branching site into close spatial proximity. Figure <xref rid="Fig5" ref-type="fig">5</xref>A shows for <italic>D. melanogaster</italic> pre-mRNAs that the distribution of graph-distances between donor and acceptor sites shifted towards smaller values compared to randomly selected pairs of positions with the same distance. Due to the insufficiency of the spacial-distance information of structural elements in the secondary structures, we artificially choose <italic>a</italic> = <italic>b</italic> = 1 in our experiments. Although the effect is small, it shows a clear difference between the real RNA sequences and artificial sequences that were randomized by di-nucleotide shuffling. Furthermore, Table <xref rid="Tab1" ref-type="table">1</xref> displays for a specific intron CG16979-RA_intron_0_0_chr3L_15569803 from <italic>Drosophila melanogaster</italic> (dm3), the most probable secondary structures in the sub-ensembles of secondary structures such that their graph-distances are 7, 6, and 14, respectively.<fig id="Fig5"><label>Figure 5</label><caption><p><bold>Graph-distance distribution of the</bold><bold><italic>Drosophila melanogaster</italic></bold><bold>and the genomic RNA of human</bold><bold><italic>Coronavirus</italic></bold><bold>229E.</bold><bold>(A)</bold>: Distribution of graph-distances (<italic>a</italic> = <italic>b</italic> = 1) in <italic>Drosophila melanogaster</italic> pre-mRNAs between the first and last intron position. To save computational resources, pre-mRNAs were truncated to 100 nt flanking sequence of introns. The black curve shows the graph-distance distribution computed for the corresponding pairs of positions on sequences that were randomized by di-nucleotide shuffling. <bold>(B)</bold>: Graph-distances (<italic>a</italic> = <italic>b</italic> = 1) within and between the 5’ and 3’ regions of the genomic RNA of human <italic>Coronavirus</italic> 229E computed from a concatenation of position 1–576 (5’ UTR) and 25188–25688 (upstream of gene N). Secondary structures bring the 5’ TRS-L (63–76) and 3’ TRS-B (-23– -10) elements into close proximity.</p></caption><graphic xlink:href="13015_2013_Article_221_Fig5_HTML" id="d29e10247"/></fig></p>
    <table-wrap id="Tab1">
      <label>Table 1</label>
      <caption>
        <p>
          <bold>Graph-distance of intron CG16979-RA_intron_0_0_chr3L_15569803 from</bold>
          <bold>
            <italic>Drosophila melanogaster</italic>
          </bold>
          <bold>(dm3)</bold>
        </p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th align="left">1st</th>
            <th align="left">6th</th>
            <th align="left">10th</th>
          </tr>
          <tr>
            <th align="left">Distance = 7</th>
            <th align="left">Distance = 6</th>
            <th align="left">Distance = 14</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">a<inline-formula id="IEq93"><inline-graphic xlink:href="13015_2013_Article_221_IEq93_HTML.gif"/></inline-formula></td>
            <td align="left">b<inline-formula id="IEq94"><inline-graphic xlink:href="13015_2013_Article_221_IEq94_HTML.gif"/></inline-formula></td>
            <td align="left">c<inline-formula id="IEq95"><inline-graphic xlink:href="13015_2013_Article_221_IEq95_HTML.gif"/></inline-formula></td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <p>The intron is extended at the 5’ and 3’ end with 100 bases. The graph-distance is computed between <italic>i</italic> = 101(G) and <italic>j</italic>=159(G) (annotated in the figure). The corresponding shortest paths are highlighted in yellow. The structures (a), (b) and (c) are the most stable structures considering the sub-ensembles which are the sets of structures of graph-distance 7, 6 and 14, respectively. The graph distances 7, 6 and 14 are the 1st, 6th and 10th most favourable graph-distances considering Boltzmann facor.</p>
      </table-wrap-foot>
    </table-wrap>
    <p>The <italic>Drosophila melanogaster</italic> Down syndrome cell adhesion molecules (DSCAM) encodes for 38.016 different mRNAs by alternative splicing. Among the 24 exons, exon 4 alone has 12 variants [<xref ref-type="bibr" rid="CR26">26</xref>]. In Figure <xref rid="Fig6" ref-type="fig">6</xref> we display the graph-distance from donor (exon 3) to any downstream position until acceptor (exon 5). Comparing the graph-distances of all twelve acceptors of exon 4, we see clearly local peaks. This suggests the acceptor being part of hairpin loops, three dimensionally poking out of the long transcript to interact easily with the spliceosome and donor. Four of the twelve acceptor sites show no local peak, however seem to be accessible as internal loops of longer hairpins.<fig id="Fig6"><label>Figure 6</label><caption><p><bold>Graph-distance distribution of DSCAM.</bold> Graph-distance distribution of DSCAM from last nucleotide of exon 3 (Chr.2, Pos. 3255892) to any position until exon 5 (Chr.2, Pos. 3249372), including all 12 variations of alternative exon 4. For secondary structure prediction 100 nt flanking region were used.</p></caption><graphic xlink:href="13015_2013_Article_221_Fig6_HTML" id="d29e10345"/></fig></p>
    <p>The spatial organization of the genomic and sub-genomic RNAs is important for the processing and functioning of many RNA viruses. This goes far beyond the well-known panhandle structures. In <italic>Coronavirus</italic> the interactions of the 5’ TRS-L cis-acting element with body TRS elements has been proposed as an important determinant for the correct assembly of the <italic>Coronavirus</italic> genes in the host [<xref ref-type="bibr" rid="CR27">27</xref>]. The mechanisms of interaction is unknown, and a small three-dimensional distance is suspected. The matrix of expected graph-distances in Figure <xref rid="Fig5" ref-type="fig">5</xref>B shows that TRS-L and TRS-B are indeed placed close to each other. In Table <xref rid="Tab2" ref-type="table">2</xref>, we show the most stable structures within the sub-ensembles of secondary structures such that their graph-distances are 14, 5, and 35, respectively. All these RNA secondary structures brings the leader transcription regulation site (L-TRS) in close spatial proximity with the body transcription regulation site (B-TRS).<table-wrap id="Tab2"><label>Table 2</label><caption><p><bold>Graph-distance of the genomic RNA of</bold><bold><italic>human Coronavirus 229E</italic></bold><bold>computed from a concatenation of position 1-576 and 25188-25688</bold></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">1st</th><th align="left">6th</th><th align="left">8th</th></tr><tr><th align="left">Distance = 14</th><th align="left">Distance = 5</th><th align="left">Distance = 35</th></tr></thead><tbody><tr><td align="left">a<inline-formula id="IEq96"><inline-graphic xlink:href="13015_2013_Article_221_IEq96_HTML.gif"/></inline-formula></td><td align="left">b<inline-formula id="IEq97"><inline-graphic xlink:href="13015_2013_Article_221_IEq97_HTML.gif"/></inline-formula></td><td align="left">c<inline-formula id="IEq98"><inline-graphic xlink:href="13015_2013_Article_221_IEq98_HTML.gif"/></inline-formula></td></tr></tbody></table><table-wrap-foot><p>The graph-distance is measured from the most 5’ end to the most 3’ end of the sequence. The RNA secondary structure brings the leader transcription regulation site (L-TRS) in close spatial proximity with the body transcription regulation site (B-TRS). The structures (a), (b) and (c) are the most stable structures considering the sub-ensembles which are the sets of structures of graph-distance 14, 5 and 35, respectively. These are the 1st, 6th and 8th most favoured graph-distances in the Boltzmann ensemble.</p></table-wrap-foot></table-wrap></p>
    <p>These examples indicate that the systematic analysis of the graph-distance distribution both for individual RNAs and their aggregation over ensembles of structures can provide useful insights into structural influences on RNA function. These may not be obvious directly from the structures due to the inherent difficulties of predicting long-range base pairs with sufficient accuracy and the many issues inherent in comparing RNA structures of very disparate lengths.</p>
    <p>Due the complexity of algorithm we have refrained from attempting a direct implementation in an imperative programming language. Instead, we are aiming at an implementation in Haskell that allows us to make use of the framework of algebraic dynamic programming [<xref ref-type="bibr" rid="CR28">28</xref>]. The graph-distance measure and the associated algorithm can be extended in principle to of RNA secondary structures with additional tertiary structural elements such as pseudoknots [<xref ref-type="bibr" rid="CR29">29</xref>] and G-quadruples [<xref ref-type="bibr" rid="CR30">30</xref>]. RNA-RNA interaction structures [<xref ref-type="bibr" rid="CR31">31</xref>] also form a promising area for future extensions. We note finally, that the Fourier transition method introduced in [<xref ref-type="bibr" rid="CR32">32</xref>] could be employed to achieve a further speedup.</p>
  </sec>
  <sec id="Sec11">
    <title>Conclusion</title>
    <p>The distribution of spatial distances in the equilibrium structure ensemble of an RNA molecule carries information about the overall structure of the molecule. These distance can be approximated by the graph-distance in RNA secondary structure. We introduced a polynomial time algorithm to compute the equilibrium distribution of graph-distances between a fixed pair of nucleotides. For practical applications, small distances are of main interest. Here, the time complexity of the proposed algorithm is <italic>O</italic>(<italic>n</italic><sup>4</sup>), compared to a naïve implementation with time complexity of <italic>O</italic>(<italic>n</italic><sup>11</sup>) for sequence length <italic>n</italic> and distances that can cover the whole sequence length. Since further reductions, however, seem to be difficult, we also introduced sampling approaches that are much easier to implement. They are also theoretically favorable for several real-life applications, in particular since these primarily concern long-range interactions in very large RNA molecules.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Electronic supplementary material</title>
    <sec id="Sec12">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13015_2013_221_MOESM1_ESM.pdf">
            <caption>
              <p>Additional file 1: <bold>Appendix A: Proof of the</bold>
<inline-formula id="IEq14"><alternatives><mml:math id="M105"><mml:mstyle mathvariant="bold-italic"><mml:mi>E</mml:mi><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>)</mml:mo><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:munder><mml:mi>d</mml:mi><mml:mo>×</mml:mo></mml:mstyle></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq14_HTML.gif"/></alternatives></inline-formula><inline-formula id="IEq15"><alternatives><mml:math id="M106"><mml:mstyle mathvariant="bold-italic"><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:math><inline-graphic xlink:href="13015_2013_Article_221_IEq15_HTML.gif"/></alternatives></inline-formula><bold>.</bold> Appendix B: The conditional probability for <italic>i</italic> to be single-stranded can be determined from the partition function for RNA folding. Appendix C: Tables of notations. (PDF 171 KB)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec13">
        <title>Authors’ original submitted files for images</title>
        <p>Below are the links to the authors’ original submitted files for images.<media position="anchor" xlink:href="13015_2013_221_MOESM2_ESM.pdf" id="MOESM2"><caption><p>Authors’ original file for figure 1</p></caption></media><media position="anchor" xlink:href="13015_2013_221_MOESM3_ESM.pdf" id="MOESM3"><caption><p>Authors’ original file for figure 2</p></caption></media><media position="anchor" xlink:href="13015_2013_221_MOESM4_ESM.pdf" id="MOESM4"><caption><p>Authors’ original file for figure 3</p></caption></media><media position="anchor" xlink:href="13015_2013_221_MOESM5_ESM.pdf" id="MOESM5"><caption><p>Authors’ original file for figure 4</p></caption></media><media position="anchor" xlink:href="13015_2013_221_MOESM6_ESM.pdf" id="MOESM6"><caption><p>Authors’ original file for figure 5</p></caption></media><media position="anchor" xlink:href="13015_2013_221_MOESM7_ESM.pdf" id="MOESM7"><caption><p>Authors’ original file for figure 6</p></caption></media></p>
      </sec>
    </app>
  </app-group>
  <fn-group>
    <fn>
      <p>
        <bold>Competing interests</bold>
      </p>
      <p>The authors declare that they have no competing interests.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors’ contributions</bold>
      </p>
      <p>Conceived and designed the algorithms: JQ, PFS and RB. Implemented algorithms and performed experiments: JQ and MN. Analyzed Diels-Alderase ribozyme data: JQ and PFS. Analyzed pre-mRNA splicing data: MN and MM. Wrote the final manuscript: JQ, MM, PF and RB. All authors read and approved the final manuscript.</p>
    </fn>
  </fn-group>
  <ack>
    <p>This work was supported in part by the <italic>Deutsche Forschungsgemeinschaft</italic> proj. nos. BA 2168/3-3, SFB 992, STA 850/10-2, SPP 1596 and MA 5082/1-1, the BMBF (grant 0316165A) and the MWK (grant 7533-7-11.6.1).</p>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yoffe</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Prinsen</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gelbart</surname>
            <given-names>WM</given-names>
          </name>
          <name>
            <surname>Ben-Shaul</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>The ends of a large RNA molecule are necessarily close</bold>
        </article-title>
        <source>Nucl Acids Res</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>292</fpage>
        <lpage>299</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkq642</pub-id>
        <?supplied-pmid 20810537?>
        <pub-id pub-id-type="pmid">20810537</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fang</surname>
            <given-names>LT</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>The end-to-end distance of RNA as a randomly self-paired polymer</bold>
        </article-title>
        <source>J Theor Biol</source>
        <year>2011</year>
        <volume>280</volume>
        <fpage>101</fpage>
        <lpage>107</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jtbi.2011.04.010</pub-id>
        <?supplied-pmid 21515288?>
        <pub-id pub-id-type="pmid">21515288</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clote</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ponty</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Steyaert</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Expected distance between terminal nucleotides of RNA secondary structures</bold>
        </article-title>
        <source>J Math Biol</source>
        <year>2012</year>
        <volume>65</volume>
        <fpage>581</fpage>
        <lpage>599</lpage>
        <pub-id pub-id-type="doi">10.1007/s00285-011-0467-8</pub-id>
        <?supplied-pmid 21984358?>
        <pub-id pub-id-type="pmid">21984358</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Han</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Reidys</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>The 5’-3’ distance of RNA secondary structures</bold>
        </article-title>
        <source>J Comput Biol</source>
        <year>2012</year>
        <volume>19</volume>
        <fpage>867</fpage>
        <lpage>878</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2011.0301</pub-id>
        <?supplied-pmid 22731624?>
        <pub-id pub-id-type="pmid">22731624</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Forties</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Bundschuh</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Modeling the interplay of single-stranded binding proteins and nucleic acid secondary structure</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>61</fpage>
        <lpage>67</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp627</pub-id>
        <?supplied-pmid 19889798?>
        <pub-id pub-id-type="pmid">19889798</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gerland</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Bundschuh</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hwa</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Force-induced denaturation of RNA</bold>
        </article-title>
        <source>Biophys J</source>
        <year>2001</year>
        <volume>81</volume>
        <fpage>1324</fpage>
        <lpage>1332</lpage>
        <pub-id pub-id-type="doi">10.1016/S0006-3495(01)75789-X</pub-id>
        <?supplied-pmid 11509348?>
        <pub-id pub-id-type="pmid">11509348</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Müller</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Krzakala</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Mézard</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>The secondary structure of RNA under tension</bold>
        </article-title>
        <source>Eur Phys J E</source>
        <year>2002</year>
        <volume>9</volume>
        <fpage>67</fpage>
        <lpage>77</lpage>
        <?supplied-pmid 15010932?>
        <pub-id pub-id-type="pmid">15010932</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gerland</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Bundschuh</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hwa</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Translocation of structured polynucleotides through nanopores</bold>
        </article-title>
        <source>Phys Biol</source>
        <year>2004</year>
        <volume>1</volume>
        <fpage>19</fpage>
        <lpage>26</lpage>
        <pub-id pub-id-type="doi">10.1088/1478-3967/1/1/002</pub-id>
        <?supplied-pmid 16204818?>
        <pub-id pub-id-type="pmid">16204818</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Einert</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Näger</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Orland</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Netz</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Impact of loop statistics on the thermodynamics of RNA Folding</bold>
        </article-title>
        <source>Phys Rev Lett</source>
        <year>2008</year>
        <volume>101</volume>
        <fpage>048103</fpage>
        <pub-id pub-id-type="doi">10.1103/PhysRevLett.101.048103</pub-id>
        <?supplied-pmid 18764368?>
        <pub-id pub-id-type="pmid">18764368</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roy</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hohng</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ha</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>A practical guide to single-molecule FRET</bold>
        </article-title>
        <source>Nat Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>507</fpage>
        <lpage>516</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1208</pub-id>
        <?supplied-pmid 18511918?>
        <pub-id pub-id-type="pmid">18511918</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Das</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Automated de novo prediction of native-like RNA tertiary structures</bold>
        </article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2007</year>
        <volume>104</volume>
        <fpage>14664</fpage>
        <lpage>14669</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0703836104</pub-id>
        <?supplied-pmid 17726102?>
        <pub-id pub-id-type="pmid">17726102</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kobitski</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nierth</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Helm</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jaschke</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nienhaus</surname>
            <given-names>UG</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Mg</bold>
          <sup>
            <bold>2+</bold>
          </sup>
          <bold>-dependent folding of a Diels-Alderase ribozyme probed by single-molecule FRET analysis</bold>
        </article-title>
        <source>Nucleic Acids Res</source>
        <year>2007</year>
        <volume>35</volume>
        <issue>6</issue>
        <fpage>2047</fpage>
        <lpage>2059</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkm072</pub-id>
        <?supplied-pmid 17344321?>
        <pub-id pub-id-type="pmid">17344321</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schuster</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Fontana</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>From sequences to shapes and back: a case study in RNA secondary structures</bold>
        </article-title>
        <source>Proc R Soc London B</source>
        <year>1994</year>
        <volume>255</volume>
        <issue>1344</issue>
        <fpage>279</fpage>
        <lpage>84</lpage>
        <pub-id pub-id-type="doi">10.1098/rspb.1994.0040</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mathews</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Disney</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Childs</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Schroeder</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Zuker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>DH</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Incorporating chemical modification constraints into a dynamic programming algorithm for prediction of RNA secondary structure</bold>
        </article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2004</year>
        <volume>101</volume>
        <fpage>7287</fpage>
        <lpage>7292</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0401799101</pub-id>
        <?supplied-pmid 15123812?>
        <pub-id pub-id-type="pmid">15123812</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCaskill</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>The equilibrium partition function and base pair binding probabilities for RNA secondary structure</bold>
        </article-title>
        <source>Biopolymers</source>
        <year>1990</year>
        <volume>29</volume>
        <issue>6–7</issue>
        <fpage>1105</fpage>
        <lpage>1119</lpage>
        <pub-id pub-id-type="doi">10.1002/bip.360290621</pub-id>
        <?supplied-pmid 1695107?>
        <pub-id pub-id-type="pmid">1695107</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lorenz</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bernhart</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Höner zu Siederdissen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Tafer</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Flamm</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>ViennaRNA Package 2.0</bold>
        </article-title>
        <source>Alg Mol Biol</source>
        <year>2011</year>
        <volume>6</volume>
        <fpage>26</fpage>
        <pub-id pub-id-type="doi">10.1186/1748-7188-6-26</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lyngsø</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Zuker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pedersen</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Fast evaluation of internal loops in RNA secondary structure prediction</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>1999</year>
        <volume>15</volume>
        <fpage>440</fpage>
        <lpage>445</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/15.6.440</pub-id>
        <?supplied-pmid 10383469?>
        <pub-id pub-id-type="pmid">10383469</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ding</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>A statistical sampling algorithm for RNA secondary structure prediction</bold>
        </article-title>
        <source>Nucl Acids Res</source>
        <year>2003</year>
        <volume>31</volume>
        <issue>24</issue>
        <fpage>7280</fpage>
        <lpage>7301</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkg938</pub-id>
        <?supplied-pmid 14654704?>
        <pub-id pub-id-type="pmid">14654704</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fredman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tarjan</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Fibonacci heaps and their uses in improved network optimization algorithms</bold>
        </article-title>
        <source>J ACM</source>
        <year>1987</year>
        <volume>34</volume>
        <issue>3</issue>
        <fpage>596</fpage>
        <lpage>615</lpage>
        <pub-id pub-id-type="doi">10.1145/28869.28874</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darty</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Denise</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ponty</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>VARNA: Interactive drawing and editing of the RNA secondary structure</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>15</issue>
        <fpage>1974</fpage>
        <lpage>1975</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp250</pub-id>
        <?supplied-pmid 19398448?>
        <pub-id pub-id-type="pmid">19398448</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leipply</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lambert</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Draper</surname>
            <given-names>DE</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Ion-RNA interactions thermodynamic analysis of the effects of mono- and divalent ions on RNA conformational equilibria</bold>
        </article-title>
        <source>Methods Enzymol</source>
        <year>2009</year>
        <volume>469</volume>
        <fpage>433</fpage>
        <lpage>463</lpage>
        <pub-id pub-id-type="doi">10.1016/S0076-6879(09)69021-2</pub-id>
        <?supplied-pmid 20946802?>
        <pub-id pub-id-type="pmid">20946802</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mathews</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sabina</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zuker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>DH</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Expanded sequence dependence of thermodynamic parameters improves prediction of RNA secondary structure</bold>
        </article-title>
        <source>J Mol Biol</source>
        <year>1999</year>
        <volume>288</volume>
        <fpage>911</fpage>
        <lpage>940</lpage>
        <pub-id pub-id-type="doi">10.1006/jmbi.1999.2700</pub-id>
        <?supplied-pmid 10329189?>
        <pub-id pub-id-type="pmid">10329189</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baraniak</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Lasda</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Garcia-Blanco</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>A stem structure in fibroblast growth factor receptor 2 transcripts mediates cell-type-specific splicing by approximating intronic control elements</bold>
        </article-title>
        <source>Mol Cell Biol</source>
        <year>2003</year>
        <volume>23</volume>
        <fpage>9327</fpage>
        <lpage>9337</lpage>
        <pub-id pub-id-type="doi">10.1128/MCB.23.24.9327-9337.2003</pub-id>
        <?supplied-pmid 14645542?>
        <pub-id pub-id-type="pmid">14645542</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McManus</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Graveley</surname>
            <given-names>BR</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>RNA structure and the mechanisms of alternative splicing</bold>
        </article-title>
        <source>Curr Opin Genet Dev</source>
        <year>2011</year>
        <volume>21</volume>
        <fpage>373</fpage>
        <lpage>379</lpage>
        <pub-id pub-id-type="doi">10.1016/j.gde.2011.04.001</pub-id>
        <?supplied-pmid 21530232?>
        <pub-id pub-id-type="pmid">21530232</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Amman</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Bernhart</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Doose</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hofacker</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Qin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Will</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>The Trouble with Long-Range Base Pairs in RNA Folding</bold>
        </article-title>
        <source>Lecture Notes in Computer Science: Advances in Bioinformatics and Computational Biology, Volume 8213</source>
        <year>2013</year>
        <publisher-loc>Berlin, Heidelberg, New York</publisher-loc>
        <publisher-name>Springer-Verlag</publisher-name>
        <fpage>1</fpage>
        <lpage>11</lpage>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Celotto</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Graveley</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Exon-specific RNAi: a tool for dissecting the functional relevance of alternative splicing</bold>
        </article-title>
        <source>RNA</source>
        <year>2002</year>
        <volume>8</volume>
        <issue>6</issue>
        <fpage>718</fpage>
        <lpage>724</lpage>
        <pub-id pub-id-type="doi">10.1017/S1355838202021064</pub-id>
        <?supplied-pmid 12088145?>
        <pub-id pub-id-type="pmid">12088145</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dufour</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mateos-Gomez</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Enjuanes</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Gallego</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sola</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Structure and functional relevance of a transcription-regulating sequence involved in coronavirus discontinuous RNA synthesis</bold>
        </article-title>
        <source>J Virol</source>
        <year>2011</year>
        <volume>85</volume>
        <issue>10</issue>
        <fpage>4963</fpage>
        <lpage>4973</lpage>
        <pub-id pub-id-type="doi">10.1128/JVI.02317-10</pub-id>
        <?supplied-pmid 21389138?>
        <pub-id pub-id-type="pmid">21389138</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Giegerich</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Algebraic dynamic programming</bold>
        </article-title>
        <source>Algebraic Methodology And Software Technology</source>
        <year>2002</year>
        <publisher-loc>Berlin, Heidelberg, New York</publisher-loc>
        <publisher-name>Springer-Verlag</publisher-name>
        <fpage>349</fpage>
        <lpage>364</lpage>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reidys</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>FWD</given-names>
          </name>
          <name>
            <surname>Andersen</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Penner</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Nebel</surname>
            <given-names>ME</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Topology and prediction of RNA pseudoknots</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>8</issue>
        <fpage>1076</fpage>
        <lpage>1085</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr090</pub-id>
        <?supplied-pmid 21335320?>
        <pub-id pub-id-type="pmid">21335320</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Lorenz R, Bernhart S, Qin J, Honer zu, Siederdissen C, Tanzer A, Amman F, Hofacker I: 2D meets 4G: G-Quadruplexes in RNA Secondary Structure Prediction. IEEE/ACM Trans Comput Biol Bioinformatics. doi:10.1109/TCBB.2013.7,</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>AX</given-names>
          </name>
          <name>
            <surname>Marz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Qin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Reidys</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>RNA-RNA interaction prediction based on multiple sequence alignments</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>4</issue>
        <fpage>456</fpage>
        <lpage>463</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq659</pub-id>
        <?supplied-pmid 21134894?>
        <pub-id pub-id-type="pmid">21134894</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Senter</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sheikh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dotu</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Ponty</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Clote</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Using the fast fourier transform to accelerate the computational search for RNA conformational switches</bold>
        </article-title>
        <source>PLoS ONE</source>
        <year>2012</year>
        <volume>7</volume>
        <issue>12</issue>
        <fpage>e50506</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0050506</pub-id>
        <?supplied-pmid 23284639?>
        <pub-id pub-id-type="pmid">23284639</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
