<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10311327</article-id>
    <article-id pub-id-type="pmid">37387138</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad202</article-id>
    <article-id pub-id-type="publisher-id">btad202</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Genome Sequence Analysis</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Effects of spaced k-mers on alignment-free genotyping</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6204-571X</contrib-id>
        <name>
          <surname>Häntze</surname>
          <given-names>Hartmut</given-names>
        </name>
        <aff><institution>Department of Computer Science and Information Engineering, National Cheng Kung University</institution>, Tainan City 701, <country country="TW">Taiwan</country></aff>
        <xref rid="btad202-cor1" ref-type="corresp"/>
        <!--hartmut.haentze@gmail.com-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0916-7339</contrib-id>
        <name>
          <surname>Horton</surname>
          <given-names>Paul</given-names>
        </name>
        <aff><institution>Department of Computer Science and Information Engineering, National Cheng Kung University</institution>, Tainan City 701, <country country="TW">Taiwan</country></aff>
        <xref rid="btad202-cor1" ref-type="corresp"/>
        <!--paulh@iscb.org-->
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad202-cor1">Corresponding author. Department of Computer Science and Information Engineering, National Cheng Kung University, Tainan City, Taiwan. E-mail: <email>hartmut.haentze@gmail.com</email> (H.H.); Department of Computer Science and Information Engineering, National Cheng Kung University, Tainan City, Taiwan. E-mail: <email>paulh@iscb.org</email> (P.H.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-06-30">
      <day>30</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>Suppl 1</issue>
    <issue-title>ISMB/ECCB 2023 Proceedings</issue-title>
    <fpage>i213</fpage>
    <lpage>i221</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad202.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Alignment-free, k-mer based genotyping methods are a fast alternative to alignment-based methods and are particularly well suited for genotyping larger cohorts. The sensitivity of algorithms, that work with k-mers, can be increased by using spaced seeds, however, the application of spaced seeds in k-mer based genotyping methods has not been researched yet.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We add a spaced seeds functionality to the genotyping software PanGenie and use it to calculate genotypes. This significantly improves sensitivity and F-score when genotyping SNPs, indels, and structural variants on reads with low (5×) and high (30×) coverage. Improvements are greater than what could be achieved by just increasing the length of contiguous k-mers. Effect sizes are particularly large for low coverage data. If applications implement effective algorithms for hashing of spaced k-mers, spaced k-mers have the potential to become an useful technique in k-mer based genotyping.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The source code of our proposed tool MaskedPanGenie is openly available on <ext-link xlink:href="https://github.com/hhaentze/MaskedPangenie" ext-link-type="uri">https://github.com/hhaentze/MaskedPangenie</ext-link>.</p>
      </sec>
    </abstract>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Next-generation sequencing (NGS) produces a vast amount of short amino acid or nucleotide sequences of up to 300 base pairs (bp). These sequences, called reads, do not directly give us an organism’s genome because their position within the genome is unknown. For further analysis, e.g. variant calling, many workflows either assemble reads <italic toggle="yes">de novo</italic> or align them to a reference genome. Aligning full reads by exact matching can be done in linear time, but the presence of variants and sequencing errors requires inexact matching. Dynamic programming algorithms can find optimal solutions for inexact matching with quadratic time complexity (<xref rid="btad202-B30" ref-type="bibr">Smith and Waterman 1981</xref>; <xref rid="btad202-B12" ref-type="bibr">Gotoh 1982</xref>). However, faced with the enormous amount of data produced by NGS systems, this quickly became insufficient. Recent methods, such as BWA-MEM (<xref rid="btad202-B21" ref-type="bibr">Li 2013</xref>), utilize hash functions, advanced indices and seeding techniques to accelerate read alignment further. Nevertheless, they still require a considerable amount of time and computing power.</p>
    <p>To further increase genotyping speed and reduce reference bias, alignment-free methods, such as PanGenie (<xref rid="btad202-B10" ref-type="bibr">Ebler et al. 2022</xref>), were proposed. These methods utilize vast databases of known variants in the human genome, which are available through the sequencing efforts and benchmark standardization of the last decade (e.g. 1000 Genomes Project, Genome in a Bottle). By mapping k-mers of a sample directly to a variant database, genotyping can be sped up immensely. Compared with mapping-based approaches, PanGenie can genotype more than four times faster at 30× coverage and achieves better genotype concordance (<xref rid="btad202-B10" ref-type="bibr">Ebler et al. 2022</xref>). The acceleration is partially due to the use of exact matching of k-mers, as opposed to inexact matching. However this comes at the cost of not being able to utilize k-mers spanning a read sequence error to identify variants.</p>
    <p>Spaced (also know as discontiguous) k-mers provide a possible solution to this problem. This approach was introduced to bioinformatics in the context of homology search (<xref rid="btad202-B23" ref-type="bibr">Ma et al. 2002</xref>) and was quickly adopted by other applications. To the best of our knowledge, exact matching of spaced k-mers has not yet been applied in alignment-free k-mer based genotyping. This article aims to evaluate the potential spaced k-mers might have on these algorithms. There exist many different algorithms, and evaluating the effect of spaced k-mers on all of them is not feasible. Hence, this study will concentrate on a single application, namely PanGenie (<xref rid="btad202-B10" ref-type="bibr">Ebler et al. 2022</xref>), which had higher genotype concordance and faster computing time than other applications. The effects of spaced k-mers on this application should give a general impression on possible advantages or problems spaced k-mers introduce to alignment-free genotyping.</p>
  </sec>
  <sec>
    <title>2 Related work</title>
    <p>This section introduces the literature this study is built on. First, it provides an overview of alignment-free genotyping. Second, spaced k-mers are introduced and explained in depth. Lastly, the intersection of both technologies is discussed.</p>
    <sec>
      <title>2.1 Alignment-free genotyping</title>
      <p>Genotyping is the process of determining which genetic variants an individual possesses (<xref rid="btad202-B5" ref-type="bibr">Byard and Payne-James 2016</xref>). Many genotyping workflows map the reads to a reference genome and then call differences between reads and reference sequence [e.g. BWA-MEM and GATK Haplotype Caller (<xref rid="btad202-B25" ref-type="bibr">McKenna et al. 2010</xref>; <xref rid="btad202-B21" ref-type="bibr">Li 2013</xref>)]. However, mapping the reads to the reference genome is computationally expensive and introduces reference bias to the results (<xref rid="btad202-B39" ref-type="bibr">Zielezinski et al. 2017</xref>). Alignment-free genotyping methods were developed to further accelerate genotyping and reduce reference bias. Their advantage is that they are computationally inexpensive and more robust to shuffling and recombination events, thus being well suited for analyzing populations with high variation in their genome (<xref rid="btad202-B33" ref-type="bibr">Vinga 2014</xref>). Disadvantages, however, are that symbol order is lost in the majority of alignment-free algorithms (<xref rid="btad202-B33" ref-type="bibr">Vinga 2014</xref>) and that unknown variants cannot be detected. Two main categories of alignment-free sequence comparisons have been proposed (<xref rid="btad202-B34" ref-type="bibr">Vinga and Almeida 2003</xref>). The first is based on the frequency of fixed-length k-mers within the reads and the second is based on Kolmogorov complexity and Chaos Theory. This article only considers the first category.</p>
      <p>Variants in the genome have specific patterns of k-mers surrounding them. To genotype a known variant, one can count how many and how often surrounding k-mers appear in the reads and calculate likelihoods of reference and alternative alleles. This is much faster than trying to find optimal read alignments, as counting k-mers can be done with almost linear time complexity through exact matching and hash maps.</p>
      <p>In recent years, many applications and studies about alignment-free algorithms have been published. <xref rid="btad202-B28" ref-type="bibr">Shajii et al. (2016)</xref> introduced a lightweight assignment of variant alleles (LAVA). Given a set of SNPs, LAVA constructs a dictionary of mid-size k-mers (<italic toggle="yes">k</italic> = 32), which uniquely belong to these SNPs, as well as a second dictionary of the k-mers in the human genome. Through bipartite matching of k-mers in the reads to the k-mers in the precomputed dictionary up to Hamming distance 1, LAVA can determine if a read belongs to a particular SNP. It then calculates genotypes (homozygous reference, heterozygous, homozygous alternate) with Bayes’ rule using allele frequencies. <xref rid="btad202-B8" ref-type="bibr">Denti et al. (2019)</xref> extended this approach and introduced a method that can genotype multi-allelic SNPs and indels using exact matching of contiguous k-mers. Similarly, <xref rid="btad202-B29" ref-type="bibr">Sibbesen et al. (2018)</xref> developed BayesTyper, which exactly matches contiguous k-mers (<italic toggle="yes">k</italic> = 55) to a variant graph and genotypes each variant, including SVs, based on observed k-mer frequencies. BayesTyper then uses an iterative, heuristic algorithm to estimate a subset of most likely haplotypes. They observe that variants that are less than k-1 nucleotides apart will share a k-mer and must thus be clustered together in the variant graph. Additionally, adding a database containing known variation significantly improves the sensitivity of genotyping structural variation. K-mer counts alone are not sufficient to reliable genotype loci that are poorly covered by k-mers, or do not have unique k-mers (<xref rid="btad202-B10" ref-type="bibr">Ebler et al. 2022</xref>). Ebler et al<italic toggle="yes">.</italic> propose an algorithm, PanGenie, that overcomes this limitation by leveraging linkage disequilibrium (LD) of structures inherent in multiple haplotype-resolved assemblies. LD is the phenomenon that alleles, at population level, are not independent of each other but follow specific patterns. It can be used to make assumptions about genotypes based on the surrounding alleles. For this, PanGenie first builds an acyclic and directed pangenome graph from a callset of multiple haplotype-resolved assemblies. The pangenome graph contains bubbles, i.e. different allele paths, for each variant in the callset. To calculate the likelihood of allele combinations in each bubble, PanGenie compares the expected counts of k-mer unique to the bubble with the actual counts of these k-mer in the reads. Finally, it infers genotypes of poorly covered loci by leveraging LD through a Hidden Markov Model.</p>
      <p>This approach is faster and achieves better genotype concordances than most mapping-based algorithms. Improvements are especially notable for large insertions and repetitive regions (<xref rid="btad202-B10" ref-type="bibr">Ebler et al. 2022</xref>). However, PanGenie only uses contiguous k-mers, even though spaced k-mers have reportedly improved many k-mer-based algorithms (<xref rid="btad202-B23" ref-type="bibr">Ma et al. 2002</xref>; <xref rid="btad202-B19" ref-type="bibr">Leimeister et al. 2014</xref>; <xref rid="btad202-B37" ref-type="bibr">Wood et al. 2019</xref>).</p>
    </sec>
    <sec>
      <title>2.2 Spaced k-mers</title>
      <p>K-mers are substrings of constant length <italic toggle="yes">k</italic>, with <italic toggle="yes">k</italic> being smaller than the length of the reads. Typically, they are contiguous, meaning they capture all consecutive bases within a substring of a nucleotide sequence. Contiguous k-mers have been used in BLAST (<xref rid="btad202-B2" ref-type="bibr">Altschul et al. 1990</xref>) for local alignment, in de Bruijn-graphs for assembly [e.g. Velvet (<xref rid="btad202-B38" ref-type="bibr">Zerbino and Birney 2008</xref>)] and in metagenomic sequence classification [e.g. Kraken (<xref rid="btad202-B36" ref-type="bibr">Wood and Salzberg 2014</xref>)]. Choosing the optimal length <italic toggle="yes">k</italic> is essential. Long k-mers have a high probability of containing sequencing errors and may lose distant homologies. Short k-mers, on the other hand, are not as distinctive and increase the computational burden (<xref rid="btad202-B23" ref-type="bibr">Ma et al. 2002</xref>).</p>
      <p>One method to increase k-mer length, while keeping the risk of missing matches due to sequencing errors low, is approximate k-mer matching (<xref rid="btad202-B28" ref-type="bibr">Shajii et al. 2016</xref>). In contrast to exact matching, this also matching up to a given Hamming distance. However, while this reduces the effect of sequencing errors, it also decreases the number of identifiable unambiguous loci in the genome (<xref rid="btad202-B28" ref-type="bibr">Shajii et al. 2016</xref>). For example, allowing a hamming distance of 1, a single k-mer in the reference database could be matched with up to <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> different k-mers in the reads.</p>
      <p>Another method that reduces the effect of sequencing errors without affecting the number of identifiable unambiguous loci is exact k-mer matching using spaced seeds. Early applications of spaced seeds can be found in <xref rid="btad202-B23" ref-type="bibr">Ma et al. (2002)</xref>, for faster and more sensitive homology search, as well as by <xref rid="btad202-B4" ref-type="bibr">Burkhardt and Kärkkäinen (2003)</xref>, for faster and/or more efficient filtering than with contiguous k-mers. They can increase the sensitivity of seed-and-extend methods for local alignment (<xref rid="btad202-B23" ref-type="bibr">Ma et al. 2002</xref>; <xref rid="btad202-B32" ref-type="bibr">Gotea et al. 2003</xref>; <xref rid="btad202-B17" ref-type="bibr">Kiełbasa et al. 2011</xref>) and can improve results of alignment-free sequence comparison methods (<xref rid="btad202-B19" ref-type="bibr">Leimeister et al. 2014</xref>) as well as specificity and sensitivity in metagenomic classification (<xref rid="btad202-B3" ref-type="bibr">Břinda et al. 2015</xref>; <xref rid="btad202-B37" ref-type="bibr">Wood et al. 2019</xref>).<statement id="mthst1"><label>Definition 1.</label><p>A seed <italic toggle="yes">s</italic> is a binary pattern over the symbols 1 and 0, denoting <italic toggle="yes">care</italic> and <italic toggle="yes">don’t care</italic> positions, respectively (<xref rid="btad202-B3" ref-type="bibr">Břinda et al. 2015</xref>). We use <italic toggle="yes">l</italic> to denote the length of this pattern, and <italic toggle="yes">w</italic> to denote the number of 1’s in the patter, known as the <monospace>weight</monospace> of the seed. If the weight and length of <italic toggle="yes">s</italic> are equal, <italic toggle="yes">s</italic> is called contiguous, otherwise spaced. A seed is palindromic if care and do not care positions remain the same, regardless of the direction in which the seed is read.</p></statement><statement id="mthst2"><label>Definition 2.</label><p>Given a spaced seed with length <italic toggle="yes">l</italic> and weight <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula>, a spaced <italic toggle="yes">k</italic>-mer is a series of <italic toggle="yes">k</italic> characters of a substring of length <italic toggle="yes">l</italic> at care positions of the used seed. For example, applying seed 1101 (two care positions followed by a do not care position and another care position) on the sequence ACTGA, results in the spaced 3-mers ACG and CTA. Two spaced k-mers can be equal, even when the raw sequences differ. For instance, using seed 1101 on the sequences ATGC and ATAC will result in the spaced 3-mer ATC in both cases.</p></statement></p>
      <sec>
        <title>2.2.1 Seed selection</title>
        <p>Applications that use contiguous k-mers must choose a suitable weight k to achieve the wanted trade-off between distinctiveness and risk of sequencing errors. For spaced seeds, this gets more complicated. Apart from the weight and length of a seed, care and do not care positions need to be specified, too.</p>
        <p>A seed’s ability to detect similar segments between biological sequences is measured in terms of sensitivity, i.e. the probability of generating a hit with a spaced seed in a fixed-length region with a given similarity level. Different seeds have different sensitivity, and selecting a seed with high sensitivity is essential. <xref rid="btad202-B23" ref-type="bibr">Ma et al. (2002)</xref> argue that the reason for increased sensitivity is that the events of having a match at different positions become more independent for spaced seeds. ‘Generally, the fewer bases shared by a model and its shifted copies, the higher its sensitivity is (<xref rid="btad202-B23" ref-type="bibr">Ma et al. 2002</xref>).’ The best seeds typically possess little regularity, with consecutive seeds consequently being among the worst (<xref rid="btad202-B4" ref-type="bibr">Burkhardt and Kärkkäinen 2003</xref>).</p>
        <p>Sensitivity can be calculated with dynamic programming (<xref rid="btad202-B16" ref-type="bibr">Keich et al. 2004</xref>) or a recurrence relation (<xref rid="btad202-B7" ref-type="bibr">Choi and Zhang 2004</xref>). Unfortunately the problem is NP-hard (<xref rid="btad202-B22" ref-type="bibr">Ma and Li 2007</xref>), with both the number of possible spaced seeds, and the time to calculate the hit probability, i.e. sensitivity, of a given spaced seed increasing exponentially in <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:math></inline-formula>. Thus in general spaced seeds can only be optimized approximately.</p>
        <p>As a heuristic, <xref rid="btad202-B13" ref-type="bibr">Ilie and Ilie (2007)</xref> introduce a new measure, overlap complexity, and show that it is experimentally well correlated to sensitivity. They give an algorithm that starts with a randomly selected initial seed and tries to improve it iteratively. <xref rid="btad202-B14" ref-type="bibr">Ilie et al. (2011)</xref> implement this algorithm in their software SpEED which executes the algorithm multiple times for different seed lengths. Through these approximations, SpEED can compute highly sensitive multiple spaced seeds in a few seconds.</p>
      </sec>
    </sec>
    <sec>
      <title>2.3 Spaced k-mers in alignment-free genotyping</title>
      <p>As demonstrated by <xref rid="btad202-B23" ref-type="bibr">Ma et al. (2002)</xref> and others, spaced seeds are effective seed-and-extend local alignment applications such as homology search and read mapping. However those findings cannot be directly transferred to alignment-free genotyping; where the measure of success is not the percent accuracy of mapping individual reads, but rather the aggregate effect of the ensemble of read k-mers matched to known variant alleles.</p>
      <p>Sequencing errors and mutations affect the proportion of k-mers that can be mapped to different variant alleles at a locus. Thus theoretically spaced k-mers might be able to increase this proportion in favour of the correct allele. Whether this is true in practice is however not self-evident; especially when sequence errors are infrequent. For example, reads in this study were sequenced with an Ilumina HiSeq X Ten platform with a median error rate of only 0.087% (<xref rid="btad202-B31" ref-type="bibr">Stoler and Nekrutenko 2021</xref>) per base.</p>
      <p>This study aims to investigate the practical advantages (if any) of using spaced k-mers for one genotyping method, namely PanGenie (<xref rid="btad202-B10" ref-type="bibr">Ebler et al. 2022</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>3 Methodology</title>
    <sec>
      <title>3.1 Problem formalization</title>
      <p>Given a set of <italic toggle="yes">reads</italic>, a reference genome <italic toggle="yes">ref</italic> and a haplotype resolved file of known variants <italic toggle="yes">vcf</italic>, PanGenie (<xref rid="btad202-B10" ref-type="bibr">Ebler et al. 2022</xref>) can be used to predict haplotypes <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>C</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> by using a contiguous seed <italic toggle="yes">C</italic>. To analyse spaced seeds’ effects on genotyping, this study proposes an adapted software <italic toggle="yes">MaskedPanGenie</italic>, which extends PanGenie with a spaced seed functionality. Given a space seed <italic toggle="yes">S</italic>, MaskedPanGenie can predict haplotypes <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> by using spaced-k-mers in reads, instead of contiguous k-mers. It is written in C++ and publicly available at <ext-link xlink:href="https://github.com/hhaentze/MaskedPangenie" ext-link-type="uri">https://github.com/hhaentze/MaskedPangenie</ext-link>. MaskedPanGenie requires the occurrences of spaced k-mers in the reads as input. We count spaced k-mers by combining the counting tool Jellyfish (<xref rid="btad202-B24" ref-type="bibr">Marçais and Kingsford 2011</xref>) with our own helper application <italic toggle="yes">MaskJelly</italic> (<ext-link xlink:href="https://github.com/hhaentze/MaskJelly" ext-link-type="uri">https://github.com/hhaentze/MaskJelly</ext-link>). We aim to investigate the effects of do not care positions on genotyping by comparing the results of genotyping with seeds <italic toggle="yes">C</italic> and <italic toggle="yes">S</italic> (of equal weight). However, apart from having do not care positions, spaced seed <italic toggle="yes">S</italic> is also longer than the contiguous seed <italic toggle="yes">C</italic>. Hence, differences in the genotyping results with <italic toggle="yes">C</italic> and <italic toggle="yes">S</italic> could also be due to the different lengths. Thus, we include a contiguous seed <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> with length equal to <italic toggle="yes">S</italic> as a second control group. If do not care positions do not significantly affect the genotyping process, similar results can be expected for spaced seed <italic toggle="yes">S</italic> and contiguous seeds of equal weight (<italic toggle="yes">C</italic>) or length (<inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>).</p>
      <p>
        <inline-graphic xlink:href="btad202ilf1.jpg"/>
      </p>
      <list list-type="order">
        <list-item>
          <p><bold>C</bold> (control group 1) A mid-sized contiguous seed with weight and length of 31. (default k-mer size in PanGenie)</p>
        </list-item>
        <list-item>
          <p><bold>S<sub>1</sub> and S<sub>2</sub></bold> Spaced seeds with weight of 31 and length of 51. Length and patterns of do not care positions are calculated with the help of SpEED (<xref rid="btad202-B14" ref-type="bibr">Ilie et al. 2011</xref>). We chose the first and second most sensitive patterns according to SpeEED.</p>
        </list-item>
        <list-item>
          <p><bold>C’</bold> (control group 2) A long-sized contiguous seed with weight and length of 51.</p>
        </list-item>
      </list>
      <p>We use MaskedPanGenie to calculate callsets for each seed and asked which callset <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>C</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, or <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is closest to a given ground truth.
</p>
      <disp-formula id="E1">
        <mml:math id="M1" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>h</mml:mi>
                      </mml:mrow>
                      <mml:mi>C</mml:mi>
                    </mml:msub>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mtext>reads</mml:mtext>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>=</mml:mo>
                    <mml:mi mathvariant="monospace">MaskedPanGenie</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mtext>reads</mml:mtext>
                    <mml:mo>,</mml:mo>
                    <mml:mtext>ref</mml:mtext>
                    <mml:mo>,</mml:mo>
                    <mml:mtext>vcf</mml:mtext>
                    <mml:mo>|</mml:mo>
                    <mml:mi>C</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>h</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>S</mml:mi>
                          </mml:mrow>
                          <mml:mi>x</mml:mi>
                        </mml:msub>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mtext>reads</mml:mtext>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>=</mml:mo>
                    <mml:mi mathvariant="monospace">MaskedPanGenie</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mtext>reads</mml:mtext>
                    <mml:mo>,</mml:mo>
                    <mml:mtext>ref</mml:mtext>
                    <mml:mo>,</mml:mo>
                    <mml:mtext>vcf</mml:mtext>
                    <mml:mo>|</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>S</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                        <mml:mo>,</mml:mo>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>h</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>C</mml:mi>
                          </mml:mrow>
                          <mml:mo>′</mml:mo>
                        </mml:msup>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mtext>reads</mml:mtext>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>=</mml:mo>
                    <mml:mi mathvariant="monospace">MaskedPanGenie</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mtext>reads</mml:mtext>
                    <mml:mo>,</mml:mo>
                    <mml:mtext>ref</mml:mtext>
                    <mml:mo>,</mml:mo>
                    <mml:mtext>vcf</mml:mtext>
                    <mml:mo>|</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>C</mml:mi>
                      </mml:mrow>
                      <mml:mo>′</mml:mo>
                    </mml:msup>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>Variants in the predicted callsets can be either absent (0<inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mo>|</mml:mo></mml:math></inline-formula>0), ie. both alleles are in line with the reference genome, heterozygous (1|0), homozygous (1|1) or undefined (*|*). The differences between the predicted sets and the true set of haplotypes are measured in terms of recall, precision and F-score.
</p>
      <disp-formula id="E2">
        <mml:math id="M2" display="block" overflow="scroll">
          <mml:mtable>
            <mml:mtr>
              <mml:mtd>
                <mml:mtable>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mtext>Recall</mml:mtext>
                        <mml:mo>=</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:mtext>TP</mml:mtext>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>TP</mml:mtext>
                            <mml:mo>+</mml:mo>
                            <mml:mtext>FN</mml:mtext>
                          </mml:mrow>
                        </mml:mfrac>
                        <mml:mo> </mml:mo>
                        <mml:mo> </mml:mo>
                        <mml:mo> </mml:mo>
                        <mml:mtext>Precision</mml:mtext>
                        <mml:mo>=</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:mtext>TP</mml:mtext>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>TP</mml:mtext>
                            <mml:mo>+</mml:mo>
                            <mml:mtext>FP</mml:mtext>
                          </mml:mrow>
                        </mml:mfrac>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mi>F</mml:mi>
                <mml:mo>-</mml:mo>
                <mml:mtext>score</mml:mtext>
                <mml:mo>=</mml:mo>
                <mml:mn>2</mml:mn>
                <mml:mo>×</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mtext>precision</mml:mtext>
                    <mml:mo>×</mml:mo>
                    <mml:mtext>recall</mml:mtext>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext>precision</mml:mtext>
                    <mml:mo>+</mml:mo>
                    <mml:mtext>recall</mml:mtext>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>This study defines true positive (TP), false positive (FP) and false negative (FN) according to the most stringent model of the ‘Best practices for benchmarking germline small-variant calls in human genomes’ (<xref rid="btad202-B18" ref-type="bibr">Krusche et al. 2019</xref>). Only sides with identical alleles and genotype in truth and callset are counted as TPs. Another metric that can be used for comparing call sets is genotype concordance, i.e. the proportion of correctly genotyped variants. However, <xref rid="btad202-B10" ref-type="bibr">Ebler et al. (2022)</xref> argue that genotype concordance is flawed if callsets contain variants originating from multiple samples because the number of absent variants (0|0) will be higher than the number of variants with true genotypes 0|1 or 1|1. To adjust for unequal numbers of 0|0, 0|1 and 1|1, they use a weighted genotype concordance (wGC), which is computed as:
where <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">x</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="normal">y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">x</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="normal">y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> denote the number of correctly and erroneously classified variants of genotype <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:math></inline-formula> respectively.</p>
      <disp-formula id="E3">
        <mml:math id="M3" display="block" overflow="scroll">
          <mml:mtable>
            <mml:mtr>
              <mml:mtd>
                <mml:mtable>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mtext>conc</mml:mtext>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi mathvariant="normal">x</mml:mi>
                        <mml:mo>|</mml:mo>
                        <mml:mi mathvariant="normal">y</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>=</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>T</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>x</mml:mi>
                                <mml:mo>|</mml:mo>
                                <mml:mi>y</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>T</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>x</mml:mi>
                                <mml:mo>|</mml:mo>
                                <mml:mi>y</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>+</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>F</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>x</mml:mi>
                                <mml:mo>|</mml:mo>
                                <mml:mi>y</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mfrac>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mtext>wGC</mml:mtext>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mtext>conc</mml:mtext>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mn>0</mml:mn>
                    <mml:mo>|</mml:mo>
                    <mml:mn>0</mml:mn>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>+</mml:mo>
                    <mml:mtext>conc</mml:mtext>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mn>0</mml:mn>
                    <mml:mo>|</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>+</mml:mo>
                    <mml:mtext>conc</mml:mtext>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>|</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mn>3</mml:mn>
                </mml:mfrac>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>This study reports adjusted versions of those metrics, which only include variants that are part of the given known variants file. Variants, which are undefined in the ground-truth set, are removed from both sets. Following the evaluation procedure of PanGenie (<xref rid="btad202-B10" ref-type="bibr">Ebler et al. 2022</xref>); we use a kind of leave-one-out cross validation in which when calling variants on an individual, the pan-genome used is constructed based the rest of the individuals. To investigate whether sequencing depth has an impact on genotyping with spaced k-mers, we test MaskedPangenie on both low (5×) and high (30×) coverage data. We evaluate genotyping separately for SNVs, indels and SVs. The tool we wrote for the calculation can be accessed at <ext-link xlink:href="https://github.com/hhaentze/GenotypeConcordance" ext-link-type="uri">https://github.com/hhaentze/GenotypeConcordance</ext-link>.</p>
    </sec>
    <sec>
      <title>3.2 Choosing a spaced seed</title>
      <sec>
        <title>3.2.1 Seed structure</title>
        <p>For the weight of the spaced seed <italic toggle="yes">S</italic> we choose the k-mer length used in the original PanGenie study, which is 31. The length of <italic toggle="yes">S</italic> needs to be above 31 and preferably lower than 76, which is half the length of the reads used in this experiment. Seed lengths <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mo>≥</mml:mo><mml:mn>76</mml:mn></mml:mrow></mml:math></inline-formula> would reduce the maximum number of unique k-mers (e.g. 31 for a weight of 31) that can cover a single nucleotide variation. The first and last positions of the seeds are always ‘1’. PanGenie uses canonical representations of k-mers. Canonical means that k-mers are considered equivalent to their reversed compliment, and the lexicographically smaller version serves as a representative. To guarantee that spaced k-mer from forward and reverse strand have the same canonical form, we require <italic toggle="yes">S</italic> to be palindromic. That is, care and do not care positions must be arranged symmetrically.</p>
      </sec>
      <sec>
        <title>3.2.2 Number of possible spaced seeds</title>
        <p>Given a weight of <italic toggle="yes">w</italic> and a length of <italic toggle="yes">l</italic> there are generally <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mi>l</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>w</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> different seeds. Previously introduced constraints lower this number. Each seed should start and end with ‘1’ so the number of possible seeds |<italic toggle="yes">S</italic>| can be reduced to <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>w</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The palindromic constraint further reduces this to:
</p>
        <disp-formula id="E4">
          <mml:math id="M4" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mo>|</mml:mo>
              <mml:mi>S</mml:mi>
              <mml:mo>|</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:mtable>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mo>⌊</mml:mo>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mi>l</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:mfrac>
                        </mml:mrow>
                        <mml:mo>⌋</mml:mo>
                      </mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mo>⌊</mml:mo>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mi>w</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:mfrac>
                        </mml:mrow>
                        <mml:mo>⌋</mml:mo>
                      </mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
                <mml:mo>)</mml:mo>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>For instance, given a weight of 31, there are <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mn>19</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>14</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>11</mml:mn><mml:mo> </mml:mo><mml:mn>628</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mn>24</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>14</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo> </mml:mo><mml:mn>961</mml:mn><mml:mo> </mml:mo><mml:mn>256</mml:mn></mml:mrow></mml:math></inline-formula> possible seeds for lengths 41 and 51 respectively.</p>
      </sec>
      <sec>
        <title>3.2.3 Application of SpEED</title>
        <p>To obtain a good palindromic spaced seed <italic toggle="yes">S</italic> with weight 31, we use the tool SpEED (<xref rid="btad202-B14" ref-type="bibr">Ilie et al. 2011</xref>) to create a spaced seed with length 16 and extend the obtained seed with its mirrored version on its right side to ensure that it is palindromic. For the expected similarity level between homologous regions, we choose 95%, as recommended in the SpEED documentation. For the length of homologous regions, we somewhat arbitrarily choose 76, which is half the read length.
</p>
        <disp-formula id="E5">
          <mml:math id="M5" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mtext>SpEED</mml:mtext>
              <mml:mo> </mml:mo>
              <mml:mn>16</mml:mn>
              <mml:mo> </mml:mo>
              <mml:mn>1</mml:mn>
              <mml:mo> </mml:mo>
              <mml:mn>0.95</mml:mn>
              <mml:mo> </mml:mo>
              <mml:mn>76</mml:mn>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>The most sensitive seed obtained after 4680 iterations was 11101110010101001101001111, with a sensitivity of 0.999, given the specified parameters. Mirroring and extending the seed results in the seed <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, with a length of 51. To construct <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> we proceeded in the same way, but instead used the second most sensitive seed (also with a sensitivity of <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mo>≈</mml:mo></mml:math></inline-formula> 0.999) obtained through SpEED.
</p>
        <disp-formula id="E6">
          <mml:math id="M6" display="block" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>S</mml:mi>
                    </mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>111011100101010011010011111110010110010101001110111</mml:mn>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>S</mml:mi>
                    </mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>111101010011100100110101111101011001001110010101111</mml:mn>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>Note that <xref rid="btad202-B14" ref-type="bibr">Ilie et al. (2011)</xref> tested their algorithm for multiple spaced seeds up to a weight of 18. PanGenie, on the other hand, is designed for mid-size k-mers with a weight of 31. It is unclear if SpEED can find a good single seed for this weight. However, the complexity of the problem makes it hard to find more optimal solutions.</p>
      </sec>
    </sec>
    <sec>
      <title>3.3 Statistics</title>
      <p>To determine whether the null hypothesis that both methods are equally good can be rejected, we conducted two-sided significance tests. We adopted the Wilcoxon signed-rank test (<xref rid="btad202-B35" ref-type="bibr">Wilcoxon 1992</xref>) with exactly calculated <italic toggle="yes">P</italic>-values as a testing procedure suitable for paired data with small sample size (<xref rid="btad202-B1" ref-type="bibr">Altman et al. 1983</xref>; <xref rid="btad202-B26" ref-type="bibr">Mundry and Fischer 1998</xref>). For a sample size <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:math></inline-formula> the smallest possible <italic toggle="yes">P</italic>-value is <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>≈</mml:mo><mml:mn>0.004</mml:mn></mml:mrow></mml:math></inline-formula>.</p>
      <sec>
        <title>3.3.1 Consideration of multiple testing</title>
        <p>This study tests significance with regard to three variant types {SNV, indel, SV}, two read-coverages {5×, 30×}, and four metrics (precision, recall, F1-Score, wGC), resulting in a total of <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>24</mml:mn></mml:mrow></mml:math></inline-formula> different tests. Therefore we considered if it would be appropriate to apply a standard method for multiple testing correction. The well known Bonferroni provides a strict upper bound on a corrected <italic toggle="yes">P</italic>-value by simply multiplying by <italic toggle="yes">m</italic>. With a sample size of 9, the lowest possible corrected <italic toggle="yes">P</italic>-value would be <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>24</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0.004</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0.096</mml:mn><mml:mo>&gt;</mml:mo><mml:mn>5</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>, excluding any possibility of obtaining statistically significantly results. Less stringent tests such as by Westfall/Young or Benjamin/Hochberg are also problematic because they require ranking individual <italic toggle="yes">P</italic>-values, but small sample size signed-rank tests tend to produce many individual <italic toggle="yes">P</italic>-values of equal value.</p>
        <p>Faced with these difficulties, we decided to report individual <italic toggle="yes">P</italic>-values without multiple testing correction. The key caveat is that when interpreting this work the results of all of the tests should be considered together, rather than focusing on a few tests with particularly low <italic toggle="yes">P</italic>-values.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>4 Data</title>
    <sec>
      <title>4.1 Pangenome reference</title>
      <p>We constructed a haplotype-resolved pangenome graph for the same eleven unrelated individuals as in the study by <xref rid="btad202-B10" ref-type="bibr">Ebler et al. (2022)</xref> (NA19238, NA19239, HG00731, HG00732, HG00512, HG00513, NA12878, HG02818, HG03125, NA24385, HG03486). For this, we used the merged variation calls, as described by <xref rid="btad202-B9" ref-type="bibr">Ebert et al. (2021)</xref> and <xref rid="btad202-B6" ref-type="bibr">Chaisson et al. (2019)</xref>, and filtered for variants shared by at least one of the eleven samples, where the alternative genotype of at least 80% of the samples is known. The number of variants covered by the pangenome graph is reported in <xref rid="btad202-T1" ref-type="table">Table 1</xref>.</p>
      <table-wrap position="float" id="btad202-T1">
        <label>Table 1.</label>
        <caption>
          <p>Number of distinct variant alleles covered by pangenome graph.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">SNV</th>
              <th rowspan="1" colspan="1">Indel (<inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mo>&lt;</mml:mo></mml:math></inline-formula>50 bp)</th>
              <th rowspan="1" colspan="1">SV (<inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mo>≥</mml:mo></mml:math></inline-formula>50 bp)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">11 385 979</td>
              <td rowspan="1" colspan="1">2 006 331</td>
              <td rowspan="1" colspan="1">69 803</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>For the leave-one-out cross-validation, we use subsets of the pangenome, which do not include the haplotypes of the tested individual, respectively. The excluded haplotypes are regarded as ground truth. Following <xref rid="btad202-B10" ref-type="bibr">Ebler et al. (2022)</xref>, this study deletes variants not covered by the tested individual’s true haplotype or the pangenome’s remaining haplotypes.</p>
    </sec>
    <sec>
      <title>4.2 Reads</title>
      <p>The test data consists of sequencing reads of 9 out of the 11 individuals used to build the pangenome reference [NCBI Sequence Read Archive (<xref rid="btad202-B20" ref-type="bibr">Leinonen et al. 2011</xref>), run ids: SRR7782675, SRR7782676, SRR7782672, SRR7782673, SRR7782690, SRR7782691, SRR7782683, SRR7782682, and SRR7782670]. All reads were sequenced within the same BioProject (accession number PRJNA477862) by an Illumina HiSeq X Ten system using a WGS strategy, a coverage of 30× and paired layout. The two remaining individuals (HG03125 and HG03486) are not part of the BioProject, so we did not include them in this study’s workflow to avoid possible noise introduced by different sequencing platforms.</p>
      <p>We sampled the reads down to a target coverage of 5× to evaluate the effects of spaced seeds on reads with lower coverage. For this, we aligned the reads to the reference genome with BWA-MEM (<xref rid="btad202-B21" ref-type="bibr">Li 2013</xref>) and then used Picard DownsampleSam (<xref rid="btad202-B15" ref-type="bibr">Broad Institute 2022</xref>) with a fraction size of one-sixth. DownsampleSam also includes reads that could not be aligned to the reference genome, which are randomly sampled down to the same fraction.</p>
    </sec>
  </sec>
  <sec>
    <title>5 Results</title>
    <sec>
      <title>5.1 Effects on genotyping of SNV, indel, and SV</title>
      <p>We genotyped reads with 5× and 30× coverage from nine samples using MaskedPanGenie with four different seeds; two spaced seed <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> as well as their contiguous counterparts <italic toggle="yes">C</italic> and <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>. <xref rid="btad202-T2" ref-type="table">Tables 2</xref> and <xref rid="btad202-T3" ref-type="table">3</xref> list the resulting performances for each type of variant. <italic toggle="yes">P</italic>-values and test statistics are listed in the <xref rid="sup1" ref-type="supplementary-material">supplementary material</xref>.</p>
      <table-wrap position="float" id="btad202-T2">
        <label>Table 2.</label>
        <caption>
          <p>Genotyping results for <italic toggle="yes">5-foldcoverage</italic>.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Variant</th>
              <th rowspan="1" colspan="1">Seed</th>
              <th rowspan="1" colspan="1">wGC</th>
              <th rowspan="1" colspan="1">Precision</th>
              <th rowspan="1" colspan="1">Recall</th>
              <th rowspan="1" colspan="1">F-score</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">SNV</td>
              <td rowspan="1" colspan="1">C</td>
              <td rowspan="1" colspan="1">0.877 (SE = 0.005)</td>
              <td rowspan="1" colspan="1">0.896 (SE = 0.005)</td>
              <td rowspan="1" colspan="1">0.842 (SE = 0.006)</td>
              <td rowspan="1" colspan="1">0.868 (SE = 0.005)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">C’</td>
              <td rowspan="1" colspan="1">0.877 (SE = 0.007)</td>
              <td rowspan="1" colspan="1">0.855 (SE = 0.010)</td>
              <td rowspan="1" colspan="1">0.828 (SE = 0.008)</td>
              <td rowspan="1" colspan="1">0.841 (SE = 0.009)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1"><bold>0.905</bold> (SE = 0.004)</td>
              <td rowspan="1" colspan="1"><bold>0.896</bold> (SE = 0.004)</td>
              <td rowspan="1" colspan="1"><bold>0.869</bold> (SE = 0.005)</td>
              <td rowspan="1" colspan="1"><bold>0.883</bold> (SE = 0.005)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1">0.902 (SE = 0.004)</td>
              <td rowspan="1" colspan="1">0.892 (SE = 0.004)</td>
              <td rowspan="1" colspan="1">0.866 (SE = 0.005)</td>
              <td rowspan="1" colspan="1">0.879 (SE = 0.004)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Indel</td>
              <td rowspan="1" colspan="1">C</td>
              <td rowspan="1" colspan="1">0.774 (SE = 0.003)</td>
              <td rowspan="1" colspan="1"><bold>0.817</bold> (SE = 0.002)</td>
              <td rowspan="1" colspan="1">0.722 (SE = 0.004)</td>
              <td rowspan="1" colspan="1">0.767 (SE = 0.003)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">C’</td>
              <td rowspan="1" colspan="1">0.800 (SE = 0.004)</td>
              <td rowspan="1" colspan="1">0.772 (SE = 0.004)</td>
              <td rowspan="1" colspan="1">0.729 (SE = 0.005)</td>
              <td rowspan="1" colspan="1">0.750 (SE = 0.005)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1"><bold>0.825</bold> (SE = 0.003)</td>
              <td rowspan="1" colspan="1">0.793 (SE = 0.002)</td>
              <td rowspan="1" colspan="1"><bold>0.766</bold> (SE = 0.004)</td>
              <td rowspan="1" colspan="1"><bold>0.779</bold> (SE = 0.003)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1">0.822 (SE = 0.003)</td>
              <td rowspan="1" colspan="1">0.789 (SE = 0.003)</td>
              <td rowspan="1" colspan="1">0.762 (SE = 0.004)</td>
              <td rowspan="1" colspan="1">0.776 (SE = 0.003)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SV</td>
              <td rowspan="1" colspan="1">C</td>
              <td rowspan="1" colspan="1">0.650 (SE = 0.003)</td>
              <td rowspan="1" colspan="1"><bold>0.613</bold> (SE = 0.003)</td>
              <td rowspan="1" colspan="1">0.579 (SE = 0.004)</td>
              <td rowspan="1" colspan="1">0.596 (SE = 0.003)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">C’</td>
              <td rowspan="1" colspan="1">0.641 (SE = 0.004)</td>
              <td rowspan="1" colspan="1">0.569 (SE = 0.006)</td>
              <td rowspan="1" colspan="1">0.551 (SE = 0.005)</td>
              <td rowspan="1" colspan="1">0.560 (SE = 0.006)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1">0.675 (SE = 0.003)</td>
              <td rowspan="1" colspan="1">0.599 (SE = 0.004)</td>
              <td rowspan="1" colspan="1"><bold>0.597</bold> (SE = 0.003)</td>
              <td rowspan="1" colspan="1">0.598 (SE = 0.003)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1"><bold>0.676</bold> (SE = 0.003)</td>
              <td rowspan="1" colspan="1">0.602 (SE = 0.003)</td>
              <td rowspan="1" colspan="1">0.596 (SE = 0.003)</td>
              <td rowspan="1" colspan="1"><bold>0.599</bold> (SE = 0.003)</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p>The highest results for each metric and variant are written in bold.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap position="float" id="btad202-T3">
        <label>Table 3.</label>
        <caption>
          <p>Genotyping results for <italic toggle="yes">30-fold coverage</italic>.<xref rid="tblfn1" ref-type="table-fn"><sup>a</sup></xref></p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Variant</th>
              <th rowspan="1" colspan="1">Seed</th>
              <th rowspan="1" colspan="1">wGC</th>
              <th rowspan="1" colspan="1">Precision</th>
              <th rowspan="1" colspan="1">Recall</th>
              <th rowspan="1" colspan="1">F-score</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">SNV</td>
              <td rowspan="1" colspan="1">C</td>
              <td rowspan="1" colspan="1">0.942 (SE = 0.001)</td>
              <td rowspan="1" colspan="1">0.977 (SE = 0.001)</td>
              <td rowspan="1" colspan="1">0.937 (SE = 0.001)</td>
              <td rowspan="1" colspan="1">0.957 (SE = 0.001)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">C’</td>
              <td rowspan="1" colspan="1"><bold>0.972</bold> (SE = 0.001)</td>
              <td rowspan="1" colspan="1">0.978 (SE = 0.001)</td>
              <td rowspan="1" colspan="1">0.964 (SE = 0.001)</td>
              <td rowspan="1" colspan="1">0.971 (SE = 0.001)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1">0.972 (SE = 0.001)</td>
              <td rowspan="1" colspan="1"><bold>0.980</bold> (SE = 0.001)</td>
              <td rowspan="1" colspan="1"><bold>0.966</bold> (SE = 0.001)</td>
              <td rowspan="1" colspan="1"><bold>0.973</bold> (SE = 0.001)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1">0.969 (SE = 0.001)</td>
              <td rowspan="1" colspan="1">0.975 (SE = 0.001)</td>
              <td rowspan="1" colspan="1">0.963 (SE = 0.002)</td>
              <td rowspan="1" colspan="1">0.969 (SE = 0.001)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Indel</td>
              <td rowspan="1" colspan="1">C</td>
              <td rowspan="1" colspan="1">0.825 (SE = 0.005)</td>
              <td rowspan="1" colspan="1"><bold>0.889</bold> (SE = 0.004)</td>
              <td rowspan="1" colspan="1">0.790 (SE = 0.007)</td>
              <td rowspan="1" colspan="1">0.836 (SE = 0.006)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">C’</td>
              <td rowspan="1" colspan="1">0.884 (SE = 0.006)</td>
              <td rowspan="1" colspan="1">0.885 (SE = 0.004)</td>
              <td rowspan="1" colspan="1">0.836 (SE = 0.011)</td>
              <td rowspan="1" colspan="1">0.859 (SE = 0.007)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1"><bold>0.891</bold> (SE = 0.006)</td>
              <td rowspan="1" colspan="1">0.887 (SE = 0.004)</td>
              <td rowspan="1" colspan="1"><bold>0.849</bold> (SE = 0.010)</td>
              <td rowspan="1" colspan="1"><bold>0.867</bold> (SE = 0.007)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1">0.888 (SE = 0.006)</td>
              <td rowspan="1" colspan="1">0.880 (SE = 0.004)</td>
              <td rowspan="1" colspan="1">0.846 (SE = 0.010)</td>
              <td rowspan="1" colspan="1">0.862 (SE = 0.007)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SV</td>
              <td rowspan="1" colspan="1">C</td>
              <td rowspan="1" colspan="1">0.682 (SE = 0.004)</td>
              <td rowspan="1" colspan="1"><bold>0.671</bold> (SE = 0.004)</td>
              <td rowspan="1" colspan="1">0.616 (SE = 0.005)</td>
              <td rowspan="1" colspan="1">0.642 (SE = 0.004)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">C’</td>
              <td rowspan="1" colspan="1">0.701 (SE = 0.005)</td>
              <td rowspan="1" colspan="1">0.660 (SE = 0.004)</td>
              <td rowspan="1" colspan="1">0.618 (SE = 0.007)</td>
              <td rowspan="1" colspan="1">0.638 (SE = 0.005)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1"><bold>0.719</bold> (SE = 0.005)</td>
              <td rowspan="1" colspan="1">0.670 (SE = 0.004)</td>
              <td rowspan="1" colspan="1"><bold>0.645</bold> (SE = 0.006)</td>
              <td rowspan="1" colspan="1"><bold>0.657</bold> (SE = 0.004)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1">0.716 (SE = 0.005)</td>
              <td rowspan="1" colspan="1">0.664 (SE = 0.004)</td>
              <td rowspan="1" colspan="1">0.642 (SE = 0.006)</td>
              <td rowspan="1" colspan="1">0.653 (SE = 0.005)</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn2">
            <label>a</label>
            <p>Metrics and standard error of the mean (SE) for each group. Results are averaged over all nine samples and separated by variant and seed type. C, mid-sized contiguous seed; C’, long-sized contiguous seed; S, spaced seed. The highest results for each metric and variant are written in bold.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Recall of genotyping with both spaced seeds <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is significantly higher for all variant groups. This can be observed for all samples at both 30× and 5× coverage. Effects on precision are more diverse. At 5× coverage, precision of <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is significantly higher than that of long-size seed <inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, but worse than that of mid-size seed <italic toggle="yes">C</italic>. However, at 30× coverage, effects of <inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> are contrary. For instance, <inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> increases precision of genotyping SNV, compared to both contiguous seeds, while <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> decreases precision.</p>
      <p>Nevertheless, the increases in recall are larger than the decreases in precision (<xref rid="btad202-F1" ref-type="fig">Fig. 1</xref>). Hence, F1-scores and wGC of <inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are significantly larger in almost all test cases, as seen in <xref rid="btad202-F2" ref-type="fig">Fig. 2</xref>. Compared to the mid-size seed <italic toggle="yes">C</italic>, <inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> show considerable improvements, regardless of coverage. The highest difference can be noted for indel, with an average increase in wGC of 6.5% at 30× coverage. Compared to the long-size seed <inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, F1-score and wGC of <inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> at 5× coverage are significantly larger, too. However, at 30× coverage <inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> performs worse than <inline-formula id="IE58"><mml:math id="IM58" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> and the effect sizes of other metrics are smaller than at 5× coverage. In fact, improvements of both <inline-formula id="IE59"><mml:math id="IM59" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE60"><mml:math id="IM60" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, compared to <italic toggle="yes">C</italic>, correlate positively.
</p>
      <disp-formula id="E7">
        <label>(1)</label>
        <mml:math id="M7" display="block" overflow="scroll">
          <mml:mtable>
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mtext>differences</mml:mtext>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>S</mml:mi>
                        </mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mi mathvariant="monospace">results</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>S</mml:mi>
                    </mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>−</mml:mo>
                  <mml:mi mathvariant="monospace">results</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>C</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mtext>differences</mml:mtext>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>C</mml:mi>
                        </mml:mrow>
                        <mml:mo>′</mml:mo>
                      </mml:msup>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mi mathvariant="monospace">results</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>C</mml:mi>
                    </mml:mrow>
                    <mml:mo>′</mml:mo>
                  </mml:msup>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>−</mml:mo>
                  <mml:mi mathvariant="monospace">results</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>C</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>r</mml:mi>
                    </mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mi mathvariant="italic">Cor</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mtext>differences</mml:mtext>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>S</mml:mi>
                        </mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mtext>differences</mml:mtext>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>C</mml:mi>
                        </mml:mrow>
                        <mml:mo>′</mml:mo>
                      </mml:msup>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mn>0.92</mml:mn>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mn>2</mml:mn>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mi mathvariant="italic">Cor</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mtext>differences</mml:mtext>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>S</mml:mi>
                        </mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>,</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mtext>differences</mml:mtext>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>C</mml:mi>
                        </mml:mrow>
                        <mml:mo>′</mml:mo>
                      </mml:msup>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mn>0.91</mml:mn>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <fig position="float" id="btad202-F1">
        <label>Figure 1.</label>
        <caption>
          <p>Scatter plot of precision and recall of genotyping SNV with different seeds at 5× and 30× read coverage. Color indicates the type of seed used. Each sample is marked through a unique shape. NA19238:<inline-formula id="IE61"><mml:math id="IM61" display="inline" overflow="scroll"><mml:mo>△</mml:mo></mml:math></inline-formula>, NA19239: <inline-formula id="IE62"><mml:math id="IM62" display="inline" overflow="scroll"><mml:mo>⊲</mml:mo></mml:math></inline-formula>, HG00731: <inline-formula id="IE63"><mml:math id="IM63" display="inline" overflow="scroll"><mml:mo>□</mml:mo></mml:math></inline-formula>, HG00732: <inline-formula id="IE64"><mml:math id="IM64" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula>, HG00512: <inline-formula id="IE65"><mml:math id="IM65" display="inline" overflow="scroll"><mml:mo>◯</mml:mo></mml:math></inline-formula>, HG00513: <inline-formula id="IE66"><mml:math id="IM66" display="inline" overflow="scroll"><mml:mo>○</mml:mo></mml:math></inline-formula>, NA12878: <inline-formula id="IE67"><mml:math id="IM67" display="inline" overflow="scroll"><mml:mo>▽</mml:mo></mml:math></inline-formula>, HG02818: <inline-formula id="IE68"><mml:math id="IM68" display="inline" overflow="scroll"><mml:mo>+</mml:mo></mml:math></inline-formula>, NA24385: <inline-formula id="IE69"><mml:math id="IM69" display="inline" overflow="scroll"><mml:mo>▹</mml:mo></mml:math></inline-formula>.</p>
        </caption>
        <graphic xlink:href="btad202f1" position="float"/>
      </fig>
      <fig position="float" id="btad202-F2">
        <label>Figure 2.</label>
        <caption>
          <p>Average weighted genotype concordance and standard deviation of genotyping with different seeds at 5× and 30× coverage.</p>
        </caption>
        <graphic xlink:href="btad202f2" position="float"/>
      </fig>
      <p>The correlation suggests that the length of spaced seeds, although not the only reason, does contribute to their performance. Nevertheless, for more complex variants, i.e. indel and SV, spaced seeds <inline-formula id="IE70"><mml:math id="IM70" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> perform notably better than the long contiguous seed <inline-formula id="IE71"><mml:math id="IM71" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>5.2 Genotype sample NA12878</title>
      <p>This section analyzes the effects of genotyping using <inline-formula id="IE72"><mml:math id="IM72" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> on the arbitrarily selected sample NA12878, at 30× coverage. A breakdown over the total number of genotyped alleles is listed in <xref rid="btad202-T4" ref-type="table">Table 4</xref>. The pangenome graph used for genotyping consists of almost 13 million variant alleles (variants at multiallelic sites are counted separately). MaskedPanGenie correctly genotyped 93% of those alleles when used with seed <italic toggle="yes">C</italic>. For both long-sized seed <inline-formula id="IE73"><mml:math id="IM73" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> and spaced seed <inline-formula id="IE74"><mml:math id="IM74" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, 97% of alleles could be correctly genotyped. The sets of the 7% and 3% of alleles that were incorrectly genotyped intersect. That is, 342 361 alleles could not be correctly genotyped, regardless of the seed used (40% of incorrect genotyped alleles for seed <italic toggle="yes">C</italic> and 86% for seed <inline-formula id="IE75"><mml:math id="IM75" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>). Regarding the set difference, in absolute numbers, using spaced seed <inline-formula id="IE76"><mml:math id="IM76" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> resulted in 465 223 more correctly genotyped alleles than for contiguous seed <italic toggle="yes">C</italic>. Many of those alleles were classified as ‘undefined’ when genotyped with <italic toggle="yes">C</italic>. MaskedPanGenie could not calculate a corresponding genotype at all because variant alleles were not covered by any unique k-mers. This is especially pronounced for genotyping of indels. Using seed <italic toggle="yes">C</italic> resulted in 157 257 undefined alleles. For spaced seed <inline-formula id="IE77"><mml:math id="IM77" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and long-sized seed <inline-formula id="IE78"><mml:math id="IM78" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, however, only 12 813 and 10 454 alleles were classified as undefined, respectively, 93% less. The decreased number of undefined alleles indicates that MaskedPanGenie could assign unique k-mers to more variant alleles for both <inline-formula id="IE79"><mml:math id="IM79" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE80"><mml:math id="IM80" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>.</p>
      <table-wrap position="float" id="btad202-T4">
        <label>Table 4.</label>
        <caption>
          <p>Number of correctly and incorrectly genotyped variant alleles for sample NA12878 at 30× coverage.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Variant</th>
              <th rowspan="1" colspan="1">Seed</th>
              <th rowspan="1" colspan="1">Total alleles</th>
              <th rowspan="1" colspan="1">Correct</th>
              <th rowspan="1" colspan="1">Incorrect</th>
              <th rowspan="1" colspan="1">Proportion</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">SNV</td>
              <td rowspan="1" colspan="1">C</td>
              <td rowspan="1" colspan="1">10 963 516</td>
              <td rowspan="1" colspan="1">10 384 838</td>
              <td rowspan="1" colspan="1">578 678</td>
              <td rowspan="1" colspan="1">0.95</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">C’</td>
              <td rowspan="1" colspan="1">10 963 516</td>
              <td rowspan="1" colspan="1">10 739 551</td>
              <td rowspan="1" colspan="1">223 965</td>
              <td rowspan="1" colspan="1">0.98</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE81"><mml:math id="IM81" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1">10 963 516</td>
              <td rowspan="1" colspan="1">10 720 135</td>
              <td rowspan="1" colspan="1">243 381</td>
              <td rowspan="1" colspan="1">0.98</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Indel</td>
              <td rowspan="1" colspan="1">C</td>
              <td rowspan="1" colspan="1">1 935 511</td>
              <td rowspan="1" colspan="1">1 664 769</td>
              <td rowspan="1" colspan="1">270 742</td>
              <td rowspan="1" colspan="1">0.86</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">C’</td>
              <td rowspan="1" colspan="1">1 935 511</td>
              <td rowspan="1" colspan="1">1 786 510</td>
              <td rowspan="1" colspan="1">149 001</td>
              <td rowspan="1" colspan="1">0.92</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE82"><mml:math id="IM82" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1">1 935 511</td>
              <td rowspan="1" colspan="1">1 792 129</td>
              <td rowspan="1" colspan="1">143 382</td>
              <td rowspan="1" colspan="1">0.93</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SV</td>
              <td rowspan="1" colspan="1">C</td>
              <td rowspan="1" colspan="1">60 348</td>
              <td rowspan="1" colspan="1">45 575</td>
              <td rowspan="1" colspan="1">14 773</td>
              <td rowspan="1" colspan="1">0.76</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">C’</td>
              <td rowspan="1" colspan="1">60 348</td>
              <td rowspan="1" colspan="1">47 749</td>
              <td rowspan="1" colspan="1">12 599</td>
              <td rowspan="1" colspan="1">0.79</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE83"><mml:math id="IM83" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1">60 348</td>
              <td rowspan="1" colspan="1">48 141</td>
              <td rowspan="1" colspan="1">12 207</td>
              <td rowspan="1" colspan="1">0.80</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Total</td>
              <td rowspan="1" colspan="1">C</td>
              <td rowspan="1" colspan="1">12 959 375</td>
              <td rowspan="1" colspan="1">12 095 182</td>
              <td rowspan="1" colspan="1">864 193</td>
              <td rowspan="1" colspan="1">0.93</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">C’</td>
              <td rowspan="1" colspan="1">12 959 375</td>
              <td rowspan="1" colspan="1">12 573 810</td>
              <td rowspan="1" colspan="1">385 565</td>
              <td rowspan="1" colspan="1">0.97</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE84"><mml:math id="IM84" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1">12 959 375</td>
              <td rowspan="1" colspan="1">12 560 405</td>
              <td rowspan="1" colspan="1">398 970</td>
              <td rowspan="1" colspan="1">0.97</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec>
      <title>5.3 Runtime</title>
      <p>Tests were executed on a Linux server with an AMD Ryzen 9 5950X 16-Core Processor and 125 GB of RAM. We used two threads for k-mer counting and 16 for the core genotyping algorithms.</p>
      <p>Times for genotyping sample NA12878 with 30× coverage are reported in <xref rid="btad202-T5" ref-type="table">Table 5</xref>. PanGenie’s workflow can be broken down into 1. reading of input files, 2. counting of k-mers, 3. identifying unique k-mers and 4. running the HMM. MaskedPanGenie skips the second step, as k-mer counting is done in a preprocessing step. This could result in a faster execution time of MaskedPanGenie (excluding preprocessing), which the version in this study yet fails to achieve, due to parallelization issues. The additional preprocessing step, required for counting spaced k-mers, increases execution time of MaskedPanGenie significantly. PanGenie is more than twice as fast as its masked counterpart. Note that differences in runtime are primarily due to a simplified implementation and not because of theoretical limitations. One reason for the delay is the naive implementation of MaskJelly, which is only intended as a prototype helper tool and effectively uses only one thread, at the moment. We expect that using a suitable hashing algorithm and integrating the counting of spaced k-mers directly into MaskedPanGenie, similar to the counting of contiguous k-mers in PanGenie, can greatly reduce runtime.</p>
      <table-wrap position="float" id="btad202-T5">
        <label>Table 5.</label>
        <caption>
          <p>Runtime of PanGenie and MaskedPanGenie for genotyping sample NA12878 with 30× coverage.<xref rid="tblfn2" ref-type="table-fn"><sup>a</sup></xref></p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Workflow</th>
              <th rowspan="1" colspan="1">Preprocessing</th>
              <th rowspan="1" colspan="1">Execution</th>
              <th rowspan="1" colspan="1">Total</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">PanGenie (<italic toggle="yes">k</italic> = 31)</td>
              <td rowspan="1" colspan="1">–</td>
              <td rowspan="1" colspan="1">3 h:07 min</td>
              <td rowspan="1" colspan="1">3 h:07 min</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">PanGenie (<italic toggle="yes">k</italic> = 51)</td>
              <td rowspan="1" colspan="1">–</td>
              <td rowspan="1" colspan="1">3 h:12 min</td>
              <td rowspan="1" colspan="1">3 h:12 min</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MaskedPanGenie</td>
              <td rowspan="1" colspan="1">4 h:24 min</td>
              <td rowspan="1" colspan="1">3 h:27 min</td>
              <td rowspan="1" colspan="1">7 h:51 min</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn3">
            <label>a</label>
            <p><bold>Execution</bold>: 1. reading of input files, 2. counting of k-mers (only PanGenie), 3. identifying unique k-mers and 4. running the HMM. <bold>Preprocessing</bold>: MaskedPanGenie, additionally, requires one preprocessing step, in which spaced seeds are counted with the help of MaskJelly.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec>
    <title>6 Discussion</title>
    <p>Spaced seeds can increase recall in homology search (<xref rid="btad202-B23" ref-type="bibr">Ma et al. 2002</xref>) metagenomic classification (<xref rid="btad202-B37" ref-type="bibr">Wood et al. 2019</xref>) and phylogenetic reconstruction (<xref rid="btad202-B19" ref-type="bibr">Leimeister et al. 2014</xref>). Motivated by this, we analysed the effects of spaced seeds on alignment-free genotyping with PanGenie. We found that the spaced seed we tested can increase recall, F1-score, and weighted genotype concordance. One reason for this is likely the increased length of a spaced seed. In fact, at 30× coverage, spaced, and long contiguous seeds have a similar impact on genotyping of SNPs with MaskedPanGenie. Furthermore, for both spaced seed and long-sized contiguous seed, MaskedPanGenie can assign unique k-mers to more variant alleles than for a mid-size contiguous seed. Even so, more than seed length is needed to fully explain the improved performance observed with the spaced seed. Compared to contiguous long-sized seeds, the spaced seeds performed significantly better in all metrics at 5× coverage and significantly improved weighted genotype concordance and F1-score of genotyping indel and SV at 30× coverage. Presumably this is due to the do not care positions giving the spaced seed robustness to sequencing errors.</p>
    <p>Comparing the two contiguous seeds, this study reported higher recall for a long contiguous seed, than for a mid-sized seed. This is the opposite of conventional expectations for contiguous seeds: Longer k-mers are more likely to contain sequencing errors and, thus, should be less sensitive for homology search. This seeming contradiction can be explained by the differences between the algorithms used for homology search and genotyping. In genotyping, a reduced seed sensitivity affects all alleles at a loci. A reduction in k-mer hits to an alternative allele may be balanced out by a similar reduction in k-mer hits to the reference allele, so the allele probabilities remain the same. Additionally, for large k, more k-mers can be uniquely assigned to a variant, compared to small k. This makes it easier to predict haplotype paths correctly, increasing recall. That said, the effect should be even more dominant for precision. We cannot explain why this is not observable in the data.</p>
    <p>Another reason for the increased performance of the longer seed in our experiments might be the high quality of the reads. Other platforms intended for sequencing small genomes, such as Illumina MiniSeq, have up to seven times higher error rates compared to Illumina HiSeq X Ten (<xref rid="btad202-B31" ref-type="bibr">Stoler and Nekrutenko 2021</xref>). Long k-mers will likely perform worse for reads from these systems. Spaced seeds, on the other hand, might show even larger improvements.</p>
    <p>A problem when using spaced k-mers is the increased runtime for k-mer hashing. MaskedPanGenie is much slower than PanGenie. However, this is mainly due to the simplified implementation of MaskedPanGenie. Algorithms that accelerate this process exist (<xref rid="btad202-B11" ref-type="bibr">Girotto et al. 2018</xref>; <xref rid="btad202-B27" ref-type="bibr">Petrucci et al. 2020</xref>), but they are not yet implemented in sophisticated software solutions. For further research, it could be of use to develop a spaced k-mer counting tool similar to Jellyfish (<xref rid="btad202-B24" ref-type="bibr">Marçais and Kingsford 2011</xref>). Implementing such a tool could reduce runtime considerably. Finally, we suspect that spaced k-mers are able to increase performance of other alignment-free genotyping tools, too, as the underlying mechanics of analyzing k-mer frequencies are similar between most applications. For future research it would be interesting to validate this hypothesis by adding spaced k-mer support to other alignment-free genotyping tools.</p>
  </sec>
  <sec>
    <title>7 Conclusion</title>
    <p>This study proposes a new software MaskedPanGenie, which extends the alignment-free k-mer-based genotyper PanGenie with a spaced seed functionality. Haplotypes are calculated for nine samples using contiguous and spaced seeds, respectively. Applying a spaced seed significantly improves recall, weighted genotype concordance, and F1-score for genotyping with low coverage. These improvements are greater than what could be achieved by increasing the length of contiguous k-mers alone. Effects on precision are mixed and hard to evaluate. Running time is increased but in principle that could be ameliorated by incorporating known special techniques for fast spaced seed hash computation.</p>
    <p>We conclude that spaced seeds may become a valuable technique for improving alignment-free genotyping, particularly for low read-coverages.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad202_Supplementary_Data</label>
      <media xlink:href="btad202_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Author contributions</title>
    <p>H.H. conceived and analysed the experiments and wrote the manuscript. P.H. advised H.H. and reviewed the manuscript.</p>
  </sec>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at Bioinformatics online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>None declared.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The data underlying this article are available in the article and in its online <xref rid="sup1" ref-type="supplementary-material">supplementary material</xref>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad202-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Altman</surname><given-names>DG</given-names></string-name>, <string-name><surname>Gore</surname><given-names>SM</given-names></string-name>, <string-name><surname>Gardner</surname><given-names>MJ</given-names></string-name></person-group><etal>et al</etal><article-title>Statistical guidelines for contributors to medical journals</article-title>. <source>Br Med J (Clin Res Ed)</source><year>1983</year>;<volume>286</volume>:<fpage>1489</fpage>–<lpage>93</lpage>.</mixed-citation>
    </ref>
    <ref id="btad202-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Altschul</surname><given-names>SF</given-names></string-name>, <string-name><surname>Gish</surname><given-names>W</given-names></string-name>, <string-name><surname>Miller</surname><given-names>W</given-names></string-name></person-group><etal>et al</etal><article-title>Basic local alignment search tool</article-title>. <source>J Mol Biol</source><year>1990</year>;<volume>215</volume>:<fpage>403</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">2231712</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B15">
      <mixed-citation publication-type="other"><collab>Broad Institute</collab>. Picard tools; version 2.27.4-SNAPSHOT. <year>2022</year>. <ext-link xlink:href="http://broadinstitute.github.io/picard/" ext-link-type="uri">http://broadinstitute.github.io/picard/</ext-link> (1 September 2022, date last accessed).</mixed-citation>
    </ref>
    <ref id="btad202-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Břinda</surname><given-names>K</given-names></string-name>, <string-name><surname>Sykulski</surname><given-names>M</given-names></string-name>, <string-name><surname>Kucherov</surname><given-names>G.</given-names></string-name></person-group><article-title>Spaced seeds improve k-mer-based metagenomic classification</article-title>. <source>Bioinformatics</source><year>2015</year>;<volume>31</volume>:<fpage>3584</fpage>–<lpage>92</lpage>.<pub-id pub-id-type="pmid">26209798</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Burkhardt</surname><given-names>S</given-names></string-name>, <string-name><surname>Kärkkäinen</surname><given-names>J.</given-names></string-name></person-group><article-title>Better filtering with gapped q-grams</article-title>. <source>Fund Inf</source><year>2003</year>;<volume>56</volume>:<fpage>51</fpage>–<lpage>70</lpage>.</mixed-citation>
    </ref>
    <ref id="btad202-B5">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Byard</surname><given-names>R</given-names></string-name>, <string-name><surname>Payne-James</surname><given-names>J.</given-names></string-name></person-group><source>Encyclopedia of Forensic and Legal Medicine</source>. 2nd ed. London (GB): <publisher-name>Academic Press</publisher-name>. <year>2016</year>.</mixed-citation>
    </ref>
    <ref id="btad202-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chaisson</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Sanders</surname><given-names>AD</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>X</given-names></string-name></person-group><etal>et al</etal><article-title>Multi-platform discovery of haplotype-resolved structural variation in human genomes</article-title>. <source>Nat Commun</source><year>2019</year>;<volume>10</volume>:<fpage>1</fpage>–<lpage>16</lpage>.<pub-id pub-id-type="pmid">30602773</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Choi</surname><given-names>KP</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>L.</given-names></string-name></person-group><article-title>Sensitivity analysis and efficient method for identifying optimal spaced seeds</article-title>. <source>J Comput Syst Sci</source><year>2004</year>;<volume>68</volume>:<fpage>22</fpage>–<lpage>40</lpage>.</mixed-citation>
    </ref>
    <ref id="btad202-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Denti</surname><given-names>L</given-names></string-name>, <string-name><surname>Previtali</surname><given-names>M</given-names></string-name>, <string-name><surname>Bernardini</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal><article-title>Malva: genotyping by mapping-free allele detection of known variants</article-title>. <source>Iscience</source><year>2019</year>;<volume>18</volume>:<fpage>20</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">31352182</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ebert</surname><given-names>P</given-names></string-name>, <string-name><surname>Audano</surname><given-names>PA</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>Q</given-names></string-name></person-group><etal>et al</etal><article-title>Haplotype-resolved diverse human genomes and integrated analysis of structural variation</article-title>. <source>Science</source><year>2021</year>;<volume>372</volume>:<fpage>eabf7117</fpage>.<pub-id pub-id-type="pmid">33632895</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ebler</surname><given-names>J</given-names></string-name>, <string-name><surname>Ebert</surname><given-names>P</given-names></string-name>, <string-name><surname>Clarke</surname><given-names>WE</given-names></string-name></person-group><etal>et al</etal><article-title>Pangenome-based genome inference allows efficient and accurate genotyping across a wide spectrum of variant classes</article-title>. <source>Nat Genet</source><year>2022</year>;<volume>54</volume>:<fpage>518</fpage>–<lpage>25</lpage>.<pub-id pub-id-type="pmid">35410384</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Girotto</surname><given-names>S</given-names></string-name>, <string-name><surname>Comin</surname><given-names>M</given-names></string-name>, <string-name><surname>Pizzi</surname><given-names>C.</given-names></string-name></person-group><article-title>Efficient computation of spaced seed hashing with block indexing</article-title>. <source>BMC Bioinformatics</source><year>2018</year>;<volume>19</volume>:<fpage>29</fpage>–<lpage>38</lpage>.<pub-id pub-id-type="pmid">29390958</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gotoh</surname><given-names>O.</given-names></string-name></person-group><article-title>An improved algorithm for matching biological sequences</article-title>. <source>J Mol Biol</source><year>1982</year>;<volume>162</volume>:<fpage>705</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">7166760</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ilie</surname><given-names>L</given-names></string-name>, <string-name><surname>Ilie</surname><given-names>S.</given-names></string-name></person-group><article-title>Multiple spaced seeds for homology search</article-title>. <source>Bioinformatics</source><year>2007</year>;<volume>23</volume>:<fpage>2969</fpage>–<lpage>77</lpage>.<pub-id pub-id-type="pmid">17804438</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ilie</surname><given-names>L</given-names></string-name>, <string-name><surname>Ilie</surname><given-names>S</given-names></string-name>, <string-name><surname>Mansouri Bigvand</surname><given-names>A.</given-names></string-name></person-group><article-title>Speed: fast computation of sensitive spaced seeds</article-title>. <source>Bioinformatics</source><year>2011</year>;<volume>27</volume>:<fpage>2433</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">21690104</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Keich</surname><given-names>U</given-names></string-name>, <string-name><surname>Li</surname><given-names>M</given-names></string-name>, <string-name><surname>Ma</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>On spaced seeds for similarity search</article-title>. <source>Discret Appl Math</source><year>2004</year>;<volume>138</volume>:<fpage>253</fpage>–<lpage>63</lpage>.</mixed-citation>
    </ref>
    <ref id="btad202-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiełbasa</surname><given-names>SM</given-names></string-name>, <string-name><surname>Wan</surname><given-names>R</given-names></string-name>, <string-name><surname>Sato</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>Adaptive seeds tame genomic sequence comparison</article-title>. <source>Genome Res</source><year>2011</year>;<volume>21</volume>:<fpage>487</fpage>–<lpage>93</lpage>.<pub-id pub-id-type="pmid">21209072</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Krusche</surname><given-names>P</given-names></string-name>, <string-name><surname>Trigg</surname><given-names>L</given-names></string-name>, <string-name><surname>Boutros</surname><given-names>PC</given-names></string-name></person-group><etal>et al</etal>; <collab>Global Alliance for Genomics and Health Benchmarking Team</collab>. <article-title>Best practices for benchmarking germline small-variant calls in human genomes</article-title>. <source>Nat Biotechnol</source><year>2019</year>;<volume>37</volume>:<fpage>555</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">30858580</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leimeister</surname><given-names>C-A</given-names></string-name>, <string-name><surname>Boden</surname><given-names>M</given-names></string-name>, <string-name><surname>Horwege</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Fast alignment-free sequence comparison using spaced-word frequencies</article-title>. <source>Bioinformatics</source><year>2014</year>;<volume>30</volume>:<fpage>1991</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">24700317</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leinonen</surname><given-names>R</given-names></string-name>, <string-name><surname>Sugawara</surname><given-names>H</given-names></string-name>, <string-name><surname>Shumway</surname><given-names>M</given-names></string-name></person-group>; <collab>I. N. S. D. Collaboration</collab>. <article-title>The sequence read archive</article-title>. <source>Nucleic Acids Res</source><year>2011</year>;<volume>39</volume>:<fpage>D19</fpage>–<lpage>D21</lpage>.<pub-id pub-id-type="pmid">21062823</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B21">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>H.</given-names></string-name></person-group> Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM. arXiv. 2013:1303.3997.</mixed-citation>
    </ref>
    <ref id="btad202-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>B</given-names></string-name>, <string-name><surname>Li</surname><given-names>M.</given-names></string-name></person-group><article-title>On the complexity of the spaced seeds</article-title>. <source>J Comput Syst Sci</source><year>2007</year>;<volume>73</volume>:<fpage>1024</fpage>–<lpage>34</lpage>.</mixed-citation>
    </ref>
    <ref id="btad202-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>B</given-names></string-name>, <string-name><surname>Tromp</surname><given-names>J</given-names></string-name>, <string-name><surname>Li</surname><given-names>M.</given-names></string-name></person-group><article-title>Patternhunter: faster and more sensitive homology search</article-title>. <source>Bioinformatics</source><year>2002</year>;<volume>18</volume>:<fpage>440</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">11934743</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Marçais</surname><given-names>G</given-names></string-name>, <string-name><surname>Kingsford</surname><given-names>C.</given-names></string-name></person-group><article-title>A fast, lock-free approach for efficient parallel counting of occurrences of k-mers</article-title>. <source>Bioinformatics</source><year>2011</year>;<volume>27</volume>:<fpage>764</fpage>–<lpage>70</lpage>.<pub-id pub-id-type="pmid">21217122</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McKenna</surname><given-names>A</given-names></string-name>, <string-name><surname>Hanna</surname><given-names>M</given-names></string-name>, <string-name><surname>Banks</surname><given-names>E</given-names></string-name></person-group><etal>et al</etal><article-title>The genome analysis toolkit: a mapreduce framework for analyzing next-generation dna sequencing data</article-title>. <source>Genome Res</source><year>2010</year>;<volume>20</volume>:<fpage>1297</fpage>–<lpage>303</lpage>.<pub-id pub-id-type="pmid">20644199</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mundry</surname><given-names>R</given-names></string-name>, <string-name><surname>Fischer</surname><given-names>J.</given-names></string-name></person-group><article-title>Use of statistical programs for nonparametric tests of small samples often leads to incorrect pvalues: examples from animal behaviour</article-title>. <source>Anim Behav</source><year>1998</year>;<volume>56</volume>:<fpage>256</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">9710485</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Petrucci</surname><given-names>E</given-names></string-name>, <string-name><surname>Noé</surname><given-names>L</given-names></string-name>, <string-name><surname>Pizzi</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>Iterative spaced seed hashing: closing the gap between spaced seed hashing and k-mer hashing</article-title>. <source>J Comput Biol</source><year>2020</year>;<volume>27</volume>:<fpage>223</fpage>–<lpage>33</lpage>.<pub-id pub-id-type="pmid">31800307</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shajii</surname><given-names>A</given-names></string-name>, <string-name><surname>Yorukoglu</surname><given-names>D</given-names></string-name>, <string-name><surname>William Yu</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>Fast genotyping of known snps through approximate k-mer matching</article-title>. <source>Bioinformatics</source><year>2016</year>;<volume>32</volume>:<fpage>i538</fpage>–<lpage>i544</lpage>.<pub-id pub-id-type="pmid">27587672</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sibbesen</surname><given-names>JA</given-names></string-name>, <string-name><surname>Maretty</surname><given-names>L</given-names></string-name>, <string-name><surname>Krogh</surname><given-names>A</given-names></string-name></person-group>; <collab>Danish Pan-Genome Consortium</collab>. <article-title>Accurate genotyping across variant classes and lengths using variant graphs</article-title>. <source>Nat Genet</source><year>2018</year>;<volume>50</volume>:<fpage>1054</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">29915429</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Smith</surname><given-names>TF</given-names></string-name>, <string-name><surname>Waterman</surname><given-names>MS.</given-names></string-name></person-group><article-title>Identification of common molecular subsequences</article-title>. <source>J Mol Biol</source><year>1981</year>;<volume>147</volume>:<fpage>195</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">7265238</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stoler</surname><given-names>N</given-names></string-name>, <string-name><surname>Nekrutenko</surname><given-names>A.</given-names></string-name></person-group><article-title>Sequencing error profiles of illumina sequencing instruments</article-title>. <source>NAR Genom Bioinf</source><year>2021</year>;<volume>3</volume>:<fpage>lqab019</fpage>.</mixed-citation>
    </ref>
    <ref id="btad202-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gotea</surname><given-names>V</given-names></string-name>, <string-name><surname>Veeramachaneni</surname><given-names>V</given-names></string-name>, <string-name><surname>Makałowski</surname><given-names>W.</given-names></string-name></person-group><article-title>Mastering seeds for genomic size nucleotide blast searches</article-title>. <source>Nucleic Acids Res</source><year>2003</year>;<volume>31</volume>:<fpage>6935</fpage>–<lpage>41</lpage>.<pub-id pub-id-type="pmid">14627826</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vinga</surname><given-names>S.</given-names></string-name></person-group> Editorial: Alignment-free methods in computational biology. <source>Brief. Bioinformatics</source><year>2014</year>;<volume>15</volume>:<fpage>341</fpage>–<lpage>2</lpage>.<pub-id pub-id-type="pmid">24819825</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vinga</surname><given-names>S</given-names></string-name>, <string-name><surname>Almeida</surname><given-names>J.</given-names></string-name></person-group><article-title>Alignment-free sequence comparison—a review</article-title>. <source>Bioinformatics</source><year>2003</year>;<volume>19</volume>:<fpage>513</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">12611807</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B35">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Wilcoxon</surname><given-names>F.</given-names></string-name></person-group><part-title>Individual comparisons by ranking methods</part-title>. In: Kotz S, Johnson NL, (eds.) <source>Breakthroughs in Statistics</source>. New York (NY): <publisher-name>Springer</publisher-name>, <year>1992</year>, <fpage>196</fpage>–<lpage>202</lpage>.</mixed-citation>
    </ref>
    <ref id="btad202-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wood</surname><given-names>DE</given-names></string-name>, <string-name><surname>Salzberg</surname><given-names>SL.</given-names></string-name></person-group><article-title>Kraken: ultrafast metagenomic sequence classification using exact alignments</article-title>. <source>Genome Biol</source><year>2014</year>;<volume>15</volume>:<fpage>1</fpage>–<lpage>12</lpage>.</mixed-citation>
    </ref>
    <ref id="btad202-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wood</surname><given-names>DE</given-names></string-name>, <string-name><surname>Lu</surname><given-names>J</given-names></string-name>, <string-name><surname>Langmead</surname><given-names>B.</given-names></string-name></person-group><article-title>Improved metagenomic analysis with kraken 2</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>1</fpage>–<lpage>13</lpage>.<pub-id pub-id-type="pmid">30606230</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zerbino</surname><given-names>DR</given-names></string-name>, <string-name><surname>Birney</surname><given-names>E.</given-names></string-name></person-group><article-title>Velvet: algorithms for de novo short read assembly using de bruijn graphs</article-title>. <source>Genome Res</source><year>2008</year>;<volume>18</volume>:<fpage>821</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">18349386</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zielezinski</surname><given-names>A</given-names></string-name>, <string-name><surname>Vinga</surname><given-names>S</given-names></string-name>, <string-name><surname>Almeida</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Alignment-free sequence comparison: benefits, applications, and tools</article-title>. <source>Genome Biol</source><year>2017</year>;<volume>18</volume>:<fpage>1</fpage>–<lpage>17</lpage>.<pub-id pub-id-type="pmid">28077169</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10311327</article-id>
    <article-id pub-id-type="pmid">37387138</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad202</article-id>
    <article-id pub-id-type="publisher-id">btad202</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Genome Sequence Analysis</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Effects of spaced k-mers on alignment-free genotyping</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6204-571X</contrib-id>
        <name>
          <surname>Häntze</surname>
          <given-names>Hartmut</given-names>
        </name>
        <aff><institution>Department of Computer Science and Information Engineering, National Cheng Kung University</institution>, Tainan City 701, <country country="TW">Taiwan</country></aff>
        <xref rid="btad202-cor1" ref-type="corresp"/>
        <!--hartmut.haentze@gmail.com-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0916-7339</contrib-id>
        <name>
          <surname>Horton</surname>
          <given-names>Paul</given-names>
        </name>
        <aff><institution>Department of Computer Science and Information Engineering, National Cheng Kung University</institution>, Tainan City 701, <country country="TW">Taiwan</country></aff>
        <xref rid="btad202-cor1" ref-type="corresp"/>
        <!--paulh@iscb.org-->
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad202-cor1">Corresponding author. Department of Computer Science and Information Engineering, National Cheng Kung University, Tainan City, Taiwan. E-mail: <email>hartmut.haentze@gmail.com</email> (H.H.); Department of Computer Science and Information Engineering, National Cheng Kung University, Tainan City, Taiwan. E-mail: <email>paulh@iscb.org</email> (P.H.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-06-30">
      <day>30</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>Suppl 1</issue>
    <issue-title>ISMB/ECCB 2023 Proceedings</issue-title>
    <fpage>i213</fpage>
    <lpage>i221</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad202.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Alignment-free, k-mer based genotyping methods are a fast alternative to alignment-based methods and are particularly well suited for genotyping larger cohorts. The sensitivity of algorithms, that work with k-mers, can be increased by using spaced seeds, however, the application of spaced seeds in k-mer based genotyping methods has not been researched yet.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We add a spaced seeds functionality to the genotyping software PanGenie and use it to calculate genotypes. This significantly improves sensitivity and F-score when genotyping SNPs, indels, and structural variants on reads with low (5×) and high (30×) coverage. Improvements are greater than what could be achieved by just increasing the length of contiguous k-mers. Effect sizes are particularly large for low coverage data. If applications implement effective algorithms for hashing of spaced k-mers, spaced k-mers have the potential to become an useful technique in k-mer based genotyping.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The source code of our proposed tool MaskedPanGenie is openly available on <ext-link xlink:href="https://github.com/hhaentze/MaskedPangenie" ext-link-type="uri">https://github.com/hhaentze/MaskedPangenie</ext-link>.</p>
      </sec>
    </abstract>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Next-generation sequencing (NGS) produces a vast amount of short amino acid or nucleotide sequences of up to 300 base pairs (bp). These sequences, called reads, do not directly give us an organism’s genome because their position within the genome is unknown. For further analysis, e.g. variant calling, many workflows either assemble reads <italic toggle="yes">de novo</italic> or align them to a reference genome. Aligning full reads by exact matching can be done in linear time, but the presence of variants and sequencing errors requires inexact matching. Dynamic programming algorithms can find optimal solutions for inexact matching with quadratic time complexity (<xref rid="btad202-B30" ref-type="bibr">Smith and Waterman 1981</xref>; <xref rid="btad202-B12" ref-type="bibr">Gotoh 1982</xref>). However, faced with the enormous amount of data produced by NGS systems, this quickly became insufficient. Recent methods, such as BWA-MEM (<xref rid="btad202-B21" ref-type="bibr">Li 2013</xref>), utilize hash functions, advanced indices and seeding techniques to accelerate read alignment further. Nevertheless, they still require a considerable amount of time and computing power.</p>
    <p>To further increase genotyping speed and reduce reference bias, alignment-free methods, such as PanGenie (<xref rid="btad202-B10" ref-type="bibr">Ebler et al. 2022</xref>), were proposed. These methods utilize vast databases of known variants in the human genome, which are available through the sequencing efforts and benchmark standardization of the last decade (e.g. 1000 Genomes Project, Genome in a Bottle). By mapping k-mers of a sample directly to a variant database, genotyping can be sped up immensely. Compared with mapping-based approaches, PanGenie can genotype more than four times faster at 30× coverage and achieves better genotype concordance (<xref rid="btad202-B10" ref-type="bibr">Ebler et al. 2022</xref>). The acceleration is partially due to the use of exact matching of k-mers, as opposed to inexact matching. However this comes at the cost of not being able to utilize k-mers spanning a read sequence error to identify variants.</p>
    <p>Spaced (also know as discontiguous) k-mers provide a possible solution to this problem. This approach was introduced to bioinformatics in the context of homology search (<xref rid="btad202-B23" ref-type="bibr">Ma et al. 2002</xref>) and was quickly adopted by other applications. To the best of our knowledge, exact matching of spaced k-mers has not yet been applied in alignment-free k-mer based genotyping. This article aims to evaluate the potential spaced k-mers might have on these algorithms. There exist many different algorithms, and evaluating the effect of spaced k-mers on all of them is not feasible. Hence, this study will concentrate on a single application, namely PanGenie (<xref rid="btad202-B10" ref-type="bibr">Ebler et al. 2022</xref>), which had higher genotype concordance and faster computing time than other applications. The effects of spaced k-mers on this application should give a general impression on possible advantages or problems spaced k-mers introduce to alignment-free genotyping.</p>
  </sec>
  <sec>
    <title>2 Related work</title>
    <p>This section introduces the literature this study is built on. First, it provides an overview of alignment-free genotyping. Second, spaced k-mers are introduced and explained in depth. Lastly, the intersection of both technologies is discussed.</p>
    <sec>
      <title>2.1 Alignment-free genotyping</title>
      <p>Genotyping is the process of determining which genetic variants an individual possesses (<xref rid="btad202-B5" ref-type="bibr">Byard and Payne-James 2016</xref>). Many genotyping workflows map the reads to a reference genome and then call differences between reads and reference sequence [e.g. BWA-MEM and GATK Haplotype Caller (<xref rid="btad202-B25" ref-type="bibr">McKenna et al. 2010</xref>; <xref rid="btad202-B21" ref-type="bibr">Li 2013</xref>)]. However, mapping the reads to the reference genome is computationally expensive and introduces reference bias to the results (<xref rid="btad202-B39" ref-type="bibr">Zielezinski et al. 2017</xref>). Alignment-free genotyping methods were developed to further accelerate genotyping and reduce reference bias. Their advantage is that they are computationally inexpensive and more robust to shuffling and recombination events, thus being well suited for analyzing populations with high variation in their genome (<xref rid="btad202-B33" ref-type="bibr">Vinga 2014</xref>). Disadvantages, however, are that symbol order is lost in the majority of alignment-free algorithms (<xref rid="btad202-B33" ref-type="bibr">Vinga 2014</xref>) and that unknown variants cannot be detected. Two main categories of alignment-free sequence comparisons have been proposed (<xref rid="btad202-B34" ref-type="bibr">Vinga and Almeida 2003</xref>). The first is based on the frequency of fixed-length k-mers within the reads and the second is based on Kolmogorov complexity and Chaos Theory. This article only considers the first category.</p>
      <p>Variants in the genome have specific patterns of k-mers surrounding them. To genotype a known variant, one can count how many and how often surrounding k-mers appear in the reads and calculate likelihoods of reference and alternative alleles. This is much faster than trying to find optimal read alignments, as counting k-mers can be done with almost linear time complexity through exact matching and hash maps.</p>
      <p>In recent years, many applications and studies about alignment-free algorithms have been published. <xref rid="btad202-B28" ref-type="bibr">Shajii et al. (2016)</xref> introduced a lightweight assignment of variant alleles (LAVA). Given a set of SNPs, LAVA constructs a dictionary of mid-size k-mers (<italic toggle="yes">k</italic> = 32), which uniquely belong to these SNPs, as well as a second dictionary of the k-mers in the human genome. Through bipartite matching of k-mers in the reads to the k-mers in the precomputed dictionary up to Hamming distance 1, LAVA can determine if a read belongs to a particular SNP. It then calculates genotypes (homozygous reference, heterozygous, homozygous alternate) with Bayes’ rule using allele frequencies. <xref rid="btad202-B8" ref-type="bibr">Denti et al. (2019)</xref> extended this approach and introduced a method that can genotype multi-allelic SNPs and indels using exact matching of contiguous k-mers. Similarly, <xref rid="btad202-B29" ref-type="bibr">Sibbesen et al. (2018)</xref> developed BayesTyper, which exactly matches contiguous k-mers (<italic toggle="yes">k</italic> = 55) to a variant graph and genotypes each variant, including SVs, based on observed k-mer frequencies. BayesTyper then uses an iterative, heuristic algorithm to estimate a subset of most likely haplotypes. They observe that variants that are less than k-1 nucleotides apart will share a k-mer and must thus be clustered together in the variant graph. Additionally, adding a database containing known variation significantly improves the sensitivity of genotyping structural variation. K-mer counts alone are not sufficient to reliable genotype loci that are poorly covered by k-mers, or do not have unique k-mers (<xref rid="btad202-B10" ref-type="bibr">Ebler et al. 2022</xref>). Ebler et al<italic toggle="yes">.</italic> propose an algorithm, PanGenie, that overcomes this limitation by leveraging linkage disequilibrium (LD) of structures inherent in multiple haplotype-resolved assemblies. LD is the phenomenon that alleles, at population level, are not independent of each other but follow specific patterns. It can be used to make assumptions about genotypes based on the surrounding alleles. For this, PanGenie first builds an acyclic and directed pangenome graph from a callset of multiple haplotype-resolved assemblies. The pangenome graph contains bubbles, i.e. different allele paths, for each variant in the callset. To calculate the likelihood of allele combinations in each bubble, PanGenie compares the expected counts of k-mer unique to the bubble with the actual counts of these k-mer in the reads. Finally, it infers genotypes of poorly covered loci by leveraging LD through a Hidden Markov Model.</p>
      <p>This approach is faster and achieves better genotype concordances than most mapping-based algorithms. Improvements are especially notable for large insertions and repetitive regions (<xref rid="btad202-B10" ref-type="bibr">Ebler et al. 2022</xref>). However, PanGenie only uses contiguous k-mers, even though spaced k-mers have reportedly improved many k-mer-based algorithms (<xref rid="btad202-B23" ref-type="bibr">Ma et al. 2002</xref>; <xref rid="btad202-B19" ref-type="bibr">Leimeister et al. 2014</xref>; <xref rid="btad202-B37" ref-type="bibr">Wood et al. 2019</xref>).</p>
    </sec>
    <sec>
      <title>2.2 Spaced k-mers</title>
      <p>K-mers are substrings of constant length <italic toggle="yes">k</italic>, with <italic toggle="yes">k</italic> being smaller than the length of the reads. Typically, they are contiguous, meaning they capture all consecutive bases within a substring of a nucleotide sequence. Contiguous k-mers have been used in BLAST (<xref rid="btad202-B2" ref-type="bibr">Altschul et al. 1990</xref>) for local alignment, in de Bruijn-graphs for assembly [e.g. Velvet (<xref rid="btad202-B38" ref-type="bibr">Zerbino and Birney 2008</xref>)] and in metagenomic sequence classification [e.g. Kraken (<xref rid="btad202-B36" ref-type="bibr">Wood and Salzberg 2014</xref>)]. Choosing the optimal length <italic toggle="yes">k</italic> is essential. Long k-mers have a high probability of containing sequencing errors and may lose distant homologies. Short k-mers, on the other hand, are not as distinctive and increase the computational burden (<xref rid="btad202-B23" ref-type="bibr">Ma et al. 2002</xref>).</p>
      <p>One method to increase k-mer length, while keeping the risk of missing matches due to sequencing errors low, is approximate k-mer matching (<xref rid="btad202-B28" ref-type="bibr">Shajii et al. 2016</xref>). In contrast to exact matching, this also matching up to a given Hamming distance. However, while this reduces the effect of sequencing errors, it also decreases the number of identifiable unambiguous loci in the genome (<xref rid="btad202-B28" ref-type="bibr">Shajii et al. 2016</xref>). For example, allowing a hamming distance of 1, a single k-mer in the reference database could be matched with up to <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> different k-mers in the reads.</p>
      <p>Another method that reduces the effect of sequencing errors without affecting the number of identifiable unambiguous loci is exact k-mer matching using spaced seeds. Early applications of spaced seeds can be found in <xref rid="btad202-B23" ref-type="bibr">Ma et al. (2002)</xref>, for faster and more sensitive homology search, as well as by <xref rid="btad202-B4" ref-type="bibr">Burkhardt and Kärkkäinen (2003)</xref>, for faster and/or more efficient filtering than with contiguous k-mers. They can increase the sensitivity of seed-and-extend methods for local alignment (<xref rid="btad202-B23" ref-type="bibr">Ma et al. 2002</xref>; <xref rid="btad202-B32" ref-type="bibr">Gotea et al. 2003</xref>; <xref rid="btad202-B17" ref-type="bibr">Kiełbasa et al. 2011</xref>) and can improve results of alignment-free sequence comparison methods (<xref rid="btad202-B19" ref-type="bibr">Leimeister et al. 2014</xref>) as well as specificity and sensitivity in metagenomic classification (<xref rid="btad202-B3" ref-type="bibr">Břinda et al. 2015</xref>; <xref rid="btad202-B37" ref-type="bibr">Wood et al. 2019</xref>).<statement id="mthst1"><label>Definition 1.</label><p>A seed <italic toggle="yes">s</italic> is a binary pattern over the symbols 1 and 0, denoting <italic toggle="yes">care</italic> and <italic toggle="yes">don’t care</italic> positions, respectively (<xref rid="btad202-B3" ref-type="bibr">Břinda et al. 2015</xref>). We use <italic toggle="yes">l</italic> to denote the length of this pattern, and <italic toggle="yes">w</italic> to denote the number of 1’s in the patter, known as the <monospace>weight</monospace> of the seed. If the weight and length of <italic toggle="yes">s</italic> are equal, <italic toggle="yes">s</italic> is called contiguous, otherwise spaced. A seed is palindromic if care and do not care positions remain the same, regardless of the direction in which the seed is read.</p></statement><statement id="mthst2"><label>Definition 2.</label><p>Given a spaced seed with length <italic toggle="yes">l</italic> and weight <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula>, a spaced <italic toggle="yes">k</italic>-mer is a series of <italic toggle="yes">k</italic> characters of a substring of length <italic toggle="yes">l</italic> at care positions of the used seed. For example, applying seed 1101 (two care positions followed by a do not care position and another care position) on the sequence ACTGA, results in the spaced 3-mers ACG and CTA. Two spaced k-mers can be equal, even when the raw sequences differ. For instance, using seed 1101 on the sequences ATGC and ATAC will result in the spaced 3-mer ATC in both cases.</p></statement></p>
      <sec>
        <title>2.2.1 Seed selection</title>
        <p>Applications that use contiguous k-mers must choose a suitable weight k to achieve the wanted trade-off between distinctiveness and risk of sequencing errors. For spaced seeds, this gets more complicated. Apart from the weight and length of a seed, care and do not care positions need to be specified, too.</p>
        <p>A seed’s ability to detect similar segments between biological sequences is measured in terms of sensitivity, i.e. the probability of generating a hit with a spaced seed in a fixed-length region with a given similarity level. Different seeds have different sensitivity, and selecting a seed with high sensitivity is essential. <xref rid="btad202-B23" ref-type="bibr">Ma et al. (2002)</xref> argue that the reason for increased sensitivity is that the events of having a match at different positions become more independent for spaced seeds. ‘Generally, the fewer bases shared by a model and its shifted copies, the higher its sensitivity is (<xref rid="btad202-B23" ref-type="bibr">Ma et al. 2002</xref>).’ The best seeds typically possess little regularity, with consecutive seeds consequently being among the worst (<xref rid="btad202-B4" ref-type="bibr">Burkhardt and Kärkkäinen 2003</xref>).</p>
        <p>Sensitivity can be calculated with dynamic programming (<xref rid="btad202-B16" ref-type="bibr">Keich et al. 2004</xref>) or a recurrence relation (<xref rid="btad202-B7" ref-type="bibr">Choi and Zhang 2004</xref>). Unfortunately the problem is NP-hard (<xref rid="btad202-B22" ref-type="bibr">Ma and Li 2007</xref>), with both the number of possible spaced seeds, and the time to calculate the hit probability, i.e. sensitivity, of a given spaced seed increasing exponentially in <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:math></inline-formula>. Thus in general spaced seeds can only be optimized approximately.</p>
        <p>As a heuristic, <xref rid="btad202-B13" ref-type="bibr">Ilie and Ilie (2007)</xref> introduce a new measure, overlap complexity, and show that it is experimentally well correlated to sensitivity. They give an algorithm that starts with a randomly selected initial seed and tries to improve it iteratively. <xref rid="btad202-B14" ref-type="bibr">Ilie et al. (2011)</xref> implement this algorithm in their software SpEED which executes the algorithm multiple times for different seed lengths. Through these approximations, SpEED can compute highly sensitive multiple spaced seeds in a few seconds.</p>
      </sec>
    </sec>
    <sec>
      <title>2.3 Spaced k-mers in alignment-free genotyping</title>
      <p>As demonstrated by <xref rid="btad202-B23" ref-type="bibr">Ma et al. (2002)</xref> and others, spaced seeds are effective seed-and-extend local alignment applications such as homology search and read mapping. However those findings cannot be directly transferred to alignment-free genotyping; where the measure of success is not the percent accuracy of mapping individual reads, but rather the aggregate effect of the ensemble of read k-mers matched to known variant alleles.</p>
      <p>Sequencing errors and mutations affect the proportion of k-mers that can be mapped to different variant alleles at a locus. Thus theoretically spaced k-mers might be able to increase this proportion in favour of the correct allele. Whether this is true in practice is however not self-evident; especially when sequence errors are infrequent. For example, reads in this study were sequenced with an Ilumina HiSeq X Ten platform with a median error rate of only 0.087% (<xref rid="btad202-B31" ref-type="bibr">Stoler and Nekrutenko 2021</xref>) per base.</p>
      <p>This study aims to investigate the practical advantages (if any) of using spaced k-mers for one genotyping method, namely PanGenie (<xref rid="btad202-B10" ref-type="bibr">Ebler et al. 2022</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>3 Methodology</title>
    <sec>
      <title>3.1 Problem formalization</title>
      <p>Given a set of <italic toggle="yes">reads</italic>, a reference genome <italic toggle="yes">ref</italic> and a haplotype resolved file of known variants <italic toggle="yes">vcf</italic>, PanGenie (<xref rid="btad202-B10" ref-type="bibr">Ebler et al. 2022</xref>) can be used to predict haplotypes <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>C</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> by using a contiguous seed <italic toggle="yes">C</italic>. To analyse spaced seeds’ effects on genotyping, this study proposes an adapted software <italic toggle="yes">MaskedPanGenie</italic>, which extends PanGenie with a spaced seed functionality. Given a space seed <italic toggle="yes">S</italic>, MaskedPanGenie can predict haplotypes <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> by using spaced-k-mers in reads, instead of contiguous k-mers. It is written in C++ and publicly available at <ext-link xlink:href="https://github.com/hhaentze/MaskedPangenie" ext-link-type="uri">https://github.com/hhaentze/MaskedPangenie</ext-link>. MaskedPanGenie requires the occurrences of spaced k-mers in the reads as input. We count spaced k-mers by combining the counting tool Jellyfish (<xref rid="btad202-B24" ref-type="bibr">Marçais and Kingsford 2011</xref>) with our own helper application <italic toggle="yes">MaskJelly</italic> (<ext-link xlink:href="https://github.com/hhaentze/MaskJelly" ext-link-type="uri">https://github.com/hhaentze/MaskJelly</ext-link>). We aim to investigate the effects of do not care positions on genotyping by comparing the results of genotyping with seeds <italic toggle="yes">C</italic> and <italic toggle="yes">S</italic> (of equal weight). However, apart from having do not care positions, spaced seed <italic toggle="yes">S</italic> is also longer than the contiguous seed <italic toggle="yes">C</italic>. Hence, differences in the genotyping results with <italic toggle="yes">C</italic> and <italic toggle="yes">S</italic> could also be due to the different lengths. Thus, we include a contiguous seed <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> with length equal to <italic toggle="yes">S</italic> as a second control group. If do not care positions do not significantly affect the genotyping process, similar results can be expected for spaced seed <italic toggle="yes">S</italic> and contiguous seeds of equal weight (<italic toggle="yes">C</italic>) or length (<inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>).</p>
      <p>
        <inline-graphic xlink:href="btad202ilf1.jpg"/>
      </p>
      <list list-type="order">
        <list-item>
          <p><bold>C</bold> (control group 1) A mid-sized contiguous seed with weight and length of 31. (default k-mer size in PanGenie)</p>
        </list-item>
        <list-item>
          <p><bold>S<sub>1</sub> and S<sub>2</sub></bold> Spaced seeds with weight of 31 and length of 51. Length and patterns of do not care positions are calculated with the help of SpEED (<xref rid="btad202-B14" ref-type="bibr">Ilie et al. 2011</xref>). We chose the first and second most sensitive patterns according to SpeEED.</p>
        </list-item>
        <list-item>
          <p><bold>C’</bold> (control group 2) A long-sized contiguous seed with weight and length of 51.</p>
        </list-item>
      </list>
      <p>We use MaskedPanGenie to calculate callsets for each seed and asked which callset <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>C</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, or <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is closest to a given ground truth.
</p>
      <disp-formula id="E1">
        <mml:math id="M1" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>h</mml:mi>
                      </mml:mrow>
                      <mml:mi>C</mml:mi>
                    </mml:msub>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mtext>reads</mml:mtext>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>=</mml:mo>
                    <mml:mi mathvariant="monospace">MaskedPanGenie</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mtext>reads</mml:mtext>
                    <mml:mo>,</mml:mo>
                    <mml:mtext>ref</mml:mtext>
                    <mml:mo>,</mml:mo>
                    <mml:mtext>vcf</mml:mtext>
                    <mml:mo>|</mml:mo>
                    <mml:mi>C</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>h</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>S</mml:mi>
                          </mml:mrow>
                          <mml:mi>x</mml:mi>
                        </mml:msub>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mtext>reads</mml:mtext>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>=</mml:mo>
                    <mml:mi mathvariant="monospace">MaskedPanGenie</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mtext>reads</mml:mtext>
                    <mml:mo>,</mml:mo>
                    <mml:mtext>ref</mml:mtext>
                    <mml:mo>,</mml:mo>
                    <mml:mtext>vcf</mml:mtext>
                    <mml:mo>|</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>S</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                        <mml:mo>,</mml:mo>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>h</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>C</mml:mi>
                          </mml:mrow>
                          <mml:mo>′</mml:mo>
                        </mml:msup>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mtext>reads</mml:mtext>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>=</mml:mo>
                    <mml:mi mathvariant="monospace">MaskedPanGenie</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mtext>reads</mml:mtext>
                    <mml:mo>,</mml:mo>
                    <mml:mtext>ref</mml:mtext>
                    <mml:mo>,</mml:mo>
                    <mml:mtext>vcf</mml:mtext>
                    <mml:mo>|</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>C</mml:mi>
                      </mml:mrow>
                      <mml:mo>′</mml:mo>
                    </mml:msup>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>Variants in the predicted callsets can be either absent (0<inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mo>|</mml:mo></mml:math></inline-formula>0), ie. both alleles are in line with the reference genome, heterozygous (1|0), homozygous (1|1) or undefined (*|*). The differences between the predicted sets and the true set of haplotypes are measured in terms of recall, precision and F-score.
</p>
      <disp-formula id="E2">
        <mml:math id="M2" display="block" overflow="scroll">
          <mml:mtable>
            <mml:mtr>
              <mml:mtd>
                <mml:mtable>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mtext>Recall</mml:mtext>
                        <mml:mo>=</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:mtext>TP</mml:mtext>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>TP</mml:mtext>
                            <mml:mo>+</mml:mo>
                            <mml:mtext>FN</mml:mtext>
                          </mml:mrow>
                        </mml:mfrac>
                        <mml:mo> </mml:mo>
                        <mml:mo> </mml:mo>
                        <mml:mo> </mml:mo>
                        <mml:mtext>Precision</mml:mtext>
                        <mml:mo>=</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:mtext>TP</mml:mtext>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>TP</mml:mtext>
                            <mml:mo>+</mml:mo>
                            <mml:mtext>FP</mml:mtext>
                          </mml:mrow>
                        </mml:mfrac>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mi>F</mml:mi>
                <mml:mo>-</mml:mo>
                <mml:mtext>score</mml:mtext>
                <mml:mo>=</mml:mo>
                <mml:mn>2</mml:mn>
                <mml:mo>×</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mtext>precision</mml:mtext>
                    <mml:mo>×</mml:mo>
                    <mml:mtext>recall</mml:mtext>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext>precision</mml:mtext>
                    <mml:mo>+</mml:mo>
                    <mml:mtext>recall</mml:mtext>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>This study defines true positive (TP), false positive (FP) and false negative (FN) according to the most stringent model of the ‘Best practices for benchmarking germline small-variant calls in human genomes’ (<xref rid="btad202-B18" ref-type="bibr">Krusche et al. 2019</xref>). Only sides with identical alleles and genotype in truth and callset are counted as TPs. Another metric that can be used for comparing call sets is genotype concordance, i.e. the proportion of correctly genotyped variants. However, <xref rid="btad202-B10" ref-type="bibr">Ebler et al. (2022)</xref> argue that genotype concordance is flawed if callsets contain variants originating from multiple samples because the number of absent variants (0|0) will be higher than the number of variants with true genotypes 0|1 or 1|1. To adjust for unequal numbers of 0|0, 0|1 and 1|1, they use a weighted genotype concordance (wGC), which is computed as:
where <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">x</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="normal">y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">x</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="normal">y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> denote the number of correctly and erroneously classified variants of genotype <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:math></inline-formula> respectively.</p>
      <disp-formula id="E3">
        <mml:math id="M3" display="block" overflow="scroll">
          <mml:mtable>
            <mml:mtr>
              <mml:mtd>
                <mml:mtable>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mtext>conc</mml:mtext>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi mathvariant="normal">x</mml:mi>
                        <mml:mo>|</mml:mo>
                        <mml:mi mathvariant="normal">y</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>=</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>T</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>x</mml:mi>
                                <mml:mo>|</mml:mo>
                                <mml:mi>y</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>T</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>x</mml:mi>
                                <mml:mo>|</mml:mo>
                                <mml:mi>y</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>+</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>F</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>x</mml:mi>
                                <mml:mo>|</mml:mo>
                                <mml:mi>y</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mfrac>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mtext>wGC</mml:mtext>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mtext>conc</mml:mtext>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mn>0</mml:mn>
                    <mml:mo>|</mml:mo>
                    <mml:mn>0</mml:mn>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>+</mml:mo>
                    <mml:mtext>conc</mml:mtext>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mn>0</mml:mn>
                    <mml:mo>|</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>+</mml:mo>
                    <mml:mtext>conc</mml:mtext>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>|</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mn>3</mml:mn>
                </mml:mfrac>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>This study reports adjusted versions of those metrics, which only include variants that are part of the given known variants file. Variants, which are undefined in the ground-truth set, are removed from both sets. Following the evaluation procedure of PanGenie (<xref rid="btad202-B10" ref-type="bibr">Ebler et al. 2022</xref>); we use a kind of leave-one-out cross validation in which when calling variants on an individual, the pan-genome used is constructed based the rest of the individuals. To investigate whether sequencing depth has an impact on genotyping with spaced k-mers, we test MaskedPangenie on both low (5×) and high (30×) coverage data. We evaluate genotyping separately for SNVs, indels and SVs. The tool we wrote for the calculation can be accessed at <ext-link xlink:href="https://github.com/hhaentze/GenotypeConcordance" ext-link-type="uri">https://github.com/hhaentze/GenotypeConcordance</ext-link>.</p>
    </sec>
    <sec>
      <title>3.2 Choosing a spaced seed</title>
      <sec>
        <title>3.2.1 Seed structure</title>
        <p>For the weight of the spaced seed <italic toggle="yes">S</italic> we choose the k-mer length used in the original PanGenie study, which is 31. The length of <italic toggle="yes">S</italic> needs to be above 31 and preferably lower than 76, which is half the length of the reads used in this experiment. Seed lengths <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mo>≥</mml:mo><mml:mn>76</mml:mn></mml:mrow></mml:math></inline-formula> would reduce the maximum number of unique k-mers (e.g. 31 for a weight of 31) that can cover a single nucleotide variation. The first and last positions of the seeds are always ‘1’. PanGenie uses canonical representations of k-mers. Canonical means that k-mers are considered equivalent to their reversed compliment, and the lexicographically smaller version serves as a representative. To guarantee that spaced k-mer from forward and reverse strand have the same canonical form, we require <italic toggle="yes">S</italic> to be palindromic. That is, care and do not care positions must be arranged symmetrically.</p>
      </sec>
      <sec>
        <title>3.2.2 Number of possible spaced seeds</title>
        <p>Given a weight of <italic toggle="yes">w</italic> and a length of <italic toggle="yes">l</italic> there are generally <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mi>l</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>w</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> different seeds. Previously introduced constraints lower this number. Each seed should start and end with ‘1’ so the number of possible seeds |<italic toggle="yes">S</italic>| can be reduced to <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>w</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The palindromic constraint further reduces this to:
</p>
        <disp-formula id="E4">
          <mml:math id="M4" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mo>|</mml:mo>
              <mml:mi>S</mml:mi>
              <mml:mo>|</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:mtable>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mo>⌊</mml:mo>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mi>l</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:mfrac>
                        </mml:mrow>
                        <mml:mo>⌋</mml:mo>
                      </mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mo>⌊</mml:mo>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mi>w</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:mfrac>
                        </mml:mrow>
                        <mml:mo>⌋</mml:mo>
                      </mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
                <mml:mo>)</mml:mo>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>For instance, given a weight of 31, there are <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mn>19</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>14</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>11</mml:mn><mml:mo> </mml:mo><mml:mn>628</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mn>24</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>14</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo> </mml:mo><mml:mn>961</mml:mn><mml:mo> </mml:mo><mml:mn>256</mml:mn></mml:mrow></mml:math></inline-formula> possible seeds for lengths 41 and 51 respectively.</p>
      </sec>
      <sec>
        <title>3.2.3 Application of SpEED</title>
        <p>To obtain a good palindromic spaced seed <italic toggle="yes">S</italic> with weight 31, we use the tool SpEED (<xref rid="btad202-B14" ref-type="bibr">Ilie et al. 2011</xref>) to create a spaced seed with length 16 and extend the obtained seed with its mirrored version on its right side to ensure that it is palindromic. For the expected similarity level between homologous regions, we choose 95%, as recommended in the SpEED documentation. For the length of homologous regions, we somewhat arbitrarily choose 76, which is half the read length.
</p>
        <disp-formula id="E5">
          <mml:math id="M5" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mtext>SpEED</mml:mtext>
              <mml:mo> </mml:mo>
              <mml:mn>16</mml:mn>
              <mml:mo> </mml:mo>
              <mml:mn>1</mml:mn>
              <mml:mo> </mml:mo>
              <mml:mn>0.95</mml:mn>
              <mml:mo> </mml:mo>
              <mml:mn>76</mml:mn>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>The most sensitive seed obtained after 4680 iterations was 11101110010101001101001111, with a sensitivity of 0.999, given the specified parameters. Mirroring and extending the seed results in the seed <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, with a length of 51. To construct <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> we proceeded in the same way, but instead used the second most sensitive seed (also with a sensitivity of <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mo>≈</mml:mo></mml:math></inline-formula> 0.999) obtained through SpEED.
</p>
        <disp-formula id="E6">
          <mml:math id="M6" display="block" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>S</mml:mi>
                    </mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>111011100101010011010011111110010110010101001110111</mml:mn>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>S</mml:mi>
                    </mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>111101010011100100110101111101011001001110010101111</mml:mn>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>Note that <xref rid="btad202-B14" ref-type="bibr">Ilie et al. (2011)</xref> tested their algorithm for multiple spaced seeds up to a weight of 18. PanGenie, on the other hand, is designed for mid-size k-mers with a weight of 31. It is unclear if SpEED can find a good single seed for this weight. However, the complexity of the problem makes it hard to find more optimal solutions.</p>
      </sec>
    </sec>
    <sec>
      <title>3.3 Statistics</title>
      <p>To determine whether the null hypothesis that both methods are equally good can be rejected, we conducted two-sided significance tests. We adopted the Wilcoxon signed-rank test (<xref rid="btad202-B35" ref-type="bibr">Wilcoxon 1992</xref>) with exactly calculated <italic toggle="yes">P</italic>-values as a testing procedure suitable for paired data with small sample size (<xref rid="btad202-B1" ref-type="bibr">Altman et al. 1983</xref>; <xref rid="btad202-B26" ref-type="bibr">Mundry and Fischer 1998</xref>). For a sample size <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:math></inline-formula> the smallest possible <italic toggle="yes">P</italic>-value is <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>≈</mml:mo><mml:mn>0.004</mml:mn></mml:mrow></mml:math></inline-formula>.</p>
      <sec>
        <title>3.3.1 Consideration of multiple testing</title>
        <p>This study tests significance with regard to three variant types {SNV, indel, SV}, two read-coverages {5×, 30×}, and four metrics (precision, recall, F1-Score, wGC), resulting in a total of <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>24</mml:mn></mml:mrow></mml:math></inline-formula> different tests. Therefore we considered if it would be appropriate to apply a standard method for multiple testing correction. The well known Bonferroni provides a strict upper bound on a corrected <italic toggle="yes">P</italic>-value by simply multiplying by <italic toggle="yes">m</italic>. With a sample size of 9, the lowest possible corrected <italic toggle="yes">P</italic>-value would be <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>24</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0.004</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0.096</mml:mn><mml:mo>&gt;</mml:mo><mml:mn>5</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>, excluding any possibility of obtaining statistically significantly results. Less stringent tests such as by Westfall/Young or Benjamin/Hochberg are also problematic because they require ranking individual <italic toggle="yes">P</italic>-values, but small sample size signed-rank tests tend to produce many individual <italic toggle="yes">P</italic>-values of equal value.</p>
        <p>Faced with these difficulties, we decided to report individual <italic toggle="yes">P</italic>-values without multiple testing correction. The key caveat is that when interpreting this work the results of all of the tests should be considered together, rather than focusing on a few tests with particularly low <italic toggle="yes">P</italic>-values.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>4 Data</title>
    <sec>
      <title>4.1 Pangenome reference</title>
      <p>We constructed a haplotype-resolved pangenome graph for the same eleven unrelated individuals as in the study by <xref rid="btad202-B10" ref-type="bibr">Ebler et al. (2022)</xref> (NA19238, NA19239, HG00731, HG00732, HG00512, HG00513, NA12878, HG02818, HG03125, NA24385, HG03486). For this, we used the merged variation calls, as described by <xref rid="btad202-B9" ref-type="bibr">Ebert et al. (2021)</xref> and <xref rid="btad202-B6" ref-type="bibr">Chaisson et al. (2019)</xref>, and filtered for variants shared by at least one of the eleven samples, where the alternative genotype of at least 80% of the samples is known. The number of variants covered by the pangenome graph is reported in <xref rid="btad202-T1" ref-type="table">Table 1</xref>.</p>
      <table-wrap position="float" id="btad202-T1">
        <label>Table 1.</label>
        <caption>
          <p>Number of distinct variant alleles covered by pangenome graph.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">SNV</th>
              <th rowspan="1" colspan="1">Indel (<inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mo>&lt;</mml:mo></mml:math></inline-formula>50 bp)</th>
              <th rowspan="1" colspan="1">SV (<inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mo>≥</mml:mo></mml:math></inline-formula>50 bp)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">11 385 979</td>
              <td rowspan="1" colspan="1">2 006 331</td>
              <td rowspan="1" colspan="1">69 803</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>For the leave-one-out cross-validation, we use subsets of the pangenome, which do not include the haplotypes of the tested individual, respectively. The excluded haplotypes are regarded as ground truth. Following <xref rid="btad202-B10" ref-type="bibr">Ebler et al. (2022)</xref>, this study deletes variants not covered by the tested individual’s true haplotype or the pangenome’s remaining haplotypes.</p>
    </sec>
    <sec>
      <title>4.2 Reads</title>
      <p>The test data consists of sequencing reads of 9 out of the 11 individuals used to build the pangenome reference [NCBI Sequence Read Archive (<xref rid="btad202-B20" ref-type="bibr">Leinonen et al. 2011</xref>), run ids: SRR7782675, SRR7782676, SRR7782672, SRR7782673, SRR7782690, SRR7782691, SRR7782683, SRR7782682, and SRR7782670]. All reads were sequenced within the same BioProject (accession number PRJNA477862) by an Illumina HiSeq X Ten system using a WGS strategy, a coverage of 30× and paired layout. The two remaining individuals (HG03125 and HG03486) are not part of the BioProject, so we did not include them in this study’s workflow to avoid possible noise introduced by different sequencing platforms.</p>
      <p>We sampled the reads down to a target coverage of 5× to evaluate the effects of spaced seeds on reads with lower coverage. For this, we aligned the reads to the reference genome with BWA-MEM (<xref rid="btad202-B21" ref-type="bibr">Li 2013</xref>) and then used Picard DownsampleSam (<xref rid="btad202-B15" ref-type="bibr">Broad Institute 2022</xref>) with a fraction size of one-sixth. DownsampleSam also includes reads that could not be aligned to the reference genome, which are randomly sampled down to the same fraction.</p>
    </sec>
  </sec>
  <sec>
    <title>5 Results</title>
    <sec>
      <title>5.1 Effects on genotyping of SNV, indel, and SV</title>
      <p>We genotyped reads with 5× and 30× coverage from nine samples using MaskedPanGenie with four different seeds; two spaced seed <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> as well as their contiguous counterparts <italic toggle="yes">C</italic> and <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>. <xref rid="btad202-T2" ref-type="table">Tables 2</xref> and <xref rid="btad202-T3" ref-type="table">3</xref> list the resulting performances for each type of variant. <italic toggle="yes">P</italic>-values and test statistics are listed in the <xref rid="sup1" ref-type="supplementary-material">supplementary material</xref>.</p>
      <table-wrap position="float" id="btad202-T2">
        <label>Table 2.</label>
        <caption>
          <p>Genotyping results for <italic toggle="yes">5-foldcoverage</italic>.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Variant</th>
              <th rowspan="1" colspan="1">Seed</th>
              <th rowspan="1" colspan="1">wGC</th>
              <th rowspan="1" colspan="1">Precision</th>
              <th rowspan="1" colspan="1">Recall</th>
              <th rowspan="1" colspan="1">F-score</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">SNV</td>
              <td rowspan="1" colspan="1">C</td>
              <td rowspan="1" colspan="1">0.877 (SE = 0.005)</td>
              <td rowspan="1" colspan="1">0.896 (SE = 0.005)</td>
              <td rowspan="1" colspan="1">0.842 (SE = 0.006)</td>
              <td rowspan="1" colspan="1">0.868 (SE = 0.005)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">C’</td>
              <td rowspan="1" colspan="1">0.877 (SE = 0.007)</td>
              <td rowspan="1" colspan="1">0.855 (SE = 0.010)</td>
              <td rowspan="1" colspan="1">0.828 (SE = 0.008)</td>
              <td rowspan="1" colspan="1">0.841 (SE = 0.009)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1"><bold>0.905</bold> (SE = 0.004)</td>
              <td rowspan="1" colspan="1"><bold>0.896</bold> (SE = 0.004)</td>
              <td rowspan="1" colspan="1"><bold>0.869</bold> (SE = 0.005)</td>
              <td rowspan="1" colspan="1"><bold>0.883</bold> (SE = 0.005)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1">0.902 (SE = 0.004)</td>
              <td rowspan="1" colspan="1">0.892 (SE = 0.004)</td>
              <td rowspan="1" colspan="1">0.866 (SE = 0.005)</td>
              <td rowspan="1" colspan="1">0.879 (SE = 0.004)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Indel</td>
              <td rowspan="1" colspan="1">C</td>
              <td rowspan="1" colspan="1">0.774 (SE = 0.003)</td>
              <td rowspan="1" colspan="1"><bold>0.817</bold> (SE = 0.002)</td>
              <td rowspan="1" colspan="1">0.722 (SE = 0.004)</td>
              <td rowspan="1" colspan="1">0.767 (SE = 0.003)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">C’</td>
              <td rowspan="1" colspan="1">0.800 (SE = 0.004)</td>
              <td rowspan="1" colspan="1">0.772 (SE = 0.004)</td>
              <td rowspan="1" colspan="1">0.729 (SE = 0.005)</td>
              <td rowspan="1" colspan="1">0.750 (SE = 0.005)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1"><bold>0.825</bold> (SE = 0.003)</td>
              <td rowspan="1" colspan="1">0.793 (SE = 0.002)</td>
              <td rowspan="1" colspan="1"><bold>0.766</bold> (SE = 0.004)</td>
              <td rowspan="1" colspan="1"><bold>0.779</bold> (SE = 0.003)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1">0.822 (SE = 0.003)</td>
              <td rowspan="1" colspan="1">0.789 (SE = 0.003)</td>
              <td rowspan="1" colspan="1">0.762 (SE = 0.004)</td>
              <td rowspan="1" colspan="1">0.776 (SE = 0.003)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SV</td>
              <td rowspan="1" colspan="1">C</td>
              <td rowspan="1" colspan="1">0.650 (SE = 0.003)</td>
              <td rowspan="1" colspan="1"><bold>0.613</bold> (SE = 0.003)</td>
              <td rowspan="1" colspan="1">0.579 (SE = 0.004)</td>
              <td rowspan="1" colspan="1">0.596 (SE = 0.003)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">C’</td>
              <td rowspan="1" colspan="1">0.641 (SE = 0.004)</td>
              <td rowspan="1" colspan="1">0.569 (SE = 0.006)</td>
              <td rowspan="1" colspan="1">0.551 (SE = 0.005)</td>
              <td rowspan="1" colspan="1">0.560 (SE = 0.006)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1">0.675 (SE = 0.003)</td>
              <td rowspan="1" colspan="1">0.599 (SE = 0.004)</td>
              <td rowspan="1" colspan="1"><bold>0.597</bold> (SE = 0.003)</td>
              <td rowspan="1" colspan="1">0.598 (SE = 0.003)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1"><bold>0.676</bold> (SE = 0.003)</td>
              <td rowspan="1" colspan="1">0.602 (SE = 0.003)</td>
              <td rowspan="1" colspan="1">0.596 (SE = 0.003)</td>
              <td rowspan="1" colspan="1"><bold>0.599</bold> (SE = 0.003)</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p>The highest results for each metric and variant are written in bold.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap position="float" id="btad202-T3">
        <label>Table 3.</label>
        <caption>
          <p>Genotyping results for <italic toggle="yes">30-fold coverage</italic>.<xref rid="tblfn1" ref-type="table-fn"><sup>a</sup></xref></p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Variant</th>
              <th rowspan="1" colspan="1">Seed</th>
              <th rowspan="1" colspan="1">wGC</th>
              <th rowspan="1" colspan="1">Precision</th>
              <th rowspan="1" colspan="1">Recall</th>
              <th rowspan="1" colspan="1">F-score</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">SNV</td>
              <td rowspan="1" colspan="1">C</td>
              <td rowspan="1" colspan="1">0.942 (SE = 0.001)</td>
              <td rowspan="1" colspan="1">0.977 (SE = 0.001)</td>
              <td rowspan="1" colspan="1">0.937 (SE = 0.001)</td>
              <td rowspan="1" colspan="1">0.957 (SE = 0.001)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">C’</td>
              <td rowspan="1" colspan="1"><bold>0.972</bold> (SE = 0.001)</td>
              <td rowspan="1" colspan="1">0.978 (SE = 0.001)</td>
              <td rowspan="1" colspan="1">0.964 (SE = 0.001)</td>
              <td rowspan="1" colspan="1">0.971 (SE = 0.001)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1">0.972 (SE = 0.001)</td>
              <td rowspan="1" colspan="1"><bold>0.980</bold> (SE = 0.001)</td>
              <td rowspan="1" colspan="1"><bold>0.966</bold> (SE = 0.001)</td>
              <td rowspan="1" colspan="1"><bold>0.973</bold> (SE = 0.001)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1">0.969 (SE = 0.001)</td>
              <td rowspan="1" colspan="1">0.975 (SE = 0.001)</td>
              <td rowspan="1" colspan="1">0.963 (SE = 0.002)</td>
              <td rowspan="1" colspan="1">0.969 (SE = 0.001)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Indel</td>
              <td rowspan="1" colspan="1">C</td>
              <td rowspan="1" colspan="1">0.825 (SE = 0.005)</td>
              <td rowspan="1" colspan="1"><bold>0.889</bold> (SE = 0.004)</td>
              <td rowspan="1" colspan="1">0.790 (SE = 0.007)</td>
              <td rowspan="1" colspan="1">0.836 (SE = 0.006)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">C’</td>
              <td rowspan="1" colspan="1">0.884 (SE = 0.006)</td>
              <td rowspan="1" colspan="1">0.885 (SE = 0.004)</td>
              <td rowspan="1" colspan="1">0.836 (SE = 0.011)</td>
              <td rowspan="1" colspan="1">0.859 (SE = 0.007)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1"><bold>0.891</bold> (SE = 0.006)</td>
              <td rowspan="1" colspan="1">0.887 (SE = 0.004)</td>
              <td rowspan="1" colspan="1"><bold>0.849</bold> (SE = 0.010)</td>
              <td rowspan="1" colspan="1"><bold>0.867</bold> (SE = 0.007)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1">0.888 (SE = 0.006)</td>
              <td rowspan="1" colspan="1">0.880 (SE = 0.004)</td>
              <td rowspan="1" colspan="1">0.846 (SE = 0.010)</td>
              <td rowspan="1" colspan="1">0.862 (SE = 0.007)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SV</td>
              <td rowspan="1" colspan="1">C</td>
              <td rowspan="1" colspan="1">0.682 (SE = 0.004)</td>
              <td rowspan="1" colspan="1"><bold>0.671</bold> (SE = 0.004)</td>
              <td rowspan="1" colspan="1">0.616 (SE = 0.005)</td>
              <td rowspan="1" colspan="1">0.642 (SE = 0.004)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">C’</td>
              <td rowspan="1" colspan="1">0.701 (SE = 0.005)</td>
              <td rowspan="1" colspan="1">0.660 (SE = 0.004)</td>
              <td rowspan="1" colspan="1">0.618 (SE = 0.007)</td>
              <td rowspan="1" colspan="1">0.638 (SE = 0.005)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1"><bold>0.719</bold> (SE = 0.005)</td>
              <td rowspan="1" colspan="1">0.670 (SE = 0.004)</td>
              <td rowspan="1" colspan="1"><bold>0.645</bold> (SE = 0.006)</td>
              <td rowspan="1" colspan="1"><bold>0.657</bold> (SE = 0.004)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1">0.716 (SE = 0.005)</td>
              <td rowspan="1" colspan="1">0.664 (SE = 0.004)</td>
              <td rowspan="1" colspan="1">0.642 (SE = 0.006)</td>
              <td rowspan="1" colspan="1">0.653 (SE = 0.005)</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn2">
            <label>a</label>
            <p>Metrics and standard error of the mean (SE) for each group. Results are averaged over all nine samples and separated by variant and seed type. C, mid-sized contiguous seed; C’, long-sized contiguous seed; S, spaced seed. The highest results for each metric and variant are written in bold.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Recall of genotyping with both spaced seeds <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is significantly higher for all variant groups. This can be observed for all samples at both 30× and 5× coverage. Effects on precision are more diverse. At 5× coverage, precision of <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is significantly higher than that of long-size seed <inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, but worse than that of mid-size seed <italic toggle="yes">C</italic>. However, at 30× coverage, effects of <inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> are contrary. For instance, <inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> increases precision of genotyping SNV, compared to both contiguous seeds, while <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> decreases precision.</p>
      <p>Nevertheless, the increases in recall are larger than the decreases in precision (<xref rid="btad202-F1" ref-type="fig">Fig. 1</xref>). Hence, F1-scores and wGC of <inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are significantly larger in almost all test cases, as seen in <xref rid="btad202-F2" ref-type="fig">Fig. 2</xref>. Compared to the mid-size seed <italic toggle="yes">C</italic>, <inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> show considerable improvements, regardless of coverage. The highest difference can be noted for indel, with an average increase in wGC of 6.5% at 30× coverage. Compared to the long-size seed <inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, F1-score and wGC of <inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> at 5× coverage are significantly larger, too. However, at 30× coverage <inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> performs worse than <inline-formula id="IE58"><mml:math id="IM58" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> and the effect sizes of other metrics are smaller than at 5× coverage. In fact, improvements of both <inline-formula id="IE59"><mml:math id="IM59" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE60"><mml:math id="IM60" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, compared to <italic toggle="yes">C</italic>, correlate positively.
</p>
      <disp-formula id="E7">
        <label>(1)</label>
        <mml:math id="M7" display="block" overflow="scroll">
          <mml:mtable>
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mtext>differences</mml:mtext>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>S</mml:mi>
                        </mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mi mathvariant="monospace">results</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>S</mml:mi>
                    </mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>−</mml:mo>
                  <mml:mi mathvariant="monospace">results</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>C</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mtext>differences</mml:mtext>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>C</mml:mi>
                        </mml:mrow>
                        <mml:mo>′</mml:mo>
                      </mml:msup>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mi mathvariant="monospace">results</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>C</mml:mi>
                    </mml:mrow>
                    <mml:mo>′</mml:mo>
                  </mml:msup>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>−</mml:mo>
                  <mml:mi mathvariant="monospace">results</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>C</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>r</mml:mi>
                    </mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mi mathvariant="italic">Cor</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mtext>differences</mml:mtext>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>S</mml:mi>
                        </mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mtext>differences</mml:mtext>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>C</mml:mi>
                        </mml:mrow>
                        <mml:mo>′</mml:mo>
                      </mml:msup>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mn>0.92</mml:mn>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                  <mml:mn>2</mml:mn>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mi mathvariant="italic">Cor</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mtext>differences</mml:mtext>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>S</mml:mi>
                        </mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>,</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mtext>differences</mml:mtext>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>C</mml:mi>
                        </mml:mrow>
                        <mml:mo>′</mml:mo>
                      </mml:msup>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mn>0.91</mml:mn>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <fig position="float" id="btad202-F1">
        <label>Figure 1.</label>
        <caption>
          <p>Scatter plot of precision and recall of genotyping SNV with different seeds at 5× and 30× read coverage. Color indicates the type of seed used. Each sample is marked through a unique shape. NA19238:<inline-formula id="IE61"><mml:math id="IM61" display="inline" overflow="scroll"><mml:mo>△</mml:mo></mml:math></inline-formula>, NA19239: <inline-formula id="IE62"><mml:math id="IM62" display="inline" overflow="scroll"><mml:mo>⊲</mml:mo></mml:math></inline-formula>, HG00731: <inline-formula id="IE63"><mml:math id="IM63" display="inline" overflow="scroll"><mml:mo>□</mml:mo></mml:math></inline-formula>, HG00732: <inline-formula id="IE64"><mml:math id="IM64" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula>, HG00512: <inline-formula id="IE65"><mml:math id="IM65" display="inline" overflow="scroll"><mml:mo>◯</mml:mo></mml:math></inline-formula>, HG00513: <inline-formula id="IE66"><mml:math id="IM66" display="inline" overflow="scroll"><mml:mo>○</mml:mo></mml:math></inline-formula>, NA12878: <inline-formula id="IE67"><mml:math id="IM67" display="inline" overflow="scroll"><mml:mo>▽</mml:mo></mml:math></inline-formula>, HG02818: <inline-formula id="IE68"><mml:math id="IM68" display="inline" overflow="scroll"><mml:mo>+</mml:mo></mml:math></inline-formula>, NA24385: <inline-formula id="IE69"><mml:math id="IM69" display="inline" overflow="scroll"><mml:mo>▹</mml:mo></mml:math></inline-formula>.</p>
        </caption>
        <graphic xlink:href="btad202f1" position="float"/>
      </fig>
      <fig position="float" id="btad202-F2">
        <label>Figure 2.</label>
        <caption>
          <p>Average weighted genotype concordance and standard deviation of genotyping with different seeds at 5× and 30× coverage.</p>
        </caption>
        <graphic xlink:href="btad202f2" position="float"/>
      </fig>
      <p>The correlation suggests that the length of spaced seeds, although not the only reason, does contribute to their performance. Nevertheless, for more complex variants, i.e. indel and SV, spaced seeds <inline-formula id="IE70"><mml:math id="IM70" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> perform notably better than the long contiguous seed <inline-formula id="IE71"><mml:math id="IM71" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>5.2 Genotype sample NA12878</title>
      <p>This section analyzes the effects of genotyping using <inline-formula id="IE72"><mml:math id="IM72" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> on the arbitrarily selected sample NA12878, at 30× coverage. A breakdown over the total number of genotyped alleles is listed in <xref rid="btad202-T4" ref-type="table">Table 4</xref>. The pangenome graph used for genotyping consists of almost 13 million variant alleles (variants at multiallelic sites are counted separately). MaskedPanGenie correctly genotyped 93% of those alleles when used with seed <italic toggle="yes">C</italic>. For both long-sized seed <inline-formula id="IE73"><mml:math id="IM73" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> and spaced seed <inline-formula id="IE74"><mml:math id="IM74" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, 97% of alleles could be correctly genotyped. The sets of the 7% and 3% of alleles that were incorrectly genotyped intersect. That is, 342 361 alleles could not be correctly genotyped, regardless of the seed used (40% of incorrect genotyped alleles for seed <italic toggle="yes">C</italic> and 86% for seed <inline-formula id="IE75"><mml:math id="IM75" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>). Regarding the set difference, in absolute numbers, using spaced seed <inline-formula id="IE76"><mml:math id="IM76" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> resulted in 465 223 more correctly genotyped alleles than for contiguous seed <italic toggle="yes">C</italic>. Many of those alleles were classified as ‘undefined’ when genotyped with <italic toggle="yes">C</italic>. MaskedPanGenie could not calculate a corresponding genotype at all because variant alleles were not covered by any unique k-mers. This is especially pronounced for genotyping of indels. Using seed <italic toggle="yes">C</italic> resulted in 157 257 undefined alleles. For spaced seed <inline-formula id="IE77"><mml:math id="IM77" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and long-sized seed <inline-formula id="IE78"><mml:math id="IM78" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, however, only 12 813 and 10 454 alleles were classified as undefined, respectively, 93% less. The decreased number of undefined alleles indicates that MaskedPanGenie could assign unique k-mers to more variant alleles for both <inline-formula id="IE79"><mml:math id="IM79" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE80"><mml:math id="IM80" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>.</p>
      <table-wrap position="float" id="btad202-T4">
        <label>Table 4.</label>
        <caption>
          <p>Number of correctly and incorrectly genotyped variant alleles for sample NA12878 at 30× coverage.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Variant</th>
              <th rowspan="1" colspan="1">Seed</th>
              <th rowspan="1" colspan="1">Total alleles</th>
              <th rowspan="1" colspan="1">Correct</th>
              <th rowspan="1" colspan="1">Incorrect</th>
              <th rowspan="1" colspan="1">Proportion</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">SNV</td>
              <td rowspan="1" colspan="1">C</td>
              <td rowspan="1" colspan="1">10 963 516</td>
              <td rowspan="1" colspan="1">10 384 838</td>
              <td rowspan="1" colspan="1">578 678</td>
              <td rowspan="1" colspan="1">0.95</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">C’</td>
              <td rowspan="1" colspan="1">10 963 516</td>
              <td rowspan="1" colspan="1">10 739 551</td>
              <td rowspan="1" colspan="1">223 965</td>
              <td rowspan="1" colspan="1">0.98</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE81"><mml:math id="IM81" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1">10 963 516</td>
              <td rowspan="1" colspan="1">10 720 135</td>
              <td rowspan="1" colspan="1">243 381</td>
              <td rowspan="1" colspan="1">0.98</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Indel</td>
              <td rowspan="1" colspan="1">C</td>
              <td rowspan="1" colspan="1">1 935 511</td>
              <td rowspan="1" colspan="1">1 664 769</td>
              <td rowspan="1" colspan="1">270 742</td>
              <td rowspan="1" colspan="1">0.86</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">C’</td>
              <td rowspan="1" colspan="1">1 935 511</td>
              <td rowspan="1" colspan="1">1 786 510</td>
              <td rowspan="1" colspan="1">149 001</td>
              <td rowspan="1" colspan="1">0.92</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE82"><mml:math id="IM82" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1">1 935 511</td>
              <td rowspan="1" colspan="1">1 792 129</td>
              <td rowspan="1" colspan="1">143 382</td>
              <td rowspan="1" colspan="1">0.93</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SV</td>
              <td rowspan="1" colspan="1">C</td>
              <td rowspan="1" colspan="1">60 348</td>
              <td rowspan="1" colspan="1">45 575</td>
              <td rowspan="1" colspan="1">14 773</td>
              <td rowspan="1" colspan="1">0.76</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">C’</td>
              <td rowspan="1" colspan="1">60 348</td>
              <td rowspan="1" colspan="1">47 749</td>
              <td rowspan="1" colspan="1">12 599</td>
              <td rowspan="1" colspan="1">0.79</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE83"><mml:math id="IM83" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1">60 348</td>
              <td rowspan="1" colspan="1">48 141</td>
              <td rowspan="1" colspan="1">12 207</td>
              <td rowspan="1" colspan="1">0.80</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Total</td>
              <td rowspan="1" colspan="1">C</td>
              <td rowspan="1" colspan="1">12 959 375</td>
              <td rowspan="1" colspan="1">12 095 182</td>
              <td rowspan="1" colspan="1">864 193</td>
              <td rowspan="1" colspan="1">0.93</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">C’</td>
              <td rowspan="1" colspan="1">12 959 375</td>
              <td rowspan="1" colspan="1">12 573 810</td>
              <td rowspan="1" colspan="1">385 565</td>
              <td rowspan="1" colspan="1">0.97</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"> <inline-formula id="IE84"><mml:math id="IM84" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1">12 959 375</td>
              <td rowspan="1" colspan="1">12 560 405</td>
              <td rowspan="1" colspan="1">398 970</td>
              <td rowspan="1" colspan="1">0.97</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec>
      <title>5.3 Runtime</title>
      <p>Tests were executed on a Linux server with an AMD Ryzen 9 5950X 16-Core Processor and 125 GB of RAM. We used two threads for k-mer counting and 16 for the core genotyping algorithms.</p>
      <p>Times for genotyping sample NA12878 with 30× coverage are reported in <xref rid="btad202-T5" ref-type="table">Table 5</xref>. PanGenie’s workflow can be broken down into 1. reading of input files, 2. counting of k-mers, 3. identifying unique k-mers and 4. running the HMM. MaskedPanGenie skips the second step, as k-mer counting is done in a preprocessing step. This could result in a faster execution time of MaskedPanGenie (excluding preprocessing), which the version in this study yet fails to achieve, due to parallelization issues. The additional preprocessing step, required for counting spaced k-mers, increases execution time of MaskedPanGenie significantly. PanGenie is more than twice as fast as its masked counterpart. Note that differences in runtime are primarily due to a simplified implementation and not because of theoretical limitations. One reason for the delay is the naive implementation of MaskJelly, which is only intended as a prototype helper tool and effectively uses only one thread, at the moment. We expect that using a suitable hashing algorithm and integrating the counting of spaced k-mers directly into MaskedPanGenie, similar to the counting of contiguous k-mers in PanGenie, can greatly reduce runtime.</p>
      <table-wrap position="float" id="btad202-T5">
        <label>Table 5.</label>
        <caption>
          <p>Runtime of PanGenie and MaskedPanGenie for genotyping sample NA12878 with 30× coverage.<xref rid="tblfn2" ref-type="table-fn"><sup>a</sup></xref></p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Workflow</th>
              <th rowspan="1" colspan="1">Preprocessing</th>
              <th rowspan="1" colspan="1">Execution</th>
              <th rowspan="1" colspan="1">Total</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">PanGenie (<italic toggle="yes">k</italic> = 31)</td>
              <td rowspan="1" colspan="1">–</td>
              <td rowspan="1" colspan="1">3 h:07 min</td>
              <td rowspan="1" colspan="1">3 h:07 min</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">PanGenie (<italic toggle="yes">k</italic> = 51)</td>
              <td rowspan="1" colspan="1">–</td>
              <td rowspan="1" colspan="1">3 h:12 min</td>
              <td rowspan="1" colspan="1">3 h:12 min</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MaskedPanGenie</td>
              <td rowspan="1" colspan="1">4 h:24 min</td>
              <td rowspan="1" colspan="1">3 h:27 min</td>
              <td rowspan="1" colspan="1">7 h:51 min</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn3">
            <label>a</label>
            <p><bold>Execution</bold>: 1. reading of input files, 2. counting of k-mers (only PanGenie), 3. identifying unique k-mers and 4. running the HMM. <bold>Preprocessing</bold>: MaskedPanGenie, additionally, requires one preprocessing step, in which spaced seeds are counted with the help of MaskJelly.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec>
    <title>6 Discussion</title>
    <p>Spaced seeds can increase recall in homology search (<xref rid="btad202-B23" ref-type="bibr">Ma et al. 2002</xref>) metagenomic classification (<xref rid="btad202-B37" ref-type="bibr">Wood et al. 2019</xref>) and phylogenetic reconstruction (<xref rid="btad202-B19" ref-type="bibr">Leimeister et al. 2014</xref>). Motivated by this, we analysed the effects of spaced seeds on alignment-free genotyping with PanGenie. We found that the spaced seed we tested can increase recall, F1-score, and weighted genotype concordance. One reason for this is likely the increased length of a spaced seed. In fact, at 30× coverage, spaced, and long contiguous seeds have a similar impact on genotyping of SNPs with MaskedPanGenie. Furthermore, for both spaced seed and long-sized contiguous seed, MaskedPanGenie can assign unique k-mers to more variant alleles than for a mid-size contiguous seed. Even so, more than seed length is needed to fully explain the improved performance observed with the spaced seed. Compared to contiguous long-sized seeds, the spaced seeds performed significantly better in all metrics at 5× coverage and significantly improved weighted genotype concordance and F1-score of genotyping indel and SV at 30× coverage. Presumably this is due to the do not care positions giving the spaced seed robustness to sequencing errors.</p>
    <p>Comparing the two contiguous seeds, this study reported higher recall for a long contiguous seed, than for a mid-sized seed. This is the opposite of conventional expectations for contiguous seeds: Longer k-mers are more likely to contain sequencing errors and, thus, should be less sensitive for homology search. This seeming contradiction can be explained by the differences between the algorithms used for homology search and genotyping. In genotyping, a reduced seed sensitivity affects all alleles at a loci. A reduction in k-mer hits to an alternative allele may be balanced out by a similar reduction in k-mer hits to the reference allele, so the allele probabilities remain the same. Additionally, for large k, more k-mers can be uniquely assigned to a variant, compared to small k. This makes it easier to predict haplotype paths correctly, increasing recall. That said, the effect should be even more dominant for precision. We cannot explain why this is not observable in the data.</p>
    <p>Another reason for the increased performance of the longer seed in our experiments might be the high quality of the reads. Other platforms intended for sequencing small genomes, such as Illumina MiniSeq, have up to seven times higher error rates compared to Illumina HiSeq X Ten (<xref rid="btad202-B31" ref-type="bibr">Stoler and Nekrutenko 2021</xref>). Long k-mers will likely perform worse for reads from these systems. Spaced seeds, on the other hand, might show even larger improvements.</p>
    <p>A problem when using spaced k-mers is the increased runtime for k-mer hashing. MaskedPanGenie is much slower than PanGenie. However, this is mainly due to the simplified implementation of MaskedPanGenie. Algorithms that accelerate this process exist (<xref rid="btad202-B11" ref-type="bibr">Girotto et al. 2018</xref>; <xref rid="btad202-B27" ref-type="bibr">Petrucci et al. 2020</xref>), but they are not yet implemented in sophisticated software solutions. For further research, it could be of use to develop a spaced k-mer counting tool similar to Jellyfish (<xref rid="btad202-B24" ref-type="bibr">Marçais and Kingsford 2011</xref>). Implementing such a tool could reduce runtime considerably. Finally, we suspect that spaced k-mers are able to increase performance of other alignment-free genotyping tools, too, as the underlying mechanics of analyzing k-mer frequencies are similar between most applications. For future research it would be interesting to validate this hypothesis by adding spaced k-mer support to other alignment-free genotyping tools.</p>
  </sec>
  <sec>
    <title>7 Conclusion</title>
    <p>This study proposes a new software MaskedPanGenie, which extends the alignment-free k-mer-based genotyper PanGenie with a spaced seed functionality. Haplotypes are calculated for nine samples using contiguous and spaced seeds, respectively. Applying a spaced seed significantly improves recall, weighted genotype concordance, and F1-score for genotyping with low coverage. These improvements are greater than what could be achieved by increasing the length of contiguous k-mers alone. Effects on precision are mixed and hard to evaluate. Running time is increased but in principle that could be ameliorated by incorporating known special techniques for fast spaced seed hash computation.</p>
    <p>We conclude that spaced seeds may become a valuable technique for improving alignment-free genotyping, particularly for low read-coverages.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad202_Supplementary_Data</label>
      <media xlink:href="btad202_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Author contributions</title>
    <p>H.H. conceived and analysed the experiments and wrote the manuscript. P.H. advised H.H. and reviewed the manuscript.</p>
  </sec>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at Bioinformatics online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>None declared.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The data underlying this article are available in the article and in its online <xref rid="sup1" ref-type="supplementary-material">supplementary material</xref>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad202-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Altman</surname><given-names>DG</given-names></string-name>, <string-name><surname>Gore</surname><given-names>SM</given-names></string-name>, <string-name><surname>Gardner</surname><given-names>MJ</given-names></string-name></person-group><etal>et al</etal><article-title>Statistical guidelines for contributors to medical journals</article-title>. <source>Br Med J (Clin Res Ed)</source><year>1983</year>;<volume>286</volume>:<fpage>1489</fpage>–<lpage>93</lpage>.</mixed-citation>
    </ref>
    <ref id="btad202-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Altschul</surname><given-names>SF</given-names></string-name>, <string-name><surname>Gish</surname><given-names>W</given-names></string-name>, <string-name><surname>Miller</surname><given-names>W</given-names></string-name></person-group><etal>et al</etal><article-title>Basic local alignment search tool</article-title>. <source>J Mol Biol</source><year>1990</year>;<volume>215</volume>:<fpage>403</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">2231712</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B15">
      <mixed-citation publication-type="other"><collab>Broad Institute</collab>. Picard tools; version 2.27.4-SNAPSHOT. <year>2022</year>. <ext-link xlink:href="http://broadinstitute.github.io/picard/" ext-link-type="uri">http://broadinstitute.github.io/picard/</ext-link> (1 September 2022, date last accessed).</mixed-citation>
    </ref>
    <ref id="btad202-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Břinda</surname><given-names>K</given-names></string-name>, <string-name><surname>Sykulski</surname><given-names>M</given-names></string-name>, <string-name><surname>Kucherov</surname><given-names>G.</given-names></string-name></person-group><article-title>Spaced seeds improve k-mer-based metagenomic classification</article-title>. <source>Bioinformatics</source><year>2015</year>;<volume>31</volume>:<fpage>3584</fpage>–<lpage>92</lpage>.<pub-id pub-id-type="pmid">26209798</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Burkhardt</surname><given-names>S</given-names></string-name>, <string-name><surname>Kärkkäinen</surname><given-names>J.</given-names></string-name></person-group><article-title>Better filtering with gapped q-grams</article-title>. <source>Fund Inf</source><year>2003</year>;<volume>56</volume>:<fpage>51</fpage>–<lpage>70</lpage>.</mixed-citation>
    </ref>
    <ref id="btad202-B5">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Byard</surname><given-names>R</given-names></string-name>, <string-name><surname>Payne-James</surname><given-names>J.</given-names></string-name></person-group><source>Encyclopedia of Forensic and Legal Medicine</source>. 2nd ed. London (GB): <publisher-name>Academic Press</publisher-name>. <year>2016</year>.</mixed-citation>
    </ref>
    <ref id="btad202-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chaisson</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Sanders</surname><given-names>AD</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>X</given-names></string-name></person-group><etal>et al</etal><article-title>Multi-platform discovery of haplotype-resolved structural variation in human genomes</article-title>. <source>Nat Commun</source><year>2019</year>;<volume>10</volume>:<fpage>1</fpage>–<lpage>16</lpage>.<pub-id pub-id-type="pmid">30602773</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Choi</surname><given-names>KP</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>L.</given-names></string-name></person-group><article-title>Sensitivity analysis and efficient method for identifying optimal spaced seeds</article-title>. <source>J Comput Syst Sci</source><year>2004</year>;<volume>68</volume>:<fpage>22</fpage>–<lpage>40</lpage>.</mixed-citation>
    </ref>
    <ref id="btad202-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Denti</surname><given-names>L</given-names></string-name>, <string-name><surname>Previtali</surname><given-names>M</given-names></string-name>, <string-name><surname>Bernardini</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal><article-title>Malva: genotyping by mapping-free allele detection of known variants</article-title>. <source>Iscience</source><year>2019</year>;<volume>18</volume>:<fpage>20</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">31352182</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ebert</surname><given-names>P</given-names></string-name>, <string-name><surname>Audano</surname><given-names>PA</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>Q</given-names></string-name></person-group><etal>et al</etal><article-title>Haplotype-resolved diverse human genomes and integrated analysis of structural variation</article-title>. <source>Science</source><year>2021</year>;<volume>372</volume>:<fpage>eabf7117</fpage>.<pub-id pub-id-type="pmid">33632895</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ebler</surname><given-names>J</given-names></string-name>, <string-name><surname>Ebert</surname><given-names>P</given-names></string-name>, <string-name><surname>Clarke</surname><given-names>WE</given-names></string-name></person-group><etal>et al</etal><article-title>Pangenome-based genome inference allows efficient and accurate genotyping across a wide spectrum of variant classes</article-title>. <source>Nat Genet</source><year>2022</year>;<volume>54</volume>:<fpage>518</fpage>–<lpage>25</lpage>.<pub-id pub-id-type="pmid">35410384</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Girotto</surname><given-names>S</given-names></string-name>, <string-name><surname>Comin</surname><given-names>M</given-names></string-name>, <string-name><surname>Pizzi</surname><given-names>C.</given-names></string-name></person-group><article-title>Efficient computation of spaced seed hashing with block indexing</article-title>. <source>BMC Bioinformatics</source><year>2018</year>;<volume>19</volume>:<fpage>29</fpage>–<lpage>38</lpage>.<pub-id pub-id-type="pmid">29390958</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gotoh</surname><given-names>O.</given-names></string-name></person-group><article-title>An improved algorithm for matching biological sequences</article-title>. <source>J Mol Biol</source><year>1982</year>;<volume>162</volume>:<fpage>705</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">7166760</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ilie</surname><given-names>L</given-names></string-name>, <string-name><surname>Ilie</surname><given-names>S.</given-names></string-name></person-group><article-title>Multiple spaced seeds for homology search</article-title>. <source>Bioinformatics</source><year>2007</year>;<volume>23</volume>:<fpage>2969</fpage>–<lpage>77</lpage>.<pub-id pub-id-type="pmid">17804438</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ilie</surname><given-names>L</given-names></string-name>, <string-name><surname>Ilie</surname><given-names>S</given-names></string-name>, <string-name><surname>Mansouri Bigvand</surname><given-names>A.</given-names></string-name></person-group><article-title>Speed: fast computation of sensitive spaced seeds</article-title>. <source>Bioinformatics</source><year>2011</year>;<volume>27</volume>:<fpage>2433</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">21690104</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Keich</surname><given-names>U</given-names></string-name>, <string-name><surname>Li</surname><given-names>M</given-names></string-name>, <string-name><surname>Ma</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>On spaced seeds for similarity search</article-title>. <source>Discret Appl Math</source><year>2004</year>;<volume>138</volume>:<fpage>253</fpage>–<lpage>63</lpage>.</mixed-citation>
    </ref>
    <ref id="btad202-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiełbasa</surname><given-names>SM</given-names></string-name>, <string-name><surname>Wan</surname><given-names>R</given-names></string-name>, <string-name><surname>Sato</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>Adaptive seeds tame genomic sequence comparison</article-title>. <source>Genome Res</source><year>2011</year>;<volume>21</volume>:<fpage>487</fpage>–<lpage>93</lpage>.<pub-id pub-id-type="pmid">21209072</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Krusche</surname><given-names>P</given-names></string-name>, <string-name><surname>Trigg</surname><given-names>L</given-names></string-name>, <string-name><surname>Boutros</surname><given-names>PC</given-names></string-name></person-group><etal>et al</etal>; <collab>Global Alliance for Genomics and Health Benchmarking Team</collab>. <article-title>Best practices for benchmarking germline small-variant calls in human genomes</article-title>. <source>Nat Biotechnol</source><year>2019</year>;<volume>37</volume>:<fpage>555</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">30858580</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leimeister</surname><given-names>C-A</given-names></string-name>, <string-name><surname>Boden</surname><given-names>M</given-names></string-name>, <string-name><surname>Horwege</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Fast alignment-free sequence comparison using spaced-word frequencies</article-title>. <source>Bioinformatics</source><year>2014</year>;<volume>30</volume>:<fpage>1991</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">24700317</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leinonen</surname><given-names>R</given-names></string-name>, <string-name><surname>Sugawara</surname><given-names>H</given-names></string-name>, <string-name><surname>Shumway</surname><given-names>M</given-names></string-name></person-group>; <collab>I. N. S. D. Collaboration</collab>. <article-title>The sequence read archive</article-title>. <source>Nucleic Acids Res</source><year>2011</year>;<volume>39</volume>:<fpage>D19</fpage>–<lpage>D21</lpage>.<pub-id pub-id-type="pmid">21062823</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B21">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>H.</given-names></string-name></person-group> Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM. arXiv. 2013:1303.3997.</mixed-citation>
    </ref>
    <ref id="btad202-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>B</given-names></string-name>, <string-name><surname>Li</surname><given-names>M.</given-names></string-name></person-group><article-title>On the complexity of the spaced seeds</article-title>. <source>J Comput Syst Sci</source><year>2007</year>;<volume>73</volume>:<fpage>1024</fpage>–<lpage>34</lpage>.</mixed-citation>
    </ref>
    <ref id="btad202-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>B</given-names></string-name>, <string-name><surname>Tromp</surname><given-names>J</given-names></string-name>, <string-name><surname>Li</surname><given-names>M.</given-names></string-name></person-group><article-title>Patternhunter: faster and more sensitive homology search</article-title>. <source>Bioinformatics</source><year>2002</year>;<volume>18</volume>:<fpage>440</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">11934743</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Marçais</surname><given-names>G</given-names></string-name>, <string-name><surname>Kingsford</surname><given-names>C.</given-names></string-name></person-group><article-title>A fast, lock-free approach for efficient parallel counting of occurrences of k-mers</article-title>. <source>Bioinformatics</source><year>2011</year>;<volume>27</volume>:<fpage>764</fpage>–<lpage>70</lpage>.<pub-id pub-id-type="pmid">21217122</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McKenna</surname><given-names>A</given-names></string-name>, <string-name><surname>Hanna</surname><given-names>M</given-names></string-name>, <string-name><surname>Banks</surname><given-names>E</given-names></string-name></person-group><etal>et al</etal><article-title>The genome analysis toolkit: a mapreduce framework for analyzing next-generation dna sequencing data</article-title>. <source>Genome Res</source><year>2010</year>;<volume>20</volume>:<fpage>1297</fpage>–<lpage>303</lpage>.<pub-id pub-id-type="pmid">20644199</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mundry</surname><given-names>R</given-names></string-name>, <string-name><surname>Fischer</surname><given-names>J.</given-names></string-name></person-group><article-title>Use of statistical programs for nonparametric tests of small samples often leads to incorrect pvalues: examples from animal behaviour</article-title>. <source>Anim Behav</source><year>1998</year>;<volume>56</volume>:<fpage>256</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">9710485</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Petrucci</surname><given-names>E</given-names></string-name>, <string-name><surname>Noé</surname><given-names>L</given-names></string-name>, <string-name><surname>Pizzi</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>Iterative spaced seed hashing: closing the gap between spaced seed hashing and k-mer hashing</article-title>. <source>J Comput Biol</source><year>2020</year>;<volume>27</volume>:<fpage>223</fpage>–<lpage>33</lpage>.<pub-id pub-id-type="pmid">31800307</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shajii</surname><given-names>A</given-names></string-name>, <string-name><surname>Yorukoglu</surname><given-names>D</given-names></string-name>, <string-name><surname>William Yu</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>Fast genotyping of known snps through approximate k-mer matching</article-title>. <source>Bioinformatics</source><year>2016</year>;<volume>32</volume>:<fpage>i538</fpage>–<lpage>i544</lpage>.<pub-id pub-id-type="pmid">27587672</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sibbesen</surname><given-names>JA</given-names></string-name>, <string-name><surname>Maretty</surname><given-names>L</given-names></string-name>, <string-name><surname>Krogh</surname><given-names>A</given-names></string-name></person-group>; <collab>Danish Pan-Genome Consortium</collab>. <article-title>Accurate genotyping across variant classes and lengths using variant graphs</article-title>. <source>Nat Genet</source><year>2018</year>;<volume>50</volume>:<fpage>1054</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">29915429</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Smith</surname><given-names>TF</given-names></string-name>, <string-name><surname>Waterman</surname><given-names>MS.</given-names></string-name></person-group><article-title>Identification of common molecular subsequences</article-title>. <source>J Mol Biol</source><year>1981</year>;<volume>147</volume>:<fpage>195</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">7265238</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stoler</surname><given-names>N</given-names></string-name>, <string-name><surname>Nekrutenko</surname><given-names>A.</given-names></string-name></person-group><article-title>Sequencing error profiles of illumina sequencing instruments</article-title>. <source>NAR Genom Bioinf</source><year>2021</year>;<volume>3</volume>:<fpage>lqab019</fpage>.</mixed-citation>
    </ref>
    <ref id="btad202-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gotea</surname><given-names>V</given-names></string-name>, <string-name><surname>Veeramachaneni</surname><given-names>V</given-names></string-name>, <string-name><surname>Makałowski</surname><given-names>W.</given-names></string-name></person-group><article-title>Mastering seeds for genomic size nucleotide blast searches</article-title>. <source>Nucleic Acids Res</source><year>2003</year>;<volume>31</volume>:<fpage>6935</fpage>–<lpage>41</lpage>.<pub-id pub-id-type="pmid">14627826</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vinga</surname><given-names>S.</given-names></string-name></person-group> Editorial: Alignment-free methods in computational biology. <source>Brief. Bioinformatics</source><year>2014</year>;<volume>15</volume>:<fpage>341</fpage>–<lpage>2</lpage>.<pub-id pub-id-type="pmid">24819825</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vinga</surname><given-names>S</given-names></string-name>, <string-name><surname>Almeida</surname><given-names>J.</given-names></string-name></person-group><article-title>Alignment-free sequence comparison—a review</article-title>. <source>Bioinformatics</source><year>2003</year>;<volume>19</volume>:<fpage>513</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">12611807</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B35">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Wilcoxon</surname><given-names>F.</given-names></string-name></person-group><part-title>Individual comparisons by ranking methods</part-title>. In: Kotz S, Johnson NL, (eds.) <source>Breakthroughs in Statistics</source>. New York (NY): <publisher-name>Springer</publisher-name>, <year>1992</year>, <fpage>196</fpage>–<lpage>202</lpage>.</mixed-citation>
    </ref>
    <ref id="btad202-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wood</surname><given-names>DE</given-names></string-name>, <string-name><surname>Salzberg</surname><given-names>SL.</given-names></string-name></person-group><article-title>Kraken: ultrafast metagenomic sequence classification using exact alignments</article-title>. <source>Genome Biol</source><year>2014</year>;<volume>15</volume>:<fpage>1</fpage>–<lpage>12</lpage>.</mixed-citation>
    </ref>
    <ref id="btad202-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wood</surname><given-names>DE</given-names></string-name>, <string-name><surname>Lu</surname><given-names>J</given-names></string-name>, <string-name><surname>Langmead</surname><given-names>B.</given-names></string-name></person-group><article-title>Improved metagenomic analysis with kraken 2</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>1</fpage>–<lpage>13</lpage>.<pub-id pub-id-type="pmid">30606230</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zerbino</surname><given-names>DR</given-names></string-name>, <string-name><surname>Birney</surname><given-names>E.</given-names></string-name></person-group><article-title>Velvet: algorithms for de novo short read assembly using de bruijn graphs</article-title>. <source>Genome Res</source><year>2008</year>;<volume>18</volume>:<fpage>821</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">18349386</pub-id></mixed-citation>
    </ref>
    <ref id="btad202-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zielezinski</surname><given-names>A</given-names></string-name>, <string-name><surname>Vinga</surname><given-names>S</given-names></string-name>, <string-name><surname>Almeida</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Alignment-free sequence comparison: benefits, applications, and tools</article-title>. <source>Genome Biol</source><year>2017</year>;<volume>18</volume>:<fpage>1</fpage>–<lpage>17</lpage>.<pub-id pub-id-type="pmid">28077169</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
