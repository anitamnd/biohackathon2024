<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput. Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">ploscomp</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6855565</article-id>
    <article-id pub-id-type="pmid">31682632</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-18-01735</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007419</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Agriculture</subject>
          <subj-group>
            <subject>Animal Management</subject>
            <subj-group>
              <subject>Animal Performance</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Gene Ontologies</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
              <subj-group>
                <subject>Gene Ontologies</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Discrete Mathematics</subject>
            <subj-group>
              <subject>Combinatorics</subject>
              <subj-group>
                <subject>Permutation</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Mathematical and Statistical Techniques</subject>
          <subj-group>
            <subject>Statistical Methods</subject>
            <subj-group>
              <subject>Forecasting</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Statistics</subject>
            <subj-group>
              <subject>Statistical Methods</subject>
              <subj-group>
                <subject>Forecasting</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Signal Processing</subject>
          <subj-group>
            <subject>Noise Reduction</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Probability Theory</subject>
            <subj-group>
              <subject>Statistical Distributions</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Artificial Intelligence</subject>
          <subj-group>
            <subject>Machine Learning</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Novel comparison of evaluation metrics for gene ontology classifiers reveals drastic performance differences</article-title>
      <alt-title alt-title-type="running-head">Novel comparison of classifier evaluation metrics</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Plyusnin</surname>
          <given-names>Ilya</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Holm</surname>
          <given-names>Liisa</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-4764-9790</contrib-id>
        <name>
          <surname>Törönen</surname>
          <given-names>Petri</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Institute of Biotechnology, Helsinki Institute of Life Sciences, University of Helsinki, Helsinki, Finland</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Research Programme in Organismal and Evolutionary Biology, Faculty of Biosciences, University of Helsinki, Helsinki, Finland</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Radivojac</surname>
          <given-names>Predrag</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Indiana University Bloomington, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>petri.toronen@helsinki.fi</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>4</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <volume>15</volume>
    <issue>11</issue>
    <elocation-id>e1007419</elocation-id>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>10</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>9</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2019 Plyusnin et al</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>Plyusnin et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1007419.pdf"/>
    <abstract>
      <p>Automated protein annotation using the Gene Ontology (GO) plays an important role in the biosciences. Evaluation has always been considered central to developing novel annotation methods, but little attention has been paid to the evaluation metrics themselves. Evaluation metrics define how well an annotation method performs and allows for them to be ranked against one another. Unfortunately, most of these metrics were adopted from the machine learning literature without establishing whether they were appropriate for GO annotations. We propose a novel approach for comparing GO evaluation metrics called <italic>Artificial Dilution Series</italic> (ADS). Our approach uses existing annotation data to generate a series of annotation sets with different levels of correctness (referred to as their signal level). We calculate the evaluation metric being tested for each annotation set in the series, allowing us to identify whether it can separate different signal levels. Finally, we contrast these results with several <italic>false positive annotation sets</italic>, which are designed to expose systematic weaknesses in GO assessment. We compared 37 evaluation metrics for GO annotation using ADS and identified drastic differences between metrics. We show that some metrics struggle to differentiate between different signal levels, while others give erroneously high scores to the false positive data sets. Based on our findings, we provide guidelines on which evaluation metrics perform well with the Gene Ontology and propose improvements to several well-known evaluation metrics. In general, we argue that evaluation metrics should be tested for their performance and we provide software for this purpose (<ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/plyusnin/ads/">https://bitbucket.org/plyusnin/ads/</ext-link>). ADS is applicable to other areas of science where the evaluation of prediction results is non-trivial.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>In the biosciences, predictive methods are becoming increasingly necessary as novel sequences are generated at an ever-increasing rate. The volume of sequence data necessitates Automated Function Prediction (AFP) as manual curation is often impossible. Unfortunately, selecting the best AFP method is complicated by researchers using different evaluation metrics. Furthermore, many commonly-used metrics can give misleading results. We argue that the use of poor metrics in AFP evaluation is a result of the lack of methods to benchmark the metrics themselves. We propose an approach called Artificial Dilution Series (ADS). ADS uses existing data sets to generate multiple artificial AFP results, where each result has a controlled error rate. We use ADS to understand whether different metrics can distinguish between results with known quantities of error. Our results highlight dramatic differences in performance between evaluation metrics.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution>Emil Aaltonen Foundation</institution>
        </funding-source>
        <principal-award-recipient>
          <name>
            <surname>Plyusnin</surname>
            <given-names>Ilya</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution>University of Helsinki</institution>
        </funding-source>
        <principal-award-recipient>
          <name>
            <surname>Plyusnin</surname>
            <given-names>Ilya</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution>Helsinki Institute of Life Sciences, University of Helsinki</institution>
        </funding-source>
        <principal-award-recipient>
          <name>
            <surname>Toronen</surname>
            <given-names>Petri</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>IP was funded by Emil Aaltonen foundation <ext-link ext-link-type="uri" xlink:href="https://emilaaltonen.fi/">https://emilaaltonen.fi/</ext-link> and University of Helsinki, <ext-link ext-link-type="uri" xlink:href="https://www.helsinki.fi/en">https://www.helsinki.fi/en</ext-link>. PT was funded by HiLife, Helsinki Institute of Life Science, <ext-link ext-link-type="uri" xlink:href="https://www.helsinki.fi/en/helsinki-institute-of-life-science">https://www.helsinki.fi/en/helsinki-institute-of-life-science</ext-link>. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="9"/>
      <table-count count="1"/>
      <page-count count="27"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2019-11-14</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>We are not generating new structures, annotations, expression datasets etc. here. However, the datasets, used in the analysis, can be found in this submission as supplementary files. They are also available from our web page <ext-link ext-link-type="uri" xlink:href="http://ekhidna2.biocenter.helsinki.fi/ADS/">http://ekhidna2.biocenter.helsinki.fi/ADS/</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>We are not generating new structures, annotations, expression datasets etc. here. However, the datasets, used in the analysis, can be found in this submission as supplementary files. They are also available from our web page <ext-link ext-link-type="uri" xlink:href="http://ekhidna2.biocenter.helsinki.fi/ADS/">http://ekhidna2.biocenter.helsinki.fi/ADS/</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>The biosciences generate sequences at a faster rate than their structure, function or interactions can be experimentally determined. This has created a demand for computational methods that can automatically link novel sequences to their biological function [<xref rid="pcbi.1007419.ref001" ref-type="bibr">1</xref>], resulting in the development of many Automated Function Prediction (AFP) methods [<xref rid="pcbi.1007419.ref002" ref-type="bibr">2</xref>, <xref rid="pcbi.1007419.ref003" ref-type="bibr">3</xref>]. The comparison of different methods is therefore an important task for bioscientists who need to use AFP methods in sequencing projects, for bioinformaticians who develop AFP methods and for reviewers who need to peer-review AFP-related publications.</p>
    <p>Evaluating AFP tools is challenging. Articles use different data sets and report different evaluation metrics in their results. This makes it unclear how different methods perform and sets a bad example for method developers. Standard data sets, such as the MouseFunc project [<xref rid="pcbi.1007419.ref004" ref-type="bibr">4</xref>] and CAFA competitions [<xref rid="pcbi.1007419.ref002" ref-type="bibr">2</xref>, <xref rid="pcbi.1007419.ref003" ref-type="bibr">3</xref>, <xref rid="pcbi.1007419.ref005" ref-type="bibr">5</xref>], are starting to emerge. In our own work, we have additionally used filtered sets of well-annotated sequences [<xref rid="pcbi.1007419.ref006" ref-type="bibr">6</xref>, <xref rid="pcbi.1007419.ref007" ref-type="bibr">7</xref>]. Unfortunately, there are no clear standards for which Evaluation Metrics (EvM) to use. An EvM is a function that quantifies the performance of a method being tested [<xref rid="pcbi.1007419.ref003" ref-type="bibr">3</xref>, <xref rid="pcbi.1007419.ref008" ref-type="bibr">8</xref>–<xref rid="pcbi.1007419.ref010" ref-type="bibr">10</xref>] and, as Table 1 in supplementary <xref ref-type="supplementary-material" rid="pcbi.1007419.s004">S2 Text</xref> demonstrates, there is no consensus in the literature for which are best. Furthermore, although the CAFA competitions [<xref rid="pcbi.1007419.ref002" ref-type="bibr">2</xref>, <xref rid="pcbi.1007419.ref003" ref-type="bibr">3</xref>, <xref rid="pcbi.1007419.ref005" ref-type="bibr">5</xref>] have led to defacto standards, these have been criticised. Gillis and Pavlidis [<xref rid="pcbi.1007419.ref011" ref-type="bibr">11</xref>], for example, observed that <italic>“the primary performance metric … for CAFA is unsatisfactory. … by this measure, a null ‘prediction method’ outperforms most methods.”</italic> Kahanda et al. [<xref rid="pcbi.1007419.ref012" ref-type="bibr">12</xref>] pointed out that the ranking of methods in CAFA varied considerably between different EvMs. Even the CAFA authors themselves concede that finding appropriate EvMs for GO annotation is an open problem [<xref rid="pcbi.1007419.ref002" ref-type="bibr">2</xref>, <xref rid="pcbi.1007419.ref003" ref-type="bibr">3</xref>]. This shows that there is a clear need for research on AFP-related EvMs.</p>
    <p>The challenges that an EvM must overcome are related to the structure of the Gene Ontology [<xref rid="pcbi.1007419.ref013" ref-type="bibr">13</xref>] itself:</p>
    <list list-type="bullet">
      <list-item>
        <p>The GO structure has a large number of classes and genes can belong to many of them. This creates a multilabel and multiclass classification task.</p>
      </list-item>
      <list-item>
        <p>The hierarchy of the GO structure causes strong and complex correlations between classes.</p>
      </list-item>
      <list-item>
        <p>Class sizes vary widely, with most being very small. This causes strong class size imbalance.</p>
      </list-item>
    </list>
    <p specific-use="continuation">and the nature of biological data:</p>
    <list list-type="bullet">
      <list-item>
        <p>The set of genes used for evaluation can be small compared to the number of classes [<xref rid="pcbi.1007419.ref002" ref-type="bibr">2</xref>], making the table of correct annotations sparse.</p>
      </list-item>
      <list-item>
        <p>The meaning and definition of true negative GO annotations is ambiguous [<xref rid="pcbi.1007419.ref014" ref-type="bibr">14</xref>, <xref rid="pcbi.1007419.ref015" ref-type="bibr">15</xref>].</p>
      </list-item>
      <list-item>
        <p>Each gene has a varying number of correct annotations.</p>
      </list-item>
    </list>
    <p>These challenges point to the selection of EvM as clearly nontrivial. Furthermore, the EvM selection problem is not limited to AFP comparison, but is a problem in many other fields [<xref rid="pcbi.1007419.ref008" ref-type="bibr">8</xref>, <xref rid="pcbi.1007419.ref009" ref-type="bibr">9</xref>], such as in speech recognition [<xref rid="pcbi.1007419.ref016" ref-type="bibr">16</xref>] and with the classification of cognitive activities [<xref rid="pcbi.1007419.ref017" ref-type="bibr">17</xref>]. Finally, EvMs often forms the core of the results section in bioinformatics articles and can be selected to favour one’s own method [<xref rid="pcbi.1007419.ref018" ref-type="bibr">18</xref>].</p>
    <p>We propose a novel approach, <bold>Artificial Dilution Series (ADS)</bold>, to address these challenges. ADS checks the performance and stability of any EvM using real-life GO annotations. ADS creates artificial classifier results by taking a set of correct GO predictions and replacing a controlled percentage of correct annotations with errors (creating type 1 and type 2 errors, collectively referred to as “noise”). The noise percentage is then increased in a step-wise fashion, creating a set of separate result data sets with a controlled level of noise at each step. This process creates a “dilution series” of the original signal in a collection of altered data sets. This series is then used to test different EvMs to see how well they separate data sets with different signal levels.</p>
    <p>Additionally, we included a secondary test using several <bold>False Positive (FP) data sets</bold>. We run each EvM with each FP data set, and compare them with the ADS results. A good EvM would place FP sets close to sets with zero signal. FP sets allow us to monitor how each EvM ranks, for example, the naïve predictor [<xref rid="pcbi.1007419.ref002" ref-type="bibr">2</xref>, <xref rid="pcbi.1007419.ref003" ref-type="bibr">3</xref>], which is a known issue for some EvMs [<xref rid="pcbi.1007419.ref011" ref-type="bibr">11</xref>]. Our supplementary text <xref ref-type="supplementary-material" rid="pcbi.1007419.s004">S2 Text</xref> compares our approach to related research.</p>
    <p>We tested many EvMs previously applied to GO annotations using three datasets: CAFA1 [<xref rid="pcbi.1007419.ref002" ref-type="bibr">2</xref>], MouseFunc [<xref rid="pcbi.1007419.ref004" ref-type="bibr">4</xref>] and 1000 randomly selected GO annotated sequences from the UniProt database. We also tested small variations of the existing EvMs. Our results show that <italic>1</italic>) many popular EvMs often fail the FP tests, <italic>2</italic>) semantic scores [<xref rid="pcbi.1007419.ref019" ref-type="bibr">19</xref>] are heavily affected by what summation method is used, with methods failing either in ADS or FP tests, <italic>3</italic>) The best, most consistent performance across all the data sets was obtained with modified SimGIC functions (a weighted Jaccard correlation [<xref rid="pcbi.1007419.ref020" ref-type="bibr">20</xref>]) and <italic>4</italic>) term centric analysis or Information Content (IC) weights are usually required for good performance. IC weights are discussed in methods and in <xref ref-type="supplementary-material" rid="pcbi.1007419.s004">S2 Text</xref>.</p>
    <p>Some EvMs showed better performance than SimGIC on one or two data sets. This suggests that different GO data sets have different challenges, each requiring separate evaluation. The ADS software is freely available at <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/plyusnin/ads/">https://bitbucket.org/plyusnin/ads/</ext-link>. All tested EvMs and our analysis scripts are available at <ext-link ext-link-type="uri" xlink:href="http://ekhidna2.biocenter.helsinki.fi/ADS/">http://ekhidna2.biocenter.helsinki.fi/ADS/</ext-link>.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and methods</title>
    <sec id="sec003">
      <title>Generating artificial dilution series</title>
      <sec id="sec004">
        <title>Motivation and requirements</title>
        <p>We assume that we have a set of genes, each with a varying number of GO annotations. This set of annotated genes will be referred to as the truth set, <italic>T</italic>. <italic>T</italic> is expected to be a table that contains gene names in the first column and the associated GO term identifiers in the second column. We assume the existence of an ontology, such as GO. The ontology links smaller, more precise child terms to more broadly defined ancestral terms. Here, if a term <italic>t</italic><sub><italic>child</italic></sub>, is a child term for <italic>t</italic><sub><italic>par</italic></sub>, then all genes that belong to <italic>t</italic><sub><italic>child</italic></sub> will also belong to <italic>t</italic><sub><italic>par</italic></sub> (i.e. <italic>t</italic><sub><italic>child</italic></sub> ⊆ <italic>t</italic><sub><italic>par</italic></sub>). These child–ancestor connections form a directed acyclic graph, where every GO term, with the exception of the root term, has a varying number of parent terms [<xref rid="pcbi.1007419.ref013" ref-type="bibr">13</xref>]. Genes can be mapped to GO terms at varying levels in the ontology, depending on how detailed our level of knowledge is.</p>
        <p>Artificial Dilution Series creates several data sets, each representing functional classifications for genes in <italic>T</italic>. These data sets, referred to here as <italic>Artificial Prediction Sets</italic> (or AP sets), imitate a GO prediction set from a GO classifier. They are comprised of a list of triples, (gene, GO, <italic>sc</italic>), where <italic>sc</italic> is the artificial prediction score. Each AP set is created artificially, with a defined proportion of correct and erroneous annotations. AP set creation does not require a real classifier, nor the actual gene sequences. Furthermore, each AP set can also be defined as a table, where rows represents different annotation entities and columns represent genes, GO terms and classifier scores.</p>
        <p>The workflow for the ADS pipeline is shown in <xref ref-type="fig" rid="pcbi.1007419.g001">Fig 1</xref> and outlined in pseudocode in <xref ref-type="supplementary-material" rid="pcbi.1007419.s003">S1 Text</xref>. The first step is to create two GO prediction sets, the <italic>Positive Prediction set</italic>, <italic>P</italic><sub><italic>pos</italic></sub>, and the <italic>Negative Prediction set</italic>, <italic>P</italic><sub><italic>neg</italic></sub>. These steps use a <italic>signal model</italic> to perturb the ground truth GO annotations and a <italic>noise model</italic> to generate erroneous annotation predictions. Note that both <italic>P</italic><sub><italic>pos</italic></sub> and <italic>P</italic><sub><italic>neg</italic></sub> have a table structure, similar to the AP set.</p>
        <fig id="pcbi.1007419.g001" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1007419.g001</object-id>
          <label>Fig 1</label>
          <caption>
            <title>ADS workflow.</title>
            <p>The ADS pipeline iterates through specified signal levels (e.g. from 100% to 0%) at each level creating a collection of artificial prediction sets (AP sets). Each AP set is a union of a set containing only false annotations (negative set) and a set containing a controlled fraction of true annotations (positive set). AP sets are compared against the correct annotations using an Evaluation Metric (EvM). The results can be shown graphically by plotting EvM scores for AP sets at each signal level as boxplots. These reveal how stable an EvM is against random variation introduced at different signal levels and whether it can measure the amount of signal retained in different AP sets. Finally, EvM performance is quantified with rank correlation.</p>
          </caption>
          <graphic xlink:href="pcbi.1007419.g001"/>
        </fig>
      </sec>
      <sec id="sec005">
        <title>Step 1: Create the positive set</title>
        <p>The Positive set, <italic>P</italic><sub><italic>pos</italic></sub>, is created from a copy of <italic>T</italic> in two stages: First, we draw a random integer, <italic>N</italic><sub><italic>shift</italic></sub>, between 0 and the size of <italic>P</italic><sub><italic>pos</italic></sub>, and select <italic>N</italic><sub><italic>shift</italic></sub> random rows from <italic>P</italic><sub><italic>pos</italic></sub>. Next, the GO term, <italic>t</italic><sub><italic>corr</italic></sub>, of every selected row is replaced with a semantically similar term. This term is selected from the <italic>k</italic> nearest parents of <italic>t</italic><sub><italic>corr</italic></sub>. We refer to this procedure as <italic>shifting to semantic neighbours</italic> and it forms the basis of our signal model. Figure 1 in supplementary text <xref ref-type="supplementary-material" rid="pcbi.1007419.s004">S2 Text</xref> demonstrates this step. We have tested <italic>k</italic> = (2, 3, 4) and found results to be similar.</p>
        <p>Second, we introduce a percentage of errors, <italic>ϵ</italic>, by switching GO terms between genes for a controlled fraction of annotation lines (see <xref ref-type="fig" rid="pcbi.1007419.g002">Fig 2</xref> for a toy example). We refer to this as the <italic>permutation of the positive set</italic>. Here a random pair of annotations, <italic>a</italic> = (<italic>gene</italic><sub><italic>a</italic></sub>, <italic>t</italic><sub><italic>a</italic></sub>) and <italic>b</italic> = (<italic>gene</italic><sub><italic>b</italic></sub>, <italic>t</italic><sub><italic>b</italic></sub>), where <italic>gene</italic><sub><italic>a</italic></sub> ≠ <italic>gene</italic><sub><italic>b</italic></sub> and <italic>t</italic><sub><italic>a</italic></sub> ≠ <italic>t</italic><sub><italic>b</italic></sub>, is selected from <italic>P</italic><sub><italic>pos</italic></sub>. If <italic>t</italic><sub><italic>a</italic></sub> is sufficiently far away in the GO structure from every GO term annotated to <italic>gene</italic><sub><italic>b</italic></sub> and vice versa for <italic>t</italic><sub><italic>b</italic></sub> and the annotations of <italic>gene</italic><sub><italic>a</italic></sub>, then the GO labels are exchanged. The distance between <italic>t</italic><sub><italic>x</italic></sub> and <italic>t</italic><sub><italic>y</italic></sub> is defined as the Jaccard correlation between the two sets created from the ancestral classes of <italic>t</italic><sub><italic>x</italic></sub> and <italic>t</italic><sub><italic>y</italic></sub> (see <xref ref-type="supplementary-material" rid="pcbi.1007419.s003">S1 Text</xref>). In our experiments we used a threshold, <italic>th</italic><sub><italic>noise</italic></sub>, of 0.2 and required that the correlation was lower than <italic>th</italic><sub><italic>noise</italic></sub>. This step represents our noise model.</p>
        <fig id="pcbi.1007419.g002" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1007419.g002</object-id>
          <label>Fig 2</label>
          <caption>
            <title>ADS permutation example.</title>
            <p>In this toy example we start with a set of correct annotations using only two GO terms A and B, taken from truth set <italic>T</italic>. Initially, in the upper part the Artificial Prediction Set (<italic>APS</italic>) matches perfectly to <italic>T</italic>. This would give us 100% correct predictions. Next, the permutation step, shown in the middle, switches GO terms for a pair of genes. This increases false positives and false negatives by 1 and decreases true positives and true negatives by 1. We obtain as a result an <italic>APS</italic> with a known level of errors (0.002 in this example). The permutation is repeated with other gene pairs and other GO terms until the required noise level is obtained.</p>
          </caption>
          <graphic xlink:href="pcbi.1007419.g002"/>
        </fig>
        <p>The permutation process is repeated until the required percentage of errors, <italic>ϵ</italic>, have been introduced. This adds a controlled fraction of false positives and false negatives among the predictions. We refer to this fraction as the <italic>ADS noise level</italic> and the remaining fraction of correct positive annotations as the <italic>ADS signal level</italic> (1—ADS noise level).</p>
      </sec>
      <sec id="sec006">
        <title>Step 2: Create the negative set</title>
        <p>The negative set, <italic>P</italic><sub><italic>neg</italic></sub>, is created by assigning genes in <italic>T</italic> with random GO annotations. Here, for every unique gene name, <italic>gene</italic><sub><italic>x</italic></sub>, that occurs in <italic>T</italic>, we sample a random GO term, <italic>t</italic><sub><italic>r</italic></sub>, from the GO structure. As in the construction of the positive set, (<italic>gene</italic><sub><italic>x</italic></sub>, <italic>t</italic><sub><italic>r</italic></sub>) is included in <italic>P</italic><sub><italic>neg</italic></sub> only if it is located far away in the GO structure compared to all GO terms linked to <italic>gene</italic><sub><italic>x</italic></sub>. This process is repeated until four erroneous GO annotations have been added to each gene.</p>
      </sec>
      <sec id="sec007">
        <title>Step 3: Add prediction scores and merge sets</title>
        <p>All entries in <italic>P</italic><sub><italic>pos</italic></sub> and <italic>P</italic><sub><italic>neg</italic></sub> are assigned prediction scores, <italic>sc</italic>. Predictions in <italic>P</italic><sub><italic>pos</italic></sub> are assigned scores by sampling <italic>sc</italic> from a normal distribution with <italic>mean</italic> = 1 and <italic>SD</italic> = 0.5. This creates a triple (<italic>gene</italic><sub><italic>x</italic></sub>, <italic>t</italic><sub><italic>x</italic></sub>, <italic>sc</italic>) for each annotation in <italic>P</italic><sub><italic>pos</italic></sub>. For predictions in <italic>P</italic><sub><italic>neg</italic></sub>, we sample <italic>sc</italic> from a normal distribution with a lower mean (<italic>mean</italic> = −1 and <italic>SD</italic> = 0.5) and add it similarly to <italic>P</italic><sub><italic>neg</italic></sub>. If scores need to be within a bounded range, such as [0, 1], a sigmoid function could be used to scale the score values. Next, <italic>P</italic><sub><italic>pos</italic></sub> and <italic>P</italic><sub><italic>neg</italic></sub> are merged to form an AP set, <italic>APS</italic> = <italic>P</italic><sub><italic>pos</italic></sub> ∪ <italic>P</italic><sub><italic>neg</italic></sub>. What we now have is a set of GO predictions with A) a set of errors, represented by <italic>P</italic><sub><italic>neg</italic></sub>, that can be separated by setting a threshold on <italic>sc</italic> values and B) a set of errors embedded into <italic>P</italic><sub><italic>pos</italic></sub>, that cannot be separated with a threshold (ADS noise level). Furthermore, A stays constant for all AP sets, whereas B is adjusted with <italic>ϵ</italic>. Finally, the predictions are extended to include ancestor nodes in the GO hierarchy for a given metric. In some cases, such as semantic similarity-based metrics, the metric will already account for dependencies between GO terms [<xref rid="pcbi.1007419.ref019" ref-type="bibr">19</xref>] and this step is omitted.</p>
      </sec>
      <sec id="sec008">
        <title>Step 4: Creating AP sets with all ADS signal levels</title>
        <p>Full ADS analysis repeats the AP set creation, while incrementally changing the ADS signal level over the selected signal range, <italic>SR</italic> = [<italic>x</italic><sub>1</sub>, <italic>x</italic><sub>2</sub>, ‥<italic>x</italic><sub><italic>k</italic></sub>] (illustrated by the outer loop in <xref ref-type="fig" rid="pcbi.1007419.g001">Fig 1</xref>). We used an <italic>SR</italic> that spans from 100% to 0% signal in steps of ten percentage points. However, our implementation allows for any range with any number of steps. At each signal level the AP set generation is repeated <italic>N</italic> times, each time applying the shifting to semantic neighbourhood and permutation procedures as described above (the inner loop in <xref ref-type="fig" rid="pcbi.1007419.g001">Fig 1</xref>). The final ADS series will contain:</p>
        <list list-type="order">
          <list-item>
            <p>Evenly sampled ADS signal levels between the selected minimum and maximum signal levels.</p>
          </list-item>
          <list-item>
            <p><italic>N</italic> separate AP sets representing each signal level.</p>
          </list-item>
          <list-item>
            <p>The proportion of annotations shifted to semantic neighbours varying randomly across AP sets at the same signal level.</p>
          </list-item>
          <list-item>
            <p>Annotations selected for permutation and shifted to semantic neighbours varying across AP sets at the same signal level.</p>
          </list-item>
          <list-item>
            <p>The proportion of permuted annotations changing as a function of the ADS noise level.</p>
          </list-item>
        </list>
        <p>These artificial data sets have variations within the ADS signal level that evaluation metrics should be relatively insensitive to (points 3 and 4) and variation across ADS signal levels that evaluation metric should be able to distinguish (point 5).</p>
      </sec>
    </sec>
    <sec id="sec009">
      <title>Motivation for signal and noise models</title>
      <p>We have two reasons for allowing <italic>t</italic><sub><italic>signal</italic></sub> in the signal model to move to nearby terms in the ontology. First, real-life GO prediction tools often predict nearby terms as these tend to be correlated with <italic>t</italic><sub><italic>corr</italic></sub>. Second, omitting these changes would favour metrics that focus on <italic>t</italic><sub><italic>corr</italic></sub> in the evaluation and ignore the ontology structure during evaluation, which would bias our analysis results.</p>
      <p>The noise model, embedded in the Positive Set, aims to represent the worst type of error a classifier could make as a) <italic>t</italic><sub><italic>noise</italic></sub> is clearly separated from <italic>t</italic><sub><italic>corr</italic></sub> in the ontology and b) prediction scores for erroneous predictions, <italic>sc</italic><sub><italic>noise</italic></sub>, come from the same distribution as correct predictions. This means that a threshold on the <italic>sc</italic> scores is unable to separate signal and noise predictions, ensuring that noise cannot be excluded from the evaluation. An EvM should consider our noise predictions as negative cases and score the data set accordingly. Furthermore, generating noise by permuting the GO classes from <italic>T</italic> keeps many other variables constant, such as average class size and average distance to the root node of predicted terms. The comparison of evaluation metrics is therefore not biased towards metrics that consider unrelated variables.</p>
      <p>The noise that is added with lower prediction scores is motivated by trends in classifier results, where lower <italic>sc</italic> corresponds to lower prediction quality. Note that most metrics take this into consideration by using varying thresholds on the <italic>sc</italic> values. If this noise was excluded, there would be no benefit in using a threshold on <italic>AP</italic> set results as an EvM could simply average over all prediction results.</p>
    </sec>
    <sec id="sec010">
      <title>Testing evaluation metrics with ADS</title>
      <p>EvMs are tested by scoring the AP sets and comparing the results to the truth set, <italic>T</italic>. This gives us an output matrix:
<disp-formula id="pcbi.1007419.e001"><alternatives><graphic xlink:href="pcbi.1007419.e001.jpg" id="pcbi.1007419.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mrow><mml:mi>O</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>p</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mi>P</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives><label>(1)</label></disp-formula>
where <italic>Metric</italic> is a given evaluation metric, columns, <italic>j</italic> = [1, 2, ‥<italic>k</italic>], correspond to different ADS signal levels, rows <italic>i</italic> = [1, 2‥<italic>N</italic>] represents the different repetitions with the same ADS signal level and <italic>APS</italic><sub><italic>ij</italic></sub> is the <italic>i</italic><sup><italic>th</italic></sup> AP set obtained at signal level <italic>j</italic>. A good metric should have low variance within one ADS signal level (within <italic>Output</italic> columns) and a clear separation between the different ADS signal levels (between <italic>Output</italic> columns). We test this in two ways: A) visually by plotting <italic>Output</italic> columns as separate boxplots at different ADS noise levels and B) numerically by calculating the rank correlation, <italic>RC</italic>, between <italic>Output</italic> matrix and ADS signal levels. Boxplots give an overview of the performance of the tested metric. <italic>RC</italic> monitors how closely EvM is able to predict the correct ranking of the ADS signal levels. One could also consider the linear correlation, but that would favour linear correlation over the correct rank.</p>
    </sec>
    <sec id="sec011">
      <title>False positive data sets</title>
      <p>In addition to AP sets, we also generated several prediction sets where all genes were annotated with the same set of non-informative GO terms or with randomly chosen GO terms. We wanted to be able to identify evaluation metrics that give high scores to prediction sets containing no signal. We refer to these sets as <italic>False Positive Sets</italic> (FP sets). We included the following FP sets:</p>
      <list list-type="order">
        <list-item>
          <p>Each gene has the same large set of the smallest GO terms. We call this the <italic>all positive set</italic>.</p>
        </list-item>
        <list-item>
          <p>Each gene has the same small set of the largest GO terms, where <italic>sc</italic> is taken from the term frequency in the database. We call this the <italic>naïve set</italic>.</p>
        </list-item>
        <list-item>
          <p>Each gene has a set of randomly selected GO terms. We call this the <italic>random set</italic>.</p>
        </list-item>
      </list>
      <p>The motivation for the all positive set is to test the sensitivity of the evaluation metric to false positive predictions (low precision). Note that a set where each gene has all GO terms would be impractical to analyse. Therefore, we decided to select a large set of the smallest GO terms, each having many ancestral GO terms. The random set shows the performance when both precision and recall are very low and should therefore always have a low score. The naïve set tests if the evaluation metric can be misled by bias in the base rates to consider the results meaningful. The naïve set uses the same list of GO classes, ranked in decreasing order of size, for every analysed gene. The naïve set was originally proposed by Clark and Radivojak [<xref rid="pcbi.1007419.ref021" ref-type="bibr">21</xref>] and it has been used extensively in CAFA competitions [<xref rid="pcbi.1007419.ref002" ref-type="bibr">2</xref>]. They refer to the naïve set as naïve method or naïve predictor. Note that all these FP sets are decoupled from the annotated sequences and contain no real information about the corresponding genes.</p>
      <p>There is a parameter that needs to be considered for FP set generation: the number of GO terms reported per gene. We selected this to be quite high (800 GO terms). This emphasises the potential inability of the metric to separate the noise signal in the FP sets from the true signal in predictions output by classifiers. We used three false positive sets:</p>
      <list list-type="order">
        <list-item>
          <p>Naïve-800: all genes assigned to the 800 most frequent GO terms. Here larger GO classes always have a better score.</p>
        </list-item>
        <list-item>
          <p>Small-800: all genes assigned to the 800 least frequent GO terms. Here smaller GO classes always have a better score.</p>
        </list-item>
        <list-item>
          <p>Random-800: all genes assigned by a random sample of 800 GO terms (sampling without replacement).</p>
        </list-item>
      </list>
      <p specific-use="continuation">GO frequencies for FP set sampling was estimated using the UniProt GO annotation (<ext-link ext-link-type="ftp" xlink:href="ftp://ftp.ebi.ac.uk/pub/databases/GO/goa/UniProt/">ftp://ftp.ebi.ac.uk/pub/databases/GO/goa/UniProt/</ext-link>, 01.2019).</p>
      <p>In the visual analysis, we plot the score for each FP set as a horizontal line over the boxplot of AP set scores. A well-performing evaluation metric is expected to score all FP sets close to AP sets with minimal or no signal (<italic>signal</italic> ∼ 0), i.e. as a horizontal line at the lowest region of the plot (see <xref ref-type="fig" rid="pcbi.1007419.g003">Fig 3</xref>).</p>
      <fig id="pcbi.1007419.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007419.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Combining FP sets with ADS results.</title>
          <p>Here <italic>F</italic><sub><italic>max</italic></sub> results from False Positive (FP) sets are combined with <italic>F</italic><sub><italic>max</italic></sub> boxplots from ADS. FP results are added as horizontal lines to the visualisation. A robust metric would score FP sets near the lowest boxplot. An FP signal estimate is obtained by comparing each FP result with medians of each signal level. This is shown in figure with vertical arrows. Resulting signals are here limited to between 0 and 1.</p>
        </caption>
        <graphic xlink:href="pcbi.1007419.g003"/>
      </fig>
      <p>In our numerical analysis, we summarise FP sets by <bold>1</bold>) Finding the approximate point where the horizontal FP set line crosses the curve created by the medians of each signal level (see <xref ref-type="fig" rid="pcbi.1007419.g003">Fig 3</xref>), <bold>2</bold>) choosing the corresponding signal level from the <italic>x</italic>-axis as the FP score for the FP set in question and <bold>3</bold>) selecting the maximum over all FP sets as the final FP Score (referred to later as <italic>FPS</italic>). Note that in step <bold>2</bold> we limit the signal between zero and one. In step <bold>3</bold> we focus on the worst result over all tested FP sets. A good EvM should not be sensitive towards any of the FP sets, making the worst signal (= highest FP score) the best measure for the insensitivity towards these biases.</p>
    </sec>
    <sec id="sec012">
      <title>Evaluation metrics</title>
      <p>We selected representatives from various types of EvMs commonly used in AFP evaluation (see supplementary text <xref ref-type="supplementary-material" rid="pcbi.1007419.s004">S2 Text</xref>). We also included modifications of some EvMs. Note that there is a large variety of EvMs available, especially in the machine learning literature [<xref rid="pcbi.1007419.ref008" ref-type="bibr">8</xref>, <xref rid="pcbi.1007419.ref010" ref-type="bibr">10</xref>], and we cannot cover them all. The tested EvMs can be grouped into three families: <bold>rank-based metrics</bold>, <bold>GO semantic similarity-based metrics</bold> and <bold>group-based metrics</bold>.</p>
      <p>We evaluated two rank-based metrics: area under ROC curve (AUC-ROC) and area under precision-recall curve (AUC-PR). Both strategies capture the amount of false positive and false negative errors at different threshold levels. We evaluated three semantic similarity-based metrics: Lin [<xref rid="pcbi.1007419.ref022" ref-type="bibr">22</xref>], Resnik [<xref rid="pcbi.1007419.ref023" ref-type="bibr">23</xref>] and Ancestor Jaccard (AJacc). AJacc is a novel method taking the Jaccard correlation between two sets of GO terms (i.e. the ancestor terms for both GO terms). Group-based methods compare a set of predicted GO terms to the ground truth. From this group, we evaluated SimGIC [<xref rid="pcbi.1007419.ref020" ref-type="bibr">20</xref>], Jaccard correlation (Jacc) and <italic>S</italic><sub><italic>min</italic></sub> [<xref rid="pcbi.1007419.ref024" ref-type="bibr">24</xref>]. We also evaluated <italic>F</italic><sub><italic>max</italic></sub>, one of the most popular metrics in machine learning.</p>
      <p>Most of the metrics compared here, have been used actively in AFP evaluation (see Table 1 in supplementary text <xref ref-type="supplementary-material" rid="pcbi.1007419.s004">S2 Text</xref>). Although AUC-PR has not been used directly, it is related to the popular precision-recall plots. All metrics except rank-based metrics can be calculated using different thresholds over prediction scores. We selected the maximum score as the final score for each metric over all possible threshold values.</p>
      <p>The semantic similarity metrics we tested return a matrix, <italic>M</italic><sub><italic>g</italic></sub>, of similarity values for each analysed gene, <italic>g</italic>. Here each <italic>m</italic><sub><italic>i</italic>,<italic>j</italic></sub> in <italic>M</italic> is a similarity score between the predicted GO term, <italic>i</italic>, and the correct GO term, <italic>j</italic>, and is calculated using the selected semantic similarity metric. Altogether <italic>M</italic><sub><italic>g</italic></sub> compares the set of correct GO terms for <italic>g</italic>, <italic>S</italic><sub><italic>corr</italic></sub>, and the set of predicted GO terms for <italic>g</italic>, <italic>S</italic><sub><italic>pred</italic></sub>, with each other. Here <italic>S</italic><sub><italic>corr</italic></sub> is a fixed set, whereas the <italic>S</italic><sub><italic>pred</italic></sub> is altered, including GO predictions for <italic>g</italic> that have stronger prediction scores than the acceptance threshold, <italic>th</italic>. We iterate through thresholds from the largest to the smallest values of the prediction scores resulting in a series of <italic>S</italic><sub><italic>pred</italic></sub> sets for each gene with the smallest set corresponding to the largest <italic>th</italic> and the largest to the smallest <italic>th</italic>. Next, we generate <italic>M</italic><sub><italic>g</italic></sub> for every <italic>S</italic><sub><italic>pred</italic></sub> and summarise <italic>M</italic><sub><italic>g</italic></sub> into a single score with a procedure described below. From threshold-wise scores we then select the best (for most metrics the maximum) score.</p>
      <p>When semantic similarity is used as an evaluation metric, <italic>M</italic><sub><italic>g</italic></sub> needs to be summarised into a single score for each gene at each tested threshold. As there is no clear recommendations for this, we tested six alternatives:</p>
      <list list-type="simple">
        <list-item>
          <label>A</label>
          <p>Mean of matrix. This is the overall similarity between all classes in <italic>S</italic><sub><italic>corr</italic></sub> and <italic>S</italic><sub><italic>pred</italic></sub></p>
        </list-item>
        <list-item>
          <label>B</label>
          <p>Mean of column maxima. This is the average of best hits in <italic>M</italic><sub><italic>g</italic></sub> for classes in <italic>S</italic><sub><italic>corr</italic></sub>.</p>
        </list-item>
        <list-item>
          <label>C</label>
          <p>Mean of row maxima. This is the average of best hits in <italic>M</italic><sub><italic>g</italic></sub> for classes in <italic>S</italic><sub><italic>pred</italic></sub>.</p>
        </list-item>
        <list-item>
          <label>D</label>
          <p>Mean of B and C.</p>
        </list-item>
        <list-item>
          <label>E</label>
          <p>Minimum of B and C.</p>
        </list-item>
        <list-item>
          <label>F</label>
          <p>Mean of concatenated row and column maxima.</p>
        </list-item>
      </list>
      <p specific-use="continuation">Methods A and D have been used previously [<xref rid="pcbi.1007419.ref019" ref-type="bibr">19</xref>]. A is considered to be weaker than D because A is affected by the heterogeneity of GO classes in <italic>S</italic><sub><italic>corr</italic></sub> (see Supplementary Text <xref ref-type="supplementary-material" rid="pcbi.1007419.s004">S2 Text</xref> and [<xref rid="pcbi.1007419.ref019" ref-type="bibr">19</xref>]). Methods B and C represent intentionally flawed methods, used here as negative controls. B is weak at monitoring false positive predictions and C is weak at monitoring false negatives. D aims to correct B and C by averaging them, but is still sensitive to outliers. Therefore, we propose methods E and F as improvements to method D. E monitors the weaker of B and C, and is therefore more stringent at reporting good similarity. F combines two vectors used for B and C. This emphasises the longer of two vectors as the size of <italic>S</italic><sub><italic>pred</italic></sub> is altered. Section 5.7 in our supplementary text <xref ref-type="supplementary-material" rid="pcbi.1007419.s004">S2 Text</xref> motivates these summation methods in more detail. Finally, the obtained scores for each gene at each <italic>th</italic> threshold are averaged and the maximum over all <italic>th</italic> values is reported.</p>
      <p>Most EvMs can be further modified by using the same core function with different <italic>Data Structuring</italic>. By data structuring we refer to the gene centric, term centric or unstructured evaluations. In <bold>Gene Centric evaluation (GC)</bold>, we evaluate the predicted set of GO terms against the true set separately for each gene and then summarise these values with the mean over all genes. In <bold>Term Centric evaluation (TC)</bold> we compare the set of genes assigned to a given GO term in predictions against the true set separately for each GO term and take the mean over all GO terms. In <bold>UnStructured evaluation (US)</bold> we compare predictions as a single set of gene–GO pairs, disregarding any grouping by shared genes or GO terms. In total we tested 37 metrics (summarised in <xref ref-type="supplementary-material" rid="pcbi.1007419.s008">S1 Table</xref>). Further discussion and metric definitions are given in <xref ref-type="supplementary-material" rid="pcbi.1007419.s004">S2 Text</xref>.</p>
    </sec>
    <sec id="sec013">
      <title>Data sets and parameters</title>
      <p>All metrics were tested on three annotation data sets: the evaluation set used in CAFA 1 [<xref rid="pcbi.1007419.ref002" ref-type="bibr">2</xref>], the evaluation set from the MouseFunc competition [<xref rid="pcbi.1007419.ref004" ref-type="bibr">4</xref>] and a random sample of 1000 well-annotated genes from the UniProt database (<ext-link ext-link-type="ftp" xlink:href="ftp://ftp.ebi.ac.uk/pub/databases/GO/goa/UniProt/">ftp://ftp.ebi.ac.uk/pub/databases/GO/goa/UniProt/</ext-link>, 01.2019). These data sets represent three alternatives for evaluating an AFP tool (see <xref ref-type="sec" rid="sec001">Introduction</xref>). We used annotations from the beginning of 2019 with all data sets. It should be noted that the annotation densities of the tested data sets vary over time, potentially affecting the ranking of metrics.</p>
      <p>These data sets have different features, shown in <xref ref-type="supplementary-material" rid="pcbi.1007419.s009">S2 Table</xref>. MouseFunc is the largest with 45,035 direct gene–GO annotations over 1634 genes. After propagation to ancestors, this expands to 291,627 GO annotations, composed of 13,691 unique GO terms. This gives a matrix with 1.42% of cells containing annotations. The CAFA data set had the smallest number of genes, with 7,092 direct gene–GO annotations over only 698 genes. After propagation, there are 61,470 GO annotations, mapping to 6,414 unique GO terms. This gives a matrix with 1.1% of cells containing annotations. The Uniprot data had the smallest number annotations, with 5,138 GO annotations over 1000 genes. These gave 46,884 annotations to 5,138 classes after propagation with 0.9% of cells in the resulting matrix containing annotations. All three data sets are intentionally small, as this is a frequent challenge in AFP evaluation. Furthermore, the number of annotations is skewed across both genes and GO terms in all data sets (see <xref ref-type="supplementary-material" rid="pcbi.1007419.s009">S2 Table</xref>).</p>
      <p>We tested all metrics with three values of <italic>k</italic> (semantic neighbourhood size): <italic>k</italic> = 2, 3, 4. <italic>RC</italic> and <italic>FPS</italic> scores for these runs are listed in <xref ref-type="supplementary-material" rid="pcbi.1007419.s011">S4 Table</xref> (<italic>k</italic> = 2), <xref ref-type="supplementary-material" rid="pcbi.1007419.s012">S5 Table</xref> (<italic>k</italic> = 4) and <xref ref-type="supplementary-material" rid="pcbi.1007419.s013">S6 Table</xref> (<italic>k</italic> = 3). We also tested <italic>th</italic><sub><italic>noise</italic></sub> = 0.8 with <italic>k</italic> = 3. Metric scores for all AP and FP sets are available in <xref ref-type="supplementary-material" rid="pcbi.1007419.s005">S1</xref>, <xref ref-type="supplementary-material" rid="pcbi.1007419.s006">S2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007419.s007">S3</xref> Files.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec014">
    <title>Results</title>
    <p>First, we investigate the stability of results across parameter settings. Second, we show differences within groups of EvMs with the CAFA data set. We then highlight differences between data sets and identify the best performing methods overall. All results were generated using scripts available from our web page (<ext-link ext-link-type="uri" xlink:href="http://ekhidna2.biocenter.helsinki.fi/ADS/">http://ekhidna2.biocenter.helsinki.fi/ADS/</ext-link>).</p>
    <sec id="sec015">
      <title>Stability of ADS results</title>
      <p>ADS data generation includes two main parameters: the size of the accepted neighbourhood, <italic>k</italic>, while shifting to semantic neighbours and a threshold for accepting noise classes, <italic>th</italic><sub><italic>jacc</italic></sub>. Here we show that results are stable as these values vary. We first compared the results with <italic>k</italic> = 2, 3, 4. We set <italic>th</italic><sub><italic>jacc</italic></sub> = 0.2. We created ADS and FP results with each value of <italic>k</italic> and calculated the Pearson and rank correlations of the results for k = 2 vs. 3 and 2 vs. 4. As these were already highly correlated, it was unnecessary to proceed any further. Analysis was done separately on RC and FP results and repeated on each tested data set.</p>
      <p>The results, shown with sub-table A in <xref ref-type="supplementary-material" rid="pcbi.1007419.s010">S3 Table</xref>, show that variations appear insignificant. The Pearson correlation ranges between 0.9944 and 0.9999. Similarly, rank correlation ranges between 0.9935 and 1. This suggests that results are stable against small variations in <italic>k</italic>. We selected results with <italic>k</italic> = 3 for all further analyses.</p>
      <p>We also tested the effect of Jaccard threshold, <italic>th</italic><sub><italic>jacc</italic></sub>, in our noise model. We compared our standard value <italic>th</italic><sub><italic>jacc</italic></sub> = 0.2 to <italic>th</italic><sub><italic>jacc</italic></sub> = 0.8. We performed a similar evaluation as with values of <italic>k</italic> (see sub-table B in <xref ref-type="supplementary-material" rid="pcbi.1007419.s010">S3 Table</xref>). The minimum and maximum Pearson correlation was 0.9991 and 0.9999, respectively, and the minimum and maximum rank correlation was 0.9945 and 0.9997, suggesting that our results are stable against <italic>th</italic><sub><italic>jacc</italic></sub></p>
    </sec>
    <sec id="sec016">
      <title>ADS identifies differences between evaluation metrics</title>
      <p>We compared the following evaluation metrics: US AUC-ROC, <italic>F</italic><sub><italic>max</italic></sub>, <italic>S</italic><sub><italic>min</italic></sub> (referred as <italic>S</italic><sub><italic>min</italic>2</sub> in figure), Resnik with summary method D and A, and Lin with summary method D to see if ADS can find performance differences. Visualisations for these metrics are shown in <xref ref-type="fig" rid="pcbi.1007419.g004">Fig 4</xref> (for exact values see <xref ref-type="supplementary-material" rid="pcbi.1007419.s013">S6 Table</xref>).</p>
      <fig id="pcbi.1007419.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007419.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Six popular evaluation metrics compared with ADS.</title>
          <p>Visual analysis of ADS results for six evaluation metrics: US AUC-ROC, <italic>F</italic><sub><italic>max</italic></sub>, <italic>S</italic><sub><italic>min</italic>2</sub>, Resnik score A and D, and Lin score D, obtained with CAFA data. Scores for AP sets at each ADS signal level are shown as boxplots and scores for FP sets as horizontal lines. <italic>RC</italic> value shows rank correlation of the AP sets with ADS signals and <italic>FPS</italic> shows the highest signal from FP sets. <italic>RC</italic> should be high and <italic>FPS</italic> should be low. Note the drastic differences between methods. We discuss these in the main text. We flipped the sign of <italic>S</italic><sub><italic>min</italic></sub> results for consistency. ADS signal is plotted on the <italic>x</italic>-axis and the evaluation metric, shown in headings, is plotted on the <italic>y</italic>-axis. Horizontal lines for FP sets are: Naive = red line, All Positive = blue line and Random = Green line.</p>
        </caption>
        <graphic xlink:href="pcbi.1007419.g004"/>
      </fig>
      <p>Results with CAFA data show drastic differences between evaluation metrics. We see a clear separation across ADS signal levels in the boxplots for <italic>F</italic><sub><italic>max</italic></sub> (<italic>RC</italic> = 0.982) and <italic>S</italic><sub><italic>min</italic></sub> (<italic>RC</italic> = 0.985), and next best separation is for US AUC-ROC. Three of the semantic similarity measures performed poorly: they have unstable distributions in the obtained RC scores. Resnik in particular, is shown to have the worst separation (<italic>RC</italic> = 0.808 and 0.811 for summary A and D, respectively). Our results show that it is impossible to infer the original signal levels using these particular semantic similarity measures.</p>
      <p>It could be argued that comparing random data and data with a strong signal should be sufficient for metric evaluation. Our results, however, show that in most plots the first (<italic>signal</italic> = 1) and last (<italic>signal</italic> = 0) boxplots do not fully reveal how good the evaluation metric is. For Lin score and Resnik score, for example, two extreme boxplots might be acceptable, assuming clear separation. However, the intermediate levels reveal considerable variability.</p>
      <p>With FP sets visualised with horizontal lines, we see different methods failing. Now AUC-ROC has the worst performance as it ranks the FP sets as equally good as <italic>signal</italic> = 1. Note, that FP sets do not convey any real annotation information, but represent biases related to the GO structure. Altogether, only Resnik with method A has excellent performance with the FP signal and only <italic>S</italic><sub><italic>min</italic></sub> has good performance in both tests. These results demonstrate that neither ADS nor FP sets are sufficient to expose all weaknesses in isolation. They clearly show orthogonal views on the evaluated methods, both of which are important.</p>
    </sec>
    <sec id="sec017">
      <title>ADS confirms known flaws in AUC-ROC</title>
      <p>Here we focus on the performance of AUC methods, using area under receiver operating characteristic curve (AUC-ROC) and area under precision-recall curve (AUC-PR) with the CAFA data set. AUC-ROC has been used extensively in AFP evaluation, whereas AUC-PR has not. We look at the unstructured (US), gene centric (GC) and term centric (TC) versions of both AUC methods.</p>
      <p>AUC-ROC has been criticised for being a noisy evaluation metric with sensitivity to sample size and class imbalance [<xref rid="pcbi.1007419.ref008" ref-type="bibr">8</xref>, <xref rid="pcbi.1007419.ref025" ref-type="bibr">25</xref>]. ADS demonstrates that AUC-ROC metrics correlate reasonably well with signal level, but fail with FP sets (<xref ref-type="fig" rid="pcbi.1007419.g005">Fig 5</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007419.s013">S6 Table</xref>). These results are expected, as FP sets monitor sensitivity to class imbalance. Surprisingly, two of our of three AUC-ROC methods rank the FP sets as good as <italic>signal</italic> = 1 (<xref ref-type="fig" rid="pcbi.1007419.g005">Fig 5</xref>, top row). This means that near-perfect prediction results could not be distinguished from false positives using this metric.</p>
      <fig id="pcbi.1007419.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007419.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>AUC metrics compared using ADS.</title>
          <p>We compared standard AUC (AUC-ROC) and AUC for precision-recall curve (AUC-PR) with CAFA dataset. We test unstructured (US), gene centric (GC) and term centric (TC) versions. US AUC-ROC and GC AUC-ROC exhibited exceptionally poor performance with the FP sets. TC AUC-PR showed good performance with both ADS and FP sets. <italic>RC</italic> and <italic>FPS</italic> are explained in previous figure text. ADS signal is plotted on the <italic>x</italic>-axis and the evaluation metric, shown in headings, is plotted on the <italic>y</italic>-axis.</p>
        </caption>
        <graphic xlink:href="pcbi.1007419.g005"/>
      </fig>
      <p>The poor FP set performance of some AUC metrics is caused by the identical treatment of small and large GO classes in US and GC analysis. However, a positive result for a large class is more probable from a random data set. This is worsened by the extreme class size differences in GO. This problem was corrected in the MouseFunc competition [<xref rid="pcbi.1007419.ref004" ref-type="bibr">4</xref>] by dividing GO classes to subsets based on class sizes and in CAFA 2 [<xref rid="pcbi.1007419.ref003" ref-type="bibr">3</xref>] by analysing each GO term separately, as in TC AUC-ROC. Indeed, the TC analysis displayed in the last column performs well with the FP sets. This is replicated across all data sets.</p>
      <p>When AUC-ROC and AUC-PR are compared, while we see that FP sets have a weaker signal with US AUC-PR and GC AUC-PR, the problem persists. In the correlation scores, however, AUC-PR metrics consistently outperform AUC-ROC metrics. The difference between AUC-ROC and AUC-PR might be explained by the definition of AUC-ROC (see supplementary <xref ref-type="supplementary-material" rid="pcbi.1007419.s004">S2 Text</xref>). Since TC AUC-PR assigns low scores to FP sets and achieves high correlation, it is our recommended method with TC AUC-ROC in second place. Furthermore, these results argue strongly against the usage of US and GC versions of AUC metrics.</p>
    </sec>
    <sec id="sec018">
      <title>ADS reveals drastic differences between semantic summation methods</title>
      <p>We compared the following GO semantic similarities: Resnik, Lin and Ancestor Jaccard (AJacc), each coupled with six different semantic summation methods, A-F (see <xref ref-type="sec" rid="sec002">Methods</xref>). The results are shown in <xref ref-type="fig" rid="pcbi.1007419.g006">Fig 6</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007419.s013">S6 Table</xref>. <xref ref-type="fig" rid="pcbi.1007419.g006">Fig 6</xref> is organised so that the columns contain the compared semantic similarities and rows contain the summation methods. Ideally, we want a combination that delivers good separation in boxplots and ranks FP sets next to AP sets with <italic>signal</italic> = 0.</p>
      <fig id="pcbi.1007419.g006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007419.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>Semantic similarities with different summation methods.</title>
          <p>We present every combination of three semantic similarity-based methods (Resnik, Lin, AJacc) in columns and six semantic summation methods (A-F, see <xref ref-type="sec" rid="sec002">Methods</xref>) in rows. We show again the results for CAFA dataset. The summation methods have a bigger impact on performance than the actual metric. The novel summation methods, E and F, outperform the previous standards, A and D. ADS signal is plotted on the <italic>x</italic>-axis and the evaluation metric combined with a given summation method is plotted on the <italic>y</italic>-axis.</p>
        </caption>
        <graphic xlink:href="pcbi.1007419.g006"/>
      </fig>
      <p>This comparison shows the power of ADS. Our first observation is that the choice of summation method has a bigger impact than which semantic measure is used. Methods A and C fail at separating signal levels in ADS and methods B and D fail at ranking FP sets next to the <italic>signal</italic> = 0. The only methods that perform well in both ADS and FP tests are E and F. Furthermore, the intentionally flawed methods, B and C, were found to be weak by either ADS or FP tests.</p>
      <p>Our second observation is that Lin similarities exhibit marginally better performance than the other metrics tested, as shown in RC values. While these results might suggest that Lin similarity summarised with methods E or F performs the best, this is dependent on data set (see below).</p>
    </sec>
    <sec id="sec019">
      <title>S<sub>min</sub> and SimGIC have similar good performance</title>
      <p>The third group of metrics we tested were methods that score sets of predicted GO terms. Some methods, like SimGIC and SimUI [<xref rid="pcbi.1007419.ref019" ref-type="bibr">19</xref>], calculate the Jaccard correlation between predictions and the ground truth, whereas <italic>S</italic><sub><italic>min</italic></sub> calculates a distance between them [<xref rid="pcbi.1007419.ref026" ref-type="bibr">26</xref>]. Most of these metrics include Information Content (IC) weights [<xref rid="pcbi.1007419.ref019" ref-type="bibr">19</xref>] in their function. We have two alternatives for IC, but limit the results here to IC weights proposed in the <italic>S</italic><sub><italic>min</italic></sub> article [<xref rid="pcbi.1007419.ref026" ref-type="bibr">26</xref>] (details on two versions of information content, <italic>ic</italic> and <italic>ic</italic>2, are discussed in the <xref ref-type="supplementary-material" rid="pcbi.1007419.s004">S2 Text</xref>). We still show results for both <italic>ic</italic> and <italic>ic</italic>2 in later analyses. We further include gene centric and unstructured versions of the following functions:</p>
      <list list-type="simple">
        <list-item>
          <label>SimGIC</label>
          <p>Gene centric original version (weighted Jaccard)</p>
        </list-item>
        <list-item>
          <label>SimGIC2</label>
          <p>Unstructured modified version of SimGIC</p>
        </list-item>
        <list-item>
          <label>S<sub>min1</sub></label>
          <p><italic>S</italic><sub><italic>min</italic></sub> original version</p>
        </list-item>
        <list-item>
          <label>S<sub>min2</sub></label>
          <p>Gene centric version of <italic>S</italic><sub><italic>min</italic></sub></p>
        </list-item>
        <list-item>
          <label>GC Jacc</label>
          <p>Gene centric unweighted Jaccard (original SimUI)</p>
        </list-item>
        <list-item>
          <label>US Jacc</label>
          <p>Unstructured version of SimUI (unstructured Jaccard)</p>
        </list-item>
      </list>
      <p>The results are shown in <xref ref-type="fig" rid="pcbi.1007419.g007">Fig 7</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007419.s013">S6 Table</xref>. Both <italic>S</italic><sub><italic>min</italic></sub> and SimGIC show very high correlation with the ADS signal level. However, in FP tests, SimGIC has better performance. Also, US Jacc shows quite good performance, but GC Jacc is weaker. Introducing gene centric terms in <italic>S</italic><sub><italic>min</italic>2</sub> resulted in a notable increase in FP scores in all three data sets. SimGIC2, our unstructured version of SimGIC, showed a minor improvement in correlation with all three data sets. Overall, the unstructured versions (<italic>S</italic><sub><italic>min</italic>1</sub>, SimGIC2 and US Jacc) outperformed the gene centric versions (<italic>S</italic><sub><italic>min</italic>2</sub>, SimGIC, GC Jacc) in correlation values, FP tests or both. Performance of <italic>S</italic><sub><italic>min</italic></sub> and SimGIC metrics across different data sets was surprisingly similar. Our recommendation is to use <italic>S</italic><sub><italic>min</italic>1</sub> or SimGIC2. Alternatively, one can use US Jacc, despite weaker performance than <italic>S</italic><sub><italic>min</italic></sub> and SimGIC2, when a simpler function is required.</p>
      <fig id="pcbi.1007419.g007" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007419.g007</object-id>
        <label>Fig 7</label>
        <caption>
          <title>S<sub>min</sub> and SimGIC metrics.</title>
          <p>We compared two versions of <italic>S</italic><sub><italic>min</italic></sub>, SimGIC and Jaccard each with Uniprot data. Performance was similar with all metrics, with the exception of GC Jacc which had a weaker correlation. <italic>S</italic><sub><italic>min</italic>1</sub> and SimGIC2 are slightly better methods. ADS signal is plotted on the <italic>x</italic>-axis and the evaluation metric, shown in headings, is plotted on the <italic>y</italic>-axis. We flipped the sign of the <italic>S</italic><sub><italic>min</italic></sub> metrics for consistency.</p>
        </caption>
        <graphic xlink:href="pcbi.1007419.g007"/>
      </fig>
    </sec>
    <sec id="sec020">
      <title>Metric performance varies between data sets</title>
      <p>We wanted to compare all the discussed evaluation metrics to see which of them performed best overall. We plotted <italic>RC</italic> against <italic>FPS</italic> for all metrics tested on the CAFA data set (see <xref ref-type="fig" rid="pcbi.1007419.g008">Fig 8</xref>). High quality metrics appear in the upper left corner of the plot. Metrics that fail with FP tests appear in the right side of the plot. Metrics failing in ADS correlation will be lower in the plot.</p>
      <fig id="pcbi.1007419.g008" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007419.g008</object-id>
        <label>Fig 8</label>
        <caption>
          <title>Top metrics for CAFA data set.</title>
          <p>Metrics are shown with different colours. <italic>F</italic><sub><italic>max</italic></sub> is black, AUC-ROC and AUC-PR are in red, Jacc, <italic>S</italic><sub><italic>min</italic></sub> and SimGIC are in green and semantic similarity metrics are in blue. Colours are varied between different metrics in the same group. The figure uses the following abbreviations: AJ = AJacc, F = <italic>F</italic><sub><italic>max</italic></sub>, G = SimGIC, J = Jacc, L = Lin, PR = AUC-PR, R = Resnik, ROC = AUC-ROC and Sm = <italic>S</italic><sub><italic>min</italic></sub>. Abbreviations are combined with summation or data structuring method. For example, Resnik F is R-F, Lin A is L-A, TC AUCROC is TC-ROC, ic2 SimGIC is ic2-G and ic <italic>S</italic><sub><italic>min</italic></sub> is ic-S. High quality metrics appear in the upper left corner (high correlation and low False Positive Signal). This clustered part is zoomed in the lower panel for clarity.</p>
        </caption>
        <graphic xlink:href="pcbi.1007419.g008"/>
      </fig>
      <p>The upper panel in <xref ref-type="fig" rid="pcbi.1007419.g008">Fig 8</xref> shows big differences in performance. The semantic similarity metrics (shown in blue) show drastic scatter on the <italic>y</italic>-axis and AUC metrics (red) show drastic scatter on the <italic>x</italic>-axis, in agreement with results from earlier sections. Clearly, usage of unstructured and gene centric Area Under Curve methods (GC AUC-ROC, US AUC-ROC, US AUC-PR, GC AUC-PR) and semantic similarities based on signal summation methods A, B, C and D cannot be recommended. The metrics with the best performance (lower panel in <xref ref-type="fig" rid="pcbi.1007419.g008">Fig 8</xref>) are Lin E, Lin F, TC AUCPR, two versions of SimGIC2 and <italic>S</italic><sub><italic>min</italic>2</sub>.</p>
      <p>When we repeated the same analysis with the other two data sets, the rankings are different. We show only the best-scoring metrics in <xref ref-type="fig" rid="pcbi.1007419.g009">Fig 9</xref> for MouseFunc and Uniprot. The performance of all metrics is shown in <xref ref-type="supplementary-material" rid="pcbi.1007419.s001">S1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007419.s002">S2</xref> Figs. In MouseFunc, the best performing group is the SimGIC—<italic>S</italic><sub><italic>min</italic></sub> methods with <italic>S</italic><sub><italic>min</italic>2</sub> as the best method. Lin E and Lin F are also among the top performers. TC AUC-PR, one of previous best performers, has weaker performance. <italic>S</italic><sub><italic>min</italic></sub> improved its performance, while TC AUC-PR got weaker. The Uniprot data set had differing results as well, with TC AUC-PR, Resnik E, Resnik F and TC AUC-ROC showing the best performance. The biggest drop among the top performing metrics is with Lin semantics (Lin E and Lin F).</p>
      <fig id="pcbi.1007419.g009" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007419.g009</object-id>
        <label>Fig 9</label>
        <caption>
          <title>Top metrics for MouseFunc (top panel) and Uniprot (lower panel) data sets.</title>
          <p>Here we repeat the lower plot from <xref ref-type="fig" rid="pcbi.1007419.g008">Fig 8</xref> on the other two data sets. The performance of individual EvMs varies between data sets. Colouring and labels are explained in <xref ref-type="fig" rid="pcbi.1007419.g007">Fig 7</xref>.</p>
        </caption>
        <graphic xlink:href="pcbi.1007419.g009"/>
      </fig>
      <p>Semantic similarities had surprising behaviour in these experiments. Lin similarity (with methods E and F) was clearly the best performing semantic similarity-based metric in CAFA and MouseFunc, with Resnik as the weakest. However, on Uniprot data, Resnik improves its performance, making it the best semantic similarity method, while Lin’s performance drops significantly. We are unable to explain these differences.</p>
      <p>Another surprising finding is that we see higher FP signals for TC AUC-PR than expected, particularly in the MouseFunc data. As term centric analysis evaluates each GO class separately, it should be insensitive to biases created by favouring larger or smaller GO classes. We will explain this in the next section.</p>
      <p>Note that these data sets differed from each other in size and density, with Uniprot being the smallest and sparsest data set, CAFA being intermediate and MouseFunc data being the largest and densest data set. We see the following tendencies in the results: a) Lin semantic performs well until the size and sparsity of the Uniprot data is reached, b) term centric AUC-ROC and AUC-PR perform well except with denser and larger mouse data and c) simGIC methods appear to perform consistently. Elucidating the exact reasons for these performance differences would require further studies. Altogether, this suggests that selecting the best evaluation metric is data-dependent, showing the necessity of ADS-style tests.</p>
    </sec>
    <sec id="sec021">
      <title>Selecting overall best evaluation metrics</title>
      <p>Results above showed variation in the ordering of metrics across the datasets. Still, it is important to see if we can select for AFP method comparisons metrics with best overall performance. Therefore, we collected the results of top performing metrics for each data set into <xref rid="pcbi.1007419.t001" ref-type="table">Table 1</xref>, showing RC (Rank Correlation) and FPS (False Positive Set) values. In addition, we show the same results for popular methods with weaker performance. Again, a good metric should have high RC values and low FP values. Therefore, we show the five highest scores in RC tests in each column with bold and five lowest scores in underlined italics. In FP tests, we similarly show five lowest scores in bold and five highest scores in underlined italics. Excellent metrics should have bold numbers and no italics.</p>
      <table-wrap id="pcbi.1007419.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007419.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Summary of results for best performing and widely-used metrics.</title>
          <p>Here we show RC (Rank Correlation) and FP (False Positive) results for the best performing methods. We also show same results for some widely-used metrics. Good metrics should have a high RC score and low FP scores. Rec column shows our selected recommendations (See text for details). The five best results in each column are shown in bold. The five weakest results in each column are shown with underlined italics. Metrics that fail a given test are highlighted in red (see text for details). Note how methods in lower block show consistent weak performance either in RC or FP tests.</p>
        </caption>
        <alternatives>
          <graphic id="pcbi.1007419.t001g" xlink:href="pcbi.1007419.t001"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" colspan="9" rowspan="1">Top performing metrics</th>
              </tr>
              <tr>
                <th align="left" rowspan="2" colspan="1"/>
                <th align="center" colspan="3" rowspan="1">Rank correlation results</th>
                <th align="center" colspan="3" rowspan="1">False Positive Sets</th>
                <th align="left" colspan="2" rowspan="1"/>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1">UniProt</th>
                <th align="center" rowspan="1" colspan="1">CAFA</th>
                <th align="center" rowspan="1" colspan="1">Mouse</th>
                <th align="center" rowspan="1" colspan="1">UniProt</th>
                <th align="center" rowspan="1" colspan="1">CAFA</th>
                <th align="center" rowspan="1" colspan="1">Mouse</th>
                <th align="left" rowspan="1" colspan="1">rec</th>
                <th align="left" rowspan="1" colspan="1">weakness</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">TC AUCROC</td>
                <td align="char" char="." rowspan="1" colspan="1">0.959</td>
                <td align="char" char="." rowspan="1" colspan="1">0.951</td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">
                  <underline>
                    <italic toggle="yes">0.920</italic>
                  </underline>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.023</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.010</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.000</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">(*)</td>
                <td align="left" rowspan="1" colspan="1">RC in mouse data</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">TC AUCPR</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.984</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.982</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.971</td>
                <td align="char" char="." rowspan="1" colspan="1">0.144</td>
                <td align="char" char="." rowspan="1" colspan="1">0.156</td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">
                  <underline>
                    <italic toggle="yes">0.312</italic>
                  </underline>
                </td>
                <td align="left" rowspan="1" colspan="1">(*)</td>
                <td align="left" rowspan="1" colspan="1">FPS in mouse data</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ic SimGIC</td>
                <td align="char" char="." rowspan="1" colspan="1">0.960</td>
                <td align="char" char="." rowspan="1" colspan="1">0.963</td>
                <td align="char" char="." rowspan="1" colspan="1">0.969</td>
                <td align="char" char="." rowspan="1" colspan="1">0.168</td>
                <td align="char" char="." rowspan="1" colspan="1">0.164</td>
                <td align="char" char="." rowspan="1" colspan="1">0.108</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ic SimGIC2</td>
                <td align="char" char="." rowspan="1" colspan="1">0.970</td>
                <td align="char" char="." rowspan="1" colspan="1">0.969</td>
                <td align="char" char="." rowspan="1" colspan="1">0.965</td>
                <td align="char" char="." rowspan="1" colspan="1">0.166</td>
                <td align="char" char="." rowspan="1" colspan="1">0.133</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.056</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">(*)</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ic2 SimGIC2</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.979</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.978</td>
                <td align="char" char="." rowspan="1" colspan="1">0.974</td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">0.190</td>
                <td align="char" char="." rowspan="1" colspan="1">0.156</td>
                <td align="char" char="." rowspan="1" colspan="1">0.065</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Resnik E</td>
                <td align="char" char="." rowspan="1" colspan="1">0.966</td>
                <td align="char" char="." rowspan="1" colspan="1">0.959</td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">0.945</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.034</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.064</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.065</td>
                <td align="left" rowspan="1" colspan="1">(*)</td>
                <td align="left" rowspan="1" colspan="1">RC in mouse data</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Lin E</td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">0.939</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.983</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.982</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.112</td>
                <td align="char" char="." rowspan="1" colspan="1">0.118</td>
                <td align="char" char="." rowspan="1" colspan="1">0.080</td>
                <td align="left" rowspan="1" colspan="1">(*)</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Lin F</td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">
                  <underline>
                    <italic toggle="yes">0.856</italic>
                  </underline>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.979</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.978</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.096</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.100</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.058</bold>
                </td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">very weak RC in Uniprot</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">AJacc E</td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">
                  <underline>
                    <italic toggle="yes">0.886</italic>
                  </underline>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.960</td>
                <td align="char" char="." rowspan="1" colspan="1">0.959</td>
                <td align="char" char="." rowspan="1" colspan="1">0.097</td>
                <td align="char" char="." rowspan="1" colspan="1">0.127</td>
                <td align="char" char="." rowspan="1" colspan="1">0.073</td>
                <td align="left" rowspan="1" colspan="1">(*)</td>
                <td align="left" rowspan="1" colspan="1">very weak RC in Uniprot</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ic2 <italic>S</italic><sub><italic>min</italic>1</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.986</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.985</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.983</bold>
                </td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">0.247</td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">0.221</td>
                <td align="char" char="." rowspan="1" colspan="1">0.124</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Slightly weak in FPS</td>
              </tr>
              <tr>
                <td align="center" colspan="9" rowspan="1">Previously used metrics with weaker performance</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>F</italic>
                  <sub>
                    <italic>max</italic>
                  </sub>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.983</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.982</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.981</bold>
                </td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">0.367</td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">0.318</td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">0.229</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">weak in FPS tests</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">US AUCPR</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.985</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.983</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.977</bold>
                </td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">
                  <underline>
                    <italic toggle="yes">0.453</italic>
                  </underline>
                </td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">
                  <underline>
                    <italic toggle="yes">0.388</italic>
                  </underline>
                </td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">0.292</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">weak in FPS tests</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">US AUCROC</td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">0.945</td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">
                  <underline>
                    <italic toggle="yes">0.932</italic>
                  </underline>
                </td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">
                  <underline>
                    <italic toggle="yes">0.901</italic>
                  </underline>
                </td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">
                  <underline>
                    <italic toggle="yes">1.000</italic>
                  </underline>
                </td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">
                  <underline>
                    <italic toggle="yes">1.000</italic>
                  </underline>
                </td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">
                  <underline>
                    <italic toggle="yes">0.878</italic>
                  </underline>
                </td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">worst metrics in FPS tests</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">GC AUCROC</td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">0.947</td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">0.937</td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">0.921</td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">
                  <underline>
                    <italic toggle="yes">1.000</italic>
                  </underline>
                </td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">
                  <underline>
                    <italic toggle="yes">1.000</italic>
                  </underline>
                </td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">
                  <underline>
                    <italic toggle="yes">0.879</italic>
                  </underline>
                </td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">worst metrics in FPS tests</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Resnik A</td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">0.922</td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">
                  <underline>
                    <italic toggle="yes">0.808</italic>
                  </underline>
                </td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">
                  <underline>
                    <italic toggle="yes">0.772</italic>
                  </underline>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.000</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.000</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.000</bold>
                </td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">weak in RC tests</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Resnik D</td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">
                  <underline>
                    <italic toggle="yes">0.892</italic>
                  </underline>
                </td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">
                  <underline>
                    <italic toggle="yes">0.811</italic>
                  </underline>
                </td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">
                  <underline>
                    <italic toggle="yes">0.801</italic>
                  </underline>
                </td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">
                  <underline>
                    <italic toggle="yes">0.428</italic>
                  </underline>
                </td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">
                  <underline>
                    <italic toggle="yes">0.333</italic>
                  </underline>
                </td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">
                  <underline>
                    <italic toggle="yes">0.339</italic>
                  </underline>
                </td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">weak in all tests</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Lin A</td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">
                  <underline>
                    <italic toggle="yes">0.758</italic>
                  </underline>
                </td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">
                  <underline>
                    <italic toggle="yes">0.840</italic>
                  </underline>
                </td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">
                  <underline>
                    <italic toggle="yes">0.880</italic>
                  </underline>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.000</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.000</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.000</bold>
                </td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">worst metrics in RC test</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Lin D</td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">
                  <underline>
                    <italic toggle="yes">0.806</italic>
                  </underline>
                </td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">
                  <underline>
                    <italic toggle="yes">0.926</italic>
                  </underline>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.970</td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">
                  <underline>
                    <italic toggle="yes">0.466</italic>
                  </underline>
                </td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">
                  <underline>
                    <italic toggle="yes">0.425</italic>
                  </underline>
                </td>
                <td align="char" char="." style="background-color:#FFC6CE" rowspan="1" colspan="1">
                  <underline>
                    <italic toggle="yes">0.364</italic>
                  </underline>
                </td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">weak in all tests</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>Furthermore, we wanted to highlight the consistent high performance of metrics by setting a threshold on <italic>RC</italic>, <italic>t</italic><sub><italic>RC</italic></sub>, and threshold on <italic>FPS</italic>, <italic>t</italic><sub><italic>FPS</italic></sub>, and requiring that <italic>RC</italic> &gt; <italic>t</italic><sub><italic>RC</italic></sub> and <italic>FPS</italic> &lt; <italic>t</italic><sub><italic>FPS</italic></sub>. We highlight the failures of these tests in <xref rid="pcbi.1007419.t001" ref-type="table">Table 1</xref> in red. For RC values, we observed that the top performing metrics would be selected with threshold <italic>t</italic><sub><italic>RC</italic></sub> = [0.94, 0.98] and therefore set <italic>t</italic><sub><italic>RC</italic></sub> = 0.95. For FP values, we found that the top performing metrics would be selected with <italic>t</italic><sub><italic>FPS</italic></sub> = [0.10, 0.25] and set <italic>t</italic><sub><italic>FPS</italic></sub> = 0.16. There is a trade-off when setting these thresholds, as different values can emphasise either RC or FPS. However, both tests should be monitored for metric selection. In conclusion, a good metric should have as little red shading as possible and high performance in both RC and FP tests. Our supplementary table <xref ref-type="supplementary-material" rid="pcbi.1007419.s013">S6 Table</xref> shows these results for all the tested metrics. We selected the best performing metrics from supplementary table to the upper portion of <xref rid="pcbi.1007419.t001" ref-type="table">Table 1</xref>.</p>
      <sec id="sec022">
        <title>Top performing metrics</title>
        <p>The upper part of <xref rid="pcbi.1007419.t001" ref-type="table">Table 1</xref> shows metrics with encouraging performance. We first identify metrics that show good performance in a majority of tests. TC AUC-PR shows good performance with the highest ranking RC values. Its FP values are around 1.5, except for MouseFunc data, where its FP result is ∼0.3. Therefore, we mark it only as a potential recommended method. TC AUC-ROC shows very good performance in FP results. However, its RC results are weaker and its RC result from mouse data is far lower. Still, it is a potential recommendation. Lin score with method E shows the most consistent high performance among the Lin and AJacc semantics in the upper block. Differences are seen in RC values. However, Lin E fails in RC test on the Uniprot data set. Therefore, we mark it also as a potential recommendation. Resnik semantic shows different behaviour than Lin and AJacc in these results. Still, it also fails the RC test with MouseFunc data. All these recommended metrics showed good performance in all but one test.</p>
        <p>Finally, ic SimGIC and ic SimGIC2 shows quite good performance across the tests, with ic SimGIC2 often outperforming ic SimGIC. We mark also ic2 SimGIC2 as a potential recommended method, although it fails in FP test with UniProt data. Note that ic2 SimGIC2 goes only slightly over the selected threshold (0.18) and in other data sets it stays below <italic>t</italic><sub><italic>FPS</italic></sub>. However, ic SimGIC2 mostly outperforms other tested SimGIC functions. Overall, based on these results, ic SimGIC2 is our strongest overall recommendation.</p>
        <p>We are surprised to see that the ic2 <italic>S</italic><sub><italic>min</italic>1</sub> [<xref rid="pcbi.1007419.ref024" ref-type="bibr">24</xref>] has an elevated FP signal, despite using <italic>ic</italic> weights to emphasise small GO classes. However, we still point out that FP results for <italic>S</italic><sub><italic>min</italic></sub> are not bad, except for Uniprot data, and it has the strongest RC results in the table. Indeed, <italic>S</italic><sub><italic>min</italic></sub> was one of the best performing metrics for MouseFunc data. Therefore, we included it in our potential recommendations.</p>
        <p>We were also surprised by FP signals with TC AUC-PR, as term centric analysis should be insensitive to FP signal. This is explained by our calculation method for AUC-PR. Even when there is no variance among prediction scores across all the genes, we allow precision-recall curve to return a single point when calculating the area. While this is in agreement with how to calculate AUC-PR [<xref rid="pcbi.1007419.ref027" ref-type="bibr">27</xref>], it can generate a non-zero result that can bias our analysis in some data sets. This can be corrected by setting AUC-PR = 0 when the range of prediction scores across all the analysed data points is zero. Note that predictions in this case do not contain any information, making the AUC-PR = 0 reasonable. So here our analysis proposes simple improvement to TC AUC-PR that would potentially make it a top performing metric.</p>
        <p>In conclusion, our results suggest that ic SimGIC2 as the most stable, well-performing metric, despite being beaten by other potential recommendations (TC AUC-PR, TC AUC-ROC, Lin E, Resnik E and <italic>S</italic><sub><italic>min</italic></sub>) with some data sets.</p>
      </sec>
      <sec id="sec023">
        <title>Issues with some widely-used metrics</title>
        <p>Metrics in the lower part of <xref rid="pcbi.1007419.t001" ref-type="table">Table 1</xref> show poor performance. All these metrics have been used in AFP research, and some of these metrics have been widely-used. The popular <italic>F</italic><sub><italic>max</italic></sub> and US AUC-PR show high FP values. Although <italic>F</italic><sub><italic>max</italic></sub> is preferred for its simplicity, our results show that even the simple US Jacc performs better, as it shows similar RC values but has roughly 30% lower FP scores (values: 0.273, 0.184, 0.073 shown in <xref ref-type="supplementary-material" rid="pcbi.1007419.s013">S6 Table</xref>). Furthermore, the weighted Jaccard metrics (SimGIC and SimGIC2) correct FP error even further. US AUC-PR shows even worse FP results. Still, TC AUC-PR would correct this problem while maintaining almost the same level of RC values. Similar results are seen with AUC-ROC methods. GC and US versions of AUC-ROC should be avoided, as they are consistently the worst performing methods in our FP tests. Again, the TC AUC-ROC corrects this bias. Finally, the results for semantic similarities in the lower block are very weak, often with the weakest RC scores in the table.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec024">
    <title>Discussion</title>
    <p>GO classifiers and other methods for automated annotation of novel sequences play an important role in the biosciences. It is therefore important to assess the quality of the predictions that they make. Evaluation depends heavily on the metrics used as they define how methods will be ultimately ranked. However, little research has been done on the evaluation metrics themselves, despite their impact in shaping the field.</p>
    <p>Artificial Dilution Series (ADS) is a novel method to systematically assess how reliably different evaluation metrics cope with assessing GO classifiers. ADS is a valuable new tool for developing and complementing the existing evaluation methodology. Using ADS we have revealed drastic differences between popular evaluation metrics and metrics that give inflated scores to false positive annotations.</p>
    <p>We demonstrate ADS by testing a large number of evaluation metrics including many variations. We were able to show that:</p>
    <list list-type="bullet">
      <list-item>
        <p>One should only use term centric AUC-ROC and AUC-PR methods and avoid their gene centric and unstructured versions.</p>
      </list-item>
      <list-item>
        <p>Our novel summary methods, E and F, both outperform existing semantic similarity summary methods.</p>
      </list-item>
      <list-item>
        <p>The simGIC metric shows consistently high performance across all data sets.</p>
      </list-item>
    </list>
    <p specific-use="continuation">Other well performing metrics, besides simGIC2, were TC AUC-PR, TC AUC-ROC, Lin score with method E and Resnik score with method E. These even outperformed ic simGIC2 on some data sets, which suggests that the selection of the best evaluation metric is data-dependent. Note that our analysis scripts and ADS are freely available, allowing testing with any GO data set.</p>
    <p>One motivation for the ADS project is the development of better evaluation metrics for GO classifier comparisons. We tested, for example, the following variations on existing metrics:</p>
    <list list-type="order">
      <list-item>
        <p>We modified the summary methods for semantic similarities.</p>
      </list-item>
      <list-item>
        <p>We tested Area Under Precision Recall curve (AUC-PR).</p>
      </list-item>
      <list-item>
        <p>We tested the unstructured variant of the SimGIC function.</p>
      </list-item>
    </list>
    <p specific-use="continuation">Here 2, 3 and some of the methods tested in 1 improved performance. All of these modifications were simple to implement using our existing evaluation code. Furthermore, we have distributed a standalone C++ program that calculates all of the evaluation metrics tested here, allowing them to be used in practice.</p>
    <p>Our results included metrics that were expected to exhibit poor performance. These were included as negative controls in our analysis to prove that ADS works as expected. Indeed, we recognised that US AUC-ROC and GC AUC-ROC show very bad performance with FP tests. This is in agreement with the results by Ferri et al. [<xref rid="pcbi.1007419.ref008" ref-type="bibr">8</xref>] with AUC-ROC and its weakness with uneven class sizes. As expected, semantic summation methods B and C had poor performance with FP tests and ADS RC values, respectively (see supplementary <xref ref-type="supplementary-material" rid="pcbi.1007419.s004">S2 Text</xref>).</p>
    <p>The importance of a good evaluation metric is best demonstrated with flawed metrics. A metric with sensitivity to our naïve FP set, <italic>EvM</italic><sub><italic>naive</italic></sub>, would allow “cheating” in method comparison. For example, when the classifier lacks predictions for a gene, <italic>G</italic>, it could improve its results simply by returning a set of naïve predictions for <italic>G</italic> (i.e. the base rate for each GO class). A better alternative for the end user would be to not make any predictions. Also, a bad <italic>EvM</italic><sub><italic>naive</italic></sub> would evaluate the correct GO term as an equally good prediction as any of its parents. This would promote predicting large unspecific GO terms for all genes, although the small terms contain more biological information. Likewise, a metric penalising false positives weakly would promote methods that predict as many terms as possible and a metric penalising false negatives weakly would promote predicting as few GO terms as possible. Note that these artefacts are often hard to observe without the kinds of comparisons we have presented.</p>
    <p>Our results are dependent on the signal and noise model, as these are used to create the correct and wrong predictions. Although these models were motivated in the Methods section, we emphasise that this is only the first version of ADS. Our plan is to extend these models and use them in addition to our current models. ADS analysis can be easily extended in this manner. We propose the ADS approach in general, without limiting it to specific signal and noise models.</p>
    <p>Furthermore, we use a real dataset as a starting point, thus maintaining its challenging features. Also, there are no real classifier result sets available, to our knowledge, where the correct ordering of the classifiers is known. So one is bound to use some kind of simulation in this type of analysis. Here the controlled percentage of noise makes the correct ordering of the results known. We point out that the only similar evaluation, extensive work by Ferri et al. [<xref rid="pcbi.1007419.ref008" ref-type="bibr">8</xref>], uses fully artificial datasets to compare evaluation metrics. Supplementary text 2 <xref ref-type="supplementary-material" rid="pcbi.1007419.s004">S2 Text</xref> compares our work in more detail to this and other previous research.</p>
    <p>We envision several application scenarios for ADS. The first, is a general user, who would like an overall answer to the question: which metrics are optimal? For this case a set of metrics that have stably high performance on very different datasets is needed. In this work we give our recommendations with tests on three data sets. Further testing on a larger spectrum of datasets and with altered noise models is planned for follow-up articles. The second scenario is a specialised user who wants to optimise metrics for the type of data he or she is testing. Here the researcher would perform the ADS analysis using the selected dataset(s). This ensures the applicability of the selected group of evaluation metrics on the used dataset(s). Finally, we expect that ADS would be useful for the developers of evaluation metrics, as it allows thorough testing of novel metrics.</p>
    <p>ADS is designed to compare evaluation metrics that are used in GO term prediction for proteins, however, similar problems with evaluation metrics occur in other areas of the biosciences. Complex hierarchical classifications are used, for example, for classifying disease genes. Also the use of ontologies in the biosciences is growing [<xref rid="pcbi.1007419.ref028" ref-type="bibr">28</xref>], creating similar classification challenges. Furthermore, similar hierarchical structures are seen in other fields (e.g. in WordNet [<xref rid="pcbi.1007419.ref029" ref-type="bibr">29</xref>]) and evaluation metrics are shown to fail even without hierarchical structures, when there is a class imbalance problem [<xref rid="pcbi.1007419.ref017" ref-type="bibr">17</xref>].</p>
    <p>The motivation for the ADS project came from our own GO classifier work [<xref rid="pcbi.1007419.ref006" ref-type="bibr">6</xref>, <xref rid="pcbi.1007419.ref007" ref-type="bibr">7</xref>], where we noted that standard classifier metrics gave misleading results. Indeed, we expect that the method development community and researchers doing comparisons between GO prediction methods will benefit most from this work. However, the benefits do not end there. Currently it can be difficult for readers and reviewers to estimate the importance of new predictive bioinformatics methods as different articles use different metrics and test data sets. Indeed, the reliability of scientific findings [<xref rid="pcbi.1007419.ref030" ref-type="bibr">30</xref>, <xref rid="pcbi.1007419.ref031" ref-type="bibr">31</xref>] and over-optimistic results [<xref rid="pcbi.1007419.ref018" ref-type="bibr">18</xref>, <xref rid="pcbi.1007419.ref032" ref-type="bibr">32</xref>] have generated much discussion recently. We hope that ADS will improve this situation by developing robust and transparent standards to select evaluation metrics in future bioinformatics publications.</p>
    <sec id="sec025">
      <title>Conclusion</title>
      <p>Science needs numerous predictive methods, making the comparison and evaluation of these methods an important challenge. The central component of these comparisons is the Evaluation Metric. In the case of Automated Function Predictors the selection of the evaluation metric is a challenging task, potentially favouring poorly performing methods. In this article we have described the Artificial Dilution Series (ADS) which is, to our knowledge, the first method for testing classifier evaluation metrics using real data sets and controlled levels of embedded signal. ADS allows for simple testing of evaluation metrics to see how easily they can separate different signal levels. Furthermore, we test with different False Positive Sets representing data sets that the evaluation metric might mistakenly consider meaningful. Our results show clear performance differences between evaluation metrics. We also tested several modifications to existing evaluation metrics, some of which improved their performance. This work provides a platform for selecting evaluation metrics for specific Gene Ontology data sets and will simplify the development of novel evaluation metrics. The same principles could be applied to other problem domains, inside and outside of the biosciences.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="sec026">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pcbi.1007419.s001">
      <label>S1 Fig</label>
      <caption>
        <title>Scatter plot visualization of EvM performance.</title>
        <p>This scatter plot represents EvM performances on MouseFunc data set. Labels and abbreviations, used here, are explained in <xref ref-type="fig" rid="pcbi.1007419.g008">Fig 8</xref>.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007419.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007419.s002">
      <label>S2 Fig</label>
      <caption>
        <title>Scatter plot visualization of EvM performance.</title>
        <p>This scatter plot represents EvM performances on Uniprot data set. Labels and abbreviations, used here, are explained in <xref ref-type="fig" rid="pcbi.1007419.g008">Fig 8</xref>.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007419.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007419.s003">
      <label>S1 Text</label>
      <caption>
        <title>ADS pseudocode.</title>
        <p>Pseudocode for generation of ADS.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007419.s003.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007419.s004">
      <label>S2 Text</label>
      <caption>
        <title>Supplementary text.</title>
        <p>Text shows an example on how the signal and noise is defined in ADS. Text also shows labels, definitions and discussion of tested metrics. Finally, we discuss the summary methods for semantic similarities and motivate our novel summary methods.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007419.s004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007419.s005">
      <label>S1 File</label>
      <caption>
        <title>Metric scores when <italic>k</italic> = 2.</title>
        <p>This compressed archive file represents the evaluation metric scores for all generated AP and FP sets, obtained with <italic>k</italic> = 2.</p>
        <p>(GZ)</p>
      </caption>
      <media xlink:href="pcbi.1007419.s005.tar.gz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007419.s006">
      <label>S2 File</label>
      <caption>
        <title>Metric scores when <italic>k</italic> = 3.</title>
        <p>This compressed archive file represents the evaluation metric scores for all generated AP and FP sets, obtained with <italic>k</italic> = 3. Our further analysis focuses on this data.</p>
        <p>(GZ)</p>
      </caption>
      <media xlink:href="pcbi.1007419.s006.tar.gz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007419.s007">
      <label>S3 File</label>
      <caption>
        <title>Metric scores when <italic>k</italic> = 4.</title>
        <p>This compressed archive file represents the evaluation metric scores for all generated AP and FP sets, obtained with <italic>k</italic> = 4.</p>
        <p>(GZ)</p>
      </caption>
      <media xlink:href="pcbi.1007419.s007.tar.gz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007419.s008">
      <label>S1 Table</label>
      <caption>
        <title>Abbreviations and features for all compared EvMs.</title>
        <p>We represent a summary table of all the compared EvMs. Table shows the used abbreviation, core function, used data summary method, used threshold function over the classifier prediction score, used IC weighting and summary method for semantic similarities. In addition we mark the EvMs that have been popular in AFP evaluation, ones that have some novelty and ones that we consider to be simple. We also mark EvMs that we expect to perform badly as negative controls. More detailed description of these EvMs is in suppl. text <xref ref-type="supplementary-material" rid="pcbi.1007419.s004">S2 Text</xref>.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007419.s008.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007419.s009">
      <label>S2 Table</label>
      <caption>
        <title>Stability of the results when parameters are varied.</title>
        <p>Here we evaluate the stability of the results when we vary parameter <italic>k</italic> and <italic>th</italic><sub><italic>jacc</italic></sub>. Table A shows results for different <italic>k</italic> values and table B shows results for two values of <italic>th</italic><sub><italic>jacc</italic></sub>. We selected in each comparison one data set, created results for all EvMs using two parameter values and compared the obtained results using Pearson and Spearmann rank correlation. FPS and RC results are evaluated here separately. Tested parameters show very little effect on the results.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007419.s009.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007419.s010">
      <label>S3 Table</label>
      <caption>
        <title>Features of the three used data sets.</title>
        <p>Table explains the size and density of the three used data sets (CAFA1, MouseFunc, UniProt). Data sets are explained in main text. Table shows skewed distribution of GO terms per gene by representing selected quantiles from this distribution. This is shown separately for each data set with and without the propagation to parent terms. We also show the same size distribution for the GO terms, again showing the skewness of the size distribution.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1007419.s010.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007419.s011">
      <label>S4 Table</label>
      <caption>
        <title>ADS results.</title>
        <p><italic>RC</italic> and <italic>FPS</italic> scores for tested metrics using <italic>k</italic> = 2. Table is tab-delimited text file.</p>
        <p>(TAB)</p>
      </caption>
      <media xlink:href="pcbi.1007419.s011.tab">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007419.s012">
      <label>S5 Table</label>
      <caption>
        <title>ADS results.</title>
        <p><italic>RC</italic> and <italic>FPS</italic> scores for tested metrics using <italic>k</italic> = 4. Table is tab-delimited text file.</p>
        <p>(TAB)</p>
      </caption>
      <media xlink:href="pcbi.1007419.s012.tab">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007419.s013">
      <label>S6 Table</label>
      <caption>
        <title>ADS results for <italic>k</italic> = 3 with highlighting.</title>
        <p><italic>RC</italic> and <italic>FPS</italic> scores for tested metrics using <italic>k</italic> = 3. Table is an excel file that shows similar results as <xref rid="pcbi.1007419.t001" ref-type="table">Table 1</xref> but for all the metrics. Colouring highlights cases where metric fails a test. Thresholds can be adjusted in this table to change the highlighting.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1007419.s013.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We would like to thank Rishi Das Roy and Alan Medlar for valuable comments and fruitful discussions. We also acknowledge Alan Medlar for reviewing our text.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1007419.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Friedberg</surname><given-names>I</given-names></name>. <article-title>Automated protein function prediction—the genomic challenge</article-title>. <source>Briefings in bioinformatics</source>. <year>2006</year>;<volume>7</volume>(<issue>3</issue>):<fpage>225</fpage>–<lpage>242</lpage>. <pub-id pub-id-type="doi">10.1093/bib/bbl004</pub-id><?supplied-pmid 16772267?><pub-id pub-id-type="pmid">16772267</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007419.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Radivojac</surname><given-names>P</given-names></name>, <name><surname>Clark</surname><given-names>WT</given-names></name>, <name><surname>Oron</surname><given-names>TR</given-names></name>, <name><surname>Schnoes</surname><given-names>AM</given-names></name>, <name><surname>Wittkop</surname><given-names>T</given-names></name>, <name><surname>Sokolov</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>A large-scale evaluation of computational protein function prediction</article-title>. <source>Nature methods</source>. <year>2013</year>;<volume>10</volume>(<issue>3</issue>):<fpage>221</fpage>–<lpage>227</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.2340</pub-id><?supplied-pmid 23353650?><pub-id pub-id-type="pmid">23353650</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007419.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Jiang</surname><given-names>Y</given-names></name>, <name><surname>Oron</surname><given-names>TR</given-names></name>, <name><surname>Clark</surname><given-names>WT</given-names></name>, <name><surname>Bankapur</surname><given-names>AR</given-names></name>, <name><surname>D’Andrea</surname><given-names>D</given-names></name>, <name><surname>Lepore</surname><given-names>R</given-names></name>, <etal>et al</etal><article-title>An expanded evaluation of protein function prediction methods shows an improvement in accuracy</article-title>. <source>Genome biology</source>. <year>2016</year>;<volume>17</volume>(<issue>1</issue>):<fpage>184</fpage><pub-id pub-id-type="doi">10.1186/s13059-016-1037-6</pub-id><?supplied-pmid 27604469?><pub-id pub-id-type="pmid">27604469</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007419.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Peña-Castillo</surname><given-names>L</given-names></name>, <name><surname>Tasan</surname><given-names>M</given-names></name>, <name><surname>Myers</surname><given-names>CL</given-names></name>, <name><surname>Lee</surname><given-names>H</given-names></name>, <name><surname>Joshi</surname><given-names>T</given-names></name>, <name><surname>Zhang</surname><given-names>C</given-names></name>, <etal>et al</etal><article-title>A critical assessment of Mus musculus gene function prediction using integrated genomic evidence</article-title>. <source>Genome biology</source>. <year>2008</year>;<volume>9</volume>(<issue>1</issue>):<fpage>S2</fpage><pub-id pub-id-type="doi">10.1186/gb-2008-9-s1-s2</pub-id><?supplied-pmid 18613946?><pub-id pub-id-type="pmid">18613946</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007419.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Zhou</surname><given-names>N</given-names></name>, <name><surname>Jiang</surname><given-names>Y</given-names></name>, <name><surname>Bergquist</surname><given-names>TR</given-names></name>, <name><surname>Lee</surname><given-names>AJ</given-names></name>, <name><surname>Kacsoh</surname><given-names>BZ</given-names></name>, <name><surname>Crocker</surname><given-names>AW</given-names></name>, <etal>et al</etal><article-title>The CAFA challenge reports improved protein function prediction and new functional annotations for hundreds of genes through experimental screens</article-title>. <source>bioRxiv</source>. <year>2019</year>; p. 653105.</mixed-citation>
    </ref>
    <ref id="pcbi.1007419.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Koskinen</surname><given-names>P</given-names></name>, <name><surname>Törönen</surname><given-names>P</given-names></name>, <name><surname>Nokso-Koivisto</surname><given-names>J</given-names></name>, <name><surname>Holm</surname><given-names>L</given-names></name>. <article-title>PANNZER: high-throughput functional annotation of uncharacterized proteins in an error-prone environment</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>(<issue>10</issue>):<fpage>1544</fpage>–<lpage>1552</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btu851</pub-id><?supplied-pmid 25653249?><pub-id pub-id-type="pmid">25653249</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007419.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Törönen</surname><given-names>P</given-names></name>, <name><surname>Medlar</surname><given-names>A</given-names></name>, <name><surname>Holm</surname><given-names>L</given-names></name>. <article-title>PANNZER2: a rapid functional annotation web server</article-title>. <source>Nucleic Acids Research</source>. <year>2018</year>;<volume>46</volume>(<issue>W1</issue>):<fpage>W84</fpage>–<lpage>W88</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gky350</pub-id><?supplied-pmid 29741643?><pub-id pub-id-type="pmid">29741643</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007419.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Ferri</surname><given-names>C</given-names></name>, <name><surname>Hernández-Orallo</surname><given-names>J</given-names></name>, <name><surname>Modroiu</surname><given-names>R</given-names></name>. <article-title>An experimental comparison of performance measures for classification</article-title>. <source>Pattern Recognition Letters</source>. <year>2009</year>;<volume>30</volume>(<issue>1</issue>):<fpage>27</fpage>–<lpage>38</lpage>. <pub-id pub-id-type="doi">10.1016/j.patrec.2008.08.010</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007419.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Hand</surname><given-names>DJ</given-names></name>. <article-title>Assessing the performance of classification methods</article-title>. <source>International Statistical Review</source>. <year>2012</year>;<volume>80</volume>(<issue>3</issue>):<fpage>400</fpage>–<lpage>414</lpage>. <pub-id pub-id-type="doi">10.1111/j.1751-5823.2012.00183.x</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007419.ref010">
      <label>10</label>
      <mixed-citation publication-type="book"><name><surname>Japkowicz</surname><given-names>N</given-names></name>, <name><surname>Shah</surname><given-names>M</given-names></name>. <source>Evaluating learning algorithms: a classification perspective</source>. <publisher-name>Cambridge University Press</publisher-name>; <year>2011</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007419.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Gillis</surname><given-names>J</given-names></name>, <name><surname>Pavlidis</surname><given-names>P</given-names></name>. <article-title>Characterizing the state of the art in the computational assignment of gene function: lessons from the first critical assessment of functional annotation (CAFA)</article-title>. In: <source>BMC bioinformatics</source>. <volume>vol. 14</volume> BioMed Central; <year>2013</year> p. <fpage>S15</fpage>
<pub-id pub-id-type="doi">10.1186/1471-2105-14-S3-S15</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007419.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Kahanda</surname><given-names>I</given-names></name>, <name><surname>Funk</surname><given-names>CS</given-names></name>, <name><surname>Ullah</surname><given-names>F</given-names></name>, <name><surname>Verspoor</surname><given-names>KM</given-names></name>, <name><surname>Ben-Hur</surname><given-names>A</given-names></name>. <article-title>A close look at protein function prediction evaluation protocols</article-title>. <source>GigaScience</source>. <year>2015</year>;<volume>4</volume>(<issue>1</issue>):<fpage>41</fpage><pub-id pub-id-type="doi">10.1186/s13742-015-0082-5</pub-id><?supplied-pmid 26380075?><pub-id pub-id-type="pmid">26380075</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007419.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Ashburner</surname><given-names>M</given-names></name>, <name><surname>Ball</surname><given-names>CA</given-names></name>, <name><surname>Blake</surname><given-names>JA</given-names></name>, <name><surname>Botstein</surname><given-names>D</given-names></name>, <name><surname>Butler</surname><given-names>H</given-names></name>, <name><surname>Cherry</surname><given-names>JM</given-names></name>, <etal>et al</etal><article-title>Gene Ontology: tool for the unification of biology</article-title>. <source>Nature genetics</source>. <year>2000</year>;<volume>25</volume>(<issue>1</issue>):<fpage>25</fpage>–<lpage>29</lpage>. <pub-id pub-id-type="doi">10.1038/75556</pub-id><?supplied-pmid 10802651?><pub-id pub-id-type="pmid">10802651</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007419.ref014">
      <label>14</label>
      <mixed-citation publication-type="other">Eisner R, Poulin B, Szafron D, Lu P, Greiner R. Improving Protein Function Prediction using the Hierarchical Structure of the Gene Ontology. In: 2005 IEEE Symposium on Computational Intelligence in Bioinformatics and Computational Biology. Institute of Electrical and Electronics Engineers (IEEE); 2005. Available from: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109%2Fcibcb.2005.1594940">https://doi.org/10.1109%2Fcibcb.2005.1594940</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007419.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Fu</surname><given-names>G</given-names></name>, <name><surname>Wang</surname><given-names>J</given-names></name>, <name><surname>Yang</surname><given-names>B</given-names></name>, <name><surname>Yu</surname><given-names>G</given-names></name>. <article-title>NegGOA: negative GO annotations selection using ontology structure</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>(<issue>19</issue>):<fpage>2996</fpage>–<lpage>3004</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btw366</pub-id><?supplied-pmid 27318205?><pub-id pub-id-type="pmid">27318205</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007419.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Valverde-Albacete</surname><given-names>FJ</given-names></name>, <name><surname>Peláez-Moreno</surname><given-names>C</given-names></name>. <article-title>Two information-theoretic tools to assess the performance of multi-class classifiers</article-title>. <source>Pattern Recognition Letters</source>. <year>2010</year>;<volume>31</volume>(<issue>12</issue>):<fpage>1665</fpage>–<lpage>1671</lpage>. <pub-id pub-id-type="doi">10.1016/j.patrec.2010.05.017</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007419.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Valverde-Albacete</surname><given-names>FJ</given-names></name>, <name><surname>Peláez-Moreno</surname><given-names>C</given-names></name>. <article-title>100% classification accuracy considered harmful: The normalized information transfer factor explains the accuracy paradox</article-title>. <source>PloS one</source>. <year>2014</year>;<volume>9</volume>(<issue>1</issue>):<fpage>e84217</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0084217</pub-id><?supplied-pmid 24427282?><pub-id pub-id-type="pmid">24427282</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007419.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Norel</surname><given-names>R</given-names></name>, <name><surname>Rice</surname><given-names>JJ</given-names></name>, <name><surname>Stolovitzky</surname><given-names>G</given-names></name>. <article-title>The self-assessment trap: can we all be better than average?</article-title><source>Molecular systems biology</source>. <year>2011</year>;<volume>7</volume>(<issue>1</issue>):<fpage>537</fpage><pub-id pub-id-type="doi">10.1038/msb.2011.70</pub-id><?supplied-pmid 21988833?><pub-id pub-id-type="pmid">21988833</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007419.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Pesquita</surname><given-names>C</given-names></name>, <name><surname>Faria</surname><given-names>D</given-names></name>, <name><surname>Falcao</surname><given-names>AO</given-names></name>, <name><surname>Lord</surname><given-names>P</given-names></name>, <name><surname>Couto</surname><given-names>FM</given-names></name>. <article-title>Semantic similarity in biomedical ontologies</article-title>. <source>PLoS comput biol</source>. <year>2009</year>;<volume>5</volume>(<issue>7</issue>):<fpage>e1000443</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000443</pub-id><?supplied-pmid 19649320?><pub-id pub-id-type="pmid">19649320</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007419.ref020">
      <label>20</label>
      <mixed-citation publication-type="other">Pesquita C, Faria D, Bastos H, Falcao A, Couto F. Evaluating GO-based semantic similarity measures. In: Proc. 10th Annual Bio-Ontologies Meeting. vol. 37; 2007. p. 38.</mixed-citation>
    </ref>
    <ref id="pcbi.1007419.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Clark</surname><given-names>WT</given-names></name>, <name><surname>Radivojac</surname><given-names>P</given-names></name>. <article-title>Analysis of protein function and its prediction from amino acid sequence</article-title>. <source>Proteins: Structure, Function, and Bioinformatics</source>. <year>2011</year>;<volume>79</volume>(<issue>7</issue>):<fpage>2086</fpage>–<lpage>2096</lpage>. <pub-id pub-id-type="doi">10.1002/prot.23029</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007419.ref022">
      <label>22</label>
      <mixed-citation publication-type="other">Lin D, et al. An information-theoretic definition of similarity. In: Icml. vol. 98. Citeseer; 1998. p. 296–304.</mixed-citation>
    </ref>
    <ref id="pcbi.1007419.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Resnik</surname><given-names>P</given-names></name>, <etal>et al</etal><article-title>Semantic similarity in a taxonomy: An information-based measure and its application to problems of ambiguity in natural language</article-title>. <source>J Artif Intell Res(JAIR)</source>. <year>1999</year>;<volume>11</volume>:<fpage>95</fpage>–<lpage>130</lpage>. <pub-id pub-id-type="doi">10.1613/jair.514</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007419.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Clark</surname><given-names>WT</given-names></name>, <name><surname>Radivojac</surname><given-names>P</given-names></name>. <article-title>Information-theoretic evaluation of predicted ontological annotations</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>(<issue>13</issue>):<fpage>i53</fpage>–<lpage>i61</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btt228</pub-id><?supplied-pmid 23813009?><pub-id pub-id-type="pmid">23813009</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007419.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Hanczar</surname><given-names>B</given-names></name>, <name><surname>Hua</surname><given-names>J</given-names></name>, <name><surname>Sima</surname><given-names>C</given-names></name>, <name><surname>Weinstein</surname><given-names>J</given-names></name>, <name><surname>Bittner</surname><given-names>M</given-names></name>, <name><surname>Dougherty</surname><given-names>ER</given-names></name>. <article-title>Small-sample precision of ROC-related estimates</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>6</issue>):<fpage>822</fpage>–<lpage>830</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btq037</pub-id><?supplied-pmid 20130029?><pub-id pub-id-type="pmid">20130029</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007419.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Clark</surname><given-names>WT</given-names></name>, <name><surname>Radivojac</surname><given-names>P</given-names></name>. <article-title>Information-theoretic evaluation of predicted ontological annotations</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>(<issue>13</issue>):<fpage>i53</fpage>–<lpage>i61</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btt228</pub-id><?supplied-pmid 23813009?><pub-id pub-id-type="pmid">23813009</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007419.ref027">
      <label>27</label>
      <mixed-citation publication-type="other">Boyd K, Eng KH, Page CD. Area under the precision-recall curve: point estimates and confidence intervals. In: Joint European conference on machine learning and knowledge discovery in databases. Springer; 2013. p. 451–466.</mixed-citation>
    </ref>
    <ref id="pcbi.1007419.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Smith</surname><given-names>B</given-names></name>, <name><surname>Ashburner</surname><given-names>M</given-names></name>, <name><surname>Rosse</surname><given-names>C</given-names></name>, <name><surname>Bard</surname><given-names>J</given-names></name>, <name><surname>Bug</surname><given-names>W</given-names></name>, <name><surname>Ceusters</surname><given-names>W</given-names></name>, <etal>et al</etal><article-title>The OBO Foundry: coordinated evolution of ontologies to support biomedical data integration</article-title>. <source>Nature biotechnology</source>. <year>2007</year>;<volume>25</volume>(<issue>11</issue>):<fpage>1251</fpage><pub-id pub-id-type="doi">10.1038/nbt1346</pub-id><?supplied-pmid 17989687?><pub-id pub-id-type="pmid">17989687</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007419.ref029">
      <label>29</label>
      <mixed-citation publication-type="book"><name><surname>Fellbaum</surname><given-names>C</given-names></name>. <source>WordNet: An Electronic Lexical Database</source>. <publisher-name>Bradford Books</publisher-name>; <year>1998</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007419.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Ioannidis</surname><given-names>JP</given-names></name>. <article-title>Why most published research findings are false</article-title>. <source>PLoS medicine</source>. <year>2005</year>;<volume>2</volume>(<issue>8</issue>):<fpage>e124</fpage><pub-id pub-id-type="doi">10.1371/journal.pmed.0020124</pub-id><?supplied-pmid 16060722?><pub-id pub-id-type="pmid">16060722</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007419.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Ioannidis</surname><given-names>JP</given-names></name>. <article-title>How to make more published research true</article-title>. <source>PLoS medicine</source>. <year>2014</year>;<volume>11</volume>(<issue>10</issue>):<fpage>e1001747</fpage><pub-id pub-id-type="doi">10.1371/journal.pmed.1001747</pub-id><?supplied-pmid 25334033?><pub-id pub-id-type="pmid">25334033</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007419.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Boulesteix</surname><given-names>AL</given-names></name>. <article-title>Over-optimism in bioinformatics research</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>3</issue>):<fpage>437</fpage>–<lpage>439</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp648</pub-id><?supplied-pmid 19942585?><pub-id pub-id-type="pmid">19942585</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
