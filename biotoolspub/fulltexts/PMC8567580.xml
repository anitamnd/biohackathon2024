<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8567580</article-id>
    <article-id pub-id-type="publisher-id">4450</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-021-04450-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MSA: reproducible mutational signature attribution with confidence based on simulations</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5848-005X</contrib-id>
        <name>
          <surname>Senkin</surname>
          <given-names>Sergey</given-names>
        </name>
        <address>
          <email>senkins@iarc.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.17703.32</institution-id><institution-id institution-id-type="ISNI">0000000405980095</institution-id><institution>Genomic Epidemiology Branch, </institution><institution>International Agency for Research on Cancer (IARC/WHO), </institution></institution-wrap>Lyon, France </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>4</day>
      <month>11</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>4</day>
      <month>11</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>540</elocation-id>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>3</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>10</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Mutational signatures proved to be a useful tool for identifying patterns of mutations in genomes, often providing valuable insights about mutagenic processes or normal DNA damage. De novo extraction of signatures is commonly performed using Non-Negative Matrix Factorisation methods, however, accurate attribution of these signatures to individual samples is a distinct problem requiring uncertainty estimation, particularly in noisy scenarios or when the acting signatures have similar shapes. Whilst many packages for signature attribution exist, a few provide accuracy measures, and most are not easily reproducible nor scalable in high-performance computing environments.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We present Mutational Signature Attribution (MSA), a reproducible pipeline designed to assign signatures of different mutation types on a single-sample basis, using Non-Negative Least Squares method with optimisation based on configurable simulations. Parametric bootstrap is proposed as a way to measure statistical uncertainties of signature attribution. Supported mutation types include single and doublet base substitutions, indels and structural variants. Results are validated using simulations with reference COSMIC signatures, as well as randomly generated signatures.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">MSA is a tool for optimised mutational signature attribution based on simulations, providing confidence intervals using parametric bootstrap. It comprises a set of Python scripts unified in a single Nextflow pipeline with containerisation for cross-platform reproducibility and scalability in high-performance computing environments. The tool is publicly available from <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/s.senkin/MSA">https://gitlab.com/s.senkin/MSA</ext-link>.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-021-04450-8.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>MSA</kwd>
      <kwd>Mutational signatures</kwd>
      <kwd>NNLS</kwd>
      <kwd>Parametric bootstrap</kwd>
      <kwd>Nextflow</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000289</institution-id>
            <institution>Cancer Research UK</institution>
          </institution-wrap>
        </funding-source>
        <award-id>C98/A24032</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par12">Mutational signatures are distinctive combinations of somatic mutations which can be of various origin, such as exogenous or endogenous exposures, defective DNA repair pathways, DNA replication infidelity or DNA enzymatic editing [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. Currently, on the order of 100 signatures have been discovered in human cancer, but for the majority of them the aetiology remains unknown. This has given rise to a rich new field of mutational signature discovery, as well as linking signatures to various risk factors, in projects like Mutographs [<xref ref-type="bibr" rid="CR3">3</xref>].</p>
    <p id="Par13">De novo extraction of signatures is commonly performed using Non-Negative Matrix Factorisation (NMF) [<xref ref-type="bibr" rid="CR4">4</xref>] for somatic mutations under various mutational classifications [<xref ref-type="bibr" rid="CR5">5</xref>], with tools such as SigProfilerExtractor [<xref ref-type="bibr" rid="CR6">6</xref>]. Such signature extraction has been extremely informative in the analysis of many cancer types and shed light into mutagenesis of endogenous and exogenous risk factors [<xref ref-type="bibr" rid="CR2">2</xref>].</p>
    <p id="Par14">It has also become apparent that certain signatures show a dose-response relationship with risk factors, for example COSMIC signature SBS4 with tobacco smoking [<xref ref-type="bibr" rid="CR7">7</xref>]. In order to characterise such relationships, it is increasingly important to attribute mutational signatures, i.e. estimate their activities in any given sample, with confidence intervals. Some signatures with similar shapes are difficult to differentiate between each other, for instance COSMIC signatures SBS5 and SBS40 that both have a relatively flat profile. For such signatures, point estimates of attribution can often be inaccurate, leading to false positive or false negative findings.</p>
    <p id="Par15">Ideally, statistical uncertainty of signature attribution would be best estimated by performing repeated measurements. Given the high cost and complexity of such measurements (especially sample preparation, DNA extraction and sequencing), one needs to look for other alternatives. Bootstrapping has been proposed as a practical method to estimate uncertainty of signature attribution [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>], however, not all investigators are explicit in the precise version of bootstrapping used. Whereas some suggest that simple resampling with replacement of a mutational catalogue can give a meaningful result, we argue that classic bootstrap is not applicable in mutational signature attribution, and propose the parametric bootstrap approach under assumption that mutations accumulate according to Poisson processes for each given mutation class, such as a trinucleotide context.</p>
    <p id="Par16">Another common difficulty of signature attribution packages is the low reproducibility as well as scalability of computations in high-performance computing environments. This is a particular concern when analysis is performed on large datasets, and when the number of bootstrap variations is considerable. We resolve this issue by utilising Nextflow [<xref ref-type="bibr" rid="CR10">10</xref>], a domain-specific language (DSL) designed to primarily address computational irreproducibility and efficient parallel execution in a large number of computing environments, from individual workstations to server clusters and cloud computing services.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par17">Consider a mutational catalogue (such as a set of somatic mutations in cancer genomes) as a matrix <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {M}}$$\end{document}</tex-math><mml:math id="M2"><mml:mi mathvariant="bold">M</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4450_Article_IEq1.gif"/></alternatives></inline-formula> (<inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m \times n$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4450_Article_IEq2.gif"/></alternatives></inline-formula>). Here, <italic>m</italic> is the number of mutation types, such as 96 single base substitution types in the trinucleotide context, and <italic>n</italic> is the number of samples. Let <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {S}}$$\end{document}</tex-math><mml:math id="M6"><mml:mi mathvariant="bold">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4450_Article_IEq3.gif"/></alternatives></inline-formula> (<inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m \times k$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4450_Article_IEq4.gif"/></alternatives></inline-formula>) be the non-negative matrix of <italic>k</italic> mutational signatures (e.g. COSMIC catalogue [<xref ref-type="bibr" rid="CR2">2</xref>]). The goal is to find the non-negative matrix of activities (or exposures) <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {A}}$$\end{document}</tex-math><mml:math id="M10"><mml:mi mathvariant="bold">A</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4450_Article_IEq5.gif"/></alternatives></inline-formula> (<inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k \times n$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi>k</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4450_Article_IEq6.gif"/></alternatives></inline-formula>):<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathbf {M}} = {\mathbf {S}} \times {\mathbf {A}} \end{aligned}$$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">M</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="bold">A</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4450_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>In a more general version of the problem where the matrix <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {S}}$$\end{document}</tex-math><mml:math id="M16"><mml:mi mathvariant="bold">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4450_Article_IEq7.gif"/></alternatives></inline-formula> is unknown, de novo extraction of signatures can be performed using algorithms such as Non-negative Matrix Factorisation (NMF). Here, we assume that the signature matrix <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {S}}$$\end{document}</tex-math><mml:math id="M18"><mml:mi mathvariant="bold">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4450_Article_IEq8.gif"/></alternatives></inline-formula> is known, thereby scrutinising a more specific problem of finding activities of predefined signatures. This is particularly relevant when estimating the uncertainty of each signature activity is important, or simply when the number of samples <italic>n</italic> is low and one needs to quickly examine how well these samples can be explained by known mutational signatures.</p>
    <p id="Par18">The signature attribution problem can therefore be studied independently for each given sample <inline-formula id="IEq9"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {y}}$$\end{document}</tex-math><mml:math id="M20"><mml:mi mathvariant="bold">y</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4450_Article_IEq9.gif"/></alternatives></inline-formula> from the mutational catalogue <inline-formula id="IEq10"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {M}}$$\end{document}</tex-math><mml:math id="M22"><mml:mi mathvariant="bold">M</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4450_Article_IEq10.gif"/></alternatives></inline-formula>, as it can be seen as a linear combination of signatures <inline-formula id="IEq11"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {S}}$$\end{document}</tex-math><mml:math id="M24"><mml:mi mathvariant="bold">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4450_Article_IEq11.gif"/></alternatives></inline-formula> and their per-sample activities <inline-formula id="IEq12"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {x}}$$\end{document}</tex-math><mml:math id="M26"><mml:mi mathvariant="bold">x</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4450_Article_IEq12.gif"/></alternatives></inline-formula>:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathbf {y}} = {\mathbf {S}} \times {\mathbf {x}} \end{aligned}$$\end{document}</tex-math><mml:math id="M28" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="bold">x</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4450_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>Several algorithms can be used to solve this kind of problem, such as quadratic programming (QP) or simulated annealing (SA). Here, we utilise the Lawson-Hanson algorithm for non-negative least squares (NNLS) [<xref ref-type="bibr" rid="CR11">11</xref>], which is essentially a constrained version of the ordinary least squares problem:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\text {arg min}}_{\mathbf {x}} \Vert {\mathbf {Sx-y}} \Vert _2, {\mathbf {x}}\ge 0 \end{aligned}$$\end{document}</tex-math><mml:math id="M30" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mrow><mml:mtext>arg min</mml:mtext></mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="false">‖</mml:mo><mml:mrow><mml:mi mathvariant="bold">Sx</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mo stretchy="false">‖</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4450_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>Application of NNLS out of the box can be performed using one of the popular packages (<italic>nnls</italic> in R or <italic>optimize.nnls</italic> function in <italic>scipy</italic> library in Python), however, such approach is known to over-fit the data and lead to a large number of false-positive findings, as shown using simulations below. To mitigate this, ad-hoc approaches can be utilised, such as the optimisation of signature attribution using additional penalties on each signature’s contribution, or by using pre-existing biological knowledge such as strand bias rules [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. Although such optimisation is implemented in MSA using the penalty loops described below, the main advantage of the tool is the ability to quantify the confidence of attribution for each signature.</p>
    <sec id="Sec3">
      <title>Classic bootstrap</title>
      <p id="Par19">To estimate the confidence of signature attribution, several bootstrap approaches have been explored when developing this tool. In principle, bootstrapping can be applied to the full genome sequence data, but in the context of mutational signatures we apply bootstrap to collapsed mutational catalogues [matrix <inline-formula id="IEq13"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {M}}$$\end{document}</tex-math><mml:math id="M32"><mml:mi mathvariant="bold">M</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4450_Article_IEq13.gif"/></alternatives></inline-formula> in Eq. (<xref rid="Equ1" ref-type="">1</xref>)] for the sake of computational facility. Furthermore, it appears problematic to validate bootstrapped full sequences with simulations of predefined signatures.</p>
      <p id="Par20">Initially, a simple bootstrap, meaning resampling with replacement, was attempted on both simulated and real data. In this approach, <italic>N</italic> observations are randomly drawn from an initial sample with <italic>N</italic> mutation counts with replacement. In any given resample, each observation occurs 0, 1 or more times according to the binomial distribution <inline-formula id="IEq14"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textit{Binomial}}(N, 1/N)$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mi mathvariant="italic">Binomial</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4450_Article_IEq14.gif"/></alternatives></inline-formula>. Since the total number of observations is <italic>N</italic>, all counts jointly form a multinomial distribution <inline-formula id="IEq15"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textit{Multinomial}}(N, 1/N, \ldots , 1/N)$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi mathvariant="italic">Multinomial</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4450_Article_IEq15.gif"/></alternatives></inline-formula>. Importantly, this approach gives meaningful results only under the i.i.d. assumption, i.e. when underlying random variables are independent and identically distributed [<xref ref-type="bibr" rid="CR13">13</xref>]. This is not the case in mutation profiles: existing mutational signatures suggest that accumulation of mutations in particular trinucleotide contexts are inter-dependent and not identically distributed. For example, samples with high levels of APOBEC activity are characterised by mutations enriched within TCA and TCT contexts, clearly not identically distributed to all other trinucleotide contexts. Not surprisingly, using simple bootstrap to derive confidence intervals of signature attribution leads to rather poor results (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). In a simulated example, four COSMIC signatures (SBS 1, 5, 22 and 40) were used to mimic real kidney RCC (Renal Cell Carcinoma) data without noise. Whilst running NNLS on the input sample yielded attributions nearly identical to the simulated true values, results on bootstrapped samples were vastly different, producing grossly inaccurate confidence intervals.</p>
      <p id="Par21">Some investigators argue that classic bootstrap approach can be regarded as conservative for non-i.i.d. data [<xref ref-type="bibr" rid="CR14">14</xref>]. Other investigators argue that classic bootstrap is inadequate for high-dimensional non-i.i.d. data [<xref ref-type="bibr" rid="CR15">15</xref>]. In the context of high-dimensional mutational profiles, we choose to derive confidence intervals on signature attributions using parametric bootstrap.<fig id="Fig1"><label>Fig. 1</label><caption><p>Attribution with <bold>a</bold> classic and <bold>b</bold> parametric bootstrap. Confidence intervals are derived as [2.5%, 97.5%] percentiles of the resulting bootstrap activities, applied to simulated data with COSMIC signatures SBS 1, 5, 22 and 40, without noise. Point estimates of NNLS attribution (red dots) almost perfectly coincide with the generated true values (green dots) in such noiseless scenario</p></caption><graphic xlink:href="12859_2021_4450_Fig1_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Parametric bootstrap using Multinomial distribution</title>
      <p id="Par22">Parametric bootstrap assumes that the data follow a known underlying distribution. This implies making certain assumptions on the original dataset, so that the bootstrap samples can be drawn from the estimated parametric model.</p>
      <p id="Par23">Here, we make an assumption that mutations are accumulated following Poisson distributions for each mutation class, such as a specific trinucleotide context, i.e. that in each class, mutations accumulate randomly, independently and at a constant rate.</p>
      <p id="Par24">The idea of parametric bootstrap applied to mutational processes was inspired by <italic>mutSignatures</italic> package [<xref ref-type="bibr" rid="CR9">9</xref>] (which is itself based on the original MATLAB framework for deciphering signatures [<xref ref-type="bibr" rid="CR16">16</xref>]), where the input mutation matrix is bootstrapped according to the multinomial distribution <inline-formula id="IEq16"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textit{Multinomial}}(M, p_1 , \ldots , p_{m})$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mi mathvariant="italic">Multinomial</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4450_Article_IEq16.gif"/></alternatives></inline-formula>, where <italic>M</italic> is the total mutational burden in a given sample, and probabilities <inline-formula id="IEq17"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_i$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4450_Article_IEq17.gif"/></alternatives></inline-formula> are normalised mutation counts for each mutation type. This distribution is chosen since the conditional distribution of a vector of independent Poisson variables is equivalent to multinomial distribution [<xref ref-type="bibr" rid="CR17">17</xref>].</p>
      <p id="Par25">Since the mutational burden of each bootstrap sample is fixed and equal to <italic>M</italic>, we slightly modify the method by drawing counts from independent binomial distributions, so that the total mutational burden is no longer fixed. Nevertheless, for any given mutation category (e.g. <inline-formula id="IEq18"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C[T&gt;A]G$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>T</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4450_Article_IEq18.gif"/></alternatives></inline-formula> trinucleotide context on Fig. <xref rid="Fig2" ref-type="fig">2</xref>) the distribution of bootstrapped mutation counts follows a Poisson distribution.</p>
      <p id="Par26">For each bootstrap sample, NNLS attribution is applied to derive the vector of signature activities. 95% confidence intervals are then derived for each signature attribution by taking [2.5%, 97.5%] percentiles of the resulting bootstrap activities. Direct comparison with classic bootstrap on a simple simulated case without noise shows a clear advantage of the parametric method (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b).<fig id="Fig2"><label>Fig. 2</label><caption><p>Example of parametric bootstrap distribution for a <inline-formula id="IEq19"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C[T&gt;A]G$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>T</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4450_Article_IEq19.gif"/></alternatives></inline-formula> trinucleotide context. Simulated sample with 1000 bootstrap variations, the histogram is fitted by Poisson probability mass function</p></caption><graphic xlink:href="12859_2021_4450_Fig2_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Optimisation of signature attribution</title>
      <p id="Par27">Since pure NNLS is based on a simple fitting approach, it is generally prone to over-fitting, particularly in noisy environments [<xref ref-type="bibr" rid="CR18">18</xref>]. To mitigate this, a form of regularisation can be applied using the penalisation loops to add or remove signatures based on their contribution to the fit. This approach is based on the penalised attribution used in Pan-Cancer Analysis of Whole Genomes (PCAWG) consortium signature assignment [<xref ref-type="bibr" rid="CR2">2</xref>].</p>
      <p id="Par28">The default optimisation strategy, called removal strategy, starts with a full set of available signatures. Base <italic>L</italic>2 similarity of the reconstructed profile (linear combination of input signatures) to the input mutational profile is calculated, normalised by its <italic>L</italic>2 norm. Afterwards, a removal loop is executed, where all least contributing signatures increasing the <italic>L</italic>2 similarity by less than a given penalty (called “weak” threshold) are sequentially removed. The resulting set of remaining signatures is used to describe the input sample by applying the final NNLS fit.</p>
      <p id="Par29">On the other hand, high penalties used in optimisation can lead to under-fitting of data, meaning that optimal penalties need to be derived. We perform this by running simulations and measuring sensitivities, specificities as well as other metrics for all acting signatures.</p>
    </sec>
    <sec id="Sec6">
      <title>Automation and integration</title>
      <p id="Par30">The MSA tool is implemented as a set of scripts in Python language, with simulation, optimisation and final attribution steps fully automised using Nextflow workflow management system [<xref ref-type="bibr" rid="CR10">10</xref>]. All dependencies, including packages such as <italic>pandas, numpy, scipy, matplotlib</italic> and <italic>seaborn</italic>, are automatically handled by Nextflow via containerisation using Docker technology, as well as Singularity where Docker is not available. Users not willing to use Docker or Singularity may opt to use a Conda environment that is also automatically handled by Nextflow, yet this approach has inferior reproducibility compared to container technology.</p>
      <p id="Par31">Native support of SigProfilerMatrixGenerator [<xref ref-type="bibr" rid="CR5">5</xref>] and SigProfilerExtractor [<xref ref-type="bibr" rid="CR6">6</xref>] tools is implemented in MSA for convenience. Where SigProfiler outputs are available, running MSA is as simple as executing a single line containing the output paths: <disp-quote><p><bold><italic>nextflow run https://gitlab.com/s.senkin/MSA -profile docker --dataset test --SP_matrix_generator_output_path path/to/SP_ME/ --SP_extractor_output_path path/to/SP_extractor/</italic></bold></p></disp-quote></p>
      <p id="Par32">Mutational classifications currently supported are SBS-96, SBS-192 and SBS-288 for single base substitution signatures, DBS-78 for doublet base substitution signatures, ID-83 for small insertion and deletion signatures, SV-32 for structural variant signatures. The SV signatures are implemented as an experimental feature.</p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Results</title>
    <p id="Par33">Execution of the MSA tool using Nextflow automatically produces various output files, including tables with absolute and relative signature attributions, statistical information with goodness-of-fit measures, optimisation plots and tables, fitted mutation spectra, residuals and all bootstrap output including confidence intervals of attribution. All corresponding plots are produced in PDF format.</p>
    <sec id="Sec8">
      <title>Validation with simulations</title>
      <p id="Par34">When simulating a dataset that is supposed to resemble real data, one generally has to make certain assumptions about underlying distributions. Firstly, we explored scenarios mimicking real cohorts (e.g. shown on Fig. <xref rid="Fig1" ref-type="fig">1</xref>), with a defined set of acting reference COSMIC signatures, where generated signature attributions follow non-negative zero-inflated Gaussian distributions. Generally, such distributions do not describe real attributions well, especially for rare signatures. Therefore, as a default approach fully automised within the MSA Nextflow pipeline, we use data-driven simulations based on a simple bootstrap of signature activities derived without regularisation (i.e. with zero penalties). These activities are used to generate mutational profiles which are then resampled with replacement and injected with noise. Although these activities are bound to be over-fitted, they provide a way to sample signature attributions from distributions of observed real data, capturing signatures specific to any given cohort. The over-fitted generated signatures generally have low attribution levels, and can be regarded as noise in addition to the default noise model. We use the Gaussian noise model by default, with the standard deviation equal to 10% of mutational burden for each sample. Alternatively, Poisson model can be used, where the variance is equal to the mean generated mutation burden for any given mutation type.</p>
      <p id="Par35">Simulations allow to estimate the performance of signature attribution overall, as well as for each signature in different optimisation scenarios. Since the simulated truth is always known, one is able to calculate various metrics in order to estimate the accuracy of signature attribution, such as sensitivity and specificity for each signature, or for all signatures on average. As an example, Fig. <xref rid="Fig3" ref-type="fig">3</xref> shows such metrics for all COSMIC SBS signatures combined, based on the simulated model of Esophageal Squamous Cell Carcinoma (ESCC) signature activities. Figure <xref rid="Fig4" ref-type="fig">4</xref> shows these metrics for COSMIC signatures SBS5 and SBS16, for a range of “weak” penalties discussed previously. Signatures SBS5 and SBS16 were picked as typical examples of signatures with flat and non-flat profiles, respectively. The L2 penalty of zero corresponds to simple NNLS fit without any optimisation. Metrics are estimated with and without utilising confidence intervals, with the latter approach using the lower limit of confidence intervals when calculating metrics.<fig id="Fig3"><label>Fig. 3</label><caption><p>Overall performance metrics of signature attribution for simulated ESCC cohort with respect to optimisation penalty. <bold>a</bold> Senstivity, specificity and Matthews correlation coefficient are calculated using point estimates without confidence intervals. <bold>b</bold> Similar metrics are calculated using bootstrap variations yielding confidence intervals. Red horizontal line corresponds to the 95% value for each metric</p></caption><graphic xlink:href="12859_2021_4450_Fig3_HTML" id="MO7"/></fig></p>
      <p id="Par36">First of all, it is evident that higher penalties lead to lower sensitivity yet higher specificity of signature attribution. Secondly, confidence intervals allow to reach higher levels of specificity for signatures that are particularly difficult to attribute, such as signatures SBS5 and SBS40 due to their relatively flat profile. In a given example without confidence intervals, i.e. only using point estimates of attributions derived for simulated samples, specificity of SBS5 never reaches <inline-formula id="IEq20"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$90\%$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:mn>90</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4450_Article_IEq20.gif"/></alternatives></inline-formula>. On the other hand, confidence intervals do drive weakly-acting signatures with low attributions to zero, hence lowering the overall sensitivity to such signatures, which can be partially recovered by applying a lower penalty.</p>
      <p id="Par37">Generally, finding an optimal penalty is always a trade-off. The advantage of the MSA tool is its flexibility with respect to optimisation. By default, the pipeline automatically runs optimisation across the default range of <italic>L</italic>2 penalties, prioritising specificity of all signatures. However, investigators are free to choose a more or less conservative strategy by prioritising sensitivity or specificity of selected signatures.<fig id="Fig4"><label>Fig. 4</label><caption><p>Performance metrics for COSMIC signatures SBS5 and SBS16 with respect to optimisation penalty. SBS5 metrics are derived using point estimates (<bold>a</bold>) and confidence intervals (<bold>b</bold>). Similarly, SBS16 metrics are derived using point estimates (<bold>c</bold>) and confidence intervals (<bold>d</bold>). Red horizontal line corresponds to the 95% value for each metric</p></caption><graphic xlink:href="12859_2021_4450_Fig4_HTML" id="MO8"/></fig></p>
      <p id="Par38">Finally, performance of MSA was benchmarked against existing tools using both real and synthetic data published by the PCAWG consortium [<xref ref-type="bibr" rid="CR19">19</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>), as well as simulations based on the real PCAWG data, for SBS, DBS and Indel mutation types (Additional file <xref rid="MOESM2" ref-type="media">2</xref>). MSA generally achieves higher attribution performance than that of other tools due to its automised optimisation of the penalties applied, coupled with the application of confidence intervals.</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Discussion</title>
    <p id="Par39">We explored parametric bootstrap based on multinomial distribution as an effective method to derive confidence intervals of mutational signature attribution for any given mutational profile and available set of de novo extracted, or reference signatures. The multinomial distribution is chosen as the one corresponding to an assumption that mutations are accumulated according to Poisson processes for each mutation class, in line with the original signature extraction algorithm [<xref ref-type="bibr" rid="CR16">16</xref>], but other assumptions can be potentially investigated—such as Monte Carlo simulations of mutations following distributions of increasing complexity.</p>
    <p id="Par40">The main limitation of the parametric bootstrap we use is its bias towards observed data, since empirical probabilities <inline-formula id="IEq21"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_i$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4450_Article_IEq21.gif"/></alternatives></inline-formula> in the multinomial distribution <inline-formula id="IEq22"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textit{Multinomial}}(N, p_1 , \ldots , p_{m})$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mi mathvariant="italic">Multinomial</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4450_Article_IEq22.gif"/></alternatives></inline-formula> are taken from real data which can be inaccurate. However, this method aims to estimate the statistical uncertainty of signature attribution method rather than total uncertainty of attribution, and for such purposes remains adequate.</p>
    <p id="Par41">Parametric bootstrap can be applied using both simple NNLS attribution and the one based on penalised optimisation designed to maximise sensitivity and specificity of signature attribution. We developed a set of tools assisting in the validation of optimisation parameters for any given scenario using automised data-driven simulations of different cancer types and population cohorts. In general, it appears that such optimisation is unique for any given cohort due to the uniqueness of acting signatures. It also depends on noise, therefore investigators exploring cohorts of interest ideally need to test different noise scenarios. We opted to pick the Gaussian and Poisson noise models, yet other models such as negative binomial noise are worth consideration.</p>
    <p id="Par42">Estimating the systematic uncertainties of signature attribution, such as the ones due to sequencing artefacts, is a more challenging task that requires comparison of multiple sequencing technologies, not feasible in most settings. However, an uncertainty due to the variant calling can potentially be estimated for any given variant, and propagated to the signature attribution uncertainty. Evaluating these and other uncertainties remains a matter for further studies.</p>
    <p id="Par43">In summary, considering different sources of errors is an important exercise for any measurement, and as we show here, particularly for the attribution of mutational signatures. We hope that investigators will continue to ask such questions and strive to advance the methods shedding light on them. As a step in this direction, we present MSA—a computational tool to attribute mutational signatures with confidence intervals in an easily reproducible and scalable manner.</p>
  </sec>
  <sec id="Sec10">
    <title>Conclusions</title>
    <p id="Par44">Mutational signature attribution is a problem distinct from signature extraction, requiring uncertainty estimation, particularly in noisy scenarios or when the acting signatures have similar shapes. Whilst many packages for signature attribution exist, a few provide accuracy measures, and practically none apply automised regularisation based on simulations. Furthermore, most tools are not easily reproducible nor scalable in high-performance computing environments.</p>
    <p id="Par45">In this study, we propose MSA, a computational tool for optimised mutational signature attribution based on simulations, providing confidence intervals using parametric bootstrap. It is the first tool to perform automatic optimisation of regularisation based on data-driven simulations specific to any given input cohort. The tool comprises a set of Python scripts unified in a single Nextflow pipeline with containerisation, specifically designed for cross-platform reproducibility and scalability in high-performance computing environments.</p>
    <p id="Par46">MSA is publicly available at <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/s.senkin/MSA">https://gitlab.com/s.senkin/MSA</ext-link> with an extensive documentation at <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/s.senkin/MSA/-/wikis">https://gitlab.com/s.senkin/MSA/-/wikis</ext-link>.</p>
  </sec>
  <sec id="Sec11">
    <title>Availability and requirements</title>
    <p id="Par47">
      <list list-type="bullet">
        <list-item>
          <p id="Par48"><bold>Project name:</bold> MSA</p>
        </list-item>
        <list-item>
          <p id="Par49">
            <bold>Project home page:</bold>
            <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/s.senkin/MSA">https://gitlab.com/s.senkin/MSA</ext-link>
          </p>
        </list-item>
        <list-item>
          <p id="Par50">
            <bold>Project wiki page:</bold>
            <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/s.senkin/MSA/-/wikis">https://gitlab.com/s.senkin/MSA/-/wikis</ext-link>
          </p>
        </list-item>
        <list-item>
          <p id="Par51"><bold>Operating system(s):</bold> Platform independent</p>
        </list-item>
        <list-item>
          <p id="Par52"><bold>Programming language:</bold> Python, Nextflow DSL</p>
        </list-item>
        <list-item>
          <p id="Par53"><bold>Other requirements:</bold> Java 8 or later, docker, conda or singularity</p>
        </list-item>
        <list-item>
          <p id="Par54"><bold>License:</bold> GNU GPL</p>
        </list-item>
        <list-item>
          <p id="Par55"><bold>Any restrictions to use by non-academics:</bold> None</p>
        </list-item>
      </list>
    </p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec12">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2021_4450_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1:</bold> Comparison of MSA performance with existing tools. Performance of MSA benchmarked using real PCAWG consortium data and simulations, compared with SigProfiler and SignatureAnalyzer tools.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2021_4450_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2:</bold> MSA performance across different mutation types on data-driven simulations. Performance of MSA validated for SBS, DBS and ID mutation types using data-driven simulations derived from the PCAWG data.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>DBS</term>
        <def>
          <p id="Par4">Doublet base substitution</p>
        </def>
      </def-item>
      <def-item>
        <term>ESCC</term>
        <def>
          <p id="Par5">Esophageal squamous cell carcinoma</p>
        </def>
      </def-item>
      <def-item>
        <term>ID</term>
        <def>
          <p id="Par6">Small insertion and deletion</p>
        </def>
      </def-item>
      <def-item>
        <term>Indel</term>
        <def>
          <p id="Par7">Small insertion and deletion</p>
        </def>
      </def-item>
      <def-item>
        <term>NMF</term>
        <def>
          <p id="Par8">Non-negative matrix factorisation</p>
        </def>
      </def-item>
      <def-item>
        <term>NNLS</term>
        <def>
          <p id="Par9">Non-negative least squares</p>
        </def>
      </def-item>
      <def-item>
        <term>SBS</term>
        <def>
          <p id="Par10">Single base substitution</p>
        </def>
      </def-item>
      <def-item>
        <term>SV</term>
        <def>
          <p id="Par11">Structural variant</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to thank Drs Ludmil Alexandrov, Graham Byrnes, Liacine Bouaoun, Vivian Viallon, Karl Smith-Byrne and Sarah Moody for immensely useful discussions and feedback.</p>
    <sec id="FPar5">
      <title>Disclaimer</title>
      <p id="Par56">Where authors are identified as personnel of the International Agency for Research on Cancer / World Health Organization, the authors alone are responsible for the views expressed in this article and they do not necessarily represent the decisions, policy or views of the International Agency for Research on Cancer / World Health Organization.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>SS was the sole author of the manuscript and performed all the reported work. The author read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by a Cancer Grand Challenges Mutographs team award funded by Cancer Research UK [C98/A24032]. The funding bodies played no role in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets generated and/or analysed during the current study are available in the MSA repository, <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/s.senkin/MSA">https://gitlab.com/s.senkin/MSA</ext-link>. Mutational catalogues and signatures of PCAWG consortium data, including real and synthetic data are available at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7303/syn11726601">https://doi.org/10.7303/syn11726601</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar2">
      <title>Ethics approval and consent to participate</title>
      <p id="Par57">Not applicable.</p>
    </notes>
    <notes id="FPar3">
      <title>Consent for publication</title>
      <p id="Par58">Not applicable.</p>
    </notes>
    <notes id="FPar4" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par59">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alexandrov</surname>
            <given-names>LB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Signatures of mutational processes in human cancer</article-title>
        <source>Nature</source>
        <year>2013</year>
        <volume>500</volume>
        <issue>7463</issue>
        <fpage>415</fpage>
        <lpage>421</lpage>
        <pub-id pub-id-type="doi">10.1038/nature12477</pub-id>
        <?supplied-pmid 3776390?>
        <pub-id pub-id-type="pmid">23945592</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alexandrov</surname>
            <given-names>LB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The repertoire of mutational signatures in human cancer</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>578</volume>
        <issue>7793</issue>
        <fpage>94</fpage>
        <lpage>101</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-1943-3</pub-id>
        <?supplied-pmid 32025018?>
        <pub-id pub-id-type="pmid">32025018</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moody</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Senkin</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mutational signatures in esophageal squamous cell carcinoma from eight countries with varying incidence</article-title>
        <source>Nat Genet</source>
        <year>2021</year>
        <pub-id pub-id-type="doi">10.1038/s41588-021-00928-6</pub-id>
        <?supplied-pmid 34663923?>
        <pub-id pub-id-type="pmid">34663923</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>DD</given-names>
          </name>
          <name>
            <surname>Seung</surname>
            <given-names>HS</given-names>
          </name>
        </person-group>
        <article-title>Learning the parts of objects by non-negative matrix factorization</article-title>
        <source>Nature</source>
        <year>1999</year>
        <volume>401</volume>
        <issue>6755</issue>
        <fpage>788</fpage>
        <lpage>791</lpage>
        <pub-id pub-id-type="doi">10.1038/44565</pub-id>
        <?supplied-pmid 10548103?>
        <pub-id pub-id-type="pmid">10548103</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bergstrom</surname>
            <given-names>EN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SigProfilerMatrixGenerator: a tool for visualizing and exploring patterns of small mutational events</article-title>
        <source>BMC Genom</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>685</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-019-6041-2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Islam SMA, et al.: Uncovering novel mutational signatures by de novo extraction with SigProfilerExtractor. bioRxiv (2020). 10.1101/2020.12.13.422570.</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Alexandrov LB et al.: Mutational signatures associated with tobacco smoking in human cancer. Science (New York, N.Y.) 354(6312), 618–622 (2016). 10.1126/science.aag0299.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wojtowicz</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Przytycka</surname>
            <given-names>TM</given-names>
          </name>
        </person-group>
        <article-title>Detecting presence of mutational signatures in cancer with confidence</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>34</volume>
        <issue>2</issue>
        <fpage>330</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx604</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fantini</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MutSignatures: an R package for extraction and analysis of cancer mutational signatures</article-title>
        <source>Sci Rep</source>
        <year>2020</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>18217</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-020-75062-0</pub-id>
        <?supplied-pmid 33106540?>
        <pub-id pub-id-type="pmid">33106540</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Di Tommaso</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nextflow enables reproducible computational workflows</article-title>
        <source>Nat Biotechnol</source>
        <year>2017</year>
        <volume>35</volume>
        <issue>4</issue>
        <fpage>316</fpage>
        <lpage>319</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3820</pub-id>
        <?supplied-pmid 28398311?>
        <pub-id pub-id-type="pmid">28398311</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Lawson CL, Hanson RJ. Solving least squares problems. Classics in applied mathematics, vol. 15, p. 337. Society for Industrial and Applied Mathematics (SIAM), Philadelphia, PA (1995). Revised reprint of the 1974 original</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Crawford</surname>
            <given-names>FW</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>MB</given-names>
          </name>
        </person-group>
        <article-title>Using sigLASSO to optimize cancer mutation signatures jointly with sampling likelihood</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>3575</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-17388-x</pub-id>
        <?supplied-pmid 32681003?>
        <pub-id pub-id-type="pmid">32681003</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Bootstrap methods: another look at the jackknife</article-title>
        <source>Ann Stat</source>
        <year>1979</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>26</lpage>
        <pub-id pub-id-type="doi">10.1214/aos/1176344552</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Liu RY, Singh K. Using i.i.d. bootstrap inference for general non-i.i.d. models. J Stat Plan Inference. 1995; 43(1), 67–75. 10.1016/0378-3758(94)00008-J. Statistics ’91 Canada Conference Papers</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Owen</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Eckles</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Bootstrapping data arrays of arbitrary order</article-title>
        <source>Ann Appl Stat</source>
        <year>2012</year>
        <volume>6</volume>
        <issue>3</issue>
        <fpage>895</fpage>
        <lpage>927</lpage>
        <pub-id pub-id-type="doi">10.1214/12-AOAS547</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alexandrov</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Nik-Zainal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wedge</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Stratton</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Deciphering signatures of mutational processes operative in human cancer</article-title>
        <source>Cell Rep</source>
        <year>2013</year>
        <volume>3</volume>
        <issue>1</issue>
        <fpage>246</fpage>
        <lpage>259</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2012.12.008</pub-id>
        <?supplied-pmid 23318258?>
        <pub-id pub-id-type="pmid">23318258</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Steel GD. Relation between Poisson and multinomial distributions. Biometrics Unit Technical Reports, BU-39-M (1953).</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Slawski</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hein</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Non-negative least squares for high-dimensional linear models: consistency and sparse recovery without regularization</article-title>
        <source>Electron J Stat</source>
        <year>2013</year>
        <volume>7</volume>
        <fpage>3004</fpage>
        <lpage>3056</lpage>
        <pub-id pub-id-type="doi">10.1214/13-EJS868</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">The ICGC/TCGA Pan-Cancer Analysis of Whole Genomes Consortium. Pan-cancer analysis of whole genomes. Nature. 2020;578(7793):82–93. 10.1038/s41586-020-1969-6.</mixed-citation>
    </ref>
  </ref-list>
</back>
