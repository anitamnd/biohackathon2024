<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20031101//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2981553</article-id>
    <article-id pub-id-type="pmid">21085574</article-id>
    <article-id pub-id-type="publisher-id">10-PONE-RA-16901R1</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0013999</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline">
        <subject>Biochemistry/Bioinformatics</subject>
        <subject>Biochemistry/Molecular Evolution</subject>
        <subject>Computational Biology/Macromolecular Sequence Analysis</subject>
        <subject>Computer Science/Applications</subject>
        <subject>Evolutionary Biology/Bioinformatics</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MPI-PHYLIP: Parallelizing Computationally Intensive Phylogenetic Analysis Routines for the Analysis of Large Protein Families</article-title>
      <alt-title alt-title-type="running-head">MPI-PHYLIP</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ropelewski</surname>
          <given-names>Alexander J.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nicholas</surname>
          <given-names>Hugh B.</given-names>
          <suffix>Jr</suffix>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gonzalez Mendez</surname>
          <given-names>Ricardo R.</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>Pittsburgh Supercomputing Center, Carnegie Mellon University, Pittsburgh, Pennsylvania, United States of America</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>Department of Radiological Sciences, University of Puerto Rico School of Medicine, San Juan, Puerto Rico, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Jordan</surname>
          <given-names>I. King</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">Georgia Institute of Technology, United States of America</aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>ropelews@psc.edu</email></corresp>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: RRGM. Performed the experiments: AJR. Analyzed the data: AJR HBNJ RRGM. Contributed reagents/materials/analysis tools: AJR RRGM. Wrote the paper: AJR HBNJ RRGM.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>11</month>
      <year>2010</year>
    </pub-date>
    <volume>5</volume>
    <issue>11</issue>
    <elocation-id>e13999</elocation-id>
    <history>
      <date date-type="received">
        <day>9</day>
        <month>3</month>
        <year>2010</year>
      </date>
      <date date-type="accepted">
        <day>7</day>
        <month>9</month>
        <year>2010</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Ropelewski et al.</copyright-statement>
      <copyright-year>2010</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Phylogenetic study of protein sequences provides unique and valuable insights into the molecular and genetic basis of important medical and epidemiological problems as well as insights about the origins and development of physiological features in present day organisms. Consensus phylogenies based on the bootstrap and other resampling methods play a crucial part in analyzing the robustness of the trees produced for these analyses.</p>
      </sec>
      <sec>
        <title>Methodology</title>
        <p>Our focus was to increase the number of bootstrap replications that can be performed on large protein datasets using the maximum parsimony, distance matrix, and maximum likelihood methods. We have modified the PHYLIP package using MPI to enable large-scale phylogenetic study of protein sequences, using a statistically robust number of bootstrapped datasets, to be performed in a moderate amount of time. This paper discusses the methodology used to parallelize the PHYLIP programs and reports the performance of the parallel PHYLIP programs that are relevant to the study of protein evolution on several protein datasets.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>Calculations that currently take a few days on a state of the art desktop workstation are reduced to calculations that can be performed over lunchtime on a modern parallel computer. Of the three protein methods tested, the maximum likelihood method scales the best, followed by the distance method, and then the maximum parsimony method. However, the maximum likelihood method requires significant memory resources, which limits its application to more moderately sized protein datasets.</p>
      </sec>
    </abstract>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>Increases in the quantity of molecular sequence data available for analysis, with over 1,000 complete genomes available at NCBI's Genome Project Resource, has brought with it both the ability and need to perform phylogenetic analyses on larger, more complex data sets. These large-scale phylogenetic studies provide unique and valuable insights into the molecular and genetic basis for important medical and epidemiological problems such as drug resistance <xref rid="pone.0013999-Sheps1" ref-type="bibr">[1]</xref>, molecular receptor function <xref rid="pone.0013999-Bridgham1" ref-type="bibr">[2]</xref> as well as important questions about the origins and development of physiological features in present day organisms <xref rid="pone.0013999-Durand1" ref-type="bibr">[3]</xref>, <xref rid="pone.0013999-Darling1" ref-type="bibr">[4]</xref>.</p>
    <p>These studies use a multiple sequence alignment to represent the evolutionary history of a protein, gene, chromosome, or genome. This alignment is represented as a matrix to reconstruct a phylogenetic tree. This tree would ideally be a binary tree with unequal branch lengths. With molecular data the nodes represent speciation/mutation or duplication events, and the branch lengths the time of evolution. A recent paper <xref rid="pone.0013999-Ciccarelli1" ref-type="bibr">[5]</xref> compared 31 orthologs across 191 species using an automated procedure to reconstruct the tree of life. The tree reconstruction used a “<italic>supermatrix of 8090 positions for 191 species</italic>”. Both of these tasks – constructing an optimal multiple sequence alignment and searching for the optimal phylogenetic tree – are known to be NP-complete <xref rid="pone.0013999-Janies1" ref-type="bibr">[6]</xref>.</p>
    <p>The major methods of phylogenetic tree search are Distance Matrix based methods, Maximum Parsimony, Maximum Likelihood (ML), and Bayesian methods. The four methods are computationally intensive, particularly the ML, and Bayesian methods using Markov Chain Monte Carlo (MCMC) techniques to determine posterior probabilities (PP). Because the numbers of trees to be searched increases in a factorial manner with the number of sequences included in the multiple sequence alignment, alternate approaches that use heuristic methods to accelerate the search for the optimal tree have been explored. These heuristic searches produce reliable results, but without the certainty of arriving at the optimal solution.</p>
    <p>In order to determine the reliability of a phylogeny and to make inferences about the evolutionary history derived from the tree the main methods are Bayesian posterior probabilities and percent support for tree nodes using resampling methods, i.e. bootstrap percentages (BP). Also bootstrapped percentage posterior probabilities (BP-PP) have been advocated as providing a better estimator than PP alone, which often yield a number of false positives <xref rid="pone.0013999-Douady1" ref-type="bibr">[7]</xref>. Consensus phylogenies based on the bootstrap and other resampling methods are a crucial part of the new analyses that attempt to infer macroevolutionary events <xref rid="pone.0013999-Durand2" ref-type="bibr">[8]</xref>, as well as the required input for many new statistical analyses <xref rid="pone.0013999-KosakovskyPond1" ref-type="bibr">[9]</xref>. Resampling procedures use substantial computer resources and require significant turnaround time even for modest traditional datasets in molecular phylogenetics. Typically this entails an additional factor of 100–1000 or more in the running time owing to the bootstrap iterations. Today, typical BP in many large trees range from 100% to 50%, sometimes even lower. By increasing the number of bootstrap replicates, one can obtain a more reliable measure of the variance of the phylogenetic bootstrap p-value <xref rid="pone.0013999-Hedges1" ref-type="bibr">[10]</xref>. In order for the error in a binary phylogeny BP with values at 50–100% to be less than ±5% at 95% confidence, at least 400 replications must be used. For a ±2% error at least 2,000–2,500 replications are required at these BPs. For ±1% error at 90% BP approximately 3,500 replicates are needed. By increasing the number of bootstrap replicates, one can obtain a more reliable measure of the variance of the phylogenetic bootstrap p value <xref rid="pone.0013999-Hedges1" ref-type="bibr">[10]</xref>. Yet, limitations on computational resources are often cited in the literature as barriers to using the bootstrap method in large-scale phylogenetic studies <xref rid="pone.0013999-Douady1" ref-type="bibr">[7]</xref>, <xref rid="pone.0013999-Sanderson1" ref-type="bibr">[11]</xref>, <xref rid="pone.0013999-Delsuc1" ref-type="bibr">[12]</xref>. With the rapidly expanding interest and need for these calculations, parallel versions of the software used to carry out the resampling calculations becomes a critical need.</p>
    <p>While resampling itself requires a linear increase in the amount of computer time necessary for a particular calculation, the increased dataset size made possible by the new data collection methods causes the needed computer time to increase substantially as well. First, to find the optimal or at least a near optimal tree requires exploring or sampling the space of all possible trees which increases factorially with the number of sequences, while computing the pairwise distances between the sequences in the (resampled) data increases as the square of the number of sequences. This is by itself a significant factor since the increase in dataset size associated with the new data collection methods can be over an order of magnitude. Further, with more sequences and the factorial increase in the number of possible trees it is desirable to make a corresponding increase in the number of resampled datasets examined. Thus, the calculations under consideration can reach into weeks and even months for turnaround time on modern single processor workstations. As stated by Williams, Bader, Moret and Yan, “<italic>depending on a user's current needs, an analysis can be short (i.e., 24 hours) or it could run for several months</italic>” <xref rid="pone.0013999-Williams1" ref-type="bibr">[13]</xref>. Sometimes calculations are not carried to their full extent because of the number of times a program must be run. For example, Douady, Delsuc, Boucher, Doolittle and Douzery state in their paper: “<italic>For computing time reasons (i.e., running 2,500 times MrBayes), BP<sub>Bay</sub> were only computed for the 25 data sets showing the greatest contrast between BP<sub>ML</sub> and PP</italic>” <xref rid="pone.0013999-Douady1" ref-type="bibr">[7]</xref>. (MrBayes is a program for computing trees using Bayesian MCMC, and BP<sub>Bay</sub>, BP<sub>ML</sub> are bootstrap percentages for posterior probabilities and maximum likelihood respectively). In more recent work Talavera and Castresana (2007) were testing the G-Blocks program for trimming alignments and how the phylogenies improved, and they wrote: “<italic>Due to heavy computational requirements of the bootstrap analyses, the number of simulations was reduced to 150</italic>” <xref rid="pone.0013999-Talavera1" ref-type="bibr">[14]</xref>. The only way to carry out such calculations on the number of datasets required to make robust statistical claims in a reasonable amount of time is parallelization.</p>
    <p>Parallel and/or distributed algorithms for ML and Bayesian methods have been developed in the last few years and include DPRml <xref rid="pone.0013999-Keane1" ref-type="bibr">[15]</xref>, MultiPhyl <xref rid="pone.0013999-Keane2" ref-type="bibr">[16]</xref>, pIQPNNI <xref rid="pone.0013999-Minh1" ref-type="bibr">[17]</xref>, parallel MrBayes <xref rid="pone.0013999-Altekar1" ref-type="bibr">[18]</xref>, ClustalW-MPI <xref rid="pone.0013999-Li1" ref-type="bibr">[19]</xref>, TREE_PUZZLE <xref rid="pone.0013999-Schmidt1" ref-type="bibr">[20]</xref>, and RaxML <xref rid="pone.0013999-Stamatakis1" ref-type="bibr">[21]</xref>, <xref rid="pone.0013999-Stamatakis2" ref-type="bibr">[22]</xref>, <xref rid="pone.0013999-Stamatakis3" ref-type="bibr">[23]</xref>, <xref rid="pone.0013999-Stamatakis4" ref-type="bibr">[24]</xref>. Most of these methods address the issues of computational complexity and of the tree search only. The program RaxML is one of the most developed. It provides heuristic construction of the phylogenetic tree using Maximum Parsimony. Then it goes through a maximum likelihood optimization of the tree <xref rid="pone.0013999-Stamatakis1" ref-type="bibr">[21]</xref>, <xref rid="pone.0013999-Stamatakis2" ref-type="bibr">[22]</xref>. It provides very good likelihood estimates <xref rid="pone.0013999-Stamatakis3" ref-type="bibr">[23]</xref>. Extremely large datasets using nucleic acid sequences have been used for constructing ML phylogenetic trees using this approach. Recently the developers added a heuristic bootstrap calculation that appears to perform well in the cases used to benchmark that software <xref rid="pone.0013999-Stamatakis4" ref-type="bibr">[24]</xref>. A recent paper carried out the phylogenomic analysis of the cystatin superfamily <xref rid="pone.0013999-Kordis1" ref-type="bibr">[25]</xref>. They used RaxML <xref rid="pone.0013999-Stamatakis3" ref-type="bibr">[23]</xref> and the Neighbor-Joining algorithm from MEGA4 <xref rid="pone.0013999-Tamura1" ref-type="bibr">[26]</xref>. They found that “<italic>the NJ method with uncorrected distances was found to produce better resolution of evolutionary relationships in the cystatin superfamily than the more complex ML method</italic>” <xref rid="pone.0013999-Kordis1" ref-type="bibr">[25]</xref>. Russo, Takezaki and Nei <xref rid="pone.0013999-Russo1" ref-type="bibr">[27]</xref> showed that the efficiencies of the NJ, ME, MP and ML methods in obtaining the correct tree were nearly the same when amino acid sequence data were used. The most important factor in constructing reliable phylogenetic trees appeared to be the number of amino acids or nucleotides used. As a final consideration it should be noted that although the ML methods appear to be more accurate in reconstructing a phylogeny, there may exist several trees for a given set of aligned sequences that maximize the likelihood of the phylogeny <xref rid="pone.0013999-Felsenstein1" ref-type="bibr">[28]</xref>.</p>
    <p>Our group is interested in the evolutionary history of proteins and how to integrate this history with sequence and structural information to understand function and mechanisms of enzymes and other proteins. For example we have studied the aldehyde dehydrogenase family evolution, structure and function with computationally intensive methods <xref rid="pone.0013999-Perozich1" ref-type="bibr">[29]</xref>, <xref rid="pone.0013999-Hempel1" ref-type="bibr">[30]</xref>, <xref rid="pone.0013999-Wymore1" ref-type="bibr">[31]</xref>. For our specific purposes, proteins are the more appropriate molecules to use for the study of phylogenies <xref rid="pone.0013999-Opperdoes1" ref-type="bibr">[32]</xref>. Furthermore, Russo, Takezaki and Nei <xref rid="pone.0013999-Russo1" ref-type="bibr">[27]</xref> showed that when sequences diverge using the protein sequence yields more accurate reconstructions of the true phylogeny. Because the protein families that we study typically have dozens or hundreds of members, we have the specific need to carry out phylogenetic studies on protein families of these sizes. Furthermore, in our studies we desire the ability to compare trees from a variety of different methods using a common bootstrapped dataset. These factors led us to parallelize the resampling calculations using the protein-oriented routines of the PHYLIP phylogenetic suite.</p>
    <p>The PHYLIP package is one of the most comprehensive sets of tools freely available for use in phylogenetic studies <xref rid="pone.0013999-Felsenstein2" ref-type="bibr">[33]</xref>. According to the release notes of the package, PHYLIP has been distributed since 1980, and has over 20,000 registered users. The PHYLIP package can be used with protein (and nucleic acid) sequences and includes distance matrix methods, parsimony methods, and maximum-likelihood methods to search for phylogenetic trees using both heuristic and exact algorithms. PHYLIP also includes routines that allow for a variety of resampling techniques that include bootstrapping, jackknifing, and permutation of characters. It also allows for consensus trees to be reconstructed from the resampled data analyses by use of strict consensus or several variants of majority rule consensus. Since bootstrapping of datasets in the PHYLIP suite is a separate process, the same bootstrapped dataset can be used as input into different phylogenetic methods, enabling the comparison of trees created by different methods from a common bootstrapped framework.</p>
    <p>This paper reports our initial parallelization of the computationally intensive bootstrap calculations discussed above on datasets of various sizes using the PHYLIP suite of phylogenetic software. Our parallel code enables the phylogenetic study using a statistically robust amount of bootstrap replicates for large protein families using the distance and parsimony methods as well using a statistically robust amount of bootstrap replicates for moderate sized protein families using the maximum likelihood method implemented in PHYLIP.</p>
  </sec>
  <sec id="s2">
    <title>Results</title>
    <p>The test datasets (containing 1,000 bootstrap replicates generated with the PHYLIP seqboot program) used to illustrate the performance of the parallel codes are: 1) a 375 residue, single-gene alignment of cytrochrome B from the mitochondrial genome from thirteen species of plasmodium (<italic>1/13</italic>); 2) a 375 residue, single-gene alignment of cytrochrome B from the mitochondrial genome from twenty five species of plasmodium (<italic>1/25</italic>); 3) a 1139 residue, three-gene alignment consisting of the cytrochome B, cytochrome oxydase 1, and cytochrome oxydase 3 genes from the mitochondrial genome from twenty five species of plasmodium (<italic>3/25</italic>); 4) a 389 residue single gene alignment of 60 ABCG transporters from a variety of species (<italic>1/60</italic>); and 5) a 356 residue, single gene alignment from a set of 121 g-protein alpha inhibitory subunits from fungi (<italic>1/121</italic>). These bootstrapped datasets are available as supplemental files. In addition to these test datasets, the Tree-of-Life dataset of Ciccarelli, Doerks, von Mering, Creevey, Snel and Bork (2006) was used as an example of a large post-genomic dataset. The dataset includes 191 species and is 8089 columns long.</p>
    <p>Code performance for the parallel-bootstrap PHYLIP protpars, protdist, and proml programs (called MPIprotpars, MPIprotdist, and MPIproml), run with the default program parameters on the test datasets is summarized in <xref ref-type="table" rid="pone-0013999-t001">Tables 1</xref> and <xref ref-type="table" rid="pone-0013999-t002">2</xref>. The timings shown in the tables were run on the SGI Altix 4700 shared-memory NUMA systems at the Pittsburgh Supercomputing Center. The PSC ALTIX systems are configured with blades holding two Itanium 2 Montvale 9130M dual core processors. Each core had a clock rate of 1.66GHz and the four cores on each blade shared 8 Gigabytes of local memory. Due to the constraints and limitations of these systems dataset (<italic>1/60</italic>) was only run once with the maximum likelihood method and datasets (<italic>1/121</italic>) and the Tree-Of-Life dataset were not run using the maximum likelihood method.</p>
    <table-wrap id="pone-0013999-t001" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0013999.t001</object-id>
      <label>Table 1</label>
      <caption>
        <title>Benchmark Results for Parallel PHYLIP programs.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0013999-t001-1" xlink:href="pone.0013999.t001"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">Program</td>
              <td align="left" rowspan="1" colspan="1">Genes</td>
              <td align="left" rowspan="1" colspan="1">Sequences</td>
              <td align="left" rowspan="1" colspan="1">Alignment Length</td>
              <td align="left" rowspan="1" colspan="1">Max Memory (Gb)</td>
              <td colspan="5" align="left" rowspan="1">Elapsed Time</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">4</td>
              <td align="left" rowspan="1" colspan="1">8</td>
              <td align="left" rowspan="1" colspan="1">16</td>
              <td align="left" rowspan="1" colspan="1">32</td>
              <td align="left" rowspan="1" colspan="1">64</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">MPIproml</td>
              <td align="left" rowspan="1" colspan="1">3</td>
              <td align="left" rowspan="1" colspan="1">25</td>
              <td align="left" rowspan="1" colspan="1">1139</td>
              <td align="left" rowspan="1" colspan="1">16</td>
              <td align="left" rowspan="1" colspan="1">143130</td>
              <td align="left" rowspan="1" colspan="1">72456</td>
              <td align="left" rowspan="1" colspan="1">35863</td>
              <td align="left" rowspan="1" colspan="1">18938</td>
              <td align="left" rowspan="1" colspan="1">9968</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">1</td>
              <td align="left" rowspan="1" colspan="1">25</td>
              <td align="left" rowspan="1" colspan="1">375</td>
              <td align="left" rowspan="1" colspan="1">7</td>
              <td align="left" rowspan="1" colspan="1">130452</td>
              <td align="left" rowspan="1" colspan="1">66116</td>
              <td align="left" rowspan="1" colspan="1">34580</td>
              <td align="left" rowspan="1" colspan="1">17285</td>
              <td align="left" rowspan="1" colspan="1">9645</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">1</td>
              <td align="left" rowspan="1" colspan="1">13</td>
              <td align="left" rowspan="1" colspan="1">375</td>
              <td align="left" rowspan="1" colspan="1">2.5</td>
              <td align="left" rowspan="1" colspan="1">20004</td>
              <td align="left" rowspan="1" colspan="1">10342</td>
              <td align="left" rowspan="1" colspan="1">5335</td>
              <td align="left" rowspan="1" colspan="1">3025</td>
              <td align="left" rowspan="1" colspan="1">1618</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">MPIprotdist</td>
              <td align="left" rowspan="1" colspan="1">1</td>
              <td align="left" rowspan="1" colspan="1">121</td>
              <td align="left" rowspan="1" colspan="1">356</td>
              <td align="left" rowspan="1" colspan="1">&lt;0.1</td>
              <td align="left" rowspan="1" colspan="1">42416</td>
              <td align="left" rowspan="1" colspan="1">21233</td>
              <td align="left" rowspan="1" colspan="1">11806</td>
              <td align="left" rowspan="1" colspan="1">5507</td>
              <td align="left" rowspan="1" colspan="1">2941</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">1</td>
              <td align="left" rowspan="1" colspan="1">60</td>
              <td align="left" rowspan="1" colspan="1">389</td>
              <td align="left" rowspan="1" colspan="1">&lt;0.1</td>
              <td align="left" rowspan="1" colspan="1">11239</td>
              <td align="left" rowspan="1" colspan="1">5626</td>
              <td align="left" rowspan="1" colspan="1">2852</td>
              <td align="left" rowspan="1" colspan="1">1485</td>
              <td align="left" rowspan="1" colspan="1">818</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">3</td>
              <td align="left" rowspan="1" colspan="1">25</td>
              <td align="left" rowspan="1" colspan="1">1139</td>
              <td align="left" rowspan="1" colspan="1">&lt;0.1</td>
              <td align="left" rowspan="1" colspan="1">5542</td>
              <td align="left" rowspan="1" colspan="1">2786</td>
              <td align="left" rowspan="1" colspan="1">1419</td>
              <td align="left" rowspan="1" colspan="1">757</td>
              <td align="left" rowspan="1" colspan="1">460</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">1</td>
              <td align="left" rowspan="1" colspan="1">25</td>
              <td align="left" rowspan="1" colspan="1">375</td>
              <td align="left" rowspan="1" colspan="1">&lt;0.1</td>
              <td align="left" rowspan="1" colspan="1">1884</td>
              <td align="left" rowspan="1" colspan="1">947</td>
              <td align="left" rowspan="1" colspan="1">484</td>
              <td align="left" rowspan="1" colspan="1">259</td>
              <td align="left" rowspan="1" colspan="1">174</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">1</td>
              <td align="left" rowspan="1" colspan="1">13</td>
              <td align="left" rowspan="1" colspan="1">375</td>
              <td align="left" rowspan="1" colspan="1">&lt;0.1</td>
              <td align="left" rowspan="1" colspan="1">493</td>
              <td align="left" rowspan="1" colspan="1">250</td>
              <td align="left" rowspan="1" colspan="1">130</td>
              <td align="left" rowspan="1" colspan="1">75</td>
              <td align="left" rowspan="1" colspan="1">57</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">MPIprotpars</td>
              <td align="left" rowspan="1" colspan="1">1</td>
              <td align="left" rowspan="1" colspan="1">121</td>
              <td align="left" rowspan="1" colspan="1">356</td>
              <td align="left" rowspan="1" colspan="1">&lt;0.1</td>
              <td align="left" rowspan="1" colspan="1">33518</td>
              <td align="left" rowspan="1" colspan="1">17105</td>
              <td align="left" rowspan="1" colspan="1">8815</td>
              <td align="left" rowspan="1" colspan="1">5115</td>
              <td align="left" rowspan="1" colspan="1">3040</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">1</td>
              <td align="left" rowspan="1" colspan="1">60</td>
              <td align="left" rowspan="1" colspan="1">389</td>
              <td align="left" rowspan="1" colspan="1">&lt;0.1</td>
              <td align="left" rowspan="1" colspan="1">9645</td>
              <td align="left" rowspan="1" colspan="1">5033</td>
              <td align="left" rowspan="1" colspan="1">2610</td>
              <td align="left" rowspan="1" colspan="1">1479</td>
              <td align="left" rowspan="1" colspan="1">843</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">3</td>
              <td align="left" rowspan="1" colspan="1">25</td>
              <td align="left" rowspan="1" colspan="1">1139</td>
              <td align="left" rowspan="1" colspan="1">&lt;0.1</td>
              <td align="left" rowspan="1" colspan="1">1418</td>
              <td align="left" rowspan="1" colspan="1">760</td>
              <td align="left" rowspan="1" colspan="1">408</td>
              <td align="left" rowspan="1" colspan="1">262</td>
              <td align="left" rowspan="1" colspan="1">229</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">1</td>
              <td align="left" rowspan="1" colspan="1">25</td>
              <td align="left" rowspan="1" colspan="1">375</td>
              <td align="left" rowspan="1" colspan="1">&lt;0.1</td>
              <td align="left" rowspan="1" colspan="1">451</td>
              <td align="left" rowspan="1" colspan="1">256</td>
              <td align="left" rowspan="1" colspan="1">157</td>
              <td align="left" rowspan="1" colspan="1">118</td>
              <td align="left" rowspan="1" colspan="1">119</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">1</td>
              <td align="left" rowspan="1" colspan="1">13</td>
              <td align="left" rowspan="1" colspan="1">375</td>
              <td align="left" rowspan="1" colspan="1">&lt;0.1</td>
              <td align="left" rowspan="1" colspan="1">89</td>
              <td align="left" rowspan="1" colspan="1">50</td>
              <td align="left" rowspan="1" colspan="1">33</td>
              <td align="left" rowspan="1" colspan="1">28</td>
              <td align="left" rowspan="1" colspan="1">34</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="nt101">
          <label/>
          <p><underline>Program</underline> is the parallel version PHLIP program. <underline>Genes</underline> refers to the number of genes present in the alignment. <underline>Sequences</underline> refers to the number of sequences present in the alignment. <underline>Alignment Length</underline> refers to the length of the underlying multiple sequence alignment being analyzed. <underline>Max Memory</underline> is the maximum memory consumed by the parallel program listed as a per-processor value in gigabytes. <underline>Elapsed Time</underline> is the elapsed time in seconds for the parallel code to run on the Altix system for the number of cores shown.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <table-wrap id="pone-0013999-t002" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0013999.t002</object-id>
      <label>Table 2</label>
      <caption>
        <title>Benchmark Results for Tree-Of-Life Dataset.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0013999-t002-2" xlink:href="pone.0013999.t002"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">Program</td>
              <td align="left" rowspan="1" colspan="1">Sequences</td>
              <td align="left" rowspan="1" colspan="1">Alignment Length</td>
              <td colspan="2" align="left" rowspan="1">Elapsed Time</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">64</td>
              <td align="left" rowspan="1" colspan="1">128</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">MPIprotdist</td>
              <td align="left" rowspan="1" colspan="1">191</td>
              <td align="left" rowspan="1" colspan="1">8089</td>
              <td align="left" rowspan="1" colspan="1">109394</td>
              <td align="left" rowspan="1" colspan="1">62606</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">MPIprotpars</td>
              <td align="left" rowspan="1" colspan="1">191</td>
              <td align="left" rowspan="1" colspan="1">8089</td>
              <td align="left" rowspan="1" colspan="1">209762</td>
              <td align="left" rowspan="1" colspan="1">123284</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="nt102">
          <label/>
          <p><underline>Program</underline> is the parallel version PHLIP program. <underline>Sequences</underline> refers to the number of sequences present in the alignment. <underline>Alignment Length</underline> refers to the length of the underlying multiple sequence alignment being analyzed. <underline>Elapsed Time</underline> is the elapsed time in seconds for the parallel code to run on the Altix system for the number of cores shown.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <sec id="s2a">
      <title>Memory Requirements</title>
      <p>The protein parsimony and distance calculations require a minimal amount of memory, even for the larger calculations. All of these test cases required less than 100 Megabytes of memory. On the other hand, the maximum likelihood calculations all required a substantial amount of memory. The test cases required approximately 2.5Gb (1/13), 7Gb (1/25), and 16Gb (3/25) of memory per core on the Altix systems. It is important to note that while the Altix NUMA architecture permits global memory sharing, it is accomplished (through decreased efficiency) at the expense of idle cores. To perform maximum likelihood calculations efficiently would require hardware configured with substantially more memory per processor than the configuration cited in this paper. In addition a full exploration of the memory management schema used by the maximum likelihood code is needed to further understand this issue and evaluate if improvements such as those undertaken by the fastdnaml code <xref rid="pone.0013999-Olsen1" ref-type="bibr">[34]</xref> may be possible in the proml code.</p>
    </sec>
    <sec id="s2b">
      <title>Scaling</title>
      <p>The figures in this paper show the efficiency and effective speedup of the parallel implementation on the test datasets. Both efficiency and effective speedup in the figures are defined in terms of the four processor run. The efficiency at <italic>n</italic> processors is defined as:<disp-formula><graphic xlink:href="pone.0013999.e001.jpg" mimetype="image" position="float"/></disp-formula>where <italic>n</italic> is the number of processors utilized and <italic>t</italic> is the wallclock time of the run. The effective speedup (in processors) at <italic>n</italic> processors is defined as:<disp-formula><graphic xlink:href="pone.0013999.e002.jpg" mimetype="image" position="float"/></disp-formula>The CPU intensity of the algorithm and the size of the dataset both have a rather obvious effect on the scaling of the code. <xref ref-type="fig" rid="pone-0013999-g001"><italic><underline>Figure 1</underline></italic></xref> shows the efficiency of the parallel implementation of the parsimony code, while <xref ref-type="fig" rid="pone-0013999-g002"><italic><underline>Figure 2</underline></italic></xref> shows the efficiency of the distance code. Of these two methods, the distance method is more efficient and scales better than the parsimony method on the test datasets. This is not surprising given that the distance method is in general more CPU intensive than parsimony on protein family datasets. <xref ref-type="table" rid="pone-0013999-t001">Table 1</xref> shows in detail the results obtained for the datasets tested except for the the Tree-of-Life dataset. For small datasets with only a few dozen species, the parsimony code scales well only to about 8–16 processors while the distance code on these same small datasets scales well to about 32–64 processors. For larger datasets, which would require more computation, both of these methods will scale to substantially more processors. With the larger datasets (1/60 and 1/121) the parsimony codes scales only to 70% efficiency using 64 processors, while the distance code scales to approximately 90% efficiency. This means that we are effectively using 44 processors for the parsimony calculations and 58 processors for the distance calculations (<xref ref-type="fig" rid="pone-0013999-g003"><italic>Figure 3</italic></xref>). Improvements in the parsimony algorithm would be required to improve efficiencies. It is important to note that calculations that take a few days on these datasets using a state-of-the-art desktop workstation are reduced in time to a calculation that can be performed over lunchtime in a state-of-the-art cluster. <xref ref-type="table" rid="pone-0013999-t002">Table 2</xref> shows the results for the Tree-of-Life dataset. We can see that both the distance and parimony codes scale only to 128 processors with this dataset. The Tree-of-Life dataset, the largest used in this paper, required less than two days of computational time for 1,000 bootstrap replicates using 128 processors.</p>
      <fig id="pone-0013999-g001" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0013999.g001</object-id>
        <label>Figure 1</label>
        <caption>
          <title>Scaling of MPIprotpars.</title>
          <p>Scaling of the parallel implementation of the PHYLIP parsimony code (MPIprotpars) on the five test datasets discussed in this paper. The vertical axis indicates the percentage efficiency compared to the four core run while the horizontal axis indicates the number of processors used.</p>
        </caption>
        <graphic xlink:href="pone.0013999.g001"/>
      </fig>
      <fig id="pone-0013999-g002" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0013999.g002</object-id>
        <label>Figure 2</label>
        <caption>
          <title>Scaling of MPIprotdist.</title>
          <p>Scaling of the parallel implementation of the PHYLIP distance code (MPIprotdist) on the five test datasets discussed in this paper. The vertical axis indicates the percentage efficiency compared to the four core run while the horizontal axis indicates the number of processors used.</p>
        </caption>
        <graphic xlink:href="pone.0013999.g002"/>
      </fig>
      <fig id="pone-0013999-g003" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0013999.g003</object-id>
        <label>Figure 3</label>
        <caption>
          <title>Speed-up of parallel bootstrapped phylogeny calculations.</title>
          <p>Speedup of the parallel implementation of the PHYLIP codes (MPIprotdist, MPIprotpars and MPIproml) on the largest dataset used for each method discussed in this paper. The vertical axis indicates the effective number of processors compared to the four-processor run while the horizontal axis indicates the number of processors used.</p>
        </caption>
        <graphic xlink:href="pone.0013999.g003"/>
      </fig>
      <p><xref ref-type="fig" rid="pone-0013999-g004"><italic><underline>Figure 4</underline></italic></xref> shows the scaling of the maximum likelihood method on test cases (1/13), (1/25), and (3/25) compared with the scaling of the same test cases using the distance and parsimony methods. A single maximum likelihood calculation on the (1/60) dataset using 32 processors for computing and the memory from 480 processors on the Altix system took approximately 25.5 hours and 30 Gb of memory per compute processor (data not shown). Due to the excessive resources required for the calculation, we did not explore the largest dataset with the likelihood approach. Again, the more CPU intensive method (likelihood) scales better than either the distance or the parsimony codes given the same bootstrapped dataset. But it should be noted that the distance code approaches the efficiency of the maximum likelihood approach with the large datasets that are barely accessible by the latter method due to the time required because of the physical memory configuration of the system. While resource limitations, particularly memory preclude us from examining the scaling of the likelihood method with larger datasets further in this paper, we are confident that the likelihood method will continue to scale well beyond the number of processors shown in this paper when larger datasets are used. However, simply the ability to perform likelihood calculations on moderately sized protein datasets in a reasonable amount of time is very beneficial in fulfilling the needs of research groups such as ours that is interested in studying protein phylogenies.</p>
      <fig id="pone-0013999-g004" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0013999.g004</object-id>
        <label>Figure 4</label>
        <caption>
          <title>Scaling of MPIproml.</title>
          <p>Scaling of the parallel implementation of the PHYLIP maximum likelihood code (MPIproml) compared with the parallel distance (MPIprotdist) and parallel parsimony (MPIprotpars) methods. The vertical axis indicates the percentage efficiency compared to the four core run while the horizontal axis indicates the number of processors used.</p>
        </caption>
        <graphic xlink:href="pone.0013999.g004"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="methods" id="s3">
    <title>Methods</title>
    <p>Our focus in this project was to use parallelization to effectively increase the number of bootstrapping replications that could be performed on large protein datasets. Specifically, we wanted to create a parallel implementation that:</p>
    <list list-type="bullet">
      <list-item>
        <p>Required minimal changes to the original PHYLIP source code, but still allowed a substantial speedup in the processing of large bootstrapped datasets.</p>
      </list-item>
      <list-item>
        <p>Made use of the MPI message-passing library which would enable the parallel implementation to work on a wide variety of computer architectures.</p>
      </list-item>
      <list-item>
        <p>Used a methodology could be transferred to other computationally intensive routines in the PHYLIP Package, such as the routines in the package that are relevant to the study of evolution at the nucleotide level.</p>
      </list-item>
    </list>
    <p>How much code to modify is always an issue when porting an existing widely used serial code to a parallel platform. From a code maintenance standpoint, having the parallel and serial versions of the code maintained from a common source will help to ensure that the latest enhancements in the serial code are also available in the parallel code. On the other hand, to gain maximum parallel efficiency codes often need to be extensively re-written, often in a way that forces the development of special parallel versions that are not fully compatible with the serial code. We wanted to avoid this situation as the PHYLIP package is actively being developed and enhanced, and we had a strong desire to minimize any future incompatibilities that the parallel code would have with the serial code.</p>
    <p>Also driving the parallelization methodology decision were the coding practices used in the PHYLIP package. From a programming perspective, one of the nice features of the PHYLIP package is its consistency in programming style across the package's 30+ component programs that make up the PHYLIP suite. This coding style makes it easy to apply knowledge learned from examining the source code that makes up one program in the package into another. The use of multiple input and output files and the extensive use of global variables in the package also contributed to the selection of the parallel approach.</p>
    <p>The PHYLIP package sets program parameters and options by reading from the standard input and by reading in data sets from an input file and optionally categories and weights from separate files. Data read from standard input and the input files are read into numerous global variables that are referenced by multiple functions in the package. It is the extensive use of these global variables that hinders parallelizing the code without an extensive rewrite. However, the manner in which bootstrapping is implemented in the PHYLIP package makes an alternative parallel approach possible without an extensive recoding. Conceptually, inside each of the PHYLIP programs that makes use of bootstrapped datasets is a loop that looks similar to the following:</p>
    <p>For each bootstrap dataset:</p>
    <list list-type="order">
      <list-item>
        <p>Read the bootstrap dataset from input file into global variables</p>
      </list-item>
      <list-item>
        <p>Perform the tree reconstruction calculation</p>
      </list-item>
      <list-item>
        <p>Write the results to output file</p>
      </list-item>
    </list>
    <p>Thus, the code is essentially using global variables as scratch space: loading each dataset into this global space, using this global space to store intermediate results and then writing out the final results from this global space to the output file. Each independent tree-reconstruction bootstrap calculation is performed under the same parameters. In order to parallelize the code, one only needs to ensure that each processor receives the same input parameters, works on unique datasets, and write the results in a coordinated fashion to a common output file. This can be easily implemented if each of the parallel processors being utilized has access to a file system.</p>
    <p>To keep the code consistent with the serial version, we developed data primitives in MPI to distribute parameters and input file data to the processors. These data primitives are contained in an auxiliary file used in the parallel implementation called MPICopyfile.c. There are two minor restrictions placed on the parallel code that is not in the original PHYLIP codes. Those restrictions are: 1) that the default input and output filenames that the PHYLIP package expects (<italic>infile</italic>, <italic>outfile</italic>, <italic>outtree</italic>, etc.) must be used and 2) that the program input must be placed in a file named <italic>stdin</italic>. These minimal restrictions are necessary because of the way that these files are distributed to the processors. While the program is running, each node accesses its own input file and writes the data to its own output file. Prior to termination the output files are collected into a single output file. The general parallelism used in this implementation is as follows:</p>
    <list list-type="order">
      <list-item>
        <p>The lead processor distributes the stdin file to all processors</p>
      </list-item>
      <list-item>
        <p>The lead processor distributes the input file to all processors</p>
      </list-item>
      <list-item>
        <p>Each processor advances the input file pointer to a chunk of unique bootstrapped data based on the MPI processor number and the total number of bootstrapped datasets.</p>
      </list-item>
      <list-item>
        <p>Each processor evaluates its unique bootstrapped data: <list list-type="alpha-lower"><list-item><p>The unique dataset is read from the local input file into global variables</p></list-item><list-item><p>The parsimony, distance, or maximum likelihood calculation is performed</p></list-item><list-item><p>The results are written to a local output file</p></list-item></list>
</p>
      </list-item>
      <list-item>
        <p>The lead processor collects the results from all the processors and writes the data into single output file. The lead processor collects any additional output files produced by the method in the same manner.</p>
      </list-item>
    </list>
    <p>This general parallelism is implemented exclusively in the files MPIprotdist.c, MPIprotpars.c and MPIproml.c, which are modifications to the original protdist.c, protpars.c, and proml.c, files as well as the auxiliary file containing the data primitives (MPIcopyfile.c). No other source codes in the PHYLIP package were modified to create the parallel implementations.</p>
    <sec id="s3a">
      <title>How to install and run the software</title>
      <p>The coding approach described above enables the parallel PHYLIP code to be run on virtually any UNIX computer in which the MPI library is available and has been installed. A Makefile and instructions are included in the distribution to compile and link the software on platforms where the standard MPI compiler wrappers (ie. mpicc) have been installed as well as the Altix system. To install the distribution, first download the compressed tar file (MPIsrc.tar.gz) from the web site (<xref ref-type="supplementary-material" rid="pone.0013999.s001">File S1</xref>). Next uncompress the file using the gunzip command (“gunzip MPIsrc.tar.gz”) and unpack it with the tar command (“tar xvf MPIsrc.tar”).</p>
      <p>To compile and link the software on platforms where the standard MPI compiler wrappers (ie. mpicc) have been installed, change your working directory to the MPIsrc/src subdirectory (via “cd MPIsrc/src”). Next, copy the Makefile.mpicc file to a file called Makefile (“cp Makefile.mpicc Makefile”). Then use the make command to build compile and link the code with the appropriate MPI library (“make all”). In general we have found that only minor modifications to the compile and link lines in the Makefile are required to run the code on parallel platforms that do not use the standard MPI wrappers (including the Altix platform used to run the test cases.) To compile on the Altix platform simply copy the Makefile.Altix file to a file called Makefile (“cp Makefile.Altix Makefile”). Then use the make command to build, compile and link the code with the appropriate MPI library (“make all”).</p>
      <p>In the test directory of the distribution are several input files that can be used to test the installation. The files ending in “.boot” are bootstrapped input files, the files ending in “.stdin” are the program input files and the files ending in “.job” are UNIX (PBS) script files that can be used to run the parallel versions of the programs.</p>
      <p>The bootstrapped datasets used for the performance measures described in this paper are located in the “paper” subdirectory of the distribution (<xref ref-type="supplementary-material" rid="pone.0013999.s002">Files S2</xref>, <xref ref-type="supplementary-material" rid="pone.0013999.s003">S3</xref>, <xref ref-type="supplementary-material" rid="pone.0013999.s004">S4</xref>, <xref ref-type="supplementary-material" rid="pone.0013999.s005">S5</xref> and <xref ref-type="supplementary-material" rid="pone.0013999.s006">S6</xref>).</p>
      <p>To make full use of the parallelized routines described in this paper, the serial PHYLIP suite is also recommended to be installed to be able to generate bootstrapped datasets and to analyze the output files produced by the parallel programs.</p>
      <sec id="s3a1">
        <title>Availability</title>
        <p>Users can download a tar file containing the parallelized PHYLIP routines described in this paper from the website <ext-link ext-link-type="uri" xlink:href="http://www.nrbsc.org/downloads/">www.nrbsc.org/downloads/</ext-link>. The serial version of the PHYLIP suite is available from Joseph Felsenstein's website: <ext-link ext-link-type="uri" xlink:href="http://evolution.genetics.washington.edu/phylip/">http://evolution.genetics.washington.edu/phylip/</ext-link>
</p>
      </sec>
      <sec id="s3a2">
        <title>Future code optimizations</title>
        <p>The current parallel implementation is reliant on each processor having access to a file system because each processor needs to read and write its own unique data. In general, it is the file input and output that limits the scaling of the code. With adequate per-processor memory available, the possibility of using internal (memory) files to store the input data might be an obtainable optimization that may improve the scaling of the codes on moderate sized datasets. In lieu of using internal files, the potential exists to internalize the physical creation of the bootstrap dataset instead of relying on the external seqboot program. Internalizing the bootstrap creation would simultaneously reduce the amount of message passing data that needs to be distributed as well as greatly reducing the volume of data that needs to be read by the programs.</p>
        <p>The output files produced by each of the programs vary substantially and typically are much larger than the input files. The case for using internal files for these datasets is less clear. For example, the size of the largest output file from the (1/121) distance runs described in this paper is 149Mb, (or about three times as large as the largest input file) and the largest parsimony output file is over 5.8 Gb or about 100 times as large as the largest input file. While compression algorithms may be used to reduce the physical size needed to store this output data, compression is accomplished at the cost of increased CPU time. Even with compression, the amount of memory required to store these output files internally may be prohibitively large enough to render this potential optimization infeasible for output datasets on datasets of the size that we are interested in studying.</p>
        <p>In addition, a full exploration of the memory management schema used by the maximum likelihood code is needed to further understand the amount of memory used by the code. Any improvement that can be made in this area will increase the size of datasets that can be examined by the method as memory is the principal limitation of the code that we encountered in our studies. We know that improving the memory management of the original PHYLIP dnaml code is one of the major optimizations of the fastdnaml code <xref rid="pone.0013999-Olsen1" ref-type="bibr">[34]</xref>, thus if these optimization techniques are also relevant to the protein maximum likelihood code, substantial improvements in memory usage and program performance may be possible. However, the proml code differs substantially in many key ways from the fastdnaml code most notably being the hidden markov model features described in Felsenstein and Churchill <xref rid="pone.0013999-Felsenstein3" ref-type="bibr">[35]</xref>. Thus, while it may be unclear if the fastdnaml memory improvements are possible, the techniques are at least something to explore.</p>
      </sec>
      <sec id="s3a3">
        <title>Future research directions</title>
        <p>We have shown that parallel computing can enable the use of very large number of bootstrap replicates for the study of moderate sized protein phylogenetic datasets when using the robust maximum likelihood method in relatively short time frames (typically less than 48 hours). Large protein datasets are similarly addressed using the parsimony and distance methods. We have also illustrated how a valuable legacy code in the biosciences can be effectively parallelized with minimal code changes. Future work will include explorations on the maximum likelihood code's memory management schema, code optimizations including more efficient file handling and the exploration of the supertree approach to maximum likelihood <xref rid="pone.0013999-Delsuc1" ref-type="bibr">[12]</xref>. Furthermore, although the MPI version of the codes for analyzing DNA sequences have been implemented and are available, they should be thoroughly characterized and optimized in future work.</p>
        <p>In the post-genome era the availability of vast amounts of data from genomes, transcriptomes, proteomes, and metabolic networks has opened new avenues to study life and evolution. A detailed understanding of the phylogenies implicated by the genes, proteins, networks, and organisms is crucial to this endeavor. The majority of the phylogenetic methods being applied are focused on the nucleic acid composition of genes, genomes, and transcriptomes, thus will have difficulties to account for constraints on the gene products in the physical realm such as protein structure, biophysics, and function issues among others. In general the signal-to-noise-ratio of methods based on protein characteristics will be better than methods like the 16S-RNA-phylogenies. This effect is due to the stable conservation of protein structure and architecture when compared to the coding sequence. An additional advantage is that longer evolutionary time-scales will become accessible for study. As noted by Yang, Doolittle and Bourne <xref rid="pone.0013999-Yang1" ref-type="bibr">[36]</xref> proteins such as metabolic enzymes, cytoskeleton-proteins, or histones can be expected to evolve even more slowly making longer time scales amenable to evolutionary studies. As expressed by Mayr <xref rid="pone.0013999-Mayr1" ref-type="bibr">[37]</xref>, evolution during selection acts upon advantageous changes of the phenotype and not necessarily upon changes in the genotype. The phenotype is, however, to a large extent determined by the encoded proteome. Protein-based approaches are more concerned with this advantage. Furthermore, they appear to produce more reliable phylogenies than those based on nucleic acids <xref rid="pone.0013999-Russo1" ref-type="bibr">[27]</xref>.</p>
        <p>We have been studying large protein superfamilies with several hundred members <xref rid="pone.0013999-Hempel1" ref-type="bibr">[30]</xref>. The recent work on the cystatin superfamily found over 2100 members of this protein across all the kingdoms <xref rid="pone.0013999-Kordis1" ref-type="bibr">[25]</xref>. These large protein datasets can only be studied in a reasonable amount of time using the methods described here. For Example, we have carried out the distance calculation for the Tree-of-Life dataset <xref rid="pone.0013999-Ciccarelli1" ref-type="bibr">[5]</xref>, which includes 31 protein families from 191 species, in 17.4 hours using the MPI-Protdist code with 1,000 bootstrap replicates. Carrying out 1,000 bootstrap replicates serially on datasets this large can take months of computational time, and re-running the phylogenies when one adds a new subfamily or additional sequences can become an extreme burden. With the new parallel methods, phylogenies on datasets such as these can be computed over a few days.</p>
        <p>The exploration of phylogenies with new information theoretic approaches such as the Jensen-Shannon divergence <xref rid="pone.0013999-Sankararaman1" ref-type="bibr">[38]</xref> to look for functionally important residues and sites, key residues that define protein subfamilies (Nicholas, unpublished results), as a distance measure for protein domain phylogenies <xref rid="pone.0013999-Hamacher1" ref-type="bibr">[39]</xref>, or the combinatorial entropy measure to group protein alignments into subfamilies and map the defining residues to structures <xref rid="pone.0013999-Reva1" ref-type="bibr">[40]</xref> has become an important complement to phylogenetic studies that requires studying large protein families to be able to understand the evolution of structure and function within them. The software presented in this paper will significantly improve our capability to carry out this kind of research.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="s4">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0013999.s001">
      <label>File S1</label>
      <caption>
        <p>MPI Source Code for the Parallel PHYLIP methods (in .tar.gz format).</p>
        <p>(1.11 MB GZ)</p>
      </caption>
      <media xlink:href="pone.0013999.s001.gz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0013999.s002">
      <label>File S2</label>
      <caption>
        <p>Test dataset (containing 1,000 bootstrap replicates) from a 356 residue, single gene alignment from a set of 121 g-protein alpha inhibitory subunits from fungi (1/121).</p>
        <p>(6.47 MB GZ)</p>
      </caption>
      <media xlink:href="pone.0013999.s002.gz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0013999.s003">
      <label>File S3</label>
      <caption>
        <p>Test dataset (containing 1,000 bootstrap replicates) from a 389 residue single gene alignment of 60 ABCG transporters from a variety of species.</p>
        <p>(6.51 MB CDX)</p>
      </caption>
      <media xlink:href="pone.0013999.s003.cdx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0013999.s004">
      <label>File S4</label>
      <caption>
        <p>Test dataset (containing 1,000 bootstrap replicates) from a 375 residue, single-gene alignment of cytrochrome B from the mitochondrial genome from thirteen species of plasmodium.</p>
        <p>(0.70 MB GZ)</p>
      </caption>
      <media xlink:href="pone.0013999.s004.gz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0013999.s005">
      <label>File S5</label>
      <caption>
        <p>Test dataset (containing 1,000 bootstrap replicates) from a 375 residue, single-gene alignment of cytrochrome B from the mitochondrial genome from twenty five species of plasmodium.</p>
        <p>(1.02 MB GZ)</p>
      </caption>
      <media xlink:href="pone.0013999.s005.gz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0013999.s006">
      <label>File S6</label>
      <caption>
        <p>Test dataset (containing 1,000 bootstrap replicates) from a 1139 residue, three-gene alignment consisting of the cytrochome B, cytochrome oxydase 1, and cytochrome oxydase 3 genes from the mitochondrial genome from twenty five species of plasmodium.</p>
        <p>(3.14 MB GZ)</p>
      </caption>
      <media xlink:href="pone.0013999.s006.gz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <fn-group>
    <fn fn-type="COI-statement">
      <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
    </fn>
    <fn fn-type="financial-disclosure">
      <p><bold>Funding: </bold>This project was supported through the United States National Institutes of Health National Institute of General Medical Sciences grant No. 2 T36GM008789 and the Pittsburgh Supercomputing Center National Resource for Biomedical Supercomputing funded through the United States National Institutes of Health National Center for Research Resources grant 2 P41 RR06009. Funding for the shared-memory parallel Altix systems used for the tests in this paper was provided through grants from the United States National Institutes of Health through the National Center for Research Resources and the United States National Science Foundation through TeraGrid. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="pone.0013999-Sheps1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sheps</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Ralph</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Baillie</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Ling</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <year>2004</year>
        <article-title>The ABC transporter gene family of Caenorhabditis elegans has implications for the evolutionary dynamics of multidrug resistance in eukaryotes.</article-title>
        <source>Genome Biol</source>
        <volume>5</volume>
        <fpage>R15</fpage>
        <pub-id pub-id-type="pmid">15003118</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Bridgham1">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bridgham</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Carroll</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Thornton</surname>
            <given-names>JW</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>Evolution of Hormone-Receptor Complexity by Molecular Exploitation.</article-title>
        <source>Science</source>
        <volume>312</volume>
        <fpage>97</fpage>
        <lpage>101</lpage>
        <pub-id pub-id-type="pmid">16601189</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Durand1">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durand</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hoberman</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>Diagnosing duplications–can it be done?</article-title>
        <source>Trends Genet</source>
        <volume>22</volume>
        <fpage>156</fpage>
        <lpage>164</lpage>
        <pub-id pub-id-type="pmid">16442663</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Darling1">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darling</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Miklós</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Ragan</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Dynamics of Genome Rearrangement in Bacterial Populations.</article-title>
        <source>PLoS Genet</source>
        <volume>4</volume>
        <fpage>e1000128</fpage>
        <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pgen.1000128">10.1371/journal.pgen.1000128</ext-link></comment>
        <pub-id pub-id-type="pmid">18650965</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Ciccarelli1">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ciccarelli</surname>
            <given-names>FD</given-names>
          </name>
          <name>
            <surname>Doerks</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>von Mering</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Creevey</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Snel</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2006</year>
        <article-title>Toward Automatic Reconstruction of a Highly Resolved Tree of Life.</article-title>
        <source>Science</source>
        <volume>311</volume>
        <fpage>1283</fpage>
        <lpage>1287</lpage>
        <pub-id pub-id-type="pmid">16513982</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Janies1">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Janies</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Wheeler</surname>
            <given-names>WC</given-names>
          </name>
        </person-group>
        <year>2002</year>
        <article-title>Theory and practice of parallel direct optimization.</article-title>
        <source>EXS</source>
        <volume>92</volume>
        <fpage>115</fpage>
        <lpage>123</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Douady1">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Douady</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Delsuc</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Boucher</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Doolittle</surname>
            <given-names>WF</given-names>
          </name>
          <name>
            <surname>Douzery</surname>
            <given-names>EJ</given-names>
          </name>
        </person-group>
        <year>2003</year>
        <article-title>Comparison of Bayesian and maximum likelihood bootstrap measures of phylogenetic reliability.</article-title>
        <source>Mol Biol Evol</source>
        <volume>20</volume>
        <fpage>248</fpage>
        <lpage>54</lpage>
        <pub-id pub-id-type="pmid">12598692</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Durand2">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durand</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Halldorsson</surname>
            <given-names>BV</given-names>
          </name>
          <name>
            <surname>Vernot</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>A Hybrid Micro–Macroevolutionary Approach to Gene Tree Reconstruction.</article-title>
        <source>J Comp Biol</source>
        <volume>13</volume>
        <fpage>320</fpage>
        <lpage>335</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0013999-KosakovskyPond1">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kosakovsky-Pond</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Frost</surname>
            <given-names>SDW</given-names>
          </name>
          <name>
            <surname>Muse</surname>
            <given-names>SV</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>HyPhy: hypothesis testing using phylogenies.</article-title>
        <source>Bioinformatics</source>
        <volume>21</volume>
        <fpage>676</fpage>
        <lpage>679</lpage>
        <pub-id pub-id-type="pmid">15509596</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Hedges1">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hedges</surname>
            <given-names>SB</given-names>
          </name>
        </person-group>
        <year>1992</year>
        <article-title>The number of replications needed for accurate estimation of the bootstrap P value in phylogenetic studies.</article-title>
        <source>Mol Biol Evol</source>
        <volume>9</volume>
        <fpage>366</fpage>
        <lpage>369</lpage>
        <pub-id pub-id-type="pmid">1560769</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Sanderson1">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sanderson</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Driskell</surname>
            <given-names>AC</given-names>
          </name>
        </person-group>
        <year>2003</year>
        <article-title>The challenge of constructing large phylogenetic trees.</article-title>
        <source>Trends Plant Sci</source>
        <volume>8</volume>
        <fpage>373</fpage>
        <lpage>379</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Delsuc1">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Delsuc</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Brinkmann</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Philippe</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>Phylogenomics and the reconstruction of the tree of life.</article-title>
        <source>Nat Rev Genet</source>
        <volume>6</volume>
        <fpage>361</fpage>
        <lpage>375</lpage>
        <pub-id pub-id-type="pmid">15861208</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Williams1">
      <label>13</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Williams</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Bader</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Moret</surname>
            <given-names>BME</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>High-Performance Phylogeny Reconstruction Under Maximum Parsimony.</article-title>
        <person-group person-group-type="editor">
          <name>
            <surname>Zomaya</surname>
            <given-names>AY</given-names>
          </name>
        </person-group>
        <source>Parallel Computing for Bioinformatics and Computational Biology</source>
        <publisher-name>John Wiley and Sons</publisher-name>
        <fpage>369</fpage>
        <lpage>394</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Talavera1">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Talavera</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Castresana</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>Improvement of phylogenies after removing divergent and ambiguously aligned blocks from protein sequence alignments.</article-title>
        <source>Syst Biol</source>
        <volume>56</volume>
        <fpage>564</fpage>
        <lpage>77</lpage>
        <pub-id pub-id-type="pmid">17654362</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Keane1">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Keane</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Naughton</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Travers</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>McInerney</surname>
            <given-names>JO</given-names>
          </name>
          <name>
            <surname>McCormack</surname>
            <given-names>GP</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>DPRml: distributed phylogeny reconstruction by maximum likelihood.</article-title>
        <source>Bioinformatics</source>
        <volume>21</volume>
        <fpage>969</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="pmid">15513992</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Keane2">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Keane</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Naughton</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>McInerney</surname>
            <given-names>JO</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>MultiPhyl: a high-throughput phylogenomics webserver using distributed computing.</article-title>
        <source>Nucleic Acids Res</source>
        <volume>35</volume>
        <fpage>W33</fpage>
        <lpage>W37</lpage>
        <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkm359">10.1093/nar/gkm359</ext-link></comment>
        <pub-id pub-id-type="pmid">17553837</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Minh1">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Minh</surname>
            <given-names>BQ</given-names>
          </name>
          <name>
            <surname>Vinh le</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>von Haeseler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>HA</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>pIQPNNI: parallel reconstruction of large maximum likelihood phylogenies.</article-title>
        <source>Bioinformatics</source>
        <volume>21</volume>
        <fpage>3794</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="pmid">16046495</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Altekar1">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altekar</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Dwarkadas</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huelsenbeck</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Ronquist</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <year>2004</year>
        <article-title>Parallel Metropolis coupled Markov chain Monte Carlo for Bayesian phylogenetic inference.</article-title>
        <source>Bioinformatics</source>
        <volume>20</volume>
        <fpage>407</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="pmid">14960467</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Li1">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>KB</given-names>
          </name>
        </person-group>
        <year>2003</year>
        <article-title>ClustalW-MPI: ClustalW analysis using distributed and parallel computing.</article-title>
        <source>Bioinformatics</source>
        <volume>19</volume>
        <fpage>1585</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="pmid">12912844</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Schmidt1">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmidt</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Strimmer</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Vingron</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>von Haeseler</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <year>2002</year>
        <article-title>TREE-PUZZLE: maximum likelihood phylogenetic analysis using quartets and parallel computing.</article-title>
        <source>Bioinformatics</source>
        <volume>18</volume>
        <fpage>502</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="pmid">11934758</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Stamatakis1">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stamatakis</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Ludwig</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Meier</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wolf</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <year>2002</year>
        <article-title>AxML: a fast program for sequential and parallel phylogenetic tree calculations based on the maximum likelihood method.</article-title>
        <source>Proc IEEE Comput Soc Bioinform Conf</source>
        <volume>1</volume>
        <fpage>21</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="pmid">15838120</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Stamatakis2">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ludwig</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Meier</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>RAxML-III: a fast program for maximum likelihood-based inference of large phylogenetic trees.</article-title>
        <source>Bioinformatics</source>
        <volume>21</volume>
        <fpage>456</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="pmid">15608047</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Stamatakis3">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>RAxML-VI-HPC: maximum likelihood-based phylogenetic analyses with thousands of taxa and mixed models.</article-title>
        <source>Bioinformatics</source>
        <volume>22</volume>
        <fpage>2688</fpage>
        <lpage>90</lpage>
        <pub-id pub-id-type="pmid">16928733</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Stamatakis4">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hoover</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Rougemont</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>A rapid bootstrap algorithm for the RAxMLWeb servers.</article-title>
        <source>Syst Biol</source>
        <volume>57</volume>
        <fpage>758</fpage>
        <lpage>71</lpage>
        <pub-id pub-id-type="pmid">18853362</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Kordis1">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kordis</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Turk</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <year>2009</year>
        <article-title>Phylogenomic analysis of the cystatin superfamily in eukaryotes and prokaryotes.</article-title>
        <source>BMC Evol Biol</source>
        <volume>9</volume>
        <fpage>266</fpage>
        <pub-id pub-id-type="pmid">19919722</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Tamura1">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tamura</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dudley</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nei</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>MEGA4: Molecular Evolutionary Genetics Analysis (MEGA) software version 4.0.</article-title>
        <source>Molecular Biology and Evolution</source>
        <volume>24</volume>
        <fpage>1596</fpage>
        <lpage>1599</lpage>
        <pub-id pub-id-type="pmid">17488738</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Russo1">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Russo</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Takezaki</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Nei</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <year>1996</year>
        <article-title>Efficiencies of different genes and different tree-building methods in recovering a known vertebrate phylogeny.</article-title>
        <source>Mol Biol Evol</source>
        <volume>13</volume>
        <fpage>525</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="pmid">8742641</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Felsenstein1">
      <label>28</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Felsenstein</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <year>2004</year>
        <source>Inferring Phylogenies</source>
        <publisher-loc>Sunderland MA</publisher-loc>
        <publisher-name>Sinauer Associates, Inc</publisher-name>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Perozich1">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Perozich</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nicholas</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Lindahl</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hempel</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <year>1999</year>
        <article-title>Relationships within the aldehyde dehydrogenase extended family.</article-title>
        <source>Protein Sci</source>
        <volume>8</volume>
        <fpage>137</fpage>
        <lpage>46</lpage>
        <pub-id pub-id-type="pmid">10210192</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Hempel1">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hempel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Perozich</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wymore</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Nicholas</surname>
            <given-names>HB</given-names>
          </name>
        </person-group>
        <year>2003</year>
        <article-title>An algorithm for identification and ranking of family-specific residues, applied to the ALDH3 family.</article-title>
        <source>Chem Biol Interact</source>
        <volume>143–144</volume>
        <fpage>23</fpage>
        <lpage>8</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Wymore1">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wymore</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Deerfield</surname>
            <given-names>DW</given-names>
            <suffix>2nd</suffix>
          </name>
          <name>
            <surname>Field</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Hempel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nicholas</surname>
            <given-names>HB</given-names>
            <suffix>Jr</suffix>
          </name>
        </person-group>
        <year>2003</year>
        <article-title>Initial catalytic events in class 3 aldehyde dehydrogenase: MM and QM/MM simulations.</article-title>
        <source>Chem Biol Interact</source>
        <volume>143–144</volume>
        <fpage>75</fpage>
        <lpage>84</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Opperdoes1">
      <label>32</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Opperdoes</surname>
            <given-names>FR</given-names>
          </name>
        </person-group>
        <year>2009</year>
        <article-title>Phylogenetic analysis using protein sequences.</article-title>
        <person-group person-group-type="editor">
          <name>
            <surname>Lemey</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Salemi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vandamme</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <source>The Phylogenetic Handbook</source>
        <publisher-name>Cambridge University Press</publisher-name>
        <fpage>313</fpage>
        <lpage>341</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Felsenstein2">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Felsenstein</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <year>1989</year>
        <article-title>PHYLIP - Phylogeny Inference Package (Version 3.2).</article-title>
        <source>Cladistics</source>
        <volume>5</volume>
        <fpage>164</fpage>
        <lpage>166</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Olsen1">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Olsen</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Matsuda</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Hagstrom</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Overbeek</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>1994</year>
        <article-title>fastDNAml: A tool for construction of phylogenetic trees of DNA sequences using maximum likelihood.</article-title>
        <source>Comput Appl Biosci</source>
        <volume>10</volume>
        <fpage>41</fpage>
        <lpage>48</lpage>
        <pub-id pub-id-type="pmid">8193955</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Felsenstein3">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Felsenstein</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Churchill</surname>
            <given-names>GA</given-names>
          </name>
        </person-group>
        <year>1996</year>
        <article-title>A Hidden Markov Model Approach to Variation Among Sites in Rate of Evolution.</article-title>
        <source>Mol Biol Evol</source>
        <volume>13</volume>
        <fpage>93</fpage>
        <lpage>104</lpage>
        <pub-id pub-id-type="pmid">8583911</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Yang1">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Doolittle</surname>
            <given-names>RF</given-names>
          </name>
          <name>
            <surname>Bourne</surname>
            <given-names>PE</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>Phylogeny determined by protein domain content.</article-title>
        <source>Proc Nat Acad Sci USA</source>
        <volume>102</volume>
        <fpage>373</fpage>
        <lpage>378</lpage>
        <pub-id pub-id-type="pmid">15630082</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Mayr1">
      <label>37</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Mayr</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <year>2001</year>
        <source>What evolution is</source>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Basic Books</publisher-name>
        <size units="page">336</size>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Sankararaman1">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sankararaman</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sjölander</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>INTREPID–INformation-theoretic TREe traversal for Protein functional site IDentification.</article-title>
        <source>Bioinformatics</source>
        <volume>24</volume>
        <fpage>2445</fpage>
        <lpage>52</lpage>
        <pub-id pub-id-type="pmid">18776193</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Hamacher1">
      <label>39</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Hamacher</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <year>2010</year>
        <article-title>Protein Domain Phylogenies: Information Theory and Evolutionary Dynamics.</article-title>
        <person-group person-group-type="editor">
          <name>
            <surname>Fred</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Filipe</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gamboa</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <fpage>114</fpage>
        <lpage>122</lpage>
        <comment>Proceedings of Bioinformatics 2010, 1<sup>st</sup> International Conference on Bioinformatics</comment>
      </element-citation>
    </ref>
    <ref id="pone.0013999-Reva1">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reva</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Antipin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Sander</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>Determinants of protein function revealed by combinatorial entropy optimization.</article-title>
        <source>Genome Biol</source>
        <volume>8</volume>
        <fpage>R232</fpage>
        <pub-id pub-id-type="pmid">17976239</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
