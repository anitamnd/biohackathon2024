<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6041753</article-id>
    <article-id pub-id-type="pmid">29514181</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bty127</article-id>
    <article-id pub-id-type="publisher-id">bty127</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PWMScan: a fast tool for scanning entire genomes with a position-specific weight matrix</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ambrosini</surname>
          <given-names>Giovanna</given-names>
        </name>
        <xref ref-type="aff" rid="bty127-aff1">1</xref>
        <xref ref-type="aff" rid="bty127-aff2">2</xref>
        <xref ref-type="corresp" rid="bty127-cor1"/>
        <!--<email>giovanna.ambrosini@epfl.ch</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Groux</surname>
          <given-names>Romain</given-names>
        </name>
        <xref ref-type="aff" rid="bty127-aff1">1</xref>
        <xref ref-type="aff" rid="bty127-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bucher</surname>
          <given-names>Philipp</given-names>
        </name>
        <xref ref-type="aff" rid="bty127-aff1">1</xref>
        <xref ref-type="aff" rid="bty127-aff2">2</xref>
        <xref ref-type="corresp" rid="bty127-cor1"/>
        <!--<email>philipp.bucher@epfl.ch</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Hancock</surname>
          <given-names>John</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="bty127-aff1"><label>1</label>The Swiss Institute for Experimental Cancer Research (ISREC), Swiss Federal Institute of Technology Lausanne (EPFL)</aff>
    <aff id="bty127-aff2"><label>2</label>Swiss Institute of Bioinformatics, Lausanne, Switzerland</aff>
    <author-notes>
      <corresp id="bty127-cor1">To whom correspondence should be addressed. <email>giovanna.ambrosini@epfl.ch</email> or <email>philipp.bucher@epfl.ch</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>7</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2018-03-05">
      <day>05</day>
      <month>3</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>3</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>34</volume>
    <issue>14</issue>
    <fpage>2483</fpage>
    <lpage>2484</lpage>
    <history>
      <date date-type="received">
        <day>10</day>
        <month>11</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>27</day>
        <month>2</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>02</day>
        <month>3</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bty127.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Transcription factors regulate gene expression by binding to specific short DNA sequences of 5–20 bp to regulate the rate of transcription of genetic information from DNA to messenger RNA. We present PWMScan, a fast web-based tool to scan server-resident genomes for matches to a user-supplied PWM or transcription factor binding site model from a public database.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>The web server and source code are available at <ext-link ext-link-type="uri" xlink:href="http://ccg.vital-it.ch/pwmscan">http://ccg.vital-it.ch/pwmscan</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/pwmscan">https://sourceforge.net/projects/pwmscan</ext-link>, respectively.</p>
      </sec>
      <sec id="s3">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Swiss Institute of Bioinformatics</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Swiss Federal Institute of Technology Lausanne</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">EPFL</named-content>
          <named-content content-type="funder-identifier">10.13039/501100001703</named-content>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Knowing where transcription factors (TFs) bind to the genome is the key to understanding gene regulation. The binding specificity of a TF is commonly represented by a numerical matrix, either as a position weight matrix (PWM), a position frequency matrix (PFM) or a letter probability matrix (LPM). The three representations are information-wise equivalent and inter-convertible. A PWM contains weights for each base at each motif position. By summing up weights at corresponding positions, a binding score can be computed for any base sequence of the same length as the PWM. Large collections of TF specificity matrices are nowadays available from public libraries such as JASPAR (<xref rid="bty127-B3" ref-type="bibr">Khan <italic>et al.</italic>, 2017</xref>) or HOCOMOCO (<xref rid="bty127-B4" ref-type="bibr">Kulakovskiy <italic>et al.</italic>, 2017</xref>).</p>
    <p>PWMScan is a web-server for rapid scanning of large genomes for high-scoring matches to a user-supplied or server-resident PWM. Compared to other web-based PWM scanning tools, PWMScan is unique in that it scans server-resident whole genomes rather than user-uploaded DNA sequences. Other key features are: (i) menu-driven access to genomes of  &gt;30 model organisms; (ii) menu-driven access to  &gt;300 public PWM libraries; (iii) support of various PWM representations and formats; (iv) cut-off values can be specified as match scores or <italic>P</italic>-values; (v) output in BEDdetail format with match scores and <italic>P</italic>-values; (vi) links to UCSC genome browser for visualization of results; and (vii) action buttons to transfer match lists to analysis tools.</p>
    <p>A short description of the PWMScan server follows. Technical details about algorithms, programs and data are provided under <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>.</p>
  </sec>
  <sec>
    <title>2 Data and methods</title>
    <p>Genome sequences were downloaded from the NCBI in FASTA format. Indexed versions for rapid scanning were generated for <italic>Bowtie</italic> (<xref rid="bty127-B5" ref-type="bibr">Langmead <italic>et al.</italic>, 2009</xref>). The motif databases offered by PWMScan have been downloaded from the MEME Suite website (<xref rid="bty127-B2" ref-type="bibr">Bailey <italic>et al.</italic>, 2009</xref>). LPMs have been converted to integer PWMs (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>).</p>
    <p>The input form of the PWMScan server is shown in <xref ref-type="fig" rid="bty127-F1">Figure 1</xref>. The user chooses a genome assembly from a menu. Optionally, a BED file may be uploaded to restrict the search to genomic regions of particular interest, e.g<italic>.</italic> open chromatin regions. The right side of the form offers several ways to specify a DNA motif. PWMs from a server-resident database are chosen from a pull-down menu. Alternatively, matrices can be entered into a text area or uploaded. Accepted motif types are: PFMs, LPMs, real or integer PWMs and IUPAC consensus sequences. PFMs can be entered in several formats, including TRANSFAC and JASPAR.
</p>
    <fig id="bty127-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>Screen shot of the PWMScan graphical user interface</p>
      </caption>
      <graphic xlink:href="bty127f1"/>
    </fig>
    <p>All motif types have to be converted into integer PWMs for input to the genome search engines (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>). Default conversion parameters are proposed and can be changed by the user. For instance, real PWMs can be rescaled on input by a multiplication factor to ensure sufficient resolution after integer conversion. IUPAC consensus sequences are converted into binary matrices consisting of 0 and 1.</p>
    <p>For all matrix formats, the cut-off value can be specified as PWM score, as <italic>P</italic>-value or as percentage of the score range (0% = minimal score and 100% = maximal score). For IUPAC consensus sequences, the cut-off value is specified as a maximal number of mismatches allowed.</p>
    <p>The <italic>P</italic>-value of a PWM score <italic>x</italic> is defined as the probability that a random <italic>k</italic>-mer sequence of the length of the PWM has a binding score ≥ <italic>x</italic> given the base composition of the genome.</p>
    <p>The whole genome scan takes as input an integer PWM and a corresponding cut-off. The output is a list of sequence regions that match the PWM with a match score higher or equal to the cut-off value. Depending on the length of the PWM and the cut-off, one of the following search strategies is chosen: (i) <italic>Bowtie</italic>, a fast memory-efficient short read aligner using indexed genomes and (ii) <italic>matrix_scan</italic>, a C program developed by our group using a conventional search algorithm.</p>
    <p>The first strategy is more efficient for short PWMs and high cut-off values. It requires as a first step the generation of a list of all <italic>k-</italic>mers that match the PWM with the given cut-off. The list of <italic>k-</italic>mers is then mapped to the genome using <italic>Bowtie</italic>.</p>
    <p>The second strategy takes genome sequences in FASTA format as input. Individual chromosomes are processed in parallel and distributed to multiple cores by a Python script. We empirically found that this approach becomes more efficient if the number of <italic>k-</italic>mers exceeds 10<sup>5</sup> sequences. <italic>matrix_scan</italic> was benchmarked for speed together with five other matrix scanners and was found to be the fastest (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>).</p>
    <p>The basic search step outputs a list of PWM matches, including the genomic coordinates, the DNA sequence and the match score. Post-processing of this list involves computation of the corresponding <italic>P</italic>-values, addition of the matrix name and, optionally, elimination of overlapping matches. The final match list is provided in BEDdetail format. The output page further shows the total number of PWM matches and a sequence logo reflecting the letter-probabilities of the input matrix. Action buttons are provided for: (i) sending the match lists to analysis tools of the ChIP-Seq and SSA servers (<xref rid="bty127-B1" ref-type="bibr">Ambrosini <italic>et al.</italic>, 2016</xref>), (ii) extracting DNA sequences around the matches, (iii) sending the output to the UCSC genome browser for visualization and (iv) liftover of the match coordinates to other assemblies of the same or related species.</p>
    <p>PWMScan is meant to support many types of genomic data analysis and designed to be interoperable with other tools from our group and elsewhere. An example of a typical workflow involving ChIP-seq data is presented in <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>.</p>
    <p>PWMScan is also available as a command-line software package from SourceForge, including a master script scheduling all computational steps running during a web job.</p>
  </sec>
  <sec>
    <title>3 Benchmark</title>
    <p>The runtime of PWMScan was measured by scanning the human genome (UCSC assembly hg19) with two different PWMs from JASPAR, STAT1 with length 11 bp and CTCF with length 19 bp, and different cut-off values expressed as <italic>P</italic>-values. Results are shown in <xref rid="bty127-T1" ref-type="table">Table 1</xref>. Note that for longer motifs and higher <italic>P</italic>-values, the <italic>Bowtie</italic>-based approach becomes inefficient, whereas <italic>matrix_scan</italic> remains reasonably fast.
<table-wrap id="bty127-T1" orientation="portrait" position="float"><label>Table 1.</label><caption><p>Benchmark results with different PWMs and <italic>P-</italic>values</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col valign="top" align="left" span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="left" span="1"/></colgroup><thead><tr><th rowspan="1" colspan="1">PWM/<italic>P</italic>-value</th><th rowspan="1" colspan="1">Bowtie speed</th><th rowspan="1" colspan="1">Matrix_scan speed</th></tr></thead><tbody><tr><td rowspan="1" colspan="1">STAT1(len = 11 bp)/10<sup>−5</sup></td><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">30/5<sup>a</sup></td></tr><tr><td rowspan="1" colspan="1">STAT1(len = 11 bp)/10<sup>−4</sup></td><td rowspan="1" colspan="1">8</td><td rowspan="1" colspan="1">40/8<sup>a</sup></td></tr><tr><td rowspan="1" colspan="1">STAT1(len = 11 bp)/10<sup>−3</sup></td><td rowspan="1" colspan="1">60</td><td rowspan="1" colspan="1">65/30<sup>a</sup></td></tr><tr><td rowspan="1" colspan="1">CTCF(len = 19 bp)/10<sup>−5</sup></td><td rowspan="1" colspan="1">12</td><td rowspan="1" colspan="1">40/6<sup>a</sup></td></tr><tr><td rowspan="1" colspan="1">CTCF(len = 19 bp)/10<sup>−4</sup></td><td rowspan="1" colspan="1">90</td><td rowspan="1" colspan="1">50/10<sup>a</sup></td></tr><tr><td rowspan="1" colspan="1">CTCF(len = 19 bp)/10<sup>−3</sup></td><td rowspan="1" colspan="1">720</td><td rowspan="1" colspan="1">90/35<sup>a</sup></td></tr></tbody></table><table-wrap-foot><fn id="tblfn1"><p><italic>Note:</italic> Speed is expressed in seconds. The benchmarking tests have been run on a Linux/CentOS7/x86_64 workstation with 48 CPU-cores and 256 GB of DRAM.</p></fn><fn id="tblfn2"><label>a</label><p>Performance measurements using <italic>matrix_scan</italic> in parallel over 10 CPU-cores.</p></fn></table-wrap-foot></table-wrap></p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="bty127_supp.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>The PWMScan server is hosted by Vital-IT, the SIB Swiss Institute of Bioinformatics’ Competence Centre in Bioinformatics and Computational Biology.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the Swiss Institute of Bioinformatics and Swiss Federal Institute of Technology Lausanne (EPFL).</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="bty127-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ambrosini</surname><given-names>G.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>The ChIP-Seq tools and web server: a resource for analyzing ChIP-seq and other types of genomic data</article-title>. <source>BMC Genomics</source>, <volume>17</volume>, <fpage>938.</fpage><pub-id pub-id-type="pmid">27863463</pub-id></mixed-citation>
    </ref>
    <ref id="bty127-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bailey</surname><given-names>T.L.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>MEME Suite: tools for motif discovery and searching</article-title>. <source>Nucleic Acids Res</source>., <volume>37</volume>, <fpage>W202</fpage>–<lpage>W208</lpage>.<pub-id pub-id-type="pmid">19458158</pub-id></mixed-citation>
    </ref>
    <ref id="bty127-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Khan</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>JASPAR 2018: update of the open-access database of transcription factor binding profiles and its web framework</article-title>. <source>Nucleic Acids Res</source>., <volume>46</volume>, <fpage>D260</fpage>–<lpage>D266</lpage>.</mixed-citation>
    </ref>
    <ref id="bty127-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kulakovskiy</surname><given-names>I.V.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>HOCOMOCO: towards a complete collection of transcription factor binding models for human and mouse via large-scale ChIP-Seq analysis</article-title>. <source>Nucleic Acids Res</source>., <volume>46</volume>, <fpage>D252</fpage>–<lpage>D259</lpage>.</mixed-citation>
    </ref>
    <ref id="bty127-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Langmead</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>. <source>Genome Biol</source>., <volume>10</volume>, <fpage>R25.</fpage><pub-id pub-id-type="pmid">19261174</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
