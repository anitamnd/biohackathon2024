<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5870855</article-id>
    <article-id pub-id-type="pmid">28174903</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btx063</article-id>
    <article-id pub-id-type="publisher-id">btx063</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Phylogenetics</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Phyx: phylogenetic tools for unix</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Brown</surname>
          <given-names>Joseph W</given-names>
        </name>
        <xref ref-type="author-notes" rid="btx063-FM2"/>
        <xref ref-type="aff" rid="btx063-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Walker</surname>
          <given-names>Joseph F</given-names>
        </name>
        <xref ref-type="author-notes" rid="btx063-FM2"/>
        <xref ref-type="aff" rid="btx063-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Smith</surname>
          <given-names>Stephen A</given-names>
        </name>
        <xref ref-type="corresp" rid="btx063-cor1"/>
        <!--<email>eebsmith@umich.edu</email>-->
        <xref ref-type="aff" rid="btx063-aff1"/>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kelso</surname>
          <given-names>Janet</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btx063-aff1">Department of Ecology &amp; Evolutionary Biology, University of Michigan, Ann Arbor, MI, USA</aff>
    <author-notes>
      <corresp id="btx063-cor1">To whom correspondence should be addressed. Email: <email>eebsmith@umich.edu</email></corresp>
      <fn id="btx063-FM2">
        <p>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>6</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-02-08">
      <day>08</day>
      <month>2</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>08</day>
      <month>2</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>33</volume>
    <issue>12</issue>
    <fpage>1886</fpage>
    <lpage>1888</lpage>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>9</month>
        <year>2016</year>
      </date>
      <date date-type="rev-recd">
        <day>05</day>
        <month>12</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>31</day>
        <month>1</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by-nc/4.0/" license-type="cc-by-nc">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btx063.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="SA1">
        <title>Summary</title>
        <p>The ease with which phylogenomic data can be generated has drastically escalated the computational burden for even routine phylogenetic investigations. To address this, we present <monospace>phyx</monospace>: a collection of programs written in C ++ to explore, manipulate, analyze and simulate phylogenetic objects (alignments, trees and MCMC logs). Modelled after Unix/GNU/Linux command line tools, individual programs perform a single task and operate on standard I/O streams that can be piped to quickly and easily form complex analytical pipelines. Because of the stream-centric paradigm, memory requirements are minimized (often only a single tree or sequence in memory at any instance), and hence <monospace>phyx</monospace> is capable of efficiently processing very large datasets.</p>
      </sec>
      <sec id="SA2">
        <title>Availability and Implementation</title>
        <p><monospace>phyx</monospace> runs on POSIX-compliant operating systems. Source code, installation instructions, documentation and example files are freely available under the GNU General Public License at <ext-link ext-link-type="uri" xlink:href="https://github.com/FePhyFoFum/phyx">https://github.com/FePhyFoFum/phyx</ext-link></p>
      </sec>
      <sec id="SA3">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">NSF AVATOL</named-content>
          <named-content content-type="funder-identifier">10.13039/100000001</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">NSF DEB</named-content>
          <named-content content-type="funder-identifier">10.13039/100000001</named-content>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>Phylogenetic and phylogenomic analyses now involve massive datasets which makes traditional approaches for the analysis and manipulation of data onerous undertakings. A number of phylogenetic toolkits exist including but not limited to <monospace>ETE</monospace> (<xref rid="btx063-B2" ref-type="bibr">Huerta-Cepas <italic>et al.</italic>, 2016</xref>), <monospace>newick utilities</monospace> (<xref rid="btx063-B3" ref-type="bibr">Junier and Zdobnov, 2010</xref>), <monospace>Mesquite</monospace> (<xref rid="btx063-B4" ref-type="bibr">Maddison and Maddison, 2016</xref>), <monospace>ape</monospace> (<xref rid="btx063-B6" ref-type="bibr">Popescu <italic>et al.</italic>, 2012</xref>), <monospace>phyutility</monospace> (<xref rid="btx063-B7" ref-type="bibr">Smith and Dunn, 2008</xref>) and <monospace>DendroPy</monospace> (<xref rid="btx063-B10" ref-type="bibr">Sukumaran and Holder, 2010</xref>). Of course, no individual software package is exhaustive in its functionality (i.e. methods and supported file formats), so these packages largely complement one another, both in terms of novel and overlapping functionalities (i.e. confirming computed values), with differences (e.g. in memory requirements and speed) sometimes making certain packages more conducive to particular workflows. However, despite the rich diversity of existing tools, there is a niche to be filled for programs that are conducive to high throughput processes and the convenience of a POSIX-style interface.</p>
    <p>In an effort to provide a more flexible and efficient software package for processing phylogenetic data and for conducting phylogenomic research we present <monospace>phyx</monospace>, a set of programs to carry out a wide range of phylogenetic tasks. Written in C ++ and modeled after Unix/GNU/Linux command line tools, individual programs perform a single task, have individual manual (i.e. man) pages and operate on standard I/O streams. A result of this stream-centric approach is that, for most programs, only a single sequence or tree is in memory at any moment. Thus, large datasets can be processed with minimal memory requirements. <monospace>phyx</monospace>’s ever-growing complement of programs currently consists of 35+ programs (see <xref rid="btx063-T1" ref-type="table">Table 1</xref> for a subset) focused on exploring, manipulating, analyzing and simulating phylogenetic objects (alignments, trees and MCMC logs). As with standard Unix command line tools, these programs can be piped (together with non-<monospace>phyx</monospace> tools), allowing the easy construction of efficient analytical pipelines. <monospace>phyx</monospace> also logs all program calls to a plain text file, which is an executable record that can be submitted as part of a manuscript for reviewing and replicability purposes. <monospace>phyx</monospace> thus provides a convenient, lightweight and inclusive toolkit consisting of programs spanning the wide breadth of programs utilized by researchers performing phylogenomic analyses.
<table-wrap id="btx063-T1" orientation="portrait" position="float"><label>Table 1.</label><caption><p>Selected phyx programs and their functions. See github for additional details and full program list</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col valign="top" align="left" span="1"/><col valign="top" align="left" span="1"/></colgroup><thead><tr><th rowspan="1" colspan="1">Program</th><th rowspan="1" colspan="1">Function</th></tr></thead><tbody><tr><td rowspan="1" colspan="1">pxlssq/pxlstr</td><td rowspan="1" colspan="1">List attributes of alignments/trees</td></tr><tr><td rowspan="1" colspan="1">pxrms/pxrmt</td><td rowspan="1" colspan="1">Remove taxa from alignments/trees</td></tr><tr><td rowspan="1" colspan="1">pxrls/pxrlt</td><td rowspan="1" colspan="1">Relabel taxa in alignments/trees</td></tr><tr><td rowspan="1" colspan="1">pxboot</td><td rowspan="1" colspan="1">Alignment bootstrap/jackknife resampling</td></tr><tr><td rowspan="1" colspan="1">pxclsq</td><td rowspan="1" colspan="1">Remove missing/ambiguous sites from an alignment</td></tr><tr><td rowspan="1" colspan="1">pxs2fa/phy/nex</td><td rowspan="1" colspan="1">Convert alignment to fasta/phylip/Nexus format</td></tr><tr><td rowspan="1" colspan="1">pxlog</td><td rowspan="1" colspan="1">Concatenate and resample MCMC parameter/tree logs</td></tr><tr><td rowspan="1" colspan="1">pxfqfilt</td><td rowspan="1" colspan="1">Filter fastq files by quality</td></tr><tr><td rowspan="1" colspan="1">pxrr</td><td rowspan="1" colspan="1">Reroot/unroot trees</td></tr><tr><td rowspan="1" colspan="1">pxtlate</td><td rowspan="1" colspan="1">Translate nucleotide sequences</td></tr><tr><td rowspan="1" colspan="1">pxsw/pxnw</td><td rowspan="1" colspan="1">Pairwise sequence alignment</td></tr><tr><td rowspan="1" colspan="1">pxstrec</td><td rowspan="1" colspan="1">Ancestral state reconstruction, stochastic mapping</td></tr><tr><td rowspan="1" colspan="1">pxbdfit/pxbdsim</td><td rowspan="1" colspan="1">Birth-death tree inference/simulator</td></tr><tr><td rowspan="1" colspan="1">pxseqgen</td><td rowspan="1" colspan="1">Simulate nucleotide/protein sequences on user tree</td></tr></tbody></table></table-wrap></p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 File processing, manipulation and conversion</title>
      <p>File manipulation and conversion is a tedious and error-prone, but often required, component of phylogenetic analysis, made more burdensome by the volume of data available in current phylogenomics studies. <monospace>phyx</monospace> supports the popular formats for sequence alignments (fasta, fastq, phylip and Nexus) and trees (newick and Nexus), and provides lightweight, high-throughput utilities to convert data among formats without the user needing to provide the format of the original data as <monospace>phyx</monospace> will attempt to auto-detect the original format. Alignments can be further manipulated by removing individual taxa, resampling (bootstrap or jackknifing), sequence recoding, translation to protein, reverse complementation, filtering by quality scores or the amount of missing data, and concatenation across mixed alignment formats.</p>
      <p>Processing large data matrices is only one step required for phylogenomic analyses. In order to perform downstream analyses (e.g. orthology detection (<xref rid="btx063-B11" ref-type="bibr">Yang and Smith, 2014</xref>), mapping gene trees to species tree (<xref rid="btx063-B8" ref-type="bibr">Smith <italic>et al.</italic>, 2015</xref>), or gene tree/species tree reconciliation (<xref rid="btx063-B5" ref-type="bibr">Mirarab <italic>et al.</italic>, 2014</xref>)) it is now also essential to be able to manipulate individual gene trees constructed from these data. <monospace>phyx</monospace> enables fast, efficient manipulations such as pruning individual taxa, extracting subclades and rerooting/unrooting trees. Finally, Bayesian MCMC analyses involving phylogenies have become common in the biological sciences, and often involve large log files generated from replicated analyses. <monospace>phyx</monospace> enables both the concatenation and resampling (burnin and/or thinning) of MCMC tree or parameter logs for downstream summary.</p>
    </sec>
    <sec>
      <title>2.2 Analysis and simulation</title>
      <p>In addition to file manipulation, <monospace>phyx</monospace> provides a growing number of tools for data analysis and simulation. Analytical capabilities presently include pairwise sequence alignment using either the Needleman-Wunsch or Smith-Waterman algorithms, tree inference using the neighbour-joining criterion, ancestral state reconstruction and stochastic mapping of discrete characters, fitting of Brownian or OU models to continuous characters, fitting birth-death models to trees, and computing alignment column bipartitions either in isolation or on a user tree.</p>
      <p>Data simulation is an essential tool with which to explore model sensitivity and adequacy through parametric bootstrapping or posterior predictive analyses (<xref rid="btx063-B1" ref-type="bibr">Bollback, 2002</xref>). <monospace>phyx</monospace> currently enables simulation of both birth-death trees (see example in <xref ref-type="fig" rid="btx063-F1">Fig. 1</xref>) and nucleotide or protein alignments given a tree and substitution model parameters.</p>
      <fig id="btx063-F1" orientation="portrait" position="float">
        <label>Fig. 1.</label>
        <caption>
          <p>Parametric bootstrapping of a diversification process. The primate phylogeny of <xref rid="btx063-B9" ref-type="bibr">Springer <italic>et al.</italic> (2012)</xref> was fit to a birth-death model (pxbdfit). To explore the breadth of plausible diversification outcomes the maximum likelihood parameters (b: 0.339487, d: 0.268944) were used to simulate (pxbdsim) 25 000 phylogenies conditioned on either the extant diversity (367, left) or root age (66.7066 Ma, right) of the empirical tree</p>
        </caption>
        <graphic xlink:href="btx063f1"/>
      </fig>
    </sec>
    <sec>
      <title>2.3 Comparison to existing programs</title>
      <p>While we view <monospace>phyx</monospace> as a complement to existing tools, we demonstrate the relative performance (speed and memory requirements) of some <monospace>phyx</monospace> programs for common phylogenomics tasks in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Data</xref>, available at <italic>Bioinformatics</italic> online.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Conclusion</title>
    <p><monospace>phyx</monospace> was designed to complement existing phylogenetic toolkits by enabling the exploration, manipulation, analysis and simulation of phylogenetic objects directly from the command line. Moreover, by conforming to a stream-centric approach, memory requirements are reduced significantly so that large volumes of data can be processed on even personal laptop computers.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="btx063_supp.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Ya Yang, Jeff Johnson and three anonymous reviewers for helpful suggestions that significantly improved the manuscript, and Ning Wang, Jeff Johnson and Ross Mounce for testing.</p>
    <sec>
      <title>Funding</title>
      <p>SAS and JWB were supported by the NSF AVATOL Grant 1207915, and JFW was supported by NSF DEB Grant 1354048.</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="btx063-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bollback</surname><given-names>J.P.</given-names></name></person-group> (<year>2002</year>) 
<article-title>Bayesian model adequacy and choice in phylogenetics</article-title>. <source>Mol. Biol. Evol</source>., <volume>19</volume>, <fpage>1171</fpage>–<lpage>1180</lpage>.<pub-id pub-id-type="pmid">12082136</pub-id></mixed-citation>
    </ref>
    <ref id="btx063-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Huerta-Cepas</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>ETE 3: reconstruction, analysis, and visualization of phylogenomic data</article-title>. <source>Mol. Biol. Evol</source>., <volume>33</volume>, <fpage>1635</fpage>–<lpage>1638</lpage>.<pub-id pub-id-type="pmid">26921390</pub-id></mixed-citation>
    </ref>
    <ref id="btx063-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Junier</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Zdobnov</surname><given-names>E.M.</given-names></name></person-group> (<year>2010</year>) 
<article-title>The newick utilities: high-throughput phylogenetic tree processing in the unix shell</article-title>. <source>Bioinformatics</source>, <volume>26</volume>, <fpage>1669</fpage>–<lpage>1670</lpage>.<pub-id pub-id-type="pmid">20472542</pub-id></mixed-citation>
    </ref>
    <ref id="btx063-B4">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Maddison</surname><given-names>W.P.</given-names></name>, <name name-style="western"><surname>Maddison</surname><given-names>D.R.</given-names></name></person-group> (<year>2017</year>) Mesquite: a modular system for evolutionary analysis. Version 3.2, <ext-link ext-link-type="uri" xlink:href="http://mesquiteproject.org">http://mesquiteproject.org</ext-link>.</mixed-citation>
    </ref>
    <ref id="btx063-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mirarab</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>ASTRAL: genome-scale coalescent-based species tree estimation</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>i541</fpage>–<lpage>i548</lpage>.<pub-id pub-id-type="pmid">25161245</pub-id></mixed-citation>
    </ref>
    <ref id="btx063-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Popescu</surname><given-names>A.A.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>ape 3.0: New tools for distance-based phylogenetics and evolutionary analysis in r</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>1536</fpage>–<lpage>1537</lpage>.<pub-id pub-id-type="pmid">22495750</pub-id></mixed-citation>
    </ref>
    <ref id="btx063-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Smith</surname><given-names>S.A.</given-names></name>, <name name-style="western"><surname>Dunn</surname><given-names>C.W.</given-names></name></person-group> (<year>2008</year>) 
<article-title>Phyutility: a phyloinformatics tool for trees, alignments and molecular data</article-title>. <source>Bioinformatics</source>, <volume>24</volume>, <fpage>715</fpage>–<lpage>716</lpage>.<pub-id pub-id-type="pmid">18227120</pub-id></mixed-citation>
    </ref>
    <ref id="btx063-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Smith</surname><given-names>S.A.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Analysis of phylogenomic datasets reveals conflict, concordance, and gene duplications with examples from animals and plants</article-title>. <source>BMC Evol. Biol</source>., <volume>15</volume>, <fpage>1</fpage>–<lpage>15</lpage>.<pub-id pub-id-type="pmid">25608511</pub-id></mixed-citation>
    </ref>
    <ref id="btx063-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Springer</surname><given-names>M.S.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Macroevolutionary dynamics and historical biogeography of primate diversification inferred from a species supermatrix</article-title>. <source>PLoS ONE</source>, <volume>7</volume>, <fpage>1</fpage>–<lpage>23</lpage>.</mixed-citation>
    </ref>
    <ref id="btx063-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sukumaran</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Holder</surname><given-names>M.T.</given-names></name></person-group> (<year>2010</year>) 
<article-title>DendroPy: a python library for phylogenetic computing</article-title>. <source>Bioinformatics</source>, <volume>26</volume>, <fpage>1569</fpage>–<lpage>1571</lpage>.<pub-id pub-id-type="pmid">20421198</pub-id></mixed-citation>
    </ref>
    <ref id="btx063-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Smith</surname><given-names>S.A.</given-names></name></person-group> (<year>2014</year>) 
<article-title>Orthology inference in nonmodel organisms using transcriptomes and low-coverage genomes: Improving accuracy and matrix occupancy for phylogenomics</article-title>. <source>Mol. Biol. Evol</source>., <volume>31</volume>, <fpage>3081</fpage>–<lpage>3092</lpage>.<pub-id pub-id-type="pmid">25158799</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
