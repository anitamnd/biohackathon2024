<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//ACS//DTD ACS Journal DTD v1.02 20061031//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName ACSJournal-v102.dtd?>
<?SourceDTD.Version 1.02?>
<?ConverterInfo.XSLTName acs2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Anal Chem</journal-id>
    <journal-id journal-id-type="iso-abbrev">Anal Chem</journal-id>
    <journal-id journal-id-type="publisher-id">ac</journal-id>
    <journal-id journal-id-type="coden">ancham</journal-id>
    <journal-title-group>
      <journal-title>Analytical Chemistry</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0003-2700</issn>
    <issn pub-type="epub">1520-6882</issn>
    <publisher>
      <publisher-name>American Chemical Society</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9047440</article-id>
    <article-id pub-id-type="pmid">35412809</article-id>
    <article-id pub-id-type="doi">10.1021/acs.analchem.1c05224</article-id>
    <article-categories>
      <subj-group>
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>automRm: An R Package for Fully Automatic LC-QQQ-MS
Data Preprocessing Powered by Machine Learning</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="ath1">
        <name>
          <surname>Eilertz</surname>
          <given-names>Daniel</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author" id="ath2">
        <name>
          <surname>Mitterer</surname>
          <given-names>Michael</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="ath3">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-6547-0076</contrib-id>
        <name>
          <surname>Buescher</surname>
          <given-names>Joerg M.</given-names>
        </name>
        <xref rid="cor1" ref-type="other">*</xref>
      </contrib>
      <aff id="aff1">Metabolomics Core Facility, <institution>Max Planck Institute of Immunobiology and Epigenetics</institution>, Stübeweg 51, 79108 Freiburg, <country>Germany</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>*</label>Email: <email>buescher@ie-freiburg.mpg.de</email>.</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>04</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <day>26</day>
      <month>04</month>
      <year>2022</year>
    </pub-date>
    <volume>94</volume>
    <issue>16</issue>
    <fpage>6163</fpage>
    <lpage>6171</lpage>
    <history>
      <date date-type="received">
        <day>02</day>
        <month>12</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>31</day>
        <month>03</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2022 The Authors. Published by American Chemical Society</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>The Authors</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>Permits the broadest form of re-use including for commercial purposes, provided that author attribution and integrity are maintained (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>).</license-p>
      </license>
    </permissions>
    <abstract>
      <p content-type="toc-graphic">
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac1c05224_0012" id="ab-tgr1"/>
      </p>
      <p>Preprocessing of
liquid chromatography-mass spectrometry (LC-MS)
raw data facilitates downstream statistical and biological data analyses.
In the case of targeted LC-MS data, consistent recognition of chromatographic
peaks is a main challenge, in particular, for low abundant signals.
Fully automatic preprocessing is faster than manual peak review and
does not depend on the individual operator. Here, we present the R
package automRm for fully automatic preprocessing of LC-MS data recorded
in MRM mode. Using machine learning (ML) for detection of chromatographic
peaks and quality control of reported results enables the automatic
recognition of complex patterns in raw data. In addition, this approach
renders automRm generally applicable to a wide range of analytical
methods including hydrophilic interaction liquid chromatography (HILIC),
which is known for sample-to-sample variations in peak shape and retention
time. We demonstrate the impact of the choice of training data set,
of the applied ML algorithm, and of individual peak characteristics
on automRm’s ability to correctly report chromatographic peaks.
Next, we show that automRm can replicate results obtained by manual
peak review on published data. Moreover, automRm outperforms alternative
software solutions regarding the variation in peak integration among
replicate measurements and the number of correctly reported peaks
when applied to a HILIC-MS data set. The R package is freely available
from gitlab (<uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://gitlab.gwdg.de/joerg.buescher/automrm">https://gitlab.gwdg.de/joerg.buescher/automrm</uri>).</p>
    </abstract>
    <custom-meta-group>
      <custom-meta>
        <meta-name>document-id-old-9</meta-name>
        <meta-value>ac1c05224</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>document-id-new-14</meta-name>
        <meta-value>ac1c05224</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>ccc-price</meta-name>
        <meta-value/>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <p id="sec1">Metabolomics
aims to study the
metabolism of organisms or cells by simultaneously measuring many
metabolites. Metabolomics has been successfully applied in diverse
fields of research such as cancer research,<sup><xref ref-type="bibr" rid="ref1">1</xref></sup> immunology,<sup><xref ref-type="bibr" rid="ref2">2</xref></sup> and environmental science.<sup><xref ref-type="bibr" rid="ref3">3</xref></sup> For an introduction to the topic from a user
point of view, we recommend a recent review by Cholsoon and Rabinowitz.<sup><xref ref-type="bibr" rid="ref4">4</xref></sup></p>
  <p>Metabolomics experiments are typically
composed of four steps (<xref rid="fig1" ref-type="fig">Figure <xref rid="fig1" ref-type="fig">1</xref></xref>): first, metabolites
are extracted from a biological specimen (tissue, cultured cells,
body fluid, etc.) during sample preparation. Depending on the nature
of the sample and the analytical method, additional steps might be
required to further clean up the sample, concentrate the sample, or
change the solvent. Second, the metabolites in the extract are quantified.
Popular technologies to perform this step are gas chromatography (GC)
or liquid chromatography (LC) coupled to mass spectrometry (MS) or
nuclear magnetic resonance (NMR). Typically, the data is recorded
in a vendor-specific file format. The third step is data preprocessing,
which takes the recorded raw data as input and extracts intensity
values for every feature and every metabolite. In nontargeted metabolomics,
preprocessing can also include the identification of the metabolites
that are represented by a feature. In the fourth step, the feature
table is used to perform statistical analyses and to draw conclusions
that answer the underlying experimental question.</p>
  <fig id="fig1" position="float">
    <label>Figure 1</label>
    <caption>
      <p>Steps of metabolomics
experiments. Sample preparation includes
all steps from a biological specimen to a sample that is suitable
to be measured. Data acquisition uses an analytical machine to record
signals representing metabolites. Preprocessing takes the acquired
raw data and extracts relevant information. Data analysis links the
measured information with its biological context to generate knowledge.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac1c05224_0002" id="gr1" position="float"/>
  </fig>
  <p>Metabolomics experiments can be either targeted
or nontargeted.
For the former, target metabolites are defined a priori and the MS
machine is programmed to only acquire data for these target metabolites.
Quadrupole MS is commonly used for targeted analyses because of its
low cost and superior dynamic range.<sup><xref ref-type="bibr" rid="ref5">5</xref></sup> Typical
targeted scan modes are selected ion monitoring (SIM) on single-quadrupole
MS or multiple reaction monitoring (MRM) on triple quadrupole (QQQ)
MS. In these modes, all other ions are physically filtered out before
reaching the detector. Knowing the target metabolites allows the optimization
of sample prep, chromatographic separation, and MS machine parameters
for the best possible sensitivity and specificity.</p>
  <p>Both commercial
and open-source software are available for processing
and analyzing metabolomics data. All vendors of MS machines also sell
software for the processing and analysis of data generated on their
respective machines. These software solutions vary in functionality
and user-friendliness and, being closed source software, cannot be
easily extended. Open-source software typically requires the conversion
of the raw data from a vendor-specific format to an open format such
as mzML.<sup><xref ref-type="bibr" rid="ref6">6</xref></sup> For most popular MS machines,
this can be achieved by msconvert/ProteoWizard.<sup><xref ref-type="bibr" rid="ref7">7</xref></sup> Many open-source software are available for the processing
of nontargeted metabolomics data or the targeted analysis of raw data
acquired in full-scan mode, but only a few can handle QQQ-MS data.<sup><xref ref-type="bibr" rid="ref8">8</xref></sup></p>
  <p>A major challenge in data preprocessing
is that incorrect and inconsistent
selection of chromatographic peaks can introduce quantitative variation
on top of the well-recognized analytical and biological variation.<sup><xref ref-type="bibr" rid="ref9">9</xref></sup> This problem is aggravated with the increasing
use of hydrophilic interaction liquid chromatography (HILIC) in metabolomics
applications, which often suffers from suboptimal retention time (RT)
reproducibility.<sup><xref ref-type="bibr" rid="ref10">10</xref></sup> Typically, some form
of user intervention or user oversight is required to obtain satisfactory
data processing of targeted metabolomics data.</p>
  <p>Manual peak review
greatly profits from the operator’s experience
with the employed chromatographic separation and mass spectrometric
detection. It encompasses several tasks for which operators typically
compare multiple metabolites and samples before making a decision.
For example, selecting the correct peak can be challenging when there
are other, incorrect, peaks that might even have higher intensity
and similar RT. Selecting the correct peak borders (start, end, baseline)
can be difficult if there is a nonflat background signal. In real-world
metabolomics data, this leads to many borderline decisions that greatly
depend on the individual operator.</p>
  <p>Fully automatic data preprocessing
can have several advantages.
It requires no expert knowledge of metabolomics technology by the
operator and can thus be used by many scientists. Fully automatic
processing can be performed in minutes, while manual peak review of
the same data set can take hours or even days. Since computers do
not make random errors, the whole process is highly reproducible.
In addition, computers do not have any expectations concerning the
result of an experiment and therefore do not risk introducing an expectation
bias in the data. The challenge is to develop fully automatic data
preprocessing that performs as well or even better than a human expert.
Here, we present automRm, an R package for fully automatic preprocessing
of LC-QQQ-MS data that is suitable for both HILIC and reversed-phase
chromatography. Two key steps of automRm, namely, peak picking and
peak reporting, rely on machine learning (ML) because it allows the
recognition of complex patterns in high-dimensional input data.<sup><xref ref-type="bibr" rid="ref11">11</xref></sup></p>
  <sec id="sec2">
    <title>Materials and Methods</title>
    <p>We have developed
and tested automRm in R version 3.6.0 on a 64-bit
Linux machine. In addition, we have tested automRm in R version 4.0.2
on a 64-bit laptop running macOS 10.14.</p>
    <p>Installation of automRm
is simple from the R console using this
command:</p>
    <p>devtools::install_gitlab(’joerg.buescher/automRm@master’,
host = ‘<uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://gitlab.gwdg.de">https://gitlab.gwdg.de</uri>’).</p>
    <sec id="sec2.1">
      <title>Sample Preparation</title>
      <p>Different concentrations of acetyl-CoA
(0, 0.01, 0.1, 1 ppm) were spiked into four different matrices (Milli-Q
H<sub>2</sub>O, commercially available fetal bovine serum (FBS), extract
of HepG2 cells, extract of HEK293 cells). For Milli-Q H<sub>2</sub>O and FBS, 100 μL was added to 400 μL of solvent, vortexed,
incubated for 5 min on wet ice, and centrifuged (3 min at 20 000<italic>g</italic>). Three different solvent compositions were used: 100%
methanol, 100% acetonitrile, and 50:50 methanol/acetonitrile. Three
different solvent compositions were used to extract cells at a concentration
of 2 × 10<sup>6</sup> cells/mL: 80:20 methanol/Milli-Q H<sub>2</sub>O, 80:20 acetonitrile/Milli-Q H<sub>2</sub>O, and 40:40:20
methanol/acetonitrile/Milli-Q H<sub>2</sub>O. Extracts were vortexed,
incubated for 5 min on wet ice, and centrifuged (3 min at 20 000<italic>g</italic>). For HILIC chromatography, clear supernatants were transferred
to PCR plates, an equal volume of <sup>13</sup>C yeast extract (ISOtopic
solutions) was added, and the plate was sealed with an EZpearce film
and stored at −80 °C until analysis. For reversed-phase
analysis, an aliquot of extract was added to an equal volume of <sup>13</sup>C yeast extract, and then the mixture was dried by speedvac
and resuspended in the original volume in Milli-Q H<sub>2</sub>O prior
to transfer to PCR plates, which were sealed with an EZpearce film
and stored at −80 °C.</p>
    </sec>
    <sec id="sec2.2">
      <title>LC-QQQ-MS</title>
      <p>Three
different chromatographic methods were
used. All targeted metabolite quantifications by LC-MS were carried
out using an Agilent 1290 Infinity II UHPLC in line with an Agilent
6495 QQQ-MS operating in MRM mode (HILIC method 1) or DMRM mode (HILIC
method 2 and reversed-phase method). MRM transitions were optimized
separately for all compounds using pure standards or inferred from
closely related compounds. Both data sets HILIC 1a and HILIC 1b were
recorded using HILIC method 1 but with different sets of target compounds.</p>
    </sec>
    <sec id="sec2.3">
      <title>Chromatographic Separation by HILIC Method 1 (LunaNH2)</title>
      <p>The
LunaNH2 HILIC method has been adapted from a previously published
method by Bajad et al.<sup><xref ref-type="bibr" rid="ref21">21</xref></sup> Chromatographic
separation was performed using a Phenomenex LunaNH2 column (50 ×
2 mm, 3 μm particles). Buffer A was 10 mM NH<sub>4</sub>OH in
water, and buffer B was 5 mM ammonium carbonate in 90:10 acetonitrile/water.
The gradient profile was 0 min, 100% B, 1 mL/min; 0.5 min, 100% B,
1 mL/min; 4.7 min, 30% B, 0.75 mL/min; 5.1 min, 10% B, 0.75 mL/min;
7.5 min, 10% B, 0.75 mL/min, 7.8 min, 100% B, 0.75 mL/min; 8.4 min,
100% B, 1 mL/min; and stop time: 9.5 min. The injection volume was
3 μL, the column temperature was 30 °C, and the autosampler
temperature was 5 °C. MS source parameters were as follows: gas
temp: 200 °C, gas flow: 17 L/min, nebulizer: 60 psi, sheath gas
temp: 350 °C, sheath gas flow: 11 L/min, capillary voltage: 1800
V, and nozzle voltage: 800 V. iFunnel parameters were as follows:
high-pressure RF positive: 110 V, high-pressure RF negative: 90 V,
low-pressure RF positive: 80 V, and low-pressure RF negative: 60 V.</p>
    </sec>
    <sec id="sec2.4">
      <title>Chromatographic Separation by HILIC Method 2 (iHILIC(P))</title>
      <p>The iHILIC(P) method has been adapted from a previously published
method by Chaleckis et al.<sup><xref ref-type="bibr" rid="ref22">22</xref></sup> Chromatographic
separation was performed using a HILICON iHILIC(P) classic column
(100 × 2 mm, 5 μm particles). Buffer A was 20 mM ammonium
carbonate and 5 μM medronic acid in Milli-Q H<sub>2</sub>O and
buffer B was 90:10 acetonitrile/buffer A. The gradient profile was
0 min, 95% B, 120 μL/min; 18 min, 55% B, 120 μL/min; 19
min, 20% B, 120 μL/min; 21.5 min, 20% B, 120 μL/min; 22
min, 95% B, 120 μL/min; 23.5 min, 95% B, 120 μL/min, 25.5
min, 95% B, 300 μL/min; and stop time: 30 min. The injection
volume was 2 μL, the column temperature was 40 °C, and
the autosampler temperature was 5 °C. MS source parameters were
as follows: gas temp: 240 °C, gas flow: 15 L/min, nebulizer:
50 psi, sheath gas temp: 400 °C, sheath gas flow: 11 L/min, capillary
voltage: 2000 V, and nozzle voltage: 300 V. iFunnel parameters were
as follows: high-pressure RF positive: 110 V, high-pressure RF negative:
90 V, low-pressure RF positive: 80 V, and low-pressure RF negative:
60 V.</p>
    </sec>
    <sec id="sec2.5">
      <title>Chromatographic Separation by Reversed Phase</title>
      <p>Reversed-phase
LC has been widely used in metabolomics; this method has been adapted
from previous methods.<sup><xref ref-type="bibr" rid="ref23">23</xref>−<xref ref-type="bibr" rid="ref26">26</xref></sup> Chromatographic separation was performed using a Waters CSH C18
column (100 × 2 mm, 1.7 μm particles). Buffer A was 0.1%
formic acid in water, and buffer B was 50:50 acetonitrile/methanol.
The gradient profile was 0 min, 0% B; 4 min, 0% B; 19 min, 97% B;
24.5 min, 97% B; 25 min, 0% B; 27 min, 0% B; and stop time: 27 min.
The flow rate was 400 μL/min, the injection volume was 3 μL,
the column temperature was 30 °C, and the autosampler temperature
was 5 °C. MS source parameters were as follows: gas temp: 200 °C,
gas flow: 17 L/min, nebulizer: 60 psi, sheath gas temp: 350 °C,
sheath gas flow: 11 L/min, capillary voltage: 1800 V, and nozzle voltage:
800 V. iFunnel parameters were as follows: high-pressure RF positive:
110 V, high-pressure RF negative: 90 V, low-pressure RF positive:
80 V, and low-pressure RF negative: 60 V.</p>
    </sec>
  </sec>
  <sec id="sec3">
    <title>Results and Discussion</title>
    <sec id="sec3.1">
      <title>Implementation
of automRm in R</title>
      <p>We have opted to implement
automRm in the R environment<sup><xref ref-type="bibr" rid="ref12">12</xref></sup> because
of its widespread use in the metabolomics community and the many available
packages that facilitate handling of mass spectrometry data in general
and metabolomics data in particular. In fact, automRm depends on several
packages such as mzR<sup><xref ref-type="bibr" rid="ref7">7</xref></sup> for parsing of mzML
files, caret<sup><xref ref-type="bibr" rid="ref13">13</xref></sup> for machine learning (ML),
and openxlsx<sup><xref ref-type="bibr" rid="ref14">14</xref></sup> for reading and writing
of xlsx files. The standard output of automRm is tailored for scientists
who are not experts in metabolomics or R and therefore comes in xlsx
and pdf formats. In addition, the results generated by automRm can
easily be used within R to perform advanced statistical analyses or
generate additional plots. There are two main functions in automRm:
process_batch() for preprocessing of batches of raw data and train_model()
for training the ML models used in process_batch(). The complete functionality
of automRm including training of ML models, batchwise preprocessing
of raw data, and manual peak review is also available through a graphical
user interface automrm_gui() (<xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref>).</p>
      <fig id="fig2" position="float">
        <label>Figure 2</label>
        <caption>
          <p>Graphical user interface (GUI) in the manual peak review
mode.
The left-hand panel allows loading of and navigation within data sets.
The right-hand panel displays selected chromatograms and allows the
modification of peak integration and export of data.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac1c05224_0003" id="gr2" position="float"/>
      </fig>
      <p>The source code of automRm including a detailed manual and
description
of the main functions in plain English is available online (<uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://gitlab.gwdg.de/joerg.buescher/automrm">https://gitlab.gwdg.de/joerg.buescher/automrm</uri>). Example data sets including input files for the training of ML
models, pretrained ML models, and data preprocessing output files
in xlsx and pdf formats are available online (<uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://gitlab.gwdg.de/joerg.buescher/demodata">https://gitlab.gwdg.de/joerg.buescher/demodata</uri>). Video tutorials for the use of automRm with command line interface
and GUI are available online (<uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://vimeo.com/681364369">https://vimeo.com/681364369</uri> and <uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://vimeo.com/681366086">https://vimeo.com/681366086</uri>).</p>
    </sec>
    <sec id="sec3.2">
      <title>Batchwise Preprocessing</title>
      <p>Preprocessing of raw data occurs
in a series of steps (<xref rid="fig3" ref-type="fig">Figure <xref rid="fig3" ref-type="fig">3</xref></xref>). Initially, user-defined processing parameters such as the
location of raw data files, the location of the saved ML models, and
the location of the xlsx file with metabolite-specific settings are
parsed from a tsv file (update_prm.tsv). Next, raw data is parsed
from mzML files and additional metabolite-specific values are parsed
from an xlsx file (metabdb.xlsx). These additional values include
the traces to use as quantifiers and qualifiers for a given metabolite,
expected RT, expected ratio of signal intensity of quantifier and
qualifier, and database IDs. Sample-specific metadata such as sample
names and biological information is then parsed from a flat file (sample.info).
Subsequently, the initial peak picking is performed independently
for each metabolite in each sample. Specifically, local maxima are
detected in a smoothed version of the quantifier trace and ranked
by peak height. The degree of smoothing and the number of candidate
peaks to be evaluated are processing parameters that can be defined
in update_prm.tsv. A total of 20 quality scores (QS) that characterize
chromatographic peaks by shape, agreement between quantifier and qualifiers,
and deviation from expected RT are calculated for each peak candidate
(<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.1c05224/suppl_file/ac1c05224_si_001.pdf">Supporting Table S1</ext-link>). These QS serve as
input for the peak picking ML model to predict the overall peak classification
score. If no ML model is present, the quality scores are averaged
to obtain the classification score. The sample with the highest average
of peak classification scores across all metabolites is then selected
as the reference sample for RT alignment. To enable subsequent training
of the peak picking ML model, QS of all detected peaks can optionally
be written to a tsv file (qslog_initial.tsv) at this stage.</p>
      <fig id="fig3" position="float">
        <label>Figure 3</label>
        <caption>
          <p>Flowchart of
the process_batch() function. Thin arrows indicate
the reading of input files and writing of output files. Thick arrows
illustrate the chronological order of subroutines used for peak picking
and peak evaluation.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac1c05224_0004" id="gr3" position="float"/>
      </fig>
      <p>We have previously observed
that RT shifts between two HILIC runs
are typically a function of the squared RT. However, RT shifts of
individual metabolites can deviate from this trend by up to 30 seconds
even for metabolites that elute in close proximity. Therefore, we
first calculate RT shifts separately for each metabolite in each sample
by the simultaneous cross-correlation of quantifier and qualifier
chromatogram with the respective chromatograms in the reference sample
in a time window around the expected RT. To eliminate artifacts from
improbably pronounced shifts, RT shifts of all metabolites in a sample
are fitted as a quadratic function of RT. This correlation is optionally
visualized (shiftplots.pdf). Subsequently, the RT shift calculation
is repeated with a smaller time window around the fitted value.</p>
      <p>To enable robust and reproducible peak detection even for noisy
and low abundant signals, we sum the RT-shifted chromatograms of a
metabolite across all samples. Next, peak picking is performed on
the summed prototype chromatogram to determine the most likely peak
candidate using the same quality scores and the same peak picking
ML model that were also used for initial peak picking. The start and
end of the best prototype peak are then propagated back to the chromatograms
of each sample to determine the peak area and peak height. To facilitate
training of the peak reporting ML model, the quality scores of all
peaks can be written to a tsv file (qslog.tsv) and a template for
generating the matching ground can be written to an xlsx file (manual_peakcheck_template.xlsx).</p>
      <p>To evaluate if the peak of a given metabolite in a given sample
is of sufficient quality to be reported to the user, the peak reporting
ML model uses the same quality scores that were previously used by
the peak picking ML model. To take into account the quality of the
peak of a metabolite in a sample relative to the quality of the respective
peaks in all samples, six quality scores are added to the original
quality scores. Specifically, these are the classification scores
from the peak picking ML model and the 0th, 25th, 50th, 75th, and
100th percentiles of these classification scores of a metabolite across
all samples. The intensity values of peaks that are selected by the
peak reporting ML model are written to an xlsx file (peakinfo.xlsx).
Additionally, the peak height and peak area, both normalized to <sup>13</sup>C qualifier or raw, are written in separate sheets as alternative
representations of relative amounts of metabolites. To provide users
with a visual impression of their data, all chromatograms are plotted
in a pdf file (peakoverview.pdf).</p>
    </sec>
    <sec id="sec3.3">
      <title>Training of ML Model</title>
      <p>The function train_model() can
generate both the peak picking ML model and the peak reporting ML
model from one set of raw data and two (expert-) user-generated training
solutions. To generate a sufficiently large training data set for
the peak picking ML model, multiple peak candidates (default = 5)
are extracted for each metabolite in each sample and saved to a tsv
file (qslog_initial.tsv) by process_batch() (<xref rid="fig3" ref-type="fig">Figure <xref rid="fig3" ref-type="fig">3</xref></xref>). Training solutions are in the form of
an xlsx file (training solution.xlsx) and must provide peak area,
peak start, and peak end for every metabolite in every sample. Absent
peaks must be indicated by peak area = 0. All peak candidates with
an apex between peak start and peak end stored in the training solution
are deemed correct peaks, while all other peaks are flagged as incorrect.
Training data sets are automatically split into subsets for training
(80%) and validation (20%) of ML models. Subsequently, hyperparameter
tuning and ML model training are performed automatically to obtain
an ML model that can best discriminate between correct and incorrect
peaks (<xref rid="fig4" ref-type="fig">Figure <xref rid="fig4" ref-type="fig">4</xref></xref>). Next,
the training data is processed by process_batch() using the newly
generated peak picking ML model to generate a tsv file (qslog.tsv)
that contains for every metabolite in every sample the classification
scores of the peak picking ML model, which are required for training
of the peak reporting ML model.</p>
      <fig id="fig4" position="float">
        <label>Figure 4</label>
        <caption>
          <p>Flowchart of the train_model() function.
Thin lines indicate input
and output files. Thick lines illustrate the chronological order of
subroutines used to train the peak picking ML model (left side) and
the peak reporting ML model (right side).</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac1c05224_0005" id="gr4" position="float"/>
      </fig>
      <p>Since automRm is designed to preprocess data without expert user
oversight, tight quality control is required to not report erroneous
or inconsistent results. The training solution must be provided in
an xlsx file (manual_peakcheck.xlsx) and contain one of three possible
scores for each metabolite in each sample: 0 = peak should not be
reported, 1 = do not use for training, and 2 = peak should be reported.
To facilitate the generation of the training solution, a template
file (manual_peakcheck_template.xlsx) is generated automatically by
process_batch() after the peak picking ML model has been trained.
Splitting of training data for training (80%) and validation (20%),
hyperparameter tuning, and ML model training are then performed automatically
to obtain an ML model that can best identify the peaks that should
be reported.</p>
    </sec>
    <sec id="sec3.4">
      <title>Impact of ML Algorithm</title>
      <p>To determine
the impact of the
employed ML algorithm, we have tested the speed and performance of
four popular ML algorithms available in the caret package,<sup><xref ref-type="bibr" rid="ref13">13</xref></sup> namely, artificial neural networks (NNet), random
forest (RF), support vector machine (SVM), and extreme gradient boosting
(XGB) (<xref rid="fig5" ref-type="fig">Figure <xref rid="fig5" ref-type="fig">5</xref></xref>). As
a measure of ML model accuracy, we have computed the F1 score, which
combines precision and recall. For all algorithms, we have separately
optimized ML model accuracy by hyperparameter tuning. For this test,
we have used the combined data set of 48 samples measured with four
LC-QQQ-MS methods. This data set contains 7817 positive and 32032
negative examples for peak picking and 4987 positive and 4164 negative
examples for peak reporting. The ground truth was generated by manually
assigning labels to all examples.</p>
      <fig id="fig5" position="float">
        <label>Figure 5</label>
        <caption>
          <p>Comparison of F1 score as a measure for
classification accuracy
among four different ML algorithms for the peak picking task and the
peak reporting task. NNet, artificial neural network; RF, random forest;
SVM, support vector machine; and XGB, extreme gradient boosting.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac1c05224_0006" id="gr5" position="float"/>
      </fig>
      <p>All algorithms performed very well for the peak
picking task with
F1 scores greater than 0.99. For the peak reporting task, random forest
or extreme gradient boosting performed better than neural networks
and support vector machines. The former two algorithms allowed almost
perfect peak classification for the peak reporting task.</p>
      <p>While
testing the accuracy of the different ML algorithms, we have
noted that the time required for training differed dramatically between
algorithms and classification tasks (<xref rid="fig6" ref-type="fig">Figure <xref rid="fig6" ref-type="fig">6</xref></xref>). Training of the peak picking ML model
was faster than that of the peak reporting ML model despite the larger
training data set of the former. Of note, random forest (RF) was the
fastest ML model to train for either task. Of note, there was hardly
any difference in the time required for the application of the ML
models in process_batch() (data not shown).</p>
      <fig id="fig6" position="float">
        <label>Figure 6</label>
        <caption>
          <p>Comparison of the time
required for training of ML models on a
consumer-grade laptop. NNet, artificial neural network; RF, random
forest; SVM, support vector machine; and XGB, extreme gradient boosting.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac1c05224_0007" id="gr6" position="float"/>
      </fig>
    </sec>
    <sec id="sec3.5">
      <title>Impact of Training Data Set</title>
      <p>To test
the impact of the
training data set on the classification quality, we have trained separate
peak picking ML models and peak reporting ML models for each of the
training data sets and on the combined data set that includes all
four training data sets (<xref rid="fig7" ref-type="fig">Figure <xref rid="fig7" ref-type="fig">7</xref></xref>). We have opted to use the random forest algorithm
for this test because of its superior combination of classification
fidelity and speed. As expected, specialized classification ML models
that were trained on only one data set perform best for the data set
that they were trained on. Peak picking ML models trained on one HILIC
data set performed better on other HILIC data sets than the peak picking
ML model that was trained on the reversed-phase data set (<xref rid="fig7" ref-type="fig">Figure <xref rid="fig7" ref-type="fig">7</xref></xref>A). Interestingly,
such a similarity among ML models trained on HILIC data sets was absent
among peak reporting ML models. For example, the peak reporting ML
model trained on the reversed-phase data set performed almost as well
as the peak reporting ML model trained on the combined data set when
used on the HILIC 1a data (<xref rid="fig7" ref-type="fig">Figure <xref rid="fig7" ref-type="fig">7</xref></xref>B). The more general classification ML model that was
trained on the combined data set delivered the second-best performance
for every single data set with F1 scores larger than 0.98 in every
case. This rendered the combined model most useful for general use
with any (future) data set.</p>
      <fig id="fig7" position="float">
        <label>Figure 7</label>
        <caption>
          <p>F1 score as a measure of classification accuracy
of (A) peak picking
ML models and (B) peak reporting ML models trained on five different
data sets and applied to four different data sets.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac1c05224_0008" id="gr7" position="float"/>
      </fig>
      <p>As the ultimate test of data preprocessing performance on
independent
data sets, we have used automRm with the “combined”
peak picking and peak reporting ML models on public data sets from
Metabolights.<sup><xref ref-type="bibr" rid="ref15">15</xref></sup> Data set MTBLS429 contains
measurements of pyrrolizidine alkaloids from leaf surfaces and leaf
tissues using reversed-phase chromatography on a C18 column coupled
to QQQ-MS detection.<sup><xref ref-type="bibr" rid="ref16">16</xref></sup> Data set MTBLS897
contains measurements of secondary metabolites from grapes using reversed-phase
chromatography on a C30 column coupled to QQQ-MS.<sup><xref ref-type="bibr" rid="ref17">17</xref></sup> To evaluate the overall performance, we correlated the
signal intensity determined by automRm to that reported by the authors
of the two data sets (<xref rid="fig8" ref-type="fig">Figure <xref rid="fig8" ref-type="fig">8</xref></xref>). In addition, we have compiled some illustrative examples
from publicly available data sets that demonstrate the performance
and limitations of fully automatic preprocessing by automRm (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.1c05224/suppl_file/ac1c05224_si_001.pdf">Supporting Table S2</ext-link>).</p>
      <fig id="fig8" position="float">
        <label>Figure 8</label>
        <caption>
          <p>Distribution of Pearson
correlation coefficients between peak areas
determined by automRm and published peak areas.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac1c05224_0009" id="gr8" position="float"/>
      </fig>
      <p>The signal intensity as measured in the peak area that had been
determined by automRm was in very good agreement (Pearson correlation
&gt;0.95) with the signal intensity values published by the authors
of
the data sets for 22 of 34 and 20 of 30 metabolites in data sets MTBLS429
and MTBLS897, respectively. The remaining metabolites fell into one
of two categories: (1) Measurements that had been filtered out by
automRm because of insufficient signal quality (indicated by correlation
coefficient = 0 in <xref rid="fig8" ref-type="fig">Figure <xref rid="fig8" ref-type="fig">8</xref></xref>). Concretely, we have trained the peak reporting ML model
to remove very low abundant measurements and metabolites with only
a quantifier trace but no qualifier trace. (2) Metabolite peaks that
were in close proximity to a much larger peak in both quantifier and
qualifier traces. Of note, these results were achieved with ML models
that had been trained mostly on HILIC data in which chromatographic
peaks frequently shift between samples and therefore deviations from
the expected RT commonly occur. With appropriate training of the ML
models on data that is more similar to these public data sets, even
better agreement between the automRm output and the originally reported
signal intensities can be expected.</p>
    </sec>
    <sec id="sec3.6">
      <title>Impact of ML Quality Scores</title>
      <p>We have compared the relative
importance of features for the peak picking ML model and the peak
reporting ML model using our combined data set and random forest ML
models (<xref rid="fig9" ref-type="fig">Figure <xref rid="fig9" ref-type="fig">9</xref></xref>).
QS representing the height of a peak relative to its surrounding had
great importance for both ML models (for example, QS_T.o: ratio of
the quantifier peak height to the highest point outside the peak,
QS_To2: like QS_T.o but for the qualifier trace, QS_T.h: ratio of
the qualifier peak height to the height of the higher peak border,
QS_T.l: ratio of the qualifier peak height to the lower peak border).
For the peak picking model, QS representing the deviation from the
expected RT (QS_dRT: deviation from the expected RT, QS_dRTs: deviation
from the expected RT taking into account the predicted peak shift
relative to the reference sample) were also important (3rd and 4th
ranks). Interestingly, they only had little influence in the peak
reporting ML model. QS that exhibited great importance in the peak
reporting ML model, but not in the peak picking ML model, describe
the shape of a peak (for example, QS_cor123: correlation among quantifier
and qualifier traces, QS_gauss: correlation of the quantifier peak
with Gauss peak). QS representing the output of the peak picking model
(output_H: score calculated by the peak reporting ML model for a metabolite
in a sample, RF0 to RF100: quantiles of output_H values of a metabolite
across all samples) are only used in the peak reporting ML model and
were found to be very important for this model.</p>
      <fig id="fig9" position="float">
        <label>Figure 9</label>
        <caption>
          <p>Relative feature importance
in random forest ML models for peak
picking and peak reporting. Interestingly, the same quality score
can have drastically different importance in the two models. For a
detailed description of quality scores, see <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.1c05224/suppl_file/ac1c05224_si_001.pdf">Supporting Table S1</ext-link>. (A) Peak picking ML model and (B) peak reporting
ML model.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac1c05224_0010" id="gr9" position="float"/>
      </fig>
    </sec>
    <sec id="sec3.7">
      <title>Comparison to Other Data
Preprocessing Solutions</title>
      <p>To
compare the performance of automRm to alternative solutions for LC-QQQ-MS
data preprocessing, we have processed our HILIC 1a data set using
automRm with the combined random forest ML models for peak picking
and peak reporting, MassHunter 8 with Agile2, MRMkit,<sup><xref ref-type="bibr" rid="ref18">18</xref></sup> MRMprobs,<sup><xref ref-type="bibr" rid="ref19">19</xref></sup> and Skyline<sup><xref ref-type="bibr" rid="ref20">20</xref></sup> (<xref rid="fig10" ref-type="fig">Figure <xref rid="fig10" ref-type="fig">10</xref></xref>). MassHunter and Skyline were designed to facilitate
manual peak review; however, we have opted to only compare the automatically
generated results retaining all reported peaks irrespective of flags.
As a measure of how reproducibly peaks were detected, we compared
the standard deviation (SD) of peak area among replicates (12 groups
of quadruplicates) for the 31 metabolites that could be processed
in all five software solutions (<xref rid="fig10" ref-type="fig">Figure <xref rid="fig10" ref-type="fig">10</xref></xref>).</p>
      <fig id="fig10" position="float">
        <label>Figure 10</label>
        <caption>
          <p>Comparison of the standard deviation of groups
of replicates in
the HILIC 1a data set processed with different algorithms.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac1c05224_0011" id="gr10" position="float"/>
      </fig>
      <p>MassHunter/Agile2 and Skyline reported a peak for almost
every
metabolite in every sample and left it to the user to remove missing
signals and correct erroneous peak detections. Consequently, the relative
SD among replicates in the automatically generated output was high.
MRMkit also reported peaks for every metabolite in every sample but
achieved more consistent peak integrations across samples indicated
by a lower average SD among replicates. MRMprobs and automRm obtained
similar SD among replicates with a slight advantage for automRm.</p>
      <p>Next, we assessed the ability of the different software solutions
to discriminate between peaks that correspond to the target metabolite
and should thus be reported (correct peaks) and all other signals.
A given chromatogram can contain zero or one correct peak, and, due
to the limited specificity of MS detection, it might contain additional
(incorrect) peaks. Ideally, data preprocessing reports the signal
intensity of all correct peaks and reports missing or zero if there
is no correct peak. We manually reviewed our HILIC 1a data set to
define all correct peaks and then classified the output of the different
software for every metabolite in every sample as one of the following:
(1) true positives (TPs): the correct peak was reported, (2) true
negatives (TNs): there is no correct peak and none was reported, (3)
false positives (FPs): an incorrect peak was reported in the presence
or absence of a correct peak, (4) false negatives (FNs): a correct
peak is present, but no peak was reported (<xref rid="tbl1" ref-type="other">Table <xref rid="tbl1" ref-type="other">1</xref></xref>). From these numbers, we then calculated
the accuracy and specificity of the classification.</p>
      <table-wrap id="tbl1" position="float">
        <label>Table 1</label>
        <caption>
          <title>Comparison of Number of Peaks That
Were Correctly or Incorrectly Reported or Not Reported for Data Set
HILIC 1a in Comparison to the Expert Review of the Data Set</title>
        </caption>
        <table frame="hsides" rules="groups" border="0">
          <colgroup>
            <col align="left"/>
            <col align="char" char="."/>
            <col align="char" char="."/>
            <col align="char" char="."/>
            <col align="char" char="."/>
            <col align="char" char="."/>
          </colgroup>
          <thead>
            <tr>
              <th style="border:none;" align="left"> </th>
              <th style="border:none;" align="center" char=".">Agile2</th>
              <th style="border:none;" align="center" char=".">automRm</th>
              <th style="border:none;" align="center" char=".">MRMkit</th>
              <th style="border:none;" align="center" char=".">MRMprobs</th>
              <th style="border:none;" align="center" char=".">Skyline</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td style="border:none;" align="left">true positive</td>
              <td style="border:none;" align="char" char=".">875</td>
              <td style="border:none;" align="char" char=".">887</td>
              <td style="border:none;" align="char" char=".">842</td>
              <td style="border:none;" align="char" char=".">820</td>
              <td style="border:none;" align="char" char=".">870</td>
            </tr>
            <tr>
              <td style="border:none;" align="left">true negative</td>
              <td style="border:none;" align="char" char=".">1</td>
              <td style="border:none;" align="char" char=".">530</td>
              <td style="border:none;" align="char" char=".">0</td>
              <td style="border:none;" align="char" char=".">366</td>
              <td style="border:none;" align="char" char=".">0</td>
            </tr>
            <tr>
              <td style="border:none;" align="left">false positive</td>
              <td style="border:none;" align="char" char=".">612</td>
              <td style="border:none;" align="char" char=".">1</td>
              <td style="border:none;" align="char" char=".">646</td>
              <td style="border:none;" align="char" char=".">201</td>
              <td style="border:none;" align="char" char=".">618</td>
            </tr>
            <tr>
              <td style="border:none;" align="left">false negative</td>
              <td style="border:none;" align="char" char=".">0</td>
              <td style="border:none;" align="char" char=".">70</td>
              <td style="border:none;" align="char" char=".">0</td>
              <td style="border:none;" align="char" char=".">101</td>
              <td style="border:none;" align="char" char=".">0</td>
            </tr>
            <tr>
              <td style="border:none;" align="left">accuracy</td>
              <td style="border:none;" align="char" char=".">0.589</td>
              <td style="border:none;" align="char" char=".">0.952</td>
              <td style="border:none;" align="char" char=".">0.566</td>
              <td style="border:none;" align="char" char=".">0.797</td>
              <td style="border:none;" align="char" char=".">0.585</td>
            </tr>
            <tr>
              <td style="border:none;" align="left">specificity</td>
              <td style="border:none;" align="char" char=".">0.002</td>
              <td style="border:none;" align="char" char=".">0.998</td>
              <td style="border:none;" align="char" char=".">0.000</td>
              <td style="border:none;" align="char" char=".">0.646</td>
              <td style="border:none;" align="char" char=".">0.000</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>Both MRMprobs and automRm used multiple peak characteristics
to
determine if a peak is of sufficient quality to be reported and thus
achieve higher accuracy and much higher specificity than the alternative
software solutions. In our comparison, automRm outperformed MRMprobs
in the number of correctly reported peaks as well as in the accuracy
and the specificity of the classification.</p>
    </sec>
  </sec>
  <sec id="sec4">
    <title>Conclusions</title>
    <p>Fully
automatic preprocessing of LC-QQQ-MS data in automRm compares
favorably to alternative automatic software solutions and is faster
and more convenient than manual peak review (the current standard
in the field). The use of machine learning enables complex automatic
decisions that surpass classical rule-based approaches. This provides
the possibility to tune the quality of the reported signals to the
required level of data reliability. With sufficient training on relevant
raw data, results from automRm can reach a similar level of quality
as manual peak review.</p>
    <p>For optimal performance, automRm requires
the use of at least one
qualifier in addition to the quantifier. We use our LC-QQQ-MS platform
for high-confidence measurements and therefore use two qualifiers
(one unlabeled and one <sup>13</sup>C labeled) wherever possible.
However, the addition of qualifiers to the acquisition method reduces
the number of analytes that can be detected simultaneously in the
MRM mode.</p>
    <p>In our hands, preprocessing of raw data is no longer
a bottleneck
in our LC-QQQ-MS pipeline since we have started to use automRm routinely.
We only retreat to manual peak review for selected metabolites in
special cases such as excessively dirty samples, very-low-input samples,
or new LC methods.</p>
  </sec>
</body>
<back>
  <notes id="notes-1" notes-type="si">
    <title>Supporting Information Available</title>
    <p>The Supporting Information
is available free of charge at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/10.1021/acs.analchem.1c05224?goto=supporting-info">https://pubs.acs.org/doi/10.1021/acs.analchem.1c05224</ext-link>.<list id="silist" list-type="simple"><list-item><p>Quality scores in automRm
(Table S1) and example chromatograms
from publicly available data sets that demonstrate the performance
and limitations of fully automatic data preprocessing by automRm (Table
S2) (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.1c05224/suppl_file/ac1c05224_si_001.pdf">PDF</ext-link>)</p></list-item></list></p>
  </notes>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sifile1">
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ac1c05224_si_001.pdf">
        <caption>
          <p>ac1c05224_si_001.pdf</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <notes notes-type="funding-statement" id="notes-2">
    <p>Open access
funded by Max Planck Society.</p>
  </notes>
  <notes notes-type="COI-statement" id="NOTES-d7e682-autogenerated">
    <p>The authors declare
no
competing financial interest.</p>
  </notes>
  <ack>
    <title>Acknowledgments</title>
    <p>The authors would
like to thank Alina Rose and Bilal Sheikh
for the kind donation of HepG2 cell pellets, Julia Zimmermann and
Angelika Rambold for the kind donation of HEK293 cell pellets, and
Marcus Rockoff for assistance with the creation of the video tutorials.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="ref1">
      <mixed-citation publication-type="journal" id="cit1"><name><surname>Schmidt</surname><given-names>D. R.</given-names></name>; <name><surname>Patel</surname><given-names>R.</given-names></name>; <name><surname>Kirsch</surname><given-names>D. G.</given-names></name>; <name><surname>Lewis</surname><given-names>C. A.</given-names></name>; <name><surname>Vander
Heiden</surname><given-names>M. G.</given-names></name>; <name><surname>Locasale</surname><given-names>J. W.</given-names></name><article-title>Metabolomics in Cancer Research and
Emerging Applications in Clinical Oncology</article-title>. <source>CA-Cancer J. Clin.</source><year>2021</year>, <volume>71</volume>, <fpage>333</fpage>–<lpage>358</lpage>. <pub-id pub-id-type="doi">10.3322/caac.21670</pub-id>.<pub-id pub-id-type="pmid">33982817</pub-id></mixed-citation>
    </ref>
    <ref id="ref2">
      <mixed-citation publication-type="book" id="cit2"><person-group person-group-type="allauthors"><name><surname>Everts</surname><given-names>B.</given-names></name></person-group><article-title>Metabolomics in
Immunology Research</article-title>. <source>Methods in Molecular
Biology</source>; <publisher-name>Humana Press</publisher-name>: <publisher-loc>New York, NY</publisher-loc>, <year>2018</year>; Vol. <volume>1730</volume>, pp <fpage>29</fpage>–<lpage>42</lpage>.<pub-id pub-id-type="pmid">29363063</pub-id></mixed-citation>
    </ref>
    <ref id="ref3">
      <mixed-citation publication-type="journal" id="cit3"><name><surname>Deng</surname><given-names>P.</given-names></name>; <name><surname>Li</surname><given-names>X.</given-names></name>; <name><surname>Petriello</surname><given-names>M. C.</given-names></name>; <name><surname>Wang</surname><given-names>C.</given-names></name>; <name><surname>Morris</surname><given-names>A. J.</given-names></name>; <name><surname>Hennig</surname><given-names>B.</given-names></name><article-title>Application
of Metabolomics to Characterize Environmental Pollutant Toxicity and
Disease Risks</article-title>. <source>Rev. Environ. Health</source><year>2019</year>, <volume>34</volume>, <fpage>251</fpage>–<lpage>259</lpage>. <pub-id pub-id-type="doi">10.1515/reveh-2019-0030</pub-id>.<pub-id pub-id-type="pmid">31408434</pub-id></mixed-citation>
    </ref>
    <ref id="ref4">
      <mixed-citation publication-type="journal" id="cit4"><name><surname>Jang</surname><given-names>C.</given-names></name>; <name><surname>Chen</surname><given-names>L.</given-names></name>; <name><surname>Rabinowitz</surname><given-names>J. D.</given-names></name><article-title>Metabolomics and Isotope Tracing</article-title>. <source>Cell</source><year>2018</year>, <volume>173</volume>, <fpage>822</fpage>–<lpage>837</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2018.03.055</pub-id>.<pub-id pub-id-type="pmid">29727671</pub-id></mixed-citation>
    </ref>
    <ref id="ref5">
      <mixed-citation publication-type="book" id="cit5"><source>Mass
Spectrometry in Polymer Chemistry</source>; <person-group person-group-type="editor"><name><surname>Barner-Kowollik</surname><given-names>C.</given-names></name>; <name><surname>Gruendling</surname><given-names>T.</given-names></name>; <name><surname>Falkenhagen</surname><given-names>J.</given-names></name>; <name><surname>Weidner</surname><given-names>S.</given-names></name></person-group>, Eds.; <publisher-name>Wiley</publisher-name>, <year>2012</year>.</mixed-citation>
    </ref>
    <ref id="ref6">
      <mixed-citation publication-type="journal" id="cit6"><name><surname>Martens</surname><given-names>L.</given-names></name>; <name><surname>Chambers</surname><given-names>M.</given-names></name>; <name><surname>Sturm</surname><given-names>M.</given-names></name>; <name><surname>Kessner</surname><given-names>D.</given-names></name>; <name><surname>Levander</surname><given-names>F.</given-names></name>; <name><surname>Shofstahl</surname><given-names>J.</given-names></name>; <name><surname>Tang</surname><given-names>W. H.</given-names></name>; <name><surname>Römpp</surname><given-names>A.</given-names></name>; <name><surname>Neumann</surname><given-names>S.</given-names></name>; <name><surname>Pizarro</surname><given-names>A. D.</given-names></name>; <name><surname>Montecchi-Palazzi</surname><given-names>L.</given-names></name>; <name><surname>Tasman</surname><given-names>N.</given-names></name>; <name><surname>Coleman</surname><given-names>M.</given-names></name>; <name><surname>Reisinger</surname><given-names>F.</given-names></name>; <name><surname>Souda</surname><given-names>P.</given-names></name>; <name><surname>Hermjakob</surname><given-names>H.</given-names></name>; <name><surname>Binz</surname><given-names>P.-A.</given-names></name>; <name><surname>Deutsch</surname><given-names>E. W.</given-names></name><article-title>MzML—a
Community Standard for Mass Spectrometry Data</article-title>. <source>Mol. Cell. Proteomics</source><year>2011</year>, <volume>10</volume>, <elocation-id>R110.000133</elocation-id><pub-id pub-id-type="doi">10.1074/mcp.R110.000133</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref7">
      <mixed-citation publication-type="journal" id="cit7"><name><surname>Chambers</surname><given-names>M. C.</given-names></name>; <name><surname>Maclean</surname><given-names>B.</given-names></name>; <name><surname>Burke</surname><given-names>R.</given-names></name>; <name><surname>Amodei</surname><given-names>D.</given-names></name>; <name><surname>Ruderman</surname><given-names>D. L.</given-names></name>; <name><surname>Neumann</surname><given-names>S.</given-names></name>; <name><surname>Gatto</surname><given-names>L.</given-names></name>; <name><surname>Fischer</surname><given-names>B.</given-names></name>; <name><surname>Pratt</surname><given-names>B.</given-names></name>; <name><surname>Egertson</surname><given-names>J.</given-names></name>; <name><surname>Hoff</surname><given-names>K.</given-names></name>; <name><surname>Kessner</surname><given-names>D.</given-names></name>; <name><surname>Tasman</surname><given-names>N.</given-names></name>; <name><surname>Shulman</surname><given-names>N.</given-names></name>; <name><surname>Frewen</surname><given-names>B.</given-names></name>; <name><surname>Baker</surname><given-names>T. A.</given-names></name>; <name><surname>Brusniak</surname><given-names>M.-Y.</given-names></name>; <name><surname>Paulse</surname><given-names>C.</given-names></name>; <name><surname>Creasy</surname><given-names>D.</given-names></name>; <name><surname>Flashner</surname><given-names>L.</given-names></name>; <name><surname>Kani</surname><given-names>K.</given-names></name>; <name><surname>Moulding</surname><given-names>C.</given-names></name>; <name><surname>Seymour</surname><given-names>S. L.</given-names></name>; <name><surname>Nuwaysir</surname><given-names>L. M.</given-names></name>; <name><surname>Lefebvre</surname><given-names>B.</given-names></name>; <name><surname>Kuhlmann</surname><given-names>F.</given-names></name>; <name><surname>Roark</surname><given-names>J.</given-names></name>; <name><surname>Rainer</surname><given-names>P.</given-names></name>; <name><surname>Detlev</surname><given-names>S.</given-names></name>; <name><surname>Hemenway</surname><given-names>T.</given-names></name>; <name><surname>Huhmer</surname><given-names>A.</given-names></name>; <name><surname>Langridge</surname><given-names>J.</given-names></name>; <name><surname>Connolly</surname><given-names>B.</given-names></name>; <name><surname>Chadick</surname><given-names>T.</given-names></name>; <name><surname>Holly</surname><given-names>K.</given-names></name>; <name><surname>Eckels</surname><given-names>J.</given-names></name>; <name><surname>Deutsch</surname><given-names>E. W.</given-names></name>; <name><surname>Moritz</surname><given-names>R. L.</given-names></name>; <name><surname>Katz</surname><given-names>J. E.</given-names></name>; <name><surname>Agus</surname><given-names>D. B.</given-names></name>; <name><surname>MacCoss</surname><given-names>M.</given-names></name>; <name><surname>Tabb</surname><given-names>D. L.</given-names></name>; <name><surname>Mallick</surname><given-names>P.</given-names></name><article-title>A Cross-Platform Toolkit
for Mass Spectrometry and Proteomics</article-title>. <source>Nat. Biotechnol.</source><year>2012</year>, <volume>30</volume>, <fpage>918</fpage>–<lpage>920</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.2377</pub-id>.<pub-id pub-id-type="pmid">23051804</pub-id></mixed-citation>
    </ref>
    <ref id="ref8">
      <mixed-citation publication-type="journal" id="cit8"><name><surname>Spicer</surname><given-names>R.</given-names></name>; <name><surname>Salek</surname><given-names>R. M.</given-names></name>; <name><surname>Moreno</surname><given-names>P.</given-names></name>; <name><surname>Cañueto</surname><given-names>D.</given-names></name>; <name><surname>Steinbeck</surname><given-names>C.</given-names></name><article-title>Navigating Freely-Available Software Tools for Metabolomics
Analysis</article-title>. <source>Metabolomics</source><year>2017</year>, <volume>13</volume>, <elocation-id>106</elocation-id><pub-id pub-id-type="doi">10.1007/s11306-017-1242-7</pub-id>.<pub-id pub-id-type="pmid">28890673</pub-id></mixed-citation>
    </ref>
    <ref id="ref9">
      <mixed-citation publication-type="journal" id="cit9"><name><surname>Yu</surname><given-names>H.</given-names></name>; <name><surname>Chen</surname><given-names>Y.</given-names></name>; <name><surname>Huan</surname><given-names>T.</given-names></name><article-title>Computational Variation: An Underinvestigated
Quantitative Variability Caused by Automated Data Processing in Untargeted
Metabolomics</article-title>. <source>Anal. Chem.</source><year>2021</year>, <volume>93</volume>, <fpage>8719</fpage>–<lpage>8728</lpage>. <pub-id pub-id-type="doi">10.1021/acs.analchem.0c03381</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref10">
      <mixed-citation publication-type="journal" id="cit10"><name><surname>Tang</surname><given-names>D.-Q.</given-names></name>; <name><surname>Zou</surname><given-names>L.</given-names></name>; <name><surname>Yin</surname><given-names>X.-X.</given-names></name>; <name><surname>Ong</surname><given-names>C. N.</given-names></name><article-title>HILIC-MS
for Metabolomics: An Attractive
and Complementary Approach to RPLC-MS</article-title>. <source>Mass
Spectrom. Rev.</source><year>2016</year>, <volume>35</volume>, <fpage>574</fpage>–<lpage>600</lpage>. <pub-id pub-id-type="doi">10.1002/mas.21445</pub-id>.<pub-id pub-id-type="pmid">25284160</pub-id></mixed-citation>
    </ref>
    <ref id="ref11">
      <mixed-citation publication-type="journal" id="cit11"><name><surname>Liebal</surname><given-names>U. W.</given-names></name>; <name><surname>Phan</surname><given-names>A. N. T.</given-names></name>; <name><surname>Sudhakar</surname><given-names>M.</given-names></name>; <name><surname>Raman</surname><given-names>K.</given-names></name>; <name><surname>Blank</surname><given-names>L. M.</given-names></name><article-title>Machine
Learning Applications for Mass Spectrometry-Based Metabolomics</article-title>. <source>Metabolites</source><year>2020</year>, <volume>10</volume>, <fpage>243</fpage><pub-id pub-id-type="doi">10.3390/metabo10060243</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref12">
      <mixed-citation publication-type="book" id="cit12"><collab>R Core Team</collab>. <article-title>R: A Language
and Environment
for Statistical Computing</article-title>. <publisher-name>R Foundation
for Statistical Computing</publisher-name>: <publisher-loc>Vienna,
Austria</publisher-loc>, <year>2019</year>.</mixed-citation>
    </ref>
    <ref id="ref13">
      <mixed-citation publication-type="journal" id="cit13"><name><surname>Kuhn</surname><given-names>M.</given-names></name><article-title>Building Predictive
Models in R Using the Caret Package</article-title>. <source>J. Stat.
Software</source><year>2008</year>, <volume>28</volume>, <fpage>1</fpage>–<lpage>26</lpage>. <pub-id pub-id-type="doi">10.18637/jss.v028.i05</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref14">
      <mixed-citation publication-type="undeclared" id="cit14"><person-group person-group-type="allauthors"><name><surname>Schauberger</surname><given-names>P.</given-names></name>; <name><surname>Walker</surname><given-names>A.</given-names></name></person-group><source>openxlsx:
Read, Write and Edit xlsx Files</source>, <year>2022</year>, <uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://ycphs.github.io/openxlsx/index.html">https://ycphs.github.io/openxlsx/index.html</uri> (accessed April 11, 2022).</mixed-citation>
    </ref>
    <ref id="ref15">
      <mixed-citation publication-type="journal" id="cit15"><name><surname>Haug</surname><given-names>K.</given-names></name>; <name><surname>Cochrane</surname><given-names>K.</given-names></name>; <name><surname>Nainala</surname><given-names>V. C.</given-names></name>; <name><surname>Williams</surname><given-names>M.</given-names></name>; <name><surname>Chang</surname><given-names>J.</given-names></name>; <name><surname>Jayaseelan</surname><given-names>K. V.</given-names></name>; <name><surname>O’Donovan</surname><given-names>C.</given-names></name><article-title>MetaboLights: A Resource Evolving
in Response to the Needs of Its Scientific Community</article-title>. <source>Nucleic Acids Res.</source><year>2020</year>, <volume>48</volume>, <fpage>D440</fpage>–<lpage>D444</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkz1019</pub-id>.<pub-id pub-id-type="pmid">31691833</pub-id></mixed-citation>
    </ref>
    <ref id="ref16">
      <mixed-citation publication-type="journal" id="cit16"><name><surname>Cheng</surname><given-names>D.</given-names></name>; <name><surname>Mulder</surname><given-names>P. P. J.</given-names></name>; <name><surname>van der Meijden</surname><given-names>E.</given-names></name>; <name><surname>Klinkhamer</surname><given-names>P. G. L.</given-names></name>; <name><surname>Vrieling</surname><given-names>K.</given-names></name><article-title>The Correlation between Leaf-Surface and Leaf-Tissue
Secondary Metabolites: A Case Study with Pyrrolizidine Alkaloids in
Jacobaea Hybrid Plants</article-title>. <source>Metabolomics</source><year>2017</year>, <volume>13</volume>, <elocation-id>47</elocation-id><pub-id pub-id-type="doi">10.1007/s11306-017-1184-0</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref17">
      <mixed-citation publication-type="journal" id="cit17"><name><surname>Savoi</surname><given-names>S.</given-names></name>; <name><surname>Wong</surname><given-names>D. C. J.</given-names></name>; <name><surname>Arapitsas</surname><given-names>P.</given-names></name>; <name><surname>Miculan</surname><given-names>M.</given-names></name>; <name><surname>Bucchetti</surname><given-names>B.</given-names></name>; <name><surname>Peterlunger</surname><given-names>E.</given-names></name>; <name><surname>Fait</surname><given-names>A.</given-names></name>; <name><surname>Mattivi</surname><given-names>F.</given-names></name>; <name><surname>Castellarin</surname><given-names>S. D.</given-names></name><article-title>Transcriptome
and Metabolite Profiling Reveals That Prolonged Drought Modulates
the Phenylpropanoid and Terpenoid Pathway in White Grapes (Vitis Vinifera
L.)</article-title>. <source>BMC Plant Biol.</source><year>2016</year>, <volume>16</volume>, <elocation-id>67</elocation-id><pub-id pub-id-type="doi">10.1186/s12870-016-0760-1</pub-id>.<pub-id pub-id-type="pmid">27001212</pub-id></mixed-citation>
    </ref>
    <ref id="ref18">
      <mixed-citation publication-type="journal" id="cit18"><name><surname>Teo</surname><given-names>G.</given-names></name>; <name><surname>Chew</surname><given-names>W. S.</given-names></name>; <name><surname>Burla</surname><given-names>B. J.</given-names></name>; <name><surname>Herr</surname><given-names>D.</given-names></name>; <name><surname>Tai</surname><given-names>E. S.</given-names></name>; <name><surname>Wenk</surname><given-names>M. R.</given-names></name>; <name><surname>Torta</surname><given-names>F.</given-names></name>; <name><surname>Choi</surname><given-names>H.</given-names></name><article-title>MRMkit: Automated Data
Processing for Large-Scale Targeted Metabolomics Analysis</article-title>. <source>Anal. Chem.</source><year>2020</year>, <volume>92</volume>, <fpage>13677</fpage>–<lpage>13682</lpage>. <pub-id pub-id-type="doi">10.1021/acs.analchem.0c03060</pub-id>.<pub-id pub-id-type="pmid">32930575</pub-id></mixed-citation>
    </ref>
    <ref id="ref19">
      <mixed-citation publication-type="journal" id="cit19"><name><surname>Tsugawa</surname><given-names>H.</given-names></name>; <name><surname>Kanazawa</surname><given-names>M.</given-names></name>; <name><surname>Ogiwara</surname><given-names>A.</given-names></name>; <name><surname>Arita</surname><given-names>M.</given-names></name><article-title>MRMPROBS Suite for
Metabolomics Using Large-Scale MRM Assays</article-title>. <source>Bioinformatics</source><year>2014</year>, <volume>30</volume>, <fpage>2379</fpage>–<lpage>2380</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btu203</pub-id>.<pub-id pub-id-type="pmid">24753485</pub-id></mixed-citation>
    </ref>
    <ref id="ref20">
      <mixed-citation publication-type="journal" id="cit20"><name><surname>MacLean</surname><given-names>B.</given-names></name>; <name><surname>Tomazela</surname><given-names>D. M.</given-names></name>; <name><surname>Shulman</surname><given-names>N.</given-names></name>; <name><surname>Chambers</surname><given-names>M.</given-names></name>; <name><surname>Finney</surname><given-names>G. L.</given-names></name>; <name><surname>Frewen</surname><given-names>B.</given-names></name>; <name><surname>Kern</surname><given-names>R.</given-names></name>; <name><surname>Tabb</surname><given-names>D. L.</given-names></name>; <name><surname>Liebler</surname><given-names>D. C.</given-names></name>; <name><surname>MacCoss</surname><given-names>M. J.</given-names></name><article-title>Skyline: An Open
Source Document Editor for Creating
and Analyzing Targeted Proteomics Experiments</article-title>. <source>Bioinformatics</source><year>2010</year>, <volume>26</volume>, <fpage>966</fpage>–<lpage>968</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btq054</pub-id>.<pub-id pub-id-type="pmid">20147306</pub-id></mixed-citation>
    </ref>
    <ref id="ref21">
      <mixed-citation publication-type="journal" id="cit21"><name><surname>Bajad</surname><given-names>S. U.</given-names></name>; <name><surname>Lu</surname><given-names>W.</given-names></name>; <name><surname>Kimball</surname><given-names>E. H.</given-names></name>; <name><surname>Yuan</surname><given-names>J.</given-names></name>; <name><surname>Peterson</surname><given-names>C.</given-names></name>; <name><surname>Rabinowitz</surname><given-names>J. D.</given-names></name><article-title>Separation
and Quantitation of Water Soluble Cellular Metabolites by Hydrophilic
Interaction Chromatography-Tandem Mass Spectrometry</article-title>. <source>J. Chromatogr. A</source><year>2006</year>, <volume>1125</volume>, <fpage>76</fpage>–<lpage>88</lpage>. <pub-id pub-id-type="doi">10.1016/j.chroma.2006.05.019</pub-id>.<pub-id pub-id-type="pmid">16759663</pub-id></mixed-citation>
    </ref>
    <ref id="ref22">
      <mixed-citation publication-type="journal" id="cit22"><name><surname>Chaleckis</surname><given-names>R.</given-names></name>; <name><surname>Ebe</surname><given-names>M.</given-names></name>; <name><surname>Pluskal</surname><given-names>T.</given-names></name>; <name><surname>Murakami</surname><given-names>I.</given-names></name>; <name><surname>Kondoh</surname><given-names>H.</given-names></name>; <name><surname>Yanagida</surname><given-names>M.</given-names></name><article-title>Unexpected
Similarities between the Schizosaccharomyces and Human Blood Metabolomes,
and Novel Human Metabolites</article-title>. <source>Mol. Biosyst.</source><year>2014</year>, <volume>10</volume>, <fpage>2538</fpage>–<lpage>2551</lpage>. <pub-id pub-id-type="doi">10.1039/c4mb00346b</pub-id>.<pub-id pub-id-type="pmid">25010571</pub-id></mixed-citation>
    </ref>
    <ref id="ref23">
      <mixed-citation publication-type="journal" id="cit23"><name><surname>Paglia</surname><given-names>G.</given-names></name>; <name><surname>Magnúsdóttir</surname><given-names>M.</given-names></name>; <name><surname>Thorlacius</surname><given-names>S.</given-names></name>; <name><surname>Sigurjónsson</surname><given-names>ÓE.</given-names></name>; <name><surname>Gudmundsson</surname><given-names>S.</given-names></name>; <name><surname>Palsson</surname><given-names>BØ.</given-names></name>; <name><surname>Thiele</surname><given-names>I.</given-names></name><article-title>Intracellular Metabolite Profiling
of Platelets: Evaluation of Extraction Processes and Chromatographic
Strategies</article-title>. <source>J. Chromatogr. B</source><year>2012</year>, <volume>898</volume>, <fpage>111</fpage>–<lpage>120</lpage>. <pub-id pub-id-type="doi">10.1016/j.jchromb.2012.04.026</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref24">
      <mixed-citation publication-type="journal" id="cit24"><name><surname>Yang</surname><given-names>W.</given-names></name>; <name><surname>Sedlak</surname><given-names>M.</given-names></name>; <name><surname>Regnier</surname><given-names>F. E.</given-names></name>; <name><surname>Mosier</surname><given-names>N.</given-names></name>; <name><surname>Ho</surname><given-names>N.</given-names></name>; <name><surname>Adamec</surname><given-names>J.</given-names></name><article-title>Simultaneous Quantification of Metabolites Involved
in Central Carbon and Energy Metabolism Using Reversed-Phase Liquid
Chromatography-Mass Spectrometry and in Vitro 13C Labeling</article-title>. <source>Anal. Chem.</source><year>2008</year>, <volume>80</volume>, <fpage>9508</fpage>–<lpage>9516</lpage>. <pub-id pub-id-type="doi">10.1021/ac801693c</pub-id>.<pub-id pub-id-type="pmid">19007244</pub-id></mixed-citation>
    </ref>
    <ref id="ref25">
      <mixed-citation publication-type="journal" id="cit25"><name><surname>Si-Hung</surname><given-names>L.</given-names></name>; <name><surname>Causon</surname><given-names>T. J.</given-names></name>; <name><surname>Hann</surname><given-names>S.</given-names></name><article-title>Comparison
of Fully-Wettable RPLC
Stationary Phases for LC-MS-Based Cellular Metabolomics</article-title>. <source>Electrophoresis</source><year>2017</year>, <volume>38</volume>, <fpage>2287</fpage>–<lpage>2295</lpage>. <pub-id pub-id-type="doi">10.1002/elps.201700157</pub-id>.<pub-id pub-id-type="pmid">28691762</pub-id></mixed-citation>
    </ref>
    <ref id="ref26">
      <mixed-citation publication-type="journal" id="cit26"><name><surname>Hermann</surname><given-names>G.</given-names></name>; <name><surname>Schwaiger</surname><given-names>M.</given-names></name>; <name><surname>Volejnik</surname><given-names>P.</given-names></name>; <name><surname>Koellensperger</surname><given-names>G.</given-names></name><article-title>13C-Labelled
Yeast as Internal Standard for LC–MS/MS and LC High Resolution
MS Based Amino Acid Quantification in Human Plasma</article-title>. <source>J. Pharm. Biomed. Anal.</source><year>2018</year>, <volume>155</volume>, <fpage>329</fpage>–<lpage>334</lpage>. <pub-id pub-id-type="doi">10.1016/j.jpba.2018.03.050</pub-id>.<pub-id pub-id-type="pmid">29704823</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
