<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Acta Crystallogr D Biol Crystallogr</journal-id>
    <journal-id journal-id-type="publisher-id">Acta Cryst. D</journal-id>
    <journal-title-group>
      <journal-title>Acta Crystallographica Section D: Biological Crystallography</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0907-4449</issn>
    <issn pub-type="epub">1399-0047</issn>
    <publisher>
      <publisher-name>International Union of Crystallography</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2852313</article-id>
    <article-id pub-id-type="publisher-id">ba5144</article-id>
    <article-id pub-id-type="doi">10.1107/S0907444910007493</article-id>
    <article-id pub-id-type="coden">ABCRE6</article-id>
    <article-id pub-id-type="pii">S0907444910007493</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Papers</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Features and development of <italic>Coot</italic>
            </article-title>
      <alt-title>
        <italic>Coot</italic>
      </alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Emsley</surname>
          <given-names>P.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
        <xref ref-type="corresp" rid="cor">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lohkamp</surname>
          <given-names>B.</given-names>
        </name>
        <xref ref-type="aff" rid="b">b</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Scott</surname>
          <given-names>W. G.</given-names>
        </name>
        <xref ref-type="aff" rid="c">c</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cowtan</surname>
          <given-names>K.</given-names>
        </name>
        <xref ref-type="aff" rid="d">d</xref>
      </contrib>
      <aff id="a"><label>a</label>Department of Biochemistry, University of Oxford, South Parks Road, Oxford OX1 3QU, <country>England</country></aff>
      <aff id="b"><label>b</label>Department of Medical Biochemistry and Biophysics, Karolinska Institute, SE-171 77 Stockholm, <country>Sweden</country></aff>
      <aff id="c"><label>c</label>Department of Chemistry, University of California, 1156 High Street, Santa Cruz, CA 95064, <country>USA</country></aff>
      <aff id="d"><label>d</label>Department of Chemistry, University of York, Heslington, York YO10 5DD, <country>England</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor">Correspondence e-mail: <email>paul.emsley@bioch.ox.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>4</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>3</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>3</month>
      <year>2010</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>66</volume>
    <issue>Pt 4</issue>
    <issue-id pub-id-type="publisher-id">d100400</issue-id>
    <fpage>486</fpage>
    <lpage>501</lpage>
    <history>
      <date date-type="received">
        <day>09</day>
        <month>6</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>26</day>
        <month>2</month>
        <year>2010</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Emsley et al. 2010</copyright-statement>
      <copyright-year>2010</copyright-year>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0/uk/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original authors and source are cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:type="simple" xlink:href="http://dx.doi.org/10.1107/S0907444910007493">A full version of this article is available from Crystallography Journals Online.</self-uri>
    <abstract abstract-type="toc">
      <p><italic>Coot</italic> is a molecular-graphics program designed to assist in the building of protein and other macromolecular models. The current state of development and available features are presented.</p>
    </abstract>
    <abstract>
      <p><italic>Coot</italic> is a molecular-graphics application for model building and validation of biological macromolecules. The program displays electron-density maps and atomic models and allows model manipulations such as idealization, real-space refinement, manual rotation/translation, rigid-body fitting, ligand search, solvation, mutations, rotamers and Ramachandran idealization. Furthermore, tools are provided for model validation as well as interfaces to external programs for refinement, validation and graphics. The software is designed to be easy to learn for novice users, which is achieved by ensuring that tools for common tasks are ‘discoverable’ through familiar user-interface elements (menus and toolbars) or by intuitive behaviour (mouse controls). Recent developments have focused on providing tools for expert users, with customisable key bindings, extensions and an extensive scripting interface. The software is under rapid development, but has already achieved very widespread use within the crystallographic community. The current state of the software is presented, with a description of the facilities available and of some of the underlying methods employed.</p>
    </abstract>
    <kwd-group>
      <kwd>
        <italic>Coot</italic>
      </kwd>
      <kwd>model building</kwd>
    </kwd-group>
    <conference>
      <conf-date/>
      <conf-name>Experimental phasing and radiation damage</conf-name>
      <conf-loc/>
    </conference>
  </article-meta>
</front>
<body>
  <sec id="sec1" sec-type="introduction">
    <label>1.</label>
    <title>Introduction</title>
    <p>Macromolecular model building using X-ray data is an interactive task involving the iterative application of various optimization algorithms with evaluation of the model and interpretation of the electron density by the scientist. <italic>Coot</italic> is an interactive three-dimensional molecular-modelling program particularly designed for the building and validation of protein structures by facilitating the steps of the process.</p>
    <p>In recent years, initial construction of the protein chain has often been carried out using automatic model-building tools such as <italic>ARP</italic>/<italic>wARP</italic> (Langer <italic>et al.</italic>, 2008<xref ref-type="bibr" rid="bb26"> ▶</xref>), <italic>SOLVE</italic>/<italic>RESOLVE</italic> (Wang <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb42"> ▶</xref>) and more recently <italic>Buccaneer</italic> (Cowtan, 2006<xref ref-type="bibr" rid="bb8"> ▶</xref>). In consequence, relatively more time and emphasis is placed on model validation than has previously been the case (Dauter, 2006<xref ref-type="bibr" rid="bb10"> ▶</xref>). The refinement and validation steps become increasingly important and also more time-consuming with lower resolution data. <italic>Coot</italic> aims to provide access to as many of the tools required in the iterative refinement and validation of a macromolecular structure as possible in order to facilitate those aspects of the process which cannot be performed automatically. A primary design goal has been to make the software easy to learn in order to provide a low barrier for scientists who are beginning to work with X-ray data. While this goal has not been met for every feature, it has played a major role in many of the design decisions that have shaped the software.</p>
    <p>The principal tasks of the software are the visualization of macromolecular structures and data, the building of models into electron density and the validation of existing models; these will be considered in the next three sections. The remaining sections of the paper will deal with more technical aspects of the software, including interactions with external software, scripting and testing.</p>
  </sec>
  <sec id="sec2">
    <label>2.</label>
    <title>Program design</title>
    <p>The program is constructed from a range of existing software libraries and a purpose-written <italic>Coot</italic> library which provides a range of tools specific to model building and visualization. The OpenGL and other graphics libraries, such as the X Window System and GTK+, provide the graphical user-interface functionality, the GNU Scientific Library (GSL) provides mathematical tools such as function minimizers and the Clipper (Cowtan, 2003<xref ref-type="bibr" rid="bb7"> ▶</xref>) and MMDB (Krissinel <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb25"> ▶</xref>) libraries provide crystallographic tools and data types. On top of these tools are the <italic>Coot</italic> libraries, which are used to manipulate models and maps and to represent them graphically.</p>
    <p>Much of this functionality may be accessed from the scripting layer (see §<xref ref-type="sec" rid="sec8"/>8), which allows programmatic access to all of the underlying functionality. Finally, the graphical user interface is built on top of the scripting layer, although in some cases it is more convenient for the graphical user interface to access the underlying classes directly (Fig. 1<xref ref-type="fig" rid="fig1"> ▶</xref>).</p>
  </sec>
  <sec id="sec3">
    <label>3.</label>
    <title>Visualization</title>
    <p>Coot provides tools for the display of three-dimensional data falling into three classes.<list list-type="simple"><list-item><p>(i) Atomic models (generally displayed as vectors connecting bonded atoms).</p></list-item><list-item><p>(ii) Electron-density maps (generally contoured using a wire-frame lattice).</p></list-item><list-item><p>(iii) Generic graphical objects (including the unit-cell box, noncrystallographic rotation axes and similar).</p></list-item></list>A user interface and a set of controls allow the user to interact with the graphical display, for example in moving or rotating the viewpoint, selecting the data to be displayed and the mode in which those data are presented.</p>
    <p>The primary objective in the user interface as it stands today has been to make the application easy to learn. Current design of user interfaces emphasizes a number of characteristics for a high-quality graphical user interface (GUI). Such characteristics include learnability, productivity, forgiveness (if a user makes a mistake, it should be easy to recover) and aesthetics (the application should look nice and provide a pleasurable experience). When designing the user interface for <italic>Coot</italic>, we aim to respect these issues; however, this may not always be achieved and the GUI often undergoes redesign. Ideally, a user who has a basic familiarity with crystallographic data but who has never used <italic>Coot</italic> before should be able to start the software, display their data and perform some basic manipulations without any instruction. In order for the software to be easy to learn, it is necessary that the core functionality of the software be discoverable, <italic>i.e.</italic> the user should be able to find out how to perform common tasks without consulting the documentation. This may be achieved in any of three ways. <list list-type="simple"><list-item><p>(i) The behaviour is intuitive, <italic>i.e.</italic> the behaviour of user-interface elements can be either anticipated or determined by a few experiments. An example of this is the rotation of the view, which is accomplished by simply dragging with the mouse.</p></list-item><list-item><p>(ii) The behaviour is familiar and consistent, <italic>i.e.</italic> user-interface elements behave in a similar way to other common software. An example of this is the use of a ‘File’ menu containing ‘Open…’ options, leading to a conventional file-selection dialogue.</p></list-item><list-item><p>(iii) The interface is explorable, <italic>i.e.</italic> if a user needs an additional functionality they can find it rapidly by inspecting the interface. An example of this is the use of organized menus which provide access to the bulk of the program functionality. Furthermore, tooltips are provided for most menus and buttons and informative widgets explain their function.</p></list-item></list>
         </p>
    <sec id="sec3.1">
      <label>3.1.</label>
      <title>User interface</title>
      <p>The main <italic>Coot</italic> user interface window is shown in Fig. 2<xref ref-type="fig" rid="fig2"> ▶</xref> and consists of the following elements. <list list-type="simple"><list-item><p>(i) In the centre of the main window is the three-dimensional canvas, on which the atomic models, maps and other graphical objects are displayed. By default this area has a black background, although this can be changed if desired.</p></list-item><list-item><p>(ii) At the top of the window is a menu bar. This includes the following menus: ‘File’, ‘Edit’, ‘Calculate’, ‘Draw’, ‘Measures’, ‘Validate’, ‘HID’, ‘About’ and ‘Extensions’. The ‘File’, ‘Edit’ and ‘About’ menus fulfill their normal roles. ‘Calculate’ provides access to model-manipulation tools. ‘Draw’ implements display options. ‘Measures’ presents access to geometrical information. ‘Validate’ provides access to validation tools. ‘HID’ allows the human-interface behaviour to be customized. ‘Extensions’ provides access to a range of optional functionalities which may be customized and extended by advanced users. Additional menus can be added by the use of the scripting interface.</p></list-item><list-item><p>(iii) Between the menu bar and the canvas is a toolbar which provides two very frequently used controls: ‘Reset view’ switches between views of the molecules and ‘Display Manager’ opens an additional window which allows individual maps and molecules to be displayed in different ways. This toolbar is customizable, <italic>i.e.</italic> additional buttons can be added.</p></list-item><list-item><p>(iv) On the right-hand side of the window is a toolbar of icons which allow the modification of atomic models. By default these are displayed as icons, although tooltips are provided and text can also be displayed.</p></list-item><list-item><p>(v) Below the canvas is a status bar in which brief text messages are displayed concerning the status of current operations.</p></list-item></list>The user interface is implemented using the GTK+2 widget stack, although with some work this could be changed in the future.</p>
    </sec>
    <sec id="sec3.2">
      <label>3.2.</label>
      <title>Controls</title>
      <p>User input to the program is primarily <italic>via</italic> mouse and keyboard, although it is also possible to use some dial devices such as the ‘Powermate’ dial. The mouse may be used to select menu options and toolbar buttons in the normal way.</p>
      <p>In addition, the mouse and the keyboard may be used to manipulate the view in the three-dimensional canvas using the controls shown in Fig. 3<xref ref-type="fig" rid="fig3"> ▶</xref>.</p>
      <p>In a large program there is often tension between software being easy to learn and being easy to use. A program which is easy to use provides extensive shortcuts to allow common tasks to be performed with the minimum user input. Keyboard shortcuts, customizations and macro languages are common examples and are often employed by expert users of all types of software. <italic>Coot</italic> now provides tools for all of these. Much of the functionality of the package is now accessible from both the Python (<ext-link ext-link-type="uri" xlink:href="http://www.python.org">http://www.python.org</ext-link>) and the Scheme (Kelsey <italic>et al.</italic>, 1998<xref ref-type="bibr" rid="bb19"> ▶</xref>) scripting languages, which may be used to construct more powerful tools using combinations of existing functions. One example is a function often used after molecular replace­ment which will step through every residue in a protein, replace any missing atoms, find the best-fitting side-chain rotamer and perform real-space refinement. This function is in turn bound to a menu item, although it would also be possible to bind it to a key on the keyboard.</p>
    </sec>
    <sec id="sec3.3">
      <label>3.3.</label>
      <title>Lighting model</title>
      <p>The lighting model used in <italic>Coot</italic> is a departure from the approach adopted in most molecular-graphics software. It is difficult to illustrate a three-dimensional shape in a two-dimensional representation of an object. The traditional approach is to use so-called ‘depth-cueing’: objects closer to the user appear more brightly lit and more distant objects are more like the background colour (usually darker). In the <italic>Coot</italic> model, however, the most brightly lit features are just forward of the centre of rotation. This innovation was accidental, but has been retained because it seemed to provide a more natural image and has generated positive feedback from users once they become accustomed to the new behaviour. It is now possible to offer an explanation for this result.</p>
      <p>Depth-cueing is an algorithm which adjusts the colours of graphical objects according to their distance from the viewer. Depth-cueing is used in several ways. When rendering outdoor scenes, it is used to wash out the colours of distant features to simulate the effect of light scattering in the intervening air. When rendering darkened scenes, the same effect can be used to darken distant objects in order to create the effect that the viewer is carrying a light source which illuminates nearer objects more brightly than distant ones. Note that both of these usages assume a ‘first-person’ view: the observer is placed within the three-dimensional environment. This is also borne out in the controls for manipulating the view: when the view is rotated, the whole environment usually rotates about the observer.</p>
      <p>However, fitting three-dimensional atomic models to X-­ray data is a different situation. It is not useful to place the observer inside the model and rotate the model around them, not least because the scientist is usually more interested in looking at the molecule or electron density from the outside. As a result, it is normal to rotate the view not about the observer but rather about the centre of the feature being studied. Since the central feature is of most interest, it helps the visualization if it is the brightest entity. To properly light the model in this way is relatively slow, so in <italic>Coot</italic> an approximation is used and the plane perpendicular to the viewer that contains the central feature is most brightly lit.</p>
    </sec>
    <sec id="sec3.4">
      <label>3.4.</label>
      <title>Atomic model</title>
      <p><italic>Coot</italic> displays the atoms of the atomic models as points on the three-dimensional canvas. If the points are within bonding distance then a line symbolizing a bond is drawn between the atomic points; otherwise the atoms are displayed as crosses. By default the atoms are coloured by element, with carbon yellow, oxygen red, nitrogen blue, sulfur green and hydrogen white. Bonds have two colours, with one half corresponding to each connecting atom. Additional atomic models are distinguished by different colour coding. The colour wheel is rotated and the element colours are adjusted accordingly. However, there is an option to fix the colours for noncarbon elements and the colour-wheel position can be adjusted for each molecule individually. Furthermore, <italic>Coot</italic> allows the user to colour the atomic model by molecule, chain, secondary structure, <italic>B</italic> factor and occupancy. Besides showing atomic models, <italic>Coot</italic> can also display C<sup>α</sup> (or backbone) chains only. Again the model can be coloured in different modes, by chain, secondary structure or with rainbow colours from the N-terminus to the C-terminus. Currently, <italic>Coot</italic> offers some additional atomic representations in the form of different bond-width or ball-and-stick representation for selected residues.</p>
      <p>Information about individual atoms can be visualized in the form of labels. These show the atom name, residue number, residue name and chain identifier. Labels are shown upon <monospace>Shift</monospace> + left mouse click or double left mouse click on an atom (the atom closest to the rotation/screen centre can be labelled using the keyboard shortcut ‘<monospace>l</monospace>’). This operation not only shows the label beside the atom in the three-dimensional canvas, but also gives more detailed information about the atom, including occupancy, <italic>B</italic> factor and coordinates, in the status bar.</p>
      <p>Symmetry-equivalent atoms of the atomic model can be displayed in <italic>Coot</italic> within a certain radius either as whole chains or as atoms within this radius. Different options for colouring and displaying atoms or C<sup>α</sup> backbone are provided. The symmetry-equivalent models can be labelled as described above. Additionally, the label will provide information about the symmetry operator used to generate the selected model.</p>
      <p>Navigation around the atomic models is primarily achieved with a GUI (‘Go To Atom…’). This allows the view to be centred on a particular atom by selection of a model, chain ID, residue number and atom name. Buttons to move to the next or previous residue are provided and are also available <italic>via</italic> keyboard shortcuts (<monospace>space bar</monospace> and <monospace>Shift space bar</monospace>, respectively). Furthermore, each chain is displayed as an expandable tree of its residues, with atoms that can be selected for centring. Additionally, a mouse can be used for navigation, so a middle mouse click centres on the clicked atom. A keyboard shortcut for the view to be centred on a C<sup>α</sup> atom of a specific residue is provided by the use of <monospace>Ctrl-g</monospace> followed by input of the chain identifier and residue number (terminated by <monospace>Enter</monospace>).</p>
      <p>All atomic models, in contrast to other display objects, are accessible by clicking a mouse button on an atom centre. This allows, for example, re-centring, selection and labelling of the model.</p>
    </sec>
    <sec id="sec3.5">
      <label>3.5.</label>
      <title>Electron density</title>
      <p>Electron-density maps are displayed using a three-dimensional mesh to visualize the surface of electron-density regions higher than a chosen electron-density value using a ‘marching-cubes’-type algorithm (Lorensen &amp; Cline, 1987<xref ref-type="bibr" rid="bb28"> ▶</xref>). The spacing of the mesh is dictated by the spacing of the grid on which the electron density is sampled. Since electron-density maps are most often described in terms of structure factors, the sampling can be modified by the user at the point where the electron density is read into the program. The contour level may be varied interactively using the scroll wheel on the mouse (if available) or alternatively by using the keyboard (‘<monospace>+</monospace>’ and ‘<monospace>-</monospace>’). In most cases this avoids the need for multiple contour levels to be displayed at once, although additional contour levels can be displayed if desired.</p>
      <p>The colour of the electron-density map may be selected by the user. By default, the first map read into the program is contoured in blue, with subsequent maps taking successive colour hues around a colour wheel. Difference maps are by default contoured at two levels, one positive and one negative (coloured green and red, respectively).</p>
      <p>The electron density is contoured in a box about the current screen centre and is interactively re-contoured whenever the view centre is changed. By default, this box covers a volume extending at least 10 Å in each direction from the current screen centre. This is an appropriate scale for manipulating individual units of a peptide or nucleotide chain and provides good interactive performance, even on older computers. Larger volumes may be contoured on faster machines. A ‘dynamic volume’ option allows the volume contoured to be varied with the current zoom level, so that the contoured region always fills the screen. A ‘dynamic sampling’ option allows the map to be contoured on a subsampled grid (<italic>e.g.</italic> every second or fourth point along each axis). This is useful when using a solvent mask to visualize the packing of the molecules in the crystal.</p>
    </sec>
    <sec id="sec3.6">
      <label>3.6.</label>
      <title>Display objects</title>
      <p>There are a variety of non-interactive display objects which can also be superimposed on the atomic model and electron density. These include the boundaries of the unit cell, an electron-density ridge trace (or skeleton), surfaces, three-dimensional text annotations and dots (used in the <italic>MolProbity</italic> interface). These cannot be selected, but aid in the visualization of features of the electron density and other entities.</p>
    </sec>
    <sec id="sec3.7">
      <label>3.7.</label>
      <title>File formats</title>
      <p><italic>Coot</italic> recognizes a variety of file formats from which the atomic model and electron density may be read. The differences in the information stored in these various formats mean that some choices have to be made by the user. This is achieved by providing several options for reading electron density and, where necessary, by requesting additional information from the user. The file formats which may be used for atomic models and for electron density will be considered in turn.</p>
      <p>In addition to obtaining data from the local storage, it is also possible to obtain atomic models directly from the Protein Data Bank (Bernstein <italic>et al.</italic>, 1977<xref ref-type="bibr" rid="bb2"> ▶</xref>) by entering the PDB code of a deposited structure. Similarly, in the case of structures for which experimental data have been deposited, the model and phased reflections may both be obtained from the Electron Density Server (Kleywegt <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb21"> ▶</xref>).</p>
      <sec id="sec3.7.1">
        <label>3.7.1.</label>
        <title>Atomic models</title>
        <p>Atomic models are read into <italic>Coot</italic> by selecting the ‘Open Coordinates…’ option from the File menu. This provides a standard file selector which may be used to select the desired file. <italic>Coot</italic> recognizes atomic models stored in the following three formats.<list list-type="simple"><list-item><p>(i) Protein Data Bank (PDB) format (with file extension <monospace>.pdb</monospace> or <monospace>.ent</monospace>; compressed files of this format with extension <monospace>.gz</monospace> can also be read). The latest releases provide compatibility with version 3 of the PDB format.</p></list-item><list-item><p>(ii) Macromolecular crystallographic information file (mmCIF; Westbrook <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb43"> ▶</xref>) format (extension <monospace>.cif</monospace>).</p></list-item><list-item><p>(iii) <italic>SHELX</italic> result files produced by the <italic>SHELXL</italic> refinement software (extension <monospace>.res</monospace> or <monospace>.ins</monospace>).</p></list-item></list>In each case, the unit-cell and space-group information are read from the file (in the case of <italic>SHELXL</italic> output the space group is inferred from the symmetry operators). The atomic model is read, including atom name, alternate conformation code, monomer name, sequence number and insertion code, chain name, coordinates, occupancy and isotropic/anisotropic atomic displacement parameters. PDB and mmCIF files are handled using the MMDB library (Krissinel <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb25"> ▶</xref>), which is also used for internal model manipulations.</p>
      </sec>
      <sec id="sec3.7.2">
        <label>3.7.2.</label>
        <title>Electron density</title>
        <p>The electron-density representation is a significant element of the design of the software. <italic>Coot</italic> employs a ‘crystal space’ representation of the electron density, in which the electron density is practically infinite in extent, in accordance with the lattice repeat and cell symmetry of the crystal. Thus, no matter where the viewpoint is located in space density can always be represented. This design decision is achieved by use of the Clipper libraries (Cowtan, 2003<xref ref-type="bibr" rid="bb7"> ▶</xref>).</p>
        <p>The alternative approach is to just display electron density in a bounded box described by the input electron-density map. This approach is simpler and may be more appropriate in some specific cases (<italic>e.g.</italic> when displaying density from cryo-EM experiments or some types of NCS maps). However, it has the limitation that no density is available for symmetry-related molecules and if the initial map has been calculated with the wrong extent then it must be recalculated in order to view the desired regions.</p>
        <p>This distinction is important in that it affects how electron-density data should be prepared for use in <italic>Coot</italic>. Files pre­pared for <italic>O</italic> or <italic>PyMOL</italic> may not be suitable for use in <italic>Coot</italic>. In order to read a map file into <italic>Coot</italic>, it should cover an asymmetric unit or unit cell. In contrast, map files prepared for <italic>O</italic> (Jones <italic>et al.</italic>, 1991<xref ref-type="bibr" rid="bb17"> ▶</xref>) or <italic>PyMOL</italic> (DeLano, 2002<xref ref-type="bibr" rid="bb12"> ▶</xref>) usually cover a bounded box surrounding the molecule. While it is possible to derive any bounded box from the asymmetric unit, it is not always possible to go the other way; therefore, using map files prepared for other software may lead to unexpected results in some cases, the most common being an incorrect calculation of the standard deviation of the map. If one uses more advanced techniques that involve masking, the electron-density map must have the same symmetry as the associated model molecule.</p>
        <p>Electron density may be read into <italic>Coot</italic> either in the form of structure factors (with optional weights) and phases or alternatively in the form of an electron-density map. There are a number of reasons why the preferred approach is to read reflection data rather than a map.<list list-type="simple"><list-item><p>(i) <italic>Coot</italic> can always obtain a complete asymmetric unit of data, avoiding the problems described above.</p></list-item><list-item><p>(ii) Structure-factor files are generally smaller than electron-density maps.</p></list-item><list-item><p>(iii) Some structure-factor files, and in particular MTZ files, provide multiple sets of data in a single file. Thus, it is possible to read a single file and obtain, for example, both best and difference maps.</p></list-item></list> The overhead in calculating an electron-density map by FFT is insignificant for modern computers.</p>
      </sec>
      <sec id="sec3.7.3">
        <label>3.7.3.</label>
        <title>Reading electron density from a reflection-data file</title>
        <p>Two options are provided for reading electron density from a reflection-data file. These are ‘Auto Open MTZ…’ and ‘Open MTZ, mmcif, fcf or phs…’ from the ‘File’ menu. <list list-type="simple"><list-item><p>(i) ‘Auto Open MTZ…’ will open an MTZ file containing coefficients for the best and difference map, automatically select the FWT/PHWT and the DELFWT/DELPHWT pairs of labels and display both electron-density maps. Currently, suitable files are generated by the following software: <italic>Phaser</italic> (Storoni <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb38"> ▶</xref>), <italic>REFMAC</italic> (Murshudov <italic>et al.</italic>, 1997<xref ref-type="bibr" rid="bb32"> ▶</xref>), <italic>phenix.refine</italic> (Adams <italic>et al.</italic>, 2002<xref ref-type="bibr" rid="bb1"> ▶</xref>), <italic>DM</italic> (Zhang <italic>et al.</italic>, 1997<xref ref-type="bibr" rid="bb47"> ▶</xref>), <italic>Parrot</italic> (Cowtan, 2010<xref ref-type="bibr" rid="bb9"> ▶</xref>), <italic>Pirate</italic> (Cowtan, 2000<xref ref-type="bibr" rid="bb6"> ▶</xref>) and <italic>BUSTER</italic> (Blanc <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb3"> ▶</xref>).</p></list-item><list-item><p>(ii) ‘Open MTZ, mmcif, fcf or phs…’ will open a reflection-data file in any of the specified formats. Note that <italic>XtalView</italic> 
                           <monospace>.phs</monospace> files do not contain space-group and cell information: in these cases a PDB file must be read first to obtain the relevant information or the information has to be entered manually. MTZ files may contain many sets of map coefficients and so it is necessary to select which map coefficients to use. In this case the user is provided with an additional window which allows the map coefficients to be selected. The standard data names for some common crystallographic software are provided in Table 1<xref ref-type="table" rid="table1"> ▶</xref>.</p></list-item></list>
                  <italic>SHELX</italic> 
                  <monospace>.fcf</monospace> files are converted to mmCIF format and the space group is then inferred from the symmetry operators.</p>
      </sec>
    </sec>
  </sec>
  <sec id="sec4">
    <label>4.</label>
    <title>Model building</title>
    <p>Initial building of protein structures from experimental phasing is usually accomplished by automated methods such as <italic>ARP</italic>/<italic>wARP</italic>, <italic>RESOLVE</italic> (Wang <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb42"> ▶</xref>) and <italic>Buccaneer</italic> (Cowtan, 2006<xref ref-type="bibr" rid="bb8"> ▶</xref>). However, most of these methods rely on a resolution of better than 2.5 Å and yield more complete models the better the resolution. The main focus in <italic>Coot</italic>, therefore, is the completion of initial models generated by either molecular replacement or automated model building as well as building of lower resolution structures. However, the features described below are provided for cases where an initial model is not available.</p>
    <sec id="sec4.1">
      <label>4.1.</label>
      <title>Tools for general model building</title>
      <sec id="sec4.1.1">
        <label>4.1.1.</label>
        <title>C<sup>α</sup> baton mode</title>
        <p>Baton building, which was introduced by Kleywegt &amp; Jones (1994<xref ref-type="bibr" rid="bb22"> ▶</xref>), allows a protein main chain to be built by using a 3.8 Å ‘baton’ to position successive C<sup>α</sup> atoms at the correct spacing. In <italic>Coot</italic>, this facility is coupled with an electron-density ridge-trace skeleton (Greer, 1974<xref ref-type="bibr" rid="bb15"> ▶</xref>). Firstly, a skeleton is calculated which follows the ridges of the electron density. The user then selects baton-building mode, which places an initial baton with one end at the current screen centre. Candidate positions for the next α-carbon are highlighted as crosses selected from those points on the skeleton which lie at the correct distance from the start point. The user can cycle through a list of candidate positions using the ‘Try Another’ button or alternatively rotate the baton freely by use of the mouse. Additionally, the length of the baton can be changed to accommodate moderate shifts in the α-­carbon positions. Once a new position is accepted, the baton moves so that its base is on the new α-carbon. In this way, a chain may be traced manually at a rate of between one and ten residues per minute.</p>
      </sec>
      <sec id="sec4.1.2">
        <label>4.1.2.</label>
        <title>C<sup>α</sup> zone→main chain</title>
        <p>Having placed the C<sup>α</sup> atoms, the rest of the main-chain atoms may be generated automatically. This tool uses a set of 62 high-resolution structures as the basis for a library of main-chain fragments. Hexapeptide and pentapeptide fragments are chosen to match the C<sup>α</sup> positions of each successive pentapeptide of the C<sup>α</sup> trace in turn, following the method of Esnouf (1997<xref ref-type="bibr" rid="bb14"> ▶</xref>), which is similar to that of Jones &amp; Thirup (1986<xref ref-type="bibr" rid="bb18"> ▶</xref>). The fragments with the best fit to the candidate C<sup>α</sup> positions are merged to provide a full trace. After this step, one typically performs a real-space refinement of the subsequent main-chain model.</p>
      </sec>
      <sec id="sec4.1.3">
        <label>4.1.3.</label>
        <title>Find secondary structure</title>
        <p>Protein secondary-structure elements, including α-helices and β-strands, can be located by their repeating electron-density features, which lead to high and low electron-density values in characteristic positions relative to the consecutive C<sup>α</sup> atoms. The ‘Find Secondary Structure’ tool performs a six-dimensional rotation and translation search to find the likely positions of helical and strand elements within the electron density. This search has been highly optimized in order to achieve interactive performance for moderately sized structures and as a result is less exhaustive than the corresponding tools employed in automated model-building packages: however, it can provide a very rapid indication of map quality and a starting point for model building.</p>
      </sec>
      <sec id="sec4.1.4">
        <label>4.1.4.</label>
        <title>Place helix here</title>
        <p>At low resolution it is sometimes possible to identify secondary-structure features in the electron density when the C<sup>α</sup> positions are not obvious. In this case, <italic>Coot</italic> can fit an α-helix automatically. This process involves several stages. <list list-type="simple"><list-item><p>(i) A local optimization is performed on the starting position to maximize the integral of the electron density over a 5 Å sphere. This tends to move the starting point close to the helix axis.</p></list-item><list-item><p>(ii) A search is performed to obtain the direction of the helix by integrating the electron density in a cylinder of radius 2.5 Å and length 12 Å. A two-dimensional orientation search is performed to optimize the orientation of the cylinder. This gives the direction of the helix.</p></list-item><list-item><p>(iii) A theoretical α-helical model (including C, C<sup>α</sup>, N and O atoms) is placed in the density in accordance with the position and direction already found. Different rotations of the model around the helix axis must be considered. Each of the resulting models is scored by the sum of the density at the atomic centres. At this stage the direction of the helix is unknown and so both directions are tested.</p></list-item><list-item><p>(iv) Next, a choice is made between the best-fitting models for each helix direction by comparing the electron density at the C<sup>β</sup> positions. In case neither orientation gives a significant better fit for the C<sup>β</sup> atoms, both helices are presented to the user.</p></list-item><list-item><p>(v) Finally, attempts are made to extend the helix from the N- and C-termini using ideal ϕ, ψ values.</p></list-item></list>
               </p>
      </sec>
      <sec id="sec4.1.5">
        <label>4.1.5.</label>
        <title>Place strand here</title>
        <p>A similar method is used for placing β-strand fragments in electron density. However, there are three differences compared with helix placement: firstly the initial step is omitted, secondly the length of the fragment (number of residues) needs to be provided by the user and finally the placed fragments are obtained from a database. The first step (optimizing the starting position) is unreliable for strands owing to the smaller radius of the cylinder, <italic>i.e.</italic> main chain, combined with larger density deviations originating from the side chains. Hence, it is omitted and the user must provide a starting position in this case. The integration cylinder used in determining the orientation of the strand has a radius of 1 Å and a length of 20 Å. The ϕ, ψ torsion angles in β-strands in protein deviate from the ideal values, resulting in curved and twisted strands. Such strands cannot be well modelled using ideal values of ϕ and ψ; therefore, candidate strand fragments corresponding to the requested length are taken from a strand ‘database’ (top100 or top500; Word, Lovell, LaBean <italic>et al.</italic>, 1999<xref ref-type="bibr" rid="bb45"> ▶</xref>) and used in the search.</p>
      </sec>
      <sec id="sec4.1.6">
        <label>4.1.6.</label>
        <title>Ideal DNA/RNA</title>
        <p><italic>Coot</italic> has a function to generate idealized atomic structures of single or double-stranded A-­form or B-form RNA or DNA given a nucleotide sequence. The function is menu-driven and can produce any desired helical nucleic acid coordinates in PDB format with canonical Watson–Crick base pairing from a given input sequence with the click of a single button. Because most DNA and RNA structures are comprised of at least local regions of regular near-ideal helical structural elements, the ability to generate nucleic acid helical models on the fly is of particular value for molecular replacement.</p>
        <p>Recently, a collection of short ideal A-form RNA helical fragments generated within <italic>Coot</italic> were used to solve a structurally complex ligase ribozyme by molecular replacement (Robertson &amp; Scott, 2008<xref ref-type="bibr" rid="bb37"> ▶</xref>). Using <italic>Coot</italic> together with the powerful molecular-replacement program <italic>Phaser</italic> (Storoni <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb38"> ▶</xref>) not only permitted this novel RNA structure to be solved without resort to heavy-atom methods, but several other RNA and RNA/protein complexes were also subsequently determined using this approach (Robertson &amp; Scott, 2007<xref ref-type="bibr" rid="bb36"> ▶</xref>). Since <italic>Coot</italic> and <italic>Phaser</italic> can be scripted using embedded Python components, an automated and integrated phasing system is amenable for development within the current software framework.</p>
      </sec>
      <sec id="sec4.1.7">
        <label>4.1.7.</label>
        <title>Find ligands</title>
        <p>The automatic fitting of ligands into electron-density maps is a frequently used technique that is particularly useful for pharmaceutical crystallographers (see, for example, Williams <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb44"> ▶</xref>). The mechanism in <italic>Coot</italic> addresses a number of ligand-fitting scenarios and is a modified form of a previously described algorithm (Oldfield, 2001<xref ref-type="bibr" rid="bb33"> ▶</xref>). It is common practice in ‘fragment screening’ to soak different ligands into the same crystal (Blundell <italic>et al.</italic>, 2002<xref ref-type="bibr" rid="bb4"> ▶</xref>). Using <italic>Coot</italic> one can either specify a region in space or search a whole asymmetric unit for either a single or a number of different ligand types. In the ‘whole-map’ scenario, candidate ligand sites are found by cluster analysis of a residual map. The candidate ligands are fitted in turn to each site (with the candidate orientations being generated by matching the eigenvectors of the ligand to that of the cluster). Each candidate ligand is fitted and scored against the electron density. The best-fitting orientation of the ligand candidates is chosen.</p>
        <p>Ligands often contain a number of rotatable bonds. To account for this flexibility, <italic>Coot</italic> samples torsion angles around these rotatable bonds. Here, each rotatable bond is sampled from an independent probability distribution. The number of conformers is under user control and it is recommended that ligands with a higher number of rotatable bonds should be allowed more conformer candidates. Above a certain number of rotatable bonds it is more efficient to use a ‘core + fragment by fragment’ approach (see, for example, Terwilliger <italic>et al.</italic>, 2006<xref ref-type="bibr" rid="bb39"> ▶</xref>).</p>
      </sec>
    </sec>
    <sec id="sec4.2">
      <label>4.2.</label>
      <title>Rebuilding and refinement</title>
      <p>The rebuilding and refinement tools are the primary means of model manipulation in <italic>Coot</italic> and are all grouped together in the ‘Model/Fit/Refine’ toolset. These tools may be accessed either through a toolbar (which is usually docked on the right-hand side of the main window) or through a separate ‘Model/Fit/Refine’ window containing buttons for each of the toolbar functions.</p>
      <p>The core of the rebuilding and refinement tools is the real-space refinement (RSR) engine, which handles the refinement of the atomic model against an electron-density map and the regularization of the atomic model against geometric restraints. Refinement may be invoked both interactively, when executed by the user, and non-interactively as part of some of the automated fitting tools. The refinement and regularization tools are supplemented by a range of additional tools aimed at assisting the fitting of protein chains. These features are discussed below.</p>
    </sec>
    <sec id="sec4.3">
      <label>4.3.</label>
      <title>Tools for moving existing atoms</title>
      <sec id="sec4.3.1">
        <label>4.3.1.</label>
        <title>Real-space refine zone</title>
        <p>The real-space refine tool is the most frequently used tool for the refinement and rebuilding of atomic models and is also incorporated as a final stage in a number of other tools, <italic>e.g.</italic> ‘Add Terminal Residue…’. In interactive mode, the user selects the RSR button and then two atoms bounding a range of monomers (amino acids or otherwise). Alternatively, a single atom can be selected followed by the ‘<monospace>A</monospace>’ key to refine a monomer and its neighbours. All atoms in the selected range of monomers will be refined, including any flanking residues. Atoms of the flanking residues are marked as ‘fixed’ but are required to be added to the refinement so that the geometry (<italic>e.g.</italic> peptide bonds, angles and planes) between fixed and moving parts is also optimized.</p>
        <p>The selected atoms are refined against a target consisting of two terms: the first being the atomic number (<italic>Z</italic>) weighted sum of the electron-density values over all the atomic centres and the second being the stereochemical restraints. The progress of the refinement is shown with a new set of atoms displayed in white/pale colours. When convergence is reached the user is shown a dialogue box with a set of χ<sup>2</sup> scores and coloured ‘traffic lights’ indicating the current geometry scores in each of the geometrical criteria (Fig. 4<xref ref-type="fig" rid="fig4"> ▶</xref>). Additionally, a warning is issued if the refined range contains any new <italic>cis</italic>-peptide bonds.</p>
        <p>At this stage the user may adjust the model by selecting an atom with the mouse and dragging it, whereby the other atoms will move with the dragged atom. Alternatively, a single atom may be dragged by holding the <monospace>Ctrl</monospace> key. As soon as the atoms are released, the selected atoms will refine from the dragged position. Optionally, before the start of refinement atoms may be selected to be fixed during the refinement (in addition to the atoms of the flanking residues).</p>
      </sec>
      <sec id="sec4.3.2">
        <label>4.3.2.</label>
        <title>Sphere refinement</title>
        <p>One of the problems with the refinement mode described above is that it only considers a linear range of residues. This can cause difficulties, with some side chains being inappropriately refined into the electron density of neighbouring residues, particularly at lower resolutions. Additionally, a linear residue selection precludes the refinement of entities such as disulfide bonds. Therefore, a new residue-selection mechanism was introduced to address these issues: the so-called ‘Sphere Refinement’. This mode selects residues that have atoms within a given radius of a specified position (typically within 4 Å of the centre of the screen). The selected residues are matched to the dictionary and any user-defined links (typically from the <monospace>mon_lib_list.cif</monospace> in the <italic>REFMAC</italic> dictionary), <italic>e.g.</italic> disulfide bonds, glycosidic linkages and formylated lysines. If such links are found and the (supposedly) bonded atoms are within 3 Å of each other then these extra link restraints are added into the refinement.</p>
      </sec>
      <sec id="sec4.3.3">
        <label>4.3.3.</label>
        <title>Ramachandran restraints</title>
        <p>At lower resolution it is sometimes difficult to obtain an acceptable fit of the model to the density and at the same time achieve a Ramachandran plot of high quality (most residues in favourable regions and less than 1% outliers). If a Ramachandran score is added to the target function then the Ramachandran plot can be improved.</p>
        <p>The analytical form for torsion gradients (∂θ/∂<italic>x</italic>
                  <sub>1</sub> and so on) for each of the <italic>x</italic>, <italic>y</italic>, <italic>z</italic> positions of the four atoms contributing to the torsion angle has been reported previously (Emsley &amp; Cowtan, 2004<xref ref-type="bibr" rid="bb13"> ▶</xref>) (in the case of Ramachandran restraints, the θ torsions will be ϕ and ψ). The extension of the torsion gradients for use as Ramachandran restraints is performed in the following manner.</p>
        <p>Firstly, two-dimensional log Ramachandran plots <italic>R</italic> are generated as tables (one for each of the residue types Pro, Gly and non-Pro or Gly). Where the Ramachandran probability becomes zero the log probability becomes infinite and so it is replaced by values which become increasingly negative with distance from the nearest nonzero value. This provides a weak gradient in the disallowed regions towards the nearest allowed region. The log Ramachandran plot provides the following values and derivatives:<disp-formula id="fd1"><graphic xlink:href="d-66-00486-efd1"/></disp-formula>The derivative of <italic>R</italic> with respect to the coordinates is required for the addition into the target geometry and is generated as<disp-formula id="fd2"><graphic xlink:href="d-66-00486-efd2"/></disp-formula>(and so on for each of the <italic>x</italic>, <italic>y</italic>, <italic>z</italic> positions of the atoms in the torsion).</p>
        <p>Adding a Ramachandran score to the geometry target function is not without consequences. The Ramachandran plot has for a long time been used as a validation criterion, therefore if it is used in geometry optimization it becomes less informative as a validation metric. Kleywegt &amp; Jones (1996<xref ref-type="bibr" rid="bb23"> ▶</xref>) included the Ramachandran plot in the restraints during refinement using <italic>X-PLOR</italic> (Brünger, 1992<xref ref-type="bibr" rid="bb5"> ▶</xref>) and reported that the number of Ramachandran outliers was reduced by about a third using moderate force constants. However, increasing the force constants by over two orders of magnitude only marginally decreased the number of outliers. As a result, Kleywegt and Jones note that the Ramachandran plot retains significant value as a validation tool even when it is also used as a restraint. Using the Ramachandran restraints as implemented in <italic>Coot</italic> with the default weights, the number of out­liers can be reduced from around 10% to 5% (typical values).</p>
      </sec>
      <sec id="sec4.3.4">
        <label>4.3.4.</label>
        <title>Regularize zone</title>
        <p>The ‘Regularize Zone’ option functions in the same way as ‘Real-Space Refine Zone’ except that in this case the model is refined with respect to stereochemical restraints but without reference to any electron density.</p>
      </sec>
      <sec id="sec4.3.5">
        <label>4.3.5.</label>
        <title>Rigid-body fit zone</title>
        <p>The ‘Rigid-Body Fit Zone’ option also follows a similar interface convention to the other refinement options. A range of atoms are selected and the orientation of the selected group is refined to best fit the density. In this case the density is the only contributor to the target function, since the geometry of the fragment is not altered. No constraints are placed on the bonding atoms. If atoms are dragged after refinement, no further refinement is performed on the fragment.</p>
      </sec>
      <sec id="sec4.3.6">
        <label>4.3.6.</label>
        <title>Rotate/translate zone</title>
        <p>Using this tool, the selected residue selection can be translated and rotated either by dragging it around the screen or through the use of user-interface sliders. No reference to the map is made. The rotation centre can be specified to be either the last atom selected or the centre of mass of the fragment rotated. Additionally, a selection of the whole chain or molecule can be transformed.</p>
      </sec>
      <sec id="sec4.3.7">
        <label>4.3.7.</label>
        <title>Rotamer tools</title>
        <p>Four tools are available for the fitting of amino-acid side chains. For a side chain whose amino-acid type is already correctly assigned, the best rotamer may be chosen to fit the density either automatically or manually. If the automatic option is chosen then the side-chain rotamer from the <italic>MolProbity</italic> library (Lovell <italic>et al.</italic>, 2000<xref ref-type="bibr" rid="bb30"> ▶</xref>) which gives rise to the highest electron-density values at the atomic centres is selected and rigid-body refined (this includes the main-chain atoms of the residues). Otherwise, the user is presented with a list of rotamers for that side-chain type sorted by frequency in the database. The user can then scroll through the list of rotamers using either the keyboard or user-interface buttons to select the desired rotamer. Rotamers are named according to the <italic>MolProbity</italic> system. Briefly, the χ angles are given letters according to the torsion angle: ‘t’ for approximately 180°, ‘p’ for approximately 60° and ‘m’ for approximately −60° (Lovell <italic>et al.</italic>, 2000<xref ref-type="bibr" rid="bb30"> ▶</xref>).</p>
        <p>The other two options (‘Mutate &amp; Auto Fit’ and ‘Simple Mutate’) allow the amino-acid type to be assigned or changed. The ‘Mutate &amp; Auto Fit Rotamer’ option allows an amino-acid type to be selected from a list and then immediately performs the autofit rotamer operation as above. The ‘Simple Mutate’ option changes the amino-acid type and builds the side-chain atoms in the most frequently occurring rotamer without further refinement.</p>
      </sec>
      <sec id="sec4.3.8">
        <label>4.3.8.</label>
        <title>Torsion editing (‘Edit Chi Angles’, ‘Edit Backbone Torsions’, ‘Torsion General’)</title>
        <p><italic>Coot</italic> has different tools for editing the main-chain and side-chain (or ligand) torsion angles. The main-chain torsion angles, namely ϕ and ψ, can be edited using ‘Edit Backbone Torsion…’. With two sliders, the peptide and carbonyl torsion angles can be adjusted. A separate window showing the Ramachandran plot with the two residues forming the altered peptide bond is displayed with the position of the residues updated as the angles change. Side-chain (or ligand) torsion angles must be defined prior to editing. Either the user manually defines the four atoms forming the torsion angle (‘Torsion General’) or the torsion angles are determined automatically and the user selects the one to edit. In the latter case the bond around which the selected torsion angle is edited is visually marked. Using the mouse, the angle can then be rotated freely.</p>
      </sec>
      <sec id="sec4.3.9">
        <label>4.3.9.</label>
        <title>Other protein tools (‘Flip peptide’, ‘Side Chain 180° Flip’, ‘Cis→Trans’)</title>
        <p>There are three other tools to perform common corrections to protein models. ‘Flip peptide’ rotates the planar atoms in a peptide group through 180° about the vector joining the bounding C<sup>α</sup> atoms (Jones <italic>et al.</italic>, 1991<xref ref-type="bibr" rid="bb17"> ▶</xref>). ‘Side Chain 180° Flip’ rotates the last torsion of a side chain through 180° (<italic>e.g.</italic> to swap the OD1 and ND2 side-chain atoms of Asn). ‘Cis→Trans’ shifts the torsion of the peptide bond through 180°, thereby changing the peptide bond from <italic>trans</italic> to <italic>cis</italic> and <italic>vice versa</italic>.</p>
      </sec>
    </sec>
    <sec id="sec4.4">
      <label>4.4.</label>
      <title>Tools for adding atoms to the model</title>
      <sec id="sec4.4.1">
        <label>4.4.1.</label>
        <title>Find waters</title>
        <p>The water-finding mechanism in <italic>Coot</italic> uses the same cluster analysis as is used in ligand fitting. However, only those clusters below a certain volume (by default 4.2 Å<sup>3</sup>) are considered as candidate sites for water molecules. The centre of each cluster is computed and a distance check is then made to the potential hydrogen-bond donors or receptors in the protein molecule (or other waters). The distance criteria for acceptable hydrogen-bond length are under user control. Additionally, a test for acceptable sphericity of the electron density is performed.</p>
      </sec>
      <sec id="sec4.4.2">
        <label>4.4.2.</label>
        <title>Add terminal residue</title>
        <p>The <italic>MolProbity</italic> ϕ, ψ distribution is used to generate a set of randomly selected ϕ, ψ pairs.</p>
        <p>To build additional residues at the N- and C-termini of protein chains, the <italic>MolProbity</italic> ϕ, ψ distribution is used to generate a set of positions of the N, C<sup>α</sup>, O and C atoms of the next two residues. The conformation of these new atoms is then scored against the electron-density map and recorded. This procedure is carried out a number of times (by default 100). The best-fitting conformation is offered as a candidate to the user (only the nearest of the two residues is kept).</p>
      </sec>
      <sec id="sec4.4.3">
        <label>4.4.3.</label>
        <title>Add alternate conformation</title>
        <p>Alternate conformations are generated by splitting the residue into two sets of conformations (<italic>A</italic> and <italic>B</italic>). By default all atoms of the residue are split, or alternatively only the C<sup>α</sup> and side-chain atoms are divided. If the residue chosen is a standard protein residue then the rotamer-selection dialogue described above is also shown, along with a slider to specify the occupancy of the new conformation.</p>
      </sec>
      <sec id="sec4.4.4">
        <label>4.4.4.</label>
        <title>Place atom at pointer</title>
        <p>This is a simple interface to place a typed atom at the position of the centre of the screen. It can place additional water or solvent molecules in un­modelled electron-density peaks and is used in conjunction with the ‘Find blobs’ tool, which allows the largest unmodelled peaks to be visited in turn.</p>
      </sec>
    </sec>
    <sec id="sec4.5">
      <label>4.5.</label>
      <title>Tools for handling noncrystallographic symmetry (NCS)</title>
      <p>Noncrystallographic symmetry (NCS) can be exploited during the building of an atomic model and also in the analysis of an existing model. <italic>Coot</italic> provides five tools to help with the building and visualization of NCS-related molecules.<list list-type="simple"><list-item><p>(i) NCS ghost molecules. In order to visualize the simi­larities and differences between NCS-related molecules, a ‘ghost’ copy of any or all NCS-related chains may be superimposed over a specific chain in the model. The ‘ghost’ copies are displayed in thin lines and coloured differently, as well as uniformly, in order to distinguish them from the original. The superposition may be performed automatically by secondary-structure matching (Krissinel &amp; Henrick, 2004<xref ref-type="bibr" rid="bb24"> ▶</xref>) or by least-squares superposition. An example of an NCS ghost molecule is shown in Fig. 5<xref ref-type="fig" rid="fig5"> ▶</xref>.</p></list-item><list-item><p>(ii) NCS maps. The electron density of NCS-related molecules can be superimposed in order to allow differences in the electron density to be visualized. This is achieved by transforming the coordinates of the three-dimensional contour mesh, rather then the electron density itself, in order to provide good interactive performance. The operators are usually determined with reference to an existing atomic model which obeys the same NCS relationships. An example of an NCS map is shown in Fig. 6<xref ref-type="fig" rid="fig6"> ▶</xref>.</p></list-item><list-item><p>(iii) NCS-averaged maps. In addition to viewing NCS-related copies of the electron density, the average density of the related regions may be computed and viewed. In noisy maps this can provide a clearer starting point for model building.</p></list-item><list-item><p>(iv) NCS rebuilding. When building an atomic model of a molecule with NCS, it is often more convenient to work on one chain and then replicate the changes made in every NCS-related copy of that chain (at least in the early stages of model building). This can be achieved by selecting two related chains and replacing the second chain in its entirety, or in a specific residue range, with an NCS-transformed copy of the first chain.</p></list-item><list-item><p>(v) NCS ‘jumping’. The view centre jumps to the next NCS-related peer chain and at the same time the NCS operators are taken into account so that the relative view remains the same. This provides a means for rapid visual comparison of NCS-related entities.</p></list-item></list>
            </p>
    </sec>
  </sec>
  <sec id="sec5">
    <label>5.</label>
    <title>Validation</title>
    <p><italic>Coot</italic> incorporates a range of validation tools from the com­parison of a model against electron density to comprehensive geometrical checks for protein structures and additional tools specific to nucleotides.</p>
    <p>It also provides convenient interfaces to external validation tools: most notably the <italic>MolProbity</italic> suite (Davis <italic>et al.</italic>, 2007<xref ref-type="bibr" rid="bb11"> ▶</xref>), but also to the <italic>REFMAC</italic> refinement software (Murshudov <italic>et al.</italic>, 1997<xref ref-type="bibr" rid="bb32"> ▶</xref>) and dictionary (Vagin <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb40"> ▶</xref>).</p>
    <p>Many of the internal validation tools provide a uniform interface in the form of colour-coded bar charts, for example the ‘Density Fit Analysis’ chart (Fig. 7<xref ref-type="fig" rid="fig7"> ▶</xref>). This window contains one bar chart for each chain in the structure. Each chart contains one bar for each residue in the chain. The height and colour of the bar indicate the model quality of the residue, with small green bars indicating a good or expected/conventional conformation and large red bars indicating poor-quality or ‘unconventional’ residues. The chart is active, <italic>i.e.</italic> on moving the pointer over the bar tooltips provide relevant statistics and clicking on a bar changes the view in the main graphics window to centre on the selected residue. In this way, a rapid overview of model quality is obtained and problem areas can be investigated. In order to obtain a good structure for sub­mission, the user may simply cycle though the validation options, correcting any problems found.</p>
    <p>The available validation tools are described in more detail in the following sections.</p>
    <sec id="sec5.1">
      <label>5.1.</label>
      <title>Ramachandran plot</title>
      <p>The Ramachandran plot tool (Fig. 8<xref ref-type="fig" rid="fig8"> ▶</xref>) launches a new window in which the Ramachandran plot for the active molecule is displayed. A data point appears in this plot for each residue in the protein, with different symbols distinguishing Gly and Pro residues. The background of the plot shows frequency data for Ramachandran angles using the Richardsons’ data (Lovell <italic>et al.</italic>, 2003<xref ref-type="bibr" rid="bb29"> ▶</xref>).</p>
      <p>The plot is interactive: clicking on a data point moves the view in the three-dimensional canvas to centre on the corresponding residue. Similarly, selecting an atom in the model highlights the corresponding data point. Moving the mouse over a data point corresponding to a Gly or Pro residue causes the Ramachandran frequency data for that residue type to be displayed.</p>
    </sec>
    <sec id="sec5.2">
      <label>5.2.</label>
      <title>Kleywegt plot</title>
      <p>The Kleywegt plot (Kleywegt, 1996<xref ref-type="bibr" rid="bb20"> ▶</xref>; Fig. 9<xref ref-type="fig" rid="fig9"> ▶</xref>) is a variation of the Ramachandran plot that is used to highlight NCS differences between two chains. The Ramachandran plot for two chains of the protein is displayed, with the data points of NCS-related residues in the two chains linked by a line for the top 50 (default) most different ϕ, ψ angles. Long lines in the corresponding figure correspond to significant differences in backbone conformation between the NCS-related chains.</p>
    </sec>
    <sec id="sec5.3">
      <label>5.3.</label>
      <title>Incorrect chiral volumes</title>
      <p>Dictionary definitions of monomers can contain descriptions of chiral centres. The chiral centres are described as ‘positive’, ‘negative’ or ‘both’. <italic>Coot</italic> can compare the residues in the protein structure to the dictionary and identify outliers.</p>
    </sec>
    <sec id="sec5.4">
      <label>5.4.</label>
      <title>Unmodelled blobs</title>
      <p>The ‘Unmodelled Blobs’ tool finds candidate ligand-binding sites (as described above) without trying to fit a specific ligand.</p>
    </sec>
    <sec id="sec5.5">
      <label>5.5.</label>
      <title>Difference-map peaks</title>
      <p>Difference maps can be searched for positive and negative peaks. The peak list is then sorted on peak height and filtered by proximity to higher peaks (<italic>i.e.</italic> only peaks that are not close to previous peaks are identified).</p>
    </sec>
    <sec id="sec5.6">
      <label>5.6.</label>
      <title>Check/delete waters</title>
      <p>Waters can be validated using several criteria, including distance from hydrogen-bond donors or acceptors, temperature factor or electron-density level. Waters that do not pass these criteria are identified and presented as a list or automatically deleted.</p>
    </sec>
    <sec id="sec5.7">
      <label>5.7.</label>
      <title>Check waters by difference map variance</title>
      <p>This tool is used to identify waters that have been placed in density that should be assigned to other atoms or molecules. The difference map at each water position is analysed by generating 20 points on each sphere at radii of 0.5, 1.0 and 1.5 Å and the electron-density level at each of these points is found by cubic interpolation. The mean and variance of the density levels is calculated for each set of points. If, for example, a water was misplaced into the density for a glycerol then (given an isotropic density model for the water molecule) the difference map will be anisotropic because there will be unaccounted-for positive density along the bonds to the other atoms in the glycerol. There may also be some negative density in a perpendicular direction as the refinement program tries to compensate for the additional electron density. The variances are summed and compared with a reference value (by default 0.12 e<sup>2</sup> Å<sup>−6</sup>). Note that it only makes sense to run this test on a difference map generated by reciprocal-space refinement (for example, from <italic>REFMAC</italic> or <italic>phenix.refine</italic>) that included temperature-factor refinement.</p>
    </sec>
    <sec id="sec5.8">
      <label>5.8.</label>
      <title>Geometry analysis</title>
      <p>The geometry (bonds, angles, planes) for each residue in the selected molecule is compared with dictionary values (typically provided by the mmCIF <italic>REFMAC</italic> dictionary). Torsion-angle deviations are not analysed (as there are other validation tools for these; see §<xref ref-type="sec" rid="sec5.9"/>5.9).</p>
      <p>The statistic displayed in the geometry graph is the average <italic>Z</italic> value for each of the geometry terms for that residue (peptide-geometry distortion is shared between neighbouring residues). The tooltip on the geometry graph describes the geometry features giving rise to the highest <italic>Z</italic> value.</p>
    </sec>
    <sec id="sec5.9">
      <label>5.9.</label>
      <title>Peptide ω analysis</title>
      <p>This is a validation tool for the analysis of peptide ω torsion angles. It produces a graph marking the deviation from 180° of the peptide ω angle. The deviation is assigned to the residue that contains the C and O atoms of the peptide link, thus peptide ω angles of 90° are very poor. Optionally, ω angles of 0° can be considered ideal (for the case of intentional <italic>ci</italic>s-peptide bonds).</p>
    </sec>
    <sec id="sec5.10">
      <label>5.10.</label>
      <title>Temperature-factor variance analysis</title>
      <p>The variance of the temperature factors for the atoms of each residue is plotted. This is occasionally useful to highlight misbuilt regions. In a badly fitting residue, reciprocal-space refinement will tend to expand the temperatures factors of atoms in low or negative density, resulting in a high variance. However, residues with long side chains (<italic>e.g.</italic> Arg or Lys) often naturally have substantial variance, even though the atoms are correctly placed, which causes ‘noise’ in this graph. This shortcoming will be addressed in future developments. H atoms are ignored in temperature-factor variance analysis.</p>
    </sec>
    <sec id="sec5.11">
      <label>5.11.</label>
      <title>Gln and Asn <italic>B</italic>-factor outliers</title>
      <p>This is another tool that analyses the results of reciprocal-space refinement. A measure <italic>z</italic> is computed that is half of the difference of the temperature factor between the NE2 and OE1 atoms (in the case of Gln) divided by the standard deviation of the temperature factors of the remaining atoms in the residue. Our analysis of high-resolution structures has shown that when <italic>z</italic> is greater than +2.25 there is a more than 90% chance that OE1 and NE2 need to be flipped (P. Emsley, unpublished results).</p>
    </sec>
    <sec id="sec5.12">
      <label>5.12.</label>
      <title>Rotamer analysis</title>
      <p>The rotamer statistics are generated from an analysis of the nearest conformation in the <italic>MolProbity</italic> rotamer probability distribution (Lovell <italic>et al.</italic>, 2000<xref ref-type="bibr" rid="bb30"> ▶</xref>) and displayed as a bar chart. The height of the bar in the graph is inversely proportional to the rotamer probability.</p>
    </sec>
    <sec id="sec5.13">
      <label>5.13.</label>
      <title>Density-fit analysis</title>
      <p>The bars in the density-fit graphs are inversely proportional to the average <italic>Z</italic>-weighted electron density at the atom centres and to the grid sampling of the map (<italic>i.e.</italic> maps with coarser grid sampling will have lower bars than a more finely gridded map, all other things being equal). Accounting for the grid sampling allows lower resolution maps to have an informative density-fit graph without many or most residues being marked as worrisome owing to their atoms being in generally low levels of density.</p>
    </sec>
    <sec id="sec5.14">
      <label>5.14.</label>
      <title>Probe clashes</title>
      <p>‘Probe Clashes’ is a graphical representation of the output of the <italic>MolProbity</italic> tools <italic>Reduce</italic> (Word, Lovell, Richardson <italic>et al.</italic>, 1999<xref ref-type="bibr" rid="bb46"> ▶</xref>), which adds H atoms to a model (and thereby provides a means of analyzing potential side-chain flips), and <italic>Probe</italic> (Word, Lovell, LaBean <italic>et al.</italic>, 1999<xref ref-type="bibr" rid="bb45"> ▶</xref>), which analyses atomic packing. ‘Contact dots’ are generated by <italic>Probe</italic> and these are displayed in <italic>Coot</italic> and coloured by the type of interaction.</p>
    </sec>
    <sec id="sec5.15">
      <label>5.15.</label>
      <title>NCS differences</title>
      <p>The graph of noncrystallographic symmetry differences shows the r.m.s. deviation of atoms in residues after the transformation of the selected chain to the reference chain has been applied. This is useful to highlight residues that have unusually large differences in atom positions (the largest differences are typically found in the side-chain atoms).</p>
    </sec>
  </sec>
  <sec id="sec6">
    <label>6.</label>
    <title>Model analysis</title>
    <sec id="sec6.1">
      <label>6.1.</label>
      <title>Geometric measurements</title>
      <p>Geometric measurements can be performed on the model and displayed in a three-dimensional view using options from the ‘Measures’ menu. These measurements include bond lengths, bond angles and torsion angles, which may be selected by clicking successively on the atoms concerned. It is also possible to measure the distance of an atom to a least-squares plane defined by a set of three or more other atoms. The ‘Environment Distances’ option allows all neighbours within a certain distance of any atom of a chosen residue to be displayed. Distances between polar neighbours are coloured differently to all others. This is particularly useful in the initial analysis of hydrogen bonding.</p>
    </sec>
    <sec id="sec6.2">
      <label>6.2.</label>
      <title>Superpositions</title>
      <p>It is often useful to compare several related molecules which are similar in terms of sequence or fold. In order to do this the molecules must be placed in the same position and orientation in space so that the differences may be clearly seen. Two tools are provided for this purpose.<list list-type="simple"><list-item><p>(i) <italic>SSM</italic> superposition (Krissinel &amp; Henrick, 2004<xref ref-type="bibr" rid="bb24"> ▶</xref>). <italic>Secondary Structure Matching</italic> (<italic>SSM</italic>) is a tool for superposing proteins whose fold is related by fitting the secondary-structure elements of one protein to those of the other. This approach is automatic and does not rely on any sequence identity between the two proteins. The superposition may include a complete structure or just a single chain.</p></list-item><list-item><p>(ii) LSQ superposition. Least-squares (LSQ) superposition involves finding the rotation and translation which minimizes the distances between corresponding atoms in the two models and therefore depends on having a predefined correspondence between the atoms of the two structures. This approach is very fast but requires that a residue range from one structure be specified and matched to a corresponding residue range in the other structure.</p></list-item></list>
            </p>
    </sec>
  </sec>
  <sec id="sec7">
    <label>7.</label>
    <title>Interaction with other programs</title>
    <p>In addition to the built-in tools, <italic>e.g.</italic> for refinement and validation, <italic>Coot</italic> provides interfaces to external programs. For refinement, interfaces to <italic>REFMAC</italic> and <italic>SHELXL</italic> are pro­vided. Validation can be accomplished by interaction with the programs <italic>Probe</italic> and <italic>Reduce</italic> from the <italic>MolProbity</italic> suite. Furthermore, interfaces for the production of publication-quality figures are provided by communication with the (molecular) graphics programs <italic>CCP</italic>4<italic>mg</italic>, <italic>POV-Ray</italic> and <italic>Raster</italic>3<italic>D</italic>.</p>
    <sec id="sec7.1">
      <label>7.1.</label>
      <title><italic>REFMAC</italic> 
            </title>
      <p><italic>Coot</italic> provides a dialogue similar to that used in <italic>CCP</italic>4<italic>i</italic> for running <italic>REFMAC</italic> (Murshudov <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb34"> ▶</xref>). <italic>REFMAC</italic> is a program from the <italic>CCP</italic>4 suite for maximum-likelihood-based macromolecular refinement. Once a round of interactive model building has finished, the user can choose to use <italic>REFMAC</italic> to refine the current model. Reflections for the refinement are either used from the MTZ file from which the currently displayed map was calculated or can be acquired from a selected MTZ file. Most <italic>REFMAC</italic> parameters are set as defaults; however, some can be specified in the GUI, such as the number of refinement cycles, twin refinement and the use of NCS. Once <italic>REFMAC</italic> has terminated, the newly generated (refined) model and MTZ file from which maps are generated are automatically read in (and displayed). If <italic>REFMAC</italic> detected geometrical outliers at the end of the refinement, an interactive dialogue will be presented with two buttons for each residue containing an outlier: one to centre the view on the residue and the other to carry out real-space refinement.</p>
    </sec>
    <sec id="sec7.2">
      <label>7.2.</label>
      <title><italic>SHELXL</italic> 
            </title>
      <p>For high-resolution refinement, <italic>SHELXL</italic> can be used directly from <italic>Coot</italic>. A new <monospace>SHELXL.ins</monospace> file can be generated from a <monospace>SHELXL.res</monospace> file including any manipulations or additions to the model. Additional parameters may be added to the file or it can be edited in a GUI. Once refinement in <italic>SHELXL</italic> is finished, the refined coordinate file is read in and displayed. The resulting reflections file (<monospace>.fcf</monospace>) is converted into an mmCIF file, after which it is read in and the electron density is displayed. An interactive dialogue of geometric out­liers (disagreeable restraints and other problems discovered by <italic>SHELXL</italic>) can be displayed by parsing the <monospace>.lst</monospace> output file from <italic>SHELXL</italic>.</p>
    </sec>
    <sec id="sec7.3">
      <label>7.3.</label>
      <title><italic>MolProbity</italic> 
            </title>
      <p><italic>Coot</italic> interacts with programs and data from the <italic>Mol­Probity</italic> suite in a number of ways, some of which have already been described. In addition, <italic>MolProbity</italic> can provide <italic>Coot</italic> with a list of possible structural problems that need to be addressed in the form of a ‘to-do chart’ in either Python or Scheme format; this can be read into <italic>Coot</italic> (‘Calculate’→‘Scripting…’).</p>
    </sec>
    <sec id="sec7.4">
      <label>7.4.</label>
      <title><italic>CCP</italic>4<italic>mg</italic> 
            </title>
      <p>Coot can write <italic>CCP</italic>4<italic>mg</italic> picture-definition files (Potterton <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb35"> ▶</xref>). These files are human-readable and editable and define the scene displayed by <italic>CCP</italic>4<italic>mg</italic>. Currently, the view and all displayed coordinate models and maps are described in the <italic>Coot</italic>-generated definition file. Hence, the displayed scene in <italic>Coot</italic> when saving the file is identical to that in <italic>CCP</italic>4<italic>mg</italic> after reading the picture-definition file. For convenience, a button is provided which will automatically produce the picture-definition file and open it in <italic>CCP</italic>4<italic>mg</italic>.</p>
    </sec>
    <sec id="sec7.5">
      <label>7.5.</label>
      <title><italic>Raster</italic>3<italic>D</italic>/<italic>POV-Ray</italic> 
            </title>
      <p><italic>Raster</italic>3<italic>D</italic> (Merritt &amp; Bacon, 1997<xref ref-type="bibr" rid="bb31"> ▶</xref>) and <italic>POV-Ray</italic> (Persistence of Vision Pty Ltd, 2004<xref ref-type="bibr" rid="bb34"> ▶</xref>) are commonly used programs for the production of publication-quality figures in macromolecular crystallography. <italic>Coot</italic> writes input files for both of these programs to display the current view. These can then be rendered and ray-traced by the external programs either externally or directly within <italic>Coot</italic> using ‘default’ parameters. The resulting images display molecular models in ball-and-stick representation and electron densities as wire frames.</p>
    </sec>
  </sec>
  <sec id="sec8">
    <label>8.</label>
    <title>Scripting</title>
    <p>Most internal functions in <italic>Coot</italic> are accessible <italic>via</italic> a SWIG (Simplified Wrapper and Interface Generator) interface to the scripting languages Python (<ext-link ext-link-type="uri" xlink:href="http://www.python.org">http://www.python.org</ext-link>) and Guile (a Scheme interpreter; Kelsey <italic>et al.</italic>, 1998<xref ref-type="bibr" rid="bb19"> ▶</xref>; <ext-link ext-link-type="uri" xlink:href="http://www.gnu.org/software/guile/guile.html">http://www.gnu.org/software/guile/guile.html</ext-link>). <italic>Via</italic> the same interface, some of <italic>Coot</italic>’s graphics widgets are available to the scripting layer (<italic>e.g.</italic> the main menu bar and the main toolbar). The availability of two scripting interfaces allows greater flexibility for the user as well as facilitating the interaction of <italic>Coot</italic> with other applications.</p>
    <p>In addition to the availability of <italic>Coot</italic>’s internal functions, the scripting interface is enriched by a number of provided scripts (usually available in both scripting languages). Some of these scripts use GUIs, either through use of the <italic>Coot</italic> graphics widgets or <italic>via</italic> the GTK+2 extensions of the scripting lan­guages. A number of available scripts and functions are made available in an extra ‘Extensions’ menu. Scripting not only provides the user with the possibility of running internal <italic>Coot</italic> functions and scripts but also that of reading and writing their own scripts and customizing the menus.</p>
  </sec>
  <sec id="sec9">
    <label>9.</label>
    <title>Building and testing</title>
    <p>When <italic>Coot</italic> was made available to the public, three initial considerations were that it should be cross-platform, robust and easy to install. These considerations continue to be a challenge. To assist in meeting them, an automated scheduled build-and-test system has been developed, thus enabling almost constant deployment of the pre-release software.</p>
    <p>The subversion version-control system (<ext-link ext-link-type="uri" xlink:href="http://svnbook.red-bean.com/">http://svnbook.red-bean.com/</ext-link>) is used to manage source-code revisions. An ‘integration machine’ checks out the latest source code several times per hour, compiles the software and makes a source-code tar file. Less frequently, a heterogeneous array of build machines copies the source tar file and compiles it for the host architecture. After a successful build, the software is run against a test suite and only if the tests are passed is the software bundled and made available for download from the web site. All the build and test logs are made available on the <italic>Coot</italic> web site. Fortunately, users of the pre-release code seem to report problems without undue exasperation. It is the aim of the developers to respond rapidly to such reports.</p>
    <sec id="sec9.1">
      <label>9.1.</label>
      <title>Computer operating-system compatibility</title>
      <p><italic>Coot</italic> is released under the GNU General Public License (GPL) and depends upon many other GPL and open-source software components. <italic>Coot</italic>’s GUI and graphical display are based on rather standard infrastructure, including the X11 windowing system, OpenGL and associated software such as the cross-platform GTK+2 stack derived from the GIMP project. In addition, <italic>Coot</italic> depends upon open-source crystallographic software components including the Clipper libraries (Cowtan, 2003<xref ref-type="bibr" rid="bb7"> ▶</xref>), the MMDB library (Krissinel <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb25"> ▶</xref>), the <italic>SSM</italic> library (Krissinel &amp; Henrick, 2004<xref ref-type="bibr" rid="bb24"> ▶</xref>) and the <italic>CCP</italic>4 libraries. In principle, <italic>Coot</italic> and its dependencies can be in­stalled on any modern GNU/Linux or Unix platform without fanfare. A Windows-based version of <italic>Coot</italic> is also available.</p>
    </sec>
    <sec id="sec9.2">
      <label>9.2.</label>
      <title><italic>Coot</italic> on GNU/Linux</title>
      <p>Compiling and installing <italic>Coot</italic> on the GNU/Linux operating system is probably the most straightforward option. GNU/Linux is in essence a free software/open-source collaborative implementation of the Unix operating system that is compatible with most computer hardware. <italic>Coot</italic>’s infrastructural dependencies, such as GTK+2 and other GNU libraries, as well as all of its crystallographic software dependencies, were selected with portability in mind. Most of the required dependencies are either installed with the GNOME desktop or are readily available for installation <italic>via</italic> the package-management systems specific to each distribution.</p>
      <p>It is possible that in future <italic>Coot</italic> (along with all its dependencies) will be made available <italic>via</italic> the official package-distribution systems for several of the major GNU/Linux distributions. When an end-user chooses to install the <italic>Coot</italic> package, all of <italic>Coot</italic>’s required dependencies will be installed along with it in a simple and painless procedure.</p>
      <p>An official <italic>Coot</italic> package currently exists in the Gentoo distribution (maintained by Donnie Berkholz), a Fedora package (maintained by Tim Fenn) is under development at the time of writing and unofficial Debian and rpm <italic>Coot</italic> packages are also available. Binary <italic>Coot</italic> releases for the most popular GNU/Linux platforms are available from the <italic>Coot</italic> website: <ext-link ext-link-type="uri" xlink:href="http://www.ysbl.york.ac.uk/~emsley/software/binaries/">http://www.ysbl.york.ac.uk/~emsley/software/binaries/</ext-link>.</p>
      <p>Additional information on installing <italic>Coot</italic> on GNU/Linux, either as a pre-compiled binary or from source code, is available on the <italic>Coot</italic> wiki: <ext-link ext-link-type="uri" xlink:href="http://strucbio.biologie.uni-konstanz.de/ccp4wiki/index.php/COOT">http://strucbio.biologie.uni-konstanz.de/ccp4wiki/index.php/COOT</ext-link>.</p>
    </sec>
    <sec id="sec9.3">
      <label>9.3.</label>
      <title>Coot on Apple’s Mac OS X</title>
      <p>With the release of Apple’s Mac OS X, a Unix-based operating system, it became possible to use most if not all of the standard crystallographic software on Apple computers. OS X does not natively use the X11 windowing system, but rather a proprietary windowing technology called Quartz. This system has some benefits over X11, but does not support X11-based Unix software. However, the X11 windowing system can be run within OS X (in rootless mode) and as of OS X version 10.5 this has become a default option and operates in a reasonably seamless manner.</p>
      <p>Unlike GNU/Linux, Apple does not provide the X11-based dependencies (GTK+2, GNOME libraries) and many of the other open-source components required to install and run <italic>Coot</italic>. However, third-party package-management systems have appeared to fill this gap, having made it their mission to port essentially all of the most important software that is freely available to users of other Unix-based systems to OS X. The two most popular package-management systems are <italic>Fink</italic> and <italic>MacPorts</italic>. Of these, <italic>Fink</italic> makes available a larger collection of software that is of use to scientists, including a substantial collection of crystallographic software. For that reason, <italic>Fink</italic> has been adopted as the preferred option for installing <italic>Coot</italic> on Mac OS X. <italic>Fink</italic> uses many of the same software tools as the Debian GNU/Linux package-management system and provides a convenient front-end.</p>
      <p>In practice, this requires the end user to do three things in preparation for installing <italic>Coot</italic> under OS X. <list list-type="simple"><list-item><p>(i) Install Apple’s X-code Developer tools. This is a free gigabyte-sized download available from Apple.</p></list-item><list-item><p>(ii) Install the very latest version of X11. This is crucial, as many bug fixes are required to run <italic>Coot</italic>.</p></list-item><list-item><p>(iii) Install the third-party package-management system <italic>Fink</italic> and enable the ‘unstable’ software tree to obtain access to the latest software.</p></list-item></list>
               <italic>Coot</italic> may then be installed through <italic>Fink</italic> with the command <monospace>fink install coot</monospace>.</p>
    </sec>
    <sec id="sec9.4">
      <label>9.4.</label>
      <title><italic>Coot</italic> on Microsoft Windows</title>
      <p>Since Microsoft Windows operating systems are the most widely used computer platform, a <italic>Coot</italic> version which runs on Microsoft Windows has been made available (<italic>WinCoot</italic>). All of <italic>Coot</italic>’s dependencies compile readily on Windows systems (although some require small adjustments) or are available as GPL/open-source binary downloads. The availability of GTK+2 (dynamically linked) libraries (DLLs) for Windows makes it possible to compile <italic>Coot</italic> without the requirement of the X11 windowing system, which would depend on an emulation layer (<italic>e.g. Cygwin</italic>). Some minor adjustments to <italic>Coot</italic> itself were necessary owing to differences in operating-system architecture, <italic>e.g.</italic> the filesystem (Lohkamp <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb27"> ▶</xref>). Currently <italic>WinCoot</italic>, by default, only uses Python as a scripting language since the Guile GTK+2 extension module is not seen as robust enough on Windows. <italic>WinCoot</italic> binaries are, as for GNU/Linux systems, automatically built and tested on a regular basis. The program is executed using a batch script and has been shown to work on Windows 98, NT, 2000, XP and Vista.</p>
      <p><italic>WinCoot</italic> binaries (stable as well as pre-releases) are available as a self-extracting file from <ext-link ext-link-type="uri" xlink:href="http://www.ysbl.york.ac.uk/~lohkamp/coot/">http://www.ysbl.york.ac.uk/~lohkamp/coot/</ext-link>.</p>
    </sec>
  </sec>
  <sec id="sec10" sec-type="discussion|interpretation">
    <label>10.</label>
    <title>Discussion</title>
    <p><italic>Coot</italic> tries to combine modern methods in macromolecular model building and validation with concerns about a modern GUI application such as ease of use, productivity, aesthetics and forgiveness. This is an ongoing process and although improvements can still be made, we believe that <italic>Coot</italic> has an easy-to-learn intuitive GUI combined with a high level of crystallographic awareness, providing useful tools for the novice and experienced alike.</p>
    <p>However, <italic>Coot</italic> has a number of limitations: NCS-averaged maps are poorly implemented, being meaningful only over a limited part of the unit cell (or crystal). There is also a mis­match in symmetry when using maps from cryo-EM data (<italic>Coot</italic> incorrectly applies crystal symmetry to EM maps). <italic>Coot</italic> is not at all easy to compile, having many dependencies: this is a problem for developers and advanced users.</p>
    <sec id="sec10.1">
      <label>10.1.</label>
      <title>Future</title>
      <p><italic>Coot</italic> is under constant development. New features and bug fixes are added on an almost daily basis. It is anticipated that further tools will be added for validation, nucleotide and carbohydrate model building, as well as for refinement. Interactive model building will be enhanced by communication with the <italic>CCP</italic>4 database, use of annotations and an interactive notebook and by adding annotation representation into the validation graphs. The embedded scripting languages provide the potential for sophisticated communication with model-building tools such as <italic>Buccaneer</italic>, <italic>ARP</italic>/<italic>wARP</italic> and <italic>PHENIX</italic>; in future this may be extended to include density modification as well.</p>
      <p>In the longer term tools to handle EM maps are planned, including the possibility of building and refining models. The appropriate data structures are already implemented in the Clipper libraries but are not yet available in <italic>Coot</italic>.</p>
      <p>The integration of validation tools will be expanded, especially with respect to <italic>MolProbity</italic>, and an interface to the <italic>WHAT_CHECK</italic> validation program (Hooft <italic>et al.</italic>, 1996<xref ref-type="bibr" rid="bb16"> ▶</xref>) will be added. <italic>WHAT_CHECK</italic> provides machine-readable output and this can be read by <italic>Coot</italic> to provide both an interactive description and navigation as well as (requiring more work) a mode to automatically fix up problematic geometry.</p>
      <p><italic>Note added in proof</italic>: Ian Tickle has noted a potential problem with the calculation of χ<sup>2</sup> values resulting from real-space refinement. <italic>Coot</italic> will be reworked to instead represent the r.m.s. deviation from ideality of each of the geometrical terms.</p>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <p>KC would like to thank the <funding-source>Royal Society</funding-source> and the United Kingdom BBSRC (BBF0202281) for funding. BL acknowledges the United Kingdom BBSRC (BB/D522403) for funding. PE acknowledges CCP4 for funding.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="bb1">
      <mixed-citation publication-type="other">Adams, P. D., Grosse-Kunstleve, R. W., Hung, L.-W., Ioerger, T. R., McCoy, A. J., Moriarty, N. W., Read, R. J., Sacchettini, J. C., Sauter, N. K. &amp; Terwilliger, T. C. (2002). <italic>Acta Cryst.</italic> D<bold>58</bold>, 1948–1954.</mixed-citation>
    </ref>
    <ref id="bb2">
      <mixed-citation publication-type="other">Bernstein, F. C., Koetzle, T. F., Williams, G. J. B., Meyer, E. F. Jr, Brice, M. D., Rodgers, J. R., Kennard, O., Shimanouchi, T. &amp; Tasumi, M. (1977). <italic>J. Mol. Biol.</italic><bold>112</bold>, 535–542.</mixed-citation>
    </ref>
    <ref id="bb3">
      <mixed-citation publication-type="other">Blanc, E., Roversi, P., Vonrhein, C., Flensburg, C., Lea, S. M. &amp; Bricogne, G. (2004). <italic>Acta Cryst.</italic> D<bold>60</bold>, 2210–2221.</mixed-citation>
    </ref>
    <ref id="bb4">
      <mixed-citation publication-type="other">Blundell, T. L., Jhoti, H. &amp; Abell, C. (2002). <italic>Nature Rev. Drug Discov.</italic><bold>1</bold>, 45–54.</mixed-citation>
    </ref>
    <ref id="bb5">
      <mixed-citation publication-type="other">Brünger, A. T. (1992). <italic>X-PLOR</italic> v.3.1. <italic>A System for X-ray Crystallo­graphy and NMR.</italic> New Haven: Yale University Press.</mixed-citation>
    </ref>
    <ref id="bb6">
      <mixed-citation publication-type="other">Cowtan, K. (2000). <italic>Acta Cryst.</italic> D<bold>56</bold>, 1612–1621.</mixed-citation>
    </ref>
    <ref id="bb7">
      <mixed-citation publication-type="other">Cowtan, K. (2003). <italic>IUCr Comput. Commun. Newsl.</italic><bold>2</bold>, 4–9.</mixed-citation>
    </ref>
    <ref id="bb8">
      <mixed-citation publication-type="other">Cowtan, K. (2006). <italic>Acta Cryst.</italic> D<bold>62</bold>, 1002–1011.</mixed-citation>
    </ref>
    <ref id="bb9">
      <mixed-citation publication-type="journal">Cowtan, K. (2010). <italic>Acta Cryst.</italic> D<bold>66</bold>, 470–478.</mixed-citation>
    </ref>
    <ref id="bb10">
      <mixed-citation publication-type="other">Dauter, Z. (2006). <italic>Acta Cryst.</italic> D<bold>62</bold>, 1–11.</mixed-citation>
    </ref>
    <ref id="bb11">
      <mixed-citation publication-type="other">Davis, I. W., Leaver-Fay, A., Chen, V. B., Block, J. N., Kapral, G. J., Wang, X., Murray, L. W., Arendall, W. B. III, Snoeyink, J., Richardson, J. S. &amp; Richardson, D. C. (2007). <italic>Nucleic Acids Res.</italic><bold>35</bold>, W375–W383.</mixed-citation>
    </ref>
    <ref id="bb12">
      <mixed-citation publication-type="other">DeLano, W. L. (2002). <italic>The PyMOL Molecular Viewer.</italic> http://www.pymol.org.</mixed-citation>
    </ref>
    <ref id="bb13">
      <mixed-citation publication-type="other">Emsley, P. &amp; Cowtan, K. (2004). <italic>Acta Cryst.</italic> D<bold>60</bold>, 2126–2132.</mixed-citation>
    </ref>
    <ref id="bb14">
      <mixed-citation publication-type="other">Esnouf, R. M. (1997). <italic>Acta Cryst.</italic> D<bold>53</bold>, 665–672.</mixed-citation>
    </ref>
    <ref id="bb15">
      <mixed-citation publication-type="other">Greer, J. (1974). <italic>J. Mol. Biol.</italic><bold>82</bold>, 279–301.</mixed-citation>
    </ref>
    <ref id="bb16">
      <mixed-citation publication-type="other">Hooft, R. W. W., Vriend, G., Sander, C. &amp; Abola, E. E. (1996). <italic>Nature (London)</italic>, <bold>381</bold>, 272.</mixed-citation>
    </ref>
    <ref id="bb18">
      <mixed-citation publication-type="other">Jones, T. A. &amp; Thirup, S. (1986). <italic>EMBO J.</italic><bold>5</bold>, 819–822.</mixed-citation>
    </ref>
    <ref id="bb17">
      <mixed-citation publication-type="other">Jones, T. A., Zou, J.-Y., Cowan, S. W. &amp; Kjeldgaard, M. (1991). <italic>Acta Cryst.</italic> A<bold>47</bold>, 110–119.</mixed-citation>
    </ref>
    <ref id="bb19">
      <mixed-citation publication-type="other">Kelsey, R., Clinger, W. &amp; Rees, J. (1998). <italic>Higher-Order and Symbolic Computation</italic>, <bold>11</bold>, 7–105.</mixed-citation>
    </ref>
    <ref id="bb20">
      <mixed-citation publication-type="other">Kleywegt, G. J. (1996). <italic>Acta Cryst.</italic> D<bold>52</bold>, 842–857.</mixed-citation>
    </ref>
    <ref id="bb21">
      <mixed-citation publication-type="other">Kleywegt, G. J., Harris, M. R., Zou, J., Taylor, T. C., Wählby, A. &amp; Jones, T. A. (2004). <italic>Acta Cryst.</italic> D<bold>60</bold>, 2240–2249.</mixed-citation>
    </ref>
    <ref id="bb22">
      <mixed-citation publication-type="other">Kleywegt, G. J. &amp; Jones, T. A. (1994). <italic>Proceedings of the CCP4 Study Weekend. From First Map to Final Model</italic>, edited by S. Bailey, R. Hubbard &amp; D. Waller, pp. 59–66. Warrington: Daresbury Laboratory.</mixed-citation>
    </ref>
    <ref id="bb23">
      <mixed-citation publication-type="other">Kleywegt, G. J. &amp; Jones, T. A. (1996). <italic>Structure</italic>, <bold>4</bold>, 1395–1400.</mixed-citation>
    </ref>
    <ref id="bb24">
      <mixed-citation publication-type="other">Krissinel, E. &amp; Henrick, K. (2004). <italic>Acta Cryst.</italic> D<bold>60</bold>, 2256–2268.</mixed-citation>
    </ref>
    <ref id="bb25">
      <mixed-citation publication-type="other">Krissinel, E. B., Winn, M. D., Ballard, C. C., Ashton, A. W., Patel, P., Potterton, E. A., McNicholas, S. J., Cowtan, K. D. &amp; Emsley, P. (2004). <italic>Acta Cryst.</italic> D<bold>60</bold>, 2250–2255.</mixed-citation>
    </ref>
    <ref id="bb26">
      <mixed-citation publication-type="other">Langer, G., Cohen, S. X., Lamzin, V. S. &amp; Perrakis, A. (2008). <italic>Nature Protoc.</italic><bold>3</bold>, 1171–1179.</mixed-citation>
    </ref>
    <ref id="bb27">
      <mixed-citation publication-type="other">Lohkamp, B., Emsley, P. &amp; Cowtan, K. (2005). <italic>CCP4 Newsl.</italic><bold>42</bold>, contribution 7.</mixed-citation>
    </ref>
    <ref id="bb28">
      <mixed-citation publication-type="other">Lorensen, W. E. &amp; Cline, H. E. (1987). <italic>ACM SIGGRAPH Comput. Graph.</italic><bold>21</bold>, 163–169.</mixed-citation>
    </ref>
    <ref id="bb29">
      <mixed-citation publication-type="other">Lovell, S. C., Davis, I. W., Arendall, W. B. III., de Bakker, P. I. W., Word, J. M., Prisant, M. G., Richardson, J. S. &amp; Richardson, D. C. (2003). <italic>Proteins</italic>, <bold>50</bold>, 437–450.</mixed-citation>
    </ref>
    <ref id="bb30">
      <mixed-citation publication-type="other">Lovell, S. C., Word, J. M., Richardson, J. S. &amp; Richardson, D. C. (2000). <italic>Proteins</italic>, <bold>40</bold>, 389–408.</mixed-citation>
    </ref>
    <ref id="bb31">
      <mixed-citation publication-type="other">Merritt, E. A. &amp; Bacon, D. J. (1997). <italic>Methods Enzymol.</italic><bold>277</bold>, 505–524.</mixed-citation>
    </ref>
    <ref id="bb32">
      <mixed-citation publication-type="other">Murshudov, G. N., Vagin, A. A. &amp; Dodson, E. J. (1997). <italic>Acta Cryst.</italic> D<bold>53</bold>, 240–255.</mixed-citation>
    </ref>
    <ref id="bb33">
      <mixed-citation publication-type="other">Oldfield, T. J. (2001). <italic>Acta Cryst.</italic> D<bold>57</bold>, 696–705.</mixed-citation>
    </ref>
    <ref id="bb34">
      <mixed-citation publication-type="other">Persistence of Vision Pty Ltd (2004). <italic>POV-Ray – Persistence of Vision Raytracer.</italic> http://www.povray.org.</mixed-citation>
    </ref>
    <ref id="bb35">
      <mixed-citation publication-type="other">Potterton, L., McNicholas, S., Krissinel, E., Gruber, J., Cowtan, K., Emsley, P., Murshudov, G. N., Cohen, S., Perrakis, A. &amp; Noble, M. (2004). <italic>Acta Cryst.</italic> D<bold>60</bold>, 2288–2294.</mixed-citation>
    </ref>
    <ref id="bb36">
      <mixed-citation publication-type="other">Robertson, M. P. &amp; Scott, W. G. (2007). <italic>Science</italic>, <bold>315</bold>, 1549–1553.</mixed-citation>
    </ref>
    <ref id="bb37">
      <mixed-citation publication-type="other">Robertson, M. P. &amp; Scott, W. G. (2008). <italic>Acta Cryst.</italic> D<bold>64</bold>, 738–744.</mixed-citation>
    </ref>
    <ref id="bb38">
      <mixed-citation publication-type="other">Storoni, L. C., McCoy, A. J. &amp; Read, R. J. (2004). <italic>Acta Cryst.</italic> D<bold>60</bold>, 432–438.</mixed-citation>
    </ref>
    <ref id="bb39">
      <mixed-citation publication-type="other">Terwilliger, T. C., Klei, H., Adams, P. D., Moriarty, N. W. &amp; Cohn, J. D. (2006). <italic>Acta Cryst.</italic> D<bold>62</bold>, 915–922.</mixed-citation>
    </ref>
    <ref id="bb40">
      <mixed-citation publication-type="other">Vagin, A. A., Steiner, R. A., Lebedev, A. A., Potterton, L., McNicholas, S., Long, F. &amp; Murshudov, G. N. (2004). <italic>Acta Cryst.</italic> D<bold>60</bold>, 2184–2195.</mixed-citation>
    </ref>
    <ref id="bb41">
      <mixed-citation publication-type="other">Vonrhein, C., Blanc, E., Roversi, P. &amp; Bricogne, G. (2007). <italic>Methods Mol. Biol.</italic><bold>364</bold>, 215–230.</mixed-citation>
    </ref>
    <ref id="bb42">
      <mixed-citation publication-type="other">Wang, J. W., Chen, J. R., Gu, Y. X., Zheng, C. D., Jiang, F., Fan, H. F., Terwilliger, T. C. &amp; Hao, Q. (2004). <italic>Acta Cryst.</italic> D<bold>60</bold>, 1244–1253.</mixed-citation>
    </ref>
    <ref id="bb43">
      <mixed-citation publication-type="other">Westbrook, J. D., Yang, H., Feng, Z. &amp; Berman, H. M. (2005). <italic>International Tables for Crystallography</italic>, Vol. <italic>G</italic>, edited by S. R. Hall &amp; B. McMahon, pp. 539–543. Heidelberg: Springer.</mixed-citation>
    </ref>
    <ref id="bb44">
      <mixed-citation publication-type="other">Williams, S. P., Kuyper, L. F. &amp; Pearce, K. H. (2005). <italic>Curr. Opin. Chem. Biol.</italic><bold>9</bold>, 371–380.</mixed-citation>
    </ref>
    <ref id="bb45">
      <mixed-citation publication-type="other">Word, J. M., Lovell, S. C., LaBean, T. H., Taylor, H. C., Zalis, M. E., Presley, B. K., Richardson, J. S. &amp; Richardson, D. C. (1999). <italic>J. Mol. Biol.</italic><bold>285</bold>, 1711–1733.</mixed-citation>
    </ref>
    <ref id="bb46">
      <mixed-citation publication-type="other">Word, J. M., Lovell, S. C., Richardson, J. S. &amp; Richardson, D. C. (1999). <italic>J. Mol. Biol.</italic><bold>285</bold>, 1735–1747.</mixed-citation>
    </ref>
    <ref id="bb47">
      <mixed-citation publication-type="other">Zhang, K. Y. J., Cowtan, K. &amp; Main, P. (1997). <italic>Methods Enzymol.</italic><bold>277</bold>, 53–64.</mixed-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="fig1" position="float">
    <label>Figure 1</label>
    <caption>
      <p><italic>Coot</italic> architecture, showing the layers of functionality from the user interface down to some of the low-level libraries. The libraries are described in more detail in the main text (§§<xref ref-type="sec" rid="sec3.4"/>3.4, <xref ref-type="sec" rid="sec3.5"/>3.5, <xref ref-type="sec" rid="sec4.3"/>4.3 and <xref ref-type="sec" rid="sec4.4"/>4.4).</p>
    </caption>
    <graphic xlink:href="d-66-00486-fig1"/>
  </fig>
  <fig id="fig2" position="float">
    <label>Figure 2</label>
    <caption>
      <p>The <italic>Coot</italic> main window. The main display area shows a molecule and electron density. At the top of the window is a menu bar providing access to most of the tools. Commonly used model-manipulation tools are also available through the toolbar on the right. Below the menu bar is an area for user-definable buttons. A status bar is displayed below the three-dimensional canvas.</p>
    </caption>
    <graphic xlink:href="d-66-00486-fig2"/>
  </fig>
  <fig id="fig3" position="float">
    <label>Figure 3</label>
    <caption>
      <p>Mouse controls: a schematic mouse is shown with the clicked button in grey. Additional keys to be pressed are shown to the left of the mouse. On the right-hand side is a schematic of the mouse control action together with an explanation.</p>
    </caption>
    <graphic xlink:href="d-66-00486-fig3"/>
  </fig>
  <fig id="fig4" position="float">
    <label>Figure 4</label>
    <caption>
      <p>Real-space refinement of a mispositioned residue. The coloured bonds show the original structure. The white bonds show the refined atoms after dragging and refinement. The coloured boxes in the pop-up window indicate how well the new model obeys various geometric restraints. Clicking the ‘Accept’ button will cause the coloured atoms to be moved to the new positions.</p>
    </caption>
    <graphic xlink:href="d-66-00486-fig4"/>
  </fig>
  <fig id="fig5" position="float">
    <label>Figure 5</label>
    <caption>
      <p>A model with an NCS ghost. The thick bonds represent the atoms in one chain of the protein. The thin bonds represent an NCS-related chain transformed to superpose on the first chain. At the bottom of the screen the atoms coincide; at the top the main chain deviates and a side chain is in a different conformation.</p>
    </caption>
    <graphic xlink:href="d-66-00486-fig5"/>
  </fig>
  <fig id="fig6" position="float">
    <label>Figure 6</label>
    <caption>
      <p>Electron density with NCS map for the same model and in the same orientation as the previous figure. The blue density is for the original chain. The magenta contour represents the electron density for the NCS-related chain transformed back onto the original chain and clearly showing the differences.</p>
    </caption>
    <graphic xlink:href="d-66-00486-fig6"/>
  </fig>
  <fig id="fig7" position="float">
    <label>Figure 7</label>
    <caption>
      <p>A typical validation graph. Bars represent individual residues in a chain, with an indication of quality for the residue being given by both the size and colour of the bar. The plot is interactive, <italic>i.e.</italic> clicking on a bar takes the user to the corresponding residue.</p>
    </caption>
    <graphic xlink:href="d-66-00486-fig7"/>
  </fig>
  <fig id="fig8" position="float">
    <label>Figure 8</label>
    <caption>
      <p>Screenshot of a classical Ramachandran plot showing all residues, with the axes defining the ϕ and ψ angles (angles in degrees). Preferred regions are coloured in pink, allowed regions in yellow and the background in grey for disallowed regions. Standard residues are shown as dark blue squares, Pro residues as light blue squares and Gly residues as light blue open triangles. Residues in the disallowed regions are coloured red.</p>
    </caption>
    <graphic xlink:href="d-66-00486-fig8"/>
  </fig>
  <fig id="fig9" position="float">
    <label>Figure 9</label>
    <caption>
      <p>Screenshot of a Kleywegt plot (Kleywegt, 1996<xref ref-type="bibr" rid="bb20"> ▶</xref>) showing Ramachandran differences between two NCS-related chains by connecting lines (angles in degrees). Labels, colouring and symbols are as in the previous figure. Arrows link NCS-related residues.</p>
    </caption>
    <graphic xlink:href="d-66-00486-fig9"/>
  </fig>
  <table-wrap id="table1" position="float">
    <label>Table 1</label>
    <caption>
      <title>Map data labels output by common crystallography software, including <italic>DM</italic> (Zhang <italic>et al.</italic>, 1997<xref ref-type="bibr" rid="bb47"> ▶</xref>), <italic>Parrot</italic> (Cowtan, 2010<xref ref-type="bibr" rid="bb9"> ▶</xref>), <italic>Pirate</italic> (Cowtan, 2000<xref ref-type="bibr" rid="bb6"> ▶</xref>) and <italic>autoSHARP</italic> (Vonrhein <italic>et al.</italic>, 2007<xref ref-type="bibr" rid="bb41"> ▶</xref>)</title>
    </caption>
    <table frame="hsides" rules="groups">
      <thead valign="bottom">
        <tr>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">Source of MTZ </th>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">Column labels for ‘best’ map </th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>DM</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">FDM, PHIDM </td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>Parrot</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">parrot.F_phi.F, parrot.F_phi.phi </td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>Pirate</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">pirate.F_phi.F, pirate.F_phi.phi </td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top"><italic>autoSHARP</italic> (phasing) </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">FP, PHIB (or Fcent, PHIcent if light atoms only) </td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top"><italic>autoSHARP</italic> (post-<italic>SOLOMON</italic>) </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">FBsol, PHIBshasol (or Fcentshasol, PHIcentshasol if light atoms only)</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</floats-group>
