<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3400962</article-id>
    <article-id pub-id-type="pmid">22635606</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bts315</article-id>
    <article-id pub-id-type="publisher-id">bts315</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group>
          <subject>Genetic and Population Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Gowinda: unbiased analysis of gene set enrichment for genome-wide association studies</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Kofler</surname>
          <given-names>Robert</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schlötterer</surname>
          <given-names>Christian</given-names>
        </name>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1">Institut für Populationsgenetik, Vetmeduni Vienna, Veterinärplatz 1, A-1210 Wien, Austria</aff>
    <author-notes>
      <corresp id="COR1">* To whom correspondence should be addressed.</corresp>
      <fn>
        <p>Associate Editor: Jeffrey Barrett</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>1</day>
      <month>8</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>26</day>
      <month>5</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>26</day>
      <month>5</month>
      <year>2012</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <!-- oupReleaseDelayRemoved from OA Article (10.1093/bioinformatics/bts315bts315APPLICATIONS NOTEGENETIC AND POPULATION ANALYSISGowinda: unbiased analysis of gene set enrichment for genome-wide association studiesKoflerRobertSchl&#x000f6;ttererChristian*Institut f&#x000fc;r Populationsgenetik, Vetmeduni Vienna, Veterin&#x000e4;rplatz 1, A-1210 Wien, Austria* To whom correspondence should be addressed.Associate Editor: Jeffrey Barrett182012265201228152084208512320123520122252012&#x000a9; The Author(s) 2012. Published by Oxford University Press.2012This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/3.0), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.Summary: An analysis of gene set [e.g. Gene Ontology (GO)] enrichment assumes that all genes are sampled independently from each other with the same probability. These assumptions are violated in genome-wide association (GWA) studies since (i) longer genes typically have more single-nucleotide polymorphisms resulting in a higher probability of being sampled and (ii) overlapping genes are sampled in clusters. Herein, we introduce Gowinda, a software specifically designed to test for enrichment of gene sets in GWA studies. We show that GO tests on GWA data could result in a substantial number of false-positive GO terms. Permutation tests implemented in Gowinda eliminate these biases, but maintain sufficient power to detect enrichment of GO terms. Since sufficient resolution for large datasets requires millions of permutations, we use multi-threading to keep computation times reasonable.Availability and implementation: Gowinda is implemented in Java (v1.6) and freely available on http://code.google.com/p/gowinda/Contact: christian.schloetterer@vetmeduni.ac.atSupplementary information: Manual: http://code.google.com/p/gowinda/wiki/Manual. Test data and tutorial: http://code.google.com/p/gowinda/wiki/Tutorial. Validation: http://code.google.com/p/gowinda/wiki/Validation.) -->
    <volume>28</volume>
    <issue>15</issue>
    <fpage>2084</fpage>
    <lpage>2085</lpage>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>3</month>
        <year>2012</year>
      </date>
      <date date-type="rev-recd">
        <day>3</day>
        <month>5</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>5</month>
        <year>2012</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2012. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2012</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">http://creativecommons.org/licenses/by-nc/3.0</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> An analysis of gene set [e.g. Gene Ontology (GO)] enrichment assumes that all genes are sampled independently from each other with the same probability. These assumptions are violated in genome-wide association (GWA) studies since (i) longer genes typically have more single-nucleotide polymorphisms resulting in a higher probability of being sampled and (ii) overlapping genes are sampled in clusters. Herein, we introduce Gowinda, a software specifically designed to test for enrichment of gene sets in GWA studies. We show that GO tests on GWA data could result in a substantial number of false-positive GO terms. Permutation tests implemented in Gowinda eliminate these biases, but maintain sufficient power to detect enrichment of GO terms. Since sufficient resolution for large datasets requires millions of permutations, we use multi-threading to keep computation times reasonable.</p>
      <p><bold>Availability and implementation:</bold> Gowinda is implemented in Java (v1.6) and freely available on <ext-link ext-link-type="uri" xlink:href="http://code.google.com/p/gowinda/">http://code.google.com/p/gowinda/</ext-link></p>
      <p>
        <bold>Contact:</bold>
        <email>christian.schloetterer@vetmeduni.ac.at</email>
      </p>
      <p><bold>Supplementary information:</bold> Manual: <ext-link ext-link-type="uri" xlink:href="http://code.google.com/p/gowinda/wiki/Manual">http://code.google.com/p/gowinda/wiki/Manual</ext-link>. Test data and tutorial: <ext-link ext-link-type="uri" xlink:href="http://code.google.com/p/gowinda/wiki/Tutorial">http://code.google.com/p/gowinda/wiki/Tutorial</ext-link>. Validation: <ext-link ext-link-type="uri" xlink:href="http://code.google.com/p/gowinda/wiki/Validation">http://code.google.com/p/gowinda/wiki/Validation</ext-link>.</p>
    </abstract>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>The advent of high-throughput analysis such as single-nucleotide polymorphism (SNP) arrays and next-generation sequencing enabled large-scale genome-wide association (GWA) studies (<xref ref-type="bibr" rid="B7">Nordborg and Weigel, 2008</xref>) or GWA-like studies, such as selective genotyping (<xref ref-type="bibr" rid="B4">Darvasi and Soller, 1994</xref>) and experimental evolution (<xref ref-type="bibr" rid="B8">Turner <italic>et al.</italic>, 2011</xref>), for almost any phenotype of interest. These studies typically yield hundreds of candidate SNPs associated with the studied trait. A wide-spread approach to shed light on the biological implications of these SNPs is a test for gene set enrichment [e.g. Gene Ontology (GO)] (<xref ref-type="bibr" rid="B1">Ashburner <italic>et al.</italic>, 2000</xref>; <xref ref-type="bibr" rid="B9">Wang <italic>et al.</italic>, 2010</xref>).</p>
    <p>Such an analysis of gene set enrichment is based on the assumptions that all genes are sampled independently from each other with the same probability. These assumptions are violated with data from GWA studies as (i) longer genes usually have more SNPs resulting in a higher probability of being sampled and (ii) overlapping genes are sampled in clusters (<xref ref-type="bibr" rid="B5">Holmans <italic>et al.</italic>, 2009</xref>). For these reasons, we developed Gowinda, a user-friendly and multi-threaded software specifically designed for detecting unbiased enrichment in gene sets from large datasets such as generated by GWA studies. By relying on standard file formats, any species with a sequenced and annotated genome may be analyzed, hence it favorably compares to a similar tool that is restricted to the analysis of GWA datasets in humans (<xref ref-type="bibr" rid="B5">Holmans <italic>et al.</italic>, 2009</xref>). [For a review of different available methods, see <xref ref-type="bibr" rid="B9">Wang <italic>et al.</italic> (2010</xref>)]. We validated Gowinda and show that the biases inherent to GWA dataset could result in a substantial number of false-positive GO terms and that Gowinda eliminates these biases while still yielding highly reliable results.</p>
  </sec>
  <sec id="SEC2">
    <title>2 IMPLEMENTATION</title>
    <p>Gowinda calculates the significance of overrepresentation for each gene set with permutation tests. Gowinda randomly samples SNPs from the total set of SNPs and records the associated genes. After repeating this permutation multiple times, an empirical null distribution of gene abundance for every gene set is obtained. The significance of overrepresentation of the candidate SNPs is estimated from the empirical null distribution. To account for multiple testing, an empirical false discovery rate (FDR) is calculated, by dividing the number of expected gene sets for a given <italic>P</italic>-value (averaged from the simulations) by the number of observed gene sets.</p>
    <p>Gowinda requires four input files, all of which widely used standard formats: a file with the annotation of the species of interest (.gtf or .gff), a file with the total set of SNPs used for the GWA study [.vcf, .mpileup or similar (<xref ref-type="bibr" rid="B3">Danecek, <italic>et al.</italic>, 2011</xref>; <xref ref-type="bibr" rid="B6">Li, <italic>et al.</italic>, 2009</xref>)], a file containing the candidate SNPs (must be a subset of all SNPs) and a file with the mapping of genes to gene sets. Such files with the mapping between genes and GO terms can, for example, be obtained either from FuncAssociate2 (<xref ref-type="bibr" rid="B2">Berriz <italic>et al.</italic>, 2009</xref>) or from High-Troughput (HT) GoMiner (<xref ref-type="bibr" rid="B10">Zeeberg <italic>et al.</italic>, 2005</xref>). In addition to this, Gowinda can be used to identify enrichment of SNPs in any user-defined gene set (Manual: <ext-link ext-link-type="uri" xlink:href="http://code.google.com/p/gowinda/wiki/Manual">http://code.google.com/p/gowinda/wiki/Manual</ext-link>; Test data and walkthrough: <ext-link ext-link-type="uri" xlink:href="http://code.google.com/p/gowinda/wiki/Tutorial">http://code.google.com/p/gowinda/wiki/Tutorial</ext-link>).</p>
    <p>Gowinda does not reproduce the exact pattern of linkage disequilibrium (LD) between SNPs but offers two complementary test strategies making two extreme assumptions about LD:
<list list-type="bullet"><list-item><p>SNPs are in linkage equilibrium: Gowinda randomly samples the same number of SNPs as candidate SNPs. Subsequently, the corresponding genes are identified and overrepresentation is estimated as described above. Note that the number of randomly sampled SNPs is kept constant in the simulations (–<italic>mode SNP</italic>) and that a gene may be considered several times according to the number of candidate SNPs.</p></list-item><list-item><p>SNPs are in complete LD: Gowinda randomly samples SNPs until the corresponding number of genes is identical to the number candidate genes. Finally, the significance of overrepresentation is estimated as described above. Note that the number of randomly sampled genes is kept constant in the simulations (–<italic>mode gene</italic>), but the number of sampled SNPs may vary between simulations. Furthermore, every gene is only considered once even when containing several candidate SNPs. This approach assumes complete LD between SNPs within a gene but does, however, not account for LD between genes.</p></list-item></list>
Another important feature of Gowinda is a flexible definition of a gene. This enables the user to include SNPs mapping to different features in the analysis, such as exons, introns, untranslated region or 2000 bp downstream. Possible definitions are as follows: exons, CDS, exons + introns, untranslated region, upstream + exons + introns, exons + introns + downstream and upstream + exons + introns + downstream.</p>
  </sec>
  <sec id="SEC3">
    <title>3 VALIDATION AND BENCHMARKS</title>
    <p>To test the reliability of Gowinda, we asked whether Gowinda reproduces the significance of overrepresentation for GO categories as the widely used tool HT GoMiner (<xref ref-type="bibr" rid="B10">Zeeberg <italic>et al.</italic>, 2005</xref>). We created an unbiased dataset by filtering for non-overlapping <italic>Drosophila melanogaster</italic> genes and introduced exactly five SNPs into each of the genes. Subsequently, we randomly sampled 1000 SNPs and computed the significance for the overrepresentation of every GO category, either on the basis of SNPs using Gowinda or based on the corresponding genes using HT GoMiner. We found that Gowinda yields almost identical results as HT GoMiner (<xref ref-type="fig" rid="F1">Fig. 1</xref>A; Spearman's rank correlation; ρ&gt;0.99; <italic>P</italic>-value &lt;2.2×−10<sup>−16</sup>). We also assessed the bias introduced in GWAS data and to what extent Gowinda corrects for this bias. We created a biased dataset by introducing a SNP every 100 bp into all genes and again randomly sampled 1000 SNPs. We calculated the significance of overrepresentation using Gowinda and HT GoMiner. Consistent with the expected bias due to different gene lengths and overlapping genes, HT GoMiner reports a significant enrichment for 341 GO categories (FDR &lt; 0.05), whereas Gowinda correctly reports zero (FDR &lt; 0.05). We also found that the correlation of the <italic>P</italic>-values of overrepresentation for Gowinda and HT Gominer dramatically decreased with the biased dataset (<xref ref-type="fig" rid="F1">Fig. 1</xref>B; Spearman's rank correlation; ρ&gt;0.56; <italic>P</italic>-value &lt;2.2×10<sup>−16</sup>).
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Correlation of the significance of overrepresentation for GO terms as calculated by Gowinda and GoMiner using an unbiased (<bold>A</bold>) and a biased (<bold>B</bold>) dataset</p></caption><graphic xlink:href="bts315f1"/></fig></p>
    <p>Finally, we tested whether Gowinda correctly identifies overrepresentation for five randomly preselected GO categories. We randomly picked five small GO categories (5–10 genes) and introduced a candidate SNP into every gene associated with these GO categories. Subsequently, we randomly sampled SNPs from the biased dataset until a total of 1000 candidate SNPs were obtained. After analysis for GO term enrichment, we found that Gowinda correctly identified all preselected GO categories (FDR &lt; 0.05). Interestingly, significant enrichment was also identified for another 14 GO categories, which is due to the nesting of GO categories. Details about validation can be found at: <ext-link ext-link-type="uri" xlink:href="http://code.google.com/p/gowinda/wiki/Validation">http://code.google.com/p/gowinda/wiki/Validation</ext-link>.</p>
    <p>Gowinda is reasonably fast, in <italic>D. melanogaster</italic> 1 000 000 simulations for 2 000 candidate SNPs out of a total of 1.8 million SNPs take about 31 min with a Mac Pro (10.5.8) using eight threads and requires about 1.2 GB of RAM. Memory consumption is mostly dependent on the total number of SNPs and computation time scales with the number of simulations.</p>
    <p><italic>Funding</italic>: <funding-source>Austrian Science Fund (FWF)</funding-source><?release-delay 12|0?> grant (<award-id>P19467</award-id>) to C.S.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
</body>
<back>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ashburner</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene ontology: tool for the unification of biology. The Gene Ontology Consortium</article-title>
        <source>Nat. Genet.</source>
        <year>2000</year>
        <volume>25</volume>
        <fpage>25</fpage>
        <lpage>29</lpage>
        <pub-id pub-id-type="pmid">10802651</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berriz</surname>
            <given-names>G.F.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Next generation software for functional trend analysis</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>3043</fpage>
        <lpage>3044</lpage>
        <pub-id pub-id-type="pmid">19717575</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Danecek</surname>
            <given-names>P.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The variant call format and VCFtools</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>2156</fpage>
        <lpage>2158</lpage>
        <pub-id pub-id-type="pmid">21653522</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darvasi</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Soller</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Selective DNA pooling for determination of linkage between a molecular marker and a quantitative trait locus</article-title>
        <source>Genetics</source>
        <year>1994</year>
        <volume>138</volume>
        <fpage>1365</fpage>
        <lpage>1373</lpage>
        <pub-id pub-id-type="pmid">7896115</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Holmans</surname>
            <given-names>P.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene ontology analysis of GWA study data sets provides insights into the biology of bipolar disorder</article-title>
        <source>Am. J. Hum. Genet.</source>
        <year>2009</year>
        <volume>85</volume>
        <fpage>13</fpage>
        <lpage>24</lpage>
        <pub-id pub-id-type="pmid">19539887</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The sequence alignment/map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nordborg</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Weigel</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <article-title>Next-generation genetics in plants</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>456</volume>
        <fpage>720</fpage>
        <lpage>723</lpage>
        <pub-id pub-id-type="pmid">19079047</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Turner</surname>
            <given-names>T.L.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Population-based resequencing of experimentally evolved populations reveals the genetic basis of body size variation in <italic>Drosophila melanogaster</italic></article-title>
        <source>PLoS Genet.</source>
        <year>2011</year>
        <volume>7</volume>
        <fpage>e1001336</fpage>
        <pub-id pub-id-type="pmid">21437274</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>K.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Analysing biological pathways in genome-wide association studies</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>843</fpage>
        <lpage>854</lpage>
        <pub-id pub-id-type="pmid">21085203</pub-id>
      </element-citation>
    </ref>
    <ref id="B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeeberg</surname>
            <given-names>B.R.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-throughput GoMiner, an ‘industrial-strength’ integrative gene ontology tool for interpretation of multiple-microarray experiments, with application to studies of Common Variable Immune Deficiency (CVID)</article-title>
        <source>BMC Bioinformatics.</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>168</fpage>
        <pub-id pub-id-type="pmid">15998470</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
