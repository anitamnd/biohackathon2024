<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10493177</article-id>
    <article-id pub-id-type="pmid">37647640</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad535</article-id>
    <article-id pub-id-type="publisher-id">btad535</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genetics and Population Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>HAPNEST: efficient, large-scale generation and evaluation of synthetic datasets for genotypes and phenotypes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-2593-8081</contrib-id>
        <name>
          <surname>Wharrie</surname>
          <given-names>Sophie</given-names>
        </name>
        <aff><institution>Department of Computer Science, Aalto University</institution>, Espoo 02150, <country country="FI">Finland</country></aff>
        <xref rid="btad535-cor1" ref-type="corresp"/>
        <!--sophie.wharrie@aalto.fi-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>Zhiyu</given-names>
        </name>
        <aff><institution>Institute for Molecular Medicine Finland, FIMM, HiLIFE, University of Helsinki</institution>, Helsinki 00014, <country country="FI">Finland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Raj</surname>
          <given-names>Vishnu</given-names>
        </name>
        <aff><institution>Department of Computer Science, Aalto University</institution>, Espoo 02150, <country country="FI">Finland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Monti</surname>
          <given-names>Remo</given-names>
        </name>
        <aff><institution>Hasso Plattner Institute, University of Potsdam, Digital Engineering Faculty</institution>, Potsdam 14469, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gupta</surname>
          <given-names>Rahul</given-names>
        </name>
        <aff><institution>Broad Institute of MIT and Harvard</institution>, Cambridge, Massachusetts 02142, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Ying</given-names>
        </name>
        <aff><institution>Broad Institute of MIT and Harvard</institution>, Cambridge, Massachusetts 02142, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0241-3522</contrib-id>
        <name>
          <surname>Martin</surname>
          <given-names>Alicia</given-names>
        </name>
        <aff><institution>Broad Institute of MIT and Harvard</institution>, Cambridge, Massachusetts 02142, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>O’Connor</surname>
          <given-names>Luke J</given-names>
        </name>
        <aff><institution>Broad Institute of MIT and Harvard</institution>, Cambridge, Massachusetts 02142, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kaski</surname>
          <given-names>Samuel</given-names>
        </name>
        <aff><institution>Department of Computer Science, Aalto University</institution>, Espoo 02150, <country country="FI">Finland</country></aff>
        <aff><institution>Department of Computer Science, University of Manchester</institution>, Manchester M13 9PL, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Marttinen</surname>
          <given-names>Pekka</given-names>
        </name>
        <aff><institution>Department of Computer Science, Aalto University</institution>, Espoo 02150, <country country="FI">Finland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7999-1972</contrib-id>
        <name>
          <surname>Palamara</surname>
          <given-names>Pier Francesco</given-names>
        </name>
        <aff><institution>Department of Statistics, University of Oxford</institution>, Oxford OX1 2JD, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6363-2556</contrib-id>
        <name>
          <surname>Lippert</surname>
          <given-names>Christoph</given-names>
        </name>
        <aff><institution>Hasso Plattner Institute, University of Potsdam, Digital Engineering Faculty</institution>, Potsdam 14469, <country country="DE">Germany</country></aff>
        <aff><institution>Hasso Plattner Institute for Digital Health at Mount Sinai, Icahn School of Medicine at Mount Sinai</institution>, New York, New York 10065, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ganna</surname>
          <given-names>Andrea</given-names>
        </name>
        <aff><institution>Institute for Molecular Medicine Finland, FIMM, HiLIFE, University of Helsinki</institution>, Helsinki 00014, <country country="FI">Finland</country></aff>
        <aff><institution>Broad Institute of MIT and Harvard</institution>, Cambridge, Massachusetts 02142, <country country="US">United States</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schwartz</surname>
          <given-names>Russell</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad535-cor1">Corresponding author. Department of Computer Science, Aalto University, Konemiehentie 2, Espoo 02150, Finland. E-mail: <email>sophie.wharrie@aalto.fi</email> (S.W.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-08-30">
      <day>30</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>9</issue>
    <elocation-id>btad535</elocation-id>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>23</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>24</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>10</day>
        <month>9</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad535.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Existing methods for simulating synthetic genotype and phenotype datasets have limited scalability, constraining their usability for large-scale analyses. Moreover, a systematic approach for evaluating synthetic data quality and a benchmark synthetic dataset for developing and evaluating methods for polygenic risk scores are lacking.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present HAPNEST, a novel approach for efficiently generating diverse individual-level genotypic and phenotypic data. In comparison to alternative methods, HAPNEST shows faster computational speed and a lower degree of relatedness with reference panels, while generating datasets that preserve key statistical properties of real data. These desirable synthetic data properties enabled us to generate 6.8 million common variants and nine phenotypes with varying degrees of heritability and polygenicity across 1 million individuals. We demonstrate how HAPNEST can facilitate biobank-scale analyses through the comparison of seven methods to generate polygenic risk scoring across multiple ancestry groups and different genetic architectures.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>A synthetic dataset of 1 008 000 individuals and nine traits for 6.8 million common variants is available at <ext-link xlink:href="https://www.ebi.ac.uk/biostudies/studies/S-BSST936" ext-link-type="uri">https://www.ebi.ac.uk/biostudies/studies/S-BSST936</ext-link>. The HAPNEST software for generating synthetic datasets is available as Docker/Singularity containers and open source Julia and C code at <ext-link xlink:href="https://github.com/intervene-EU-H2020/synthetic_data" ext-link-type="uri">https://github.com/intervene-EU-H2020/synthetic_data</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Union’s Horizon 2020 research and innovation programme</institution>
          </institution-wrap>
        </funding-source>
        <award-id>101016775</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>With the emergence of large-scale biobanks, methods to analyse common genetic variants [single-nucleotide polymorphisms (SNPs)] across diverse human populations are in growing demand. This is especially the case for polygenic risk scoring (PRS) methods, which quantify an individual’s genetic risk for a disease or other phenotypic trait (<xref rid="btad535-B5" ref-type="bibr">Choi <italic toggle="yes">et al.</italic> 2020</xref>). Derived from one’s genotype, well-calibrated PRSs have the potential to be used for risk stratification and prognostic prediction (<xref rid="btad535-B5" ref-type="bibr">Choi <italic toggle="yes">et al.</italic> 2020</xref>). The utility of PRS has been demonstrated for certain common diseases among European ancestries, on which most genome-wide association studies (GWAS) were carried out (<xref rid="btad535-B17" ref-type="bibr">Mills and Rahal 2020</xref>), but some studies have highlighted limitations in transferability of PRS across ancestries and different socio-demographic groups (<xref rid="btad535-B3" ref-type="bibr">Araújo and Wheeler 2022</xref>). Thus, the development of methods that can improve the generalizability of PRSs is needed. At the same time, only a few accessible large-scale biobank datasets exist and most previous PRS methods have been tested and compared in UK Biobank (<xref rid="btad535-B19" ref-type="bibr">Pain <italic toggle="yes">et al.</italic> 2021</xref>). More diverse biobank datasets are needed, but due to the highly sensitive nature of genetics data, accessing and sharing individual-level data raises privacy concerns. This makes publicly accessible synthetic data a welcome alternative for methods developers.</p>
    <p>Broadly, two main approaches have been used to simulate individual level genetic data. Coalescence-based methods, such as Hudson’s ms and msprime (<xref rid="btad535-B11" ref-type="bibr">Hudson 2002</xref>, <xref rid="btad535-B13" ref-type="bibr">Kelleher <italic toggle="yes">et al.</italic> 2016</xref>), use demographic models to generate genomes including both rare and common variants. Reference-based approaches use real genomic data (e.g. 1000 genomes or HGDP) to generate synthetic data, but they are not suitable to generate realistic rare variants. There are also methods, such as simGWAS (<xref rid="btad535-B9" ref-type="bibr">Fortune and Wallace 2019</xref>), that directly simulate GWAS summary statistics. However, many times they do not meet modern demands for methods development based on individual level data. We will focus on reference-based approaches since for PRSs we are mostly interested in common genetic variation, which forms the bulk of complex trait heritability (<xref rid="btad535-B29" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> 2010</xref>). Moreover, common SNPs, especially Hapmap3 SNPs (<xref rid="btad535-B6" ref-type="bibr">International HapMap 3 Consortium 2010)</xref>, are widely recommended for PRS computation (<xref rid="btad535-B27" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2023</xref>). HAPGEN2 (<xref rid="btad535-B23" ref-type="bibr">Su <italic toggle="yes">et al.</italic> 2011</xref>) is a widely used tool for genotype and phenotype simulation, which preserves linkage disequilibrium (LD) patterns of real data through a resampling approach based on the Li and Stephens model (<xref rid="btad535-B15" ref-type="bibr">Li and Stephens 2003</xref>). However, HAPGEN2 lacks computational scalability and flexibility in phenotype generation to simulate certain scenarios of interest for biobank-scale PRS and SNP-based methods development, where the genetic architecture of the phenotype is an essential factor. Recent alternatives include G2P (<xref rid="btad535-B24" ref-type="bibr">Tang and Liu 2019</xref>) and Sim1000G (<xref rid="btad535-B7" ref-type="bibr">Dimitromanolakis <italic toggle="yes">et al.</italic> 2019</xref>). Sim1000G is an integrated R package, but is limited to genotype simulation. G2P encompasses both genotype and phenotype simulation, and is highly customizable, but this setup can be challenging for non-expert users. In <xref rid="btad535-T1" ref-type="table">Table 1</xref>, we provide an overview of the characteristics of these different approaches. Without an integrated approach for parameter selection and evaluation of synthetic data quality, it is difficult for end-users to understand the statistical guarantees and reliability of the generated datasets. To the best of our knowledge, there does not exist a software tool implementing an end-to-end pipeline for synthetic data generation, evaluation and optimization.</p>
    <table-wrap position="float" id="btad535-T1">
      <label>Table 1.</label>
      <caption>
        <p>Summary of main differences between HAPNEST and alternative synthetic data generation tools.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1"/>
            <th colspan="2" align="center" rowspan="1">Runtime for 100k synthetic samples<hr/></th>
          </tr>
          <tr>
            <th rowspan="1" colspan="1">Method</th>
            <th align="left" rowspan="1" colspan="1">Genotype simulation</th>
            <th align="left" rowspan="1" colspan="1">Phenotype simulation</th>
            <th align="left" rowspan="1" colspan="1">Parameter optimization</th>
            <th align="left" rowspan="1" colspan="1">Evaluation pipeline</th>
            <th align="left" rowspan="1" colspan="1">Open source</th>
            <th align="left" rowspan="1" colspan="1">Software platform</th>
            <th align="left" rowspan="1" colspan="1">∼20k SNPs</th>
            <th align="left" rowspan="1" colspan="1">∼100k SNPs</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">HAPNEST</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Automated</td>
            <td rowspan="1" colspan="1">Fidelity (MAF, LD, population structure, nearest-neighbour adversarial accuracy, GWAS results) and generalizability (kinship relatedness)</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Containerized command line tool</td>
            <td rowspan="1" colspan="1">15.0 min for one thread, 6.3 min for eight threads</td>
            <td rowspan="1" colspan="1">41.6 min for one thread, 11.7 min for eight threads</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">HAPGEN2</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Manual</td>
            <td rowspan="1" colspan="1">None</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Command line tool</td>
            <td rowspan="1" colspan="1">36.3 min for one thread, 33.4 min for eight threads</td>
            <td rowspan="1" colspan="1">339.2 min for one thread, 280.9 min for eight threads</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">G2P</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Manual</td>
            <td rowspan="1" colspan="1">GWAS results</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Java-based GUI</td>
            <td rowspan="1" colspan="1">Excluded from comparison</td>
            <td rowspan="1" colspan="1">Excluded from comparison</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Sim1000G</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Manual</td>
            <td rowspan="1" colspan="1">None</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">R package</td>
            <td rowspan="1" colspan="1">Excluded from comparison</td>
            <td rowspan="1" colspan="1">Excluded from comparison</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <p>To address these limitations, we introduce HAPNEST, a user-friendly tool for generating synthetic datasets for genotypes and phenotypes, evaluating synthetic data quality, and analysing the behaviour of model parameters with respect to the evaluation metrics. HAPNEST simulates genotypes by resampling a set of existing reference genomes, according to a stochastic model that approximates the underlying processes of coalescent, recombination and mutation. Like HAPGEN2, HAPNEST is also based on the Li and Stephens model of LD (<xref rid="btad535-B15" ref-type="bibr">Li and Stephens 2003</xref>), but HAPNEST additionally models the coalescence age of segments using an approximate model inspired by the sequential Markovian coalescent model (<xref rid="btad535-B16" ref-type="bibr">McVean and Cardin 2005</xref>). Phenotypes are subsequently assigned to each sample by integrating user-specified genetic, covariate, and environmental effects. Genetic effects are modelled in terms of heritability and polygenicity. HAPNEST enables efficient simulation of diverse biobank-scale datasets, as well as simultaneously generating multiple genetically correlated traits with population specific effects under different pleiotropy models. Moreover, the HAPNEST software includes an extensive workflow for evaluating synthetic data fidelity and generalizability, as well as approximate Bayesian computation (ABC) techniques for analysing the posterior distributions of model parameters to aid model selection.</p>
    <p>We compare the performance of HAPNEST with current state-of-the-art genotype and phenotype simulation tools in terms of data quality and computational speed. Furthermore, as a demonstration of the utility of our tool, we show the application of our diverse, biobank-scale synthetic data for evaluating the performance of various PRS methods under different disease models. Our open-source software tool is available at <ext-link xlink:href="https://github.com/intervene-EU-H2020/synthetic_data" ext-link-type="uri">https://github.com/intervene-EU-H2020/synthetic_data</ext-link>, and has also been distributed as Docker and Singularity containers. We have generated 6.8 million common variants and nine phenotypes with varying degrees of heritability and polygenicity across 1 million individuals and made this large synthetic dataset available at <ext-link xlink:href="https://www.ebi.ac.uk/biostudies/studies/S-BSST936" ext-link-type="uri">https://www.ebi.ac.uk/biostudies/studies/S-BSST936</ext-link> to encourage standardized evaluation of new statistical methods by the genomic research community.</p>
  </sec>
  <sec>
    <title>2 Overview of genotype generation methods</title>
    <p>HAPNEST simulates pairs of synthetic haplotypes, where each haplotype is constructed as a mosaic of segments of various lengths imperfectly copied from a reference set of real haplotypes (<xref rid="btad535-F1" ref-type="fig">Fig. 1a</xref>). This resampling approach, based on the Li and Stephens model (<xref rid="btad535-B15" ref-type="bibr">Li and Stephens 2003</xref>), is also used by other tools such as HAPGEN2, but HAPNEST differs in that it models a varying coalescent age of segments, <italic toggle="yes">T</italic>, when determining genetic distances, <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mi>ℓ</mml:mi></mml:math></inline-formula>, between cross-over events, and uses this to introduce age-based mutations. This is inspired by the sequential Markovian coalescent model (<xref rid="btad535-B16" ref-type="bibr">McVean and Cardin 2005</xref>) and motivated by the need to (i) preserve key statistical properties of real genotypes (fidelity) and (ii) limit overfitting to the reference data (generalizability) by introducing variability according to the coalescence process. Previous works have focused on generating high-fidelity data with respect to properties such as LD structure, but the generalizability property is also important when generating a large number of synthetic samples and genetic variants from few reference samples.</p>
    <fig position="float" id="btad535-F1">
      <label>Figure 1.</label>
      <caption>
        <p>(a) A reference set of real haplotypes, from which segments (coloured) are imperfectly copied to construct a synthetic haplotype. (b) Detailed view of an individual segment. The segment length, <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mi>ℓ</mml:mi></mml:math></inline-formula>, and coalescence time, <italic toggle="yes">T</italic>, are sampled from a stochastic model. The presence of a genetic variant at position <italic toggle="yes">i</italic> is only copied if <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mi>T</mml:mi><mml:mo>≤</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the variant’s age of mutation. Variants that are not copied are shown in red. (c) Synthetic genotypes, <italic toggle="yes">g</italic>, are constructed as pairs of synthetic haplotypes, <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. (d) Once the genotype is generated, liability of phenotype will subsequently be assigned to each sample as a summation of genetic effect, covariate effect (if any) and environmental noise.</p>
      </caption>
      <graphic xlink:href="btad535f1" position="float"/>
    </fig>
    <p>Specifically, the real haplotypes to copy from are sampled uniformly from a reference dataset, <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, of <italic toggle="yes">k</italic> SNPs for <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> samples, limited to individuals belonging to a certain ancestry group <italic toggle="yes">s</italic> (<inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo></mml:mrow></mml:math></inline-formula>AFR, AMR, EAS, EUR, CSA, MID<inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mo>}</mml:mo></mml:math></inline-formula>, where AFR = African, AMR = Admixed American, EAS = East Asian, EUR = European, CSA = Central/South Asian, MID = Middle Eastern). Alternatively, users can specify the proportion of real haplotypes to sample from each ancestry group. We refer to the Discussion section of the paper regarding the complications in interpreting admixed samples. Segments of length <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mi>ℓ</mml:mi></mml:math></inline-formula> (in centimorgans) are sampled from the real haplotypes (<xref rid="btad535-F1" ref-type="fig">Fig. 1b</xref>) based on the model
where for group <italic toggle="yes">s</italic>, <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the recombination rate and <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the effective population size. The presence of a genetic variant at position <italic toggle="yes">i</italic> is only copied if <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mi>T</mml:mi><mml:mo>≤</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, where <italic toggle="yes">T</italic> is the segment’s coalescent time and <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the variant’s age of mutation (obtained from <xref rid="btad535-B2" ref-type="bibr">Albers and McVean 2020</xref>). This does not create new mutations but introduces variability based on a coalescent model of when mutations entered the population. Two synthetic haplotypes, <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, constructed in this way are added element-wise to create a synthetic genotype, <italic toggle="yes">g</italic> (<xref rid="btad535-F1" ref-type="fig">Fig. 1c</xref>). For experiments in this text, we consider a reference dataset of 4062 phased genotypes derived from the publicly available 1000 Genomes Project and Human Genome Diversity Project (1KG+HGDP) datasets for six major discrete ancestry groups (<xref rid="btad535-B12" ref-type="bibr">Karczewski <italic toggle="yes">et al.</italic> 2020</xref>).</p>
    <disp-formula id="E1">
      <label>(1)</label>
      <mml:math id="M1" display="block" overflow="scroll">
        <mml:mrow>
          <mml:mi>ℓ</mml:mi>
          <mml:mo>∼</mml:mo>
          <mml:mo> </mml:mo>
          <mml:mi mathvariant="italic">Exp</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mn>2</mml:mn>
          <mml:mi>T</mml:mi>
          <mml:mrow>
            <mml:msub>
              <mml:mrow>
                <mml:mo>ρ</mml:mo>
              </mml:mrow>
              <mml:mi mathvariant="normal">s</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
          <mml:mo> </mml:mo>
          <mml:mi>T</mml:mi>
          <mml:mo>∼</mml:mo>
          <mml:mi mathvariant="italic">Gamma</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mn>2</mml:mn>
          <mml:mo>,</mml:mo>
          <mml:mrow>
            <mml:msub>
              <mml:mrow>
                <mml:mi>N</mml:mi>
              </mml:mrow>
              <mml:mi mathvariant="normal">s</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:mo>/</mml:mo>
          <mml:mrow>
            <mml:msub>
              <mml:mrow>
                <mml:mi>N</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">e</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi mathvariant="normal">s</mml:mi>
              </mml:mrow>
            </mml:msub>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:mrow>
      </mml:math>
    </disp-formula>
    <p>Finally, to aid the scalability of HAPNEST, we develop an efficient multithreaded implementation in the Julia programming language. Specifically, the operations that are parallelized across genotypes include the part of the algorithm that executes <xref rid="E1" ref-type="disp-formula">Equation (1)</xref> to determine how segments should be copied to construct synthetic haplotypes and the I/O operations that write these segments to an output file. We note that this parallelization and use of memory-mapped I/O for constant-time access of reference data makes HAPNEST suitable for use with large reference panels (even if they do not fit in the computer’s memory) and a large number of synthetic samples.</p>
    <sec>
      <title>2.1 Posterior distributions of model parameters</title>
      <p>HAPNEST uses ABC to optimize the model parameters for the fidelity and generalizability objectives (<xref rid="btad535-B18" ref-type="bibr">Naeem <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad535-B1" ref-type="bibr">Alaa <italic toggle="yes">et al.</italic> 2022</xref>). We define the ABC summary statistic for the fidelity objective as an LD decay vector, and the summary statistic for the generalizability objective is defined as a vector of the number of duplicate/MZ twin, first-degree and second-degree relatives between the synthetic and reference datasets. We measure generalizability in terms of genetic relatedness (defined by the kinship coefficient), to ensure that the samples in large synthetic datasets are not close copies of samples from the much smaller reference dataset. HAPNEST model parameters are selected as the means of the posterior distributions inferred using emulation-based rejection sampling (<xref rid="btad535-B25" ref-type="bibr">Tankhilevich <italic toggle="yes">et al.</italic> 2020</xref>). As an illustrative example, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref> shows the posterior distributions of the parameters that best satisfy the multiobjective criteria, for six discrete ancestry groups from the 1KG+HGDP reference for 18 267 HapMap3 variants on chromosome 21. We observe a tradeoff between optimizing the fidelity objective (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>) and optimizing the generalizability objective (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>). This tradeoff can affect the results of downstream analyses such as GWAS (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7</xref> and <xref rid="sup1" ref-type="supplementary-material">Table S9</xref>), and so it is important for users to choose the objective that matches the priorities of their use case.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Comparison of synthetic genotype quality</title>
    <p>Synthetic data quality is evaluated based on a workflow implemented in the HAPNEST software tool for measuring the fidelity, diversity, and generalizability of synthetic datasets. We compare HAPNEST with three alternative methods: HAPGEN2 (<xref rid="btad535-B23" ref-type="bibr">Su <italic toggle="yes">et al.</italic> 2011</xref>), G2P (<xref rid="btad535-B24" ref-type="bibr">Tang and Liu 2019</xref>), and Sim1000G (<xref rid="btad535-B7" ref-type="bibr">Dimitromanolakis <italic toggle="yes">et al.</italic> 2019</xref>). For these experiments, we consider two models for HAPNEST based on whether the multiobjective (fidelity and generalizability) or LD objective (fidelity only) was used to optimize the parameter values. The evaluation based on the LD objective alone is motivated by the fact that for applications such as GWAS and PRS, it is important to preserve realistic LD patterns in the synthetic data. For the other methods, which do not have built-in optimization procedures, parameters are selected manually to be comparable to the parameters used by the HAPNEST multiobjective approach, where possible (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Experiments</xref> section for a full list of parameter values used for other methods). The method comparison experiments use <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>syn</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula> samples generated from a reference of <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>ref</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>775</mml:mn></mml:mrow></mml:math></inline-formula> European-ancestry individuals from the 1KG+HGDP datasets (<xref rid="btad535-B12" ref-type="bibr">Karczewski <italic toggle="yes">et al.</italic> 2020</xref>), for 18 267 HapMap3 variants on chromosome 21. Due to limitations with scalability and compatibility of other methods, we do not evaluate larger synthetic datasets across methods, but we do provide a detailed evaluation of HAPNEST-generated datasets for larger synthetic datasets, non-European ancestry and larger SNP sets: <italic toggle="yes">N</italic><sub>syn</sub> = 1000, 25 000, <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="italic">EUR</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">AFR</mml:mi></mml:mrow></mml:math></inline-formula>, and <italic toggle="yes">k</italic> = 18 267, 1 09 673 (where the number of SNPs, <italic toggle="yes">k</italic>, correspond to the HapMap3 variants and SNPs with non-zero MAF in all six superpopulations, respectively, on chromosome 21).</p>
    <sec>
      <title>3.1 Fidelity</title>
      <p>Fidelity is measured as the similarity between the real (reference) and synthetic datasets for four properties: minor allele frequency (MAF) distribution, population structure in terms of alignment of the principal components (PCs), LD decay and nearest neighbour adversarial accuracy (full definitions are given in <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref> sections). The full fidelity results are reported in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>.</p>
      <sec>
        <title>3.1.1 Minor allele frequency</title>
        <p>The G2P method had the lowest divergence in MAF between the synthetic and reference datasets, followed by HAPNEST (LD objective), HAPNEST (multiobjective), and Sim1000G (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>).</p>
      </sec>
      <sec>
        <title>3.1.2 LD decay</title>
        <p>In <xref rid="btad535-F2" ref-type="fig">Fig. 2a and c</xref>, we provide a visualization of LD correlation matrices for a snapshot segment of the reference and synthetic samples generated by each method. We observe that the samples produced by HAPGEN, HAPNEST, and G2P faithfully capture the reference LD while Sim1000G amplifies the correlation among SNPs. To quantify this observation, we provide the LD decay plot (<xref rid="btad535-B14" ref-type="bibr">Laido <italic toggle="yes">et al.</italic> 2014</xref>) for all methods along with the reference in <xref rid="btad535-F2" ref-type="fig">Fig. 2b</xref>. The HAPNEST (LD objective) method had the LD decay that least diverged from the reference, followed by the G2P and HAPGEN2 methods (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). However, we observe that HAPNEST (multiobjective) has a faster LD decay (<xref rid="btad535-F2" ref-type="fig">Fig. 2b</xref>) and more generally, our posterior analysis indicates there is a tradeoff between optimizing the LD and relatedness objectives (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs. S3 and S4</xref>). Nevertheless, GWAS results presented later still indicate realistic LD structure at genome-wide significant loci. LD analyses similar to <xref rid="btad535-F2" ref-type="fig">Fig. 2b</xref> (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>) and <xref rid="btad535-F2" ref-type="fig">Fig. 2c</xref> (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>) for a wider range of HAPNEST-generated synthetic datasets show visually comparable LD results for a larger number of synthetic samples, number of SNPs and non-European ancestry.</p>
        <fig position="float" id="btad535-F2">
          <label>Figure 2.</label>
          <caption>
            <p>(a) LD correlation for 500 contiguous SNPs selected at random from chromosome 21 HapMap3 variants, for the European-ancestry reference dataset (<inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>ref</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>775</mml:mn></mml:mrow></mml:math></inline-formula>); (b) comparison of LD decay (<xref rid="btad535-B14" ref-type="bibr">Laido et al., 2014</xref>) for <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>syn</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula> European-ancestry synthetic samples; (c) comparison of LD correlation (for same 500 SNPs shown in reference panel) for <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>syn</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula> European-ancestry synthetic samples. We selected alleles with MAF <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula> and used <monospace>plink</monospace> with <monospace>– r2 square</monospace> flag to compute the LD correlation matrix.</p>
          </caption>
          <graphic xlink:href="btad535f2" position="float"/>
        </fig>
      </sec>
      <sec>
        <title>3.1.3 Population structure</title>
        <p>We evaluate preservation of population structure of HAPNEST and other state of the art simulators. <xref rid="btad535-F3" ref-type="fig">Figure 3a</xref> shows a PCA projection of 10 002 HAPNEST-generated individuals from six super populations based on chromosome 21. Visual separations between individuals from different populations demonstrate good preservation of overall population structure across multiple ancestries. <xref rid="btad535-F3" ref-type="fig">Figure 3b</xref> shows a visual comparison of projecting the top two PCs of 1000 European-ancestry individuals generated by each tool, aligning with the reference. For a more quantitative evaluation, we also compare the PC alignment score, defined as the cosine distance between the first 20 PCs obtained from real and synthetic data within European individuals. The PC alignment score captures the discrepancy in population structure in a high-dimensional space. HAPGEN2 has the highest PC alignment score, followed by HAPNEST (LD objective) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>).</p>
        <fig position="float" id="btad535-F3">
          <label>Figure 3.</label>
          <caption>
            <p>(a) PCA projection plot for <italic toggle="yes">N</italic><sub>syn</sub> = 10 002 synthetic samples generated by the HAPNEST method (multiobjective ABC), for chromosome 21 HapMap3 variants, <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>ref</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>4062</mml:mn></mml:mrow></mml:math></inline-formula>; (b) comparison of PCA projection plots and bivariate densities for <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>syn</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula> European-ancestry synthetic samples (<inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>ref</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>775</mml:mn></mml:mrow></mml:math></inline-formula>). The highest PC alignment score for preservation of population structure is 0.311 for HAPGEN2, 0.281 (HAPNEST LD objective), 0.222 (G2P), 0.182 (HAPNEST multiobjective), and 0.043 (Sim1000G).</p>
          </caption>
          <graphic xlink:href="btad535f3" position="float"/>
        </fig>
      </sec>
      <sec>
        <title>3.1.4 Adversarial accuracy</title>
        <p>We consider privacy-preserving metrics by calculating the nearest neighbour adversarial accuracy score, which averages the true positive rate and true negative rate for distinguishing real and synthetic data. Adversarial accuracy scores closest to 0.5 are observed for the G2P and HAPNEST (multiobjective) methods, indicating that these synthetic samples are more indistinguishable from the real data (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>).</p>
        <p>Overall, our analysis indicates that no one method performs best across all evaluation metrics, but instead there are tradeoffs that end users should consider, depending on the priorities of their use case. The correlation in the performance of metrics across methods is weak overall, but a lower LD decay distance is generally associated with a higher PC alignment, suggesting that methods with better preservation of LD structure also preserve the population structure of the reference data well (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). The nearest neighbour adversarial accuracy is closest to 0.5 for methods that generate high-fidelity data with lower relatedness to the reference data and between synthetic genotypes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S2 and S3</xref>). We provide further analyses of fidelity and generalizability metrics (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref> for European ancestry and <xref rid="sup1" ref-type="supplementary-material">Table S6</xref> for African ancestry) to demonstrate the properties of HAPNEST datasets for a variety of common use cases. In particular, these results show that for larger synthetic datasets (<italic toggle="yes">N</italic><sub>syn</sub> = 25 000, <italic toggle="yes">k</italic> &gt; 1 00 000), HAPNEST achieves comparable performance in the LD metric and better performance in some metrics such as PC alignment, compared with the smaller datasets. Similar results were observed for both the European and African ancestry experiments.</p>
      </sec>
    </sec>
    <sec>
      <title>3.2 Generalizability and diversity</title>
      <p>Diversity is measured by the degree of genetic relatedness (kinship) within the synthetic dataset and generalizability is measured by the degree of genetic relatedness between the real and synthetic datasets. HAPNEST (multiobjective) reached the best generalizability and diversity of all methods evaluated (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S2 and S3</xref>) when considering <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>syn</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula> synthetic samples. However, it is more appropriate to measure generalizability and diversity on larger and more realistic sample sizes. As there is a limited number of haplotypes in the reference dataset, one might expect that when generating thousands of synthetic samples, some generated genomes might eventually be copies of or highly related with genomes in the reference set. As shown in the next section, scalability is an issue for Sim1000G and G2P, so in this experiment we only consider HAPNEST and HAPGEN2. We quantify the two measurements as
for generalizability, where <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>cross</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the number of closely related pairs (i.e. twins or first-degree relatives, as determined by the kinship coefficient) between the reference and synthetic datasets; and
for diversity, where <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>pairs</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the number of closely related pairs in the synthetic dataset. <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref> shows the generalizability and diversity measurements for HAPNEST in comparison to HAPGEN2, under various sample sizes generated with two reference panels. We observe that HAPNEST also outperforms HAPGEN2 for both generalizability and diversity on larger sample samples.</p>
      <disp-formula id="E2">
        <mml:math id="M2" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mo stretchy="true">(</mml:mo>
            <mml:mn>1</mml:mn>
            <mml:mo>−</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext>cross</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mrow>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext>syn</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>*</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext>ref</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo stretchy="true">)</mml:mo>
            <mml:mo>×</mml:mo>
            <mml:mn>100</mml:mn>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <disp-formula id="E3">
        <mml:math id="M3" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mo stretchy="true">(</mml:mo>
            <mml:mn>1</mml:mn>
            <mml:mo>−</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext>pairs</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mrow>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext>syn</mml:mtext>
                      </mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:msubsup>
                  </mml:mrow>
                  <mml:mo>−</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext>syn</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo stretchy="true">)</mml:mo>
            <mml:mo>×</mml:mo>
            <mml:mn>100</mml:mn>
          </mml:mrow>
        </mml:math>
      </disp-formula>
    </sec>
  </sec>
  <sec>
    <title>4 Scalability analysis for large sample sizes</title>
    <p>The scalability of HAPNEST is validated by measuring the computational speed of generating genotype datasets for a varying number of synthetic samples, SNPs and computing threads. The experiments compare a smaller panel of 18 267 HapMap3 variants and a larger panel of 109 673 variants with non-zero MAF on chromosome 21. The analyses were conducted using a CentOS server with Intel Xeon E5 2680 v3 2.50 GHz processors and 32GB RAM for both single- and multithreaded setups, and use fixed input parameters, <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>2.185</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>500</mml:mn></mml:mrow></mml:math></inline-formula>, to ensure that equivalent setups are being compared for computational experiments. The Sim1000G and G2P methods were excluded from this comparison as they did not scale to the large sample sizes considered here under this setup.</p>
    <p>We observe that while generation times are similar for smaller datasets, HAPNEST is increasingly faster than HAPGEN2 for more variants and larger sample sizes (<xref rid="btad535-F4" ref-type="fig">Fig. 4</xref>) which approach the size of modern biobank-scale genetic datasets. For 100 000 synthetic samples, HAPNEST was between 2.4–8.2<italic toggle="yes">x</italic> times faster than HAPGEN2 (for between 18 267 and 109 673 SNPs) for a single thread and this increased to 5.3–24<italic toggle="yes">x</italic> times faster for multiple threads (tested for eight threads). This demonstrates that HAPNEST uses parallelization to achieve gains in computational efficiency for larger synthetic datasets. We note that HAPGEN2 does not have a command-line option for multiple threads and that similar results for both the single and multithreaded experiments (<xref rid="btad535-F4" ref-type="fig">Fig. 4</xref>) indicate that HAPGEN2 was not fully utilizing the available computing resources. The scalability of HAPNEST to generate large datasets under memory constraints can also be attributed to details of our implementation introduced to handle memory-intensive I/O operations, such as batching and memory-mapping. RAM usage statistics reported in <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S10 and S11</xref> demonstrate that HAPNEST utilizes less RAM than HAPGEN2 for larger synthetic sample sizes (3.8–7.9<italic toggle="yes">x</italic> times less RAM for 100 000 synthetic samples on a single thread) and uses multithreading to more efficiently utilize the available computing resources.</p>
    <fig position="float" id="btad535-F4">
      <label>Figure 4.</label>
      <caption>
        <p>Simulation times for genotype datasets for HAPNEST and HAPGEN2 (other methods are excluded from this comparison due to scalability and compatibility issues), averaged for five trials with 95% confidence intervals plotted, for a varying number of synthetic samples, SNPs and computing threads. Missing results are due to an experiment being terminated for exceeding the memory limit.</p>
      </caption>
      <graphic xlink:href="btad535f4" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>5 Overview of phenotype generation methods</title>
    <p>A continuous or binary phenotype can be assigned to each sample as an aggregation of genetic effect, user-input covariate effect (if any) and environmental noise. The genetic component is generated as a weighted sum of causal allele counts (<xref rid="btad535-F1" ref-type="fig">Fig. 1d</xref>). For each causal SNP <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, the effect size is drawn from a Gaussian distribution with 0 mean and variance determined by three well-studied factors impacting heritability of the variants, the MAF <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, local linkage structural <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and the functional annotation <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> of the SNP:
</p>
    <disp-formula id="E4">
      <mml:math id="M4" display="block" overflow="scroll">
        <mml:mrow>
          <mml:mrow>
            <mml:msub>
              <mml:mrow>
                <mml:mo>β</mml:mo>
              </mml:mrow>
              <mml:mi>i</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:mo>∼</mml:mo>
          <mml:mi>N</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mn>0</mml:mn>
          <mml:mo>,</mml:mo>
          <mml:mrow>
            <mml:msup>
              <mml:mrow>
                <mml:mrow>
                  <mml:mo stretchy="false">[</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>p</mml:mi>
                      </mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>−</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>p</mml:mi>
                      </mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo stretchy="false">]</mml:mo>
                </mml:mrow>
              </mml:mrow>
              <mml:mi>a</mml:mi>
            </mml:msup>
          </mml:mrow>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi>r</mml:mi>
              </mml:mrow>
              <mml:mi>i</mml:mi>
              <mml:mi>b</mml:mi>
            </mml:msubsup>
          </mml:mrow>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi>s</mml:mi>
              </mml:mrow>
              <mml:mi>i</mml:mi>
              <mml:mi>c</mml:mi>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>.</mml:mo>
        </mml:mrow>
      </mml:math>
    </disp-formula>
    <p>Power parameters <italic toggle="yes">a</italic>, <italic toggle="yes">b</italic>, and <italic toggle="yes">c</italic> reflect strength of negative selection on each aspect and we used extensive empirical observations (<xref rid="btad535-B8" ref-type="bibr">Finucane <italic toggle="yes">et al.</italic> 2015</xref>, <xref rid="btad535-B10" ref-type="bibr">Gazal <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btad535-B21" ref-type="bibr">Schoech <italic toggle="yes">et al.</italic> 2019</xref>) to chose the default parameters. HAPNEST allows SNP’s effect sizes to be drawn from a mixture of distributions with different width, corresponding to variable level of heritability. Our model also allows flexible assignment of individual components’ contribution to the phenotype (heritability), as well as the number of causal variants constituting the genetic risk (polygenicity). We run GWASs for 50 000 synthetic individuals and 1 049 096 HapMap 3 SNPs based on phenotypes generated under different genetic architectures. The Manhattan plots visually resemble Manhattan plots obtained on real data with similar heritability and polygenicity (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs. S8, S9, and S11</xref>). <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S11</xref> shows exemplary GWAS results for traits under two extreme scenarios: low heritability, low polygenicity, and high heritability, high polygenicity. The former resembles phenotypes such as atrial fibrillation and flutter (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8</xref>), and the latter resembles typically more heterogeneous traits, such as body pain (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S9</xref>). Our approach allows us to specify genetic correlations between phenotypes within and, importantly, between ancestry groups.</p>
  </sec>
  <sec>
    <title>6 Application: comparison of polygenic risk scoring methods</title>
    <p>We demonstrated the utility of HAPNEST by comparing seven PRS methods using synthetic data from five ancestry groups. We first generated a synthetic training dataset of 100 000 individuals of European ancestries, and performed a standard GWAS using software plink2 (<xref rid="btad535-B20" ref-type="bibr">Purcell <italic toggle="yes">et al.</italic> 2007</xref>), correcting for top 20 PCs. We subsequently used the summary statistics to build PRSs in a separate synthetic test set of 25 000 individuals (5000 samples from each ancestry group). To demonstrate variability across genetic architectures, GWAS summary statistics are computed for nine continuous phenotypic traits, with varying heritability (0.03, 0.1, and 0.5) and polygenicity (0.0001, 0.005, and 0.1). We assumed a genetic correlation of 1 across all ancestry groups.</p>
    <p>The evaluation of the PRS methods is based on the reference-standardized framework by <xref rid="btad535-B19" ref-type="bibr">Pain <italic toggle="yes">et al.</italic> (2021)</xref>, where for continuous traits, the PRS performance is measured in terms of Pearson correlation between the predicted and observed values. The optimal parameters for each PRS method are identified using cross validation (CV), or pseudovalidation (PseudoVal), if CV is not available.</p>
    <p>Better predictive performance is observed for higher heritability, lower polygenicity architectures (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S10</xref>). No single PRS method was observed to perform best across all genetic architectures. Methods with sparsity-inducing shrinkage priors (e.g. PRScs) were observed to perform better for higher heritability, lower polygenicity architectures, where genetic effects on most SNPs are zero (<xref rid="btad535-F5" ref-type="fig">Fig. 5c</xref>), while other approaches such as MegaPRS performed better for lower heritability, higher polygenicity architectures (<xref rid="btad535-F5" ref-type="fig">Fig. 5a</xref>). Multiancestry results replicate known issues with transferability of polygenic risk scores based on European-ancestry summary statistics (<xref rid="btad535-F5" ref-type="fig">Fig. 5b and d</xref>).</p>
    <fig position="float" id="btad535-F5">
      <label>Figure 5.</label>
      <caption>
        <p>PRS results for two genetic architectures, averaged across three experiment trials with error bars showing the range of outcomes, for HapMap3 variants across 22 chromosomes. (a) Pearson correlation between predicted and observed values, for various PRS methods and a European-ancestry phenotype with heritability 0.1 and polygenicity 0.005. (b) Pearson correlation for various target ancestry groups for the best-performing PRS method (MegaPRS) for the heritability 0.1 and polygenicity 0.005 phenotype. (c) Pearson correlation between predicted and observed values, for various PRS methods and a European-ancestry phenotype with heritability 0.5 and polygenicity 0.0001. (d) Pearson correlation for various target ancestry groups for the best-performing PRS method (PRScs) for the heritability 0.5 and polygenicity 0.0001 phenotype.</p>
      </caption>
      <graphic xlink:href="btad535f5" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>7 Discussion</title>
    <p>In this study, we proposed HAPNEST, a new algorithm to generate realistic individual-level genetic and phenotypic data and provide an efficient implementation. HAPNEST meets the demand for diverse, biobank-scale genomic data by improving scalability compared with existing methods. Users can customize population parameters or use parameter estimates derived from the reference dataset. Previous studies have been inconsistent in their approach to evaluating the quality of the generated synthetic data. We provide a comprehensive set of measures to be used for data quality evaluation that have been proposed in the statistical genetics and differential-privacy literature (<xref rid="btad535-B28" ref-type="bibr">Yale <italic toggle="yes">et al.</italic> 2019</xref>). Genotype generation, phenotype generation and evaluation modules are wrapped in user-friendly Docker or Singularity containers, where each module can be run independently.</p>
    <p>Synthetic genotypes are generated by copying and assembling haplotype segments from the reference genome, with distribution of segment length determined by specifics of the target population, including recombination rates, effective population size and samples in the reference panel. Parameters are optimized through the ABC algorithm, which typically results in an output dataset well-balanced across fidelity and generalizability metrics. On top of that, we introduced mutations to the synthetic genome to reduce similarity across individuals. Like HAPGEN2, HAPNEST is also based on the Li and Stephens model of LD (<xref rid="btad535-B15" ref-type="bibr">Li and Stephens 2003</xref>), but to improve computational scalability and generalizability we have introduced modelling of varying, rather than constant, coalescence time, and the use of mutation ages to determine if mutations are present in synthetic samples.</p>
    <p>From our systematic evaluation and experiments, we noticed some general trade-offs in synthetic data quality and in the parameter selection. One trade-off occurs between the preservation of population LD structure and synthetic sample relatedness when constructing large synthetic datasets from much smaller reference datasets. Our observations indicated that parameters optimizing the preservation of LD usually result in higher levels of sample relatedness, as LD typically comes with larger average segment length copied from the reference. On the other hand, shortened segments allow more combinations and higher sample level variability, which results in samples that are less related to each other but increased fragmentation in the LD structure. Furthermore, smaller segments lead to more computational input/output operations when constructing synthetic data files and a slight increase in running time. Segments copied from the reference genome in our algorithm can be conceptually viewed as identity-by-descent (IBD) segments in population genetics (<xref rid="btad535-B30" ref-type="bibr">Zhou <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad535-B4" ref-type="bibr">Browning and Browning 2020</xref>). As shown in <xref rid="E1" ref-type="disp-formula">Equation (1)</xref>, recombination events (<inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>) happen over time (<italic toggle="yes">T</italic>) in the population. Thus, IBD segments degrade over time, which also shows an impact on LD (<xref rid="btad535-B26" ref-type="bibr">Thompson 2013</xref>, <xref rid="btad535-B22" ref-type="bibr">Sticca <italic toggle="yes">et al.</italic> 2021</xref>). Our algorithm also provides an implementation of generating “admixed” samples by sampling from multiple reference populations under user defined compositions. However, we would like to note that this approach does not accurately reflect the process of multipopulation diverging and intermixing, therefore it should be used and interpreted carefully.</p>
    <p>Compared with other methods, HAPNEST-generated genotypes demonstrated better diversity and generalizability, which are essential features when scaling to large sample sizes. While the genetic relatedness analysis indicated that the genotypes are sufficiently different from the reference data, a nearest-neighbour adversarial accuracy close to 0.5 indicates that statistically speaking, it would be difficult to discern a synthetic genotype from a real genotype. These properties of synthetic datasets are desirable in the context of data privacy, where we may want to create a synthetic twin of sensitive data that preserves key statistical properties of the real data, but cannot be traced back to real individuals. However, we note that we have not tested the HAPNEST method for differential privacy guarantees and for this reason, we advise to use HAPNEST, or any of the reference-based generation methods, only on publicly available genomics datasets.</p>
    <p>Once individual level genotypes have been generated, we can subsequently assign phenotypes to each sample as an aggregation of polygenic effects, non-genetic effects and environmental noise. We also implemented population-specific phenotypic effects by assuming shared causal variants across populations with distinct but correlated effect sizes, and multitrait simulation allowing for different genetic correlation and pleiotropy models.</p>
    <p>We believe our tool can benefit the community especially for GWAS-related method development, for which one of the examples can be PRS computation and evaluation. HAPNEST allows researchers to assess the validity of genetic scoring methods under a broad variety of setups, including cross-ancestry, trans-diagnostic, and different genetic architectures. Here, as a demonstration of its utility, we applied PRSpipe [PRSpipe is a Snakemake pipeline developed to calculate and evaluate polygenic risk scores from GWAS summary statistics. It implements and extends the GenoPred (<xref rid="btad535-B19" ref-type="bibr">Pain <italic toggle="yes">et al.</italic> 2021</xref>) pipeline, a reference standardised framework for the prediction of PRS using various state-of-the-art methods] to synthetic data generated by HAPNEST and found that our results, to a great degree, replicated what has been observed by <xref rid="btad535-B19" ref-type="bibr">Pain <italic toggle="yes">et al.</italic> (2021)</xref>. As widely discussed, we found lower cross-ancestry portability of PRSs derived in a single ancestry. For a given phenotype, we set genetic correlations between ancestry groups to 1 and this might be higher than what is observed in real settings and result in slightly inflated trans-ethnic PRS prediction performance. Nevertheless, we still observed reduced prediction accuracy in non-European samples, indicating the synthetic genotype captured the differences of MAF and LD structures across populations. Results under different genetic architectures are concordant with the general expectation: we observe better performance of PRS for phenotypes with higher heritability and lower polygenicity due to the existence of few variants with larger effect that explain large amounts of phenotypic variance. We also noticed that the best performing method can depend on different genetic architecture, reflecting the need for careful considerations when choosing a PRS method. As more studies come online that examine the clinical utility of PRSs, it will be important to have a reference dataset where old and new PRS methods can be compared and their robustness can be assessed as a function of the genetic and phenotypic architecture. We used HAPNEST to create one of the largest genomics synthetic datasets today including 1 million individuals across six major continental ancestry groups, 6.8 million variants, and nine phenotypes. We hope this dataset can generate a reference set for deriving and testing PRS methods within a unified framework.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad535_Supplementary_Data</label>
      <media xlink:href="btad535_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors wish to acknowledge CSC—IT Center for Science, Finland, for computational resources.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the European Union’s Horizon 2020 research and innovation programme [grant agreement number 101016775].</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>A synthetic dataset of 1 008 000 individuals and nine traits for 6.8 million common variants is available at <ext-link xlink:href="https://www.ebi.ac.uk/biostudies/studies/S-BSST936" ext-link-type="uri">https://www.ebi.ac.uk/biostudies/studies/S-BSST936</ext-link>. The HAPNEST software for generating synthetic datasets is available as Docker/Singularity containers and open source Julia and C code at <ext-link xlink:href="https://github.com/intervene-EU-H2020/synthetic_data" ext-link-type="uri">https://github.com/intervene-EU-H2020/synthetic_data</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad535-B1">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Alaa</surname><given-names>AM</given-names></string-name>, <string-name><surname>van Breugel</surname><given-names>B</given-names></string-name>, <string-name><surname>Saveliev</surname><given-names>E</given-names></string-name></person-group><etal>et al</etal> How faithful is your synthetic data? Sample-level metrics for evaluating and auditing generative models, In: <italic toggle="yes">International Conference on Machine Learning</italic>, PMLR <year>2022</year>.</mixed-citation>
    </ref>
    <ref id="btad535-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Albers</surname><given-names>PK</given-names></string-name>, <string-name><surname>McVean</surname><given-names>G.</given-names></string-name></person-group><article-title>Dating genomic variants and shared ancestry in population-scale sequencing data</article-title>. <source>PLoS Biol</source><year>2020</year>;<volume>18</volume>:<fpage>e3000586</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pbio.3000586</pub-id><pub-id pub-id-type="pmid">31951611</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Araújo</surname><given-names>DS</given-names></string-name>, <string-name><surname>Wheeler</surname><given-names>HE.</given-names></string-name></person-group><article-title>Genetic and environmental variation impact transferability of polygenic risk scores</article-title>. <source>Cell Rep Med</source><year>2022</year>;<volume>3</volume>:<fpage>100687</fpage>.<pub-id pub-id-type="pmid">35858592</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Browning</surname><given-names>SR</given-names></string-name>, <string-name><surname>Browning</surname><given-names>BL.</given-names></string-name></person-group><article-title>Probabilistic estimation of identity by descent segment endpoints and detection of recent selection</article-title>. <source>Am J Hum Genet</source><year>2020</year>;<volume>107</volume>:<fpage>895</fpage>–<lpage>910</lpage>.<pub-id pub-id-type="pmid">33053335</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Choi</surname><given-names>SW</given-names></string-name>, <string-name><surname>Mak</surname><given-names>TS-H</given-names></string-name>, <string-name><surname>O'Reilly</surname><given-names>PF.</given-names></string-name></person-group><article-title>Tutorial: a guide to performing polygenic risk score analyses</article-title>. <source>Nat Protoc</source><year>2020</year>;<volume>15</volume>:<fpage>2759</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">32709988</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B6">
      <mixed-citation publication-type="journal"><collab>International HapMap 3 Consortium</collab>. <article-title>Integrating common and rare genetic variation in diverse human populations</article-title>. <source>Nature</source><year>2010</year>;<volume>467</volume>:<fpage>52</fpage>.<pub-id pub-id-type="pmid">20811451</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dimitromanolakis</surname><given-names>A</given-names></string-name>, <string-name><surname>Xu</surname><given-names>J</given-names></string-name>, <string-name><surname>Krol</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Sim1000G: a user-friendly genetic variant simulator in r for unrelated individuals and family-based designs</article-title>. <source>BMC Bioinform</source><year>2019</year>;<volume>20</volume>:<fpage>26</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="btad535-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Finucane</surname><given-names>HK</given-names></string-name>, <string-name><surname>Bulik-Sullivan</surname><given-names>B</given-names></string-name>, <string-name><surname>Gusev</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal>; <collab>RACI Consortium</collab>. <article-title>Partitioning heritability by functional annotation using genome-wide association summary statistics</article-title>. <source>Nat Genet</source><year>2015</year>;<volume>47</volume>:<fpage>1228</fpage>–<lpage>35</lpage>.<pub-id pub-id-type="pmid">26414678</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fortune</surname><given-names>MD</given-names></string-name>, <string-name><surname>Wallace</surname><given-names>C.</given-names></string-name></person-group><article-title>simGWAS: a fast method for simulation of large scale case–control GWAS summary statistics</article-title>. <source>Bioinformatics</source><year>2019</year>;<volume>35</volume>:<fpage>1901</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">30371734</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gazal</surname><given-names>S</given-names></string-name>, <string-name><surname>Finucane</surname><given-names>HK</given-names></string-name>, <string-name><surname>Furlotte</surname><given-names>NA</given-names></string-name></person-group><etal>et al</etal><article-title>Linkage disequilibrium–dependent architecture of human complex traits shows action of negative selection</article-title>. <source>Nat Genet</source><year>2017</year>;<volume>49</volume>:<fpage>1421</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">28892061</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hudson</surname><given-names>RR.</given-names></string-name></person-group><article-title>Generating samples under a wright–fisher neutral model of genetic variation</article-title>. <source>Bioinformatics</source><year>2002</year>;<volume>18</volume>:<fpage>337</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">11847089</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Karczewski</surname><given-names>KJ</given-names></string-name>, <string-name><surname>Francioli</surname><given-names>LC</given-names></string-name>, <string-name><surname>Tiao</surname><given-names>G</given-names></string-name></person-group>, <etal>et al</etal>; <collab>Genome Aggregation Database Consortium</collab>. <article-title>The mutational constraint spectrum quantified from variation in 141,456 humans</article-title>. <source>Nature</source><year>2020</year>;<volume>581</volume>:<fpage>434</fpage>–<lpage>43</lpage>.<pub-id pub-id-type="pmid">32461654</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kelleher</surname><given-names>J</given-names></string-name>, <string-name><surname>Etheridge</surname><given-names>AM</given-names></string-name>, <string-name><surname>McVean</surname><given-names>G.</given-names></string-name></person-group><article-title>Efficient coalescent simulation and genealogical analysis for large sample sizes</article-title>. <source>PLoS Comput Biol</source><year>2016</year>;<volume>12</volume>:<fpage>e1004842</fpage>.<pub-id pub-id-type="pmid">27145223</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Laido</surname><given-names>G</given-names></string-name>, <string-name><surname>Marone</surname><given-names>D</given-names></string-name>, <string-name><surname>Russo</surname><given-names>MA</given-names></string-name></person-group><etal>et al</etal><article-title>Linkage disequilibrium and genome-wide association mapping in tetraploid wheat (<italic toggle="yes">Triticum turgidum</italic> L.)</article-title>. <source>PLoS One</source><year>2014</year>;<volume>9</volume>:<fpage>e95211</fpage>.<pub-id pub-id-type="pmid">24759998</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>N</given-names></string-name>, <string-name><surname>Stephens</surname><given-names>M.</given-names></string-name></person-group><article-title>Modeling linkage disequilibrium and identifying recombination hotspots using single-nucleotide polymorphism data</article-title>. <source>Genetics</source><year>2003</year>;<volume>165</volume>:<fpage>2213</fpage>–<lpage>33</lpage>.<pub-id pub-id-type="pmid">14704198</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McVean</surname><given-names>GA</given-names></string-name>, <string-name><surname>Cardin</surname><given-names>NJ.</given-names></string-name></person-group><article-title>Approximating the coalescent with recombination</article-title>. <source>Philos Trans R Soc Lond B Biol Sci</source><year>2005</year>;<volume>360</volume>:<fpage>1387</fpage>–<lpage>93</lpage>.<pub-id pub-id-type="pmid">16048782</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mills</surname><given-names>MC</given-names></string-name>, <string-name><surname>Rahal</surname><given-names>C.</given-names></string-name></person-group><article-title>The GWAS diversity monitor tracks diversity by disease in real time</article-title>. <source>Nat Genet</source><year>2020</year>;<volume>52</volume>:<fpage>242</fpage>–<lpage>3</lpage>.<pub-id pub-id-type="pmid">32139905</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B18">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Naeem</surname><given-names>MF</given-names></string-name>, <string-name><surname>Oh</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Uh</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal> Reliable fidelity and diversity metrics for generative models. In: <person-group person-group-type="editor"><string-name><surname>Daumé</surname><given-names>H</given-names><suffix>III</suffix></string-name>, <string-name><surname>Singh</surname><given-names>A</given-names></string-name></person-group> (eds), <italic toggle="yes">Proceedings of the 37th International Conference on Machine Learning</italic>, volume 119 of <italic toggle="yes">Proceedings of Machine Learning Research</italic>, <fpage>7176</fpage>–<lpage>85</lpage>. PMLR, 13–18 July <year>2020</year>.</mixed-citation>
    </ref>
    <ref id="btad535-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pain</surname><given-names>O</given-names></string-name>, <string-name><surname>Glanville</surname><given-names>KP</given-names></string-name>, <string-name><surname>Hagenaars</surname><given-names>SP</given-names></string-name></person-group><etal>et al</etal><article-title>Evaluation of polygenic prediction methodology within a reference-standardized framework</article-title>. <source>PLoS Genet</source><year>2021</year>;<volume>17</volume>:<fpage>e1009021</fpage>.<pub-id pub-id-type="pmid">33945532</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Purcell</surname><given-names>S</given-names></string-name>, <string-name><surname>Neale</surname><given-names>B</given-names></string-name>, <string-name><surname>Todd-Brown</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>Plink: a tool set for whole-genome association and population-based linkage analyses</article-title>. <source>Am J Hum Genet</source><year>2007</year>;<volume>81</volume>:<fpage>559</fpage>–<lpage>75</lpage>.<pub-id pub-id-type="pmid">17701901</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schoech</surname><given-names>AP</given-names></string-name>, <string-name><surname>Jordan</surname><given-names>DM</given-names></string-name>, <string-name><surname>Loh</surname><given-names>P-R</given-names></string-name></person-group><etal>et al</etal><article-title>Quantification of frequency-dependent genetic architectures in 25 UK biobank traits reveals action of negative selection</article-title>. <source>Nat Commun</source><year>2019</year>;<volume>10</volume>:<fpage>790</fpage>.<pub-id pub-id-type="pmid">30770844</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sticca</surname><given-names>EL</given-names></string-name>, <string-name><surname>Belbin</surname><given-names>GM</given-names></string-name>, <string-name><surname>Gignoux</surname><given-names>CR.</given-names></string-name></person-group><article-title>Current developments in detection of identity-by-descent methods and applications</article-title>. <source>Front Genet</source><year>2021</year>;<volume>12</volume>:<fpage>722602</fpage>.<pub-id pub-id-type="pmid">34567074</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Su</surname><given-names>Z</given-names></string-name>, <string-name><surname>Marchini</surname><given-names>J</given-names></string-name>, <string-name><surname>Donnelly</surname><given-names>P.</given-names></string-name></person-group><article-title>HAPGEN2: simulation of multiple disease SNPs</article-title>. <source>Bioinformatics</source><year>2011</year>;<volume>27</volume>:<fpage>2304</fpage>–<lpage>5</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btr341</pub-id><pub-id pub-id-type="pmid">21653516</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Liu</surname><given-names>X.</given-names></string-name></person-group><article-title>G2P: a genome-wide-association-study simulation tool for genotype simulation, phenotype simulation and power evaluation</article-title>. <source>Bioinformatics</source><year>2019</year>;<volume>35</volume>:<fpage>3852</fpage>–<lpage>4</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btz126</pub-id><pub-id pub-id-type="pmid">30848784</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tankhilevich</surname><given-names>E</given-names></string-name>, <string-name><surname>Ish-Horowicz</surname><given-names>J</given-names></string-name>, <string-name><surname>Hameed</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>GpABC: a Julia package for approximate Bayesian computation with Gaussian process emulation</article-title>. <source>Bioinformatics</source><year>2020</year>;<volume>36</volume>:<fpage>3286</fpage>–<lpage>7</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa078</pub-id><pub-id pub-id-type="pmid">32022854</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Thompson</surname><given-names>EA.</given-names></string-name></person-group><article-title>Identity by descent: variation in meiosis, across genomes, and in populations</article-title>. <source>Genetics</source><year>2013</year>;<volume>194</volume>:<fpage>301</fpage>–<lpage>26</lpage>.<pub-id pub-id-type="pmid">23733848</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B27">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Namba</surname><given-names>S</given-names></string-name>, <string-name><surname>Lopera-Maya</surname><given-names>EA</given-names></string-name></person-group><etal>et al</etal> Global biobank analyses provide lessons for computing polygenic risk scores across diverse cohorts. <italic toggle="yes">Cell Genomics</italic> 2023;3.</mixed-citation>
    </ref>
    <ref id="btad535-B28">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Yale</surname><given-names>A</given-names></string-name>, <string-name><surname>Dash</surname><given-names>S</given-names></string-name>, <string-name><surname>Dutta</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal> Privacy preserving synthetic health data. In: <italic toggle="yes">ESANN 2019-European Symposium on Artificial Neural Networks, Computational Intelligence and Machine Learning</italic>, <year>2019</year>.</mixed-citation>
    </ref>
    <ref id="btad535-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>J</given-names></string-name>, <string-name><surname>Benyamin</surname><given-names>B</given-names></string-name>, <string-name><surname>McEvoy</surname><given-names>BP</given-names></string-name></person-group><etal>et al</etal><article-title>Common SNPs explain a large proportion of the heritability for human height</article-title>. <source>Nat Genet</source><year>2010</year>;<volume>42</volume>:<fpage>565</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">20562875</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhou</surname><given-names>Y</given-names></string-name>, <string-name><surname>Browning</surname><given-names>SR</given-names></string-name>, <string-name><surname>Browning</surname><given-names>BL.</given-names></string-name></person-group><article-title>A fast and simple method for detecting identity-by-descent segments in large-scale data</article-title>. <source>Am J Hum Genet</source><year>2020</year>;<volume>106</volume>:<fpage>426</fpage>–<lpage>37</lpage>.<pub-id pub-id-type="pmid">32169169</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10493177</article-id>
    <article-id pub-id-type="pmid">37647640</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad535</article-id>
    <article-id pub-id-type="publisher-id">btad535</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genetics and Population Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>HAPNEST: efficient, large-scale generation and evaluation of synthetic datasets for genotypes and phenotypes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-2593-8081</contrib-id>
        <name>
          <surname>Wharrie</surname>
          <given-names>Sophie</given-names>
        </name>
        <aff><institution>Department of Computer Science, Aalto University</institution>, Espoo 02150, <country country="FI">Finland</country></aff>
        <xref rid="btad535-cor1" ref-type="corresp"/>
        <!--sophie.wharrie@aalto.fi-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>Zhiyu</given-names>
        </name>
        <aff><institution>Institute for Molecular Medicine Finland, FIMM, HiLIFE, University of Helsinki</institution>, Helsinki 00014, <country country="FI">Finland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Raj</surname>
          <given-names>Vishnu</given-names>
        </name>
        <aff><institution>Department of Computer Science, Aalto University</institution>, Espoo 02150, <country country="FI">Finland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Monti</surname>
          <given-names>Remo</given-names>
        </name>
        <aff><institution>Hasso Plattner Institute, University of Potsdam, Digital Engineering Faculty</institution>, Potsdam 14469, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gupta</surname>
          <given-names>Rahul</given-names>
        </name>
        <aff><institution>Broad Institute of MIT and Harvard</institution>, Cambridge, Massachusetts 02142, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Ying</given-names>
        </name>
        <aff><institution>Broad Institute of MIT and Harvard</institution>, Cambridge, Massachusetts 02142, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0241-3522</contrib-id>
        <name>
          <surname>Martin</surname>
          <given-names>Alicia</given-names>
        </name>
        <aff><institution>Broad Institute of MIT and Harvard</institution>, Cambridge, Massachusetts 02142, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>O’Connor</surname>
          <given-names>Luke J</given-names>
        </name>
        <aff><institution>Broad Institute of MIT and Harvard</institution>, Cambridge, Massachusetts 02142, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kaski</surname>
          <given-names>Samuel</given-names>
        </name>
        <aff><institution>Department of Computer Science, Aalto University</institution>, Espoo 02150, <country country="FI">Finland</country></aff>
        <aff><institution>Department of Computer Science, University of Manchester</institution>, Manchester M13 9PL, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Marttinen</surname>
          <given-names>Pekka</given-names>
        </name>
        <aff><institution>Department of Computer Science, Aalto University</institution>, Espoo 02150, <country country="FI">Finland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7999-1972</contrib-id>
        <name>
          <surname>Palamara</surname>
          <given-names>Pier Francesco</given-names>
        </name>
        <aff><institution>Department of Statistics, University of Oxford</institution>, Oxford OX1 2JD, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6363-2556</contrib-id>
        <name>
          <surname>Lippert</surname>
          <given-names>Christoph</given-names>
        </name>
        <aff><institution>Hasso Plattner Institute, University of Potsdam, Digital Engineering Faculty</institution>, Potsdam 14469, <country country="DE">Germany</country></aff>
        <aff><institution>Hasso Plattner Institute for Digital Health at Mount Sinai, Icahn School of Medicine at Mount Sinai</institution>, New York, New York 10065, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ganna</surname>
          <given-names>Andrea</given-names>
        </name>
        <aff><institution>Institute for Molecular Medicine Finland, FIMM, HiLIFE, University of Helsinki</institution>, Helsinki 00014, <country country="FI">Finland</country></aff>
        <aff><institution>Broad Institute of MIT and Harvard</institution>, Cambridge, Massachusetts 02142, <country country="US">United States</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schwartz</surname>
          <given-names>Russell</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad535-cor1">Corresponding author. Department of Computer Science, Aalto University, Konemiehentie 2, Espoo 02150, Finland. E-mail: <email>sophie.wharrie@aalto.fi</email> (S.W.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-08-30">
      <day>30</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>9</issue>
    <elocation-id>btad535</elocation-id>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>23</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>24</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>10</day>
        <month>9</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad535.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Existing methods for simulating synthetic genotype and phenotype datasets have limited scalability, constraining their usability for large-scale analyses. Moreover, a systematic approach for evaluating synthetic data quality and a benchmark synthetic dataset for developing and evaluating methods for polygenic risk scores are lacking.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present HAPNEST, a novel approach for efficiently generating diverse individual-level genotypic and phenotypic data. In comparison to alternative methods, HAPNEST shows faster computational speed and a lower degree of relatedness with reference panels, while generating datasets that preserve key statistical properties of real data. These desirable synthetic data properties enabled us to generate 6.8 million common variants and nine phenotypes with varying degrees of heritability and polygenicity across 1 million individuals. We demonstrate how HAPNEST can facilitate biobank-scale analyses through the comparison of seven methods to generate polygenic risk scoring across multiple ancestry groups and different genetic architectures.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>A synthetic dataset of 1 008 000 individuals and nine traits for 6.8 million common variants is available at <ext-link xlink:href="https://www.ebi.ac.uk/biostudies/studies/S-BSST936" ext-link-type="uri">https://www.ebi.ac.uk/biostudies/studies/S-BSST936</ext-link>. The HAPNEST software for generating synthetic datasets is available as Docker/Singularity containers and open source Julia and C code at <ext-link xlink:href="https://github.com/intervene-EU-H2020/synthetic_data" ext-link-type="uri">https://github.com/intervene-EU-H2020/synthetic_data</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Union’s Horizon 2020 research and innovation programme</institution>
          </institution-wrap>
        </funding-source>
        <award-id>101016775</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>With the emergence of large-scale biobanks, methods to analyse common genetic variants [single-nucleotide polymorphisms (SNPs)] across diverse human populations are in growing demand. This is especially the case for polygenic risk scoring (PRS) methods, which quantify an individual’s genetic risk for a disease or other phenotypic trait (<xref rid="btad535-B5" ref-type="bibr">Choi <italic toggle="yes">et al.</italic> 2020</xref>). Derived from one’s genotype, well-calibrated PRSs have the potential to be used for risk stratification and prognostic prediction (<xref rid="btad535-B5" ref-type="bibr">Choi <italic toggle="yes">et al.</italic> 2020</xref>). The utility of PRS has been demonstrated for certain common diseases among European ancestries, on which most genome-wide association studies (GWAS) were carried out (<xref rid="btad535-B17" ref-type="bibr">Mills and Rahal 2020</xref>), but some studies have highlighted limitations in transferability of PRS across ancestries and different socio-demographic groups (<xref rid="btad535-B3" ref-type="bibr">Araújo and Wheeler 2022</xref>). Thus, the development of methods that can improve the generalizability of PRSs is needed. At the same time, only a few accessible large-scale biobank datasets exist and most previous PRS methods have been tested and compared in UK Biobank (<xref rid="btad535-B19" ref-type="bibr">Pain <italic toggle="yes">et al.</italic> 2021</xref>). More diverse biobank datasets are needed, but due to the highly sensitive nature of genetics data, accessing and sharing individual-level data raises privacy concerns. This makes publicly accessible synthetic data a welcome alternative for methods developers.</p>
    <p>Broadly, two main approaches have been used to simulate individual level genetic data. Coalescence-based methods, such as Hudson’s ms and msprime (<xref rid="btad535-B11" ref-type="bibr">Hudson 2002</xref>, <xref rid="btad535-B13" ref-type="bibr">Kelleher <italic toggle="yes">et al.</italic> 2016</xref>), use demographic models to generate genomes including both rare and common variants. Reference-based approaches use real genomic data (e.g. 1000 genomes or HGDP) to generate synthetic data, but they are not suitable to generate realistic rare variants. There are also methods, such as simGWAS (<xref rid="btad535-B9" ref-type="bibr">Fortune and Wallace 2019</xref>), that directly simulate GWAS summary statistics. However, many times they do not meet modern demands for methods development based on individual level data. We will focus on reference-based approaches since for PRSs we are mostly interested in common genetic variation, which forms the bulk of complex trait heritability (<xref rid="btad535-B29" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> 2010</xref>). Moreover, common SNPs, especially Hapmap3 SNPs (<xref rid="btad535-B6" ref-type="bibr">International HapMap 3 Consortium 2010)</xref>, are widely recommended for PRS computation (<xref rid="btad535-B27" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2023</xref>). HAPGEN2 (<xref rid="btad535-B23" ref-type="bibr">Su <italic toggle="yes">et al.</italic> 2011</xref>) is a widely used tool for genotype and phenotype simulation, which preserves linkage disequilibrium (LD) patterns of real data through a resampling approach based on the Li and Stephens model (<xref rid="btad535-B15" ref-type="bibr">Li and Stephens 2003</xref>). However, HAPGEN2 lacks computational scalability and flexibility in phenotype generation to simulate certain scenarios of interest for biobank-scale PRS and SNP-based methods development, where the genetic architecture of the phenotype is an essential factor. Recent alternatives include G2P (<xref rid="btad535-B24" ref-type="bibr">Tang and Liu 2019</xref>) and Sim1000G (<xref rid="btad535-B7" ref-type="bibr">Dimitromanolakis <italic toggle="yes">et al.</italic> 2019</xref>). Sim1000G is an integrated R package, but is limited to genotype simulation. G2P encompasses both genotype and phenotype simulation, and is highly customizable, but this setup can be challenging for non-expert users. In <xref rid="btad535-T1" ref-type="table">Table 1</xref>, we provide an overview of the characteristics of these different approaches. Without an integrated approach for parameter selection and evaluation of synthetic data quality, it is difficult for end-users to understand the statistical guarantees and reliability of the generated datasets. To the best of our knowledge, there does not exist a software tool implementing an end-to-end pipeline for synthetic data generation, evaluation and optimization.</p>
    <table-wrap position="float" id="btad535-T1">
      <label>Table 1.</label>
      <caption>
        <p>Summary of main differences between HAPNEST and alternative synthetic data generation tools.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1"/>
            <th colspan="2" align="center" rowspan="1">Runtime for 100k synthetic samples<hr/></th>
          </tr>
          <tr>
            <th rowspan="1" colspan="1">Method</th>
            <th align="left" rowspan="1" colspan="1">Genotype simulation</th>
            <th align="left" rowspan="1" colspan="1">Phenotype simulation</th>
            <th align="left" rowspan="1" colspan="1">Parameter optimization</th>
            <th align="left" rowspan="1" colspan="1">Evaluation pipeline</th>
            <th align="left" rowspan="1" colspan="1">Open source</th>
            <th align="left" rowspan="1" colspan="1">Software platform</th>
            <th align="left" rowspan="1" colspan="1">∼20k SNPs</th>
            <th align="left" rowspan="1" colspan="1">∼100k SNPs</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">HAPNEST</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Automated</td>
            <td rowspan="1" colspan="1">Fidelity (MAF, LD, population structure, nearest-neighbour adversarial accuracy, GWAS results) and generalizability (kinship relatedness)</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Containerized command line tool</td>
            <td rowspan="1" colspan="1">15.0 min for one thread, 6.3 min for eight threads</td>
            <td rowspan="1" colspan="1">41.6 min for one thread, 11.7 min for eight threads</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">HAPGEN2</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Manual</td>
            <td rowspan="1" colspan="1">None</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Command line tool</td>
            <td rowspan="1" colspan="1">36.3 min for one thread, 33.4 min for eight threads</td>
            <td rowspan="1" colspan="1">339.2 min for one thread, 280.9 min for eight threads</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">G2P</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Manual</td>
            <td rowspan="1" colspan="1">GWAS results</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Java-based GUI</td>
            <td rowspan="1" colspan="1">Excluded from comparison</td>
            <td rowspan="1" colspan="1">Excluded from comparison</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Sim1000G</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Manual</td>
            <td rowspan="1" colspan="1">None</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">R package</td>
            <td rowspan="1" colspan="1">Excluded from comparison</td>
            <td rowspan="1" colspan="1">Excluded from comparison</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <p>To address these limitations, we introduce HAPNEST, a user-friendly tool for generating synthetic datasets for genotypes and phenotypes, evaluating synthetic data quality, and analysing the behaviour of model parameters with respect to the evaluation metrics. HAPNEST simulates genotypes by resampling a set of existing reference genomes, according to a stochastic model that approximates the underlying processes of coalescent, recombination and mutation. Like HAPGEN2, HAPNEST is also based on the Li and Stephens model of LD (<xref rid="btad535-B15" ref-type="bibr">Li and Stephens 2003</xref>), but HAPNEST additionally models the coalescence age of segments using an approximate model inspired by the sequential Markovian coalescent model (<xref rid="btad535-B16" ref-type="bibr">McVean and Cardin 2005</xref>). Phenotypes are subsequently assigned to each sample by integrating user-specified genetic, covariate, and environmental effects. Genetic effects are modelled in terms of heritability and polygenicity. HAPNEST enables efficient simulation of diverse biobank-scale datasets, as well as simultaneously generating multiple genetically correlated traits with population specific effects under different pleiotropy models. Moreover, the HAPNEST software includes an extensive workflow for evaluating synthetic data fidelity and generalizability, as well as approximate Bayesian computation (ABC) techniques for analysing the posterior distributions of model parameters to aid model selection.</p>
    <p>We compare the performance of HAPNEST with current state-of-the-art genotype and phenotype simulation tools in terms of data quality and computational speed. Furthermore, as a demonstration of the utility of our tool, we show the application of our diverse, biobank-scale synthetic data for evaluating the performance of various PRS methods under different disease models. Our open-source software tool is available at <ext-link xlink:href="https://github.com/intervene-EU-H2020/synthetic_data" ext-link-type="uri">https://github.com/intervene-EU-H2020/synthetic_data</ext-link>, and has also been distributed as Docker and Singularity containers. We have generated 6.8 million common variants and nine phenotypes with varying degrees of heritability and polygenicity across 1 million individuals and made this large synthetic dataset available at <ext-link xlink:href="https://www.ebi.ac.uk/biostudies/studies/S-BSST936" ext-link-type="uri">https://www.ebi.ac.uk/biostudies/studies/S-BSST936</ext-link> to encourage standardized evaluation of new statistical methods by the genomic research community.</p>
  </sec>
  <sec>
    <title>2 Overview of genotype generation methods</title>
    <p>HAPNEST simulates pairs of synthetic haplotypes, where each haplotype is constructed as a mosaic of segments of various lengths imperfectly copied from a reference set of real haplotypes (<xref rid="btad535-F1" ref-type="fig">Fig. 1a</xref>). This resampling approach, based on the Li and Stephens model (<xref rid="btad535-B15" ref-type="bibr">Li and Stephens 2003</xref>), is also used by other tools such as HAPGEN2, but HAPNEST differs in that it models a varying coalescent age of segments, <italic toggle="yes">T</italic>, when determining genetic distances, <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mi>ℓ</mml:mi></mml:math></inline-formula>, between cross-over events, and uses this to introduce age-based mutations. This is inspired by the sequential Markovian coalescent model (<xref rid="btad535-B16" ref-type="bibr">McVean and Cardin 2005</xref>) and motivated by the need to (i) preserve key statistical properties of real genotypes (fidelity) and (ii) limit overfitting to the reference data (generalizability) by introducing variability according to the coalescence process. Previous works have focused on generating high-fidelity data with respect to properties such as LD structure, but the generalizability property is also important when generating a large number of synthetic samples and genetic variants from few reference samples.</p>
    <fig position="float" id="btad535-F1">
      <label>Figure 1.</label>
      <caption>
        <p>(a) A reference set of real haplotypes, from which segments (coloured) are imperfectly copied to construct a synthetic haplotype. (b) Detailed view of an individual segment. The segment length, <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mi>ℓ</mml:mi></mml:math></inline-formula>, and coalescence time, <italic toggle="yes">T</italic>, are sampled from a stochastic model. The presence of a genetic variant at position <italic toggle="yes">i</italic> is only copied if <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mi>T</mml:mi><mml:mo>≤</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the variant’s age of mutation. Variants that are not copied are shown in red. (c) Synthetic genotypes, <italic toggle="yes">g</italic>, are constructed as pairs of synthetic haplotypes, <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. (d) Once the genotype is generated, liability of phenotype will subsequently be assigned to each sample as a summation of genetic effect, covariate effect (if any) and environmental noise.</p>
      </caption>
      <graphic xlink:href="btad535f1" position="float"/>
    </fig>
    <p>Specifically, the real haplotypes to copy from are sampled uniformly from a reference dataset, <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, of <italic toggle="yes">k</italic> SNPs for <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> samples, limited to individuals belonging to a certain ancestry group <italic toggle="yes">s</italic> (<inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo></mml:mrow></mml:math></inline-formula>AFR, AMR, EAS, EUR, CSA, MID<inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mo>}</mml:mo></mml:math></inline-formula>, where AFR = African, AMR = Admixed American, EAS = East Asian, EUR = European, CSA = Central/South Asian, MID = Middle Eastern). Alternatively, users can specify the proportion of real haplotypes to sample from each ancestry group. We refer to the Discussion section of the paper regarding the complications in interpreting admixed samples. Segments of length <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mi>ℓ</mml:mi></mml:math></inline-formula> (in centimorgans) are sampled from the real haplotypes (<xref rid="btad535-F1" ref-type="fig">Fig. 1b</xref>) based on the model
where for group <italic toggle="yes">s</italic>, <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the recombination rate and <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the effective population size. The presence of a genetic variant at position <italic toggle="yes">i</italic> is only copied if <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mi>T</mml:mi><mml:mo>≤</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, where <italic toggle="yes">T</italic> is the segment’s coalescent time and <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the variant’s age of mutation (obtained from <xref rid="btad535-B2" ref-type="bibr">Albers and McVean 2020</xref>). This does not create new mutations but introduces variability based on a coalescent model of when mutations entered the population. Two synthetic haplotypes, <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, constructed in this way are added element-wise to create a synthetic genotype, <italic toggle="yes">g</italic> (<xref rid="btad535-F1" ref-type="fig">Fig. 1c</xref>). For experiments in this text, we consider a reference dataset of 4062 phased genotypes derived from the publicly available 1000 Genomes Project and Human Genome Diversity Project (1KG+HGDP) datasets for six major discrete ancestry groups (<xref rid="btad535-B12" ref-type="bibr">Karczewski <italic toggle="yes">et al.</italic> 2020</xref>).</p>
    <disp-formula id="E1">
      <label>(1)</label>
      <mml:math id="M1" display="block" overflow="scroll">
        <mml:mrow>
          <mml:mi>ℓ</mml:mi>
          <mml:mo>∼</mml:mo>
          <mml:mo> </mml:mo>
          <mml:mi mathvariant="italic">Exp</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mn>2</mml:mn>
          <mml:mi>T</mml:mi>
          <mml:mrow>
            <mml:msub>
              <mml:mrow>
                <mml:mo>ρ</mml:mo>
              </mml:mrow>
              <mml:mi mathvariant="normal">s</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
          <mml:mo> </mml:mo>
          <mml:mi>T</mml:mi>
          <mml:mo>∼</mml:mo>
          <mml:mi mathvariant="italic">Gamma</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mn>2</mml:mn>
          <mml:mo>,</mml:mo>
          <mml:mrow>
            <mml:msub>
              <mml:mrow>
                <mml:mi>N</mml:mi>
              </mml:mrow>
              <mml:mi mathvariant="normal">s</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:mo>/</mml:mo>
          <mml:mrow>
            <mml:msub>
              <mml:mrow>
                <mml:mi>N</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">e</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi mathvariant="normal">s</mml:mi>
              </mml:mrow>
            </mml:msub>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:mrow>
      </mml:math>
    </disp-formula>
    <p>Finally, to aid the scalability of HAPNEST, we develop an efficient multithreaded implementation in the Julia programming language. Specifically, the operations that are parallelized across genotypes include the part of the algorithm that executes <xref rid="E1" ref-type="disp-formula">Equation (1)</xref> to determine how segments should be copied to construct synthetic haplotypes and the I/O operations that write these segments to an output file. We note that this parallelization and use of memory-mapped I/O for constant-time access of reference data makes HAPNEST suitable for use with large reference panels (even if they do not fit in the computer’s memory) and a large number of synthetic samples.</p>
    <sec>
      <title>2.1 Posterior distributions of model parameters</title>
      <p>HAPNEST uses ABC to optimize the model parameters for the fidelity and generalizability objectives (<xref rid="btad535-B18" ref-type="bibr">Naeem <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad535-B1" ref-type="bibr">Alaa <italic toggle="yes">et al.</italic> 2022</xref>). We define the ABC summary statistic for the fidelity objective as an LD decay vector, and the summary statistic for the generalizability objective is defined as a vector of the number of duplicate/MZ twin, first-degree and second-degree relatives between the synthetic and reference datasets. We measure generalizability in terms of genetic relatedness (defined by the kinship coefficient), to ensure that the samples in large synthetic datasets are not close copies of samples from the much smaller reference dataset. HAPNEST model parameters are selected as the means of the posterior distributions inferred using emulation-based rejection sampling (<xref rid="btad535-B25" ref-type="bibr">Tankhilevich <italic toggle="yes">et al.</italic> 2020</xref>). As an illustrative example, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref> shows the posterior distributions of the parameters that best satisfy the multiobjective criteria, for six discrete ancestry groups from the 1KG+HGDP reference for 18 267 HapMap3 variants on chromosome 21. We observe a tradeoff between optimizing the fidelity objective (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>) and optimizing the generalizability objective (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>). This tradeoff can affect the results of downstream analyses such as GWAS (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7</xref> and <xref rid="sup1" ref-type="supplementary-material">Table S9</xref>), and so it is important for users to choose the objective that matches the priorities of their use case.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Comparison of synthetic genotype quality</title>
    <p>Synthetic data quality is evaluated based on a workflow implemented in the HAPNEST software tool for measuring the fidelity, diversity, and generalizability of synthetic datasets. We compare HAPNEST with three alternative methods: HAPGEN2 (<xref rid="btad535-B23" ref-type="bibr">Su <italic toggle="yes">et al.</italic> 2011</xref>), G2P (<xref rid="btad535-B24" ref-type="bibr">Tang and Liu 2019</xref>), and Sim1000G (<xref rid="btad535-B7" ref-type="bibr">Dimitromanolakis <italic toggle="yes">et al.</italic> 2019</xref>). For these experiments, we consider two models for HAPNEST based on whether the multiobjective (fidelity and generalizability) or LD objective (fidelity only) was used to optimize the parameter values. The evaluation based on the LD objective alone is motivated by the fact that for applications such as GWAS and PRS, it is important to preserve realistic LD patterns in the synthetic data. For the other methods, which do not have built-in optimization procedures, parameters are selected manually to be comparable to the parameters used by the HAPNEST multiobjective approach, where possible (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Experiments</xref> section for a full list of parameter values used for other methods). The method comparison experiments use <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>syn</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula> samples generated from a reference of <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>ref</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>775</mml:mn></mml:mrow></mml:math></inline-formula> European-ancestry individuals from the 1KG+HGDP datasets (<xref rid="btad535-B12" ref-type="bibr">Karczewski <italic toggle="yes">et al.</italic> 2020</xref>), for 18 267 HapMap3 variants on chromosome 21. Due to limitations with scalability and compatibility of other methods, we do not evaluate larger synthetic datasets across methods, but we do provide a detailed evaluation of HAPNEST-generated datasets for larger synthetic datasets, non-European ancestry and larger SNP sets: <italic toggle="yes">N</italic><sub>syn</sub> = 1000, 25 000, <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="italic">EUR</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">AFR</mml:mi></mml:mrow></mml:math></inline-formula>, and <italic toggle="yes">k</italic> = 18 267, 1 09 673 (where the number of SNPs, <italic toggle="yes">k</italic>, correspond to the HapMap3 variants and SNPs with non-zero MAF in all six superpopulations, respectively, on chromosome 21).</p>
    <sec>
      <title>3.1 Fidelity</title>
      <p>Fidelity is measured as the similarity between the real (reference) and synthetic datasets for four properties: minor allele frequency (MAF) distribution, population structure in terms of alignment of the principal components (PCs), LD decay and nearest neighbour adversarial accuracy (full definitions are given in <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref> sections). The full fidelity results are reported in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>.</p>
      <sec>
        <title>3.1.1 Minor allele frequency</title>
        <p>The G2P method had the lowest divergence in MAF between the synthetic and reference datasets, followed by HAPNEST (LD objective), HAPNEST (multiobjective), and Sim1000G (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>).</p>
      </sec>
      <sec>
        <title>3.1.2 LD decay</title>
        <p>In <xref rid="btad535-F2" ref-type="fig">Fig. 2a and c</xref>, we provide a visualization of LD correlation matrices for a snapshot segment of the reference and synthetic samples generated by each method. We observe that the samples produced by HAPGEN, HAPNEST, and G2P faithfully capture the reference LD while Sim1000G amplifies the correlation among SNPs. To quantify this observation, we provide the LD decay plot (<xref rid="btad535-B14" ref-type="bibr">Laido <italic toggle="yes">et al.</italic> 2014</xref>) for all methods along with the reference in <xref rid="btad535-F2" ref-type="fig">Fig. 2b</xref>. The HAPNEST (LD objective) method had the LD decay that least diverged from the reference, followed by the G2P and HAPGEN2 methods (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). However, we observe that HAPNEST (multiobjective) has a faster LD decay (<xref rid="btad535-F2" ref-type="fig">Fig. 2b</xref>) and more generally, our posterior analysis indicates there is a tradeoff between optimizing the LD and relatedness objectives (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs. S3 and S4</xref>). Nevertheless, GWAS results presented later still indicate realistic LD structure at genome-wide significant loci. LD analyses similar to <xref rid="btad535-F2" ref-type="fig">Fig. 2b</xref> (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>) and <xref rid="btad535-F2" ref-type="fig">Fig. 2c</xref> (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>) for a wider range of HAPNEST-generated synthetic datasets show visually comparable LD results for a larger number of synthetic samples, number of SNPs and non-European ancestry.</p>
        <fig position="float" id="btad535-F2">
          <label>Figure 2.</label>
          <caption>
            <p>(a) LD correlation for 500 contiguous SNPs selected at random from chromosome 21 HapMap3 variants, for the European-ancestry reference dataset (<inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>ref</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>775</mml:mn></mml:mrow></mml:math></inline-formula>); (b) comparison of LD decay (<xref rid="btad535-B14" ref-type="bibr">Laido et al., 2014</xref>) for <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>syn</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula> European-ancestry synthetic samples; (c) comparison of LD correlation (for same 500 SNPs shown in reference panel) for <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>syn</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula> European-ancestry synthetic samples. We selected alleles with MAF <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula> and used <monospace>plink</monospace> with <monospace>– r2 square</monospace> flag to compute the LD correlation matrix.</p>
          </caption>
          <graphic xlink:href="btad535f2" position="float"/>
        </fig>
      </sec>
      <sec>
        <title>3.1.3 Population structure</title>
        <p>We evaluate preservation of population structure of HAPNEST and other state of the art simulators. <xref rid="btad535-F3" ref-type="fig">Figure 3a</xref> shows a PCA projection of 10 002 HAPNEST-generated individuals from six super populations based on chromosome 21. Visual separations between individuals from different populations demonstrate good preservation of overall population structure across multiple ancestries. <xref rid="btad535-F3" ref-type="fig">Figure 3b</xref> shows a visual comparison of projecting the top two PCs of 1000 European-ancestry individuals generated by each tool, aligning with the reference. For a more quantitative evaluation, we also compare the PC alignment score, defined as the cosine distance between the first 20 PCs obtained from real and synthetic data within European individuals. The PC alignment score captures the discrepancy in population structure in a high-dimensional space. HAPGEN2 has the highest PC alignment score, followed by HAPNEST (LD objective) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>).</p>
        <fig position="float" id="btad535-F3">
          <label>Figure 3.</label>
          <caption>
            <p>(a) PCA projection plot for <italic toggle="yes">N</italic><sub>syn</sub> = 10 002 synthetic samples generated by the HAPNEST method (multiobjective ABC), for chromosome 21 HapMap3 variants, <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>ref</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>4062</mml:mn></mml:mrow></mml:math></inline-formula>; (b) comparison of PCA projection plots and bivariate densities for <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>syn</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula> European-ancestry synthetic samples (<inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>ref</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>775</mml:mn></mml:mrow></mml:math></inline-formula>). The highest PC alignment score for preservation of population structure is 0.311 for HAPGEN2, 0.281 (HAPNEST LD objective), 0.222 (G2P), 0.182 (HAPNEST multiobjective), and 0.043 (Sim1000G).</p>
          </caption>
          <graphic xlink:href="btad535f3" position="float"/>
        </fig>
      </sec>
      <sec>
        <title>3.1.4 Adversarial accuracy</title>
        <p>We consider privacy-preserving metrics by calculating the nearest neighbour adversarial accuracy score, which averages the true positive rate and true negative rate for distinguishing real and synthetic data. Adversarial accuracy scores closest to 0.5 are observed for the G2P and HAPNEST (multiobjective) methods, indicating that these synthetic samples are more indistinguishable from the real data (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>).</p>
        <p>Overall, our analysis indicates that no one method performs best across all evaluation metrics, but instead there are tradeoffs that end users should consider, depending on the priorities of their use case. The correlation in the performance of metrics across methods is weak overall, but a lower LD decay distance is generally associated with a higher PC alignment, suggesting that methods with better preservation of LD structure also preserve the population structure of the reference data well (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). The nearest neighbour adversarial accuracy is closest to 0.5 for methods that generate high-fidelity data with lower relatedness to the reference data and between synthetic genotypes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S2 and S3</xref>). We provide further analyses of fidelity and generalizability metrics (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref> for European ancestry and <xref rid="sup1" ref-type="supplementary-material">Table S6</xref> for African ancestry) to demonstrate the properties of HAPNEST datasets for a variety of common use cases. In particular, these results show that for larger synthetic datasets (<italic toggle="yes">N</italic><sub>syn</sub> = 25 000, <italic toggle="yes">k</italic> &gt; 1 00 000), HAPNEST achieves comparable performance in the LD metric and better performance in some metrics such as PC alignment, compared with the smaller datasets. Similar results were observed for both the European and African ancestry experiments.</p>
      </sec>
    </sec>
    <sec>
      <title>3.2 Generalizability and diversity</title>
      <p>Diversity is measured by the degree of genetic relatedness (kinship) within the synthetic dataset and generalizability is measured by the degree of genetic relatedness between the real and synthetic datasets. HAPNEST (multiobjective) reached the best generalizability and diversity of all methods evaluated (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S2 and S3</xref>) when considering <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>syn</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula> synthetic samples. However, it is more appropriate to measure generalizability and diversity on larger and more realistic sample sizes. As there is a limited number of haplotypes in the reference dataset, one might expect that when generating thousands of synthetic samples, some generated genomes might eventually be copies of or highly related with genomes in the reference set. As shown in the next section, scalability is an issue for Sim1000G and G2P, so in this experiment we only consider HAPNEST and HAPGEN2. We quantify the two measurements as
for generalizability, where <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>cross</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the number of closely related pairs (i.e. twins or first-degree relatives, as determined by the kinship coefficient) between the reference and synthetic datasets; and
for diversity, where <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>pairs</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the number of closely related pairs in the synthetic dataset. <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref> shows the generalizability and diversity measurements for HAPNEST in comparison to HAPGEN2, under various sample sizes generated with two reference panels. We observe that HAPNEST also outperforms HAPGEN2 for both generalizability and diversity on larger sample samples.</p>
      <disp-formula id="E2">
        <mml:math id="M2" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mo stretchy="true">(</mml:mo>
            <mml:mn>1</mml:mn>
            <mml:mo>−</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext>cross</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mrow>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext>syn</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>*</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext>ref</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo stretchy="true">)</mml:mo>
            <mml:mo>×</mml:mo>
            <mml:mn>100</mml:mn>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <disp-formula id="E3">
        <mml:math id="M3" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mo stretchy="true">(</mml:mo>
            <mml:mn>1</mml:mn>
            <mml:mo>−</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext>pairs</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mrow>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext>syn</mml:mtext>
                      </mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:msubsup>
                  </mml:mrow>
                  <mml:mo>−</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext>syn</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo stretchy="true">)</mml:mo>
            <mml:mo>×</mml:mo>
            <mml:mn>100</mml:mn>
          </mml:mrow>
        </mml:math>
      </disp-formula>
    </sec>
  </sec>
  <sec>
    <title>4 Scalability analysis for large sample sizes</title>
    <p>The scalability of HAPNEST is validated by measuring the computational speed of generating genotype datasets for a varying number of synthetic samples, SNPs and computing threads. The experiments compare a smaller panel of 18 267 HapMap3 variants and a larger panel of 109 673 variants with non-zero MAF on chromosome 21. The analyses were conducted using a CentOS server with Intel Xeon E5 2680 v3 2.50 GHz processors and 32GB RAM for both single- and multithreaded setups, and use fixed input parameters, <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>2.185</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>500</mml:mn></mml:mrow></mml:math></inline-formula>, to ensure that equivalent setups are being compared for computational experiments. The Sim1000G and G2P methods were excluded from this comparison as they did not scale to the large sample sizes considered here under this setup.</p>
    <p>We observe that while generation times are similar for smaller datasets, HAPNEST is increasingly faster than HAPGEN2 for more variants and larger sample sizes (<xref rid="btad535-F4" ref-type="fig">Fig. 4</xref>) which approach the size of modern biobank-scale genetic datasets. For 100 000 synthetic samples, HAPNEST was between 2.4–8.2<italic toggle="yes">x</italic> times faster than HAPGEN2 (for between 18 267 and 109 673 SNPs) for a single thread and this increased to 5.3–24<italic toggle="yes">x</italic> times faster for multiple threads (tested for eight threads). This demonstrates that HAPNEST uses parallelization to achieve gains in computational efficiency for larger synthetic datasets. We note that HAPGEN2 does not have a command-line option for multiple threads and that similar results for both the single and multithreaded experiments (<xref rid="btad535-F4" ref-type="fig">Fig. 4</xref>) indicate that HAPGEN2 was not fully utilizing the available computing resources. The scalability of HAPNEST to generate large datasets under memory constraints can also be attributed to details of our implementation introduced to handle memory-intensive I/O operations, such as batching and memory-mapping. RAM usage statistics reported in <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S10 and S11</xref> demonstrate that HAPNEST utilizes less RAM than HAPGEN2 for larger synthetic sample sizes (3.8–7.9<italic toggle="yes">x</italic> times less RAM for 100 000 synthetic samples on a single thread) and uses multithreading to more efficiently utilize the available computing resources.</p>
    <fig position="float" id="btad535-F4">
      <label>Figure 4.</label>
      <caption>
        <p>Simulation times for genotype datasets for HAPNEST and HAPGEN2 (other methods are excluded from this comparison due to scalability and compatibility issues), averaged for five trials with 95% confidence intervals plotted, for a varying number of synthetic samples, SNPs and computing threads. Missing results are due to an experiment being terminated for exceeding the memory limit.</p>
      </caption>
      <graphic xlink:href="btad535f4" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>5 Overview of phenotype generation methods</title>
    <p>A continuous or binary phenotype can be assigned to each sample as an aggregation of genetic effect, user-input covariate effect (if any) and environmental noise. The genetic component is generated as a weighted sum of causal allele counts (<xref rid="btad535-F1" ref-type="fig">Fig. 1d</xref>). For each causal SNP <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, the effect size is drawn from a Gaussian distribution with 0 mean and variance determined by three well-studied factors impacting heritability of the variants, the MAF <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, local linkage structural <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and the functional annotation <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> of the SNP:
</p>
    <disp-formula id="E4">
      <mml:math id="M4" display="block" overflow="scroll">
        <mml:mrow>
          <mml:mrow>
            <mml:msub>
              <mml:mrow>
                <mml:mo>β</mml:mo>
              </mml:mrow>
              <mml:mi>i</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:mo>∼</mml:mo>
          <mml:mi>N</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mn>0</mml:mn>
          <mml:mo>,</mml:mo>
          <mml:mrow>
            <mml:msup>
              <mml:mrow>
                <mml:mrow>
                  <mml:mo stretchy="false">[</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>p</mml:mi>
                      </mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>−</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>p</mml:mi>
                      </mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo stretchy="false">]</mml:mo>
                </mml:mrow>
              </mml:mrow>
              <mml:mi>a</mml:mi>
            </mml:msup>
          </mml:mrow>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi>r</mml:mi>
              </mml:mrow>
              <mml:mi>i</mml:mi>
              <mml:mi>b</mml:mi>
            </mml:msubsup>
          </mml:mrow>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi>s</mml:mi>
              </mml:mrow>
              <mml:mi>i</mml:mi>
              <mml:mi>c</mml:mi>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>.</mml:mo>
        </mml:mrow>
      </mml:math>
    </disp-formula>
    <p>Power parameters <italic toggle="yes">a</italic>, <italic toggle="yes">b</italic>, and <italic toggle="yes">c</italic> reflect strength of negative selection on each aspect and we used extensive empirical observations (<xref rid="btad535-B8" ref-type="bibr">Finucane <italic toggle="yes">et al.</italic> 2015</xref>, <xref rid="btad535-B10" ref-type="bibr">Gazal <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btad535-B21" ref-type="bibr">Schoech <italic toggle="yes">et al.</italic> 2019</xref>) to chose the default parameters. HAPNEST allows SNP’s effect sizes to be drawn from a mixture of distributions with different width, corresponding to variable level of heritability. Our model also allows flexible assignment of individual components’ contribution to the phenotype (heritability), as well as the number of causal variants constituting the genetic risk (polygenicity). We run GWASs for 50 000 synthetic individuals and 1 049 096 HapMap 3 SNPs based on phenotypes generated under different genetic architectures. The Manhattan plots visually resemble Manhattan plots obtained on real data with similar heritability and polygenicity (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs. S8, S9, and S11</xref>). <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S11</xref> shows exemplary GWAS results for traits under two extreme scenarios: low heritability, low polygenicity, and high heritability, high polygenicity. The former resembles phenotypes such as atrial fibrillation and flutter (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8</xref>), and the latter resembles typically more heterogeneous traits, such as body pain (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S9</xref>). Our approach allows us to specify genetic correlations between phenotypes within and, importantly, between ancestry groups.</p>
  </sec>
  <sec>
    <title>6 Application: comparison of polygenic risk scoring methods</title>
    <p>We demonstrated the utility of HAPNEST by comparing seven PRS methods using synthetic data from five ancestry groups. We first generated a synthetic training dataset of 100 000 individuals of European ancestries, and performed a standard GWAS using software plink2 (<xref rid="btad535-B20" ref-type="bibr">Purcell <italic toggle="yes">et al.</italic> 2007</xref>), correcting for top 20 PCs. We subsequently used the summary statistics to build PRSs in a separate synthetic test set of 25 000 individuals (5000 samples from each ancestry group). To demonstrate variability across genetic architectures, GWAS summary statistics are computed for nine continuous phenotypic traits, with varying heritability (0.03, 0.1, and 0.5) and polygenicity (0.0001, 0.005, and 0.1). We assumed a genetic correlation of 1 across all ancestry groups.</p>
    <p>The evaluation of the PRS methods is based on the reference-standardized framework by <xref rid="btad535-B19" ref-type="bibr">Pain <italic toggle="yes">et al.</italic> (2021)</xref>, where for continuous traits, the PRS performance is measured in terms of Pearson correlation between the predicted and observed values. The optimal parameters for each PRS method are identified using cross validation (CV), or pseudovalidation (PseudoVal), if CV is not available.</p>
    <p>Better predictive performance is observed for higher heritability, lower polygenicity architectures (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S10</xref>). No single PRS method was observed to perform best across all genetic architectures. Methods with sparsity-inducing shrinkage priors (e.g. PRScs) were observed to perform better for higher heritability, lower polygenicity architectures, where genetic effects on most SNPs are zero (<xref rid="btad535-F5" ref-type="fig">Fig. 5c</xref>), while other approaches such as MegaPRS performed better for lower heritability, higher polygenicity architectures (<xref rid="btad535-F5" ref-type="fig">Fig. 5a</xref>). Multiancestry results replicate known issues with transferability of polygenic risk scores based on European-ancestry summary statistics (<xref rid="btad535-F5" ref-type="fig">Fig. 5b and d</xref>).</p>
    <fig position="float" id="btad535-F5">
      <label>Figure 5.</label>
      <caption>
        <p>PRS results for two genetic architectures, averaged across three experiment trials with error bars showing the range of outcomes, for HapMap3 variants across 22 chromosomes. (a) Pearson correlation between predicted and observed values, for various PRS methods and a European-ancestry phenotype with heritability 0.1 and polygenicity 0.005. (b) Pearson correlation for various target ancestry groups for the best-performing PRS method (MegaPRS) for the heritability 0.1 and polygenicity 0.005 phenotype. (c) Pearson correlation between predicted and observed values, for various PRS methods and a European-ancestry phenotype with heritability 0.5 and polygenicity 0.0001. (d) Pearson correlation for various target ancestry groups for the best-performing PRS method (PRScs) for the heritability 0.5 and polygenicity 0.0001 phenotype.</p>
      </caption>
      <graphic xlink:href="btad535f5" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>7 Discussion</title>
    <p>In this study, we proposed HAPNEST, a new algorithm to generate realistic individual-level genetic and phenotypic data and provide an efficient implementation. HAPNEST meets the demand for diverse, biobank-scale genomic data by improving scalability compared with existing methods. Users can customize population parameters or use parameter estimates derived from the reference dataset. Previous studies have been inconsistent in their approach to evaluating the quality of the generated synthetic data. We provide a comprehensive set of measures to be used for data quality evaluation that have been proposed in the statistical genetics and differential-privacy literature (<xref rid="btad535-B28" ref-type="bibr">Yale <italic toggle="yes">et al.</italic> 2019</xref>). Genotype generation, phenotype generation and evaluation modules are wrapped in user-friendly Docker or Singularity containers, where each module can be run independently.</p>
    <p>Synthetic genotypes are generated by copying and assembling haplotype segments from the reference genome, with distribution of segment length determined by specifics of the target population, including recombination rates, effective population size and samples in the reference panel. Parameters are optimized through the ABC algorithm, which typically results in an output dataset well-balanced across fidelity and generalizability metrics. On top of that, we introduced mutations to the synthetic genome to reduce similarity across individuals. Like HAPGEN2, HAPNEST is also based on the Li and Stephens model of LD (<xref rid="btad535-B15" ref-type="bibr">Li and Stephens 2003</xref>), but to improve computational scalability and generalizability we have introduced modelling of varying, rather than constant, coalescence time, and the use of mutation ages to determine if mutations are present in synthetic samples.</p>
    <p>From our systematic evaluation and experiments, we noticed some general trade-offs in synthetic data quality and in the parameter selection. One trade-off occurs between the preservation of population LD structure and synthetic sample relatedness when constructing large synthetic datasets from much smaller reference datasets. Our observations indicated that parameters optimizing the preservation of LD usually result in higher levels of sample relatedness, as LD typically comes with larger average segment length copied from the reference. On the other hand, shortened segments allow more combinations and higher sample level variability, which results in samples that are less related to each other but increased fragmentation in the LD structure. Furthermore, smaller segments lead to more computational input/output operations when constructing synthetic data files and a slight increase in running time. Segments copied from the reference genome in our algorithm can be conceptually viewed as identity-by-descent (IBD) segments in population genetics (<xref rid="btad535-B30" ref-type="bibr">Zhou <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad535-B4" ref-type="bibr">Browning and Browning 2020</xref>). As shown in <xref rid="E1" ref-type="disp-formula">Equation (1)</xref>, recombination events (<inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>) happen over time (<italic toggle="yes">T</italic>) in the population. Thus, IBD segments degrade over time, which also shows an impact on LD (<xref rid="btad535-B26" ref-type="bibr">Thompson 2013</xref>, <xref rid="btad535-B22" ref-type="bibr">Sticca <italic toggle="yes">et al.</italic> 2021</xref>). Our algorithm also provides an implementation of generating “admixed” samples by sampling from multiple reference populations under user defined compositions. However, we would like to note that this approach does not accurately reflect the process of multipopulation diverging and intermixing, therefore it should be used and interpreted carefully.</p>
    <p>Compared with other methods, HAPNEST-generated genotypes demonstrated better diversity and generalizability, which are essential features when scaling to large sample sizes. While the genetic relatedness analysis indicated that the genotypes are sufficiently different from the reference data, a nearest-neighbour adversarial accuracy close to 0.5 indicates that statistically speaking, it would be difficult to discern a synthetic genotype from a real genotype. These properties of synthetic datasets are desirable in the context of data privacy, where we may want to create a synthetic twin of sensitive data that preserves key statistical properties of the real data, but cannot be traced back to real individuals. However, we note that we have not tested the HAPNEST method for differential privacy guarantees and for this reason, we advise to use HAPNEST, or any of the reference-based generation methods, only on publicly available genomics datasets.</p>
    <p>Once individual level genotypes have been generated, we can subsequently assign phenotypes to each sample as an aggregation of polygenic effects, non-genetic effects and environmental noise. We also implemented population-specific phenotypic effects by assuming shared causal variants across populations with distinct but correlated effect sizes, and multitrait simulation allowing for different genetic correlation and pleiotropy models.</p>
    <p>We believe our tool can benefit the community especially for GWAS-related method development, for which one of the examples can be PRS computation and evaluation. HAPNEST allows researchers to assess the validity of genetic scoring methods under a broad variety of setups, including cross-ancestry, trans-diagnostic, and different genetic architectures. Here, as a demonstration of its utility, we applied PRSpipe [PRSpipe is a Snakemake pipeline developed to calculate and evaluate polygenic risk scores from GWAS summary statistics. It implements and extends the GenoPred (<xref rid="btad535-B19" ref-type="bibr">Pain <italic toggle="yes">et al.</italic> 2021</xref>) pipeline, a reference standardised framework for the prediction of PRS using various state-of-the-art methods] to synthetic data generated by HAPNEST and found that our results, to a great degree, replicated what has been observed by <xref rid="btad535-B19" ref-type="bibr">Pain <italic toggle="yes">et al.</italic> (2021)</xref>. As widely discussed, we found lower cross-ancestry portability of PRSs derived in a single ancestry. For a given phenotype, we set genetic correlations between ancestry groups to 1 and this might be higher than what is observed in real settings and result in slightly inflated trans-ethnic PRS prediction performance. Nevertheless, we still observed reduced prediction accuracy in non-European samples, indicating the synthetic genotype captured the differences of MAF and LD structures across populations. Results under different genetic architectures are concordant with the general expectation: we observe better performance of PRS for phenotypes with higher heritability and lower polygenicity due to the existence of few variants with larger effect that explain large amounts of phenotypic variance. We also noticed that the best performing method can depend on different genetic architecture, reflecting the need for careful considerations when choosing a PRS method. As more studies come online that examine the clinical utility of PRSs, it will be important to have a reference dataset where old and new PRS methods can be compared and their robustness can be assessed as a function of the genetic and phenotypic architecture. We used HAPNEST to create one of the largest genomics synthetic datasets today including 1 million individuals across six major continental ancestry groups, 6.8 million variants, and nine phenotypes. We hope this dataset can generate a reference set for deriving and testing PRS methods within a unified framework.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad535_Supplementary_Data</label>
      <media xlink:href="btad535_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors wish to acknowledge CSC—IT Center for Science, Finland, for computational resources.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the European Union’s Horizon 2020 research and innovation programme [grant agreement number 101016775].</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>A synthetic dataset of 1 008 000 individuals and nine traits for 6.8 million common variants is available at <ext-link xlink:href="https://www.ebi.ac.uk/biostudies/studies/S-BSST936" ext-link-type="uri">https://www.ebi.ac.uk/biostudies/studies/S-BSST936</ext-link>. The HAPNEST software for generating synthetic datasets is available as Docker/Singularity containers and open source Julia and C code at <ext-link xlink:href="https://github.com/intervene-EU-H2020/synthetic_data" ext-link-type="uri">https://github.com/intervene-EU-H2020/synthetic_data</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad535-B1">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Alaa</surname><given-names>AM</given-names></string-name>, <string-name><surname>van Breugel</surname><given-names>B</given-names></string-name>, <string-name><surname>Saveliev</surname><given-names>E</given-names></string-name></person-group><etal>et al</etal> How faithful is your synthetic data? Sample-level metrics for evaluating and auditing generative models, In: <italic toggle="yes">International Conference on Machine Learning</italic>, PMLR <year>2022</year>.</mixed-citation>
    </ref>
    <ref id="btad535-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Albers</surname><given-names>PK</given-names></string-name>, <string-name><surname>McVean</surname><given-names>G.</given-names></string-name></person-group><article-title>Dating genomic variants and shared ancestry in population-scale sequencing data</article-title>. <source>PLoS Biol</source><year>2020</year>;<volume>18</volume>:<fpage>e3000586</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pbio.3000586</pub-id><pub-id pub-id-type="pmid">31951611</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Araújo</surname><given-names>DS</given-names></string-name>, <string-name><surname>Wheeler</surname><given-names>HE.</given-names></string-name></person-group><article-title>Genetic and environmental variation impact transferability of polygenic risk scores</article-title>. <source>Cell Rep Med</source><year>2022</year>;<volume>3</volume>:<fpage>100687</fpage>.<pub-id pub-id-type="pmid">35858592</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Browning</surname><given-names>SR</given-names></string-name>, <string-name><surname>Browning</surname><given-names>BL.</given-names></string-name></person-group><article-title>Probabilistic estimation of identity by descent segment endpoints and detection of recent selection</article-title>. <source>Am J Hum Genet</source><year>2020</year>;<volume>107</volume>:<fpage>895</fpage>–<lpage>910</lpage>.<pub-id pub-id-type="pmid">33053335</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Choi</surname><given-names>SW</given-names></string-name>, <string-name><surname>Mak</surname><given-names>TS-H</given-names></string-name>, <string-name><surname>O'Reilly</surname><given-names>PF.</given-names></string-name></person-group><article-title>Tutorial: a guide to performing polygenic risk score analyses</article-title>. <source>Nat Protoc</source><year>2020</year>;<volume>15</volume>:<fpage>2759</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">32709988</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B6">
      <mixed-citation publication-type="journal"><collab>International HapMap 3 Consortium</collab>. <article-title>Integrating common and rare genetic variation in diverse human populations</article-title>. <source>Nature</source><year>2010</year>;<volume>467</volume>:<fpage>52</fpage>.<pub-id pub-id-type="pmid">20811451</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dimitromanolakis</surname><given-names>A</given-names></string-name>, <string-name><surname>Xu</surname><given-names>J</given-names></string-name>, <string-name><surname>Krol</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Sim1000G: a user-friendly genetic variant simulator in r for unrelated individuals and family-based designs</article-title>. <source>BMC Bioinform</source><year>2019</year>;<volume>20</volume>:<fpage>26</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="btad535-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Finucane</surname><given-names>HK</given-names></string-name>, <string-name><surname>Bulik-Sullivan</surname><given-names>B</given-names></string-name>, <string-name><surname>Gusev</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal>; <collab>RACI Consortium</collab>. <article-title>Partitioning heritability by functional annotation using genome-wide association summary statistics</article-title>. <source>Nat Genet</source><year>2015</year>;<volume>47</volume>:<fpage>1228</fpage>–<lpage>35</lpage>.<pub-id pub-id-type="pmid">26414678</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fortune</surname><given-names>MD</given-names></string-name>, <string-name><surname>Wallace</surname><given-names>C.</given-names></string-name></person-group><article-title>simGWAS: a fast method for simulation of large scale case–control GWAS summary statistics</article-title>. <source>Bioinformatics</source><year>2019</year>;<volume>35</volume>:<fpage>1901</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">30371734</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gazal</surname><given-names>S</given-names></string-name>, <string-name><surname>Finucane</surname><given-names>HK</given-names></string-name>, <string-name><surname>Furlotte</surname><given-names>NA</given-names></string-name></person-group><etal>et al</etal><article-title>Linkage disequilibrium–dependent architecture of human complex traits shows action of negative selection</article-title>. <source>Nat Genet</source><year>2017</year>;<volume>49</volume>:<fpage>1421</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">28892061</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hudson</surname><given-names>RR.</given-names></string-name></person-group><article-title>Generating samples under a wright–fisher neutral model of genetic variation</article-title>. <source>Bioinformatics</source><year>2002</year>;<volume>18</volume>:<fpage>337</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">11847089</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Karczewski</surname><given-names>KJ</given-names></string-name>, <string-name><surname>Francioli</surname><given-names>LC</given-names></string-name>, <string-name><surname>Tiao</surname><given-names>G</given-names></string-name></person-group>, <etal>et al</etal>; <collab>Genome Aggregation Database Consortium</collab>. <article-title>The mutational constraint spectrum quantified from variation in 141,456 humans</article-title>. <source>Nature</source><year>2020</year>;<volume>581</volume>:<fpage>434</fpage>–<lpage>43</lpage>.<pub-id pub-id-type="pmid">32461654</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kelleher</surname><given-names>J</given-names></string-name>, <string-name><surname>Etheridge</surname><given-names>AM</given-names></string-name>, <string-name><surname>McVean</surname><given-names>G.</given-names></string-name></person-group><article-title>Efficient coalescent simulation and genealogical analysis for large sample sizes</article-title>. <source>PLoS Comput Biol</source><year>2016</year>;<volume>12</volume>:<fpage>e1004842</fpage>.<pub-id pub-id-type="pmid">27145223</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Laido</surname><given-names>G</given-names></string-name>, <string-name><surname>Marone</surname><given-names>D</given-names></string-name>, <string-name><surname>Russo</surname><given-names>MA</given-names></string-name></person-group><etal>et al</etal><article-title>Linkage disequilibrium and genome-wide association mapping in tetraploid wheat (<italic toggle="yes">Triticum turgidum</italic> L.)</article-title>. <source>PLoS One</source><year>2014</year>;<volume>9</volume>:<fpage>e95211</fpage>.<pub-id pub-id-type="pmid">24759998</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>N</given-names></string-name>, <string-name><surname>Stephens</surname><given-names>M.</given-names></string-name></person-group><article-title>Modeling linkage disequilibrium and identifying recombination hotspots using single-nucleotide polymorphism data</article-title>. <source>Genetics</source><year>2003</year>;<volume>165</volume>:<fpage>2213</fpage>–<lpage>33</lpage>.<pub-id pub-id-type="pmid">14704198</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McVean</surname><given-names>GA</given-names></string-name>, <string-name><surname>Cardin</surname><given-names>NJ.</given-names></string-name></person-group><article-title>Approximating the coalescent with recombination</article-title>. <source>Philos Trans R Soc Lond B Biol Sci</source><year>2005</year>;<volume>360</volume>:<fpage>1387</fpage>–<lpage>93</lpage>.<pub-id pub-id-type="pmid">16048782</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mills</surname><given-names>MC</given-names></string-name>, <string-name><surname>Rahal</surname><given-names>C.</given-names></string-name></person-group><article-title>The GWAS diversity monitor tracks diversity by disease in real time</article-title>. <source>Nat Genet</source><year>2020</year>;<volume>52</volume>:<fpage>242</fpage>–<lpage>3</lpage>.<pub-id pub-id-type="pmid">32139905</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B18">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Naeem</surname><given-names>MF</given-names></string-name>, <string-name><surname>Oh</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Uh</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal> Reliable fidelity and diversity metrics for generative models. In: <person-group person-group-type="editor"><string-name><surname>Daumé</surname><given-names>H</given-names><suffix>III</suffix></string-name>, <string-name><surname>Singh</surname><given-names>A</given-names></string-name></person-group> (eds), <italic toggle="yes">Proceedings of the 37th International Conference on Machine Learning</italic>, volume 119 of <italic toggle="yes">Proceedings of Machine Learning Research</italic>, <fpage>7176</fpage>–<lpage>85</lpage>. PMLR, 13–18 July <year>2020</year>.</mixed-citation>
    </ref>
    <ref id="btad535-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pain</surname><given-names>O</given-names></string-name>, <string-name><surname>Glanville</surname><given-names>KP</given-names></string-name>, <string-name><surname>Hagenaars</surname><given-names>SP</given-names></string-name></person-group><etal>et al</etal><article-title>Evaluation of polygenic prediction methodology within a reference-standardized framework</article-title>. <source>PLoS Genet</source><year>2021</year>;<volume>17</volume>:<fpage>e1009021</fpage>.<pub-id pub-id-type="pmid">33945532</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Purcell</surname><given-names>S</given-names></string-name>, <string-name><surname>Neale</surname><given-names>B</given-names></string-name>, <string-name><surname>Todd-Brown</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>Plink: a tool set for whole-genome association and population-based linkage analyses</article-title>. <source>Am J Hum Genet</source><year>2007</year>;<volume>81</volume>:<fpage>559</fpage>–<lpage>75</lpage>.<pub-id pub-id-type="pmid">17701901</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schoech</surname><given-names>AP</given-names></string-name>, <string-name><surname>Jordan</surname><given-names>DM</given-names></string-name>, <string-name><surname>Loh</surname><given-names>P-R</given-names></string-name></person-group><etal>et al</etal><article-title>Quantification of frequency-dependent genetic architectures in 25 UK biobank traits reveals action of negative selection</article-title>. <source>Nat Commun</source><year>2019</year>;<volume>10</volume>:<fpage>790</fpage>.<pub-id pub-id-type="pmid">30770844</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sticca</surname><given-names>EL</given-names></string-name>, <string-name><surname>Belbin</surname><given-names>GM</given-names></string-name>, <string-name><surname>Gignoux</surname><given-names>CR.</given-names></string-name></person-group><article-title>Current developments in detection of identity-by-descent methods and applications</article-title>. <source>Front Genet</source><year>2021</year>;<volume>12</volume>:<fpage>722602</fpage>.<pub-id pub-id-type="pmid">34567074</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Su</surname><given-names>Z</given-names></string-name>, <string-name><surname>Marchini</surname><given-names>J</given-names></string-name>, <string-name><surname>Donnelly</surname><given-names>P.</given-names></string-name></person-group><article-title>HAPGEN2: simulation of multiple disease SNPs</article-title>. <source>Bioinformatics</source><year>2011</year>;<volume>27</volume>:<fpage>2304</fpage>–<lpage>5</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btr341</pub-id><pub-id pub-id-type="pmid">21653516</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Liu</surname><given-names>X.</given-names></string-name></person-group><article-title>G2P: a genome-wide-association-study simulation tool for genotype simulation, phenotype simulation and power evaluation</article-title>. <source>Bioinformatics</source><year>2019</year>;<volume>35</volume>:<fpage>3852</fpage>–<lpage>4</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btz126</pub-id><pub-id pub-id-type="pmid">30848784</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tankhilevich</surname><given-names>E</given-names></string-name>, <string-name><surname>Ish-Horowicz</surname><given-names>J</given-names></string-name>, <string-name><surname>Hameed</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>GpABC: a Julia package for approximate Bayesian computation with Gaussian process emulation</article-title>. <source>Bioinformatics</source><year>2020</year>;<volume>36</volume>:<fpage>3286</fpage>–<lpage>7</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa078</pub-id><pub-id pub-id-type="pmid">32022854</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Thompson</surname><given-names>EA.</given-names></string-name></person-group><article-title>Identity by descent: variation in meiosis, across genomes, and in populations</article-title>. <source>Genetics</source><year>2013</year>;<volume>194</volume>:<fpage>301</fpage>–<lpage>26</lpage>.<pub-id pub-id-type="pmid">23733848</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B27">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Namba</surname><given-names>S</given-names></string-name>, <string-name><surname>Lopera-Maya</surname><given-names>EA</given-names></string-name></person-group><etal>et al</etal> Global biobank analyses provide lessons for computing polygenic risk scores across diverse cohorts. <italic toggle="yes">Cell Genomics</italic> 2023;3.</mixed-citation>
    </ref>
    <ref id="btad535-B28">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Yale</surname><given-names>A</given-names></string-name>, <string-name><surname>Dash</surname><given-names>S</given-names></string-name>, <string-name><surname>Dutta</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal> Privacy preserving synthetic health data. In: <italic toggle="yes">ESANN 2019-European Symposium on Artificial Neural Networks, Computational Intelligence and Machine Learning</italic>, <year>2019</year>.</mixed-citation>
    </ref>
    <ref id="btad535-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>J</given-names></string-name>, <string-name><surname>Benyamin</surname><given-names>B</given-names></string-name>, <string-name><surname>McEvoy</surname><given-names>BP</given-names></string-name></person-group><etal>et al</etal><article-title>Common SNPs explain a large proportion of the heritability for human height</article-title>. <source>Nat Genet</source><year>2010</year>;<volume>42</volume>:<fpage>565</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">20562875</pub-id></mixed-citation>
    </ref>
    <ref id="btad535-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhou</surname><given-names>Y</given-names></string-name>, <string-name><surname>Browning</surname><given-names>SR</given-names></string-name>, <string-name><surname>Browning</surname><given-names>BL.</given-names></string-name></person-group><article-title>A fast and simple method for detecting identity-by-descent segments in large-scale data</article-title>. <source>Am J Hum Genet</source><year>2020</year>;<volume>106</volume>:<fpage>426</fpage>–<lpage>37</lpage>.<pub-id pub-id-type="pmid">32169169</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
