<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Res Notes</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Res Notes</journal-id>
    <journal-title-group>
      <journal-title>BMC Research Notes</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1756-0500</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3748833</article-id>
    <article-id pub-id-type="publisher-id">1756-0500-5-341</article-id>
    <article-id pub-id-type="pmid">22747589</article-id>
    <article-id pub-id-type="doi">10.1186/1756-0500-5-341</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Technical Note</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GTfold: Enabling parallel RNA secondary structure prediction on multi-core desktops</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="A1">
        <name>
          <surname>Swenson</surname>
          <given-names>M Shel</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>mswenson@math.gatech.edu</email>
      </contrib>
      <contrib contrib-type="author" id="A2">
        <name>
          <surname>Anderson</surname>
          <given-names>Joshua</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>janderson3@gatech.edu</email>
      </contrib>
      <contrib contrib-type="author" id="A3">
        <name>
          <surname>Ash</surname>
          <given-names>Andrew</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>andrew.ash@gatech.edu</email>
      </contrib>
      <contrib contrib-type="author" id="A4">
        <name>
          <surname>Gaurav</surname>
          <given-names>Prashant</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>pgaurav3@gatech.edu</email>
      </contrib>
      <contrib contrib-type="author" id="A5">
        <name>
          <surname>Sükösd</surname>
          <given-names>Zsuzsanna</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I3">3</xref>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>zs@mb.au.dk</email>
      </contrib>
      <contrib contrib-type="author" id="A6">
        <name>
          <surname>Bader</surname>
          <given-names>David A</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>bader@cc.gatech.edu</email>
      </contrib>
      <contrib contrib-type="author" id="A7">
        <name>
          <surname>Harvey</surname>
          <given-names>Stephen C</given-names>
        </name>
        <xref ref-type="aff" rid="I5">5</xref>
        <email>harvey@biology.gatech.edu</email>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="A8">
        <name>
          <surname>Heitsch</surname>
          <given-names>Christine E</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>heitsch@math.gatech.edu</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>School of Mathematics, Georgia Institute of Technology, Atlanta, GA, USA</aff>
    <aff id="I2"><label>2</label>College of Computing, Georgia Institute of Technology, Atlanta, GA, USA</aff>
    <aff id="I3"><label>3</label>Interdisciplinary Nanoscience Center, Aarhus University, Aarhus, Denmark</aff>
    <aff id="I4"><label>4</label>Department of Molecular Biology, Aarhus University, Aarhus, Denmark</aff>
    <aff id="I5"><label>5</label>School of Biology, Georgia Institute of Technology, Atlanta, GA, USA</aff>
    <pub-date pub-type="collection">
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>7</month>
      <year>2012</year>
    </pub-date>
    <volume>5</volume>
    <fpage>341</fpage>
    <lpage>341</lpage>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>2</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>6</month>
        <year>2012</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2012 Swenson et al.; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2012</copyright-year>
      <copyright-holder>Swenson et al.; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1756-0500"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Accurate and efficient RNA secondary structure prediction remains an important open problem in computational molecular biology. Historically, advances in computing technology have enabled faster and more accurate RNA secondary structure predictions. Previous parallelized prediction programs achieved significant improvements in runtime, but their implementations were not portable from niche high-performance computers or easily accessible to most RNA researchers. With the increasing prevalence of multi-core desktop machines, a new parallel prediction program is needed to take full advantage of today’s computing technology.</p>
      </sec>
      <sec>
        <title>Findings</title>
        <p>We present here the first implementation of RNA secondary structure prediction by thermodynamic optimization for modern multi-core computers. We show that GTfold predicts secondary structure in less time than UNAfold and RNAfold, without sacrificing accuracy, on machines with four or more cores.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>GTfold supports advances in RNA structural biology by reducing the timescales for secondary structure prediction. The difference will be particularly valuable to researchers working with lengthy RNA sequences, such as RNA viral genomes.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Findings</title>
    <p>Prediction algorithms based on thermodynamic models have been parallelized in the past, but for specific computer architectures that were available over two decades ago. The Vienna RNA package was originally parallelized [<xref ref-type="bibr" rid="B1">1</xref>] for a target architecture (an IBM RS/6000) popular in the early 1990’s. Subsequently [<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B3">3</xref>], this work was extended to a first-generation cluster-like parallel computer (the Intel Delta) with an early message-passing framework, which allows the processors to exchange only coarse-grained information. Similarly, other researchers [<xref ref-type="bibr" rid="B4">4</xref>] parallelized a minimal free energy (MFE) folding algorithm for two architectures (a Cray Y-MP vector machine and MasPar MP-2 SIMD mesh) popular through the 1990’s.</p>
    <p>Since then, parallel computing technology has changed substantially, and these previous parallel implementations are not compatible with current architectures. The current execution model includes multiple sockets of multi-core processors, deep memory hierarchies with several levels of cache, and the availability of gigabytes of memory. New parallel implementations are needed to take full advantage of these new platforms.</p>
    <p>We present the first implementation of RNA secondary structure prediction by thermodynamic optimization for modern multi-core computers. Our motivation is to reduce the prediction time for long RNA sequences on modern parallel platforms, including contemporary laptops and desktops, because sequential algorithms still take many minutes to produce a single MFE structure. With the increasing prevalence of multi-core desktop machines, reduction in runtime will be particularly valuable to researchers working with long RNA sequences, such as RNA viral genomes.</p>
    <p>We compare our program GTfold with two of the most widely-used sequential programs, UNAfold [<xref ref-type="bibr" rid="B5">5</xref>] and RNAfold [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B6">6</xref>] which also run on desktop machines. The purpose of our comparisons is to demonstrate to RNA researchers that GTfold’s runtime improvements are easily accessible from their desktop computer. Our program GTfold achieves the same minimum free energy (MFE) accuracy as UNAfold and RNAfold in appreciably less time on modern multi-core computers. With only four cores, GTfold folds an HIV genome, a sequence of nearly 10,000 nucleotides, in just 3.38 minutes versus the sequential running times of RNAfold (6.05 min.) and UNAfold (37.32 min.), a significant reduction in running time which further drops to below two minutes on eight or more cores.</p>
    <p>In addition to our findings on runtime and accuracy given below, we summarize the algorithmic and implementation differences between these three software packages. These findings explain why, though they are based on the same basic model, they often produce different MFE structures. This information clarifies why the “same” programs can produce different outcomes.</p>
    <sec>
      <title>Implementation</title>
      <p>Like UNAfold and RNAfold, we implement the classic dynamic programming algorithm for free energy minimization [<xref ref-type="bibr" rid="B7">7</xref>] based on the same general nearest neighbor thermodynamic model (NNTM) [<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B9">9</xref>]. The optimal solution for a given sequence, that is the MFE and associated secondary structure, is computed from optimal solutions for smaller subproblems. The algorithm first fills various one- and two-dimensional tables, whose entries correspond to the MFE scores for different subsequences. It then computes an optimal structure for the full sequence by performing a traceback through these tables. For detailed descriptions of the data dependencies among various elements of the tables and the algorithm in general, see [<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B10">10</xref>].</p>
      <p>In general, these dependencies leave open various options regarding the order in which the cells of the tables are calculated. As we will explain, the order used by GTfold is ideal for enabling a fine-grained parallelism well suited for multi-core and other shared memory parallel machines. However, when run sequentially on one core, this approach results in a larger number of memory accesses compared with the best sequential approach. Hence, it allows better concurrency on multi-core machines at the expense of single-core performance.</p>
      <p>More specifically, let <sub><italic>s</italic>1</sub><sub><italic>s</italic>2</sub>…<sub><italic>s</italic><italic>n</italic></sub>be an RNA sequence of length <italic>n</italic>. The MFE score of the sequence is computed by filling a 1×<italic>n</italic> array whose values depend on multiple <italic>n</italic>×<italic>n</italic> “helper” arrays which are themselves interdependent. The (<italic>i</italic>,<italic>j</italic>) entries of these helper arrays, where <italic>i</italic>&lt;<italic>j</italic>, holds the score of the minimum free energy structure for subsets of possible structures on the subsequence <sub><italic>s</italic><italic>i</italic></sub><sub><italic>s</italic><italic>i</italic> + 1</sub>…<sub><italic>s</italic><italic>j</italic></sub>.</p>
      <p>To describe the dependencies relevant to parallelization that govern the elements of these tables, it suffices to consider a single <italic>n</italic>×<italic>n</italic>matrix and assume, for the moment, that its entries hold the optimal score for the set of possible structures on the subsequence <sub><italic>s</italic><italic>i</italic></sub><sub><italic>s</italic><italic>i</italic> + 1</sub>…<sub><italic>s</italic><italic>j</italic></sub>. The standard assumption of nested base pairings (i.e. lack of pseudoknots) means that the optimal structure for <sub><italic>s</italic><italic>i</italic></sub><sub><italic>s</italic><italic>i</italic> + 1</sub>…<sub><italic>s</italic><italic>j</italic></sub> depends only on subsequences of the form <inline-formula><mml:math id="M1" name="1756-0500-5-341-i1" overflow="scroll"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>″</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>″</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>″</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula>, where <inline-formula><mml:math id="M2" name="1756-0500-5-341-i2" overflow="scroll"><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>″</mml:mi></mml:mrow></mml:msup><mml:mo>&lt;</mml:mo><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>″</mml:mi></mml:mrow></mml:msup><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:math></inline-formula>. Hence, as illustrated in Figure <xref ref-type="fig" rid="F1">1</xref>, the point (<italic>i</italic>,<italic>j</italic>) is dependent only on points <inline-formula><mml:math id="M3" name="1756-0500-5-341-i3" overflow="scroll"><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>″</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>″</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math></inline-formula> that are both below and to the left.</p>
      <fig id="F1" position="float">
        <label>Figure 1</label>
        <caption>
          <p><bold>Dependencies.</bold> Figure <xref ref-type="fig" rid="F1">1</xref> shows the dependencies in the dynamic programming algorithm. The (<italic>i</italic>,<italic>j</italic>) entry is dependent on the entries in the triangle (<italic>A</italic>,<italic>B</italic>,<italic>C</italic>).</p>
        </caption>
        <graphic xlink:href="1756-0500-5-341-1"/>
      </fig>
      <p>Consider computing the optimal score for subsequences of length <italic>k</italic>=<italic>j</italic>−<italic>i</italic> + 1 for some 1≤<italic>k</italic>≤<italic>n</italic>. Since these particular computations are independent of each other, they can be performed in parallel. As implemented in GTfold, the optimal structures for subsequences of length <italic>k</italic> are computed in parallel from <italic>k</italic>=1, the main diagonal, to <italic>k</italic>=<italic>n</italic>, the optimal score for the full sequence.</p>
      <p>Other orderings, such as column-wise or row-wise, also cover the whole computation space without violating the algorithm’s dependencies. For example, RNAfold computes the dynamic programming tables in row-major order, which is cache-friendly (for programs written in C/C++, like RNAfold) and has small average memory access time, but this approach is inherently sequential.</p>
      <p>We implement the shared memory parallelism necessary for our approach using OpenMP [<xref ref-type="bibr" rid="B11">11</xref>] (see Availability and requirements for details). Using OpenMP allows all threads to access and to update values in a single set of arrays.</p>
      <p>As described above, our parallel implementation exploits a diagonal access of table entries, allowing for concurrent computation via fine-grained parallelism but incurring more cache misses (and hence, a larger average memory access time). As is often necessary when engineering parallel algorithms [<xref ref-type="bibr" rid="B12">12</xref>], we accept slower single processor performance, so that our code will run faster on the multi-processor machines that are becoming ubiquitous. Further implementation details can be found in Mathuriya et. al 2009 [<xref ref-type="bibr" rid="B13">13</xref>].</p>
    </sec>
    <sec>
      <title>Running time</title>
      <p>The results shown here and in the rest of this section are based on GTfold (version 2.0), RNAfold distributed with the Vienna package (version 1.8.5), and UNAfold (version 3.8). When discussing running time, the number of cores is a parameter for a parallel algorithm so we refer to GTfold on <italic>n</italic> cores as GTfold(<italic>n</italic>). Running time comparisons are based on a complete HIV-1 genome [GenBank:K03454] of length 9,719 nucleotides. Further details on materials and methods, including command line arguments and computing architectures, are provided in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Appendix 1. (Recall that previous parallelized prediction programs do not run on modern multi-core machines. Because our primary interest was to evaluate the performance of GTfold on these current architectures, we did not include these previous parallelized programs in our study.)</p>
      <p>Our running time results for UNAfold and RNAfold versus GTfold(<italic>n</italic>) on <italic>n</italic>=1,2,4,8,16 cores are given in Figure <xref ref-type="fig" rid="F2">2</xref>. Each program predicted an MFE structure (and only that) for the HIV-1 genome, and MFE calculations also on a set of 22 complete HIV genomes of similar length (accession numbers given in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Appendix 1). We also document how the runtime scales with respect to length up to that point by graphing prediction times for different length subsequences of the HIV-1 genome.</p>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p><bold>Running time vs. sequence length.</bold> Figure <xref ref-type="fig" rid="F2">2</xref> shows the effect of sequence length on the running time of GTfold (run using 1, 2, 4, 8, and 16 cores), RNAfold, and UNAfold.</p>
        </caption>
        <graphic xlink:href="1756-0500-5-341-2"/>
      </fig>
      <p>We see that GTfold(<italic>n</italic>) is always faster than UNAfold, and significantly so for the full genome, which UNAfold computes in 37 minutes versus 3.38 minutes for GTfold(4). The relative running time of GTfold versus RNAfold depends on the number of cores used by GTfold. RNAfold computes an MFE structure for the full genome in 6.06 minutes while the running times for GTfold(<italic>n</italic>) are 12.44, 6.64, 3.38, 1.89, and 1.54 minutes respectively for <italic>n</italic>=1,2,4,8,16 cores. Hence, GTfold(1) is slower than RNAfold while the running time of GTfold(2) and RNAfold are similar (to within 10%), and GTfold on four or more cores runs in strictly less time than RNAfold.</p>
      <p>The reproducibility of these times was confirmed by comparing UNAfold, RNAfold, and GTfold(<italic>n</italic>) (for <italic>n</italic>=1,2,4,8,16), across the full set of 22 HIV genomes (data not shown).</p>
    </sec>
    <sec>
      <title>Accuracy</title>
      <p>We also demonstrate that GTfold’s reduced running time does not come at the expense of prediction accuracy, relative to UNAfold and RNAfold, as measured against ribosomal structures obtained by comparative sequence analysis [<xref ref-type="bibr" rid="B14">14</xref>]. We find no meaningful differences in the average prediction accuracy, which is only around 40%, of all three programs across hundreds of ribosomal sequences. This confirms that in general GTfold predicts optimal structures as accurately as UNAfold and RNAfold, while simultaneously illustrating the importance of ongoing efforts to improve RNA secondary structure prediction.</p>
      <p>Since GTfold(<italic>n</italic>) always returns the same structure, we do not specify the number of cores when discussing accuracy. The reference secondary structures for 223 16S and 55 23S ribosomal sequences were downloaded from the Comparative RNA Web site [<xref ref-type="bibr" rid="B15">15</xref>] (database queries given in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Appendix 1).</p>
      <p>Our prediction accuracy results for UNAfold and RNAfold versus GTfold are given in Figure <xref ref-type="fig" rid="F3">3</xref>. We assess prediction accuracy against the structures for ribosomal sequences from the Comparative RNA Web site [<xref ref-type="bibr" rid="B15">15</xref>] using the two measures of <italic>sensitivity</italic> and <italic>selectivity</italic> as in [<xref ref-type="bibr" rid="B16">16</xref>]. These values are calculated based on counting base pairs in the two structures in one of three categories. True positives (<italic>TP</italic>) occur in both the comparative and predicted structure, false negatives (<italic>FN</italic>) occur only in the comparative structure, while false positives (<italic>FP</italic>) occur only in the predicted structure. Gardner &amp; Giegerich further subdivide the <italic>FP</italic> category to account for <italic>compatible</italic> base pairs, denoted <italic>ξ</italic>, that could exist in the comparative structure and hence “can be considered neutral with respect to algorithm accuracy.” Thus, </p>
      <p>
        <disp-formula>
          <mml:math id="M4" name="1756-0500-5-341-i4" overflow="scroll">
            <mml:mrow>
              <mml:mtable>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mtext>Sensitivity</mml:mtext>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mtext>TP</mml:mtext>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext>TP</mml:mtext>
                        <mml:mo>+</mml:mo>
                        <mml:mtext>FN</mml:mtext>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mtext>Selectivity</mml:mtext>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mtext>TP</mml:mtext>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext>TP</mml:mtext>
                        <mml:mo>+</mml:mo>
                        <mml:mo>(</mml:mo>
                        <mml:mtext>FP</mml:mtext>
                        <mml:mo>−</mml:mo>
                        <mml:mi>ξ</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <fig id="F3" position="float">
        <label>Figure 3</label>
        <caption>
          <p><bold>Sensitivity vs. selectivity.</bold> Figure <xref ref-type="fig" rid="F3">3</xref> plots selectivity against sensitivity for GTfold, RNAfold, and UNAfold on 223 16S sequences and for 55 23S sequences. The gray circles are (selectivity, sensitivity) pairs for an individual sequence, while the black dot shows the (average selectivity, average sensitivity) for a given method on a given class of sequences.</p>
        </caption>
        <graphic xlink:href="1756-0500-5-341-3"/>
      </fig>
      <p>We find that all three programs produce structures with a wide range of sensitivity and selectivity values, with nearly indistinguishable distributions of accuracy. Each program has an average of only ∼40<italic>%</italic> for the 223 16S ribosomal sequences and the 55 23S ones. Given the high variance within programs (from a low of ∼10<italic>%</italic> to a high of ∼80<italic>%</italic>) versus the low variance between programs (less than 2% average difference), we find no meaningful difference in the accuracy of MFE predictions for GTfold versus UNAfold or RNAfold. (Further details are given in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>: Appendix 2.) This is certainly not to say that the three programs always predict the same optimal structure, in fact our experience indicates that the opposite is often true (particularly for UNAfold). As discussed below, this is a result of the subtle but crucial differences in the optimization criteria used by the different programs.</p>
    </sec>
    <sec>
      <title>Differences between programs</title>
      <p>Finally, we address the fact that these three programs, which all implement the same basic algorithm using the same general NNTM, rarely return the same MFE structure — and in some cases return very different structures. This is due to the small but crucial differences in the thermodynamic and algorithmic details between GTfold, RNAfold, and UNAfold. The lack of robustness, or “ill-conditioning,” is a well-known aspect [<xref ref-type="bibr" rid="B17">17</xref>] of this particular optimization problem; slight changes in the optimization criteria can result in drastically different MFE structures.</p>
      <p>Our analysis of GTfold’s accuracy versus RNAfold or UNAfold necessitated a detailed comparison of the different optimization criteria of the three programs. Hence, here we summarize the details that currently result in different optimal structures while noting that these differences do not have a significant effect on prediction accuracy between programs. This information should be useful to other researchers who also find the different outcomes for these “same” programs perplexing.</p>
      <p>The optimality criteria of GTfold and RNAfold differ simply in their thermodynamic parameter values, specifically for some special cases of internal, bulge and hairpin loops and in the number of significant digits used in the entropic penalty assigned to different lengths of internal, bulge, and hairpin loops. To address this difference, GTfold includes a <monospace>--rnafold</monospace> option, which uses the RNAfold parameters. We have confirmed that under this option GTfold predicts the same MFE structures as RNAfold on all of our 16S and 23S sequences and on a set of 500 randomly generated sequences of length 1500.</p>
      <p>The optimality criteria of GTfold and UNAfold differ in a number of ways. Again, there are differences in the thermodynamic parameters, but there are now also algorithmic differences, which effect the treatment of all types of loops as well as the stacked pairs. The most notable parameter differences are the treatment of G-U pairs in stacks and small symmetric internal loops. The parameters used by UNAfold differ from the Nearest Neighbor Database (NNDB) [<xref ref-type="bibr" rid="B18">18</xref>] values in that various substructures involving G-U pairs are assigned “infinite” energy. According to the UNAfold FAQ [<xref ref-type="bibr" rid="B19">19</xref>], these are instead treated as 1×1 and 2×2 internal loops, which are intended to be interpreted as base pairs. Nonetheless, it is our experience that this difference alters the optimization in small but significant ways. The algorithmic differences are four-fold: </p>
      <p> 1. UNAfold handles 2×3 internal loops as a special case.</p>
      <p> 2. UNAfold considers terminal mismatches in multi-loops and external loops while GTfold instead considers pairs of 3’ and 5’ dangling ends.</p>
      <p> 3. UNAfold performs a pre-filtering that prohibits from consideration base pairs without at least one possible neighboring pair.</p>
      <p> 4. UNAfold and GTfold can take different traceback paths producing different optimal structures with the same MFE.</p>
      <p>To address the parameter differences and the first three algorithmic differences, GTfold has a <monospace>--unafold</monospace> option. We have confirmed that under this option GTfold predicts a structure with the same MFE as UNAfold on all of our 16S and 23S sequences and on set of 500 randomly generated sequences of length 1500. We note that, due to differences in traceback, GTfold with this option does not always produce a structure identical to UNAfold despite obtaining the same minimum free energy.</p>
    </sec>
    <sec>
      <title>User Options</title>
      <p>In addition to basic MFE calculation, GTfold has a number of user options. One set of options controls what information is calculated and the level of detail in the output. As is now standard, in addition to the MFE value and optimal structure, GTfold can provide a loop-by-loop energy decomposition, suboptimal structures [<xref ref-type="bibr" rid="B20">20</xref>] within a specified range of the MFE, and base pair probabilities via the partition function. Ongoing feature development includes performing stochastic backtracking to produce sets of structures sampled according to the Boltzmann distribution [<xref ref-type="bibr" rid="B21">21</xref>].</p>
      <p>Additionally, GTfold provides several options for modifying the optimization criterion used. As with other programs, users can provide their own parameter sets for the NNTM, change the calculation of energies associated with the ends of helices in multi-loops and external loops (treatment of dangling end energies and terminal mismatches), or constrain GTfold to consider only structures that contain (or that do not contain) particular base pairs or single stranded regions. It is also possible to provide experimental data from “SHAPE” experiments (Selective 2’-Hydroxyl Acylation analyzed by Primer Extension [<xref ref-type="bibr" rid="B22">22</xref>]), to be used in the MFE optimization.</p>
      <p>Finally, GTfold supports the <monospace>--unafold</monospace> and <monospace>--rnafold</monospace> options, under which it uses the same optimization criteria as UNAfold or as RNAfold, while still achieving the same running time advantages when multiple cores are available.</p>
    </sec>
  </sec>
  <sec>
    <title>Availability and requirements</title>
    <p>GTfold is freely available as open source at gtfold.sourceforge.net. Support for parallel threads requires OpenMP (which is part of current standard C compiler packages, such as GCC). We implemented shared memory parallelism using the “omp for” directive of the OpenMP[<xref ref-type="bibr" rid="B11">11</xref>] interface, version 3.0 (with GCC version 4.4). Further instructions, documentation, and details on requirements are specified on the GTfold sourceforge website. </p>
    <p>• Project name: GTfold</p>
    <p>• Project home page: <ext-link ext-link-type="uri" xlink:href="http://gtfold.sourceforge.net/">http://gtfold.sourceforge.net/</ext-link></p>
    <p>• Operating systems: Unix, Linux, Mac OS X</p>
    <p>• Programming language: C/C++</p>
    <p>• Other requirements: C/C++ compiler; standard UNIX tools such as autoconf, automake, make; OpenMP support in the compiler</p>
    <p>• License: GNU GPL v3</p>
    <p>• Any restrictions to use by non-academics: None</p>
  </sec>
  <sec>
    <title>Availability of supporting data</title>
    <p>Additional details on the sequences, software, commands, and machines used in the accuracy and running time analyses are available in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Appendix 1. Additional file 2: Appendix 2 provides a more detailed analysis of the relative accuracy of the three prediction methods.</p>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec>
    <title>Authors contributions</title>
    <p>Current version of GTfold code was written by DAB, JA, AA, PG, and ZS under the supervision of MSS, DAB, and CEH, and optimized by DAB. Numerical data was generated by PG and MSS. Paper was written by MSS and CEH, with contributions from DAB and ZS. All authors read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p><bold>Appendix 1</bold>Materials and Methods. Appendix 1 gives additional details on the sequences, software, commands, and machines used in the accuracy and running time analyses.</p>
      </caption>
      <media xlink:href="1756-0500-5-341-S1.pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional file 2</title>
        <p><bold>Appendix 2</bold>Accuracy Comparison. Appendix 2 gives a more detailed analysis of the relative accuracy of the three prediction methods.</p>
      </caption>
      <media xlink:href="1756-0500-5-341-S2.pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>The authors thank previous students (in chronological order) for their significant contributions to the GTfold program development: Gregory Nou, Sonny Hernandez, Amrita Mathuriya, Sainath Mallidi, Neha Jatav, and Manoj Soni. MSS, PG, ZS, DAB, SCH, and CEH were supported by National Institutes of Health grant NIH NIGMS R01 GM083621. Additionally, MSS is supported in part by the Georgia Institute of Technology School of Mathematics, ZS acknowledges support from the Danish Agency for Science, Technology, and Innovation under grant #09-061856 and a travel grant from the Aarhus University Research Foundation, DAB is supported in part by NSF Grants CNS-0614915 and OCI-0904461, and research of CEH is supported in part by a Career Award at the Scientific Interface (CASI) from the Burroughs Wellcome Fund (BWF).</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hofacker</surname>
          <given-names>IL</given-names>
        </name>
        <name>
          <surname>Fontana</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Stadler</surname>
          <given-names>PF</given-names>
        </name>
        <name>
          <surname>Bonhoeffer</surname>
          <given-names>LS</given-names>
        </name>
        <name>
          <surname>Tacker</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Schuster</surname>
          <given-names>P</given-names>
        </name>
        <article-title>Fast folding and comparison of RNA secondary structures</article-title>
        <source>Monatsh Chem</source>
        <year>1994</year>
        <volume>125</volume>
        <issue>2</issue>
        <fpage>167</fpage>
        <lpage>188</lpage>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="book">
        <name>
          <surname>Hofacker</surname>
          <given-names>IL</given-names>
        </name>
        <name>
          <surname>Huynen</surname>
          <given-names>MA</given-names>
        </name>
        <name>
          <surname>Stadler</surname>
          <given-names>PF</given-names>
        </name>
        <name>
          <surname>Stolorz</surname>
          <given-names>PE</given-names>
        </name>
        <article-title>Knowledge Discovery in RNA, Sequence Families of HIV using scalable computers</article-title>
        <source>Proc. of the 2nd Int’l Conf. on Knowledge Discovery and Data Mining</source>
        <year>1996</year>
        <publisher-name>Portland, OR</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Fekete</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Hofacker</surname>
          <given-names>IL</given-names>
        </name>
        <name>
          <surname>Stadler</surname>
          <given-names>PF</given-names>
        </name>
        <article-title>Prediction of RNA Base Pairing Probabilities on Massively Parallel Computers</article-title>
        <source>J Computational Biology</source>
        <year>2000</year>
        <volume>7</volume>
        <issue>1-2</issue>
        <fpage>171</fpage>
        <lpage>182</lpage>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Chen</surname>
          <given-names>JH</given-names>
        </name>
        <name>
          <surname>Le</surname>
          <given-names>SY</given-names>
        </name>
        <name>
          <surname>Shapiro</surname>
          <given-names>BA</given-names>
        </name>
        <name>
          <surname>Maizel</surname>
          <given-names>JV</given-names>
        </name>
        <article-title>Optimization of an RNA folding algorithm for parallel architectures</article-title>
        <source>Parallel Computing</source>
        <year>1998</year>
        <volume>24</volume>
        <fpage>1617</fpage>
        <lpage>1634</lpage>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="book">
        <name>
          <surname>Markham</surname>
          <given-names>NR</given-names>
        </name>
        <name>
          <surname>Zuker</surname>
          <given-names>M</given-names>
        </name>
        <person-group person-group-type="editor">Keith JM</person-group>
        <article-title>UNAFold: Software for Nucleic Acid Folding and Hybridization</article-title>
        <source>Bioinformatics: Structure, Function, and Applications, Volume 453 of Methods in Molecular Biology</source>
        <year>2008</year>
        <publisher-name>Totowa, NJ: Humana Press</publisher-name>
        <fpage>3</fpage>
        <lpage>31</lpage>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hofacker</surname>
          <given-names>IL</given-names>
        </name>
        <name>
          <surname>Stadler</surname>
          <given-names>PF</given-names>
        </name>
        <article-title>Memory Efficient Folding Algorithms for Circular RNA Secondary Structures</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <issue>10</issue>
        <fpage>1172</fpage>
        <lpage>1176</lpage>
        <pub-id pub-id-type="pmid">16452114</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Zuker</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Stiegler</surname>
          <given-names>P</given-names>
        </name>
        <article-title>Optimal computer folding of large RNA sequences using thermodynamics and auxiliary information</article-title>
        <source>Nucleic Acids Res</source>
        <year>1981</year>
        <volume>9</volume>
        <fpage>133</fpage>
        <lpage>148</lpage>
        <pub-id pub-id-type="pmid">6163133</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Mathews</surname>
          <given-names>DH</given-names>
        </name>
        <name>
          <surname>Sabina</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Zuker</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Turner</surname>
          <given-names>DH</given-names>
        </name>
        <article-title>Expanded sequence dependence of thermodynamic parameters improves prediction of RNA secondary structure</article-title>
        <source>J Mol Biol</source>
        <year>1999</year>
        <volume>288</volume>
        <issue>5</issue>
        <fpage>911</fpage>
        <lpage>940</lpage>
        <pub-id pub-id-type="pmid">10329189</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Mathews</surname>
          <given-names>DH</given-names>
        </name>
        <name>
          <surname>Disney</surname>
          <given-names>MD</given-names>
        </name>
        <name>
          <surname>Childs</surname>
          <given-names>JL</given-names>
        </name>
        <name>
          <surname>Schroeder</surname>
          <given-names>SJ</given-names>
        </name>
        <name>
          <surname>Zuker</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Turner</surname>
          <given-names>DH</given-names>
        </name>
        <article-title>Incorporating chemical modification constraints into a dynamic programming algorithm for prediction of RNA secondary structure</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2004</year>
        <volume>101</volume>
        <issue>19</issue>
        <fpage>7287</fpage>
        <lpage>7292</lpage>
        <pub-id pub-id-type="pmid">15123812</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="book">
        <name>
          <surname>Lyngsø</surname>
          <given-names>RB</given-names>
        </name>
        <name>
          <surname>Zuker</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Pedersen</surname>
          <given-names>CNS</given-names>
        </name>
        <article-title>Internal loops in RNA, secondary structure prediction</article-title>
        <source>Proc. of the 3rd Ann. Int’l Conf. on Computational Molecular Biology (RECOMB)</source>
        <year>1999</year>
        <publisher-name>Lyon, France</publisher-name>
        <fpage>260</fpage>
        <lpage>267</lpage>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="other">
        <collab>OpenMP Architecture Review Board</collab>
        <article-title>OpenMP Application Program Interface Version 3.1.</article-title>
        <year>2011</year>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="book">
        <name>
          <surname>Bader</surname>
          <given-names>DA</given-names>
        </name>
        <name>
          <surname>Moret</surname>
          <given-names>BME</given-names>
        </name>
        <name>
          <surname>Sanders</surname>
          <given-names>P</given-names>
        </name>
        <person-group person-group-type="editor">Fleischer R</person-group>
        <article-title>Algorithm Engineering for Parallel Computation</article-title>
        <source>Experimental Algorithmics, LNCS</source>
        <year>2002</year>
        <publisher-name>Berlin Heidelberg: Springer-Verlag</publisher-name>
        <fpage>1</fpage>
        <lpage>23</lpage>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="book">
        <name>
          <surname>Mathuriya</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Bader</surname>
          <given-names>DA</given-names>
        </name>
        <name>
          <surname>Heitsch</surname>
          <given-names>CE</given-names>
        </name>
        <name>
          <surname>Harvey</surname>
          <given-names>SC</given-names>
        </name>
        <article-title>GTfold: A Scalable Multicore Code for RNA, Secondary Structure Prediction</article-title>
        <source>Proceedings of the 24th Annual ACM Symposium on Applied Computing (SAC), Computational Sciences Track</source>
        <year>2009</year>
        <publisher-name>Honolulu, HI</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Gutell</surname>
          <given-names>RR</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>JC</given-names>
        </name>
        <name>
          <surname>Cannone</surname>
          <given-names>JJ</given-names>
        </name>
        <article-title>The accuracy of ribosomal RNA,comparative structure models</article-title>
        <source>Curr Opin Struct Biol</source>
        <year>2002</year>
        <volume>12</volume>
        <issue>3</issue>
        <fpage>301</fpage>
        <lpage>310</lpage>
        <pub-id pub-id-type="pmid">12127448</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Cannone</surname>
          <given-names>JJ</given-names>
        </name>
        <name>
          <surname>Subramanian</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Schnare</surname>
          <given-names>MN</given-names>
        </name>
        <name>
          <surname>Collett</surname>
          <given-names>JR</given-names>
        </name>
        <name>
          <surname>D’Souza</surname>
          <given-names>LM</given-names>
        </name>
        <name>
          <surname>Du</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Feng</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Lin</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Madabusi</surname>
          <given-names>LV</given-names>
        </name>
        <name>
          <surname>Müller</surname>
          <given-names>KM</given-names>
        </name>
        <name>
          <surname>Pande</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Shang</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Yu</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Gutell</surname>
          <given-names>RR</given-names>
        </name>
        <article-title>The Comparative RNA, Web (CRW) Site: an online database of comparative sequence and structure information for ribosomal, intron, and other RNAs</article-title>
        <source>BMC Bioinformatics</source>
        <year>2002</year>
        <volume>3</volume>
        <issue>2</issue>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Gardner</surname>
          <given-names>PP</given-names>
        </name>
        <name>
          <surname>Giegerich</surname>
          <given-names>R</given-names>
        </name>
        <article-title>A comprehensive comparison of comparative RNA, structure prediction approaches</article-title>
        <source>BMC Bioinformatics</source>
        <year>2004</year>
        <volume>5</volume>
        <issue>140</issue>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="book">
        <name>
          <surname>Zuker</surname>
          <given-names>M</given-names>
        </name>
        <article-title>RNA folding prediction: the continued need for interaction between biologists and mathematicians</article-title>
        <source>Some mathematical questions in biology—DNA sequence analysis (New York, 1984), Volume 17 of Lectures Math. Life Sci</source>
        <year>1986</year>
        <publisher-name>Providence RI: Amer. Math. Soc</publisher-name>
        <fpage>87</fpage>
        <lpage>124</lpage>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Turner</surname>
          <given-names>DH</given-names>
        </name>
        <name>
          <surname>Mathews</surname>
          <given-names>DH</given-names>
        </name>
        <article-title>NNDB: the nearest neighbor parameter database for predicting stability of nucleic acid secondary structure</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <volume>38 Database</volume>
        <fpage>D280</fpage>
        <lpage>2</lpage>
        <pub-id pub-id-type="pmid">19880381</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="other">
        <name>
          <surname>Zuker</surname>
          <given-names>M</given-names>
        </name>
        <article-title>FAQs for mfold computations.</article-title>
        <year>2006</year>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wuchty</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Fontana</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Hofacker</surname>
          <given-names>IL</given-names>
        </name>
        <name>
          <surname>Schuster</surname>
          <given-names>P</given-names>
        </name>
        <article-title>Complete suboptimal folding of RNA and the stability of secondary structures</article-title>
        <source>Biopolymers</source>
        <year>1999</year>
        <volume>49</volume>
        <issue>2</issue>
        <fpage>145</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="pmid">10070264</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>McCaskill</surname>
          <given-names>JS</given-names>
        </name>
        <article-title>The equilibrium partition function and base pair binding probabilities for RNA,secondary structure</article-title>
        <source>Biopolymers</source>
        <year>1990</year>
        <volume>29</volume>
        <issue>6-7</issue>
        <fpage>1105</fpage>
        <lpage>19</lpage>
        <pub-id pub-id-type="pmid">1695107</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Deigan</surname>
          <given-names>KE</given-names>
        </name>
        <name>
          <surname>Lia</surname>
          <given-names>TW</given-names>
        </name>
        <name>
          <surname>Mathews</surname>
          <given-names>DH</given-names>
        </name>
        <name>
          <surname>Weeks</surname>
          <given-names>KM</given-names>
        </name>
        <article-title>Accurate SHAPE-directed RNA structure determination</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2009</year>
        <volume>106</volume>
        <fpage>97</fpage>
        <lpage>102</lpage>
        <pub-id pub-id-type="pmid">19109441</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
