<?properties open_access?>
<?subarticle report12383?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v3.0 20080202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing3.dtd?>
<?SourceDTD.Version 3.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">F1000Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">F1000Res</journal-id>
    <journal-id journal-id-type="pmc">F1000Research</journal-id>
    <journal-title-group>
      <journal-title>F1000Research</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2046-1402</issn>
    <publisher>
      <publisher-name>F1000Research</publisher-name>
      <publisher-loc>London, UK</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4765721</article-id>
    <article-id pub-id-type="pmid">26962434</article-id>
    <article-id pub-id-type="doi">10.12688/f1000research.7453.1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software Tool Article</subject>
      </subj-group>
      <subj-group>
        <subject>Articles</subject>
        <subj-group>
          <subject>Bioinformatics</subject>
        </subj-group>
        <subj-group>
          <subject>Genomics</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>Crambled: </italic>A Shiny application to enable intuitive resolution of conflicting cellularity estimates</article-title>
      <fn-group content-type="pub-status">
        <fn>
          <p>[version 1; referees: 2 approved]</p>
        </fn>
      </fn-group>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lynch</surname>
          <given-names>Andy</given-names>
        </name>
        <xref ref-type="corresp" rid="c1">a</xref>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <aff id="a1"><label>1</label>Cancer Research UK Cambridge Institute, University of Cambridge, Cambridge, UK</aff>
    </contrib-group>
    <author-notes>
      <corresp id="c1">
        <label>a</label>
        <email xlink:href="mailto:andy.lynch@cruk.cam.ac.uk">andy.lynch@cruk.cam.ac.uk</email>
      </corresp>
      <fn fn-type="con">
        <p>AGL conceived and conducted this research.</p>
      </fn>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>7</day>
      <month>12</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2015</year>
    </pub-date>
    <volume>4</volume>
    <elocation-id>1407</elocation-id>
    <history>
      <date date-type="accepted">
        <day>30</day>
        <month>11</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright: © 2015 Lynch A</copyright-statement>
      <copyright-year>2015</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:type="simple" xlink:href="f1000research-4-8030.pdf"/>
    <abstract>
      <p>It is now commonplace to investigate tumour samples using whole-genome sequencing, and some commonly performed tasks are the estimation of cellularity (or sample purity), the genome-wide profiling of copy numbers, and the assessment of sub-clonal behaviours. Several tools are available to undertake these tasks, but often give conflicting results – not least because there is often genuine uncertainty due to a lack of model identifiability. </p>
      <p>Presented here is a tool, "Crambled", that allows for an intuitive visual comparison of the conflicting solutions. Crambled is implemented as a Shiny application within R, and is accompanied by example images from two use cases (one tumour sample with matched normal sequencing, and one standalone cell line example) as well as functions to generate the necessary images from any sequencing data set. </p>
      <p>Through the use of Crambled, a user may gain insight into why each tool has offered its given solution and combined with a knowledge of the disease being studied can choose between the competing solutions in an informed manner.</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>Cancer</kwd>
      <kwd>Whole-genome sequencing</kwd>
      <kwd>Cellularity</kwd>
      <kwd>Copy number</kwd>
      <kwd>Sub-clonality</kwd>
      <kwd>Cell lines</kwd>
      <kwd>Shiny</kwd>
      <kwd>R</kwd>
      <kwd>Bioconductor</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="fund-1">
        <funding-source>Cancer Research UK</funding-source>
        <award-id>C14303/A20406</award-id>
      </award-group>
      <award-group id="fund-2">
        <funding-source>Horizon 2020 project SOUND</funding-source>
        <award-id>633974</award-id>
      </award-group>
      <funding-statement>AGL is supported by a Cancer Research UK programme grant (C14303/A20406) to Simon Tavaré and additionally acknowledges funding from the European Commission through the Horizon 2020 project SOUND (Grant Agreement no. 633974).</funding-statement>
      <funding-statement>
        <italic>I confirm that the funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</italic>
      </funding-statement>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>The generation of whole-genome sequencing data to investigate tumour samples has become commonplace, thanks in particular to initiatives such as the International Cancer Genome Consortium (ICGC)
<sup><xref rid="ref-1" ref-type="bibr">1</xref></sup>. Among the analyses being applied to the data generated are investigations of copy number changes
<sup><xref rid="ref-2" ref-type="bibr">2</xref></sup>, structural variants
<sup><xref rid="ref-3" ref-type="bibr">3</xref></sup>, and sub-clonality
<sup><xref rid="ref-4" ref-type="bibr">4</xref></sup>. These analyses typically require the establishment of segmented copy number profiles for the sample, which in turn rely on estimating the degree of contamination of normal tissue in a sample and the mean ploidy (equivalently the depth of coverage associated with a particular copy number state or the increase in depth associated with an increment in copy number).</p>
    <p>Many tools have been developed that allow for the estimation of one or more of sample purity, copy number profile and clonality. These include e.g. ABSOLUTE (
<ext-link ext-link-type="uri" xlink:href="http://www.broadinstitute.org/cancer/cga/absolute">www.broadinstitute.org/cancer/cga/absolute</ext-link>)
<sup><xref rid="ref-5" ref-type="bibr">5</xref></sup>, ASCAT (
<ext-link ext-link-type="uri" xlink:href="http://heim.ifi.uio.no/bioinf/Projects/ASCAT">heim.ifi.uio.no/bioinf/Projects/ASCAT</ext-link>)
<sup><xref rid="ref-6" ref-type="bibr">6</xref></sup>, CloneHD (
<ext-link ext-link-type="uri" xlink:href="http://github.com/andrej-fischer/cloneHD">github.com/andrej-fischer/cloneHD</ext-link>)
<sup><xref rid="ref-7" ref-type="bibr">7</xref></sup>, OncoSNP-SEQ (
<ext-link ext-link-type="uri" xlink:href="http://sites.google.com/site/oncosnpseq/">sites.google.com/site/oncosnpseq/</ext-link>)
<sup><xref rid="ref-8" ref-type="bibr">8</xref></sup> and QPure (
<ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/qpure/">sourceforge.net/projects/qpure/</ext-link>)
<sup><xref rid="ref-9" ref-type="bibr">9</xref></sup> (for a more complete review see Yadav and De.
<sup><xref rid="ref-10" ref-type="bibr">10</xref></sup>). There are real problems of model identifiability in performing this task, particularly when sub-clonal solutions are allowed, as any errors or discrepancies in the purity, segmentation or identification of mean ploidy can often be explained as sub-clonal behaviour (many of the issues are discussed in Lonnstedt
<italic>et al.</italic>
<sup><xref rid="ref-11" ref-type="bibr">11</xref></sup>). Indeed, many tools acknowledge the inherent uncertainty in the calculations. As a consequence, applying two tools to a data set may return two conflicting solutions.</p>
    <p>Contrasting this problem with another common analysis applied to whole-genome cancer sequencing data, that of identifying somatic single nucleotide variants and indels then there is one striking difference: SNV calls can be easily validated. This can be via a targeted experimental approach, or increasingly commonly through visual assessment using a tool such as the Integrative Genomics Viewer
<sup><xref rid="ref-12" ref-type="bibr">12</xref></sup>.</p>
    <p>Herein is presented the
<italic>Crambled</italic> tool to enable the visual assessment of the alternative purity/depth-of-sequencing solutions that can arise for a tumour sample. Through exploration of the solutions using
<italic>Crambled</italic> one may achieve an appreciation of the reasons for each to have been offered. Coupled with knowledge of the tumour type, and the case history and pathology of the particular patient under examination, it may be possible to then select a preferred solution.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Implementation</title>
      <p><bold><italic>Overview</italic>.</bold> The
<italic>Crambled</italic> tool is implemented as a Shiny
<sup><xref rid="ref-13" ref-type="bibr">13</xref></sup> application in R
<sup><xref rid="ref-14" ref-type="bibr">14</xref></sup>. In essence it takes in a figure depicting the sequencing data (akin to a patchwork plot
<sup><xref rid="ref-15" ref-type="bibr">15</xref></sup> or grid plot
<sup><xref rid="ref-11" ref-type="bibr">11</xref></sup>), constructs a second figure based on a solution for the cellularity/depth conditions, and displays them in a superimposed manner. By allowing for a dynamic adjustment of the cellularity/depth solution being considered,
<italic>Crambled</italic> enables an intuitive comparison of competing solutions and a tactile exploration of the solution space that provides insight into why different tools offer different solutions and informs the user in choosing between them.</p>
      <p>The
<italic>Crambled</italic> tool is divided into two sections as depicted in
<xref ref-type="fig" rid="f1">Figure 1</xref>, nominally a ‘client’ side and a ‘server’ side, to avoid having to upload across a network the large BAM files that contain the genome sequencing data.</p>
      <fig fig-type="figure" id="f1" orientation="portrait" position="float">
        <label>Figure 1. </label>
        <caption>
          <title>A schematic of the operation of the
<italic>Crambled</italic> tool.</title>
          <p>Tasks are divided between those on the ‘client’ side (that aim to reduce the size of the data that need to be transferred) and the main application on the ‘server’ side (where the cellularity/depth solutions can be investigated).</p>
        </caption>
        <graphic xlink:href="f1000research-4-8030-g0000"/>
      </fig>
      <p>Even when both ‘client’ and ‘server’ sides are run on the same machine, as is envisaged for a typical user, there are clear benefits to the division of labours. The initial data processing is an expensive operation and should only be performed once, with the output stored for potential repeated and spontaneous investigations in the future.</p>
      <p><bold><italic>‘Server’-side tools</italic>.</bold> The
<italic>Crambled</italic> application consists primarily of a dialogue box for selecting an image representing a sequencing experiment, two sliders for specifying cellularity and the depth of a single copy (that is the depth associated with a single copy present in all cells in a sample or, equivalently, half of the depth of coverage in diploid regions), and a display that dynamically updates the selected image with superimposed predictions based on the chosen values.</p>
      <p>The display figure is generated by first writing out the predictions to a temporary image before the two image files are combined. For two values, cellularity (
<italic>C</italic>) and single-copy depth (
<italic>D</italic>), the initial predictions for a region with
<italic>n</italic>
<sub>1</sub> copies of one allele and
<italic>n</italic>
<sub>2</sub> copies of the second are:</p>
      <p>
        <disp-formula id="e1">
          <mml:math id="math1">
            <mml:mrow>
              <mml:mtext>Depth</mml:mtext>
              <mml:mo>=</mml:mo>
              <mml:mi>D</mml:mi>
              <mml:mo>×</mml:mo>
              <mml:mrow>
                <mml:mo>[</mml:mo>
                <mml:mrow>
                  <mml:mn>2</mml:mn>
                  <mml:mo>×</mml:mo>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mo>−</mml:mo>
                      <mml:mi>C</mml:mi>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>n</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                      <mml:mo>+</mml:mo>
                      <mml:msub>
                        <mml:mi>n</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>×</mml:mo>
                  <mml:mi>C</mml:mi>
                </mml:mrow>
                <mml:mo>]</mml:mo>
              </mml:mrow>
              <mml:mspace width="4em"/>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mn>1</mml:mn>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>and</p>
      <p>
        <disp-formula id="e2">
          <mml:math id="math2">
            <mml:mrow>
              <mml:mtext>Minor allele fraction</mml:mtext>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mn>1</mml:mn>
                  <mml:mo>+</mml:mo>
                  <mml:mi>C</mml:mi>
                  <mml:mo>×</mml:mo>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>n</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>2</mml:mn>
                  <mml:mo>+</mml:mo>
                  <mml:mi>C</mml:mi>
                  <mml:mo>×</mml:mo>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>n</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                      <mml:mo>+</mml:mo>
                      <mml:msub>
                        <mml:mi>n</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                      <mml:mo>−</mml:mo>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:mfrac>
              <mml:mo>.</mml:mo>
              <mml:mspace width="3em"/>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mn>2</mml:mn>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>These values are depicted in
<xref ref-type="fig" rid="f2">Figure 2</xref>.</p>
      <fig fig-type="figure" id="f2" orientation="portrait" position="float">
        <label>Figure 2. </label>
        <caption>
          <title>Deriving the predicted values used by
<italic>Crambled</italic>.</title>
          <p>Top left: The basic predicted depths of sequencing and allele fractions that are expected for a number of copy number states. Top right: For six cases the uncertainty in the allele fraction that will be observed is illustrated. Bottom left: When the distribution folds at the 0.5 level, the expected value of the allele fraction is reduced. Bottom right: The predicted depths of sequencing and allele fractions that are used in the
<italic>Crambled</italic> tool.</p>
        </caption>
        <graphic xlink:href="f1000research-4-8030-g0001"/>
      </fig>
      <p>For a locus that is heterozygous in the germline sample, the observed minor allele fraction is recorded. If the SNPs are phased, and one is considering a region in allelic balance, then it is possible to take all the allele fractions from one allele and gain a mean fraction of 0.5. Without the phasing information, the minor allele will be taken at each locus and so the mean allele fraction recorded in the region will be below 0.5. Even in regions of strong allelic imbalance, it is possible that the observed allele fraction can exceed 0.5 when the true value does not, and so the mean allele fraction in those regions will also be biased.</p>
      <p>Given the true minor allele fraction and depth, the observed fraction of the true minor allele has an estimable probability distribution. The mass of probability for allele fractions greater than 0.5 then ‘folds’ below 0.5 to reflect the distribution of the observed fraction of the observed minor allele, which is the value recorded. In this manner, the mean of the distribution is reduced. This effect is greater for small depths of sequencing due to the greater variance in observed allele fraction that comes from having a smaller denominator. The effect is greater also for allele fractions that are close to 0.5 (
<xref ref-type="fig" rid="f2">Figure 2</xref>).</p>
      <p>The final options available in the server interface allow the user to edit some of the metadata concerning the image loaded into
<italic>Crambled</italic>. Specifically, the user can depict a different range of depths as appropriate for their experimental data, and can specify the size of the image if this is different to the default.</p>
      <p><bold><italic>‘Client’-side tools</italic>.</bold> It may be that the user will already have details of germline variants, and their depths and allelic fractions in the tumour sample, from which to create an image to load into
<italic>Crambled</italic>. Such data may be purposefully sought from tools such as GATK (
<ext-link ext-link-type="uri" xlink:href="http://www.broadinstitute.org/gatk/">www.broadinstitute.org/gatk/</ext-link>)
<sup><xref rid="ref-16" ref-type="bibr">16</xref></sup>, SAMtools (
<ext-link ext-link-type="uri" xlink:href="http://www.htslib.org/">www.htslib.org/</ext-link>)
<sup><xref rid="ref-17" ref-type="bibr">17</xref></sup>, or parabam (
<ext-link ext-link-type="uri" xlink:href="http://parabam.readthedocs.org/">parabam.readthedocs.org/</ext-link>). Alternatively, the information may be available as the side effect of running a somatic mutation caller. In the event that such data are not available, functions are supplied with
<italic>Crambled</italic> to enable suitable data to be generated from BAM files.</p>
      <p>The function CrambledScan() is accompanied by a file that lists (for Human Genome Issue 19) 177,299 sites that are highly likely to be heterozygous in a sample. This was generated from the “snp138Common” table for hg19 from the UCSC Table Browser
<sup><xref rid="ref-18" ref-type="bibr">18</xref></sup>. Rsamtools
<sup><xref rid="ref-19" ref-type="bibr">19</xref></sup> is used to interrogate the BAM files at those locations. At a depth of coverage of about 40×, this typically returns approximately 80,000 heterozygous sites once quality filters have been put in place.</p>
      <p>A running median is then applied to the depths and allele fractions at these sites to reduce noise. Note that this is not an attempt to characterize the entire genome, but merely to capture the cellularity information. Thus it does not matter if fine-grain copy number changes are lost in this smoothing. Ideally one would have as many germline heterozygous loci as possible (typically 2,000,000 such loci for an individual), but extracting them comes at a computational cost. The approximately 80, 000 loci used here will usually suffice for this limited task, and fewer may be feasible as seen in
<xref ref-type="fig" rid="f3">Figure 3</xref>.</p>
      <fig fig-type="figure" id="f3" orientation="portrait" position="float">
        <label>Figure 3. </label>
        <caption>
          <title>The capabilities of a small number of loci to capture the grid-plot structure.</title>
          <p>Top left: A smoothed density plot of depth and B-allele fraction for sample SS6003302 (see Use Case 1) using 84,252 loci and no running average (equivalently a running average with a window length of 1). Top right: The same density plot with a running average (window size: 51 loci) first applied to the depth and minor allele fractions. Middle left, Middle right, Bottom left: The same density plots produced from samples of 50,000, 10,000 and 5,000 loci respectively. Bottom right: The same density plot produced from a sample of 1,000 loci and using a window of 11 loci for the running average.</p>
        </caption>
        <graphic xlink:href="f1000research-4-8030-g0002"/>
      </fig>
      <p>The need for using a running average is also demonstrated in
<xref ref-type="fig" rid="f3">Figure 3</xref>. Note that as the number of heterozygous loci being used decreases, then a window of,
<italic>e.g.,</italic> 50 loci represents a much larger genomic region, making it more likely that the values being averaged represent several distinct states and that the average will not represent a true state. Reducing that window will increase the noise in the picture and so a balance must be sought that reflects the complexity of the genome being studied.</p>
      <p>The plotting function (
<italic>CrambledPlot</italic>) takes the output of this approach and produces a standard R plot, but with parameters set to values that the
<italic>Crambled</italic> application will anticipate. Should it be necessary to change these, e.g. to increase the limits on the plotting area because a sample has been sequenced to 500× depth of coverage, then the
<italic>Crambled</italic> app needs to be informed via the metadata input options.</p>
    </sec>
    <sec>
      <title>Operation</title>
      <p>The tool and code presented here are built on top of R
<sup><xref rid="ref-14" ref-type="bibr">14</xref></sup> and Shiny
<sup><xref rid="ref-13" ref-type="bibr">13</xref></sup>, and thus will run on a large number of operating systems. The dependencies within R are on the ‘Shiny’ package (obtainable from The Comprehensive R Archive Network [
<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/">cran.r-project.org</ext-link>]) to run the application, and the ‘Rsamtools’ packages from Bioconductor
<sup><xref rid="ref-20" ref-type="bibr">20</xref></sup> required for the code to prepare images for
<italic>Crambled</italic>. Naturally, if the BAM files have been aligned against a genome other than human genome issue HG-19, then the list of suggested loci for investigation that accompanies the
<italic>Crambled</italic> tool will not be relevant and an alternative list must be generated. The user must create an image from the sequencing data of interest (either using the code provided, or independently in the style of the example images) and then load this into the
<italic>Crambled</italic> application. The
<italic>Crambled</italic> application can be run on a local machine that has R and the R shiny package installed, or it can be run on a Linux machine running the Shiny Server software (
<ext-link ext-link-type="uri" xlink:href="http://www.rstudio.com/products/shiny/shiny-server/">www.rstudio.com/products/shiny/shiny-server/</ext-link>). It has been extensively tested on a Ubuntu 12.04.5 machine running R version 3.2.1, Shiny 0.12.2 and Rsamtools 1.20.5. and an Apple computer running OS X version 10.9.5, R version 3.1.2, Shiny 0.11.1 and Rsamtools 1.18.3.</p>
      <p>The code provided with
<italic>Crambled</italic> for creating the images takes approximately 20 minutes to run (using a single processor on a reasonable desktop machine) on a single 100GB cell line BAM file, or approximately an hour to run on two 150GB BAM files representing a tumour/normal pair.</p>
    </sec>
  </sec>
  <sec>
    <title>Use cases</title>
    <sec>
      <title>A tumour/normal pair</title>
      <p>The first illustration of
<italic>Crambled</italic> is an application to a previously published tumour/normal pair from an oesophageal adenocarcinoma (OAC) patient
<sup><xref rid="ref-21" ref-type="bibr">21</xref></sup>. Two estimates of cellularity have been suggested in this case: 81% and 68%. While a small variation in estimates is natural, in this case the difference is too great to put down to the (in)stability of the estimate and it warrants investigation with the
<italic>Crambled</italic> tool.</p>
      <p>The first step is to generate the image to load into the
<italic>Crambled</italic> Shiny application. Assuming that one has obtained the two BAM files (here called “SS6003301.bam” and “SS6003302.bam”), within the R environment one types:</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;">&gt; 
                            <bold>source</bold>("crambledfunctions.R")&gt; CrambledScan(normal="SS6003301.bam",tumour="SS6003302.bam",
                            <bold>title</bold>="SS6003302")</styled-content>
        </preformat>
      </p>
      <p>This produces the file ‘SS6003022-shiny.png’ (available in the ExamplePlots folder at
<ext-link ext-link-type="uri" xlink:href="https://github.com/dralynch/crambled.git">https://github.com/dralynch/crambled.git</ext-link>), that can be loaded into the
<italic>Crambled</italic> application. The application may be operating on a server or, after installing Shiny, within R one can type:</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;">&gt; 
                            <bold>library</bold>(shiny)
&gt; runApp("crambled_app/")</styled-content>
        </preformat>
      </p>
      <p>to begin the tool. Uploading the figure, one can then test the two solutions as seen in
<xref ref-type="fig" rid="f4">Figure 4</xref>.</p>
      <fig fig-type="figure" id="f4" orientation="portrait" position="float">
        <label>Figure 4. </label>
        <caption>
          <title>Resolving two competing solutions for a tumour/normal-tissue pair.</title>
          <p>Left: The solution at 81% cellularity fits the extremes of the data (the red contour) well, suggests a (hypo)diploid solution and leaves two states (blue regions in the density plot) unexplained by the clonal model (presumably representing sub-clonal behaviour). Right: The solution at 68% cellularity fits the extremes of the data equally well, and explains all of the main observed states, but suggests that the tumour is largely tetraploid.</p>
        </caption>
        <graphic xlink:href="f1000research-4-8030-g0003"/>
      </fig>
      <p>One can see that the solution with 81% tumour assumes that the sample is primarily diploid, with some regions of copy number loss and, crucially, some regions of data that lie off of the predicted grid and so must represent ‘sub-clonal’ states. By contrast, the 68% cellularity solution shows that all of the data lie on the predicted grid (i.e. there is little-to-no evidence of sub-clonality). However this solution suggests that the sample is broadly tetraploid.</p>
      <p>Since OAC cases are often tetraploid, and this solution explains away all of the sub-clonality, the 68% cellularity solution seems to be the favourable one. While sub-clonal behaviour is also seen frequently in OAC, and the 81% solution is entirely valid, that the suggested sub-clonality conveniently only occurs at frequencies that can be explained by the tetraploid solution leads to a favouring of 68%.</p>
    </sec>
    <sec>
      <title>A cell line</title>
      <p>Cell lines present a different problem. Typically one would not be trying to estimate the cellularity of a cell line (which should be pure), but resolving the depth-of-sequencing/copy number can still be an issue, as can confirming that only a single population of cells is present.</p>
      <p>Commonly, there will be no germline reference sample for a tumour cell line. Coupled with this, due to the (near-)perfect purity of a cell line, it is not possible to distinguish a germline homozygous site from a heterozygous site that has undergone loss-of-heterozygosity (LOH). Nor is it possible to distinguish a clonal somatic mutation from a germline-heterozygous site.</p>
      <p>For the purposes of inferring cellularity, neither of these confusions matters except that in producing a patchwork- or grid- plot the signal from sites with no heterozygosity will drown out any observations from the (more informative) loci that have gained or retained heterozygosity. The purity of the cell line, and the consequent separating of LOH-representing regions from other regions on the plot allows for separation of the two groups (with a simple threshold on allele fraction) and subsequent down-sampling of the LOH-like regions. Since this case requires different preparation, a separate command is provided for the creation of the plot.</p>
      <p>This usage is illustrated using whole genome sequencing from the Genome Modelling System (
<ext-link ext-link-type="uri" xlink:href="https://github.com/genome/gms">github.com/genome/gms</ext-link>)
<sup><xref rid="ref-22" ref-type="bibr">22</xref></sup>. Three lanes of whole genome sequencing data for the HCC1395 breast cancer cell line (gerald_D1VCPACXX_1.bam, gerald_D1VCPACXX_2.bam, and gerald_D1VCPACXX_3.bam) were downloaded (via
<ext-link ext-link-type="uri" xlink:href="https://github.com/genome/gms/wiki/HCC1395-WGS-Exome-RNA-Seq-Data">github.com/genome/gms/wiki/HCC1395-WGS-Exome-RNA-Seq-Data</ext-link>) and aligned to the EnsEMBL release 71 assembly of the GRCh37 (hg19) human genome (
<ext-link ext-link-type="uri" xlink:href="https://apr2013.archive.ensembl.org/index.html">apr2013.archive.ensembl.org/index.html</ext-link>).</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;">&gt; 
                            <bold>source</bold>("crambledfunctions.R")&gt; CrambledScanCellline(normal="gerald_D1VCPACXX.bam",
                            <bold>title</bold>="HCC1395")</styled-content>
        </preformat>
      </p>
      <p>This produces the file ‘HCC1395-shiny.png’ (available in the ExamplePlots folder at
<ext-link ext-link-type="uri" xlink:href="https://github.com/dralynch/crambled.git">https://github.com/dralynch/crambled.git</ext-link>). This image can be loaded into the
<italic>Crambled</italic> application as per the previous use case. Therefore, within R one would type:</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;">&gt; 
                            <bold>library</bold>(shiny)
&gt; runApp("crambled_app/")</styled-content>
        </preformat>
      </p>
      <p>The results can be seen in
<xref ref-type="fig" rid="f5">Figure 5</xref>. The cell line appears to be a single population of cells, with copy numbers mainly in the 2 to 4 range (with some regions at a copy number of 1, and others at a copy number of 5 but with a four-to-one allele balance). Note that the thresholding of allele fractions may, at low depths, cause an artefactual data cloud to appear in the plot close to the threshold and suggestive of sub-clonality, but that this should be ignored.</p>
      <fig fig-type="figure" id="f5" orientation="portrait" position="float">
        <label>Figure 5. </label>
        <caption>
          <title>Illustrating the application to cell line data.</title>
        </caption>
        <graphic xlink:href="f1000research-4-8030-g0004"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>The code provided to produce the images to load into the
<italic>Crambled</italic> application suffices for the intended purpose, but has shortcomings with regard to other tasks. Firstly, it is prohibitively slow if one wishes to search for the complete set of informative loci in the genome, and the resolution that such a set brings to the problem is useful. One of the other tools mentioned in the introduction can be used if this is desired.</p>
    <p>Secondly, there is no correction either for biases such as GC-related biases in the tumour sample, nor for regions of the normal sample that are polyploid, nor for artefactual mapping. Any of these would reduce the noise in the figures (particularly that about the depth estimate) and could potentially allow fewer loci, or a smaller window for the running average, to be used.</p>
    <p>Finally, it should be noted that little effort is required to annotate the uploaded image more than is currently the case. Individual chromosomes could be picked out and highlighted using different colours. Alternatively, if one wanted to know whether e.g. TP53 had undergone LOH, it would be straightforward to mark the location of nearby SNPs and see where they lie in the plot.</p>
  </sec>
  <sec>
    <title>Summary</title>
    <p><italic>Crambled</italic> is a tool that allows for interactive investigation of the multiple solutions that are possible when inferring the cellularity (and related attributes) of a tumour sample that has undergone whole genome sequencing. Implemented as a Shiny application it can be used on most platforms and comes with example files and code to prepare such files from one’s own sequencing data.</p>
  </sec>
  <sec>
    <title>Software availability</title>
    <list list-type="simple">
      <list-item>
        <label>1.</label>
        <p>Software available from:
<ext-link ext-link-type="uri" xlink:href="https://dralynch.shinyapps.io/crambled_app">https://dralynch.shinyapps.io/crambled_app</ext-link> (limited usage server - the preference is for the user to download the
<italic>Crambled</italic> application and run it locally)</p>
      </list-item>
      <list-item>
        <label>2.</label>
        <p>Latest source code:
<ext-link ext-link-type="uri" xlink:href="https://github.com/dralynch/crambled.git">https://github.com/dralynch/crambled.git</ext-link>
</p>
      </list-item>
      <list-item>
        <label>3.</label>
        <p>Link to archived source code as at time of publication:
<ext-link ext-link-type="uri" xlink:href="http://www.dx.doi.org/10.5281/zenodo.34147">http://www.dx.doi.org/10.5281/zenodo.34147</ext-link>
<sup><xref rid="ref-23" ref-type="bibr">23</xref></sup>
</p>
      </list-item>
      <list-item>
        <label>4.</label>
        <p>License: Lesser GNU Public License 2.0:
<ext-link ext-link-type="uri" xlink:href="https://www.gnu.org/licenses/old-licenses/lgpl-2.0.html">https://www.gnu.org/licenses/old-licenses/lgpl-2.0.html</ext-link>
</p>
      </list-item>
    </list>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>The author acknowledges the access to test data provided by the Oesophageal cancer clinical and molecular stratification (OCCAMS) consortium.</p>
  </ack>
  <ref-list>
    <ref id="ref-1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>International Cancer Genome Consortium, </collab><name><surname>Hudson</surname><given-names>TJ</given-names></name><name><surname>Anderson</surname><given-names>W</given-names></name><etal/></person-group>:
<article-title>International network of cancer genome projects.</article-title><source><italic>Nature.</italic></source><year>2010</year>;<volume>464</volume>(<issue>7291</issue>):<fpage>993</fpage>–<lpage>998</lpage>.
<pub-id pub-id-type="doi">10.1038/nature08987</pub-id><!--<pub-id pub-id-type="pmcid">2902243</pub-id>--><?supplied-pmid 20393554?><pub-id pub-id-type="pmid">20393554</pub-id></mixed-citation>
    </ref>
    <ref id="ref-2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zack</surname><given-names>TI</given-names></name><name><surname>Schumacher</surname><given-names>SE</given-names></name><name><surname>Carter</surname><given-names>SL</given-names></name><etal/></person-group>:
<article-title>Pan-cancer patterns of somatic copy number alteration.</article-title><source><italic>Nat Genet.</italic></source><year>2013</year>;<volume>45</volume>(<issue>10</issue>):<fpage>1134</fpage>–<lpage>1140</lpage>.
<pub-id pub-id-type="doi">10.1038/ng.2760</pub-id><!--<pub-id pub-id-type="pmcid">3966983</pub-id>--><?supplied-pmid 24071852?><pub-id pub-id-type="pmid">24071852</pub-id></mixed-citation>
    </ref>
    <ref id="ref-3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pleasance</surname><given-names>ED</given-names></name><name><surname>Cheetham</surname><given-names>RK</given-names></name><name><surname>Stephens</surname><given-names>PJ</given-names></name><etal/></person-group>:
<article-title>A comprehensive catalogue of somatic mutations from a human cancer genome.</article-title><source><italic>Nature.</italic></source><year>2010</year>;<volume>463</volume>(<issue>7278</issue>):<fpage>191</fpage>–<lpage>196</lpage>.
<pub-id pub-id-type="doi">10.1038/nature08658</pub-id><!--<pub-id pub-id-type="pmcid">3145108</pub-id>--><?supplied-pmid 20016485?><pub-id pub-id-type="pmid">20016485</pub-id></mixed-citation>
    </ref>
    <ref id="ref-4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Knight</surname><given-names>SJ</given-names></name><name><surname>Yau</surname><given-names>C</given-names></name><name><surname>Clifford</surname><given-names>R</given-names></name><etal/></person-group>:
<article-title>Quantification of subclonal distributions of recurrent genomic aberrations in paired pre-treatment and relapse samples from patients with B-cell chronic lymphocytic leukemia.</article-title><source><italic>Leukemia.</italic></source><year>2012</year>;<volume>26</volume>(<issue>7</issue>):<fpage>1564</fpage>–<lpage>75</lpage>.
<pub-id pub-id-type="doi">10.1038/leu.2012.13</pub-id><!--<pub-id pub-id-type="pmcid">3505832</pub-id>--><?supplied-pmid 22258401?><pub-id pub-id-type="pmid">22258401</pub-id></mixed-citation>
    </ref>
    <ref id="ref-5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carter</surname><given-names>SL</given-names></name><name><surname>Cibulskis</surname><given-names>K</given-names></name><name><surname>Helman</surname><given-names>E</given-names></name><etal/></person-group>:
<article-title>Absolute quantification of somatic DNA alterations in human cancer.</article-title><source><italic>Nat Biotechnol.</italic></source><year>2012</year>;<volume>30</volume>(<issue>5</issue>):<fpage>413</fpage>–<lpage>21</lpage>.
<pub-id pub-id-type="doi">10.1038/nbt.2203</pub-id><!--<pub-id pub-id-type="pmcid">4383288</pub-id>--><?supplied-pmid 22544022?><pub-id pub-id-type="pmid">22544022</pub-id></mixed-citation>
    </ref>
    <ref id="ref-6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van Loo</surname><given-names>P</given-names></name><name><surname>Nordgard</surname><given-names>SH</given-names></name><name><surname>Lingjaerde</surname><given-names>OC</given-names></name><etal/></person-group>:
<article-title>Allele-specific copy number analysis of tumors.</article-title><source><italic>Proc Natl Acad Sci U S A.</italic></source><year>2010</year>;<volume>107</volume>(<issue>39</issue>):<fpage>16910</fpage>–<lpage>16915</lpage>.
<pub-id pub-id-type="doi">10.1073/pnas.1009843107</pub-id><!--<pub-id pub-id-type="pmcid">2947907</pub-id>--><?supplied-pmid 20837533?><pub-id pub-id-type="pmid">20837533</pub-id></mixed-citation>
    </ref>
    <ref id="ref-7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fischer</surname><given-names>A</given-names></name><name><surname>Vázquez-García</surname><given-names>I</given-names></name><name><surname>Illingworth</surname><given-names>CJ</given-names></name><etal/></person-group>:
<article-title>High-definition reconstruction of clonal composition in cancer.</article-title><source><italic>Cell Rep.</italic></source><year>2014</year>;<volume>7</volume>(<issue>5</issue>):<fpage>1740</fpage>–<lpage>1752</lpage>.
<pub-id pub-id-type="doi">10.1016/j.celrep.2014.04.055</pub-id><!--<pub-id pub-id-type="pmcid">4062932</pub-id>--><?supplied-pmid 24882004?><pub-id pub-id-type="pmid">24882004</pub-id></mixed-citation>
    </ref>
    <ref id="ref-8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yau</surname><given-names>C</given-names></name></person-group>:
<article-title>OncoSNP-SEQ: a statistical approach for the identification of somatic copy number alterations from next-generation sequencing of cancer genomes.</article-title><source><italic>Bioinformatics.</italic></source><year>2013</year>;<volume>29</volume>(<issue>19</issue>):<fpage>2482</fpage>–<lpage>2484</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btt416</pub-id><?supplied-pmid 23926227?><pub-id pub-id-type="pmid">23926227</pub-id></mixed-citation>
    </ref>
    <ref id="ref-9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname><given-names>S</given-names></name><name><surname>Nones</surname><given-names>K</given-names></name><name><surname>Miller</surname><given-names>D</given-names></name><etal/></person-group>:
<article-title>qpure: A tool to estimate tumor cellularity from genome-wide single-nucleotide polymorphism profiles.</article-title><source><italic>PLoS One.</italic></source><year>2012</year>;<volume>7</volume>(<issue>9</issue>):<fpage>e45835</fpage>.
<pub-id pub-id-type="doi">10.1371/journal.pone.0045835</pub-id><!--<pub-id pub-id-type="pmcid">3457972</pub-id>--><?supplied-pmid 23049875?><pub-id pub-id-type="pmid">23049875</pub-id></mixed-citation>
    </ref>
    <ref id="ref-10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yadav</surname><given-names>VK</given-names></name><name><surname>De</surname><given-names>S</given-names></name></person-group>:
<article-title>An assessment of computational methods for estimating purity and clonality using genomic data derived from heterogeneous tumor tissue samples.</article-title><source><italic>Brief Bioinform.</italic></source><year>2015</year>;<volume>16</volume>(<issue>2</issue>):<fpage>232</fpage>–<lpage>241</lpage>.
<pub-id pub-id-type="doi">10.1093/bib/bbu002</pub-id><?supplied-pmid 24562872?><pub-id pub-id-type="pmid">24562872</pub-id></mixed-citation>
    </ref>
    <ref id="ref-11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lönnstedt</surname><given-names>IM</given-names></name><name><surname>Caramia</surname><given-names>F</given-names></name><name><surname>Li</surname><given-names>J</given-names></name><etal/></person-group>:
<article-title>Deciphering clonality in aneuploid breast tumors using SNP array and sequencing data.</article-title><source><italic>Genome Biol.</italic></source><year>2014</year>;<volume>15</volume>(<issue>9</issue>):<fpage>470</fpage>.
<pub-id pub-id-type="doi">10.1186/s13059-014-0470-7</pub-id><!--<pub-id pub-id-type="pmcid">4220069</pub-id>--><?supplied-pmid 25270265?><pub-id pub-id-type="pmid">25270265</pub-id></mixed-citation>
    </ref>
    <ref id="ref-12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>JT</given-names></name><name><surname>Thorvaldsdóttir</surname><given-names>H</given-names></name><name><surname>Winckler</surname><given-names>W</given-names></name><etal/></person-group>:
<article-title>Integrative genomics viewer.</article-title><source><italic>Nat Biotechnol.</italic></source><year>2011</year>;<volume>29</volume>(<issue>1</issue>):<fpage>24</fpage>–<lpage>6</lpage>.
<pub-id pub-id-type="doi">10.1038/nbt.1754</pub-id><!--<pub-id pub-id-type="pmcid">3346182</pub-id>--><?supplied-pmid 21221095?><pub-id pub-id-type="pmid">21221095</pub-id></mixed-citation>
    </ref>
    <ref id="ref-13">
      <label>13</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chang</surname><given-names>W</given-names></name><name><surname>Cheng</surname><given-names>J</given-names></name><name><surname>Allaire</surname><given-names>JJ</given-names></name><etal/></person-group>:
<article-title>shiny: Web Application Framework for R</article-title>. R package version 0.11.1.<year>2015</year>.</mixed-citation>
    </ref>
    <ref id="ref-14">
      <label>14</label>
      <mixed-citation publication-type="book"><collab>R Core Team</collab>:
<article-title>R: A Language and Environment for Statistical Computing</article-title>. R Foundation for Statistical Computing, Vienna, Austria.<year>2014</year><ext-link ext-link-type="uri" xlink:href="http://www.researchgate.net/publication/221943681_R_Core_Team._R_A_Language_and_Environment_for_Statistical_Computing_2014">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-15">
      <label>15</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mayrhofer</surname><given-names>M</given-names></name><name><surname>DiLorenzo</surname><given-names>S</given-names></name><name><surname>Isaksson</surname><given-names>A</given-names></name></person-group>:
<article-title>Patchwork: allele-specific copy number analysis of whole-genome sequenced tumor tissue.</article-title><source><italic>Genome Biol.</italic></source><year>2013</year>;<volume>14</volume>(<issue>3</issue>):<fpage>R24</fpage>.
<pub-id pub-id-type="doi">10.1186/gb-2013-14-3-r24</pub-id><!--<pub-id pub-id-type="pmcid">4053982</pub-id>--><?supplied-pmid 23531354?><pub-id pub-id-type="pmid">23531354</pub-id></mixed-citation>
    </ref>
    <ref id="ref-16">
      <label>16</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McKenna</surname><given-names>A</given-names></name><name><surname>Hanna</surname><given-names>M</given-names></name><name><surname>Banks</surname><given-names>E</given-names></name><etal/></person-group>:
<article-title>The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data.</article-title><source><italic>Genome Res.</italic></source><year>2010</year>;<volume>20</volume>(<issue>9</issue>):<fpage>1297</fpage>–<lpage>303</lpage>.
<pub-id pub-id-type="doi">10.1101/gr.107524.110</pub-id><!--<pub-id pub-id-type="pmcid">2928508</pub-id>--><?supplied-pmid 20644199?><pub-id pub-id-type="pmid">20644199</pub-id></mixed-citation>
    </ref>
    <ref id="ref-17">
      <label>17</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Handsaker</surname><given-names>B</given-names></name><name><surname>Wysoker</surname><given-names>A</given-names></name><etal/></person-group>:
<article-title>The Sequence Alignment/Map format and SAMtools.</article-title><source><italic>Bioinformatics.</italic></source><year>2009</year>;<volume>25</volume>(<issue>16</issue>):<fpage>2078</fpage>–<lpage>9</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id><!--<pub-id pub-id-type="pmcid">2723002</pub-id>--><?supplied-pmid 19505943?><pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="ref-18">
      <label>18</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karolchik</surname><given-names>D</given-names></name><name><surname>Hinrichs</surname><given-names>AS</given-names></name><name><surname>Furey</surname><given-names>TS</given-names></name><etal/></person-group>:
<article-title>The UCSC Table Browser data retrieval tool.</article-title><source><italic>Nucleic Acids Res.</italic></source><year>2004</year>;<volume>32</volume>(<issue>Database issue</issue>):<fpage>D493</fpage>–<lpage>6</lpage>.
<pub-id pub-id-type="doi">10.1093/nar/gkh103</pub-id><!--<pub-id pub-id-type="pmcid">308837</pub-id>--><?supplied-pmid 14681465?><pub-id pub-id-type="pmid">14681465</pub-id></mixed-citation>
    </ref>
    <ref id="ref-19">
      <label>19</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morgan</surname><given-names>M</given-names></name><name><surname>Pagès</surname><given-names>H</given-names></name><name><surname>Obenchain</surname><given-names>V</given-names></name><etal/></person-group>:
<article-title>Rsamtools: Binary alignment (BAM), FASTA, variant call (BCF), and tabix file import</article-title>. R package version 1.18.3.<year>2015</year><ext-link ext-link-type="uri" xlink:href="http://bioc.ism.ac.jp/packages/3.0/bioc/manuals/Rsamtools/man/Rsamtools.pdf">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-20">
      <label>20</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gentleman</surname><given-names>RC</given-names></name><name><surname>Carey</surname><given-names>VJ</given-names></name><name><surname>Bates</surname><given-names>DM</given-names></name><etal/></person-group>:
<article-title>Bioconductor: Open software development for computational biology and bioinformatics.</article-title><source><italic>Genome Biol.</italic></source><year>2004</year>;<volume>5</volume>(<issue>10</issue>):<fpage>R80</fpage>.
<pub-id pub-id-type="doi">10.1186/gb-2004-5-10-r80</pub-id><!--<pub-id pub-id-type="pmcid">545600</pub-id>--><?supplied-pmid 15461798?><pub-id pub-id-type="pmid">15461798</pub-id></mixed-citation>
    </ref>
    <ref id="ref-21">
      <label>21</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weaver</surname><given-names>JM</given-names></name><name><surname>Ross-Innes</surname><given-names>CS</given-names></name><name><surname>Shannon</surname><given-names>N</given-names></name><etal/></person-group>:
<article-title>Ordering of mutations in preinvasive disease stages of esophageal carcinogenesis.</article-title><source><italic>Nat Genet.</italic></source><year>2014</year>;<volume>46</volume>(<issue>8</issue>):<fpage>837</fpage>–<lpage>43</lpage>.
<pub-id pub-id-type="doi">10.1038/ng.3013</pub-id><!--<pub-id pub-id-type="pmcid">4116294</pub-id>--><?supplied-pmid 24952744?><pub-id pub-id-type="pmid">24952744</pub-id></mixed-citation>
    </ref>
    <ref id="ref-22">
      <label>22</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Griffith</surname><given-names>M</given-names></name><name><surname>Griffith</surname><given-names>OL</given-names></name><name><surname>Smith</surname><given-names>SM</given-names></name><etal/></person-group>:
<article-title>Genome Modeling System: A Knowledge Management Platform for Genomics.</article-title><source><italic>PLoS Comput Biol.</italic></source><year>2015</year>;<volume>11</volume>(<issue>7</issue>):<fpage>e1004274</fpage>.
<pub-id pub-id-type="doi">10.1371/journal.pcbi.1004274</pub-id><!--<pub-id pub-id-type="pmcid">4497734</pub-id>--><?supplied-pmid 26158448?><pub-id pub-id-type="pmid">26158448</pub-id></mixed-citation>
    </ref>
    <ref id="ref-23">
      <label>23</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lynch</surname><given-names>AG</given-names></name></person-group>:
<article-title><italic>Crambled</italic>: Release v1.0 to accompany manuscript.</article-title><source><italic>Zenodo.</italic></source><year>2015</year><ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5281/zenodo.34147">Data Source</ext-link></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="report12383" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.8030.r12383</article-id>
    <title-group>
      <article-title>Referee response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lönnstedt</surname>
          <given-names>Ingrid</given-names>
        </name>
        <xref ref-type="aff" rid="r12383a1">1</xref>
        <role>Referee</role>
      </contrib>
      <aff id="r12383a1"><label>1</label>Department of Immunology, Genetics and Pathology, Uppsala University, Uppsala, Sweden</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>2</month>
      <year>2016</year>
    </pub-date>
    <related-article id="d35e1975" related-article-type="peer-reviewed-article" ext-link-type="doi" xlink:href="10.12688/f1000research.7453.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>The article describes "Crambled", an online application to investigate cellularity/ploidy solutions of genome sequencing copy number data. The easily accessible and soundly developed tool, enabling informed choices between potential solutions, is the main contribution of this study. It also comprises additional advances to existing methods, as (i) the naturally occurring bias in minor allele fractions of heterozygous loci is assessed and adjusted for, and (ii)  crambled suggests potentially heterozygous sites which can add substantially to the information a solution choice is based upon.</p>
    <p>These are minor suggestions to improve the article:
<list list-type="bullet"><list-item><p>I would have enjoyed some performance statistics on Crambled, for example showing the fraction of samples tried that were successfully resolved, or the fractions of samples tried that had in practice a good fit to expected cluster centers for at least say 70% of the genome. At the moment I can only see the overall performance of a couple of of samples, and Figure 2 seems to be based on simulated data so I cannot assess whether this strategy works out well with real data.</p></list-item><list-item><p>I have only tried the online Crambled application, not the full from bam file setup which requires source download. Based on the current version of the article, it is not obvious to me whether the full downloadable version of Crambled returns a list with the copy numbers of a chosen cellularity solution are assigned to genomic locations, or whether this solutions (which will commonly be a central desired outcome of the analysis) have to be extracted with a different software.</p></list-item><list-item><p>In the last section before Discussion, I do not understand where the "cloud close to the threshold" is, which is falsely suggesting subclonality. Could that be explained better?</p></list-item><list-item><p>The png figures to be supplied to Crambled should show "minor allele proportion" versus "depth of sequencing". Preferably explain that "depth of sequencing" is different from the definition of "Depth" in equation 1 (assuming you mean the total depth, not just the depth of one copy).</p></list-item><list-item><p>I think many readers would have enjoyed some more instructions on how to play with the cellularity and depth in the application. What should I try to achieve, what should I try to avoid?</p></list-item></list>
</p>
    <p>I have read this submission. I believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
</sub-article>
<sub-article id="report11450" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.8030.r11450</article-id>
    <title-group>
      <article-title>Referee response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Oosting</surname>
          <given-names>Jan</given-names>
        </name>
        <xref ref-type="aff" rid="r11450a1">1</xref>
        <role>Referee</role>
      </contrib>
      <aff id="r11450a1"><label>1</label>Department of Pathology, Leiden University Medical Center, Leiden, Netherlands</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>1</month>
      <year>2016</year>
    </pub-date>
    <related-article id="d35e2043" related-article-type="peer-reviewed-article" ext-link-type="doi" xlink:href="10.12688/f1000research.7453.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>The manuscript by Lynch presents an R app ‘Crambled’ to ease the determination, in whole genome DNA sequencing experiments, of cellularity in tumour samples or to show the presence of sub clones in cellline samples.</p>
    <p>A shiny app displays an image of the behavior of heterozygous SNPs according to read-depth and minor allele frequency, and overlays that with the theoretical positions of chromosomal aberrations at  user- defined cellularity and single copy coverage levels.</p>
    <p>The image can be produced, starting from BAM-files, by the accompanying functions of the app.
<list list-type="bullet"><list-item><p>The manuscript is written clearly, and describes the functionality of the package well.</p></list-item><list-item><p>I have not tested all functions of the package, but the R code is understandable and straightforward. The functions are commented throughout.</p></list-item><list-item><p>As described in the paper, during the use of the shiny app, it is important to have an idea of the cellularity of the sample. Just playing around with the sliders does not converge to logical solutions easily. The example case 1 illustrates the usefulness of the app because it shows clearly that one of the cellularity solutions is to be preferred over the other.</p></list-item><list-item><p>I would like more guidance on how to get the cellularity estimates. The references 5-9 seem to be geared mostly towards array type of data. It would be a good addition to provide a preferred solution in the workflow description.</p></list-item><list-item><p>It would be good to mention the values for cellularity and single copy depth that were chosen for figure 2.</p></list-item></list>In conclusion, the manuscript presents a tool that is useful in the assessment of copy-number aberrations. There are a few minor details that could be improved.</p>
    <p>I have read this submission. I believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
</sub-article>
